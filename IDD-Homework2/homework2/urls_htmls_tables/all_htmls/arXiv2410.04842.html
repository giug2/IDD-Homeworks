<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>A Simple Image Segmentation Framework via In-Context Examples</title>
<!--Generated on Tue Oct  8 12:38:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.04842v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S1" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S1.SS1" title="In 1 Introduction ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.1 </span>Related Work</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S2" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S2.SS1" title="In 2 Preliminary ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S2.SS2" title="In 2 Preliminary ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>A Revisit of SegGPT</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S3" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S3.SS1" title="In 3 Method ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S3.SS2" title="In 3 Method ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>In-Context Interaction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S3.SS3" title="In 3 Method ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Matching Transformer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.SS1" title="In 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Qualitative Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.SS2" title="In 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Few-shot Semantic Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.SS3" title="In 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Few-shot Instance Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.SS4" title="In 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Video Object Segmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.SS5" title="In 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S5" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion and Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A1" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Discussions and Limitation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A2" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3" title="In A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional Results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.SS1" title="In Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.1 </span>Transfer Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.SS2" title="In Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.2 </span>Comparison of SINE and SegGPT without Objects365.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.SS3" title="In Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.3 </span>Impact of Different Backbones.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.SS4" title="In Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.4 </span>Generalization of SINE on One-shot Part Segmentation.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.SS5" title="In Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.5 </span>Generalizability of SINE beyond Semantically Similar Objects.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.SS6" title="In Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C.6 </span>Visualizations</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
A Simple Image Segmentation Framework via In-Context Examples
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yang Liu<sup class="ltx_sup" id="id10.10.id1">1</sup>,
  
Chenchen Jing<sup class="ltx_sup" id="id11.11.id2">1</sup>,
  
Hengtao Li<sup class="ltx_sup" id="id12.12.id3">1</sup>,
  
Muzhi Zhu<sup class="ltx_sup" id="id13.13.id4">1</sup>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id5.5.1">Hao Chen<sup class="ltx_sup" id="id5.5.1.1"><span class="ltx_text ltx_font_medium" id="id5.5.1.1.1">1</span></sup></span>,
  
<span class="ltx_text ltx_font_bold" id="id6.6.2">Xinlong Wang<sup class="ltx_sup" id="id6.6.2.1"><span class="ltx_text ltx_font_medium" id="id6.6.2.1.1">2</span></sup></span>,
  
<span class="ltx_text ltx_font_bold" id="id7.7.3">Chunhua Shen<sup class="ltx_sup" id="id7.7.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id7.7.3.1.1">1</span></sup></span>
<br class="ltx_break"/>
<sup class="ltx_sup" id="id14.14.id5">1</sup>Zhejiang University, China
    
<sup class="ltx_sup" id="id15.15.id6">2</sup>Beijing Academy of Artificial Intelligence
</span><span class="ltx_author_notes">HC is the corresponding author.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id16.id1">Recently, there have been explorations of generalist segmentation models that can effectively tackle a variety of image segmentation tasks within a unified in-context learning framework. However, these methods still struggle with task ambiguity in in-context segmentation, as not all in-context examples can accurately convey the task information. In order to address this issue, we present SINE, a simple image <span class="ltx_text ltx_font_bold" id="id16.id1.1">S</span>egmentation framework utilizing <span class="ltx_text ltx_font_bold" id="id16.id1.2">in</span>-context <span class="ltx_text ltx_font_bold" id="id16.id1.3">e</span>xamples.
Our approach leverages a Transformer encoder-decoder structure, where the encoder provides high-quality image representations, and the decoder is designed to yield multiple task-specific output masks to effectively eliminate task ambiguity.
Specifically, we introduce an In-context Interaction module to complement in-context information and produce correlations between the target image and the in-context example and a Matching Transformer that uses fixed matching and a Hungarian algorithm to eliminate differences between different tasks.
In addition, we have further perfected the current evaluation system for in-context image segmentation, aiming to facilitate a holistic appraisal of these models.
Experiments on various segmentation tasks show the effectiveness of the proposed method.</p>
<p class="ltx_p" id="id17.id2">Our
code is released at: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/aim-uofa/SINE" title="">https://github.com/aim-uofa/SINE</a></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Image segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx59" title="">ZZP<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx29" title="">LMB<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx22" title="">KGHD19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx53" title="">XYF<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx43" title="">PTPC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>]</cite> involves localizing and organizing concepts at the pixel level.
Different definitions of concepts, such as foreground, category, and object instance, lead to different types of segmentation tasks.
Recent years, we have witnessed great progress in developing more accurate and
faster algorithms for various segmentation tasks such as semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx32" title="">LSD15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx56" title="">ZSQ<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx44" title="">RBK21</a>]</cite>, instance segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx18" title="">HGDG17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx8" title="">DBNVG17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx3" title="">BZXL19</a>]</cite>, panoptic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx22" title="">KGHD19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx4" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>, foreground segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx46" title="">SG99</a>]</cite>, interactive segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx52" title="">XPC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx39" title="">MVL18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx24" title="">KMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>.
Nonetheless, most existing segmentation methods are tailored for certain tasks and cannot be applied to other tasks.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">More recently, a few works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> have explored generalist segmentation models that are capable of solving diverse and unlimited segmentation tasks via in-context learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx2" title="">BMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite>.
Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> performs in-context training with masked image modeling and can achieve various tasks according to the in-context visual prompts.
SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> focuses on visual segmentation and introduces in-context segmentation, which unifies multiple segmentation tasks by incorporating both a target image and an annotated reference image as input. To encourage the model to leverage contextual information, SegGPT employs a random coloring scheme during the task completion process.
However, these models still struggle with task ambiguity in in-context segmentation.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="231" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Illustration of ambiguity in traditional in-context segmentation framework and an overview of our SINE framework.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">1</span></a>(a), the in-context segmentation model needs to understand the task and content information conveyed by the in-context example and segments related concepts on the target image. However, not all in-context examples can convey the task information accurately. For example, when presented with a
photo of a particular individual
for segmenting the target image that includes him/her and others, which visual concepts should be segmented? Specifically, should it be limited to
the individual
alone, encompass the instance segmentation of all persons, or focus on semantic segmentation?
Whether the pixels of the target image need to be segmented depends on their similarity to the in-context example. Ambiguous in-context examples can make it difficult for traditional in-context segmentation models to clearly define the boundaries between different tasks, resulting in undesired outputs.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address this issue, we present SINE, a simple image <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">S</span>egmentation framework via <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">IN</span>-context <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">E</span>xamples.
Drawing inspiration from the segment anything model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx24" title="">KMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>, which addresses point ambiguity by generating multiple masks of different granularity, SINE predicts multiple output masks, custom-made for tasks of varying complexity. This ranges from identical objects, instances to overall semantic conception.
SINE unifies existing segmentation tasks with various granularities, intending to achieve a broader task generalization.
SINE leverages a Transformer encoder-decoder structure. The encoder contains a frozen pre-trained image encoder offering high-quality image representations and an In-context Interaction module to complement in-context information and learn correlations between the target and the reference image features.
We propose a novel Matching Transformer (M-Former) for efficient multiple-task decoding. M-Former is implemented by a dual-path Transformer. One path is used for information interaction between object queries with image features. The second path is employed to enhance the semantic prototypes for accurate matching.
In addition, a fixed matching and a Hungarian algorithm are used to eliminate differences between different tasks.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">SINE achieves impressive performance with fewer trainable parameters compared with SegGPT. Our qualitative results demonstrate that SINE can effectively address the problem of task ambiguity in in-context segmentation, while SegGPT only outputs the semantic segmentation results. SINE achieves state-of-the-art or competitive performance on existing in-context image segmentation benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>, including few-shot semantic segmentation, video object segmentation. In addition, we further introduce few-shot instance segmentation to the current evaluation system for facilitating a holistic appraisal of these models. SINE provides a baseline result for in-context segmentation models to promote the development of this field.
Finally, comprehensive ablation studies verify the effectiveness of the proposed components.
Our main contributions are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">To our knowledge, our method
is the first to investigate the task ambiguity of in-context segmentation,
and we present a simple but effective framework to address the issue.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We introduce a Matching Transformer to unleash the potential of frozen pre-trained image models on various segmentation tasks with a low training cost.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Our comprehensive results demonstrate that SINE can address a broad range of segmentation tasks, including few-shot semantic segmentation, few-shot instance segmentation, video object segmentation.
Ablation studies show the effectiveness of the proposed components.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Related Work</h3>
<div class="ltx_para" id="S1.SS1.p1">
<p class="ltx_p" id="S1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.SS1.p1.1.1">Image Segmentation</span>
Segmentation involves localizing and organizing meaningful concepts at the pixel level.
Different definitions of concepts, such as foreground, category, and object instance, lead to different types of segmentation tasks.
Specifically, semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx59" title="">ZZP<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>19</a>]</cite> requires semantic classification at the pixel level, while instance segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx29" title="">LMB<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>14</a>]</cite> is to identify and localize various object instances. Panoptic Segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx22" title="">KGHD19</a>]</cite> introduces a more challenging task by unifying semantic segmentation and instance segmentation. Video object segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx53" title="">XYF<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx43" title="">PTPC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>]</cite> is to segment an identical object throughout a video sequence.
Most existing segmentation methods are tailored for certain tasks and cannot be applied to other tasks.</p>
</div>
<div class="ltx_para" id="S1.SS1.p2">
<p class="ltx_p" id="S1.SS1.p2.1">Traditional segmentation methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx32" title="">LSD15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx30" title="">LMSR17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx56" title="">ZSQ<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx44" title="">RBK21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx18" title="">HGDG17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx8" title="">DBNVG17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx3" title="">BZXL19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx22" title="">KGHD19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx4" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite> have been designed for identical segmentation tasks and trained on a specific dataset. These methods have limited generalization when transferring to other datasets or tasks. To solve this challenge,
we unify
various segmentation tasks into in-context segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> and introduces a simple visual segmentation framework via in-context examples. Prompted by a given in-context example, our method can perform few-shot segmentation across various datasets and tasks.</p>
</div>
<div class="ltx_para" id="S1.SS1.p3">
<p class="ltx_p" id="S1.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S1.SS1.p3.1.1">In-Context Visual Learning</span>
Recently, in-context learning has been successfully used in NLP tasks and vision-and-language tasks.
Bar <em class="ltx_emph ltx_font_italic" id="S1.SS1.p3.1.2">et al.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx1" title="">BGD<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite> first introduced in-context learning in computer vision.
They cast the in-context learning as an image inpainting problem, where models need to fill in a hole in a concatenated image containing several examples and a new input image.
They demonstrate the effectiveness of the strategy for foreground segmentation, single object detection, and colorization.
Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> adopts masked image modeling on continuous pixels to perform in-context training with supervised datasets, and achieves competitive results on seven vision tasks.
SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> focuses on the segmentation task and uses random coloring scheme that forces the model to reference contextual information to complete the assigned task.</p>
</div>
<div class="ltx_para" id="S1.SS1.p4">
<p class="ltx_p" id="S1.SS1.p4.1">Our work focuses on segmentation tasks.
These aforementioned models struggle with the task ambiguity in in-context segmentation.
By contrast, our SINE can effectively address the problem of task ambiguity in in-context segmentation by disentangling the specific task from the in-context example and understanding the semantic concepts of the prompts to output results at different levels of task granularity from the identical object, instance, to semantics.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminary</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we first formulate the problem setting of in-context segmentation. Then, we revisit SegGPT, the previous in-context segmentation model.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Formulation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.7">In-context segmentation aims to identify a specific task and objects within the given in-context example, including a reference image <math alttext="\textbf{x}_{r}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2a.cmml">x</mtext><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2a.cmml" xref="S2.SS1.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">x</mtext></ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\textbf{x}_{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">x start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and its annotations <math alttext="\textbf{y}_{r}=\{(m_{r}^{i},c_{r}^{i})\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.2.m2.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.3.2a.cmml">y</mtext><mi id="S2.SS1.p1.2.m2.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.cmml">r</mi></msub><mo id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">=</mo><msubsup id="S2.SS1.p1.2.m2.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.cmml"><mrow id="S2.SS1.p1.2.m2.1.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml"><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.3" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">m</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">r</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.4" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2.cmml">c</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3.cmml">r</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.5" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.2.m2.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.2.m2.1.1.1.1.3.1" xref="S2.SS1.p1.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.2.m2.1.1.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.2.m2.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><eq id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2"></eq><apply id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.3.2a.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2">y</mtext></ci><ci id="S2.SS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3">𝑟</ci></apply><apply id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1"><interval closure="open" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2"><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.2">𝑚</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.2">𝑐</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.2.3">𝑟</ci></apply><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S2.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3"><eq id="S2.SS1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.1"></eq><ci id="S2.SS1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S2.SS1.p1.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S2.SS1.p1.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.2.m2.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\textbf{y}_{r}=\{(m_{r}^{i},c_{r}^{i})\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">y start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = { ( italic_m start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, and segment the interested objects in the target image <math alttext="\textbf{x}_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2a.cmml">x</mtext><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2a.cmml" xref="S2.SS1.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">x</mtext></ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\textbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>.
<math alttext="m_{r}^{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msubsup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2.2" xref="S2.SS1.p1.4.m4.1.1.2.2.cmml">m</mi><mi id="S2.SS1.p1.4.m4.1.1.2.3" xref="S2.SS1.p1.4.m4.1.1.2.3.cmml">r</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2.2">𝑚</ci><ci id="S2.SS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3">𝑟</ci></apply><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">m_{r}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_m start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_i</annotation></semantics></math>-th reference mask and <math alttext="c_{r}^{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msubsup id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2.2" xref="S2.SS1.p1.6.m6.1.1.2.2.cmml">c</mi><mi id="S2.SS1.p1.6.m6.1.1.2.3" xref="S2.SS1.p1.6.m6.1.1.2.3.cmml">r</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">superscript</csymbol><apply id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2.2">𝑐</ci><ci id="S2.SS1.p1.6.m6.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.2.3">𝑟</ci></apply><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">c_{r}^{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_c start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> denotes its class label, <math alttext="N" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_N</annotation></semantics></math> denotes the number of the reference masks. The interested objects are related to the in-context example, which can be an identical object for video object segmentation or all objects of the same semantic concept for instance segmentation and semantic segmentation.
We mainly focus on three semantic granularities in the task ambiguity, <em class="ltx_emph ltx_font_italic" id="S2.SS1.p1.7.1">i.e.</em>, identical object (ID), instance, and semantic. The identical object segmentation can be seen as finer granularity instance segmentation, and instance segmentation can be transformed into semantic segmentation by merging instance masks belonging to the same category. Based on this relationship between these tasks, we unify them into instance segmentation.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>A Revisit of SegGPT</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> introduces in-context segmentation, which incorporates both the images and mask annotations into an RGB image to convey the specific task to be performed and identify the objects to be segmented simultaneously.
SegGPT takes stitched reference and target images as input and employs the masked image modeling algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx17" title="">HCX<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite> and smooth-<math alttext="\ell" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS2.p1.1.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\ell</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">roman_ℓ</annotation></semantics></math>1 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx15" title="">Gir15</a>]</cite> loss to train a Vision Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx7" title="">DBK<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite> encoder.
During inference, SegGPT enables segmenting everything via an in-context example, including a reference image and its annotation image. Given a target image, it is stitched with the reference image and fed into SegGPT to get the corresponding in-context predictions.
Although SegGPT has achieved great success in various segmentation tasks, it faces two challenges: 1) In many cases, in-context examples may not accurately convey the task information. For example, when an in-context example only consists of a single object and its annotation, the lack of additional task-related information can lead to incorrect outputs. 2) SegGPT utilizes a single Transformer encoder structure for both feature extraction and task-specific decoding purposes. This will introduce complexity in the in-context segmentation process and lead to a sub-optimal solution.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Inspired by the segment anything model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx24" title="">KMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>, which solves point ambiguity by outputting multiple different granularity masks simultaneously, we focus solely on the various content of in-context examples and endow the model with the ability to predict multiple output masks for different tasks. In addition, we disentangle the function of the Transformer encoder within SegGPT and deploy a Transformer encoder and decoder to perform feature extraction and task decoding, respectively.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="309" id="S2.F2.g1" src="x2.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">An overview of SINE. SINE is a Transformer encoder-decoder structure, including a frozen pre-trained image encoder, an In-Context Interaction module, and a lightweight Matching Transformer (M-Former) decoder. The top right corner is the self-attention mask of M-Former. The down right corner shows the different task outputs, from identical object, instance, to semantic.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We present SINE, a simple image <span class="ltx_text ltx_font_bold" id="S3.p1.1.1">S</span>egmentation framework via <span class="ltx_text ltx_font_bold" id="S3.p1.1.2">IN</span>-context <span class="ltx_text ltx_font_bold" id="S3.p1.1.3">E</span>xamples.
SINE can effectively address the problem of task ambiguity in in-context segmentation by disentangling the specific task from the in-context example and understanding the semantic concepts of the prompts to output results at different levels of task granularity from the identical object, instance, to semantics.
We elaborate on our method in the following subsections.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The overview of the proposed SINE framework is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S2.F2" title="Figure 2 ‣ 2.2 A Revisit of SegGPT ‣ 2 Preliminary ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">2</span></a>. We build SINE based on the classic Transformer structure <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx48" title="">VSP<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx7" title="">DBK<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite> and introduce some effective designs targeted for the in-context segmentation task, including a frozen pre-trained image encoder, an In-Context Interaction module, and a lightweight Matching Transformer (M-Former) decoder.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.12">We use the frozen pre-trained image encoder to encode <math alttext="\textbf{x}_{r}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2a.cmml">x</mtext><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2a.cmml" xref="S3.SS1.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">x</mtext></ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\textbf{x}_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">x start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{x}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2a.cmml">x</mtext><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2a.cmml" xref="S3.SS1.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">x</mtext></ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\textbf{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, resulting in the reference feature <math alttext="\textbf{F}_{r}\in\mathbb{R}^{C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><msub id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2a.cmml">F</mtext><mi id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">r</mi></msub><mo id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.3.2" xref="S3.SS1.p2.3.m3.1.1.3.3.2.cmml">C</mi><mo id="S3.SS1.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.3.m3.1.1.3.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.3.cmml">H</mi><mo id="S3.SS1.p2.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.3.m3.1.1.3.3.4" xref="S3.SS1.p2.3.m3.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><in id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></in><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2a.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">F</mtext></ci><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">𝑟</ci></apply><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3"><times id="S3.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS1.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.3">𝐻</ci><ci id="S3.SS1.p2.3.m3.1.1.3.3.4.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\textbf{F}_{r}\in\mathbb{R}^{C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">F start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> and target feature<math alttext="\textbf{F}_{t}\in\mathbb{R}^{C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><msub id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.4.m4.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.2.2a.cmml">F</mtext><mi id="S3.SS1.p2.4.m4.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.2" xref="S3.SS1.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.4.m4.1.1.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.cmml"><mi id="S3.SS1.p2.4.m4.1.1.3.3.2" xref="S3.SS1.p2.4.m4.1.1.3.3.2.cmml">C</mi><mo id="S3.SS1.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3.3" xref="S3.SS1.p2.4.m4.1.1.3.3.3.cmml">H</mi><mo id="S3.SS1.p2.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.4.m4.1.1.3.3.4" xref="S3.SS1.p2.4.m4.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><in id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1"></in><apply id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.2a.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2">F</mtext></ci><ci id="S3.SS1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.4.m4.1.1.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3"><times id="S3.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.1"></times><ci id="S3.SS1.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.3">𝐻</ci><ci id="S3.SS1.p2.4.m4.1.1.3.3.4.cmml" xref="S3.SS1.p2.4.m4.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\textbf{F}_{t}\in\mathbb{R}^{C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="H" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_H</annotation></semantics></math>, <math alttext="W" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_W</annotation></semantics></math>, and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_C</annotation></semantics></math> denote the image features’ height, width and the number of channels, respectively.
Inspired by the in-context learning in NLP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx2" title="">BMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite>, we enable SINE to grasp the in-context correlations that coexist between the reference and the target images.
Specifically, we develop an In-Context Interaction module, a component tailored to capture the semantic correlations between <math alttext="\textbf{F}_{r}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2a.cmml">F</mtext><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2a.cmml" xref="S3.SS1.p2.8.m8.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">F</mtext></ci><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\textbf{F}_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">F start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{F}_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><msub id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2a.cmml">F</mtext><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2a.cmml" xref="S3.SS1.p2.9.m9.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">F</mtext></ci><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\textbf{F}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and outputs the enhanced target feature <math alttext="\textbf{F}_{t}^{{}^{\prime}}\in\mathbb{R}^{C\times H\times W}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><mrow id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><msubsup id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.10.m10.1.1.2.2.2" xref="S3.SS1.p2.10.m10.1.1.2.2.2a.cmml">F</mtext><mi id="S3.SS1.p2.10.m10.1.1.2.2.3" xref="S3.SS1.p2.10.m10.1.1.2.2.3.cmml">t</mi><msup id="S3.SS1.p2.10.m10.1.1.2.3" xref="S3.SS1.p2.10.m10.1.1.2.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2.3a" xref="S3.SS1.p2.10.m10.1.1.2.3.cmml"></mi><mo id="S3.SS1.p2.10.m10.1.1.2.3.1" xref="S3.SS1.p2.10.m10.1.1.2.3.1.cmml">′</mo></msup></msubsup><mo id="S3.SS1.p2.10.m10.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.3.2" xref="S3.SS1.p2.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.10.m10.1.1.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.cmml"><mi id="S3.SS1.p2.10.m10.1.1.3.3.2" xref="S3.SS1.p2.10.m10.1.1.3.3.2.cmml">C</mi><mo id="S3.SS1.p2.10.m10.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.10.m10.1.1.3.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.3.cmml">H</mi><mo id="S3.SS1.p2.10.m10.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.10.m10.1.1.3.3.4" xref="S3.SS1.p2.10.m10.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><in id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1"></in><apply id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.2">superscript</csymbol><apply id="S3.SS1.p2.10.m10.1.1.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.2.2.1.cmml" xref="S3.SS1.p2.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.2.2a.cmml" xref="S3.SS1.p2.10.m10.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.10.m10.1.1.2.2.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2.2.2">F</mtext></ci><ci id="S3.SS1.p2.10.m10.1.1.2.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p2.10.m10.1.1.2.3.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3"><ci id="S3.SS1.p2.10.m10.1.1.2.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.2.3.1">′</ci></apply></apply><apply id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.10.m10.1.1.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3"><times id="S3.SS1.p2.10.m10.1.1.3.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.1"></times><ci id="S3.SS1.p2.10.m10.1.1.3.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.2">𝐶</ci><ci id="S3.SS1.p2.10.m10.1.1.3.3.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.3">𝐻</ci><ci id="S3.SS1.p2.10.m10.1.1.3.3.4.cmml" xref="S3.SS1.p2.10.m10.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">\textbf{F}_{t}^{{}^{\prime}}\in\mathbb{R}^{C\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>, the ID queries <math alttext="\textbf{q}_{id}\in\mathbb{R}^{N\times C}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><mrow id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><msub id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.11.m11.1.1.2.2" xref="S3.SS1.p2.11.m11.1.1.2.2a.cmml">q</mtext><mrow id="S3.SS1.p2.11.m11.1.1.2.3" xref="S3.SS1.p2.11.m11.1.1.2.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2.3.2" xref="S3.SS1.p2.11.m11.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p2.11.m11.1.1.2.3.1" xref="S3.SS1.p2.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.11.m11.1.1.2.3.3" xref="S3.SS1.p2.11.m11.1.1.2.3.3.cmml">d</mi></mrow></msub><mo id="S3.SS1.p2.11.m11.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.3.2" xref="S3.SS1.p2.11.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.11.m11.1.1.3.3" xref="S3.SS1.p2.11.m11.1.1.3.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.3.3.2" xref="S3.SS1.p2.11.m11.1.1.3.3.2.cmml">N</mi><mo id="S3.SS1.p2.11.m11.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.11.m11.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.11.m11.1.1.3.3.3" xref="S3.SS1.p2.11.m11.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><in id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1"></in><apply id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.2.1.cmml" xref="S3.SS1.p2.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.2a.cmml" xref="S3.SS1.p2.11.m11.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.11.m11.1.1.2.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2.2">q</mtext></ci><apply id="S3.SS1.p2.11.m11.1.1.2.3.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3"><times id="S3.SS1.p2.11.m11.1.1.2.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3.1"></times><ci id="S3.SS1.p2.11.m11.1.1.2.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3.2">𝑖</ci><ci id="S3.SS1.p2.11.m11.1.1.2.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.2.3.3">𝑑</ci></apply></apply><apply id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.11.m11.1.1.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3.3"><times id="S3.SS1.p2.11.m11.1.1.3.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.3.3.1"></times><ci id="S3.SS1.p2.11.m11.1.1.3.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.3.3.2">𝑁</ci><ci id="S3.SS1.p2.11.m11.1.1.3.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">\textbf{q}_{id}\in\mathbb{R}^{N\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> and the semantic prototypes <math alttext="\textbf{p}_{sem}\in\mathbb{R}^{M\times C}" class="ltx_Math" display="inline" id="S3.SS1.p2.12.m12.1"><semantics id="S3.SS1.p2.12.m12.1a"><mrow id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><msub id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.12.m12.1.1.2.2" xref="S3.SS1.p2.12.m12.1.1.2.2a.cmml">p</mtext><mrow id="S3.SS1.p2.12.m12.1.1.2.3" xref="S3.SS1.p2.12.m12.1.1.2.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2.3.2" xref="S3.SS1.p2.12.m12.1.1.2.3.2.cmml">s</mi><mo id="S3.SS1.p2.12.m12.1.1.2.3.1" xref="S3.SS1.p2.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.12.m12.1.1.2.3.3" xref="S3.SS1.p2.12.m12.1.1.2.3.3.cmml">e</mi><mo id="S3.SS1.p2.12.m12.1.1.2.3.1a" xref="S3.SS1.p2.12.m12.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.12.m12.1.1.2.3.4" xref="S3.SS1.p2.12.m12.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S3.SS1.p2.12.m12.1.1.1" xref="S3.SS1.p2.12.m12.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.3.2" xref="S3.SS1.p2.12.m12.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.12.m12.1.1.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.cmml"><mi id="S3.SS1.p2.12.m12.1.1.3.3.2" xref="S3.SS1.p2.12.m12.1.1.3.3.2.cmml">M</mi><mo id="S3.SS1.p2.12.m12.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.12.m12.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p2.12.m12.1.1.3.3.3" xref="S3.SS1.p2.12.m12.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><in id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1.1"></in><apply id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.2.1.cmml" xref="S3.SS1.p2.12.m12.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.2a.cmml" xref="S3.SS1.p2.12.m12.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p2.12.m12.1.1.2.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2.2">p</mtext></ci><apply id="S3.SS1.p2.12.m12.1.1.2.3.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3"><times id="S3.SS1.p2.12.m12.1.1.2.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.1"></times><ci id="S3.SS1.p2.12.m12.1.1.2.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.2">𝑠</ci><ci id="S3.SS1.p2.12.m12.1.1.2.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.3">𝑒</ci><ci id="S3.SS1.p2.12.m12.1.1.2.3.4.cmml" xref="S3.SS1.p2.12.m12.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.12.m12.1.1.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3"><times id="S3.SS1.p2.12.m12.1.1.3.3.1.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.1"></times><ci id="S3.SS1.p2.12.m12.1.1.3.3.2.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.2">𝑀</ci><ci id="S3.SS1.p2.12.m12.1.1.3.3.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">\textbf{p}_{sem}\in\mathbb{R}^{M\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.12.m12.1d">p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_M × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2">SINE is built as a query-based segmentation model, following DETR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx4" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite> and Mask2Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>. We employ the ID queries <math alttext="\textbf{q}_{id}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2a.cmml">q</mtext><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2a.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">q</mtext></ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><times id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1"></times><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\textbf{q}_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> to identify and locate objects within the target image that have identical counterparts within the reference image. Furthermore, we apply learnable instance queries <math alttext="\textbf{q}_{ins}\in\mathbb{R}^{S\times C}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><msub id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p3.2.m2.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.2.2a.cmml">q</mtext><mrow id="S3.SS1.p3.2.m2.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.2.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2.3.2" xref="S3.SS1.p3.2.m2.1.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p3.2.m2.1.1.2.3.1" xref="S3.SS1.p3.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.2.3.3" xref="S3.SS1.p3.2.m2.1.1.2.3.3.cmml">n</mi><mo id="S3.SS1.p3.2.m2.1.1.2.3.1a" xref="S3.SS1.p3.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.2.3.4" xref="S3.SS1.p3.2.m2.1.1.2.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.2" xref="S3.SS1.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.2.m2.1.1.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS1.p3.2.m2.1.1.3.3.2" xref="S3.SS1.p3.2.m2.1.1.3.3.2.cmml">S</mi><mo id="S3.SS1.p3.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p3.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.2.m2.1.1.3.3.3" xref="S3.SS1.p3.2.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><in id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></in><apply id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.2a.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p3.2.m2.1.1.2.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.2">q</mtext></ci><apply id="S3.SS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3"><times id="S3.SS1.p3.2.m2.1.1.2.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.2.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.2">𝑖</ci><ci id="S3.SS1.p3.2.m2.1.1.2.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.3">𝑛</ci><ci id="S3.SS1.p3.2.m2.1.1.2.3.4.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.2.m2.1.1.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3"><times id="S3.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS1.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3.2">𝑆</ci><ci id="S3.SS1.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\textbf{q}_{ins}\in\mathbb{R}^{S\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">q start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_S × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> to identify and locate objects within the target image that share the same semantic labels in the reference image. The M-Fomer decoder is employed to update these queries and prototypes. Then, a prediction feed-forward network <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx4" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite> is employed to predict ID and instance outputs, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>In-Context Interaction</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.10">The purpose of In-Context Interaction is to complement in-context information and produce correlations between reference and target image features. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S3.F3" title="Figure 3 ‣ 3.2 In-Context Interaction ‣ 3 Method ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">3</span></a>, we use a Mask Pooling process to extract the ID and semantic tokens, represented as <math alttext="\textbf{t}_{id}\in\mathbb{R}^{N\times C}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><msub id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2a.cmml">t</mtext><mrow id="S3.SS2.p1.1.m1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.1.m1.1.1.2.3.1" xref="S3.SS2.p1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.2.3.3" xref="S3.SS2.p1.1.m1.1.1.2.3.3.cmml">d</mi></mrow></msub><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">N</mi><mo id="S3.SS2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.2a.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">t</mtext></ci><apply id="S3.SS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3"><times id="S3.SS2.p1.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3.3">𝑑</ci></apply></apply><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\textbf{t}_{id}\in\mathbb{R}^{N\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">t start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\textbf{t}_{sem}\in\mathbb{R}^{M\times C}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2a.cmml">t</mtext><mrow id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.3.2" xref="S3.SS2.p1.2.m2.1.1.2.3.2.cmml">s</mi><mo id="S3.SS2.p1.2.m2.1.1.2.3.1" xref="S3.SS2.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.3.3" xref="S3.SS2.p1.2.m2.1.1.2.3.3.cmml">e</mi><mo id="S3.SS2.p1.2.m2.1.1.2.3.1a" xref="S3.SS2.p1.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.2.3.4" xref="S3.SS2.p1.2.m2.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.3.2" xref="S3.SS2.p1.2.m2.1.1.3.3.2.cmml">M</mi><mo id="S3.SS2.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.2.m2.1.1.3.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><in id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></in><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2a.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">t</mtext></ci><apply id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3"><times id="S3.SS2.p1.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.2">𝑠</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.4.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3"><times id="S3.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.2">𝑀</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\textbf{t}_{sem}\in\mathbb{R}^{M\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">t start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_M × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>. Specifically, we transfer <math alttext="\textbf{m}_{r}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2a.cmml">m</mtext><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2a.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">m</mtext></ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\textbf{m}_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">m start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> into ID masks <math alttext="\textbf{m}_{id}\in\mathbb{R}^{N\times H\times W}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msub id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2a.cmml">m</mtext><mrow id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.3.2" xref="S3.SS2.p1.4.m4.1.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p1.4.m4.1.1.2.3.1" xref="S3.SS2.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.4.m4.1.1.2.3.3" xref="S3.SS2.p1.4.m4.1.1.2.3.3.cmml">d</mi></mrow></msub><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.3.2" xref="S3.SS2.p1.4.m4.1.1.3.3.2.cmml">N</mi><mo id="S3.SS2.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.4.m4.1.1.3.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.3.cmml">H</mi><mo id="S3.SS2.p1.4.m4.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.4.m4.1.1.3.3.4" xref="S3.SS2.p1.4.m4.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><in id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></in><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2a.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">m</mtext></ci><apply id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3"><times id="S3.SS2.p1.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3.3">𝑑</ci></apply></apply><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3"><times id="S3.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.1"></times><ci id="S3.SS2.p1.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.2">𝑁</ci><ci id="S3.SS2.p1.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.3">𝐻</ci><ci id="S3.SS2.p1.4.m4.1.1.3.3.4.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\textbf{m}_{id}\in\mathbb{R}^{N\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">m start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_N × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> by assigning different ID labels for each mask and semantic masks <math alttext="\textbf{m}_{sem}\in\mathbb{R}^{M\times H\times W}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><msub id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.5.m5.1.1.2.2" xref="S3.SS2.p1.5.m5.1.1.2.2a.cmml">m</mtext><mrow id="S3.SS2.p1.5.m5.1.1.2.3" xref="S3.SS2.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2.3.2" xref="S3.SS2.p1.5.m5.1.1.2.3.2.cmml">s</mi><mo id="S3.SS2.p1.5.m5.1.1.2.3.1" xref="S3.SS2.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.2.3.3" xref="S3.SS2.p1.5.m5.1.1.2.3.3.cmml">e</mi><mo id="S3.SS2.p1.5.m5.1.1.2.3.1a" xref="S3.SS2.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.5.m5.1.1.2.3.4" xref="S3.SS2.p1.5.m5.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.3.2" xref="S3.SS2.p1.5.m5.1.1.3.3.2.cmml">M</mi><mo id="S3.SS2.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.3.cmml">H</mi><mo id="S3.SS2.p1.5.m5.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.5.m5.1.1.3.3.4" xref="S3.SS2.p1.5.m5.1.1.3.3.4.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><in id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></in><apply id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.2a.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.2">m</mtext></ci><apply id="S3.SS2.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3"><times id="S3.SS2.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.2">𝑠</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.3">𝑒</ci><ci id="S3.SS2.p1.5.m5.1.1.2.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.2.3.4">𝑚</ci></apply></apply><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3"><times id="S3.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.1"></times><ci id="S3.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.2">𝑀</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.3">𝐻</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.4.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3.4">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\textbf{m}_{sem}\in\mathbb{R}^{M\times H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">m start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_M × italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> by merging the masks with same category label, where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_N</annotation></semantics></math> and <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_M</annotation></semantics></math> are the numbers of ID and semantic masks. Then, we use these masks to pool over the reference feature <math alttext="\textbf{F}_{r}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2a.cmml">F</mtext><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2a.cmml" xref="S3.SS2.p1.8.m8.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">F</mtext></ci><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\textbf{F}_{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">F start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and obtain <math alttext="\textbf{t}_{id}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2a.cmml">t</mtext><mrow id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.9.m9.1.1.3.1" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2a.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">t</mtext></ci><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><times id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.1"></times><ci id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">𝑖</ci><ci id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">\textbf{t}_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">t start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{t}_{sem}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.1"><semantics id="S3.SS2.p1.10.m10.1a"><msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2a.cmml">t</mtext><mrow id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml"><mi id="S3.SS2.p1.10.m10.1.1.3.2" xref="S3.SS2.p1.10.m10.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p1.10.m10.1.1.3.1" xref="S3.SS2.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.10.m10.1.1.3.3" xref="S3.SS2.p1.10.m10.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p1.10.m10.1.1.3.1a" xref="S3.SS2.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.10.m10.1.1.3.4" xref="S3.SS2.p1.10.m10.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2a.cmml" xref="S3.SS2.p1.10.m10.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">t</mtext></ci><apply id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3"><times id="S3.SS2.p1.10.m10.1.1.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.3.1"></times><ci id="S3.SS2.p1.10.m10.1.1.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.3.2">𝑠</ci><ci id="S3.SS2.p1.10.m10.1.1.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3">𝑒</ci><ci id="S3.SS2.p1.10.m10.1.1.3.4.cmml" xref="S3.SS2.p1.10.m10.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\textbf{t}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">t start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, the pooling process similar to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx14" title="">GGCL22</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="288" id="S3.F3.g1" src="x3.png" width="705"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Illustration of the In-Context Interaction module. This module aims to complement in-context information between reference and target. The ID and semantic tokens are extracted by the Mask Pooling. The enhanced target feature, the ID queries, and the semantic prototypes are outputted by the In-Context Fusion module.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.8">We introduce an In-Context Fusion module to enable the in-context correlation between the reference and target features. The process of this module can be summarized as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\left&lt;\textbf{q}_{id},\textbf{p}_{sem},\textbf{F}_{t}^{{}^{\prime%
}}\right&gt;=InContextFusion\left(\textbf{t}_{id},\textbf{t}_{sem},\textbf{F}_{t}%
;\theta\right),\end{split}" class="ltx_Math" display="block" id="S3.E1.m1.42"><semantics id="S3.E1.m1.42a"><mtable displaystyle="true" id="S3.E1.m1.42.42.2"><mtr id="S3.E1.m1.42.42.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.42.42.2b"><mrow id="S3.E1.m1.42.42.2.41.41.41.41"><mrow id="S3.E1.m1.42.42.2.41.41.41.41.1"><mrow id="S3.E1.m1.42.42.2.41.41.41.41.1.3.3"><mo id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.41.41.1.1.1.cmml">⟨</mo><msub id="S3.E1.m1.42.42.2.41.41.41.41.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2a.cmml">q</mtext><mrow id="S3.E1.m1.3.3.3.3.3.3.1" xref="S3.E1.m1.3.3.3.3.3.3.1.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.1.2" xref="S3.E1.m1.3.3.3.3.3.3.1.2.cmml">i</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.3.3.3.3.1.3" xref="S3.E1.m1.3.3.3.3.3.3.1.3.cmml">d</mi></mrow></msub><mo id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.41.41.1.1.1.cmml">,</mo><msub id="S3.E1.m1.42.42.2.41.41.41.41.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.5.5.5.5.5.5a.cmml">p</mtext><mrow id="S3.E1.m1.6.6.6.6.6.6.1" xref="S3.E1.m1.6.6.6.6.6.6.1.cmml"><mi id="S3.E1.m1.6.6.6.6.6.6.1.2" xref="S3.E1.m1.6.6.6.6.6.6.1.2.cmml">s</mi><mo id="S3.E1.m1.6.6.6.6.6.6.1.1" xref="S3.E1.m1.6.6.6.6.6.6.1.1.cmml">⁢</mo><mi id="S3.E1.m1.6.6.6.6.6.6.1.3" xref="S3.E1.m1.6.6.6.6.6.6.1.3.cmml">e</mi><mo id="S3.E1.m1.6.6.6.6.6.6.1.1a" xref="S3.E1.m1.6.6.6.6.6.6.1.1.cmml">⁢</mo><mi id="S3.E1.m1.6.6.6.6.6.6.1.4" xref="S3.E1.m1.6.6.6.6.6.6.1.4.cmml">m</mi></mrow></msub><mo id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.41.41.1.1.1.cmml">,</mo><msubsup id="S3.E1.m1.42.42.2.41.41.41.41.1.3.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.8.8.8.8.8.8" xref="S3.E1.m1.8.8.8.8.8.8a.cmml">F</mtext><mi id="S3.E1.m1.9.9.9.9.9.9.1" xref="S3.E1.m1.9.9.9.9.9.9.1.cmml">t</mi><msup id="S3.E1.m1.10.10.10.10.10.10.1" xref="S3.E1.m1.10.10.10.10.10.10.1.cmml"><mi id="S3.E1.m1.10.10.10.10.10.10.1a" xref="S3.E1.m1.10.10.10.10.10.10.1.cmml"></mi><mo id="S3.E1.m1.10.10.10.10.10.10.1.1" xref="S3.E1.m1.10.10.10.10.10.10.1.1.cmml">′</mo></msup></msubsup><mo id="S3.E1.m1.11.11.11.11.11.11" xref="S3.E1.m1.41.41.1.1.1.cmml">⟩</mo></mrow><mo id="S3.E1.m1.12.12.12.12.12.12" xref="S3.E1.m1.12.12.12.12.12.12.cmml">=</mo><mrow id="S3.E1.m1.42.42.2.41.41.41.41.1.6"><mi id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.13.13.13.13.13.13.cmml">I</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.14.14.14.14.14.14" xref="S3.E1.m1.14.14.14.14.14.14.cmml">n</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4a" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.15.15.15.15.15.15" xref="S3.E1.m1.15.15.15.15.15.15.cmml">C</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4b" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.16.16.16.16.16.16" xref="S3.E1.m1.16.16.16.16.16.16.cmml">o</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4c" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.17.17.17.17.17.17" xref="S3.E1.m1.17.17.17.17.17.17.cmml">n</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4d" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.18.18.18.18.18.18" xref="S3.E1.m1.18.18.18.18.18.18.cmml">t</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4e" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.19.19.19.19.19.19" xref="S3.E1.m1.19.19.19.19.19.19.cmml">e</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4f" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.20.20.20.20.20.20" xref="S3.E1.m1.20.20.20.20.20.20.cmml">x</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4g" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.21.21.21.21.21.21" xref="S3.E1.m1.21.21.21.21.21.21.cmml">t</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4h" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.22.22.22.22.22.22" xref="S3.E1.m1.22.22.22.22.22.22.cmml">F</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4i" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.23.23.23.23.23.23" xref="S3.E1.m1.23.23.23.23.23.23.cmml">u</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4j" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.24.24.24.24.24.24" xref="S3.E1.m1.24.24.24.24.24.24.cmml">s</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4k" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.25.25.25.25.25.25" xref="S3.E1.m1.25.25.25.25.25.25.cmml">i</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4l" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.26.26.26.26.26.26" xref="S3.E1.m1.26.26.26.26.26.26.cmml">o</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4m" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mi id="S3.E1.m1.27.27.27.27.27.27" xref="S3.E1.m1.27.27.27.27.27.27.cmml">n</mi><mo id="S3.E1.m1.42.42.2.41.41.41.41.1.6.4n" xref="S3.E1.m1.41.41.1.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.42.42.2.41.41.41.41.1.6.3.3"><mo id="S3.E1.m1.28.28.28.28.28.28" xref="S3.E1.m1.41.41.1.1.1.cmml">(</mo><msub id="S3.E1.m1.42.42.2.41.41.41.41.1.4.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.29.29.29.29.29.29" xref="S3.E1.m1.29.29.29.29.29.29a.cmml">t</mtext><mrow id="S3.E1.m1.30.30.30.30.30.30.1" xref="S3.E1.m1.30.30.30.30.30.30.1.cmml"><mi id="S3.E1.m1.30.30.30.30.30.30.1.2" xref="S3.E1.m1.30.30.30.30.30.30.1.2.cmml">i</mi><mo id="S3.E1.m1.30.30.30.30.30.30.1.1" xref="S3.E1.m1.30.30.30.30.30.30.1.1.cmml">⁢</mo><mi id="S3.E1.m1.30.30.30.30.30.30.1.3" xref="S3.E1.m1.30.30.30.30.30.30.1.3.cmml">d</mi></mrow></msub><mo id="S3.E1.m1.31.31.31.31.31.31" xref="S3.E1.m1.41.41.1.1.1.cmml">,</mo><msub id="S3.E1.m1.42.42.2.41.41.41.41.1.5.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.32.32.32.32.32.32" xref="S3.E1.m1.32.32.32.32.32.32a.cmml">t</mtext><mrow id="S3.E1.m1.33.33.33.33.33.33.1" xref="S3.E1.m1.33.33.33.33.33.33.1.cmml"><mi id="S3.E1.m1.33.33.33.33.33.33.1.2" xref="S3.E1.m1.33.33.33.33.33.33.1.2.cmml">s</mi><mo id="S3.E1.m1.33.33.33.33.33.33.1.1" xref="S3.E1.m1.33.33.33.33.33.33.1.1.cmml">⁢</mo><mi id="S3.E1.m1.33.33.33.33.33.33.1.3" xref="S3.E1.m1.33.33.33.33.33.33.1.3.cmml">e</mi><mo id="S3.E1.m1.33.33.33.33.33.33.1.1a" xref="S3.E1.m1.33.33.33.33.33.33.1.1.cmml">⁢</mo><mi id="S3.E1.m1.33.33.33.33.33.33.1.4" xref="S3.E1.m1.33.33.33.33.33.33.1.4.cmml">m</mi></mrow></msub><mo id="S3.E1.m1.34.34.34.34.34.34" xref="S3.E1.m1.41.41.1.1.1.cmml">,</mo><msub id="S3.E1.m1.42.42.2.41.41.41.41.1.6.3.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.35.35.35.35.35.35" xref="S3.E1.m1.35.35.35.35.35.35a.cmml">F</mtext><mi id="S3.E1.m1.36.36.36.36.36.36.1" xref="S3.E1.m1.36.36.36.36.36.36.1.cmml">t</mi></msub><mo id="S3.E1.m1.37.37.37.37.37.37" xref="S3.E1.m1.41.41.1.1.1.cmml">;</mo><mi id="S3.E1.m1.38.38.38.38.38.38" xref="S3.E1.m1.38.38.38.38.38.38.cmml">θ</mi><mo id="S3.E1.m1.39.39.39.39.39.39" xref="S3.E1.m1.41.41.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.40.40.40.40.40.40" xref="S3.E1.m1.41.41.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.42b"><apply id="S3.E1.m1.41.41.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><eq id="S3.E1.m1.12.12.12.12.12.12.cmml" xref="S3.E1.m1.12.12.12.12.12.12"></eq><list id="S3.E1.m1.41.41.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.41.41.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2a.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">q</mtext></ci><apply id="S3.E1.m1.3.3.3.3.3.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1"><times id="S3.E1.m1.3.3.3.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1"></times><ci id="S3.E1.m1.3.3.3.3.3.3.1.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.2">𝑖</ci><ci id="S3.E1.m1.3.3.3.3.3.3.1.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.3">𝑑</ci></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.5.5.5.5a.cmml" xref="S3.E1.m1.5.5.5.5.5.5"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.5.5.5.5.5.5.cmml" xref="S3.E1.m1.5.5.5.5.5.5">p</mtext></ci><apply id="S3.E1.m1.6.6.6.6.6.6.1.cmml" xref="S3.E1.m1.6.6.6.6.6.6.1"><times id="S3.E1.m1.6.6.6.6.6.6.1.1.cmml" xref="S3.E1.m1.6.6.6.6.6.6.1.1"></times><ci id="S3.E1.m1.6.6.6.6.6.6.1.2.cmml" xref="S3.E1.m1.6.6.6.6.6.6.1.2">𝑠</ci><ci id="S3.E1.m1.6.6.6.6.6.6.1.3.cmml" xref="S3.E1.m1.6.6.6.6.6.6.1.3">𝑒</ci><ci id="S3.E1.m1.6.6.6.6.6.6.1.4.cmml" xref="S3.E1.m1.6.6.6.6.6.6.1.4">𝑚</ci></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.41.41.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.3.3.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.8.8.8.8.8.8a.cmml" xref="S3.E1.m1.8.8.8.8.8.8"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.8.8.8.8.8.8.cmml" xref="S3.E1.m1.8.8.8.8.8.8">F</mtext></ci><ci id="S3.E1.m1.9.9.9.9.9.9.1.cmml" xref="S3.E1.m1.9.9.9.9.9.9.1">𝑡</ci></apply><apply id="S3.E1.m1.10.10.10.10.10.10.1.cmml" xref="S3.E1.m1.10.10.10.10.10.10.1"><ci id="S3.E1.m1.10.10.10.10.10.10.1.1.cmml" xref="S3.E1.m1.10.10.10.10.10.10.1.1">′</ci></apply></apply></list><apply id="S3.E1.m1.41.41.1.1.1.6.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><times id="S3.E1.m1.41.41.1.1.1.6.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.13.13.13.13.13.13.cmml" xref="S3.E1.m1.13.13.13.13.13.13">𝐼</ci><ci id="S3.E1.m1.14.14.14.14.14.14.cmml" xref="S3.E1.m1.14.14.14.14.14.14">𝑛</ci><ci id="S3.E1.m1.15.15.15.15.15.15.cmml" xref="S3.E1.m1.15.15.15.15.15.15">𝐶</ci><ci id="S3.E1.m1.16.16.16.16.16.16.cmml" xref="S3.E1.m1.16.16.16.16.16.16">𝑜</ci><ci id="S3.E1.m1.17.17.17.17.17.17.cmml" xref="S3.E1.m1.17.17.17.17.17.17">𝑛</ci><ci id="S3.E1.m1.18.18.18.18.18.18.cmml" xref="S3.E1.m1.18.18.18.18.18.18">𝑡</ci><ci id="S3.E1.m1.19.19.19.19.19.19.cmml" xref="S3.E1.m1.19.19.19.19.19.19">𝑒</ci><ci id="S3.E1.m1.20.20.20.20.20.20.cmml" xref="S3.E1.m1.20.20.20.20.20.20">𝑥</ci><ci id="S3.E1.m1.21.21.21.21.21.21.cmml" xref="S3.E1.m1.21.21.21.21.21.21">𝑡</ci><ci id="S3.E1.m1.22.22.22.22.22.22.cmml" xref="S3.E1.m1.22.22.22.22.22.22">𝐹</ci><ci id="S3.E1.m1.23.23.23.23.23.23.cmml" xref="S3.E1.m1.23.23.23.23.23.23">𝑢</ci><ci id="S3.E1.m1.24.24.24.24.24.24.cmml" xref="S3.E1.m1.24.24.24.24.24.24">𝑠</ci><ci id="S3.E1.m1.25.25.25.25.25.25.cmml" xref="S3.E1.m1.25.25.25.25.25.25">𝑖</ci><ci id="S3.E1.m1.26.26.26.26.26.26.cmml" xref="S3.E1.m1.26.26.26.26.26.26">𝑜</ci><ci id="S3.E1.m1.27.27.27.27.27.27.cmml" xref="S3.E1.m1.27.27.27.27.27.27">𝑛</ci><vector id="S3.E1.m1.41.41.1.1.1.6.3.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><apply id="S3.E1.m1.41.41.1.1.1.4.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.4.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.29.29.29.29.29.29a.cmml" xref="S3.E1.m1.29.29.29.29.29.29"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.29.29.29.29.29.29.cmml" xref="S3.E1.m1.29.29.29.29.29.29">t</mtext></ci><apply id="S3.E1.m1.30.30.30.30.30.30.1.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1"><times id="S3.E1.m1.30.30.30.30.30.30.1.1.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1.1"></times><ci id="S3.E1.m1.30.30.30.30.30.30.1.2.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1.2">𝑖</ci><ci id="S3.E1.m1.30.30.30.30.30.30.1.3.cmml" xref="S3.E1.m1.30.30.30.30.30.30.1.3">𝑑</ci></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.5.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.5.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.32.32.32.32.32.32a.cmml" xref="S3.E1.m1.32.32.32.32.32.32"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.32.32.32.32.32.32.cmml" xref="S3.E1.m1.32.32.32.32.32.32">t</mtext></ci><apply id="S3.E1.m1.33.33.33.33.33.33.1.cmml" xref="S3.E1.m1.33.33.33.33.33.33.1"><times id="S3.E1.m1.33.33.33.33.33.33.1.1.cmml" xref="S3.E1.m1.33.33.33.33.33.33.1.1"></times><ci id="S3.E1.m1.33.33.33.33.33.33.1.2.cmml" xref="S3.E1.m1.33.33.33.33.33.33.1.2">𝑠</ci><ci id="S3.E1.m1.33.33.33.33.33.33.1.3.cmml" xref="S3.E1.m1.33.33.33.33.33.33.1.3">𝑒</ci><ci id="S3.E1.m1.33.33.33.33.33.33.1.4.cmml" xref="S3.E1.m1.33.33.33.33.33.33.1.4">𝑚</ci></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.6.3.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.6.3.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.35.35.35.35.35.35a.cmml" xref="S3.E1.m1.35.35.35.35.35.35"><mtext class="ltx_mathvariant_bold" id="S3.E1.m1.35.35.35.35.35.35.cmml" xref="S3.E1.m1.35.35.35.35.35.35">F</mtext></ci><ci id="S3.E1.m1.36.36.36.36.36.36.1.cmml" xref="S3.E1.m1.36.36.36.36.36.36.1">𝑡</ci></apply><ci id="S3.E1.m1.38.38.38.38.38.38.cmml" xref="S3.E1.m1.38.38.38.38.38.38">𝜃</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.42c">\begin{split}\left&lt;\textbf{q}_{id},\textbf{p}_{sem},\textbf{F}_{t}^{{}^{\prime%
}}\right&gt;=InContextFusion\left(\textbf{t}_{id},\textbf{t}_{sem},\textbf{F}_{t}%
;\theta\right),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.42d">start_ROW start_CELL ⟨ q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT , p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT , F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ⟩ = italic_I italic_n italic_C italic_o italic_n italic_t italic_e italic_x italic_t italic_F italic_u italic_s italic_i italic_o italic_n ( t start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT , t start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT , F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; italic_θ ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.7">where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_θ</annotation></semantics></math> is the parameters of the In-Context Fusion.
The module is a Transformer block <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx48" title="">VSP<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx4" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite> including a self-attention, cross-attention, and a feed-forward network. The tokens (<math alttext="\textbf{t}_{id}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2a.cmml">t</mtext><mrow id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p2.2.m2.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2a.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">t</mtext></ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><times id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.1"></times><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\textbf{t}_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">t start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{t}_{sem}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2a.cmml">t</mtext><mrow id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p2.3.m3.1.1.3.1" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p2.3.m3.1.1.3.1a" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.3.4" xref="S3.SS2.p2.3.m3.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2a.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">t</mtext></ci><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><times id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">𝑠</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝑒</ci><ci id="S3.SS2.p2.3.m3.1.1.3.4.cmml" xref="S3.SS2.p2.3.m3.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\textbf{t}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">t start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math>) and target feature (<math alttext="\textbf{F}_{t}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2a.cmml">F</mtext><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2a.cmml" xref="S3.SS2.p2.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">F</mtext></ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\textbf{F}_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>) are fused by this shared module, where they are used as keys and values for each other in the cross-attention, and the enhanced target feature <math alttext="\textbf{F}_{t}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msubsup id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.5.m5.1.1.2.2" xref="S3.SS2.p2.5.m5.1.1.2.2a.cmml">F</mtext><mi id="S3.SS2.p2.5.m5.1.1.2.3" xref="S3.SS2.p2.5.m5.1.1.2.3.cmml">t</mi><msup id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.3a" xref="S3.SS2.p2.5.m5.1.1.3.cmml"></mi><mo id="S3.SS2.p2.5.m5.1.1.3.1" xref="S3.SS2.p2.5.m5.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">superscript</csymbol><apply id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.2a.cmml" xref="S3.SS2.p2.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.5.m5.1.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2.2">F</mtext></ci><ci id="S3.SS2.p2.5.m5.1.1.2.3.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3"><ci id="S3.SS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\textbf{F}_{t}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, the ID queries <math alttext="\textbf{q}_{id}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><msub id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2a.cmml">q</mtext><mrow id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml"><mi id="S3.SS2.p2.6.m6.1.1.3.2" xref="S3.SS2.p2.6.m6.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p2.6.m6.1.1.3.1" xref="S3.SS2.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.6.m6.1.1.3.3" xref="S3.SS2.p2.6.m6.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2a.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">q</mtext></ci><apply id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3"><times id="S3.SS2.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.p2.6.m6.1.1.3.1"></times><ci id="S3.SS2.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.p2.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS2.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\textbf{q}_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and the semantic prototypes <math alttext="\textbf{p}_{sem}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2a.cmml">p</mtext><mrow id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.3.2.cmml">s</mi><mo id="S3.SS2.p2.7.m7.1.1.3.1" xref="S3.SS2.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.7.m7.1.1.3.3" xref="S3.SS2.p2.7.m7.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p2.7.m7.1.1.3.1a" xref="S3.SS2.p2.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.7.m7.1.1.3.4" xref="S3.SS2.p2.7.m7.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2a.cmml" xref="S3.SS2.p2.7.m7.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">p</mtext></ci><apply id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3"><times id="S3.SS2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.1"></times><ci id="S3.SS2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2">𝑠</ci><ci id="S3.SS2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3">𝑒</ci><ci id="S3.SS2.p2.7.m7.1.1.3.4.cmml" xref="S3.SS2.p2.7.m7.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\textbf{p}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math> can be obtained.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Matching Transformer</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">M-Former aims to decode the enhanced target feature into different task outputs, from identical object, instance, to semantic, and enables comprehensive and efficient performance for in-context segmentation. Thus, in addition to the ID queries <math alttext="\textbf{q}_{id}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2a.cmml">q</mtext><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2a.cmml" xref="S3.SS3.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">q</mtext></ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><times id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\textbf{q}_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and the semantic prototypes <math alttext="\textbf{p}_{sem}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2a.cmml">p</mtext><mrow id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">s</mi><mo id="S3.SS3.p1.2.m2.1.1.3.1" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.3.3.cmml">e</mi><mo id="S3.SS3.p1.2.m2.1.1.3.1a" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.3.4" xref="S3.SS3.p1.2.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2a.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">p</mtext></ci><apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><times id="S3.SS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.3.1"></times><ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">𝑠</ci><ci id="S3.SS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS3.p1.2.m2.1.1.3.4.cmml" xref="S3.SS3.p1.2.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\textbf{p}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, we also incorporate a set of learnable instance queries <math alttext="\textbf{q}_{ins}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2a.cmml">q</mtext><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p1.3.m3.1.1.3.1" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">n</mi><mo id="S3.SS3.p1.3.m3.1.1.3.1a" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p1.3.m3.1.1.3.4" xref="S3.SS3.p1.3.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2a.cmml" xref="S3.SS3.p1.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">q</mtext></ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><times id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1"></times><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">𝑛</ci><ci id="S3.SS3.p1.3.m3.1.1.3.4.cmml" xref="S3.SS3.p1.3.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\textbf{q}_{ins}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">q start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT</annotation></semantics></math> for predicting instances.
To perform in-context segmentation and eliminate task ambiguity effectively,
the design of M-Former needs to consider 1) the semantic prototypes need to assign semantic information to the instance queries, 2) avoiding coarse-grained semantic prototypes to contaminate fine-grained ID queries, and 3) the queries interact with the target feature.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.6">Encouraged by the above analyses, the M-Former is implemented by a dual-path Transformer decoder sharing the self-attention layers. One path is utilized to interact <math alttext="\textbf{F}_{t}^{{}^{\prime}}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msubsup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2a.cmml">F</mtext><mi id="S3.SS3.p2.1.m1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.2.3.cmml">t</mi><msup id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3a" xref="S3.SS3.p2.1.m1.1.1.3.cmml"></mi><mo id="S3.SS3.p2.1.m1.1.1.3.1" xref="S3.SS3.p2.1.m1.1.1.3.1.cmml">′</mo></msup></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.2a.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">F</mtext></ci><ci id="S3.SS3.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><ci id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.1">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\textbf{F}_{t}^{{}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and queries (<math alttext="\textbf{q}_{id}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2a.cmml">q</mtext><mrow id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2a.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">q</mtext></ci><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><times id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\textbf{q}_{id}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\textbf{q}_{ins}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2a.cmml">q</mtext><mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.3.m3.1.1.3.1" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">n</mi><mo id="S3.SS3.p2.3.m3.1.1.3.1a" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.3.m3.1.1.3.4" xref="S3.SS3.p2.3.m3.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2a.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">q</mtext></ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><times id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.1"></times><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">𝑛</ci><ci id="S3.SS3.p2.3.m3.1.1.3.4.cmml" xref="S3.SS3.p2.3.m3.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\textbf{q}_{ins}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">q start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT</annotation></semantics></math>) for extracting correlated feature with the in-context example from the target image. This path consists of a series of self-attention, masked cross-attention <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>, and feed-forward network. The second path is employed to enhance the semantic prototypes <math alttext="\textbf{p}_{sem}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2a.cmml">p</mtext><mrow id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">s</mi><mo id="S3.SS3.p2.4.m4.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">e</mi><mo id="S3.SS3.p2.4.m4.1.1.3.1a" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.4.m4.1.1.3.4" xref="S3.SS3.p2.4.m4.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2a.cmml" xref="S3.SS3.p2.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">p</mtext></ci><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><times id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3.1"></times><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">𝑒</ci><ci id="S3.SS3.p2.4.m4.1.1.3.4.cmml" xref="S3.SS3.p2.4.m4.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\textbf{p}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math> for a more accurate matching. The two paths share the self-attention layers for assign semantics from <math alttext="\textbf{p}_{sem}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2a.cmml">p</mtext><mrow id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml"><mi id="S3.SS3.p2.5.m5.1.1.3.2" xref="S3.SS3.p2.5.m5.1.1.3.2.cmml">s</mi><mo id="S3.SS3.p2.5.m5.1.1.3.1" xref="S3.SS3.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m5.1.1.3.3" xref="S3.SS3.p2.5.m5.1.1.3.3.cmml">e</mi><mo id="S3.SS3.p2.5.m5.1.1.3.1a" xref="S3.SS3.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.5.m5.1.1.3.4" xref="S3.SS3.p2.5.m5.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2a.cmml" xref="S3.SS3.p2.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">p</mtext></ci><apply id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><times id="S3.SS3.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3.1"></times><ci id="S3.SS3.p2.5.m5.1.1.3.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.5.m5.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3">𝑒</ci><ci id="S3.SS3.p2.5.m5.1.1.3.4.cmml" xref="S3.SS3.p2.5.m5.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\textbf{p}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\textbf{q}_{ins}" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><msub id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2a.cmml">q</mtext><mrow id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.p2.6.m6.1.1.3.2" xref="S3.SS3.p2.6.m6.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p2.6.m6.1.1.3.1" xref="S3.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m6.1.1.3.3" xref="S3.SS3.p2.6.m6.1.1.3.3.cmml">n</mi><mo id="S3.SS3.p2.6.m6.1.1.3.1a" xref="S3.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.6.m6.1.1.3.4" xref="S3.SS3.p2.6.m6.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2a.cmml" xref="S3.SS3.p2.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">q</mtext></ci><apply id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3"><times id="S3.SS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.3.1"></times><ci id="S3.SS3.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS3.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3.3">𝑛</ci><ci id="S3.SS3.p2.6.m6.1.1.3.4.cmml" xref="S3.SS3.p2.6.m6.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\textbf{q}_{ins}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">q start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT</annotation></semantics></math>. To avoid semantic prototypes contaminating fine-grained ID queries, we apply a self-attention mask within the shared self-attention layers as shown in at the top right corner of Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S2.F2" title="Figure 2 ‣ 2.2 A Revisit of SegGPT ‣ 2 Preliminary ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">2</span></a>. M-Former has N blocks. The process of M-Former can be summarized as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\left&lt;\textbf{q}_{id}^{l},\textbf{q}_{ins}^{l},\textbf{p}_{sem}^{%
l}\right&gt;=MFormer_{l}\left(\textbf{q}_{id}^{l-1},\textbf{q}_{ins}^{l-1},%
\textbf{p}_{sem}^{l-1};\theta^{l},\textbf{F}_{t}^{{}^{\prime}}\right),\end{split}" class="ltx_Math" display="block" id="S3.E2.m1.45"><semantics id="S3.E2.m1.45a"><mtable displaystyle="true" id="S3.E2.m1.45.45.2"><mtr id="S3.E2.m1.45.45.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.45.45.2b"><mrow id="S3.E2.m1.45.45.2.44.44.44.44"><mrow id="S3.E2.m1.45.45.2.44.44.44.44.1"><mrow id="S3.E2.m1.45.45.2.44.44.44.44.1.3.3"><mo id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.44.44.1.1.1.cmml">⟨</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2a.cmml">q</mtext><mrow id="S3.E2.m1.3.3.3.3.3.3.1" xref="S3.E2.m1.3.3.3.3.3.3.1.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.cmml">i</mi><mo id="S3.E2.m1.3.3.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.3.3.3.1.3" xref="S3.E2.m1.3.3.3.3.3.3.1.3.cmml">d</mi></mrow><mi id="S3.E2.m1.4.4.4.4.4.4.1" xref="S3.E2.m1.4.4.4.4.4.4.1.cmml">l</mi></msubsup><mo id="S3.E2.m1.5.5.5.5.5.5" xref="S3.E2.m1.44.44.1.1.1.cmml">,</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.6.6.6.6.6.6" xref="S3.E2.m1.6.6.6.6.6.6a.cmml">q</mtext><mrow id="S3.E2.m1.7.7.7.7.7.7.1" xref="S3.E2.m1.7.7.7.7.7.7.1.cmml"><mi id="S3.E2.m1.7.7.7.7.7.7.1.2" xref="S3.E2.m1.7.7.7.7.7.7.1.2.cmml">i</mi><mo id="S3.E2.m1.7.7.7.7.7.7.1.1" xref="S3.E2.m1.7.7.7.7.7.7.1.1.cmml">⁢</mo><mi id="S3.E2.m1.7.7.7.7.7.7.1.3" xref="S3.E2.m1.7.7.7.7.7.7.1.3.cmml">n</mi><mo id="S3.E2.m1.7.7.7.7.7.7.1.1a" xref="S3.E2.m1.7.7.7.7.7.7.1.1.cmml">⁢</mo><mi id="S3.E2.m1.7.7.7.7.7.7.1.4" xref="S3.E2.m1.7.7.7.7.7.7.1.4.cmml">s</mi></mrow><mi id="S3.E2.m1.8.8.8.8.8.8.1" xref="S3.E2.m1.8.8.8.8.8.8.1.cmml">l</mi></msubsup><mo id="S3.E2.m1.9.9.9.9.9.9" xref="S3.E2.m1.44.44.1.1.1.cmml">,</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.3.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.10.10.10.10.10.10" xref="S3.E2.m1.10.10.10.10.10.10a.cmml">p</mtext><mrow id="S3.E2.m1.11.11.11.11.11.11.1" xref="S3.E2.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E2.m1.11.11.11.11.11.11.1.2" xref="S3.E2.m1.11.11.11.11.11.11.1.2.cmml">s</mi><mo id="S3.E2.m1.11.11.11.11.11.11.1.1" xref="S3.E2.m1.11.11.11.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E2.m1.11.11.11.11.11.11.1.3" xref="S3.E2.m1.11.11.11.11.11.11.1.3.cmml">e</mi><mo id="S3.E2.m1.11.11.11.11.11.11.1.1a" xref="S3.E2.m1.11.11.11.11.11.11.1.1.cmml">⁢</mo><mi id="S3.E2.m1.11.11.11.11.11.11.1.4" xref="S3.E2.m1.11.11.11.11.11.11.1.4.cmml">m</mi></mrow><mi id="S3.E2.m1.12.12.12.12.12.12.1" xref="S3.E2.m1.12.12.12.12.12.12.1.cmml">l</mi></msubsup><mo id="S3.E2.m1.13.13.13.13.13.13" xref="S3.E2.m1.44.44.1.1.1.cmml">⟩</mo></mrow><mo id="S3.E2.m1.14.14.14.14.14.14" xref="S3.E2.m1.14.14.14.14.14.14.cmml">=</mo><mrow id="S3.E2.m1.45.45.2.44.44.44.44.1.8"><mi id="S3.E2.m1.15.15.15.15.15.15" xref="S3.E2.m1.15.15.15.15.15.15.cmml">M</mi><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.16.16.16.16.16.16" xref="S3.E2.m1.16.16.16.16.16.16.cmml">F</mi><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6a" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.17.17.17.17.17.17" xref="S3.E2.m1.17.17.17.17.17.17.cmml">o</mi><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6b" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.18.18.18.18.18.18" xref="S3.E2.m1.18.18.18.18.18.18.cmml">r</mi><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6c" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.19.19.19.19.19.19" xref="S3.E2.m1.19.19.19.19.19.19.cmml">m</mi><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6d" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><mi id="S3.E2.m1.20.20.20.20.20.20" xref="S3.E2.m1.20.20.20.20.20.20.cmml">e</mi><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6e" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><msub id="S3.E2.m1.45.45.2.44.44.44.44.1.8.7"><mi id="S3.E2.m1.21.21.21.21.21.21" xref="S3.E2.m1.21.21.21.21.21.21.cmml">r</mi><mi id="S3.E2.m1.22.22.22.22.22.22.1" xref="S3.E2.m1.22.22.22.22.22.22.1.cmml">l</mi></msub><mo id="S3.E2.m1.45.45.2.44.44.44.44.1.8.6f" xref="S3.E2.m1.44.44.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.45.45.2.44.44.44.44.1.8.5.5"><mo id="S3.E2.m1.23.23.23.23.23.23" xref="S3.E2.m1.44.44.1.1.1.cmml">(</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.4.1.1.1"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.24.24.24.24.24.24" xref="S3.E2.m1.24.24.24.24.24.24a.cmml">q</mtext><mrow id="S3.E2.m1.25.25.25.25.25.25.1" xref="S3.E2.m1.25.25.25.25.25.25.1.cmml"><mi id="S3.E2.m1.25.25.25.25.25.25.1.2" xref="S3.E2.m1.25.25.25.25.25.25.1.2.cmml">i</mi><mo id="S3.E2.m1.25.25.25.25.25.25.1.1" xref="S3.E2.m1.25.25.25.25.25.25.1.1.cmml">⁢</mo><mi id="S3.E2.m1.25.25.25.25.25.25.1.3" xref="S3.E2.m1.25.25.25.25.25.25.1.3.cmml">d</mi></mrow><mrow id="S3.E2.m1.26.26.26.26.26.26.1" xref="S3.E2.m1.26.26.26.26.26.26.1.cmml"><mi id="S3.E2.m1.26.26.26.26.26.26.1.2" xref="S3.E2.m1.26.26.26.26.26.26.1.2.cmml">l</mi><mo id="S3.E2.m1.26.26.26.26.26.26.1.1" xref="S3.E2.m1.26.26.26.26.26.26.1.1.cmml">−</mo><mn id="S3.E2.m1.26.26.26.26.26.26.1.3" xref="S3.E2.m1.26.26.26.26.26.26.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.27.27.27.27.27.27" xref="S3.E2.m1.44.44.1.1.1.cmml">,</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.5.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.28.28.28.28.28.28" xref="S3.E2.m1.28.28.28.28.28.28a.cmml">q</mtext><mrow id="S3.E2.m1.29.29.29.29.29.29.1" xref="S3.E2.m1.29.29.29.29.29.29.1.cmml"><mi id="S3.E2.m1.29.29.29.29.29.29.1.2" xref="S3.E2.m1.29.29.29.29.29.29.1.2.cmml">i</mi><mo id="S3.E2.m1.29.29.29.29.29.29.1.1" xref="S3.E2.m1.29.29.29.29.29.29.1.1.cmml">⁢</mo><mi id="S3.E2.m1.29.29.29.29.29.29.1.3" xref="S3.E2.m1.29.29.29.29.29.29.1.3.cmml">n</mi><mo id="S3.E2.m1.29.29.29.29.29.29.1.1a" xref="S3.E2.m1.29.29.29.29.29.29.1.1.cmml">⁢</mo><mi id="S3.E2.m1.29.29.29.29.29.29.1.4" xref="S3.E2.m1.29.29.29.29.29.29.1.4.cmml">s</mi></mrow><mrow id="S3.E2.m1.30.30.30.30.30.30.1" xref="S3.E2.m1.30.30.30.30.30.30.1.cmml"><mi id="S3.E2.m1.30.30.30.30.30.30.1.2" xref="S3.E2.m1.30.30.30.30.30.30.1.2.cmml">l</mi><mo id="S3.E2.m1.30.30.30.30.30.30.1.1" xref="S3.E2.m1.30.30.30.30.30.30.1.1.cmml">−</mo><mn id="S3.E2.m1.30.30.30.30.30.30.1.3" xref="S3.E2.m1.30.30.30.30.30.30.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.31.31.31.31.31.31" xref="S3.E2.m1.44.44.1.1.1.cmml">,</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.6.3.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.32.32.32.32.32.32" xref="S3.E2.m1.32.32.32.32.32.32a.cmml">p</mtext><mrow id="S3.E2.m1.33.33.33.33.33.33.1" xref="S3.E2.m1.33.33.33.33.33.33.1.cmml"><mi id="S3.E2.m1.33.33.33.33.33.33.1.2" xref="S3.E2.m1.33.33.33.33.33.33.1.2.cmml">s</mi><mo id="S3.E2.m1.33.33.33.33.33.33.1.1" xref="S3.E2.m1.33.33.33.33.33.33.1.1.cmml">⁢</mo><mi id="S3.E2.m1.33.33.33.33.33.33.1.3" xref="S3.E2.m1.33.33.33.33.33.33.1.3.cmml">e</mi><mo id="S3.E2.m1.33.33.33.33.33.33.1.1a" xref="S3.E2.m1.33.33.33.33.33.33.1.1.cmml">⁢</mo><mi id="S3.E2.m1.33.33.33.33.33.33.1.4" xref="S3.E2.m1.33.33.33.33.33.33.1.4.cmml">m</mi></mrow><mrow id="S3.E2.m1.34.34.34.34.34.34.1" xref="S3.E2.m1.34.34.34.34.34.34.1.cmml"><mi id="S3.E2.m1.34.34.34.34.34.34.1.2" xref="S3.E2.m1.34.34.34.34.34.34.1.2.cmml">l</mi><mo id="S3.E2.m1.34.34.34.34.34.34.1.1" xref="S3.E2.m1.34.34.34.34.34.34.1.1.cmml">−</mo><mn id="S3.E2.m1.34.34.34.34.34.34.1.3" xref="S3.E2.m1.34.34.34.34.34.34.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.35.35.35.35.35.35" xref="S3.E2.m1.44.44.1.1.1.cmml">;</mo><msup id="S3.E2.m1.45.45.2.44.44.44.44.1.7.4.4.4"><mi id="S3.E2.m1.36.36.36.36.36.36" xref="S3.E2.m1.36.36.36.36.36.36.cmml">θ</mi><mi id="S3.E2.m1.37.37.37.37.37.37.1" xref="S3.E2.m1.37.37.37.37.37.37.1.cmml">l</mi></msup><mo id="S3.E2.m1.38.38.38.38.38.38" xref="S3.E2.m1.44.44.1.1.1.cmml">,</mo><msubsup id="S3.E2.m1.45.45.2.44.44.44.44.1.8.5.5.5"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.39.39.39.39.39.39" xref="S3.E2.m1.39.39.39.39.39.39a.cmml">F</mtext><mi id="S3.E2.m1.40.40.40.40.40.40.1" xref="S3.E2.m1.40.40.40.40.40.40.1.cmml">t</mi><msup id="S3.E2.m1.41.41.41.41.41.41.1" xref="S3.E2.m1.41.41.41.41.41.41.1.cmml"><mi id="S3.E2.m1.41.41.41.41.41.41.1a" xref="S3.E2.m1.41.41.41.41.41.41.1.cmml"></mi><mo id="S3.E2.m1.41.41.41.41.41.41.1.1" xref="S3.E2.m1.41.41.41.41.41.41.1.1.cmml">′</mo></msup></msubsup><mo id="S3.E2.m1.42.42.42.42.42.42" xref="S3.E2.m1.44.44.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.43.43.43.43.43.43" xref="S3.E2.m1.44.44.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.45b"><apply id="S3.E2.m1.44.44.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><eq id="S3.E2.m1.14.14.14.14.14.14.cmml" xref="S3.E2.m1.14.14.14.14.14.14"></eq><list id="S3.E2.m1.44.44.1.1.1.3.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><apply id="S3.E2.m1.44.44.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.2a.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2">q</mtext></ci><apply id="S3.E2.m1.3.3.3.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1"><times id="S3.E2.m1.3.3.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1"></times><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2">𝑖</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.3">𝑑</ci></apply></apply><ci id="S3.E2.m1.4.4.4.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.4.4.4.1">𝑙</ci></apply><apply id="S3.E2.m1.44.44.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.6.6.6a.cmml" xref="S3.E2.m1.6.6.6.6.6.6"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.6.6.6.6.6.6.cmml" xref="S3.E2.m1.6.6.6.6.6.6">q</mtext></ci><apply id="S3.E2.m1.7.7.7.7.7.7.1.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1"><times id="S3.E2.m1.7.7.7.7.7.7.1.1.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.1"></times><ci id="S3.E2.m1.7.7.7.7.7.7.1.2.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.2">𝑖</ci><ci id="S3.E2.m1.7.7.7.7.7.7.1.3.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.3">𝑛</ci><ci id="S3.E2.m1.7.7.7.7.7.7.1.4.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.4">𝑠</ci></apply></apply><ci id="S3.E2.m1.8.8.8.8.8.8.1.cmml" xref="S3.E2.m1.8.8.8.8.8.8.1">𝑙</ci></apply><apply id="S3.E2.m1.44.44.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.3.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.10.10.10.10.10.10a.cmml" xref="S3.E2.m1.10.10.10.10.10.10"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.10.10.10.10.10.10.cmml" xref="S3.E2.m1.10.10.10.10.10.10">p</mtext></ci><apply id="S3.E2.m1.11.11.11.11.11.11.1.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1"><times id="S3.E2.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.1"></times><ci id="S3.E2.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.2">𝑠</ci><ci id="S3.E2.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.3">𝑒</ci><ci id="S3.E2.m1.11.11.11.11.11.11.1.4.cmml" xref="S3.E2.m1.11.11.11.11.11.11.1.4">𝑚</ci></apply></apply><ci id="S3.E2.m1.12.12.12.12.12.12.1.cmml" xref="S3.E2.m1.12.12.12.12.12.12.1">𝑙</ci></apply></list><apply id="S3.E2.m1.44.44.1.1.1.8.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><times id="S3.E2.m1.44.44.1.1.1.8.6.cmml" xref="S3.E2.m1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.15.15.15.15.15.15.cmml" xref="S3.E2.m1.15.15.15.15.15.15">𝑀</ci><ci id="S3.E2.m1.16.16.16.16.16.16.cmml" xref="S3.E2.m1.16.16.16.16.16.16">𝐹</ci><ci id="S3.E2.m1.17.17.17.17.17.17.cmml" xref="S3.E2.m1.17.17.17.17.17.17">𝑜</ci><ci id="S3.E2.m1.18.18.18.18.18.18.cmml" xref="S3.E2.m1.18.18.18.18.18.18">𝑟</ci><ci id="S3.E2.m1.19.19.19.19.19.19.cmml" xref="S3.E2.m1.19.19.19.19.19.19">𝑚</ci><ci id="S3.E2.m1.20.20.20.20.20.20.cmml" xref="S3.E2.m1.20.20.20.20.20.20">𝑒</ci><apply id="S3.E2.m1.44.44.1.1.1.8.13.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.8.13.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.21.21.21.21.21.21.cmml" xref="S3.E2.m1.21.21.21.21.21.21">𝑟</ci><ci id="S3.E2.m1.22.22.22.22.22.22.1.cmml" xref="S3.E2.m1.22.22.22.22.22.22.1">𝑙</ci></apply><vector id="S3.E2.m1.44.44.1.1.1.8.5.6.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><apply id="S3.E2.m1.44.44.1.1.1.4.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.4.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.4.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.4.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.24.24.24.24.24.24a.cmml" xref="S3.E2.m1.24.24.24.24.24.24"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.24.24.24.24.24.24.cmml" xref="S3.E2.m1.24.24.24.24.24.24">q</mtext></ci><apply id="S3.E2.m1.25.25.25.25.25.25.1.cmml" xref="S3.E2.m1.25.25.25.25.25.25.1"><times id="S3.E2.m1.25.25.25.25.25.25.1.1.cmml" xref="S3.E2.m1.25.25.25.25.25.25.1.1"></times><ci id="S3.E2.m1.25.25.25.25.25.25.1.2.cmml" xref="S3.E2.m1.25.25.25.25.25.25.1.2">𝑖</ci><ci id="S3.E2.m1.25.25.25.25.25.25.1.3.cmml" xref="S3.E2.m1.25.25.25.25.25.25.1.3">𝑑</ci></apply></apply><apply id="S3.E2.m1.26.26.26.26.26.26.1.cmml" xref="S3.E2.m1.26.26.26.26.26.26.1"><minus id="S3.E2.m1.26.26.26.26.26.26.1.1.cmml" xref="S3.E2.m1.26.26.26.26.26.26.1.1"></minus><ci id="S3.E2.m1.26.26.26.26.26.26.1.2.cmml" xref="S3.E2.m1.26.26.26.26.26.26.1.2">𝑙</ci><cn id="S3.E2.m1.26.26.26.26.26.26.1.3.cmml" type="integer" xref="S3.E2.m1.26.26.26.26.26.26.1.3">1</cn></apply></apply><apply id="S3.E2.m1.44.44.1.1.1.5.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.5.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.5.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.5.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.28.28.28.28.28.28a.cmml" xref="S3.E2.m1.28.28.28.28.28.28"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.28.28.28.28.28.28.cmml" xref="S3.E2.m1.28.28.28.28.28.28">q</mtext></ci><apply id="S3.E2.m1.29.29.29.29.29.29.1.cmml" xref="S3.E2.m1.29.29.29.29.29.29.1"><times id="S3.E2.m1.29.29.29.29.29.29.1.1.cmml" xref="S3.E2.m1.29.29.29.29.29.29.1.1"></times><ci id="S3.E2.m1.29.29.29.29.29.29.1.2.cmml" xref="S3.E2.m1.29.29.29.29.29.29.1.2">𝑖</ci><ci id="S3.E2.m1.29.29.29.29.29.29.1.3.cmml" xref="S3.E2.m1.29.29.29.29.29.29.1.3">𝑛</ci><ci id="S3.E2.m1.29.29.29.29.29.29.1.4.cmml" xref="S3.E2.m1.29.29.29.29.29.29.1.4">𝑠</ci></apply></apply><apply id="S3.E2.m1.30.30.30.30.30.30.1.cmml" xref="S3.E2.m1.30.30.30.30.30.30.1"><minus id="S3.E2.m1.30.30.30.30.30.30.1.1.cmml" xref="S3.E2.m1.30.30.30.30.30.30.1.1"></minus><ci id="S3.E2.m1.30.30.30.30.30.30.1.2.cmml" xref="S3.E2.m1.30.30.30.30.30.30.1.2">𝑙</ci><cn id="S3.E2.m1.30.30.30.30.30.30.1.3.cmml" type="integer" xref="S3.E2.m1.30.30.30.30.30.30.1.3">1</cn></apply></apply><apply id="S3.E2.m1.44.44.1.1.1.6.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.6.3.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.6.3.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.6.3.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.32.32.32.32.32.32a.cmml" xref="S3.E2.m1.32.32.32.32.32.32"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.32.32.32.32.32.32.cmml" xref="S3.E2.m1.32.32.32.32.32.32">p</mtext></ci><apply id="S3.E2.m1.33.33.33.33.33.33.1.cmml" xref="S3.E2.m1.33.33.33.33.33.33.1"><times id="S3.E2.m1.33.33.33.33.33.33.1.1.cmml" xref="S3.E2.m1.33.33.33.33.33.33.1.1"></times><ci id="S3.E2.m1.33.33.33.33.33.33.1.2.cmml" xref="S3.E2.m1.33.33.33.33.33.33.1.2">𝑠</ci><ci id="S3.E2.m1.33.33.33.33.33.33.1.3.cmml" xref="S3.E2.m1.33.33.33.33.33.33.1.3">𝑒</ci><ci id="S3.E2.m1.33.33.33.33.33.33.1.4.cmml" xref="S3.E2.m1.33.33.33.33.33.33.1.4">𝑚</ci></apply></apply><apply id="S3.E2.m1.34.34.34.34.34.34.1.cmml" xref="S3.E2.m1.34.34.34.34.34.34.1"><minus id="S3.E2.m1.34.34.34.34.34.34.1.1.cmml" xref="S3.E2.m1.34.34.34.34.34.34.1.1"></minus><ci id="S3.E2.m1.34.34.34.34.34.34.1.2.cmml" xref="S3.E2.m1.34.34.34.34.34.34.1.2">𝑙</ci><cn id="S3.E2.m1.34.34.34.34.34.34.1.3.cmml" type="integer" xref="S3.E2.m1.34.34.34.34.34.34.1.3">1</cn></apply></apply><apply id="S3.E2.m1.44.44.1.1.1.7.4.4.4.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.7.4.4.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.36.36.36.36.36.36.cmml" xref="S3.E2.m1.36.36.36.36.36.36">𝜃</ci><ci id="S3.E2.m1.37.37.37.37.37.37.1.cmml" xref="S3.E2.m1.37.37.37.37.37.37.1">𝑙</ci></apply><apply id="S3.E2.m1.44.44.1.1.1.8.5.5.5.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.8.5.5.5.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.44.44.1.1.1.8.5.5.5.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.44.44.1.1.1.8.5.5.5.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.39.39.39.39.39.39a.cmml" xref="S3.E2.m1.39.39.39.39.39.39"><mtext class="ltx_mathvariant_bold" id="S3.E2.m1.39.39.39.39.39.39.cmml" xref="S3.E2.m1.39.39.39.39.39.39">F</mtext></ci><ci id="S3.E2.m1.40.40.40.40.40.40.1.cmml" xref="S3.E2.m1.40.40.40.40.40.40.1">𝑡</ci></apply><apply id="S3.E2.m1.41.41.41.41.41.41.1.cmml" xref="S3.E2.m1.41.41.41.41.41.41.1"><ci id="S3.E2.m1.41.41.41.41.41.41.1.1.cmml" xref="S3.E2.m1.41.41.41.41.41.41.1.1">′</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.45c">\begin{split}\left&lt;\textbf{q}_{id}^{l},\textbf{q}_{ins}^{l},\textbf{p}_{sem}^{%
l}\right&gt;=MFormer_{l}\left(\textbf{q}_{id}^{l-1},\textbf{q}_{ins}^{l-1},%
\textbf{p}_{sem}^{l-1};\theta^{l},\textbf{F}_{t}^{{}^{\prime}}\right),\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.45d">start_ROW start_CELL ⟨ q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , q start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ⟩ = italic_M italic_F italic_o italic_r italic_m italic_e italic_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ( q start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT , q start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT , p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT ; italic_θ start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , F start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT start_FLOATSUPERSCRIPT ′ end_FLOATSUPERSCRIPT end_POSTSUPERSCRIPT ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p2.9">where <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m1.1"><semantics id="S3.SS3.p2.7.m1.1a"><mi id="S3.SS3.p2.7.m1.1.1" xref="S3.SS3.p2.7.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m1.1b"><ci id="S3.SS3.p2.7.m1.1.1.cmml" xref="S3.SS3.p2.7.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m1.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m1.1d">italic_l</annotation></semantics></math> denotes the layer number of M-Former and <math alttext="\theta^{l}" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m2.1"><semantics id="S3.SS3.p2.8.m2.1a"><msup id="S3.SS3.p2.8.m2.1.1" xref="S3.SS3.p2.8.m2.1.1.cmml"><mi id="S3.SS3.p2.8.m2.1.1.2" xref="S3.SS3.p2.8.m2.1.1.2.cmml">θ</mi><mi id="S3.SS3.p2.8.m2.1.1.3" xref="S3.SS3.p2.8.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m2.1b"><apply id="S3.SS3.p2.8.m2.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m2.1.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.8.m2.1.1.2.cmml" xref="S3.SS3.p2.8.m2.1.1.2">𝜃</ci><ci id="S3.SS3.p2.8.m2.1.1.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m2.1c">\theta^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m2.1d">italic_θ start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is the parameters of the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p2.9.m3.1"><semantics id="S3.SS3.p2.9.m3.1a"><mi id="S3.SS3.p2.9.m3.1.1" xref="S3.SS3.p2.9.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m3.1b"><ci id="S3.SS3.p2.9.m3.1.1.cmml" xref="S3.SS3.p2.9.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m3.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.9.m3.1d">italic_l</annotation></semantics></math>-th M-Former block. Then, a prediction feed-forward network is employed to predict ID and instance outputs, respectively.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.15">For instance segmentation, we use the updated semantic prototypes <math alttext="\textbf{p}_{sem}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2a.cmml">p</mtext><mrow id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">s</mi><mo id="S3.SS3.p3.1.m1.1.1.3.1" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.SS3.p3.1.m1.1.1.3.1a" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.1.m1.1.1.3.4" xref="S3.SS3.p3.1.m1.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2a.cmml" xref="S3.SS3.p3.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">p</mtext></ci><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><times id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.1"></times><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS3.p3.1.m1.1.1.3.4.cmml" xref="S3.SS3.p3.1.m1.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\textbf{p}_{sem}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">p start_POSTSUBSCRIPT italic_s italic_e italic_m end_POSTSUBSCRIPT</annotation></semantics></math> as the classifier and let <math alttext="\hat{\textbf{y}}_{ins}=\{\hat{y}_{ins}^{i}\}_{i=1}^{S}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><msub id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mover accent="true" id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.2.m2.1.1.3.2.2" xref="S3.SS3.p3.2.m2.1.1.3.2.2a.cmml">y</mtext><mo id="S3.SS3.p3.2.m2.1.1.3.2.1" xref="S3.SS3.p3.2.m2.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.3.2" xref="S3.SS3.p3.2.m2.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.p3.2.m2.1.1.3.3.1" xref="S3.SS3.p3.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.3.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.3.cmml">n</mi><mo id="S3.SS3.p3.2.m2.1.1.3.3.1a" xref="S3.SS3.p3.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.3.3.4" xref="S3.SS3.p3.2.m2.1.1.3.3.4.cmml">s</mi></mrow></msub><mo id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">=</mo><msubsup id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml"><mrow id="S3.SS3.p3.2.m2.1.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.3.cmml">n</mi><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.1a" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.4" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS3.p3.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p3.2.m2.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.2.m2.1.1.1.1.3.1" xref="S3.SS3.p3.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p3.2.m2.1.1.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p3.2.m2.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.3.cmml">S</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><eq id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2"></eq><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3">subscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2"><ci id="S3.SS3.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.1">^</ci><ci id="S3.SS3.p3.2.m2.1.1.3.2.2a.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2">y</mtext></ci></apply><apply id="S3.SS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3"><times id="S3.SS3.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.3">𝑛</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.4.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4">𝑠</ci></apply></apply><apply id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1">subscript</csymbol><set id="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1"><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2"><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3"><times id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.3">𝑛</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS3.p3.2.m2.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.3"><eq id="S3.SS3.p3.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.3.1"></eq><ci id="S3.SS3.p3.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS3.p3.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p3.2.m2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\hat{\textbf{y}}_{ins}=\{\hat{y}_{ins}^{i}\}_{i=1}^{S}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">over^ start_ARG y end_ARG start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT = { over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT</annotation></semantics></math> denote the set of <math alttext="S" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_S</annotation></semantics></math> instance predictions. The ground truth is denoted by <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.SS3.p3.15.1">y</span>.
We use the Hungarian loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx4" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite> to learn SINE. Specifically, we compute the assignment costs between prediction <math alttext="\hat{y}_{ins}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m5.1"><semantics id="S3.SS3.p3.5.m5.1a"><msubsup id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.p3.5.m5.1.1.2.2" xref="S3.SS3.p3.5.m5.1.1.2.2.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2.2.2" xref="S3.SS3.p3.5.m5.1.1.2.2.2.cmml">y</mi><mo id="S3.SS3.p3.5.m5.1.1.2.2.1" xref="S3.SS3.p3.5.m5.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.5.m5.1.1.2.3" xref="S3.SS3.p3.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2.3.2" xref="S3.SS3.p3.5.m5.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.5.m5.1.1.2.3.1" xref="S3.SS3.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.1.1.2.3.3" xref="S3.SS3.p3.5.m5.1.1.2.3.3.cmml">n</mi><mo id="S3.SS3.p3.5.m5.1.1.2.3.1a" xref="S3.SS3.p3.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.5.m5.1.1.2.3.4" xref="S3.SS3.p3.5.m5.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><apply id="S3.SS3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2"><ci id="S3.SS3.p3.5.m5.1.1.2.2.1.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.5.m5.1.1.2.2.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2.2">𝑦</ci></apply><apply id="S3.SS3.p3.5.m5.1.1.2.3.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3"><times id="S3.SS3.p3.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.1"></times><ci id="S3.SS3.p3.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p3.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.3">𝑛</ci><ci id="S3.SS3.p3.5.m5.1.1.2.3.4.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\hat{y}_{ins}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m5.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> and ground truth <math alttext="y^{j}" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m6.1"><semantics id="S3.SS3.p3.6.m6.1a"><msup id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">y</mi><mi id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝑦</ci><ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">y^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m6.1d">italic_y start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> for the matching problem, <em class="ltx_emph ltx_font_italic" id="S3.SS3.p3.15.2">i.e.</em>, <math alttext="-p_{i}(c^{j})+\mathcal{L}_{\text{mask}}(\hat{m}_{ins}^{i},m^{j})" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m7.3"><semantics id="S3.SS3.p3.7.m7.3a"><mrow id="S3.SS3.p3.7.m7.3.3" xref="S3.SS3.p3.7.m7.3.3.cmml"><mrow id="S3.SS3.p3.7.m7.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.cmml"><mo id="S3.SS3.p3.7.m7.1.1.1a" xref="S3.SS3.p3.7.m7.1.1.1.cmml">−</mo><mrow id="S3.SS3.p3.7.m7.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.cmml"><msub id="S3.SS3.p3.7.m7.1.1.1.1.3" xref="S3.SS3.p3.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.7.m7.1.1.1.1.3.2" xref="S3.SS3.p3.7.m7.1.1.1.1.3.2.cmml">p</mi><mi id="S3.SS3.p3.7.m7.1.1.1.1.3.3" xref="S3.SS3.p3.7.m7.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS3.p3.7.m7.1.1.1.1.2" xref="S3.SS3.p3.7.m7.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.7.m7.1.1.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.2" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S3.SS3.p3.7.m7.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.p3.7.m7.3.3.4" xref="S3.SS3.p3.7.m7.3.3.4.cmml">+</mo><mrow id="S3.SS3.p3.7.m7.3.3.3" xref="S3.SS3.p3.7.m7.3.3.3.cmml"><msub id="S3.SS3.p3.7.m7.3.3.3.4" xref="S3.SS3.p3.7.m7.3.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.7.m7.3.3.3.4.2" xref="S3.SS3.p3.7.m7.3.3.3.4.2.cmml">ℒ</mi><mtext id="S3.SS3.p3.7.m7.3.3.3.4.3" xref="S3.SS3.p3.7.m7.3.3.3.4.3a.cmml">mask</mtext></msub><mo id="S3.SS3.p3.7.m7.3.3.3.3" xref="S3.SS3.p3.7.m7.3.3.3.3.cmml">⁢</mo><mrow id="S3.SS3.p3.7.m7.3.3.3.2.2" xref="S3.SS3.p3.7.m7.3.3.3.2.3.cmml"><mo id="S3.SS3.p3.7.m7.3.3.3.2.2.3" stretchy="false" xref="S3.SS3.p3.7.m7.3.3.3.2.3.cmml">(</mo><msubsup id="S3.SS3.p3.7.m7.2.2.2.1.1.1" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.cmml"><mi id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.2" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.2.cmml">m</mi><mo id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.1" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.cmml"><mi id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.2" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.1" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.3" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.3.cmml">n</mi><mo id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.1a" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.4" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS3.p3.7.m7.2.2.2.1.1.1.3" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS3.p3.7.m7.3.3.3.2.2.4" xref="S3.SS3.p3.7.m7.3.3.3.2.3.cmml">,</mo><msup id="S3.SS3.p3.7.m7.3.3.3.2.2.2" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2.cmml"><mi id="S3.SS3.p3.7.m7.3.3.3.2.2.2.2" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2.2.cmml">m</mi><mi id="S3.SS3.p3.7.m7.3.3.3.2.2.2.3" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2.3.cmml">j</mi></msup><mo id="S3.SS3.p3.7.m7.3.3.3.2.2.5" stretchy="false" xref="S3.SS3.p3.7.m7.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.3b"><apply id="S3.SS3.p3.7.m7.3.3.cmml" xref="S3.SS3.p3.7.m7.3.3"><plus id="S3.SS3.p3.7.m7.3.3.4.cmml" xref="S3.SS3.p3.7.m7.3.3.4"></plus><apply id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1"><minus id="S3.SS3.p3.7.m7.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1"></minus><apply id="S3.SS3.p3.7.m7.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1"><times id="S3.SS3.p3.7.m7.1.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.2"></times><apply id="S3.SS3.p3.7.m7.1.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.3.2">𝑝</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S3.SS3.p3.7.m7.3.3.3.cmml" xref="S3.SS3.p3.7.m7.3.3.3"><times id="S3.SS3.p3.7.m7.3.3.3.3.cmml" xref="S3.SS3.p3.7.m7.3.3.3.3"></times><apply id="S3.SS3.p3.7.m7.3.3.3.4.cmml" xref="S3.SS3.p3.7.m7.3.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.3.3.3.4.1.cmml" xref="S3.SS3.p3.7.m7.3.3.3.4">subscript</csymbol><ci id="S3.SS3.p3.7.m7.3.3.3.4.2.cmml" xref="S3.SS3.p3.7.m7.3.3.3.4.2">ℒ</ci><ci id="S3.SS3.p3.7.m7.3.3.3.4.3a.cmml" xref="S3.SS3.p3.7.m7.3.3.3.4.3"><mtext id="S3.SS3.p3.7.m7.3.3.3.4.3.cmml" mathsize="70%" xref="S3.SS3.p3.7.m7.3.3.3.4.3">mask</mtext></ci></apply><interval closure="open" id="S3.SS3.p3.7.m7.3.3.3.2.3.cmml" xref="S3.SS3.p3.7.m7.3.3.3.2.2"><apply id="S3.SS3.p3.7.m7.2.2.2.1.1.1.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2"><ci id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.1.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.2.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.2.2">𝑚</ci></apply><apply id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3"><times id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.1.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.1"></times><ci id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.2.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.3.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.3">𝑛</ci><ci id="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.4.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS3.p3.7.m7.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.7.m7.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p3.7.m7.3.3.3.2.2.2.cmml" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.3.3.3.2.2.2.1.cmml" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2">superscript</csymbol><ci id="S3.SS3.p3.7.m7.3.3.3.2.2.2.2.cmml" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2.2">𝑚</ci><ci id="S3.SS3.p3.7.m7.3.3.3.2.2.2.3.cmml" xref="S3.SS3.p3.7.m7.3.3.3.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.3c">-p_{i}(c^{j})+\mathcal{L}_{\text{mask}}(\hat{m}_{ins}^{i},m^{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m7.3d">- italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) + caligraphic_L start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT ( over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_m start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="(c^{j},m^{j})" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m8.2"><semantics id="S3.SS3.p3.8.m8.2a"><mrow id="S3.SS3.p3.8.m8.2.2.2" xref="S3.SS3.p3.8.m8.2.2.3.cmml"><mo id="S3.SS3.p3.8.m8.2.2.2.3" stretchy="false" xref="S3.SS3.p3.8.m8.2.2.3.cmml">(</mo><msup id="S3.SS3.p3.8.m8.1.1.1.1" xref="S3.SS3.p3.8.m8.1.1.1.1.cmml"><mi id="S3.SS3.p3.8.m8.1.1.1.1.2" xref="S3.SS3.p3.8.m8.1.1.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.8.m8.1.1.1.1.3" xref="S3.SS3.p3.8.m8.1.1.1.1.3.cmml">j</mi></msup><mo id="S3.SS3.p3.8.m8.2.2.2.4" xref="S3.SS3.p3.8.m8.2.2.3.cmml">,</mo><msup id="S3.SS3.p3.8.m8.2.2.2.2" xref="S3.SS3.p3.8.m8.2.2.2.2.cmml"><mi id="S3.SS3.p3.8.m8.2.2.2.2.2" xref="S3.SS3.p3.8.m8.2.2.2.2.2.cmml">m</mi><mi id="S3.SS3.p3.8.m8.2.2.2.2.3" xref="S3.SS3.p3.8.m8.2.2.2.2.3.cmml">j</mi></msup><mo id="S3.SS3.p3.8.m8.2.2.2.5" stretchy="false" xref="S3.SS3.p3.8.m8.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.2b"><interval closure="open" id="S3.SS3.p3.8.m8.2.2.3.cmml" xref="S3.SS3.p3.8.m8.2.2.2"><apply id="S3.SS3.p3.8.m8.1.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.8.m8.1.1.1.1.2.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1.2">𝑐</ci><ci id="S3.SS3.p3.8.m8.1.1.1.1.3.cmml" xref="S3.SS3.p3.8.m8.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS3.p3.8.m8.2.2.2.2.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.2.2.2.2.1.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p3.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2.2">𝑚</ci><ci id="S3.SS3.p3.8.m8.2.2.2.2.3.cmml" xref="S3.SS3.p3.8.m8.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.2c">(c^{j},m^{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m8.2d">( italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_m start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math> is the class and mask of the ground truth object, <math alttext="c^{j}" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m9.1"><semantics id="S3.SS3.p3.9.m9.1a"><msup id="S3.SS3.p3.9.m9.1.1" xref="S3.SS3.p3.9.m9.1.1.cmml"><mi id="S3.SS3.p3.9.m9.1.1.2" xref="S3.SS3.p3.9.m9.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.9.m9.1.1.3" xref="S3.SS3.p3.9.m9.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m9.1b"><apply id="S3.SS3.p3.9.m9.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m9.1.1.1.cmml" xref="S3.SS3.p3.9.m9.1.1">superscript</csymbol><ci id="S3.SS3.p3.9.m9.1.1.2.cmml" xref="S3.SS3.p3.9.m9.1.1.2">𝑐</ci><ci id="S3.SS3.p3.9.m9.1.1.3.cmml" xref="S3.SS3.p3.9.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m9.1c">c^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m9.1d">italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> may be <math alttext="\varnothing" class="ltx_Math" display="inline" id="S3.SS3.p3.10.m10.1"><semantics id="S3.SS3.p3.10.m10.1a"><mi id="S3.SS3.p3.10.m10.1.1" mathvariant="normal" xref="S3.SS3.p3.10.m10.1.1.cmml">∅</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m10.1b"><emptyset id="S3.SS3.p3.10.m10.1.1.cmml" xref="S3.SS3.p3.10.m10.1.1"></emptyset></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m10.1c">\varnothing</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.10.m10.1d">∅</annotation></semantics></math>. <math alttext="p_{i}(c^{j})" class="ltx_Math" display="inline" id="S3.SS3.p3.11.m11.1"><semantics id="S3.SS3.p3.11.m11.1a"><mrow id="S3.SS3.p3.11.m11.1.1" xref="S3.SS3.p3.11.m11.1.1.cmml"><msub id="S3.SS3.p3.11.m11.1.1.3" xref="S3.SS3.p3.11.m11.1.1.3.cmml"><mi id="S3.SS3.p3.11.m11.1.1.3.2" xref="S3.SS3.p3.11.m11.1.1.3.2.cmml">p</mi><mi id="S3.SS3.p3.11.m11.1.1.3.3" xref="S3.SS3.p3.11.m11.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS3.p3.11.m11.1.1.2" xref="S3.SS3.p3.11.m11.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.11.m11.1.1.1.1" xref="S3.SS3.p3.11.m11.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.11.m11.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.11.m11.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p3.11.m11.1.1.1.1.1" xref="S3.SS3.p3.11.m11.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.11.m11.1.1.1.1.1.2" xref="S3.SS3.p3.11.m11.1.1.1.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.11.m11.1.1.1.1.1.3" xref="S3.SS3.p3.11.m11.1.1.1.1.1.3.cmml">j</mi></msup><mo id="S3.SS3.p3.11.m11.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m11.1b"><apply id="S3.SS3.p3.11.m11.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1"><times id="S3.SS3.p3.11.m11.1.1.2.cmml" xref="S3.SS3.p3.11.m11.1.1.2"></times><apply id="S3.SS3.p3.11.m11.1.1.3.cmml" xref="S3.SS3.p3.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m11.1.1.3.1.cmml" xref="S3.SS3.p3.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.11.m11.1.1.3.2.cmml" xref="S3.SS3.p3.11.m11.1.1.3.2">𝑝</ci><ci id="S3.SS3.p3.11.m11.1.1.3.3.cmml" xref="S3.SS3.p3.11.m11.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p3.11.m11.1.1.1.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.11.m11.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.1.2">𝑐</ci><ci id="S3.SS3.p3.11.m11.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.11.m11.1.1.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m11.1c">p_{i}(c^{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.11.m11.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math> is the probability of class <math alttext="c^{j}" class="ltx_Math" display="inline" id="S3.SS3.p3.12.m12.1"><semantics id="S3.SS3.p3.12.m12.1a"><msup id="S3.SS3.p3.12.m12.1.1" xref="S3.SS3.p3.12.m12.1.1.cmml"><mi id="S3.SS3.p3.12.m12.1.1.2" xref="S3.SS3.p3.12.m12.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.12.m12.1.1.3" xref="S3.SS3.p3.12.m12.1.1.3.cmml">j</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m12.1b"><apply id="S3.SS3.p3.12.m12.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m12.1.1.1.cmml" xref="S3.SS3.p3.12.m12.1.1">superscript</csymbol><ci id="S3.SS3.p3.12.m12.1.1.2.cmml" xref="S3.SS3.p3.12.m12.1.1.2">𝑐</ci><ci id="S3.SS3.p3.12.m12.1.1.3.cmml" xref="S3.SS3.p3.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m12.1c">c^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.12.m12.1d">italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> for <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.13.m13.1"><semantics id="S3.SS3.p3.13.m13.1a"><mi id="S3.SS3.p3.13.m13.1.1" xref="S3.SS3.p3.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m13.1b"><ci id="S3.SS3.p3.13.m13.1.1.cmml" xref="S3.SS3.p3.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m13.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.13.m13.1d">italic_i</annotation></semantics></math>-th instance query, <math alttext="\hat{m}_{ins}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.14.m14.1"><semantics id="S3.SS3.p3.14.m14.1a"><msubsup id="S3.SS3.p3.14.m14.1.1" xref="S3.SS3.p3.14.m14.1.1.cmml"><mover accent="true" id="S3.SS3.p3.14.m14.1.1.2.2" xref="S3.SS3.p3.14.m14.1.1.2.2.cmml"><mi id="S3.SS3.p3.14.m14.1.1.2.2.2" xref="S3.SS3.p3.14.m14.1.1.2.2.2.cmml">m</mi><mo id="S3.SS3.p3.14.m14.1.1.2.2.1" xref="S3.SS3.p3.14.m14.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.14.m14.1.1.2.3" xref="S3.SS3.p3.14.m14.1.1.2.3.cmml"><mi id="S3.SS3.p3.14.m14.1.1.2.3.2" xref="S3.SS3.p3.14.m14.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.14.m14.1.1.2.3.1" xref="S3.SS3.p3.14.m14.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.14.m14.1.1.2.3.3" xref="S3.SS3.p3.14.m14.1.1.2.3.3.cmml">n</mi><mo id="S3.SS3.p3.14.m14.1.1.2.3.1a" xref="S3.SS3.p3.14.m14.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.14.m14.1.1.2.3.4" xref="S3.SS3.p3.14.m14.1.1.2.3.4.cmml">s</mi></mrow><mi id="S3.SS3.p3.14.m14.1.1.3" xref="S3.SS3.p3.14.m14.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m14.1b"><apply id="S3.SS3.p3.14.m14.1.1.cmml" xref="S3.SS3.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.14.m14.1.1.1.cmml" xref="S3.SS3.p3.14.m14.1.1">superscript</csymbol><apply id="S3.SS3.p3.14.m14.1.1.2.cmml" xref="S3.SS3.p3.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.14.m14.1.1.2.1.cmml" xref="S3.SS3.p3.14.m14.1.1">subscript</csymbol><apply id="S3.SS3.p3.14.m14.1.1.2.2.cmml" xref="S3.SS3.p3.14.m14.1.1.2.2"><ci id="S3.SS3.p3.14.m14.1.1.2.2.1.cmml" xref="S3.SS3.p3.14.m14.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.14.m14.1.1.2.2.2.cmml" xref="S3.SS3.p3.14.m14.1.1.2.2.2">𝑚</ci></apply><apply id="S3.SS3.p3.14.m14.1.1.2.3.cmml" xref="S3.SS3.p3.14.m14.1.1.2.3"><times id="S3.SS3.p3.14.m14.1.1.2.3.1.cmml" xref="S3.SS3.p3.14.m14.1.1.2.3.1"></times><ci id="S3.SS3.p3.14.m14.1.1.2.3.2.cmml" xref="S3.SS3.p3.14.m14.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p3.14.m14.1.1.2.3.3.cmml" xref="S3.SS3.p3.14.m14.1.1.2.3.3">𝑛</ci><ci id="S3.SS3.p3.14.m14.1.1.2.3.4.cmml" xref="S3.SS3.p3.14.m14.1.1.2.3.4">𝑠</ci></apply></apply><ci id="S3.SS3.p3.14.m14.1.1.3.cmml" xref="S3.SS3.p3.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m14.1c">\hat{m}_{ins}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.14.m14.1d">over^ start_ARG italic_m end_ARG start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> denotes its predicted mask. <math alttext="\mathcal{L}_{\text{mask}}" class="ltx_Math" display="inline" id="S3.SS3.p3.15.m15.1"><semantics id="S3.SS3.p3.15.m15.1a"><msub id="S3.SS3.p3.15.m15.1.1" xref="S3.SS3.p3.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.15.m15.1.1.2" xref="S3.SS3.p3.15.m15.1.1.2.cmml">ℒ</mi><mtext id="S3.SS3.p3.15.m15.1.1.3" xref="S3.SS3.p3.15.m15.1.1.3a.cmml">mask</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.15.m15.1b"><apply id="S3.SS3.p3.15.m15.1.1.cmml" xref="S3.SS3.p3.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.15.m15.1.1.1.cmml" xref="S3.SS3.p3.15.m15.1.1">subscript</csymbol><ci id="S3.SS3.p3.15.m15.1.1.2.cmml" xref="S3.SS3.p3.15.m15.1.1.2">ℒ</ci><ci id="S3.SS3.p3.15.m15.1.1.3a.cmml" xref="S3.SS3.p3.15.m15.1.1.3"><mtext id="S3.SS3.p3.15.m15.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p3.15.m15.1.1.3">mask</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.15.m15.1c">\mathcal{L}_{\text{mask}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.15.m15.1d">caligraphic_L start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT</annotation></semantics></math> is a binary mask loss and Dice loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx38" title="">MNA16</a>]</cite>. The Hungarian loss is</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{\text{Hungarian}}(\hat{\textbf{y}}_{ins},\textbf{y})%
=\sum\nolimits_{j=1}^{S}\left[-\log p_{\sigma(j)}(c^{j})+\mathds{1}_{c^{j}\neq%
\varnothing}\mathcal{L}_{\text{mask}}(\hat{m}^{\sigma(j)}_{ins},m^{j})\right],%
\end{split}" class="ltx_Math" display="block" id="S3.E3.m1.38"><semantics id="S3.E3.m1.38a"><mtable displaystyle="true" id="S3.E3.m1.38.38.2"><mtr id="S3.E3.m1.38.38.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.38.38.2b"><mrow id="S3.E3.m1.38.38.2.37.37.37.37"><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1"><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.1"><msub id="S3.E3.m1.38.38.2.37.37.37.37.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">ℒ</mi><mtext id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1a.cmml">Hungarian</mtext></msub><mo id="S3.E3.m1.38.38.2.37.37.37.37.1.1.2" xref="S3.E3.m1.37.37.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.1.1.1"><mo id="S3.E3.m1.3.3.3.3.3.3" stretchy="false" xref="S3.E3.m1.37.37.1.1.1.cmml">(</mo><msub id="S3.E3.m1.38.38.2.37.37.37.37.1.1.1.1.1"><mover accent="true" id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.4.4.4.4.2" xref="S3.E3.m1.4.4.4.4.4.4.2a.cmml">y</mtext><mo id="S3.E3.m1.4.4.4.4.4.4.1" xref="S3.E3.m1.4.4.4.4.4.4.1.cmml">^</mo></mover><mrow id="S3.E3.m1.5.5.5.5.5.5.1" xref="S3.E3.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E3.m1.5.5.5.5.5.5.1.2" xref="S3.E3.m1.5.5.5.5.5.5.1.2.cmml">i</mi><mo id="S3.E3.m1.5.5.5.5.5.5.1.1" xref="S3.E3.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><mi id="S3.E3.m1.5.5.5.5.5.5.1.3" xref="S3.E3.m1.5.5.5.5.5.5.1.3.cmml">n</mi><mo id="S3.E3.m1.5.5.5.5.5.5.1.1a" xref="S3.E3.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><mi id="S3.E3.m1.5.5.5.5.5.5.1.4" xref="S3.E3.m1.5.5.5.5.5.5.1.4.cmml">s</mi></mrow></msub><mo id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.37.37.1.1.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.7.7.7.7.7.7" xref="S3.E3.m1.7.7.7.7.7.7a.cmml">y</mtext><mo id="S3.E3.m1.8.8.8.8.8.8" stretchy="false" xref="S3.E3.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.9.9.9.9" rspace="0.111em" xref="S3.E3.m1.9.9.9.9.9.9.cmml">=</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2"><msubsup id="S3.E3.m1.38.38.2.37.37.37.37.1.2.2"><mo id="S3.E3.m1.10.10.10.10.10.10" rspace="0em" xref="S3.E3.m1.10.10.10.10.10.10.cmml">∑</mo><mrow id="S3.E3.m1.11.11.11.11.11.11.1" xref="S3.E3.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E3.m1.11.11.11.11.11.11.1.2" xref="S3.E3.m1.11.11.11.11.11.11.1.2.cmml">j</mi><mo id="S3.E3.m1.11.11.11.11.11.11.1.1" xref="S3.E3.m1.11.11.11.11.11.11.1.1.cmml">=</mo><mn id="S3.E3.m1.11.11.11.11.11.11.1.3" xref="S3.E3.m1.11.11.11.11.11.11.1.3.cmml">1</mn></mrow><mi id="S3.E3.m1.12.12.12.12.12.12.1" xref="S3.E3.m1.12.12.12.12.12.12.1.cmml">S</mi></msubsup><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1"><mo id="S3.E3.m1.13.13.13.13.13.13" xref="S3.E3.m1.37.37.1.1.1.cmml">[</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1"><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1"><mo id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1a" rspace="0.167em" xref="S3.E3.m1.37.37.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1"><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.3"><mi id="S3.E3.m1.15.15.15.15.15.15" xref="S3.E3.m1.15.15.15.15.15.15.cmml">log</mi><mo id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E3.m1.37.37.1.1.1.cmml">⁡</mo><msub id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.3.1"><mi id="S3.E3.m1.16.16.16.16.16.16" xref="S3.E3.m1.16.16.16.16.16.16.cmml">p</mi><mrow id="S3.E3.m1.17.17.17.17.17.17.1" xref="S3.E3.m1.17.17.17.17.17.17.1.cmml"><mi id="S3.E3.m1.17.17.17.17.17.17.1.3" xref="S3.E3.m1.17.17.17.17.17.17.1.3.cmml">σ</mi><mo id="S3.E3.m1.17.17.17.17.17.17.1.2" xref="S3.E3.m1.17.17.17.17.17.17.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.17.17.17.17.17.17.1.4.2" xref="S3.E3.m1.17.17.17.17.17.17.1.cmml"><mo id="S3.E3.m1.17.17.17.17.17.17.1.4.2.1" stretchy="false" xref="S3.E3.m1.17.17.17.17.17.17.1.cmml">(</mo><mi id="S3.E3.m1.17.17.17.17.17.17.1.1" xref="S3.E3.m1.17.17.17.17.17.17.1.1.cmml">j</mi><mo id="S3.E3.m1.17.17.17.17.17.17.1.4.2.2" stretchy="false" xref="S3.E3.m1.17.17.17.17.17.17.1.cmml">)</mo></mrow></mrow></msub></mrow><mo id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.2" xref="S3.E3.m1.37.37.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.1.1"><mo id="S3.E3.m1.18.18.18.18.18.18" stretchy="false" xref="S3.E3.m1.37.37.1.1.1.cmml">(</mo><msup id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.1.1.1"><mi id="S3.E3.m1.19.19.19.19.19.19" xref="S3.E3.m1.19.19.19.19.19.19.cmml">c</mi><mi id="S3.E3.m1.20.20.20.20.20.20.1" xref="S3.E3.m1.20.20.20.20.20.20.1.cmml">j</mi></msup><mo id="S3.E3.m1.21.21.21.21.21.21" stretchy="false" xref="S3.E3.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.22.22.22.22.22.22" xref="S3.E3.m1.22.22.22.22.22.22.cmml">+</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3"><msub id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.4"><mn id="S3.E3.m1.23.23.23.23.23.23" xref="S3.E3.m1.23.23.23.23.23.23.cmml">𝟙</mn><mrow id="S3.E3.m1.24.24.24.24.24.24.1" xref="S3.E3.m1.24.24.24.24.24.24.1.cmml"><msup id="S3.E3.m1.24.24.24.24.24.24.1.2" xref="S3.E3.m1.24.24.24.24.24.24.1.2.cmml"><mi id="S3.E3.m1.24.24.24.24.24.24.1.2.2" xref="S3.E3.m1.24.24.24.24.24.24.1.2.2.cmml">c</mi><mi id="S3.E3.m1.24.24.24.24.24.24.1.2.3" xref="S3.E3.m1.24.24.24.24.24.24.1.2.3.cmml">j</mi></msup><mo id="S3.E3.m1.24.24.24.24.24.24.1.1" xref="S3.E3.m1.24.24.24.24.24.24.1.1.cmml">≠</mo><mi id="S3.E3.m1.24.24.24.24.24.24.1.3" mathvariant="normal" xref="S3.E3.m1.24.24.24.24.24.24.1.3.cmml">∅</mi></mrow></msub><mo id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.3" xref="S3.E3.m1.37.37.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.5"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.25.25.25.25.25.25" xref="S3.E3.m1.25.25.25.25.25.25.cmml">ℒ</mi><mtext id="S3.E3.m1.26.26.26.26.26.26.1" xref="S3.E3.m1.26.26.26.26.26.26.1a.cmml">mask</mtext></msub><mo id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.3a" xref="S3.E3.m1.37.37.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.2.2"><mo id="S3.E3.m1.27.27.27.27.27.27" stretchy="false" xref="S3.E3.m1.37.37.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.2.1.1.1"><mover accent="true" id="S3.E3.m1.28.28.28.28.28.28" xref="S3.E3.m1.28.28.28.28.28.28.cmml"><mi id="S3.E3.m1.28.28.28.28.28.28.2" xref="S3.E3.m1.28.28.28.28.28.28.2.cmml">m</mi><mo id="S3.E3.m1.28.28.28.28.28.28.1" xref="S3.E3.m1.28.28.28.28.28.28.1.cmml">^</mo></mover><mrow id="S3.E3.m1.30.30.30.30.30.30.1" xref="S3.E3.m1.30.30.30.30.30.30.1.cmml"><mi id="S3.E3.m1.30.30.30.30.30.30.1.2" xref="S3.E3.m1.30.30.30.30.30.30.1.2.cmml">i</mi><mo id="S3.E3.m1.30.30.30.30.30.30.1.1" xref="S3.E3.m1.30.30.30.30.30.30.1.1.cmml">⁢</mo><mi id="S3.E3.m1.30.30.30.30.30.30.1.3" xref="S3.E3.m1.30.30.30.30.30.30.1.3.cmml">n</mi><mo id="S3.E3.m1.30.30.30.30.30.30.1.1a" xref="S3.E3.m1.30.30.30.30.30.30.1.1.cmml">⁢</mo><mi id="S3.E3.m1.30.30.30.30.30.30.1.4" xref="S3.E3.m1.30.30.30.30.30.30.1.4.cmml">s</mi></mrow><mrow id="S3.E3.m1.29.29.29.29.29.29.1" xref="S3.E3.m1.29.29.29.29.29.29.1.cmml"><mi id="S3.E3.m1.29.29.29.29.29.29.1.3" xref="S3.E3.m1.29.29.29.29.29.29.1.3.cmml">σ</mi><mo id="S3.E3.m1.29.29.29.29.29.29.1.2" xref="S3.E3.m1.29.29.29.29.29.29.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.29.29.29.29.29.29.1.4.2" xref="S3.E3.m1.29.29.29.29.29.29.1.cmml"><mo id="S3.E3.m1.29.29.29.29.29.29.1.4.2.1" stretchy="false" xref="S3.E3.m1.29.29.29.29.29.29.1.cmml">(</mo><mi id="S3.E3.m1.29.29.29.29.29.29.1.1" xref="S3.E3.m1.29.29.29.29.29.29.1.1.cmml">j</mi><mo id="S3.E3.m1.29.29.29.29.29.29.1.4.2.2" stretchy="false" xref="S3.E3.m1.29.29.29.29.29.29.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S3.E3.m1.31.31.31.31.31.31" xref="S3.E3.m1.37.37.1.1.1.cmml">,</mo><msup id="S3.E3.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.2.2.2"><mi id="S3.E3.m1.32.32.32.32.32.32" xref="S3.E3.m1.32.32.32.32.32.32.cmml">m</mi><mi id="S3.E3.m1.33.33.33.33.33.33.1" xref="S3.E3.m1.33.33.33.33.33.33.1.cmml">j</mi></msup><mo id="S3.E3.m1.34.34.34.34.34.34" stretchy="false" xref="S3.E3.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.35.35.35.35.35.35" xref="S3.E3.m1.37.37.1.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E3.m1.36.36.36.36.36.36" xref="S3.E3.m1.37.37.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.38b"><apply id="S3.E3.m1.37.37.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><eq id="S3.E3.m1.9.9.9.9.9.9.cmml" xref="S3.E3.m1.9.9.9.9.9.9"></eq><apply id="S3.E3.m1.37.37.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><times id="S3.E3.m1.37.37.1.1.1.1.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"></times><apply id="S3.E3.m1.37.37.1.1.1.1.3.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.1.3.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">ℒ</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1a.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1"><mtext id="S3.E3.m1.2.2.2.2.2.2.1.cmml" mathsize="70%" xref="S3.E3.m1.2.2.2.2.2.2.1">Hungarian</mtext></ci></apply><interval closure="open" id="S3.E3.m1.37.37.1.1.1.1.1.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><apply id="S3.E3.m1.37.37.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><apply id="S3.E3.m1.4.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4.4"><ci id="S3.E3.m1.4.4.4.4.4.4.1.cmml" xref="S3.E3.m1.4.4.4.4.4.4.1">^</ci><ci id="S3.E3.m1.4.4.4.4.4.4.2a.cmml" xref="S3.E3.m1.4.4.4.4.4.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.4.4.4.4.4.4.2.cmml" xref="S3.E3.m1.4.4.4.4.4.4.2">y</mtext></ci></apply><apply id="S3.E3.m1.5.5.5.5.5.5.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1"><times id="S3.E3.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.1"></times><ci id="S3.E3.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.2">𝑖</ci><ci id="S3.E3.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.3">𝑛</ci><ci id="S3.E3.m1.5.5.5.5.5.5.1.4.cmml" xref="S3.E3.m1.5.5.5.5.5.5.1.4">𝑠</ci></apply></apply><ci id="S3.E3.m1.7.7.7.7.7.7a.cmml" xref="S3.E3.m1.7.7.7.7.7.7"><mtext class="ltx_mathvariant_bold" id="S3.E3.m1.7.7.7.7.7.7.cmml" xref="S3.E3.m1.7.7.7.7.7.7">y</mtext></ci></interval></apply><apply id="S3.E3.m1.37.37.1.1.1.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><apply id="S3.E3.m1.37.37.1.1.1.2.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.2.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><apply id="S3.E3.m1.37.37.1.1.1.2.2.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><sum id="S3.E3.m1.10.10.10.10.10.10.cmml" xref="S3.E3.m1.10.10.10.10.10.10"></sum><apply id="S3.E3.m1.11.11.11.11.11.11.1.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1"><eq id="S3.E3.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.1"></eq><ci id="S3.E3.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E3.m1.11.11.11.11.11.11.1.2">𝑗</ci><cn id="S3.E3.m1.11.11.11.11.11.11.1.3.cmml" type="integer" xref="S3.E3.m1.11.11.11.11.11.11.1.3">1</cn></apply></apply><ci id="S3.E3.m1.12.12.12.12.12.12.1.cmml" xref="S3.E3.m1.12.12.12.12.12.12.1">𝑆</ci></apply><apply id="S3.E3.m1.37.37.1.1.1.2.1.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="latexml" id="S3.E3.m1.37.37.1.1.1.2.1.2.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><plus id="S3.E3.m1.22.22.22.22.22.22.cmml" xref="S3.E3.m1.22.22.22.22.22.22"></plus><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><minus id="S3.E3.m1.14.14.14.14.14.14.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"></minus><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><times id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"></times><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><log id="S3.E3.m1.15.15.15.15.15.15.cmml" xref="S3.E3.m1.15.15.15.15.15.15"></log><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><ci id="S3.E3.m1.16.16.16.16.16.16.cmml" xref="S3.E3.m1.16.16.16.16.16.16">𝑝</ci><apply id="S3.E3.m1.17.17.17.17.17.17.1.cmml" xref="S3.E3.m1.17.17.17.17.17.17.1"><times id="S3.E3.m1.17.17.17.17.17.17.1.2.cmml" xref="S3.E3.m1.17.17.17.17.17.17.1.2"></times><ci id="S3.E3.m1.17.17.17.17.17.17.1.3.cmml" xref="S3.E3.m1.17.17.17.17.17.17.1.3">𝜎</ci><ci id="S3.E3.m1.17.17.17.17.17.17.1.1.cmml" xref="S3.E3.m1.17.17.17.17.17.17.1.1">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><ci id="S3.E3.m1.19.19.19.19.19.19.cmml" xref="S3.E3.m1.19.19.19.19.19.19">𝑐</ci><ci id="S3.E3.m1.20.20.20.20.20.20.1.cmml" xref="S3.E3.m1.20.20.20.20.20.20.1">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><times id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"></times><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.4.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.4.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><cn id="S3.E3.m1.23.23.23.23.23.23.cmml" type="integer" xref="S3.E3.m1.23.23.23.23.23.23">1</cn><apply id="S3.E3.m1.24.24.24.24.24.24.1.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1"><neq id="S3.E3.m1.24.24.24.24.24.24.1.1.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1.1"></neq><apply id="S3.E3.m1.24.24.24.24.24.24.1.2.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.24.24.24.24.24.24.1.2.1.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1.2">superscript</csymbol><ci id="S3.E3.m1.24.24.24.24.24.24.1.2.2.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1.2.2">𝑐</ci><ci id="S3.E3.m1.24.24.24.24.24.24.1.2.3.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1.2.3">𝑗</ci></apply><emptyset id="S3.E3.m1.24.24.24.24.24.24.1.3.cmml" xref="S3.E3.m1.24.24.24.24.24.24.1.3"></emptyset></apply></apply><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.5.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.5.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><ci id="S3.E3.m1.25.25.25.25.25.25.cmml" xref="S3.E3.m1.25.25.25.25.25.25">ℒ</ci><ci id="S3.E3.m1.26.26.26.26.26.26.1a.cmml" xref="S3.E3.m1.26.26.26.26.26.26.1"><mtext id="S3.E3.m1.26.26.26.26.26.26.1.cmml" mathsize="70%" xref="S3.E3.m1.26.26.26.26.26.26.1">mask</mtext></ci></apply><interval closure="open" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.2.3.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><apply id="S3.E3.m1.28.28.28.28.28.28.cmml" xref="S3.E3.m1.28.28.28.28.28.28"><ci id="S3.E3.m1.28.28.28.28.28.28.1.cmml" xref="S3.E3.m1.28.28.28.28.28.28.1">^</ci><ci id="S3.E3.m1.28.28.28.28.28.28.2.cmml" xref="S3.E3.m1.28.28.28.28.28.28.2">𝑚</ci></apply><apply id="S3.E3.m1.29.29.29.29.29.29.1.cmml" xref="S3.E3.m1.29.29.29.29.29.29.1"><times id="S3.E3.m1.29.29.29.29.29.29.1.2.cmml" xref="S3.E3.m1.29.29.29.29.29.29.1.2"></times><ci id="S3.E3.m1.29.29.29.29.29.29.1.3.cmml" xref="S3.E3.m1.29.29.29.29.29.29.1.3">𝜎</ci><ci id="S3.E3.m1.29.29.29.29.29.29.1.1.cmml" xref="S3.E3.m1.29.29.29.29.29.29.1.1">𝑗</ci></apply></apply><apply id="S3.E3.m1.30.30.30.30.30.30.1.cmml" xref="S3.E3.m1.30.30.30.30.30.30.1"><times id="S3.E3.m1.30.30.30.30.30.30.1.1.cmml" xref="S3.E3.m1.30.30.30.30.30.30.1.1"></times><ci id="S3.E3.m1.30.30.30.30.30.30.1.2.cmml" xref="S3.E3.m1.30.30.30.30.30.30.1.2">𝑖</ci><ci id="S3.E3.m1.30.30.30.30.30.30.1.3.cmml" xref="S3.E3.m1.30.30.30.30.30.30.1.3">𝑛</ci><ci id="S3.E3.m1.30.30.30.30.30.30.1.4.cmml" xref="S3.E3.m1.30.30.30.30.30.30.1.4">𝑠</ci></apply></apply><apply id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.37.37.1.1.1.2.1.1.1.3.2.2.2.1.cmml" xref="S3.E3.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><ci id="S3.E3.m1.32.32.32.32.32.32.cmml" xref="S3.E3.m1.32.32.32.32.32.32">𝑚</ci><ci id="S3.E3.m1.33.33.33.33.33.33.1.cmml" xref="S3.E3.m1.33.33.33.33.33.33.1">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.38c">\begin{split}\mathcal{L}_{\text{Hungarian}}(\hat{\textbf{y}}_{ins},\textbf{y})%
=\sum\nolimits_{j=1}^{S}\left[-\log p_{\sigma(j)}(c^{j})+\mathds{1}_{c^{j}\neq%
\varnothing}\mathcal{L}_{\text{mask}}(\hat{m}^{\sigma(j)}_{ins},m^{j})\right],%
\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.38d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT Hungarian end_POSTSUBSCRIPT ( over^ start_ARG y end_ARG start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT , y ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT [ - roman_log italic_p start_POSTSUBSCRIPT italic_σ ( italic_j ) end_POSTSUBSCRIPT ( italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) + blackboard_1 start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ≠ ∅ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT ( over^ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_σ ( italic_j ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_n italic_s end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.18">where
<math alttext="\sigma(j)" class="ltx_Math" display="inline" id="S3.SS3.p3.16.m1.1"><semantics id="S3.SS3.p3.16.m1.1a"><mrow id="S3.SS3.p3.16.m1.1.2" xref="S3.SS3.p3.16.m1.1.2.cmml"><mi id="S3.SS3.p3.16.m1.1.2.2" xref="S3.SS3.p3.16.m1.1.2.2.cmml">σ</mi><mo id="S3.SS3.p3.16.m1.1.2.1" xref="S3.SS3.p3.16.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p3.16.m1.1.2.3.2" xref="S3.SS3.p3.16.m1.1.2.cmml"><mo id="S3.SS3.p3.16.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p3.16.m1.1.2.cmml">(</mo><mi id="S3.SS3.p3.16.m1.1.1" xref="S3.SS3.p3.16.m1.1.1.cmml">j</mi><mo id="S3.SS3.p3.16.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p3.16.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.16.m1.1b"><apply id="S3.SS3.p3.16.m1.1.2.cmml" xref="S3.SS3.p3.16.m1.1.2"><times id="S3.SS3.p3.16.m1.1.2.1.cmml" xref="S3.SS3.p3.16.m1.1.2.1"></times><ci id="S3.SS3.p3.16.m1.1.2.2.cmml" xref="S3.SS3.p3.16.m1.1.2.2">𝜎</ci><ci id="S3.SS3.p3.16.m1.1.1.cmml" xref="S3.SS3.p3.16.m1.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.16.m1.1c">\sigma(j)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.16.m1.1d">italic_σ ( italic_j )</annotation></semantics></math> denotes the resulting index of the bipartite matching. To endow SINE with the ability to predict an identical object, we use the different cropped views of the same instance within the image as reference-target image pairs. Let <math alttext="\hat{\textbf{y}}_{id}=\{\hat{y}_{id}^{i}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS3.p3.17.m2.1"><semantics id="S3.SS3.p3.17.m2.1a"><mrow id="S3.SS3.p3.17.m2.1.1" xref="S3.SS3.p3.17.m2.1.1.cmml"><msub id="S3.SS3.p3.17.m2.1.1.3" xref="S3.SS3.p3.17.m2.1.1.3.cmml"><mover accent="true" id="S3.SS3.p3.17.m2.1.1.3.2" xref="S3.SS3.p3.17.m2.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.17.m2.1.1.3.2.2" xref="S3.SS3.p3.17.m2.1.1.3.2.2a.cmml">y</mtext><mo id="S3.SS3.p3.17.m2.1.1.3.2.1" xref="S3.SS3.p3.17.m2.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.17.m2.1.1.3.3" xref="S3.SS3.p3.17.m2.1.1.3.3.cmml"><mi id="S3.SS3.p3.17.m2.1.1.3.3.2" xref="S3.SS3.p3.17.m2.1.1.3.3.2.cmml">i</mi><mo id="S3.SS3.p3.17.m2.1.1.3.3.1" xref="S3.SS3.p3.17.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.17.m2.1.1.3.3.3" xref="S3.SS3.p3.17.m2.1.1.3.3.3.cmml">d</mi></mrow></msub><mo id="S3.SS3.p3.17.m2.1.1.2" xref="S3.SS3.p3.17.m2.1.1.2.cmml">=</mo><msubsup id="S3.SS3.p3.17.m2.1.1.1" xref="S3.SS3.p3.17.m2.1.1.1.cmml"><mrow id="S3.SS3.p3.17.m2.1.1.1.1.1.1" xref="S3.SS3.p3.17.m2.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p3.17.m2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.17.m2.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.1" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.1" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.3" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mi id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.3" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS3.p3.17.m2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.17.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.p3.17.m2.1.1.1.1.3" xref="S3.SS3.p3.17.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.17.m2.1.1.1.1.3.2" xref="S3.SS3.p3.17.m2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.17.m2.1.1.1.1.3.1" xref="S3.SS3.p3.17.m2.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.p3.17.m2.1.1.1.1.3.3" xref="S3.SS3.p3.17.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p3.17.m2.1.1.1.3" xref="S3.SS3.p3.17.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.17.m2.1b"><apply id="S3.SS3.p3.17.m2.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1"><eq id="S3.SS3.p3.17.m2.1.1.2.cmml" xref="S3.SS3.p3.17.m2.1.1.2"></eq><apply id="S3.SS3.p3.17.m2.1.1.3.cmml" xref="S3.SS3.p3.17.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.3.1.cmml" xref="S3.SS3.p3.17.m2.1.1.3">subscript</csymbol><apply id="S3.SS3.p3.17.m2.1.1.3.2.cmml" xref="S3.SS3.p3.17.m2.1.1.3.2"><ci id="S3.SS3.p3.17.m2.1.1.3.2.1.cmml" xref="S3.SS3.p3.17.m2.1.1.3.2.1">^</ci><ci id="S3.SS3.p3.17.m2.1.1.3.2.2a.cmml" xref="S3.SS3.p3.17.m2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p3.17.m2.1.1.3.2.2.cmml" xref="S3.SS3.p3.17.m2.1.1.3.2.2">y</mtext></ci></apply><apply id="S3.SS3.p3.17.m2.1.1.3.3.cmml" xref="S3.SS3.p3.17.m2.1.1.3.3"><times id="S3.SS3.p3.17.m2.1.1.3.3.1.cmml" xref="S3.SS3.p3.17.m2.1.1.3.3.1"></times><ci id="S3.SS3.p3.17.m2.1.1.3.3.2.cmml" xref="S3.SS3.p3.17.m2.1.1.3.3.2">𝑖</ci><ci id="S3.SS3.p3.17.m2.1.1.3.3.3.cmml" xref="S3.SS3.p3.17.m2.1.1.3.3.3">𝑑</ci></apply></apply><apply id="S3.SS3.p3.17.m2.1.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.1.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.17.m2.1.1.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.1.1.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1">subscript</csymbol><set id="S3.SS3.p3.17.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1"><apply id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2"><ci id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><apply id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3"><times id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS3.p3.17.m2.1.1.1.1.3.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.3"><eq id="S3.SS3.p3.17.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.3.1"></eq><ci id="S3.SS3.p3.17.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.17.m2.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS3.p3.17.m2.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p3.17.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p3.17.m2.1.1.1.3.cmml" xref="S3.SS3.p3.17.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.17.m2.1c">\hat{\textbf{y}}_{id}=\{\hat{y}_{id}^{i}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.17.m2.1d">over^ start_ARG y end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT = { over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> denote the set of <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p3.18.m3.1"><semantics id="S3.SS3.p3.18.m3.1a"><mi id="S3.SS3.p3.18.m3.1.1" xref="S3.SS3.p3.18.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.18.m3.1b"><ci id="S3.SS3.p3.18.m3.1.1.cmml" xref="S3.SS3.p3.18.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.18.m3.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.18.m3.1d">italic_N</annotation></semantics></math> ID predictions. Because the relationship between reference and target IDs is fixed and can be accurately determined, we perform fixed matching between the predictions and the ground truth. The loss can be written as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{\text{ID}}(\hat{\textbf{y}}_{id},\textbf{y})=\sum%
\nolimits_{i=1}^{N}\left[-\log p_{i}(c^{i})+\mathds{1}_{c^{i}\neq\varnothing}%
\mathcal{L}_{\text{mask}}(\hat{m}^{i}_{id},m^{i})\right],\end{split}" class="ltx_Math" display="block" id="S3.E4.m1.38"><semantics id="S3.E4.m1.38a"><mtable displaystyle="true" id="S3.E4.m1.38.38.2"><mtr id="S3.E4.m1.38.38.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.38.38.2b"><mrow id="S3.E4.m1.38.38.2.37.37.37.37"><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1"><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.1"><msub id="S3.E4.m1.38.38.2.37.37.37.37.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">ℒ</mi><mtext id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1a.cmml">ID</mtext></msub><mo id="S3.E4.m1.38.38.2.37.37.37.37.1.1.2" xref="S3.E4.m1.37.37.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.1.1.1"><mo id="S3.E4.m1.3.3.3.3.3.3" stretchy="false" xref="S3.E4.m1.37.37.1.1.1.cmml">(</mo><msub id="S3.E4.m1.38.38.2.37.37.37.37.1.1.1.1.1"><mover accent="true" id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.4.4.4.4.4.4.2" xref="S3.E4.m1.4.4.4.4.4.4.2a.cmml">y</mtext><mo id="S3.E4.m1.4.4.4.4.4.4.1" xref="S3.E4.m1.4.4.4.4.4.4.1.cmml">^</mo></mover><mrow id="S3.E4.m1.5.5.5.5.5.5.1" xref="S3.E4.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E4.m1.5.5.5.5.5.5.1.2" xref="S3.E4.m1.5.5.5.5.5.5.1.2.cmml">i</mi><mo id="S3.E4.m1.5.5.5.5.5.5.1.1" xref="S3.E4.m1.5.5.5.5.5.5.1.1.cmml">⁢</mo><mi id="S3.E4.m1.5.5.5.5.5.5.1.3" xref="S3.E4.m1.5.5.5.5.5.5.1.3.cmml">d</mi></mrow></msub><mo id="S3.E4.m1.6.6.6.6.6.6" xref="S3.E4.m1.37.37.1.1.1.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.7.7.7.7.7.7" xref="S3.E4.m1.7.7.7.7.7.7a.cmml">y</mtext><mo id="S3.E4.m1.8.8.8.8.8.8" stretchy="false" xref="S3.E4.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.9.9.9.9.9.9" rspace="0.111em" xref="S3.E4.m1.9.9.9.9.9.9.cmml">=</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2"><msubsup id="S3.E4.m1.38.38.2.37.37.37.37.1.2.2"><mo id="S3.E4.m1.10.10.10.10.10.10" rspace="0em" xref="S3.E4.m1.10.10.10.10.10.10.cmml">∑</mo><mrow id="S3.E4.m1.11.11.11.11.11.11.1" xref="S3.E4.m1.11.11.11.11.11.11.1.cmml"><mi id="S3.E4.m1.11.11.11.11.11.11.1.2" xref="S3.E4.m1.11.11.11.11.11.11.1.2.cmml">i</mi><mo id="S3.E4.m1.11.11.11.11.11.11.1.1" xref="S3.E4.m1.11.11.11.11.11.11.1.1.cmml">=</mo><mn id="S3.E4.m1.11.11.11.11.11.11.1.3" xref="S3.E4.m1.11.11.11.11.11.11.1.3.cmml">1</mn></mrow><mi id="S3.E4.m1.12.12.12.12.12.12.1" xref="S3.E4.m1.12.12.12.12.12.12.1.cmml">N</mi></msubsup><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1"><mo id="S3.E4.m1.13.13.13.13.13.13" xref="S3.E4.m1.37.37.1.1.1.cmml">[</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1"><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1"><mo id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1a" rspace="0.167em" xref="S3.E4.m1.37.37.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1"><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.3"><mi id="S3.E4.m1.15.15.15.15.15.15" xref="S3.E4.m1.15.15.15.15.15.15.cmml">log</mi><mo id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.37.37.1.1.1.cmml">⁡</mo><msub id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.3.1"><mi id="S3.E4.m1.16.16.16.16.16.16" xref="S3.E4.m1.16.16.16.16.16.16.cmml">p</mi><mi id="S3.E4.m1.17.17.17.17.17.17.1" xref="S3.E4.m1.17.17.17.17.17.17.1.cmml">i</mi></msub></mrow><mo id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.2" xref="S3.E4.m1.37.37.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.1.1"><mo id="S3.E4.m1.18.18.18.18.18.18" stretchy="false" xref="S3.E4.m1.37.37.1.1.1.cmml">(</mo><msup id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.1.1.1.1.1"><mi id="S3.E4.m1.19.19.19.19.19.19" xref="S3.E4.m1.19.19.19.19.19.19.cmml">c</mi><mi id="S3.E4.m1.20.20.20.20.20.20.1" xref="S3.E4.m1.20.20.20.20.20.20.1.cmml">i</mi></msup><mo id="S3.E4.m1.21.21.21.21.21.21" stretchy="false" xref="S3.E4.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.22.22.22.22.22.22" xref="S3.E4.m1.22.22.22.22.22.22.cmml">+</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3"><msub id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.4"><mn id="S3.E4.m1.23.23.23.23.23.23" xref="S3.E4.m1.23.23.23.23.23.23.cmml">𝟙</mn><mrow id="S3.E4.m1.24.24.24.24.24.24.1" xref="S3.E4.m1.24.24.24.24.24.24.1.cmml"><msup id="S3.E4.m1.24.24.24.24.24.24.1.2" xref="S3.E4.m1.24.24.24.24.24.24.1.2.cmml"><mi id="S3.E4.m1.24.24.24.24.24.24.1.2.2" xref="S3.E4.m1.24.24.24.24.24.24.1.2.2.cmml">c</mi><mi id="S3.E4.m1.24.24.24.24.24.24.1.2.3" xref="S3.E4.m1.24.24.24.24.24.24.1.2.3.cmml">i</mi></msup><mo id="S3.E4.m1.24.24.24.24.24.24.1.1" xref="S3.E4.m1.24.24.24.24.24.24.1.1.cmml">≠</mo><mi id="S3.E4.m1.24.24.24.24.24.24.1.3" mathvariant="normal" xref="S3.E4.m1.24.24.24.24.24.24.1.3.cmml">∅</mi></mrow></msub><mo id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.3" xref="S3.E4.m1.37.37.1.1.1.cmml">⁢</mo><msub id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.5"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.25.25.25.25.25.25" xref="S3.E4.m1.25.25.25.25.25.25.cmml">ℒ</mi><mtext id="S3.E4.m1.26.26.26.26.26.26.1" xref="S3.E4.m1.26.26.26.26.26.26.1a.cmml">mask</mtext></msub><mo id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.3a" xref="S3.E4.m1.37.37.1.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.2.2"><mo id="S3.E4.m1.27.27.27.27.27.27" stretchy="false" xref="S3.E4.m1.37.37.1.1.1.cmml">(</mo><msubsup id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.2.1.1.1"><mover accent="true" id="S3.E4.m1.28.28.28.28.28.28" xref="S3.E4.m1.28.28.28.28.28.28.cmml"><mi id="S3.E4.m1.28.28.28.28.28.28.2" xref="S3.E4.m1.28.28.28.28.28.28.2.cmml">m</mi><mo id="S3.E4.m1.28.28.28.28.28.28.1" xref="S3.E4.m1.28.28.28.28.28.28.1.cmml">^</mo></mover><mrow id="S3.E4.m1.30.30.30.30.30.30.1" xref="S3.E4.m1.30.30.30.30.30.30.1.cmml"><mi id="S3.E4.m1.30.30.30.30.30.30.1.2" xref="S3.E4.m1.30.30.30.30.30.30.1.2.cmml">i</mi><mo id="S3.E4.m1.30.30.30.30.30.30.1.1" xref="S3.E4.m1.30.30.30.30.30.30.1.1.cmml">⁢</mo><mi id="S3.E4.m1.30.30.30.30.30.30.1.3" xref="S3.E4.m1.30.30.30.30.30.30.1.3.cmml">d</mi></mrow><mi id="S3.E4.m1.29.29.29.29.29.29.1" xref="S3.E4.m1.29.29.29.29.29.29.1.cmml">i</mi></msubsup><mo id="S3.E4.m1.31.31.31.31.31.31" xref="S3.E4.m1.37.37.1.1.1.cmml">,</mo><msup id="S3.E4.m1.38.38.2.37.37.37.37.1.2.1.1.1.3.2.2.2"><mi id="S3.E4.m1.32.32.32.32.32.32" xref="S3.E4.m1.32.32.32.32.32.32.cmml">m</mi><mi id="S3.E4.m1.33.33.33.33.33.33.1" xref="S3.E4.m1.33.33.33.33.33.33.1.cmml">i</mi></msup><mo id="S3.E4.m1.34.34.34.34.34.34" stretchy="false" xref="S3.E4.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.35.35.35.35.35.35" xref="S3.E4.m1.37.37.1.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m1.36.36.36.36.36.36" xref="S3.E4.m1.37.37.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.38b"><apply id="S3.E4.m1.37.37.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><eq id="S3.E4.m1.9.9.9.9.9.9.cmml" xref="S3.E4.m1.9.9.9.9.9.9"></eq><apply id="S3.E4.m1.37.37.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><times id="S3.E4.m1.37.37.1.1.1.1.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"></times><apply id="S3.E4.m1.37.37.1.1.1.1.3.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.1.3.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">ℒ</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1a.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1"><mtext id="S3.E4.m1.2.2.2.2.2.2.1.cmml" mathsize="70%" xref="S3.E4.m1.2.2.2.2.2.2.1">ID</mtext></ci></apply><interval closure="open" id="S3.E4.m1.37.37.1.1.1.1.1.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><apply id="S3.E4.m1.37.37.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><apply id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4"><ci id="S3.E4.m1.4.4.4.4.4.4.1.cmml" xref="S3.E4.m1.4.4.4.4.4.4.1">^</ci><ci id="S3.E4.m1.4.4.4.4.4.4.2a.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.4.4.4.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4.4.4.4.2">y</mtext></ci></apply><apply id="S3.E4.m1.5.5.5.5.5.5.1.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1"><times id="S3.E4.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.1"></times><ci id="S3.E4.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.2">𝑖</ci><ci id="S3.E4.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.3">𝑑</ci></apply></apply><ci id="S3.E4.m1.7.7.7.7.7.7a.cmml" xref="S3.E4.m1.7.7.7.7.7.7"><mtext class="ltx_mathvariant_bold" id="S3.E4.m1.7.7.7.7.7.7.cmml" xref="S3.E4.m1.7.7.7.7.7.7">y</mtext></ci></interval></apply><apply id="S3.E4.m1.37.37.1.1.1.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><apply id="S3.E4.m1.37.37.1.1.1.2.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.2.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><apply id="S3.E4.m1.37.37.1.1.1.2.2.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><sum id="S3.E4.m1.10.10.10.10.10.10.cmml" xref="S3.E4.m1.10.10.10.10.10.10"></sum><apply id="S3.E4.m1.11.11.11.11.11.11.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1"><eq id="S3.E4.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.1"></eq><ci id="S3.E4.m1.11.11.11.11.11.11.1.2.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2">𝑖</ci><cn id="S3.E4.m1.11.11.11.11.11.11.1.3.cmml" type="integer" xref="S3.E4.m1.11.11.11.11.11.11.1.3">1</cn></apply></apply><ci id="S3.E4.m1.12.12.12.12.12.12.1.cmml" xref="S3.E4.m1.12.12.12.12.12.12.1">𝑁</ci></apply><apply id="S3.E4.m1.37.37.1.1.1.2.1.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="latexml" id="S3.E4.m1.37.37.1.1.1.2.1.2.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><plus id="S3.E4.m1.22.22.22.22.22.22.cmml" xref="S3.E4.m1.22.22.22.22.22.22"></plus><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><minus id="S3.E4.m1.14.14.14.14.14.14.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"></minus><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><times id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"></times><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><log id="S3.E4.m1.15.15.15.15.15.15.cmml" xref="S3.E4.m1.15.15.15.15.15.15"></log><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><ci id="S3.E4.m1.16.16.16.16.16.16.cmml" xref="S3.E4.m1.16.16.16.16.16.16">𝑝</ci><ci id="S3.E4.m1.17.17.17.17.17.17.1.cmml" xref="S3.E4.m1.17.17.17.17.17.17.1">𝑖</ci></apply></apply><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><ci id="S3.E4.m1.19.19.19.19.19.19.cmml" xref="S3.E4.m1.19.19.19.19.19.19">𝑐</ci><ci id="S3.E4.m1.20.20.20.20.20.20.1.cmml" xref="S3.E4.m1.20.20.20.20.20.20.1">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><times id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"></times><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.4.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.4.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><cn id="S3.E4.m1.23.23.23.23.23.23.cmml" type="integer" xref="S3.E4.m1.23.23.23.23.23.23">1</cn><apply id="S3.E4.m1.24.24.24.24.24.24.1.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1"><neq id="S3.E4.m1.24.24.24.24.24.24.1.1.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1.1"></neq><apply id="S3.E4.m1.24.24.24.24.24.24.1.2.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.24.24.24.24.24.24.1.2.1.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1.2">superscript</csymbol><ci id="S3.E4.m1.24.24.24.24.24.24.1.2.2.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1.2.2">𝑐</ci><ci id="S3.E4.m1.24.24.24.24.24.24.1.2.3.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1.2.3">𝑖</ci></apply><emptyset id="S3.E4.m1.24.24.24.24.24.24.1.3.cmml" xref="S3.E4.m1.24.24.24.24.24.24.1.3"></emptyset></apply></apply><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.5.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.5.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><ci id="S3.E4.m1.25.25.25.25.25.25.cmml" xref="S3.E4.m1.25.25.25.25.25.25">ℒ</ci><ci id="S3.E4.m1.26.26.26.26.26.26.1a.cmml" xref="S3.E4.m1.26.26.26.26.26.26.1"><mtext id="S3.E4.m1.26.26.26.26.26.26.1.cmml" mathsize="70%" xref="S3.E4.m1.26.26.26.26.26.26.1">mask</mtext></ci></apply><interval closure="open" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.2.3.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">subscript</csymbol><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><apply id="S3.E4.m1.28.28.28.28.28.28.cmml" xref="S3.E4.m1.28.28.28.28.28.28"><ci id="S3.E4.m1.28.28.28.28.28.28.1.cmml" xref="S3.E4.m1.28.28.28.28.28.28.1">^</ci><ci id="S3.E4.m1.28.28.28.28.28.28.2.cmml" xref="S3.E4.m1.28.28.28.28.28.28.2">𝑚</ci></apply><ci id="S3.E4.m1.29.29.29.29.29.29.1.cmml" xref="S3.E4.m1.29.29.29.29.29.29.1">𝑖</ci></apply><apply id="S3.E4.m1.30.30.30.30.30.30.1.cmml" xref="S3.E4.m1.30.30.30.30.30.30.1"><times id="S3.E4.m1.30.30.30.30.30.30.1.1.cmml" xref="S3.E4.m1.30.30.30.30.30.30.1.1"></times><ci id="S3.E4.m1.30.30.30.30.30.30.1.2.cmml" xref="S3.E4.m1.30.30.30.30.30.30.1.2">𝑖</ci><ci id="S3.E4.m1.30.30.30.30.30.30.1.3.cmml" xref="S3.E4.m1.30.30.30.30.30.30.1.3">𝑑</ci></apply></apply><apply id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.37.37.1.1.1.2.1.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.38.38.2.37.37.37.37.1.1.2">superscript</csymbol><ci id="S3.E4.m1.32.32.32.32.32.32.cmml" xref="S3.E4.m1.32.32.32.32.32.32">𝑚</ci><ci id="S3.E4.m1.33.33.33.33.33.33.1.cmml" xref="S3.E4.m1.33.33.33.33.33.33.1">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.38c">\begin{split}\mathcal{L}_{\text{ID}}(\hat{\textbf{y}}_{id},\textbf{y})=\sum%
\nolimits_{i=1}^{N}\left[-\log p_{i}(c^{i})+\mathds{1}_{c^{i}\neq\varnothing}%
\mathcal{L}_{\text{mask}}(\hat{m}^{i}_{id},m^{i})\right],\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.38d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT ( over^ start_ARG y end_ARG start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT , y ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ - roman_log italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) + blackboard_1 start_POSTSUBSCRIPT italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ≠ ∅ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT ( over^ start_ARG italic_m end_ARG start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i italic_d end_POSTSUBSCRIPT , italic_m start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.22">where <math alttext="(c^{i},m^{i})" class="ltx_Math" display="inline" id="S3.SS3.p3.19.m1.2"><semantics id="S3.SS3.p3.19.m1.2a"><mrow id="S3.SS3.p3.19.m1.2.2.2" xref="S3.SS3.p3.19.m1.2.2.3.cmml"><mo id="S3.SS3.p3.19.m1.2.2.2.3" stretchy="false" xref="S3.SS3.p3.19.m1.2.2.3.cmml">(</mo><msup id="S3.SS3.p3.19.m1.1.1.1.1" xref="S3.SS3.p3.19.m1.1.1.1.1.cmml"><mi id="S3.SS3.p3.19.m1.1.1.1.1.2" xref="S3.SS3.p3.19.m1.1.1.1.1.2.cmml">c</mi><mi id="S3.SS3.p3.19.m1.1.1.1.1.3" xref="S3.SS3.p3.19.m1.1.1.1.1.3.cmml">i</mi></msup><mo id="S3.SS3.p3.19.m1.2.2.2.4" xref="S3.SS3.p3.19.m1.2.2.3.cmml">,</mo><msup id="S3.SS3.p3.19.m1.2.2.2.2" xref="S3.SS3.p3.19.m1.2.2.2.2.cmml"><mi id="S3.SS3.p3.19.m1.2.2.2.2.2" xref="S3.SS3.p3.19.m1.2.2.2.2.2.cmml">m</mi><mi id="S3.SS3.p3.19.m1.2.2.2.2.3" xref="S3.SS3.p3.19.m1.2.2.2.2.3.cmml">i</mi></msup><mo id="S3.SS3.p3.19.m1.2.2.2.5" stretchy="false" xref="S3.SS3.p3.19.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.19.m1.2b"><interval closure="open" id="S3.SS3.p3.19.m1.2.2.3.cmml" xref="S3.SS3.p3.19.m1.2.2.2"><apply id="S3.SS3.p3.19.m1.1.1.1.1.cmml" xref="S3.SS3.p3.19.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.19.m1.1.1.1.1.1.cmml" xref="S3.SS3.p3.19.m1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.19.m1.1.1.1.1.2.cmml" xref="S3.SS3.p3.19.m1.1.1.1.1.2">𝑐</ci><ci id="S3.SS3.p3.19.m1.1.1.1.1.3.cmml" xref="S3.SS3.p3.19.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p3.19.m1.2.2.2.2.cmml" xref="S3.SS3.p3.19.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.19.m1.2.2.2.2.1.cmml" xref="S3.SS3.p3.19.m1.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p3.19.m1.2.2.2.2.2.cmml" xref="S3.SS3.p3.19.m1.2.2.2.2.2">𝑚</ci><ci id="S3.SS3.p3.19.m1.2.2.2.2.3.cmml" xref="S3.SS3.p3.19.m1.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.19.m1.2c">(c^{i},m^{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.19.m1.2d">( italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT , italic_m start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT )</annotation></semantics></math> is the ground truth class and mask,
<math alttext="c^{i}\in\{1,\varnothing\}" class="ltx_Math" display="inline" id="S3.SS3.p3.20.m2.2"><semantics id="S3.SS3.p3.20.m2.2a"><mrow id="S3.SS3.p3.20.m2.2.3" xref="S3.SS3.p3.20.m2.2.3.cmml"><msup id="S3.SS3.p3.20.m2.2.3.2" xref="S3.SS3.p3.20.m2.2.3.2.cmml"><mi id="S3.SS3.p3.20.m2.2.3.2.2" xref="S3.SS3.p3.20.m2.2.3.2.2.cmml">c</mi><mi id="S3.SS3.p3.20.m2.2.3.2.3" xref="S3.SS3.p3.20.m2.2.3.2.3.cmml">i</mi></msup><mo id="S3.SS3.p3.20.m2.2.3.1" xref="S3.SS3.p3.20.m2.2.3.1.cmml">∈</mo><mrow id="S3.SS3.p3.20.m2.2.3.3.2" xref="S3.SS3.p3.20.m2.2.3.3.1.cmml"><mo id="S3.SS3.p3.20.m2.2.3.3.2.1" stretchy="false" xref="S3.SS3.p3.20.m2.2.3.3.1.cmml">{</mo><mn id="S3.SS3.p3.20.m2.1.1" xref="S3.SS3.p3.20.m2.1.1.cmml">1</mn><mo id="S3.SS3.p3.20.m2.2.3.3.2.2" xref="S3.SS3.p3.20.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p3.20.m2.2.2" mathvariant="normal" xref="S3.SS3.p3.20.m2.2.2.cmml">∅</mi><mo id="S3.SS3.p3.20.m2.2.3.3.2.3" stretchy="false" xref="S3.SS3.p3.20.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.20.m2.2b"><apply id="S3.SS3.p3.20.m2.2.3.cmml" xref="S3.SS3.p3.20.m2.2.3"><in id="S3.SS3.p3.20.m2.2.3.1.cmml" xref="S3.SS3.p3.20.m2.2.3.1"></in><apply id="S3.SS3.p3.20.m2.2.3.2.cmml" xref="S3.SS3.p3.20.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.20.m2.2.3.2.1.cmml" xref="S3.SS3.p3.20.m2.2.3.2">superscript</csymbol><ci id="S3.SS3.p3.20.m2.2.3.2.2.cmml" xref="S3.SS3.p3.20.m2.2.3.2.2">𝑐</ci><ci id="S3.SS3.p3.20.m2.2.3.2.3.cmml" xref="S3.SS3.p3.20.m2.2.3.2.3">𝑖</ci></apply><set id="S3.SS3.p3.20.m2.2.3.3.1.cmml" xref="S3.SS3.p3.20.m2.2.3.3.2"><cn id="S3.SS3.p3.20.m2.1.1.cmml" type="integer" xref="S3.SS3.p3.20.m2.1.1">1</cn><emptyset id="S3.SS3.p3.20.m2.2.2.cmml" xref="S3.SS3.p3.20.m2.2.2"></emptyset></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.20.m2.2c">c^{i}\in\{1,\varnothing\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.20.m2.2d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ∈ { 1 , ∅ }</annotation></semantics></math>, <math alttext="c^{i}=1" class="ltx_Math" display="inline" id="S3.SS3.p3.21.m3.1"><semantics id="S3.SS3.p3.21.m3.1a"><mrow id="S3.SS3.p3.21.m3.1.1" xref="S3.SS3.p3.21.m3.1.1.cmml"><msup id="S3.SS3.p3.21.m3.1.1.2" xref="S3.SS3.p3.21.m3.1.1.2.cmml"><mi id="S3.SS3.p3.21.m3.1.1.2.2" xref="S3.SS3.p3.21.m3.1.1.2.2.cmml">c</mi><mi id="S3.SS3.p3.21.m3.1.1.2.3" xref="S3.SS3.p3.21.m3.1.1.2.3.cmml">i</mi></msup><mo id="S3.SS3.p3.21.m3.1.1.1" xref="S3.SS3.p3.21.m3.1.1.1.cmml">=</mo><mn id="S3.SS3.p3.21.m3.1.1.3" xref="S3.SS3.p3.21.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.21.m3.1b"><apply id="S3.SS3.p3.21.m3.1.1.cmml" xref="S3.SS3.p3.21.m3.1.1"><eq id="S3.SS3.p3.21.m3.1.1.1.cmml" xref="S3.SS3.p3.21.m3.1.1.1"></eq><apply id="S3.SS3.p3.21.m3.1.1.2.cmml" xref="S3.SS3.p3.21.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.21.m3.1.1.2.1.cmml" xref="S3.SS3.p3.21.m3.1.1.2">superscript</csymbol><ci id="S3.SS3.p3.21.m3.1.1.2.2.cmml" xref="S3.SS3.p3.21.m3.1.1.2.2">𝑐</ci><ci id="S3.SS3.p3.21.m3.1.1.2.3.cmml" xref="S3.SS3.p3.21.m3.1.1.2.3">𝑖</ci></apply><cn id="S3.SS3.p3.21.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p3.21.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.21.m3.1c">c^{i}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.21.m3.1d">italic_c start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = 1</annotation></semantics></math> denotes that an object appears in both reference and target images simultaneously. The total loss is <math alttext="\mathcal{L}=\mathcal{L}_{\text{Hungarian}}+\mathcal{L}_{\text{ID}}" class="ltx_Math" display="inline" id="S3.SS3.p3.22.m4.1"><semantics id="S3.SS3.p3.22.m4.1a"><mrow id="S3.SS3.p3.22.m4.1.1" xref="S3.SS3.p3.22.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.22.m4.1.1.2" xref="S3.SS3.p3.22.m4.1.1.2.cmml">ℒ</mi><mo id="S3.SS3.p3.22.m4.1.1.1" xref="S3.SS3.p3.22.m4.1.1.1.cmml">=</mo><mrow id="S3.SS3.p3.22.m4.1.1.3" xref="S3.SS3.p3.22.m4.1.1.3.cmml"><msub id="S3.SS3.p3.22.m4.1.1.3.2" xref="S3.SS3.p3.22.m4.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.22.m4.1.1.3.2.2" xref="S3.SS3.p3.22.m4.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.SS3.p3.22.m4.1.1.3.2.3" xref="S3.SS3.p3.22.m4.1.1.3.2.3a.cmml">Hungarian</mtext></msub><mo id="S3.SS3.p3.22.m4.1.1.3.1" xref="S3.SS3.p3.22.m4.1.1.3.1.cmml">+</mo><msub id="S3.SS3.p3.22.m4.1.1.3.3" xref="S3.SS3.p3.22.m4.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.22.m4.1.1.3.3.2" xref="S3.SS3.p3.22.m4.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.SS3.p3.22.m4.1.1.3.3.3" xref="S3.SS3.p3.22.m4.1.1.3.3.3a.cmml">ID</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.22.m4.1b"><apply id="S3.SS3.p3.22.m4.1.1.cmml" xref="S3.SS3.p3.22.m4.1.1"><eq id="S3.SS3.p3.22.m4.1.1.1.cmml" xref="S3.SS3.p3.22.m4.1.1.1"></eq><ci id="S3.SS3.p3.22.m4.1.1.2.cmml" xref="S3.SS3.p3.22.m4.1.1.2">ℒ</ci><apply id="S3.SS3.p3.22.m4.1.1.3.cmml" xref="S3.SS3.p3.22.m4.1.1.3"><plus id="S3.SS3.p3.22.m4.1.1.3.1.cmml" xref="S3.SS3.p3.22.m4.1.1.3.1"></plus><apply id="S3.SS3.p3.22.m4.1.1.3.2.cmml" xref="S3.SS3.p3.22.m4.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.22.m4.1.1.3.2.1.cmml" xref="S3.SS3.p3.22.m4.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p3.22.m4.1.1.3.2.2.cmml" xref="S3.SS3.p3.22.m4.1.1.3.2.2">ℒ</ci><ci id="S3.SS3.p3.22.m4.1.1.3.2.3a.cmml" xref="S3.SS3.p3.22.m4.1.1.3.2.3"><mtext id="S3.SS3.p3.22.m4.1.1.3.2.3.cmml" mathsize="70%" xref="S3.SS3.p3.22.m4.1.1.3.2.3">Hungarian</mtext></ci></apply><apply id="S3.SS3.p3.22.m4.1.1.3.3.cmml" xref="S3.SS3.p3.22.m4.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.22.m4.1.1.3.3.1.cmml" xref="S3.SS3.p3.22.m4.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p3.22.m4.1.1.3.3.2.cmml" xref="S3.SS3.p3.22.m4.1.1.3.3.2">ℒ</ci><ci id="S3.SS3.p3.22.m4.1.1.3.3.3a.cmml" xref="S3.SS3.p3.22.m4.1.1.3.3.3"><mtext id="S3.SS3.p3.22.m4.1.1.3.3.3.cmml" mathsize="70%" xref="S3.SS3.p3.22.m4.1.1.3.3.3">ID</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.22.m4.1c">\mathcal{L}=\mathcal{L}_{\text{Hungarian}}+\mathcal{L}_{\text{ID}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.22.m4.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT Hungarian end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT ID end_POSTSUBSCRIPT</annotation></semantics></math>.
Once the training is finished, the full capability of SINE is unleashed during inference. SINE can address the ambiguity within the in-context examples and output predictions for different segmentation tasks.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="S3.F4.g1" src="x4.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Qualitative results of SINE. (a) Comparison between SegGPT and SINE for addressing ambiguity in in-context segmentation. (b) Few-shot semantic segmentation. (c) Few-shot instance segmentation. (d) Video object segmentation.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Training Data</span> We train our model with a diverse set of segmentation datasets, including semantic, instance, and panoptic segmentation. Specifically, we utilize three visual perception datasets:
<span class="ltx_text ltx_font_bold" id="S4.p1.1.2">ADE20K</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx59" title="">ZZP<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>19</a>]</cite> is a popular semantic segmentation dataset, providing semantic labels for 150 categories. For panoptic segmentation, the 150 categories can be divided into 100 “things” and 50 “stuff” categories. It has 25K images, including 20K for training, 2K for validation, and 3K for testing. <span class="ltx_text ltx_font_bold" id="S4.p1.1.3">COCO</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx29" title="">LMB<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>14</a>]</cite> is a widely-used dataset that supports object detection, instance segmentation, and panoptic segmentation. It contains 80 “things” and 53 “stuff” categories, with 118K training and 5K validation images. <span class="ltx_text ltx_font_bold" id="S4.p1.1.4">Objects365</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx47" title="">SLZ<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>19</a>]</cite> is a large-scale high-quality object detection dataset. It contains 365 categories, 638K images, and 10M bounding boxes. We extend instance segmentation annotations for Objects365 by using the Segment Anything Model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx24" title="">KMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>. We convert different data annotations into the form of instance segmentation for unified mixed data training.
<span class="ltx_text ltx_font_bold" id="S4.p1.1.5">Implementation Details</span> are provided in the <span class="ltx_text" id="S4.p1.1.6" style="color:#0000FF;">Appendix</span> <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A2" title="Appendix B Implementation Details ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Qualitative Results</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We demonstrate that our SINE framework can effectively address the ambiguity in the in-context examples. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S3.F4" title="Figure 4 ‣ 3.3 Matching Transformer ‣ 3 Method ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">4</span></a>(a), it is difficult to understand which tasks should be executed via the reference image with an annotation of Geoffrey Hinton. SegGPT only outputs the semantic segmentation result. In contrast, SINE outputs multiple outputs to avoid task ambiguity. We further visualize the results of SINE on few-shot semantic segmentation, few-shot instance segmentation, and video object segmentation. SINE showcases its capability to deliver highly accurate predictions across diverse tasks while retaining exceptional flexibility in the task definition.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.15" style="width:381.6pt;height:155pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-76.3pt,30.8pt) scale(0.714433980841777,0.714433980841777) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.15.15">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.3.3.4" rowspan="2"><span class="ltx_text" id="S4.T1.3.3.3.4.1">Methods</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.3.3.3.5" rowspan="2"><span class="ltx_text" id="S4.T1.3.3.3.5.1">Venue</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S4.T1.1.1.1.1">COCO-20<sup class="ltx_sup" id="S4.T1.1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T1.1.1.1.1.1.1">i</span></sup>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S4.T1.2.2.2.2">PASCAL-5<sup class="ltx_sup" id="S4.T1.2.2.2.2.1"><span class="ltx_text ltx_font_italic" id="S4.T1.2.2.2.2.1.1">i</span></sup>
</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S4.T1.3.3.3.3">LVIS-92<sup class="ltx_sup" id="S4.T1.3.3.3.3.1"><span class="ltx_text ltx_font_italic" id="S4.T1.3.3.3.3.1.1">i</span></sup>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.16.1">
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.16.1.1">one-shot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.16.1.2">few-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.16.1.3">one-shot</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.16.1.4">few-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.16.1.5">one-shot</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.16.1.6">few-shot</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.17.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T1.15.15.17.2.1"><span class="ltx_text ltx_font_italic" id="S4.T1.15.15.17.2.1.1" style="font-size:90%;">specialist segmentation model</span></th>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.17.2.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T1.15.15.17.2.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.17.2.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T1.15.15.17.2.5"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.17.2.6"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.17.2.7"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.7.7.7.5">HSNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx37" title="">MKC21</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.7.7.6">ICCV’21</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4.1"><span class="ltx_text" id="S4.T1.4.4.4.1.1" style="color:#808080;">41.7<sup class="ltx_sup" id="S4.T1.4.4.4.1.1.1"><span class="ltx_text" id="S4.T1.4.4.4.1.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.5.5.5.2"><span class="ltx_text" id="S4.T1.5.5.5.2.1" style="color:#808080;">50.7<sup class="ltx_sup" id="S4.T1.5.5.5.2.1.1"><span class="ltx_text" id="S4.T1.5.5.5.2.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6.3"><span class="ltx_text" id="S4.T1.6.6.6.3.1" style="color:#808080;">68.7<sup class="ltx_sup" id="S4.T1.6.6.6.3.1.1"><span class="ltx_text" id="S4.T1.6.6.6.3.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.7.7.4"><span class="ltx_text" id="S4.T1.7.7.7.4.1" style="color:#808080;">73.8<sup class="ltx_sup" id="S4.T1.7.7.7.4.1.1"><span class="ltx_text" id="S4.T1.7.7.7.4.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.7.7.7">17.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.7.7.8">22.9</td>
</tr>
<tr class="ltx_tr" id="S4.T1.11.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.11.11.11.5">VAT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx16" title="">HCN<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.11.11.11.6">ECCV’22</th>
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.8.1"><span class="ltx_text" id="S4.T1.8.8.8.1.1" style="color:#808080;">42.9<sup class="ltx_sup" id="S4.T1.8.8.8.1.1.1"><span class="ltx_text" id="S4.T1.8.8.8.1.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.9.9.9.2"><span class="ltx_text" id="S4.T1.9.9.9.2.1" style="color:#808080;">49.4<sup class="ltx_sup" id="S4.T1.9.9.9.2.1.1"><span class="ltx_text" id="S4.T1.9.9.9.2.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.10.10.10.3"><span class="ltx_text" id="S4.T1.10.10.10.3.1" style="color:#808080;">72.4<sup class="ltx_sup" id="S4.T1.10.10.10.3.1.1"><span class="ltx_text" id="S4.T1.10.10.10.3.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.11.11.11.4"><span class="ltx_text" id="S4.T1.11.11.11.4.1" style="color:#808080;">76.3<sup class="ltx_sup" id="S4.T1.11.11.11.4.1.1"><span class="ltx_text" id="S4.T1.11.11.11.4.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.11.11.11.7">18.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.11.11.11.8">22.7</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.15.5">FPTrans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx57" title="">ZSYC22</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.15.15.15.6">NeurIPS’22</th>
<td class="ltx_td ltx_align_center" id="S4.T1.12.12.12.1"><span class="ltx_text" id="S4.T1.12.12.12.1.1" style="color:#808080;">56.5<sup class="ltx_sup" id="S4.T1.12.12.12.1.1.1"><span class="ltx_text" id="S4.T1.12.12.12.1.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.13.13.13.2"><span class="ltx_text" id="S4.T1.13.13.13.2.1" style="color:#808080;">65.5<sup class="ltx_sup" id="S4.T1.13.13.13.2.1.1"><span class="ltx_text" id="S4.T1.13.13.13.2.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.14.14.14.3"><span class="ltx_text" id="S4.T1.14.14.14.3.1" style="color:#808080;">77.7<sup class="ltx_sup" id="S4.T1.14.14.14.3.1.1"><span class="ltx_text" id="S4.T1.14.14.14.3.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.15.4"><span class="ltx_text" id="S4.T1.15.15.15.4.1" style="color:#808080;">83.2<sup class="ltx_sup" id="S4.T1.15.15.15.4.1.1"><span class="ltx_text" id="S4.T1.15.15.15.4.1.1.1" style="color:#000000;">∗</span></sup></span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.15.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.15.8">-</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.18.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T1.15.15.18.3.1"><span class="ltx_text ltx_font_italic" id="S4.T1.15.15.18.3.1.1" style="font-size:90%;">generalist segmentation model</span></th>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.18.3.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T1.15.15.18.3.3"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.18.3.4"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T1.15.15.18.3.5"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.18.3.6"></td>
<td class="ltx_td ltx_border_t" id="S4.T1.15.15.18.3.7"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.19.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.19.4.1">Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.15.15.19.4.2">CVPR’23</th>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.19.4.3"><span class="ltx_text" id="S4.T1.15.15.19.4.3.1" style="color:#808080;">32.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.19.4.4"><span class="ltx_text" id="S4.T1.15.15.19.4.4.1" style="color:#808080;">32.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.19.4.5">64.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.19.4.6">64.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.19.4.7">10.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.19.4.8">10.9</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.20.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.20.5.1">SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.15.15.20.5.2">ICCV’23</th>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.20.5.3"><span class="ltx_text" id="S4.T1.15.15.20.5.3.1" style="color:#808080;">56.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.20.5.4"><span class="ltx_text" id="S4.T1.15.15.20.5.4.1" style="color:#808080;">67.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.20.5.5"><span class="ltx_text" id="S4.T1.15.15.20.5.5.1" style="color:#808080;">83.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.20.5.6"><span class="ltx_text" id="S4.T1.15.15.20.5.6.1" style="color:#808080;">89.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.20.5.7">18.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.20.5.8">25.4</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.21.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.21.6.1">PerSAM-F <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx55" title="">ZJG<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.15.15.21.6.2">ICLR’24</th>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.21.6.3">23.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.21.6.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.21.6.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.21.6.6">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.21.6.7">18.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.21.6.8">-</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.22.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.22.7.1">Matcher <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx34" title="">LZL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.15.15.22.7.2">ICLR’24</th>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.22.7.3">52.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.22.7.4">60.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.22.7.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.22.7.6">-</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.22.7.7">33.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.22.7.8">40.0</td>
</tr>
<tr class="ltx_tr" id="S4.T1.15.15.23.8" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.15.15.23.8.1"><span class="ltx_text" id="S4.T1.15.15.23.8.1.1" style="background-color:#FFF2F2;">SINE</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T1.15.15.23.8.2"><span class="ltx_text" id="S4.T1.15.15.23.8.2.1" style="background-color:#FFF2F2;">this work</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.23.8.3"><span class="ltx_text" id="S4.T1.15.15.23.8.3.1" style="color:#808080;background-color:#FFF2F2;">64.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.23.8.4"><span class="ltx_text" id="S4.T1.15.15.23.8.4.1" style="color:#808080;background-color:#FFF2F2;">66.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.23.8.5"><span class="ltx_text" id="S4.T1.15.15.23.8.5.1" style="background-color:#FFF2F2;">85.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.15.15.23.8.6"><span class="ltx_text" id="S4.T1.15.15.23.8.6.1" style="background-color:#FFF2F2;">86.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.23.8.7"><span class="ltx_text" id="S4.T1.15.15.23.8.7.1" style="background-color:#FFF2F2;">31.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.15.15.23.8.8"><span class="ltx_text" id="S4.T1.15.15.23.8.8.1" style="background-color:#FFF2F2;">35.5</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.29.5.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.23.4" style="font-size:90%;">Results of few-shot semantic segmentation on COCO-20<sup class="ltx_sup" id="S4.T1.23.4.1"><span class="ltx_text ltx_font_italic" id="S4.T1.23.4.1.1">i</span></sup>, PASCAL-5<sup class="ltx_sup" id="S4.T1.23.4.2"><span class="ltx_text ltx_font_italic" id="S4.T1.23.4.2.1">i</span></sup>, and LVIS-92<sup class="ltx_sup" id="S4.T1.23.4.3"><span class="ltx_text ltx_font_italic" id="S4.T1.23.4.3.1">i</span></sup>. <span class="ltx_text" id="S4.T1.23.4.4" style="color:#808080;">Gray</span> indicates the model is trained by in-domain datasets. <math alttext="*" class="ltx_Math" display="inline" id="S4.T1.23.4.m4.1"><semantics id="S4.T1.23.4.m4.1b"><mo id="S4.T1.23.4.m4.1.1" xref="S4.T1.23.4.m4.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S4.T1.23.4.m4.1c"><times id="S4.T1.23.4.m4.1.1.cmml" xref="S4.T1.23.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.4.m4.1d">*</annotation><annotation encoding="application/x-llamapun" id="S4.T1.23.4.m4.1e">∗</annotation></semantics></math> indicates that the categories in training cover the categories in testing within the same dataset.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Few-shot Semantic Segmentation</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.6"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.6.1">Datasets</span> We revisit the few-shot semantic segmentation task into two settings:
in-domain (COCO-20<sup class="ltx_sup" id="S4.SS2.p1.6.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.p1.6.2.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx40" title="">NT19</a>]</cite>) and out-domain (PASCAL-5<sup class="ltx_sup" id="S4.SS2.p1.6.3"><span class="ltx_text ltx_font_italic" id="S4.SS2.p1.6.3.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx45" title="">SBL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>]</cite>, LVIS-92<sup class="ltx_sup" id="S4.SS2.p1.6.4"><span class="ltx_text ltx_font_italic" id="S4.SS2.p1.6.4.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx34" title="">LZL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>), based on whether the dataset has been seen during training. COCO-20<sup class="ltx_sup" id="S4.SS2.p1.6.5"><span class="ltx_text ltx_font_italic" id="S4.SS2.p1.6.5.1">i</span></sup> divides the 80 classes of COCO into four cross-validation folds with 20 test classes and 60 training classes for each fold. Similarly, PASCAL-5<sup class="ltx_sup" id="S4.SS2.p1.6.6"><span class="ltx_text ltx_font_italic" id="S4.SS2.p1.6.6.1">i</span></sup> is built on PASCAL, including four cross-validation folds.
LVIS-92<sup class="ltx_sup" id="S4.SS2.p1.6.7"><span class="ltx_text ltx_font_italic" id="S4.SS2.p1.6.7.1">i</span></sup> is a more challenging benchmark for evaluating the generalization of a model across datasets based on LVIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx13" title="">GDG19</a>]</cite>, including ten folds and 92 classes for each fold. We comprehensively verify the few-shot semantic segmentation performance of SINE on these datasets following the evaluation scheme of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx37" title="">MKC21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx34" title="">LZL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.7.1">Results</span> 
As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F8" title="Figure 8 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">8</span></a>, we compare the SINE with a variety of specialist and generalist segmentation models. For COCO-20<sup class="ltx_sup" id="S4.SS2.p2.7.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.2.1">i</span></sup> and PASCAL-5<sup class="ltx_sup" id="S4.SS2.p2.7.3"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.3.1">i</span></sup>, because SINE is trained with all data of COCO, we report the performance of specialist models trained on in-domain categories (marked by <sup class="ltx_sup" id="S4.SS2.p2.7.4">∗</sup>) for a fair comparison.
Although SINE and SegGPT are trained on the COCO dataset, SINE achieves significant advantages in one-shot performance with a simpler in-context learning framework on COCO-20<sup class="ltx_sup" id="S4.SS2.p2.7.5"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.5.1">i</span></sup>. In addition, without specific training on the PASCAL dataset, SINE achieves better performance with one-shot and comparable performance with few-shot to SegGPT on PASCAL-5<sup class="ltx_sup" id="S4.SS2.p2.7.6"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.6.1">i</span></sup>. On the more challenging dataset LVIS-92<sup class="ltx_sup" id="S4.SS2.p2.7.7"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.7.1">i</span></sup>, SINE outperforms Painter, SegGPT, and PerSAM-F, demonstrating superior generalization and versatility.
The performance of SINE on LVIS-92<sup class="ltx_sup" id="S4.SS2.p2.7.8"><span class="ltx_text ltx_font_italic" id="S4.SS2.p2.7.8.1">i</span></sup> is slightly weaker compared to Matcher, which benefits from the SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx24" title="">KMR<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> pre-trained on a large-scale segmentation dataset. SINE achieves competitive results independently, without relying on extensive segmentation data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Please note</span> that SINE aims to provide insights for the research community to build a simple baseline for in-context segmentation, instead of SOTA.
Despite having been trained on 12 diverse segmentation datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>, SegGPT demonstrates a limited performance when applied to LVIS-92<sup class="ltx_sup" id="S4.SS2.p3.1.2"><span class="ltx_text ltx_font_italic" id="S4.SS2.p3.1.2.1">i</span></sup>.
This indicates a need for developing more effective data-centric learning approaches specifically tailored for in-context segmentation.
SINE is the first to explore the utilization of Objects365 with automatic mask annotations. The efficient design of SINE enables the training on Objects365 at the instance level.
This enables SINE to only use 19M training parameters, making the training budget much smaller than SegGPT (304M) or SAM (600M) in Matcher.</p>
</div>
<figure class="ltx_figure" id="S4.SS2.2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.SS2.1.fig1" style="width:208.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.SS2.1.fig1.1" style="width:231.7pt;height:131.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-42.8pt,24.3pt) scale(0.73,0.73) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS2.1.fig1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.1.1">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.1.1.1.1">Methods</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS2.1.fig1.1.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.1.1.2.1">Venue</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S4.SS2.1.fig1.1.1.1.1.3">Det.</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S4.SS2.1.fig1.1.1.1.1.4">Segm.</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.2.2">
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.2.2.1">1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.2.2.2">5</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.2.2.3">1</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.2.2.4">5</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" colspan="2" id="S4.SS2.1.fig1.1.1.3.3.1"><span class="ltx_text ltx_font_italic" id="S4.SS2.1.fig1.1.1.3.3.1.1" style="font-size:90%;">specialist segmentation model</span></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.1.fig1.1.1.3.3.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.SS2.1.fig1.1.1.3.3.3"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.1.fig1.1.1.3.3.4"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.1.fig1.1.1.3.3.5"></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.4.4">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.4.4.1">Meta R-CNN</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS2.1.fig1.1.1.4.4.2">ICCV’19</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.4.4.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.4.4.4">3.5</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.4.4.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.4.4.6">2.8</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.5.5">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.5.5.1">MTFA</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS2.1.fig1.1.1.5.5.2" rowspan="2"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.5.5.2.1">CVPR’21</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.5.5.3">2.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.5.5.4">6.6</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.5.5.5">2.7</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.5.5.6">6.6</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.6.6">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.6.6.1">iMTFA</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.6.6.2">3.3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.6.6.3">6.2</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.6.6.4">2.8</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.6.6.5">5.2</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.7.7">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.7.7.1">Meta-DETR</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS2.1.fig1.1.1.7.7.2">TPAMI’22</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.7.7.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.7.7.4">15.4</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.7.7.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.7.7.6">8.1</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.8.8">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.8.8.1">RefT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx20" title="">HZX<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS2.1.fig1.1.1.8.8.2">arXiv’23</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.8.8.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.8.8.4">15.0</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.8.8.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.8.8.6">14.2</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" colspan="2" id="S4.SS2.1.fig1.1.1.9.9.1"><span class="ltx_text ltx_font_italic" id="S4.SS2.1.fig1.1.1.9.9.1.1" style="font-size:90%;">generalist segmentation model</span></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.1.fig1.1.1.9.9.2"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.SS2.1.fig1.1.1.9.9.3"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.1.fig1.1.1.9.9.4"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.1.fig1.1.1.9.9.5"></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.1.fig1.1.1.10.10" style="background-color:#FFF2F2;">
<td class="ltx_td ltx_align_left" id="S4.SS2.1.fig1.1.1.10.10.1"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.10.10.1.1" style="background-color:#FFF2F2;">SINE</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.SS2.1.fig1.1.1.10.10.2"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.10.10.2.1" style="background-color:#FFF2F2;">this work</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.10.10.3"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.10.10.3.1" style="background-color:#FFF2F2;">18.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.1.fig1.1.1.10.10.4"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.10.10.4.1" style="background-color:#FFF2F2;">22.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.10.10.5"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.10.10.5.1" style="background-color:#FFF2F2;">16.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.1.fig1.1.1.10.10.6"><span class="ltx_text" id="S4.SS2.1.fig1.1.1.10.10.6.1" style="background-color:#FFF2F2;">21.8</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.4.2.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.2.1" style="font-size:90%;">Results (AP) of few-shot object detection and instance segmentation on COCO-NOVEL with <math alttext="K=\{1,5\}" class="ltx_Math" display="inline" id="S4.T2.2.1.m1.2"><semantics id="S4.T2.2.1.m1.2b"><mrow id="S4.T2.2.1.m1.2.3" xref="S4.T2.2.1.m1.2.3.cmml"><mi id="S4.T2.2.1.m1.2.3.2" xref="S4.T2.2.1.m1.2.3.2.cmml">K</mi><mo id="S4.T2.2.1.m1.2.3.1" xref="S4.T2.2.1.m1.2.3.1.cmml">=</mo><mrow id="S4.T2.2.1.m1.2.3.3.2" xref="S4.T2.2.1.m1.2.3.3.1.cmml"><mo id="S4.T2.2.1.m1.2.3.3.2.1" stretchy="false" xref="S4.T2.2.1.m1.2.3.3.1.cmml">{</mo><mn id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml">1</mn><mo id="S4.T2.2.1.m1.2.3.3.2.2" xref="S4.T2.2.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.T2.2.1.m1.2.2" xref="S4.T2.2.1.m1.2.2.cmml">5</mn><mo id="S4.T2.2.1.m1.2.3.3.2.3" stretchy="false" xref="S4.T2.2.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.2c"><apply id="S4.T2.2.1.m1.2.3.cmml" xref="S4.T2.2.1.m1.2.3"><eq id="S4.T2.2.1.m1.2.3.1.cmml" xref="S4.T2.2.1.m1.2.3.1"></eq><ci id="S4.T2.2.1.m1.2.3.2.cmml" xref="S4.T2.2.1.m1.2.3.2">𝐾</ci><set id="S4.T2.2.1.m1.2.3.3.1.cmml" xref="S4.T2.2.1.m1.2.3.3.2"><cn id="S4.T2.2.1.m1.1.1.cmml" type="integer" xref="S4.T2.2.1.m1.1.1">1</cn><cn id="S4.T2.2.1.m1.2.2.cmml" type="integer" xref="S4.T2.2.1.m1.2.2">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.2d">K=\{1,5\}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.1.m1.2e">italic_K = { 1 , 5 }</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.SS2.2.fig2" style="width:208.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="S4.SS2.2.fig2.1" style="width:258.5pt;height:118.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-47.8pt,21.9pt) scale(0.73,0.73) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.SS2.2.fig2.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.SS2.2.fig2.1.1.1.1.1" rowspan="2"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.1.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.SS2.2.fig2.1.1.1.1.2" rowspan="2"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.1.1.2.1">Venue</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="2" id="S4.SS2.2.fig2.1.1.1.1.3">Det.</td>
<td class="ltx_td ltx_align_center" colspan="2" id="S4.SS2.2.fig2.1.1.1.1.4">Segm.</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.2.2">
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.2.2.1">AP</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.2.fig2.1.1.2.2.2">AP50</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.2.2.3">AP</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.2.2.4">AP50</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.SS2.2.fig2.1.1.3.3.1"><span class="ltx_text ltx_font_italic" id="S4.SS2.2.fig2.1.1.3.3.1.1" style="font-size:90%;">1-shot</span></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.SS2.2.fig2.1.1.3.3.2"></th>
<td class="ltx_td ltx_border_t" id="S4.SS2.2.fig2.1.1.3.3.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.SS2.2.fig2.1.1.3.3.4"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.2.fig2.1.1.3.3.5"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.2.fig2.1.1.3.3.6"></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.SS2.2.fig2.1.1.4.4.1">FGN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx10" title="">FYL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.SS2.2.fig2.1.1.4.4.2">CVPR’20</th>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.4.4.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.2.fig2.1.1.4.4.4">30.8</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.4.4.5">-</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.4.4.6">16.2</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.SS2.2.fig2.1.1.5.5.1">MTFA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx11" title="">GBP21</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.SS2.2.fig2.1.1.5.5.2" rowspan="2"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.5.5.2.1">CVPR’21</span></th>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.5.5.3">10.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.2.fig2.1.1.5.5.4">21.7</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.5.5.5">9.5</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.5.5.6">19.3</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.SS2.2.fig2.1.1.6.6.1">iMTFA</th>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.6.6.2">11.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.2.fig2.1.1.6.6.3">22.4</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.6.6.4">8.6</td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.6.6.5">16.3</td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.7.7" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.SS2.2.fig2.1.1.7.7.1"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.7.7.1.1" style="background-color:#FFF2F2;">SINE</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.SS2.2.fig2.1.1.7.7.2"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.7.7.2.1" style="background-color:#FFF2F2;">this work</span></th>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.7.7.3"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.7.7.3.1" style="background-color:#FFF2F2;">35.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.2.fig2.1.1.7.7.4"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.7.7.4.1" style="background-color:#FFF2F2;">51.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.7.7.5"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.7.7.5.1" style="background-color:#FFF2F2;">27.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.7.7.6"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.7.7.6.1" style="background-color:#FFF2F2;">47.6</span></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.SS2.2.fig2.1.1.8.8.1"><span class="ltx_text ltx_font_italic" id="S4.SS2.2.fig2.1.1.8.8.1.1" style="font-size:90%;">5-shot</span></th>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.SS2.2.fig2.1.1.8.8.2"></th>
<td class="ltx_td ltx_border_t" id="S4.SS2.2.fig2.1.1.8.8.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.SS2.2.fig2.1.1.8.8.4"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.2.fig2.1.1.8.8.5"></td>
<td class="ltx_td ltx_border_t" id="S4.SS2.2.fig2.1.1.8.8.6"></td>
</tr>
<tr class="ltx_tr" id="S4.SS2.2.fig2.1.1.9.9" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.SS2.2.fig2.1.1.9.9.1"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.9.9.1.1" style="background-color:#FFF2F2;">SINE</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.SS2.2.fig2.1.1.9.9.2"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.9.9.2.1" style="background-color:#FFF2F2;">this work</span></th>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.9.9.3"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.9.9.3.1" style="background-color:#FFF2F2;">42.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.SS2.2.fig2.1.1.9.9.4"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.9.9.4.1" style="background-color:#FFF2F2;">62.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.9.9.5"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.9.9.5.1" style="background-color:#FFF2F2;">33.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.SS2.2.fig2.1.1.9.9.6"><span class="ltx_text" id="S4.SS2.2.fig2.1.1.9.9.6.1" style="background-color:#FFF2F2;">57.7</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.4.2.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.2.1" style="font-size:90%;">Results (AP and AP50) of few-shot object detection and instance segmentation on COCO2VOC with <math alttext="K=\{1,5\}" class="ltx_Math" display="inline" id="S4.T3.2.1.m1.2"><semantics id="S4.T3.2.1.m1.2b"><mrow id="S4.T3.2.1.m1.2.3" xref="S4.T3.2.1.m1.2.3.cmml"><mi id="S4.T3.2.1.m1.2.3.2" xref="S4.T3.2.1.m1.2.3.2.cmml">K</mi><mo id="S4.T3.2.1.m1.2.3.1" xref="S4.T3.2.1.m1.2.3.1.cmml">=</mo><mrow id="S4.T3.2.1.m1.2.3.3.2" xref="S4.T3.2.1.m1.2.3.3.1.cmml"><mo id="S4.T3.2.1.m1.2.3.3.2.1" stretchy="false" xref="S4.T3.2.1.m1.2.3.3.1.cmml">{</mo><mn id="S4.T3.2.1.m1.1.1" xref="S4.T3.2.1.m1.1.1.cmml">1</mn><mo id="S4.T3.2.1.m1.2.3.3.2.2" xref="S4.T3.2.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.T3.2.1.m1.2.2" xref="S4.T3.2.1.m1.2.2.cmml">5</mn><mo id="S4.T3.2.1.m1.2.3.3.2.3" stretchy="false" xref="S4.T3.2.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.1.m1.2c"><apply id="S4.T3.2.1.m1.2.3.cmml" xref="S4.T3.2.1.m1.2.3"><eq id="S4.T3.2.1.m1.2.3.1.cmml" xref="S4.T3.2.1.m1.2.3.1"></eq><ci id="S4.T3.2.1.m1.2.3.2.cmml" xref="S4.T3.2.1.m1.2.3.2">𝐾</ci><set id="S4.T3.2.1.m1.2.3.3.1.cmml" xref="S4.T3.2.1.m1.2.3.3.2"><cn id="S4.T3.2.1.m1.1.1.cmml" type="integer" xref="S4.T3.2.1.m1.1.1">1</cn><cn id="S4.T3.2.1.m1.2.2.cmml" type="integer" xref="S4.T3.2.1.m1.2.2">5</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.1.m1.2d">K=\{1,5\}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.1.m1.2e">italic_K = { 1 , 5 }</annotation></semantics></math>.</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Few-shot Instance Segmentation</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">Datasets</span> Like few-shot semantic segmentation, we evaluate the performance of SINE of few-shot instance segmentation on both settings: in-domain on COCO-NOVEL <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx23" title="">KLW<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>19</a>]</cite> and out-domain on COCO2VOC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx9" title="">EVGW<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>10</a>]</cite> settings. COCO-NOVEL includes 20 classes that intersect with VOC and 5k test images. We evaluate 1-shot and 5-shot instance segmentation performance on this dataset. The COCO2VOC dataset is used to evaluate the cross-dataset generalization ability by using reference samples of COCO to test the VOC test set. We report the mean results of 10 groups of different reference images generated by different random seed for both two datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Results</span> Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T2" title="Table 2 ‣ 4.2 Few-shot Semantic Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">2</span></a> shows the results of few-shot object detection and instance segmentation. SINE outperforms specialist methods by a large margin at both 1-shot and 5-shot settings. For the results of COCO2VOC in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T3" title="Table 3 ‣ 4.2 Few-shot Semantic Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">3</span></a>, SINE shows better generalization ability compared to specialist models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">Please note</span> that the goal of this experiment is not to prove that SINE achieves better few-shot instance segmentation performance compared to specialist segmentation models. The existing in-context segmentation models, such as SegGPT, are unsuitable to perform instance segmentation. SegGPT needs to use a sliding window to traverse all grids to predict the objects. The post-processing is complicated and ineffective. SINE is the first in-context segmentation model that can address few-shot instance segmentation. We hope SINE can be a baseline for in-context segmentation models to promote the development of this field.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Video Object Segmentation</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.2"><span class="ltx_text ltx_font_bold" id="S4.SS4.p1.2.1">Datasets</span> 
For video object segmentation (VOS), we focus on the semi-supervised setting where the object masks of the first frame are provided, and the model is responsible for segmenting the object in all subsequent frames. We evaluate SINE on three validation datasets, including DAVIS 2017 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx43" title="">PTPC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>17</a>]</cite>, DAVIS 2016 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx42" title="">PPTM<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>16</a>]</cite>, and YouTube-VOS 2018 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx53" title="">XYF<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>18</a>]</cite>. We use
the <math alttext="J" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_J</annotation></semantics></math> score and the <math alttext="F" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_F</annotation></semantics></math> score to evaluate the performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.1.1">Details</span> 
To effectively perform SINE on the VOS task, we introduce a group of memory banks for each object, maintaining the intermediate predictions. We determine which frame to retain in the memory according to the classification and mask scores.
Considering that objects are more likely to resemble those in adjacent frames, we apply a time-based decay ratio to the scores, gradually reducing its value. In addition, we store the reference image and mask in memory to solve the case where objects vanish and reappear.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p3.1.1">Results</span> Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T4" title="Table 4 ‣ 4.4 Video Object Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">4</span></a> compares the performance of VOS between SINE and different methods trained with or without video data. Without video data, SINE achieves competitive performance compared with the models trained with video data on DAVIS 2017. In addition, SINE outperforms recent generalist segmentation methods, such as Painter, SEEM, DINOv and PerSAM-F, on YouTube-VOS 2018. These results demonstrate that SINE has the potential to address video tasks.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.11" style="width:381.6pt;height:200.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-101.6pt,53.2pt) scale(0.652502418469982,0.652502418469982) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.11.11">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.11.11.12.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.12.1.1" rowspan="2"><span class="ltx_text" id="S4.T4.11.11.12.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.12.1.2" rowspan="2"><span class="ltx_text" id="S4.T4.11.11.12.1.2.1">Venue</span></th>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="S4.T4.11.11.12.1.3">DAVIS 2017</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="S4.T4.11.11.12.1.4">DAVIS 2016</td>
<td class="ltx_td ltx_align_center" colspan="5" id="S4.T4.11.11.12.1.5">YouTube-VOS 2018</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.11">
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.1.1"><math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mi id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2.cmml">J</mi><mo id="S4.T4.1.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">&amp;</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><and id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1"></and><ci id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2">𝐽</ci><ci id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">italic_J &amp; italic_F</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.2.2.2"><math alttext="J" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.2.m1.1a"><mi id="S4.T4.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><ci id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.m1.1d">italic_J</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.3.3.3.3"><math alttext="F" class="ltx_Math" display="inline" id="S4.T4.3.3.3.3.m1.1"><semantics id="S4.T4.3.3.3.3.m1.1a"><mi id="S4.T4.3.3.3.3.m1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.3.m1.1b"><ci id="S4.T4.3.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.3.m1.1d">italic_F</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.4.4"><math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.T4.4.4.4.4.m1.1"><semantics id="S4.T4.4.4.4.4.m1.1a"><mrow id="S4.T4.4.4.4.4.m1.1.1" xref="S4.T4.4.4.4.4.m1.1.1.cmml"><mi id="S4.T4.4.4.4.4.m1.1.1.2" xref="S4.T4.4.4.4.4.m1.1.1.2.cmml">J</mi><mo id="S4.T4.4.4.4.4.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T4.4.4.4.4.m1.1.1.1.cmml">&amp;</mo><mi id="S4.T4.4.4.4.4.m1.1.1.3" xref="S4.T4.4.4.4.4.m1.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.4.m1.1b"><apply id="S4.T4.4.4.4.4.m1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1"><and id="S4.T4.4.4.4.4.m1.1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1.1"></and><ci id="S4.T4.4.4.4.4.m1.1.1.2.cmml" xref="S4.T4.4.4.4.4.m1.1.1.2">𝐽</ci><ci id="S4.T4.4.4.4.4.m1.1.1.3.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.4.m1.1c">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.4.m1.1d">italic_J &amp; italic_F</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.5.5.5.5"><math alttext="J" class="ltx_Math" display="inline" id="S4.T4.5.5.5.5.m1.1"><semantics id="S4.T4.5.5.5.5.m1.1a"><mi id="S4.T4.5.5.5.5.m1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.5.m1.1b"><ci id="S4.T4.5.5.5.5.m1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.5.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.5.m1.1d">italic_J</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.6.6.6.6"><math alttext="F" class="ltx_Math" display="inline" id="S4.T4.6.6.6.6.m1.1"><semantics id="S4.T4.6.6.6.6.m1.1a"><mi id="S4.T4.6.6.6.6.m1.1.1" xref="S4.T4.6.6.6.6.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.6.m1.1b"><ci id="S4.T4.6.6.6.6.m1.1.1.cmml" xref="S4.T4.6.6.6.6.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.6.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.6.6.6.m1.1d">italic_F</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.7.7.7.7"><math alttext="G" class="ltx_Math" display="inline" id="S4.T4.7.7.7.7.m1.1"><semantics id="S4.T4.7.7.7.7.m1.1a"><mi id="S4.T4.7.7.7.7.m1.1.1" xref="S4.T4.7.7.7.7.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.7.m1.1b"><ci id="S4.T4.7.7.7.7.m1.1.1.cmml" xref="S4.T4.7.7.7.7.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.7.m1.1c">G</annotation><annotation encoding="application/x-llamapun" id="S4.T4.7.7.7.7.m1.1d">italic_G</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.8.8.8.8"><math alttext="J_{s}" class="ltx_Math" display="inline" id="S4.T4.8.8.8.8.m1.1"><semantics id="S4.T4.8.8.8.8.m1.1a"><msub id="S4.T4.8.8.8.8.m1.1.1" xref="S4.T4.8.8.8.8.m1.1.1.cmml"><mi id="S4.T4.8.8.8.8.m1.1.1.2" xref="S4.T4.8.8.8.8.m1.1.1.2.cmml">J</mi><mi id="S4.T4.8.8.8.8.m1.1.1.3" xref="S4.T4.8.8.8.8.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.8.8.m1.1b"><apply id="S4.T4.8.8.8.8.m1.1.1.cmml" xref="S4.T4.8.8.8.8.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.8.8.8.8.m1.1.1.1.cmml" xref="S4.T4.8.8.8.8.m1.1.1">subscript</csymbol><ci id="S4.T4.8.8.8.8.m1.1.1.2.cmml" xref="S4.T4.8.8.8.8.m1.1.1.2">𝐽</ci><ci id="S4.T4.8.8.8.8.m1.1.1.3.cmml" xref="S4.T4.8.8.8.8.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.8.8.m1.1c">J_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.8.8.8.8.m1.1d">italic_J start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.9.9.9.9"><math alttext="F_{s}" class="ltx_Math" display="inline" id="S4.T4.9.9.9.9.m1.1"><semantics id="S4.T4.9.9.9.9.m1.1a"><msub id="S4.T4.9.9.9.9.m1.1.1" xref="S4.T4.9.9.9.9.m1.1.1.cmml"><mi id="S4.T4.9.9.9.9.m1.1.1.2" xref="S4.T4.9.9.9.9.m1.1.1.2.cmml">F</mi><mi id="S4.T4.9.9.9.9.m1.1.1.3" xref="S4.T4.9.9.9.9.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.9.9.m1.1b"><apply id="S4.T4.9.9.9.9.m1.1.1.cmml" xref="S4.T4.9.9.9.9.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.9.9.9.9.m1.1.1.1.cmml" xref="S4.T4.9.9.9.9.m1.1.1">subscript</csymbol><ci id="S4.T4.9.9.9.9.m1.1.1.2.cmml" xref="S4.T4.9.9.9.9.m1.1.1.2">𝐹</ci><ci id="S4.T4.9.9.9.9.m1.1.1.3.cmml" xref="S4.T4.9.9.9.9.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.9.9.m1.1c">F_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.9.9.9.9.m1.1d">italic_F start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.10.10.10.10"><math alttext="J_{u}" class="ltx_Math" display="inline" id="S4.T4.10.10.10.10.m1.1"><semantics id="S4.T4.10.10.10.10.m1.1a"><msub id="S4.T4.10.10.10.10.m1.1.1" xref="S4.T4.10.10.10.10.m1.1.1.cmml"><mi id="S4.T4.10.10.10.10.m1.1.1.2" xref="S4.T4.10.10.10.10.m1.1.1.2.cmml">J</mi><mi id="S4.T4.10.10.10.10.m1.1.1.3" xref="S4.T4.10.10.10.10.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.10.10.m1.1b"><apply id="S4.T4.10.10.10.10.m1.1.1.cmml" xref="S4.T4.10.10.10.10.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.10.10.10.10.m1.1.1.1.cmml" xref="S4.T4.10.10.10.10.m1.1.1">subscript</csymbol><ci id="S4.T4.10.10.10.10.m1.1.1.2.cmml" xref="S4.T4.10.10.10.10.m1.1.1.2">𝐽</ci><ci id="S4.T4.10.10.10.10.m1.1.1.3.cmml" xref="S4.T4.10.10.10.10.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.10.10.m1.1c">J_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.10.10.10.10.m1.1d">italic_J start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.11.11"><math alttext="F_{u}" class="ltx_Math" display="inline" id="S4.T4.11.11.11.11.m1.1"><semantics id="S4.T4.11.11.11.11.m1.1a"><msub id="S4.T4.11.11.11.11.m1.1.1" xref="S4.T4.11.11.11.11.m1.1.1.cmml"><mi id="S4.T4.11.11.11.11.m1.1.1.2" xref="S4.T4.11.11.11.11.m1.1.1.2.cmml">F</mi><mi id="S4.T4.11.11.11.11.m1.1.1.3" xref="S4.T4.11.11.11.11.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.T4.11.11.11.11.m1.1b"><apply id="S4.T4.11.11.11.11.m1.1.1.cmml" xref="S4.T4.11.11.11.11.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.11.11.11.11.m1.1.1.1.cmml" xref="S4.T4.11.11.11.11.m1.1.1">subscript</csymbol><ci id="S4.T4.11.11.11.11.m1.1.1.2.cmml" xref="S4.T4.11.11.11.11.m1.1.1.2">𝐹</ci><ci id="S4.T4.11.11.11.11.m1.1.1.3.cmml" xref="S4.T4.11.11.11.11.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.11.11.11.m1.1c">F_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.11.11.11.11.m1.1d">italic_F start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.13.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T4.11.11.13.2.1"><span class="ltx_text ltx_font_italic" id="S4.T4.11.11.13.2.1.1" style="font-size:90%;">with video data</span></th>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.11.11.13.2.4"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.5"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.6"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.11.11.13.2.7"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.8"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.9"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.10"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.11"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.13.2.12"></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.14.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.14.3.1"><span class="ltx_text" id="S4.T4.11.11.14.3.1.1" style="color:#808080;">AGAME <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx21" title="">JDB<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>19</a>]</cite></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.14.3.2"><span class="ltx_text" id="S4.T4.11.11.14.3.2.1" style="color:#808080;">CVPR’19</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.3"><span class="ltx_text" id="S4.T4.11.11.14.3.3.1" style="color:#808080;">70.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.4"><span class="ltx_text" id="S4.T4.11.11.14.3.4.1" style="color:#808080;">67.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.14.3.5"><span class="ltx_text" id="S4.T4.11.11.14.3.5.1" style="color:#808080;">72.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.6"><span class="ltx_text" id="S4.T4.11.11.14.3.6.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.7"><span class="ltx_text" id="S4.T4.11.11.14.3.7.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.14.3.8"><span class="ltx_text" id="S4.T4.11.11.14.3.8.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.9"><span class="ltx_text" id="S4.T4.11.11.14.3.9.1" style="color:#808080;">66.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.10"><span class="ltx_text" id="S4.T4.11.11.14.3.10.1" style="color:#808080;">66.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.11"><span class="ltx_text" id="S4.T4.11.11.14.3.11.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.12"><span class="ltx_text" id="S4.T4.11.11.14.3.12.1" style="color:#808080;">61.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.14.3.13"><span class="ltx_text" id="S4.T4.11.11.14.3.13.1" style="color:#808080;">-</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.15.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.15.4.1"><span class="ltx_text" id="S4.T4.11.11.15.4.1.1" style="color:#808080;">AGSS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx31" title="">LQJ19</a>]</cite></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.15.4.2"><span class="ltx_text" id="S4.T4.11.11.15.4.2.1" style="color:#808080;">ICCV’19</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.3"><span class="ltx_text" id="S4.T4.11.11.15.4.3.1" style="color:#808080;">67.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.4"><span class="ltx_text" id="S4.T4.11.11.15.4.4.1" style="color:#808080;">64.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.15.4.5"><span class="ltx_text" id="S4.T4.11.11.15.4.5.1" style="color:#808080;">69.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.6"><span class="ltx_text" id="S4.T4.11.11.15.4.6.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.7"><span class="ltx_text" id="S4.T4.11.11.15.4.7.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.15.4.8"><span class="ltx_text" id="S4.T4.11.11.15.4.8.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.9"><span class="ltx_text" id="S4.T4.11.11.15.4.9.1" style="color:#808080;">71.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.10"><span class="ltx_text" id="S4.T4.11.11.15.4.10.1" style="color:#808080;">71.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.11"><span class="ltx_text" id="S4.T4.11.11.15.4.11.1" style="color:#808080;">65.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.12"><span class="ltx_text" id="S4.T4.11.11.15.4.12.1" style="color:#808080;">75.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.15.4.13"><span class="ltx_text" id="S4.T4.11.11.15.4.13.1" style="color:#808080;">73.1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.16.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.16.5.1"><span class="ltx_text" id="S4.T4.11.11.16.5.1.1" style="color:#808080;">AFB-URR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx28" title="">LLJC20</a>]</cite></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.16.5.2"><span class="ltx_text" id="S4.T4.11.11.16.5.2.1" style="color:#808080;">NeurIPS’20</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.3"><span class="ltx_text" id="S4.T4.11.11.16.5.3.1" style="color:#808080;">74.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.4"><span class="ltx_text" id="S4.T4.11.11.16.5.4.1" style="color:#808080;">73.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.16.5.5"><span class="ltx_text" id="S4.T4.11.11.16.5.5.1" style="color:#808080;">76.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.6"><span class="ltx_text" id="S4.T4.11.11.16.5.6.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.7"><span class="ltx_text" id="S4.T4.11.11.16.5.7.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.16.5.8"><span class="ltx_text" id="S4.T4.11.11.16.5.8.1" style="color:#808080;">-</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.9"><span class="ltx_text" id="S4.T4.11.11.16.5.9.1" style="color:#808080;">79.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.10"><span class="ltx_text" id="S4.T4.11.11.16.5.10.1" style="color:#808080;">78.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.11"><span class="ltx_text" id="S4.T4.11.11.16.5.11.1" style="color:#808080;">83.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.12"><span class="ltx_text" id="S4.T4.11.11.16.5.12.1" style="color:#808080;">74.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.16.5.13"><span class="ltx_text" id="S4.T4.11.11.16.5.13.1" style="color:#808080;">82.6</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.17.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.17.6.1"><span class="ltx_text" id="S4.T4.11.11.17.6.1.1" style="color:#808080;">AOT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx54" title="">YWY21</a>]</cite></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.17.6.2"><span class="ltx_text" id="S4.T4.11.11.17.6.2.1" style="color:#808080;">NeurIPS’21</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.3"><span class="ltx_text" id="S4.T4.11.11.17.6.3.1" style="color:#808080;">85.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.4"><span class="ltx_text" id="S4.T4.11.11.17.6.4.1" style="color:#808080;">82.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.17.6.5"><span class="ltx_text" id="S4.T4.11.11.17.6.5.1" style="color:#808080;">88.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.6"><span class="ltx_text" id="S4.T4.11.11.17.6.6.1" style="color:#808080;">92.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.7"><span class="ltx_text" id="S4.T4.11.11.17.6.7.1" style="color:#808080;">90.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.17.6.8"><span class="ltx_text" id="S4.T4.11.11.17.6.8.1" style="color:#808080;">93.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.9"><span class="ltx_text" id="S4.T4.11.11.17.6.9.1" style="color:#808080;">84.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.10"><span class="ltx_text" id="S4.T4.11.11.17.6.10.1" style="color:#808080;">84.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.11"><span class="ltx_text" id="S4.T4.11.11.17.6.11.1" style="color:#808080;">89.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.12"><span class="ltx_text" id="S4.T4.11.11.17.6.12.1" style="color:#808080;">77.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.17.6.13"><span class="ltx_text" id="S4.T4.11.11.17.6.13.1" style="color:#808080;">86.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.18.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.18.7.1"><span class="ltx_text" id="S4.T4.11.11.18.7.1.1" style="color:#808080;">SWEM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx33" title="">LYL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.18.7.2"><span class="ltx_text" id="S4.T4.11.11.18.7.2.1" style="color:#808080;">CVPR’22</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.3"><span class="ltx_text" id="S4.T4.11.11.18.7.3.1" style="color:#808080;">84.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.4"><span class="ltx_text" id="S4.T4.11.11.18.7.4.1" style="color:#808080;">81.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.18.7.5"><span class="ltx_text" id="S4.T4.11.11.18.7.5.1" style="color:#808080;">87.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.6"><span class="ltx_text" id="S4.T4.11.11.18.7.6.1" style="color:#808080;">91.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.7"><span class="ltx_text" id="S4.T4.11.11.18.7.7.1" style="color:#808080;">89.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.18.7.8"><span class="ltx_text" id="S4.T4.11.11.18.7.8.1" style="color:#808080;">92.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.9"><span class="ltx_text" id="S4.T4.11.11.18.7.9.1" style="color:#808080;">82.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.10"><span class="ltx_text" id="S4.T4.11.11.18.7.10.1" style="color:#808080;">82.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.11"><span class="ltx_text" id="S4.T4.11.11.18.7.11.1" style="color:#808080;">86.9</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.12"><span class="ltx_text" id="S4.T4.11.11.18.7.12.1" style="color:#808080;">77.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.18.7.13"><span class="ltx_text" id="S4.T4.11.11.18.7.13.1" style="color:#808080;">85.0</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.19.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.19.8.1"><span class="ltx_text" id="S4.T4.11.11.19.8.1.1" style="color:#808080;">XMem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx6" title="">CS22</a>]</cite></span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.19.8.2"><span class="ltx_text" id="S4.T4.11.11.19.8.2.1" style="color:#808080;">ECCV’22</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.3"><span class="ltx_text" id="S4.T4.11.11.19.8.3.1" style="color:#808080;">87.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.4"><span class="ltx_text" id="S4.T4.11.11.19.8.4.1" style="color:#808080;">84.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.19.8.5"><span class="ltx_text" id="S4.T4.11.11.19.8.5.1" style="color:#808080;">91.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.6"><span class="ltx_text" id="S4.T4.11.11.19.8.6.1" style="color:#808080;">92.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.7"><span class="ltx_text" id="S4.T4.11.11.19.8.7.1" style="color:#808080;">90.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.19.8.8"><span class="ltx_text" id="S4.T4.11.11.19.8.8.1" style="color:#808080;">93.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.9"><span class="ltx_text" id="S4.T4.11.11.19.8.9.1" style="color:#808080;">86.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.10"><span class="ltx_text" id="S4.T4.11.11.19.8.10.1" style="color:#808080;">85.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.11"><span class="ltx_text" id="S4.T4.11.11.19.8.11.1" style="color:#808080;">89.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.12"><span class="ltx_text" id="S4.T4.11.11.19.8.12.1" style="color:#808080;">80.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.19.8.13"><span class="ltx_text" id="S4.T4.11.11.19.8.13.1" style="color:#808080;">89.2</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.20.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" colspan="2" id="S4.T4.11.11.20.9.1"><span class="ltx_text ltx_font_italic" id="S4.T4.11.11.20.9.1.1" style="font-size:90%;">without video data</span></th>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.2"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.11.11.20.9.4"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.5"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.6"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T4.11.11.20.9.7"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.8"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.9"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.10"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.11"></td>
<td class="ltx_td ltx_border_t" id="S4.T4.11.11.20.9.12"></td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.21.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.21.10.1">Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.21.10.2">CVPR’23</th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.3">34.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.4">28.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.21.10.5">40.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.6">70.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.7">69.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.21.10.8">70.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.9">24.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.10">27.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.11">35.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.12">14.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.21.10.13">18.7</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.22.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.22.11.1">SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.22.11.2">ICCV’23</th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.3">75.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.4">72.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.22.11.5">78.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.6">83.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.7">83.6</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.22.11.8">83.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.9">74.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.10">75.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.11">80.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.12">67.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.22.11.13">75.9</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.23.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.23.12.1">SEEM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx58" title="">ZYZ<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.23.12.2">NeurIPS’23</th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.3">58.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.4">55.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.23.12.5">62.8</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.6">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.23.12.8">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.9">50.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.10">57.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.11">38.2</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.12">61.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.23.12.13">43.3</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.24.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.24.13.1">DINOv <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx27" title="">LJZ<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>24</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.24.13.2">CVPR’24</th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.3">73.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.4">71.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.24.13.5">75.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.6">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.24.13.8">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.9">60.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.10">65.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.11">70.0</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.12">52.3</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.24.13.13">57.9</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.25.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.25.14.1">PerSAM-F <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx55" title="">ZJG<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.25.14.2">ICLR’24</th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.3">76.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.4">74.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.25.14.5">79.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.6">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.25.14.8">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.9">54.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.10">53.9</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.11">56.4</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.12">50.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.25.14.13">56.6</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.26.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.26.15.1">Matcher <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx34" title="">LZL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.26.15.2">ICLR’24</th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.3">79.5</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.4">76.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.26.15.5">82.6</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.6">86.1</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.7">85.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.26.15.8">86.7</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.9">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.10">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.11">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.12">-</td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.26.15.13">-</td>
</tr>
<tr class="ltx_tr" id="S4.T4.11.11.27.16" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T4.11.11.27.16.1"><span class="ltx_text" id="S4.T4.11.11.27.16.1.1" style="background-color:#FFF2F2;">SINE</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.11.11.27.16.2"><span class="ltx_text" id="S4.T4.11.11.27.16.2.1" style="background-color:#FFF2F2;">this work</span></th>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.3"><span class="ltx_text" id="S4.T4.11.11.27.16.3.1" style="background-color:#FFF2F2;">77.0</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.4"><span class="ltx_text" id="S4.T4.11.11.27.16.4.1" style="background-color:#FFF2F2;">72.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.27.16.5"><span class="ltx_text" id="S4.T4.11.11.27.16.5.1" style="background-color:#FFF2F2;">81.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.6"><span class="ltx_text" id="S4.T4.11.11.27.16.6.1" style="background-color:#FFF2F2;">82.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.7"><span class="ltx_text" id="S4.T4.11.11.27.16.7.1" style="background-color:#FFF2F2;">81.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.11.11.27.16.8"><span class="ltx_text" id="S4.T4.11.11.27.16.8.1" style="background-color:#FFF2F2;">83.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.9"><span class="ltx_text" id="S4.T4.11.11.27.16.9.1" style="background-color:#FFF2F2;">66.2</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.10"><span class="ltx_text" id="S4.T4.11.11.27.16.10.1" style="background-color:#FFF2F2;">69.1</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.11"><span class="ltx_text" id="S4.T4.11.11.27.16.11.1" style="background-color:#FFF2F2;">57.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.12"><span class="ltx_text" id="S4.T4.11.11.27.16.12.1" style="background-color:#FFF2F2;">71.7</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.11.11.27.16.13"><span class="ltx_text" id="S4.T4.11.11.27.16.13.1" style="background-color:#FFF2F2;">66.5</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.16.2.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S4.T4.13.1" style="font-size:90%;">Results of video object segmentation on DAVIS 2017, DAVIS 2016, and YouTube-VOS 2018. <span class="ltx_text" id="S4.T4.13.1.1" style="color:#808080;">Gray</span> indicates the model is trained on target datasets with video data. <math alttext="G" class="ltx_Math" display="inline" id="S4.T4.13.1.m1.1"><semantics id="S4.T4.13.1.m1.1b"><mi id="S4.T4.13.1.m1.1.1" xref="S4.T4.13.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.T4.13.1.m1.1c"><ci id="S4.T4.13.1.m1.1.1.cmml" xref="S4.T4.13.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.13.1.m1.1d">G</annotation><annotation encoding="application/x-llamapun" id="S4.T4.13.1.m1.1e">italic_G</annotation></semantics></math> is the average score over the “seen” and “unseen” classes in YouTube-VOS 2018.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T5">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T5.st1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.st1.4" style="width:206.0pt;height:65.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-39.1pt,12.4pt) scale(0.725,0.725) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.st1.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.st1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st1.1.1.1.2" rowspan="2" style="padding-left:5.7pt;padding-right:5.7pt;"><span class="ltx_text" id="S4.T5.st1.1.1.1.2.1">Training Data</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st1.1.1.1.1" style="padding-left:5.7pt;padding-right:5.7pt;">LVIS-92<sup class="ltx_sup" id="S4.T5.st1.1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T5.st1.1.1.1.1.1.1">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" colspan="2" id="S4.T5.st1.1.1.1.3" style="padding-left:5.7pt;padding-right:5.7pt;">COCO-NOVEL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st1.1.1.1.4" style="padding-left:5.7pt;padding-right:5.7pt;">DAVIS 2017</th>
</tr>
<tr class="ltx_tr" id="S4.T5.st1.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st1.4.4.4.4" style="padding-left:5.7pt;padding-right:5.7pt;">mean mIoU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st1.2.2.2.1" style="padding-left:5.7pt;padding-right:5.7pt;">AP<sub class="ltx_sub" id="S4.T5.st1.2.2.2.1.1"><span class="ltx_text ltx_font_italic" id="S4.T5.st1.2.2.2.1.1.1">box</span></sub>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S4.T5.st1.3.3.3.2" style="padding-left:5.7pt;padding-right:5.7pt;">AP<sub class="ltx_sub" id="S4.T5.st1.3.3.3.2.1"><span class="ltx_text ltx_font_italic" id="S4.T5.st1.3.3.3.2.1.1">mask</span></sub>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st1.4.4.4.3" style="padding-left:5.7pt;padding-right:5.7pt;"><math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.T5.st1.4.4.4.3.m1.1"><semantics id="S4.T5.st1.4.4.4.3.m1.1a"><mrow id="S4.T5.st1.4.4.4.3.m1.1.1" xref="S4.T5.st1.4.4.4.3.m1.1.1.cmml"><mi id="S4.T5.st1.4.4.4.3.m1.1.1.2" xref="S4.T5.st1.4.4.4.3.m1.1.1.2.cmml">J</mi><mo id="S4.T5.st1.4.4.4.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T5.st1.4.4.4.3.m1.1.1.1.cmml">&amp;</mo><mi id="S4.T5.st1.4.4.4.3.m1.1.1.3" xref="S4.T5.st1.4.4.4.3.m1.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.st1.4.4.4.3.m1.1b"><apply id="S4.T5.st1.4.4.4.3.m1.1.1.cmml" xref="S4.T5.st1.4.4.4.3.m1.1.1"><and id="S4.T5.st1.4.4.4.3.m1.1.1.1.cmml" xref="S4.T5.st1.4.4.4.3.m1.1.1.1"></and><ci id="S4.T5.st1.4.4.4.3.m1.1.1.2.cmml" xref="S4.T5.st1.4.4.4.3.m1.1.1.2">𝐽</ci><ci id="S4.T5.st1.4.4.4.3.m1.1.1.3.cmml" xref="S4.T5.st1.4.4.4.3.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.st1.4.4.4.3.m1.1c">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.T5.st1.4.4.4.3.m1.1d">italic_J &amp; italic_F</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.st1.4.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.st1.4.4.5.1.1" style="padding-left:5.7pt;padding-right:5.7pt;">COCO</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.st1.4.4.5.1.2" style="padding-left:5.7pt;padding-right:5.7pt;">24.4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st1.4.4.5.1.3" style="padding-left:5.7pt;padding-right:5.7pt;">10.5</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.st1.4.4.5.1.4" style="padding-left:5.7pt;padding-right:5.7pt;">11.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st1.4.4.5.1.5" style="padding-left:5.7pt;padding-right:5.7pt;">63.2</td>
</tr>
<tr class="ltx_tr" id="S4.T5.st1.4.4.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.st1.4.4.6.2.1" style="padding-left:5.7pt;padding-right:5.7pt;">+ ADE20K</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st1.4.4.6.2.2" style="padding-left:5.7pt;padding-right:5.7pt;">25.5</th>
<td class="ltx_td ltx_align_center" id="S4.T5.st1.4.4.6.2.3" style="padding-left:5.7pt;padding-right:5.7pt;">19.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.st1.4.4.6.2.4" style="padding-left:5.7pt;padding-right:5.7pt;">18.2</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st1.4.4.6.2.5" style="padding-left:5.7pt;padding-right:5.7pt;">68.8</td>
</tr>
<tr class="ltx_tr" id="S4.T5.st1.4.4.7.3" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T5.st1.4.4.7.3.1" style="padding-left:5.7pt;padding-right:5.7pt;"><span class="ltx_text" id="S4.T5.st1.4.4.7.3.1.1" style="background-color:#FFF2F2;">+ Objects365</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st1.4.4.7.3.2" style="padding-left:5.7pt;padding-right:5.7pt;"><span class="ltx_text" id="S4.T5.st1.4.4.7.3.2.1" style="background-color:#FFF2F2;">28.3</span></th>
<td class="ltx_td ltx_align_center" id="S4.T5.st1.4.4.7.3.3" style="padding-left:5.7pt;padding-right:5.7pt;"><span class="ltx_text" id="S4.T5.st1.4.4.7.3.3.1" style="background-color:#FFF2F2;">22.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.st1.4.4.7.3.4" style="padding-left:5.7pt;padding-right:5.7pt;"><span class="ltx_text" id="S4.T5.st1.4.4.7.3.4.1" style="background-color:#FFF2F2;">21.5</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.st1.4.4.7.3.5" style="padding-left:5.7pt;padding-right:5.7pt;"><span class="ltx_text" id="S4.T5.st1.4.4.7.3.5.1" style="background-color:#FFF2F2;">77.0</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T5.st1.6.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.T5.st1.7.2" style="font-size:90%;">Ablation study of training data.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T5.st2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.st2.3" style="width:191.5pt;height:65.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-36.3pt,12.4pt) scale(0.725,0.725) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.st2.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.st2.3.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st2.3.3.4.1.1" rowspan="2" style="padding-left:8.5pt;padding-right:8.5pt;"><span class="ltx_text" id="S4.T5.st2.3.3.4.1.1.1">Frames</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="6" id="S4.T5.st2.3.3.4.1.2" style="padding-left:8.5pt;padding-right:8.5pt;">DAVIS 2017</th>
</tr>
<tr class="ltx_tr" id="S4.T5.st2.3.3.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st2.3.3.5.2.1" style="padding-left:8.5pt;padding-right:8.5pt;">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st2.3.3.5.2.2" style="padding-left:8.5pt;padding-right:8.5pt;">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st2.3.3.5.2.3" style="padding-left:8.5pt;padding-right:8.5pt;">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st2.3.3.5.2.4" style="background-color:#FFF2F2;padding-left:8.5pt;padding-right:8.5pt;"><span class="ltx_text" id="S4.T5.st2.3.3.5.2.4.1" style="background-color:#FFF2F2;">6</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st2.3.3.5.2.5" style="padding-left:8.5pt;padding-right:8.5pt;">8</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st2.3.3.5.2.6" style="padding-left:8.5pt;padding-right:8.5pt;">10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.st2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.st2.1.1.1.1" style="padding-left:8.5pt;padding-right:8.5pt;"><math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.T5.st2.1.1.1.1.m1.1"><semantics id="S4.T5.st2.1.1.1.1.m1.1a"><mrow id="S4.T5.st2.1.1.1.1.m1.1.1" xref="S4.T5.st2.1.1.1.1.m1.1.1.cmml"><mi id="S4.T5.st2.1.1.1.1.m1.1.1.2" xref="S4.T5.st2.1.1.1.1.m1.1.1.2.cmml">J</mi><mo id="S4.T5.st2.1.1.1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T5.st2.1.1.1.1.m1.1.1.1.cmml">&amp;</mo><mi id="S4.T5.st2.1.1.1.1.m1.1.1.3" xref="S4.T5.st2.1.1.1.1.m1.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.st2.1.1.1.1.m1.1b"><apply id="S4.T5.st2.1.1.1.1.m1.1.1.cmml" xref="S4.T5.st2.1.1.1.1.m1.1.1"><and id="S4.T5.st2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T5.st2.1.1.1.1.m1.1.1.1"></and><ci id="S4.T5.st2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T5.st2.1.1.1.1.m1.1.1.2">𝐽</ci><ci id="S4.T5.st2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T5.st2.1.1.1.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.st2.1.1.1.1.m1.1c">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.T5.st2.1.1.1.1.m1.1d">italic_J &amp; italic_F</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st2.1.1.1.2" style="padding-left:8.5pt;padding-right:8.5pt;">70.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st2.1.1.1.3" style="padding-left:8.5pt;padding-right:8.5pt;">76.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st2.1.1.1.4" style="padding-left:8.5pt;padding-right:8.5pt;">76.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st2.1.1.1.5" style="background-color:#FFF2F2;padding-left:8.5pt;padding-right:8.5pt;"><span class="ltx_text" id="S4.T5.st2.1.1.1.5.1" style="background-color:#FFF2F2;">77.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st2.1.1.1.6" style="padding-left:8.5pt;padding-right:8.5pt;">77.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st2.1.1.1.7" style="padding-left:8.5pt;padding-right:8.5pt;">76.0</td>
</tr>
<tr class="ltx_tr" id="S4.T5.st2.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st2.2.2.2.1" style="padding-left:8.5pt;padding-right:8.5pt;"><math alttext="J" class="ltx_Math" display="inline" id="S4.T5.st2.2.2.2.1.m1.1"><semantics id="S4.T5.st2.2.2.2.1.m1.1a"><mi id="S4.T5.st2.2.2.2.1.m1.1.1" xref="S4.T5.st2.2.2.2.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.T5.st2.2.2.2.1.m1.1b"><ci id="S4.T5.st2.2.2.2.1.m1.1.1.cmml" xref="S4.T5.st2.2.2.2.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.st2.2.2.2.1.m1.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.T5.st2.2.2.2.1.m1.1d">italic_J</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.2.2.2.2" style="padding-left:8.5pt;padding-right:8.5pt;">66.1</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.2.2.2.3" style="padding-left:8.5pt;padding-right:8.5pt;">71.5</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.2.2.2.4" style="padding-left:8.5pt;padding-right:8.5pt;">71.9</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.2.2.2.5" style="background-color:#FFF2F2;padding-left:8.5pt;padding-right:8.5pt;"><span class="ltx_text" id="S4.T5.st2.2.2.2.5.1" style="background-color:#FFF2F2;">72.6</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.2.2.2.6" style="padding-left:8.5pt;padding-right:8.5pt;">72.7</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.2.2.2.7" style="padding-left:8.5pt;padding-right:8.5pt;">71.6</td>
</tr>
<tr class="ltx_tr" id="S4.T5.st2.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st2.3.3.3.1" style="padding-left:8.5pt;padding-right:8.5pt;"><math alttext="F" class="ltx_Math" display="inline" id="S4.T5.st2.3.3.3.1.m1.1"><semantics id="S4.T5.st2.3.3.3.1.m1.1a"><mi id="S4.T5.st2.3.3.3.1.m1.1.1" xref="S4.T5.st2.3.3.3.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.T5.st2.3.3.3.1.m1.1b"><ci id="S4.T5.st2.3.3.3.1.m1.1.1.cmml" xref="S4.T5.st2.3.3.3.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.st2.3.3.3.1.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.T5.st2.3.3.3.1.m1.1d">italic_F</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.3.3.3.2" style="padding-left:8.5pt;padding-right:8.5pt;">75.8</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.3.3.3.3" style="padding-left:8.5pt;padding-right:8.5pt;">81.0</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.3.3.3.4" style="padding-left:8.5pt;padding-right:8.5pt;">81.4</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.3.3.3.5" style="background-color:#FFF2F2;padding-left:8.5pt;padding-right:8.5pt;"><span class="ltx_text" id="S4.T5.st2.3.3.3.5.1" style="background-color:#FFF2F2;">81.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.3.3.3.6" style="padding-left:8.5pt;padding-right:8.5pt;">81.3</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st2.3.3.3.7" style="padding-left:8.5pt;padding-right:8.5pt;">80.3</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T5.st2.5.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.T5.st2.6.2" style="font-size:90%;">Effect of the number of frames for VOS.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T5.st3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T5.st3.4" style="width:314.5pt;height:66pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-59.6pt,12.4pt) scale(0.725,0.725) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.st3.4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.st3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st3.1.1.1.2" rowspan="2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.1.1.1.2.1">In-Context Fusion</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st3.1.1.1.3" rowspan="2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.1.1.1.3.1">Decoder</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st3.1.1.1.1" style="padding-left:11.4pt;padding-right:11.4pt;">LVIS-92<sup class="ltx_sup" id="S4.T5.st3.1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S4.T5.st3.1.1.1.1.1.1">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" colspan="2" id="S4.T5.st3.1.1.1.4" style="padding-left:11.4pt;padding-right:11.4pt;">COCO-NOVEL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st3.1.1.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">DAVIS 2017</th>
</tr>
<tr class="ltx_tr" id="S4.T5.st3.4.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.4.4" style="padding-left:11.4pt;padding-right:11.4pt;">mean mIoU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st3.2.2.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">AP<sub class="ltx_sub" id="S4.T5.st3.2.2.2.1.1"><span class="ltx_text ltx_font_italic" id="S4.T5.st3.2.2.2.1.1.1">box</span></sub>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S4.T5.st3.3.3.3.2" style="padding-left:11.4pt;padding-right:11.4pt;">AP<sub class="ltx_sub" id="S4.T5.st3.3.3.3.2.1"><span class="ltx_text ltx_font_italic" id="S4.T5.st3.3.3.3.2.1.1">mask</span></sub>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T5.st3.4.4.4.3" style="padding-left:11.4pt;padding-right:11.4pt;"><math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.T5.st3.4.4.4.3.m1.1"><semantics id="S4.T5.st3.4.4.4.3.m1.1a"><mrow id="S4.T5.st3.4.4.4.3.m1.1.1" xref="S4.T5.st3.4.4.4.3.m1.1.1.cmml"><mi id="S4.T5.st3.4.4.4.3.m1.1.1.2" xref="S4.T5.st3.4.4.4.3.m1.1.1.2.cmml">J</mi><mo id="S4.T5.st3.4.4.4.3.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T5.st3.4.4.4.3.m1.1.1.1.cmml">&amp;</mo><mi id="S4.T5.st3.4.4.4.3.m1.1.1.3" xref="S4.T5.st3.4.4.4.3.m1.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.st3.4.4.4.3.m1.1b"><apply id="S4.T5.st3.4.4.4.3.m1.1.1.cmml" xref="S4.T5.st3.4.4.4.3.m1.1.1"><and id="S4.T5.st3.4.4.4.3.m1.1.1.1.cmml" xref="S4.T5.st3.4.4.4.3.m1.1.1.1"></and><ci id="S4.T5.st3.4.4.4.3.m1.1.1.2.cmml" xref="S4.T5.st3.4.4.4.3.m1.1.1.2">𝐽</ci><ci id="S4.T5.st3.4.4.4.3.m1.1.1.3.cmml" xref="S4.T5.st3.4.4.4.3.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.st3.4.4.4.3.m1.1c">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.T5.st3.4.4.4.3.m1.1d">italic_J &amp; italic_F</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.st3.4.4.5.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.st3.4.4.5.1.1" style="padding-left:11.4pt;padding-right:11.4pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.st3.4.4.5.1.2" style="padding-left:11.4pt;padding-right:11.4pt;">Mask2Fomer</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T5.st3.4.4.5.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">22.2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st3.4.4.5.1.4" style="padding-left:11.4pt;padding-right:11.4pt;">8.6</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T5.st3.4.4.5.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">9.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.st3.4.4.5.1.6" style="padding-left:11.4pt;padding-right:11.4pt;">61.1</td>
</tr>
<tr class="ltx_tr" id="S4.T5.st3.4.4.6.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.6.2.1" style="padding-left:11.4pt;padding-right:11.4pt;">✓</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.6.2.2" style="padding-left:11.4pt;padding-right:11.4pt;">Mask2Fomer</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.6.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">23.5</th>
<td class="ltx_td ltx_align_center" id="S4.T5.st3.4.4.6.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">8.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.st3.4.4.6.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">10.6</td>
<td class="ltx_td ltx_align_center" id="S4.T5.st3.4.4.6.2.6" style="padding-left:11.4pt;padding-right:11.4pt;">62.3</td>
</tr>
<tr class="ltx_tr" id="S4.T5.st3.4.4.7.3" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.7.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.4.4.7.3.1.1" style="background-color:#FFF2F2;">✓</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.7.3.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.4.4.7.3.2.1" style="background-color:#FFF2F2;">M-Former</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T5.st3.4.4.7.3.3" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.4.4.7.3.3.1" style="background-color:#FFF2F2;">24.4</span></th>
<td class="ltx_td ltx_align_center" id="S4.T5.st3.4.4.7.3.4" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.4.4.7.3.4.1" style="background-color:#FFF2F2;">10.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T5.st3.4.4.7.3.5" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.4.4.7.3.5.1" style="background-color:#FFF2F2;">11.4</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.st3.4.4.7.3.6" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S4.T5.st3.4.4.7.3.6.1" style="background-color:#FFF2F2;">63.2</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T5.st3.6.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.T5.st3.7.2" style="font-size:90%;">Effect of proposed components.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T5.14.5.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="S4.T5.8.4" style="font-size:90%;">Ablation study. We report the mIoU of fold0 on LVIS-92<sup class="ltx_sup" id="S4.T5.8.4.1"><span class="ltx_text ltx_font_italic" id="S4.T5.8.4.1.1">i</span></sup>, AP<sub class="ltx_sub" id="S4.T5.8.4.2"><span class="ltx_text ltx_font_italic" id="S4.T5.8.4.2.1">box</span></sub> and AP<sub class="ltx_sub" id="S4.T5.8.4.3"><span class="ltx_text ltx_font_italic" id="S4.T5.8.4.3.1">mask</span></sub> of seed0 on COCO-NOVEL, and <math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.T5.8.4.m4.1"><semantics id="S4.T5.8.4.m4.1b"><mrow id="S4.T5.8.4.m4.1.1" xref="S4.T5.8.4.m4.1.1.cmml"><mi id="S4.T5.8.4.m4.1.1.2" xref="S4.T5.8.4.m4.1.1.2.cmml">J</mi><mo id="S4.T5.8.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.T5.8.4.m4.1.1.1.cmml">&amp;</mo><mi id="S4.T5.8.4.m4.1.1.3" xref="S4.T5.8.4.m4.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.8.4.m4.1c"><apply id="S4.T5.8.4.m4.1.1.cmml" xref="S4.T5.8.4.m4.1.1"><and id="S4.T5.8.4.m4.1.1.1.cmml" xref="S4.T5.8.4.m4.1.1.1"></and><ci id="S4.T5.8.4.m4.1.1.2.cmml" xref="S4.T5.8.4.m4.1.1.2">𝐽</ci><ci id="S4.T5.8.4.m4.1.1.3.cmml" xref="S4.T5.8.4.m4.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.8.4.m4.1d">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.T5.8.4.m4.1e">italic_J &amp; italic_F</annotation></semantics></math> on DAVIS 2017. <span class="ltx_text" id="S4.T5.8.4.4" style="background-color:#FFF2F2;">Pink</span> is the default
setting. </span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Ablation Study</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T5" title="Table 5 ‣ 4.4 Video Object Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">5</span></a>, we conduct ablation experiments on LVIS-92<sup class="ltx_sup" id="S4.SS5.p1.1.1"><span class="ltx_text ltx_font_italic" id="S4.SS5.p1.1.1.1">i</span></sup> for few-shot semantic segmentation, COCO-NOVEL dataset for few-shot instance segmentation, DAVIS 2017 for video object segmentation, and ADE20K for the semantic segmentation task, to thoroughly validate the effectiveness of the proposed components and the impact of training with different datasets. Unless specified, only fold0 and seed0 are used for the ablation on the few-shot semantic/instance segmentation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p2.1.1">Effect of different training data.</span>
We train SINE on different data sources (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T5.st1" title="In Table 5 ‣ 4.4 Video Object Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">5(a)</span></a>). We validate that incorporating more diverse semantic segmentation data, such as ADE20K, helps improve the model. Furthermore, we demonstrate for the first time that adding additional detection data, such as Object365, greatly enhances the model’s in-context segmentation capability.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p3">
<p class="ltx_p" id="S4.SS5.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p3.1.1">Ablation study of proposed components.</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T5.st3" title="In Table 5 ‣ 4.4 Video Object Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">5(c)</span></a> shows the impact of the proposed components and all experiments only use COCO as training data. The proposed In-Context Fusion module leads to improvements in mean mIoU, AP and <math alttext="J\&amp;F" class="ltx_Math" display="inline" id="S4.SS5.p3.1.m1.1"><semantics id="S4.SS5.p3.1.m1.1a"><mrow id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml"><mi id="S4.SS5.p3.1.m1.1.1.2" xref="S4.SS5.p3.1.m1.1.1.2.cmml">J</mi><mo id="S4.SS5.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS5.p3.1.m1.1.1.1.cmml">&amp;</mo><mi id="S4.SS5.p3.1.m1.1.1.3" xref="S4.SS5.p3.1.m1.1.1.3.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><apply id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1"><and id="S4.SS5.p3.1.m1.1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1.1"></and><ci id="S4.SS5.p3.1.m1.1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.1.2">𝐽</ci><ci id="S4.SS5.p3.1.m1.1.1.3.cmml" xref="S4.SS5.p3.1.m1.1.1.3">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">J\&amp;F</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p3.1.m1.1d">italic_J &amp; italic_F</annotation></semantics></math>. Further enhancements are observed across all evaluation metrics when the M-Former is used. This demonstrates the effectiveness of the proposed components in improving the model’s performance for various segmentation tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS5.p4">
<p class="ltx_p" id="S4.SS5.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS5.p4.1.1">Varying the number of frames</span>
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#S4.T5.st2" title="In Table 5 ‣ 4.4 Video Object Segmentation ‣ 4 Experiments ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">5(b)</span></a> demonstrates a gradual improvement in the overall segmentation quality as the number of frames increases from 1 to 6. Overall, using a moderate number of frames, such as 6 or 8, achieves optimal VOS performance on the DAVIS 2017 dataset.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion and Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Conclusion</span> In this work, we point out the task ambiguity in in-context segmentation for the first time and present SINE, which simultaneously predicts multiple task-specific masks to address this problem.
Leveraging the efficient design, SINE can utilize few trainable parameters to exhibit strong segmentation abilities.We hope SINE can promote the development of in-context segmentation. <span class="ltx_text ltx_font_bold" id="S5.p1.1.2">Limitation</span> and more <span class="ltx_text ltx_font_bold" id="S5.p1.1.3">Discussions</span> are provided in <span class="ltx_text" id="S5.p1.1.4" style="color:#0000FF;">Appendix</span> <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A1" title="Appendix A Discussions and Limitation ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bibx1">
<span class="ltx_tag ltx_tag_bibitem">[BGD<sup class="ltx_sup" id="bib.bibx1.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx1.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx1.7.1" style="font-size:90%;">
Amir Bar, Yossi Gandelsman, Trevor Darrell, Amir Globerson, and Alexei Efros.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx1.8.1" style="font-size:90%;">Visual prompting via image inpainting.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx1.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx1.10.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx1.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx2">
<span class="ltx_tag ltx_tag_bibitem">[BMR<sup class="ltx_sup" id="bib.bibx2.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx2.4.4.1.1">+</span></sup>20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx2.7.1" style="font-size:90%;">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx2.8.1" style="font-size:90%;">Language models are few-shot learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx2.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx2.10.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx2.11.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx3">
<span class="ltx_tag ltx_tag_bibitem">[BZXL19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx3.1.1" style="font-size:90%;">
Daniel Bolya, Chong Zhou, Fanyi Xiao, and Yong Jae Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx3.2.1" style="font-size:90%;">Yolact: Real-time instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx3.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx3.4.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx3.5.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx4">
<span class="ltx_tag ltx_tag_bibitem">[CMS<sup class="ltx_sup" id="bib.bibx4.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx4.4.4.1.1">+</span></sup>20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx4.7.1" style="font-size:90%;">
Nicolas Carion, Francisco Massa, Gabriel Synnaeve, Nicolas Usunier, Alexander
Kirillov, and Sergey Zagoruyko.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx4.8.1" style="font-size:90%;">End-to-end object detection with transformers.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx4.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx4.10.2" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx4.11.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx5">
<span class="ltx_tag ltx_tag_bibitem">[CMS<sup class="ltx_sup" id="bib.bibx5.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx5.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx5.7.1" style="font-size:90%;">
Bowen Cheng, Ishan Misra, Alexander G Schwing, Alexander Kirillov, and Rohit
Girdhar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx5.8.1" style="font-size:90%;">Masked-attention mask transformer for universal image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx5.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx5.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx5.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx6">
<span class="ltx_tag ltx_tag_bibitem">[CS22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx6.1.1" style="font-size:90%;">
Ho Kei Cheng and Alexander G Schwing.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx6.2.1" style="font-size:90%;">Xmem: Long-term video object segmentation with an atkinson-shiffrin
memory model.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx6.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx6.4.2" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx6.5.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx7">
<span class="ltx_tag ltx_tag_bibitem">[DBK<sup class="ltx_sup" id="bib.bibx7.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx7.4.4.1.1">+</span></sup>20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx7.7.1" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx7.8.1" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at
scale.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx7.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx7.10.2" style="font-size:90%;">Int. Conf. Learn. Represent.</span><span class="ltx_text" id="bib.bibx7.11.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx8">
<span class="ltx_tag ltx_tag_bibitem">[DBNVG17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx8.1.1" style="font-size:90%;">
Bert De Brabandere, Davy Neven, and Luc Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx8.2.1" style="font-size:90%;">Semantic instance segmentation with a discriminative loss function.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx8.3.1" style="font-size:90%;">arXiv preprint arXiv:1708.02551</span><span class="ltx_text" id="bib.bibx8.4.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx9">
<span class="ltx_tag ltx_tag_bibitem">[EVGW<sup class="ltx_sup" id="bib.bibx9.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx9.4.4.1.1">+</span></sup>10]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx9.7.1" style="font-size:90%;">
Mark Everingham, Luc Van Gool, Christopher KI Williams, John Winn, and Andrew
Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx9.8.1" style="font-size:90%;">The pascal visual object classes (voc) challenge.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx9.9.1" style="font-size:90%;">Int. J. Comput. Vis.</span><span class="ltx_text" id="bib.bibx9.10.2" style="font-size:90%;">, 2010.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx10">
<span class="ltx_tag ltx_tag_bibitem">[FYL<sup class="ltx_sup" id="bib.bibx10.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx10.4.4.1.1">+</span></sup>20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx10.7.1" style="font-size:90%;">
Zhibo Fan, Jin-Gang Yu, Zhihao Liang, Jiarong Ou, Changxin Gao, Gui-Song Xia,
and Yuanqing Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx10.8.1" style="font-size:90%;">Fgn: Fully guided network for few-shot instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx10.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx10.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx10.11.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx11">
<span class="ltx_tag ltx_tag_bibitem">[GBP21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx11.1.1" style="font-size:90%;">
Dan Andrei Ganea, Bas Boom, and Ronald Poppe.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx11.2.1" style="font-size:90%;">Incremental few-shot instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx11.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx11.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx11.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx12">
<span class="ltx_tag ltx_tag_bibitem">[GCS<sup class="ltx_sup" id="bib.bibx12.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx12.4.4.1.1">+</span></sup>21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx12.7.1" style="font-size:90%;">
Golnaz Ghiasi, Yin Cui, Aravind Srinivas, Rui Qian, Tsung-Yi Lin, Ekin D Cubuk,
Quoc V Le, and Barret Zoph.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx12.8.1" style="font-size:90%;">Simple copy-paste is a strong data augmentation method for instance
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx12.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx12.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx12.11.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx13">
<span class="ltx_tag ltx_tag_bibitem">[GDG19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx13.1.1" style="font-size:90%;">
Agrim Gupta, Piotr Dollar, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx13.2.1" style="font-size:90%;">Lvis: A dataset for large vocabulary instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx13.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx13.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx13.5.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx14">
<span class="ltx_tag ltx_tag_bibitem">[GGCL22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx14.1.1" style="font-size:90%;">
Golnaz Ghiasi, Xiuye Gu, Yin Cui, and Tsung-Yi Lin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx14.2.1" style="font-size:90%;">Scaling open-vocabulary image segmentation with image-level labels.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx14.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx14.4.2" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx14.5.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx15">
<span class="ltx_tag ltx_tag_bibitem">[Gir15]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx15.1.1" style="font-size:90%;">
Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx15.2.1" style="font-size:90%;">Fast R-CNN.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx15.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx15.4.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx15.5.3" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx16">
<span class="ltx_tag ltx_tag_bibitem">[HCN<sup class="ltx_sup" id="bib.bibx16.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx16.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx16.7.1" style="font-size:90%;">
Sunghwan Hong, Seokju Cho, Jisu Nam, Stephen Lin, and Seungryong Kim.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx16.8.1" style="font-size:90%;">Cost aggregation with 4d convolutional swin transformer for few-shot
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx16.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx16.10.2" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx16.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx17">
<span class="ltx_tag ltx_tag_bibitem">[HCX<sup class="ltx_sup" id="bib.bibx17.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx17.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx17.7.1" style="font-size:90%;">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross
Girshick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx17.8.1" style="font-size:90%;">Masked autoencoders are scalable vision learners.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx17.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx17.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx17.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx18">
<span class="ltx_tag ltx_tag_bibitem">[HGDG17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx18.1.1" style="font-size:90%;">
Kaiming He, Georgia Gkioxari, Piotr Dollár, and Ross Girshick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx18.2.1" style="font-size:90%;">Mask r-cnn.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx18.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx18.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx18.5.3" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx19">
<span class="ltx_tag ltx_tag_bibitem">[HSW<sup class="ltx_sup" id="bib.bibx19.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx19.4.4.1.1">+</span></sup>21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx19.7.1" style="font-size:90%;">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean
Wang, Lu Wang, and Weizhu Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx19.8.1" style="font-size:90%;">Lora: Low-rank adaptation of large language models.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx19.9.1" style="font-size:90%;">arXiv preprint arXiv:2106.09685</span><span class="ltx_text" id="bib.bibx19.10.2" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx20">
<span class="ltx_tag ltx_tag_bibitem">[HZX<sup class="ltx_sup" id="bib.bibx20.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx20.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx20.7.1" style="font-size:90%;">
Yue Han, Jiangning Zhang, Zhucun Xue, Chao Xu, Xintian Shen, Yabiao Wang,
Chengjie Wang, Yong Liu, and Xiangtai Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx20.8.1" style="font-size:90%;">Reference twice: A simple and unified baseline for few-shot instance
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx20.9.1" style="font-size:90%;">arXiv preprint arXiv:2301.01156</span><span class="ltx_text" id="bib.bibx20.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx21">
<span class="ltx_tag ltx_tag_bibitem">[JDB<sup class="ltx_sup" id="bib.bibx21.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx21.4.4.1.1">+</span></sup>19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx21.7.1" style="font-size:90%;">
Joakim Johnander, Martin Danelljan, Emil Brissman, Fahad Shahbaz Khan, and
Michael Felsberg.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx21.8.1" style="font-size:90%;">A generative appearance model for end-to-end video object
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx21.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx21.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx21.11.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx22">
<span class="ltx_tag ltx_tag_bibitem">[KGHD19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx22.1.1" style="font-size:90%;">
Alexander Kirillov, Ross Girshick, Kaiming He, and Piotr Dollár.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx22.2.1" style="font-size:90%;">Panoptic feature pyramid networks.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx22.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx22.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx22.5.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx23">
<span class="ltx_tag ltx_tag_bibitem">[KLW<sup class="ltx_sup" id="bib.bibx23.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx23.4.4.1.1">+</span></sup>19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx23.7.1" style="font-size:90%;">
Bingyi Kang, Zhuang Liu, Xin Wang, Fisher Yu, Jiashi Feng, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx23.8.1" style="font-size:90%;">Few-shot object detection via feature reweighting.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx23.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx23.10.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx23.11.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx24">
<span class="ltx_tag ltx_tag_bibitem">[KMR<sup class="ltx_sup" id="bib.bibx24.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx24.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx24.7.1" style="font-size:90%;">
Alexander Kirillov, Eric Mintun, Nikhila Ravi, Hanzi Mao, Chloe Rolland, Laura
Gustafson, Tete Xiao, Spencer Whitehead, Alexander C Berg, Wan-Yen Lo, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx24.8.1" style="font-size:90%;">Segment anything.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx24.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx24.10.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx24.11.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx25">
<span class="ltx_tag ltx_tag_bibitem">[KSPB<sup class="ltx_sup" id="bib.bibx25.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx25.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx25.7.1" style="font-size:90%;">
Alexander Kolesnikov, André Susano Pinto, Lucas Beyer, Xiaohua Zhai,
Jeremiah Harmsen, and Neil Houlsby.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx25.8.1" style="font-size:90%;">Uvim: A unified modeling approach for vision with learned guiding
codes.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx25.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx25.10.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx25.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx26">
<span class="ltx_tag ltx_tag_bibitem">[LH17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx26.1.1" style="font-size:90%;">
Ilya Loshchilov and Frank Hutter.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx26.2.1" style="font-size:90%;">Decoupled weight decay regularization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx26.3.1" style="font-size:90%;">arXiv preprint arXiv:1711.05101</span><span class="ltx_text" id="bib.bibx26.4.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx27">
<span class="ltx_tag ltx_tag_bibitem">[LJZ<sup class="ltx_sup" id="bib.bibx27.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx27.4.4.1.1">+</span></sup>24]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx27.7.1" style="font-size:90%;">
Feng Li, Qing Jiang, Hao Zhang, Tianhe Ren, Shilong Liu, Xueyan Zou, Huaizhe
Xu, Hongyang Li, Jianwei Yang, Chunyuan Li, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx27.8.1" style="font-size:90%;">Visual in-context prompting.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx27.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx27.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx27.11.3" style="font-size:90%;">, 2024.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx28">
<span class="ltx_tag ltx_tag_bibitem">[LLJC20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx28.1.1" style="font-size:90%;">
Yongqing Liang, Xin Li, Navid Jafari, and Jim Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx28.2.1" style="font-size:90%;">Video object segmentation with adaptive feature bank and
uncertain-region refinement.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx28.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx28.4.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx28.5.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx29">
<span class="ltx_tag ltx_tag_bibitem">[LMB<sup class="ltx_sup" id="bib.bibx29.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx29.4.4.1.1">+</span></sup>14]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx29.7.1" style="font-size:90%;">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx29.8.1" style="font-size:90%;">Microsoft coco: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx29.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx29.10.2" style="font-size:90%;">Eur. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx29.11.3" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx30">
<span class="ltx_tag ltx_tag_bibitem">[LMSR17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx30.1.1" style="font-size:90%;">
Guosheng Lin, Anton Milan, Chunhua Shen, and Ian Reid.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx30.2.1" style="font-size:90%;">Refinenet: Multi-path refinement networks for high-resolution
semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx30.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx30.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx30.5.3" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx31">
<span class="ltx_tag ltx_tag_bibitem">[LQJ19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx31.1.1" style="font-size:90%;">
Huaijia Lin, Xiaojuan Qi, and Jiaya Jia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx31.2.1" style="font-size:90%;">Agss-vos: Attention guided single-shot video object segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx31.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx31.4.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx31.5.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx32">
<span class="ltx_tag ltx_tag_bibitem">[LSD15]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx32.1.1" style="font-size:90%;">
Jonathan Long, Evan Shelhamer, and Trevor Darrell.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx32.2.1" style="font-size:90%;">Fully convolutional networks for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx32.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx32.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx32.5.3" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx33">
<span class="ltx_tag ltx_tag_bibitem">[LYL<sup class="ltx_sup" id="bib.bibx33.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx33.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx33.7.1" style="font-size:90%;">
Zhihui Lin, Tianyu Yang, Maomao Li, Ziyu Wang, Chun Yuan, Wenhao Jiang, and Wei
Liu.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx33.8.1" style="font-size:90%;">Swem: Towards real-time video object segmentation with sequential
weighted expectation-maximization.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx33.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx33.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx33.11.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx34">
<span class="ltx_tag ltx_tag_bibitem">[LZL<sup class="ltx_sup" id="bib.bibx34.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx34.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx34.7.1" style="font-size:90%;">
Yang Liu, Muzhi Zhu, Hengtao Li, Hao Chen, Xinlong Wang, and Chunhua Shen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx34.8.1" style="font-size:90%;">Matcher: Segment anything with one shot using all-purpose feature
matching.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx34.9.1" style="font-size:90%;">arXiv preprint arXiv:2305.13310</span><span class="ltx_text" id="bib.bibx34.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx35">
<span class="ltx_tag ltx_tag_bibitem">[MAV20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx35.1.1" style="font-size:90%;">
Keval Morabia, Jatin Arora, and Tara Vijaykumar.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx35.2.1" style="font-size:90%;">Attention-based joint detection of object and semantic part.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx35.3.1" style="font-size:90%;">arXiv preprint arXiv:2007.02419</span><span class="ltx_text" id="bib.bibx35.4.2" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx36">
<span class="ltx_tag ltx_tag_bibitem">[MGD<sup class="ltx_sup" id="bib.bibx36.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx36.4.4.1.1">+</span></sup>22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx36.7.1" style="font-size:90%;">
Sourab Mangrulkar, Sylvain Gugger, Lysandre Debut, Younes Belkada, Sayak Paul,
and Benjamin Bossan.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx36.8.1" style="font-size:90%;">Peft: State-of-the-art parameter-efficient fine-tuning methods, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx37">
<span class="ltx_tag ltx_tag_bibitem">[MKC21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx37.1.1" style="font-size:90%;">
Juhong Min, Dahyun Kang, and Minsu Cho.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx37.2.1" style="font-size:90%;">Hypercorrelation squeeze for few-shot segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx37.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx37.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx37.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx38">
<span class="ltx_tag ltx_tag_bibitem">[MNA16]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx38.1.1" style="font-size:90%;">
Fausto Milletari, Nassir Navab, and Seyed-Ahmad Ahmadi.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx38.2.1" style="font-size:90%;">V-net: Fully convolutional neural networks for volumetric medical
image segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx38.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx38.4.2" style="font-size:90%;">International Conf. 3D vision (3DV)</span><span class="ltx_text" id="bib.bibx38.5.3" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx39">
<span class="ltx_tag ltx_tag_bibitem">[MVL18]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx39.1.1" style="font-size:90%;">
Sabarinath Mahadevan, Paul Voigtlaender, and Bastian Leibe.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx39.2.1" style="font-size:90%;">Iteratively trained interactive segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx39.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx39.4.2" style="font-size:90%;">Brit. Mach. Vis. Conf.</span><span class="ltx_text" id="bib.bibx39.5.3" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx40">
<span class="ltx_tag ltx_tag_bibitem">[NT19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx40.1.1" style="font-size:90%;">
Khoi Nguyen and Sinisa Todorovic.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx40.2.1" style="font-size:90%;">Feature weighting and boosting for few-shot segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx40.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx40.4.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx40.5.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx41">
<span class="ltx_tag ltx_tag_bibitem">[ODM<sup class="ltx_sup" id="bib.bibx41.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx41.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx41.7.1" style="font-size:90%;">
Maxime Oquab, Timothée Darcet, Théo Moutakanni, Huy Vo, Marc
Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa,
Alaaeldin El-Nouby, et al.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx41.8.1" style="font-size:90%;">Dinov2: Learning robust visual features without supervision.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx41.9.1" style="font-size:90%;">arXiv preprint arXiv:2304.07193</span><span class="ltx_text" id="bib.bibx41.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx42">
<span class="ltx_tag ltx_tag_bibitem">[PPTM<sup class="ltx_sup" id="bib.bibx42.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx42.4.4.1.1">+</span></sup>16]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx42.7.1" style="font-size:90%;">
Federico Perazzi, Jordi Pont-Tuset, Brian McWilliams, Luc Van Gool, Markus
Gross, and Alexander Sorkine-Hornung.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx42.8.1" style="font-size:90%;">A benchmark dataset and evaluation methodology for video object
segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx42.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx42.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx42.11.3" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx43">
<span class="ltx_tag ltx_tag_bibitem">[PTPC<sup class="ltx_sup" id="bib.bibx43.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx43.4.4.1.1">+</span></sup>17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx43.7.1" style="font-size:90%;">
Jordi Pont-Tuset, Federico Perazzi, Sergi Caelles, Pablo Arbeláez, Alex
Sorkine-Hornung, and Luc Van Gool.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx43.8.1" style="font-size:90%;">The 2017 davis challenge on video object segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx43.9.1" style="font-size:90%;">arXiv preprint arXiv:1704.00675</span><span class="ltx_text" id="bib.bibx43.10.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx44">
<span class="ltx_tag ltx_tag_bibitem">[RBK21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx44.1.1" style="font-size:90%;">
René Ranftl, Alexey Bochkovskiy, and Vladlen Koltun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx44.2.1" style="font-size:90%;">Vision transformers for dense prediction.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx44.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx44.4.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx44.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx45">
<span class="ltx_tag ltx_tag_bibitem">[SBL<sup class="ltx_sup" id="bib.bibx45.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx45.4.4.1.1">+</span></sup>17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx45.7.1" style="font-size:90%;">
Amirreza Shaban, Shray Bansal, Zhen Liu, Irfan Essa, and Byron Boots.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx45.8.1" style="font-size:90%;">One-shot learning for semantic segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx45.9.1" style="font-size:90%;">arXiv preprint arXiv:1709.03410</span><span class="ltx_text" id="bib.bibx45.10.2" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx46">
<span class="ltx_tag ltx_tag_bibitem">[SG99]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx46.1.1" style="font-size:90%;">
Chris Stauffer and W. Eric Grimson.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx46.2.1" style="font-size:90%;">Adaptive background mixture models for real-time tracking.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx46.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx46.4.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx46.5.3" style="font-size:90%;">, 1999.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx47">
<span class="ltx_tag ltx_tag_bibitem">[SLZ<sup class="ltx_sup" id="bib.bibx47.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx47.4.4.1.1">+</span></sup>19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx47.7.1" style="font-size:90%;">
Shuai Shao, Zeming Li, Tianyuan Zhang, Chao Peng, Gang Yu, Xiangyu Zhang, Jing
Li, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx47.8.1" style="font-size:90%;">Objects365: A large-scale, high-quality dataset for object detection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx47.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx47.10.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx47.11.3" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx48">
<span class="ltx_tag ltx_tag_bibitem">[VSP<sup class="ltx_sup" id="bib.bibx48.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx48.4.4.1.1">+</span></sup>17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx48.7.1" style="font-size:90%;">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx48.8.1" style="font-size:90%;">Attention is all you need.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx48.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx48.10.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx48.11.3" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx49">
<span class="ltx_tag ltx_tag_bibitem">[WWC<sup class="ltx_sup" id="bib.bibx49.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx49.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx49.7.1" style="font-size:90%;">
Xinlong Wang, Wen Wang, Yue Cao, Chunhua Shen, and Tiejun Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx49.8.1" style="font-size:90%;">Images speak in images: A generalist painter for in-context visual
learning.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx49.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx49.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx49.11.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx50">
<span class="ltx_tag ltx_tag_bibitem">[WZC<sup class="ltx_sup" id="bib.bibx50.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx50.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx50.7.1" style="font-size:90%;">
Xinlong Wang, Xiaosong Zhang, Yue Cao, Wen Wang, Chunhua Shen, and Tiejun
Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx50.8.1" style="font-size:90%;">Seggpt: Segmenting everything in context.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx50.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx50.10.2" style="font-size:90%;">Int. Conf. Comput. Vis.</span><span class="ltx_text" id="bib.bibx50.11.3" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx51">
<span class="ltx_tag ltx_tag_bibitem">[WZK<sup class="ltx_sup" id="bib.bibx51.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx51.4.4.1.1">+</span></sup>20]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx51.7.1" style="font-size:90%;">
Xinlong Wang, Rufeng Zhang, Tao Kong, Lei Li, and Chunhua Shen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx51.8.1" style="font-size:90%;">Solov2: Dynamic and fast instance segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx51.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx51.10.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx51.11.3" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx52">
<span class="ltx_tag ltx_tag_bibitem">[XPC<sup class="ltx_sup" id="bib.bibx52.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx52.4.4.1.1">+</span></sup>16]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx52.7.1" style="font-size:90%;">
Ning Xu, Brian Price, Scott Cohen, Jimei Yang, and Thomas S Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx52.8.1" style="font-size:90%;">Deep interactive object selection.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx52.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx52.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx52.11.3" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx53">
<span class="ltx_tag ltx_tag_bibitem">[XYF<sup class="ltx_sup" id="bib.bibx53.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx53.4.4.1.1">+</span></sup>18]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx53.7.1" style="font-size:90%;">
Ning Xu, Linjie Yang, Yuchen Fan, Dingcheng Yue, Yuchen Liang, Jianchao Yang,
and Thomas Huang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx53.8.1" style="font-size:90%;">Youtube-vos: A large-scale video object segmentation benchmark.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx53.9.1" style="font-size:90%;">arXiv preprint arXiv:1809.03327</span><span class="ltx_text" id="bib.bibx53.10.2" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx54">
<span class="ltx_tag ltx_tag_bibitem">[YWY21]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx54.1.1" style="font-size:90%;">
Zongxin Yang, Yunchao Wei, and Yi Yang.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx54.2.1" style="font-size:90%;">Associating objects with transformers for video object segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx54.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx54.4.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx54.5.3" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx55">
<span class="ltx_tag ltx_tag_bibitem">[ZJG<sup class="ltx_sup" id="bib.bibx55.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx55.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx55.7.1" style="font-size:90%;">
Renrui Zhang, Zhengkai Jiang, Ziyu Guo, Shilin Yan, Junting Pan, Hao Dong, Peng
Gao, and Hongsheng Li.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx55.8.1" style="font-size:90%;">Personalize segment anything model with one shot.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx55.9.1" style="font-size:90%;">arXiv preprint arXiv:2305.03048</span><span class="ltx_text" id="bib.bibx55.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx56">
<span class="ltx_tag ltx_tag_bibitem">[ZSQ<sup class="ltx_sup" id="bib.bibx56.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx56.4.4.1.1">+</span></sup>17]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx56.7.1" style="font-size:90%;">
Hengshuang Zhao, Jianping Shi, Xiaojuan Qi, Xiaogang Wang, and Jiaya Jia.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx56.8.1" style="font-size:90%;">Pyramid scene parsing network.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx56.9.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx56.10.2" style="font-size:90%;">IEEE Conf. Comput. Vis. Pattern Recog.</span><span class="ltx_text" id="bib.bibx56.11.3" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx57">
<span class="ltx_tag ltx_tag_bibitem">[ZSYC22]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx57.1.1" style="font-size:90%;">
Jian-Wei Zhang, Yifan Sun, Yi Yang, and Wei Chen.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx57.2.1" style="font-size:90%;">Feature-proxy transformer for few-shot segmentation.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx57.3.1" style="font-size:90%;">In </span><span class="ltx_text ltx_font_italic" id="bib.bibx57.4.2" style="font-size:90%;">Adv. Neural Inform. Process. Syst.</span><span class="ltx_text" id="bib.bibx57.5.3" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx58">
<span class="ltx_tag ltx_tag_bibitem">[ZYZ<sup class="ltx_sup" id="bib.bibx58.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx58.4.4.1.1">+</span></sup>23]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx58.7.1" style="font-size:90%;">
Xueyan Zou, Jianwei Yang, Hao Zhang, Feng Li, Linjie Li, Jianfeng Gao, and
Yong Jae Lee.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx58.8.1" style="font-size:90%;">Segment everything everywhere all at once.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx58.9.1" style="font-size:90%;">arXiv preprint arXiv:2304.06718</span><span class="ltx_text" id="bib.bibx58.10.2" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bibx59">
<span class="ltx_tag ltx_tag_bibitem">[ZZP<sup class="ltx_sup" id="bib.bibx59.4.4.1"><span class="ltx_text ltx_font_italic" id="bib.bibx59.4.4.1.1">+</span></sup>19]</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx59.7.1" style="font-size:90%;">
Bolei Zhou, Hang Zhao, Xavier Puig, Tete Xiao, Sanja Fidler, Adela Barriuso,
and Antonio Torralba.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text" id="bib.bibx59.8.1" style="font-size:90%;">Semantic understanding of scenes through the ade20k dataset.
</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bibx59.9.1" style="font-size:90%;">Int. J. Comput. Vis.</span><span class="ltx_text" id="bib.bibx59.10.2" style="font-size:90%;">, 2019.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Discussions and Limitation</h2>
<div class="ltx_para ltx_noindent" id="A1.p1">
<p class="ltx_p" id="A1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.p1.1.1">Comparison to SegGPT</span> Both SINE and SegGPT are in-context segmentation models. SINE’s flexibility is comparable to SegGPT for various segmentation tasks. SINE can handle instance segmentation, which fails in SegGPT. SegGPT cannot deal with task ambiguity. The pixel output of SegGPT is not the final result and necessitates complex post-processing that converts the RGB output to mask. SINE avert this problem by predicting the mask directly. Stitching reference and target in SegGPT limits its capacity to process high-resolution images. SINE does not have this problem.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p2">
<p class="ltx_p" id="A1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.p2.1.1">Comparison to SAM</span> SINE and SAM offer different paths to the segmentation foundation model. SAM provides semantic-free promptable segmentation, while SINE handles semantic in-context segmentation. With different emphases, SINE and SAM can complement each other.
Take auto-labeling as an example. SAM labels objects (<em class="ltx_emph ltx_font_italic" id="A1.p2.1.2">e.g.</em>, a dog) in the first image. SINE could use that image as an in-context example to label subsequent images to reduce costs.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p3">
<p class="ltx_p" id="A1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.p3.1.1">Limitation</span> As the first work to study ambiguity in in-context segmentation, SINE focuses on resolving ambiguities among ID, instance, and semantic segmentation tasks (as these are more important and commonly used).
More complex ambiguities, such as full objects and parts, spatial position, category, and color, can be addressed by incorporating multimodal in-context examples (e.g., image and text).
In addition, SINE has a performance gap compared with SegGPT. We think the reason behind this performance gap is that SegGPT trains all model parameters (300M), while SINE uses a simpler in-context fusion module and fewer learnable parameters (19M), limiting its ability to handle inter-frame relations in complex videos. Although SINE currently has limitations in learning complex inter-frame relationships in videos, we believe that by designing a more suitable In-Context Interaction module, the current paradigm holds greater potential for solving in-context segmentation tasks.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.p4">
<p class="ltx_p" id="A1.p4.1"><span class="ltx_text ltx_font_bold" id="A1.p4.1.1">Broader Impacts</span> Our Method is built upon open-source
foundation models, significantly reducing carbon emissions. We do not foresee any obvious undesirable ethical or social impacts now.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.p1.1.1">Training Details.</span> 
We train our model with diverse segmentation datasets, including semantic, instance, and panoptic. The sampling weight for each dataset is 0.14 (COCO panoptic), 0.14 (ADE20K panoptic), 0.18 (COCO instance), and 0.54 (Objects365 instance). SINE uses two kinds of in-context pairs, selecting two images including the same category objects as the in-context pair or using two transformed views of the same image as the in-context pair. The probability is 0.5 for both in-context pairs.</p>
</div>
<div class="ltx_para" id="A2.p2">
<p class="ltx_p" id="A2.p2.4">We deploy the frozen DINOv2 (ViT-L) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx41" title="">ODM<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> with 304M parameters as the Transformer encoder of SINE and train the In-Context Fusion module and the lightweight Transformer decoder with only 19M trainable parameters. The decoder contains six M-Former blocks. The model size of SINE is comparable with SegGPT (307M). SINE has fewer trainable parameters, leading to more efficient training. We randomly initialize the trainable parameters and train SINE about 50K steps with 64 batch sizes. We use Adam <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx26" title="">LH17</a>]</cite> optimizer and employ <math alttext="\beta_{1}=0.9,\beta_{2}=0.999" class="ltx_Math" display="inline" id="A2.p2.1.m1.2"><semantics id="A2.p2.1.m1.2a"><mrow id="A2.p2.1.m1.2.2.2" xref="A2.p2.1.m1.2.2.3.cmml"><mrow id="A2.p2.1.m1.1.1.1.1" xref="A2.p2.1.m1.1.1.1.1.cmml"><msub id="A2.p2.1.m1.1.1.1.1.2" xref="A2.p2.1.m1.1.1.1.1.2.cmml"><mi id="A2.p2.1.m1.1.1.1.1.2.2" xref="A2.p2.1.m1.1.1.1.1.2.2.cmml">β</mi><mn id="A2.p2.1.m1.1.1.1.1.2.3" xref="A2.p2.1.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A2.p2.1.m1.1.1.1.1.1" xref="A2.p2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="A2.p2.1.m1.1.1.1.1.3" xref="A2.p2.1.m1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A2.p2.1.m1.2.2.2.3" xref="A2.p2.1.m1.2.2.3a.cmml">,</mo><mrow id="A2.p2.1.m1.2.2.2.2" xref="A2.p2.1.m1.2.2.2.2.cmml"><msub id="A2.p2.1.m1.2.2.2.2.2" xref="A2.p2.1.m1.2.2.2.2.2.cmml"><mi id="A2.p2.1.m1.2.2.2.2.2.2" xref="A2.p2.1.m1.2.2.2.2.2.2.cmml">β</mi><mn id="A2.p2.1.m1.2.2.2.2.2.3" xref="A2.p2.1.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="A2.p2.1.m1.2.2.2.2.1" xref="A2.p2.1.m1.2.2.2.2.1.cmml">=</mo><mn id="A2.p2.1.m1.2.2.2.2.3" xref="A2.p2.1.m1.2.2.2.2.3.cmml">0.999</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.2b"><apply id="A2.p2.1.m1.2.2.3.cmml" xref="A2.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="A2.p2.1.m1.2.2.3a.cmml" xref="A2.p2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="A2.p2.1.m1.1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1.1"><eq id="A2.p2.1.m1.1.1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1.1.1"></eq><apply id="A2.p2.1.m1.1.1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A2.p2.1.m1.1.1.1.1.2.1.cmml" xref="A2.p2.1.m1.1.1.1.1.2">subscript</csymbol><ci id="A2.p2.1.m1.1.1.1.1.2.2.cmml" xref="A2.p2.1.m1.1.1.1.1.2.2">𝛽</ci><cn id="A2.p2.1.m1.1.1.1.1.2.3.cmml" type="integer" xref="A2.p2.1.m1.1.1.1.1.2.3">1</cn></apply><cn id="A2.p2.1.m1.1.1.1.1.3.cmml" type="float" xref="A2.p2.1.m1.1.1.1.1.3">0.9</cn></apply><apply id="A2.p2.1.m1.2.2.2.2.cmml" xref="A2.p2.1.m1.2.2.2.2"><eq id="A2.p2.1.m1.2.2.2.2.1.cmml" xref="A2.p2.1.m1.2.2.2.2.1"></eq><apply id="A2.p2.1.m1.2.2.2.2.2.cmml" xref="A2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.p2.1.m1.2.2.2.2.2.1.cmml" xref="A2.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="A2.p2.1.m1.2.2.2.2.2.2.cmml" xref="A2.p2.1.m1.2.2.2.2.2.2">𝛽</ci><cn id="A2.p2.1.m1.2.2.2.2.2.3.cmml" type="integer" xref="A2.p2.1.m1.2.2.2.2.2.3">2</cn></apply><cn id="A2.p2.1.m1.2.2.2.2.3.cmml" type="float" xref="A2.p2.1.m1.2.2.2.2.3">0.999</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.2c">\beta_{1}=0.9,\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="A2.p2.1.m1.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.9 , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math> for optimization. We use a linear learning rate scheduler with a base learning rate of 1<math alttext="e" class="ltx_Math" display="inline" id="A2.p2.2.m2.1"><semantics id="A2.p2.2.m2.1a"><mi id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><ci id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">e</annotation><annotation encoding="application/x-llamapun" id="A2.p2.2.m2.1d">italic_e</annotation></semantics></math><math alttext="-" class="ltx_Math" display="inline" id="A2.p2.3.m3.1"><semantics id="A2.p2.3.m3.1a"><mo id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><minus id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">-</annotation><annotation encoding="application/x-llamapun" id="A2.p2.3.m3.1d">-</annotation></semantics></math>4 and a warmup of 100 steps. The weight decay is set to 0.05. For data augmentation, we use random horizontal flipping and the large-scale jittering (LSJ) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx12" title="">GCS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>21</a>]</cite> augmentation with a random scale sampled from range 0.1 to 2.0 followed by a fixed size crop to <math alttext="896\times 896" class="ltx_Math" display="inline" id="A2.p2.4.m4.1"><semantics id="A2.p2.4.m4.1a"><mrow id="A2.p2.4.m4.1.1" xref="A2.p2.4.m4.1.1.cmml"><mn id="A2.p2.4.m4.1.1.2" xref="A2.p2.4.m4.1.1.2.cmml">896</mn><mo id="A2.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="A2.p2.4.m4.1.1.1.cmml">×</mo><mn id="A2.p2.4.m4.1.1.3" xref="A2.p2.4.m4.1.1.3.cmml">896</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.4.m4.1b"><apply id="A2.p2.4.m4.1.1.cmml" xref="A2.p2.4.m4.1.1"><times id="A2.p2.4.m4.1.1.1.cmml" xref="A2.p2.4.m4.1.1.1"></times><cn id="A2.p2.4.m4.1.1.2.cmml" type="integer" xref="A2.p2.4.m4.1.1.2">896</cn><cn id="A2.p2.4.m4.1.1.3.cmml" type="integer" xref="A2.p2.4.m4.1.1.3">896</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.4.m4.1c">896\times 896</annotation><annotation encoding="application/x-llamapun" id="A2.p2.4.m4.1d">896 × 896</annotation></semantics></math>. Our model is trained for 5 days by using 8 NVIDIA V100 GPUs.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p3">
<p class="ltx_p" id="A2.p3.1"><span class="ltx_text ltx_font_bold" id="A2.p3.1.1">Evaluation.</span> The in-context examples are from the support samples for few-shot semantic segmentation, the training set for few-shot instance segmentation, and the first video frame for video object segmentation. The semantic prototypes can be seen as the classifier. The post-processing is similar to Mask2Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>, but we use the predictions of the ID queries for VOS and the predictions of instance queries for instance segmentation, respectively.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional Results</h2>
<section class="ltx_subsection" id="A3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Transfer Learning</h3>
<div class="ltx_para" id="A3.SS1.p1">
<p class="ltx_p" id="A3.SS1.p1.1">We investigate the performance of SINE when transferring to common segmentation tasks, such as ADE20K semantic segmentation and COCO panoptic segmentation. Unlike traditional pre-trained methods, <em class="ltx_emph ltx_font_italic" id="A3.SS1.p1.1.1">e.g.</em>, MAE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx17" title="">HCX<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>, require to fine-tune all model parameters to downstream tasks. We verify that our method can be efficiently transferred to these tasks via parameter efficient fine-tuning (PEFT) methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx36" title="">MGD<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>. Specifically, We deploy the popular PEFT method, LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx19" title="">HSW<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>21</a>]</cite>, on the frozen image encoder and fix the original parameters to test the transfer ability of SINE. We select rank 32 as the default setting
We learn semantic prototypes and LoRA parameters for transfer learning for specific segmentation tasks.</p>
</div>
<figure class="ltx_figure" id="A3.SS1.3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="A3.SS1.1.fig1" style="width:208.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="A3.SS1.1.fig1.1" style="width:173.0pt;height:144pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-21.6pt,18.0pt) scale(0.8,0.8) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.SS1.1.fig1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.1.1.1">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.SS1.1.fig1.1.1.1.1.2">mIoU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.SS1.1.fig1.1.1.2.1.1"><span class="ltx_text ltx_font_italic" id="A3.SS1.1.fig1.1.1.2.1.1.1" style="font-size:90%;">specialist model</span></th>
<td class="ltx_td ltx_border_t" id="A3.SS1.1.fig1.1.1.2.1.2"></td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.3.2.1">FCN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx32" title="">LSD15</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.3.2.2">29.4</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.4.3.1">RefineNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx30" title="">LMSR17</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.4.3.2">40.7</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.5.4.1">DPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx44" title="">RBK21</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.5.4.2">49.2</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.6.5.1">Mask2Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.6.5.2">57.7</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.SS1.1.fig1.1.1.7.6.1"><span class="ltx_text ltx_font_italic" id="A3.SS1.1.fig1.1.1.7.6.1.1" style="font-size:90%;">generalist model</span></th>
<td class="ltx_td ltx_border_t" id="A3.SS1.1.fig1.1.1.7.6.2"></td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.8.7.1">Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.8.7.2">49.9</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.9.8.1">SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.9.8.2">39.6</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.1.fig1.1.1.10.9" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.1.fig1.1.1.10.9.1"><span class="ltx_text" id="A3.SS1.1.fig1.1.1.10.9.1.1" style="background-color:#FFF2F2;">SINE</span></th>
<td class="ltx_td ltx_align_center" id="A3.SS1.1.fig1.1.1.10.9.2"><span class="ltx_text" id="A3.SS1.1.fig1.1.1.10.9.2.1" style="background-color:#FFF2F2;">54.1</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A3.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T6.2.1.1" style="font-size:90%;">Table 6</span>: </span><span class="ltx_text" id="A3.T6.3.2" style="font-size:90%;">Transfer performance on ADE20K semantic segmentation.</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A3.SS1.3.2" style="width:208.1pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" id="A3.SS1.3.2.2" style="width:229.4pt;height:144pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-28.7pt,18.0pt) scale(0.8,0.8) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A3.SS1.3.2.2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.2.3">Methods</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.2.4">PQ</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.2.1.1.1.1.1">PQ<sup class="ltx_sup" id="A3.SS1.2.1.1.1.1.1.1"><span class="ltx_text ltx_font_italic" id="A3.SS1.2.1.1.1.1.1.1.1">Th</span></sup>
</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.2.2">PQ<sup class="ltx_sup" id="A3.SS1.3.2.2.2.2.2.1"><span class="ltx_text ltx_font_italic" id="A3.SS1.3.2.2.2.2.2.1.1">St</span></sup>
</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.SS1.3.2.2.2.3.1.1"><span class="ltx_text ltx_font_italic" id="A3.SS1.3.2.2.2.3.1.1.1" style="font-size:90%;">specialist model</span></th>
<td class="ltx_td ltx_border_t" id="A3.SS1.3.2.2.2.3.1.2"></td>
<td class="ltx_td ltx_border_t" id="A3.SS1.3.2.2.2.3.1.3"></td>
<td class="ltx_td ltx_border_t" id="A3.SS1.3.2.2.2.3.1.4"></td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.4.2.1">PanopticFPN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx22" title="">KGHD19</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.4.2.2">40.8</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.4.2.3">48.3</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.4.2.4">29.4</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.5.3.1">SOLOv2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx51" title="">WZK<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>20</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.5.3.2">42.1</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.5.3.3">49.6</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.5.3.4">30.7</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.6.4.1">Mask2Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.6.4.2">57.8</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.6.4.3">64.2</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.6.4.4">48.1</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.7.5.1">UViM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx25" title="">KSPB<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.7.5.2">45.8</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.7.5.3">-</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.7.5.4">-</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.SS1.3.2.2.2.8.6.1"><span class="ltx_text ltx_font_italic" id="A3.SS1.3.2.2.2.8.6.1.1" style="font-size:90%;">generalist model</span></th>
<td class="ltx_td ltx_border_t" id="A3.SS1.3.2.2.2.8.6.2"></td>
<td class="ltx_td ltx_border_t" id="A3.SS1.3.2.2.2.8.6.3"></td>
<td class="ltx_td ltx_border_t" id="A3.SS1.3.2.2.2.8.6.4"></td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.9.7.1">Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx49" title="">WWC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.9.7.2">43.4</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.9.7.3">-</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.9.7.4">-</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.10.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.10.8.1">SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.10.8.2">34.4</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.10.8.3">-</td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.10.8.4">-</td>
</tr>
<tr class="ltx_tr" id="A3.SS1.3.2.2.2.11.9" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.SS1.3.2.2.2.11.9.1"><span class="ltx_text" id="A3.SS1.3.2.2.2.11.9.1.1" style="background-color:#FFF2F2;">SINE</span></th>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.11.9.2"><span class="ltx_text" id="A3.SS1.3.2.2.2.11.9.2.1" style="background-color:#FFF2F2;">51.0</span></td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.11.9.3"><span class="ltx_text" id="A3.SS1.3.2.2.2.11.9.3.1" style="background-color:#FFF2F2;">57.8</span></td>
<td class="ltx_td ltx_align_center" id="A3.SS1.3.2.2.2.11.9.4"><span class="ltx_text" id="A3.SS1.3.2.2.2.11.9.4.1" style="background-color:#FFF2F2;">40.8</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="A3.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T7.2.1.1" style="font-size:90%;">Table 7</span>: </span><span class="ltx_text" id="A3.T7.3.2" style="font-size:90%;">Transfer performance on COCO panoptic segmentation.</span></figcaption>
</figure>
</div>
</div>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="A3.SS1.p2">
<p class="ltx_p" id="A3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A3.SS1.p2.1.1">Semantic Segmentation</span> 
According to Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.T6" title="Table 6 ‣ C.1 Transfer Learning ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">6</span></a>, our method SINE achieves 54.1% mIoU on the ADE20K semantic segmentation benchmark, outperforming other in-context segmentation models like SegGPT which trains a dataset-specific prompt using related dataset annotations. In addition, with only a few trainable parameters, our method achieves better or comparable performance to specialist segmentation models. It is worth noting that, unlike Mask2Former <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx5" title="">CMS<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>22</a>]</cite>, SINE does not use multi-scale features for better performance.</p>
</div>
<div class="ltx_para" id="A3.SS1.p3">
<p class="ltx_p" id="A3.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="A3.SS1.p3.1.1">Panoptic Segmentation</span> 
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.T7" title="Table 7 ‣ C.1 Transfer Learning ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">7</span></a> shows that SINE also significantly outperforms other generalist segmentation models on the COCO panoptic segmentation task, demonstrating that the proposed method can enable the learned Transformer decoder to apply to more complicated panoptic segmentation effectively.
By fixing the overall model parameters and adding only a few of LoRA parameters, SINE achieves competitive performance with the best specialist segmentation model, Mask2Former.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Comparison of SINE and SegGPT without Objects365.</h3>
<div class="ltx_para" id="A3.SS2.p1">
<p class="ltx_p" id="A3.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.T8" title="Table 8 ‣ C.2 Comparison of SINE and SegGPT without Objects365. ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">8</span></a> compares the one-shot semantic segmentation results of training SINE using only ADE20K and COCO with SegGPT. SINE outperforms SegGPT on three benchmarks. Notably, SINE achieves 10% higher mIoU than SegGPT on LVIS-92i, indicating stronger class generalization capability in real-world image segmentation compared to SegGPT.</p>
</div>
<figure class="ltx_table" id="A3.T8">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T8.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T8.3.3.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row" id="A3.T8.3.3.3.4"><span class="ltx_text" id="A3.T8.3.3.3.4.1" style="font-size:90%;">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T8.1.1.1.1">
<span class="ltx_text" id="A3.T8.1.1.1.1.1" style="font-size:90%;">COCO-20</span><sup class="ltx_sup" id="A3.T8.1.1.1.1.2"><span class="ltx_text ltx_font_italic" id="A3.T8.1.1.1.1.2.1" style="font-size:90%;">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T8.2.2.2.2">
<span class="ltx_text" id="A3.T8.2.2.2.2.1" style="font-size:90%;">PASCAL-5</span><sup class="ltx_sup" id="A3.T8.2.2.2.2.2"><span class="ltx_text ltx_font_italic" id="A3.T8.2.2.2.2.2.1" style="font-size:90%;">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T8.3.3.3.3">
<span class="ltx_text" id="A3.T8.3.3.3.3.1" style="font-size:90%;">LVIS-92</span><sup class="ltx_sup" id="A3.T8.3.3.3.3.2"><span class="ltx_text ltx_font_italic" id="A3.T8.3.3.3.3.2.1" style="font-size:90%;">i</span></sup>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T8.3.3.4.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" id="A3.T8.3.3.4.1.1"><span class="ltx_text" id="A3.T8.3.3.4.1.1.1" style="font-size:90%;">SegGPT</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.3.3.4.1.2"><span class="ltx_text" id="A3.T8.3.3.4.1.2.1" style="font-size:90%;">56.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.3.3.4.1.3"><span class="ltx_text" id="A3.T8.3.3.4.1.3.1" style="font-size:90%;">83.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T8.3.3.4.1.4"><span class="ltx_text" id="A3.T8.3.3.4.1.4.1" style="font-size:90%;">18.6</span></td>
</tr>
<tr class="ltx_tr" id="A3.T8.3.3.5.2" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="A3.T8.3.3.5.2.1"><span class="ltx_text" id="A3.T8.3.3.5.2.1.1" style="font-size:90%;background-color:#FFF2F2;">SINE</span></th>
<td class="ltx_td ltx_align_center" id="A3.T8.3.3.5.2.2"><span class="ltx_text" id="A3.T8.3.3.5.2.2.1" style="font-size:90%;background-color:#FFF2F2;">67.1</span></td>
<td class="ltx_td ltx_align_center" id="A3.T8.3.3.5.2.3"><span class="ltx_text" id="A3.T8.3.3.5.2.3.1" style="font-size:90%;background-color:#FFF2F2;">86.3</span></td>
<td class="ltx_td ltx_align_center" id="A3.T8.3.3.5.2.4"><span class="ltx_text" id="A3.T8.3.3.5.2.4.1" style="font-size:90%;background-color:#FFF2F2;">28.8</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T8.5.1.1" style="font-size:90%;">Table 8</span>: </span><span class="ltx_text" id="A3.T8.6.2" style="font-size:90%;">Comparison of SINE and SegGPT without Objects365.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Impact of Different Backbones.</h3>
<div class="ltx_para" id="A3.SS3.p1">
<p class="ltx_p" id="A3.SS3.p1.1">We select DINOv2-S, DINOv2-B, DINOv2-L, and CLIP-L to explore the impact of different backbones. The conclusions are as follows: 1) DINOv2 is better than CLIP. DINOv2 achieves better performance than CLIP because it has general matching capabilities at both image and patch levels, allowing it to better understand complex contextual information between images. In contrast, CLIP captures image-text similarity, making it difficult to capture relationships between images, leading to poorer performance. 2) Larger DINOv2 model performs better: Larger DINOv2 models have stronger representation capabilities, making it easier to capture contextual relationships, thus improving performance. This also indicates that SINE is scalable with the enhanced capabilities of the encoder.</p>
</div>
<figure class="ltx_table" id="A3.T9">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T9.3.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T9.3.3.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r" id="A3.T9.3.3.3.4"><span class="ltx_text" id="A3.T9.3.3.3.4.1" style="font-size:90%;">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="A3.T9.3.3.3.5"><span class="ltx_text" id="A3.T9.3.3.3.5.1" style="font-size:90%;">Backbone</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T9.1.1.1.1">
<span class="ltx_text" id="A3.T9.1.1.1.1.1" style="font-size:90%;">COCO-20</span><sup class="ltx_sup" id="A3.T9.1.1.1.1.2"><span class="ltx_text ltx_font_italic" id="A3.T9.1.1.1.1.2.1" style="font-size:90%;">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T9.2.2.2.2">
<span class="ltx_text" id="A3.T9.2.2.2.2.1" style="font-size:90%;">PASCAL-5</span><sup class="ltx_sup" id="A3.T9.2.2.2.2.2"><span class="ltx_text ltx_font_italic" id="A3.T9.2.2.2.2.2.1" style="font-size:90%;">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T9.3.3.3.3">
<span class="ltx_text" id="A3.T9.3.3.3.3.1" style="font-size:90%;">LVIS-92</span><sup class="ltx_sup" id="A3.T9.3.3.3.3.2"><span class="ltx_text ltx_font_italic" id="A3.T9.3.3.3.3.2.1" style="font-size:90%;">i</span></sup>
</th>
</tr>
<tr class="ltx_tr" id="A3.T9.3.3.4.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A3.T9.3.3.4.1.1"><span class="ltx_text" id="A3.T9.3.3.4.1.1.1" style="font-size:90%;">SegGPT</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A3.T9.3.3.4.1.2"><span class="ltx_text" id="A3.T9.3.3.4.1.2.1" style="font-size:90%;">-</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T9.3.3.4.1.3"><span class="ltx_text" id="A3.T9.3.3.4.1.3.1" style="font-size:90%;">56.1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T9.3.3.4.1.4"><span class="ltx_text" id="A3.T9.3.3.4.1.4.1" style="font-size:90%;">83.2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A3.T9.3.3.4.1.5"><span class="ltx_text" id="A3.T9.3.3.4.1.5.1" style="font-size:90%;">18.6</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T9.3.3.5.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T9.3.3.5.1.1" rowspan="4"><span class="ltx_text" id="A3.T9.3.3.5.1.1.1" style="font-size:90%;">SINE</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T9.3.3.5.1.2"><span class="ltx_text" id="A3.T9.3.3.5.1.2.1" style="font-size:90%;">DINOv2-S</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.3.3.5.1.3"><span class="ltx_text" id="A3.T9.3.3.5.1.3.1" style="font-size:90%;">56.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.3.3.5.1.4"><span class="ltx_text" id="A3.T9.3.3.5.1.4.1" style="font-size:90%;">81.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T9.3.3.5.1.5"><span class="ltx_text" id="A3.T9.3.3.5.1.5.1" style="font-size:90%;">26.7</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.3.3.6.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A3.T9.3.3.6.2.1"><span class="ltx_text" id="A3.T9.3.3.6.2.1.1" style="font-size:90%;">DINOv2-B</span></th>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.6.2.2"><span class="ltx_text" id="A3.T9.3.3.6.2.2.1" style="font-size:90%;">61.7</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.6.2.3"><span class="ltx_text" id="A3.T9.3.3.6.2.3.1" style="font-size:90%;">84.1</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.6.2.4"><span class="ltx_text" id="A3.T9.3.3.6.2.4.1" style="font-size:90%;">29.5</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.3.3.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A3.T9.3.3.7.3.1"><span class="ltx_text" id="A3.T9.3.3.7.3.1.1" style="font-size:90%;">DINOv2-L</span></th>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.7.3.2"><span class="ltx_text" id="A3.T9.3.3.7.3.2.1" style="font-size:90%;">64.5</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.7.3.3"><span class="ltx_text" id="A3.T9.3.3.7.3.3.1" style="font-size:90%;">85.4</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.7.3.4"><span class="ltx_text" id="A3.T9.3.3.7.3.4.1" style="font-size:90%;">31.2</span></td>
</tr>
<tr class="ltx_tr" id="A3.T9.3.3.8.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A3.T9.3.3.8.4.1"><span class="ltx_text" id="A3.T9.3.3.8.4.1.1" style="font-size:90%;">CLIP-L</span></th>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.8.4.2"><span class="ltx_text" id="A3.T9.3.3.8.4.2.1" style="font-size:90%;">34.8</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.8.4.3"><span class="ltx_text" id="A3.T9.3.3.8.4.3.1" style="font-size:90%;">57.3</span></td>
<td class="ltx_td ltx_align_center" id="A3.T9.3.3.8.4.4"><span class="ltx_text" id="A3.T9.3.3.8.4.4.1" style="font-size:90%;">16.1</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T9.5.1.1" style="font-size:90%;">Table 9</span>: </span><span class="ltx_text" id="A3.T9.6.2" style="font-size:90%;">Impact of Different Backbones.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Generalization of SINE on One-shot Part Segmentation.</h3>
<div class="ltx_para" id="A3.SS4.p1">
<p class="ltx_p" id="A3.SS4.p1.1">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F5" title="Figure 5 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">5</span></a>, SINE can perform part segmentation like SegGPT when including PACO as training data.
We evaluate SINE for one-shot part segmentation on PASCAL-Part <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx35" title="">MAV20</a>]</cite> following Matcher <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx34" title="">LZL<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite> for the data pre-processing and evaluation. Compared with SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#bib.bibx50" title="">WZC<sup class="ltx_sup"><span class="ltx_text ltx_font_italic">+</span></sup>23</a>]</cite>, SINE achieves competitive performance.</p>
</div>
<figure class="ltx_table" id="A3.T10">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T10.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T10.2.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row" id="A3.T10.2.1.1.1"><span class="ltx_text" id="A3.T10.2.1.1.1.1" style="font-size:90%;">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T10.2.1.1.2"><span class="ltx_text" id="A3.T10.2.1.1.2.1" style="font-size:90%;">animals</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T10.2.1.1.3"><span class="ltx_text" id="A3.T10.2.1.1.3.1" style="font-size:90%;">indoor</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T10.2.1.1.4"><span class="ltx_text" id="A3.T10.2.1.1.4.1" style="font-size:90%;">person</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T10.2.1.1.5"><span class="ltx_text" id="A3.T10.2.1.1.5.1" style="font-size:90%;">vehicles</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="A3.T10.2.1.1.6"><span class="ltx_text" id="A3.T10.2.1.1.6.1" style="font-size:90%;">mean</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T10.2.2.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" id="A3.T10.2.2.1.1"><span class="ltx_text" id="A3.T10.2.2.1.1.1" style="font-size:90%;">SegGPT</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.2.2.1.2"><span class="ltx_text" id="A3.T10.2.2.1.2.1" style="font-size:90%;">22.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.2.2.1.3"><span class="ltx_text" id="A3.T10.2.2.1.3.1" style="font-size:90%;">50.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.2.2.1.4"><span class="ltx_text" id="A3.T10.2.2.1.4.1" style="font-size:90%;">31.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.2.2.1.5"><span class="ltx_text" id="A3.T10.2.2.1.5.1" style="font-size:90%;">38.0</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T10.2.2.1.6"><span class="ltx_text" id="A3.T10.2.2.1.6.1" style="font-size:90%;">35.8</span></td>
</tr>
<tr class="ltx_tr" id="A3.T10.2.3.2" style="background-color:#FFF2F2;">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="A3.T10.2.3.2.1"><span class="ltx_text" id="A3.T10.2.3.2.1.1" style="font-size:90%;background-color:#FFF2F2;">SINE</span></th>
<td class="ltx_td ltx_align_center" id="A3.T10.2.3.2.2"><span class="ltx_text" id="A3.T10.2.3.2.2.1" style="font-size:90%;background-color:#FFF2F2;">22.7</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.2.3.2.3"><span class="ltx_text" id="A3.T10.2.3.2.3.1" style="font-size:90%;background-color:#FFF2F2;">61.8</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.2.3.2.4"><span class="ltx_text" id="A3.T10.2.3.2.4.1" style="font-size:90%;background-color:#FFF2F2;">21.7</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.2.3.2.5"><span class="ltx_text" id="A3.T10.2.3.2.5.1" style="font-size:90%;background-color:#FFF2F2;">38.5</span></td>
<td class="ltx_td ltx_align_center" id="A3.T10.2.3.2.6"><span class="ltx_text" id="A3.T10.2.3.2.6.1" style="font-size:90%;background-color:#FFF2F2;">36.2</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A3.T10.3.1.1" style="font-size:90%;">Table 10</span>: </span><span class="ltx_text" id="A3.T10.4.2" style="font-size:90%;">Results of one-shot part segmentation on PASCAL-Part.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.5 </span>Generalizability of SINE beyond Semantically Similar Objects.</h3>
<div class="ltx_para" id="A3.SS5.p1">
<p class="ltx_p" id="A3.SS5.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F6" title="Figure 6 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">6</span></a> shows SINE’s capability in handling complex interaction relationships. In Fig. 1(a), the reference consists of multiple images, each containing different objects (box, cup, keyboard, mouse). When using these as in-context examples, SINE can segment one or more semantically different objects on a desk. In Fig. 1(b), with a reference containing only one object, the in-context example cannot represent complex interactions, and thus no segmentation result is provided. In Fig. 1(c), replacing multiple single-object images with a single image containing multiple objects yields the same effective results.</p>
</div>
</section>
<section class="ltx_subsection" id="A3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.6 </span>Visualizations</h3>
<div class="ltx_para" id="A3.SS6.p1">
<p class="ltx_p" id="A3.SS6.p1.1">Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F7" title="Figure 7 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">7</span></a> shows further visual comparisons. For video tasks, SINE reduces tracking failures from intersections, viewpoint changes, and occlusions. SINE addresses task ambiguity, preventing errors in semantic segmentation where SegGPT fails, as shown in the second set of comparison results in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F7" title="Figure 7 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">7</span></a>(a). In real-world image segmentation, SINE exhibits better class generalization than SegGPT, matching the LVIS-92i comparison in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F8" title="Figure 8 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">8</span></a>. We provide more visualizations for example-based semantic segmentation in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F8" title="Figure 8 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">8</span></a>, example-based instance segmentation in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F9" title="Figure 9 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">9</span></a>, video object segmentation in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F10" title="Figure 10 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">10</span></a>, semantic segmentation on ADE20K, and panoptic segmentation on COCO in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.04842v2#A3.F11" title="Figure 11 ‣ C.6 Visualizations ‣ Appendix C Additional Results ‣ A Simple Image Segmentation Framework via In-Context Examples"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<figure class="ltx_figure" id="A3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="311" id="A3.F5.g1" src="x5.png" width="689"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F5.3.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="A3.F5.4.2" style="font-size:80%;">Visualization of part segmentation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="394" id="A3.F6.g1" src="x6.png" width="689"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F6.3.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A3.F6.4.2" style="font-size:80%;">Generalizability of SINE beyond semantically similar objects. (a) and (c) SINE can recognize and segment another object when given successive images (or one image) including different objects. (b) SINE cannot output masks when given one reference image with a different object. </span></figcaption>
</figure>
<figure class="ltx_figure" id="A3.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="370" id="A3.F7.g1" src="x7.png" width="689"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F7.3.1.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="A3.F7.4.2" style="font-size:80%;">Visualization comparisons between SINE and SegGPT on video and image tasks. For video task, SINE can effectively alleviate the tracking failure issues caused by crossing, perspective changes, occlusion, etc. In real-world image segmentation, SINE has a stronger category generalization capability compared to SegGPT.
</span></figcaption>
</figure>
<figure class="ltx_figure" id="A3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="532" id="A3.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F8.2.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="A3.F8.3.2" style="font-size:90%;">Visualization of example-based semantic segmentation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="483" id="A3.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F9.2.1.1" style="font-size:90%;">Figure 9</span>: </span><span class="ltx_text" id="A3.F9.3.2" style="font-size:90%;">Visualization of example-based instance segmentation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="489" id="A3.F10.g1" src="x10.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F10.2.1.1" style="font-size:90%;">Figure 10</span>: </span><span class="ltx_text" id="A3.F10.3.2" style="font-size:90%;">Visualization of video object segmentation.</span></figcaption>
</figure>
<figure class="ltx_figure" id="A3.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="642" id="A3.F11.g1" src="x11.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A3.F11.2.1.1" style="font-size:90%;">Figure 11</span>: </span><span class="ltx_text" id="A3.F11.3.2" style="font-size:90%;">Visualization of semantic segmentation on ADE20K, and panoptic segmentation on COCO.</span></figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  8 12:38:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
