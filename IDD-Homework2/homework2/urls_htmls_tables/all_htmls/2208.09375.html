<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2208.09375] Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation</title><meta property="og:description" content="Federated recommendation applies federated learning techniques in recommendation systems to help protect user privacy by exchanging models instead of raw user data between user devices and the central server. Due to th…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2208.09375">

<!--Generated on Wed Mar 13 16:56:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Federated learning; Recommender system; Personalization">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document"> Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sichun Luo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_department">Department of Computer Science</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_institution">City University of Hong Kong</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_city">Hong Kong</span><span id="id4.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id5.5.id1" class="ltx_text ltx_affiliation_institution">City University of Hong Kong Shenzhen Research Institute</span><span id="id6.6.id2" class="ltx_text ltx_affiliation_city">Shenzhen</span><span id="id7.7.id3" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:sichun.luo@my.cityu.edu.hk">sichun.luo@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuanzhang Xiao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id8.1.id1" class="ltx_text ltx_affiliation_department">Hawaii Advanced Wireless Technologies Institute</span><span id="id9.2.id2" class="ltx_text ltx_affiliation_institution">University of Hawaii at Manoa</span><span id="id10.3.id3" class="ltx_text ltx_affiliation_city">Honolulu</span><span id="id11.4.id4" class="ltx_text ltx_affiliation_state">HI</span><span id="id12.5.id5" class="ltx_text ltx_affiliation_country">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yxiao8@hawaii.edu">yxiao8@hawaii.edu</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Linqi Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id13.1.id1" class="ltx_text ltx_affiliation_department">Department of Computer Science</span><span id="id14.2.id2" class="ltx_text ltx_affiliation_institution">City University of Hong Kong</span><span id="id15.3.id3" class="ltx_text ltx_affiliation_city">Hong Kong</span><span id="id16.4.id4" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id17.5.id1" class="ltx_text ltx_affiliation_institution">City University of Hong Kong Shenzhen Research Institute</span><span id="id18.6.id2" class="ltx_text ltx_affiliation_city">Shenzhen</span><span id="id19.7.id3" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:linqi.song@cityu.edu.hk">linqi.song@cityu.edu.hk</a>
</span></span></span>
</div>
<div class="ltx_dates">(2022)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id20.id1" class="ltx_p">Federated recommendation applies federated learning techniques in recommendation systems to help protect user privacy by exchanging models instead of raw user data between user devices and the central server. Due to the heterogeneity in user’s attributes and local data, attaining personalized models is critical to help improve the federated recommendation performance. In this paper, we propose a Graph Neural Network based Personalized Federated Recommendation (PerFedRec) framework via joint representation learning, user clustering, and model adaptation. Specifically, we construct a collaborative graph and incorporate attribute information to jointly learn the representation through a federated GNN. Based on these learned representations, we cluster users into different user groups and learn personalized models for each cluster. Then each user learns a personalized model by combining the global federated model, the cluster-level federated model, and the user’s fine-tuned local model. To alleviate the heavy communication burden, we intelligently select a few representative users (instead of randomly picked users) from each cluster to participate in training. Experiments on real-world datasets show that our proposed method achieves superior performance over existing methods.</p>
</div>
<div class="ltx_keywords">Federated learning; Recommender system; Personalization
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2022</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 31st ACM International Conference on Information and Knowledge Management; October 17–21, 2022; Atlanta, GA, USA.</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 31st ACM International Conference on Information and Knowledge Management (CIKM ’22), October 17–21, 2022, Atlanta, GA, USA</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-9236-5/22/10</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3511808.3557668</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated recommendation aims to help users filter out useful information while keeping users’ personal data private. Following the principles in federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2017</a>)</cite>, federated recommendation exchanges recommendation models, instead of raw data, between user devices and the central server. This new distributed learning paradigm has found applications in content recommendations <cite class="ltx_cite ltx_citemacro_citep">(Tan et al<span class="ltx_text">.</span>, <a href="#bib.bib16" title="" class="ltx_ref">2020</a>; Ali et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>, mobile crowdsourcing task recommendations <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2020</a>; Guo et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, and autonomous driving strategy recommendations <cite class="ltx_cite ltx_citemacro_citep">(Savazzi et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Several classic recommendation algorithms have been extended to the federated setting, such as federated collaborative filtering <cite class="ltx_cite ltx_citemacro_citep">(Ammad-Ud-Din et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2019</a>; Minto et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, federated matrix factorization <cite class="ltx_cite ltx_citemacro_citep">(Chai et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2021</a>; Du et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite>, and federated graph neural networks (GNN) <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>. However, these works have two drawbacks. First, they use the <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">same</span> aggregated recommendation model for all the users, ignoring the heterogeneity of the users (e.g., non-IID data distribution, different levels of computing resources). Second, they require model exchanges between the server and <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">all</span> the users for federated learning, incurring high communication costs.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address the above issues, we propose a graph neural network based <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">Per</span>sonalized <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">Fed</span>erated <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">Rec</span>ommendation (PerFedRec) framework. PerFedRec learns user representations from user/item attributes and collaborative information (i.e., user-item interaction) via a GNN, and group similar users into clusters based on user representation. Then each cluster attains a cluster-level federated recommendation model, and the server attains a global model. Finally, each user combines its local model, the cluster-level model, and the global model to obtain a personalized model. Importantly, the representation learning, user clustering, and model adaptation are done jointly instead of independently.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In addition to personalization, our proposed PerFedRec framework alleviates the heavy communication burden by judiciously picking a few representative clients in each cluster in the training of the global model. This “user dropout” could save communication costs in critical scenarios, such as (autonomous) driving strategy recommendations where wireless bandwidth is limited and long time delay is prohibitive.
To sum up, our contribution is threefold.
</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p"><math id="S1.p5.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S1.p5.1.m1.1a"><mo id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">\bullet</annotation></semantics></math> We propose a joint representation learning, user clustering, and model adaptation framework in federated recommendation to achieve personalized recommendation, which adapts to the heterogeneity of users’ local data and resources. We show that representations, learned by a GNN from users’ collaborative and attribute information, are helpful to cluster similar users and learn personalized models.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p"><math id="S1.p6.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S1.p6.1.m1.1a"><mo id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\bullet</annotation></semantics></math> We carefully pick a few representative users from each cluster to participate in training. This approach reduces communication costs, and is especially suitable for applications with limited bandwidth and low latency requirement.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p"><math id="S1.p7.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S1.p7.1.m1.1a"><mo id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><ci id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">\bullet</annotation></semantics></math> Our proposed approach improves the performance of state-of-the-art baselines on several real-world datasets.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2208.09375/assets/images/system3.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="329" height="269" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Illustration of the proposed personalized federated recommendation framework.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Problem Formulation</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.8" class="ltx_p">We consider a federated recommendation system consisting of a central server and <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation></semantics></math> distributed users, each with a <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="d_{ua}" display="inline"><semantics id="S2.p1.2.m2.1a"><msub id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">d</mi><mrow id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml"><mi id="S2.p1.2.m2.1.1.3.2" xref="S2.p1.2.m2.1.1.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.p1.2.m2.1.1.3.1" xref="S2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.p1.2.m2.1.1.3.3" xref="S2.p1.2.m2.1.1.3.3.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">𝑑</ci><apply id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3"><times id="S2.p1.2.m2.1.1.3.1.cmml" xref="S2.p1.2.m2.1.1.3.1"></times><ci id="S2.p1.2.m2.1.1.3.2.cmml" xref="S2.p1.2.m2.1.1.3.2">𝑢</ci><ci id="S2.p1.2.m2.1.1.3.3.cmml" xref="S2.p1.2.m2.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">d_{ua}</annotation></semantics></math>-dimensional attribute <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="u_{n}\in\mathbb{R}^{d_{ua}}" display="inline"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><msub id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml"><mi id="S2.p1.3.m3.1.1.2.2" xref="S2.p1.3.m3.1.1.2.2.cmml">u</mi><mi id="S2.p1.3.m3.1.1.2.3" xref="S2.p1.3.m3.1.1.2.3.cmml">n</mi></msub><mo id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml"><mi id="S2.p1.3.m3.1.1.3.2" xref="S2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><msub id="S2.p1.3.m3.1.1.3.3" xref="S2.p1.3.m3.1.1.3.3.cmml"><mi id="S2.p1.3.m3.1.1.3.3.2" xref="S2.p1.3.m3.1.1.3.3.2.cmml">d</mi><mrow id="S2.p1.3.m3.1.1.3.3.3" xref="S2.p1.3.m3.1.1.3.3.3.cmml"><mi id="S2.p1.3.m3.1.1.3.3.3.2" xref="S2.p1.3.m3.1.1.3.3.3.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="S2.p1.3.m3.1.1.3.3.3.1" xref="S2.p1.3.m3.1.1.3.3.3.1.cmml">​</mo><mi id="S2.p1.3.m3.1.1.3.3.3.3" xref="S2.p1.3.m3.1.1.3.3.3.3.cmml">a</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><in id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"></in><apply id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.2.1.cmml" xref="S2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S2.p1.3.m3.1.1.2.2.cmml" xref="S2.p1.3.m3.1.1.2.2">𝑢</ci><ci id="S2.p1.3.m3.1.1.2.3.cmml" xref="S2.p1.3.m3.1.1.2.3">𝑛</ci></apply><apply id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.3.1.cmml" xref="S2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S2.p1.3.m3.1.1.3.2.cmml" xref="S2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S2.p1.3.m3.1.1.3.3.cmml" xref="S2.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.3.3.1.cmml" xref="S2.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S2.p1.3.m3.1.1.3.3.2.cmml" xref="S2.p1.3.m3.1.1.3.3.2">𝑑</ci><apply id="S2.p1.3.m3.1.1.3.3.3.cmml" xref="S2.p1.3.m3.1.1.3.3.3"><times id="S2.p1.3.m3.1.1.3.3.3.1.cmml" xref="S2.p1.3.m3.1.1.3.3.3.1"></times><ci id="S2.p1.3.m3.1.1.3.3.3.2.cmml" xref="S2.p1.3.m3.1.1.3.3.3.2">𝑢</ci><ci id="S2.p1.3.m3.1.1.3.3.3.3.cmml" xref="S2.p1.3.m3.1.1.3.3.3.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">u_{n}\in\mathbb{R}^{d_{ua}}</annotation></semantics></math>, <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="\forall n\in[N]" display="inline"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.2" xref="S2.p1.4.m4.1.2.cmml"><mrow id="S2.p1.4.m4.1.2.2" xref="S2.p1.4.m4.1.2.2.cmml"><mo rspace="0.167em" id="S2.p1.4.m4.1.2.2.1" xref="S2.p1.4.m4.1.2.2.1.cmml">∀</mo><mi id="S2.p1.4.m4.1.2.2.2" xref="S2.p1.4.m4.1.2.2.2.cmml">n</mi></mrow><mo id="S2.p1.4.m4.1.2.1" xref="S2.p1.4.m4.1.2.1.cmml">∈</mo><mrow id="S2.p1.4.m4.1.2.3.2" xref="S2.p1.4.m4.1.2.3.1.cmml"><mo stretchy="false" id="S2.p1.4.m4.1.2.3.2.1" xref="S2.p1.4.m4.1.2.3.1.1.cmml">[</mo><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">N</mi><mo stretchy="false" id="S2.p1.4.m4.1.2.3.2.2" xref="S2.p1.4.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.2.cmml" xref="S2.p1.4.m4.1.2"><in id="S2.p1.4.m4.1.2.1.cmml" xref="S2.p1.4.m4.1.2.1"></in><apply id="S2.p1.4.m4.1.2.2.cmml" xref="S2.p1.4.m4.1.2.2"><csymbol cd="latexml" id="S2.p1.4.m4.1.2.2.1.cmml" xref="S2.p1.4.m4.1.2.2.1">for-all</csymbol><ci id="S2.p1.4.m4.1.2.2.2.cmml" xref="S2.p1.4.m4.1.2.2.2">𝑛</ci></apply><apply id="S2.p1.4.m4.1.2.3.1.cmml" xref="S2.p1.4.m4.1.2.3.2"><csymbol cd="latexml" id="S2.p1.4.m4.1.2.3.1.1.cmml" xref="S2.p1.4.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\forall n\in[N]</annotation></semantics></math>. There are <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">M</annotation></semantics></math> items, each with a <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="d_{ia}" display="inline"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">d</mi><mrow id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml"><mi id="S2.p1.6.m6.1.1.3.2" xref="S2.p1.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p1.6.m6.1.1.3.1" xref="S2.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S2.p1.6.m6.1.1.3.3" xref="S2.p1.6.m6.1.1.3.3.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑑</ci><apply id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3"><times id="S2.p1.6.m6.1.1.3.1.cmml" xref="S2.p1.6.m6.1.1.3.1"></times><ci id="S2.p1.6.m6.1.1.3.2.cmml" xref="S2.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S2.p1.6.m6.1.1.3.3.cmml" xref="S2.p1.6.m6.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">d_{ia}</annotation></semantics></math>-dimensional attribute <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="v_{m}\in\mathbb{R}^{d_{ia}}" display="inline"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><msub id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml"><mi id="S2.p1.7.m7.1.1.2.2" xref="S2.p1.7.m7.1.1.2.2.cmml">v</mi><mi id="S2.p1.7.m7.1.1.2.3" xref="S2.p1.7.m7.1.1.2.3.cmml">m</mi></msub><mo id="S2.p1.7.m7.1.1.1" xref="S2.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml"><mi id="S2.p1.7.m7.1.1.3.2" xref="S2.p1.7.m7.1.1.3.2.cmml">ℝ</mi><msub id="S2.p1.7.m7.1.1.3.3" xref="S2.p1.7.m7.1.1.3.3.cmml"><mi id="S2.p1.7.m7.1.1.3.3.2" xref="S2.p1.7.m7.1.1.3.3.2.cmml">d</mi><mrow id="S2.p1.7.m7.1.1.3.3.3" xref="S2.p1.7.m7.1.1.3.3.3.cmml"><mi id="S2.p1.7.m7.1.1.3.3.3.2" xref="S2.p1.7.m7.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.p1.7.m7.1.1.3.3.3.1" xref="S2.p1.7.m7.1.1.3.3.3.1.cmml">​</mo><mi id="S2.p1.7.m7.1.1.3.3.3.3" xref="S2.p1.7.m7.1.1.3.3.3.3.cmml">a</mi></mrow></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><in id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1.1"></in><apply id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.2.1.cmml" xref="S2.p1.7.m7.1.1.2">subscript</csymbol><ci id="S2.p1.7.m7.1.1.2.2.cmml" xref="S2.p1.7.m7.1.1.2.2">𝑣</ci><ci id="S2.p1.7.m7.1.1.2.3.cmml" xref="S2.p1.7.m7.1.1.2.3">𝑚</ci></apply><apply id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.3.1.cmml" xref="S2.p1.7.m7.1.1.3">superscript</csymbol><ci id="S2.p1.7.m7.1.1.3.2.cmml" xref="S2.p1.7.m7.1.1.3.2">ℝ</ci><apply id="S2.p1.7.m7.1.1.3.3.cmml" xref="S2.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.3.3.1.cmml" xref="S2.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="S2.p1.7.m7.1.1.3.3.2.cmml" xref="S2.p1.7.m7.1.1.3.3.2">𝑑</ci><apply id="S2.p1.7.m7.1.1.3.3.3.cmml" xref="S2.p1.7.m7.1.1.3.3.3"><times id="S2.p1.7.m7.1.1.3.3.3.1.cmml" xref="S2.p1.7.m7.1.1.3.3.3.1"></times><ci id="S2.p1.7.m7.1.1.3.3.3.2.cmml" xref="S2.p1.7.m7.1.1.3.3.3.2">𝑖</ci><ci id="S2.p1.7.m7.1.1.3.3.3.3.cmml" xref="S2.p1.7.m7.1.1.3.3.3.3">𝑎</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">v_{m}\in\mathbb{R}^{d_{ia}}</annotation></semantics></math>, <math id="S2.p1.8.m8.1" class="ltx_Math" alttext="\forall m\in[M]" display="inline"><semantics id="S2.p1.8.m8.1a"><mrow id="S2.p1.8.m8.1.2" xref="S2.p1.8.m8.1.2.cmml"><mrow id="S2.p1.8.m8.1.2.2" xref="S2.p1.8.m8.1.2.2.cmml"><mo rspace="0.167em" id="S2.p1.8.m8.1.2.2.1" xref="S2.p1.8.m8.1.2.2.1.cmml">∀</mo><mi id="S2.p1.8.m8.1.2.2.2" xref="S2.p1.8.m8.1.2.2.2.cmml">m</mi></mrow><mo id="S2.p1.8.m8.1.2.1" xref="S2.p1.8.m8.1.2.1.cmml">∈</mo><mrow id="S2.p1.8.m8.1.2.3.2" xref="S2.p1.8.m8.1.2.3.1.cmml"><mo stretchy="false" id="S2.p1.8.m8.1.2.3.2.1" xref="S2.p1.8.m8.1.2.3.1.1.cmml">[</mo><mi id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">M</mi><mo stretchy="false" id="S2.p1.8.m8.1.2.3.2.2" xref="S2.p1.8.m8.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><apply id="S2.p1.8.m8.1.2.cmml" xref="S2.p1.8.m8.1.2"><in id="S2.p1.8.m8.1.2.1.cmml" xref="S2.p1.8.m8.1.2.1"></in><apply id="S2.p1.8.m8.1.2.2.cmml" xref="S2.p1.8.m8.1.2.2"><csymbol cd="latexml" id="S2.p1.8.m8.1.2.2.1.cmml" xref="S2.p1.8.m8.1.2.2.1">for-all</csymbol><ci id="S2.p1.8.m8.1.2.2.2.cmml" xref="S2.p1.8.m8.1.2.2.2">𝑚</ci></apply><apply id="S2.p1.8.m8.1.2.3.1.cmml" xref="S2.p1.8.m8.1.2.3.2"><csymbol cd="latexml" id="S2.p1.8.m8.1.2.3.1.1.cmml" xref="S2.p1.8.m8.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">\forall m\in[M]</annotation></semantics></math>, to be recommended in the system. Each user has some historical interactions with items (e.g., rating the items). However, the users’ historical interactions and attributes cannot be observed by the central server due to users’ privacy concerns. Therefore, only recommendation models, instead of user data, can be exchanged between the server and the user devices. Under such constraints, the system aims to train personalized recommendation models for different users.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Our Proposed Framework</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our proposed PerFedRec framework consists of a user-side end-to-end local recommendation network and a server-side clustering based aggregator. The overall architecture is shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>User-Side Local Recommendation Network</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Our proposed user-side local recommendation network has three modules: a raw embedding module, a local GNN module, and a personalized prediction module.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.10" class="ltx_p"><math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mo id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\bullet</annotation></semantics></math> <span id="S3.SS1.p2.10.1" class="ltx_text ltx_font_bold">Raw Embedding Module.</span> This module pre-processes user and item attributes. Via an attention mechanism, it combines attribute information with collaborative information (i.e., user-item interactions) to generate inputs to the local GNN module. Formally, the collaborative information for user <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">n</annotation></semantics></math> and item <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">m</annotation></semantics></math> is denoted by a <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">d</annotation></semantics></math>-dimensional ID embedding <math id="S3.SS1.p2.5.m5.2" class="ltx_Math" alttext="E_{idu,n}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.5.m5.2a"><mrow id="S3.SS1.p2.5.m5.2.3" xref="S3.SS1.p2.5.m5.2.3.cmml"><msub id="S3.SS1.p2.5.m5.2.3.2" xref="S3.SS1.p2.5.m5.2.3.2.cmml"><mi id="S3.SS1.p2.5.m5.2.3.2.2" xref="S3.SS1.p2.5.m5.2.3.2.2.cmml">E</mi><mrow id="S3.SS1.p2.5.m5.2.2.2.2" xref="S3.SS1.p2.5.m5.2.2.2.3.cmml"><mrow id="S3.SS1.p2.5.m5.2.2.2.2.1" xref="S3.SS1.p2.5.m5.2.2.2.2.1.cmml"><mi id="S3.SS1.p2.5.m5.2.2.2.2.1.2" xref="S3.SS1.p2.5.m5.2.2.2.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.2.2.2.2.1.1" xref="S3.SS1.p2.5.m5.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.5.m5.2.2.2.2.1.3" xref="S3.SS1.p2.5.m5.2.2.2.2.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.2.2.2.2.1.1a" xref="S3.SS1.p2.5.m5.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.5.m5.2.2.2.2.1.4" xref="S3.SS1.p2.5.m5.2.2.2.2.1.4.cmml">u</mi></mrow><mo id="S3.SS1.p2.5.m5.2.2.2.2.2" xref="S3.SS1.p2.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.cmml">n</mi></mrow></msub><mo id="S3.SS1.p2.5.m5.2.3.1" xref="S3.SS1.p2.5.m5.2.3.1.cmml">∈</mo><msup id="S3.SS1.p2.5.m5.2.3.3" xref="S3.SS1.p2.5.m5.2.3.3.cmml"><mi id="S3.SS1.p2.5.m5.2.3.3.2" xref="S3.SS1.p2.5.m5.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.5.m5.2.3.3.3" xref="S3.SS1.p2.5.m5.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.2b"><apply id="S3.SS1.p2.5.m5.2.3.cmml" xref="S3.SS1.p2.5.m5.2.3"><in id="S3.SS1.p2.5.m5.2.3.1.cmml" xref="S3.SS1.p2.5.m5.2.3.1"></in><apply id="S3.SS1.p2.5.m5.2.3.2.cmml" xref="S3.SS1.p2.5.m5.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.3.2.1.cmml" xref="S3.SS1.p2.5.m5.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.2.3.2.2.cmml" xref="S3.SS1.p2.5.m5.2.3.2.2">𝐸</ci><list id="S3.SS1.p2.5.m5.2.2.2.3.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2"><apply id="S3.SS1.p2.5.m5.2.2.2.2.1.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2.1"><times id="S3.SS1.p2.5.m5.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2.1.1"></times><ci id="S3.SS1.p2.5.m5.2.2.2.2.1.2.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2.1.2">𝑖</ci><ci id="S3.SS1.p2.5.m5.2.2.2.2.1.3.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2.1.3">𝑑</ci><ci id="S3.SS1.p2.5.m5.2.2.2.2.1.4.cmml" xref="S3.SS1.p2.5.m5.2.2.2.2.1.4">𝑢</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1">𝑛</ci></list></apply><apply id="S3.SS1.p2.5.m5.2.3.3.cmml" xref="S3.SS1.p2.5.m5.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.3.3.1.cmml" xref="S3.SS1.p2.5.m5.2.3.3">superscript</csymbol><ci id="S3.SS1.p2.5.m5.2.3.3.2.cmml" xref="S3.SS1.p2.5.m5.2.3.3.2">ℝ</ci><ci id="S3.SS1.p2.5.m5.2.3.3.3.cmml" xref="S3.SS1.p2.5.m5.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.2c">E_{idu,n}\in\mathbb{R}^{d}</annotation></semantics></math> and <math id="S3.SS1.p2.6.m6.2" class="ltx_Math" alttext="E_{idi,m}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.6.m6.2a"><mrow id="S3.SS1.p2.6.m6.2.3" xref="S3.SS1.p2.6.m6.2.3.cmml"><msub id="S3.SS1.p2.6.m6.2.3.2" xref="S3.SS1.p2.6.m6.2.3.2.cmml"><mi id="S3.SS1.p2.6.m6.2.3.2.2" xref="S3.SS1.p2.6.m6.2.3.2.2.cmml">E</mi><mrow id="S3.SS1.p2.6.m6.2.2.2.2" xref="S3.SS1.p2.6.m6.2.2.2.3.cmml"><mrow id="S3.SS1.p2.6.m6.2.2.2.2.1" xref="S3.SS1.p2.6.m6.2.2.2.2.1.cmml"><mi id="S3.SS1.p2.6.m6.2.2.2.2.1.2" xref="S3.SS1.p2.6.m6.2.2.2.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.2.2.2.2.1.1" xref="S3.SS1.p2.6.m6.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.6.m6.2.2.2.2.1.3" xref="S3.SS1.p2.6.m6.2.2.2.2.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.6.m6.2.2.2.2.1.1a" xref="S3.SS1.p2.6.m6.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.6.m6.2.2.2.2.1.4" xref="S3.SS1.p2.6.m6.2.2.2.2.1.4.cmml">i</mi></mrow><mo id="S3.SS1.p2.6.m6.2.2.2.2.2" xref="S3.SS1.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.cmml">m</mi></mrow></msub><mo id="S3.SS1.p2.6.m6.2.3.1" xref="S3.SS1.p2.6.m6.2.3.1.cmml">∈</mo><msup id="S3.SS1.p2.6.m6.2.3.3" xref="S3.SS1.p2.6.m6.2.3.3.cmml"><mi id="S3.SS1.p2.6.m6.2.3.3.2" xref="S3.SS1.p2.6.m6.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.6.m6.2.3.3.3" xref="S3.SS1.p2.6.m6.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.2b"><apply id="S3.SS1.p2.6.m6.2.3.cmml" xref="S3.SS1.p2.6.m6.2.3"><in id="S3.SS1.p2.6.m6.2.3.1.cmml" xref="S3.SS1.p2.6.m6.2.3.1"></in><apply id="S3.SS1.p2.6.m6.2.3.2.cmml" xref="S3.SS1.p2.6.m6.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.3.2.1.cmml" xref="S3.SS1.p2.6.m6.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.2.3.2.2.cmml" xref="S3.SS1.p2.6.m6.2.3.2.2">𝐸</ci><list id="S3.SS1.p2.6.m6.2.2.2.3.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2"><apply id="S3.SS1.p2.6.m6.2.2.2.2.1.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.1"><times id="S3.SS1.p2.6.m6.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.1.1"></times><ci id="S3.SS1.p2.6.m6.2.2.2.2.1.2.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.1.2">𝑖</ci><ci id="S3.SS1.p2.6.m6.2.2.2.2.1.3.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.1.3">𝑑</ci><ci id="S3.SS1.p2.6.m6.2.2.2.2.1.4.cmml" xref="S3.SS1.p2.6.m6.2.2.2.2.1.4">𝑖</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1">𝑚</ci></list></apply><apply id="S3.SS1.p2.6.m6.2.3.3.cmml" xref="S3.SS1.p2.6.m6.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.2.3.3.1.cmml" xref="S3.SS1.p2.6.m6.2.3.3">superscript</csymbol><ci id="S3.SS1.p2.6.m6.2.3.3.2.cmml" xref="S3.SS1.p2.6.m6.2.3.3.2">ℝ</ci><ci id="S3.SS1.p2.6.m6.2.3.3.3.cmml" xref="S3.SS1.p2.6.m6.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.2c">E_{idi,m}\in\mathbb{R}^{d}</annotation></semantics></math>, respectively. These embeddings are initialized randomly and updated based on user-item interactions during training. The attributes of user <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">n</annotation></semantics></math> and item <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">m</annotation></semantics></math> are passed through a linear layer and a feature crossing layer to generate the attribute embeddings <math id="S3.SS1.p2.9.m9.2" class="ltx_Math" alttext="E_{fcu,n}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.9.m9.2a"><mrow id="S3.SS1.p2.9.m9.2.3" xref="S3.SS1.p2.9.m9.2.3.cmml"><msub id="S3.SS1.p2.9.m9.2.3.2" xref="S3.SS1.p2.9.m9.2.3.2.cmml"><mi id="S3.SS1.p2.9.m9.2.3.2.2" xref="S3.SS1.p2.9.m9.2.3.2.2.cmml">E</mi><mrow id="S3.SS1.p2.9.m9.2.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml"><mrow id="S3.SS1.p2.9.m9.2.2.2.2.1" xref="S3.SS1.p2.9.m9.2.2.2.2.1.cmml"><mi id="S3.SS1.p2.9.m9.2.2.2.2.1.2" xref="S3.SS1.p2.9.m9.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m9.2.2.2.2.1.1" xref="S3.SS1.p2.9.m9.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.9.m9.2.2.2.2.1.3" xref="S3.SS1.p2.9.m9.2.2.2.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.9.m9.2.2.2.2.1.1a" xref="S3.SS1.p2.9.m9.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.9.m9.2.2.2.2.1.4" xref="S3.SS1.p2.9.m9.2.2.2.2.1.4.cmml">u</mi></mrow><mo id="S3.SS1.p2.9.m9.2.2.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.9.m9.1.1.1.1" xref="S3.SS1.p2.9.m9.1.1.1.1.cmml">n</mi></mrow></msub><mo id="S3.SS1.p2.9.m9.2.3.1" xref="S3.SS1.p2.9.m9.2.3.1.cmml">∈</mo><msup id="S3.SS1.p2.9.m9.2.3.3" xref="S3.SS1.p2.9.m9.2.3.3.cmml"><mi id="S3.SS1.p2.9.m9.2.3.3.2" xref="S3.SS1.p2.9.m9.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.9.m9.2.3.3.3" xref="S3.SS1.p2.9.m9.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.2b"><apply id="S3.SS1.p2.9.m9.2.3.cmml" xref="S3.SS1.p2.9.m9.2.3"><in id="S3.SS1.p2.9.m9.2.3.1.cmml" xref="S3.SS1.p2.9.m9.2.3.1"></in><apply id="S3.SS1.p2.9.m9.2.3.2.cmml" xref="S3.SS1.p2.9.m9.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.2.3.2.1.cmml" xref="S3.SS1.p2.9.m9.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.9.m9.2.3.2.2.cmml" xref="S3.SS1.p2.9.m9.2.3.2.2">𝐸</ci><list id="S3.SS1.p2.9.m9.2.2.2.3.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2"><apply id="S3.SS1.p2.9.m9.2.2.2.2.1.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.1"><times id="S3.SS1.p2.9.m9.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.1.1"></times><ci id="S3.SS1.p2.9.m9.2.2.2.2.1.2.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.1.2">𝑓</ci><ci id="S3.SS1.p2.9.m9.2.2.2.2.1.3.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.1.3">𝑐</ci><ci id="S3.SS1.p2.9.m9.2.2.2.2.1.4.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.1.4">𝑢</ci></apply><ci id="S3.SS1.p2.9.m9.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1.1">𝑛</ci></list></apply><apply id="S3.SS1.p2.9.m9.2.3.3.cmml" xref="S3.SS1.p2.9.m9.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.2.3.3.1.cmml" xref="S3.SS1.p2.9.m9.2.3.3">superscript</csymbol><ci id="S3.SS1.p2.9.m9.2.3.3.2.cmml" xref="S3.SS1.p2.9.m9.2.3.3.2">ℝ</ci><ci id="S3.SS1.p2.9.m9.2.3.3.3.cmml" xref="S3.SS1.p2.9.m9.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.2c">E_{fcu,n}\in\mathbb{R}^{d}</annotation></semantics></math> and <math id="S3.SS1.p2.10.m10.2" class="ltx_Math" alttext="E_{fci,m}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.10.m10.2a"><mrow id="S3.SS1.p2.10.m10.2.3" xref="S3.SS1.p2.10.m10.2.3.cmml"><msub id="S3.SS1.p2.10.m10.2.3.2" xref="S3.SS1.p2.10.m10.2.3.2.cmml"><mi id="S3.SS1.p2.10.m10.2.3.2.2" xref="S3.SS1.p2.10.m10.2.3.2.2.cmml">E</mi><mrow id="S3.SS1.p2.10.m10.2.2.2.2" xref="S3.SS1.p2.10.m10.2.2.2.3.cmml"><mrow id="S3.SS1.p2.10.m10.2.2.2.2.1" xref="S3.SS1.p2.10.m10.2.2.2.2.1.cmml"><mi id="S3.SS1.p2.10.m10.2.2.2.2.1.2" xref="S3.SS1.p2.10.m10.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m10.2.2.2.2.1.1" xref="S3.SS1.p2.10.m10.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.10.m10.2.2.2.2.1.3" xref="S3.SS1.p2.10.m10.2.2.2.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.10.m10.2.2.2.2.1.1a" xref="S3.SS1.p2.10.m10.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.10.m10.2.2.2.2.1.4" xref="S3.SS1.p2.10.m10.2.2.2.2.1.4.cmml">i</mi></mrow><mo id="S3.SS1.p2.10.m10.2.2.2.2.2" xref="S3.SS1.p2.10.m10.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.10.m10.1.1.1.1" xref="S3.SS1.p2.10.m10.1.1.1.1.cmml">m</mi></mrow></msub><mo id="S3.SS1.p2.10.m10.2.3.1" xref="S3.SS1.p2.10.m10.2.3.1.cmml">∈</mo><msup id="S3.SS1.p2.10.m10.2.3.3" xref="S3.SS1.p2.10.m10.2.3.3.cmml"><mi id="S3.SS1.p2.10.m10.2.3.3.2" xref="S3.SS1.p2.10.m10.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.10.m10.2.3.3.3" xref="S3.SS1.p2.10.m10.2.3.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.2b"><apply id="S3.SS1.p2.10.m10.2.3.cmml" xref="S3.SS1.p2.10.m10.2.3"><in id="S3.SS1.p2.10.m10.2.3.1.cmml" xref="S3.SS1.p2.10.m10.2.3.1"></in><apply id="S3.SS1.p2.10.m10.2.3.2.cmml" xref="S3.SS1.p2.10.m10.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.2.3.2.1.cmml" xref="S3.SS1.p2.10.m10.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.10.m10.2.3.2.2.cmml" xref="S3.SS1.p2.10.m10.2.3.2.2">𝐸</ci><list id="S3.SS1.p2.10.m10.2.2.2.3.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2"><apply id="S3.SS1.p2.10.m10.2.2.2.2.1.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2.1"><times id="S3.SS1.p2.10.m10.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2.1.1"></times><ci id="S3.SS1.p2.10.m10.2.2.2.2.1.2.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2.1.2">𝑓</ci><ci id="S3.SS1.p2.10.m10.2.2.2.2.1.3.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2.1.3">𝑐</ci><ci id="S3.SS1.p2.10.m10.2.2.2.2.1.4.cmml" xref="S3.SS1.p2.10.m10.2.2.2.2.1.4">𝑖</ci></apply><ci id="S3.SS1.p2.10.m10.1.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1.1.1">𝑚</ci></list></apply><apply id="S3.SS1.p2.10.m10.2.3.3.cmml" xref="S3.SS1.p2.10.m10.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.2.3.3.1.cmml" xref="S3.SS1.p2.10.m10.2.3.3">superscript</csymbol><ci id="S3.SS1.p2.10.m10.2.3.3.2.cmml" xref="S3.SS1.p2.10.m10.2.3.3.2">ℝ</ci><ci id="S3.SS1.p2.10.m10.2.3.3.3.cmml" xref="S3.SS1.p2.10.m10.2.3.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.2c">E_{fci,m}\in\mathbb{R}^{d}</annotation></semantics></math>, respectively:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.45" class="ltx_Math" alttext="\begin{split}E_{fu,n}&amp;=W_{fu,n}u_{n}+b_{fu,n},\\
E_{fi,m}&amp;=W_{fi,m}v_{m}+b_{fi,m},\\
E_{fcu,n}&amp;=\text{FeatureCrossing}(E_{fu,n}),\\
E_{fci,m}&amp;=\text{FeatureCrossing}(E_{fi,m}),\end{split}" display="block"><semantics id="S3.E1.m1.45a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E1.m1.45.45.5"><mtr id="S3.E1.m1.45.45.5a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.45.45.5b"><msub id="S3.E1.m1.2.2.2.2.2"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">E</mi><mrow id="S3.E1.m1.2.2.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.2.1.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.2.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.2.2.1.2.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.2.2.1.2.1.3" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.3.cmml">u</mi></mrow><mo id="S3.E1.m1.2.2.2.2.2.2.1.2.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.cmml">n</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.45.45.5c"><mrow id="S3.E1.m1.42.42.2.41.12.10.10"><mrow id="S3.E1.m1.42.42.2.41.12.10.10.1"><mi id="S3.E1.m1.42.42.2.41.12.10.10.1.1"></mi><mo id="S3.E1.m1.3.3.3.3.1.1" xref="S3.E1.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E1.m1.42.42.2.41.12.10.10.1.2"><mrow id="S3.E1.m1.42.42.2.41.12.10.10.1.2.1"><msub id="S3.E1.m1.42.42.2.41.12.10.10.1.2.1.2"><mi id="S3.E1.m1.4.4.4.4.2.2" xref="S3.E1.m1.4.4.4.4.2.2.cmml">W</mi><mrow id="S3.E1.m1.5.5.5.5.3.3.1.2" xref="S3.E1.m1.5.5.5.5.3.3.1.3.cmml"><mrow id="S3.E1.m1.5.5.5.5.3.3.1.2.1" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.cmml"><mi id="S3.E1.m1.5.5.5.5.3.3.1.2.1.2" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.5.5.3.3.1.2.1.1" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.5.5.5.5.3.3.1.2.1.3" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.3.cmml">u</mi></mrow><mo id="S3.E1.m1.5.5.5.5.3.3.1.2.2" xref="S3.E1.m1.5.5.5.5.3.3.1.3.cmml">,</mo><mi id="S3.E1.m1.5.5.5.5.3.3.1.1" xref="S3.E1.m1.5.5.5.5.3.3.1.1.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.42.42.2.41.12.10.10.1.2.1.1">​</mo><msub id="S3.E1.m1.42.42.2.41.12.10.10.1.2.1.3"><mi id="S3.E1.m1.6.6.6.6.4.4" xref="S3.E1.m1.6.6.6.6.4.4.cmml">u</mi><mi id="S3.E1.m1.7.7.7.7.5.5.1" xref="S3.E1.m1.7.7.7.7.5.5.1.cmml">n</mi></msub></mrow><mo id="S3.E1.m1.8.8.8.8.6.6" xref="S3.E1.m1.8.8.8.8.6.6.cmml">+</mo><msub id="S3.E1.m1.42.42.2.41.12.10.10.1.2.2"><mi id="S3.E1.m1.9.9.9.9.7.7" xref="S3.E1.m1.9.9.9.9.7.7.cmml">b</mi><mrow id="S3.E1.m1.10.10.10.10.8.8.1.2" xref="S3.E1.m1.10.10.10.10.8.8.1.3.cmml"><mrow id="S3.E1.m1.10.10.10.10.8.8.1.2.1" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.cmml"><mi id="S3.E1.m1.10.10.10.10.8.8.1.2.1.2" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.10.10.10.10.8.8.1.2.1.1" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.10.10.10.10.8.8.1.2.1.3" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.3.cmml">u</mi></mrow><mo id="S3.E1.m1.10.10.10.10.8.8.1.2.2" xref="S3.E1.m1.10.10.10.10.8.8.1.3.cmml">,</mo><mi id="S3.E1.m1.10.10.10.10.8.8.1.1" xref="S3.E1.m1.10.10.10.10.8.8.1.1.cmml">n</mi></mrow></msub></mrow></mrow><mo id="S3.E1.m1.11.11.11.11.9.9">,</mo></mrow></mtd></mtr><mtr id="S3.E1.m1.45.45.5d"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.45.45.5e"><msub id="S3.E1.m1.13.13.13.2.2"><mi id="S3.E1.m1.12.12.12.1.1.1" xref="S3.E1.m1.12.12.12.1.1.1.cmml">E</mi><mrow id="S3.E1.m1.13.13.13.2.2.2.1.2" xref="S3.E1.m1.13.13.13.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.13.13.13.2.2.2.1.2.1" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.cmml"><mi id="S3.E1.m1.13.13.13.2.2.2.1.2.1.2" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.13.13.13.2.2.2.1.2.1.1" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.13.13.13.2.2.2.1.2.1.3" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.3.cmml">i</mi></mrow><mo id="S3.E1.m1.13.13.13.2.2.2.1.2.2" xref="S3.E1.m1.13.13.13.2.2.2.1.3.cmml">,</mo><mi id="S3.E1.m1.13.13.13.2.2.2.1.1" xref="S3.E1.m1.13.13.13.2.2.2.1.1.cmml">m</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.45.45.5f"><mrow id="S3.E1.m1.43.43.3.42.12.10.10"><mrow id="S3.E1.m1.43.43.3.42.12.10.10.1"><mi id="S3.E1.m1.43.43.3.42.12.10.10.1.1"></mi><mo id="S3.E1.m1.14.14.14.3.1.1" xref="S3.E1.m1.14.14.14.3.1.1.cmml">=</mo><mrow id="S3.E1.m1.43.43.3.42.12.10.10.1.2"><mrow id="S3.E1.m1.43.43.3.42.12.10.10.1.2.1"><msub id="S3.E1.m1.43.43.3.42.12.10.10.1.2.1.2"><mi id="S3.E1.m1.15.15.15.4.2.2" xref="S3.E1.m1.15.15.15.4.2.2.cmml">W</mi><mrow id="S3.E1.m1.16.16.16.5.3.3.1.2" xref="S3.E1.m1.16.16.16.5.3.3.1.3.cmml"><mrow id="S3.E1.m1.16.16.16.5.3.3.1.2.1" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.cmml"><mi id="S3.E1.m1.16.16.16.5.3.3.1.2.1.2" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.16.16.16.5.3.3.1.2.1.1" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.16.16.16.5.3.3.1.2.1.3" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.3.cmml">i</mi></mrow><mo id="S3.E1.m1.16.16.16.5.3.3.1.2.2" xref="S3.E1.m1.16.16.16.5.3.3.1.3.cmml">,</mo><mi id="S3.E1.m1.16.16.16.5.3.3.1.1" xref="S3.E1.m1.16.16.16.5.3.3.1.1.cmml">m</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.43.43.3.42.12.10.10.1.2.1.1">​</mo><msub id="S3.E1.m1.43.43.3.42.12.10.10.1.2.1.3"><mi id="S3.E1.m1.17.17.17.6.4.4" xref="S3.E1.m1.17.17.17.6.4.4.cmml">v</mi><mi id="S3.E1.m1.18.18.18.7.5.5.1" xref="S3.E1.m1.18.18.18.7.5.5.1.cmml">m</mi></msub></mrow><mo id="S3.E1.m1.19.19.19.8.6.6" xref="S3.E1.m1.19.19.19.8.6.6.cmml">+</mo><msub id="S3.E1.m1.43.43.3.42.12.10.10.1.2.2"><mi id="S3.E1.m1.20.20.20.9.7.7" xref="S3.E1.m1.20.20.20.9.7.7.cmml">b</mi><mrow id="S3.E1.m1.21.21.21.10.8.8.1.2" xref="S3.E1.m1.21.21.21.10.8.8.1.3.cmml"><mrow id="S3.E1.m1.21.21.21.10.8.8.1.2.1" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.cmml"><mi id="S3.E1.m1.21.21.21.10.8.8.1.2.1.2" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.21.21.21.10.8.8.1.2.1.1" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.21.21.21.10.8.8.1.2.1.3" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.3.cmml">i</mi></mrow><mo id="S3.E1.m1.21.21.21.10.8.8.1.2.2" xref="S3.E1.m1.21.21.21.10.8.8.1.3.cmml">,</mo><mi id="S3.E1.m1.21.21.21.10.8.8.1.1" xref="S3.E1.m1.21.21.21.10.8.8.1.1.cmml">m</mi></mrow></msub></mrow></mrow><mo id="S3.E1.m1.22.22.22.11.9.9">,</mo></mrow></mtd></mtr><mtr id="S3.E1.m1.45.45.5g"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.45.45.5h"><msub id="S3.E1.m1.24.24.24.2.2"><mi id="S3.E1.m1.23.23.23.1.1.1" xref="S3.E1.m1.23.23.23.1.1.1.cmml">E</mi><mrow id="S3.E1.m1.24.24.24.2.2.2.1.2" xref="S3.E1.m1.24.24.24.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.24.24.24.2.2.2.1.2.1" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.cmml"><mi id="S3.E1.m1.24.24.24.2.2.2.1.2.1.2" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.24.24.24.2.2.2.1.2.1.1" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.24.24.24.2.2.2.1.2.1.3" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.24.24.24.2.2.2.1.2.1.1a" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.24.24.24.2.2.2.1.2.1.4" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.4.cmml">u</mi></mrow><mo id="S3.E1.m1.24.24.24.2.2.2.1.2.2" xref="S3.E1.m1.24.24.24.2.2.2.1.3.cmml">,</mo><mi id="S3.E1.m1.24.24.24.2.2.2.1.1" xref="S3.E1.m1.24.24.24.2.2.2.1.1.cmml">n</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.45.45.5i"><mrow id="S3.E1.m1.44.44.4.43.10.8.8"><mrow id="S3.E1.m1.44.44.4.43.10.8.8.1"><mi id="S3.E1.m1.44.44.4.43.10.8.8.1.2"></mi><mo id="S3.E1.m1.25.25.25.3.1.1" xref="S3.E1.m1.25.25.25.3.1.1.cmml">=</mo><mrow id="S3.E1.m1.44.44.4.43.10.8.8.1.1"><mtext id="S3.E1.m1.26.26.26.4.2.2" xref="S3.E1.m1.26.26.26.4.2.2a.cmml">FeatureCrossing</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.44.44.4.43.10.8.8.1.1.2">​</mo><mrow id="S3.E1.m1.44.44.4.43.10.8.8.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.27.27.27.5.3.3">(</mo><msub id="S3.E1.m1.44.44.4.43.10.8.8.1.1.1.1.1"><mi id="S3.E1.m1.28.28.28.6.4.4" xref="S3.E1.m1.28.28.28.6.4.4.cmml">E</mi><mrow id="S3.E1.m1.29.29.29.7.5.5.1.2" xref="S3.E1.m1.29.29.29.7.5.5.1.3.cmml"><mrow id="S3.E1.m1.29.29.29.7.5.5.1.2.1" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.cmml"><mi id="S3.E1.m1.29.29.29.7.5.5.1.2.1.2" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.29.29.29.7.5.5.1.2.1.1" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.29.29.29.7.5.5.1.2.1.3" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.3.cmml">u</mi></mrow><mo id="S3.E1.m1.29.29.29.7.5.5.1.2.2" xref="S3.E1.m1.29.29.29.7.5.5.1.3.cmml">,</mo><mi id="S3.E1.m1.29.29.29.7.5.5.1.1" xref="S3.E1.m1.29.29.29.7.5.5.1.1.cmml">n</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.30.30.30.8.6.6">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.31.31.31.9.7.7">,</mo></mrow></mtd></mtr><mtr id="S3.E1.m1.45.45.5j"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.45.45.5k"><msub id="S3.E1.m1.33.33.33.2.2"><mi id="S3.E1.m1.32.32.32.1.1.1" xref="S3.E1.m1.32.32.32.1.1.1.cmml">E</mi><mrow id="S3.E1.m1.33.33.33.2.2.2.1.2" xref="S3.E1.m1.33.33.33.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.33.33.33.2.2.2.1.2.1" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.cmml"><mi id="S3.E1.m1.33.33.33.2.2.2.1.2.1.2" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.33.2.2.2.1.2.1.1" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.33.33.33.2.2.2.1.2.1.3" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.33.33.33.2.2.2.1.2.1.1a" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.33.33.33.2.2.2.1.2.1.4" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.4.cmml">i</mi></mrow><mo id="S3.E1.m1.33.33.33.2.2.2.1.2.2" xref="S3.E1.m1.33.33.33.2.2.2.1.3.cmml">,</mo><mi id="S3.E1.m1.33.33.33.2.2.2.1.1" xref="S3.E1.m1.33.33.33.2.2.2.1.1.cmml">m</mi></mrow></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.45.45.5l"><mrow id="S3.E1.m1.45.45.5.44.10.8.8"><mrow id="S3.E1.m1.45.45.5.44.10.8.8.1"><mi id="S3.E1.m1.45.45.5.44.10.8.8.1.2"></mi><mo id="S3.E1.m1.34.34.34.3.1.1" xref="S3.E1.m1.34.34.34.3.1.1.cmml">=</mo><mrow id="S3.E1.m1.45.45.5.44.10.8.8.1.1"><mtext id="S3.E1.m1.35.35.35.4.2.2" xref="S3.E1.m1.35.35.35.4.2.2a.cmml">FeatureCrossing</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.45.45.5.44.10.8.8.1.1.2">​</mo><mrow id="S3.E1.m1.45.45.5.44.10.8.8.1.1.1.1"><mo stretchy="false" id="S3.E1.m1.36.36.36.5.3.3">(</mo><msub id="S3.E1.m1.45.45.5.44.10.8.8.1.1.1.1.1"><mi id="S3.E1.m1.37.37.37.6.4.4" xref="S3.E1.m1.37.37.37.6.4.4.cmml">E</mi><mrow id="S3.E1.m1.38.38.38.7.5.5.1.2" xref="S3.E1.m1.38.38.38.7.5.5.1.3.cmml"><mrow id="S3.E1.m1.38.38.38.7.5.5.1.2.1" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.cmml"><mi id="S3.E1.m1.38.38.38.7.5.5.1.2.1.2" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.38.38.38.7.5.5.1.2.1.1" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.1.cmml">​</mo><mi id="S3.E1.m1.38.38.38.7.5.5.1.2.1.3" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.3.cmml">i</mi></mrow><mo id="S3.E1.m1.38.38.38.7.5.5.1.2.2" xref="S3.E1.m1.38.38.38.7.5.5.1.3.cmml">,</mo><mi id="S3.E1.m1.38.38.38.7.5.5.1.1" xref="S3.E1.m1.38.38.38.7.5.5.1.1.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.39.39.39.8.6.6">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.40.40.40.9.7.7">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.45b"><apply id="S3.E1.m1.41.41.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E1.m1.41.41.1.1.1.1.1.cmml"><eq id="S3.E1.m1.3.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1"></eq><apply id="S3.E1.m1.41.41.1.1.1.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.1.1.2.1.cmml">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝐸</ci><list id="S3.E1.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.2"><apply id="S3.E1.m1.2.2.2.2.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1"><times id="S3.E1.m1.2.2.2.2.2.2.1.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.1"></times><ci id="S3.E1.m1.2.2.2.2.2.2.1.2.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.2.1.3">𝑢</ci></apply><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1">𝑛</ci></list></apply><apply id="S3.E1.m1.41.41.1.1.1.1.1.3.cmml"><plus id="S3.E1.m1.8.8.8.8.6.6.cmml" xref="S3.E1.m1.8.8.8.8.6.6"></plus><apply id="S3.E1.m1.41.41.1.1.1.1.1.3.2.cmml"><times id="S3.E1.m1.41.41.1.1.1.1.1.3.2.1.cmml"></times><apply id="S3.E1.m1.41.41.1.1.1.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.1.1.3.2.2.1.cmml">subscript</csymbol><ci id="S3.E1.m1.4.4.4.4.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.2">𝑊</ci><list id="S3.E1.m1.5.5.5.5.3.3.1.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.1.2"><apply id="S3.E1.m1.5.5.5.5.3.3.1.2.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1"><times id="S3.E1.m1.5.5.5.5.3.3.1.2.1.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.1"></times><ci id="S3.E1.m1.5.5.5.5.3.3.1.2.1.2.cmml" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.5.5.5.5.3.3.1.2.1.3.cmml" xref="S3.E1.m1.5.5.5.5.3.3.1.2.1.3">𝑢</ci></apply><ci id="S3.E1.m1.5.5.5.5.3.3.1.1.cmml" xref="S3.E1.m1.5.5.5.5.3.3.1.1">𝑛</ci></list></apply><apply id="S3.E1.m1.41.41.1.1.1.1.1.3.2.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.1.1.3.2.3.1.cmml">subscript</csymbol><ci id="S3.E1.m1.6.6.6.6.4.4.cmml" xref="S3.E1.m1.6.6.6.6.4.4">𝑢</ci><ci id="S3.E1.m1.7.7.7.7.5.5.1.cmml" xref="S3.E1.m1.7.7.7.7.5.5.1">𝑛</ci></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.1.1.3.3.1.cmml">subscript</csymbol><ci id="S3.E1.m1.9.9.9.9.7.7.cmml" xref="S3.E1.m1.9.9.9.9.7.7">𝑏</ci><list id="S3.E1.m1.10.10.10.10.8.8.1.3.cmml" xref="S3.E1.m1.10.10.10.10.8.8.1.2"><apply id="S3.E1.m1.10.10.10.10.8.8.1.2.1.cmml" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1"><times id="S3.E1.m1.10.10.10.10.8.8.1.2.1.1.cmml" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.1"></times><ci id="S3.E1.m1.10.10.10.10.8.8.1.2.1.2.cmml" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.10.10.10.10.8.8.1.2.1.3.cmml" xref="S3.E1.m1.10.10.10.10.8.8.1.2.1.3">𝑢</ci></apply><ci id="S3.E1.m1.10.10.10.10.8.8.1.1.cmml" xref="S3.E1.m1.10.10.10.10.8.8.1.1">𝑛</ci></list></apply></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.cmml"><eq id="S3.E1.m1.14.14.14.3.1.1.cmml" xref="S3.E1.m1.14.14.14.3.1.1"></eq><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.2.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.1.1.2.1.cmml">subscript</csymbol><ci id="S3.E1.m1.12.12.12.1.1.1.cmml" xref="S3.E1.m1.12.12.12.1.1.1">𝐸</ci><list id="S3.E1.m1.13.13.13.2.2.2.1.3.cmml" xref="S3.E1.m1.13.13.13.2.2.2.1.2"><apply id="S3.E1.m1.13.13.13.2.2.2.1.2.1.cmml" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1"><times id="S3.E1.m1.13.13.13.2.2.2.1.2.1.1.cmml" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.1"></times><ci id="S3.E1.m1.13.13.13.2.2.2.1.2.1.2.cmml" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.13.13.13.2.2.2.1.2.1.3.cmml" xref="S3.E1.m1.13.13.13.2.2.2.1.2.1.3">𝑖</ci></apply><ci id="S3.E1.m1.13.13.13.2.2.2.1.1.cmml" xref="S3.E1.m1.13.13.13.2.2.2.1.1">𝑚</ci></list></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.cmml"><plus id="S3.E1.m1.19.19.19.8.6.6.cmml" xref="S3.E1.m1.19.19.19.8.6.6"></plus><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.2.cmml"><times id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.2.1.cmml"></times><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.2.2.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.2.2.1.cmml">subscript</csymbol><ci id="S3.E1.m1.15.15.15.4.2.2.cmml" xref="S3.E1.m1.15.15.15.4.2.2">𝑊</ci><list id="S3.E1.m1.16.16.16.5.3.3.1.3.cmml" xref="S3.E1.m1.16.16.16.5.3.3.1.2"><apply id="S3.E1.m1.16.16.16.5.3.3.1.2.1.cmml" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1"><times id="S3.E1.m1.16.16.16.5.3.3.1.2.1.1.cmml" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.1"></times><ci id="S3.E1.m1.16.16.16.5.3.3.1.2.1.2.cmml" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.16.16.16.5.3.3.1.2.1.3.cmml" xref="S3.E1.m1.16.16.16.5.3.3.1.2.1.3">𝑖</ci></apply><ci id="S3.E1.m1.16.16.16.5.3.3.1.1.cmml" xref="S3.E1.m1.16.16.16.5.3.3.1.1">𝑚</ci></list></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.2.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.2.3.1.cmml">subscript</csymbol><ci id="S3.E1.m1.17.17.17.6.4.4.cmml" xref="S3.E1.m1.17.17.17.6.4.4">𝑣</ci><ci id="S3.E1.m1.18.18.18.7.5.5.1.cmml" xref="S3.E1.m1.18.18.18.7.5.5.1">𝑚</ci></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.1.1.3.3.1.cmml">subscript</csymbol><ci id="S3.E1.m1.20.20.20.9.7.7.cmml" xref="S3.E1.m1.20.20.20.9.7.7">𝑏</ci><list id="S3.E1.m1.21.21.21.10.8.8.1.3.cmml" xref="S3.E1.m1.21.21.21.10.8.8.1.2"><apply id="S3.E1.m1.21.21.21.10.8.8.1.2.1.cmml" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1"><times id="S3.E1.m1.21.21.21.10.8.8.1.2.1.1.cmml" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.1"></times><ci id="S3.E1.m1.21.21.21.10.8.8.1.2.1.2.cmml" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.21.21.21.10.8.8.1.2.1.3.cmml" xref="S3.E1.m1.21.21.21.10.8.8.1.2.1.3">𝑖</ci></apply><ci id="S3.E1.m1.21.21.21.10.8.8.1.1.cmml" xref="S3.E1.m1.21.21.21.10.8.8.1.1">𝑚</ci></list></apply></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.cmml"><eq id="S3.E1.m1.25.25.25.3.1.1.cmml" xref="S3.E1.m1.25.25.25.3.1.1"></eq><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.3.1.cmml">subscript</csymbol><ci id="S3.E1.m1.23.23.23.1.1.1.cmml" xref="S3.E1.m1.23.23.23.1.1.1">𝐸</ci><list id="S3.E1.m1.24.24.24.2.2.2.1.3.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.2"><apply id="S3.E1.m1.24.24.24.2.2.2.1.2.1.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1"><times id="S3.E1.m1.24.24.24.2.2.2.1.2.1.1.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.1"></times><ci id="S3.E1.m1.24.24.24.2.2.2.1.2.1.2.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.24.24.24.2.2.2.1.2.1.3.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.3">𝑐</ci><ci id="S3.E1.m1.24.24.24.2.2.2.1.2.1.4.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.2.1.4">𝑢</ci></apply><ci id="S3.E1.m1.24.24.24.2.2.2.1.1.cmml" xref="S3.E1.m1.24.24.24.2.2.2.1.1">𝑛</ci></list></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.1.cmml"><times id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.1.2.cmml"></times><ci id="S3.E1.m1.26.26.26.4.2.2a.cmml" xref="S3.E1.m1.26.26.26.4.2.2"><mtext id="S3.E1.m1.26.26.26.4.2.2.cmml" xref="S3.E1.m1.26.26.26.4.2.2">FeatureCrossing</mtext></ci><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.2.2.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E1.m1.28.28.28.6.4.4.cmml" xref="S3.E1.m1.28.28.28.6.4.4">𝐸</ci><list id="S3.E1.m1.29.29.29.7.5.5.1.3.cmml" xref="S3.E1.m1.29.29.29.7.5.5.1.2"><apply id="S3.E1.m1.29.29.29.7.5.5.1.2.1.cmml" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1"><times id="S3.E1.m1.29.29.29.7.5.5.1.2.1.1.cmml" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.1"></times><ci id="S3.E1.m1.29.29.29.7.5.5.1.2.1.2.cmml" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.29.29.29.7.5.5.1.2.1.3.cmml" xref="S3.E1.m1.29.29.29.7.5.5.1.2.1.3">𝑢</ci></apply><ci id="S3.E1.m1.29.29.29.7.5.5.1.1.cmml" xref="S3.E1.m1.29.29.29.7.5.5.1.1">𝑛</ci></list></apply></apply></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.cmml"><eq id="S3.E1.m1.34.34.34.3.1.1.cmml" xref="S3.E1.m1.34.34.34.3.1.1"></eq><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.3.1.cmml">subscript</csymbol><ci id="S3.E1.m1.32.32.32.1.1.1.cmml" xref="S3.E1.m1.32.32.32.1.1.1">𝐸</ci><list id="S3.E1.m1.33.33.33.2.2.2.1.3.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.2"><apply id="S3.E1.m1.33.33.33.2.2.2.1.2.1.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1"><times id="S3.E1.m1.33.33.33.2.2.2.1.2.1.1.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.1"></times><ci id="S3.E1.m1.33.33.33.2.2.2.1.2.1.2.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.33.33.33.2.2.2.1.2.1.3.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.3">𝑐</ci><ci id="S3.E1.m1.33.33.33.2.2.2.1.2.1.4.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.2.1.4">𝑖</ci></apply><ci id="S3.E1.m1.33.33.33.2.2.2.1.1.cmml" xref="S3.E1.m1.33.33.33.2.2.2.1.1">𝑚</ci></list></apply><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.1.cmml"><times id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.1.2.cmml"></times><ci id="S3.E1.m1.35.35.35.4.2.2a.cmml" xref="S3.E1.m1.35.35.35.4.2.2"><mtext id="S3.E1.m1.35.35.35.4.2.2.cmml" xref="S3.E1.m1.35.35.35.4.2.2">FeatureCrossing</mtext></ci><apply id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E1.m1.41.41.1.1.1.2.2.2.2.2.2.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E1.m1.37.37.37.6.4.4.cmml" xref="S3.E1.m1.37.37.37.6.4.4">𝐸</ci><list id="S3.E1.m1.38.38.38.7.5.5.1.3.cmml" xref="S3.E1.m1.38.38.38.7.5.5.1.2"><apply id="S3.E1.m1.38.38.38.7.5.5.1.2.1.cmml" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1"><times id="S3.E1.m1.38.38.38.7.5.5.1.2.1.1.cmml" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.1"></times><ci id="S3.E1.m1.38.38.38.7.5.5.1.2.1.2.cmml" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.2">𝑓</ci><ci id="S3.E1.m1.38.38.38.7.5.5.1.2.1.3.cmml" xref="S3.E1.m1.38.38.38.7.5.5.1.2.1.3">𝑖</ci></apply><ci id="S3.E1.m1.38.38.38.7.5.5.1.1.cmml" xref="S3.E1.m1.38.38.38.7.5.5.1.1">𝑚</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.45c">\begin{split}E_{fu,n}&amp;=W_{fu,n}u_{n}+b_{fu,n},\\
E_{fi,m}&amp;=W_{fi,m}v_{m}+b_{fi,m},\\
E_{fcu,n}&amp;=\text{FeatureCrossing}(E_{fu,n}),\\
E_{fci,m}&amp;=\text{FeatureCrossing}(E_{fi,m}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.21" class="ltx_p">where <math id="S3.SS1.p2.11.m1.12" class="ltx_Math" alttext="W_{fu,n},b_{fu,n},W_{fi,m},b_{fi,m}" display="inline"><semantics id="S3.SS1.p2.11.m1.12a"><mrow id="S3.SS1.p2.11.m1.12.12.4" xref="S3.SS1.p2.11.m1.12.12.5.cmml"><msub id="S3.SS1.p2.11.m1.9.9.1.1" xref="S3.SS1.p2.11.m1.9.9.1.1.cmml"><mi id="S3.SS1.p2.11.m1.9.9.1.1.2" xref="S3.SS1.p2.11.m1.9.9.1.1.2.cmml">W</mi><mrow id="S3.SS1.p2.11.m1.2.2.2.2" xref="S3.SS1.p2.11.m1.2.2.2.3.cmml"><mrow id="S3.SS1.p2.11.m1.2.2.2.2.1" xref="S3.SS1.p2.11.m1.2.2.2.2.1.cmml"><mi id="S3.SS1.p2.11.m1.2.2.2.2.1.2" xref="S3.SS1.p2.11.m1.2.2.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m1.2.2.2.2.1.1" xref="S3.SS1.p2.11.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.11.m1.2.2.2.2.1.3" xref="S3.SS1.p2.11.m1.2.2.2.2.1.3.cmml">u</mi></mrow><mo id="S3.SS1.p2.11.m1.2.2.2.2.2" xref="S3.SS1.p2.11.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p2.11.m1.1.1.1.1" xref="S3.SS1.p2.11.m1.1.1.1.1.cmml">n</mi></mrow></msub><mo id="S3.SS1.p2.11.m1.12.12.4.5" xref="S3.SS1.p2.11.m1.12.12.5.cmml">,</mo><msub id="S3.SS1.p2.11.m1.10.10.2.2" xref="S3.SS1.p2.11.m1.10.10.2.2.cmml"><mi id="S3.SS1.p2.11.m1.10.10.2.2.2" xref="S3.SS1.p2.11.m1.10.10.2.2.2.cmml">b</mi><mrow id="S3.SS1.p2.11.m1.4.4.2.2" xref="S3.SS1.p2.11.m1.4.4.2.3.cmml"><mrow id="S3.SS1.p2.11.m1.4.4.2.2.1" xref="S3.SS1.p2.11.m1.4.4.2.2.1.cmml"><mi id="S3.SS1.p2.11.m1.4.4.2.2.1.2" xref="S3.SS1.p2.11.m1.4.4.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m1.4.4.2.2.1.1" xref="S3.SS1.p2.11.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.11.m1.4.4.2.2.1.3" xref="S3.SS1.p2.11.m1.4.4.2.2.1.3.cmml">u</mi></mrow><mo id="S3.SS1.p2.11.m1.4.4.2.2.2" xref="S3.SS1.p2.11.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS1.p2.11.m1.3.3.1.1" xref="S3.SS1.p2.11.m1.3.3.1.1.cmml">n</mi></mrow></msub><mo id="S3.SS1.p2.11.m1.12.12.4.6" xref="S3.SS1.p2.11.m1.12.12.5.cmml">,</mo><msub id="S3.SS1.p2.11.m1.11.11.3.3" xref="S3.SS1.p2.11.m1.11.11.3.3.cmml"><mi id="S3.SS1.p2.11.m1.11.11.3.3.2" xref="S3.SS1.p2.11.m1.11.11.3.3.2.cmml">W</mi><mrow id="S3.SS1.p2.11.m1.6.6.2.2" xref="S3.SS1.p2.11.m1.6.6.2.3.cmml"><mrow id="S3.SS1.p2.11.m1.6.6.2.2.1" xref="S3.SS1.p2.11.m1.6.6.2.2.1.cmml"><mi id="S3.SS1.p2.11.m1.6.6.2.2.1.2" xref="S3.SS1.p2.11.m1.6.6.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m1.6.6.2.2.1.1" xref="S3.SS1.p2.11.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.11.m1.6.6.2.2.1.3" xref="S3.SS1.p2.11.m1.6.6.2.2.1.3.cmml">i</mi></mrow><mo id="S3.SS1.p2.11.m1.6.6.2.2.2" xref="S3.SS1.p2.11.m1.6.6.2.3.cmml">,</mo><mi id="S3.SS1.p2.11.m1.5.5.1.1" xref="S3.SS1.p2.11.m1.5.5.1.1.cmml">m</mi></mrow></msub><mo id="S3.SS1.p2.11.m1.12.12.4.7" xref="S3.SS1.p2.11.m1.12.12.5.cmml">,</mo><msub id="S3.SS1.p2.11.m1.12.12.4.4" xref="S3.SS1.p2.11.m1.12.12.4.4.cmml"><mi id="S3.SS1.p2.11.m1.12.12.4.4.2" xref="S3.SS1.p2.11.m1.12.12.4.4.2.cmml">b</mi><mrow id="S3.SS1.p2.11.m1.8.8.2.2" xref="S3.SS1.p2.11.m1.8.8.2.3.cmml"><mrow id="S3.SS1.p2.11.m1.8.8.2.2.1" xref="S3.SS1.p2.11.m1.8.8.2.2.1.cmml"><mi id="S3.SS1.p2.11.m1.8.8.2.2.1.2" xref="S3.SS1.p2.11.m1.8.8.2.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m1.8.8.2.2.1.1" xref="S3.SS1.p2.11.m1.8.8.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p2.11.m1.8.8.2.2.1.3" xref="S3.SS1.p2.11.m1.8.8.2.2.1.3.cmml">i</mi></mrow><mo id="S3.SS1.p2.11.m1.8.8.2.2.2" xref="S3.SS1.p2.11.m1.8.8.2.3.cmml">,</mo><mi id="S3.SS1.p2.11.m1.7.7.1.1" xref="S3.SS1.p2.11.m1.7.7.1.1.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m1.12b"><list id="S3.SS1.p2.11.m1.12.12.5.cmml" xref="S3.SS1.p2.11.m1.12.12.4"><apply id="S3.SS1.p2.11.m1.9.9.1.1.cmml" xref="S3.SS1.p2.11.m1.9.9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.9.9.1.1.1.cmml" xref="S3.SS1.p2.11.m1.9.9.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m1.9.9.1.1.2.cmml" xref="S3.SS1.p2.11.m1.9.9.1.1.2">𝑊</ci><list id="S3.SS1.p2.11.m1.2.2.2.3.cmml" xref="S3.SS1.p2.11.m1.2.2.2.2"><apply id="S3.SS1.p2.11.m1.2.2.2.2.1.cmml" xref="S3.SS1.p2.11.m1.2.2.2.2.1"><times id="S3.SS1.p2.11.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p2.11.m1.2.2.2.2.1.1"></times><ci id="S3.SS1.p2.11.m1.2.2.2.2.1.2.cmml" xref="S3.SS1.p2.11.m1.2.2.2.2.1.2">𝑓</ci><ci id="S3.SS1.p2.11.m1.2.2.2.2.1.3.cmml" xref="S3.SS1.p2.11.m1.2.2.2.2.1.3">𝑢</ci></apply><ci id="S3.SS1.p2.11.m1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m1.1.1.1.1">𝑛</ci></list></apply><apply id="S3.SS1.p2.11.m1.10.10.2.2.cmml" xref="S3.SS1.p2.11.m1.10.10.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.10.10.2.2.1.cmml" xref="S3.SS1.p2.11.m1.10.10.2.2">subscript</csymbol><ci id="S3.SS1.p2.11.m1.10.10.2.2.2.cmml" xref="S3.SS1.p2.11.m1.10.10.2.2.2">𝑏</ci><list id="S3.SS1.p2.11.m1.4.4.2.3.cmml" xref="S3.SS1.p2.11.m1.4.4.2.2"><apply id="S3.SS1.p2.11.m1.4.4.2.2.1.cmml" xref="S3.SS1.p2.11.m1.4.4.2.2.1"><times id="S3.SS1.p2.11.m1.4.4.2.2.1.1.cmml" xref="S3.SS1.p2.11.m1.4.4.2.2.1.1"></times><ci id="S3.SS1.p2.11.m1.4.4.2.2.1.2.cmml" xref="S3.SS1.p2.11.m1.4.4.2.2.1.2">𝑓</ci><ci id="S3.SS1.p2.11.m1.4.4.2.2.1.3.cmml" xref="S3.SS1.p2.11.m1.4.4.2.2.1.3">𝑢</ci></apply><ci id="S3.SS1.p2.11.m1.3.3.1.1.cmml" xref="S3.SS1.p2.11.m1.3.3.1.1">𝑛</ci></list></apply><apply id="S3.SS1.p2.11.m1.11.11.3.3.cmml" xref="S3.SS1.p2.11.m1.11.11.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.11.11.3.3.1.cmml" xref="S3.SS1.p2.11.m1.11.11.3.3">subscript</csymbol><ci id="S3.SS1.p2.11.m1.11.11.3.3.2.cmml" xref="S3.SS1.p2.11.m1.11.11.3.3.2">𝑊</ci><list id="S3.SS1.p2.11.m1.6.6.2.3.cmml" xref="S3.SS1.p2.11.m1.6.6.2.2"><apply id="S3.SS1.p2.11.m1.6.6.2.2.1.cmml" xref="S3.SS1.p2.11.m1.6.6.2.2.1"><times id="S3.SS1.p2.11.m1.6.6.2.2.1.1.cmml" xref="S3.SS1.p2.11.m1.6.6.2.2.1.1"></times><ci id="S3.SS1.p2.11.m1.6.6.2.2.1.2.cmml" xref="S3.SS1.p2.11.m1.6.6.2.2.1.2">𝑓</ci><ci id="S3.SS1.p2.11.m1.6.6.2.2.1.3.cmml" xref="S3.SS1.p2.11.m1.6.6.2.2.1.3">𝑖</ci></apply><ci id="S3.SS1.p2.11.m1.5.5.1.1.cmml" xref="S3.SS1.p2.11.m1.5.5.1.1">𝑚</ci></list></apply><apply id="S3.SS1.p2.11.m1.12.12.4.4.cmml" xref="S3.SS1.p2.11.m1.12.12.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m1.12.12.4.4.1.cmml" xref="S3.SS1.p2.11.m1.12.12.4.4">subscript</csymbol><ci id="S3.SS1.p2.11.m1.12.12.4.4.2.cmml" xref="S3.SS1.p2.11.m1.12.12.4.4.2">𝑏</ci><list id="S3.SS1.p2.11.m1.8.8.2.3.cmml" xref="S3.SS1.p2.11.m1.8.8.2.2"><apply id="S3.SS1.p2.11.m1.8.8.2.2.1.cmml" xref="S3.SS1.p2.11.m1.8.8.2.2.1"><times id="S3.SS1.p2.11.m1.8.8.2.2.1.1.cmml" xref="S3.SS1.p2.11.m1.8.8.2.2.1.1"></times><ci id="S3.SS1.p2.11.m1.8.8.2.2.1.2.cmml" xref="S3.SS1.p2.11.m1.8.8.2.2.1.2">𝑓</ci><ci id="S3.SS1.p2.11.m1.8.8.2.2.1.3.cmml" xref="S3.SS1.p2.11.m1.8.8.2.2.1.3">𝑖</ci></apply><ci id="S3.SS1.p2.11.m1.7.7.1.1.cmml" xref="S3.SS1.p2.11.m1.7.7.1.1">𝑚</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m1.12c">W_{fu,n},b_{fu,n},W_{fi,m},b_{fi,m}</annotation></semantics></math> are network parameters of the linear layer, and <math id="S3.SS1.p2.12.m2.1" class="ltx_Math" alttext="\text{FeatureCrossing}({\mathbf{x}}_{0})" display="inline"><semantics id="S3.SS1.p2.12.m2.1a"><mrow id="S3.SS1.p2.12.m2.1.1" xref="S3.SS1.p2.12.m2.1.1.cmml"><mtext id="S3.SS1.p2.12.m2.1.1.3" xref="S3.SS1.p2.12.m2.1.1.3a.cmml">FeatureCrossing</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p2.12.m2.1.1.2" xref="S3.SS1.p2.12.m2.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.12.m2.1.1.1.1" xref="S3.SS1.p2.12.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.12.m2.1.1.1.1.2" xref="S3.SS1.p2.12.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.12.m2.1.1.1.1.1" xref="S3.SS1.p2.12.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.12.m2.1.1.1.1.1.2" xref="S3.SS1.p2.12.m2.1.1.1.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p2.12.m2.1.1.1.1.1.3" xref="S3.SS1.p2.12.m2.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S3.SS1.p2.12.m2.1.1.1.1.3" xref="S3.SS1.p2.12.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m2.1b"><apply id="S3.SS1.p2.12.m2.1.1.cmml" xref="S3.SS1.p2.12.m2.1.1"><times id="S3.SS1.p2.12.m2.1.1.2.cmml" xref="S3.SS1.p2.12.m2.1.1.2"></times><ci id="S3.SS1.p2.12.m2.1.1.3a.cmml" xref="S3.SS1.p2.12.m2.1.1.3"><mtext id="S3.SS1.p2.12.m2.1.1.3.cmml" xref="S3.SS1.p2.12.m2.1.1.3">FeatureCrossing</mtext></ci><apply id="S3.SS1.p2.12.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.12.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.12.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.12.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.12.m2.1.1.1.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p2.12.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.12.m2.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m2.1c">\text{FeatureCrossing}({\mathbf{x}}_{0})</annotation></semantics></math> is the feature crossing network that mixes the information in <math id="S3.SS1.p2.13.m3.1" class="ltx_Math" alttext="{\mathbf{x}}_{0}" display="inline"><semantics id="S3.SS1.p2.13.m3.1a"><msub id="S3.SS1.p2.13.m3.1.1" xref="S3.SS1.p2.13.m3.1.1.cmml"><mi id="S3.SS1.p2.13.m3.1.1.2" xref="S3.SS1.p2.13.m3.1.1.2.cmml">𝐱</mi><mn id="S3.SS1.p2.13.m3.1.1.3" xref="S3.SS1.p2.13.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m3.1b"><apply id="S3.SS1.p2.13.m3.1.1.cmml" xref="S3.SS1.p2.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m3.1.1.1.cmml" xref="S3.SS1.p2.13.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m3.1.1.2.cmml" xref="S3.SS1.p2.13.m3.1.1.2">𝐱</ci><cn type="integer" id="S3.SS1.p2.13.m3.1.1.3.cmml" xref="S3.SS1.p2.13.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m3.1c">{\mathbf{x}}_{0}</annotation></semantics></math> across dimensions. The feature crossing network consists of <math id="S3.SS1.p2.14.m4.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p2.14.m4.1a"><mi id="S3.SS1.p2.14.m4.1.1" xref="S3.SS1.p2.14.m4.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m4.1b"><ci id="S3.SS1.p2.14.m4.1.1.cmml" xref="S3.SS1.p2.14.m4.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m4.1c">L</annotation></semantics></math> feature crossing layers and the output <math id="S3.SS1.p2.15.m5.1" class="ltx_Math" alttext="\mathbf{x}_{l+1}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.15.m5.1a"><mrow id="S3.SS1.p2.15.m5.1.1" xref="S3.SS1.p2.15.m5.1.1.cmml"><msub id="S3.SS1.p2.15.m5.1.1.2" xref="S3.SS1.p2.15.m5.1.1.2.cmml"><mi id="S3.SS1.p2.15.m5.1.1.2.2" xref="S3.SS1.p2.15.m5.1.1.2.2.cmml">𝐱</mi><mrow id="S3.SS1.p2.15.m5.1.1.2.3" xref="S3.SS1.p2.15.m5.1.1.2.3.cmml"><mi id="S3.SS1.p2.15.m5.1.1.2.3.2" xref="S3.SS1.p2.15.m5.1.1.2.3.2.cmml">l</mi><mo id="S3.SS1.p2.15.m5.1.1.2.3.1" xref="S3.SS1.p2.15.m5.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p2.15.m5.1.1.2.3.3" xref="S3.SS1.p2.15.m5.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p2.15.m5.1.1.1" xref="S3.SS1.p2.15.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.15.m5.1.1.3" xref="S3.SS1.p2.15.m5.1.1.3.cmml"><mi id="S3.SS1.p2.15.m5.1.1.3.2" xref="S3.SS1.p2.15.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.15.m5.1.1.3.3" xref="S3.SS1.p2.15.m5.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m5.1b"><apply id="S3.SS1.p2.15.m5.1.1.cmml" xref="S3.SS1.p2.15.m5.1.1"><in id="S3.SS1.p2.15.m5.1.1.1.cmml" xref="S3.SS1.p2.15.m5.1.1.1"></in><apply id="S3.SS1.p2.15.m5.1.1.2.cmml" xref="S3.SS1.p2.15.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m5.1.1.2.1.cmml" xref="S3.SS1.p2.15.m5.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.15.m5.1.1.2.2.cmml" xref="S3.SS1.p2.15.m5.1.1.2.2">𝐱</ci><apply id="S3.SS1.p2.15.m5.1.1.2.3.cmml" xref="S3.SS1.p2.15.m5.1.1.2.3"><plus id="S3.SS1.p2.15.m5.1.1.2.3.1.cmml" xref="S3.SS1.p2.15.m5.1.1.2.3.1"></plus><ci id="S3.SS1.p2.15.m5.1.1.2.3.2.cmml" xref="S3.SS1.p2.15.m5.1.1.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.15.m5.1.1.2.3.3.cmml" xref="S3.SS1.p2.15.m5.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.15.m5.1.1.3.cmml" xref="S3.SS1.p2.15.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.15.m5.1.1.3.1.cmml" xref="S3.SS1.p2.15.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.15.m5.1.1.3.2.cmml" xref="S3.SS1.p2.15.m5.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.15.m5.1.1.3.3.cmml" xref="S3.SS1.p2.15.m5.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m5.1c">\mathbf{x}_{l+1}\in\mathbb{R}^{d}</annotation></semantics></math> of layer <math id="S3.SS1.p2.16.m6.1" class="ltx_Math" alttext="l+1" display="inline"><semantics id="S3.SS1.p2.16.m6.1a"><mrow id="S3.SS1.p2.16.m6.1.1" xref="S3.SS1.p2.16.m6.1.1.cmml"><mi id="S3.SS1.p2.16.m6.1.1.2" xref="S3.SS1.p2.16.m6.1.1.2.cmml">l</mi><mo id="S3.SS1.p2.16.m6.1.1.1" xref="S3.SS1.p2.16.m6.1.1.1.cmml">+</mo><mn id="S3.SS1.p2.16.m6.1.1.3" xref="S3.SS1.p2.16.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m6.1b"><apply id="S3.SS1.p2.16.m6.1.1.cmml" xref="S3.SS1.p2.16.m6.1.1"><plus id="S3.SS1.p2.16.m6.1.1.1.cmml" xref="S3.SS1.p2.16.m6.1.1.1"></plus><ci id="S3.SS1.p2.16.m6.1.1.2.cmml" xref="S3.SS1.p2.16.m6.1.1.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.16.m6.1.1.3.cmml" xref="S3.SS1.p2.16.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m6.1c">l+1</annotation></semantics></math> is obtained by <math id="S3.SS1.p2.17.m7.1" class="ltx_Math" alttext="\mathbf{x}_{l+1}=\mathbf{x}_{0}\mathbf{x}_{l}^{\top}\mathbf{w}_{l}+\mathbf{b}_{l}+\mathbf{x}_{l}" display="inline"><semantics id="S3.SS1.p2.17.m7.1a"><mrow id="S3.SS1.p2.17.m7.1.1" xref="S3.SS1.p2.17.m7.1.1.cmml"><msub id="S3.SS1.p2.17.m7.1.1.2" xref="S3.SS1.p2.17.m7.1.1.2.cmml"><mi id="S3.SS1.p2.17.m7.1.1.2.2" xref="S3.SS1.p2.17.m7.1.1.2.2.cmml">𝐱</mi><mrow id="S3.SS1.p2.17.m7.1.1.2.3" xref="S3.SS1.p2.17.m7.1.1.2.3.cmml"><mi id="S3.SS1.p2.17.m7.1.1.2.3.2" xref="S3.SS1.p2.17.m7.1.1.2.3.2.cmml">l</mi><mo id="S3.SS1.p2.17.m7.1.1.2.3.1" xref="S3.SS1.p2.17.m7.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p2.17.m7.1.1.2.3.3" xref="S3.SS1.p2.17.m7.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS1.p2.17.m7.1.1.1" xref="S3.SS1.p2.17.m7.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.17.m7.1.1.3" xref="S3.SS1.p2.17.m7.1.1.3.cmml"><mrow id="S3.SS1.p2.17.m7.1.1.3.2" xref="S3.SS1.p2.17.m7.1.1.3.2.cmml"><msub id="S3.SS1.p2.17.m7.1.1.3.2.2" xref="S3.SS1.p2.17.m7.1.1.3.2.2.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.2.2.2" xref="S3.SS1.p2.17.m7.1.1.3.2.2.2.cmml">𝐱</mi><mn id="S3.SS1.p2.17.m7.1.1.3.2.2.3" xref="S3.SS1.p2.17.m7.1.1.3.2.2.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.17.m7.1.1.3.2.1" xref="S3.SS1.p2.17.m7.1.1.3.2.1.cmml">​</mo><msubsup id="S3.SS1.p2.17.m7.1.1.3.2.3" xref="S3.SS1.p2.17.m7.1.1.3.2.3.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.2.3.2.2" xref="S3.SS1.p2.17.m7.1.1.3.2.3.2.2.cmml">𝐱</mi><mi id="S3.SS1.p2.17.m7.1.1.3.2.3.2.3" xref="S3.SS1.p2.17.m7.1.1.3.2.3.2.3.cmml">l</mi><mo id="S3.SS1.p2.17.m7.1.1.3.2.3.3" xref="S3.SS1.p2.17.m7.1.1.3.2.3.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.17.m7.1.1.3.2.1a" xref="S3.SS1.p2.17.m7.1.1.3.2.1.cmml">​</mo><msub id="S3.SS1.p2.17.m7.1.1.3.2.4" xref="S3.SS1.p2.17.m7.1.1.3.2.4.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.2.4.2" xref="S3.SS1.p2.17.m7.1.1.3.2.4.2.cmml">𝐰</mi><mi id="S3.SS1.p2.17.m7.1.1.3.2.4.3" xref="S3.SS1.p2.17.m7.1.1.3.2.4.3.cmml">l</mi></msub></mrow><mo id="S3.SS1.p2.17.m7.1.1.3.1" xref="S3.SS1.p2.17.m7.1.1.3.1.cmml">+</mo><msub id="S3.SS1.p2.17.m7.1.1.3.3" xref="S3.SS1.p2.17.m7.1.1.3.3.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.3.2" xref="S3.SS1.p2.17.m7.1.1.3.3.2.cmml">𝐛</mi><mi id="S3.SS1.p2.17.m7.1.1.3.3.3" xref="S3.SS1.p2.17.m7.1.1.3.3.3.cmml">l</mi></msub><mo id="S3.SS1.p2.17.m7.1.1.3.1a" xref="S3.SS1.p2.17.m7.1.1.3.1.cmml">+</mo><msub id="S3.SS1.p2.17.m7.1.1.3.4" xref="S3.SS1.p2.17.m7.1.1.3.4.cmml"><mi id="S3.SS1.p2.17.m7.1.1.3.4.2" xref="S3.SS1.p2.17.m7.1.1.3.4.2.cmml">𝐱</mi><mi id="S3.SS1.p2.17.m7.1.1.3.4.3" xref="S3.SS1.p2.17.m7.1.1.3.4.3.cmml">l</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m7.1b"><apply id="S3.SS1.p2.17.m7.1.1.cmml" xref="S3.SS1.p2.17.m7.1.1"><eq id="S3.SS1.p2.17.m7.1.1.1.cmml" xref="S3.SS1.p2.17.m7.1.1.1"></eq><apply id="S3.SS1.p2.17.m7.1.1.2.cmml" xref="S3.SS1.p2.17.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.2.1.cmml" xref="S3.SS1.p2.17.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.2.2.cmml" xref="S3.SS1.p2.17.m7.1.1.2.2">𝐱</ci><apply id="S3.SS1.p2.17.m7.1.1.2.3.cmml" xref="S3.SS1.p2.17.m7.1.1.2.3"><plus id="S3.SS1.p2.17.m7.1.1.2.3.1.cmml" xref="S3.SS1.p2.17.m7.1.1.2.3.1"></plus><ci id="S3.SS1.p2.17.m7.1.1.2.3.2.cmml" xref="S3.SS1.p2.17.m7.1.1.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.17.m7.1.1.2.3.3.cmml" xref="S3.SS1.p2.17.m7.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.17.m7.1.1.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3"><plus id="S3.SS1.p2.17.m7.1.1.3.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.1"></plus><apply id="S3.SS1.p2.17.m7.1.1.3.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2"><times id="S3.SS1.p2.17.m7.1.1.3.2.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.1"></times><apply id="S3.SS1.p2.17.m7.1.1.3.2.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.2.2.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.2">subscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.3.2.2.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.2.2">𝐱</ci><cn type="integer" id="S3.SS1.p2.17.m7.1.1.3.2.2.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.2.3">0</cn></apply><apply id="S3.SS1.p2.17.m7.1.1.3.2.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3">superscript</csymbol><apply id="S3.SS1.p2.17.m7.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.2.3.2.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.3.2.3.2.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3.2.2">𝐱</ci><ci id="S3.SS1.p2.17.m7.1.1.3.2.3.2.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3.2.3">𝑙</ci></apply><csymbol cd="latexml" id="S3.SS1.p2.17.m7.1.1.3.2.3.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.3.3">top</csymbol></apply><apply id="S3.SS1.p2.17.m7.1.1.3.2.4.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.2.4.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.4">subscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.3.2.4.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.4.2">𝐰</ci><ci id="S3.SS1.p2.17.m7.1.1.3.2.4.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.2.4.3">𝑙</ci></apply></apply><apply id="S3.SS1.p2.17.m7.1.1.3.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.3.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.3.3.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3.2">𝐛</ci><ci id="S3.SS1.p2.17.m7.1.1.3.3.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.3.3">𝑙</ci></apply><apply id="S3.SS1.p2.17.m7.1.1.3.4.cmml" xref="S3.SS1.p2.17.m7.1.1.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m7.1.1.3.4.1.cmml" xref="S3.SS1.p2.17.m7.1.1.3.4">subscript</csymbol><ci id="S3.SS1.p2.17.m7.1.1.3.4.2.cmml" xref="S3.SS1.p2.17.m7.1.1.3.4.2">𝐱</ci><ci id="S3.SS1.p2.17.m7.1.1.3.4.3.cmml" xref="S3.SS1.p2.17.m7.1.1.3.4.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m7.1c">\mathbf{x}_{l+1}=\mathbf{x}_{0}\mathbf{x}_{l}^{\top}\mathbf{w}_{l}+\mathbf{b}_{l}+\mathbf{x}_{l}</annotation></semantics></math>, where <math id="S3.SS1.p2.18.m8.1" class="ltx_Math" alttext="\mathbf{x}_{l}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.18.m8.1a"><mrow id="S3.SS1.p2.18.m8.1.1" xref="S3.SS1.p2.18.m8.1.1.cmml"><msub id="S3.SS1.p2.18.m8.1.1.2" xref="S3.SS1.p2.18.m8.1.1.2.cmml"><mi id="S3.SS1.p2.18.m8.1.1.2.2" xref="S3.SS1.p2.18.m8.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS1.p2.18.m8.1.1.2.3" xref="S3.SS1.p2.18.m8.1.1.2.3.cmml">l</mi></msub><mo id="S3.SS1.p2.18.m8.1.1.1" xref="S3.SS1.p2.18.m8.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.18.m8.1.1.3" xref="S3.SS1.p2.18.m8.1.1.3.cmml"><mi id="S3.SS1.p2.18.m8.1.1.3.2" xref="S3.SS1.p2.18.m8.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.18.m8.1.1.3.3" xref="S3.SS1.p2.18.m8.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m8.1b"><apply id="S3.SS1.p2.18.m8.1.1.cmml" xref="S3.SS1.p2.18.m8.1.1"><in id="S3.SS1.p2.18.m8.1.1.1.cmml" xref="S3.SS1.p2.18.m8.1.1.1"></in><apply id="S3.SS1.p2.18.m8.1.1.2.cmml" xref="S3.SS1.p2.18.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m8.1.1.2.1.cmml" xref="S3.SS1.p2.18.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.18.m8.1.1.2.2.cmml" xref="S3.SS1.p2.18.m8.1.1.2.2">𝐱</ci><ci id="S3.SS1.p2.18.m8.1.1.2.3.cmml" xref="S3.SS1.p2.18.m8.1.1.2.3">𝑙</ci></apply><apply id="S3.SS1.p2.18.m8.1.1.3.cmml" xref="S3.SS1.p2.18.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.18.m8.1.1.3.1.cmml" xref="S3.SS1.p2.18.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.18.m8.1.1.3.2.cmml" xref="S3.SS1.p2.18.m8.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.18.m8.1.1.3.3.cmml" xref="S3.SS1.p2.18.m8.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m8.1c">\mathbf{x}_{l}\in\mathbb{R}^{d}</annotation></semantics></math> is the output of layer <math id="S3.SS1.p2.19.m9.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.19.m9.1a"><mi id="S3.SS1.p2.19.m9.1.1" xref="S3.SS1.p2.19.m9.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m9.1b"><ci id="S3.SS1.p2.19.m9.1.1.cmml" xref="S3.SS1.p2.19.m9.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m9.1c">l</annotation></semantics></math>, and <math id="S3.SS1.p2.20.m10.2" class="ltx_Math" alttext="\mathbf{w}_{l},\mathbf{b}_{l}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.SS1.p2.20.m10.2a"><mrow id="S3.SS1.p2.20.m10.2.2" xref="S3.SS1.p2.20.m10.2.2.cmml"><mrow id="S3.SS1.p2.20.m10.2.2.2.2" xref="S3.SS1.p2.20.m10.2.2.2.3.cmml"><msub id="S3.SS1.p2.20.m10.1.1.1.1.1" xref="S3.SS1.p2.20.m10.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.20.m10.1.1.1.1.1.2" xref="S3.SS1.p2.20.m10.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.20.m10.1.1.1.1.1.3" xref="S3.SS1.p2.20.m10.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S3.SS1.p2.20.m10.2.2.2.2.3" xref="S3.SS1.p2.20.m10.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p2.20.m10.2.2.2.2.2" xref="S3.SS1.p2.20.m10.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.20.m10.2.2.2.2.2.2" xref="S3.SS1.p2.20.m10.2.2.2.2.2.2.cmml">𝐛</mi><mi id="S3.SS1.p2.20.m10.2.2.2.2.2.3" xref="S3.SS1.p2.20.m10.2.2.2.2.2.3.cmml">l</mi></msub></mrow><mo id="S3.SS1.p2.20.m10.2.2.3" xref="S3.SS1.p2.20.m10.2.2.3.cmml">∈</mo><msup id="S3.SS1.p2.20.m10.2.2.4" xref="S3.SS1.p2.20.m10.2.2.4.cmml"><mi id="S3.SS1.p2.20.m10.2.2.4.2" xref="S3.SS1.p2.20.m10.2.2.4.2.cmml">ℝ</mi><mi id="S3.SS1.p2.20.m10.2.2.4.3" xref="S3.SS1.p2.20.m10.2.2.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.20.m10.2b"><apply id="S3.SS1.p2.20.m10.2.2.cmml" xref="S3.SS1.p2.20.m10.2.2"><in id="S3.SS1.p2.20.m10.2.2.3.cmml" xref="S3.SS1.p2.20.m10.2.2.3"></in><list id="S3.SS1.p2.20.m10.2.2.2.3.cmml" xref="S3.SS1.p2.20.m10.2.2.2.2"><apply id="S3.SS1.p2.20.m10.1.1.1.1.1.cmml" xref="S3.SS1.p2.20.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m10.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.20.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.20.m10.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.20.m10.1.1.1.1.1.2">𝐰</ci><ci id="S3.SS1.p2.20.m10.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.20.m10.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS1.p2.20.m10.2.2.2.2.2.cmml" xref="S3.SS1.p2.20.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m10.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.20.m10.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.20.m10.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.20.m10.2.2.2.2.2.2">𝐛</ci><ci id="S3.SS1.p2.20.m10.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.20.m10.2.2.2.2.2.3">𝑙</ci></apply></list><apply id="S3.SS1.p2.20.m10.2.2.4.cmml" xref="S3.SS1.p2.20.m10.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m10.2.2.4.1.cmml" xref="S3.SS1.p2.20.m10.2.2.4">superscript</csymbol><ci id="S3.SS1.p2.20.m10.2.2.4.2.cmml" xref="S3.SS1.p2.20.m10.2.2.4.2">ℝ</ci><ci id="S3.SS1.p2.20.m10.2.2.4.3.cmml" xref="S3.SS1.p2.20.m10.2.2.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.20.m10.2c">\mathbf{w}_{l},\mathbf{b}_{l}\in\mathbb{R}^{d}</annotation></semantics></math> are parameters of layer <math id="S3.SS1.p2.21.m11.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.21.m11.1a"><mi id="S3.SS1.p2.21.m11.1.1" xref="S3.SS1.p2.21.m11.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.21.m11.1b"><ci id="S3.SS1.p2.21.m11.1.1.cmml" xref="S3.SS1.p2.21.m11.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.21.m11.1c">l</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.2" class="ltx_p">After getting these cross feature embeddings of attributes, we use an attention network to incorporate the attribute into the collaborative information:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.33" class="ltx_Math" alttext="\begin{split}&amp;E_{attu,n}=\text{Attention}(E_{fu,n},E_{fcu,n},E_{idu,n}),\\
&amp;E_{atti,m}=\text{Attention}(E_{fi,m},E_{fci,m},E_{idi,m}),\end{split}" display="block"><semantics id="S3.E2.m1.33a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E2.m1.33.33.3"><mtr id="S3.E2.m1.33.33.3a"><mtd id="S3.E2.m1.33.33.3b"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.33.33.3c"><mrow id="S3.E2.m1.32.32.2.31.16.16.16"><mrow id="S3.E2.m1.32.32.2.31.16.16.16.1"><msub id="S3.E2.m1.32.32.2.31.16.16.16.1.4"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">E</mi><mrow id="S3.E2.m1.2.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.3.cmml"><mrow id="S3.E2.m1.2.2.2.2.2.2.1.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.1.2.1.2" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.1.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.2.1.3" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.1.2.1.1a" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.2.1.4" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.2.2.1.2.1.1b" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.2.1.5" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.5.cmml">u</mi></mrow><mo id="S3.E2.m1.2.2.2.2.2.2.1.2.2" xref="S3.E2.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.2.1.1.cmml">n</mi></mrow></msub><mo id="S3.E2.m1.3.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E2.m1.32.32.2.31.16.16.16.1.3"><mtext id="S3.E2.m1.4.4.4.4.4.4" xref="S3.E2.m1.4.4.4.4.4.4a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.32.32.2.31.16.16.16.1.3.4">​</mo><mrow id="S3.E2.m1.32.32.2.31.16.16.16.1.3.3.3"><mo stretchy="false" id="S3.E2.m1.5.5.5.5.5.5">(</mo><msub id="S3.E2.m1.32.32.2.31.16.16.16.1.1.1.1.1"><mi id="S3.E2.m1.6.6.6.6.6.6" xref="S3.E2.m1.6.6.6.6.6.6.cmml">E</mi><mrow id="S3.E2.m1.7.7.7.7.7.7.1.2" xref="S3.E2.m1.7.7.7.7.7.7.1.3.cmml"><mrow id="S3.E2.m1.7.7.7.7.7.7.1.2.1" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.cmml"><mi id="S3.E2.m1.7.7.7.7.7.7.1.2.1.2" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.7.7.7.7.1.2.1.1" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.7.7.7.7.7.7.1.2.1.3" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.3.cmml">u</mi></mrow><mo id="S3.E2.m1.7.7.7.7.7.7.1.2.2" xref="S3.E2.m1.7.7.7.7.7.7.1.3.cmml">,</mo><mi id="S3.E2.m1.7.7.7.7.7.7.1.1" xref="S3.E2.m1.7.7.7.7.7.7.1.1.cmml">n</mi></mrow></msub><mo id="S3.E2.m1.8.8.8.8.8.8">,</mo><msub id="S3.E2.m1.32.32.2.31.16.16.16.1.2.2.2.2"><mi id="S3.E2.m1.9.9.9.9.9.9" xref="S3.E2.m1.9.9.9.9.9.9.cmml">E</mi><mrow id="S3.E2.m1.10.10.10.10.10.10.1.2" xref="S3.E2.m1.10.10.10.10.10.10.1.3.cmml"><mrow id="S3.E2.m1.10.10.10.10.10.10.1.2.1" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.cmml"><mi id="S3.E2.m1.10.10.10.10.10.10.1.2.1.2" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.10.10.10.10.1.2.1.1" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.10.10.10.10.10.10.1.2.1.3" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.10.10.10.10.10.10.1.2.1.1a" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.10.10.10.10.10.10.1.2.1.4" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.4.cmml">u</mi></mrow><mo id="S3.E2.m1.10.10.10.10.10.10.1.2.2" xref="S3.E2.m1.10.10.10.10.10.10.1.3.cmml">,</mo><mi id="S3.E2.m1.10.10.10.10.10.10.1.1" xref="S3.E2.m1.10.10.10.10.10.10.1.1.cmml">n</mi></mrow></msub><mo id="S3.E2.m1.11.11.11.11.11.11">,</mo><msub id="S3.E2.m1.32.32.2.31.16.16.16.1.3.3.3.3"><mi id="S3.E2.m1.12.12.12.12.12.12" xref="S3.E2.m1.12.12.12.12.12.12.cmml">E</mi><mrow id="S3.E2.m1.13.13.13.13.13.13.1.2" xref="S3.E2.m1.13.13.13.13.13.13.1.3.cmml"><mrow id="S3.E2.m1.13.13.13.13.13.13.1.2.1" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.cmml"><mi id="S3.E2.m1.13.13.13.13.13.13.1.2.1.2" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.13.13.13.13.13.13.1.2.1.1" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.13.13.13.13.13.13.1.2.1.3" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.13.13.13.13.13.13.1.2.1.1a" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.13.13.13.13.13.13.1.2.1.4" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.4.cmml">u</mi></mrow><mo id="S3.E2.m1.13.13.13.13.13.13.1.2.2" xref="S3.E2.m1.13.13.13.13.13.13.1.3.cmml">,</mo><mi id="S3.E2.m1.13.13.13.13.13.13.1.1" xref="S3.E2.m1.13.13.13.13.13.13.1.1.cmml">n</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.14.14.14.14.14.14">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.15.15.15.15.15.15">,</mo></mrow></mtd></mtr><mtr id="S3.E2.m1.33.33.3d"><mtd id="S3.E2.m1.33.33.3e"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E2.m1.33.33.3f"><mrow id="S3.E2.m1.33.33.3.32.16.16.16"><mrow id="S3.E2.m1.33.33.3.32.16.16.16.1"><msub id="S3.E2.m1.33.33.3.32.16.16.16.1.4"><mi id="S3.E2.m1.16.16.16.1.1.1" xref="S3.E2.m1.16.16.16.1.1.1.cmml">E</mi><mrow id="S3.E2.m1.17.17.17.2.2.2.1.2" xref="S3.E2.m1.17.17.17.2.2.2.1.3.cmml"><mrow id="S3.E2.m1.17.17.17.2.2.2.1.2.1" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.cmml"><mi id="S3.E2.m1.17.17.17.2.2.2.1.2.1.2" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.17.17.17.2.2.2.1.2.1.1" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.17.17.17.2.2.2.1.2.1.3" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.17.17.17.2.2.2.1.2.1.1a" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.17.17.17.2.2.2.1.2.1.4" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.17.17.17.2.2.2.1.2.1.1b" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.17.17.17.2.2.2.1.2.1.5" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.5.cmml">i</mi></mrow><mo id="S3.E2.m1.17.17.17.2.2.2.1.2.2" xref="S3.E2.m1.17.17.17.2.2.2.1.3.cmml">,</mo><mi id="S3.E2.m1.17.17.17.2.2.2.1.1" xref="S3.E2.m1.17.17.17.2.2.2.1.1.cmml">m</mi></mrow></msub><mo id="S3.E2.m1.18.18.18.3.3.3" xref="S3.E2.m1.18.18.18.3.3.3.cmml">=</mo><mrow id="S3.E2.m1.33.33.3.32.16.16.16.1.3"><mtext id="S3.E2.m1.19.19.19.4.4.4" xref="S3.E2.m1.19.19.19.4.4.4a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.33.33.3.32.16.16.16.1.3.4">​</mo><mrow id="S3.E2.m1.33.33.3.32.16.16.16.1.3.3.3"><mo stretchy="false" id="S3.E2.m1.20.20.20.5.5.5">(</mo><msub id="S3.E2.m1.33.33.3.32.16.16.16.1.1.1.1.1"><mi id="S3.E2.m1.21.21.21.6.6.6" xref="S3.E2.m1.21.21.21.6.6.6.cmml">E</mi><mrow id="S3.E2.m1.22.22.22.7.7.7.1.2" xref="S3.E2.m1.22.22.22.7.7.7.1.3.cmml"><mrow id="S3.E2.m1.22.22.22.7.7.7.1.2.1" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.cmml"><mi id="S3.E2.m1.22.22.22.7.7.7.1.2.1.2" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.22.22.22.7.7.7.1.2.1.1" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.22.22.22.7.7.7.1.2.1.3" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.3.cmml">i</mi></mrow><mo id="S3.E2.m1.22.22.22.7.7.7.1.2.2" xref="S3.E2.m1.22.22.22.7.7.7.1.3.cmml">,</mo><mi id="S3.E2.m1.22.22.22.7.7.7.1.1" xref="S3.E2.m1.22.22.22.7.7.7.1.1.cmml">m</mi></mrow></msub><mo id="S3.E2.m1.23.23.23.8.8.8">,</mo><msub id="S3.E2.m1.33.33.3.32.16.16.16.1.2.2.2.2"><mi id="S3.E2.m1.24.24.24.9.9.9" xref="S3.E2.m1.24.24.24.9.9.9.cmml">E</mi><mrow id="S3.E2.m1.25.25.25.10.10.10.1.2" xref="S3.E2.m1.25.25.25.10.10.10.1.3.cmml"><mrow id="S3.E2.m1.25.25.25.10.10.10.1.2.1" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.cmml"><mi id="S3.E2.m1.25.25.25.10.10.10.1.2.1.2" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.25.25.25.10.10.10.1.2.1.1" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.25.25.25.10.10.10.1.2.1.3" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.25.25.25.10.10.10.1.2.1.1a" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.25.25.25.10.10.10.1.2.1.4" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.4.cmml">i</mi></mrow><mo id="S3.E2.m1.25.25.25.10.10.10.1.2.2" xref="S3.E2.m1.25.25.25.10.10.10.1.3.cmml">,</mo><mi id="S3.E2.m1.25.25.25.10.10.10.1.1" xref="S3.E2.m1.25.25.25.10.10.10.1.1.cmml">m</mi></mrow></msub><mo id="S3.E2.m1.26.26.26.11.11.11">,</mo><msub id="S3.E2.m1.33.33.3.32.16.16.16.1.3.3.3.3"><mi id="S3.E2.m1.27.27.27.12.12.12" xref="S3.E2.m1.27.27.27.12.12.12.cmml">E</mi><mrow id="S3.E2.m1.28.28.28.13.13.13.1.2" xref="S3.E2.m1.28.28.28.13.13.13.1.3.cmml"><mrow id="S3.E2.m1.28.28.28.13.13.13.1.2.1" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.cmml"><mi id="S3.E2.m1.28.28.28.13.13.13.1.2.1.2" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.28.28.28.13.13.13.1.2.1.1" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.28.28.28.13.13.13.1.2.1.3" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.28.28.28.13.13.13.1.2.1.1a" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.1.cmml">​</mo><mi id="S3.E2.m1.28.28.28.13.13.13.1.2.1.4" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.4.cmml">i</mi></mrow><mo id="S3.E2.m1.28.28.28.13.13.13.1.2.2" xref="S3.E2.m1.28.28.28.13.13.13.1.3.cmml">,</mo><mi id="S3.E2.m1.28.28.28.13.13.13.1.1" xref="S3.E2.m1.28.28.28.13.13.13.1.1.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.29.29.29.14.14.14">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.30.30.30.15.15.15">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.33b"><apply id="S3.E2.m1.31.31.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E2.m1.31.31.1.1.1.1.1.cmml"><eq id="S3.E2.m1.3.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3"></eq><apply id="S3.E2.m1.31.31.1.1.1.1.1.5.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.1.1.5.1.cmml">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝐸</ci><list id="S3.E2.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2"><apply id="S3.E2.m1.2.2.2.2.2.2.1.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1"><times id="S3.E2.m1.2.2.2.2.2.2.1.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.1"></times><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.2">𝑎</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.3">𝑡</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.1.4.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.4">𝑡</ci><ci id="S3.E2.m1.2.2.2.2.2.2.1.2.1.5.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.2.1.5">𝑢</ci></apply><ci id="S3.E2.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1.1">𝑛</ci></list></apply><apply id="S3.E2.m1.31.31.1.1.1.1.1.3.cmml"><times id="S3.E2.m1.31.31.1.1.1.1.1.3.4.cmml"></times><ci id="S3.E2.m1.4.4.4.4.4.4a.cmml" xref="S3.E2.m1.4.4.4.4.4.4"><mtext id="S3.E2.m1.4.4.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4.4.4">Attention</mtext></ci><vector id="S3.E2.m1.31.31.1.1.1.1.1.3.3.4.cmml"><apply id="S3.E2.m1.31.31.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E2.m1.6.6.6.6.6.6.cmml" xref="S3.E2.m1.6.6.6.6.6.6">𝐸</ci><list id="S3.E2.m1.7.7.7.7.7.7.1.3.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.2"><apply id="S3.E2.m1.7.7.7.7.7.7.1.2.1.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1"><times id="S3.E2.m1.7.7.7.7.7.7.1.2.1.1.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.1"></times><ci id="S3.E2.m1.7.7.7.7.7.7.1.2.1.2.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.2">𝑓</ci><ci id="S3.E2.m1.7.7.7.7.7.7.1.2.1.3.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.2.1.3">𝑢</ci></apply><ci id="S3.E2.m1.7.7.7.7.7.7.1.1.cmml" xref="S3.E2.m1.7.7.7.7.7.7.1.1">𝑛</ci></list></apply><apply id="S3.E2.m1.31.31.1.1.1.1.1.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.1.1.2.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E2.m1.9.9.9.9.9.9.cmml" xref="S3.E2.m1.9.9.9.9.9.9">𝐸</ci><list id="S3.E2.m1.10.10.10.10.10.10.1.3.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.2"><apply id="S3.E2.m1.10.10.10.10.10.10.1.2.1.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1"><times id="S3.E2.m1.10.10.10.10.10.10.1.2.1.1.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.1"></times><ci id="S3.E2.m1.10.10.10.10.10.10.1.2.1.2.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.2">𝑓</ci><ci id="S3.E2.m1.10.10.10.10.10.10.1.2.1.3.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.3">𝑐</ci><ci id="S3.E2.m1.10.10.10.10.10.10.1.2.1.4.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.2.1.4">𝑢</ci></apply><ci id="S3.E2.m1.10.10.10.10.10.10.1.1.cmml" xref="S3.E2.m1.10.10.10.10.10.10.1.1">𝑛</ci></list></apply><apply id="S3.E2.m1.31.31.1.1.1.1.1.3.3.3.3.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.1.1.3.3.3.3.1.cmml">subscript</csymbol><ci id="S3.E2.m1.12.12.12.12.12.12.cmml" xref="S3.E2.m1.12.12.12.12.12.12">𝐸</ci><list id="S3.E2.m1.13.13.13.13.13.13.1.3.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.2"><apply id="S3.E2.m1.13.13.13.13.13.13.1.2.1.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1"><times id="S3.E2.m1.13.13.13.13.13.13.1.2.1.1.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.1"></times><ci id="S3.E2.m1.13.13.13.13.13.13.1.2.1.2.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.2">𝑖</ci><ci id="S3.E2.m1.13.13.13.13.13.13.1.2.1.3.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.3">𝑑</ci><ci id="S3.E2.m1.13.13.13.13.13.13.1.2.1.4.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.2.1.4">𝑢</ci></apply><ci id="S3.E2.m1.13.13.13.13.13.13.1.1.cmml" xref="S3.E2.m1.13.13.13.13.13.13.1.1">𝑛</ci></list></apply></vector></apply></apply><apply id="S3.E2.m1.31.31.1.1.1.2.2.cmml"><eq id="S3.E2.m1.18.18.18.3.3.3.cmml" xref="S3.E2.m1.18.18.18.3.3.3"></eq><apply id="S3.E2.m1.31.31.1.1.1.2.2.5.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.2.2.5.1.cmml">subscript</csymbol><ci id="S3.E2.m1.16.16.16.1.1.1.cmml" xref="S3.E2.m1.16.16.16.1.1.1">𝐸</ci><list id="S3.E2.m1.17.17.17.2.2.2.1.3.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2"><apply id="S3.E2.m1.17.17.17.2.2.2.1.2.1.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1"><times id="S3.E2.m1.17.17.17.2.2.2.1.2.1.1.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.1"></times><ci id="S3.E2.m1.17.17.17.2.2.2.1.2.1.2.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.2">𝑎</ci><ci id="S3.E2.m1.17.17.17.2.2.2.1.2.1.3.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.3">𝑡</ci><ci id="S3.E2.m1.17.17.17.2.2.2.1.2.1.4.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.4">𝑡</ci><ci id="S3.E2.m1.17.17.17.2.2.2.1.2.1.5.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.2.1.5">𝑖</ci></apply><ci id="S3.E2.m1.17.17.17.2.2.2.1.1.cmml" xref="S3.E2.m1.17.17.17.2.2.2.1.1">𝑚</ci></list></apply><apply id="S3.E2.m1.31.31.1.1.1.2.2.3.cmml"><times id="S3.E2.m1.31.31.1.1.1.2.2.3.4.cmml"></times><ci id="S3.E2.m1.19.19.19.4.4.4a.cmml" xref="S3.E2.m1.19.19.19.4.4.4"><mtext id="S3.E2.m1.19.19.19.4.4.4.cmml" xref="S3.E2.m1.19.19.19.4.4.4">Attention</mtext></ci><vector id="S3.E2.m1.31.31.1.1.1.2.2.3.3.4.cmml"><apply id="S3.E2.m1.31.31.1.1.1.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.2.2.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E2.m1.21.21.21.6.6.6.cmml" xref="S3.E2.m1.21.21.21.6.6.6">𝐸</ci><list id="S3.E2.m1.22.22.22.7.7.7.1.3.cmml" xref="S3.E2.m1.22.22.22.7.7.7.1.2"><apply id="S3.E2.m1.22.22.22.7.7.7.1.2.1.cmml" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1"><times id="S3.E2.m1.22.22.22.7.7.7.1.2.1.1.cmml" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.1"></times><ci id="S3.E2.m1.22.22.22.7.7.7.1.2.1.2.cmml" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.2">𝑓</ci><ci id="S3.E2.m1.22.22.22.7.7.7.1.2.1.3.cmml" xref="S3.E2.m1.22.22.22.7.7.7.1.2.1.3">𝑖</ci></apply><ci id="S3.E2.m1.22.22.22.7.7.7.1.1.cmml" xref="S3.E2.m1.22.22.22.7.7.7.1.1">𝑚</ci></list></apply><apply id="S3.E2.m1.31.31.1.1.1.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.2.2.2.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E2.m1.24.24.24.9.9.9.cmml" xref="S3.E2.m1.24.24.24.9.9.9">𝐸</ci><list id="S3.E2.m1.25.25.25.10.10.10.1.3.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.2"><apply id="S3.E2.m1.25.25.25.10.10.10.1.2.1.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1"><times id="S3.E2.m1.25.25.25.10.10.10.1.2.1.1.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.1"></times><ci id="S3.E2.m1.25.25.25.10.10.10.1.2.1.2.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.2">𝑓</ci><ci id="S3.E2.m1.25.25.25.10.10.10.1.2.1.3.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.3">𝑐</ci><ci id="S3.E2.m1.25.25.25.10.10.10.1.2.1.4.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.2.1.4">𝑖</ci></apply><ci id="S3.E2.m1.25.25.25.10.10.10.1.1.cmml" xref="S3.E2.m1.25.25.25.10.10.10.1.1">𝑚</ci></list></apply><apply id="S3.E2.m1.31.31.1.1.1.2.2.3.3.3.3.cmml"><csymbol cd="ambiguous" id="S3.E2.m1.31.31.1.1.1.2.2.3.3.3.3.1.cmml">subscript</csymbol><ci id="S3.E2.m1.27.27.27.12.12.12.cmml" xref="S3.E2.m1.27.27.27.12.12.12">𝐸</ci><list id="S3.E2.m1.28.28.28.13.13.13.1.3.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.2"><apply id="S3.E2.m1.28.28.28.13.13.13.1.2.1.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1"><times id="S3.E2.m1.28.28.28.13.13.13.1.2.1.1.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.1"></times><ci id="S3.E2.m1.28.28.28.13.13.13.1.2.1.2.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.2">𝑖</ci><ci id="S3.E2.m1.28.28.28.13.13.13.1.2.1.3.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.3">𝑑</ci><ci id="S3.E2.m1.28.28.28.13.13.13.1.2.1.4.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.2.1.4">𝑖</ci></apply><ci id="S3.E2.m1.28.28.28.13.13.13.1.1.cmml" xref="S3.E2.m1.28.28.28.13.13.13.1.1">𝑚</ci></list></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.33c">\begin{split}&amp;E_{attu,n}=\text{Attention}(E_{fu,n},E_{fcu,n},E_{idu,n}),\\
&amp;E_{atti,m}=\text{Attention}(E_{fi,m},E_{fci,m},E_{idi,m}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.1" class="ltx_p">where <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\text{Attention}()" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mtext id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">​</mo><mrow id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.3.2.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.3.2.2" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><times id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></times><ci id="S3.SS1.p3.1.m1.1.1.2a.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><mtext id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">Attention</mtext></ci><list id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\text{Attention}()</annotation></semantics></math> is the attention mechanism. One example of the attention mechanism is:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.20" class="ltx_Math" alttext="\begin{split}\text{Attention}(\mathbf{x}_{1},\ldots,\mathbf{x}_{k})=\sum_{i=1}^{k}\frac{\text{exp}(\text{tanh}(W_{i}\mathbf{x}_{i}+b_{i}))}{\sum_{i^{\prime}=1}^{k}\text{exp}(\text{tanh}(W_{i^{\prime}}\mathbf{x}_{i^{\prime}}+b_{i^{\prime}}))}\mathbf{x}_{i}.\end{split}" display="block"><semantics id="S3.E3.m1.20a"><mtable displaystyle="true" id="S3.E3.m1.20.20.2"><mtr id="S3.E3.m1.20.20.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.20.20.2b"><mrow id="S3.E3.m1.20.20.2.19.19.19.19"><mrow id="S3.E3.m1.20.20.2.19.19.19.19.1"><mrow id="S3.E3.m1.20.20.2.19.19.19.19.1.2"><mtext id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1a.cmml">Attention</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.2.19.19.19.19.1.2.3" xref="S3.E3.m1.19.19.1.1.1.cmml">​</mo><mrow id="S3.E3.m1.20.20.2.19.19.19.19.1.2.2.2"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.19.19.1.1.1.cmml">(</mo><msub id="S3.E3.m1.20.20.2.19.19.19.19.1.1.1.1.1"><mi id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml">𝐱</mi><mn id="S3.E3.m1.4.4.4.4.4.4.1" xref="S3.E3.m1.4.4.4.4.4.4.1.cmml">1</mn></msub><mo id="S3.E3.m1.5.5.5.5.5.5" xref="S3.E3.m1.19.19.1.1.1.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.6.6.6.6.6.6" xref="S3.E3.m1.6.6.6.6.6.6.cmml">…</mi><mo id="S3.E3.m1.7.7.7.7.7.7" xref="S3.E3.m1.19.19.1.1.1.cmml">,</mo><msub id="S3.E3.m1.20.20.2.19.19.19.19.1.2.2.2.2"><mi id="S3.E3.m1.8.8.8.8.8.8" xref="S3.E3.m1.8.8.8.8.8.8.cmml">𝐱</mi><mi id="S3.E3.m1.9.9.9.9.9.9.1" xref="S3.E3.m1.9.9.9.9.9.9.1.cmml">k</mi></msub><mo stretchy="false" id="S3.E3.m1.10.10.10.10.10.10" xref="S3.E3.m1.19.19.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E3.m1.11.11.11.11.11.11" xref="S3.E3.m1.11.11.11.11.11.11.cmml">=</mo><mrow id="S3.E3.m1.20.20.2.19.19.19.19.1.3"><munderover id="S3.E3.m1.20.20.2.19.19.19.19.1.3.1"><mo movablelimits="false" id="S3.E3.m1.12.12.12.12.12.12" xref="S3.E3.m1.12.12.12.12.12.12.cmml">∑</mo><mrow id="S3.E3.m1.13.13.13.13.13.13.1" xref="S3.E3.m1.13.13.13.13.13.13.1.cmml"><mi id="S3.E3.m1.13.13.13.13.13.13.1.2" xref="S3.E3.m1.13.13.13.13.13.13.1.2.cmml">i</mi><mo id="S3.E3.m1.13.13.13.13.13.13.1.1" xref="S3.E3.m1.13.13.13.13.13.13.1.1.cmml">=</mo><mn id="S3.E3.m1.13.13.13.13.13.13.1.3" xref="S3.E3.m1.13.13.13.13.13.13.1.3.cmml">1</mn></mrow><mi id="S3.E3.m1.14.14.14.14.14.14.1" xref="S3.E3.m1.14.14.14.14.14.14.1.cmml">k</mi></munderover><mrow id="S3.E3.m1.20.20.2.19.19.19.19.1.3.2"><mfrac id="S3.E3.m1.15.15.15.15.15.15" xref="S3.E3.m1.15.15.15.15.15.15.cmml"><mrow id="S3.E3.m1.15.15.15.15.15.15.1" xref="S3.E3.m1.15.15.15.15.15.15.1.cmml"><mtext id="S3.E3.m1.15.15.15.15.15.15.1.3" xref="S3.E3.m1.15.15.15.15.15.15.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.15.15.1.2" xref="S3.E3.m1.15.15.15.15.15.15.1.2.cmml">​</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.cmml"><mtext id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.3a.cmml">tanh</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><mi id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.15.15.15.15.15.15.2" xref="S3.E3.m1.15.15.15.15.15.15.2.cmml"><msubsup id="S3.E3.m1.15.15.15.15.15.15.2.2" xref="S3.E3.m1.15.15.15.15.15.15.2.2.cmml"><mo id="S3.E3.m1.15.15.15.15.15.15.2.2.2.2" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.cmml"><msup id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.2" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.2.cmml">i</mi><mo id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.3" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.3.cmml">′</mo></msup><mo id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.1" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.3" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.15.15.15.15.15.15.2.2.3" xref="S3.E3.m1.15.15.15.15.15.15.2.2.3.cmml">k</mi></msubsup><mrow id="S3.E3.m1.15.15.15.15.15.15.2.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.cmml"><mtext id="S3.E3.m1.15.15.15.15.15.15.2.1.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.3a.cmml">exp</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.15.15.2.1.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.2.cmml">​</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.cmml"><mtext id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.3a.cmml">tanh</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><msup id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.3.cmml">′</mo></msup></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><msup id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.2.cmml">i</mi><mo id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.3.cmml">′</mo></msup></msub></mrow><mo id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.2.cmml">b</mi><msup id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.3.cmml">′</mo></msup></msub></mrow><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.3" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.20.20.2.19.19.19.19.1.3.2.1" xref="S3.E3.m1.19.19.1.1.1.cmml">​</mo><msub id="S3.E3.m1.20.20.2.19.19.19.19.1.3.2.2"><mi id="S3.E3.m1.16.16.16.16.16.16" xref="S3.E3.m1.16.16.16.16.16.16.cmml">𝐱</mi><mi id="S3.E3.m1.17.17.17.17.17.17.1" xref="S3.E3.m1.17.17.17.17.17.17.1.cmml">i</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.18.18.18.18.18.18" xref="S3.E3.m1.19.19.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.20b"><apply id="S3.E3.m1.19.19.1.1.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><eq id="S3.E3.m1.11.11.11.11.11.11.cmml" xref="S3.E3.m1.11.11.11.11.11.11"></eq><apply id="S3.E3.m1.19.19.1.1.1.2.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><times id="S3.E3.m1.19.19.1.1.1.2.3.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"></times><ci id="S3.E3.m1.1.1.1.1.1.1a.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><mtext id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">Attention</mtext></ci><vector id="S3.E3.m1.19.19.1.1.1.2.2.3.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><apply id="S3.E3.m1.19.19.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3">𝐱</ci><cn type="integer" id="S3.E3.m1.4.4.4.4.4.4.1.cmml" xref="S3.E3.m1.4.4.4.4.4.4.1">1</cn></apply><ci id="S3.E3.m1.6.6.6.6.6.6.cmml" xref="S3.E3.m1.6.6.6.6.6.6">…</ci><apply id="S3.E3.m1.19.19.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3">subscript</csymbol><ci id="S3.E3.m1.8.8.8.8.8.8.cmml" xref="S3.E3.m1.8.8.8.8.8.8">𝐱</ci><ci id="S3.E3.m1.9.9.9.9.9.9.1.cmml" xref="S3.E3.m1.9.9.9.9.9.9.1">𝑘</ci></apply></vector></apply><apply id="S3.E3.m1.19.19.1.1.1.4.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><apply id="S3.E3.m1.19.19.1.1.1.4.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.4.1.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3">superscript</csymbol><apply id="S3.E3.m1.19.19.1.1.1.4.1.2.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.4.1.2.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3">subscript</csymbol><sum id="S3.E3.m1.12.12.12.12.12.12.cmml" xref="S3.E3.m1.12.12.12.12.12.12"></sum><apply id="S3.E3.m1.13.13.13.13.13.13.1.cmml" xref="S3.E3.m1.13.13.13.13.13.13.1"><eq id="S3.E3.m1.13.13.13.13.13.13.1.1.cmml" xref="S3.E3.m1.13.13.13.13.13.13.1.1"></eq><ci id="S3.E3.m1.13.13.13.13.13.13.1.2.cmml" xref="S3.E3.m1.13.13.13.13.13.13.1.2">𝑖</ci><cn type="integer" id="S3.E3.m1.13.13.13.13.13.13.1.3.cmml" xref="S3.E3.m1.13.13.13.13.13.13.1.3">1</cn></apply></apply><ci id="S3.E3.m1.14.14.14.14.14.14.1.cmml" xref="S3.E3.m1.14.14.14.14.14.14.1">𝑘</ci></apply><apply id="S3.E3.m1.19.19.1.1.1.4.2.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><times id="S3.E3.m1.19.19.1.1.1.4.2.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"></times><apply id="S3.E3.m1.15.15.15.15.15.15.cmml" xref="S3.E3.m1.15.15.15.15.15.15"><divide id="S3.E3.m1.15.15.15.15.15.15.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15"></divide><apply id="S3.E3.m1.15.15.15.15.15.15.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1"><times id="S3.E3.m1.15.15.15.15.15.15.1.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.2"></times><ci id="S3.E3.m1.15.15.15.15.15.15.1.3a.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.3"><mtext id="S3.E3.m1.15.15.15.15.15.15.1.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.3">exp</mtext></ci><apply id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1"><times id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.2"></times><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.3a.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.3"><mtext id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.3">tanh</mtext></ci><apply id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1"><plus id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.2">𝐱</ci><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E3.m1.15.15.15.15.15.15.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2"><apply id="S3.E3.m1.15.15.15.15.15.15.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2">superscript</csymbol><apply id="S3.E3.m1.15.15.15.15.15.15.2.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.2.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2">subscript</csymbol><sum id="S3.E3.m1.15.15.15.15.15.15.2.2.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.2"></sum><apply id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3"><eq id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.1"></eq><apply id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2">superscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.2">𝑖</ci><ci id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.2.3">′</ci></apply><cn type="integer" id="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.15.15.15.15.15.15.2.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.2.3">𝑘</ci></apply><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1"><times id="S3.E3.m1.15.15.15.15.15.15.2.1.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.2"></times><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.3a.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.3"><mtext id="S3.E3.m1.15.15.15.15.15.15.2.1.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.3">exp</mtext></ci><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1"><times id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.2"></times><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.3a.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.3"><mtext id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.3">tanh</mtext></ci><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1"><plus id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.2">𝑊</ci><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3">superscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.2.3.3">′</ci></apply></apply><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.2">𝐱</ci><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.2">𝑖</ci><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.2.3.3.3">′</ci></apply></apply></apply><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.2">𝑏</ci><apply id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.15.15.15.15.15.15.2.1.1.1.1.1.1.1.3.3.3">′</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E3.m1.19.19.1.1.1.4.2.3.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.19.19.1.1.1.4.2.3.1.cmml" xref="S3.E3.m1.20.20.2.19.19.19.19.1.2.3">subscript</csymbol><ci id="S3.E3.m1.16.16.16.16.16.16.cmml" xref="S3.E3.m1.16.16.16.16.16.16">𝐱</ci><ci id="S3.E3.m1.17.17.17.17.17.17.1.cmml" xref="S3.E3.m1.17.17.17.17.17.17.1">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.20c">\begin{split}\text{Attention}(\mathbf{x}_{1},\ldots,\mathbf{x}_{k})=\sum_{i=1}^{k}\frac{\text{exp}(\text{tanh}(W_{i}\mathbf{x}_{i}+b_{i}))}{\sum_{i^{\prime}=1}^{k}\text{exp}(\text{tanh}(W_{i^{\prime}}\mathbf{x}_{i^{\prime}}+b_{i^{\prime}}))}\mathbf{x}_{i}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.4" class="ltx_p">We concatenate all the above embeddings as the raw embeddings for user <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">n</annotation></semantics></math> and item <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">m</annotation></semantics></math>: <math id="S3.SS1.p4.3.m3.2" class="ltx_Math" alttext="E_{rawu,n}" display="inline"><semantics id="S3.SS1.p4.3.m3.2a"><msub id="S3.SS1.p4.3.m3.2.3" xref="S3.SS1.p4.3.m3.2.3.cmml"><mi id="S3.SS1.p4.3.m3.2.3.2" xref="S3.SS1.p4.3.m3.2.3.2.cmml">E</mi><mrow id="S3.SS1.p4.3.m3.2.2.2.2" xref="S3.SS1.p4.3.m3.2.2.2.3.cmml"><mrow id="S3.SS1.p4.3.m3.2.2.2.2.1" xref="S3.SS1.p4.3.m3.2.2.2.2.1.cmml"><mi id="S3.SS1.p4.3.m3.2.2.2.2.1.2" xref="S3.SS1.p4.3.m3.2.2.2.2.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.3.m3.2.2.2.2.1.1" xref="S3.SS1.p4.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p4.3.m3.2.2.2.2.1.3" xref="S3.SS1.p4.3.m3.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.3.m3.2.2.2.2.1.1a" xref="S3.SS1.p4.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p4.3.m3.2.2.2.2.1.4" xref="S3.SS1.p4.3.m3.2.2.2.2.1.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.3.m3.2.2.2.2.1.1b" xref="S3.SS1.p4.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p4.3.m3.2.2.2.2.1.5" xref="S3.SS1.p4.3.m3.2.2.2.2.1.5.cmml">u</mi></mrow><mo id="S3.SS1.p4.3.m3.2.2.2.2.2" xref="S3.SS1.p4.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p4.3.m3.1.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.1.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.2b"><apply id="S3.SS1.p4.3.m3.2.3.cmml" xref="S3.SS1.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.2.3.1.cmml" xref="S3.SS1.p4.3.m3.2.3">subscript</csymbol><ci id="S3.SS1.p4.3.m3.2.3.2.cmml" xref="S3.SS1.p4.3.m3.2.3.2">𝐸</ci><list id="S3.SS1.p4.3.m3.2.2.2.3.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2"><apply id="S3.SS1.p4.3.m3.2.2.2.2.1.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.1"><times id="S3.SS1.p4.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.1.1"></times><ci id="S3.SS1.p4.3.m3.2.2.2.2.1.2.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.1.2">𝑟</ci><ci id="S3.SS1.p4.3.m3.2.2.2.2.1.3.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.1.3">𝑎</ci><ci id="S3.SS1.p4.3.m3.2.2.2.2.1.4.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.1.4">𝑤</ci><ci id="S3.SS1.p4.3.m3.2.2.2.2.1.5.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.1.5">𝑢</ci></apply><ci id="S3.SS1.p4.3.m3.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.2c">E_{rawu,n}</annotation></semantics></math> and <math id="S3.SS1.p4.4.m4.2" class="ltx_Math" alttext="E_{rawi,m}" display="inline"><semantics id="S3.SS1.p4.4.m4.2a"><msub id="S3.SS1.p4.4.m4.2.3" xref="S3.SS1.p4.4.m4.2.3.cmml"><mi id="S3.SS1.p4.4.m4.2.3.2" xref="S3.SS1.p4.4.m4.2.3.2.cmml">E</mi><mrow id="S3.SS1.p4.4.m4.2.2.2.2" xref="S3.SS1.p4.4.m4.2.2.2.3.cmml"><mrow id="S3.SS1.p4.4.m4.2.2.2.2.1" xref="S3.SS1.p4.4.m4.2.2.2.2.1.cmml"><mi id="S3.SS1.p4.4.m4.2.2.2.2.1.2" xref="S3.SS1.p4.4.m4.2.2.2.2.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.2.2.2.2.1.1" xref="S3.SS1.p4.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p4.4.m4.2.2.2.2.1.3" xref="S3.SS1.p4.4.m4.2.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.2.2.2.2.1.1a" xref="S3.SS1.p4.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p4.4.m4.2.2.2.2.1.4" xref="S3.SS1.p4.4.m4.2.2.2.2.1.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.4.m4.2.2.2.2.1.1b" xref="S3.SS1.p4.4.m4.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p4.4.m4.2.2.2.2.1.5" xref="S3.SS1.p4.4.m4.2.2.2.2.1.5.cmml">i</mi></mrow><mo id="S3.SS1.p4.4.m4.2.2.2.2.2" xref="S3.SS1.p4.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p4.4.m4.1.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.1.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.2b"><apply id="S3.SS1.p4.4.m4.2.3.cmml" xref="S3.SS1.p4.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.2.3.1.cmml" xref="S3.SS1.p4.4.m4.2.3">subscript</csymbol><ci id="S3.SS1.p4.4.m4.2.3.2.cmml" xref="S3.SS1.p4.4.m4.2.3.2">𝐸</ci><list id="S3.SS1.p4.4.m4.2.2.2.3.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2"><apply id="S3.SS1.p4.4.m4.2.2.2.2.1.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.1"><times id="S3.SS1.p4.4.m4.2.2.2.2.1.1.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.1.1"></times><ci id="S3.SS1.p4.4.m4.2.2.2.2.1.2.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.1.2">𝑟</ci><ci id="S3.SS1.p4.4.m4.2.2.2.2.1.3.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.1.3">𝑎</ci><ci id="S3.SS1.p4.4.m4.2.2.2.2.1.4.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.1.4">𝑤</ci><ci id="S3.SS1.p4.4.m4.2.2.2.2.1.5.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.1.5">𝑖</ci></apply><ci id="S3.SS1.p4.4.m4.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1">𝑚</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.2c">E_{rawi,m}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">Item embeddings are shared and updated iteratively among users via the server, while the user embeddings are kept locally due to privacy concerns. These raw initial embeddings are used to train the local GNNs. During the training process, the global item embeddings and local user embeddings will be updated.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.1" class="ltx_p"><math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mo id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><ci id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\bullet</annotation></semantics></math> <span id="S3.SS1.p6.1.1" class="ltx_text ltx_font_bold">Local GNN Module.</span>
After getting all items’ embeddings and the user’s own embedding, each user needs the user-item interaction matrix to train the local GNN model. However, one difficulty is that user-item interaction information is kept private as local data and should not be shared among the server and other users.</p>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<p id="S3.SS1.p7.1" class="ltx_p">In order to tackle such issues, we follow a similar idea as in <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, where each user uploads the privacy-protected embedding and the encrypted IDs (with the same encryption for all users) of the items that this user has interaction with to the server. Then the server sends encrypted item IDs and user embeddings back to all the users. To further reduce the communication cost, the server can just send back the encrypted item ID and the other users’ embeddings to a user that has previously interacted with this item. Therefore, each user is able to get several users’ embedding information together with the corresponding items, without revealing the identities of these users. In this way, each user could explore its neighborhood users and expand a local interaction graph.</p>
</div>
<div id="S3.SS1.p8" class="ltx_para">
<p id="S3.SS1.p8.3" class="ltx_p">The GNN module will output user <math id="S3.SS1.p8.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p8.1.m1.1a"><mi id="S3.SS1.p8.1.m1.1.1" xref="S3.SS1.p8.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.1.m1.1b"><ci id="S3.SS1.p8.1.m1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.1.m1.1c">n</annotation></semantics></math>’s embedding <math id="S3.SS1.p8.2.m2.2" class="ltx_Math" alttext="E_{u,n}" display="inline"><semantics id="S3.SS1.p8.2.m2.2a"><msub id="S3.SS1.p8.2.m2.2.3" xref="S3.SS1.p8.2.m2.2.3.cmml"><mi id="S3.SS1.p8.2.m2.2.3.2" xref="S3.SS1.p8.2.m2.2.3.2.cmml">E</mi><mrow id="S3.SS1.p8.2.m2.2.2.2.4" xref="S3.SS1.p8.2.m2.2.2.2.3.cmml"><mi id="S3.SS1.p8.2.m2.1.1.1.1" xref="S3.SS1.p8.2.m2.1.1.1.1.cmml">u</mi><mo id="S3.SS1.p8.2.m2.2.2.2.4.1" xref="S3.SS1.p8.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p8.2.m2.2.2.2.2" xref="S3.SS1.p8.2.m2.2.2.2.2.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.2.m2.2b"><apply id="S3.SS1.p8.2.m2.2.3.cmml" xref="S3.SS1.p8.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p8.2.m2.2.3.1.cmml" xref="S3.SS1.p8.2.m2.2.3">subscript</csymbol><ci id="S3.SS1.p8.2.m2.2.3.2.cmml" xref="S3.SS1.p8.2.m2.2.3.2">𝐸</ci><list id="S3.SS1.p8.2.m2.2.2.2.3.cmml" xref="S3.SS1.p8.2.m2.2.2.2.4"><ci id="S3.SS1.p8.2.m2.1.1.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1.1.1">𝑢</ci><ci id="S3.SS1.p8.2.m2.2.2.2.2.cmml" xref="S3.SS1.p8.2.m2.2.2.2.2">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.2.m2.2c">E_{u,n}</annotation></semantics></math> and items’ embeddings <math id="S3.SS1.p8.3.m3.3" class="ltx_Math" alttext="\{E_{i,m}\}" display="inline"><semantics id="S3.SS1.p8.3.m3.3a"><mrow id="S3.SS1.p8.3.m3.3.3.1" xref="S3.SS1.p8.3.m3.3.3.2.cmml"><mo stretchy="false" id="S3.SS1.p8.3.m3.3.3.1.2" xref="S3.SS1.p8.3.m3.3.3.2.cmml">{</mo><msub id="S3.SS1.p8.3.m3.3.3.1.1" xref="S3.SS1.p8.3.m3.3.3.1.1.cmml"><mi id="S3.SS1.p8.3.m3.3.3.1.1.2" xref="S3.SS1.p8.3.m3.3.3.1.1.2.cmml">E</mi><mrow id="S3.SS1.p8.3.m3.2.2.2.4" xref="S3.SS1.p8.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p8.3.m3.1.1.1.1" xref="S3.SS1.p8.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p8.3.m3.2.2.2.4.1" xref="S3.SS1.p8.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p8.3.m3.2.2.2.2" xref="S3.SS1.p8.3.m3.2.2.2.2.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p8.3.m3.3.3.1.3" xref="S3.SS1.p8.3.m3.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.3.m3.3b"><set id="S3.SS1.p8.3.m3.3.3.2.cmml" xref="S3.SS1.p8.3.m3.3.3.1"><apply id="S3.SS1.p8.3.m3.3.3.1.1.cmml" xref="S3.SS1.p8.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p8.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.p8.3.m3.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p8.3.m3.3.3.1.1.2.cmml" xref="S3.SS1.p8.3.m3.3.3.1.1.2">𝐸</ci><list id="S3.SS1.p8.3.m3.2.2.2.3.cmml" xref="S3.SS1.p8.3.m3.2.2.2.4"><ci id="S3.SS1.p8.3.m3.1.1.1.1.cmml" xref="S3.SS1.p8.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS1.p8.3.m3.2.2.2.2.cmml" xref="S3.SS1.p8.3.m3.2.2.2.2">𝑚</ci></list></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.3.m3.3c">\{E_{i,m}\}</annotation></semantics></math>:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.21" class="ltx_Math" alttext="\begin{split}&amp;E_{u,n},E_{i,m}=\text{LocalGNN}(\{E_{rawu,n}\},\{E_{rawi,m}\}).\\
\end{split}" display="block"><semantics id="S3.E4.m1.21a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E4.m1.21.21.2"><mtr id="S3.E4.m1.21.21.2a"><mtd id="S3.E4.m1.21.21.2b" xref="S3.E4.m1.20.20.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.21.21.2c"><mrow id="S3.E4.m1.21.21.2.20.20.20.20"><mrow id="S3.E4.m1.21.21.2.20.20.20.20.1"><mrow id="S3.E4.m1.21.21.2.20.20.20.20.1.2.2"><msub id="S3.E4.m1.21.21.2.20.20.20.20.1.1.1.1"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">E</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.1.4" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">u</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.4.1" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.2.1.2.cmml">n</mi></mrow></msub><mo id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.20.20.1.1.1.cmml">,</mo><msub id="S3.E4.m1.21.21.2.20.20.20.20.1.2.2.2"><mi id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml">E</mi><mrow id="S3.E4.m1.5.5.5.5.5.5.1.4" xref="S3.E4.m1.5.5.5.5.5.5.1.3.cmml"><mi id="S3.E4.m1.5.5.5.5.5.5.1.1" xref="S3.E4.m1.5.5.5.5.5.5.1.1.cmml">i</mi><mo id="S3.E4.m1.5.5.5.5.5.5.1.4.1" xref="S3.E4.m1.5.5.5.5.5.5.1.3.cmml">,</mo><mi id="S3.E4.m1.5.5.5.5.5.5.1.2" xref="S3.E4.m1.5.5.5.5.5.5.1.2.cmml">m</mi></mrow></msub></mrow><mo id="S3.E4.m1.6.6.6.6.6.6" xref="S3.E4.m1.6.6.6.6.6.6.cmml">=</mo><mrow id="S3.E4.m1.21.21.2.20.20.20.20.1.4"><mtext id="S3.E4.m1.7.7.7.7.7.7" xref="S3.E4.m1.7.7.7.7.7.7a.cmml">LocalGNN</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.21.21.2.20.20.20.20.1.4.3" xref="S3.E4.m1.20.20.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.21.21.2.20.20.20.20.1.4.2.2"><mo stretchy="false" id="S3.E4.m1.8.8.8.8.8.8" xref="S3.E4.m1.20.20.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.21.21.2.20.20.20.20.1.3.1.1.1"><mo stretchy="false" id="S3.E4.m1.9.9.9.9.9.9" xref="S3.E4.m1.20.20.1.1.1.cmml">{</mo><msub id="S3.E4.m1.21.21.2.20.20.20.20.1.3.1.1.1.1.1"><mi id="S3.E4.m1.10.10.10.10.10.10" xref="S3.E4.m1.10.10.10.10.10.10.cmml">E</mi><mrow id="S3.E4.m1.11.11.11.11.11.11.1.2" xref="S3.E4.m1.11.11.11.11.11.11.1.3.cmml"><mrow id="S3.E4.m1.11.11.11.11.11.11.1.2.1" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.cmml"><mi id="S3.E4.m1.11.11.11.11.11.11.1.2.1.2" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.11.11.11.11.1.2.1.1" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.1.cmml">​</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.2.1.3" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.11.11.11.11.1.2.1.1a" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.1.cmml">​</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.2.1.4" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.11.11.11.11.11.11.1.2.1.1b" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.1.cmml">​</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.2.1.5" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.5.cmml">u</mi></mrow><mo id="S3.E4.m1.11.11.11.11.11.11.1.2.2" xref="S3.E4.m1.11.11.11.11.11.11.1.3.cmml">,</mo><mi id="S3.E4.m1.11.11.11.11.11.11.1.1" xref="S3.E4.m1.11.11.11.11.11.11.1.1.cmml">n</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.12.12.12.12.12.12" xref="S3.E4.m1.20.20.1.1.1.cmml">}</mo></mrow><mo id="S3.E4.m1.13.13.13.13.13.13" xref="S3.E4.m1.20.20.1.1.1.cmml">,</mo><mrow id="S3.E4.m1.21.21.2.20.20.20.20.1.4.2.2.2"><mo stretchy="false" id="S3.E4.m1.14.14.14.14.14.14" xref="S3.E4.m1.20.20.1.1.1.cmml">{</mo><msub id="S3.E4.m1.21.21.2.20.20.20.20.1.4.2.2.2.1.1"><mi id="S3.E4.m1.15.15.15.15.15.15" xref="S3.E4.m1.15.15.15.15.15.15.cmml">E</mi><mrow id="S3.E4.m1.16.16.16.16.16.16.1.2" xref="S3.E4.m1.16.16.16.16.16.16.1.3.cmml"><mrow id="S3.E4.m1.16.16.16.16.16.16.1.2.1" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.cmml"><mi id="S3.E4.m1.16.16.16.16.16.16.1.2.1.2" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.16.16.16.16.16.16.1.2.1.1" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.1.cmml">​</mo><mi id="S3.E4.m1.16.16.16.16.16.16.1.2.1.3" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.16.16.16.16.16.16.1.2.1.1a" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.1.cmml">​</mo><mi id="S3.E4.m1.16.16.16.16.16.16.1.2.1.4" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.4.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.16.16.16.16.16.16.1.2.1.1b" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.1.cmml">​</mo><mi id="S3.E4.m1.16.16.16.16.16.16.1.2.1.5" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.5.cmml">i</mi></mrow><mo id="S3.E4.m1.16.16.16.16.16.16.1.2.2" xref="S3.E4.m1.16.16.16.16.16.16.1.3.cmml">,</mo><mi id="S3.E4.m1.16.16.16.16.16.16.1.1" xref="S3.E4.m1.16.16.16.16.16.16.1.1.cmml">m</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.17.17.17.17.17.17" xref="S3.E4.m1.20.20.1.1.1.cmml">}</mo></mrow><mo stretchy="false" id="S3.E4.m1.18.18.18.18.18.18" xref="S3.E4.m1.20.20.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.19.19.19.19.19.19" xref="S3.E4.m1.20.20.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.21b"><apply id="S3.E4.m1.20.20.1.1.1.cmml" xref="S3.E4.m1.21.21.2b"><eq id="S3.E4.m1.6.6.6.6.6.6.cmml" xref="S3.E4.m1.6.6.6.6.6.6"></eq><list id="S3.E4.m1.20.20.1.1.1.2.3.cmml" xref="S3.E4.m1.21.21.2b"><apply id="S3.E4.m1.20.20.1.1.1.1.1.1.cmml" xref="S3.E4.m1.21.21.2b"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.21.21.2b">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝐸</ci><list id="S3.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.4"><ci id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1">𝑢</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2">𝑛</ci></list></apply><apply id="S3.E4.m1.20.20.1.1.1.2.2.2.cmml" xref="S3.E4.m1.21.21.2b"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.21.21.2b">subscript</csymbol><ci id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4">𝐸</ci><list id="S3.E4.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.4"><ci id="S3.E4.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.1">𝑖</ci><ci id="S3.E4.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.2">𝑚</ci></list></apply></list><apply id="S3.E4.m1.20.20.1.1.1.4.cmml" xref="S3.E4.m1.21.21.2b"><times id="S3.E4.m1.20.20.1.1.1.4.3.cmml" xref="S3.E4.m1.21.21.2b"></times><ci id="S3.E4.m1.7.7.7.7.7.7a.cmml" xref="S3.E4.m1.7.7.7.7.7.7"><mtext id="S3.E4.m1.7.7.7.7.7.7.cmml" xref="S3.E4.m1.7.7.7.7.7.7">LocalGNN</mtext></ci><interval closure="open" id="S3.E4.m1.20.20.1.1.1.4.2.3.cmml" xref="S3.E4.m1.21.21.2b"><set id="S3.E4.m1.20.20.1.1.1.3.1.1.1.2.cmml" xref="S3.E4.m1.21.21.2b"><apply id="S3.E4.m1.20.20.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E4.m1.21.21.2b"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.1.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.21.21.2b">subscript</csymbol><ci id="S3.E4.m1.10.10.10.10.10.10.cmml" xref="S3.E4.m1.10.10.10.10.10.10">𝐸</ci><list id="S3.E4.m1.11.11.11.11.11.11.1.3.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2"><apply id="S3.E4.m1.11.11.11.11.11.11.1.2.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1"><times id="S3.E4.m1.11.11.11.11.11.11.1.2.1.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.1"></times><ci id="S3.E4.m1.11.11.11.11.11.11.1.2.1.2.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.2">𝑟</ci><ci id="S3.E4.m1.11.11.11.11.11.11.1.2.1.3.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.3">𝑎</ci><ci id="S3.E4.m1.11.11.11.11.11.11.1.2.1.4.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.4">𝑤</ci><ci id="S3.E4.m1.11.11.11.11.11.11.1.2.1.5.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.2.1.5">𝑢</ci></apply><ci id="S3.E4.m1.11.11.11.11.11.11.1.1.cmml" xref="S3.E4.m1.11.11.11.11.11.11.1.1">𝑛</ci></list></apply></set><set id="S3.E4.m1.20.20.1.1.1.4.2.2.2.2.cmml" xref="S3.E4.m1.21.21.2b"><apply id="S3.E4.m1.20.20.1.1.1.4.2.2.2.1.1.cmml" xref="S3.E4.m1.21.21.2b"><csymbol cd="ambiguous" id="S3.E4.m1.20.20.1.1.1.4.2.2.2.1.1.1.cmml" xref="S3.E4.m1.21.21.2b">subscript</csymbol><ci id="S3.E4.m1.15.15.15.15.15.15.cmml" xref="S3.E4.m1.15.15.15.15.15.15">𝐸</ci><list id="S3.E4.m1.16.16.16.16.16.16.1.3.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2"><apply id="S3.E4.m1.16.16.16.16.16.16.1.2.1.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1"><times id="S3.E4.m1.16.16.16.16.16.16.1.2.1.1.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.1"></times><ci id="S3.E4.m1.16.16.16.16.16.16.1.2.1.2.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.2">𝑟</ci><ci id="S3.E4.m1.16.16.16.16.16.16.1.2.1.3.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.3">𝑎</ci><ci id="S3.E4.m1.16.16.16.16.16.16.1.2.1.4.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.4">𝑤</ci><ci id="S3.E4.m1.16.16.16.16.16.16.1.2.1.5.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.2.1.5">𝑖</ci></apply><ci id="S3.E4.m1.16.16.16.16.16.16.1.1.cmml" xref="S3.E4.m1.16.16.16.16.16.16.1.1">𝑚</ci></list></apply></set></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.21c">\begin{split}&amp;E_{u,n},E_{i,m}=\text{LocalGNN}(\{E_{rawu,n}\},\{E_{rawi,m}\}).\\
\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p8.4" class="ltx_p">These embeddings will be fed into the personalized prediction network for rating/preference predictions.</p>
</div>
<div id="S3.SS1.p9" class="ltx_para">
<p id="S3.SS1.p9.1" class="ltx_p">Note that there are various choices for this plug and use GNN module, such as PinSage <cite class="ltx_cite ltx_citemacro_citep">(Ying et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>, NGCF <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2019</a>)</cite> and LightGCN <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S3.SS1.p10" class="ltx_para">
<p id="S3.SS1.p10.9" class="ltx_p"><math id="S3.SS1.p10.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS1.p10.1.m1.1a"><mo id="S3.SS1.p10.1.m1.1.1" xref="S3.SS1.p10.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.1.m1.1b"><ci id="S3.SS1.p10.1.m1.1.1.cmml" xref="S3.SS1.p10.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.1.m1.1c">\bullet</annotation></semantics></math> <span id="S3.SS1.p10.9.1" class="ltx_text ltx_font_bold">Personalized Prediction Module.</span>
To achieve personalized recommendation, our framework trains personalized recommendation models for each user. Let us denote by <math id="S3.SS1.p10.2.m2.2" class="ltx_Math" alttext="\theta^{t}_{local,n}" display="inline"><semantics id="S3.SS1.p10.2.m2.2a"><msubsup id="S3.SS1.p10.2.m2.2.3" xref="S3.SS1.p10.2.m2.2.3.cmml"><mi id="S3.SS1.p10.2.m2.2.3.2.2" xref="S3.SS1.p10.2.m2.2.3.2.2.cmml">θ</mi><mrow id="S3.SS1.p10.2.m2.2.2.2.2" xref="S3.SS1.p10.2.m2.2.2.2.3.cmml"><mrow id="S3.SS1.p10.2.m2.2.2.2.2.1" xref="S3.SS1.p10.2.m2.2.2.2.2.1.cmml"><mi id="S3.SS1.p10.2.m2.2.2.2.2.1.2" xref="S3.SS1.p10.2.m2.2.2.2.2.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.2.m2.2.2.2.2.1.1" xref="S3.SS1.p10.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p10.2.m2.2.2.2.2.1.3" xref="S3.SS1.p10.2.m2.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.2.m2.2.2.2.2.1.1a" xref="S3.SS1.p10.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p10.2.m2.2.2.2.2.1.4" xref="S3.SS1.p10.2.m2.2.2.2.2.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.2.m2.2.2.2.2.1.1b" xref="S3.SS1.p10.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p10.2.m2.2.2.2.2.1.5" xref="S3.SS1.p10.2.m2.2.2.2.2.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.2.m2.2.2.2.2.1.1c" xref="S3.SS1.p10.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS1.p10.2.m2.2.2.2.2.1.6" xref="S3.SS1.p10.2.m2.2.2.2.2.1.6.cmml">l</mi></mrow><mo id="S3.SS1.p10.2.m2.2.2.2.2.2" xref="S3.SS1.p10.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p10.2.m2.1.1.1.1" xref="S3.SS1.p10.2.m2.1.1.1.1.cmml">n</mi></mrow><mi id="S3.SS1.p10.2.m2.2.3.2.3" xref="S3.SS1.p10.2.m2.2.3.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.2.m2.2b"><apply id="S3.SS1.p10.2.m2.2.3.cmml" xref="S3.SS1.p10.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p10.2.m2.2.3.1.cmml" xref="S3.SS1.p10.2.m2.2.3">subscript</csymbol><apply id="S3.SS1.p10.2.m2.2.3.2.cmml" xref="S3.SS1.p10.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p10.2.m2.2.3.2.1.cmml" xref="S3.SS1.p10.2.m2.2.3">superscript</csymbol><ci id="S3.SS1.p10.2.m2.2.3.2.2.cmml" xref="S3.SS1.p10.2.m2.2.3.2.2">𝜃</ci><ci id="S3.SS1.p10.2.m2.2.3.2.3.cmml" xref="S3.SS1.p10.2.m2.2.3.2.3">𝑡</ci></apply><list id="S3.SS1.p10.2.m2.2.2.2.3.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2"><apply id="S3.SS1.p10.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1"><times id="S3.SS1.p10.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1.1"></times><ci id="S3.SS1.p10.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1.2">𝑙</ci><ci id="S3.SS1.p10.2.m2.2.2.2.2.1.3.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1.3">𝑜</ci><ci id="S3.SS1.p10.2.m2.2.2.2.2.1.4.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1.4">𝑐</ci><ci id="S3.SS1.p10.2.m2.2.2.2.2.1.5.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1.5">𝑎</ci><ci id="S3.SS1.p10.2.m2.2.2.2.2.1.6.cmml" xref="S3.SS1.p10.2.m2.2.2.2.2.1.6">𝑙</ci></apply><ci id="S3.SS1.p10.2.m2.1.1.1.1.cmml" xref="S3.SS1.p10.2.m2.1.1.1.1">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.2.m2.2c">\theta^{t}_{local,n}</annotation></semantics></math> the raw embedding and GNN model trained by user <math id="S3.SS1.p10.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p10.3.m3.1a"><mi id="S3.SS1.p10.3.m3.1.1" xref="S3.SS1.p10.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.3.m3.1b"><ci id="S3.SS1.p10.3.m3.1.1.cmml" xref="S3.SS1.p10.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.3.m3.1c">n</annotation></semantics></math> at time step <math id="S3.SS1.p10.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p10.4.m4.1a"><mi id="S3.SS1.p10.4.m4.1.1" xref="S3.SS1.p10.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.4.m4.1b"><ci id="S3.SS1.p10.4.m4.1.1.cmml" xref="S3.SS1.p10.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.4.m4.1c">t</annotation></semantics></math>. From the server side, we will also have a global federated model <math id="S3.SS1.p10.5.m5.1" class="ltx_Math" alttext="\theta^{t}_{global}" display="inline"><semantics id="S3.SS1.p10.5.m5.1a"><msubsup id="S3.SS1.p10.5.m5.1.1" xref="S3.SS1.p10.5.m5.1.1.cmml"><mi id="S3.SS1.p10.5.m5.1.1.2.2" xref="S3.SS1.p10.5.m5.1.1.2.2.cmml">θ</mi><mrow id="S3.SS1.p10.5.m5.1.1.3" xref="S3.SS1.p10.5.m5.1.1.3.cmml"><mi id="S3.SS1.p10.5.m5.1.1.3.2" xref="S3.SS1.p10.5.m5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.5.m5.1.1.3.1" xref="S3.SS1.p10.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p10.5.m5.1.1.3.3" xref="S3.SS1.p10.5.m5.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.5.m5.1.1.3.1a" xref="S3.SS1.p10.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p10.5.m5.1.1.3.4" xref="S3.SS1.p10.5.m5.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.5.m5.1.1.3.1b" xref="S3.SS1.p10.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p10.5.m5.1.1.3.5" xref="S3.SS1.p10.5.m5.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.5.m5.1.1.3.1c" xref="S3.SS1.p10.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p10.5.m5.1.1.3.6" xref="S3.SS1.p10.5.m5.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.5.m5.1.1.3.1d" xref="S3.SS1.p10.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p10.5.m5.1.1.3.7" xref="S3.SS1.p10.5.m5.1.1.3.7.cmml">l</mi></mrow><mi id="S3.SS1.p10.5.m5.1.1.2.3" xref="S3.SS1.p10.5.m5.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.5.m5.1b"><apply id="S3.SS1.p10.5.m5.1.1.cmml" xref="S3.SS1.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p10.5.m5.1.1.1.cmml" xref="S3.SS1.p10.5.m5.1.1">subscript</csymbol><apply id="S3.SS1.p10.5.m5.1.1.2.cmml" xref="S3.SS1.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p10.5.m5.1.1.2.1.cmml" xref="S3.SS1.p10.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p10.5.m5.1.1.2.2.cmml" xref="S3.SS1.p10.5.m5.1.1.2.2">𝜃</ci><ci id="S3.SS1.p10.5.m5.1.1.2.3.cmml" xref="S3.SS1.p10.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.p10.5.m5.1.1.3.cmml" xref="S3.SS1.p10.5.m5.1.1.3"><times id="S3.SS1.p10.5.m5.1.1.3.1.cmml" xref="S3.SS1.p10.5.m5.1.1.3.1"></times><ci id="S3.SS1.p10.5.m5.1.1.3.2.cmml" xref="S3.SS1.p10.5.m5.1.1.3.2">𝑔</ci><ci id="S3.SS1.p10.5.m5.1.1.3.3.cmml" xref="S3.SS1.p10.5.m5.1.1.3.3">𝑙</ci><ci id="S3.SS1.p10.5.m5.1.1.3.4.cmml" xref="S3.SS1.p10.5.m5.1.1.3.4">𝑜</ci><ci id="S3.SS1.p10.5.m5.1.1.3.5.cmml" xref="S3.SS1.p10.5.m5.1.1.3.5">𝑏</ci><ci id="S3.SS1.p10.5.m5.1.1.3.6.cmml" xref="S3.SS1.p10.5.m5.1.1.3.6">𝑎</ci><ci id="S3.SS1.p10.5.m5.1.1.3.7.cmml" xref="S3.SS1.p10.5.m5.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.5.m5.1c">\theta^{t}_{global}</annotation></semantics></math> and a cluster-level federated model <math id="S3.SS1.p10.6.m6.1" class="ltx_Math" alttext="\theta^{t}_{C(n)}" display="inline"><semantics id="S3.SS1.p10.6.m6.1a"><msubsup id="S3.SS1.p10.6.m6.1.2" xref="S3.SS1.p10.6.m6.1.2.cmml"><mi id="S3.SS1.p10.6.m6.1.2.2.2" xref="S3.SS1.p10.6.m6.1.2.2.2.cmml">θ</mi><mrow id="S3.SS1.p10.6.m6.1.1.1" xref="S3.SS1.p10.6.m6.1.1.1.cmml"><mi id="S3.SS1.p10.6.m6.1.1.1.3" xref="S3.SS1.p10.6.m6.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.6.m6.1.1.1.2" xref="S3.SS1.p10.6.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p10.6.m6.1.1.1.4.2" xref="S3.SS1.p10.6.m6.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p10.6.m6.1.1.1.4.2.1" xref="S3.SS1.p10.6.m6.1.1.1.cmml">(</mo><mi id="S3.SS1.p10.6.m6.1.1.1.1" xref="S3.SS1.p10.6.m6.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S3.SS1.p10.6.m6.1.1.1.4.2.2" xref="S3.SS1.p10.6.m6.1.1.1.cmml">)</mo></mrow></mrow><mi id="S3.SS1.p10.6.m6.1.2.2.3" xref="S3.SS1.p10.6.m6.1.2.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.6.m6.1b"><apply id="S3.SS1.p10.6.m6.1.2.cmml" xref="S3.SS1.p10.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p10.6.m6.1.2.1.cmml" xref="S3.SS1.p10.6.m6.1.2">subscript</csymbol><apply id="S3.SS1.p10.6.m6.1.2.2.cmml" xref="S3.SS1.p10.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p10.6.m6.1.2.2.1.cmml" xref="S3.SS1.p10.6.m6.1.2">superscript</csymbol><ci id="S3.SS1.p10.6.m6.1.2.2.2.cmml" xref="S3.SS1.p10.6.m6.1.2.2.2">𝜃</ci><ci id="S3.SS1.p10.6.m6.1.2.2.3.cmml" xref="S3.SS1.p10.6.m6.1.2.2.3">𝑡</ci></apply><apply id="S3.SS1.p10.6.m6.1.1.1.cmml" xref="S3.SS1.p10.6.m6.1.1.1"><times id="S3.SS1.p10.6.m6.1.1.1.2.cmml" xref="S3.SS1.p10.6.m6.1.1.1.2"></times><ci id="S3.SS1.p10.6.m6.1.1.1.3.cmml" xref="S3.SS1.p10.6.m6.1.1.1.3">𝐶</ci><ci id="S3.SS1.p10.6.m6.1.1.1.1.cmml" xref="S3.SS1.p10.6.m6.1.1.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.6.m6.1c">\theta^{t}_{C(n)}</annotation></semantics></math>, where <math id="S3.SS1.p10.7.m7.1" class="ltx_Math" alttext="C(n)" display="inline"><semantics id="S3.SS1.p10.7.m7.1a"><mrow id="S3.SS1.p10.7.m7.1.2" xref="S3.SS1.p10.7.m7.1.2.cmml"><mi id="S3.SS1.p10.7.m7.1.2.2" xref="S3.SS1.p10.7.m7.1.2.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p10.7.m7.1.2.1" xref="S3.SS1.p10.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS1.p10.7.m7.1.2.3.2" xref="S3.SS1.p10.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS1.p10.7.m7.1.2.3.2.1" xref="S3.SS1.p10.7.m7.1.2.cmml">(</mo><mi id="S3.SS1.p10.7.m7.1.1" xref="S3.SS1.p10.7.m7.1.1.cmml">n</mi><mo stretchy="false" id="S3.SS1.p10.7.m7.1.2.3.2.2" xref="S3.SS1.p10.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.7.m7.1b"><apply id="S3.SS1.p10.7.m7.1.2.cmml" xref="S3.SS1.p10.7.m7.1.2"><times id="S3.SS1.p10.7.m7.1.2.1.cmml" xref="S3.SS1.p10.7.m7.1.2.1"></times><ci id="S3.SS1.p10.7.m7.1.2.2.cmml" xref="S3.SS1.p10.7.m7.1.2.2">𝐶</ci><ci id="S3.SS1.p10.7.m7.1.1.cmml" xref="S3.SS1.p10.7.m7.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.7.m7.1c">C(n)</annotation></semantics></math> is the cluster containing user <math id="S3.SS1.p10.8.m8.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p10.8.m8.1a"><mi id="S3.SS1.p10.8.m8.1.1" xref="S3.SS1.p10.8.m8.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.8.m8.1b"><ci id="S3.SS1.p10.8.m8.1.1.cmml" xref="S3.SS1.p10.8.m8.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.8.m8.1c">n</annotation></semantics></math>. We will describe how to obtain the global and the cluster-level models later. The personalized model combines these three models together via weights <math id="S3.SS1.p10.9.m9.9" class="ltx_Math" alttext="\alpha_{n,1},\alpha_{n,2},\alpha_{n,3}" display="inline"><semantics id="S3.SS1.p10.9.m9.9a"><mrow id="S3.SS1.p10.9.m9.9.9.3" xref="S3.SS1.p10.9.m9.9.9.4.cmml"><msub id="S3.SS1.p10.9.m9.7.7.1.1" xref="S3.SS1.p10.9.m9.7.7.1.1.cmml"><mi id="S3.SS1.p10.9.m9.7.7.1.1.2" xref="S3.SS1.p10.9.m9.7.7.1.1.2.cmml">α</mi><mrow id="S3.SS1.p10.9.m9.2.2.2.4" xref="S3.SS1.p10.9.m9.2.2.2.3.cmml"><mi id="S3.SS1.p10.9.m9.1.1.1.1" xref="S3.SS1.p10.9.m9.1.1.1.1.cmml">n</mi><mo id="S3.SS1.p10.9.m9.2.2.2.4.1" xref="S3.SS1.p10.9.m9.2.2.2.3.cmml">,</mo><mn id="S3.SS1.p10.9.m9.2.2.2.2" xref="S3.SS1.p10.9.m9.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S3.SS1.p10.9.m9.9.9.3.4" xref="S3.SS1.p10.9.m9.9.9.4.cmml">,</mo><msub id="S3.SS1.p10.9.m9.8.8.2.2" xref="S3.SS1.p10.9.m9.8.8.2.2.cmml"><mi id="S3.SS1.p10.9.m9.8.8.2.2.2" xref="S3.SS1.p10.9.m9.8.8.2.2.2.cmml">α</mi><mrow id="S3.SS1.p10.9.m9.4.4.2.4" xref="S3.SS1.p10.9.m9.4.4.2.3.cmml"><mi id="S3.SS1.p10.9.m9.3.3.1.1" xref="S3.SS1.p10.9.m9.3.3.1.1.cmml">n</mi><mo id="S3.SS1.p10.9.m9.4.4.2.4.1" xref="S3.SS1.p10.9.m9.4.4.2.3.cmml">,</mo><mn id="S3.SS1.p10.9.m9.4.4.2.2" xref="S3.SS1.p10.9.m9.4.4.2.2.cmml">2</mn></mrow></msub><mo id="S3.SS1.p10.9.m9.9.9.3.5" xref="S3.SS1.p10.9.m9.9.9.4.cmml">,</mo><msub id="S3.SS1.p10.9.m9.9.9.3.3" xref="S3.SS1.p10.9.m9.9.9.3.3.cmml"><mi id="S3.SS1.p10.9.m9.9.9.3.3.2" xref="S3.SS1.p10.9.m9.9.9.3.3.2.cmml">α</mi><mrow id="S3.SS1.p10.9.m9.6.6.2.4" xref="S3.SS1.p10.9.m9.6.6.2.3.cmml"><mi id="S3.SS1.p10.9.m9.5.5.1.1" xref="S3.SS1.p10.9.m9.5.5.1.1.cmml">n</mi><mo id="S3.SS1.p10.9.m9.6.6.2.4.1" xref="S3.SS1.p10.9.m9.6.6.2.3.cmml">,</mo><mn id="S3.SS1.p10.9.m9.6.6.2.2" xref="S3.SS1.p10.9.m9.6.6.2.2.cmml">3</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.9.m9.9b"><list id="S3.SS1.p10.9.m9.9.9.4.cmml" xref="S3.SS1.p10.9.m9.9.9.3"><apply id="S3.SS1.p10.9.m9.7.7.1.1.cmml" xref="S3.SS1.p10.9.m9.7.7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p10.9.m9.7.7.1.1.1.cmml" xref="S3.SS1.p10.9.m9.7.7.1.1">subscript</csymbol><ci id="S3.SS1.p10.9.m9.7.7.1.1.2.cmml" xref="S3.SS1.p10.9.m9.7.7.1.1.2">𝛼</ci><list id="S3.SS1.p10.9.m9.2.2.2.3.cmml" xref="S3.SS1.p10.9.m9.2.2.2.4"><ci id="S3.SS1.p10.9.m9.1.1.1.1.cmml" xref="S3.SS1.p10.9.m9.1.1.1.1">𝑛</ci><cn type="integer" id="S3.SS1.p10.9.m9.2.2.2.2.cmml" xref="S3.SS1.p10.9.m9.2.2.2.2">1</cn></list></apply><apply id="S3.SS1.p10.9.m9.8.8.2.2.cmml" xref="S3.SS1.p10.9.m9.8.8.2.2"><csymbol cd="ambiguous" id="S3.SS1.p10.9.m9.8.8.2.2.1.cmml" xref="S3.SS1.p10.9.m9.8.8.2.2">subscript</csymbol><ci id="S3.SS1.p10.9.m9.8.8.2.2.2.cmml" xref="S3.SS1.p10.9.m9.8.8.2.2.2">𝛼</ci><list id="S3.SS1.p10.9.m9.4.4.2.3.cmml" xref="S3.SS1.p10.9.m9.4.4.2.4"><ci id="S3.SS1.p10.9.m9.3.3.1.1.cmml" xref="S3.SS1.p10.9.m9.3.3.1.1">𝑛</ci><cn type="integer" id="S3.SS1.p10.9.m9.4.4.2.2.cmml" xref="S3.SS1.p10.9.m9.4.4.2.2">2</cn></list></apply><apply id="S3.SS1.p10.9.m9.9.9.3.3.cmml" xref="S3.SS1.p10.9.m9.9.9.3.3"><csymbol cd="ambiguous" id="S3.SS1.p10.9.m9.9.9.3.3.1.cmml" xref="S3.SS1.p10.9.m9.9.9.3.3">subscript</csymbol><ci id="S3.SS1.p10.9.m9.9.9.3.3.2.cmml" xref="S3.SS1.p10.9.m9.9.9.3.3.2">𝛼</ci><list id="S3.SS1.p10.9.m9.6.6.2.3.cmml" xref="S3.SS1.p10.9.m9.6.6.2.4"><ci id="S3.SS1.p10.9.m9.5.5.1.1.cmml" xref="S3.SS1.p10.9.m9.5.5.1.1">𝑛</ci><cn type="integer" id="S3.SS1.p10.9.m9.6.6.2.2.cmml" xref="S3.SS1.p10.9.m9.6.6.2.2">3</cn></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.9.m9.9c">\alpha_{n,1},\alpha_{n,2},\alpha_{n,3}</annotation></semantics></math>, which can be either hyperparameters or learnable parameters:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.24" class="ltx_Math" alttext="\begin{split}&amp;\theta^{t}_{n}=\alpha_{n,1}\theta^{t}_{local,n}+\alpha_{n,2}\theta^{t}_{C(n)}+\alpha_{n,3}\theta^{t}_{global}.\end{split}" display="block"><semantics id="S3.E5.m1.24a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E5.m1.24.24.2"><mtr id="S3.E5.m1.24.24.2a"><mtd id="S3.E5.m1.24.24.2b" xref="S3.E5.m1.23.23.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.24.24.2c"><mrow id="S3.E5.m1.24.24.2.23.23.23.23"><mrow id="S3.E5.m1.24.24.2.23.23.23.23.1"><msubsup id="S3.E5.m1.24.24.2.23.23.23.23.1.1"><mi id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">θ</mi><mi id="S3.E5.m1.3.3.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.3.3.1.cmml">n</mi><mi id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">t</mi></msubsup><mo id="S3.E5.m1.4.4.4.4.4.4" xref="S3.E5.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S3.E5.m1.24.24.2.23.23.23.23.1.2"><mrow id="S3.E5.m1.24.24.2.23.23.23.23.1.2.1"><msub id="S3.E5.m1.24.24.2.23.23.23.23.1.2.1.2"><mi id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">α</mi><mrow id="S3.E5.m1.6.6.6.6.6.6.1.4" xref="S3.E5.m1.6.6.6.6.6.6.1.3.cmml"><mi id="S3.E5.m1.6.6.6.6.6.6.1.1" xref="S3.E5.m1.6.6.6.6.6.6.1.1.cmml">n</mi><mo id="S3.E5.m1.6.6.6.6.6.6.1.4.1" xref="S3.E5.m1.6.6.6.6.6.6.1.3.cmml">,</mo><mn id="S3.E5.m1.6.6.6.6.6.6.1.2" xref="S3.E5.m1.6.6.6.6.6.6.1.2.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.24.24.2.23.23.23.23.1.2.1.1" xref="S3.E5.m1.23.23.1.1.1.cmml">​</mo><msubsup id="S3.E5.m1.24.24.2.23.23.23.23.1.2.1.3"><mi id="S3.E5.m1.7.7.7.7.7.7" xref="S3.E5.m1.7.7.7.7.7.7.cmml">θ</mi><mrow id="S3.E5.m1.9.9.9.9.9.9.1.2" xref="S3.E5.m1.9.9.9.9.9.9.1.3.cmml"><mrow id="S3.E5.m1.9.9.9.9.9.9.1.2.1" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.cmml"><mi id="S3.E5.m1.9.9.9.9.9.9.1.2.1.2" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml">​</mo><mi id="S3.E5.m1.9.9.9.9.9.9.1.2.1.3" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1a" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml">​</mo><mi id="S3.E5.m1.9.9.9.9.9.9.1.2.1.4" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1b" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml">​</mo><mi id="S3.E5.m1.9.9.9.9.9.9.1.2.1.5" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1c" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml">​</mo><mi id="S3.E5.m1.9.9.9.9.9.9.1.2.1.6" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.6.cmml">l</mi></mrow><mo id="S3.E5.m1.9.9.9.9.9.9.1.2.2" xref="S3.E5.m1.9.9.9.9.9.9.1.3.cmml">,</mo><mi id="S3.E5.m1.9.9.9.9.9.9.1.1" xref="S3.E5.m1.9.9.9.9.9.9.1.1.cmml">n</mi></mrow><mi id="S3.E5.m1.8.8.8.8.8.8.1" xref="S3.E5.m1.8.8.8.8.8.8.1.cmml">t</mi></msubsup></mrow><mo id="S3.E5.m1.10.10.10.10.10.10" xref="S3.E5.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S3.E5.m1.24.24.2.23.23.23.23.1.2.2"><msub id="S3.E5.m1.24.24.2.23.23.23.23.1.2.2.2"><mi id="S3.E5.m1.11.11.11.11.11.11" xref="S3.E5.m1.11.11.11.11.11.11.cmml">α</mi><mrow id="S3.E5.m1.12.12.12.12.12.12.1.4" xref="S3.E5.m1.12.12.12.12.12.12.1.3.cmml"><mi id="S3.E5.m1.12.12.12.12.12.12.1.1" xref="S3.E5.m1.12.12.12.12.12.12.1.1.cmml">n</mi><mo id="S3.E5.m1.12.12.12.12.12.12.1.4.1" xref="S3.E5.m1.12.12.12.12.12.12.1.3.cmml">,</mo><mn id="S3.E5.m1.12.12.12.12.12.12.1.2" xref="S3.E5.m1.12.12.12.12.12.12.1.2.cmml">2</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.24.24.2.23.23.23.23.1.2.2.1" xref="S3.E5.m1.23.23.1.1.1.cmml">​</mo><msubsup id="S3.E5.m1.24.24.2.23.23.23.23.1.2.2.3"><mi id="S3.E5.m1.13.13.13.13.13.13" xref="S3.E5.m1.13.13.13.13.13.13.cmml">θ</mi><mrow id="S3.E5.m1.15.15.15.15.15.15.1" xref="S3.E5.m1.15.15.15.15.15.15.1.cmml"><mi id="S3.E5.m1.15.15.15.15.15.15.1.3" xref="S3.E5.m1.15.15.15.15.15.15.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.15.15.15.15.15.15.1.2" xref="S3.E5.m1.15.15.15.15.15.15.1.2.cmml">​</mo><mrow id="S3.E5.m1.15.15.15.15.15.15.1.4.2" xref="S3.E5.m1.15.15.15.15.15.15.1.cmml"><mo stretchy="false" id="S3.E5.m1.15.15.15.15.15.15.1.4.2.1" xref="S3.E5.m1.15.15.15.15.15.15.1.cmml">(</mo><mi id="S3.E5.m1.15.15.15.15.15.15.1.1" xref="S3.E5.m1.15.15.15.15.15.15.1.1.cmml">n</mi><mo stretchy="false" id="S3.E5.m1.15.15.15.15.15.15.1.4.2.2" xref="S3.E5.m1.15.15.15.15.15.15.1.cmml">)</mo></mrow></mrow><mi id="S3.E5.m1.14.14.14.14.14.14.1" xref="S3.E5.m1.14.14.14.14.14.14.1.cmml">t</mi></msubsup></mrow><mo id="S3.E5.m1.10.10.10.10.10.10a" xref="S3.E5.m1.10.10.10.10.10.10.cmml">+</mo><mrow id="S3.E5.m1.24.24.2.23.23.23.23.1.2.3"><msub id="S3.E5.m1.24.24.2.23.23.23.23.1.2.3.2"><mi id="S3.E5.m1.17.17.17.17.17.17" xref="S3.E5.m1.17.17.17.17.17.17.cmml">α</mi><mrow id="S3.E5.m1.18.18.18.18.18.18.1.4" xref="S3.E5.m1.18.18.18.18.18.18.1.3.cmml"><mi id="S3.E5.m1.18.18.18.18.18.18.1.1" xref="S3.E5.m1.18.18.18.18.18.18.1.1.cmml">n</mi><mo id="S3.E5.m1.18.18.18.18.18.18.1.4.1" xref="S3.E5.m1.18.18.18.18.18.18.1.3.cmml">,</mo><mn id="S3.E5.m1.18.18.18.18.18.18.1.2" xref="S3.E5.m1.18.18.18.18.18.18.1.2.cmml">3</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.24.24.2.23.23.23.23.1.2.3.1" xref="S3.E5.m1.23.23.1.1.1.cmml">​</mo><msubsup id="S3.E5.m1.24.24.2.23.23.23.23.1.2.3.3"><mi id="S3.E5.m1.19.19.19.19.19.19" xref="S3.E5.m1.19.19.19.19.19.19.cmml">θ</mi><mrow id="S3.E5.m1.21.21.21.21.21.21.1" xref="S3.E5.m1.21.21.21.21.21.21.1.cmml"><mi id="S3.E5.m1.21.21.21.21.21.21.1.2" xref="S3.E5.m1.21.21.21.21.21.21.1.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.21.21.21.21.21.21.1.1" xref="S3.E5.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.21.21.21.21.21.21.1.3" xref="S3.E5.m1.21.21.21.21.21.21.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.21.21.21.21.21.21.1.1a" xref="S3.E5.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.21.21.21.21.21.21.1.4" xref="S3.E5.m1.21.21.21.21.21.21.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.21.21.21.21.21.21.1.1b" xref="S3.E5.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.21.21.21.21.21.21.1.5" xref="S3.E5.m1.21.21.21.21.21.21.1.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.21.21.21.21.21.21.1.1c" xref="S3.E5.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.21.21.21.21.21.21.1.6" xref="S3.E5.m1.21.21.21.21.21.21.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.21.21.21.21.21.21.1.1d" xref="S3.E5.m1.21.21.21.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.21.21.21.21.21.21.1.7" xref="S3.E5.m1.21.21.21.21.21.21.1.7.cmml">l</mi></mrow><mi id="S3.E5.m1.20.20.20.20.20.20.1" xref="S3.E5.m1.20.20.20.20.20.20.1.cmml">t</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.22.22.22.22.22.22" xref="S3.E5.m1.23.23.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.24b"><apply id="S3.E5.m1.23.23.1.1.1.cmml" xref="S3.E5.m1.24.24.2b"><eq id="S3.E5.m1.4.4.4.4.4.4.cmml" xref="S3.E5.m1.4.4.4.4.4.4"></eq><apply id="S3.E5.m1.23.23.1.1.1.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.2.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><apply id="S3.E5.m1.23.23.1.1.1.2.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.2.2.1.cmml" xref="S3.E5.m1.24.24.2b">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">𝜃</ci><ci id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1">𝑡</ci></apply><ci id="S3.E5.m1.3.3.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1">𝑛</ci></apply><apply id="S3.E5.m1.23.23.1.1.1.3.cmml" xref="S3.E5.m1.24.24.2b"><plus id="S3.E5.m1.10.10.10.10.10.10.cmml" xref="S3.E5.m1.10.10.10.10.10.10"></plus><apply id="S3.E5.m1.23.23.1.1.1.3.2.cmml" xref="S3.E5.m1.24.24.2b"><times id="S3.E5.m1.23.23.1.1.1.3.2.1.cmml" xref="S3.E5.m1.24.24.2b"></times><apply id="S3.E5.m1.23.23.1.1.1.3.2.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">𝛼</ci><list id="S3.E5.m1.6.6.6.6.6.6.1.3.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.4"><ci id="S3.E5.m1.6.6.6.6.6.6.1.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.1">𝑛</ci><cn type="integer" id="S3.E5.m1.6.6.6.6.6.6.1.2.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1.2">1</cn></list></apply><apply id="S3.E5.m1.23.23.1.1.1.3.2.3.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><apply id="S3.E5.m1.23.23.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.2.3.2.1.cmml" xref="S3.E5.m1.24.24.2b">superscript</csymbol><ci id="S3.E5.m1.7.7.7.7.7.7.cmml" xref="S3.E5.m1.7.7.7.7.7.7">𝜃</ci><ci id="S3.E5.m1.8.8.8.8.8.8.1.cmml" xref="S3.E5.m1.8.8.8.8.8.8.1">𝑡</ci></apply><list id="S3.E5.m1.9.9.9.9.9.9.1.3.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2"><apply id="S3.E5.m1.9.9.9.9.9.9.1.2.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1"><times id="S3.E5.m1.9.9.9.9.9.9.1.2.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.1"></times><ci id="S3.E5.m1.9.9.9.9.9.9.1.2.1.2.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.2">𝑙</ci><ci id="S3.E5.m1.9.9.9.9.9.9.1.2.1.3.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.3">𝑜</ci><ci id="S3.E5.m1.9.9.9.9.9.9.1.2.1.4.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.4">𝑐</ci><ci id="S3.E5.m1.9.9.9.9.9.9.1.2.1.5.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.5">𝑎</ci><ci id="S3.E5.m1.9.9.9.9.9.9.1.2.1.6.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.2.1.6">𝑙</ci></apply><ci id="S3.E5.m1.9.9.9.9.9.9.1.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1.1">𝑛</ci></list></apply></apply><apply id="S3.E5.m1.23.23.1.1.1.3.3.cmml" xref="S3.E5.m1.24.24.2b"><times id="S3.E5.m1.23.23.1.1.1.3.3.1.cmml" xref="S3.E5.m1.24.24.2b"></times><apply id="S3.E5.m1.23.23.1.1.1.3.3.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><ci id="S3.E5.m1.11.11.11.11.11.11.cmml" xref="S3.E5.m1.11.11.11.11.11.11">𝛼</ci><list id="S3.E5.m1.12.12.12.12.12.12.1.3.cmml" xref="S3.E5.m1.12.12.12.12.12.12.1.4"><ci id="S3.E5.m1.12.12.12.12.12.12.1.1.cmml" xref="S3.E5.m1.12.12.12.12.12.12.1.1">𝑛</ci><cn type="integer" id="S3.E5.m1.12.12.12.12.12.12.1.2.cmml" xref="S3.E5.m1.12.12.12.12.12.12.1.2">2</cn></list></apply><apply id="S3.E5.m1.23.23.1.1.1.3.3.3.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><apply id="S3.E5.m1.23.23.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.3.3.2.1.cmml" xref="S3.E5.m1.24.24.2b">superscript</csymbol><ci id="S3.E5.m1.13.13.13.13.13.13.cmml" xref="S3.E5.m1.13.13.13.13.13.13">𝜃</ci><ci id="S3.E5.m1.14.14.14.14.14.14.1.cmml" xref="S3.E5.m1.14.14.14.14.14.14.1">𝑡</ci></apply><apply id="S3.E5.m1.15.15.15.15.15.15.1.cmml" xref="S3.E5.m1.15.15.15.15.15.15.1"><times id="S3.E5.m1.15.15.15.15.15.15.1.2.cmml" xref="S3.E5.m1.15.15.15.15.15.15.1.2"></times><ci id="S3.E5.m1.15.15.15.15.15.15.1.3.cmml" xref="S3.E5.m1.15.15.15.15.15.15.1.3">𝐶</ci><ci id="S3.E5.m1.15.15.15.15.15.15.1.1.cmml" xref="S3.E5.m1.15.15.15.15.15.15.1.1">𝑛</ci></apply></apply></apply><apply id="S3.E5.m1.23.23.1.1.1.3.4.cmml" xref="S3.E5.m1.24.24.2b"><times id="S3.E5.m1.23.23.1.1.1.3.4.1.cmml" xref="S3.E5.m1.24.24.2b"></times><apply id="S3.E5.m1.23.23.1.1.1.3.4.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.4.2.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><ci id="S3.E5.m1.17.17.17.17.17.17.cmml" xref="S3.E5.m1.17.17.17.17.17.17">𝛼</ci><list id="S3.E5.m1.18.18.18.18.18.18.1.3.cmml" xref="S3.E5.m1.18.18.18.18.18.18.1.4"><ci id="S3.E5.m1.18.18.18.18.18.18.1.1.cmml" xref="S3.E5.m1.18.18.18.18.18.18.1.1">𝑛</ci><cn type="integer" id="S3.E5.m1.18.18.18.18.18.18.1.2.cmml" xref="S3.E5.m1.18.18.18.18.18.18.1.2">3</cn></list></apply><apply id="S3.E5.m1.23.23.1.1.1.3.4.3.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.4.3.1.cmml" xref="S3.E5.m1.24.24.2b">subscript</csymbol><apply id="S3.E5.m1.23.23.1.1.1.3.4.3.2.cmml" xref="S3.E5.m1.24.24.2b"><csymbol cd="ambiguous" id="S3.E5.m1.23.23.1.1.1.3.4.3.2.1.cmml" xref="S3.E5.m1.24.24.2b">superscript</csymbol><ci id="S3.E5.m1.19.19.19.19.19.19.cmml" xref="S3.E5.m1.19.19.19.19.19.19">𝜃</ci><ci id="S3.E5.m1.20.20.20.20.20.20.1.cmml" xref="S3.E5.m1.20.20.20.20.20.20.1">𝑡</ci></apply><apply id="S3.E5.m1.21.21.21.21.21.21.1.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1"><times id="S3.E5.m1.21.21.21.21.21.21.1.1.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.1"></times><ci id="S3.E5.m1.21.21.21.21.21.21.1.2.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.2">𝑔</ci><ci id="S3.E5.m1.21.21.21.21.21.21.1.3.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.3">𝑙</ci><ci id="S3.E5.m1.21.21.21.21.21.21.1.4.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.4">𝑜</ci><ci id="S3.E5.m1.21.21.21.21.21.21.1.5.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.5">𝑏</ci><ci id="S3.E5.m1.21.21.21.21.21.21.1.6.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.6">𝑎</ci><ci id="S3.E5.m1.21.21.21.21.21.21.1.7.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.7">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.24c">\begin{split}&amp;\theta^{t}_{n}=\alpha_{n,1}\theta^{t}_{local,n}+\alpha_{n,2}\theta^{t}_{C(n)}+\alpha_{n,3}\theta^{t}_{global}.\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p11" class="ltx_para">
<p id="S3.SS1.p11.1" class="ltx_p">After obtaining the embeddings, an additional linear layer or a dot multiplication of the user and item embeddings could be used to get the rating prediction.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Server-Side Clustering Based Federation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Our proposed server-side federation module performs three main functions: user clustering, user selection, and parameter aggregation. At each iteration, encrypted and privacy protected user/item embeddings and models are uploaded to the server by the users.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.6" class="ltx_p"><math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mo id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\bullet</annotation></semantics></math> <span id="S3.SS2.p2.6.1" class="ltx_text ltx_font_bold">User Clustering.</span>
Based on user embeddings <math id="S3.SS2.p2.2.m2.2" class="ltx_Math" alttext="E_{u,n}" display="inline"><semantics id="S3.SS2.p2.2.m2.2a"><msub id="S3.SS2.p2.2.m2.2.3" xref="S3.SS2.p2.2.m2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.2.3.2" xref="S3.SS2.p2.2.m2.2.3.2.cmml">E</mi><mrow id="S3.SS2.p2.2.m2.2.2.2.4" xref="S3.SS2.p2.2.m2.2.2.2.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.cmml">u</mi><mo id="S3.SS2.p2.2.m2.2.2.2.4.1" xref="S3.SS2.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.2.m2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><apply id="S3.SS2.p2.2.m2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.2.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.3.2.cmml" xref="S3.SS2.p2.2.m2.2.3.2">𝐸</ci><list id="S3.SS2.p2.2.m2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.4"><ci id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1">𝑢</ci><ci id="S3.SS2.p2.2.m2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">E_{u,n}</annotation></semantics></math>, the server clusters users into <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">K</annotation></semantics></math> groups.
User <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">n</annotation></semantics></math> belongs to cluster <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="C(n)" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.2" xref="S3.SS2.p2.5.m5.1.2.cmml"><mi id="S3.SS2.p2.5.m5.1.2.2" xref="S3.SS2.p2.5.m5.1.2.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.2.1" xref="S3.SS2.p2.5.m5.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.5.m5.1.2.3.2" xref="S3.SS2.p2.5.m5.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.5.m5.1.2.3.2.1" xref="S3.SS2.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">n</mi><mo stretchy="false" id="S3.SS2.p2.5.m5.1.2.3.2.2" xref="S3.SS2.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.2.cmml" xref="S3.SS2.p2.5.m5.1.2"><times id="S3.SS2.p2.5.m5.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.2.1"></times><ci id="S3.SS2.p2.5.m5.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.2.2">𝐶</ci><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">C(n)</annotation></semantics></math>. We can use any commonly used clustering method such as K-means <cite class="ltx_cite ltx_citemacro_citep">(MacQueen et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">1967</a>)</cite>. Since the node representation <math id="S3.SS2.p2.6.m6.2" class="ltx_Math" alttext="E_{u,n}" display="inline"><semantics id="S3.SS2.p2.6.m6.2a"><msub id="S3.SS2.p2.6.m6.2.3" xref="S3.SS2.p2.6.m6.2.3.cmml"><mi id="S3.SS2.p2.6.m6.2.3.2" xref="S3.SS2.p2.6.m6.2.3.2.cmml">E</mi><mrow id="S3.SS2.p2.6.m6.2.2.2.4" xref="S3.SS2.p2.6.m6.2.2.2.3.cmml"><mi id="S3.SS2.p2.6.m6.1.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.1.cmml">u</mi><mo id="S3.SS2.p2.6.m6.2.2.2.4.1" xref="S3.SS2.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p2.6.m6.2.2.2.2" xref="S3.SS2.p2.6.m6.2.2.2.2.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.2b"><apply id="S3.SS2.p2.6.m6.2.3.cmml" xref="S3.SS2.p2.6.m6.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.2.3.1.cmml" xref="S3.SS2.p2.6.m6.2.3">subscript</csymbol><ci id="S3.SS2.p2.6.m6.2.3.2.cmml" xref="S3.SS2.p2.6.m6.2.3.2">𝐸</ci><list id="S3.SS2.p2.6.m6.2.2.2.3.cmml" xref="S3.SS2.p2.6.m6.2.2.2.4"><ci id="S3.SS2.p2.6.m6.1.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1.1">𝑢</ci><ci id="S3.SS2.p2.6.m6.2.2.2.2.cmml" xref="S3.SS2.p2.6.m6.2.2.2.2">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.2c">E_{u,n}</annotation></semantics></math> is jointly learned from the attribute and collaborative information at each user, the representation is therefore enhanced.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p"><math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mo id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\bullet</annotation></semantics></math> <span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_bold">User Selection.</span>
To reduce the communication cost in critical conditions, our framework has an optional cluster-based user selection ability. Within each cluster, we can adaptively select a few random users, proportional to the cluster size, to participate in the model aggregation in each iteration.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.7" class="ltx_p"><math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mo id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\bullet</annotation></semantics></math> <span id="S3.SS2.p4.7.1" class="ltx_text ltx_font_bold">Parameter Aggregation.</span>
Our framework perform both network model aggregation and embedding aggregation. The user embedding is stored at the local user device but may get exchanged via the server without revealing the user identity. Item embeddings are shared and updated by all clients. For network models, the server will aggregate a global model <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\theta^{t}_{global}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msubsup id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2.2" xref="S3.SS2.p4.2.m2.1.1.2.2.cmml">θ</mi><mrow id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1a" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.4" xref="S3.SS2.p4.2.m2.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1b" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.5" xref="S3.SS2.p4.2.m2.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1c" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.6" xref="S3.SS2.p4.2.m2.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1d" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.7" xref="S3.SS2.p4.2.m2.1.1.3.7.cmml">l</mi></mrow><mi id="S3.SS2.p4.2.m2.1.1.2.3" xref="S3.SS2.p4.2.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.2">𝜃</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><times id="S3.SS2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.1"></times><ci id="S3.SS2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.2">𝑔</ci><ci id="S3.SS2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3">𝑙</ci><ci id="S3.SS2.p4.2.m2.1.1.3.4.cmml" xref="S3.SS2.p4.2.m2.1.1.3.4">𝑜</ci><ci id="S3.SS2.p4.2.m2.1.1.3.5.cmml" xref="S3.SS2.p4.2.m2.1.1.3.5">𝑏</ci><ci id="S3.SS2.p4.2.m2.1.1.3.6.cmml" xref="S3.SS2.p4.2.m2.1.1.3.6">𝑎</ci><ci id="S3.SS2.p4.2.m2.1.1.3.7.cmml" xref="S3.SS2.p4.2.m2.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\theta^{t}_{global}</annotation></semantics></math> (via a weighted sum of all participating users) and cluster-wise models <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="\theta^{t}_{C(n)}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><msubsup id="S3.SS2.p4.3.m3.1.2" xref="S3.SS2.p4.3.m3.1.2.cmml"><mi id="S3.SS2.p4.3.m3.1.2.2.2" xref="S3.SS2.p4.3.m3.1.2.2.2.cmml">θ</mi><mrow id="S3.SS2.p4.3.m3.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.1.3" xref="S3.SS2.p4.3.m3.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.3.m3.1.1.1.2" xref="S3.SS2.p4.3.m3.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.3.m3.1.1.1.4.2" xref="S3.SS2.p4.3.m3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.3.m3.1.1.1.4.2.1" xref="S3.SS2.p4.3.m3.1.1.1.cmml">(</mo><mi id="S3.SS2.p4.3.m3.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S3.SS2.p4.3.m3.1.1.1.4.2.2" xref="S3.SS2.p4.3.m3.1.1.1.cmml">)</mo></mrow></mrow><mi id="S3.SS2.p4.3.m3.1.2.2.3" xref="S3.SS2.p4.3.m3.1.2.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.2.cmml" xref="S3.SS2.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.2.1.cmml" xref="S3.SS2.p4.3.m3.1.2">subscript</csymbol><apply id="S3.SS2.p4.3.m3.1.2.2.cmml" xref="S3.SS2.p4.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.2.2.1.cmml" xref="S3.SS2.p4.3.m3.1.2">superscript</csymbol><ci id="S3.SS2.p4.3.m3.1.2.2.2.cmml" xref="S3.SS2.p4.3.m3.1.2.2.2">𝜃</ci><ci id="S3.SS2.p4.3.m3.1.2.2.3.cmml" xref="S3.SS2.p4.3.m3.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1"><times id="S3.SS2.p4.3.m3.1.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.1.2"></times><ci id="S3.SS2.p4.3.m3.1.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.1.3">𝐶</ci><ci id="S3.SS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\theta^{t}_{C(n)}</annotation></semantics></math> for cluster <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="C(n)" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mrow id="S3.SS2.p4.4.m4.1.2" xref="S3.SS2.p4.4.m4.1.2.cmml"><mi id="S3.SS2.p4.4.m4.1.2.2" xref="S3.SS2.p4.4.m4.1.2.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.2.1" xref="S3.SS2.p4.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS2.p4.4.m4.1.2.3.2" xref="S3.SS2.p4.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS2.p4.4.m4.1.2.3.2.1" xref="S3.SS2.p4.4.m4.1.2.cmml">(</mo><mi id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml">n</mi><mo stretchy="false" id="S3.SS2.p4.4.m4.1.2.3.2.2" xref="S3.SS2.p4.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.2.cmml" xref="S3.SS2.p4.4.m4.1.2"><times id="S3.SS2.p4.4.m4.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.2.1"></times><ci id="S3.SS2.p4.4.m4.1.2.2.cmml" xref="S3.SS2.p4.4.m4.1.2.2">𝐶</ci><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">C(n)</annotation></semantics></math> (via a weighted sum of all participating users in the cluster). The global model <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="\theta^{t}_{global}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><msubsup id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2.2" xref="S3.SS2.p4.5.m5.1.1.2.2.cmml">θ</mi><mrow id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml"><mi id="S3.SS2.p4.5.m5.1.1.3.2" xref="S3.SS2.p4.5.m5.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.1.3.1" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.5.m5.1.1.3.3" xref="S3.SS2.p4.5.m5.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.1.3.1a" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.5.m5.1.1.3.4" xref="S3.SS2.p4.5.m5.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.1.3.1b" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.5.m5.1.1.3.5" xref="S3.SS2.p4.5.m5.1.1.3.5.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.1.3.1c" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.5.m5.1.1.3.6" xref="S3.SS2.p4.5.m5.1.1.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.5.m5.1.1.3.1d" xref="S3.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.5.m5.1.1.3.7" xref="S3.SS2.p4.5.m5.1.1.3.7.cmml">l</mi></mrow><mi id="S3.SS2.p4.5.m5.1.1.2.3" xref="S3.SS2.p4.5.m5.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.2.1.cmml" xref="S3.SS2.p4.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2.2">𝜃</ci><ci id="S3.SS2.p4.5.m5.1.1.2.3.cmml" xref="S3.SS2.p4.5.m5.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3"><times id="S3.SS2.p4.5.m5.1.1.3.1.cmml" xref="S3.SS2.p4.5.m5.1.1.3.1"></times><ci id="S3.SS2.p4.5.m5.1.1.3.2.cmml" xref="S3.SS2.p4.5.m5.1.1.3.2">𝑔</ci><ci id="S3.SS2.p4.5.m5.1.1.3.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3.3">𝑙</ci><ci id="S3.SS2.p4.5.m5.1.1.3.4.cmml" xref="S3.SS2.p4.5.m5.1.1.3.4">𝑜</ci><ci id="S3.SS2.p4.5.m5.1.1.3.5.cmml" xref="S3.SS2.p4.5.m5.1.1.3.5">𝑏</ci><ci id="S3.SS2.p4.5.m5.1.1.3.6.cmml" xref="S3.SS2.p4.5.m5.1.1.3.6">𝑎</ci><ci id="S3.SS2.p4.5.m5.1.1.3.7.cmml" xref="S3.SS2.p4.5.m5.1.1.3.7">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\theta^{t}_{global}</annotation></semantics></math> and the cluster-level model <math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="\theta^{t}_{C(n)}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><msubsup id="S3.SS2.p4.6.m6.1.2" xref="S3.SS2.p4.6.m6.1.2.cmml"><mi id="S3.SS2.p4.6.m6.1.2.2.2" xref="S3.SS2.p4.6.m6.1.2.2.2.cmml">θ</mi><mrow id="S3.SS2.p4.6.m6.1.1.1" xref="S3.SS2.p4.6.m6.1.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.1.3" xref="S3.SS2.p4.6.m6.1.1.1.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.6.m6.1.1.1.2" xref="S3.SS2.p4.6.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p4.6.m6.1.1.1.4.2" xref="S3.SS2.p4.6.m6.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.6.m6.1.1.1.4.2.1" xref="S3.SS2.p4.6.m6.1.1.1.cmml">(</mo><mi id="S3.SS2.p4.6.m6.1.1.1.1" xref="S3.SS2.p4.6.m6.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S3.SS2.p4.6.m6.1.1.1.4.2.2" xref="S3.SS2.p4.6.m6.1.1.1.cmml">)</mo></mrow></mrow><mi id="S3.SS2.p4.6.m6.1.2.2.3" xref="S3.SS2.p4.6.m6.1.2.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.2.cmml" xref="S3.SS2.p4.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.2.1.cmml" xref="S3.SS2.p4.6.m6.1.2">subscript</csymbol><apply id="S3.SS2.p4.6.m6.1.2.2.cmml" xref="S3.SS2.p4.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.2.2.1.cmml" xref="S3.SS2.p4.6.m6.1.2">superscript</csymbol><ci id="S3.SS2.p4.6.m6.1.2.2.2.cmml" xref="S3.SS2.p4.6.m6.1.2.2.2">𝜃</ci><ci id="S3.SS2.p4.6.m6.1.2.2.3.cmml" xref="S3.SS2.p4.6.m6.1.2.2.3">𝑡</ci></apply><apply id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1.1"><times id="S3.SS2.p4.6.m6.1.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.1.2"></times><ci id="S3.SS2.p4.6.m6.1.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.1.3">𝐶</ci><ci id="S3.SS2.p4.6.m6.1.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1.1.1">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">\theta^{t}_{C(n)}</annotation></semantics></math> will be given to user <math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><mi id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><ci id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">n</annotation></semantics></math> for personalized recommendation.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we show the effectiveness of our proposed framework over real-world datasets and compare our PerFedRec with existing baseline methods.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experiment Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span>
To evaluate our proposed framework, we conduct experiments on the three real-world datasets, whose statistics can be found in Table <a href="#S4.T1" title="Table 1 ‣ 4.1. Experiment Setup ‣ 4. Experiments ‣ Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
MovieLens<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://grouplens.org/datasets/movielens/</span></span></span> is a movie rating dataset that is widely used for evaluating recommendation algorithms. We use MovieLens-100k, which includes 100,000 user ratings.
Yelp<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.yelp.com/dataset/challenge</span></span></span> is another widely-used benchmark dataset.
Amazon-Kindle<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://jmcauley.ucsd.edu/data/amazon/</span></span></span> is from the Amazon review data to recommend e-books to users.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Dataset description</figcaption>
<div id="S4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:290.7pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.7pt,1.8pt) scale(0.95,0.95) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Dataset</th>
<th id="S4.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"># of user</th>
<th id="S4.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"># of item</th>
<th id="S4.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"># of rating</th>
<th id="S4.T1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">sparsity</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">MovieLens-100K</th>
<td id="S4.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">943</td>
<td id="S4.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">1,682</td>
<td id="S4.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">100,000</td>
<td id="S4.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">93.70%</td>
</tr>
<tr id="S4.T1.1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Yelp</th>
<td id="S4.T1.1.1.3.2.2" class="ltx_td ltx_align_center">5,224</td>
<td id="S4.T1.1.1.3.2.3" class="ltx_td ltx_align_center">7,741</td>
<td id="S4.T1.1.1.3.2.4" class="ltx_td ltx_align_center">123,024</td>
<td id="S4.T1.1.1.3.2.5" class="ltx_td ltx_align_center">99.70%</td>
</tr>
<tr id="S4.T1.1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Amazon-Kindle</th>
<td id="S4.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b">7,650</td>
<td id="S4.T1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b">9,173</td>
<td id="S4.T1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b">137,124</td>
<td id="S4.T1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b">99.80%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Baseline Methods.</span>
We compare our proposed PerFedRec solution with FedGNN <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>)</cite>, a federated recommendation framework using the popular FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2017</a>)</cite> algorithm.
Recall that PerFedRec is designed to improve FedAvg by clustering users and making personalized recommendations.
We also compare our model with a centralized version.
Since we conduct the experiments in a federated setting, we leave out some classical recommendation algorithms because it is hard to adapt them to the federated setting.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.4" class="ltx_p"><span id="S4.SS1.p3.4.1" class="ltx_text ltx_font_bold">Settings. </span>
In our experiments, we use a lightweight model named LightGCN <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite> as the GNN model, and use the dot product to implement the rating predictor. The user and item embeddings and their hidden representations learned by graph neural networks are 64-dimensional.
Following previous works <cite class="ltx_cite ltx_citemacro_citep">(Deshpande and Karypis, <a href="#bib.bib5" title="" class="ltx_ref">2004</a>)</cite>, we apply the leave-one-out strategy for evaluation, and employ HR@K and NDCG@K to evaluate the performance. For each user, we use the last behavior for testing, the second to last for validation and the others for training. Similar to <cite class="ltx_cite ltx_citemacro_citep">(Muhammad et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Elkahky et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2015</a>)</cite>, we randomly sample 100 items that have no interaction with the user, and rank the test item among these items.
The number of users used in each round of model training is 128, and the default learning rate is 0.01. The hyper-parameters <math id="S4.SS1.p3.1.m1.2" class="ltx_Math" alttext="\alpha_{n,1}" display="inline"><semantics id="S4.SS1.p3.1.m1.2a"><msub id="S4.SS1.p3.1.m1.2.3" xref="S4.SS1.p3.1.m1.2.3.cmml"><mi id="S4.SS1.p3.1.m1.2.3.2" xref="S4.SS1.p3.1.m1.2.3.2.cmml">α</mi><mrow id="S4.SS1.p3.1.m1.2.2.2.4" xref="S4.SS1.p3.1.m1.2.2.2.3.cmml"><mi id="S4.SS1.p3.1.m1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.cmml">n</mi><mo id="S4.SS1.p3.1.m1.2.2.2.4.1" xref="S4.SS1.p3.1.m1.2.2.2.3.cmml">,</mo><mn id="S4.SS1.p3.1.m1.2.2.2.2" xref="S4.SS1.p3.1.m1.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.2b"><apply id="S4.SS1.p3.1.m1.2.3.cmml" xref="S4.SS1.p3.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.2.3.1.cmml" xref="S4.SS1.p3.1.m1.2.3">subscript</csymbol><ci id="S4.SS1.p3.1.m1.2.3.2.cmml" xref="S4.SS1.p3.1.m1.2.3.2">𝛼</ci><list id="S4.SS1.p3.1.m1.2.2.2.3.cmml" xref="S4.SS1.p3.1.m1.2.2.2.4"><ci id="S4.SS1.p3.1.m1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1">𝑛</ci><cn type="integer" id="S4.SS1.p3.1.m1.2.2.2.2.cmml" xref="S4.SS1.p3.1.m1.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.2c">\alpha_{n,1}</annotation></semantics></math>, <math id="S4.SS1.p3.2.m2.2" class="ltx_Math" alttext="\alpha_{n,2}" display="inline"><semantics id="S4.SS1.p3.2.m2.2a"><msub id="S4.SS1.p3.2.m2.2.3" xref="S4.SS1.p3.2.m2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.2.3.2" xref="S4.SS1.p3.2.m2.2.3.2.cmml">α</mi><mrow id="S4.SS1.p3.2.m2.2.2.2.4" xref="S4.SS1.p3.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.cmml">n</mi><mo id="S4.SS1.p3.2.m2.2.2.2.4.1" xref="S4.SS1.p3.2.m2.2.2.2.3.cmml">,</mo><mn id="S4.SS1.p3.2.m2.2.2.2.2" xref="S4.SS1.p3.2.m2.2.2.2.2.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.2b"><apply id="S4.SS1.p3.2.m2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.2.3.1.cmml" xref="S4.SS1.p3.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.p3.2.m2.2.3.2.cmml" xref="S4.SS1.p3.2.m2.2.3.2">𝛼</ci><list id="S4.SS1.p3.2.m2.2.2.2.3.cmml" xref="S4.SS1.p3.2.m2.2.2.2.4"><ci id="S4.SS1.p3.2.m2.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1">𝑛</ci><cn type="integer" id="S4.SS1.p3.2.m2.2.2.2.2.cmml" xref="S4.SS1.p3.2.m2.2.2.2.2">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.2c">\alpha_{n,2}</annotation></semantics></math>, <math id="S4.SS1.p3.3.m3.2" class="ltx_Math" alttext="\alpha_{n,3}" display="inline"><semantics id="S4.SS1.p3.3.m3.2a"><msub id="S4.SS1.p3.3.m3.2.3" xref="S4.SS1.p3.3.m3.2.3.cmml"><mi id="S4.SS1.p3.3.m3.2.3.2" xref="S4.SS1.p3.3.m3.2.3.2.cmml">α</mi><mrow id="S4.SS1.p3.3.m3.2.2.2.4" xref="S4.SS1.p3.3.m3.2.2.2.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml">n</mi><mo id="S4.SS1.p3.3.m3.2.2.2.4.1" xref="S4.SS1.p3.3.m3.2.2.2.3.cmml">,</mo><mn id="S4.SS1.p3.3.m3.2.2.2.2" xref="S4.SS1.p3.3.m3.2.2.2.2.cmml">3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.2b"><apply id="S4.SS1.p3.3.m3.2.3.cmml" xref="S4.SS1.p3.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.2.3.1.cmml" xref="S4.SS1.p3.3.m3.2.3">subscript</csymbol><ci id="S4.SS1.p3.3.m3.2.3.2.cmml" xref="S4.SS1.p3.3.m3.2.3.2">𝛼</ci><list id="S4.SS1.p3.3.m3.2.2.2.3.cmml" xref="S4.SS1.p3.3.m3.2.2.2.4"><ci id="S4.SS1.p3.3.m3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1">𝑛</ci><cn type="integer" id="S4.SS1.p3.3.m3.2.2.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.2c">\alpha_{n,3}</annotation></semantics></math> are set to <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="\frac{1}{3}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mfrac id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">1</mn><mn id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">3</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><divide id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"></divide><cn type="integer" id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">1</cn><cn type="integer" id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\frac{1}{3}</annotation></semantics></math>.
The hyper-parameters (e.g., learning rate, dropout rate) of baseline methods are selected according to the best performance
on the validation set.
The performance is averaged over 5 runs on the testing set.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Performance comparison (improv. represents the performance improvement of PerFedRec over FedAvg)</figcaption>
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:307.7pt;height:215.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-13.4pt,9.4pt) scale(0.92,0.92) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" colspan="2">Model</th>
<th id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Central</th>
<th id="S4.T2.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">FedAvg</th>
<th id="S4.T2.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">PerFedRec</th>
<th id="S4.T2.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Improv.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.2.1" class="ltx_tr">
<th id="S4.T2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S4.T2.1.1.2.1.1.1" class="ltx_ERROR undefined">\multirow</span>4*MovieLens</th>
<td id="S4.T2.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">HR@10</td>
<td id="S4.T2.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">0.6532</td>
<td id="S4.T2.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">0.4475</td>
<td id="S4.T2.1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">0.6119</td>
<td id="S4.T2.1.1.2.1.6" class="ltx_td ltx_align_left ltx_border_t">36.74%</td>
</tr>
<tr id="S4.T2.1.1.3.2" class="ltx_tr">
<th id="S4.T2.1.1.3.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.3.2.2" class="ltx_td ltx_align_left">NDCG@10</td>
<td id="S4.T2.1.1.3.2.3" class="ltx_td ltx_align_left">0.4337</td>
<td id="S4.T2.1.1.3.2.4" class="ltx_td ltx_align_left">0.2462</td>
<td id="S4.T2.1.1.3.2.5" class="ltx_td ltx_align_left">0.4409</td>
<td id="S4.T2.1.1.3.2.6" class="ltx_td ltx_align_left">79.08%</td>
</tr>
<tr id="S4.T2.1.1.4.3" class="ltx_tr">
<th id="S4.T2.1.1.4.3.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.4.3.2" class="ltx_td ltx_align_left ltx_border_t">HR@20</td>
<td id="S4.T2.1.1.4.3.3" class="ltx_td ltx_align_left ltx_border_t">0.8165</td>
<td id="S4.T2.1.1.4.3.4" class="ltx_td ltx_align_left ltx_border_t">0.6405</td>
<td id="S4.T2.1.1.4.3.5" class="ltx_td ltx_align_left ltx_border_t">0.7402</td>
<td id="S4.T2.1.1.4.3.6" class="ltx_td ltx_align_left ltx_border_t">15.57%</td>
</tr>
<tr id="S4.T2.1.1.5.4" class="ltx_tr">
<th id="S4.T2.1.1.5.4.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.5.4.2" class="ltx_td ltx_align_left">NDCG@20</td>
<td id="S4.T2.1.1.5.4.3" class="ltx_td ltx_align_left">0.4740</td>
<td id="S4.T2.1.1.5.4.4" class="ltx_td ltx_align_left">0.2954</td>
<td id="S4.T2.1.1.5.4.5" class="ltx_td ltx_align_left">0.4707</td>
<td id="S4.T2.1.1.5.4.6" class="ltx_td ltx_align_left">59.34%</td>
</tr>
<tr id="S4.T2.1.1.6.5" class="ltx_tr">
<th id="S4.T2.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S4.T2.1.1.6.5.1.1" class="ltx_ERROR undefined">\multirow</span>4*Yelp</th>
<td id="S4.T2.1.1.6.5.2" class="ltx_td ltx_align_left ltx_border_t">HR@10</td>
<td id="S4.T2.1.1.6.5.3" class="ltx_td ltx_align_left ltx_border_t">0.6497</td>
<td id="S4.T2.1.1.6.5.4" class="ltx_td ltx_align_left ltx_border_t">0.4422</td>
<td id="S4.T2.1.1.6.5.5" class="ltx_td ltx_align_left ltx_border_t">0.6058</td>
<td id="S4.T2.1.1.6.5.6" class="ltx_td ltx_align_left ltx_border_t">36.99%</td>
</tr>
<tr id="S4.T2.1.1.7.6" class="ltx_tr">
<th id="S4.T2.1.1.7.6.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.7.6.2" class="ltx_td ltx_align_left">NDCG@10</td>
<td id="S4.T2.1.1.7.6.3" class="ltx_td ltx_align_left">0.4099</td>
<td id="S4.T2.1.1.7.6.4" class="ltx_td ltx_align_left">0.2487</td>
<td id="S4.T2.1.1.7.6.5" class="ltx_td ltx_align_left">0.4040</td>
<td id="S4.T2.1.1.7.6.6" class="ltx_td ltx_align_left">62.44%</td>
</tr>
<tr id="S4.T2.1.1.8.7" class="ltx_tr">
<th id="S4.T2.1.1.8.7.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.8.7.2" class="ltx_td ltx_align_left ltx_border_t">HR@20</td>
<td id="S4.T2.1.1.8.7.3" class="ltx_td ltx_align_left ltx_border_t">0.8168</td>
<td id="S4.T2.1.1.8.7.4" class="ltx_td ltx_align_left ltx_border_t">0.6437</td>
<td id="S4.T2.1.1.8.7.5" class="ltx_td ltx_align_left ltx_border_t">0.7151</td>
<td id="S4.T2.1.1.8.7.6" class="ltx_td ltx_align_left ltx_border_t">11.09%</td>
</tr>
<tr id="S4.T2.1.1.9.8" class="ltx_tr">
<th id="S4.T2.1.1.9.8.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.9.8.2" class="ltx_td ltx_align_left">NDCG@20</td>
<td id="S4.T2.1.1.9.8.3" class="ltx_td ltx_align_left">0.4531</td>
<td id="S4.T2.1.1.9.8.4" class="ltx_td ltx_align_left">0.3000</td>
<td id="S4.T2.1.1.9.8.5" class="ltx_td ltx_align_left">0.4317</td>
<td id="S4.T2.1.1.9.8.6" class="ltx_td ltx_align_left">43.90%</td>
</tr>
<tr id="S4.T2.1.1.10.9" class="ltx_tr">
<th id="S4.T2.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">
<span id="S4.T2.1.1.10.9.1.1" class="ltx_ERROR undefined">\multirow</span>4*Kindle</th>
<td id="S4.T2.1.1.10.9.2" class="ltx_td ltx_align_left ltx_border_t">HR@10</td>
<td id="S4.T2.1.1.10.9.3" class="ltx_td ltx_align_left ltx_border_t">0.6382</td>
<td id="S4.T2.1.1.10.9.4" class="ltx_td ltx_align_left ltx_border_t">0.3936</td>
<td id="S4.T2.1.1.10.9.5" class="ltx_td ltx_align_left ltx_border_t">0.4514</td>
<td id="S4.T2.1.1.10.9.6" class="ltx_td ltx_align_left ltx_border_t">14.68%</td>
</tr>
<tr id="S4.T2.1.1.11.10" class="ltx_tr">
<th id="S4.T2.1.1.11.10.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.11.10.2" class="ltx_td ltx_align_left">NDCG@10</td>
<td id="S4.T2.1.1.11.10.3" class="ltx_td ltx_align_left">0.4102</td>
<td id="S4.T2.1.1.11.10.4" class="ltx_td ltx_align_left">0.2366</td>
<td id="S4.T2.1.1.11.10.5" class="ltx_td ltx_align_left">0.3111</td>
<td id="S4.T2.1.1.11.10.6" class="ltx_td ltx_align_left">31.49%</td>
</tr>
<tr id="S4.T2.1.1.12.11" class="ltx_tr">
<th id="S4.T2.1.1.12.11.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S4.T2.1.1.12.11.2" class="ltx_td ltx_align_left ltx_border_t">HR@20</td>
<td id="S4.T2.1.1.12.11.3" class="ltx_td ltx_align_left ltx_border_t">0.7742</td>
<td id="S4.T2.1.1.12.11.4" class="ltx_td ltx_align_left ltx_border_t">0.5218</td>
<td id="S4.T2.1.1.12.11.5" class="ltx_td ltx_align_left ltx_border_t">0.5548</td>
<td id="S4.T2.1.1.12.11.6" class="ltx_td ltx_align_left ltx_border_t">6.32%</td>
</tr>
<tr id="S4.T2.1.1.13.12" class="ltx_tr">
<th id="S4.T2.1.1.13.12.1" class="ltx_td ltx_th ltx_th_row ltx_border_b"></th>
<td id="S4.T2.1.1.13.12.2" class="ltx_td ltx_align_left ltx_border_b">NDCG@20</td>
<td id="S4.T2.1.1.13.12.3" class="ltx_td ltx_align_left ltx_border_b">0.4448</td>
<td id="S4.T2.1.1.13.12.4" class="ltx_td ltx_align_left ltx_border_b">0.2701</td>
<td id="S4.T2.1.1.13.12.5" class="ltx_td ltx_align_left ltx_border_b">0.3379</td>
<td id="S4.T2.1.1.13.12.6" class="ltx_td ltx_align_left ltx_border_b">25.10%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Performance under different # of clusters <math id="S4.T3.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T3.2.m1.1b"><mi id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><ci id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">K</annotation></semantics></math> on MovieLens dataset</figcaption>
<div id="S4.T3.5" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:279.2pt;height:68.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-7.3pt,1.8pt) scale(0.95,0.95) ;">
<table id="S4.T3.5.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.5.3.4.1" class="ltx_tr">
<th id="S4.T3.5.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"># of clusters</th>
<th id="S4.T3.5.3.4.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">HR@10</th>
<th id="S4.T3.5.3.4.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">NDCG@10</th>
<th id="S4.T3.5.3.4.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">HR@20</th>
<th id="S4.T3.5.3.4.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">NDCG@20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><math id="S4.T3.3.1.1.1.m1.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S4.T3.3.1.1.1.m1.1a"><mrow id="S4.T3.3.1.1.1.m1.1.1" xref="S4.T3.3.1.1.1.m1.1.1.cmml"><mi id="S4.T3.3.1.1.1.m1.1.1.2" xref="S4.T3.3.1.1.1.m1.1.1.2.cmml">K</mi><mo id="S4.T3.3.1.1.1.m1.1.1.1" xref="S4.T3.3.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.3.1.1.1.m1.1.1.3" xref="S4.T3.3.1.1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.3.1.1.1.m1.1b"><apply id="S4.T3.3.1.1.1.m1.1.1.cmml" xref="S4.T3.3.1.1.1.m1.1.1"><eq id="S4.T3.3.1.1.1.m1.1.1.1.cmml" xref="S4.T3.3.1.1.1.m1.1.1.1"></eq><ci id="S4.T3.3.1.1.1.m1.1.1.2.cmml" xref="S4.T3.3.1.1.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.T3.3.1.1.1.m1.1.1.3.cmml" xref="S4.T3.3.1.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.1.1.1.m1.1c">K=5</annotation></semantics></math></th>
<td id="S4.T3.3.1.1.2" class="ltx_td ltx_align_left ltx_border_t">0.6119</td>
<td id="S4.T3.3.1.1.3" class="ltx_td ltx_align_left ltx_border_t">0.4409</td>
<td id="S4.T3.3.1.1.4" class="ltx_td ltx_align_left ltx_border_t">0.7402</td>
<td id="S4.T3.3.1.1.5" class="ltx_td ltx_align_left ltx_border_t">0.4707</td>
</tr>
<tr id="S4.T3.4.2.2" class="ltx_tr">
<th id="S4.T3.4.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.T3.4.2.2.1.m1.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S4.T3.4.2.2.1.m1.1a"><mrow id="S4.T3.4.2.2.1.m1.1.1" xref="S4.T3.4.2.2.1.m1.1.1.cmml"><mi id="S4.T3.4.2.2.1.m1.1.1.2" xref="S4.T3.4.2.2.1.m1.1.1.2.cmml">K</mi><mo id="S4.T3.4.2.2.1.m1.1.1.1" xref="S4.T3.4.2.2.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.4.2.2.1.m1.1.1.3" xref="S4.T3.4.2.2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.4.2.2.1.m1.1b"><apply id="S4.T3.4.2.2.1.m1.1.1.cmml" xref="S4.T3.4.2.2.1.m1.1.1"><eq id="S4.T3.4.2.2.1.m1.1.1.1.cmml" xref="S4.T3.4.2.2.1.m1.1.1.1"></eq><ci id="S4.T3.4.2.2.1.m1.1.1.2.cmml" xref="S4.T3.4.2.2.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.T3.4.2.2.1.m1.1.1.3.cmml" xref="S4.T3.4.2.2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.2.2.1.m1.1c">K=10</annotation></semantics></math></th>
<td id="S4.T3.4.2.2.2" class="ltx_td ltx_align_left">0.6214</td>
<td id="S4.T3.4.2.2.3" class="ltx_td ltx_align_left">0.4492</td>
<td id="S4.T3.4.2.2.4" class="ltx_td ltx_align_left">0.7470</td>
<td id="S4.T3.4.2.2.5" class="ltx_td ltx_align_left">0.4799</td>
</tr>
<tr id="S4.T3.5.3.3" class="ltx_tr">
<th id="S4.T3.5.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><math id="S4.T3.5.3.3.1.m1.1" class="ltx_Math" alttext="K=20" display="inline"><semantics id="S4.T3.5.3.3.1.m1.1a"><mrow id="S4.T3.5.3.3.1.m1.1.1" xref="S4.T3.5.3.3.1.m1.1.1.cmml"><mi id="S4.T3.5.3.3.1.m1.1.1.2" xref="S4.T3.5.3.3.1.m1.1.1.2.cmml">K</mi><mo id="S4.T3.5.3.3.1.m1.1.1.1" xref="S4.T3.5.3.3.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.5.3.3.1.m1.1.1.3" xref="S4.T3.5.3.3.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.5.3.3.1.m1.1b"><apply id="S4.T3.5.3.3.1.m1.1.1.cmml" xref="S4.T3.5.3.3.1.m1.1.1"><eq id="S4.T3.5.3.3.1.m1.1.1.1.cmml" xref="S4.T3.5.3.3.1.m1.1.1.1"></eq><ci id="S4.T3.5.3.3.1.m1.1.1.2.cmml" xref="S4.T3.5.3.3.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.T3.5.3.3.1.m1.1.1.3.cmml" xref="S4.T3.5.3.3.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.3.3.1.m1.1c">K=20</annotation></semantics></math></th>
<td id="S4.T3.5.3.3.2" class="ltx_td ltx_align_left ltx_border_b">0.6087</td>
<td id="S4.T3.5.3.3.3" class="ltx_td ltx_align_left ltx_border_b">0.4404</td>
<td id="S4.T3.5.3.3.4" class="ltx_td ltx_align_left ltx_border_b">0.7328</td>
<td id="S4.T3.5.3.3.5" class="ltx_td ltx_align_left ltx_border_b">0.4699</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Performance Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.1. Experiment Setup ‣ 4. Experiments ‣ Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the performance of all three methods on three datasets.
The centralized method achieves the best results in almost all scenarios, and
FedAvg achieves the worst results on all scenarios since it ignores the feature information and does not provide personalized recommendation.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">The performance of our proposed PerFedRec is close to the centralized method in most cases.
Compared to FedAvg, our proposed PerFedRec achieves an improvement of 29.47% in terms of HR@10 on average over all three datasets and 57.67% in terms of NDCG@10 on average over all three datasets.
The improvement (43.79% on average) is the most significant on the MovieLens dataset.
The improvement is smaller for sparser datasets such as Kindle while still achieving 19.40% on average.
In particular, the improvement on the Kindle dataset, which does not have external feature information, shows the importance of personalized recommendations.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Model Analysis</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We discuss the impacts of a key hyperparameter: the number of clusters <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">K</annotation></semantics></math> during model training. Table <a href="#S4.T3" title="Table 3 ‣ 4.1. Experiment Setup ‣ 4. Experiments ‣ Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> indicates that the performance is relatively stable under varying hyperparameters, which reduces the burden of hyperparameter tuning.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Ablation Study</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We conduct ablation study to evaluate how much each module of our proposed framework contributes to the performance. Specifically, PerFedRec-Variation 1 uses no personalized recommendation,
PerFedRec-Variation 2 uses no feature information,
and PerFedRec-Variation 3 uses no user clustering.
Table <a href="#S4.T4" title="Table 4 ‣ 4.4. Ablation Study ‣ 4. Experiments ‣ Personalized Federated Recommendation via Joint Representation Learning, User Clustering, and Model Adaptation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that the largest improvement comes from personalized recommendation. Moreover, incorporating feature information brings an obvious improvement on the performance. Finally, compared to Variation 3 (no user clustering), PerFedRec has negligible performance degradation while reducing communication cost by user clustering.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Ablation study on MovieLens dataset</figcaption>
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:286.5pt;height:76.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-25.3pt,6.8pt) scale(0.85,0.85) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Model</th>
<th id="S4.T4.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">HR@10</th>
<th id="S4.T4.1.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">NDCG@10</th>
<th id="S4.T4.1.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">HR@20</th>
<th id="S4.T4.1.1.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">NDCG@20</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.2.1" class="ltx_tr">
<td id="S4.T4.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">PerFedRec-Variation 1</td>
<td id="S4.T4.1.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">0.4464</td>
<td id="S4.T4.1.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">0.2497</td>
<td id="S4.T4.1.1.2.1.4" class="ltx_td ltx_align_left ltx_border_t">0.6405</td>
<td id="S4.T4.1.1.2.1.5" class="ltx_td ltx_align_left ltx_border_t">0.2965</td>
</tr>
<tr id="S4.T4.1.1.3.2" class="ltx_tr">
<td id="S4.T4.1.1.3.2.1" class="ltx_td ltx_align_left">PerFedRec-Variation 2</td>
<td id="S4.T4.1.1.3.2.2" class="ltx_td ltx_align_left">0.6087</td>
<td id="S4.T4.1.1.3.2.3" class="ltx_td ltx_align_left">0.4340</td>
<td id="S4.T4.1.1.3.2.4" class="ltx_td ltx_align_left">0.7381</td>
<td id="S4.T4.1.1.3.2.5" class="ltx_td ltx_align_left">0.4677</td>
</tr>
<tr id="S4.T4.1.1.4.3" class="ltx_tr">
<td id="S4.T4.1.1.4.3.1" class="ltx_td ltx_align_left">PerFedRec-Variation 3</td>
<td id="S4.T4.1.1.4.3.2" class="ltx_td ltx_align_left">0.6102</td>
<td id="S4.T4.1.1.4.3.3" class="ltx_td ltx_align_left">0.4453</td>
<td id="S4.T4.1.1.4.3.4" class="ltx_td ltx_align_left">0.7359</td>
<td id="S4.T4.1.1.4.3.5" class="ltx_td ltx_align_left">0.4766</td>
</tr>
<tr id="S4.T4.1.1.5.4" class="ltx_tr">
<td id="S4.T4.1.1.5.4.1" class="ltx_td ltx_align_left ltx_border_b">PerFedRec</td>
<td id="S4.T4.1.1.5.4.2" class="ltx_td ltx_align_left ltx_border_b">0.6119</td>
<td id="S4.T4.1.1.5.4.3" class="ltx_td ltx_align_left ltx_border_b">0.4409</td>
<td id="S4.T4.1.1.5.4.4" class="ltx_td ltx_align_left ltx_border_b">0.7402</td>
<td id="S4.T4.1.1.5.4.5" class="ltx_td ltx_align_left ltx_border_b">0.4707</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we highlight the importance of user clustering in personalized federated recommendations and propose a novel personalized federated recommendation framework. The proposed framework jointly learns user representations from collaborative and attribute information via GNNs, clusters similar users, and obtains personalized recommendation models by combining the user-level, cluster-level, and global models.
To alleviate the communication burden, we propose a sampling strategy to select representative clients from each cluster for model federation.
Experiments on three real-world datasets demonstrate that our proposed framework achieves superior performance for federated recommendation.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
This work was supported in part by the Changsha Science and Technology Program International and Regional Science and Technology Cooperation Project under Grants kh2201026, the Hong Kong RGC grant ECS 21212419, the Technological Breakthrough Project of Science, Technology and Innovation Commission of Shenzhen Municipality under Grants JSGG20201102162000001, InnoHK initiative, the Government of the HKSAR, Laboratory for AI-Powered Financial Technologies, the Hong Kong UGC Special Virtual Teaching and Learning (VTL) Grant 6430300, and the Tencent AI Lab Rhino-Bird Gift Fund.

</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ali et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Waqar Ali, Rajesh Kumar,
Zhiyi Deng, Yansong Wang, and
Jie Shao. 2021.

</span>
<span class="ltx_bibblock">A federated learning approach for privacy
protection in context-aware recommender systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">Comput. J.</em> 64,
7 (2021), 1016–1027.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ammad-Ud-Din et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Muhammad Ammad-Ud-Din,
Elena Ivannikova, Suleiman A Khan,
Were Oyomno, Qiang Fu,
Kuan Eeik Tan, and Adrian Flanagan.
2019.

</span>
<span class="ltx_bibblock">Federated collaborative filtering for
privacy-preserving personalized recommendation system.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.09888</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chai et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Di Chai, Leye Wang,
Kai Chen, and Qiang Yang.
2020.

</span>
<span class="ltx_bibblock">Secure federated matrix factorization.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">IEEE Intelligent Systems</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deshpande and Karypis (2004)</span>
<span class="ltx_bibblock">
Mukund Deshpande and
George Karypis. 2004.

</span>
<span class="ltx_bibblock">Item-based top-n recommendation algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Information Systems
(TOIS)</em> 22, 1 (2004),
143–177.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Yongjie Du, Deyun Zhou,
Yu Xie, Jiao Shi, and
Maoguo Gong. 2021.

</span>
<span class="ltx_bibblock">Federated matrix factorization for
privacy-preserving recommender systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Applied Soft Computing</em>
111 (2021), 107700.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elkahky et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Ali Mamdouh Elkahky, Yang
Song, and Xiaodong He. 2015.

</span>
<span class="ltx_bibblock">A multi-view deep learning approach for cross
domain user modeling in recommendation systems. In
<em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 24th international conference on
world wide web</em>. 278–288.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Yu Guo, Hongcheng Xie,
Yinbin Miao, Cong Wang, and
Xiaohua Jia. 2020.

</span>
<span class="ltx_bibblock">Fedcrowd: A federated and privacy-preserving
crowdsourcing platform on blockchain.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Services Computing</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng,
Xiang Wang, Yan Li,
Yongdong Zhang, and Meng Wang.
2020.

</span>
<span class="ltx_bibblock">Lightgcn: Simplifying and powering graph
convolution network for recommendation. In
<em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 43rd International ACM SIGIR
conference on research and development in Information Retrieval</em>.
639–648.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Zitao Li, Bolin Ding,
Ce Zhang, Ninghui Li, and
Jingren Zhou. 2021.

</span>
<span class="ltx_bibblock">Federated matrix factorization with privacy
guarantee.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">Proceedings of the VLDB Endowment</em>
15, 4 (2021),
900–913.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">MacQueen et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (1967)</span>
<span class="ltx_bibblock">
James MacQueen et al<span id="bib.bib11.3.1" class="ltx_text">.</span>
1967.

</span>
<span class="ltx_bibblock">Some methods for classification and analysis of
multivariate observations. In <em id="bib.bib11.4.1" class="ltx_emph ltx_font_italic">Proceedings of the
fifth Berkeley symposium on mathematical statistics and probability</em>,
Vol. 1. Oakland, CA, USA, 281–297.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib12.3.1" class="ltx_emph ltx_font_italic">Artificial
intelligence and statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Minto et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Lorenzo Minto, Moritz
Haller, Benjamin Livshits, and Hamed
Haddadi. 2021.

</span>
<span class="ltx_bibblock">Stronger Privacy for Federated Collaborative
Filtering With Implicit Feedback. In <em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">Fifteenth ACM
Conference on Recommender Systems</em>. 342–350.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muhammad et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Khalil Muhammad, Qinqin
Wang, Diarmuid O’Reilly-Morgan, Elias
Tragos, Barry Smyth, Neil Hurley,
James Geraci, and Aonghus Lawlor.
2020.

</span>
<span class="ltx_bibblock">Fedfast: Going beyond average for faster training
of federated recommender systems. In <em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">Proceedings
of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp;
Data Mining</em>. 1234–1242.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Savazzi et al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Stefano Savazzi, Monica
Nicoli, Mehdi Bennis, Sanaz Kianoush,
and Luca Barbieri. 2021.

</span>
<span class="ltx_bibblock">Opportunities of federated learning in connected,
cooperative, and automated industrial systems.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.3.1" class="ltx_emph ltx_font_italic">IEEE Communications Magazine</em>
59, 2 (2021),
16–21.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span id="bib.bib16.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Ben Tan, Bo Liu,
Vincent Zheng, and Qiang Yang.
2020.

</span>
<span class="ltx_bibblock">A federated recommender system for online
services. In <em id="bib.bib16.3.1" class="ltx_emph ltx_font_italic">Fourteenth ACM Conference on
Recommender Systems</em>. 579–581.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He,
Meng Wang, Fuli Feng, and
Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">Neural graph collaborative filtering. In
<em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 42nd international ACM SIGIR
conference on Research and development in Information Retrieval</em>.
165–174.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Chuhan Wu, Fangzhao Wu,
Yang Cao, Yongfeng Huang, and
Xing Xie. 2021.

</span>
<span class="ltx_bibblock">FedGNN: Federated graph neural network for
privacy-preserving recommendation.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.04925</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ying et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Rex Ying, Ruining He,
Kaifeng Chen, Pong Eksombatchai,
William L Hamilton, and Jure Leskovec.
2018.

</span>
<span class="ltx_bibblock">Graph convolutional neural networks for web-scale
recommender systems. In <em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 24th
ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>.
974–983.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Chen Zhang, Yu Guo,
Hongwei Du, and Xiaohua Jia.
2020.

</span>
<span class="ltx_bibblock">Pfcrowd: Privacy-preserving and federated
crowdsourcing framework by using blockchain. In
<em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">2020 IEEE/ACM 28th International Symposium on
Quality of Service (IWQoS)</em>. IEEE, 1–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2208.09374" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2208.09375" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2208.09375">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2208.09375" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2208.09377" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar 13 16:56:27 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
