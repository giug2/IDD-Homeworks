<!DOCTYPE html>
<html lang="en" prefix="dcterms: http://purl.org/dc/terms/">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Inverse Design of Copolymers Including Stoichiometry and Chain Architecture</title>
<!--Generated on Mon Sep 30 15:34:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02824v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S1" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS1" title="In 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Polymer representations</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS1.SSS1" title="In 2.1 Polymer representations ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Graph representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS1.SSS2" title="In 2.1 Polymer representations ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>String representation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS2" title="In 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS2.SSS1" title="In 2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Graph-2-string variational autoencoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS2.SSS2" title="In 2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Loss function</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS3" title="In 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Case study and dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS4" title="In 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>Training and evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS5" title="In 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Property optimization and inverse design</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS5.SSS1" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5.1 </span>Bayesian optimization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS5.SSS2" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5.2 </span>Genetic algorithm</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Results and Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS1" title="In 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Model evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS2" title="In 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Latent space</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS2.SSS1" title="In 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Latent space organization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS2.SSS2" title="In 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Smoothness of latent space</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS3" title="In 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Hyperparameter selection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4" title="In 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Inverse design of novel polymer photocatalysts for hydrogen production</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4.SSS0.Px1" title="In 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title">Discussion of the top 10 candidates</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS5" title="In 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Limitations and future work</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S4" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S5" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Data availability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S6" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Author contributions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional details on methods</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.SS1" title="In Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Polymer string tokenization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.SS2" title="In Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Variational lower bound of graph-2-string VAE</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.SS3" title="In Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Choice of target values in objective function</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2" title="In Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Additional results</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS1" title="In Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Impact of higher-order structure on polymer properties</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS2" title="In Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Polymer property prediction performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS3" title="In Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.3 </span>Additional latent space plots: Stoichiometry and chain architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS4" title="In Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4 </span>Polymer design without optimization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS4.SSS1" title="In B.4 Polymer design without optimization ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4.1 </span>Sampling the neighborhood of high-performing polymer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS4.SSS2" title="In B.4 Polymer design without optimization ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.4.2 </span>Interpolation between interesting candidates</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS5" title="In Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.5 </span>Additional inverse design experiments with varied property targets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS5.SSS1" title="In B.5 Additional inverse design experiments with varied property targets ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.5.1 </span>Target electronic properties of a known high-performing photocatalyst</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS5.SSS2" title="In B.5 Additional inverse design experiments with varied property targets ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.5.2 </span>Change of target values according to dataset statistics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS6" title="In Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.6 </span>Additional smoothness plot around known high-performing photocatalyst</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Inverse Design of Copolymers Including Stoichiometry and Chain Architecture</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Gabriel Vogel
<br class="ltx_break"/>Department of Intelligent Systems
<br class="ltx_break"/>Delft University of Technology
<br class="ltx_break"/>Delft 2629 HZ, The Netherlands 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">g.vogel@tudelft.nl</span>
<br class="ltx_break"/>&amp;Jana M. Weber
<br class="ltx_break"/>Department of Intelligent Systems
<br class="ltx_break"/>Delft University of Technology
<br class="ltx_break"/>Delft 2629 HZ, The Netherlands 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">j.m.weber@tudelft.nl</span>
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">The demand for innovative synthetic polymers with improved properties is high, but their structural complexity and vast design space hinder rapid discovery. Machine learning-guided molecular design is a promising approach to accelerate polymer discovery. However, the scarcity of labeled polymer data and the complex hierarchical structure of synthetic polymers make generative design particularly challenging. We advance the current state-of-the-art approaches to generate not only repeating units, but monomer ensembles including their stoichiometry and chain architecture. We build upon a recent polymer representation that includes stoichiometries and chain architectures of monomer ensembles and develop a novel variational autoencoder (VAE) architecture encoding a graph and decoding a string. Using a semi-supervised setup, we enable the handling of partly labelled datasets which can be benefitial for domains with a small corpus of labelled data. Our model learns a continuous, well organized latent space (LS) that enables de-novo generation of copolymer structures including different monomer stoichiometries and chain architectures. In an inverse design case study, we demonstrate our model for in-silico discovery of novel conjugated copolymer photocatalysts for hydrogen production using optimization of the polymer’s electron affinity and ionization potential in the latent space.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p" id="p1.4"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="p1.4.1">Keywords</em> generative molecular design  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.1.m1.1"><semantics id="p1.1.m1.1a"><mo id="p1.1.m1.1.1" xref="p1.1.m1.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.1.m1.1b"><ci id="p1.1.m1.1.1.cmml" xref="p1.1.m1.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.1.m1.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.1.m1.1d">⋅</annotation></semantics></math>
synthetic polymers  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.2.m2.1"><semantics id="p1.2.m2.1a"><mo id="p1.2.m2.1.1" xref="p1.2.m2.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.2.m2.1b"><ci id="p1.2.m2.1.1.cmml" xref="p1.2.m2.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.2.m2.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.2.m2.1d">⋅</annotation></semantics></math>
higher-order information  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.3.m3.1"><semantics id="p1.3.m3.1a"><mo id="p1.3.m3.1.1" xref="p1.3.m3.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.3.m3.1b"><ci id="p1.3.m3.1.1.cmml" xref="p1.3.m3.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.3.m3.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.3.m3.1d">⋅</annotation></semantics></math>
variational autoencoders  <math alttext="\cdot" class="ltx_Math" display="inline" id="p1.4.m4.1"><semantics id="p1.4.m4.1a"><mo id="p1.4.m4.1.1" xref="p1.4.m4.1.1.cmml">⋅</mo><annotation-xml encoding="MathML-Content" id="p1.4.m4.1b"><ci id="p1.4.m4.1.1.cmml" xref="p1.4.m4.1.1">⋅</ci></annotation-xml><annotation encoding="application/x-tex" id="p1.4.m4.1c">\cdot</annotation><annotation encoding="application/x-llamapun" id="p1.4.m4.1d">⋅</annotation></semantics></math>
transformers</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Polymers have evolved into a cornerstone of modern society, finding applications across diverse domains such as food packaging <cite class="ltx_cite ltx_citemacro_citep">(Mangaraj et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib1" title="">2019</a>)</cite>, textiles <cite class="ltx_cite ltx_citemacro_citep">(Morais et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib2" title="">2016</a>)</cite>, photovoltaics <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib3" title="">2016</a>)</cite>, clinical medicine <cite class="ltx_cite ltx_citemacro_citep">(Maitz, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib4" title="">2015</a>)</cite>, and many more. As the demand for innovative polymers surges, researchers face the task of navigating a vast design space. The space is uniquely characterized by the complexity of polymer materials which span from the chemical structure of monomers to diverse topologies and morphologies of the polymer material.
Traditionally, polymer design relies heavily on expert knowledge and trial-and-error of selected real-world experiments in the lab and in-silico simulations. Recently, machine learning (ML) has increasingly contributed to polymer informatics <cite class="ltx_cite ltx_citemacro_citep">(Yan and Li, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib5" title="">2023</a>; Hatakeyama-Sato, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib6" title="">2023</a>)</cite>, aiming to develop efficient strategies for polymer design. The core idea is to learn from existing polymer data, implicitly leveraging expert knowledge, to navigate the vast design space and find promising polymer candidates. These candidates can then be evaluated through in-silico experiments and synthesized and tested in the lab.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">There are two prominent ML-based strategies to accelerate the discovery of new molecules <cite class="ltx_cite ltx_citemacro_citep">(Lavecchia, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib7" title="">2015</a>; Sanchez-Lengeling and Aspuru-Guzik, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib8" title="">2018</a>; Bilodeau et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib9" title="">2022</a>; Du et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib10" title="">2024</a>)</cite> also applicable to polymers. First, in direct design strategies <cite class="ltx_cite ltx_citemacro_citep">(Lavecchia and Di Giovanni, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib11" title="">2013</a>; Gómez-Bombarelli et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib12" title="">2016</a>)</cite>, ML models are trained to learn polymer structure-to-property relationships from known labelled polymer data. This approach can be used for virtual screening of polymer structure libraries to find the candidate with the best predicted properties. This provides an efficient way to limit the number of experiments. However, this approach is constrained by a selection bias of predefined polymer structures to test, only focusing on a very small fraction of the full design space. In response, in inverse design strategies <cite class="ltx_cite ltx_citemacro_cite">Sanchez-Lengeling and Aspuru-Guzik (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib8" title="">2018</a>); Sattari et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib13" title="">2021</a>)</cite> generative models are specifically trained to generate novel polymer structures with desired properties. One advantage of this approach is that candidate polymer structures do not need to be defined upfront. Labelled data and knowledge of the optimal property value is however still required. If trained correctly, this approach allows for iteratively optimizing toward novel polymers (not in the data library) with optimal properties (properties beyond the best values in the library). This can for instance be achieved through the combination of the generative model with optimization algorithms such as Bayesian optimization or genetic algorithms. In this work, we focus on the inverse design of polymers using generative modelling.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">An inverse design model requires a machine-readable representation that accurately captures the molecular structure and further can be generated by a generative model. This is especially challenging for polymers. Polymers possess a hierarchical structure spanning from the monomer chemistry to the polymer morphology. To a certain extent, all levels indicated in
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>(A) impact the material’s properties. At the smallest scale, polymers consist of monomer units with varying stoichiometries. Depending on the polymerization type and the reaction/processing conditions, the monomers can be arranged in diverse chain architectures, which are often described as polymer topologies. For instance, simply linear topologies with alternating, block, random, or other monomer arrangements exist. Other examples are lightly branched chains <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib14" title="">2011</a>)</cite>, hyperbranched <cite class="ltx_cite ltx_citemacro_citep">(Hult et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib15" title="">1999</a>)</cite>, cyclic <cite class="ltx_cite ltx_citemacro_citep">(Hadjichristidis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib16" title="">2001</a>)</cite> or star-shaped <cite class="ltx_cite ltx_citemacro_citep">(Bazan and Schrock, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib17" title="">1991</a>)</cite> polymer topologies. Further, the processing conditions influence morphological traits such as crystallinity and therewith also the properties <cite class="ltx_cite ltx_citemacro_citep">(Hatakeyama-Sato, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib6" title="">2023</a>)</cite>. Besides, many polymers are stochastic. That means that they are ensembles of macromolecules of differing sizes and weights (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>(B)), which complicates the use of just one single polymer representation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Numerous studies have employed descriptor-based fingerprinting in different variations to represent polymers as numerical vectors (see a comprehensive overview in <cite class="ltx_cite ltx_citemacro_citep">(Yan and Li, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib5" title="">2023</a>)</cite>). Polymer fingerprints have been widely used for predicting polymer properties <cite class="ltx_cite ltx_citemacro_citep">(Kuenneth et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib18" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib19" title="">2022</a>; Doan Tran et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib20" title="">2020</a>; Pilania et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib21" title="">2019</a>; Bhowmik et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib22" title="">2021</a>)</cite>, however and most notably, fingerprints are unsuitable for generative design. This is due to their non-invertibility, meaning that they cannot be uniquely mapped back and forth between the actual molecule and the fingerprint. In contrast, string and graph-based representations are invertible and thus appropriate for generative design.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Most string-based polymer representations, such as pSMILES <cite class="ltx_cite ltx_citemacro_cite">Ma and Luo (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib23" title="">2020</a>); Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib24" title="">2018</a>)</cite>, build upon the SMILES (Simplified Molecule Line Entry System) notation, adapting it for polymers by incorporating the repeating unit’s SMILES and connection points using the * symbol.
The pSMILES (or similar variants) has been used widely for the prediction of mechanical, thermal, thermodynamical, electronical and optical properties <cite class="ltx_cite ltx_citemacro_citep">(Kuenneth and Ramprasad, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib25" title="">2023</a>; Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib26" title="">2023</a>)</cite>. Moreover, it has been used to discover novel polymer structures with generative models <cite class="ltx_cite ltx_citemacro_cite">Batra et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib27" title="">2020</a>); Ma and Luo (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib23" title="">2020</a>); Ohno et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib28" title="">2023</a>); Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib29" title="">2023</a>)</cite>. While pSMILES efficiently describes repeat unit chemistries, it falls short in depicting monomer combinations, higher-order structures, and polymer stochasticity. BigSMILES, an extension by <cite class="ltx_cite ltx_citemacro_citet">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib30" title="">2019</a>)</cite>, offers greater flexibility, describing polymers as stochastic objects, accommodating multiple monomers and their connection points. However, BigSMILES lacks encoding for stoichiometry and processing history. G-BigSMILES <cite class="ltx_cite ltx_citemacro_citep">(Schneider et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib31" title="">2024</a>)</cite>, a recent work, extends the BigSMILES to include molecular weight distributions and connection probabilities, indirectly capturing monomer stoichiometry. The recent advances in the string-based polymer representations show promise for the development of more precise inverse design models, however these advanced representations have not yet been employed with generative models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Most polymer graph representations are simplified using only the molecular graph of one monomer or repeat unit <cite class="ltx_cite ltx_citemacro_citep">(Park et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib32" title="">2022</a>)</cite>. This can be applied for property prediction but also for generative design as shown in the work by <cite class="ltx_cite ltx_citemacro_citet">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib33" title="">2023</a>)</cite>.
Recent works aim to move towards polymer graphs that represent macromolecules instead of only the repeat unit. One proposed approach known as PolyGrammar <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib34" title="">2022</a>)</cite> makes use of hypergraphs to represent polymeric structures by explicitly defining sequences of monomers. It enables describing complex chain architectures and allows for generative design approaches, but does not account for the stochastic nature of polymer materials. Other approaches approximate the macromolecule by adding an additional edge (loop) between the connection points of the repeating unit <cite class="ltx_cite ltx_citemacro_citep">(Antoniuk et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib35" title="">2022</a>; Gurnani et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib36" title="">2023</a>)</cite>. Moreover, <cite class="ltx_cite ltx_citemacro_citet">Aldeghi and Coley (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite> introduced a polymer graph that comprises multiple monomers as subgraphs, which are interconnected by additional weighted edges. The introduction of weighted edges enables the authors to capture the stochastic nature of polymer as monomer ensembles and facilitates the description of diverse polymer types (e.g., homo- and copolymers including stoichiometry) and various chain architectures (such as alternating, block, random, and graft structures).</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Given the impact of structural and stochastic variability beyond the repeat unit on polymer properties, we believe that incorporating these factors is key to accurate inverse design of property-optimized polymers. Our work addresses this challenge. We build upon the recent graph representation <cite class="ltx_cite ltx_citemacro_citep">(Aldeghi and Coley, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite> and use a Graph-2-string Variational Autoencoder <cite class="ltx_cite ltx_citemacro_citep">(Vogel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib38" title="">2023</a>)</cite> for inverse design of copolymers. Our work generates polymers defined by their monomer chemistries, monomer stoichiometry, and chain architecture.
We lead our generative model towards the design of optimal polymers through two steps. Firstly, we present a semi-supervised VAE setup to enable working with partly labelled and unlabelled data. Secondly, we employ two molecular optimisation strategies in the continuous latent space, which were previously demonstrated successfully in the literature <cite class="ltx_cite ltx_citemacro_citep">(Griffiths and Hernández-Lobato, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib39" title="">2020</a>; Sousa et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib40" title="">2021</a>)</cite>.
We illustrate our approach in a case study for the in-silico discovery of novel photocatalysts for green hydrogen production.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><svg class="ltx_picture ltx_centering" height="199.22" id="S1.F1.pic1" overflow="visible" version="1.1" width="547.22"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,199.22) matrix(1 0 0 -1 0 0) translate(273.61,0) translate(0,99.61) matrix(1.0 0.0 0.0 1.0 -269 -95)"><foreignobject height="190" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="538"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="263" id="S1.F1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="x1.png" width="747"/></foreignobject></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Two aspects of the complexity of synthetic polymer structures that need to be considered in the design due to their impact on the polymer properties. (A) Polymers possess a hierarchical structure from monomer structures, their composition (homopolymer, copolymer, etc.) and stoichiometry to chain architecture and linking structure. (B) Polymers are often stochastic materials composed of macromolecules of different lengths and weights.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section first explains the employed graph and text-based polymer representations briefly. Afterwards, we outline the general concept of VAEs and explain the detailed model architecture of the semi-supervised Graph-2-string VAE developed in this work. We then introduce the case study and dataset of copolymer photocatalysts for hydrogen production. Furthermore, we explain the evaluation metrics and conclude with details on the optimization in latent space.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Polymer representations</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Our approach integrates graph- and string-based representations, as depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.F2" title="Figure 2 ‣ 2.1.2 String representation ‣ 2.1 Polymer representations ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2</span></a>. Both represent the polymers as stochastic ensembles, including stoichiometry and chain architecture information.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Graph representation</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p1">
<p class="ltx_p" id="S2.SS1.SSS1.p1.5">Each polymer graph <math alttext="G^{(i)}=\{V^{(i)},E^{(i)}\}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.1.m1.5"><semantics id="S2.SS1.SSS1.p1.1.m1.5a"><mrow id="S2.SS1.SSS1.p1.1.m1.5.5" xref="S2.SS1.SSS1.p1.1.m1.5.5.cmml"><msup id="S2.SS1.SSS1.p1.1.m1.5.5.4" xref="S2.SS1.SSS1.p1.1.m1.5.5.4.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.5.5.4.2" xref="S2.SS1.SSS1.p1.1.m1.5.5.4.2.cmml">G</mi><mrow id="S2.SS1.SSS1.p1.1.m1.1.1.1.3" xref="S2.SS1.SSS1.p1.1.m1.5.5.4.cmml"><mo id="S2.SS1.SSS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.5.5.4.cmml">(</mo><mi id="S2.SS1.SSS1.p1.1.m1.1.1.1.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS1.SSS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.5.5.4.cmml">)</mo></mrow></msup><mo id="S2.SS1.SSS1.p1.1.m1.5.5.3" xref="S2.SS1.SSS1.p1.1.m1.5.5.3.cmml">=</mo><mrow id="S2.SS1.SSS1.p1.1.m1.5.5.2.2" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.3.cmml"><mo id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.3" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.3.cmml">{</mo><msup id="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.2" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.2.cmml">V</mi><mrow id="S2.SS1.SSS1.p1.1.m1.2.2.1.3" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.cmml"><mo id="S2.SS1.SSS1.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.cmml">(</mo><mi id="S2.SS1.SSS1.p1.1.m1.2.2.1.1" xref="S2.SS1.SSS1.p1.1.m1.2.2.1.1.cmml">i</mi><mo id="S2.SS1.SSS1.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.4" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.3.cmml">,</mo><msup id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.cmml"><mi id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.2" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.2.cmml">E</mi><mrow id="S2.SS1.SSS1.p1.1.m1.3.3.1.3" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.cmml"><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.3.1" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.cmml">(</mo><mi id="S2.SS1.SSS1.p1.1.m1.3.3.1.1" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1.cmml">i</mi><mo id="S2.SS1.SSS1.p1.1.m1.3.3.1.3.2" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.cmml">)</mo></mrow></msup><mo id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.5" stretchy="false" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.1.m1.5b"><apply id="S2.SS1.SSS1.p1.1.m1.5.5.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5"><eq id="S2.SS1.SSS1.p1.1.m1.5.5.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.3"></eq><apply id="S2.SS1.SSS1.p1.1.m1.5.5.4.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.5.5.4.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.4">superscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.5.5.4.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.4.2">𝐺</ci><ci id="S2.SS1.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1.1.1">𝑖</ci></apply><set id="S2.SS1.SSS1.p1.1.m1.5.5.2.3.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2"><apply id="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1">superscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.4.4.1.1.1.2">𝑉</ci><ci id="S2.SS1.SSS1.p1.1.m1.2.2.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2">superscript</csymbol><ci id="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.1.m1.5.5.2.2.2.2">𝐸</ci><ci id="S2.SS1.SSS1.p1.1.m1.3.3.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.3.3.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.1.m1.5c">G^{(i)}=\{V^{(i)},E^{(i)}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.1.m1.5d">italic_G start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = { italic_V start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_E start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT }</annotation></semantics></math> consists of nodes (or vertices) <math alttext="V_{i}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.2.m2.1"><semantics id="S2.SS1.SSS1.p1.2.m2.1a"><msub id="S2.SS1.SSS1.p1.2.m2.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.SSS1.p1.2.m2.1.1.2" xref="S2.SS1.SSS1.p1.2.m2.1.1.2.cmml">V</mi><mi id="S2.SS1.SSS1.p1.2.m2.1.1.3" xref="S2.SS1.SSS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.2.m2.1b"><apply id="S2.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.2">𝑉</ci><ci id="S2.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.2.m2.1c">V_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.2.m2.1d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> representing atoms and edges <math alttext="E_{i}" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.3.m3.1"><semantics id="S2.SS1.SSS1.p1.3.m3.1a"><msub id="S2.SS1.SSS1.p1.3.m3.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.SSS1.p1.3.m3.1.1.2" xref="S2.SS1.SSS1.p1.3.m3.1.1.2.cmml">E</mi><mi id="S2.SS1.SSS1.p1.3.m3.1.1.3" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.3.m3.1b"><apply id="S2.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.2">𝐸</ci><ci id="S2.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.3.m3.1c">E_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> representing bonds. In the graph representation by <cite class="ltx_cite ltx_citemacro_citet">Aldeghi and Coley (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite>, the edges are weighted according to the probability that they occur in the polymer. Bonds within the monomer structure have the weight <math alttext="w=1.0" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.4.m4.1"><semantics id="S2.SS1.SSS1.p1.4.m4.1a"><mrow id="S2.SS1.SSS1.p1.4.m4.1.1" xref="S2.SS1.SSS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.SSS1.p1.4.m4.1.1.2" xref="S2.SS1.SSS1.p1.4.m4.1.1.2.cmml">w</mi><mo id="S2.SS1.SSS1.p1.4.m4.1.1.1" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S2.SS1.SSS1.p1.4.m4.1.1.3" xref="S2.SS1.SSS1.p1.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.4.m4.1b"><apply id="S2.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1"><eq id="S2.SS1.SSS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.1"></eq><ci id="S2.SS1.SSS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.2">𝑤</ci><cn id="S2.SS1.SSS1.p1.4.m4.1.1.3.cmml" type="float" xref="S2.SS1.SSS1.p1.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.4.m4.1c">w=1.0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.4.m4.1d">italic_w = 1.0</annotation></semantics></math> and bonds between monomers have a weight <math alttext="w\in(0,\,1.0]" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.5.m5.2"><semantics id="S2.SS1.SSS1.p1.5.m5.2a"><mrow id="S2.SS1.SSS1.p1.5.m5.2.3" xref="S2.SS1.SSS1.p1.5.m5.2.3.cmml"><mi id="S2.SS1.SSS1.p1.5.m5.2.3.2" xref="S2.SS1.SSS1.p1.5.m5.2.3.2.cmml">w</mi><mo id="S2.SS1.SSS1.p1.5.m5.2.3.1" xref="S2.SS1.SSS1.p1.5.m5.2.3.1.cmml">∈</mo><mrow id="S2.SS1.SSS1.p1.5.m5.2.3.3.2" xref="S2.SS1.SSS1.p1.5.m5.2.3.3.1.cmml"><mo id="S2.SS1.SSS1.p1.5.m5.2.3.3.2.1" stretchy="false" xref="S2.SS1.SSS1.p1.5.m5.2.3.3.1.cmml">(</mo><mn id="S2.SS1.SSS1.p1.5.m5.1.1" xref="S2.SS1.SSS1.p1.5.m5.1.1.cmml">0</mn><mo id="S2.SS1.SSS1.p1.5.m5.2.3.3.2.2" xref="S2.SS1.SSS1.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S2.SS1.SSS1.p1.5.m5.2.2" xref="S2.SS1.SSS1.p1.5.m5.2.2.cmml"> 1.0</mn><mo id="S2.SS1.SSS1.p1.5.m5.2.3.3.2.3" stretchy="false" xref="S2.SS1.SSS1.p1.5.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.5.m5.2b"><apply id="S2.SS1.SSS1.p1.5.m5.2.3.cmml" xref="S2.SS1.SSS1.p1.5.m5.2.3"><in id="S2.SS1.SSS1.p1.5.m5.2.3.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.2.3.1"></in><ci id="S2.SS1.SSS1.p1.5.m5.2.3.2.cmml" xref="S2.SS1.SSS1.p1.5.m5.2.3.2">𝑤</ci><interval closure="open-closed" id="S2.SS1.SSS1.p1.5.m5.2.3.3.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.2.3.3.2"><cn id="S2.SS1.SSS1.p1.5.m5.1.1.cmml" type="integer" xref="S2.SS1.SSS1.p1.5.m5.1.1">0</cn><cn id="S2.SS1.SSS1.p1.5.m5.2.2.cmml" type="float" xref="S2.SS1.SSS1.p1.5.m5.2.2">1.0</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.5.m5.2c">w\in(0,\,1.0]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.5.m5.2d">italic_w ∈ ( 0 , 1.0 ]</annotation></semantics></math>. The weights reflect how monomers are connected, essentially depicting the chain architecture of the polymer. Furthermore, the stoichiometry is incorporated as node weights, where nodes of the same monomer have the same weight. The node weights are used during pooling in the graph neural network (GNN) introduced by <cite class="ltx_cite ltx_citemacro_citet">Aldeghi and Coley (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite>. We make use of their GNN architecture as encoder block for the VAE, see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS2" title="2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.2</span></a>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>String representation</h4>
<div class="ltx_para" id="S2.SS1.SSS2.p1">
<p class="ltx_p" id="S2.SS1.SSS2.p1.3">The string representation encapsulates stoichiometry and connection probabilities as numerical values next to the monomer SMILES. A polymer string <math alttext="\boldsymbol{x_{S}}^{(i)}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.1.m1.1"><semantics id="S2.SS1.SSS2.p1.1.m1.1a"><mmultiscripts id="S2.SS1.SSS2.p1.1.m1.1.2" xref="S2.SS1.SSS2.p1.1.m1.1.2.cmml"><mi id="S2.SS1.SSS2.p1.1.m1.1.2.2.2" xref="S2.SS1.SSS2.p1.1.m1.1.2.2.2.cmml">𝒙</mi><mi id="S2.SS1.SSS2.p1.1.m1.1.2.2.3" xref="S2.SS1.SSS2.p1.1.m1.1.2.2.3.cmml">𝑺</mi><mrow id="S2.SS1.SSS2.p1.1.m1.1.2a" xref="S2.SS1.SSS2.p1.1.m1.1.2.cmml"></mrow><mrow id="S2.SS1.SSS2.p1.1.m1.1.2b" xref="S2.SS1.SSS2.p1.1.m1.1.2.cmml"></mrow><mrow id="S2.SS1.SSS2.p1.1.m1.1.1.1.3" xref="S2.SS1.SSS2.p1.1.m1.1.2.cmml"><mo id="S2.SS1.SSS2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.1.m1.1.2.cmml">(</mo><mi id="S2.SS1.SSS2.p1.1.m1.1.1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.1.m1.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.1.m1.1b"><apply id="S2.SS1.SSS2.p1.1.m1.1.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.1.m1.1.2.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.2">superscript</csymbol><apply id="S2.SS1.SSS2.p1.1.m1.1.2.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.1.m1.1.2.2.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.1.m1.1.2.2.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.2.2.2">𝒙</ci><ci id="S2.SS1.SSS2.p1.1.m1.1.2.2.3.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.2.2.3">𝑺</ci></apply><ci id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.1.m1.1c">\boldsymbol{x_{S}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.1.m1.1d">bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> can be formally described as a sequence of tokens <math alttext="\boldsymbol{x_{S}}^{(i)}=\{\boldsymbol{x_{S}}_{1}^{(i)},\boldsymbol{x_{S}}_{2}%
^{(i)},...,\boldsymbol{x_{S}}_{N}^{(i)}\}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.2.m2.8"><semantics id="S2.SS1.SSS2.p1.2.m2.8a"><mrow id="S2.SS1.SSS2.p1.2.m2.8.8" xref="S2.SS1.SSS2.p1.2.m2.8.8.cmml"><mmultiscripts id="S2.SS1.SSS2.p1.2.m2.8.8.5" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.8.8.5.2.2" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.2.2.cmml">𝒙</mi><mi id="S2.SS1.SSS2.p1.2.m2.8.8.5.2.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.2.3.cmml">𝑺</mi><mrow id="S2.SS1.SSS2.p1.2.m2.8.8.5a" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml"></mrow><mrow id="S2.SS1.SSS2.p1.2.m2.8.8.5b" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml"></mrow><mrow id="S2.SS1.SSS2.p1.2.m2.1.1.1.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml">(</mo><mi id="S2.SS1.SSS2.p1.2.m2.1.1.1.1" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS1.SSS2.p1.2.m2.8.8.4" xref="S2.SS1.SSS2.p1.2.m2.8.8.4.cmml">=</mo><mrow id="S2.SS1.SSS2.p1.2.m2.8.8.3.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.4" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml">{</mo><mmultiscripts id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.2.cmml">𝒙</mi><mi id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.3" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.3.cmml">𝑺</mi><mrow id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1a" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.cmml"></mrow><mn id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.3" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.3.cmml">1</mn><mrow id="S2.SS1.SSS2.p1.2.m2.2.2.1.3" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.2.2.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.cmml">(</mo><mi id="S2.SS1.SSS2.p1.2.m2.2.2.1.1" xref="S2.SS1.SSS2.p1.2.m2.2.2.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.2.m2.2.2.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.5" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml">,</mo><mmultiscripts id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.2.cmml">𝒙</mi><mi id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.3" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.3.cmml">𝑺</mi><mrow id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2a" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.cmml"></mrow><mn id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.3" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.3.cmml">2</mn><mrow id="S2.SS1.SSS2.p1.2.m2.3.3.1.3" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.3.3.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.cmml">(</mo><mi id="S2.SS1.SSS2.p1.2.m2.3.3.1.1" xref="S2.SS1.SSS2.p1.2.m2.3.3.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.2.m2.3.3.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.6" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml">,</mo><mi id="S2.SS1.SSS2.p1.2.m2.5.5" mathvariant="normal" xref="S2.SS1.SSS2.p1.2.m2.5.5.cmml">…</mi><mo id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.7" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml">,</mo><mmultiscripts id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.2.cmml">𝒙</mi><mi id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.3.cmml">𝑺</mi><mrow id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3a" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.cmml"></mrow><mi id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.3.cmml">N</mi><mrow id="S2.SS1.SSS2.p1.2.m2.4.4.1.3" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.4.4.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.cmml">(</mo><mi id="S2.SS1.SSS2.p1.2.m2.4.4.1.1" xref="S2.SS1.SSS2.p1.2.m2.4.4.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.2.m2.4.4.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.cmml">)</mo></mrow></mmultiscripts><mo id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.8" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.2.m2.8b"><apply id="S2.SS1.SSS2.p1.2.m2.8.8.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8"><eq id="S2.SS1.SSS2.p1.2.m2.8.8.4.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.4"></eq><apply id="S2.SS1.SSS2.p1.2.m2.8.8.5.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.5"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.8.8.5.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.5">superscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.8.8.5.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.5"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.8.8.5.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.5">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.8.8.5.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.2.2">𝒙</ci><ci id="S2.SS1.SSS2.p1.2.m2.8.8.5.2.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.5.2.3">𝑺</ci></apply><ci id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1">𝑖</ci></apply><set id="S2.SS1.SSS2.p1.2.m2.8.8.3.4.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3"><apply id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1">superscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1">subscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.2">𝒙</ci><ci id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.2.3">𝑺</ci></apply><cn id="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.SSS2.p1.2.m2.6.6.1.1.1.2.3">1</cn></apply><ci id="S2.SS1.SSS2.p1.2.m2.2.2.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.2.2.1.1">𝑖</ci></apply><apply id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2">superscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2">subscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.2">𝒙</ci><ci id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.2.3">𝑺</ci></apply><cn id="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.SSS2.p1.2.m2.7.7.2.2.2.2.3">2</cn></apply><ci id="S2.SS1.SSS2.p1.2.m2.3.3.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.1.1">𝑖</ci></apply><ci id="S2.SS1.SSS2.p1.2.m2.5.5.cmml" xref="S2.SS1.SSS2.p1.2.m2.5.5">…</ci><apply id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3">superscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3">subscript</csymbol><apply id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.2">𝒙</ci><ci id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.2.3">𝑺</ci></apply><ci id="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.8.8.3.3.3.2.3">𝑁</ci></apply><ci id="S2.SS1.SSS2.p1.2.m2.4.4.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.4.4.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.2.m2.8c">\boldsymbol{x_{S}}^{(i)}=\{\boldsymbol{x_{S}}_{1}^{(i)},\boldsymbol{x_{S}}_{2}%
^{(i)},...,\boldsymbol{x_{S}}_{N}^{(i)}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.2.m2.8d">bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = { bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , … , bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="\boldsymbol{x_{S}}_{i}^{(i)}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.3.m3.1"><semantics id="S2.SS1.SSS2.p1.3.m3.1a"><mmultiscripts id="S2.SS1.SSS2.p1.3.m3.1.2" xref="S2.SS1.SSS2.p1.3.m3.1.2.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.1.2.2.2.2" xref="S2.SS1.SSS2.p1.3.m3.1.2.2.2.2.cmml">𝒙</mi><mi id="S2.SS1.SSS2.p1.3.m3.1.2.2.2.3" xref="S2.SS1.SSS2.p1.3.m3.1.2.2.2.3.cmml">𝑺</mi><mrow id="S2.SS1.SSS2.p1.3.m3.1.2a" xref="S2.SS1.SSS2.p1.3.m3.1.2.cmml"></mrow><mi id="S2.SS1.SSS2.p1.3.m3.1.2.2.3" xref="S2.SS1.SSS2.p1.3.m3.1.2.2.3.cmml">i</mi><mrow id="S2.SS1.SSS2.p1.3.m3.1.1.1.3" xref="S2.SS1.SSS2.p1.3.m3.1.2.cmml"><mo id="S2.SS1.SSS2.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS1.SSS2.p1.3.m3.1.1.1.1" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.3.m3.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.3.m3.1b"><apply id="S2.SS1.SSS2.p1.3.m3.1.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.1.2.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2">superscript</csymbol><apply id="S2.SS1.SSS2.p1.3.m3.1.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.1.2.2.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2">subscript</csymbol><apply id="S2.SS1.SSS2.p1.3.m3.1.2.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.1.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.3.m3.1.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2.2.2.2">𝒙</ci><ci id="S2.SS1.SSS2.p1.3.m3.1.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2.2.2.3">𝑺</ci></apply><ci id="S2.SS1.SSS2.p1.3.m3.1.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.2.2.3">𝑖</ci></apply><ci id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.3.m3.1c">\boldsymbol{x_{S}}_{i}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> can be a SMILES token describing the monomer chemistry or a numerical token as part of the stochiometry or chain architecture.
We use a tokenization scheme that combines a SMILES tokenizer and numerical number tokenizer adapted from the Regression Transformer <cite class="ltx_cite ltx_citemacro_cite">Born and Manica (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib41" title="">2022</a>)</cite>. In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.SS1" title="A.1 Polymer string tokenization ‣ Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">A.1</span></a> we show an example tokenization of a polymer string.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="180" id="S2.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Polymer representations accounting for stoichiometry of monomer ensembles, the chain architecture and the stochastic nature of polymers. The graph representation is adopted from <cite class="ltx_cite ltx_citemacro_citet">Aldeghi and Coley (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite>, with stochastic edges (dashed) reflecting the connection propbabilities between monomers, i.e. reflecting the chain archtiecture. The string representation is a text-based description of the polymer graph representation, concatenating monomer SMILES, stoichiometry and connection probabilities.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Model</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.8">We build on the general framework of a variational autoencoder (VAE) <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Welling, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib42" title="">2013</a>)</cite>, a probabilistic generative model. This model consists of an encoder network <math alttext="q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{\boldsymbol{x}})" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><msub id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">q</mi><mi class="ltx_mathvariant_bold-italic" id="S2.SS2.p1.1.m1.1.1.3.3" mathvariant="bold-italic" xref="S2.SS2.p1.1.m1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.1.m1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml">𝒛</mi><mo fence="false" id="S2.SS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml">𝒙</mi></mrow><mo id="S2.SS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2"></times><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">𝑞</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="S2.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.2">𝒛</ci><ci id="S2.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1.1.3">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{\boldsymbol{x}})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | bold_italic_x )</annotation></semantics></math> that maps high-dimensional data <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">bold_italic_x</annotation></semantics></math> to a latent space distribution <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.1"><semantics id="S2.SS2.p1.3.m3.1a"><mi id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.1d">bold_italic_z</annotation></semantics></math>, which is approximated by a Gaussian distribution with mean <math alttext="\mu" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><mi id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_μ</annotation></semantics></math> and variance <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><msup id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">σ</mi><mn id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝜎</ci><cn id="S2.SS2.p1.5.m5.1.1.3.cmml" type="integer" xref="S2.SS2.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. Additionally, it includes a decoder network <math alttext="p_{\boldsymbol{\theta}}(\boldsymbol{x}|\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mrow id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><msub id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml"><mi id="S2.SS2.p1.6.m6.1.1.3.2" xref="S2.SS2.p1.6.m6.1.1.3.2.cmml">p</mi><mi id="S2.SS2.p1.6.m6.1.1.3.3" xref="S2.SS2.p1.6.m6.1.1.3.3.cmml">𝜽</mi></msub><mo id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S2.SS2.p1.6.m6.1.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S2.SS2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p1.6.m6.1.1.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.1.1.1.2" xref="S2.SS2.p1.6.m6.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.SS2.p1.6.m6.1.1.1.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS2.p1.6.m6.1.1.1.1.1.3" xref="S2.SS2.p1.6.m6.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="S2.SS2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><times id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2"></times><apply id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.3.2.cmml" xref="S2.SS2.p1.6.m6.1.1.3.2">𝑝</ci><ci id="S2.SS2.p1.6.m6.1.1.3.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3">𝜽</ci></apply><apply id="S2.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.1.1.1.3">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">p_{\boldsymbol{\theta}}(\boldsymbol{x}|\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x | bold_italic_z )</annotation></semantics></math> that maps samples from the latent space <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">bold_italic_z</annotation></semantics></math> back to the data space, aiming to reconstruct the original input <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">bold_italic_x</annotation></semantics></math>.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Graph-2-string variational autoencoder</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.3">In the graph-2-string VAE we encode polymer graphs <math alttext="G_{i}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.1"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><msub id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml">G</mi><mi id="S2.SS2.SSS1.p1.1.m1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><apply id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.2">𝐺</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">G_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">italic_G start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to a latent embedding <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m2.1"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.1d">bold_italic_z</annotation></semantics></math> and use it to predict polymer properties and decode an equivalent polymer string <math alttext="\boldsymbol{x_{S}}^{(i)}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.3.m3.1"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><mmultiscripts id="S2.SS2.SSS1.p1.3.m3.1.2" xref="S2.SS2.SSS1.p1.3.m3.1.2.cmml"><mi id="S2.SS2.SSS1.p1.3.m3.1.2.2.2" xref="S2.SS2.SSS1.p1.3.m3.1.2.2.2.cmml">𝒙</mi><mi id="S2.SS2.SSS1.p1.3.m3.1.2.2.3" xref="S2.SS2.SSS1.p1.3.m3.1.2.2.3.cmml">𝑺</mi><mrow id="S2.SS2.SSS1.p1.3.m3.1.2a" xref="S2.SS2.SSS1.p1.3.m3.1.2.cmml"></mrow><mrow id="S2.SS2.SSS1.p1.3.m3.1.2b" xref="S2.SS2.SSS1.p1.3.m3.1.2.cmml"></mrow><mrow id="S2.SS2.SSS1.p1.3.m3.1.1.1.3" xref="S2.SS2.SSS1.p1.3.m3.1.2.cmml"><mo id="S2.SS2.SSS1.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.3.m3.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.3.m3.1.1.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.3.m3.1.2.cmml">)</mo></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><apply id="S2.SS2.SSS1.p1.3.m3.1.2.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.3.m3.1.2.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.3.m3.1.2.2.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.3.m3.1.2.2.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.3.m3.1.2.2.2.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.2.2.2">𝒙</ci><ci id="S2.SS2.SSS1.p1.3.m3.1.2.2.3.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.2.2.3">𝑺</ci></apply><ci id="S2.SS2.SSS1.p1.3.m3.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">\boldsymbol{x_{S}}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.3.m3.1d">bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> instead of the graph (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.F3" title="Figure 3 ‣ 2.2.1 Graph-2-string variational autoencoder ‣ 2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3</span></a>). <cite class="ltx_cite ltx_citemacro_citet">Dollar et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib43" title="">2023</a>)</cite> also demonstrated the benefits of using a graph-to-string VAE for small molecular design. Very recently, another work developed a graph-to-string VAE architecture in the field of drug design <cite class="ltx_cite ltx_citemacro_citep">(Müller et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib44" title="">2024</a>)</cite>, combining graph attention neural networks and recurrent neural networks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p2">
<p class="ltx_p" id="S2.SS2.SSS1.p2.3">To encode a polymer graph we re-implement the proposed weighted directed edge message passing neural network (wD-MPNN) <cite class="ltx_cite ltx_citemacro_citep">(Aldeghi and Coley, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite>. We use one wd-MPNN block with 3 layers and subsequently two parallel blocks that output a mean <math alttext="\mu" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.1.m1.1"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><mi id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><ci id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.1.m1.1d">italic_μ</annotation></semantics></math> and variance <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.2.m2.1"><semantics id="S2.SS2.SSS1.p2.2.m2.1a"><msup id="S2.SS2.SSS1.p2.2.m2.1.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p2.2.m2.1.1.2" xref="S2.SS2.SSS1.p2.2.m2.1.1.2.cmml">σ</mi><mn id="S2.SS2.SSS1.p2.2.m2.1.1.3" xref="S2.SS2.SSS1.p2.2.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m2.1b"><apply id="S2.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1.2">𝜎</ci><cn id="S2.SS2.SSS1.p2.2.m2.1.1.3.cmml" type="integer" xref="S2.SS2.SSS1.p2.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m2.1c">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.2.m2.1d">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> vector, respectively <cite class="ltx_cite ltx_citemacro_citep">(Vogel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib38" title="">2023</a>)</cite>. Then we use the reparametrization trick <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Welling, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib42" title="">2013</a>)</cite> to obtain the latent embedding <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p2.3.m3.1"><semantics id="S2.SS2.SSS1.p2.3.m3.1a"><mi id="S2.SS2.SSS1.p2.3.m3.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m3.1b"><ci id="S2.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m3.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p2.3.m3.1d">bold_italic_z</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p3">
<p class="ltx_p" id="S2.SS2.SSS1.p3.2">The latent embedding is fed to a Transformer-based <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib45" title="">2017</a>)</cite> language model consisting of four sequential layers with each four attention heads to decode the equivalent polymer string. In addition to the encoder-decoder cross attention between <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.1.m1.1"><semantics id="S2.SS2.SSS1.p3.1.m1.1a"><mi id="S2.SS2.SSS1.p3.1.m1.1.1" xref="S2.SS2.SSS1.p3.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.1.m1.1b"><ci id="S2.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.1.m1.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.1.m1.1d">bold_italic_z</annotation></semantics></math> and previously generated token embeddings, we concatenate <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p3.2.m2.1"><semantics id="S2.SS2.SSS1.p3.2.m2.1a"><mi id="S2.SS2.SSS1.p3.2.m2.1.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.2.m2.1b"><ci id="S2.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.2.m2.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p3.2.m2.1d">bold_italic_z</annotation></semantics></math> with each token embedding after the positional encoding, slightly different to <cite class="ltx_cite ltx_citemacro_citet">Fang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib46" title="">2021</a>)</cite> who added it element wise. This was motivated by work in the natural language domain showing that the combination of VAEs and Transformer decoder requires modifications that regulate how the latent space is fed to the decoder <cite class="ltx_cite ltx_citemacro_citep">(Fang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib46" title="">2021</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib47" title="">2020</a>)</cite>. This modification improved the reconstruction ability of the model substantially as demonstrated in <cite class="ltx_cite ltx_citemacro_cite">Vogel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib38" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p4">
<p class="ltx_p" id="S2.SS2.SSS1.p4.2">We further include knowledge about the properties in our model to generate a property-organised latent space. We adopt the approach of <cite class="ltx_cite ltx_citemacro_citet">Gómez-Bombarelli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib48" title="">2018</a>)</cite> that adds an additional feed-forward neural network taking the latent embedding <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p4.1.m1.1"><semantics id="S2.SS2.SSS1.p4.1.m1.1a"><mi id="S2.SS2.SSS1.p4.1.m1.1.1" xref="S2.SS2.SSS1.p4.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.1.m1.1b"><ci id="S2.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.1.m1.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p4.1.m1.1d">bold_italic_z</annotation></semantics></math> as input to predict a property <math alttext="y" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p4.2.m2.1"><semantics id="S2.SS2.SSS1.p4.2.m2.1a"><mi id="S2.SS2.SSS1.p4.2.m2.1.1" xref="S2.SS2.SSS1.p4.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.2.m2.1b"><ci id="S2.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p4.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p4.2.m2.1d">italic_y</annotation></semantics></math> (or multiple) that is jointly trained with the VAE architecture consisting of encoder and decoder networks.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="430" id="S2.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Semi-supervised Graph-2-string VAE architecture. The polymers are represented as graphs and encoded in a wD-MPNN (weighted directed message passing neural network) to obtain mean <math alttext="\mu" class="ltx_Math" display="inline" id="S2.F3.7.m1.1"><semantics id="S2.F3.7.m1.1b"><mi id="S2.F3.7.m1.1.1" xref="S2.F3.7.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.F3.7.m1.1c"><ci id="S2.F3.7.m1.1.1.cmml" xref="S2.F3.7.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.7.m1.1d">\mu</annotation><annotation encoding="application/x-llamapun" id="S2.F3.7.m1.1e">italic_μ</annotation></semantics></math> and variance <math alttext="\sigma^{2}" class="ltx_Math" display="inline" id="S2.F3.8.m2.1"><semantics id="S2.F3.8.m2.1b"><msup id="S2.F3.8.m2.1.1" xref="S2.F3.8.m2.1.1.cmml"><mi id="S2.F3.8.m2.1.1.2" xref="S2.F3.8.m2.1.1.2.cmml">σ</mi><mn id="S2.F3.8.m2.1.1.3" xref="S2.F3.8.m2.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.F3.8.m2.1c"><apply id="S2.F3.8.m2.1.1.cmml" xref="S2.F3.8.m2.1.1"><csymbol cd="ambiguous" id="S2.F3.8.m2.1.1.1.cmml" xref="S2.F3.8.m2.1.1">superscript</csymbol><ci id="S2.F3.8.m2.1.1.2.cmml" xref="S2.F3.8.m2.1.1.2">𝜎</ci><cn id="S2.F3.8.m2.1.1.3.cmml" type="integer" xref="S2.F3.8.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.8.m2.1d">\sigma^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.8.m2.1e">italic_σ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> tensors. The latent representation <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.F3.9.m3.1"><semantics id="S2.F3.9.m3.1b"><mi id="S2.F3.9.m3.1.1" xref="S2.F3.9.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.F3.9.m3.1c"><ci id="S2.F3.9.m3.1.1.cmml" xref="S2.F3.9.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.9.m3.1d">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.9.m3.1e">bold_italic_z</annotation></semantics></math> is sampled from a normal distribution parametrized by <math alttext="\mu" class="ltx_Math" display="inline" id="S2.F3.10.m4.1"><semantics id="S2.F3.10.m4.1b"><mi id="S2.F3.10.m4.1.1" xref="S2.F3.10.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.F3.10.m4.1c"><ci id="S2.F3.10.m4.1.1.cmml" xref="S2.F3.10.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.10.m4.1d">\mu</annotation><annotation encoding="application/x-llamapun" id="S2.F3.10.m4.1e">italic_μ</annotation></semantics></math> and <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.F3.11.m5.1"><semantics id="S2.F3.11.m5.1b"><mi id="S2.F3.11.m5.1.1" xref="S2.F3.11.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.F3.11.m5.1c"><ci id="S2.F3.11.m5.1.1.cmml" xref="S2.F3.11.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.11.m5.1d">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.F3.11.m5.1e">italic_σ</annotation></semantics></math>, using the reparametrization trick. The latent representation <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.F3.12.m6.1"><semantics id="S2.F3.12.m6.1b"><mi id="S2.F3.12.m6.1.1" xref="S2.F3.12.m6.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.F3.12.m6.1c"><ci id="S2.F3.12.m6.1.1.cmml" xref="S2.F3.12.m6.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.12.m6.1d">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.F3.12.m6.1e">bold_italic_z</annotation></semantics></math> is fed both to a feed forward neural network to predict polymer properties (for labelled data) and to the Transformer decoder to reconstruct the polymer in string format. </figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Loss function</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.5">The loss in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E1" title="In 2.2.2 Loss function ‣ 2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>) to train the graph-2-string VAE architecture consists of a reconstruction loss term <math alttext="\mathcal{L}_{Rec}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.1.m1.1"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><msub id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.1.m1.1.1.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p1.1.m1.1.1.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.1.m1.1.1.3.2" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.2.cmml">R</mi><mo id="S2.SS2.SSS2.p1.1.m1.1.1.3.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.1.m1.1.1.3.3" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS2.SSS2.p1.1.m1.1.1.3.1a" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.1.m1.1.1.3.4" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><apply id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.2">ℒ</ci><apply id="S2.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3"><times id="S2.SS2.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.2">𝑅</ci><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S2.SS2.SSS2.p1.1.m1.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">\mathcal{L}_{Rec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, Kullback-Leibler divergence loss <math alttext="\mathcal{L}_{KLD}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.2.m2.1"><semantics id="S2.SS2.SSS2.p1.2.m2.1a"><msub id="S2.SS2.SSS2.p1.2.m2.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.2.m2.1.1.2" xref="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p1.2.m2.1.1.3" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.1.1.3.2" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.2.cmml">K</mi><mo id="S2.SS2.SSS2.p1.2.m2.1.1.3.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.2.m2.1.1.3.3" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.3.cmml">L</mi><mo id="S2.SS2.SSS2.p1.2.m2.1.1.3.1a" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.2.m2.1.1.3.4" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.4.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m2.1b"><apply id="S2.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.2">ℒ</ci><apply id="S2.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3"><times id="S2.SS2.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.2">𝐾</ci><ci id="S2.SS2.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.3">𝐿</ci><ci id="S2.SS2.SSS2.p1.2.m2.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.3.4">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m2.1c">\mathcal{L}_{KLD}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_K italic_L italic_D end_POSTSUBSCRIPT</annotation></semantics></math> and an additional property loss term <math alttext="\mathcal{L}_{y}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.3.m3.1"><semantics id="S2.SS2.SSS2.p1.3.m3.1a"><msub id="S2.SS2.SSS2.p1.3.m3.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.3.m3.1.1.2" xref="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="S2.SS2.SSS2.p1.3.m3.1.1.3" xref="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m3.1b"><apply id="S2.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.2">ℒ</ci><ci id="S2.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m3.1c">\mathcal{L}_{y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math>. For additional details on the deriviation of the loss see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.SS2" title="A.2 Variational lower bound of graph-2-string VAE ‣ Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">A.2</span></a>. We further use two hyperparameters <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.4.m4.1"><semantics id="S2.SS2.SSS2.p1.4.m4.1a"><mi id="S2.SS2.SSS2.p1.4.m4.1.1" xref="S2.SS2.SSS2.p1.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.4.m4.1b"><ci id="S2.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p1.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.4.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.4.m4.1d">italic_β</annotation></semantics></math> and <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.5.m5.1"><semantics id="S2.SS2.SSS2.p1.5.m5.1a"><mi id="S2.SS2.SSS2.p1.5.m5.1.1" xref="S2.SS2.SSS2.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.5.m5.1b"><ci id="S2.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.5.m5.1d">italic_α</annotation></semantics></math> to balance the loss terms.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{Rec}+\beta\cdot\mathcal{L}_{KLD}+\alpha\cdot\mathcal{%
L}_{y}" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">ℒ</mi><mo id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><msub id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.3.2.2" xref="S2.E1.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E1.m1.1.1.3.2.3" xref="S2.E1.m1.1.1.3.2.3.cmml"><mi id="S2.E1.m1.1.1.3.2.3.2" xref="S2.E1.m1.1.1.3.2.3.2.cmml">R</mi><mo id="S2.E1.m1.1.1.3.2.3.1" xref="S2.E1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.3.2.3.3" xref="S2.E1.m1.1.1.3.2.3.3.cmml">e</mi><mo id="S2.E1.m1.1.1.3.2.3.1a" xref="S2.E1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.3.2.3.4" xref="S2.E1.m1.1.1.3.2.3.4.cmml">c</mi></mrow></msub><mo id="S2.E1.m1.1.1.3.1" xref="S2.E1.m1.1.1.3.1.cmml">+</mo><mrow id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.3.3.2" xref="S2.E1.m1.1.1.3.3.2.cmml">β</mi><mo id="S2.E1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.1.1.3.3.1.cmml">⋅</mo><msub id="S2.E1.m1.1.1.3.3.3" xref="S2.E1.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.3.3.3.2" xref="S2.E1.m1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S2.E1.m1.1.1.3.3.3.3" xref="S2.E1.m1.1.1.3.3.3.3.cmml"><mi id="S2.E1.m1.1.1.3.3.3.3.2" xref="S2.E1.m1.1.1.3.3.3.3.2.cmml">K</mi><mo id="S2.E1.m1.1.1.3.3.3.3.1" xref="S2.E1.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.3.3.3.3.3" xref="S2.E1.m1.1.1.3.3.3.3.3.cmml">L</mi><mo id="S2.E1.m1.1.1.3.3.3.3.1a" xref="S2.E1.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E1.m1.1.1.3.3.3.3.4" xref="S2.E1.m1.1.1.3.3.3.3.4.cmml">D</mi></mrow></msub></mrow><mo id="S2.E1.m1.1.1.3.1a" xref="S2.E1.m1.1.1.3.1.cmml">+</mo><mrow id="S2.E1.m1.1.1.3.4" xref="S2.E1.m1.1.1.3.4.cmml"><mi id="S2.E1.m1.1.1.3.4.2" xref="S2.E1.m1.1.1.3.4.2.cmml">α</mi><mo id="S2.E1.m1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.1.1.3.4.1.cmml">⋅</mo><msub id="S2.E1.m1.1.1.3.4.3" xref="S2.E1.m1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.3.4.3.2" xref="S2.E1.m1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S2.E1.m1.1.1.3.4.3.3" xref="S2.E1.m1.1.1.3.4.3.3.cmml">y</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"></eq><ci id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2">ℒ</ci><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><plus id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3.1"></plus><apply id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.3.2.2">ℒ</ci><apply id="S2.E1.m1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.3.2.3"><times id="S2.E1.m1.1.1.3.2.3.1.cmml" xref="S2.E1.m1.1.1.3.2.3.1"></times><ci id="S2.E1.m1.1.1.3.2.3.2.cmml" xref="S2.E1.m1.1.1.3.2.3.2">𝑅</ci><ci id="S2.E1.m1.1.1.3.2.3.3.cmml" xref="S2.E1.m1.1.1.3.2.3.3">𝑒</ci><ci id="S2.E1.m1.1.1.3.2.3.4.cmml" xref="S2.E1.m1.1.1.3.2.3.4">𝑐</ci></apply></apply><apply id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3"><ci id="S2.E1.m1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.3.3.1">⋅</ci><ci id="S2.E1.m1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.3.3.2">𝛽</ci><apply id="S2.E1.m1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.1.1.3.3.3.2">ℒ</ci><apply id="S2.E1.m1.1.1.3.3.3.3.cmml" xref="S2.E1.m1.1.1.3.3.3.3"><times id="S2.E1.m1.1.1.3.3.3.3.1.cmml" xref="S2.E1.m1.1.1.3.3.3.3.1"></times><ci id="S2.E1.m1.1.1.3.3.3.3.2.cmml" xref="S2.E1.m1.1.1.3.3.3.3.2">𝐾</ci><ci id="S2.E1.m1.1.1.3.3.3.3.3.cmml" xref="S2.E1.m1.1.1.3.3.3.3.3">𝐿</ci><ci id="S2.E1.m1.1.1.3.3.3.3.4.cmml" xref="S2.E1.m1.1.1.3.3.3.3.4">𝐷</ci></apply></apply></apply><apply id="S2.E1.m1.1.1.3.4.cmml" xref="S2.E1.m1.1.1.3.4"><ci id="S2.E1.m1.1.1.3.4.1.cmml" xref="S2.E1.m1.1.1.3.4.1">⋅</ci><ci id="S2.E1.m1.1.1.3.4.2.cmml" xref="S2.E1.m1.1.1.3.4.2">𝛼</ci><apply id="S2.E1.m1.1.1.3.4.3.cmml" xref="S2.E1.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.4.3.1.cmml" xref="S2.E1.m1.1.1.3.4.3">subscript</csymbol><ci id="S2.E1.m1.1.1.3.4.3.2.cmml" xref="S2.E1.m1.1.1.3.4.3.2">ℒ</ci><ci id="S2.E1.m1.1.1.3.4.3.3.cmml" xref="S2.E1.m1.1.1.3.4.3.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathcal{L}=\mathcal{L}_{Rec}+\beta\cdot\mathcal{L}_{KLD}+\alpha\cdot\mathcal{%
L}_{y}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT + italic_β ⋅ caligraphic_L start_POSTSUBSCRIPT italic_K italic_L italic_D end_POSTSUBSCRIPT + italic_α ⋅ caligraphic_L start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p1.8">The reconstruction loss <math alttext="\mathcal{L}_{Rec}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.6.m1.1"><semantics id="S2.SS2.SSS2.p1.6.m1.1a"><msub id="S2.SS2.SSS2.p1.6.m1.1.1" xref="S2.SS2.SSS2.p1.6.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p1.6.m1.1.1.2" xref="S2.SS2.SSS2.p1.6.m1.1.1.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p1.6.m1.1.1.3" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p1.6.m1.1.1.3.2" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.2.cmml">R</mi><mo id="S2.SS2.SSS2.p1.6.m1.1.1.3.1" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.6.m1.1.1.3.3" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.3.cmml">e</mi><mo id="S2.SS2.SSS2.p1.6.m1.1.1.3.1a" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.SSS2.p1.6.m1.1.1.3.4" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.6.m1.1b"><apply id="S2.SS2.SSS2.p1.6.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.6.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.6.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1.2">ℒ</ci><apply id="S2.SS2.SSS2.p1.6.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1.3"><times id="S2.SS2.SSS2.p1.6.m1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.1"></times><ci id="S2.SS2.SSS2.p1.6.m1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.2">𝑅</ci><ci id="S2.SS2.SSS2.p1.6.m1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.3">𝑒</ci><ci id="S2.SS2.SSS2.p1.6.m1.1.1.3.4.cmml" xref="S2.SS2.SSS2.p1.6.m1.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.6.m1.1c">\mathcal{L}_{Rec}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.6.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is calculated as the weighted cross entropy loss between the ground truth and predicted polymer string given the latent representation <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.7.m2.1"><semantics id="S2.SS2.SSS2.p1.7.m2.1a"><mi id="S2.SS2.SSS2.p1.7.m2.1.1" xref="S2.SS2.SSS2.p1.7.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.7.m2.1b"><ci id="S2.SS2.SSS2.p1.7.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.7.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.7.m2.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.7.m2.1d">bold_italic_z</annotation></semantics></math>. Further, as will be outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS3" title="2.3 Case study and dataset ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.3</span></a>, we have a combination of labelled and unlabelled data. To handle partially labelled data, we introduce a mask <math alttext="m" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.8.m3.1"><semantics id="S2.SS2.SSS2.p1.8.m3.1a"><mi id="S2.SS2.SSS2.p1.8.m3.1.1" xref="S2.SS2.SSS2.p1.8.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.8.m3.1b"><ci id="S2.SS2.SSS2.p1.8.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.8.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.8.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.8.m3.1d">italic_m</annotation></semantics></math> for the property loss</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{Rec}+\beta\cdot\mathcal{L}_{KLD}+\alpha\cdot m\cdot%
\mathcal{L}_{y}," class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><msub id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E2.m1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.3.2" xref="S2.E2.m1.1.1.1.1.3.2.3.2.cmml">R</mi><mo id="S2.E2.m1.1.1.1.1.3.2.3.1" xref="S2.E2.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.2.3.3" xref="S2.E2.m1.1.1.1.1.3.2.3.3.cmml">e</mi><mo id="S2.E2.m1.1.1.1.1.3.2.3.1a" xref="S2.E2.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.2.3.4" xref="S2.E2.m1.1.1.1.1.3.2.3.4.cmml">c</mi></mrow></msub><mo id="S2.E2.m1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.2.cmml">β</mi><mo id="S2.E2.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.1.1.1.1.3.3.1.cmml">⋅</mo><msub id="S2.E2.m1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S2.E2.m1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.3.3.2.cmml">K</mi><mo id="S2.E2.m1.1.1.1.1.3.3.3.3.1" xref="S2.E2.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.3.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.3.3.cmml">L</mi><mo id="S2.E2.m1.1.1.1.1.3.3.3.3.1a" xref="S2.E2.m1.1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.3.3.3.3.4" xref="S2.E2.m1.1.1.1.1.3.3.3.3.4.cmml">D</mi></mrow></msub></mrow><mo id="S2.E2.m1.1.1.1.1.3.1a" xref="S2.E2.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.3.4" xref="S2.E2.m1.1.1.1.1.3.4.cmml"><mi id="S2.E2.m1.1.1.1.1.3.4.2" xref="S2.E2.m1.1.1.1.1.3.4.2.cmml">α</mi><mo id="S2.E2.m1.1.1.1.1.3.4.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.1.1.1.1.3.4.1.cmml">⋅</mo><mi id="S2.E2.m1.1.1.1.1.3.4.3" xref="S2.E2.m1.1.1.1.1.3.4.3.cmml">m</mi><mo id="S2.E2.m1.1.1.1.1.3.4.1a" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.1.1.1.1.3.4.1.cmml">⋅</mo><msub id="S2.E2.m1.1.1.1.1.3.4.4" xref="S2.E2.m1.1.1.1.1.3.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.3.4.4.2" xref="S2.E2.m1.1.1.1.1.3.4.4.2.cmml">ℒ</mi><mi id="S2.E2.m1.1.1.1.1.3.4.4.3" xref="S2.E2.m1.1.1.1.1.3.4.4.3.cmml">y</mi></msub></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"></eq><ci id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2">ℒ</ci><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><plus id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1"></plus><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S2.E2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3"><times id="S2.E2.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3.1"></times><ci id="S2.E2.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3.2">𝑅</ci><ci id="S2.E2.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3.3">𝑒</ci><ci id="S2.E2.m1.1.1.1.1.3.2.3.4.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3.4">𝑐</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><ci id="S2.E2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.1">⋅</ci><ci id="S2.E2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S2.E2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S2.E2.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3"><times id="S2.E2.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S2.E2.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3.2">𝐾</ci><ci id="S2.E2.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3.3">𝐿</ci><ci id="S2.E2.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3.4">𝐷</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.4.cmml" xref="S2.E2.m1.1.1.1.1.3.4"><ci id="S2.E2.m1.1.1.1.1.3.4.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.1">⋅</ci><ci id="S2.E2.m1.1.1.1.1.3.4.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.2">𝛼</ci><ci id="S2.E2.m1.1.1.1.1.3.4.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.3">𝑚</ci><apply id="S2.E2.m1.1.1.1.1.3.4.4.cmml" xref="S2.E2.m1.1.1.1.1.3.4.4"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.4.4.1.cmml" xref="S2.E2.m1.1.1.1.1.3.4.4">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.4.4.2.cmml" xref="S2.E2.m1.1.1.1.1.3.4.4.2">ℒ</ci><ci id="S2.E2.m1.1.1.1.1.3.4.4.3.cmml" xref="S2.E2.m1.1.1.1.1.3.4.4.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\mathcal{L}=\mathcal{L}_{Rec}+\beta\cdot\mathcal{L}_{KLD}+\alpha\cdot m\cdot%
\mathcal{L}_{y},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT + italic_β ⋅ caligraphic_L start_POSTSUBSCRIPT italic_K italic_L italic_D end_POSTSUBSCRIPT + italic_α ⋅ italic_m ⋅ caligraphic_L start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.SSS2.p1.11">ensuring it is calculated solely for labelled data. This approach limits gradient computation to labelled instances, thereby updating the property prediction network based exclusively on labelled data in a batch with <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.9.m1.1"><semantics id="S2.SS2.SSS2.p1.9.m1.1a"><mi id="S2.SS2.SSS2.p1.9.m1.1.1" xref="S2.SS2.SSS2.p1.9.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.9.m1.1b"><ci id="S2.SS2.SSS2.p1.9.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.9.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.9.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.9.m1.1d">italic_N</annotation></semantics></math> samples. Given two (<math alttext="M=2" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.10.m2.1"><semantics id="S2.SS2.SSS2.p1.10.m2.1a"><mrow id="S2.SS2.SSS2.p1.10.m2.1.1" xref="S2.SS2.SSS2.p1.10.m2.1.1.cmml"><mi id="S2.SS2.SSS2.p1.10.m2.1.1.2" xref="S2.SS2.SSS2.p1.10.m2.1.1.2.cmml">M</mi><mo id="S2.SS2.SSS2.p1.10.m2.1.1.1" xref="S2.SS2.SSS2.p1.10.m2.1.1.1.cmml">=</mo><mn id="S2.SS2.SSS2.p1.10.m2.1.1.3" xref="S2.SS2.SSS2.p1.10.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.10.m2.1b"><apply id="S2.SS2.SSS2.p1.10.m2.1.1.cmml" xref="S2.SS2.SSS2.p1.10.m2.1.1"><eq id="S2.SS2.SSS2.p1.10.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p1.10.m2.1.1.1"></eq><ci id="S2.SS2.SSS2.p1.10.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p1.10.m2.1.1.2">𝑀</ci><cn id="S2.SS2.SSS2.p1.10.m2.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.10.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.10.m2.1c">M=2</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.10.m2.1d">italic_M = 2</annotation></semantics></math>) continuous properties <math alttext="P=\{p_{1},p_{2}\}" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.11.m3.2"><semantics id="S2.SS2.SSS2.p1.11.m3.2a"><mrow id="S2.SS2.SSS2.p1.11.m3.2.2" xref="S2.SS2.SSS2.p1.11.m3.2.2.cmml"><mi id="S2.SS2.SSS2.p1.11.m3.2.2.4" xref="S2.SS2.SSS2.p1.11.m3.2.2.4.cmml">P</mi><mo id="S2.SS2.SSS2.p1.11.m3.2.2.3" xref="S2.SS2.SSS2.p1.11.m3.2.2.3.cmml">=</mo><mrow id="S2.SS2.SSS2.p1.11.m3.2.2.2.2" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.3.cmml"><mo id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.3" stretchy="false" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.3.cmml">{</mo><msub id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.2.cmml">p</mi><mn id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.3" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.4" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.3.cmml">,</mo><msub id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.2" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.2.cmml">p</mi><mn id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.3" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.5" stretchy="false" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.11.m3.2b"><apply id="S2.SS2.SSS2.p1.11.m3.2.2.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2"><eq id="S2.SS2.SSS2.p1.11.m3.2.2.3.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2.3"></eq><ci id="S2.SS2.SSS2.p1.11.m3.2.2.4.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2.4">𝑃</ci><set id="S2.SS2.SSS2.p1.11.m3.2.2.2.3.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2"><apply id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.2">𝑝</ci><cn id="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.11.m3.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.2">𝑝</ci><cn id="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS2.SSS2.p1.11.m3.2.2.2.2.2.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.11.m3.2c">P=\{p_{1},p_{2}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.11.m3.2d">italic_P = { italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_p start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT }</annotation></semantics></math> of interest (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS3" title="2.3 Case study and dataset ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.3</span></a>), we design the neural network to output two property values and calculate the masked property prediction loss as the mean squared error averaged over the two properties and the number of samples in the batch.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="m\cdot\mathcal{L}_{y}=\frac{1}{N}\sum_{i=1}^{N}\left(\frac{1}{M}\sum_{j=1}^{M}%
\text{mask}(i,p_{j})\cdot(y_{p_{j},i}-\hat{y}_{p_{j},i}))^{2}\right)" class="ltx_math_unparsed" display="block" id="S2.E3.m1.5"><semantics id="S2.E3.m1.5a"><mrow id="S2.E3.m1.5b"><mi id="S2.E3.m1.5.6">m</mi><mo id="S2.E3.m1.5.7" lspace="0.222em" rspace="0.222em">⋅</mo><msub id="S2.E3.m1.5.8"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.8.2">ℒ</mi><mi id="S2.E3.m1.5.8.3">y</mi></msub><mo id="S2.E3.m1.5.9">=</mo><mfrac id="S2.E3.m1.5.10"><mn id="S2.E3.m1.5.10.2">1</mn><mi id="S2.E3.m1.5.10.3">N</mi></mfrac><munderover id="S2.E3.m1.5.11"><mo id="S2.E3.m1.5.11.2.2" movablelimits="false" rspace="0em">∑</mo><mrow id="S2.E3.m1.5.11.2.3"><mi id="S2.E3.m1.5.11.2.3.2">i</mi><mo id="S2.E3.m1.5.11.2.3.1">=</mo><mn id="S2.E3.m1.5.11.2.3.3">1</mn></mrow><mi id="S2.E3.m1.5.11.3">N</mi></munderover><msup id="S2.E3.m1.5.12"><mrow id="S2.E3.m1.5.12.2"><mo id="S2.E3.m1.5.12.2.1">(</mo><mfrac id="S2.E3.m1.5.12.2.2"><mn id="S2.E3.m1.5.12.2.2.2">1</mn><mi id="S2.E3.m1.5.12.2.2.3">M</mi></mfrac><munderover id="S2.E3.m1.5.12.2.3"><mo id="S2.E3.m1.5.12.2.3.2.2" movablelimits="false">∑</mo><mrow id="S2.E3.m1.5.12.2.3.2.3"><mi id="S2.E3.m1.5.12.2.3.2.3.2">j</mi><mo id="S2.E3.m1.5.12.2.3.2.3.1">=</mo><mn id="S2.E3.m1.5.12.2.3.2.3.3">1</mn></mrow><mi id="S2.E3.m1.5.12.2.3.3">M</mi></munderover><mtext id="S2.E3.m1.5.12.2.4">mask</mtext><mrow id="S2.E3.m1.5.12.2.5"><mo id="S2.E3.m1.5.12.2.5.1" stretchy="false">(</mo><mi id="S2.E3.m1.5.5">i</mi><mo id="S2.E3.m1.5.12.2.5.2">,</mo><msub id="S2.E3.m1.5.12.2.5.3"><mi id="S2.E3.m1.5.12.2.5.3.2">p</mi><mi id="S2.E3.m1.5.12.2.5.3.3">j</mi></msub><mo id="S2.E3.m1.5.12.2.5.4" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.5.12.2.6" rspace="0.222em">⋅</mo><mrow id="S2.E3.m1.5.12.2.7"><mo id="S2.E3.m1.5.12.2.7.1" stretchy="false">(</mo><msub id="S2.E3.m1.5.12.2.7.2"><mi id="S2.E3.m1.5.12.2.7.2.2">y</mi><mrow id="S2.E3.m1.2.2.2.2"><msub id="S2.E3.m1.2.2.2.2.1"><mi id="S2.E3.m1.2.2.2.2.1.2">p</mi><mi id="S2.E3.m1.2.2.2.2.1.3">j</mi></msub><mo id="S2.E3.m1.2.2.2.2.2">,</mo><mi id="S2.E3.m1.1.1.1.1">i</mi></mrow></msub><mo id="S2.E3.m1.5.12.2.7.3">−</mo><msub id="S2.E3.m1.5.12.2.7.4"><mover accent="true" id="S2.E3.m1.5.12.2.7.4.2"><mi id="S2.E3.m1.5.12.2.7.4.2.2">y</mi><mo id="S2.E3.m1.5.12.2.7.4.2.1">^</mo></mover><mrow id="S2.E3.m1.4.4.2.2"><msub id="S2.E3.m1.4.4.2.2.1"><mi id="S2.E3.m1.4.4.2.2.1.2">p</mi><mi id="S2.E3.m1.4.4.2.2.1.3">j</mi></msub><mo id="S2.E3.m1.4.4.2.2.2">,</mo><mi id="S2.E3.m1.3.3.1.1">i</mi></mrow></msub><mo id="S2.E3.m1.5.12.2.7.5" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.5.12.2.8" stretchy="false">)</mo></mrow><mn id="S2.E3.m1.5.12.3">2</mn></msup><mo id="S2.E3.m1.5.13">)</mo></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.5c">m\cdot\mathcal{L}_{y}=\frac{1}{N}\sum_{i=1}^{N}\left(\frac{1}{M}\sum_{j=1}^{M}%
\text{mask}(i,p_{j})\cdot(y_{p_{j},i}-\hat{y}_{p_{j},i}))^{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.5d">italic_m ⋅ caligraphic_L start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_M end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT mask ( italic_i , italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ⋅ ( italic_y start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_i end_POSTSUBSCRIPT - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_i end_POSTSUBSCRIPT ) ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Case study and dataset</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">We test our model in a case study to design novel conjugated copolymers which are emerging as promising organic photocatalysts for green hydrogen production through photocatalytic water splitting. The process involves a photocatalyst that absorbs light to generate charge carriers which reduce protons to hydrogen while oxidizing water or an electron donor. Addressing the vast synthetic diversity of conjugated polymers, <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>)</cite> conducted a high-throughput screening study to explore various copolymers, analyzing their hydrogen evolution rate (HER) as a measure of photocatalytic activity. Ultimately, we aim to find candidate polymers with improved catalytic activity (see Sections <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS5" title="2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.5</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4" title="3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.4</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">We base our study on the dataset introduced by <cite class="ltx_cite ltx_citemacro_citet">Aldeghi and Coley (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite> which is built upon the conjugated copolymer space of <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>)</cite>. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.F4" title="Figure 4 ‣ 2.3 Case study and dataset ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>, the dataset combines eight A-monomers with 682 B-monomers in stoichiometries of 1:1, 1:3, and 3:1 and three types of chain architectures (alternating, random, block). This leads to 42966 copolymers. The dataset additionally reports the ionization potential (IP) and electron affinity (EA), determined with DFT calculations for all 42966 polymer candidates <cite class="ltx_cite ltx_citemacro_citep">(Aldeghi and Coley, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite>.
Additionally, we construct an augmented version of the data set, allowing for B-B copolymers to increase the diversity of the chemical space of monomer A, comprising 138447 copolymers (ca. 3x the size of original dataset). The labels IP and EA are only available for the original data points, hence, we obtain a partly labelled dataset.</p>
</div>
<figure class="ltx_figure" id="S2.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="481" id="S2.F4.g1" src="x4.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Copolymer photocatalyst dataset from <cite class="ltx_cite ltx_citemacro_cite">Aldeghi and Coley (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite> that is used in this work. The polymer space consists of 9 A-monomers and 682 B-monomers that are combined in three stoichiometries (1:1, 1:3, 3:1) and three chain architectures (alternating, block, random). This forms a dataset of 42966 copolymers, including DFT-calculated polymer properties ionization potential (IP) and electron affinity (EA). We create an augmented data set without the property labels (ca. 3 times the size) by allowing the combination of B-B copolymers.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Training and evaluation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.4">We split the dataset in 80% training data, and 10% validation and 10% test data. Since we have multiple data points per monomer combination (varying stoichiomtry and chain architecture), we split the data by monomer combinations to prevent data leakage, i.e. ensuring that there are no monomer combinations in the test- or validation set that also occur in the training set. During training we apply the default teacher forcing in the Transformer decoder and use early stopping based on the evaluation on the held out validation set. During inference, i.e. the novel generation of molecules from latent embeddings <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.1"><semantics id="S2.SS4.p1.1.m1.1a"><mi id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><ci id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.1d">bold_italic_z</annotation></semantics></math>, we use beam search with a beam size of five to decode the polymer strings. This maximizes the final probability of the sequence and helps with generating valid SMILES. Where applicable, we adopted the hyperparameters of <cite class="ltx_cite ltx_citemacro_citep">(Vogel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib38" title="">2023</a>)</cite>, which is the unsupervised version (only encoder and decoder) of the model used in this work. To ensure a more stable training we use a cyclical schedule for <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><mi id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><ci id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">italic_β</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Fu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib50" title="">2019</a>)</cite>. Additionally, we performed a hyperparameter search over <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><mi id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><ci id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">italic_β</annotation></semantics></math> and <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS4.p1.4.m4.1"><semantics id="S2.SS4.p1.4.m4.1a"><mi id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><ci id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.4.m4.1d">italic_α</annotation></semantics></math> to balance the contribution of the loss terms in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E2" title="In 2.2.2 Loss function ‣ 2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2</span></a>). Note, that we limited the hyperparameter search of these parameters to a fixed number of evaluations in a random search approach and subsequent fine-grained grid search.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">During the hyperparameter search and to assess the final model performance, we calculate quantitative metrics that have been established in the small molecule domain: reconstruction, validity, novelty, and uniqueness, defined in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.T1" title="Table 1 ‣ 2.4 Training and evaluation ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>. Reconstruction is evaluated on the test set, encoding each sample to a latent point <math alttext="\boldsymbol{z}=\boldsymbol{\mu}" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.1"><semantics id="S2.SS4.p2.1.m1.1a"><mrow id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">𝒛</mi><mo id="S2.SS4.p2.1.m1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.cmml">=</mo><mi id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml">𝝁</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><eq id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1"></eq><ci id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">𝒛</ci><ci id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3">𝝁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">\boldsymbol{z}=\boldsymbol{\mu}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.1d">bold_italic_z = bold_italic_μ</annotation></semantics></math> and passing it to the decoder to produce the polymer string representation. Novelty and Uniqueness are evaluated for the sampled set which consists of 16000 polymers randomly sampled from Gaussian noise. Validity is calculated both for the reconstructed test set as well as the sampled set. In the results in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3" title="3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3</span></a> we use the best performing model according to these model metrics and qualitative assessments of the latent space structure. In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS3" title="3.3 Hyperparameter selection ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.3</span></a> we explain in more detail how we combine the quantitative and qualitative assessment.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Common quantitative metrics used for evaluation of different models during hyperparameter search. Reconstruction is evaluated for the test set while novelty and uniqueness are evaluated for a sampled set of 16000 polymers sampled from Gaussian noise. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T1.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S2.T1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.1.1.1.1">
<span class="ltx_p" id="S2.T1.1.1.1.1.1.1" style="width:65.0pt;">Metric</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S2.T1.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.1.1.2.1">
<span class="ltx_p" id="S2.T1.1.1.1.2.1.1" style="width:86.7pt;">Data</span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt" id="S2.T1.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.1.1.3.1">
<span class="ltx_p" id="S2.T1.1.1.1.3.1.1" style="width:238.5pt;">Definition</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S2.T1.1.2.1.1">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.2.1.1.1">
<span class="ltx_p" id="S2.T1.1.2.1.1.1.1" style="width:65.0pt;">Reconstruction</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S2.T1.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.2.1.2.1">
<span class="ltx_p" id="S2.T1.1.2.1.2.1.1" style="width:86.7pt;">test set</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S2.T1.1.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.2.1.3.1">
<span class="ltx_p" id="S2.T1.1.2.1.3.1.1" style="width:238.5pt;">Percent of correctly reconstructed molecules</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S2.T1.1.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.3.2.1.1">
<span class="ltx_p" id="S2.T1.1.3.2.1.1.1" style="width:65.0pt;">Validity</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S2.T1.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.3.2.2.1">
<span class="ltx_p" id="S2.T1.1.3.2.2.1.1" style="width:86.7pt;">test set, sampled set</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S2.T1.1.3.2.3">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.3.2.3.1">
<span class="ltx_p" id="S2.T1.1.3.2.3.1.1" style="width:238.5pt;">Percent of valid molecules evaluated using RDKit’s molecular structure parser <cite class="ltx_cite ltx_citemacro_cite">Bilodeau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib9" title="">2022</a>)</cite></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="S2.T1.1.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.4.3.1.1">
<span class="ltx_p" id="S2.T1.1.4.3.1.1.1" style="width:65.0pt;">Novelty</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S2.T1.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.4.3.2.1">
<span class="ltx_p" id="S2.T1.1.4.3.2.1.1" style="width:86.7pt;">sampled set</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S2.T1.1.4.3.3">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.4.3.3.1">
<span class="ltx_p" id="S2.T1.1.4.3.3.1.1" style="width:238.5pt;">Percent of molecules not present in training set <cite class="ltx_cite ltx_citemacro_cite">Bilodeau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib9" title="">2022</a>)</cite></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S2.T1.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S2.T1.1.5.4.1">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.5.4.1.1">
<span class="ltx_p" id="S2.T1.1.5.4.1.1.1" style="width:65.0pt;">Uniqueness</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S2.T1.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.5.4.2.1">
<span class="ltx_p" id="S2.T1.1.5.4.2.1.1" style="width:86.7pt;">sampled set</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S2.T1.1.5.4.3">
<span class="ltx_inline-block ltx_align_top" id="S2.T1.1.5.4.3.1">
<span class="ltx_p" id="S2.T1.1.5.4.3.1.1" style="width:238.5pt;">Percent of unique molecules <cite class="ltx_cite ltx_citemacro_cite">Bilodeau et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib9" title="">2022</a>)</cite></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Property optimization and inverse design</h3>
<div class="ltx_para ltx_noindent" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.1">To generate molecules with desired properties, we employ optimization in the numerical latent space of our trained VAE model. We define the 32 numerical latent dimensions as input variables for an optimization algorithm, denoted as <math alttext="\boldsymbol{z}=\{z_{1},z_{2},...,z_{32}\}" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.4"><semantics id="S2.SS5.p1.1.m1.4a"><mrow id="S2.SS5.p1.1.m1.4.4" xref="S2.SS5.p1.1.m1.4.4.cmml"><mi id="S2.SS5.p1.1.m1.4.4.5" xref="S2.SS5.p1.1.m1.4.4.5.cmml">𝒛</mi><mo id="S2.SS5.p1.1.m1.4.4.4" xref="S2.SS5.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS5.p1.1.m1.4.4.3.3" xref="S2.SS5.p1.1.m1.4.4.3.4.cmml"><mo id="S2.SS5.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS5.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S2.SS5.p1.1.m1.2.2.1.1.1" xref="S2.SS5.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS5.p1.1.m1.2.2.1.1.1.2" xref="S2.SS5.p1.1.m1.2.2.1.1.1.2.cmml">z</mi><mn id="S2.SS5.p1.1.m1.2.2.1.1.1.3" xref="S2.SS5.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS5.p1.1.m1.4.4.3.3.5" xref="S2.SS5.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS5.p1.1.m1.3.3.2.2.2" xref="S2.SS5.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS5.p1.1.m1.3.3.2.2.2.2" xref="S2.SS5.p1.1.m1.3.3.2.2.2.2.cmml">z</mi><mn id="S2.SS5.p1.1.m1.3.3.2.2.2.3" xref="S2.SS5.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS5.p1.1.m1.4.4.3.3.6" xref="S2.SS5.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS5.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS5.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS5.p1.1.m1.4.4.3.3.7" xref="S2.SS5.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.SS5.p1.1.m1.4.4.3.3.3" xref="S2.SS5.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS5.p1.1.m1.4.4.3.3.3.2" xref="S2.SS5.p1.1.m1.4.4.3.3.3.2.cmml">z</mi><mn id="S2.SS5.p1.1.m1.4.4.3.3.3.3" xref="S2.SS5.p1.1.m1.4.4.3.3.3.3.cmml">32</mn></msub><mo id="S2.SS5.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS5.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.4b"><apply id="S2.SS5.p1.1.m1.4.4.cmml" xref="S2.SS5.p1.1.m1.4.4"><eq id="S2.SS5.p1.1.m1.4.4.4.cmml" xref="S2.SS5.p1.1.m1.4.4.4"></eq><ci id="S2.SS5.p1.1.m1.4.4.5.cmml" xref="S2.SS5.p1.1.m1.4.4.5">𝒛</ci><set id="S2.SS5.p1.1.m1.4.4.3.4.cmml" xref="S2.SS5.p1.1.m1.4.4.3.3"><apply id="S2.SS5.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS5.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.2.2.1.1.1.2">𝑧</ci><cn id="S2.SS5.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS5.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS5.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS5.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS5.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS5.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS5.p1.1.m1.3.3.2.2.2.2">𝑧</ci><cn id="S2.SS5.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS5.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">…</ci><apply id="S2.SS5.p1.1.m1.4.4.3.3.3.cmml" xref="S2.SS5.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS5.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS5.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS5.p1.1.m1.4.4.3.3.3.2">𝑧</ci><cn id="S2.SS5.p1.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="S2.SS5.p1.1.m1.4.4.3.3.3.3">32</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.4c">\boldsymbol{z}=\{z_{1},z_{2},...,z_{32}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.4d">bold_italic_z = { italic_z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_z start_POSTSUBSCRIPT 32 end_POSTSUBSCRIPT }</annotation></semantics></math>.
The objective function is composed of target values for the predicted copolymer properties from the latent space. The ideal scenario would be to maximize for the HER, however, this property is not reported for the dataset we used to train our model. We use the observation <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>)</cite>, that the two electronic properties IP and EA are correlated to the HER of copolymer catalysts. Optimal target values for IP and EA can be derived for instance using expert knowledge, targeting a specific chemical region that is known to perform well (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS4" title="B.4 Polymer design without optimization ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">B.4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS5" title="B.5 Additional inverse design experiments with varied property targets ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">B.5</span></a>), or through observed trends in high-throughput studies. Hereinafter, we used the last option, deriving target values of EA and IP from the analysis in <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.2">Based on the findings in <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>)</cite>, we determine that IP<math alttext="\approx 1" class="ltx_Math" display="inline" id="S2.SS5.p2.1.m1.1"><semantics id="S2.SS5.p2.1.m1.1a"><mrow id="S2.SS5.p2.1.m1.1.1" xref="S2.SS5.p2.1.m1.1.1.cmml"><mi id="S2.SS5.p2.1.m1.1.1.2" xref="S2.SS5.p2.1.m1.1.1.2.cmml"></mi><mo id="S2.SS5.p2.1.m1.1.1.1" xref="S2.SS5.p2.1.m1.1.1.1.cmml">≈</mo><mn id="S2.SS5.p2.1.m1.1.1.3" xref="S2.SS5.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.1.m1.1b"><apply id="S2.SS5.p2.1.m1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1"><approx id="S2.SS5.p2.1.m1.1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1.1"></approx><csymbol cd="latexml" id="S2.SS5.p2.1.m1.1.1.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2">absent</csymbol><cn id="S2.SS5.p2.1.m1.1.1.3.cmml" type="integer" xref="S2.SS5.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.1.m1.1c">\approx 1</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.1.m1.1d">≈ 1</annotation></semantics></math> and more negative values of EA are indicative of better HERs and thus correlate to better photocatalysts. In Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.SS3" title="A.3 Choice of target values in objective function ‣ Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">A.3</span></a> we elaborate on the choice of the exact target values of IP and EA. Consequently, we seek to minimize the overall objective function <math alttext="f(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.p2.2.m2.1"><semantics id="S2.SS5.p2.2.m2.1a"><mrow id="S2.SS5.p2.2.m2.1.2" xref="S2.SS5.p2.2.m2.1.2.cmml"><mi id="S2.SS5.p2.2.m2.1.2.2" xref="S2.SS5.p2.2.m2.1.2.2.cmml">f</mi><mo id="S2.SS5.p2.2.m2.1.2.1" xref="S2.SS5.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.p2.2.m2.1.2.3.2" xref="S2.SS5.p2.2.m2.1.2.cmml"><mo id="S2.SS5.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS5.p2.2.m2.1.2.cmml">(</mo><mi id="S2.SS5.p2.2.m2.1.1" xref="S2.SS5.p2.2.m2.1.1.cmml">𝒛</mi><mo id="S2.SS5.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS5.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.2.m2.1b"><apply id="S2.SS5.p2.2.m2.1.2.cmml" xref="S2.SS5.p2.2.m2.1.2"><times id="S2.SS5.p2.2.m2.1.2.1.cmml" xref="S2.SS5.p2.2.m2.1.2.1"></times><ci id="S2.SS5.p2.2.m2.1.2.2.cmml" xref="S2.SS5.p2.2.m2.1.2.2">𝑓</ci><ci id="S2.SS5.p2.2.m2.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.2.m2.1c">f(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.2.m2.1d">italic_f ( bold_italic_z )</annotation></semantics></math></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(\boldsymbol{z})=|pp_{IP}(\boldsymbol{z})-1|+pp_{EA}(\boldsymbol{z})+pen_{inv%
}(\boldsymbol{x_{S}})." class="ltx_Math" display="block" id="S2.E4.m1.4"><semantics id="S2.E4.m1.4a"><mrow id="S2.E4.m1.4.4.1" xref="S2.E4.m1.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1" xref="S2.E4.m1.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.4" xref="S2.E4.m1.4.4.1.1.4.cmml"><mi id="S2.E4.m1.4.4.1.1.4.2" xref="S2.E4.m1.4.4.1.1.4.2.cmml">f</mi><mo id="S2.E4.m1.4.4.1.1.4.1" xref="S2.E4.m1.4.4.1.1.4.1.cmml">⁢</mo><mrow id="S2.E4.m1.4.4.1.1.4.3.2" xref="S2.E4.m1.4.4.1.1.4.cmml"><mo id="S2.E4.m1.4.4.1.1.4.3.2.1" stretchy="false" xref="S2.E4.m1.4.4.1.1.4.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝒛</mi><mo id="S2.E4.m1.4.4.1.1.4.3.2.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.4.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.4.4.1.1.3" xref="S2.E4.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.4.4.1.1.2" xref="S2.E4.m1.4.4.1.1.2.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.E4.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.2.1.cmml">|</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.2.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.2.cmml">p</mi><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.2.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.2.cmml">p</mi><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.2.cmml">I</mi><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.3.cmml">P</mi></mrow></msub><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.2.1a" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.2.4.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.2.4.2.1" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml">𝒛</mi><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.2.4.2.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.4.4.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mn id="S2.E4.m1.4.4.1.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.E4.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.E4.m1.4.4.1.1.2.3" xref="S2.E4.m1.4.4.1.1.2.3.cmml">+</mo><mrow id="S2.E4.m1.4.4.1.1.2.4" xref="S2.E4.m1.4.4.1.1.2.4.cmml"><mi id="S2.E4.m1.4.4.1.1.2.4.2" xref="S2.E4.m1.4.4.1.1.2.4.2.cmml">p</mi><mo id="S2.E4.m1.4.4.1.1.2.4.1" xref="S2.E4.m1.4.4.1.1.2.4.1.cmml">⁢</mo><msub id="S2.E4.m1.4.4.1.1.2.4.3" xref="S2.E4.m1.4.4.1.1.2.4.3.cmml"><mi id="S2.E4.m1.4.4.1.1.2.4.3.2" xref="S2.E4.m1.4.4.1.1.2.4.3.2.cmml">p</mi><mrow id="S2.E4.m1.4.4.1.1.2.4.3.3" xref="S2.E4.m1.4.4.1.1.2.4.3.3.cmml"><mi id="S2.E4.m1.4.4.1.1.2.4.3.3.2" xref="S2.E4.m1.4.4.1.1.2.4.3.3.2.cmml">E</mi><mo id="S2.E4.m1.4.4.1.1.2.4.3.3.1" xref="S2.E4.m1.4.4.1.1.2.4.3.3.1.cmml">⁢</mo><mi id="S2.E4.m1.4.4.1.1.2.4.3.3.3" xref="S2.E4.m1.4.4.1.1.2.4.3.3.3.cmml">A</mi></mrow></msub><mo id="S2.E4.m1.4.4.1.1.2.4.1a" xref="S2.E4.m1.4.4.1.1.2.4.1.cmml">⁢</mo><mrow id="S2.E4.m1.4.4.1.1.2.4.4.2" xref="S2.E4.m1.4.4.1.1.2.4.cmml"><mo id="S2.E4.m1.4.4.1.1.2.4.4.2.1" stretchy="false" xref="S2.E4.m1.4.4.1.1.2.4.cmml">(</mo><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">𝒛</mi><mo id="S2.E4.m1.4.4.1.1.2.4.4.2.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.2.4.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.4.4.1.1.2.3a" xref="S2.E4.m1.4.4.1.1.2.3.cmml">+</mo><mrow id="S2.E4.m1.4.4.1.1.2.2" xref="S2.E4.m1.4.4.1.1.2.2.cmml"><mi id="S2.E4.m1.4.4.1.1.2.2.3" xref="S2.E4.m1.4.4.1.1.2.2.3.cmml">p</mi><mo id="S2.E4.m1.4.4.1.1.2.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml">⁢</mo><mi id="S2.E4.m1.4.4.1.1.2.2.4" xref="S2.E4.m1.4.4.1.1.2.2.4.cmml">e</mi><mo id="S2.E4.m1.4.4.1.1.2.2.2a" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml">⁢</mo><msub id="S2.E4.m1.4.4.1.1.2.2.5" xref="S2.E4.m1.4.4.1.1.2.2.5.cmml"><mi id="S2.E4.m1.4.4.1.1.2.2.5.2" xref="S2.E4.m1.4.4.1.1.2.2.5.2.cmml">n</mi><mrow id="S2.E4.m1.4.4.1.1.2.2.5.3" xref="S2.E4.m1.4.4.1.1.2.2.5.3.cmml"><mi id="S2.E4.m1.4.4.1.1.2.2.5.3.2" xref="S2.E4.m1.4.4.1.1.2.2.5.3.2.cmml">i</mi><mo id="S2.E4.m1.4.4.1.1.2.2.5.3.1" xref="S2.E4.m1.4.4.1.1.2.2.5.3.1.cmml">⁢</mo><mi id="S2.E4.m1.4.4.1.1.2.2.5.3.3" xref="S2.E4.m1.4.4.1.1.2.2.5.3.3.cmml">n</mi><mo id="S2.E4.m1.4.4.1.1.2.2.5.3.1a" xref="S2.E4.m1.4.4.1.1.2.2.5.3.1.cmml">⁢</mo><mi id="S2.E4.m1.4.4.1.1.2.2.5.3.4" xref="S2.E4.m1.4.4.1.1.2.2.5.3.4.cmml">v</mi></mrow></msub><mo id="S2.E4.m1.4.4.1.1.2.2.2b" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml">⁢</mo><mrow id="S2.E4.m1.4.4.1.1.2.2.1.1" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.cmml"><mo id="S2.E4.m1.4.4.1.1.2.2.1.1.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.cmml">(</mo><msub id="S2.E4.m1.4.4.1.1.2.2.1.1.1" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.cmml"><mi id="S2.E4.m1.4.4.1.1.2.2.1.1.1.2" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.2.cmml">𝒙</mi><mi id="S2.E4.m1.4.4.1.1.2.2.1.1.1.3" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.3.cmml">𝑺</mi></msub><mo id="S2.E4.m1.4.4.1.1.2.2.1.1.3" stretchy="false" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.4.4.1.2" lspace="0em" xref="S2.E4.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.4b"><apply id="S2.E4.m1.4.4.1.1.cmml" xref="S2.E4.m1.4.4.1"><eq id="S2.E4.m1.4.4.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.3"></eq><apply id="S2.E4.m1.4.4.1.1.4.cmml" xref="S2.E4.m1.4.4.1.1.4"><times id="S2.E4.m1.4.4.1.1.4.1.cmml" xref="S2.E4.m1.4.4.1.1.4.1"></times><ci id="S2.E4.m1.4.4.1.1.4.2.cmml" xref="S2.E4.m1.4.4.1.1.4.2">𝑓</ci><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝒛</ci></apply><apply id="S2.E4.m1.4.4.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.2"><plus id="S2.E4.m1.4.4.1.1.2.3.cmml" xref="S2.E4.m1.4.4.1.1.2.3"></plus><apply id="S2.E4.m1.4.4.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1"><abs id="S2.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.2"></abs><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1"><minus id="S2.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1"></minus><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2"><times id="S2.E4.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.1"></times><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.2">𝑝</ci><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.2">𝑝</ci><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3"><times id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.1"></times><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.2">𝐼</ci><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.3.3.3">𝑃</ci></apply></apply><ci id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2">𝒛</ci></apply><cn id="S2.E4.m1.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E4.m1.4.4.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E4.m1.4.4.1.1.2.4.cmml" xref="S2.E4.m1.4.4.1.1.2.4"><times id="S2.E4.m1.4.4.1.1.2.4.1.cmml" xref="S2.E4.m1.4.4.1.1.2.4.1"></times><ci id="S2.E4.m1.4.4.1.1.2.4.2.cmml" xref="S2.E4.m1.4.4.1.1.2.4.2">𝑝</ci><apply id="S2.E4.m1.4.4.1.1.2.4.3.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.2.4.3.1.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.2.4.3.2.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3.2">𝑝</ci><apply id="S2.E4.m1.4.4.1.1.2.4.3.3.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3.3"><times id="S2.E4.m1.4.4.1.1.2.4.3.3.1.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3.3.1"></times><ci id="S2.E4.m1.4.4.1.1.2.4.3.3.2.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3.3.2">𝐸</ci><ci id="S2.E4.m1.4.4.1.1.2.4.3.3.3.cmml" xref="S2.E4.m1.4.4.1.1.2.4.3.3.3">𝐴</ci></apply></apply><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">𝒛</ci></apply><apply id="S2.E4.m1.4.4.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2"><times id="S2.E4.m1.4.4.1.1.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2"></times><ci id="S2.E4.m1.4.4.1.1.2.2.3.cmml" xref="S2.E4.m1.4.4.1.1.2.2.3">𝑝</ci><ci id="S2.E4.m1.4.4.1.1.2.2.4.cmml" xref="S2.E4.m1.4.4.1.1.2.2.4">𝑒</ci><apply id="S2.E4.m1.4.4.1.1.2.2.5.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.2.2.5.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.2.2.5.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5.2">𝑛</ci><apply id="S2.E4.m1.4.4.1.1.2.2.5.3.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5.3"><times id="S2.E4.m1.4.4.1.1.2.2.5.3.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5.3.1"></times><ci id="S2.E4.m1.4.4.1.1.2.2.5.3.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5.3.2">𝑖</ci><ci id="S2.E4.m1.4.4.1.1.2.2.5.3.3.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5.3.3">𝑛</ci><ci id="S2.E4.m1.4.4.1.1.2.2.5.3.4.cmml" xref="S2.E4.m1.4.4.1.1.2.2.5.3.4">𝑣</ci></apply></apply><apply id="S2.E4.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.1.1">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.2">𝒙</ci><ci id="S2.E4.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.2.2.1.1.1.3">𝑺</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.4c">f(\boldsymbol{z})=|pp_{IP}(\boldsymbol{z})-1|+pp_{EA}(\boldsymbol{z})+pen_{inv%
}(\boldsymbol{x_{S}}).</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.4d">italic_f ( bold_italic_z ) = | italic_p italic_p start_POSTSUBSCRIPT italic_I italic_P end_POSTSUBSCRIPT ( bold_italic_z ) - 1 | + italic_p italic_p start_POSTSUBSCRIPT italic_E italic_A end_POSTSUBSCRIPT ( bold_italic_z ) + italic_p italic_e italic_n start_POSTSUBSCRIPT italic_i italic_n italic_v end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p2.5">Here, <math alttext="pp_{IP}(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.p2.3.m1.1"><semantics id="S2.SS5.p2.3.m1.1a"><mrow id="S2.SS5.p2.3.m1.1.2" xref="S2.SS5.p2.3.m1.1.2.cmml"><mi id="S2.SS5.p2.3.m1.1.2.2" xref="S2.SS5.p2.3.m1.1.2.2.cmml">p</mi><mo id="S2.SS5.p2.3.m1.1.2.1" xref="S2.SS5.p2.3.m1.1.2.1.cmml">⁢</mo><msub id="S2.SS5.p2.3.m1.1.2.3" xref="S2.SS5.p2.3.m1.1.2.3.cmml"><mi id="S2.SS5.p2.3.m1.1.2.3.2" xref="S2.SS5.p2.3.m1.1.2.3.2.cmml">p</mi><mrow id="S2.SS5.p2.3.m1.1.2.3.3" xref="S2.SS5.p2.3.m1.1.2.3.3.cmml"><mi id="S2.SS5.p2.3.m1.1.2.3.3.2" xref="S2.SS5.p2.3.m1.1.2.3.3.2.cmml">I</mi><mo id="S2.SS5.p2.3.m1.1.2.3.3.1" xref="S2.SS5.p2.3.m1.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.3.m1.1.2.3.3.3" xref="S2.SS5.p2.3.m1.1.2.3.3.3.cmml">P</mi></mrow></msub><mo id="S2.SS5.p2.3.m1.1.2.1a" xref="S2.SS5.p2.3.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.p2.3.m1.1.2.4.2" xref="S2.SS5.p2.3.m1.1.2.cmml"><mo id="S2.SS5.p2.3.m1.1.2.4.2.1" stretchy="false" xref="S2.SS5.p2.3.m1.1.2.cmml">(</mo><mi id="S2.SS5.p2.3.m1.1.1" xref="S2.SS5.p2.3.m1.1.1.cmml">𝒛</mi><mo id="S2.SS5.p2.3.m1.1.2.4.2.2" stretchy="false" xref="S2.SS5.p2.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.3.m1.1b"><apply id="S2.SS5.p2.3.m1.1.2.cmml" xref="S2.SS5.p2.3.m1.1.2"><times id="S2.SS5.p2.3.m1.1.2.1.cmml" xref="S2.SS5.p2.3.m1.1.2.1"></times><ci id="S2.SS5.p2.3.m1.1.2.2.cmml" xref="S2.SS5.p2.3.m1.1.2.2">𝑝</ci><apply id="S2.SS5.p2.3.m1.1.2.3.cmml" xref="S2.SS5.p2.3.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS5.p2.3.m1.1.2.3.1.cmml" xref="S2.SS5.p2.3.m1.1.2.3">subscript</csymbol><ci id="S2.SS5.p2.3.m1.1.2.3.2.cmml" xref="S2.SS5.p2.3.m1.1.2.3.2">𝑝</ci><apply id="S2.SS5.p2.3.m1.1.2.3.3.cmml" xref="S2.SS5.p2.3.m1.1.2.3.3"><times id="S2.SS5.p2.3.m1.1.2.3.3.1.cmml" xref="S2.SS5.p2.3.m1.1.2.3.3.1"></times><ci id="S2.SS5.p2.3.m1.1.2.3.3.2.cmml" xref="S2.SS5.p2.3.m1.1.2.3.3.2">𝐼</ci><ci id="S2.SS5.p2.3.m1.1.2.3.3.3.cmml" xref="S2.SS5.p2.3.m1.1.2.3.3.3">𝑃</ci></apply></apply><ci id="S2.SS5.p2.3.m1.1.1.cmml" xref="S2.SS5.p2.3.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.3.m1.1c">pp_{IP}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.3.m1.1d">italic_p italic_p start_POSTSUBSCRIPT italic_I italic_P end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> and <math alttext="pp_{EA}(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.p2.4.m2.1"><semantics id="S2.SS5.p2.4.m2.1a"><mrow id="S2.SS5.p2.4.m2.1.2" xref="S2.SS5.p2.4.m2.1.2.cmml"><mi id="S2.SS5.p2.4.m2.1.2.2" xref="S2.SS5.p2.4.m2.1.2.2.cmml">p</mi><mo id="S2.SS5.p2.4.m2.1.2.1" xref="S2.SS5.p2.4.m2.1.2.1.cmml">⁢</mo><msub id="S2.SS5.p2.4.m2.1.2.3" xref="S2.SS5.p2.4.m2.1.2.3.cmml"><mi id="S2.SS5.p2.4.m2.1.2.3.2" xref="S2.SS5.p2.4.m2.1.2.3.2.cmml">p</mi><mrow id="S2.SS5.p2.4.m2.1.2.3.3" xref="S2.SS5.p2.4.m2.1.2.3.3.cmml"><mi id="S2.SS5.p2.4.m2.1.2.3.3.2" xref="S2.SS5.p2.4.m2.1.2.3.3.2.cmml">E</mi><mo id="S2.SS5.p2.4.m2.1.2.3.3.1" xref="S2.SS5.p2.4.m2.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS5.p2.4.m2.1.2.3.3.3" xref="S2.SS5.p2.4.m2.1.2.3.3.3.cmml">A</mi></mrow></msub><mo id="S2.SS5.p2.4.m2.1.2.1a" xref="S2.SS5.p2.4.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.p2.4.m2.1.2.4.2" xref="S2.SS5.p2.4.m2.1.2.cmml"><mo id="S2.SS5.p2.4.m2.1.2.4.2.1" stretchy="false" xref="S2.SS5.p2.4.m2.1.2.cmml">(</mo><mi id="S2.SS5.p2.4.m2.1.1" xref="S2.SS5.p2.4.m2.1.1.cmml">𝒛</mi><mo id="S2.SS5.p2.4.m2.1.2.4.2.2" stretchy="false" xref="S2.SS5.p2.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.4.m2.1b"><apply id="S2.SS5.p2.4.m2.1.2.cmml" xref="S2.SS5.p2.4.m2.1.2"><times id="S2.SS5.p2.4.m2.1.2.1.cmml" xref="S2.SS5.p2.4.m2.1.2.1"></times><ci id="S2.SS5.p2.4.m2.1.2.2.cmml" xref="S2.SS5.p2.4.m2.1.2.2">𝑝</ci><apply id="S2.SS5.p2.4.m2.1.2.3.cmml" xref="S2.SS5.p2.4.m2.1.2.3"><csymbol cd="ambiguous" id="S2.SS5.p2.4.m2.1.2.3.1.cmml" xref="S2.SS5.p2.4.m2.1.2.3">subscript</csymbol><ci id="S2.SS5.p2.4.m2.1.2.3.2.cmml" xref="S2.SS5.p2.4.m2.1.2.3.2">𝑝</ci><apply id="S2.SS5.p2.4.m2.1.2.3.3.cmml" xref="S2.SS5.p2.4.m2.1.2.3.3"><times id="S2.SS5.p2.4.m2.1.2.3.3.1.cmml" xref="S2.SS5.p2.4.m2.1.2.3.3.1"></times><ci id="S2.SS5.p2.4.m2.1.2.3.3.2.cmml" xref="S2.SS5.p2.4.m2.1.2.3.3.2">𝐸</ci><ci id="S2.SS5.p2.4.m2.1.2.3.3.3.cmml" xref="S2.SS5.p2.4.m2.1.2.3.3.3">𝐴</ci></apply></apply><ci id="S2.SS5.p2.4.m2.1.1.cmml" xref="S2.SS5.p2.4.m2.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.4.m2.1c">pp_{EA}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.4.m2.1d">italic_p italic_p start_POSTSUBSCRIPT italic_E italic_A end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> represent properties predicted from latent inputs using the trained property prediction neural network of our model. The last term assigns a penalty if the decoded string <math alttext="\boldsymbol{x_{S}}=p_{\boldsymbol{\theta}}(\boldsymbol{x}|\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.p2.5.m3.1"><semantics id="S2.SS5.p2.5.m3.1a"><mrow id="S2.SS5.p2.5.m3.1.1" xref="S2.SS5.p2.5.m3.1.1.cmml"><msub id="S2.SS5.p2.5.m3.1.1.3" xref="S2.SS5.p2.5.m3.1.1.3.cmml"><mi id="S2.SS5.p2.5.m3.1.1.3.2" xref="S2.SS5.p2.5.m3.1.1.3.2.cmml">𝒙</mi><mi id="S2.SS5.p2.5.m3.1.1.3.3" xref="S2.SS5.p2.5.m3.1.1.3.3.cmml">𝑺</mi></msub><mo id="S2.SS5.p2.5.m3.1.1.2" xref="S2.SS5.p2.5.m3.1.1.2.cmml">=</mo><mrow id="S2.SS5.p2.5.m3.1.1.1" xref="S2.SS5.p2.5.m3.1.1.1.cmml"><msub id="S2.SS5.p2.5.m3.1.1.1.3" xref="S2.SS5.p2.5.m3.1.1.1.3.cmml"><mi id="S2.SS5.p2.5.m3.1.1.1.3.2" xref="S2.SS5.p2.5.m3.1.1.1.3.2.cmml">p</mi><mi id="S2.SS5.p2.5.m3.1.1.1.3.3" xref="S2.SS5.p2.5.m3.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="S2.SS5.p2.5.m3.1.1.1.2" xref="S2.SS5.p2.5.m3.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS5.p2.5.m3.1.1.1.1.1" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.cmml"><mo id="S2.SS5.p2.5.m3.1.1.1.1.1.2" stretchy="false" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS5.p2.5.m3.1.1.1.1.1.1" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.cmml"><mi id="S2.SS5.p2.5.m3.1.1.1.1.1.1.2" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="S2.SS5.p2.5.m3.1.1.1.1.1.1.1" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS5.p2.5.m3.1.1.1.1.1.1.3" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="S2.SS5.p2.5.m3.1.1.1.1.1.3" stretchy="false" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.5.m3.1b"><apply id="S2.SS5.p2.5.m3.1.1.cmml" xref="S2.SS5.p2.5.m3.1.1"><eq id="S2.SS5.p2.5.m3.1.1.2.cmml" xref="S2.SS5.p2.5.m3.1.1.2"></eq><apply id="S2.SS5.p2.5.m3.1.1.3.cmml" xref="S2.SS5.p2.5.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p2.5.m3.1.1.3.1.cmml" xref="S2.SS5.p2.5.m3.1.1.3">subscript</csymbol><ci id="S2.SS5.p2.5.m3.1.1.3.2.cmml" xref="S2.SS5.p2.5.m3.1.1.3.2">𝒙</ci><ci id="S2.SS5.p2.5.m3.1.1.3.3.cmml" xref="S2.SS5.p2.5.m3.1.1.3.3">𝑺</ci></apply><apply id="S2.SS5.p2.5.m3.1.1.1.cmml" xref="S2.SS5.p2.5.m3.1.1.1"><times id="S2.SS5.p2.5.m3.1.1.1.2.cmml" xref="S2.SS5.p2.5.m3.1.1.1.2"></times><apply id="S2.SS5.p2.5.m3.1.1.1.3.cmml" xref="S2.SS5.p2.5.m3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p2.5.m3.1.1.1.3.1.cmml" xref="S2.SS5.p2.5.m3.1.1.1.3">subscript</csymbol><ci id="S2.SS5.p2.5.m3.1.1.1.3.2.cmml" xref="S2.SS5.p2.5.m3.1.1.1.3.2">𝑝</ci><ci id="S2.SS5.p2.5.m3.1.1.1.3.3.cmml" xref="S2.SS5.p2.5.m3.1.1.1.3.3">𝜽</ci></apply><apply id="S2.SS5.p2.5.m3.1.1.1.1.1.1.cmml" xref="S2.SS5.p2.5.m3.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS5.p2.5.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS5.p2.5.m3.1.1.1.1.1.1.2.cmml" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS5.p2.5.m3.1.1.1.1.1.1.3.cmml" xref="S2.SS5.p2.5.m3.1.1.1.1.1.1.3">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.5.m3.1c">\boldsymbol{x_{S}}=p_{\boldsymbol{\theta}}(\boldsymbol{x}|\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.5.m3.1d">bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT = italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x | bold_italic_z )</annotation></semantics></math> is invalid. To perform the optimization task in latent space, common approaches are gradient-based optimization, genetic algorithms (GA) or Bayesian optimization (BO). In this work we focus on BO and GAs for the optimization task.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.5.1 </span>Bayesian optimization</h4>
<div class="ltx_para ltx_noindent" id="S2.SS5.SSS1.p1">
<p class="ltx_p" id="S2.SS5.SSS1.p1.3">We implement BO using the Bayesian optimization Python package <cite class="ltx_cite ltx_citemacro_citep">(Nogueira, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib51" title="">2014–</a>)</cite>. We run the task as single objective optimization with the two objectives aggregated in one objective function, as defined in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>). The BO first fits a surrogate model, here a Gaussian Process, to represent the mapping between input variables and the objective function for observed data points including a quantification of the uncertainty of unobserved areas. Then, iteratively the algorithm uses an acquisition function to select new evaluation points. As acquisition function, we employ the upper confidence bounds method that takes as input the expected objective <math alttext="\mu(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.1.m1.1"><semantics id="S2.SS5.SSS1.p1.1.m1.1a"><mrow id="S2.SS5.SSS1.p1.1.m1.1.2" xref="S2.SS5.SSS1.p1.1.m1.1.2.cmml"><mi id="S2.SS5.SSS1.p1.1.m1.1.2.2" xref="S2.SS5.SSS1.p1.1.m1.1.2.2.cmml">μ</mi><mo id="S2.SS5.SSS1.p1.1.m1.1.2.1" xref="S2.SS5.SSS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.SSS1.p1.1.m1.1.2.3.2" xref="S2.SS5.SSS1.p1.1.m1.1.2.cmml"><mo id="S2.SS5.SSS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS5.SSS1.p1.1.m1.1.2.cmml">(</mo><mi id="S2.SS5.SSS1.p1.1.m1.1.1" xref="S2.SS5.SSS1.p1.1.m1.1.1.cmml">𝒛</mi><mo id="S2.SS5.SSS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS5.SSS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.1.m1.1b"><apply id="S2.SS5.SSS1.p1.1.m1.1.2.cmml" xref="S2.SS5.SSS1.p1.1.m1.1.2"><times id="S2.SS5.SSS1.p1.1.m1.1.2.1.cmml" xref="S2.SS5.SSS1.p1.1.m1.1.2.1"></times><ci id="S2.SS5.SSS1.p1.1.m1.1.2.2.cmml" xref="S2.SS5.SSS1.p1.1.m1.1.2.2">𝜇</ci><ci id="S2.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS5.SSS1.p1.1.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.1.m1.1c">\mu(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.1.m1.1d">italic_μ ( bold_italic_z )</annotation></semantics></math> and uncertainty <math alttext="\sigma(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.2.m2.1"><semantics id="S2.SS5.SSS1.p1.2.m2.1a"><mrow id="S2.SS5.SSS1.p1.2.m2.1.2" xref="S2.SS5.SSS1.p1.2.m2.1.2.cmml"><mi id="S2.SS5.SSS1.p1.2.m2.1.2.2" xref="S2.SS5.SSS1.p1.2.m2.1.2.2.cmml">σ</mi><mo id="S2.SS5.SSS1.p1.2.m2.1.2.1" xref="S2.SS5.SSS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.SSS1.p1.2.m2.1.2.3.2" xref="S2.SS5.SSS1.p1.2.m2.1.2.cmml"><mo id="S2.SS5.SSS1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S2.SS5.SSS1.p1.2.m2.1.2.cmml">(</mo><mi id="S2.SS5.SSS1.p1.2.m2.1.1" xref="S2.SS5.SSS1.p1.2.m2.1.1.cmml">𝒛</mi><mo id="S2.SS5.SSS1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S2.SS5.SSS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.2.m2.1b"><apply id="S2.SS5.SSS1.p1.2.m2.1.2.cmml" xref="S2.SS5.SSS1.p1.2.m2.1.2"><times id="S2.SS5.SSS1.p1.2.m2.1.2.1.cmml" xref="S2.SS5.SSS1.p1.2.m2.1.2.1"></times><ci id="S2.SS5.SSS1.p1.2.m2.1.2.2.cmml" xref="S2.SS5.SSS1.p1.2.m2.1.2.2">𝜎</ci><ci id="S2.SS5.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS5.SSS1.p1.2.m2.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.2.m2.1c">\sigma(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.2.m2.1d">italic_σ ( bold_italic_z )</annotation></semantics></math> given by the Gaussian process as function of the input variables <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.3.m3.1"><semantics id="S2.SS5.SSS1.p1.3.m3.1a"><mi id="S2.SS5.SSS1.p1.3.m3.1.1" xref="S2.SS5.SSS1.p1.3.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.3.m3.1b"><ci id="S2.SS5.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS5.SSS1.p1.3.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.3.m3.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.3.m3.1d">bold_italic_z</annotation></semantics></math></p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="UCB(\boldsymbol{z};\kappa)=\mu(\boldsymbol{z})+\kappa\sigma(\boldsymbol{z})," class="ltx_Math" display="block" id="S2.E5.m1.5"><semantics id="S2.E5.m1.5a"><mrow id="S2.E5.m1.5.5.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1.2" xref="S2.E5.m1.5.5.1.1.2.cmml"><mi id="S2.E5.m1.5.5.1.1.2.2" xref="S2.E5.m1.5.5.1.1.2.2.cmml">U</mi><mo id="S2.E5.m1.5.5.1.1.2.1" xref="S2.E5.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E5.m1.5.5.1.1.2.3" xref="S2.E5.m1.5.5.1.1.2.3.cmml">C</mi><mo id="S2.E5.m1.5.5.1.1.2.1a" xref="S2.E5.m1.5.5.1.1.2.1.cmml">⁢</mo><mi id="S2.E5.m1.5.5.1.1.2.4" xref="S2.E5.m1.5.5.1.1.2.4.cmml">B</mi><mo id="S2.E5.m1.5.5.1.1.2.1b" xref="S2.E5.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.2.5.2" xref="S2.E5.m1.5.5.1.1.2.5.1.cmml"><mo id="S2.E5.m1.5.5.1.1.2.5.2.1" stretchy="false" xref="S2.E5.m1.5.5.1.1.2.5.1.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">𝒛</mi><mo id="S2.E5.m1.5.5.1.1.2.5.2.2" xref="S2.E5.m1.5.5.1.1.2.5.1.cmml">;</mo><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">κ</mi><mo id="S2.E5.m1.5.5.1.1.2.5.2.3" stretchy="false" xref="S2.E5.m1.5.5.1.1.2.5.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.1" xref="S2.E5.m1.5.5.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.5.5.1.1.3" xref="S2.E5.m1.5.5.1.1.3.cmml"><mrow id="S2.E5.m1.5.5.1.1.3.2" xref="S2.E5.m1.5.5.1.1.3.2.cmml"><mi id="S2.E5.m1.5.5.1.1.3.2.2" xref="S2.E5.m1.5.5.1.1.3.2.2.cmml">μ</mi><mo id="S2.E5.m1.5.5.1.1.3.2.1" xref="S2.E5.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.3.2.3.2" xref="S2.E5.m1.5.5.1.1.3.2.cmml"><mo id="S2.E5.m1.5.5.1.1.3.2.3.2.1" stretchy="false" xref="S2.E5.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">𝒛</mi><mo id="S2.E5.m1.5.5.1.1.3.2.3.2.2" stretchy="false" xref="S2.E5.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.3.1" xref="S2.E5.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S2.E5.m1.5.5.1.1.3.3" xref="S2.E5.m1.5.5.1.1.3.3.cmml"><mi id="S2.E5.m1.5.5.1.1.3.3.2" xref="S2.E5.m1.5.5.1.1.3.3.2.cmml">κ</mi><mo id="S2.E5.m1.5.5.1.1.3.3.1" xref="S2.E5.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S2.E5.m1.5.5.1.1.3.3.3" xref="S2.E5.m1.5.5.1.1.3.3.3.cmml">σ</mi><mo id="S2.E5.m1.5.5.1.1.3.3.1a" xref="S2.E5.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1.3.3.4.2" xref="S2.E5.m1.5.5.1.1.3.3.cmml"><mo id="S2.E5.m1.5.5.1.1.3.3.4.2.1" stretchy="false" xref="S2.E5.m1.5.5.1.1.3.3.cmml">(</mo><mi id="S2.E5.m1.4.4" xref="S2.E5.m1.4.4.cmml">𝒛</mi><mo id="S2.E5.m1.5.5.1.1.3.3.4.2.2" stretchy="false" xref="S2.E5.m1.5.5.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.5.5.1.2" xref="S2.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.5b"><apply id="S2.E5.m1.5.5.1.1.cmml" xref="S2.E5.m1.5.5.1"><eq id="S2.E5.m1.5.5.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1"></eq><apply id="S2.E5.m1.5.5.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.2"><times id="S2.E5.m1.5.5.1.1.2.1.cmml" xref="S2.E5.m1.5.5.1.1.2.1"></times><ci id="S2.E5.m1.5.5.1.1.2.2.cmml" xref="S2.E5.m1.5.5.1.1.2.2">𝑈</ci><ci id="S2.E5.m1.5.5.1.1.2.3.cmml" xref="S2.E5.m1.5.5.1.1.2.3">𝐶</ci><ci id="S2.E5.m1.5.5.1.1.2.4.cmml" xref="S2.E5.m1.5.5.1.1.2.4">𝐵</ci><list id="S2.E5.m1.5.5.1.1.2.5.1.cmml" xref="S2.E5.m1.5.5.1.1.2.5.2"><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝒛</ci><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝜅</ci></list></apply><apply id="S2.E5.m1.5.5.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.3"><plus id="S2.E5.m1.5.5.1.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.3.1"></plus><apply id="S2.E5.m1.5.5.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2"><times id="S2.E5.m1.5.5.1.1.3.2.1.cmml" xref="S2.E5.m1.5.5.1.1.3.2.1"></times><ci id="S2.E5.m1.5.5.1.1.3.2.2.cmml" xref="S2.E5.m1.5.5.1.1.3.2.2">𝜇</ci><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝒛</ci></apply><apply id="S2.E5.m1.5.5.1.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.3.3"><times id="S2.E5.m1.5.5.1.1.3.3.1.cmml" xref="S2.E5.m1.5.5.1.1.3.3.1"></times><ci id="S2.E5.m1.5.5.1.1.3.3.2.cmml" xref="S2.E5.m1.5.5.1.1.3.3.2">𝜅</ci><ci id="S2.E5.m1.5.5.1.1.3.3.3.cmml" xref="S2.E5.m1.5.5.1.1.3.3.3">𝜎</ci><ci id="S2.E5.m1.4.4.cmml" xref="S2.E5.m1.4.4">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.5c">UCB(\boldsymbol{z};\kappa)=\mu(\boldsymbol{z})+\kappa\sigma(\boldsymbol{z}),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.5d">italic_U italic_C italic_B ( bold_italic_z ; italic_κ ) = italic_μ ( bold_italic_z ) + italic_κ italic_σ ( bold_italic_z ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.SSS1.p1.10">where <math alttext="\kappa" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.4.m1.1"><semantics id="S2.SS5.SSS1.p1.4.m1.1a"><mi id="S2.SS5.SSS1.p1.4.m1.1.1" xref="S2.SS5.SSS1.p1.4.m1.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.4.m1.1b"><ci id="S2.SS5.SSS1.p1.4.m1.1.1.cmml" xref="S2.SS5.SSS1.p1.4.m1.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.4.m1.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.4.m1.1d">italic_κ</annotation></semantics></math> balances exploration and exploitation (higher <math alttext="\kappa" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.5.m2.1"><semantics id="S2.SS5.SSS1.p1.5.m2.1a"><mi id="S2.SS5.SSS1.p1.5.m2.1.1" xref="S2.SS5.SSS1.p1.5.m2.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.5.m2.1b"><ci id="S2.SS5.SSS1.p1.5.m2.1.1.cmml" xref="S2.SS5.SSS1.p1.5.m2.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.5.m2.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.5.m2.1d">italic_κ</annotation></semantics></math> favors more exploration). We use the default value for <math alttext="\kappa" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.6.m3.1"><semantics id="S2.SS5.SSS1.p1.6.m3.1a"><mi id="S2.SS5.SSS1.p1.6.m3.1.1" xref="S2.SS5.SSS1.p1.6.m3.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.6.m3.1b"><ci id="S2.SS5.SSS1.p1.6.m3.1.1.cmml" xref="S2.SS5.SSS1.p1.6.m3.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.6.m3.1c">\kappa</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.6.m3.1d">italic_κ</annotation></semantics></math> of 2.576. 
<br class="ltx_break"/>A substantial number of works discuss good practices <cite class="ltx_cite ltx_citemacro_citep">(Siivola et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib52" title="">2021</a>)</cite> or propose strategies to overcome common challenges of Bayesian optimization particularly in the relatively high-dimensional latent spaces of VAEs, e.g., <cite class="ltx_cite ltx_citemacro_citep">(Griffiths and Hernández-Lobato, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib39" title="">2020</a>; Maus et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib53" title="">2022</a>; Tripp et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib54" title="">2020</a>)</cite>. A general issue encountered while performing any optimization in the latent space of VAEs is the presence of holes or low-confidence regions, which do not align with the high-confidence regions produced by the encoder. The optimization algorithm often tends to exploit these regions to optimize the objective, leading to a mismatch of the predicted and the real properties of the decoded polymer.
To address this, we designed an approach aimed at ensuring high confidence in property predictions <math alttext="pp_{IP}(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.7.m4.1"><semantics id="S2.SS5.SSS1.p1.7.m4.1a"><mrow id="S2.SS5.SSS1.p1.7.m4.1.2" xref="S2.SS5.SSS1.p1.7.m4.1.2.cmml"><mi id="S2.SS5.SSS1.p1.7.m4.1.2.2" xref="S2.SS5.SSS1.p1.7.m4.1.2.2.cmml">p</mi><mo id="S2.SS5.SSS1.p1.7.m4.1.2.1" xref="S2.SS5.SSS1.p1.7.m4.1.2.1.cmml">⁢</mo><msub id="S2.SS5.SSS1.p1.7.m4.1.2.3" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.cmml"><mi id="S2.SS5.SSS1.p1.7.m4.1.2.3.2" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.2.cmml">p</mi><mrow id="S2.SS5.SSS1.p1.7.m4.1.2.3.3" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.cmml"><mi id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.2" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.2.cmml">I</mi><mo id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.1" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.3" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.3.cmml">P</mi></mrow></msub><mo id="S2.SS5.SSS1.p1.7.m4.1.2.1a" xref="S2.SS5.SSS1.p1.7.m4.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.SSS1.p1.7.m4.1.2.4.2" xref="S2.SS5.SSS1.p1.7.m4.1.2.cmml"><mo id="S2.SS5.SSS1.p1.7.m4.1.2.4.2.1" stretchy="false" xref="S2.SS5.SSS1.p1.7.m4.1.2.cmml">(</mo><mi id="S2.SS5.SSS1.p1.7.m4.1.1" xref="S2.SS5.SSS1.p1.7.m4.1.1.cmml">𝒛</mi><mo id="S2.SS5.SSS1.p1.7.m4.1.2.4.2.2" stretchy="false" xref="S2.SS5.SSS1.p1.7.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.7.m4.1b"><apply id="S2.SS5.SSS1.p1.7.m4.1.2.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2"><times id="S2.SS5.SSS1.p1.7.m4.1.2.1.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.1"></times><ci id="S2.SS5.SSS1.p1.7.m4.1.2.2.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.2">𝑝</ci><apply id="S2.SS5.SSS1.p1.7.m4.1.2.3.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p1.7.m4.1.2.3.1.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3">subscript</csymbol><ci id="S2.SS5.SSS1.p1.7.m4.1.2.3.2.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.2">𝑝</ci><apply id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3"><times id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.1.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.1"></times><ci id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.2.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.2">𝐼</ci><ci id="S2.SS5.SSS1.p1.7.m4.1.2.3.3.3.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.2.3.3.3">𝑃</ci></apply></apply><ci id="S2.SS5.SSS1.p1.7.m4.1.1.cmml" xref="S2.SS5.SSS1.p1.7.m4.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.7.m4.1c">pp_{IP}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.7.m4.1d">italic_p italic_p start_POSTSUBSCRIPT italic_I italic_P end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> and <math alttext="pp_{EA}(\boldsymbol{z})" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.8.m5.1"><semantics id="S2.SS5.SSS1.p1.8.m5.1a"><mrow id="S2.SS5.SSS1.p1.8.m5.1.2" xref="S2.SS5.SSS1.p1.8.m5.1.2.cmml"><mi id="S2.SS5.SSS1.p1.8.m5.1.2.2" xref="S2.SS5.SSS1.p1.8.m5.1.2.2.cmml">p</mi><mo id="S2.SS5.SSS1.p1.8.m5.1.2.1" xref="S2.SS5.SSS1.p1.8.m5.1.2.1.cmml">⁢</mo><msub id="S2.SS5.SSS1.p1.8.m5.1.2.3" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.cmml"><mi id="S2.SS5.SSS1.p1.8.m5.1.2.3.2" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.2.cmml">p</mi><mrow id="S2.SS5.SSS1.p1.8.m5.1.2.3.3" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.cmml"><mi id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.2" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.2.cmml">E</mi><mo id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.1" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.1.cmml">⁢</mo><mi id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.3" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.3.cmml">A</mi></mrow></msub><mo id="S2.SS5.SSS1.p1.8.m5.1.2.1a" xref="S2.SS5.SSS1.p1.8.m5.1.2.1.cmml">⁢</mo><mrow id="S2.SS5.SSS1.p1.8.m5.1.2.4.2" xref="S2.SS5.SSS1.p1.8.m5.1.2.cmml"><mo id="S2.SS5.SSS1.p1.8.m5.1.2.4.2.1" stretchy="false" xref="S2.SS5.SSS1.p1.8.m5.1.2.cmml">(</mo><mi id="S2.SS5.SSS1.p1.8.m5.1.1" xref="S2.SS5.SSS1.p1.8.m5.1.1.cmml">𝒛</mi><mo id="S2.SS5.SSS1.p1.8.m5.1.2.4.2.2" stretchy="false" xref="S2.SS5.SSS1.p1.8.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.8.m5.1b"><apply id="S2.SS5.SSS1.p1.8.m5.1.2.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2"><times id="S2.SS5.SSS1.p1.8.m5.1.2.1.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.1"></times><ci id="S2.SS5.SSS1.p1.8.m5.1.2.2.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.2">𝑝</ci><apply id="S2.SS5.SSS1.p1.8.m5.1.2.3.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p1.8.m5.1.2.3.1.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3">subscript</csymbol><ci id="S2.SS5.SSS1.p1.8.m5.1.2.3.2.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.2">𝑝</ci><apply id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3"><times id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.1.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.1"></times><ci id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.2.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.2">𝐸</ci><ci id="S2.SS5.SSS1.p1.8.m5.1.2.3.3.3.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.2.3.3.3">𝐴</ci></apply></apply><ci id="S2.SS5.SSS1.p1.8.m5.1.1.cmml" xref="S2.SS5.SSS1.p1.8.m5.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.8.m5.1c">pp_{EA}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.8.m5.1d">italic_p italic_p start_POSTSUBSCRIPT italic_E italic_A end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math>. This involves correcting points sampled by BO, denoted as <math alttext="\boldsymbol{z_{\text{BO}}}" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.9.m6.1"><semantics id="S2.SS5.SSS1.p1.9.m6.1a"><msub id="S2.SS5.SSS1.p1.9.m6.1.1" xref="S2.SS5.SSS1.p1.9.m6.1.1.cmml"><mi id="S2.SS5.SSS1.p1.9.m6.1.1.2" xref="S2.SS5.SSS1.p1.9.m6.1.1.2.cmml">𝒛</mi><mtext id="S2.SS5.SSS1.p1.9.m6.1.1.3" xref="S2.SS5.SSS1.p1.9.m6.1.1.3a.cmml">BO</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.9.m6.1b"><apply id="S2.SS5.SSS1.p1.9.m6.1.1.cmml" xref="S2.SS5.SSS1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p1.9.m6.1.1.1.cmml" xref="S2.SS5.SSS1.p1.9.m6.1.1">subscript</csymbol><ci id="S2.SS5.SSS1.p1.9.m6.1.1.2.cmml" xref="S2.SS5.SSS1.p1.9.m6.1.1.2">𝒛</ci><ci id="S2.SS5.SSS1.p1.9.m6.1.1.3a.cmml" xref="S2.SS5.SSS1.p1.9.m6.1.1.3"><mtext id="S2.SS5.SSS1.p1.9.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS5.SSS1.p1.9.m6.1.1.3">BO</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.9.m6.1c">\boldsymbol{z_{\text{BO}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.9.m6.1d">bold_italic_z start_POSTSUBSCRIPT BO end_POSTSUBSCRIPT</annotation></semantics></math>, by decoding and re-encoding them to obtain <math alttext="\boldsymbol{z^{\prime}}\approx\boldsymbol{z_{\text{BO}}}" class="ltx_Math" display="inline" id="S2.SS5.SSS1.p1.10.m7.1"><semantics id="S2.SS5.SSS1.p1.10.m7.1a"><mrow id="S2.SS5.SSS1.p1.10.m7.1.1" xref="S2.SS5.SSS1.p1.10.m7.1.1.cmml"><msup id="S2.SS5.SSS1.p1.10.m7.1.1.2" xref="S2.SS5.SSS1.p1.10.m7.1.1.2.cmml"><mi id="S2.SS5.SSS1.p1.10.m7.1.1.2.2" xref="S2.SS5.SSS1.p1.10.m7.1.1.2.2.cmml">𝒛</mi><mo class="ltx_mathvariant_bold" id="S2.SS5.SSS1.p1.10.m7.1.1.2.3" mathvariant="bold" xref="S2.SS5.SSS1.p1.10.m7.1.1.2.3.cmml">′</mo></msup><mo id="S2.SS5.SSS1.p1.10.m7.1.1.1" xref="S2.SS5.SSS1.p1.10.m7.1.1.1.cmml">≈</mo><msub id="S2.SS5.SSS1.p1.10.m7.1.1.3" xref="S2.SS5.SSS1.p1.10.m7.1.1.3.cmml"><mi id="S2.SS5.SSS1.p1.10.m7.1.1.3.2" xref="S2.SS5.SSS1.p1.10.m7.1.1.3.2.cmml">𝒛</mi><mtext id="S2.SS5.SSS1.p1.10.m7.1.1.3.3" xref="S2.SS5.SSS1.p1.10.m7.1.1.3.3a.cmml">BO</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS1.p1.10.m7.1b"><apply id="S2.SS5.SSS1.p1.10.m7.1.1.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1"><approx id="S2.SS5.SSS1.p1.10.m7.1.1.1.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.1"></approx><apply id="S2.SS5.SSS1.p1.10.m7.1.1.2.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p1.10.m7.1.1.2.1.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.2">superscript</csymbol><ci id="S2.SS5.SSS1.p1.10.m7.1.1.2.2.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.2.2">𝒛</ci><ci id="S2.SS5.SSS1.p1.10.m7.1.1.2.3.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.2.3">bold-′</ci></apply><apply id="S2.SS5.SSS1.p1.10.m7.1.1.3.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.SSS1.p1.10.m7.1.1.3.1.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.3">subscript</csymbol><ci id="S2.SS5.SSS1.p1.10.m7.1.1.3.2.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.3.2">𝒛</ci><ci id="S2.SS5.SSS1.p1.10.m7.1.1.3.3a.cmml" xref="S2.SS5.SSS1.p1.10.m7.1.1.3.3"><mtext id="S2.SS5.SSS1.p1.10.m7.1.1.3.3.cmml" mathsize="70%" xref="S2.SS5.SSS1.p1.10.m7.1.1.3.3">BO</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS1.p1.10.m7.1c">\boldsymbol{z^{\prime}}\approx\boldsymbol{z_{\text{BO}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS1.p1.10.m7.1d">bold_italic_z start_POSTSUPERSCRIPT bold_′ end_POSTSUPERSCRIPT ≈ bold_italic_z start_POSTSUBSCRIPT BO end_POSTSUBSCRIPT</annotation></semantics></math>. Consequently, we ensure that the point lies within a high-confidence region of the latent space, suitable as input to the property predictor network. Thus, we achieve more accurate property predictions (see also Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS2" title="B.2 Polymer property prediction performance ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">B.2</span></a>), which mitigates discrepancies between the predicted properties used for objective function evaluations and the corresponding decoded molecules.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.5.2 </span>Genetic algorithm</h4>
<div class="ltx_para ltx_noindent" id="S2.SS5.SSS2.p1">
<p class="ltx_p" id="S2.SS5.SSS2.p1.2">For the implementation of the GA we use the multi-objective Non-dominated Sorting Genetic Algorithm (NSGA-II) <cite class="ltx_cite ltx_citemacro_citep">(Deb et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib55" title="">2002</a>)</cite> from the pymoo python package <cite class="ltx_cite ltx_citemacro_citep">(Blank and Deb, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib56" title="">2020</a>)</cite>. We use Latin Hypercube Sampling to ensure that the initial population covers the entire latent space uniformly. By iteratively performing selection, cross-over and mutation of the samples in a population, the GA evolves the population towards optimal or near-optimal solutions over successive generations. As crossover we use Simulated Binary Crossover (SBX), a method to combine previous solutions (parents) and produce offsprings. For each latent dimension, the parents’ values are averaged and perturbed (small changes) according to a perturbation factor. It preserves useful properties of the parents and effictively balances exploration and exploitation. Lastly, we use Polynomial Mutation (PM), commonly paired with SBX, which performs additional slight perturbations of the offspring’s latent dimensions generated by SBX. This helps to avoid local optima and enhance the search process. A mutation probability and perturbation factor control the probability for each latent dimensions to be perturbed and the extent of change, respectively. For both SBX and PM we use the default settings of the python package.
<br class="ltx_break"/>To tackle the problem of low-confidence regions in the latent space we implement a repair mechanism after the offsprings (new individuals after crossover and mutation) have been reproduced. We adjust these offsprings <math alttext="\boldsymbol{z_{\text{offspring}}}" class="ltx_Math" display="inline" id="S2.SS5.SSS2.p1.1.m1.1"><semantics id="S2.SS5.SSS2.p1.1.m1.1a"><msub id="S2.SS5.SSS2.p1.1.m1.1.1" xref="S2.SS5.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS5.SSS2.p1.1.m1.1.1.2" xref="S2.SS5.SSS2.p1.1.m1.1.1.2.cmml">𝒛</mi><mtext id="S2.SS5.SSS2.p1.1.m1.1.1.3" xref="S2.SS5.SSS2.p1.1.m1.1.1.3a.cmml">offspring</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS2.p1.1.m1.1b"><apply id="S2.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS5.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS5.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS5.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS5.SSS2.p1.1.m1.1.1.2">𝒛</ci><ci id="S2.SS5.SSS2.p1.1.m1.1.1.3a.cmml" xref="S2.SS5.SSS2.p1.1.m1.1.1.3"><mtext id="S2.SS5.SSS2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS5.SSS2.p1.1.m1.1.1.3">offspring</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS2.p1.1.m1.1c">\boldsymbol{z_{\text{offspring}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS2.p1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT offspring end_POSTSUBSCRIPT</annotation></semantics></math>, by decoding and re-encoding them to obtain <math alttext="\boldsymbol{z^{\prime}_{\text{repaired}}}\approx\boldsymbol{z_{\text{offspring%
}}}" class="ltx_Math" display="inline" id="S2.SS5.SSS2.p1.2.m2.1"><semantics id="S2.SS5.SSS2.p1.2.m2.1a"><mrow id="S2.SS5.SSS2.p1.2.m2.1.1" xref="S2.SS5.SSS2.p1.2.m2.1.1.cmml"><msubsup id="S2.SS5.SSS2.p1.2.m2.1.1.2" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.cmml"><mi id="S2.SS5.SSS2.p1.2.m2.1.1.2.2.2" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.2.2.cmml">𝒛</mi><mtext id="S2.SS5.SSS2.p1.2.m2.1.1.2.3" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.3a.cmml">repaired</mtext><mo class="ltx_mathvariant_bold" id="S2.SS5.SSS2.p1.2.m2.1.1.2.2.3" mathvariant="bold" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.2.3.cmml">′</mo></msubsup><mo id="S2.SS5.SSS2.p1.2.m2.1.1.1" xref="S2.SS5.SSS2.p1.2.m2.1.1.1.cmml">≈</mo><msub id="S2.SS5.SSS2.p1.2.m2.1.1.3" xref="S2.SS5.SSS2.p1.2.m2.1.1.3.cmml"><mi id="S2.SS5.SSS2.p1.2.m2.1.1.3.2" xref="S2.SS5.SSS2.p1.2.m2.1.1.3.2.cmml">𝒛</mi><mtext id="S2.SS5.SSS2.p1.2.m2.1.1.3.3" xref="S2.SS5.SSS2.p1.2.m2.1.1.3.3a.cmml">offspring</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.SSS2.p1.2.m2.1b"><apply id="S2.SS5.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1"><approx id="S2.SS5.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.1"></approx><apply id="S2.SS5.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.SSS2.p1.2.m2.1.1.2.1.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2">subscript</csymbol><apply id="S2.SS5.SSS2.p1.2.m2.1.1.2.2.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.SSS2.p1.2.m2.1.1.2.2.1.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2">superscript</csymbol><ci id="S2.SS5.SSS2.p1.2.m2.1.1.2.2.2.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.2.2">𝒛</ci><ci id="S2.SS5.SSS2.p1.2.m2.1.1.2.2.3.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.2.3">bold-′</ci></apply><ci id="S2.SS5.SSS2.p1.2.m2.1.1.2.3a.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.3"><mtext id="S2.SS5.SSS2.p1.2.m2.1.1.2.3.cmml" mathsize="70%" xref="S2.SS5.SSS2.p1.2.m2.1.1.2.3">repaired</mtext></ci></apply><apply id="S2.SS5.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS5.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.3.2">𝒛</ci><ci id="S2.SS5.SSS2.p1.2.m2.1.1.3.3a.cmml" xref="S2.SS5.SSS2.p1.2.m2.1.1.3.3"><mtext id="S2.SS5.SSS2.p1.2.m2.1.1.3.3.cmml" mathsize="70%" xref="S2.SS5.SSS2.p1.2.m2.1.1.3.3">offspring</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.SSS2.p1.2.m2.1c">\boldsymbol{z^{\prime}_{\text{repaired}}}\approx\boldsymbol{z_{\text{offspring%
}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.SSS2.p1.2.m2.1d">bold_italic_z start_POSTSUPERSCRIPT bold_′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT repaired end_POSTSUBSCRIPT ≈ bold_italic_z start_POSTSUBSCRIPT offspring end_POSTSUBSCRIPT</annotation></semantics></math> to ensure they are within high-density regions of the latent space. These points are then evaluated to calculate the objectives.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results and Discussion</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section we demonstrate the generative capabilities of our model to generate novel copolymers including their stoichiometry and chain architecture. We first assess the overall model performance as a generative model in terms of reconstruction and validity, novelty, and uniqueness of sampled polymers. Further, we analyse the structure and smoothness of the latent space qualitatively. Then we test our model for inverse design of property-optimized organic copoloymer photocatalysts for improved green hydrogen production.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Model evaluation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Our model demonstrates good performance in generating novel, diverse, and chemically valid polymers and reconstructing complex copolymer structures. With the best hyperparameter configuration (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS3" title="3.3 Hyperparameter selection ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.3</span></a>) we achieve a reconstruction accuracy of 68% for copolymers in the testset, including their higher-order structural information (chain architecture and stoichiometry). Further, the model generates novel (81%) and unique (98%) polymers. The reconstructed test set exhibits 99% valid and the generated sample set 96% chemically valid molecules. We observe that the overall novelty (81%) is composed of novel monomer chemistries (25%), but also a substantial fraction of novel unseen combinations of monomers from the training set (81%-25% = 56%). Further, the sampled molecules cover all combinations of stoichiometries and chain architectures from the dataset. The results demonstrate the generative capabilities, but also show room for improvement in terms of monomer novelty and possibly novelty on other structural levels (stoichiometry and chain architecture) through a greater dataset diversity.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F5" title="Figure 5 ‣ 3.1 Model evaluation ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">5</span></a> presents 56 example polymers sampled randomly from the latent space after model training. The generated copolymers display a wide range of structures, showcasing various conjugated copolymers with differing monomer chemistries, stoichiometries, and chain architectures.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><svg class="ltx_picture ltx_centering" height="486.22" id="S3.F5.pic1" overflow="visible" version="1.1" width="488.22"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,486.22) matrix(1 0 0 -1 0 0) translate(244.11,0) translate(0,243.11) matrix(1.0 0.0 0.0 1.0 -239.5 -238.5)"><foreignobject height="477" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="479"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="477" id="S3.F5.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5873110/images/molecules_random.png" width="479"/></foreignobject></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>56 example copolymers sampled from Gaussian noise. All sampled polymers belong to the class of conjugated copolymers as the training data, displaying a wide variety of monomer structures combined in different chain architectures and stoichiometries.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Latent space</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">In the following section, we demonstrate that the latent space (LS) is smooth and organized in a chemically meaningful way. These characteristics are of great importance when sampling novel polymers and using the latent space for property-guided polymer discovery.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Latent space organization</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F6" title="Figure 6 ‣ 3.2.1 Latent space organization ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">6</span></a> visualizes the first two principal components of the training dataset encoded to the LS. We observe that the LS of the best model primarily organizes according to monomer chemistry. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F14" title="Figure 14 ‣ B.3 Additional latent space plots: Stoichiometry and chain architecture ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">14</span></a> in the Appendix shows that the LS is more locally structured according to stoichiometry and chain architecture. This organization aligns with the intuitive understanding that polymers sharing the same monomer types are inherently more similar, regardless of differences in chain architecture. Further, we verify that the LS structures according to the ionization potential (IP) and electron affinity (EA), which facilitates successful optimization in the LS (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4" title="3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.4</span></a>). Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F7" title="Figure 7 ‣ 3.2.1 Latent space organization ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">7</span></a> illustrates distribution of property values and gradients in the PCA plot of the latent space, demonstrating the model’s ability to capture property-structure relationships.</p>
</div>
<figure class="ltx_figure" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="158" id="S3.F6.g1" src="extracted/5873110/images/train_latent_Amonomers_pca.png" width="359"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualization of the two first principal components of the latent space of the training data. Coloring by A monomer type reveals organization according to the monomer chemistry.</figcaption>
</figure>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S3.F7.sf1.g1" src="extracted/5873110/images/train_latenty1_pca.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((a)) </span>Colored by EA</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="449" id="S3.F7.sf2.g1" src="extracted/5873110/images/train_latenty2_pca.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((b)) </span>Colored by IP</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visualization of the two first principal components of the latent space of the training data. Coloring according to polymer properties reveals that the latent space shows property gradients.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Smoothness of latent space</h4>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">In line with the approach described by <cite class="ltx_cite ltx_citemacro_citet">Kusner et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib57" title="">2017</a>)</cite>, we visualize the neighborhood of a seed molecule in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F8" title="Figure 8 ‣ 3.2.2 Smoothness of latent space ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">8</span></a> to inspect the smoothness of the latent space. We start by defining two random orthogonal unit vectors (of dimension 32) in the latent space, scaled by the variance of a sample batch of molecules. From the seed molecule (in black dashed lines), we then explore its local neighborhood on a grid defined by these vectors. Each copolymer in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F8" title="Figure 8 ‣ 3.2.2 Smoothness of latent space ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">8</span></a> comprises an A monomer (bottom) and a B monomer (top). We observe that monomer A remains unchanged for more steps than monomer B. Also, monomer B exhibits more gradual changes in the latent space, often altering only one atom type, a side chain, or functional group. This discrepancy is attributable to the different variety of A and B monomers in the training data: there are fewer A monomer chemistries compared to B monomer chemistries, resulting in a smoother latent space for monomer B. Note that the stoichiometry and chain architecture remain the same in the direct neighborhood of the seed molecule. This consistency is expected for stoichiometry, as changing from 1:1 to either 1:3 or 3:1 would significantly alter the nature of the polymer and thus should not be modified in the immediate neighborhood. For the chain architecture, the impact is slightly less pronounced, but changing from an alternating to a block structure would still substantially alter the polymer’s nature.</p>
</div>
<figure class="ltx_figure" id="S3.F8"><svg class="ltx_picture ltx_centering" height="604.22" id="S3.F8.pic1" overflow="visible" version="1.1" width="607.22"><g transform="translate(0,604.22) matrix(1 0 0 -1 0 0) translate(303.61,0) translate(0,302.11)"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="matrix(1.0 0.0 0.0 1.0 -299 -297.5)"><foreignobject height="595" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="598"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="595" id="S3.F8.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5873110/images/molecular_grid_randomseed2_scaling1.0.png" width="598"/></foreignobject></g><g color="#000000" fill="#000000" stroke="#000000" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -31.5 31.5 L 31.5 31.5 L 31.5 -31.5 L -31.5 -31.5 Z" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Visualization of the molecular neighborhood using two orthogonal vectors in latent space as proposed by <cite class="ltx_cite ltx_citemacro_citet">Kusner et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib57" title="">2017</a>)</cite>. Moving around the random seed molecule in black dashed lines in the center, we can observe step-wise changes in monomer A (bottom one), monomer B (top one), stoichioemtry and chain architecture.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Hyperparameter selection</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.12">As detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS4" title="2.4 Training and evaluation ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.4</span></a>, to select the best model we conducted a hyperparameter search over the weights <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_β</annotation></semantics></math> and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_α</annotation></semantics></math> in the loss terms in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E2" title="In 2.2.2 Loss function ‣ 2.2 Model ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2</span></a>) and evaluated the model using the performance metrics from Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.T1" title="Table 1 ‣ 2.4 Training and evaluation ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">1</span></a>.
We observed that lower values of <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_β</annotation></semantics></math> and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_α</annotation></semantics></math> enhance reconstruction accuracy by prioritizing the reconstruction term in the loss function. However, achieving high novelty and validity in randomly generated samples requires larger <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_β</annotation></semantics></math> values. If <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_β</annotation></semantics></math> is too small, the latent space becomes discontinuous with "holes" or regions of low confidence, leading to invalid molecules when sampled. We found that for this dataset, <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.1d">italic_β</annotation></semantics></math> values between 0.0003 and 0.0004 work best to optimize the trade-off between reconstruction, validity and novelty.
Additionally, we found that a well-structured latent space (LS) is crucial for successful inverse design using optimization algorithms. Ideally, the LS should organize polymers by their properties, as demonstrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS2.SSS1" title="3.2.1 Latent space organization ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>. Increasing the weighting factor <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.1d">italic_α</annotation></semantics></math> improved the organization of molecules regarding their properties, which was visually confirmed by examining PCA plots of the latent space showing clear property gradients (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F7" title="Figure 7 ‣ 3.2.1 Latent space organization ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">7</span></a>). A sufficiently high <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><mi id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><ci id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">italic_α</annotation></semantics></math> also leads to accurate property predictions, as verified in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS2" title="B.2 Polymer property prediction performance ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">B.2</span></a>. Contrary, increasing <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.1"><semantics id="S3.SS3.p1.10.m10.1a"><mi id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><ci id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.1d">italic_α</annotation></semantics></math> too much harms the reconstruction performance.
As a result, we select the best model (<math alttext="\alpha=0.2" class="ltx_Math" display="inline" id="S3.SS3.p1.11.m11.1"><semantics id="S3.SS3.p1.11.m11.1a"><mrow id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2" xref="S3.SS3.p1.11.m11.1.1.2.cmml">α</mi><mo id="S3.SS3.p1.11.m11.1.1.1" xref="S3.SS3.p1.11.m11.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1"><eq id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1.1"></eq><ci id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2">𝛼</ci><cn id="S3.SS3.p1.11.m11.1.1.3.cmml" type="float" xref="S3.SS3.p1.11.m11.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">\alpha=0.2</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.11.m11.1d">italic_α = 0.2</annotation></semantics></math> and <math alttext="\beta=0.0004" class="ltx_Math" display="inline" id="S3.SS3.p1.12.m12.1"><semantics id="S3.SS3.p1.12.m12.1a"><mrow id="S3.SS3.p1.12.m12.1.1" xref="S3.SS3.p1.12.m12.1.1.cmml"><mi id="S3.SS3.p1.12.m12.1.1.2" xref="S3.SS3.p1.12.m12.1.1.2.cmml">β</mi><mo id="S3.SS3.p1.12.m12.1.1.1" xref="S3.SS3.p1.12.m12.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.12.m12.1.1.3" xref="S3.SS3.p1.12.m12.1.1.3.cmml">0.0004</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m12.1b"><apply id="S3.SS3.p1.12.m12.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1"><eq id="S3.SS3.p1.12.m12.1.1.1.cmml" xref="S3.SS3.p1.12.m12.1.1.1"></eq><ci id="S3.SS3.p1.12.m12.1.1.2.cmml" xref="S3.SS3.p1.12.m12.1.1.2">𝛽</ci><cn id="S3.SS3.p1.12.m12.1.1.3.cmml" type="float" xref="S3.SS3.p1.12.m12.1.1.3">0.0004</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m12.1c">\beta=0.0004</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.12.m12.1d">italic_β = 0.0004</annotation></semantics></math>) according to both the quantitative metrics and visual inspection of gradients in the latent space. In the subsequent section, we use this model for the inverse design approach. Note, that the hyperparameter tuning does not guarantee reaching a globally optimal configuration for the inverse design problem and may vary for new datasets.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Inverse design of novel polymer photocatalysts for hydrogen production</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">With the objective function defined in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>), we can directly apply optimization techniques to decode novel polymer photocatalysts that best align with our targets.
We compare Bayesian optimization (BO) and genetic algorithms (GA), as explained in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS5" title="2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.5</span></a>. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.T2" title="Table 2 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2</span></a> shows a comparison of the best objective values of polymers in the training dataset with the decoded polymers using BO and GA. Notably, both BO and GA produce top 3 candidates that better satisfy the objective than the best candidate from the dataset. Inspecting the average objective of the top 10 polymers in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.T2" title="Table 2 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2</span></a> shows that both optimization strategies outperform selecting the ten best candidates from the dataset, while we observe that the GA outperforms the BO.
One possible explanation is the computational efficiency of the GA which allows it to evaluate a greater number of molecules than the BO within the same runtime, giving it an advantage in identifying more candidates with high objective values. Thus, we conclude that with the aim to obtain a large variety of good candidate polymers, the GA, in combination with our model, is the most effective approach for inverse design. 
<br class="ltx_break"/>The result is a library of polymer structures that adhere to the specified target objectives. Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F11.sf1" title="In Figure 11 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">11(a)</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F11.sf2" title="In Figure 11 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">11(b)</span></a> show the effective distribution shift towards polymers with targeted EA and IP, compared to the wide distribution of properties in the training data.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison of polymers from the dataset and the generated data after optimization in the latent space. The table shows the average objective values according to Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>) of the ten best polymers and the objective values of the top three polymers.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.2.2.3">Data</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1">
<math alttext="f(\boldsymbol{z})" class="ltx_Math" display="inline" id="S3.T2.1.1.1.m1.1"><semantics id="S3.T2.1.1.1.m1.1a"><mrow id="S3.T2.1.1.1.m1.1.2" xref="S3.T2.1.1.1.m1.1.2.cmml"><mi id="S3.T2.1.1.1.m1.1.2.2" xref="S3.T2.1.1.1.m1.1.2.2.cmml">f</mi><mo id="S3.T2.1.1.1.m1.1.2.1" xref="S3.T2.1.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.T2.1.1.1.m1.1.2.3.2" xref="S3.T2.1.1.1.m1.1.2.cmml"><mo id="S3.T2.1.1.1.m1.1.2.3.2.1" stretchy="false" xref="S3.T2.1.1.1.m1.1.2.cmml">(</mo><mi id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml">𝒛</mi><mo id="S3.T2.1.1.1.m1.1.2.3.2.2" stretchy="false" xref="S3.T2.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.1b"><apply id="S3.T2.1.1.1.m1.1.2.cmml" xref="S3.T2.1.1.1.m1.1.2"><times id="S3.T2.1.1.1.m1.1.2.1.cmml" xref="S3.T2.1.1.1.m1.1.2.1"></times><ci id="S3.T2.1.1.1.m1.1.2.2.cmml" xref="S3.T2.1.1.1.m1.1.2.2">𝑓</ci><ci id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.1c">f(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S3.T2.1.1.1.m1.1d">italic_f ( bold_italic_z )</annotation></semantics></math> (Top 3)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.2.2.2">
<math alttext="f(\boldsymbol{z})" class="ltx_Math" display="inline" id="S3.T2.2.2.2.m1.1"><semantics id="S3.T2.2.2.2.m1.1a"><mrow id="S3.T2.2.2.2.m1.1.2" xref="S3.T2.2.2.2.m1.1.2.cmml"><mi id="S3.T2.2.2.2.m1.1.2.2" xref="S3.T2.2.2.2.m1.1.2.2.cmml">f</mi><mo id="S3.T2.2.2.2.m1.1.2.1" xref="S3.T2.2.2.2.m1.1.2.1.cmml">⁢</mo><mrow id="S3.T2.2.2.2.m1.1.2.3.2" xref="S3.T2.2.2.2.m1.1.2.cmml"><mo id="S3.T2.2.2.2.m1.1.2.3.2.1" stretchy="false" xref="S3.T2.2.2.2.m1.1.2.cmml">(</mo><mi id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml">𝒛</mi><mo id="S3.T2.2.2.2.m1.1.2.3.2.2" stretchy="false" xref="S3.T2.2.2.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.1b"><apply id="S3.T2.2.2.2.m1.1.2.cmml" xref="S3.T2.2.2.2.m1.1.2"><times id="S3.T2.2.2.2.m1.1.2.1.cmml" xref="S3.T2.2.2.2.m1.1.2.1"></times><ci id="S3.T2.2.2.2.m1.1.2.2.cmml" xref="S3.T2.2.2.2.m1.1.2.2">𝑓</ci><ci id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.1c">f(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="S3.T2.2.2.2.m1.1d">italic_f ( bold_italic_z )</annotation></semantics></math> (Average (top 10))</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T2.2.3.1.1">Training data</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.2">-4.027, -4.009, -3.936</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.3">-3.9362</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T2.2.4.2.1">Generated data (BO)</th>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.2">-4.451, -4.294, -4.199</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.3">-4.0151</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T2.2.5.3.1">Generated data (GA)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.2.5.3.2">-4.297, -4.224, -4.160</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.2.5.3.3"><span class="ltx_text ltx_font_bold" id="S3.T2.2.5.3.3.1">-4.0705</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S3.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="235" id="S3.F9.g1" src="extracted/5873110/images/optimal_mols_GA_correct_EAmin.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>The top ten decoded candidates after optimization of the objective function in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>) in latent space using a genetic algorithm. </figcaption>
</figure>
<figure class="ltx_figure" id="S3.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="235" id="S3.F10.g1" src="extracted/5873110/images/optimal_mols_BO.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The top ten decoded candidates after optimization of the objective function in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>) in latent space using Bayesian optimization. </figcaption>
</figure>
<figure class="ltx_figure" id="S3.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F11.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="456" id="S3.F11.sf1.g1" src="extracted/5873110/images/KDE_EA_GA.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((a)) </span>Electron affinity</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F11.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="456" id="S3.F11.sf2.g1" src="extracted/5873110/images/KDE_IP_GA.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((b)) </span>Ionization potential</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Kernel density estimation of property distribution in the real dataset, the augmented dataset and the best 500 molecules sampled during the inverse design using GA optimization. The plots show that optimization with a GA enables a distribution shift, generating polymers with targeted properties.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">As mentioned in <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>)</cite>, even optimal values of IP and EA according to the objective function do not guarantee high HERs.
Note that it is important to consider additional factors (beyond electronic properties) that influence the HER for experimental validation. However, the set of candidates after the optimization likely comprises more high-performing materials than a broader set of structures and is thus very valuable for material development. Furthermore, researchers using these methods should carefully consider the importance of different properties (weights in objective function). In our setting with equal weights for both objectives, we observe that the optimization favors low EA values while sacrificing larger deviations of IP from 1 eV.</p>
</div>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Discussion of the top 10 candidates</h5>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.1">Analysis of the best polymer candidates in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F9" title="Figure 9 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">9</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F10" title="Figure 10 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">10</span></a> suggests that the properties EA and IP, are primarily influenced by the monomer chemistries. Both optimization algorithms converge to a specific region in the latent space characterized by monomers of similar sizes, typically featuring one aromatic ring and at least one nitrogen atom, with rare occurences of other heteroatoms such as oxygen, fluorine and chlorine. Sulfur and bromine, which are present in the dataset, do not appear in the optimal polymers identified by our model. The chemical region that the optimization algorithms converge to is strongly influenced by the property targets defined in the objective function, which can be easily adjusted to investigate different scenarios (see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS5" title="B.5 Additional inverse design experiments with varied property targets ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">B.5</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p2.1">Stoichiometry and chain architecture play a less significant role. For instance, candidates two and three of the BO consist of the same monomers and block chain architecture and have very similar properties, despite the different stoichiometry. Similarly, candidate 5 and 6 only differ in the chain architecture but possess very similar properties.
The importance of monomer chemistry compared to stoichiometry and chain architecture aligns with our observations of the latent space structure (Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F6" title="Figure 6 ‣ 3.2.1 Latent space organization ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F14" title="Figure 14 ‣ B.3 Additional latent space plots: Stoichiometry and chain architecture ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">14</span></a>) and the analysis in prior studies <cite class="ltx_cite ltx_citemacro_citep">(Aldeghi and Coley, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>)</cite>. Nonetheless, it’s important to acknowledge that for other datasets or properties, stoichiometry and chain architecture might play a more critical role in the optimization process.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Limitations and future work</h3>
<div class="ltx_para ltx_noindent" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">Polymer properties are influenced not only by the repeat unit chemistry, but also by their higher-order structure and processing conditions. While our work incorporates stochasticity, stoichiometry of monomers and chain architectures, further factors such as weight distribution, linking structure, and processing conditions, also play crucial roles. We see the inclusion of hierarchical information in datasets and in informative representations as one of the main challenges of polymer informatics.
We expect that this influences the design of future ML model architectures as well as the granularity of predictions.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">While the dataset we use enables exploration of novel polymer photocatalysts, our results also reveal the need for greater dataset diversity in monomer chemistries and higher-order structural information (stoichiometry and chain architecture). Expanding dataset diversity across all structural levels will help prevent overfitting to monomers or e.g., a set of stoichiometries, and therefore constructing a truly continuous chemical latent space. This would naturally increase the novelty and diversity of the generated structures.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1">Synthesizability is another critical consideration in polymer design, yet existing metrics like the synthetic accessibility (SA) score typically encountered in small molecule discovery are limited in their application to polymers. Polymers possess a hierarchical structure beyond the monomer and their synthesis involves complex steps. Hence, developing a tailored metric that considers polymerization methods, monomer reactivity, and monomer availability is essential for translating computational predictions into experimentally realizable materials.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">Lastly, while VAEs are effective at generating data within the training data distribution, they struggle with creating truly novel, out-of-distribution molecules. Techniques like reinforcement learning or genetic algorithms iteratively modifying the molecular structure (e.g. molecular graph) may be suited for out-of-distribution design but require reliable property predictors or experimental validations. When the generated molecules deviate significantly from the training data, the accuracy of property predictors is likely to diminish, underscoring the importance of robust validation methods.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In conclusion, our model explores a novel VAE architecture encoding polymer graphs using a graph neural network and decoding polymer strings with a Transformer. With the consideration of stochasticity of monomer ensembles including their stoichiometry and chain architecture our model represents a significant step forward in the inverse design of synthetic polymers, going beyond the repeat unit structure. We leverage a semi-supervised setup to handle partly labelled data, which is promising for a domain like polymer informatics with limited labelled data. Our model is designed to work effectively across a wide range of polymer datasets that consider the same structural levels. Additionally, we consider it to be easily adaptable, making it a useful starting point for further development as new datasets with more complex structural information emerge.
<br class="ltx_break"/>Finally, for the use case of conjugated copolymer-photocatalysts for hydrogen production, we demonstrate the capability of our model to generate conjugated copolymers with tailored electronic properties. We do this by using optimization in the latent space that encodes monomer combinations including monomer stoichiometries and chain architectures. Notably, the inverse design approach identifies novel copolymers that exhibit properties better than the best properties in the used training dataset. The results hold promise for accelerating the discovery of new high-performing polymer materials considering their hierarchical structure.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Data availability</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">The data and code can be found openly accessible on https://github.com/Intelligent-molecular-systems/Inverse_copolymer_design.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Author contributions</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Conceptualization was carried out by J.M.W. and G.V. G.V. was responsible for data curation, formal analysis, investigation, methodology, software development, validation, and visualization. G.V. wrote the original draft of the manuscript. J.M.W. provided supervision and contributed to the review and editing of the manuscript.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mangaraj et al. [2019]</span>
<span class="ltx_bibblock">
S Mangaraj, Ajay Yadav, Lalit M Bal, SK Dash, and Naveen K Mahanti.

</span>
<span class="ltx_bibblock">Application of biodegradable polymers in food packaging industry: A comprehensive review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Journal of Packaging Technology and Research</em>, 3:77–96, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morais et al. [2016]</span>
<span class="ltx_bibblock">
Diana Santos Morais, Rui Miranda Guedes, and Maria Ascensão Lopes.

</span>
<span class="ltx_bibblock">Antimicrobial approaches for textiles: from research to market.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Materials</em>, 9(6):498, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2016]</span>
<span class="ltx_bibblock">
Chang Liu, Kai Wang, Xiong Gong, and Alan J Heeger.

</span>
<span class="ltx_bibblock">Low bandgap semiconducting polymers for polymeric photovoltaics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Chemical Society Reviews</em>, 45(17):4825–4846, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maitz [2015]</span>
<span class="ltx_bibblock">
Manfred F Maitz.

</span>
<span class="ltx_bibblock">Applications of synthetic polymers in clinical medicine.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Biosurface and Biotribology</em>, 1(3):161–176, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan and Li [2023]</span>
<span class="ltx_bibblock">
Cheng Yan and Guoqiang Li.

</span>
<span class="ltx_bibblock">The rise of machine learning in polymer discovery.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advanced Intelligent Systems</em>, 5(4):2200243, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hatakeyama-Sato [2023]</span>
<span class="ltx_bibblock">
Kan Hatakeyama-Sato.

</span>
<span class="ltx_bibblock">Recent advances and challenges in experiment-oriented polymer informatics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Polymer Journal</em>, 55(2):117–131, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lavecchia [2015]</span>
<span class="ltx_bibblock">
Antonio Lavecchia.

</span>
<span class="ltx_bibblock">Machine-learning approaches in drug discovery: methods and applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Drug discovery today</em>, 20(3):318–331, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanchez-Lengeling and Aspuru-Guzik [2018]</span>
<span class="ltx_bibblock">
Benjamin Sanchez-Lengeling and Alán Aspuru-Guzik.

</span>
<span class="ltx_bibblock">Inverse molecular design using machine learning: Generative models for matter engineering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Science</em>, 361(6400):360–365, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bilodeau et al. [2022]</span>
<span class="ltx_bibblock">
Camille Bilodeau, Wengong Jin, Tommi Jaakkola, Regina Barzilay, and Klavs F Jensen.

</span>
<span class="ltx_bibblock">Generative models for molecular discovery: Recent advances and challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Wiley Interdisciplinary Reviews: Computational Molecular Science</em>, 12(5):e1608, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. [2024]</span>
<span class="ltx_bibblock">
Yuanqi Du, Arian R Jamasb, Jeff Guo, Tianfan Fu, Charles Harris, Yingheng Wang, Chenru Duan, Pietro Liò, Philippe Schwaller, and Tom L Blundell.

</span>
<span class="ltx_bibblock">Machine learning-aided generative molecular design.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Nature Machine Intelligence</em>, pages 1–16, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lavecchia and Di Giovanni [2013]</span>
<span class="ltx_bibblock">
Antonio Lavecchia and Carmen Di Giovanni.

</span>
<span class="ltx_bibblock">Virtual screening strategies in drug discovery: a critical review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Current medicinal chemistry</em>, 20(23):2839–2860, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gómez-Bombarelli et al. [2016]</span>
<span class="ltx_bibblock">
Rafael Gómez-Bombarelli, Jorge Aguilera-Iparraguirre, Timothy D Hirzel, David Duvenaud, Dougal Maclaurin, Martin A Blood-Forsythe, Hyun Sik Chae, Markus Einzinger, Dong-Gwang Ha, Tony Wu, et al.

</span>
<span class="ltx_bibblock">Design of efficient molecular organic light-emitting diodes by a high-throughput virtual screening and experimental approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Nature materials</em>, 15(10):1120–1127, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattari et al. [2021]</span>
<span class="ltx_bibblock">
Kianoosh Sattari, Yunchao Xie, and Jian Lin.

</span>
<span class="ltx_bibblock">Data-driven algorithms for inverse design of polymers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Soft Matter</em>, 17(33):7607–7622, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2011]</span>
<span class="ltx_bibblock">
Xinyuan Zhu, Yongfeng Zhou, and Deyue Yan.

</span>
<span class="ltx_bibblock">Influence of branching architecture on polymer properties.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Journal of Polymer Science Part B: Polymer Physics</em>, 49(18):1277–1286, 2011.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hult et al. [1999]</span>
<span class="ltx_bibblock">
Anders Hult, Mats Johansson, and Eva Malmström.

</span>
<span class="ltx_bibblock">Hyperbranched polymers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Branched Polymers II</em>, pages 1–34, 1999.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hadjichristidis et al. [2001]</span>
<span class="ltx_bibblock">
Nikos Hadjichristidis, Marinos Pitsikalis, Stergios Pispas, and Hermis Iatrou.

</span>
<span class="ltx_bibblock">Polymers with complex architecture by living anionic polymerization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Chemical reviews</em>, 101(12):3747–3792, 2001.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bazan and Schrock [1991]</span>
<span class="ltx_bibblock">
Guillermo C Bazan and Richard R Schrock.

</span>
<span class="ltx_bibblock">Synthesis of star block copolymers by controlled ring-opening metathesis polymerization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Macromolecules</em>, 24(4):817–823, 1991.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuenneth et al. [2021]</span>
<span class="ltx_bibblock">
Christopher Kuenneth, Arunkumar Chitteth Rajan, Huan Tran, Lihua Chen, Chiho Kim, and Rampi Ramprasad.

</span>
<span class="ltx_bibblock">Polymer informatics with multi-task learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Patterns</em>, 2(4), 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuenneth et al. [2022]</span>
<span class="ltx_bibblock">
Christopher Kuenneth, Jessica Lalonde, Babetta L Marrone, Carl N Iverson, Rampi Ramprasad, and Ghanshyam Pilania.

</span>
<span class="ltx_bibblock">Bioplastic design using multitask deep neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Communications Materials</em>, 3(1):96, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Doan Tran et al. [2020]</span>
<span class="ltx_bibblock">
Huan Doan Tran, Chiho Kim, Lihua Chen, Anand Chandrasekaran, Rohit Batra, Shruti Venkatram, Deepak Kamal, Jordan P Lightstone, Rishi Gurnani, Pranav Shetty, et al.

</span>
<span class="ltx_bibblock">Machine-learning predictions of polymer properties with polymer genome.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Journal of Applied Physics</em>, 128(17), 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pilania et al. [2019]</span>
<span class="ltx_bibblock">
Ghanshyam Pilania, Carl N Iverson, Turab Lookman, and Babetta L Marrone.

</span>
<span class="ltx_bibblock">Machine-learning-based predictive modeling of glass transition temperatures: a case of polyhydroxyalkanoate homopolymers and copolymers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Journal of Chemical Information and Modeling</em>, 59(12):5013–5025, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhowmik et al. [2021]</span>
<span class="ltx_bibblock">
Rahul Bhowmik, Sangwook Sihn, Ruth Pachter, and Jonathan P Vernon.

</span>
<span class="ltx_bibblock">Prediction of the specific heat of polymers from experimental data and machine learning methods.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Polymer</em>, 220:123558, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma and Luo [2020]</span>
<span class="ltx_bibblock">
Ruimin Ma and Tengfei Luo.

</span>
<span class="ltx_bibblock">Pi1m: a benchmark database for polymer informatics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Journal of Chemical Information and Modeling</em>, 60(10):4684–4690, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. [2018]</span>
<span class="ltx_bibblock">
Chiho Kim, Anand Chandrasekaran, Tran Doan Huan, Deya Das, and Rampi Ramprasad.

</span>
<span class="ltx_bibblock">Polymer genome: a data-powered polymer informatics platform for property predictions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">The Journal of Physical Chemistry C</em>, 122(31):17575–17585, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuenneth and Ramprasad [2023]</span>
<span class="ltx_bibblock">
Christopher Kuenneth and Rampi Ramprasad.

</span>
<span class="ltx_bibblock">polybert: a chemical language model to enable fully machine-driven ultrafast polymer informatics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Nature Communications</em>, 14(1):4099, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2023]</span>
<span class="ltx_bibblock">
Changwen Xu, Yuyang Wang, and Amir Barati Farimani.

</span>
<span class="ltx_bibblock">Transpolymer: a transformer-based language model for polymer property predictions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">npj Computational Materials</em>, 9(1):64, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Batra et al. [2020]</span>
<span class="ltx_bibblock">
Rohit Batra, Hanjun Dai, Tran Doan Huan, Lihua Chen, Chiho Kim, Will R Gutekunst, Le Song, and Rampi Ramprasad.

</span>
<span class="ltx_bibblock">Polymers for extreme conditions designed using syntax-directed variational autoencoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Chemistry of Materials</em>, 32(24):10489–10500, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ohno et al. [2023]</span>
<span class="ltx_bibblock">
Mitsuru Ohno, Yoshihiro Hayashi, Qi Zhang, Yu Kaneko, and Ryo Yoshida.

</span>
<span class="ltx_bibblock">Smipoly: Generation of a synthesizable polymer virtual library using rule-based polymerization reactions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Journal of Chemical Information and Modeling</em>, 63(17):5539–5548, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. [2023]</span>
<span class="ltx_bibblock">
Seonghwan Kim, Charles M Schroeder, and Nicholas E Jackson.

</span>
<span class="ltx_bibblock">Open macromolecular genome: Generative design of synthetically accessible polymers.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">ACS Polymers Au</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2019]</span>
<span class="ltx_bibblock">
Tzyy-Shyang Lin, Connor W Coley, Hidenobu Mochigase, Haley K Beech, Wencong Wang, Zi Wang, Eliot Woods, Stephen L Craig, Jeremiah A Johnson, Julia A Kalow, et al.

</span>
<span class="ltx_bibblock">Bigsmiles: a structurally-based line notation for describing macromolecules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">ACS central science</em>, 5(9):1523–1531, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schneider et al. [2024]</span>
<span class="ltx_bibblock">
Ludwig Schneider, Dylan Walsh, Bradley Olsen, and Juan de Pablo.

</span>
<span class="ltx_bibblock">Generative bigsmiles: an extension for polymer informatics, computer simulations &amp; ml/ai.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Digital Discovery</em>, 3(1):51–61, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. [2022]</span>
<span class="ltx_bibblock">
Jaehong Park, Youngseon Shim, Franklin Lee, Aravind Rammohan, Sushmit Goyal, Munbo Shim, Changwook Jeong, and Dae Sin Kim.

</span>
<span class="ltx_bibblock">Prediction and interpretation of polymer properties using the graph convolutional network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">ACS Polymers Au</em>, 2(4):213–222, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023]</span>
<span class="ltx_bibblock">
Di-Fan Liu, Yong-Xin Zhang, Wen-Zhuo Dong, Qi-Kun Feng, Shao-Long Zhong, and Zhi-Min Dang.

</span>
<span class="ltx_bibblock">High-temperature polymer dielectrics designed using an invertible molecular graph generative model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Journal of Chemical Information and Modeling</em>, 63(24):7669–7675, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. [2022]</span>
<span class="ltx_bibblock">
Minghao Guo, Wan Shou, Liane Makatura, Timothy Erps, Michael Foshey, and Wojciech Matusik.

</span>
<span class="ltx_bibblock">Polygrammar: grammar for digital polymer representation and generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Advanced Science</em>, 9(23):2101864, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antoniuk et al. [2022]</span>
<span class="ltx_bibblock">
Evan R Antoniuk, Peggy Li, Bhavya Kailkhura, and Anna M Hiszpanski.

</span>
<span class="ltx_bibblock">Representing polymers as periodic graphs with learned descriptors for accurate polymer property predictions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Journal of Chemical Information and Modeling</em>, 62(22):5435–5445, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gurnani et al. [2023]</span>
<span class="ltx_bibblock">
Rishi Gurnani, Christopher Kuenneth, Aubrey Toland, and Rampi Ramprasad.

</span>
<span class="ltx_bibblock">Polymer informatics at scale with multitask graph neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Chemistry of Materials</em>, 35(4):1560–1567, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aldeghi and Coley [2022]</span>
<span class="ltx_bibblock">
Matteo Aldeghi and Connor W Coley.

</span>
<span class="ltx_bibblock">A graph representation of molecular ensembles for polymer property prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Chemical Science</em>, 13(35):10486–10498, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vogel et al. [2023]</span>
<span class="ltx_bibblock">
Gabriel Vogel, Paolo Sortino, and Jana Marie Weber.

</span>
<span class="ltx_bibblock">Graph-to-string variational autoencoder for synthetic polymer design.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">AI for Accelerated Materials Design - NeurIPS 2023 Workshop</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=6E2qjEf7Rs" title="">https://openreview.net/forum?id=6E2qjEf7Rs</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Griffiths and Hernández-Lobato [2020]</span>
<span class="ltx_bibblock">
Ryan-Rhys Griffiths and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">Constrained bayesian optimization for automatic chemical design using variational autoencoders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Chemical science</em>, 11(2):577–586, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sousa et al. [2021]</span>
<span class="ltx_bibblock">
Tiago Sousa, João Correia, Vitor Pereira, and Miguel Rocha.

</span>
<span class="ltx_bibblock">Combining multi-objective evolutionary algorithms with deep generative models towards focused molecular design.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Applications of Evolutionary Computation: 24th International Conference, EvoApplications 2021, Held as Part of EvoStar 2021, Virtual Event, April 7–9, 2021, Proceedings 24</em>, pages 81–96. Springer, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Born and Manica [2022]</span>
<span class="ltx_bibblock">
Jannis Born and Matteo Manica.

</span>
<span class="ltx_bibblock">Regression transformer: Concurrent conditional generation and regression by blending numerical and textual tokens.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2202.01338</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Welling [2013]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Max Welling.

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:1312.6114</em>, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dollar et al. [2023]</span>
<span class="ltx_bibblock">
Orion Dollar, Nisarg Joshi, Jim Pfaendtner, and David AC Beck.

</span>
<span class="ltx_bibblock">Efficient 3d molecular design with an e (3) invariant transformer vae.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">The Journal of Physical Chemistry A</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Müller et al. [2024]</span>
<span class="ltx_bibblock">
Alex T Müller, Kenneth Atz, Michael Reutlinger, and Nicolas Zorn.

</span>
<span class="ltx_bibblock">Combining graph attention and recurrent neural networks in a variational autoencoder for molecular representation learning and drug design.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">ICML’24 Workshop ML for Life and Material Science: From Theory to Industry Applications</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. [2017]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. [2021]</span>
<span class="ltx_bibblock">
Le Fang, Tao Zeng, Chaochun Liu, Liefeng Bo, Wen Dong, and Changyou Chen.

</span>
<span class="ltx_bibblock">Transformer-based conditional variational autoencoder for controllable story generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2101.00828</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2020]</span>
<span class="ltx_bibblock">
Chunyuan Li, Xiang Gao, Yuan Li, Baolin Peng, Xiujun Li, Yizhe Zhang, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Optimus: Organizing sentences via pre-trained modeling of a latent space.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2004.04092</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gómez-Bombarelli et al. [2018]</span>
<span class="ltx_bibblock">
Rafael Gómez-Bombarelli, Jennifer N Wei, David Duvenaud, José Miguel Hernández-Lobato, Benjamín Sánchez-Lengeling, Dennis Sheberla, Jorge Aguilera-Iparraguirre, Timothy D Hirzel, Ryan P Adams, and Alán Aspuru-Guzik.

</span>
<span class="ltx_bibblock">Automatic chemical design using a data-driven continuous representation of molecules.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">ACS central science</em>, 4(2):268–276, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. [2019]</span>
<span class="ltx_bibblock">
Yang Bai, Liam Wilbraham, Benjamin J Slater, Martijn A Zwijnenburg, Reiner Sebastian Sprick, and Andrew I Cooper.

</span>
<span class="ltx_bibblock">Accelerated discovery of organic polymer photocatalysts for hydrogen evolution from water through the integration of experiment and theory.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Journal of the American Chemical Society</em>, 141(22):9063–9071, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. [2019]</span>
<span class="ltx_bibblock">
Hao Fu, Chunyuan Li, Xiaodong Liu, Jianfeng Gao, Asli Celikyilmaz, and Lawrence Carin.

</span>
<span class="ltx_bibblock">Cyclical annealing schedule: A simple approach to mitigating kl vanishing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:1903.10145</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nogueira [2014–]</span>
<span class="ltx_bibblock">
Fernando Nogueira.

</span>
<span class="ltx_bibblock">Bayesian Optimization: Open source constrained global optimization tool for Python, 2014–.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/bayesian-optimization/BayesianOptimization" title="">https://github.com/bayesian-optimization/BayesianOptimization</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Siivola et al. [2021]</span>
<span class="ltx_bibblock">
Eero Siivola, Andrei Paleyes, Javier González, and Aki Vehtari.

</span>
<span class="ltx_bibblock">Good practices for bayesian optimization of high dimensional structured spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Applied AI Letters</em>, 2(2):e24, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Maus et al. [2022]</span>
<span class="ltx_bibblock">
Natalie Maus, Haydn Jones, Juston Moore, Matt J Kusner, John Bradshaw, and Jacob Gardner.

</span>
<span class="ltx_bibblock">Local latent space bayesian optimization over structured inputs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Advances in neural information processing systems</em>, 35:34505–34518, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tripp et al. [2020]</span>
<span class="ltx_bibblock">
Austin Tripp, Erik Daxberger, and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">Sample-efficient optimization in the latent space of deep generative models via weighted retraining.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Advances in Neural Information Processing Systems</em>, 33:11259–11272, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deb et al. [2002]</span>
<span class="ltx_bibblock">
Kalyanmoy Deb, Amrit Pratap, Sameer Agarwal, and TAMT Meyarivan.

</span>
<span class="ltx_bibblock">A fast and elitist multiobjective genetic algorithm: Nsga-ii.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">IEEE transactions on evolutionary computation</em>, 6(2):182–197, 2002.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blank and Deb [2020]</span>
<span class="ltx_bibblock">
J. Blank and K. Deb.

</span>
<span class="ltx_bibblock">pymoo: Multi-objective optimization in python.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">IEEE Access</em>, 8:89497–89509, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kusner et al. [2017]</span>
<span class="ltx_bibblock">
Matt J Kusner, Brooks Paige, and José Miguel Hernández-Lobato.

</span>
<span class="ltx_bibblock">Grammar variational autoencoder.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">International conference on machine learning</em>, pages 1945–1954. PMLR, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional details on methods</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Polymer string tokenization</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">For the tokenization of the polymer strings we implement a tokenizer that is inspired by the Regression Transformer <cite class="ltx_cite ltx_citemacro_cite">Born and Manica [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib41" title="">2022</a>]</cite> (RT) tokenization. The strings are tokenized using a combination of a SMILES tokenization and floating point number tokenization. The SMILES tokenization alone uses the same vocabulary for the digits in the SMILES string and the digits in the floating point numbers. The RT-tokenization distinguishes digits in SMILES and the digits in floating point numbers. We demonstrate the difference using the number 0.125 and the monomer string [*:1]c1cc2sc3cc([*:2])sc3c2s1. In red we highlighted the tokens that are encoded with the same vocabulary but represent a different meaning.</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I1.ix1.p1">
<p class="ltx_p" id="A1.I1.ix1.p1.1">SMILES-tokenization: 0.125 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.I1.ix1.p1.1.m1.1"><semantics id="A1.I1.ix1.p1.1.m1.1a"><mo id="A1.I1.ix1.p1.1.m1.1.1" stretchy="false" xref="A1.I1.ix1.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.I1.ix1.p1.1.m1.1b"><ci id="A1.I1.ix1.p1.1.m1.1.1.cmml" xref="A1.I1.ix1.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.ix1.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.I1.ix1.p1.1.m1.1d">→</annotation></semantics></math> 0 . <span class="ltx_text" id="A1.I1.ix1.p1.1.1" style="color:#FF0000;">1</span> <span class="ltx_text" id="A1.I1.ix1.p1.1.2" style="color:#FF0000;">2</span> 5</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I1.ix2.p1">
<p class="ltx_p" id="A1.I1.ix2.p1.1">SMILES-tokenization: [*:1]c1cc2sc3cc([*:2])sc3c2s1 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.I1.ix2.p1.1.m1.1"><semantics id="A1.I1.ix2.p1.1.m1.1a"><mo id="A1.I1.ix2.p1.1.m1.1.1" stretchy="false" xref="A1.I1.ix2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.I1.ix2.p1.1.m1.1b"><ci id="A1.I1.ix2.p1.1.m1.1.1.cmml" xref="A1.I1.ix2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.ix2.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.I1.ix2.p1.1.m1.1d">→</annotation></semantics></math> [* :1 ] c <span class="ltx_text" id="A1.I1.ix2.p1.1.1" style="color:#FF0000;">1</span> c c <span class="ltx_text" id="A1.I1.ix2.p1.1.2" style="color:#FF0000;">2</span> s c 3 c c ( [* :2 ] ) s c 3 c <span class="ltx_text" id="A1.I1.ix2.p1.1.3" style="color:#FF0000;">2</span> s <span class="ltx_text" id="A1.I1.ix2.p1.1.4" style="color:#FF0000;">1</span></p>
</div>
</li>
</ul>
<p class="ltx_p" id="A1.SS1.p1.2">Using the RT-tokenization, the digits in floating point numbers are enriched by the information of their decimal position (..,0,-1,-2, -3, …) which mitigates this issue of using the same vocabulary:</p>
<ul class="ltx_itemize" id="A1.I2">
<li class="ltx_item" id="A1.I2.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="A1.I2.ix1.p1">
<p class="ltx_p" id="A1.I2.ix1.p1.5">RT-tokenization: 0.125 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.I2.ix1.p1.1.m1.1"><semantics id="A1.I2.ix1.p1.1.m1.1a"><mo id="A1.I2.ix1.p1.1.m1.1.1" stretchy="false" xref="A1.I2.ix1.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.I2.ix1.p1.1.m1.1b"><ci id="A1.I2.ix1.p1.1.m1.1.1.cmml" xref="A1.I2.ix1.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.ix1.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.I2.ix1.p1.1.m1.1d">→</annotation></semantics></math> 0<math alttext="\_" class="ltx_Math" display="inline" id="A1.I2.ix1.p1.2.m2.1"><semantics id="A1.I2.ix1.p1.2.m2.1a"><mi id="A1.I2.ix1.p1.2.m2.1.1" mathvariant="normal" xref="A1.I2.ix1.p1.2.m2.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="A1.I2.ix1.p1.2.m2.1b"><ci id="A1.I2.ix1.p1.2.m2.1.1.cmml" xref="A1.I2.ix1.p1.2.m2.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.ix1.p1.2.m2.1c">\_</annotation><annotation encoding="application/x-llamapun" id="A1.I2.ix1.p1.2.m2.1d">_</annotation></semantics></math>0 . <span class="ltx_text" id="A1.I2.ix1.p1.3.1" style="color:#0000FF;">1<math alttext="\_" class="ltx_Math" display="inline" id="A1.I2.ix1.p1.3.1.m1.1"><semantics id="A1.I2.ix1.p1.3.1.m1.1a"><mi id="A1.I2.ix1.p1.3.1.m1.1.1" mathcolor="#0000FF" mathvariant="normal" xref="A1.I2.ix1.p1.3.1.m1.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="A1.I2.ix1.p1.3.1.m1.1b"><ci id="A1.I2.ix1.p1.3.1.m1.1.1.cmml" xref="A1.I2.ix1.p1.3.1.m1.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.ix1.p1.3.1.m1.1c">\_</annotation><annotation encoding="application/x-llamapun" id="A1.I2.ix1.p1.3.1.m1.1d">_</annotation></semantics></math>-1</span> <span class="ltx_text" id="A1.I2.ix1.p1.4.2" style="color:#0000FF;">2<math alttext="\_" class="ltx_Math" display="inline" id="A1.I2.ix1.p1.4.2.m1.1"><semantics id="A1.I2.ix1.p1.4.2.m1.1a"><mi id="A1.I2.ix1.p1.4.2.m1.1.1" mathcolor="#0000FF" mathvariant="normal" xref="A1.I2.ix1.p1.4.2.m1.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="A1.I2.ix1.p1.4.2.m1.1b"><ci id="A1.I2.ix1.p1.4.2.m1.1.1.cmml" xref="A1.I2.ix1.p1.4.2.m1.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.ix1.p1.4.2.m1.1c">\_</annotation><annotation encoding="application/x-llamapun" id="A1.I2.ix1.p1.4.2.m1.1d">_</annotation></semantics></math>-2</span> 5<math alttext="\_" class="ltx_Math" display="inline" id="A1.I2.ix1.p1.5.m3.1"><semantics id="A1.I2.ix1.p1.5.m3.1a"><mi id="A1.I2.ix1.p1.5.m3.1.1" mathvariant="normal" xref="A1.I2.ix1.p1.5.m3.1.1.cmml">_</mi><annotation-xml encoding="MathML-Content" id="A1.I2.ix1.p1.5.m3.1b"><ci id="A1.I2.ix1.p1.5.m3.1.1.cmml" xref="A1.I2.ix1.p1.5.m3.1.1">_</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.ix1.p1.5.m3.1c">\_</annotation><annotation encoding="application/x-llamapun" id="A1.I2.ix1.p1.5.m3.1d">_</annotation></semantics></math>-3</p>
</div>
</li>
<li class="ltx_item" id="A1.I2.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para ltx_noindent" id="A1.I2.ix2.p1">
<p class="ltx_p" id="A1.I2.ix2.p1.1">RT-tokenization: [*:1]c1cc2sc3cc([*:2])sc3c2s1 <math alttext="\rightarrow" class="ltx_Math" display="inline" id="A1.I2.ix2.p1.1.m1.1"><semantics id="A1.I2.ix2.p1.1.m1.1a"><mo id="A1.I2.ix2.p1.1.m1.1.1" stretchy="false" xref="A1.I2.ix2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A1.I2.ix2.p1.1.m1.1b"><ci id="A1.I2.ix2.p1.1.m1.1.1.cmml" xref="A1.I2.ix2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.I2.ix2.p1.1.m1.1c">\rightarrow</annotation><annotation encoding="application/x-llamapun" id="A1.I2.ix2.p1.1.m1.1d">→</annotation></semantics></math> [* :1 ] c <span class="ltx_text" id="A1.I2.ix2.p1.1.1" style="color:#FF8000;">1</span> c c <span class="ltx_text" id="A1.I2.ix2.p1.1.2" style="color:#FF8000;">2</span> s c 3 c c ( [* :2 ] ) s c 3 c <span class="ltx_text" id="A1.I2.ix2.p1.1.3" style="color:#FF8000;">2</span> s <span class="ltx_text" id="A1.I2.ix2.p1.1.4" style="color:#FF8000;">1</span></p>
</div>
</li>
</ul>
<p class="ltx_p" id="A1.SS1.p1.3">Further the decimal tokenization could be used in future work together with numerical encodings as demonstrated in <cite class="ltx_cite ltx_citemacro_citep">[Born and Manica, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib41" title="">2022</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Variational lower bound of graph-2-string VAE</h3>
<div class="ltx_para ltx_noindent" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">A VAE is trained by maximizing the Variational Lower Bound, which is defined as follows for one datapoint <math alttext="\boldsymbol{x}^{(i)}" class="ltx_Math" display="inline" id="A1.SS2.p1.1.m1.1"><semantics id="A1.SS2.p1.1.m1.1a"><msup id="A1.SS2.p1.1.m1.1.2" xref="A1.SS2.p1.1.m1.1.2.cmml"><mi id="A1.SS2.p1.1.m1.1.2.2" xref="A1.SS2.p1.1.m1.1.2.2.cmml">𝒙</mi><mrow id="A1.SS2.p1.1.m1.1.1.1.3" xref="A1.SS2.p1.1.m1.1.2.cmml"><mo id="A1.SS2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="A1.SS2.p1.1.m1.1.2.cmml">(</mo><mi id="A1.SS2.p1.1.m1.1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="A1.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p1.1.m1.1.2.1.cmml" xref="A1.SS2.p1.1.m1.1.2">superscript</csymbol><ci id="A1.SS2.p1.1.m1.1.2.2.cmml" xref="A1.SS2.p1.1.m1.1.2.2">𝒙</ci><ci id="A1.SS2.p1.1.m1.1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\boldsymbol{x}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.1.m1.1d">bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math></p>
<table class="ltx_equation ltx_eqn_table" id="A1.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x}^{(i)})=%
\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})}\left[%
\log p_{\boldsymbol{\theta}}(\boldsymbol{x}^{(i)}|\boldsymbol{z})\right]-D_{KL%
}(q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})||p_{\boldsymbol{%
\theta}}(\boldsymbol{z}))" class="ltx_math_unparsed" display="block" id="A1.E6.m1.8"><semantics id="A1.E6.m1.8a"><mrow id="A1.E6.m1.8b"><mi class="ltx_font_mathcaligraphic" id="A1.E6.m1.8.9">ℒ</mi><mrow id="A1.E6.m1.8.10"><mo id="A1.E6.m1.8.10.1" stretchy="false">(</mo><mi id="A1.E6.m1.6.6">𝜽</mi><mo id="A1.E6.m1.8.10.2">,</mo><mi class="ltx_mathvariant_bold-italic" id="A1.E6.m1.7.7" mathvariant="bold-italic">ϕ</mi><mo id="A1.E6.m1.8.10.3">;</mo><msup id="A1.E6.m1.8.10.4"><mi id="A1.E6.m1.8.10.4.2">𝒙</mi><mrow id="A1.E6.m1.1.1.1.3"><mo id="A1.E6.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.E6.m1.1.1.1.1">i</mi><mo id="A1.E6.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="A1.E6.m1.8.10.5" stretchy="false">)</mo></mrow><mo id="A1.E6.m1.8.11">=</mo><msub id="A1.E6.m1.8.12"><mi id="A1.E6.m1.8.12.2">𝔼</mi><mrow id="A1.E6.m1.3.3.2"><msub id="A1.E6.m1.3.3.2.4"><mi id="A1.E6.m1.3.3.2.4.2">q</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E6.m1.3.3.2.4.3" mathvariant="bold-italic">ϕ</mi></msub><mo id="A1.E6.m1.3.3.2.3">⁢</mo><mrow id="A1.E6.m1.3.3.2.2.1"><mo id="A1.E6.m1.3.3.2.2.1.2" stretchy="false">(</mo><mrow id="A1.E6.m1.3.3.2.2.1.1"><mi id="A1.E6.m1.3.3.2.2.1.1.2">𝒛</mi><mo fence="false" id="A1.E6.m1.3.3.2.2.1.1.1">|</mo><msup id="A1.E6.m1.3.3.2.2.1.1.3"><mi id="A1.E6.m1.3.3.2.2.1.1.3.2">𝒙</mi><mrow id="A1.E6.m1.2.2.1.1.1.3"><mo id="A1.E6.m1.2.2.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.E6.m1.2.2.1.1.1.1">i</mi><mo id="A1.E6.m1.2.2.1.1.1.3.2" stretchy="false">)</mo></mrow></msup></mrow><mo id="A1.E6.m1.3.3.2.2.1.3" stretchy="false">)</mo></mrow></mrow></msub><mrow id="A1.E6.m1.8.13"><mo id="A1.E6.m1.8.13.1">[</mo><mi id="A1.E6.m1.8.13.2">log</mi><msub id="A1.E6.m1.8.13.3"><mi id="A1.E6.m1.8.13.3.2">p</mi><mi id="A1.E6.m1.8.13.3.3">𝜽</mi></msub><mrow id="A1.E6.m1.8.13.4"><mo id="A1.E6.m1.8.13.4.1" stretchy="false">(</mo><msup id="A1.E6.m1.8.13.4.2"><mi id="A1.E6.m1.8.13.4.2.2">𝒙</mi><mrow id="A1.E6.m1.4.4.1.3"><mo id="A1.E6.m1.4.4.1.3.1" stretchy="false">(</mo><mi id="A1.E6.m1.4.4.1.1">i</mi><mo id="A1.E6.m1.4.4.1.3.2" stretchy="false">)</mo></mrow></msup><mo fence="false" id="A1.E6.m1.8.13.4.3" rspace="0.167em" stretchy="false">|</mo><mi id="A1.E6.m1.8.13.4.4">𝒛</mi><mo id="A1.E6.m1.8.13.4.5" stretchy="false">)</mo></mrow><mo id="A1.E6.m1.8.13.5">]</mo></mrow><mo id="A1.E6.m1.8.14">−</mo><msub id="A1.E6.m1.8.15"><mi id="A1.E6.m1.8.15.2">D</mi><mrow id="A1.E6.m1.8.15.3"><mi id="A1.E6.m1.8.15.3.2">K</mi><mo id="A1.E6.m1.8.15.3.1">⁢</mo><mi id="A1.E6.m1.8.15.3.3">L</mi></mrow></msub><mrow id="A1.E6.m1.8.16"><mo id="A1.E6.m1.8.16.1" stretchy="false">(</mo><msub id="A1.E6.m1.8.16.2"><mi id="A1.E6.m1.8.16.2.2">q</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E6.m1.8.16.2.3" mathvariant="bold-italic">ϕ</mi></msub><mrow id="A1.E6.m1.8.16.3"><mo id="A1.E6.m1.8.16.3.1" stretchy="false">(</mo><mi id="A1.E6.m1.8.16.3.2">𝒛</mi><mo fence="false" id="A1.E6.m1.8.16.3.3" rspace="0.167em" stretchy="false">|</mo><msup id="A1.E6.m1.8.16.3.4"><mi id="A1.E6.m1.8.16.3.4.2">𝒙</mi><mrow id="A1.E6.m1.5.5.1.3"><mo id="A1.E6.m1.5.5.1.3.1" stretchy="false">(</mo><mi id="A1.E6.m1.5.5.1.1">i</mi><mo id="A1.E6.m1.5.5.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="A1.E6.m1.8.16.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E6.m1.8.16.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E6.m1.8.16.5" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E6.m1.8.16.6"><mi id="A1.E6.m1.8.16.6.2">p</mi><mi id="A1.E6.m1.8.16.6.3">𝜽</mi></msub><mrow id="A1.E6.m1.8.16.7"><mo id="A1.E6.m1.8.16.7.1" stretchy="false">(</mo><mi id="A1.E6.m1.8.8">𝒛</mi><mo id="A1.E6.m1.8.16.7.2" stretchy="false">)</mo></mrow><mo id="A1.E6.m1.8.16.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.E6.m1.8c">\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x}^{(i)})=%
\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})}\left[%
\log p_{\boldsymbol{\theta}}(\boldsymbol{x}^{(i)}|\boldsymbol{z})\right]-D_{KL%
}(q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})||p_{\boldsymbol{%
\theta}}(\boldsymbol{z}))</annotation><annotation encoding="application/x-llamapun" id="A1.E6.m1.8d">caligraphic_L ( bold_italic_θ , bold_italic_ϕ ; bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) = blackboard_E start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ roman_log italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT | bold_italic_z ) ] - italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) | | italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p1.5">balancing the maximization of the reconstruction term <math alttext="\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})}[\log p%
_{\boldsymbol{\theta}}(\boldsymbol{x}^{(i)}|\boldsymbol{z})]" class="ltx_Math" display="inline" id="A1.SS2.p1.2.m1.4"><semantics id="A1.SS2.p1.2.m1.4a"><mrow id="A1.SS2.p1.2.m1.4.4" xref="A1.SS2.p1.2.m1.4.4.cmml"><msub id="A1.SS2.p1.2.m1.4.4.3" xref="A1.SS2.p1.2.m1.4.4.3.cmml"><mi id="A1.SS2.p1.2.m1.4.4.3.2" xref="A1.SS2.p1.2.m1.4.4.3.2.cmml">𝔼</mi><mrow id="A1.SS2.p1.2.m1.2.2.2" xref="A1.SS2.p1.2.m1.2.2.2.cmml"><msub id="A1.SS2.p1.2.m1.2.2.2.4" xref="A1.SS2.p1.2.m1.2.2.2.4.cmml"><mi id="A1.SS2.p1.2.m1.2.2.2.4.2" xref="A1.SS2.p1.2.m1.2.2.2.4.2.cmml">q</mi><mi class="ltx_mathvariant_bold-italic" id="A1.SS2.p1.2.m1.2.2.2.4.3" mathvariant="bold-italic" xref="A1.SS2.p1.2.m1.2.2.2.4.3.cmml">ϕ</mi></msub><mo id="A1.SS2.p1.2.m1.2.2.2.3" xref="A1.SS2.p1.2.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.SS2.p1.2.m1.2.2.2.2.1" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.cmml"><mo id="A1.SS2.p1.2.m1.2.2.2.2.1.2" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="A1.SS2.p1.2.m1.2.2.2.2.1.1" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.cmml"><mi id="A1.SS2.p1.2.m1.2.2.2.2.1.1.2" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.2.cmml">𝒛</mi><mo fence="false" id="A1.SS2.p1.2.m1.2.2.2.2.1.1.1" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.1.cmml">|</mo><msup id="A1.SS2.p1.2.m1.2.2.2.2.1.1.3" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.cmml"><mi id="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.2" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.2.cmml">𝒙</mi><mrow id="A1.SS2.p1.2.m1.1.1.1.1.1.3" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.cmml"><mo id="A1.SS2.p1.2.m1.1.1.1.1.1.3.1" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.cmml">(</mo><mi id="A1.SS2.p1.2.m1.1.1.1.1.1.1" xref="A1.SS2.p1.2.m1.1.1.1.1.1.1.cmml">i</mi><mo id="A1.SS2.p1.2.m1.1.1.1.1.1.3.2" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="A1.SS2.p1.2.m1.2.2.2.2.1.3" stretchy="false" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></msub><mo id="A1.SS2.p1.2.m1.4.4.2" xref="A1.SS2.p1.2.m1.4.4.2.cmml">⁢</mo><mrow id="A1.SS2.p1.2.m1.4.4.1.1" xref="A1.SS2.p1.2.m1.4.4.1.2.cmml"><mo id="A1.SS2.p1.2.m1.4.4.1.1.2" stretchy="false" xref="A1.SS2.p1.2.m1.4.4.1.2.1.cmml">[</mo><mrow id="A1.SS2.p1.2.m1.4.4.1.1.1" xref="A1.SS2.p1.2.m1.4.4.1.1.1.cmml"><mrow id="A1.SS2.p1.2.m1.4.4.1.1.1.3" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.cmml"><mi id="A1.SS2.p1.2.m1.4.4.1.1.1.3.1" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.1.cmml">log</mi><mo id="A1.SS2.p1.2.m1.4.4.1.1.1.3a" lspace="0.167em" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.cmml">⁡</mo><msub id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.cmml"><mi id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.2" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.2.cmml">p</mi><mi id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.3" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo id="A1.SS2.p1.2.m1.4.4.1.1.1.2" xref="A1.SS2.p1.2.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.cmml"><msup id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.2" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mrow id="A1.SS2.p1.2.m1.3.3.1.3" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="A1.SS2.p1.2.m1.3.3.1.3.1" stretchy="false" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="A1.SS2.p1.2.m1.3.3.1.1" xref="A1.SS2.p1.2.m1.3.3.1.1.cmml">i</mi><mo id="A1.SS2.p1.2.m1.3.3.1.3.2" stretchy="false" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.1" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.1.cmml">|</mo><mi id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.3" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p1.2.m1.4.4.1.1.3" stretchy="false" xref="A1.SS2.p1.2.m1.4.4.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.2.m1.4b"><apply id="A1.SS2.p1.2.m1.4.4.cmml" xref="A1.SS2.p1.2.m1.4.4"><times id="A1.SS2.p1.2.m1.4.4.2.cmml" xref="A1.SS2.p1.2.m1.4.4.2"></times><apply id="A1.SS2.p1.2.m1.4.4.3.cmml" xref="A1.SS2.p1.2.m1.4.4.3"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.4.4.3.1.cmml" xref="A1.SS2.p1.2.m1.4.4.3">subscript</csymbol><ci id="A1.SS2.p1.2.m1.4.4.3.2.cmml" xref="A1.SS2.p1.2.m1.4.4.3.2">𝔼</ci><apply id="A1.SS2.p1.2.m1.2.2.2.cmml" xref="A1.SS2.p1.2.m1.2.2.2"><times id="A1.SS2.p1.2.m1.2.2.2.3.cmml" xref="A1.SS2.p1.2.m1.2.2.2.3"></times><apply id="A1.SS2.p1.2.m1.2.2.2.4.cmml" xref="A1.SS2.p1.2.m1.2.2.2.4"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.2.2.2.4.1.cmml" xref="A1.SS2.p1.2.m1.2.2.2.4">subscript</csymbol><ci id="A1.SS2.p1.2.m1.2.2.2.4.2.cmml" xref="A1.SS2.p1.2.m1.2.2.2.4.2">𝑞</ci><ci id="A1.SS2.p1.2.m1.2.2.2.4.3.cmml" xref="A1.SS2.p1.2.m1.2.2.2.4.3">bold-italic-ϕ</ci></apply><apply id="A1.SS2.p1.2.m1.2.2.2.2.1.1.cmml" xref="A1.SS2.p1.2.m1.2.2.2.2.1"><csymbol cd="latexml" id="A1.SS2.p1.2.m1.2.2.2.2.1.1.1.cmml" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="A1.SS2.p1.2.m1.2.2.2.2.1.1.2.cmml" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.2">𝒛</ci><apply id="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.cmml" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.1.cmml" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.2.cmml" xref="A1.SS2.p1.2.m1.2.2.2.2.1.1.3.2">𝒙</ci><ci id="A1.SS2.p1.2.m1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.2.m1.1.1.1.1.1.1">𝑖</ci></apply></apply></apply></apply><apply id="A1.SS2.p1.2.m1.4.4.1.2.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1"><csymbol cd="latexml" id="A1.SS2.p1.2.m1.4.4.1.2.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.2">delimited-[]</csymbol><apply id="A1.SS2.p1.2.m1.4.4.1.1.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1"><times id="A1.SS2.p1.2.m1.4.4.1.1.1.2.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.2"></times><apply id="A1.SS2.p1.2.m1.4.4.1.1.1.3.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3"><log id="A1.SS2.p1.2.m1.4.4.1.1.1.3.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.1"></log><apply id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2">subscript</csymbol><ci id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.2.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.2">𝑝</ci><ci id="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.3.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.1">conditional</csymbol><apply id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.2.2">𝒙</ci><ci id="A1.SS2.p1.2.m1.3.3.1.1.cmml" xref="A1.SS2.p1.2.m1.3.3.1.1">𝑖</ci></apply><ci id="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p1.2.m1.4.4.1.1.1.1.1.1.3">𝒛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.2.m1.4c">\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})}[\log p%
_{\boldsymbol{\theta}}(\boldsymbol{x}^{(i)}|\boldsymbol{z})]</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.2.m1.4d">blackboard_E start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ roman_log italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT | bold_italic_z ) ]</annotation></semantics></math> with minimization of the regularization term <math alttext="D_{KL}(q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})||p(%
\boldsymbol{z}))" class="ltx_math_unparsed" display="inline" id="A1.SS2.p1.3.m2.2"><semantics id="A1.SS2.p1.3.m2.2a"><mrow id="A1.SS2.p1.3.m2.2b"><msub id="A1.SS2.p1.3.m2.2.3"><mi id="A1.SS2.p1.3.m2.2.3.2">D</mi><mrow id="A1.SS2.p1.3.m2.2.3.3"><mi id="A1.SS2.p1.3.m2.2.3.3.2">K</mi><mo id="A1.SS2.p1.3.m2.2.3.3.1">⁢</mo><mi id="A1.SS2.p1.3.m2.2.3.3.3">L</mi></mrow></msub><mrow id="A1.SS2.p1.3.m2.2.4"><mo id="A1.SS2.p1.3.m2.2.4.1" stretchy="false">(</mo><msub id="A1.SS2.p1.3.m2.2.4.2"><mi id="A1.SS2.p1.3.m2.2.4.2.2">q</mi><mi class="ltx_mathvariant_bold-italic" id="A1.SS2.p1.3.m2.2.4.2.3" mathvariant="bold-italic">ϕ</mi></msub><mrow id="A1.SS2.p1.3.m2.2.4.3"><mo id="A1.SS2.p1.3.m2.2.4.3.1" stretchy="false">(</mo><mi id="A1.SS2.p1.3.m2.2.4.3.2">𝒛</mi><mo fence="false" id="A1.SS2.p1.3.m2.2.4.3.3" rspace="0.167em" stretchy="false">|</mo><msup id="A1.SS2.p1.3.m2.2.4.3.4"><mi id="A1.SS2.p1.3.m2.2.4.3.4.2">𝒙</mi><mrow id="A1.SS2.p1.3.m2.1.1.1.3"><mo id="A1.SS2.p1.3.m2.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.SS2.p1.3.m2.1.1.1.1">i</mi><mo id="A1.SS2.p1.3.m2.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="A1.SS2.p1.3.m2.2.4.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.SS2.p1.3.m2.2.4.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.SS2.p1.3.m2.2.4.5" rspace="0.167em" stretchy="false">|</mo><mi id="A1.SS2.p1.3.m2.2.4.6">p</mi><mrow id="A1.SS2.p1.3.m2.2.4.7"><mo id="A1.SS2.p1.3.m2.2.4.7.1" stretchy="false">(</mo><mi id="A1.SS2.p1.3.m2.2.2">𝒛</mi><mo id="A1.SS2.p1.3.m2.2.4.7.2" stretchy="false">)</mo></mrow><mo id="A1.SS2.p1.3.m2.2.4.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="A1.SS2.p1.3.m2.2c">D_{KL}(q_{\boldsymbol{\phi}}(\boldsymbol{z}|\boldsymbol{x}^{(i)})||p(%
\boldsymbol{z}))</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.3.m2.2d">italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | bold_italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) | | italic_p ( bold_italic_z ) )</annotation></semantics></math>, where the prior <math alttext="p(\boldsymbol{z})" class="ltx_Math" display="inline" id="A1.SS2.p1.4.m3.1"><semantics id="A1.SS2.p1.4.m3.1a"><mrow id="A1.SS2.p1.4.m3.1.2" xref="A1.SS2.p1.4.m3.1.2.cmml"><mi id="A1.SS2.p1.4.m3.1.2.2" xref="A1.SS2.p1.4.m3.1.2.2.cmml">p</mi><mo id="A1.SS2.p1.4.m3.1.2.1" xref="A1.SS2.p1.4.m3.1.2.1.cmml">⁢</mo><mrow id="A1.SS2.p1.4.m3.1.2.3.2" xref="A1.SS2.p1.4.m3.1.2.cmml"><mo id="A1.SS2.p1.4.m3.1.2.3.2.1" stretchy="false" xref="A1.SS2.p1.4.m3.1.2.cmml">(</mo><mi id="A1.SS2.p1.4.m3.1.1" xref="A1.SS2.p1.4.m3.1.1.cmml">𝒛</mi><mo id="A1.SS2.p1.4.m3.1.2.3.2.2" stretchy="false" xref="A1.SS2.p1.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.4.m3.1b"><apply id="A1.SS2.p1.4.m3.1.2.cmml" xref="A1.SS2.p1.4.m3.1.2"><times id="A1.SS2.p1.4.m3.1.2.1.cmml" xref="A1.SS2.p1.4.m3.1.2.1"></times><ci id="A1.SS2.p1.4.m3.1.2.2.cmml" xref="A1.SS2.p1.4.m3.1.2.2">𝑝</ci><ci id="A1.SS2.p1.4.m3.1.1.cmml" xref="A1.SS2.p1.4.m3.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.4.m3.1c">p(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.4.m3.1d">italic_p ( bold_italic_z )</annotation></semantics></math> is a normal distribution <math alttext="\mathcal{N}(0,I)" class="ltx_Math" display="inline" id="A1.SS2.p1.5.m4.2"><semantics id="A1.SS2.p1.5.m4.2a"><mrow id="A1.SS2.p1.5.m4.2.3" xref="A1.SS2.p1.5.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p1.5.m4.2.3.2" xref="A1.SS2.p1.5.m4.2.3.2.cmml">𝒩</mi><mo id="A1.SS2.p1.5.m4.2.3.1" xref="A1.SS2.p1.5.m4.2.3.1.cmml">⁢</mo><mrow id="A1.SS2.p1.5.m4.2.3.3.2" xref="A1.SS2.p1.5.m4.2.3.3.1.cmml"><mo id="A1.SS2.p1.5.m4.2.3.3.2.1" stretchy="false" xref="A1.SS2.p1.5.m4.2.3.3.1.cmml">(</mo><mn id="A1.SS2.p1.5.m4.1.1" xref="A1.SS2.p1.5.m4.1.1.cmml">0</mn><mo id="A1.SS2.p1.5.m4.2.3.3.2.2" xref="A1.SS2.p1.5.m4.2.3.3.1.cmml">,</mo><mi id="A1.SS2.p1.5.m4.2.2" xref="A1.SS2.p1.5.m4.2.2.cmml">I</mi><mo id="A1.SS2.p1.5.m4.2.3.3.2.3" stretchy="false" xref="A1.SS2.p1.5.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.5.m4.2b"><apply id="A1.SS2.p1.5.m4.2.3.cmml" xref="A1.SS2.p1.5.m4.2.3"><times id="A1.SS2.p1.5.m4.2.3.1.cmml" xref="A1.SS2.p1.5.m4.2.3.1"></times><ci id="A1.SS2.p1.5.m4.2.3.2.cmml" xref="A1.SS2.p1.5.m4.2.3.2">𝒩</ci><interval closure="open" id="A1.SS2.p1.5.m4.2.3.3.1.cmml" xref="A1.SS2.p1.5.m4.2.3.3.2"><cn id="A1.SS2.p1.5.m4.1.1.cmml" type="integer" xref="A1.SS2.p1.5.m4.1.1">0</cn><ci id="A1.SS2.p1.5.m4.2.2.cmml" xref="A1.SS2.p1.5.m4.2.2">𝐼</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.5.m4.2c">\mathcal{N}(0,I)</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p1.5.m4.2d">caligraphic_N ( 0 , italic_I )</annotation></semantics></math>. During training, the negative of the lower bound is minimized, as described in <cite class="ltx_cite ltx_citemacro_citep">[Kingma and Welling, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib42" title="">2013</a>]</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.2">As a result of the modified components of the VAE, encoding a graph and decoding a string, the variational lower bound in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.E6" title="In A.2 Variational lower bound of graph-2-string VAE ‣ Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">6</span></a> can be rewritten as</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x_{S}}^{(i)},G^{%
(i)})=\underbrace{\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}|G^{(i)})}%
\left[\log p_{\boldsymbol{\theta}}(\boldsymbol{x_{S}}^{(i)}|\boldsymbol{z},G^{%
(i)})\right]}_{-\mathcal{L}_{rec}}-\underbrace{D_{KL}(q_{\boldsymbol{\phi}}(%
\boldsymbol{z}|G^{(i)})||p_{\boldsymbol{\theta}}(\boldsymbol{z}))}_{\mathcal{L%
}_{KLD}}." class="ltx_math_unparsed" display="block" id="A1.E7.m1.13"><semantics id="A1.E7.m1.13a"><mrow id="A1.E7.m1.13.13.1"><mrow id="A1.E7.m1.13.13.1.1"><mrow id="A1.E7.m1.13.13.1.1.2"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.13.13.1.1.2.4">ℒ</mi><mo id="A1.E7.m1.13.13.1.1.2.3">⁢</mo><mrow id="A1.E7.m1.13.13.1.1.2.2.2"><mo id="A1.E7.m1.13.13.1.1.2.2.2.3" stretchy="false">(</mo><mi id="A1.E7.m1.11.11">𝜽</mi><mo id="A1.E7.m1.13.13.1.1.2.2.2.4">,</mo><mi class="ltx_mathvariant_bold-italic" id="A1.E7.m1.12.12" mathvariant="bold-italic">ϕ</mi><mo id="A1.E7.m1.13.13.1.1.2.2.2.5">;</mo><mmultiscripts id="A1.E7.m1.13.13.1.1.1.1.1.1"><mi id="A1.E7.m1.13.13.1.1.1.1.1.1.2.2">𝒙</mi><mi id="A1.E7.m1.13.13.1.1.1.1.1.1.2.3">𝑺</mi><mrow id="A1.E7.m1.13.13.1.1.1.1.1.1a"></mrow><mrow id="A1.E7.m1.13.13.1.1.1.1.1.1b"></mrow><mrow id="A1.E7.m1.1.1.1.3"><mo id="A1.E7.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.1.1.1.1">i</mi><mo id="A1.E7.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></mmultiscripts><mo id="A1.E7.m1.13.13.1.1.2.2.2.6">,</mo><msup id="A1.E7.m1.13.13.1.1.2.2.2.2"><mi id="A1.E7.m1.13.13.1.1.2.2.2.2.2">G</mi><mrow id="A1.E7.m1.2.2.1.3"><mo id="A1.E7.m1.2.2.1.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.2.2.1.1">i</mi><mo id="A1.E7.m1.2.2.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="A1.E7.m1.13.13.1.1.2.2.2.7" stretchy="false">)</mo></mrow></mrow><mo id="A1.E7.m1.13.13.1.1.3">=</mo><mrow id="A1.E7.m1.13.13.1.1.4"><munder id="A1.E7.m1.13.13.1.1.4.2"><munder accentunder="true" id="A1.E7.m1.8.8"><mrow id="A1.E7.m1.8.8.6"><msub id="A1.E7.m1.8.8.6.8"><mi id="A1.E7.m1.8.8.6.8.2">𝔼</mi><mrow id="A1.E7.m1.4.4.2.2.2"><msub id="A1.E7.m1.4.4.2.2.2.4"><mi id="A1.E7.m1.4.4.2.2.2.4.2">q</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E7.m1.4.4.2.2.2.4.3" mathvariant="bold-italic">ϕ</mi></msub><mo id="A1.E7.m1.4.4.2.2.2.3">⁢</mo><mrow id="A1.E7.m1.4.4.2.2.2.2.1"><mo id="A1.E7.m1.4.4.2.2.2.2.1.2" stretchy="false">(</mo><mrow id="A1.E7.m1.4.4.2.2.2.2.1.1"><mi id="A1.E7.m1.4.4.2.2.2.2.1.1.2">𝒛</mi><mo fence="false" id="A1.E7.m1.4.4.2.2.2.2.1.1.1">|</mo><msup id="A1.E7.m1.4.4.2.2.2.2.1.1.3"><mi id="A1.E7.m1.4.4.2.2.2.2.1.1.3.2">G</mi><mrow id="A1.E7.m1.3.3.1.1.1.1.1.3"><mo id="A1.E7.m1.3.3.1.1.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.3.3.1.1.1.1.1.1">i</mi><mo id="A1.E7.m1.3.3.1.1.1.1.1.3.2" stretchy="false">)</mo></mrow></msup></mrow><mo id="A1.E7.m1.4.4.2.2.2.2.1.3" stretchy="false">)</mo></mrow></mrow></msub><mo id="A1.E7.m1.8.8.6.7">⁢</mo><mrow id="A1.E7.m1.8.8.6.6.1"><mo id="A1.E7.m1.8.8.6.6.1.2">[</mo><mrow id="A1.E7.m1.8.8.6.6.1.1"><mrow id="A1.E7.m1.8.8.6.6.1.1.3"><mi id="A1.E7.m1.8.8.6.6.1.1.3.1">log</mi><mo id="A1.E7.m1.8.8.6.6.1.1.3a" lspace="0.167em">⁡</mo><msub id="A1.E7.m1.8.8.6.6.1.1.3.2"><mi id="A1.E7.m1.8.8.6.6.1.1.3.2.2">p</mi><mi id="A1.E7.m1.8.8.6.6.1.1.3.2.3">𝜽</mi></msub></mrow><mo id="A1.E7.m1.8.8.6.6.1.1.2">⁢</mo><mrow id="A1.E7.m1.8.8.6.6.1.1.1.1"><mo id="A1.E7.m1.8.8.6.6.1.1.1.1.2" stretchy="false">(</mo><mrow id="A1.E7.m1.8.8.6.6.1.1.1.1.1"><mmultiscripts id="A1.E7.m1.8.8.6.6.1.1.1.1.1.3"><mi id="A1.E7.m1.8.8.6.6.1.1.1.1.1.3.2.2">𝒙</mi><mi id="A1.E7.m1.8.8.6.6.1.1.1.1.1.3.2.3">𝑺</mi><mrow id="A1.E7.m1.8.8.6.6.1.1.1.1.1.3a"></mrow><mrow id="A1.E7.m1.8.8.6.6.1.1.1.1.1.3b"></mrow><mrow id="A1.E7.m1.5.5.3.3.1.3"><mo id="A1.E7.m1.5.5.3.3.1.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.5.5.3.3.1.1">i</mi><mo id="A1.E7.m1.5.5.3.3.1.3.2" stretchy="false">)</mo></mrow></mmultiscripts><mo fence="false" id="A1.E7.m1.8.8.6.6.1.1.1.1.1.2">|</mo><mrow id="A1.E7.m1.8.8.6.6.1.1.1.1.1.1.1"><mi id="A1.E7.m1.7.7.5.5">𝒛</mi><mo id="A1.E7.m1.8.8.6.6.1.1.1.1.1.1.1.2">,</mo><msup id="A1.E7.m1.8.8.6.6.1.1.1.1.1.1.1.1"><mi id="A1.E7.m1.8.8.6.6.1.1.1.1.1.1.1.1.2">G</mi><mrow id="A1.E7.m1.6.6.4.4.1.3"><mo id="A1.E7.m1.6.6.4.4.1.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.6.6.4.4.1.1">i</mi><mo id="A1.E7.m1.6.6.4.4.1.3.2" stretchy="false">)</mo></mrow></msup></mrow></mrow><mo id="A1.E7.m1.8.8.6.6.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mo id="A1.E7.m1.8.8.6.6.1.3">]</mo></mrow></mrow><mo id="A1.E7.m1.8.8.7">⏟</mo></munder><mrow id="A1.E7.m1.13.13.1.1.4.2.2"><mo id="A1.E7.m1.13.13.1.1.4.2.2a">−</mo><msub id="A1.E7.m1.13.13.1.1.4.2.2.2"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.13.13.1.1.4.2.2.2.2">ℒ</mi><mrow id="A1.E7.m1.13.13.1.1.4.2.2.2.3"><mi id="A1.E7.m1.13.13.1.1.4.2.2.2.3.2">r</mi><mo id="A1.E7.m1.13.13.1.1.4.2.2.2.3.1">⁢</mo><mi id="A1.E7.m1.13.13.1.1.4.2.2.2.3.3">e</mi><mo id="A1.E7.m1.13.13.1.1.4.2.2.2.3.1a">⁢</mo><mi id="A1.E7.m1.13.13.1.1.4.2.2.2.3.4">c</mi></mrow></msub></mrow></munder><mo id="A1.E7.m1.13.13.1.1.4.1">−</mo><munder id="A1.E7.m1.13.13.1.1.4.3"><munder accentunder="true" id="A1.E7.m1.10.10"><mrow id="A1.E7.m1.10.10.2"><msub id="A1.E7.m1.10.10.2.3"><mi id="A1.E7.m1.10.10.2.3.2">D</mi><mrow id="A1.E7.m1.10.10.2.3.3"><mi id="A1.E7.m1.10.10.2.3.3.2">K</mi><mo id="A1.E7.m1.10.10.2.3.3.1">⁢</mo><mi id="A1.E7.m1.10.10.2.3.3.3">L</mi></mrow></msub><mrow id="A1.E7.m1.10.10.2.4"><mo id="A1.E7.m1.10.10.2.4.1" stretchy="false">(</mo><msub id="A1.E7.m1.10.10.2.4.2"><mi id="A1.E7.m1.10.10.2.4.2.2">q</mi><mi class="ltx_mathvariant_bold-italic" id="A1.E7.m1.10.10.2.4.2.3" mathvariant="bold-italic">ϕ</mi></msub><mrow id="A1.E7.m1.10.10.2.4.3"><mo id="A1.E7.m1.10.10.2.4.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.10.10.2.4.3.2">𝒛</mi><mo fence="false" id="A1.E7.m1.10.10.2.4.3.3" rspace="0.167em" stretchy="false">|</mo><msup id="A1.E7.m1.10.10.2.4.3.4"><mi id="A1.E7.m1.10.10.2.4.3.4.2">G</mi><mrow id="A1.E7.m1.9.9.1.1.1.3"><mo id="A1.E7.m1.9.9.1.1.1.3.1" stretchy="false">(</mo><mi id="A1.E7.m1.9.9.1.1.1.1">i</mi><mo id="A1.E7.m1.9.9.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="A1.E7.m1.10.10.2.4.3.5" stretchy="false">)</mo></mrow><mo fence="false" id="A1.E7.m1.10.10.2.4.4" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="A1.E7.m1.10.10.2.4.5" rspace="0.167em" stretchy="false">|</mo><msub id="A1.E7.m1.10.10.2.4.6"><mi id="A1.E7.m1.10.10.2.4.6.2">p</mi><mi id="A1.E7.m1.10.10.2.4.6.3">𝜽</mi></msub><mrow id="A1.E7.m1.10.10.2.4.7"><mo id="A1.E7.m1.10.10.2.4.7.1" stretchy="false">(</mo><mi id="A1.E7.m1.10.10.2.2">𝒛</mi><mo id="A1.E7.m1.10.10.2.4.7.2" stretchy="false">)</mo></mrow><mo id="A1.E7.m1.10.10.2.4.8" stretchy="false">)</mo></mrow></mrow><mo id="A1.E7.m1.10.10.3">⏟</mo></munder><msub id="A1.E7.m1.13.13.1.1.4.3.2"><mi class="ltx_font_mathcaligraphic" id="A1.E7.m1.13.13.1.1.4.3.2.2">ℒ</mi><mrow id="A1.E7.m1.13.13.1.1.4.3.2.3"><mi id="A1.E7.m1.13.13.1.1.4.3.2.3.2">K</mi><mo id="A1.E7.m1.13.13.1.1.4.3.2.3.1">⁢</mo><mi id="A1.E7.m1.13.13.1.1.4.3.2.3.3">L</mi><mo id="A1.E7.m1.13.13.1.1.4.3.2.3.1a">⁢</mo><mi id="A1.E7.m1.13.13.1.1.4.3.2.3.4">D</mi></mrow></msub></munder></mrow></mrow><mo id="A1.E7.m1.13.13.1.2" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="A1.E7.m1.13b">\mathcal{L}(\boldsymbol{\theta},\boldsymbol{\phi};\boldsymbol{x_{S}}^{(i)},G^{%
(i)})=\underbrace{\mathbb{E}_{q_{\boldsymbol{\phi}}(\boldsymbol{z}|G^{(i)})}%
\left[\log p_{\boldsymbol{\theta}}(\boldsymbol{x_{S}}^{(i)}|\boldsymbol{z},G^{%
(i)})\right]}_{-\mathcal{L}_{rec}}-\underbrace{D_{KL}(q_{\boldsymbol{\phi}}(%
\boldsymbol{z}|G^{(i)})||p_{\boldsymbol{\theta}}(\boldsymbol{z}))}_{\mathcal{L%
}_{KLD}}.</annotation><annotation encoding="application/x-llamapun" id="A1.E7.m1.13c">caligraphic_L ( bold_italic_θ , bold_italic_ϕ ; bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_G start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) = under⏟ start_ARG blackboard_E start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | italic_G start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) end_POSTSUBSCRIPT [ roman_log italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT bold_italic_S end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT | bold_italic_z , italic_G start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) ] end_ARG start_POSTSUBSCRIPT - caligraphic_L start_POSTSUBSCRIPT italic_r italic_e italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT - under⏟ start_ARG italic_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT ( italic_q start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( bold_italic_z | italic_G start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) | | italic_p start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z ) ) end_ARG start_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_K italic_L italic_D end_POSTSUBSCRIPT end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p2.1">The loss that is minimized during training is the negative of Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A1.E7" title="In A.2 Variational lower bound of graph-2-string VAE ‣ Appendix A Additional details on methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">7</span></a>) with the addition of a hyperparameter <math alttext="\beta" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1"><semantics id="A1.SS2.p2.1.m1.1a"><mi id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b"><ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p2.1.m1.1d">italic_β</annotation></semantics></math> to balance the two loss terms.</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathcal{L}_{Rec}+\beta\cdot\mathcal{L}_{KLD}" class="ltx_Math" display="block" id="A1.E8.m1.1"><semantics id="A1.E8.m1.1a"><mrow id="A1.E8.m1.1.1" xref="A1.E8.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E8.m1.1.1.2" xref="A1.E8.m1.1.1.2.cmml">ℒ</mi><mo id="A1.E8.m1.1.1.1" xref="A1.E8.m1.1.1.1.cmml">=</mo><mrow id="A1.E8.m1.1.1.3" xref="A1.E8.m1.1.1.3.cmml"><msub id="A1.E8.m1.1.1.3.2" xref="A1.E8.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E8.m1.1.1.3.2.2" xref="A1.E8.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="A1.E8.m1.1.1.3.2.3" xref="A1.E8.m1.1.1.3.2.3.cmml"><mi id="A1.E8.m1.1.1.3.2.3.2" xref="A1.E8.m1.1.1.3.2.3.2.cmml">R</mi><mo id="A1.E8.m1.1.1.3.2.3.1" xref="A1.E8.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E8.m1.1.1.3.2.3.3" xref="A1.E8.m1.1.1.3.2.3.3.cmml">e</mi><mo id="A1.E8.m1.1.1.3.2.3.1a" xref="A1.E8.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="A1.E8.m1.1.1.3.2.3.4" xref="A1.E8.m1.1.1.3.2.3.4.cmml">c</mi></mrow></msub><mo id="A1.E8.m1.1.1.3.1" xref="A1.E8.m1.1.1.3.1.cmml">+</mo><mrow id="A1.E8.m1.1.1.3.3" xref="A1.E8.m1.1.1.3.3.cmml"><mi id="A1.E8.m1.1.1.3.3.2" xref="A1.E8.m1.1.1.3.3.2.cmml">β</mi><mo id="A1.E8.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.E8.m1.1.1.3.3.1.cmml">⋅</mo><msub id="A1.E8.m1.1.1.3.3.3" xref="A1.E8.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E8.m1.1.1.3.3.3.2" xref="A1.E8.m1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="A1.E8.m1.1.1.3.3.3.3" xref="A1.E8.m1.1.1.3.3.3.3.cmml"><mi id="A1.E8.m1.1.1.3.3.3.3.2" xref="A1.E8.m1.1.1.3.3.3.3.2.cmml">K</mi><mo id="A1.E8.m1.1.1.3.3.3.3.1" xref="A1.E8.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E8.m1.1.1.3.3.3.3.3" xref="A1.E8.m1.1.1.3.3.3.3.3.cmml">L</mi><mo id="A1.E8.m1.1.1.3.3.3.3.1a" xref="A1.E8.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E8.m1.1.1.3.3.3.3.4" xref="A1.E8.m1.1.1.3.3.3.3.4.cmml">D</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.1b"><apply id="A1.E8.m1.1.1.cmml" xref="A1.E8.m1.1.1"><eq id="A1.E8.m1.1.1.1.cmml" xref="A1.E8.m1.1.1.1"></eq><ci id="A1.E8.m1.1.1.2.cmml" xref="A1.E8.m1.1.1.2">ℒ</ci><apply id="A1.E8.m1.1.1.3.cmml" xref="A1.E8.m1.1.1.3"><plus id="A1.E8.m1.1.1.3.1.cmml" xref="A1.E8.m1.1.1.3.1"></plus><apply id="A1.E8.m1.1.1.3.2.cmml" xref="A1.E8.m1.1.1.3.2"><csymbol cd="ambiguous" id="A1.E8.m1.1.1.3.2.1.cmml" xref="A1.E8.m1.1.1.3.2">subscript</csymbol><ci id="A1.E8.m1.1.1.3.2.2.cmml" xref="A1.E8.m1.1.1.3.2.2">ℒ</ci><apply id="A1.E8.m1.1.1.3.2.3.cmml" xref="A1.E8.m1.1.1.3.2.3"><times id="A1.E8.m1.1.1.3.2.3.1.cmml" xref="A1.E8.m1.1.1.3.2.3.1"></times><ci id="A1.E8.m1.1.1.3.2.3.2.cmml" xref="A1.E8.m1.1.1.3.2.3.2">𝑅</ci><ci id="A1.E8.m1.1.1.3.2.3.3.cmml" xref="A1.E8.m1.1.1.3.2.3.3">𝑒</ci><ci id="A1.E8.m1.1.1.3.2.3.4.cmml" xref="A1.E8.m1.1.1.3.2.3.4">𝑐</ci></apply></apply><apply id="A1.E8.m1.1.1.3.3.cmml" xref="A1.E8.m1.1.1.3.3"><ci id="A1.E8.m1.1.1.3.3.1.cmml" xref="A1.E8.m1.1.1.3.3.1">⋅</ci><ci id="A1.E8.m1.1.1.3.3.2.cmml" xref="A1.E8.m1.1.1.3.3.2">𝛽</ci><apply id="A1.E8.m1.1.1.3.3.3.cmml" xref="A1.E8.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.1.1.3.3.3.1.cmml" xref="A1.E8.m1.1.1.3.3.3">subscript</csymbol><ci id="A1.E8.m1.1.1.3.3.3.2.cmml" xref="A1.E8.m1.1.1.3.3.3.2">ℒ</ci><apply id="A1.E8.m1.1.1.3.3.3.3.cmml" xref="A1.E8.m1.1.1.3.3.3.3"><times id="A1.E8.m1.1.1.3.3.3.3.1.cmml" xref="A1.E8.m1.1.1.3.3.3.3.1"></times><ci id="A1.E8.m1.1.1.3.3.3.3.2.cmml" xref="A1.E8.m1.1.1.3.3.3.3.2">𝐾</ci><ci id="A1.E8.m1.1.1.3.3.3.3.3.cmml" xref="A1.E8.m1.1.1.3.3.3.3.3">𝐿</ci><ci id="A1.E8.m1.1.1.3.3.3.3.4.cmml" xref="A1.E8.m1.1.1.3.3.3.3.4">𝐷</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.1c">\mathcal{L}=\mathcal{L}_{Rec}+\beta\cdot\mathcal{L}_{KLD}</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.1d">caligraphic_L = caligraphic_L start_POSTSUBSCRIPT italic_R italic_e italic_c end_POSTSUBSCRIPT + italic_β ⋅ caligraphic_L start_POSTSUBSCRIPT italic_K italic_L italic_D end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Choice of target values in objective function</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">The goal in our study is to generate novel polymers with targeted property values indicating a high HER. To do so, we leverage the continuous latent space of our model, allowing for optimization of the latent variables to decode candidates with desired properties. In our case study the ideal property to optimize would be the HER, which is not given for the dataset we used to train our model. However, <cite class="ltx_cite ltx_citemacro_citet">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite> found that materials with more negative electron affinity (EA) and more positive ioinization potential (IP) showed better HERs. This is likely related to the optical gap, approximated as |EA - IP|; larger optical gaps often correlate with higher HER. Thus, maximizing the optical gap by minimizing EA and maximizing IP could help identify high-performance materials. Looking at the study’s results more closely, it showed that the HER was nearly zero for polymers with positive EA values on the standard hydrogen electrode (SHE) scale and peaked at an EA of around -2 eV. This peak was at the lower end of the EAs observed, suggesting optimal driving force for the proton reduction when minimizing this property. The number of materials with high observed HERs increased with rising IP, peaking around 1 eV before declining. This indicates the importance of balancing the driving force for oxidation. We conclude that, to optimize copolymers for photocatalytic activity, one could target minimal EA values and IP values near 1 eV (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.SS5" title="2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">2.5</span></a> and the objective function in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional results</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Impact of higher-order structure on polymer properties</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F12" title="Figure 12 ‣ B.1 Impact of higher-order structure on polymer properties ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">12</span></a> shows an example monomer combination found in the dataset. Changing the stoichiometry from 3:1 to 1:3 leads to a significant drop of the EA compared to the data set range. Further, for a fixed stoichiometry, changing the chain architecture from alternating to block structure leads to a non negligible drop in the EA of the polymer material. This example illustrates that the higher order structure matters to learn accurate structure-property relationships.</p>
</div>
<figure class="ltx_figure" id="A2.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="258" id="A2.F12.g1" src="x5.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>For a fixed monomer combination (left), changing the stoichiometry and chain architecture influences the electron affinity of the polymer (right). </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Polymer property prediction performance</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">To assess how well properties are predicted for unseen data, we encode the test set to the latent representations and use the trained neural network on top of the latent space to predict the properties. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F13" title="Figure 13 ‣ B.2 Polymer property prediction performance ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">13</span></a> shows a high performance, comparable to the values reported in <cite class="ltx_cite ltx_citemacro_citep">[Aldeghi and Coley, <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>]</cite>. This is important to ensure accurate property values as feedback for the optimization algorithms in the inverse design approach.</p>
</div>
<figure class="ltx_figure" id="A2.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="441" id="A2.F13.sf1.g1" src="extracted/5873110/images/parity_EA.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((a)) </span>Property prediction accuracy of EA</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F13.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="457" id="A2.F13.sf2.g1" src="extracted/5873110/images/parity_IP.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((b)) </span>Property prediction accuracy of IP</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Evaluation of the property prediction performance for the held out testset. </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Additional latent space plots: Stoichiometry and chain architecture</h3>
<figure class="ltx_figure" id="A2.F14">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F14.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="430" id="A2.F14.sf1.g1" src="extracted/5873110/images/train_latent_stoichimetry_pca.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((a)) </span>Colored by stoichiometry</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F14.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="423" id="A2.F14.sf2.g1" src="extracted/5873110/images/train_latent_connectivity_pca.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">((b)) </span>Colored by chain architecture</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Visualization of the two first principal components of the latent space of the training data. Coloring by stoichiometry and chain architecture only shows local organization according to these structural characteristics of the polymer.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Polymer design without optimization</h3>
<div class="ltx_para ltx_noindent" id="A2.SS4.p1">
<p class="ltx_p" id="A2.SS4.p1.1">This analysis focuses on generating polymers that are similar to the best performing photocatalyst in <cite class="ltx_cite ltx_citemacro_citep">[Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>.
We make use of two common techniques. First, we can sample the latent neighborhood of good polymer candidates that showed high HERs in literature. Second, we can perform interpolation in latent space between interesting candidates. Given our well structured latent space, as demonstrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS2.SSS1" title="3.2.1 Latent space organization ‣ 3.2 Latent space ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>, these approaches should help to yield a higher fraction of high-performing candidate polymers than just randomly sampled ones. 
<br class="ltx_break"/></p>
</div>
<section class="ltx_subsubsection" id="A2.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.4.1 </span>Sampling the neighborhood of high-performing polymer</h4>
<div class="ltx_para ltx_noindent" id="A2.SS4.SSS1.p1">
<p class="ltx_p" id="A2.SS4.SSS1.p1.2">Sampling around polymers that are known to be high-performing photocatalysts can prove as a powerful approach to generate novel polymers with similarly good or better performance. To do so, we take one high-performing photocatalysts as a starting point and encode the respective graph to a continuous latent vector <math alttext="\boldsymbol{z}_{seed}" class="ltx_Math" display="inline" id="A2.SS4.SSS1.p1.1.m1.1"><semantics id="A2.SS4.SSS1.p1.1.m1.1a"><msub id="A2.SS4.SSS1.p1.1.m1.1.1" xref="A2.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="A2.SS4.SSS1.p1.1.m1.1.1.2" xref="A2.SS4.SSS1.p1.1.m1.1.1.2.cmml">𝒛</mi><mrow id="A2.SS4.SSS1.p1.1.m1.1.1.3" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.cmml"><mi id="A2.SS4.SSS1.p1.1.m1.1.1.3.2" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.2.cmml">s</mi><mo id="A2.SS4.SSS1.p1.1.m1.1.1.3.1" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A2.SS4.SSS1.p1.1.m1.1.1.3.3" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="A2.SS4.SSS1.p1.1.m1.1.1.3.1a" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A2.SS4.SSS1.p1.1.m1.1.1.3.4" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.4.cmml">e</mi><mo id="A2.SS4.SSS1.p1.1.m1.1.1.3.1b" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A2.SS4.SSS1.p1.1.m1.1.1.3.5" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.5.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A2.SS4.SSS1.p1.1.m1.1b"><apply id="A2.SS4.SSS1.p1.1.m1.1.1.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.2">𝒛</ci><apply id="A2.SS4.SSS1.p1.1.m1.1.1.3.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.3"><times id="A2.SS4.SSS1.p1.1.m1.1.1.3.1.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.1"></times><ci id="A2.SS4.SSS1.p1.1.m1.1.1.3.2.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.2">𝑠</ci><ci id="A2.SS4.SSS1.p1.1.m1.1.1.3.3.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="A2.SS4.SSS1.p1.1.m1.1.1.3.4.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.4">𝑒</ci><ci id="A2.SS4.SSS1.p1.1.m1.1.1.3.5.cmml" xref="A2.SS4.SSS1.p1.1.m1.1.1.3.5">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.SSS1.p1.1.m1.1c">\boldsymbol{z}_{seed}</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.SSS1.p1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_s italic_e italic_e italic_d end_POSTSUBSCRIPT</annotation></semantics></math>. Next, we repeatedly add small noise (drawn from <math alttext="\mathcal{N}(0,0.25)" class="ltx_Math" display="inline" id="A2.SS4.SSS1.p1.2.m2.2"><semantics id="A2.SS4.SSS1.p1.2.m2.2a"><mrow id="A2.SS4.SSS1.p1.2.m2.2.3" xref="A2.SS4.SSS1.p1.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.SS4.SSS1.p1.2.m2.2.3.2" xref="A2.SS4.SSS1.p1.2.m2.2.3.2.cmml">𝒩</mi><mo id="A2.SS4.SSS1.p1.2.m2.2.3.1" xref="A2.SS4.SSS1.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="A2.SS4.SSS1.p1.2.m2.2.3.3.2" xref="A2.SS4.SSS1.p1.2.m2.2.3.3.1.cmml"><mo id="A2.SS4.SSS1.p1.2.m2.2.3.3.2.1" stretchy="false" xref="A2.SS4.SSS1.p1.2.m2.2.3.3.1.cmml">(</mo><mn id="A2.SS4.SSS1.p1.2.m2.1.1" xref="A2.SS4.SSS1.p1.2.m2.1.1.cmml">0</mn><mo id="A2.SS4.SSS1.p1.2.m2.2.3.3.2.2" xref="A2.SS4.SSS1.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="A2.SS4.SSS1.p1.2.m2.2.2" xref="A2.SS4.SSS1.p1.2.m2.2.2.cmml">0.25</mn><mo id="A2.SS4.SSS1.p1.2.m2.2.3.3.2.3" stretchy="false" xref="A2.SS4.SSS1.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.SSS1.p1.2.m2.2b"><apply id="A2.SS4.SSS1.p1.2.m2.2.3.cmml" xref="A2.SS4.SSS1.p1.2.m2.2.3"><times id="A2.SS4.SSS1.p1.2.m2.2.3.1.cmml" xref="A2.SS4.SSS1.p1.2.m2.2.3.1"></times><ci id="A2.SS4.SSS1.p1.2.m2.2.3.2.cmml" xref="A2.SS4.SSS1.p1.2.m2.2.3.2">𝒩</ci><interval closure="open" id="A2.SS4.SSS1.p1.2.m2.2.3.3.1.cmml" xref="A2.SS4.SSS1.p1.2.m2.2.3.3.2"><cn id="A2.SS4.SSS1.p1.2.m2.1.1.cmml" type="integer" xref="A2.SS4.SSS1.p1.2.m2.1.1">0</cn><cn id="A2.SS4.SSS1.p1.2.m2.2.2.cmml" type="float" xref="A2.SS4.SSS1.p1.2.m2.2.2">0.25</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.SSS1.p1.2.m2.2c">\mathcal{N}(0,0.25)</annotation><annotation encoding="application/x-llamapun" id="A2.SS4.SSS1.p1.2.m2.2d">caligraphic_N ( 0 , 0.25 )</annotation></semantics></math>) to obtain new latent vectors. We can then decode these new latent vectors to structures.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F15" title="Figure 15 ‣ B.4.1 Sampling the neighborhood of high-performing polymer ‣ B.4 Polymer design without optimization ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">15</span></a> shows the results of sampling around the polymer with the best experimental HER in <cite class="ltx_cite ltx_citemacro_citet">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>’s study, highlighted in black dashed lines. The novel molecules we obtained by sampling around the latent vector of the encoded seed molecule possess a variety of changes from the encoded polymer, where monomer B is varied most. We see that monomer A is altered less, attributable to the limited monomer A variety in the dataset. Same holds for the stoichiometry while the chain architecture is varied more than stoichiometry, meaning that it has less strong signal in the latent space than the stoichiometry (less robust to changes in the latent vector).</p>
</div>
<figure class="ltx_figure" id="A2.F15"><svg class="ltx_picture ltx_centering" height="486.22" id="A2.F15.pic1" overflow="visible" version="1.1" width="488.22"><g transform="translate(0,486.22) matrix(1 0 0 -1 0 0) translate(244.11,0) translate(0,243.11)"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="matrix(1.0 0.0 0.0 1.0 -239.5 -238.5)"><foreignobject height="477" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="479"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="477" id="A2.F15.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5873110/images/molecules_around_seed.png" width="479"/></foreignobject></g><g color="#000000" fill="#000000" stroke="#000000" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -35.43 -39.37 L 35.43 -39.37 L 35.43 -106.3 L -35.43 -106.3 Z" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Sampling around the best experimental photocatalyst found in <cite class="ltx_cite ltx_citemacro_cite">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>. The best photocatalyst is first encoded to the latent space. By adding small bits of random noise to the latent representation, we obtain new latent vectors that can be decoded to novel similar polymer photocatalysts. </figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A2.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.4.2 </span>Interpolation between interesting candidates</h4>
<div class="ltx_para ltx_noindent" id="A2.SS4.SSS2.p1">
<p class="ltx_p" id="A2.SS4.SSS2.p1.1">The second strategy to sample novel polymers without property optimization is interpolation in the latent space. With the aim to find promising novel photocatalysts we can for instance interpolate between the two best polymers found in <cite class="ltx_cite ltx_citemacro_citep">[Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>. For this we assume that both polymers possess a 1:1 monomer stoichiometry and alternating chain architecture. However, the two best candidates are structurally very similar: Monomer A is the same and monomer B is only slightly different. As a result, the interpolation only leads to one additional candidate that is found on the interpolation path (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F16" title="Figure 16 ‣ B.4.2 Interpolation between interesting candidates ‣ B.4 Polymer design without optimization ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">16</span></a>). While we expect the polymers to be close in the latent space, we could think of more candidates that lie on the interpolation path. Generally, interpolation is more interesting in scenarios where we want to know the path in the chemical space between two structurally substantially different molecules. For instance, we can interpolate between the best molecule and a random molecule in the dataset, leading to a more interesting path as visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F17" title="Figure 17 ‣ B.4.2 Interpolation between interesting candidates ‣ B.4 Polymer design without optimization ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">17</span></a>.</p>
</div>
<figure class="ltx_figure" id="A2.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="116" id="A2.F16.g1" src="extracted/5873110/images/interpolation_between_two_best.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Interpolation in the latent space between the two best copolymer photocatalysts found in <cite class="ltx_cite ltx_citemacro_cite">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>. Starting from the best candidate polymer on the left, we observe only one polymer on the interpolation path to the second best candidate.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F17"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="269" id="A2.F17.g1" src="extracted/5873110/images/interpolation_between_best_and_random.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Interpolation in the latent space between the best copolymer photocatalysts found in <cite class="ltx_cite ltx_citemacro_cite">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite> and one random polymer. We observe a step-wise change from on the monomer but level but also on the higher order structural levels, i.e. the monomer stoichiometry and chain architecture.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.5 </span>Additional inverse design experiments with varied property targets</h3>
<div class="ltx_para ltx_noindent" id="A2.SS5.p1">
<p class="ltx_p" id="A2.SS5.p1.1">In this section we show two additional experiments, where we varied the objective function for the optimization with the GA.</p>
</div>
<section class="ltx_subsubsection" id="A2.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.5.1 </span>Target electronic properties of a known high-performing photocatalyst</h4>
<div class="ltx_para" id="A2.SS5.SSS1.p1">
<p class="ltx_p" id="A2.SS5.SSS1.p1.1">Let us consider the best-performing molecule in <cite class="ltx_cite ltx_citemacro_citet">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>’s study which has an EA of approximately -2.64 eV and an IP of 1.61 eV (as reported in the used training dataset <cite class="ltx_cite ltx_citemacro_cite">Aldeghi and Coley [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib37" title="">2022</a>]</cite>. These values differ markedly from the targets in the objective function in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4" title="3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.4</span></a>, which aimed for minimal EAs (converging to around -4 eV) and an IP of 1 eV.
Hence, we observe that the results in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.F18" title="Figure 18 ‣ B.5.1 Target electronic properties of a known high-performing photocatalyst ‣ B.5 Additional inverse design experiments with varied property targets ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">18</span></a> differ significantly from those in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.F9" title="Figure 9 ‣ 3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">9</span></a>. Interestingly, the sixth-best candidate (indicated by black dashed lines) is identical to the molecule from the experimental study we used to specify the property targets. It should be the best candidate, matching the objective values exactly. However, despite the very high accuracy of the property predictor (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#A2.SS2" title="B.2 Polymer property prediction performance ‣ Appendix B Additional results ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">B.2</span></a>), there is a small prediction error. We also see a variety of structures that satisfy the objective function well but differ structurally from the best polymer reported in the literature.</p>
</div>
<figure class="ltx_figure" id="A2.F18"><svg class="ltx_picture ltx_centering" height="244.22" id="A2.F18.pic1" overflow="visible" version="1.1" width="498.6"><g transform="translate(0,244.22) matrix(1 0 0 -1 0 0) translate(254.49,0) translate(0,122.11)"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="matrix(1.0 0.0 0.0 1.0 -239.5 -117.5)"><foreignobject height="235" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="479"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="235" id="A2.F18.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5873110/images/optimal_mols_GA_correct_mimick_best.png" width="479"/></foreignobject></g><g color="#000000" fill="#000000" stroke="#000000" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -253.94 -5.91 L -173.23 -5.91 L -173.23 -82.68 L -253.94 -82.68 Z" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Results when minimizing the objective function using a genetic algorithm. This is the modified objective function with EA and IP targeting the values of the best experimental polymer. In black dashed line we highlighted the polymer that we used to define the objectives. It is found as a solution by the GA but not as the best candidate which is contradictive. This results from small errors made by the property predictor.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A2.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">B.5.2 </span>Change of target values according to dataset statistics</h4>
<div class="ltx_para ltx_noindent" id="A2.SS5.SSS2.p1">
<p class="ltx_p" id="A2.SS5.SSS2.p1.1">Second, we adjust the target for IP and EA to the value that exhibits the largest number of well-performing (threshold defined in <cite class="ltx_cite ltx_citemacro_cite">Bai et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>) photocatalysts from their experimental validation. As a result, we specify an EA of -2 eV and IP of 1.2 eV as optimal.
Also for this modified objective function we observe a different region of the polymer space to be optimal compared to the results in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4" title="3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.SS5.SSS2.p2">
<p class="ltx_p" id="A2.SS5.SSS2.p2.1">An interesting detail for both of these experiments is, that the genetic algorithm (GA) converges faster for these two objective functions compared to the objective function in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S2.E4" title="In 2.5 Property optimization and inverse design ‣ 2 Methods ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">4</span></a>) and experiment in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#S3.SS4" title="3.4 Inverse design of novel polymer photocatalysts for hydrogen production ‣ 3 Results and Discussion ‣ Inverse Design of Copolymers Including Stoichiometry and Chain Architecture"><span class="ltx_text ltx_ref_tag">3.4</span></a>. This suggests that specifying property values as target is a simpler task than the open-ended minimization of EA. This could also be due to EAs &lt;-4 being slightly outside of the distribution of the dataset.</p>
</div>
<figure class="ltx_figure" id="A2.F19"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="235" id="A2.F19.g1" src="extracted/5873110/images/optimal_mols_GA_correct_mimick_peak.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 19: </span>Results when minimizing the objective function using a genetic algorithm. This is the modified objective function targeting an EA of -2 eV and an IP of 1.2 eV. The objective matches the property values where most well-performing materials were found according to <cite class="ltx_cite ltx_citemacro_citep">[Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.6 </span>Additional smoothness plot around known high-performing photocatalyst</h3>
<figure class="ltx_figure" id="A2.F20"><svg class="ltx_picture ltx_centering" height="604.22" id="A2.F20.pic1" overflow="visible" version="1.1" width="607.22"><g transform="translate(0,604.22) matrix(1 0 0 -1 0 0) translate(303.61,0) translate(0,302.11)"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="matrix(1.0 0.0 0.0 1.0 -299 -297.5)"><foreignobject height="595" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="598"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="595" id="A2.F20.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.g1" src="extracted/5873110/images/molecular_grid_scaling1.0.png" width="598"/></foreignobject></g><g color="#000000" fill="#000000" stroke="#000000" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -31.5 31.5 L 31.5 31.5 L 31.5 -31.5 L -31.5 -31.5 Z" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 20: </span>Visualization of the molecular neighborhood (as proposed by <cite class="ltx_cite ltx_citemacro_citet">Kusner et al. [<a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib57" title="">2017</a>]</cite>) of the best performing polymer found in <cite class="ltx_cite ltx_citemacro_citep">[Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.02824v1#bib.bib49" title="">2019</a>]</cite>. Moving around the encoded molecule in black dashed lines in the center, we can observe step-wise changes in monomer A (bottom one), monomer B (top one), stoichioemtry and chain architecture.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section><div about="" class="ltx_rdf" content="Gabriel Vogel" property="dcterms:creator"></div>
<div about="" class="ltx_rdf" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" content="q-bio.NC, q-bio.QM" property="dcterms:subject"></div>
<div about="" class="ltx_rdf" content="Inverse polymer design" property="dcterms:title"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 30 15:34:06 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
