<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.14088] \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings</title><meta property="og:description" content="Clustering clients into groups that exhibit relatively homogeneous data distributions represents one of the major means of improving the performance of federated learning (FL) in non-independent and identically distrib…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="\acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="\acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.14088">

<!--Generated on Wed Feb 28 04:33:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id1.id1" class="ltx_ERROR undefined">\acronym</span>: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Boris Radovič<sup id="id2.1.id1" class="ltx_sup">1</sup>,
Veljko Pejović<sup id="id3.2.id2" class="ltx_sup">1,2</sup>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id4.id1" class="ltx_p">Clustering clients into groups that exhibit relatively homogeneous data distributions represents one of the major means of improving the performance of federated learning (FL) in non-independent and identically distributed (non-IID) data settings. Yet, the applicability of current state-of-the-art approaches remains limited as these approaches cluster clients based on information, such as the evolution of local model parameters, that is only obtainable through actual on-client training. On the other hand, there is a need to make FL models available to clients who are not able to perform the training themselves, as they do not have the processing capabilities required for training, or simply want to use the model without participating in the training. Furthermore, the existing alternative approaches that avert the training still require that individual clients have a sufficient amount of labeled data upon which the clustering is based, essentially assuming that each client is a data annotator. In this paper, we present <span id="id4.id1.1" class="ltx_ERROR undefined">\acronym</span>, an approach to client clustering in non-IID FL settings that requires neither training nor labeled data collection. <span id="id4.id1.2" class="ltx_ERROR undefined">\acronym</span>uses a novel supervised autoencoder-based method to create embeddings that profile a client’s underlying data-generating processes without exposing the data to the server and without requiring local training. Our experimental analysis over three different datasets demonstrates that <span id="id4.id1.3" class="ltx_ERROR undefined">\acronym</span>delivers state-of-the-art model performance while expanding the applicability of cluster-based FL to previously uncovered use cases.</p>
</div>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite> is a distributed machine learning paradigm in which a model is trained locally over a set of clients, with only the model updates being observed and aggregated by a server. FL ensures that the clients’ data remain on the devices and offloads the training burden from the server, thus representing an important step towards decentralized AI.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">Avoiding aggregating the data on the server to ensure privacy, on the other hand, hinders the model convergence in cases of diverging data distributions across clients that participate in FL. The problem of non-independent and identically distributed (non-IID) data is known to hamper the training convergence and the accuracy of the final model <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al. <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>. Consequently, approaches have been proposed to go beyond FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite> – a commonly used simple aggregation of local model updates. Among these approaches, of particular interest are those that rely on grouping clients into clusters exhibiting relatively homogeneous data distributions, such as <cite class="ltx_cite ltx_citemacro_citep">(Long et al. <a href="#bib.bib14" title="" class="ltx_ref">2023</a>; Briggs, Fan, and Andras <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>. After clustering the clients the server can evolve different (flavors of) models for different clusters of clients. Such ensembles of models can improve convergence and inference accuracy in non-IID settings, while still ensuring that the clients’ data remains fully private.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">Unfortunately, real-world applicability of clustering-based solutions to FL in non-IID settings remains limited, since most clustering methods rely on information stemming from local training. This information, such as the direction in which the model parameters are evolving during local training, is only obtainable by clients who have sufficient computational and energy resources to conduct on-device training. In real-world applications, however, FL-trained models will often be used by clients who may never get a chance to participate in the training themselves. For instance, Android’s predictive on-screen keyboard – Gboard – is trained in a federated manner, yet in each round, only a few hundred high-end smartphones connected to a charger participate in the training <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al. <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>. Consequently, comprehensive clustering that would allow personalized model deployment across billions of Android users remains infeasible, if training is mandated for each client. While alternative approaches that alleviate the need for training have appeared <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al. <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Ruan and Joe-Wong <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>, they still require that each client collects and labels a substantial amount of data upon which the clustering is performed. Such a requirement implies that each client has to serve as a data annotator, even if only interested in using, not necessarily training, the model.</p>
</div>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">In this paper, we present <span id="Sx1.p4.1.1" class="ltx_ERROR undefined">\acronym</span>, a novel method for client clustering in non-IID data settings. Unlike the existing solutions, <span id="Sx1.p4.1.2" class="ltx_ERROR undefined">\acronym</span>brings benefits of personalized FL modeling to a wide range of clients, including those who have no labeled data and those who cannot train, either temporarily, e.g. due to insufficient battery power, or at all, e.g. due to poor hardware capabilities. To enable this, <span id="Sx1.p4.1.3" class="ltx_ERROR undefined">\acronym</span>develops an encoder to embed the client’s unlabeled data into a latent space. The clustering is then performed on profiles of the embedded data. We show that statistics calculated over the generated data embeddings reflect the actual data distribution sufficiently well to allow robust clustering. Moreover, experimenting with different datasets we demonstrate that <span id="Sx1.p4.1.4" class="ltx_ERROR undefined">\acronym</span>matches the state-of-the-art inference in FL while making customized models available to a wide range of training-free clients. Specifically, the contributions of this paper include:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">We devise a supervised autoencoder-based embedder through which we profile the data without the need for training and without the need for labeled data;</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">We propose a lightweight FL client clustering scheme that harnesses statistical profiles of the embedding distributions. Neither the data nor the actual data distributions need to be sent to the server;</p>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">We compare the performance of <span id="Sx1.I1.i3.p1.1.1" class="ltx_ERROR undefined">\acronym</span>against the state-of-the-art scheme for client clustering that relies on on-client training, and demonstrate that our approach delivers comparable performance while significantly expanding the usability of FL-trained models.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p">The stochastic gradient used for FL training is an unbiased estimate of the full gradient only if gradients produced by individual clients are all calculated over data samples originating from the equivalent data-generating processes (DGPs) <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>. In practice, however, DGPs may vary across clients, for instance, due to the DGPs’ tight relationship to individual human behavior, including one’s movement patterns, keyboard typing habits, voice properties, and other factors. In case of significant non-IIDness, straightforward aggregation of local gradients at the server may lead to drastically underperforming FL models, with studies demonstrating a 55% reduction in model accuracy on the keyword spotting and 51% accuracy loss on CIFAR-10 image recognition tasks <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib19" title="" class="ltx_ref">2018</a>)</cite>.</p>
</div>
<div id="Sx2.p2" class="ltx_para">
<p id="Sx2.p2.1" class="ltx_p">Individual clients “pulling” the global model in different directions prevent model convergence in FL. To counter this, Li et al. propose penalizing the deviation of local models from the global model through L2 regularization of model weights <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>. Alternatively, contrastive learning can be harnessed to pull the embeddings of data instances belonging to the same classes close to each other in the embedding space, and the embeddings of data instances belonging to different classes away from each other <cite class="ltx_cite ltx_citemacro_citep">(Mu et al. <a href="#bib.bib16" title="" class="ltx_ref">2023</a>)</cite>. This is done across all clients, who are orchestrated to align these embeddings with class prototypes calculated at the global level.</p>
</div>
<div id="Sx2.p3" class="ltx_para">
<p id="Sx2.p3.3" class="ltx_p">However, even if the above solutions manage to improve the convergence, a single global model may not perform well across the range of clients that train and/or use it. In such cases, clustering clients into groups exhibiting similar DGPs might be more appropriate, as it would allow for multiple model flavors to be trained – one for each cluster of clients. Nevertheless, such clustering is challenging in FL settings, as it has to satisfy what appear to be conflicting requirements: reflect individual clients’ data distributions and maintain the clients’ data privacy. Consequently, clustering solutions have appeared that rely on data that is an inherent part of federated training. The approach presented in <cite class="ltx_cite ltx_citemacro_citep">(Briggs, Fan, and Andras <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>, for example, first trains the joint model <math id="Sx2.p3.1.m1.1" class="ltx_Math" alttext="\theta^{T}" display="inline"><semantics id="Sx2.p3.1.m1.1a"><msup id="Sx2.p3.1.m1.1.1" xref="Sx2.p3.1.m1.1.1.cmml"><mi id="Sx2.p3.1.m1.1.1.2" xref="Sx2.p3.1.m1.1.1.2.cmml">θ</mi><mi id="Sx2.p3.1.m1.1.1.3" xref="Sx2.p3.1.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="Sx2.p3.1.m1.1b"><apply id="Sx2.p3.1.m1.1.1.cmml" xref="Sx2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.p3.1.m1.1.1.1.cmml" xref="Sx2.p3.1.m1.1.1">superscript</csymbol><ci id="Sx2.p3.1.m1.1.1.2.cmml" xref="Sx2.p3.1.m1.1.1.2">𝜃</ci><ci id="Sx2.p3.1.m1.1.1.3.cmml" xref="Sx2.p3.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p3.1.m1.1c">\theta^{T}</annotation></semantics></math> on all the available clients up to round <math id="Sx2.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="Sx2.p3.2.m2.1a"><mi id="Sx2.p3.2.m2.1.1" xref="Sx2.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx2.p3.2.m2.1b"><ci id="Sx2.p3.2.m2.1.1.cmml" xref="Sx2.p3.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p3.2.m2.1c">T</annotation></semantics></math> and then computes the difference between the joint model and each locally evolved model <math id="Sx2.p3.3.m3.1" class="ltx_Math" alttext="\Delta\theta_{i}=\theta^{T}-\theta_{i}^{T+1}" display="inline"><semantics id="Sx2.p3.3.m3.1a"><mrow id="Sx2.p3.3.m3.1.1" xref="Sx2.p3.3.m3.1.1.cmml"><mrow id="Sx2.p3.3.m3.1.1.2" xref="Sx2.p3.3.m3.1.1.2.cmml"><mi mathvariant="normal" id="Sx2.p3.3.m3.1.1.2.2" xref="Sx2.p3.3.m3.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="Sx2.p3.3.m3.1.1.2.1" xref="Sx2.p3.3.m3.1.1.2.1.cmml">​</mo><msub id="Sx2.p3.3.m3.1.1.2.3" xref="Sx2.p3.3.m3.1.1.2.3.cmml"><mi id="Sx2.p3.3.m3.1.1.2.3.2" xref="Sx2.p3.3.m3.1.1.2.3.2.cmml">θ</mi><mi id="Sx2.p3.3.m3.1.1.2.3.3" xref="Sx2.p3.3.m3.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="Sx2.p3.3.m3.1.1.1" xref="Sx2.p3.3.m3.1.1.1.cmml">=</mo><mrow id="Sx2.p3.3.m3.1.1.3" xref="Sx2.p3.3.m3.1.1.3.cmml"><msup id="Sx2.p3.3.m3.1.1.3.2" xref="Sx2.p3.3.m3.1.1.3.2.cmml"><mi id="Sx2.p3.3.m3.1.1.3.2.2" xref="Sx2.p3.3.m3.1.1.3.2.2.cmml">θ</mi><mi id="Sx2.p3.3.m3.1.1.3.2.3" xref="Sx2.p3.3.m3.1.1.3.2.3.cmml">T</mi></msup><mo id="Sx2.p3.3.m3.1.1.3.1" xref="Sx2.p3.3.m3.1.1.3.1.cmml">−</mo><msubsup id="Sx2.p3.3.m3.1.1.3.3" xref="Sx2.p3.3.m3.1.1.3.3.cmml"><mi id="Sx2.p3.3.m3.1.1.3.3.2.2" xref="Sx2.p3.3.m3.1.1.3.3.2.2.cmml">θ</mi><mi id="Sx2.p3.3.m3.1.1.3.3.2.3" xref="Sx2.p3.3.m3.1.1.3.3.2.3.cmml">i</mi><mrow id="Sx2.p3.3.m3.1.1.3.3.3" xref="Sx2.p3.3.m3.1.1.3.3.3.cmml"><mi id="Sx2.p3.3.m3.1.1.3.3.3.2" xref="Sx2.p3.3.m3.1.1.3.3.3.2.cmml">T</mi><mo id="Sx2.p3.3.m3.1.1.3.3.3.1" xref="Sx2.p3.3.m3.1.1.3.3.3.1.cmml">+</mo><mn id="Sx2.p3.3.m3.1.1.3.3.3.3" xref="Sx2.p3.3.m3.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.p3.3.m3.1b"><apply id="Sx2.p3.3.m3.1.1.cmml" xref="Sx2.p3.3.m3.1.1"><eq id="Sx2.p3.3.m3.1.1.1.cmml" xref="Sx2.p3.3.m3.1.1.1"></eq><apply id="Sx2.p3.3.m3.1.1.2.cmml" xref="Sx2.p3.3.m3.1.1.2"><times id="Sx2.p3.3.m3.1.1.2.1.cmml" xref="Sx2.p3.3.m3.1.1.2.1"></times><ci id="Sx2.p3.3.m3.1.1.2.2.cmml" xref="Sx2.p3.3.m3.1.1.2.2">Δ</ci><apply id="Sx2.p3.3.m3.1.1.2.3.cmml" xref="Sx2.p3.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="Sx2.p3.3.m3.1.1.2.3.1.cmml" xref="Sx2.p3.3.m3.1.1.2.3">subscript</csymbol><ci id="Sx2.p3.3.m3.1.1.2.3.2.cmml" xref="Sx2.p3.3.m3.1.1.2.3.2">𝜃</ci><ci id="Sx2.p3.3.m3.1.1.2.3.3.cmml" xref="Sx2.p3.3.m3.1.1.2.3.3">𝑖</ci></apply></apply><apply id="Sx2.p3.3.m3.1.1.3.cmml" xref="Sx2.p3.3.m3.1.1.3"><minus id="Sx2.p3.3.m3.1.1.3.1.cmml" xref="Sx2.p3.3.m3.1.1.3.1"></minus><apply id="Sx2.p3.3.m3.1.1.3.2.cmml" xref="Sx2.p3.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.p3.3.m3.1.1.3.2.1.cmml" xref="Sx2.p3.3.m3.1.1.3.2">superscript</csymbol><ci id="Sx2.p3.3.m3.1.1.3.2.2.cmml" xref="Sx2.p3.3.m3.1.1.3.2.2">𝜃</ci><ci id="Sx2.p3.3.m3.1.1.3.2.3.cmml" xref="Sx2.p3.3.m3.1.1.3.2.3">𝑇</ci></apply><apply id="Sx2.p3.3.m3.1.1.3.3.cmml" xref="Sx2.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="Sx2.p3.3.m3.1.1.3.3.1.cmml" xref="Sx2.p3.3.m3.1.1.3.3">superscript</csymbol><apply id="Sx2.p3.3.m3.1.1.3.3.2.cmml" xref="Sx2.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="Sx2.p3.3.m3.1.1.3.3.2.1.cmml" xref="Sx2.p3.3.m3.1.1.3.3">subscript</csymbol><ci id="Sx2.p3.3.m3.1.1.3.3.2.2.cmml" xref="Sx2.p3.3.m3.1.1.3.3.2.2">𝜃</ci><ci id="Sx2.p3.3.m3.1.1.3.3.2.3.cmml" xref="Sx2.p3.3.m3.1.1.3.3.2.3">𝑖</ci></apply><apply id="Sx2.p3.3.m3.1.1.3.3.3.cmml" xref="Sx2.p3.3.m3.1.1.3.3.3"><plus id="Sx2.p3.3.m3.1.1.3.3.3.1.cmml" xref="Sx2.p3.3.m3.1.1.3.3.3.1"></plus><ci id="Sx2.p3.3.m3.1.1.3.3.3.2.cmml" xref="Sx2.p3.3.m3.1.1.3.3.3.2">𝑇</ci><cn type="integer" id="Sx2.p3.3.m3.1.1.3.3.3.3.cmml" xref="Sx2.p3.3.m3.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.p3.3.m3.1c">\Delta\theta_{i}=\theta^{T}-\theta_{i}^{T+1}</annotation></semantics></math> for every client. This vector is then used for hierarchically clustering the clients. Similarly, FeSEM <cite class="ltx_cite ltx_citemacro_citep">(Long et al. <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> randomly initializes multiple models and iteratively assigns clients to a cluster whose model parameters are nearest to the client’s locally-tuned model according to a certain distance measure. Other algorithms leverage information directly related to the gradient updates to cluster the clients as well <cite class="ltx_cite ltx_citemacro_citep">(Duan et al. <a href="#bib.bib5" title="" class="ltx_ref">2021</a>; Sattler, Müller, and Samek <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="Sx2.p4" class="ltx_para">
<p id="Sx2.p4.1" class="ltx_p">The above approaches rely on information accessible only to clients capable of training a model. Consequently, a potentially large number of clients unable to perform this action cannot be assigned to a cluster and, as a result, do not obtain the corresponding model flavor. Iterative Federated Clustering Algorithm <cite class="ltx_cite ltx_citemacro_citep">(Ghosh et al. <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> avoids this training requirement by letting the clients determine which cluster they belong to themselves. To do so, each client calculates the value of a certain loss function over its local dataset for all the model flavors and selects the model flavor that results in the lowest loss. For calculating the loss, however, this approach requires that each client collects a labeled dataset. Obtaining data labels is known to be expensive in many mobile sensing applications and avoiding this restriction would greatly improve the solution generalizability.</p>
</div>
<div id="Sx2.p5" class="ltx_para">
<p id="Sx2.p5.1" class="ltx_p">To the best of our knowledge, the only clustering solution that requires neither labeled data nor on-device training is <cite class="ltx_cite ltx_citemacro_citep">(Huang et al. <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>. The approach, however, clusters individual data points, not individual clients. Embeddings of data points obtained through an autoencoder are clustered, and a separate model is trained for every cluster. Running multiple instances of FedAvg training in parallel across clients is feasible as the algorithm targets cross-silo FL settings, where the training is performed by a small number of relatively reliable clients with large datasets, for instance, hospitals. Nevertheless, the approach is unlikely to be suitable for resource-constrained devices, such as smartphones, and dynamic ubiquitous computing settings.</p>
</div>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Preliminaries and General Framework for Clustered FL</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">The related work analysis from the previous section reveals no unified framework for considering clustering FL clients in non-IID settings. Such a framework is necessary should we wish to ensure that competing clustering solutions are evaluated on the same terms. Thus, in this section, we introduce a general framework for clustered FL.</p>
</div>
<div id="Sx3.p2" class="ltx_para">
<p id="Sx3.p2.1" class="ltx_p">We assume that the set of clients <math id="Sx3.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="Sx3.p2.1.m1.1a"><mi id="Sx3.p2.1.m1.1.1" xref="Sx3.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="Sx3.p2.1.m1.1b"><ci id="Sx3.p2.1.m1.1.1.cmml" xref="Sx3.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p2.1.m1.1c">C</annotation></semantics></math> can be partitioned as follows:</p>
<ul id="Sx3.I2" class="ltx_itemize">
<li id="Sx3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx3.I2.i1.p1" class="ltx_para">
<p id="Sx3.I2.i1.p1.1" class="ltx_p"><math id="Sx3.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="C_{t}\subseteq C" display="inline"><semantics id="Sx3.I2.i1.p1.1.m1.1a"><mrow id="Sx3.I2.i1.p1.1.m1.1.1" xref="Sx3.I2.i1.p1.1.m1.1.1.cmml"><msub id="Sx3.I2.i1.p1.1.m1.1.1.2" xref="Sx3.I2.i1.p1.1.m1.1.1.2.cmml"><mi id="Sx3.I2.i1.p1.1.m1.1.1.2.2" xref="Sx3.I2.i1.p1.1.m1.1.1.2.2.cmml">C</mi><mi id="Sx3.I2.i1.p1.1.m1.1.1.2.3" xref="Sx3.I2.i1.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="Sx3.I2.i1.p1.1.m1.1.1.1" xref="Sx3.I2.i1.p1.1.m1.1.1.1.cmml">⊆</mo><mi id="Sx3.I2.i1.p1.1.m1.1.1.3" xref="Sx3.I2.i1.p1.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I2.i1.p1.1.m1.1b"><apply id="Sx3.I2.i1.p1.1.m1.1.1.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1"><subset id="Sx3.I2.i1.p1.1.m1.1.1.1.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1.1"></subset><apply id="Sx3.I2.i1.p1.1.m1.1.1.2.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.I2.i1.p1.1.m1.1.1.2.1.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx3.I2.i1.p1.1.m1.1.1.2.2.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1.2.2">𝐶</ci><ci id="Sx3.I2.i1.p1.1.m1.1.1.2.3.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1.2.3">𝑡</ci></apply><ci id="Sx3.I2.i1.p1.1.m1.1.1.3.cmml" xref="Sx3.I2.i1.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I2.i1.p1.1.m1.1c">C_{t}\subseteq C</annotation></semantics></math> <span id="Sx3.I2.i1.p1.1.1" class="ltx_text ltx_font_italic">training clients</span>, which are able to train a model on their local datasets;</p>
</div>
</li>
<li id="Sx3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx3.I2.i2.p1" class="ltx_para">
<p id="Sx3.I2.i2.p1.1" class="ltx_p"><math id="Sx3.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="C_{h}\subset C" display="inline"><semantics id="Sx3.I2.i2.p1.1.m1.1a"><mrow id="Sx3.I2.i2.p1.1.m1.1.1" xref="Sx3.I2.i2.p1.1.m1.1.1.cmml"><msub id="Sx3.I2.i2.p1.1.m1.1.1.2" xref="Sx3.I2.i2.p1.1.m1.1.1.2.cmml"><mi id="Sx3.I2.i2.p1.1.m1.1.1.2.2" xref="Sx3.I2.i2.p1.1.m1.1.1.2.2.cmml">C</mi><mi id="Sx3.I2.i2.p1.1.m1.1.1.2.3" xref="Sx3.I2.i2.p1.1.m1.1.1.2.3.cmml">h</mi></msub><mo id="Sx3.I2.i2.p1.1.m1.1.1.1" xref="Sx3.I2.i2.p1.1.m1.1.1.1.cmml">⊂</mo><mi id="Sx3.I2.i2.p1.1.m1.1.1.3" xref="Sx3.I2.i2.p1.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I2.i2.p1.1.m1.1b"><apply id="Sx3.I2.i2.p1.1.m1.1.1.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1"><subset id="Sx3.I2.i2.p1.1.m1.1.1.1.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1.1"></subset><apply id="Sx3.I2.i2.p1.1.m1.1.1.2.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.I2.i2.p1.1.m1.1.1.2.1.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx3.I2.i2.p1.1.m1.1.1.2.2.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1.2.2">𝐶</ci><ci id="Sx3.I2.i2.p1.1.m1.1.1.2.3.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1.2.3">ℎ</ci></apply><ci id="Sx3.I2.i2.p1.1.m1.1.1.3.cmml" xref="Sx3.I2.i2.p1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I2.i2.p1.1.m1.1c">C_{h}\subset C</annotation></semantics></math> <span id="Sx3.I2.i2.p1.1.1" class="ltx_text ltx_font_italic">holdout clients</span>, which wish to use an FL-trained model, yet, do not participate in model training, either because of the lack of local labeled datasets, insufficient computing capabilities, or other reasons;</p>
</div>
</li>
</ul>
<p id="Sx3.p2.3" class="ltx_p">and that <math id="Sx3.p2.2.m1.1" class="ltx_Math" alttext="C_{t}\cup C_{h}=C" display="inline"><semantics id="Sx3.p2.2.m1.1a"><mrow id="Sx3.p2.2.m1.1.1" xref="Sx3.p2.2.m1.1.1.cmml"><mrow id="Sx3.p2.2.m1.1.1.2" xref="Sx3.p2.2.m1.1.1.2.cmml"><msub id="Sx3.p2.2.m1.1.1.2.2" xref="Sx3.p2.2.m1.1.1.2.2.cmml"><mi id="Sx3.p2.2.m1.1.1.2.2.2" xref="Sx3.p2.2.m1.1.1.2.2.2.cmml">C</mi><mi id="Sx3.p2.2.m1.1.1.2.2.3" xref="Sx3.p2.2.m1.1.1.2.2.3.cmml">t</mi></msub><mo id="Sx3.p2.2.m1.1.1.2.1" xref="Sx3.p2.2.m1.1.1.2.1.cmml">∪</mo><msub id="Sx3.p2.2.m1.1.1.2.3" xref="Sx3.p2.2.m1.1.1.2.3.cmml"><mi id="Sx3.p2.2.m1.1.1.2.3.2" xref="Sx3.p2.2.m1.1.1.2.3.2.cmml">C</mi><mi id="Sx3.p2.2.m1.1.1.2.3.3" xref="Sx3.p2.2.m1.1.1.2.3.3.cmml">h</mi></msub></mrow><mo id="Sx3.p2.2.m1.1.1.1" xref="Sx3.p2.2.m1.1.1.1.cmml">=</mo><mi id="Sx3.p2.2.m1.1.1.3" xref="Sx3.p2.2.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p2.2.m1.1b"><apply id="Sx3.p2.2.m1.1.1.cmml" xref="Sx3.p2.2.m1.1.1"><eq id="Sx3.p2.2.m1.1.1.1.cmml" xref="Sx3.p2.2.m1.1.1.1"></eq><apply id="Sx3.p2.2.m1.1.1.2.cmml" xref="Sx3.p2.2.m1.1.1.2"><union id="Sx3.p2.2.m1.1.1.2.1.cmml" xref="Sx3.p2.2.m1.1.1.2.1"></union><apply id="Sx3.p2.2.m1.1.1.2.2.cmml" xref="Sx3.p2.2.m1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.p2.2.m1.1.1.2.2.1.cmml" xref="Sx3.p2.2.m1.1.1.2.2">subscript</csymbol><ci id="Sx3.p2.2.m1.1.1.2.2.2.cmml" xref="Sx3.p2.2.m1.1.1.2.2.2">𝐶</ci><ci id="Sx3.p2.2.m1.1.1.2.2.3.cmml" xref="Sx3.p2.2.m1.1.1.2.2.3">𝑡</ci></apply><apply id="Sx3.p2.2.m1.1.1.2.3.cmml" xref="Sx3.p2.2.m1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.p2.2.m1.1.1.2.3.1.cmml" xref="Sx3.p2.2.m1.1.1.2.3">subscript</csymbol><ci id="Sx3.p2.2.m1.1.1.2.3.2.cmml" xref="Sx3.p2.2.m1.1.1.2.3.2">𝐶</ci><ci id="Sx3.p2.2.m1.1.1.2.3.3.cmml" xref="Sx3.p2.2.m1.1.1.2.3.3">ℎ</ci></apply></apply><ci id="Sx3.p2.2.m1.1.1.3.cmml" xref="Sx3.p2.2.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p2.2.m1.1c">C_{t}\cup C_{h}=C</annotation></semantics></math> and <math id="Sx3.p2.3.m2.1" class="ltx_Math" alttext="C_{t}\cap C_{h}=\emptyset" display="inline"><semantics id="Sx3.p2.3.m2.1a"><mrow id="Sx3.p2.3.m2.1.1" xref="Sx3.p2.3.m2.1.1.cmml"><mrow id="Sx3.p2.3.m2.1.1.2" xref="Sx3.p2.3.m2.1.1.2.cmml"><msub id="Sx3.p2.3.m2.1.1.2.2" xref="Sx3.p2.3.m2.1.1.2.2.cmml"><mi id="Sx3.p2.3.m2.1.1.2.2.2" xref="Sx3.p2.3.m2.1.1.2.2.2.cmml">C</mi><mi id="Sx3.p2.3.m2.1.1.2.2.3" xref="Sx3.p2.3.m2.1.1.2.2.3.cmml">t</mi></msub><mo id="Sx3.p2.3.m2.1.1.2.1" xref="Sx3.p2.3.m2.1.1.2.1.cmml">∩</mo><msub id="Sx3.p2.3.m2.1.1.2.3" xref="Sx3.p2.3.m2.1.1.2.3.cmml"><mi id="Sx3.p2.3.m2.1.1.2.3.2" xref="Sx3.p2.3.m2.1.1.2.3.2.cmml">C</mi><mi id="Sx3.p2.3.m2.1.1.2.3.3" xref="Sx3.p2.3.m2.1.1.2.3.3.cmml">h</mi></msub></mrow><mo id="Sx3.p2.3.m2.1.1.1" xref="Sx3.p2.3.m2.1.1.1.cmml">=</mo><mi mathvariant="normal" id="Sx3.p2.3.m2.1.1.3" xref="Sx3.p2.3.m2.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p2.3.m2.1b"><apply id="Sx3.p2.3.m2.1.1.cmml" xref="Sx3.p2.3.m2.1.1"><eq id="Sx3.p2.3.m2.1.1.1.cmml" xref="Sx3.p2.3.m2.1.1.1"></eq><apply id="Sx3.p2.3.m2.1.1.2.cmml" xref="Sx3.p2.3.m2.1.1.2"><intersect id="Sx3.p2.3.m2.1.1.2.1.cmml" xref="Sx3.p2.3.m2.1.1.2.1"></intersect><apply id="Sx3.p2.3.m2.1.1.2.2.cmml" xref="Sx3.p2.3.m2.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.p2.3.m2.1.1.2.2.1.cmml" xref="Sx3.p2.3.m2.1.1.2.2">subscript</csymbol><ci id="Sx3.p2.3.m2.1.1.2.2.2.cmml" xref="Sx3.p2.3.m2.1.1.2.2.2">𝐶</ci><ci id="Sx3.p2.3.m2.1.1.2.2.3.cmml" xref="Sx3.p2.3.m2.1.1.2.2.3">𝑡</ci></apply><apply id="Sx3.p2.3.m2.1.1.2.3.cmml" xref="Sx3.p2.3.m2.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.p2.3.m2.1.1.2.3.1.cmml" xref="Sx3.p2.3.m2.1.1.2.3">subscript</csymbol><ci id="Sx3.p2.3.m2.1.1.2.3.2.cmml" xref="Sx3.p2.3.m2.1.1.2.3.2">𝐶</ci><ci id="Sx3.p2.3.m2.1.1.2.3.3.cmml" xref="Sx3.p2.3.m2.1.1.2.3.3">ℎ</ci></apply></apply><emptyset id="Sx3.p2.3.m2.1.1.3.cmml" xref="Sx3.p2.3.m2.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p2.3.m2.1c">C_{t}\cap C_{h}=\emptyset</annotation></semantics></math>.</p>
</div>
<div id="Sx3.p3" class="ltx_para">
<p id="Sx3.p3.3" class="ltx_p">Further, we assume that each client <math id="Sx3.p3.1.m1.1" class="ltx_Math" alttext="i\in C" display="inline"><semantics id="Sx3.p3.1.m1.1a"><mrow id="Sx3.p3.1.m1.1.1" xref="Sx3.p3.1.m1.1.1.cmml"><mi id="Sx3.p3.1.m1.1.1.2" xref="Sx3.p3.1.m1.1.1.2.cmml">i</mi><mo id="Sx3.p3.1.m1.1.1.1" xref="Sx3.p3.1.m1.1.1.1.cmml">∈</mo><mi id="Sx3.p3.1.m1.1.1.3" xref="Sx3.p3.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p3.1.m1.1b"><apply id="Sx3.p3.1.m1.1.1.cmml" xref="Sx3.p3.1.m1.1.1"><in id="Sx3.p3.1.m1.1.1.1.cmml" xref="Sx3.p3.1.m1.1.1.1"></in><ci id="Sx3.p3.1.m1.1.1.2.cmml" xref="Sx3.p3.1.m1.1.1.2">𝑖</ci><ci id="Sx3.p3.1.m1.1.1.3.cmml" xref="Sx3.p3.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p3.1.m1.1c">i\in C</annotation></semantics></math> possesses a (not necessarily labeled) dataset <math id="Sx3.p3.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx3.p3.2.m2.1a"><msub id="Sx3.p3.2.m2.1.1" xref="Sx3.p3.2.m2.1.1.cmml"><mi id="Sx3.p3.2.m2.1.1.2" xref="Sx3.p3.2.m2.1.1.2.cmml">D</mi><mi id="Sx3.p3.2.m2.1.1.3" xref="Sx3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p3.2.m2.1b"><apply id="Sx3.p3.2.m2.1.1.cmml" xref="Sx3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.p3.2.m2.1.1.1.cmml" xref="Sx3.p3.2.m2.1.1">subscript</csymbol><ci id="Sx3.p3.2.m2.1.1.2.cmml" xref="Sx3.p3.2.m2.1.1.2">𝐷</ci><ci id="Sx3.p3.2.m2.1.1.3.cmml" xref="Sx3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p3.2.m2.1c">D_{i}</annotation></semantics></math> generated by sampling data from the single Data-Generating Process (DGP) <math id="Sx3.p3.3.m3.1" class="ltx_Math" alttext="\gamma_{i}" display="inline"><semantics id="Sx3.p3.3.m3.1a"><msub id="Sx3.p3.3.m3.1.1" xref="Sx3.p3.3.m3.1.1.cmml"><mi id="Sx3.p3.3.m3.1.1.2" xref="Sx3.p3.3.m3.1.1.2.cmml">γ</mi><mi id="Sx3.p3.3.m3.1.1.3" xref="Sx3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p3.3.m3.1b"><apply id="Sx3.p3.3.m3.1.1.cmml" xref="Sx3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.p3.3.m3.1.1.1.cmml" xref="Sx3.p3.3.m3.1.1">subscript</csymbol><ci id="Sx3.p3.3.m3.1.1.2.cmml" xref="Sx3.p3.3.m3.1.1.2">𝛾</ci><ci id="Sx3.p3.3.m3.1.1.3.cmml" xref="Sx3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p3.3.m3.1c">\gamma_{i}</annotation></semantics></math> associated with the client. That is,</p>
<table id="Sx6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E1.m1.10" class="ltx_Math" alttext="\displaystyle D_{i}=\{X_{i,j},y_{i,j}\}_{j=1}^{|D_{i}|}\sim_{i.i.d.}\gamma_{i}." display="inline"><semantics id="Sx3.E1.m1.10a"><mrow id="Sx3.E1.m1.10.10.1" xref="Sx3.E1.m1.10.10.1.1.cmml"><mrow id="Sx3.E1.m1.10.10.1.1" xref="Sx3.E1.m1.10.10.1.1.cmml"><msub id="Sx3.E1.m1.10.10.1.1.4" xref="Sx3.E1.m1.10.10.1.1.4.cmml"><mi id="Sx3.E1.m1.10.10.1.1.4.2" xref="Sx3.E1.m1.10.10.1.1.4.2.cmml">D</mi><mi id="Sx3.E1.m1.10.10.1.1.4.3" xref="Sx3.E1.m1.10.10.1.1.4.3.cmml">i</mi></msub><mo id="Sx3.E1.m1.10.10.1.1.5" xref="Sx3.E1.m1.10.10.1.1.5.cmml">=</mo><msubsup id="Sx3.E1.m1.10.10.1.1.2" xref="Sx3.E1.m1.10.10.1.1.2.cmml"><mrow id="Sx3.E1.m1.10.10.1.1.2.2.2.2" xref="Sx3.E1.m1.10.10.1.1.2.2.2.3.cmml"><mo stretchy="false" id="Sx3.E1.m1.10.10.1.1.2.2.2.2.3" xref="Sx3.E1.m1.10.10.1.1.2.2.2.3.cmml">{</mo><msub id="Sx3.E1.m1.10.10.1.1.1.1.1.1.1" xref="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.2" xref="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="Sx3.E1.m1.2.2.2.4" xref="Sx3.E1.m1.2.2.2.3.cmml"><mi id="Sx3.E1.m1.1.1.1.1" xref="Sx3.E1.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.E1.m1.2.2.2.4.1" xref="Sx3.E1.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.E1.m1.2.2.2.2" xref="Sx3.E1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="Sx3.E1.m1.10.10.1.1.2.2.2.2.4" xref="Sx3.E1.m1.10.10.1.1.2.2.2.3.cmml">,</mo><msub id="Sx3.E1.m1.10.10.1.1.2.2.2.2.2" xref="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.cmml"><mi id="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.2" xref="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.2.cmml">y</mi><mrow id="Sx3.E1.m1.4.4.2.4" xref="Sx3.E1.m1.4.4.2.3.cmml"><mi id="Sx3.E1.m1.3.3.1.1" xref="Sx3.E1.m1.3.3.1.1.cmml">i</mi><mo id="Sx3.E1.m1.4.4.2.4.1" xref="Sx3.E1.m1.4.4.2.3.cmml">,</mo><mi id="Sx3.E1.m1.4.4.2.2" xref="Sx3.E1.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="Sx3.E1.m1.10.10.1.1.2.2.2.2.5" xref="Sx3.E1.m1.10.10.1.1.2.2.2.3.cmml">}</mo></mrow><mrow id="Sx3.E1.m1.10.10.1.1.2.2.4" xref="Sx3.E1.m1.10.10.1.1.2.2.4.cmml"><mi id="Sx3.E1.m1.10.10.1.1.2.2.4.2" xref="Sx3.E1.m1.10.10.1.1.2.2.4.2.cmml">j</mi><mo id="Sx3.E1.m1.10.10.1.1.2.2.4.1" xref="Sx3.E1.m1.10.10.1.1.2.2.4.1.cmml">=</mo><mn id="Sx3.E1.m1.10.10.1.1.2.2.4.3" xref="Sx3.E1.m1.10.10.1.1.2.2.4.3.cmml">1</mn></mrow><mrow id="Sx3.E1.m1.5.5.1.1" xref="Sx3.E1.m1.5.5.1.2.cmml"><mo stretchy="false" id="Sx3.E1.m1.5.5.1.1.2" xref="Sx3.E1.m1.5.5.1.2.1.cmml">|</mo><msub id="Sx3.E1.m1.5.5.1.1.1" xref="Sx3.E1.m1.5.5.1.1.1.cmml"><mi id="Sx3.E1.m1.5.5.1.1.1.2" xref="Sx3.E1.m1.5.5.1.1.1.2.cmml">D</mi><mi id="Sx3.E1.m1.5.5.1.1.1.3" xref="Sx3.E1.m1.5.5.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E1.m1.5.5.1.1.3" xref="Sx3.E1.m1.5.5.1.2.1.cmml">|</mo></mrow></msubsup><msub id="Sx3.E1.m1.10.10.1.1.6" xref="Sx3.E1.m1.10.10.1.1.6.cmml"><mo id="Sx3.E1.m1.10.10.1.1.6.2" xref="Sx3.E1.m1.10.10.1.1.6.2.cmml">∼</mo><mrow id="Sx3.E1.m1.9.9.4.4" xref="Sx3.E1.m1.9.9.4.5.cmml"><mrow id="Sx3.E1.m1.9.9.4.4.1.2" xref="Sx3.E1.m1.9.9.4.4.1.1.cmml"><mi id="Sx3.E1.m1.6.6.1.1" xref="Sx3.E1.m1.6.6.1.1.cmml">i</mi><mo lspace="0em" rspace="0.167em" id="Sx3.E1.m1.9.9.4.4.1.2.1" xref="Sx3.E1.m1.9.9.4.4.1.1a.cmml">.</mo><mi id="Sx3.E1.m1.7.7.2.2" xref="Sx3.E1.m1.7.7.2.2.cmml">i</mi><mo lspace="0em" rspace="0.167em" id="Sx3.E1.m1.9.9.4.4.1.2.2" xref="Sx3.E1.m1.9.9.4.4.1.1a.cmml">.</mo><mi id="Sx3.E1.m1.8.8.3.3" xref="Sx3.E1.m1.8.8.3.3.cmml">d</mi></mrow><mo lspace="0em" id="Sx3.E1.m1.9.9.4.4.2" xref="Sx3.E1.m1.9.9.4.5.cmml">.</mo></mrow></msub><msub id="Sx3.E1.m1.10.10.1.1.7" xref="Sx3.E1.m1.10.10.1.1.7.cmml"><mi id="Sx3.E1.m1.10.10.1.1.7.2" xref="Sx3.E1.m1.10.10.1.1.7.2.cmml">γ</mi><mi id="Sx3.E1.m1.10.10.1.1.7.3" xref="Sx3.E1.m1.10.10.1.1.7.3.cmml">i</mi></msub></mrow><mo lspace="0em" id="Sx3.E1.m1.10.10.1.2" xref="Sx3.E1.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.10b"><apply id="Sx3.E1.m1.10.10.1.1.cmml" xref="Sx3.E1.m1.10.10.1"><and id="Sx3.E1.m1.10.10.1.1a.cmml" xref="Sx3.E1.m1.10.10.1"></and><apply id="Sx3.E1.m1.10.10.1.1b.cmml" xref="Sx3.E1.m1.10.10.1"><eq id="Sx3.E1.m1.10.10.1.1.5.cmml" xref="Sx3.E1.m1.10.10.1.1.5"></eq><apply id="Sx3.E1.m1.10.10.1.1.4.cmml" xref="Sx3.E1.m1.10.10.1.1.4"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.4.1.cmml" xref="Sx3.E1.m1.10.10.1.1.4">subscript</csymbol><ci id="Sx3.E1.m1.10.10.1.1.4.2.cmml" xref="Sx3.E1.m1.10.10.1.1.4.2">𝐷</ci><ci id="Sx3.E1.m1.10.10.1.1.4.3.cmml" xref="Sx3.E1.m1.10.10.1.1.4.3">𝑖</ci></apply><apply id="Sx3.E1.m1.10.10.1.1.2.cmml" xref="Sx3.E1.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.2.3.cmml" xref="Sx3.E1.m1.10.10.1.1.2">superscript</csymbol><apply id="Sx3.E1.m1.10.10.1.1.2.2.cmml" xref="Sx3.E1.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.2.2.3.cmml" xref="Sx3.E1.m1.10.10.1.1.2">subscript</csymbol><set id="Sx3.E1.m1.10.10.1.1.2.2.2.3.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.2.2"><apply id="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.10.10.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m1.10.10.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E1.m1.10.10.1.1.1.1.1.1.1.2">𝑋</ci><list id="Sx3.E1.m1.2.2.2.3.cmml" xref="Sx3.E1.m1.2.2.2.4"><ci id="Sx3.E1.m1.1.1.1.1.cmml" xref="Sx3.E1.m1.1.1.1.1">𝑖</ci><ci id="Sx3.E1.m1.2.2.2.2.cmml" xref="Sx3.E1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.1.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.2.2.2">subscript</csymbol><ci id="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.2.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.2.2.2.2">𝑦</ci><list id="Sx3.E1.m1.4.4.2.3.cmml" xref="Sx3.E1.m1.4.4.2.4"><ci id="Sx3.E1.m1.3.3.1.1.cmml" xref="Sx3.E1.m1.3.3.1.1">𝑖</ci><ci id="Sx3.E1.m1.4.4.2.2.cmml" xref="Sx3.E1.m1.4.4.2.2">𝑗</ci></list></apply></set><apply id="Sx3.E1.m1.10.10.1.1.2.2.4.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.4"><eq id="Sx3.E1.m1.10.10.1.1.2.2.4.1.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.4.1"></eq><ci id="Sx3.E1.m1.10.10.1.1.2.2.4.2.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.4.2">𝑗</ci><cn type="integer" id="Sx3.E1.m1.10.10.1.1.2.2.4.3.cmml" xref="Sx3.E1.m1.10.10.1.1.2.2.4.3">1</cn></apply></apply><apply id="Sx3.E1.m1.5.5.1.2.cmml" xref="Sx3.E1.m1.5.5.1.1"><abs id="Sx3.E1.m1.5.5.1.2.1.cmml" xref="Sx3.E1.m1.5.5.1.1.2"></abs><apply id="Sx3.E1.m1.5.5.1.1.1.cmml" xref="Sx3.E1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.5.5.1.1.1.1.cmml" xref="Sx3.E1.m1.5.5.1.1.1">subscript</csymbol><ci id="Sx3.E1.m1.5.5.1.1.1.2.cmml" xref="Sx3.E1.m1.5.5.1.1.1.2">𝐷</ci><ci id="Sx3.E1.m1.5.5.1.1.1.3.cmml" xref="Sx3.E1.m1.5.5.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="Sx3.E1.m1.10.10.1.1c.cmml" xref="Sx3.E1.m1.10.10.1"><apply id="Sx3.E1.m1.10.10.1.1.6.cmml" xref="Sx3.E1.m1.10.10.1.1.6"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.6.1.cmml" xref="Sx3.E1.m1.10.10.1.1.6">subscript</csymbol><csymbol cd="latexml" id="Sx3.E1.m1.10.10.1.1.6.2.cmml" xref="Sx3.E1.m1.10.10.1.1.6.2">similar-to</csymbol><list id="Sx3.E1.m1.9.9.4.5.cmml" xref="Sx3.E1.m1.9.9.4.4"><apply id="Sx3.E1.m1.9.9.4.4.1.1.cmml" xref="Sx3.E1.m1.9.9.4.4.1.2"><csymbol cd="ambiguous" id="Sx3.E1.m1.9.9.4.4.1.1a.cmml" xref="Sx3.E1.m1.9.9.4.4.1.2.1">formulae-sequence</csymbol><ci id="Sx3.E1.m1.6.6.1.1.cmml" xref="Sx3.E1.m1.6.6.1.1">𝑖</ci><ci id="Sx3.E1.m1.7.7.2.2.cmml" xref="Sx3.E1.m1.7.7.2.2">𝑖</ci><ci id="Sx3.E1.m1.8.8.3.3.cmml" xref="Sx3.E1.m1.8.8.3.3">𝑑</ci></apply></list></apply><share href="#Sx3.E1.m1.10.10.1.1.2.cmml" id="Sx3.E1.m1.10.10.1.1d.cmml" xref="Sx3.E1.m1.10.10.1"></share><apply id="Sx3.E1.m1.10.10.1.1.7.cmml" xref="Sx3.E1.m1.10.10.1.1.7"><csymbol cd="ambiguous" id="Sx3.E1.m1.10.10.1.1.7.1.cmml" xref="Sx3.E1.m1.10.10.1.1.7">subscript</csymbol><ci id="Sx3.E1.m1.10.10.1.1.7.2.cmml" xref="Sx3.E1.m1.10.10.1.1.7.2">𝛾</ci><ci id="Sx3.E1.m1.10.10.1.1.7.3.cmml" xref="Sx3.E1.m1.10.10.1.1.7.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.10c">\displaystyle D_{i}=\{X_{i,j},y_{i,j}\}_{j=1}^{|D_{i}|}\sim_{i.i.d.}\gamma_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.p4" class="ltx_para">
<p id="Sx3.p4.4" class="ltx_p">The concept of DGP is abstract, as it represents an unknown stochastic process that encompasses all factors influencing the collected data. From a probabilistic perspective, any DGP <math id="Sx3.p4.1.m1.1" class="ltx_Math" alttext="\gamma_{i}" display="inline"><semantics id="Sx3.p4.1.m1.1a"><msub id="Sx3.p4.1.m1.1.1" xref="Sx3.p4.1.m1.1.1.cmml"><mi id="Sx3.p4.1.m1.1.1.2" xref="Sx3.p4.1.m1.1.1.2.cmml">γ</mi><mi id="Sx3.p4.1.m1.1.1.3" xref="Sx3.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p4.1.m1.1b"><apply id="Sx3.p4.1.m1.1.1.cmml" xref="Sx3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.p4.1.m1.1.1.1.cmml" xref="Sx3.p4.1.m1.1.1">subscript</csymbol><ci id="Sx3.p4.1.m1.1.1.2.cmml" xref="Sx3.p4.1.m1.1.1.2">𝛾</ci><ci id="Sx3.p4.1.m1.1.1.3.cmml" xref="Sx3.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p4.1.m1.1c">\gamma_{i}</annotation></semantics></math> is characterized by a distribution <math id="Sx3.p4.2.m2.2" class="ltx_Math" alttext="p_{i}(x,y)" display="inline"><semantics id="Sx3.p4.2.m2.2a"><mrow id="Sx3.p4.2.m2.2.3" xref="Sx3.p4.2.m2.2.3.cmml"><msub id="Sx3.p4.2.m2.2.3.2" xref="Sx3.p4.2.m2.2.3.2.cmml"><mi id="Sx3.p4.2.m2.2.3.2.2" xref="Sx3.p4.2.m2.2.3.2.2.cmml">p</mi><mi id="Sx3.p4.2.m2.2.3.2.3" xref="Sx3.p4.2.m2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.p4.2.m2.2.3.1" xref="Sx3.p4.2.m2.2.3.1.cmml">​</mo><mrow id="Sx3.p4.2.m2.2.3.3.2" xref="Sx3.p4.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Sx3.p4.2.m2.2.3.3.2.1" xref="Sx3.p4.2.m2.2.3.3.1.cmml">(</mo><mi id="Sx3.p4.2.m2.1.1" xref="Sx3.p4.2.m2.1.1.cmml">x</mi><mo id="Sx3.p4.2.m2.2.3.3.2.2" xref="Sx3.p4.2.m2.2.3.3.1.cmml">,</mo><mi id="Sx3.p4.2.m2.2.2" xref="Sx3.p4.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="Sx3.p4.2.m2.2.3.3.2.3" xref="Sx3.p4.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p4.2.m2.2b"><apply id="Sx3.p4.2.m2.2.3.cmml" xref="Sx3.p4.2.m2.2.3"><times id="Sx3.p4.2.m2.2.3.1.cmml" xref="Sx3.p4.2.m2.2.3.1"></times><apply id="Sx3.p4.2.m2.2.3.2.cmml" xref="Sx3.p4.2.m2.2.3.2"><csymbol cd="ambiguous" id="Sx3.p4.2.m2.2.3.2.1.cmml" xref="Sx3.p4.2.m2.2.3.2">subscript</csymbol><ci id="Sx3.p4.2.m2.2.3.2.2.cmml" xref="Sx3.p4.2.m2.2.3.2.2">𝑝</ci><ci id="Sx3.p4.2.m2.2.3.2.3.cmml" xref="Sx3.p4.2.m2.2.3.2.3">𝑖</ci></apply><interval closure="open" id="Sx3.p4.2.m2.2.3.3.1.cmml" xref="Sx3.p4.2.m2.2.3.3.2"><ci id="Sx3.p4.2.m2.1.1.cmml" xref="Sx3.p4.2.m2.1.1">𝑥</ci><ci id="Sx3.p4.2.m2.2.2.cmml" xref="Sx3.p4.2.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p4.2.m2.2c">p_{i}(x,y)</annotation></semantics></math>, which may be rewritten as <math id="Sx3.p4.3.m3.2" class="ltx_Math" alttext="p_{i}(x)\cdot p_{i}(y|x)" display="inline"><semantics id="Sx3.p4.3.m3.2a"><mrow id="Sx3.p4.3.m3.2.2" xref="Sx3.p4.3.m3.2.2.cmml"><mrow id="Sx3.p4.3.m3.2.2.3" xref="Sx3.p4.3.m3.2.2.3.cmml"><mrow id="Sx3.p4.3.m3.2.2.3.2" xref="Sx3.p4.3.m3.2.2.3.2.cmml"><msub id="Sx3.p4.3.m3.2.2.3.2.2" xref="Sx3.p4.3.m3.2.2.3.2.2.cmml"><mi id="Sx3.p4.3.m3.2.2.3.2.2.2" xref="Sx3.p4.3.m3.2.2.3.2.2.2.cmml">p</mi><mi id="Sx3.p4.3.m3.2.2.3.2.2.3" xref="Sx3.p4.3.m3.2.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.p4.3.m3.2.2.3.2.1" xref="Sx3.p4.3.m3.2.2.3.2.1.cmml">​</mo><mrow id="Sx3.p4.3.m3.2.2.3.2.3.2" xref="Sx3.p4.3.m3.2.2.3.2.cmml"><mo stretchy="false" id="Sx3.p4.3.m3.2.2.3.2.3.2.1" xref="Sx3.p4.3.m3.2.2.3.2.cmml">(</mo><mi id="Sx3.p4.3.m3.1.1" xref="Sx3.p4.3.m3.1.1.cmml">x</mi><mo rspace="0.055em" stretchy="false" id="Sx3.p4.3.m3.2.2.3.2.3.2.2" xref="Sx3.p4.3.m3.2.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Sx3.p4.3.m3.2.2.3.1" xref="Sx3.p4.3.m3.2.2.3.1.cmml">⋅</mo><msub id="Sx3.p4.3.m3.2.2.3.3" xref="Sx3.p4.3.m3.2.2.3.3.cmml"><mi id="Sx3.p4.3.m3.2.2.3.3.2" xref="Sx3.p4.3.m3.2.2.3.3.2.cmml">p</mi><mi id="Sx3.p4.3.m3.2.2.3.3.3" xref="Sx3.p4.3.m3.2.2.3.3.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Sx3.p4.3.m3.2.2.2" xref="Sx3.p4.3.m3.2.2.2.cmml">​</mo><mrow id="Sx3.p4.3.m3.2.2.1.1" xref="Sx3.p4.3.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.p4.3.m3.2.2.1.1.2" xref="Sx3.p4.3.m3.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.p4.3.m3.2.2.1.1.1" xref="Sx3.p4.3.m3.2.2.1.1.1.cmml"><mi id="Sx3.p4.3.m3.2.2.1.1.1.2" xref="Sx3.p4.3.m3.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="Sx3.p4.3.m3.2.2.1.1.1.1" xref="Sx3.p4.3.m3.2.2.1.1.1.1.cmml">|</mo><mi id="Sx3.p4.3.m3.2.2.1.1.1.3" xref="Sx3.p4.3.m3.2.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="Sx3.p4.3.m3.2.2.1.1.3" xref="Sx3.p4.3.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p4.3.m3.2b"><apply id="Sx3.p4.3.m3.2.2.cmml" xref="Sx3.p4.3.m3.2.2"><times id="Sx3.p4.3.m3.2.2.2.cmml" xref="Sx3.p4.3.m3.2.2.2"></times><apply id="Sx3.p4.3.m3.2.2.3.cmml" xref="Sx3.p4.3.m3.2.2.3"><ci id="Sx3.p4.3.m3.2.2.3.1.cmml" xref="Sx3.p4.3.m3.2.2.3.1">⋅</ci><apply id="Sx3.p4.3.m3.2.2.3.2.cmml" xref="Sx3.p4.3.m3.2.2.3.2"><times id="Sx3.p4.3.m3.2.2.3.2.1.cmml" xref="Sx3.p4.3.m3.2.2.3.2.1"></times><apply id="Sx3.p4.3.m3.2.2.3.2.2.cmml" xref="Sx3.p4.3.m3.2.2.3.2.2"><csymbol cd="ambiguous" id="Sx3.p4.3.m3.2.2.3.2.2.1.cmml" xref="Sx3.p4.3.m3.2.2.3.2.2">subscript</csymbol><ci id="Sx3.p4.3.m3.2.2.3.2.2.2.cmml" xref="Sx3.p4.3.m3.2.2.3.2.2.2">𝑝</ci><ci id="Sx3.p4.3.m3.2.2.3.2.2.3.cmml" xref="Sx3.p4.3.m3.2.2.3.2.2.3">𝑖</ci></apply><ci id="Sx3.p4.3.m3.1.1.cmml" xref="Sx3.p4.3.m3.1.1">𝑥</ci></apply><apply id="Sx3.p4.3.m3.2.2.3.3.cmml" xref="Sx3.p4.3.m3.2.2.3.3"><csymbol cd="ambiguous" id="Sx3.p4.3.m3.2.2.3.3.1.cmml" xref="Sx3.p4.3.m3.2.2.3.3">subscript</csymbol><ci id="Sx3.p4.3.m3.2.2.3.3.2.cmml" xref="Sx3.p4.3.m3.2.2.3.3.2">𝑝</ci><ci id="Sx3.p4.3.m3.2.2.3.3.3.cmml" xref="Sx3.p4.3.m3.2.2.3.3.3">𝑖</ci></apply></apply><apply id="Sx3.p4.3.m3.2.2.1.1.1.cmml" xref="Sx3.p4.3.m3.2.2.1.1"><csymbol cd="latexml" id="Sx3.p4.3.m3.2.2.1.1.1.1.cmml" xref="Sx3.p4.3.m3.2.2.1.1.1.1">conditional</csymbol><ci id="Sx3.p4.3.m3.2.2.1.1.1.2.cmml" xref="Sx3.p4.3.m3.2.2.1.1.1.2">𝑦</ci><ci id="Sx3.p4.3.m3.2.2.1.1.1.3.cmml" xref="Sx3.p4.3.m3.2.2.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p4.3.m3.2c">p_{i}(x)\cdot p_{i}(y|x)</annotation></semantics></math> or <math id="Sx3.p4.4.m4.2" class="ltx_Math" alttext="p_{i}(y)\cdot p_{i}(x|y)" display="inline"><semantics id="Sx3.p4.4.m4.2a"><mrow id="Sx3.p4.4.m4.2.2" xref="Sx3.p4.4.m4.2.2.cmml"><mrow id="Sx3.p4.4.m4.2.2.3" xref="Sx3.p4.4.m4.2.2.3.cmml"><mrow id="Sx3.p4.4.m4.2.2.3.2" xref="Sx3.p4.4.m4.2.2.3.2.cmml"><msub id="Sx3.p4.4.m4.2.2.3.2.2" xref="Sx3.p4.4.m4.2.2.3.2.2.cmml"><mi id="Sx3.p4.4.m4.2.2.3.2.2.2" xref="Sx3.p4.4.m4.2.2.3.2.2.2.cmml">p</mi><mi id="Sx3.p4.4.m4.2.2.3.2.2.3" xref="Sx3.p4.4.m4.2.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.p4.4.m4.2.2.3.2.1" xref="Sx3.p4.4.m4.2.2.3.2.1.cmml">​</mo><mrow id="Sx3.p4.4.m4.2.2.3.2.3.2" xref="Sx3.p4.4.m4.2.2.3.2.cmml"><mo stretchy="false" id="Sx3.p4.4.m4.2.2.3.2.3.2.1" xref="Sx3.p4.4.m4.2.2.3.2.cmml">(</mo><mi id="Sx3.p4.4.m4.1.1" xref="Sx3.p4.4.m4.1.1.cmml">y</mi><mo rspace="0.055em" stretchy="false" id="Sx3.p4.4.m4.2.2.3.2.3.2.2" xref="Sx3.p4.4.m4.2.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="Sx3.p4.4.m4.2.2.3.1" xref="Sx3.p4.4.m4.2.2.3.1.cmml">⋅</mo><msub id="Sx3.p4.4.m4.2.2.3.3" xref="Sx3.p4.4.m4.2.2.3.3.cmml"><mi id="Sx3.p4.4.m4.2.2.3.3.2" xref="Sx3.p4.4.m4.2.2.3.3.2.cmml">p</mi><mi id="Sx3.p4.4.m4.2.2.3.3.3" xref="Sx3.p4.4.m4.2.2.3.3.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Sx3.p4.4.m4.2.2.2" xref="Sx3.p4.4.m4.2.2.2.cmml">​</mo><mrow id="Sx3.p4.4.m4.2.2.1.1" xref="Sx3.p4.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.p4.4.m4.2.2.1.1.2" xref="Sx3.p4.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.p4.4.m4.2.2.1.1.1" xref="Sx3.p4.4.m4.2.2.1.1.1.cmml"><mi id="Sx3.p4.4.m4.2.2.1.1.1.2" xref="Sx3.p4.4.m4.2.2.1.1.1.2.cmml">x</mi><mo fence="false" id="Sx3.p4.4.m4.2.2.1.1.1.1" xref="Sx3.p4.4.m4.2.2.1.1.1.1.cmml">|</mo><mi id="Sx3.p4.4.m4.2.2.1.1.1.3" xref="Sx3.p4.4.m4.2.2.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="Sx3.p4.4.m4.2.2.1.1.3" xref="Sx3.p4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p4.4.m4.2b"><apply id="Sx3.p4.4.m4.2.2.cmml" xref="Sx3.p4.4.m4.2.2"><times id="Sx3.p4.4.m4.2.2.2.cmml" xref="Sx3.p4.4.m4.2.2.2"></times><apply id="Sx3.p4.4.m4.2.2.3.cmml" xref="Sx3.p4.4.m4.2.2.3"><ci id="Sx3.p4.4.m4.2.2.3.1.cmml" xref="Sx3.p4.4.m4.2.2.3.1">⋅</ci><apply id="Sx3.p4.4.m4.2.2.3.2.cmml" xref="Sx3.p4.4.m4.2.2.3.2"><times id="Sx3.p4.4.m4.2.2.3.2.1.cmml" xref="Sx3.p4.4.m4.2.2.3.2.1"></times><apply id="Sx3.p4.4.m4.2.2.3.2.2.cmml" xref="Sx3.p4.4.m4.2.2.3.2.2"><csymbol cd="ambiguous" id="Sx3.p4.4.m4.2.2.3.2.2.1.cmml" xref="Sx3.p4.4.m4.2.2.3.2.2">subscript</csymbol><ci id="Sx3.p4.4.m4.2.2.3.2.2.2.cmml" xref="Sx3.p4.4.m4.2.2.3.2.2.2">𝑝</ci><ci id="Sx3.p4.4.m4.2.2.3.2.2.3.cmml" xref="Sx3.p4.4.m4.2.2.3.2.2.3">𝑖</ci></apply><ci id="Sx3.p4.4.m4.1.1.cmml" xref="Sx3.p4.4.m4.1.1">𝑦</ci></apply><apply id="Sx3.p4.4.m4.2.2.3.3.cmml" xref="Sx3.p4.4.m4.2.2.3.3"><csymbol cd="ambiguous" id="Sx3.p4.4.m4.2.2.3.3.1.cmml" xref="Sx3.p4.4.m4.2.2.3.3">subscript</csymbol><ci id="Sx3.p4.4.m4.2.2.3.3.2.cmml" xref="Sx3.p4.4.m4.2.2.3.3.2">𝑝</ci><ci id="Sx3.p4.4.m4.2.2.3.3.3.cmml" xref="Sx3.p4.4.m4.2.2.3.3.3">𝑖</ci></apply></apply><apply id="Sx3.p4.4.m4.2.2.1.1.1.cmml" xref="Sx3.p4.4.m4.2.2.1.1"><csymbol cd="latexml" id="Sx3.p4.4.m4.2.2.1.1.1.1.cmml" xref="Sx3.p4.4.m4.2.2.1.1.1.1">conditional</csymbol><ci id="Sx3.p4.4.m4.2.2.1.1.1.2.cmml" xref="Sx3.p4.4.m4.2.2.1.1.1.2">𝑥</ci><ci id="Sx3.p4.4.m4.2.2.1.1.1.3.cmml" xref="Sx3.p4.4.m4.2.2.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p4.4.m4.2c">p_{i}(y)\cdot p_{i}(x|y)</annotation></semantics></math><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>For simplicity we use the shorthand notation <math id="footnote1.m1.2" class="ltx_Math" alttext="p(x)=p_{X}(x)" display="inline"><semantics id="footnote1.m1.2b"><mrow id="footnote1.m1.2.3" xref="footnote1.m1.2.3.cmml"><mrow id="footnote1.m1.2.3.2" xref="footnote1.m1.2.3.2.cmml"><mi id="footnote1.m1.2.3.2.2" xref="footnote1.m1.2.3.2.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="footnote1.m1.2.3.2.1" xref="footnote1.m1.2.3.2.1.cmml">​</mo><mrow id="footnote1.m1.2.3.2.3.2" xref="footnote1.m1.2.3.2.cmml"><mo stretchy="false" id="footnote1.m1.2.3.2.3.2.1" xref="footnote1.m1.2.3.2.cmml">(</mo><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">x</mi><mo stretchy="false" id="footnote1.m1.2.3.2.3.2.2" xref="footnote1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="footnote1.m1.2.3.1" xref="footnote1.m1.2.3.1.cmml">=</mo><mrow id="footnote1.m1.2.3.3" xref="footnote1.m1.2.3.3.cmml"><msub id="footnote1.m1.2.3.3.2" xref="footnote1.m1.2.3.3.2.cmml"><mi id="footnote1.m1.2.3.3.2.2" xref="footnote1.m1.2.3.3.2.2.cmml">p</mi><mi id="footnote1.m1.2.3.3.2.3" xref="footnote1.m1.2.3.3.2.3.cmml">X</mi></msub><mo lspace="0em" rspace="0em" id="footnote1.m1.2.3.3.1" xref="footnote1.m1.2.3.3.1.cmml">​</mo><mrow id="footnote1.m1.2.3.3.3.2" xref="footnote1.m1.2.3.3.cmml"><mo stretchy="false" id="footnote1.m1.2.3.3.3.2.1" xref="footnote1.m1.2.3.3.cmml">(</mo><mi id="footnote1.m1.2.2" xref="footnote1.m1.2.2.cmml">x</mi><mo stretchy="false" id="footnote1.m1.2.3.3.3.2.2" xref="footnote1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.2c"><apply id="footnote1.m1.2.3.cmml" xref="footnote1.m1.2.3"><eq id="footnote1.m1.2.3.1.cmml" xref="footnote1.m1.2.3.1"></eq><apply id="footnote1.m1.2.3.2.cmml" xref="footnote1.m1.2.3.2"><times id="footnote1.m1.2.3.2.1.cmml" xref="footnote1.m1.2.3.2.1"></times><ci id="footnote1.m1.2.3.2.2.cmml" xref="footnote1.m1.2.3.2.2">𝑝</ci><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">𝑥</ci></apply><apply id="footnote1.m1.2.3.3.cmml" xref="footnote1.m1.2.3.3"><times id="footnote1.m1.2.3.3.1.cmml" xref="footnote1.m1.2.3.3.1"></times><apply id="footnote1.m1.2.3.3.2.cmml" xref="footnote1.m1.2.3.3.2"><csymbol cd="ambiguous" id="footnote1.m1.2.3.3.2.1.cmml" xref="footnote1.m1.2.3.3.2">subscript</csymbol><ci id="footnote1.m1.2.3.3.2.2.cmml" xref="footnote1.m1.2.3.3.2.2">𝑝</ci><ci id="footnote1.m1.2.3.3.2.3.cmml" xref="footnote1.m1.2.3.3.2.3">𝑋</ci></apply><ci id="footnote1.m1.2.2.cmml" xref="footnote1.m1.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.2d">p(x)=p_{X}(x)</annotation></semantics></math>, <math id="footnote1.m2.2" class="ltx_Math" alttext="p_{X|Y}(x|y)=p(x|y)" display="inline"><semantics id="footnote1.m2.2b"><mrow id="footnote1.m2.2.2" xref="footnote1.m2.2.2.cmml"><mrow id="footnote1.m2.1.1.1" xref="footnote1.m2.1.1.1.cmml"><msub id="footnote1.m2.1.1.1.3" xref="footnote1.m2.1.1.1.3.cmml"><mi id="footnote1.m2.1.1.1.3.2" xref="footnote1.m2.1.1.1.3.2.cmml">p</mi><mrow id="footnote1.m2.1.1.1.3.3" xref="footnote1.m2.1.1.1.3.3.cmml"><mi id="footnote1.m2.1.1.1.3.3.2" xref="footnote1.m2.1.1.1.3.3.2.cmml">X</mi><mo fence="false" id="footnote1.m2.1.1.1.3.3.1" xref="footnote1.m2.1.1.1.3.3.1.cmml">|</mo><mi id="footnote1.m2.1.1.1.3.3.3" xref="footnote1.m2.1.1.1.3.3.3.cmml">Y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="footnote1.m2.1.1.1.2" xref="footnote1.m2.1.1.1.2.cmml">​</mo><mrow id="footnote1.m2.1.1.1.1.1" xref="footnote1.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="footnote1.m2.1.1.1.1.1.2" xref="footnote1.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="footnote1.m2.1.1.1.1.1.1" xref="footnote1.m2.1.1.1.1.1.1.cmml"><mi id="footnote1.m2.1.1.1.1.1.1.2" xref="footnote1.m2.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="footnote1.m2.1.1.1.1.1.1.1" xref="footnote1.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="footnote1.m2.1.1.1.1.1.1.3" xref="footnote1.m2.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="footnote1.m2.1.1.1.1.1.3" xref="footnote1.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="footnote1.m2.2.2.3" xref="footnote1.m2.2.2.3.cmml">=</mo><mrow id="footnote1.m2.2.2.2" xref="footnote1.m2.2.2.2.cmml"><mi id="footnote1.m2.2.2.2.3" xref="footnote1.m2.2.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="footnote1.m2.2.2.2.2" xref="footnote1.m2.2.2.2.2.cmml">​</mo><mrow id="footnote1.m2.2.2.2.1.1" xref="footnote1.m2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="footnote1.m2.2.2.2.1.1.2" xref="footnote1.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="footnote1.m2.2.2.2.1.1.1" xref="footnote1.m2.2.2.2.1.1.1.cmml"><mi id="footnote1.m2.2.2.2.1.1.1.2" xref="footnote1.m2.2.2.2.1.1.1.2.cmml">x</mi><mo fence="false" id="footnote1.m2.2.2.2.1.1.1.1" xref="footnote1.m2.2.2.2.1.1.1.1.cmml">|</mo><mi id="footnote1.m2.2.2.2.1.1.1.3" xref="footnote1.m2.2.2.2.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="footnote1.m2.2.2.2.1.1.3" xref="footnote1.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m2.2c"><apply id="footnote1.m2.2.2.cmml" xref="footnote1.m2.2.2"><eq id="footnote1.m2.2.2.3.cmml" xref="footnote1.m2.2.2.3"></eq><apply id="footnote1.m2.1.1.1.cmml" xref="footnote1.m2.1.1.1"><times id="footnote1.m2.1.1.1.2.cmml" xref="footnote1.m2.1.1.1.2"></times><apply id="footnote1.m2.1.1.1.3.cmml" xref="footnote1.m2.1.1.1.3"><csymbol cd="ambiguous" id="footnote1.m2.1.1.1.3.1.cmml" xref="footnote1.m2.1.1.1.3">subscript</csymbol><ci id="footnote1.m2.1.1.1.3.2.cmml" xref="footnote1.m2.1.1.1.3.2">𝑝</ci><apply id="footnote1.m2.1.1.1.3.3.cmml" xref="footnote1.m2.1.1.1.3.3"><csymbol cd="latexml" id="footnote1.m2.1.1.1.3.3.1.cmml" xref="footnote1.m2.1.1.1.3.3.1">conditional</csymbol><ci id="footnote1.m2.1.1.1.3.3.2.cmml" xref="footnote1.m2.1.1.1.3.3.2">𝑋</ci><ci id="footnote1.m2.1.1.1.3.3.3.cmml" xref="footnote1.m2.1.1.1.3.3.3">𝑌</ci></apply></apply><apply id="footnote1.m2.1.1.1.1.1.1.cmml" xref="footnote1.m2.1.1.1.1.1"><csymbol cd="latexml" id="footnote1.m2.1.1.1.1.1.1.1.cmml" xref="footnote1.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="footnote1.m2.1.1.1.1.1.1.2.cmml" xref="footnote1.m2.1.1.1.1.1.1.2">𝑥</ci><ci id="footnote1.m2.1.1.1.1.1.1.3.cmml" xref="footnote1.m2.1.1.1.1.1.1.3">𝑦</ci></apply></apply><apply id="footnote1.m2.2.2.2.cmml" xref="footnote1.m2.2.2.2"><times id="footnote1.m2.2.2.2.2.cmml" xref="footnote1.m2.2.2.2.2"></times><ci id="footnote1.m2.2.2.2.3.cmml" xref="footnote1.m2.2.2.2.3">𝑝</ci><apply id="footnote1.m2.2.2.2.1.1.1.cmml" xref="footnote1.m2.2.2.2.1.1"><csymbol cd="latexml" id="footnote1.m2.2.2.2.1.1.1.1.cmml" xref="footnote1.m2.2.2.2.1.1.1.1">conditional</csymbol><ci id="footnote1.m2.2.2.2.1.1.1.2.cmml" xref="footnote1.m2.2.2.2.1.1.1.2">𝑥</ci><ci id="footnote1.m2.2.2.2.1.1.1.3.cmml" xref="footnote1.m2.2.2.2.1.1.1.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.2d">p_{X|Y}(x|y)=p(x|y)</annotation></semantics></math>, etc.</span></span></span>. If any of these probabilities differ between two DGPs, we say that the data generated by the two DGPs is non-IID. In particular, the non-IIDness types may be characterized as follows <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al. <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>:</p>
</div>
<div id="Sx3.p5" class="ltx_para">
<ul id="Sx3.I3" class="ltx_itemize">
<li id="Sx3.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx3.I3.i1.p1" class="ltx_para">
<p id="Sx3.I3.i1.p1.1" class="ltx_p"><span id="Sx3.I3.i1.p1.1.1" class="ltx_text ltx_font_italic">Concept drift</span>, when <math id="Sx3.I3.i1.p1.1.m1.2" class="ltx_Math" alttext="p_{i}(x|y)\neq p_{j}(x|y)" display="inline"><semantics id="Sx3.I3.i1.p1.1.m1.2a"><mrow id="Sx3.I3.i1.p1.1.m1.2.2" xref="Sx3.I3.i1.p1.1.m1.2.2.cmml"><mrow id="Sx3.I3.i1.p1.1.m1.1.1.1" xref="Sx3.I3.i1.p1.1.m1.1.1.1.cmml"><msub id="Sx3.I3.i1.p1.1.m1.1.1.1.3" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3.cmml"><mi id="Sx3.I3.i1.p1.1.m1.1.1.1.3.2" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3.2.cmml">p</mi><mi id="Sx3.I3.i1.p1.1.m1.1.1.1.3.3" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i1.p1.1.m1.1.1.1.2" xref="Sx3.I3.i1.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.2" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.2" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.1" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.3" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.3" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.I3.i1.p1.1.m1.2.2.3" xref="Sx3.I3.i1.p1.1.m1.2.2.3.cmml">≠</mo><mrow id="Sx3.I3.i1.p1.1.m1.2.2.2" xref="Sx3.I3.i1.p1.1.m1.2.2.2.cmml"><msub id="Sx3.I3.i1.p1.1.m1.2.2.2.3" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3.cmml"><mi id="Sx3.I3.i1.p1.1.m1.2.2.2.3.2" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3.2.cmml">p</mi><mi id="Sx3.I3.i1.p1.1.m1.2.2.2.3.3" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i1.p1.1.m1.2.2.2.2" xref="Sx3.I3.i1.p1.1.m1.2.2.2.2.cmml">​</mo><mrow id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.2" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.cmml"><mi id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.2" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.2.cmml">x</mi><mo fence="false" id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.1" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.3" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.3" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I3.i1.p1.1.m1.2b"><apply id="Sx3.I3.i1.p1.1.m1.2.2.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2"><neq id="Sx3.I3.i1.p1.1.m1.2.2.3.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.3"></neq><apply id="Sx3.I3.i1.p1.1.m1.1.1.1.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1"><times id="Sx3.I3.i1.p1.1.m1.1.1.1.2.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.2"></times><apply id="Sx3.I3.i1.p1.1.m1.1.1.1.3.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.I3.i1.p1.1.m1.1.1.1.3.1.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3">subscript</csymbol><ci id="Sx3.I3.i1.p1.1.m1.1.1.1.3.2.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3.2">𝑝</ci><ci id="Sx3.I3.i1.p1.1.m1.1.1.1.3.3.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.I3.i1.p1.1.m1.1.1.1.1.1.1.3">𝑦</ci></apply></apply><apply id="Sx3.I3.i1.p1.1.m1.2.2.2.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2"><times id="Sx3.I3.i1.p1.1.m1.2.2.2.2.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.2"></times><apply id="Sx3.I3.i1.p1.1.m1.2.2.2.3.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.I3.i1.p1.1.m1.2.2.2.3.1.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="Sx3.I3.i1.p1.1.m1.2.2.2.3.2.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3.2">𝑝</ci><ci id="Sx3.I3.i1.p1.1.m1.2.2.2.3.3.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.3.3">𝑗</ci></apply><apply id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.2">𝑥</ci><ci id="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="Sx3.I3.i1.p1.1.m1.2.2.2.1.1.1.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I3.i1.p1.1.m1.2c">p_{i}(x|y)\neq p_{j}(x|y)</annotation></semantics></math>;</p>
</div>
</li>
<li id="Sx3.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx3.I3.i2.p1" class="ltx_para">
<p id="Sx3.I3.i2.p1.1" class="ltx_p"><span id="Sx3.I3.i2.p1.1.1" class="ltx_text ltx_font_italic">Concept shift</span>, when <math id="Sx3.I3.i2.p1.1.m1.2" class="ltx_Math" alttext="p_{i}(y|x)\neq p_{j}(y|x)" display="inline"><semantics id="Sx3.I3.i2.p1.1.m1.2a"><mrow id="Sx3.I3.i2.p1.1.m1.2.2" xref="Sx3.I3.i2.p1.1.m1.2.2.cmml"><mrow id="Sx3.I3.i2.p1.1.m1.1.1.1" xref="Sx3.I3.i2.p1.1.m1.1.1.1.cmml"><msub id="Sx3.I3.i2.p1.1.m1.1.1.1.3" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3.cmml"><mi id="Sx3.I3.i2.p1.1.m1.1.1.1.3.2" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3.2.cmml">p</mi><mi id="Sx3.I3.i2.p1.1.m1.1.1.1.3.3" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i2.p1.1.m1.1.1.1.2" xref="Sx3.I3.i2.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.2" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.2" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.1" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.3" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.3" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.I3.i2.p1.1.m1.2.2.3" xref="Sx3.I3.i2.p1.1.m1.2.2.3.cmml">≠</mo><mrow id="Sx3.I3.i2.p1.1.m1.2.2.2" xref="Sx3.I3.i2.p1.1.m1.2.2.2.cmml"><msub id="Sx3.I3.i2.p1.1.m1.2.2.2.3" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3.cmml"><mi id="Sx3.I3.i2.p1.1.m1.2.2.2.3.2" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3.2.cmml">p</mi><mi id="Sx3.I3.i2.p1.1.m1.2.2.2.3.3" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i2.p1.1.m1.2.2.2.2" xref="Sx3.I3.i2.p1.1.m1.2.2.2.2.cmml">​</mo><mrow id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.2" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.cmml"><mi id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.2" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.1" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.3" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.3" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I3.i2.p1.1.m1.2b"><apply id="Sx3.I3.i2.p1.1.m1.2.2.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2"><neq id="Sx3.I3.i2.p1.1.m1.2.2.3.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.3"></neq><apply id="Sx3.I3.i2.p1.1.m1.1.1.1.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1"><times id="Sx3.I3.i2.p1.1.m1.1.1.1.2.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.2"></times><apply id="Sx3.I3.i2.p1.1.m1.1.1.1.3.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.I3.i2.p1.1.m1.1.1.1.3.1.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3">subscript</csymbol><ci id="Sx3.I3.i2.p1.1.m1.1.1.1.3.2.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3.2">𝑝</ci><ci id="Sx3.I3.i2.p1.1.m1.1.1.1.3.3.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.I3.i2.p1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="Sx3.I3.i2.p1.1.m1.2.2.2.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2"><times id="Sx3.I3.i2.p1.1.m1.2.2.2.2.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.2"></times><apply id="Sx3.I3.i2.p1.1.m1.2.2.2.3.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="Sx3.I3.i2.p1.1.m1.2.2.2.3.1.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="Sx3.I3.i2.p1.1.m1.2.2.2.3.2.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3.2">𝑝</ci><ci id="Sx3.I3.i2.p1.1.m1.2.2.2.3.3.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.3.3">𝑗</ci></apply><apply id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1"><csymbol cd="latexml" id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.2.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.3.cmml" xref="Sx3.I3.i2.p1.1.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I3.i2.p1.1.m1.2c">p_{i}(y|x)\neq p_{j}(y|x)</annotation></semantics></math>;</p>
</div>
</li>
<li id="Sx3.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx3.I3.i3.p1" class="ltx_para">
<p id="Sx3.I3.i3.p1.1" class="ltx_p"><span id="Sx3.I3.i3.p1.1.1" class="ltx_text ltx_font_italic">Label skew</span>, when <math id="Sx3.I3.i3.p1.1.m1.2" class="ltx_Math" alttext="p_{i}(y)\neq p_{j}(y)" display="inline"><semantics id="Sx3.I3.i3.p1.1.m1.2a"><mrow id="Sx3.I3.i3.p1.1.m1.2.3" xref="Sx3.I3.i3.p1.1.m1.2.3.cmml"><mrow id="Sx3.I3.i3.p1.1.m1.2.3.2" xref="Sx3.I3.i3.p1.1.m1.2.3.2.cmml"><msub id="Sx3.I3.i3.p1.1.m1.2.3.2.2" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2.cmml"><mi id="Sx3.I3.i3.p1.1.m1.2.3.2.2.2" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2.2.cmml">p</mi><mi id="Sx3.I3.i3.p1.1.m1.2.3.2.2.3" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i3.p1.1.m1.2.3.2.1" xref="Sx3.I3.i3.p1.1.m1.2.3.2.1.cmml">​</mo><mrow id="Sx3.I3.i3.p1.1.m1.2.3.2.3.2" xref="Sx3.I3.i3.p1.1.m1.2.3.2.cmml"><mo stretchy="false" id="Sx3.I3.i3.p1.1.m1.2.3.2.3.2.1" xref="Sx3.I3.i3.p1.1.m1.2.3.2.cmml">(</mo><mi id="Sx3.I3.i3.p1.1.m1.1.1" xref="Sx3.I3.i3.p1.1.m1.1.1.cmml">y</mi><mo stretchy="false" id="Sx3.I3.i3.p1.1.m1.2.3.2.3.2.2" xref="Sx3.I3.i3.p1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="Sx3.I3.i3.p1.1.m1.2.3.1" xref="Sx3.I3.i3.p1.1.m1.2.3.1.cmml">≠</mo><mrow id="Sx3.I3.i3.p1.1.m1.2.3.3" xref="Sx3.I3.i3.p1.1.m1.2.3.3.cmml"><msub id="Sx3.I3.i3.p1.1.m1.2.3.3.2" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2.cmml"><mi id="Sx3.I3.i3.p1.1.m1.2.3.3.2.2" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2.2.cmml">p</mi><mi id="Sx3.I3.i3.p1.1.m1.2.3.3.2.3" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i3.p1.1.m1.2.3.3.1" xref="Sx3.I3.i3.p1.1.m1.2.3.3.1.cmml">​</mo><mrow id="Sx3.I3.i3.p1.1.m1.2.3.3.3.2" xref="Sx3.I3.i3.p1.1.m1.2.3.3.cmml"><mo stretchy="false" id="Sx3.I3.i3.p1.1.m1.2.3.3.3.2.1" xref="Sx3.I3.i3.p1.1.m1.2.3.3.cmml">(</mo><mi id="Sx3.I3.i3.p1.1.m1.2.2" xref="Sx3.I3.i3.p1.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="Sx3.I3.i3.p1.1.m1.2.3.3.3.2.2" xref="Sx3.I3.i3.p1.1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I3.i3.p1.1.m1.2b"><apply id="Sx3.I3.i3.p1.1.m1.2.3.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3"><neq id="Sx3.I3.i3.p1.1.m1.2.3.1.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.1"></neq><apply id="Sx3.I3.i3.p1.1.m1.2.3.2.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.2"><times id="Sx3.I3.i3.p1.1.m1.2.3.2.1.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.2.1"></times><apply id="Sx3.I3.i3.p1.1.m1.2.3.2.2.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2"><csymbol cd="ambiguous" id="Sx3.I3.i3.p1.1.m1.2.3.2.2.1.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2">subscript</csymbol><ci id="Sx3.I3.i3.p1.1.m1.2.3.2.2.2.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2.2">𝑝</ci><ci id="Sx3.I3.i3.p1.1.m1.2.3.2.2.3.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.2.2.3">𝑖</ci></apply><ci id="Sx3.I3.i3.p1.1.m1.1.1.cmml" xref="Sx3.I3.i3.p1.1.m1.1.1">𝑦</ci></apply><apply id="Sx3.I3.i3.p1.1.m1.2.3.3.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.3"><times id="Sx3.I3.i3.p1.1.m1.2.3.3.1.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.3.1"></times><apply id="Sx3.I3.i3.p1.1.m1.2.3.3.2.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="Sx3.I3.i3.p1.1.m1.2.3.3.2.1.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2">subscript</csymbol><ci id="Sx3.I3.i3.p1.1.m1.2.3.3.2.2.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2.2">𝑝</ci><ci id="Sx3.I3.i3.p1.1.m1.2.3.3.2.3.cmml" xref="Sx3.I3.i3.p1.1.m1.2.3.3.2.3">𝑗</ci></apply><ci id="Sx3.I3.i3.p1.1.m1.2.2.cmml" xref="Sx3.I3.i3.p1.1.m1.2.2">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I3.i3.p1.1.m1.2c">p_{i}(y)\neq p_{j}(y)</annotation></semantics></math>;</p>
</div>
</li>
<li id="Sx3.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx3.I3.i4.p1" class="ltx_para">
<p id="Sx3.I3.i4.p1.1" class="ltx_p"><span id="Sx3.I3.i4.p1.1.1" class="ltx_text ltx_font_italic">Feature skew</span>, when <math id="Sx3.I3.i4.p1.1.m1.2" class="ltx_Math" alttext="p_{i}(x)\neq p_{j}(x)" display="inline"><semantics id="Sx3.I3.i4.p1.1.m1.2a"><mrow id="Sx3.I3.i4.p1.1.m1.2.3" xref="Sx3.I3.i4.p1.1.m1.2.3.cmml"><mrow id="Sx3.I3.i4.p1.1.m1.2.3.2" xref="Sx3.I3.i4.p1.1.m1.2.3.2.cmml"><msub id="Sx3.I3.i4.p1.1.m1.2.3.2.2" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2.cmml"><mi id="Sx3.I3.i4.p1.1.m1.2.3.2.2.2" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2.2.cmml">p</mi><mi id="Sx3.I3.i4.p1.1.m1.2.3.2.2.3" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i4.p1.1.m1.2.3.2.1" xref="Sx3.I3.i4.p1.1.m1.2.3.2.1.cmml">​</mo><mrow id="Sx3.I3.i4.p1.1.m1.2.3.2.3.2" xref="Sx3.I3.i4.p1.1.m1.2.3.2.cmml"><mo stretchy="false" id="Sx3.I3.i4.p1.1.m1.2.3.2.3.2.1" xref="Sx3.I3.i4.p1.1.m1.2.3.2.cmml">(</mo><mi id="Sx3.I3.i4.p1.1.m1.1.1" xref="Sx3.I3.i4.p1.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="Sx3.I3.i4.p1.1.m1.2.3.2.3.2.2" xref="Sx3.I3.i4.p1.1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="Sx3.I3.i4.p1.1.m1.2.3.1" xref="Sx3.I3.i4.p1.1.m1.2.3.1.cmml">≠</mo><mrow id="Sx3.I3.i4.p1.1.m1.2.3.3" xref="Sx3.I3.i4.p1.1.m1.2.3.3.cmml"><msub id="Sx3.I3.i4.p1.1.m1.2.3.3.2" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2.cmml"><mi id="Sx3.I3.i4.p1.1.m1.2.3.3.2.2" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2.2.cmml">p</mi><mi id="Sx3.I3.i4.p1.1.m1.2.3.3.2.3" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.I3.i4.p1.1.m1.2.3.3.1" xref="Sx3.I3.i4.p1.1.m1.2.3.3.1.cmml">​</mo><mrow id="Sx3.I3.i4.p1.1.m1.2.3.3.3.2" xref="Sx3.I3.i4.p1.1.m1.2.3.3.cmml"><mo stretchy="false" id="Sx3.I3.i4.p1.1.m1.2.3.3.3.2.1" xref="Sx3.I3.i4.p1.1.m1.2.3.3.cmml">(</mo><mi id="Sx3.I3.i4.p1.1.m1.2.2" xref="Sx3.I3.i4.p1.1.m1.2.2.cmml">x</mi><mo stretchy="false" id="Sx3.I3.i4.p1.1.m1.2.3.3.3.2.2" xref="Sx3.I3.i4.p1.1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.I3.i4.p1.1.m1.2b"><apply id="Sx3.I3.i4.p1.1.m1.2.3.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3"><neq id="Sx3.I3.i4.p1.1.m1.2.3.1.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.1"></neq><apply id="Sx3.I3.i4.p1.1.m1.2.3.2.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.2"><times id="Sx3.I3.i4.p1.1.m1.2.3.2.1.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.2.1"></times><apply id="Sx3.I3.i4.p1.1.m1.2.3.2.2.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2"><csymbol cd="ambiguous" id="Sx3.I3.i4.p1.1.m1.2.3.2.2.1.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2">subscript</csymbol><ci id="Sx3.I3.i4.p1.1.m1.2.3.2.2.2.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2.2">𝑝</ci><ci id="Sx3.I3.i4.p1.1.m1.2.3.2.2.3.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.2.2.3">𝑖</ci></apply><ci id="Sx3.I3.i4.p1.1.m1.1.1.cmml" xref="Sx3.I3.i4.p1.1.m1.1.1">𝑥</ci></apply><apply id="Sx3.I3.i4.p1.1.m1.2.3.3.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.3"><times id="Sx3.I3.i4.p1.1.m1.2.3.3.1.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.3.1"></times><apply id="Sx3.I3.i4.p1.1.m1.2.3.3.2.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="Sx3.I3.i4.p1.1.m1.2.3.3.2.1.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2">subscript</csymbol><ci id="Sx3.I3.i4.p1.1.m1.2.3.3.2.2.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2.2">𝑝</ci><ci id="Sx3.I3.i4.p1.1.m1.2.3.3.2.3.cmml" xref="Sx3.I3.i4.p1.1.m1.2.3.3.2.3">𝑗</ci></apply><ci id="Sx3.I3.i4.p1.1.m1.2.2.cmml" xref="Sx3.I3.i4.p1.1.m1.2.2">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.I3.i4.p1.1.m1.2c">p_{i}(x)\neq p_{j}(x)</annotation></semantics></math>;</p>
</div>
</li>
</ul>
</div>
<div id="Sx3.p6" class="ltx_para">
<p id="Sx3.p6.6" class="ltx_p">The complexity of DGPs prevents their straightforward use in client clustering. Thus, we introduce the notion of <span id="Sx3.p6.6.1" class="ltx_text ltx_font_italic">client embedding</span> <math id="Sx3.p6.1.m1.1" class="ltx_Math" alttext="e_{i}=F(\gamma_{i})" display="inline"><semantics id="Sx3.p6.1.m1.1a"><mrow id="Sx3.p6.1.m1.1.1" xref="Sx3.p6.1.m1.1.1.cmml"><msub id="Sx3.p6.1.m1.1.1.3" xref="Sx3.p6.1.m1.1.1.3.cmml"><mi id="Sx3.p6.1.m1.1.1.3.2" xref="Sx3.p6.1.m1.1.1.3.2.cmml">e</mi><mi id="Sx3.p6.1.m1.1.1.3.3" xref="Sx3.p6.1.m1.1.1.3.3.cmml">i</mi></msub><mo id="Sx3.p6.1.m1.1.1.2" xref="Sx3.p6.1.m1.1.1.2.cmml">=</mo><mrow id="Sx3.p6.1.m1.1.1.1" xref="Sx3.p6.1.m1.1.1.1.cmml"><mi id="Sx3.p6.1.m1.1.1.1.3" xref="Sx3.p6.1.m1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="Sx3.p6.1.m1.1.1.1.2" xref="Sx3.p6.1.m1.1.1.1.2.cmml">​</mo><mrow id="Sx3.p6.1.m1.1.1.1.1.1" xref="Sx3.p6.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.p6.1.m1.1.1.1.1.1.2" xref="Sx3.p6.1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.p6.1.m1.1.1.1.1.1.1" xref="Sx3.p6.1.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.p6.1.m1.1.1.1.1.1.1.2" xref="Sx3.p6.1.m1.1.1.1.1.1.1.2.cmml">γ</mi><mi id="Sx3.p6.1.m1.1.1.1.1.1.1.3" xref="Sx3.p6.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.p6.1.m1.1.1.1.1.1.3" xref="Sx3.p6.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p6.1.m1.1b"><apply id="Sx3.p6.1.m1.1.1.cmml" xref="Sx3.p6.1.m1.1.1"><eq id="Sx3.p6.1.m1.1.1.2.cmml" xref="Sx3.p6.1.m1.1.1.2"></eq><apply id="Sx3.p6.1.m1.1.1.3.cmml" xref="Sx3.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.p6.1.m1.1.1.3.1.cmml" xref="Sx3.p6.1.m1.1.1.3">subscript</csymbol><ci id="Sx3.p6.1.m1.1.1.3.2.cmml" xref="Sx3.p6.1.m1.1.1.3.2">𝑒</ci><ci id="Sx3.p6.1.m1.1.1.3.3.cmml" xref="Sx3.p6.1.m1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.p6.1.m1.1.1.1.cmml" xref="Sx3.p6.1.m1.1.1.1"><times id="Sx3.p6.1.m1.1.1.1.2.cmml" xref="Sx3.p6.1.m1.1.1.1.2"></times><ci id="Sx3.p6.1.m1.1.1.1.3.cmml" xref="Sx3.p6.1.m1.1.1.1.3">𝐹</ci><apply id="Sx3.p6.1.m1.1.1.1.1.1.1.cmml" xref="Sx3.p6.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.p6.1.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.p6.1.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.p6.1.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.p6.1.m1.1.1.1.1.1.1.2">𝛾</ci><ci id="Sx3.p6.1.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.p6.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p6.1.m1.1c">e_{i}=F(\gamma_{i})</annotation></semantics></math>, a semantically rich vector that summarizes the properties of a client <math id="Sx3.p6.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.p6.2.m2.1a"><mi id="Sx3.p6.2.m2.1.1" xref="Sx3.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.p6.2.m2.1b"><ci id="Sx3.p6.2.m2.1.1.cmml" xref="Sx3.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p6.2.m2.1c">i</annotation></semantics></math>’s DGP <math id="Sx3.p6.3.m3.1" class="ltx_Math" alttext="\gamma_{i}" display="inline"><semantics id="Sx3.p6.3.m3.1a"><msub id="Sx3.p6.3.m3.1.1" xref="Sx3.p6.3.m3.1.1.cmml"><mi id="Sx3.p6.3.m3.1.1.2" xref="Sx3.p6.3.m3.1.1.2.cmml">γ</mi><mi id="Sx3.p6.3.m3.1.1.3" xref="Sx3.p6.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p6.3.m3.1b"><apply id="Sx3.p6.3.m3.1.1.cmml" xref="Sx3.p6.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.p6.3.m3.1.1.1.cmml" xref="Sx3.p6.3.m3.1.1">subscript</csymbol><ci id="Sx3.p6.3.m3.1.1.2.cmml" xref="Sx3.p6.3.m3.1.1.2">𝛾</ci><ci id="Sx3.p6.3.m3.1.1.3.cmml" xref="Sx3.p6.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p6.3.m3.1c">\gamma_{i}</annotation></semantics></math>. Since these properties often remain unknown, clients need to compute their embeddings by leveraging solely their local dataset <math id="Sx3.p6.4.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx3.p6.4.m4.1a"><msub id="Sx3.p6.4.m4.1.1" xref="Sx3.p6.4.m4.1.1.cmml"><mi id="Sx3.p6.4.m4.1.1.2" xref="Sx3.p6.4.m4.1.1.2.cmml">D</mi><mi id="Sx3.p6.4.m4.1.1.3" xref="Sx3.p6.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p6.4.m4.1b"><apply id="Sx3.p6.4.m4.1.1.cmml" xref="Sx3.p6.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.p6.4.m4.1.1.1.cmml" xref="Sx3.p6.4.m4.1.1">subscript</csymbol><ci id="Sx3.p6.4.m4.1.1.2.cmml" xref="Sx3.p6.4.m4.1.1.2">𝐷</ci><ci id="Sx3.p6.4.m4.1.1.3.cmml" xref="Sx3.p6.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p6.4.m4.1c">D_{i}</annotation></semantics></math>, the data sent from the server <math id="Sx3.p6.5.m5.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Sx3.p6.5.m5.1a"><mi id="Sx3.p6.5.m5.1.1" xref="Sx3.p6.5.m5.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx3.p6.5.m5.1b"><ci id="Sx3.p6.5.m5.1.1.cmml" xref="Sx3.p6.5.m5.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p6.5.m5.1c">S</annotation></semantics></math>, and possibly other contextual information <math id="Sx3.p6.6.m6.1" class="ltx_Math" alttext="\kappa_{i}" display="inline"><semantics id="Sx3.p6.6.m6.1a"><msub id="Sx3.p6.6.m6.1.1" xref="Sx3.p6.6.m6.1.1.cmml"><mi id="Sx3.p6.6.m6.1.1.2" xref="Sx3.p6.6.m6.1.1.2.cmml">κ</mi><mi id="Sx3.p6.6.m6.1.1.3" xref="Sx3.p6.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p6.6.m6.1b"><apply id="Sx3.p6.6.m6.1.1.cmml" xref="Sx3.p6.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.p6.6.m6.1.1.1.cmml" xref="Sx3.p6.6.m6.1.1">subscript</csymbol><ci id="Sx3.p6.6.m6.1.1.2.cmml" xref="Sx3.p6.6.m6.1.1.2">𝜅</ci><ci id="Sx3.p6.6.m6.1.1.3.cmml" xref="Sx3.p6.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p6.6.m6.1c">\kappa_{i}</annotation></semantics></math> they have at their disposal:</p>
</div>
<div id="Sx3.p7" class="ltx_para">
<table id="Sx6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E2.m1.4" class="ltx_Math" alttext="\displaystyle e_{i}=F(\gamma_{i})\approx f(D_{i},S,\kappa_{i})" display="inline"><semantics id="Sx3.E2.m1.4a"><mrow id="Sx3.E2.m1.4.4" xref="Sx3.E2.m1.4.4.cmml"><msub id="Sx3.E2.m1.4.4.5" xref="Sx3.E2.m1.4.4.5.cmml"><mi id="Sx3.E2.m1.4.4.5.2" xref="Sx3.E2.m1.4.4.5.2.cmml">e</mi><mi id="Sx3.E2.m1.4.4.5.3" xref="Sx3.E2.m1.4.4.5.3.cmml">i</mi></msub><mo id="Sx3.E2.m1.4.4.6" xref="Sx3.E2.m1.4.4.6.cmml">=</mo><mrow id="Sx3.E2.m1.2.2.1" xref="Sx3.E2.m1.2.2.1.cmml"><mi id="Sx3.E2.m1.2.2.1.3" xref="Sx3.E2.m1.2.2.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.2.2.1.2" xref="Sx3.E2.m1.2.2.1.2.cmml">​</mo><mrow id="Sx3.E2.m1.2.2.1.1.1" xref="Sx3.E2.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m1.2.2.1.1.1.2" xref="Sx3.E2.m1.2.2.1.1.1.1.cmml">(</mo><msub id="Sx3.E2.m1.2.2.1.1.1.1" xref="Sx3.E2.m1.2.2.1.1.1.1.cmml"><mi id="Sx3.E2.m1.2.2.1.1.1.1.2" xref="Sx3.E2.m1.2.2.1.1.1.1.2.cmml">γ</mi><mi id="Sx3.E2.m1.2.2.1.1.1.1.3" xref="Sx3.E2.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E2.m1.2.2.1.1.1.3" xref="Sx3.E2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E2.m1.4.4.7" xref="Sx3.E2.m1.4.4.7.cmml">≈</mo><mrow id="Sx3.E2.m1.4.4.3" xref="Sx3.E2.m1.4.4.3.cmml"><mi id="Sx3.E2.m1.4.4.3.4" xref="Sx3.E2.m1.4.4.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.4.4.3.3" xref="Sx3.E2.m1.4.4.3.3.cmml">​</mo><mrow id="Sx3.E2.m1.4.4.3.2.2" xref="Sx3.E2.m1.4.4.3.2.3.cmml"><mo stretchy="false" id="Sx3.E2.m1.4.4.3.2.2.3" xref="Sx3.E2.m1.4.4.3.2.3.cmml">(</mo><msub id="Sx3.E2.m1.3.3.2.1.1.1" xref="Sx3.E2.m1.3.3.2.1.1.1.cmml"><mi id="Sx3.E2.m1.3.3.2.1.1.1.2" xref="Sx3.E2.m1.3.3.2.1.1.1.2.cmml">D</mi><mi id="Sx3.E2.m1.3.3.2.1.1.1.3" xref="Sx3.E2.m1.3.3.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E2.m1.4.4.3.2.2.4" xref="Sx3.E2.m1.4.4.3.2.3.cmml">,</mo><mi id="Sx3.E2.m1.1.1" xref="Sx3.E2.m1.1.1.cmml">S</mi><mo id="Sx3.E2.m1.4.4.3.2.2.5" xref="Sx3.E2.m1.4.4.3.2.3.cmml">,</mo><msub id="Sx3.E2.m1.4.4.3.2.2.2" xref="Sx3.E2.m1.4.4.3.2.2.2.cmml"><mi id="Sx3.E2.m1.4.4.3.2.2.2.2" xref="Sx3.E2.m1.4.4.3.2.2.2.2.cmml">κ</mi><mi id="Sx3.E2.m1.4.4.3.2.2.2.3" xref="Sx3.E2.m1.4.4.3.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E2.m1.4.4.3.2.2.6" xref="Sx3.E2.m1.4.4.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.4b"><apply id="Sx3.E2.m1.4.4.cmml" xref="Sx3.E2.m1.4.4"><and id="Sx3.E2.m1.4.4a.cmml" xref="Sx3.E2.m1.4.4"></and><apply id="Sx3.E2.m1.4.4b.cmml" xref="Sx3.E2.m1.4.4"><eq id="Sx3.E2.m1.4.4.6.cmml" xref="Sx3.E2.m1.4.4.6"></eq><apply id="Sx3.E2.m1.4.4.5.cmml" xref="Sx3.E2.m1.4.4.5"><csymbol cd="ambiguous" id="Sx3.E2.m1.4.4.5.1.cmml" xref="Sx3.E2.m1.4.4.5">subscript</csymbol><ci id="Sx3.E2.m1.4.4.5.2.cmml" xref="Sx3.E2.m1.4.4.5.2">𝑒</ci><ci id="Sx3.E2.m1.4.4.5.3.cmml" xref="Sx3.E2.m1.4.4.5.3">𝑖</ci></apply><apply id="Sx3.E2.m1.2.2.1.cmml" xref="Sx3.E2.m1.2.2.1"><times id="Sx3.E2.m1.2.2.1.2.cmml" xref="Sx3.E2.m1.2.2.1.2"></times><ci id="Sx3.E2.m1.2.2.1.3.cmml" xref="Sx3.E2.m1.2.2.1.3">𝐹</ci><apply id="Sx3.E2.m1.2.2.1.1.1.1.cmml" xref="Sx3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.2.2.1.1.1.1.2.cmml" xref="Sx3.E2.m1.2.2.1.1.1.1.2">𝛾</ci><ci id="Sx3.E2.m1.2.2.1.1.1.1.3.cmml" xref="Sx3.E2.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E2.m1.4.4c.cmml" xref="Sx3.E2.m1.4.4"><approx id="Sx3.E2.m1.4.4.7.cmml" xref="Sx3.E2.m1.4.4.7"></approx><share href="#Sx3.E2.m1.2.2.1.cmml" id="Sx3.E2.m1.4.4d.cmml" xref="Sx3.E2.m1.4.4"></share><apply id="Sx3.E2.m1.4.4.3.cmml" xref="Sx3.E2.m1.4.4.3"><times id="Sx3.E2.m1.4.4.3.3.cmml" xref="Sx3.E2.m1.4.4.3.3"></times><ci id="Sx3.E2.m1.4.4.3.4.cmml" xref="Sx3.E2.m1.4.4.3.4">𝑓</ci><vector id="Sx3.E2.m1.4.4.3.2.3.cmml" xref="Sx3.E2.m1.4.4.3.2.2"><apply id="Sx3.E2.m1.3.3.2.1.1.1.cmml" xref="Sx3.E2.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.3.3.2.1.1.1.1.cmml" xref="Sx3.E2.m1.3.3.2.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.3.3.2.1.1.1.2.cmml" xref="Sx3.E2.m1.3.3.2.1.1.1.2">𝐷</ci><ci id="Sx3.E2.m1.3.3.2.1.1.1.3.cmml" xref="Sx3.E2.m1.3.3.2.1.1.1.3">𝑖</ci></apply><ci id="Sx3.E2.m1.1.1.cmml" xref="Sx3.E2.m1.1.1">𝑆</ci><apply id="Sx3.E2.m1.4.4.3.2.2.2.cmml" xref="Sx3.E2.m1.4.4.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.E2.m1.4.4.3.2.2.2.1.cmml" xref="Sx3.E2.m1.4.4.3.2.2.2">subscript</csymbol><ci id="Sx3.E2.m1.4.4.3.2.2.2.2.cmml" xref="Sx3.E2.m1.4.4.3.2.2.2.2">𝜅</ci><ci id="Sx3.E2.m1.4.4.3.2.2.2.3.cmml" xref="Sx3.E2.m1.4.4.3.2.2.2.3">𝑖</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.4c">\displaystyle e_{i}=F(\gamma_{i})\approx f(D_{i},S,\kappa_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.p8" class="ltx_para">
<p id="Sx3.p8.1" class="ltx_p">The goal of clustering is to assign clients with similar DGPs to the same cluster so that a personalized model can be grown within each cluster. The clustering can be performed directly on embeddings, as these embeddings reflect the DGPs. Since holdout clients may request the model after the training has been completed, the algorithm used for clustering must be able to handle embeddings that were not seen during the training. Thus, the K-Means clustering algorithm <cite class="ltx_cite ltx_citemacro_citep">(Lloyd <a href="#bib.bib13" title="" class="ltx_ref">1982</a>)</cite> is a viable choice, while DBSCAN <cite class="ltx_cite ltx_citemacro_citep">(Ester et al. <a href="#bib.bib6" title="" class="ltx_ref">1996</a>)</cite> is not.</p>
</div>
<div id="Sx3.p9" class="ltx_para">
<p id="Sx3.p9.3" class="ltx_p">To summarize, by clustering the clients we transform the training task from training a single model <math id="Sx3.p9.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.p9.1.m1.1a"><mi id="Sx3.p9.1.m1.1.1" xref="Sx3.p9.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.p9.1.m1.1b"><ci id="Sx3.p9.1.m1.1.1.cmml" xref="Sx3.p9.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p9.1.m1.1c">\theta</annotation></semantics></math> in conditions of data heterogeneity to the training of multiple models <math id="Sx3.p9.2.m2.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="Sx3.p9.2.m2.1a"><msub id="Sx3.p9.2.m2.1.1" xref="Sx3.p9.2.m2.1.1.cmml"><mi id="Sx3.p9.2.m2.1.1.2" xref="Sx3.p9.2.m2.1.1.2.cmml">θ</mi><mi id="Sx3.p9.2.m2.1.1.3" xref="Sx3.p9.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p9.2.m2.1b"><apply id="Sx3.p9.2.m2.1.1.cmml" xref="Sx3.p9.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.p9.2.m2.1.1.1.cmml" xref="Sx3.p9.2.m2.1.1">subscript</csymbol><ci id="Sx3.p9.2.m2.1.1.2.cmml" xref="Sx3.p9.2.m2.1.1.2">𝜃</ci><ci id="Sx3.p9.2.m2.1.1.3.cmml" xref="Sx3.p9.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p9.2.m2.1c">\theta_{k}</annotation></semantics></math>, each in a more homogeneous environment. Consequently, instead of minimizing the loss of a single global model across all clients, the training task boils down to training one model <math id="Sx3.p9.3.m3.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="Sx3.p9.3.m3.1a"><msub id="Sx3.p9.3.m3.1.1" xref="Sx3.p9.3.m3.1.1.cmml"><mi id="Sx3.p9.3.m3.1.1.2" xref="Sx3.p9.3.m3.1.1.2.cmml">θ</mi><mi id="Sx3.p9.3.m3.1.1.3" xref="Sx3.p9.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p9.3.m3.1b"><apply id="Sx3.p9.3.m3.1.1.cmml" xref="Sx3.p9.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.p9.3.m3.1.1.1.cmml" xref="Sx3.p9.3.m3.1.1">subscript</csymbol><ci id="Sx3.p9.3.m3.1.1.2.cmml" xref="Sx3.p9.3.m3.1.1.2">𝜃</ci><ci id="Sx3.p9.3.m3.1.1.3.cmml" xref="Sx3.p9.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p9.3.m3.1c">\theta_{k}</annotation></semantics></math> for every cluster of clients:</p>
</div>
<div id="Sx3.p10" class="ltx_para">
<table id="Sx6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E3.m1.5" class="ltx_Math" alttext="\displaystyle\theta_{k}^{*}=\arg\min_{\theta\in\mathbb{R}^{d}}\,\,\frac{1}{\sum_{i\in C}\mathds{1}_{\alpha(i)=k}}\sum_{i=1}^{|C|}\mathds{1}_{\alpha(i)=k}\cdot L_{i}(\theta)," display="inline"><semantics id="Sx3.E3.m1.5a"><mrow id="Sx3.E3.m1.5.5.1" xref="Sx3.E3.m1.5.5.1.1.cmml"><mrow id="Sx3.E3.m1.5.5.1.1" xref="Sx3.E3.m1.5.5.1.1.cmml"><msubsup id="Sx3.E3.m1.5.5.1.1.2" xref="Sx3.E3.m1.5.5.1.1.2.cmml"><mi id="Sx3.E3.m1.5.5.1.1.2.2.2" xref="Sx3.E3.m1.5.5.1.1.2.2.2.cmml">θ</mi><mi id="Sx3.E3.m1.5.5.1.1.2.2.3" xref="Sx3.E3.m1.5.5.1.1.2.2.3.cmml">k</mi><mo id="Sx3.E3.m1.5.5.1.1.2.3" xref="Sx3.E3.m1.5.5.1.1.2.3.cmml">∗</mo></msubsup><mo id="Sx3.E3.m1.5.5.1.1.1" xref="Sx3.E3.m1.5.5.1.1.1.cmml">=</mo><mrow id="Sx3.E3.m1.5.5.1.1.3" xref="Sx3.E3.m1.5.5.1.1.3.cmml"><mrow id="Sx3.E3.m1.5.5.1.1.3.2" xref="Sx3.E3.m1.5.5.1.1.3.2.cmml"><mi id="Sx3.E3.m1.5.5.1.1.3.2.1" xref="Sx3.E3.m1.5.5.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="Sx3.E3.m1.5.5.1.1.3.2a" xref="Sx3.E3.m1.5.5.1.1.3.2.cmml">⁡</mo><mrow id="Sx3.E3.m1.5.5.1.1.3.2.2" xref="Sx3.E3.m1.5.5.1.1.3.2.2.cmml"><munder id="Sx3.E3.m1.5.5.1.1.3.2.2.1" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.cmml"><mi id="Sx3.E3.m1.5.5.1.1.3.2.2.1.2" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.2.cmml">min</mi><mrow id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.cmml"><mi id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.2" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.2.cmml">θ</mi><mo id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.1" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.1.cmml">∈</mo><msup id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.cmml"><mi id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.2" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.2.cmml">ℝ</mi><mi id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.3" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.3.cmml">d</mi></msup></mrow></munder><mo lspace="0.167em" id="Sx3.E3.m1.5.5.1.1.3.2.2a" xref="Sx3.E3.m1.5.5.1.1.3.2.2.cmml">⁡</mo><mstyle displaystyle="true" id="Sx3.E3.m1.1.1" xref="Sx3.E3.m1.1.1.cmml"><mfrac id="Sx3.E3.m1.1.1a" xref="Sx3.E3.m1.1.1.cmml"><mn id="Sx3.E3.m1.1.1.3" xref="Sx3.E3.m1.1.1.3.cmml">1</mn><mrow id="Sx3.E3.m1.1.1.1" xref="Sx3.E3.m1.1.1.1.cmml"><msub id="Sx3.E3.m1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.2.cmml"><mo id="Sx3.E3.m1.1.1.1.2.2" xref="Sx3.E3.m1.1.1.1.2.2.cmml">∑</mo><mrow id="Sx3.E3.m1.1.1.1.2.3" xref="Sx3.E3.m1.1.1.1.2.3.cmml"><mi id="Sx3.E3.m1.1.1.1.2.3.2" xref="Sx3.E3.m1.1.1.1.2.3.2.cmml">i</mi><mo id="Sx3.E3.m1.1.1.1.2.3.1" xref="Sx3.E3.m1.1.1.1.2.3.1.cmml">∈</mo><mi id="Sx3.E3.m1.1.1.1.2.3.3" xref="Sx3.E3.m1.1.1.1.2.3.3.cmml">C</mi></mrow></msub><msub id="Sx3.E3.m1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.3.cmml"><mn id="Sx3.E3.m1.1.1.1.3.2" xref="Sx3.E3.m1.1.1.1.3.2.cmml">𝟙</mn><mrow id="Sx3.E3.m1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.1.3.cmml"><mi id="Sx3.E3.m1.1.1.1.1.1.3.2" xref="Sx3.E3.m1.1.1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.1.3.1" xref="Sx3.E3.m1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="Sx3.E3.m1.1.1.1.1.1.3.3.2" xref="Sx3.E3.m1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.1.3.3.2.1" xref="Sx3.E3.m1.1.1.1.1.1.3.cmml">(</mo><mi id="Sx3.E3.m1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.1.3.3.2.2" xref="Sx3.E3.m1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E3.m1.1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.1.2.cmml">=</mo><mi id="Sx3.E3.m1.1.1.1.1.1.4" xref="Sx3.E3.m1.1.1.1.1.1.4.cmml">k</mi></mrow></msub></mrow></mfrac></mstyle></mrow></mrow><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.5.5.1.1.3.1" xref="Sx3.E3.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="Sx3.E3.m1.5.5.1.1.3.3" xref="Sx3.E3.m1.5.5.1.1.3.3.cmml"><mstyle displaystyle="true" id="Sx3.E3.m1.5.5.1.1.3.3.1" xref="Sx3.E3.m1.5.5.1.1.3.3.1.cmml"><munderover id="Sx3.E3.m1.5.5.1.1.3.3.1a" xref="Sx3.E3.m1.5.5.1.1.3.3.1.cmml"><mo movablelimits="false" id="Sx3.E3.m1.5.5.1.1.3.3.1.2.2" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.cmml"><mi id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.2" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.1" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.3" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mrow id="Sx3.E3.m1.2.2.1.3" xref="Sx3.E3.m1.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.E3.m1.2.2.1.3.1" xref="Sx3.E3.m1.2.2.1.2.1.cmml">|</mo><mi id="Sx3.E3.m1.2.2.1.1" xref="Sx3.E3.m1.2.2.1.1.cmml">C</mi><mo stretchy="false" id="Sx3.E3.m1.2.2.1.3.2" xref="Sx3.E3.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="Sx3.E3.m1.5.5.1.1.3.3.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.cmml"><mrow id="Sx3.E3.m1.5.5.1.1.3.3.2.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.cmml"><msub id="Sx3.E3.m1.5.5.1.1.3.3.2.2.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.cmml"><mn id="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.2.cmml">𝟙</mn><mrow id="Sx3.E3.m1.3.3.1" xref="Sx3.E3.m1.3.3.1.cmml"><mrow id="Sx3.E3.m1.3.3.1.3" xref="Sx3.E3.m1.3.3.1.3.cmml"><mi id="Sx3.E3.m1.3.3.1.3.2" xref="Sx3.E3.m1.3.3.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.3.3.1.3.1" xref="Sx3.E3.m1.3.3.1.3.1.cmml">​</mo><mrow id="Sx3.E3.m1.3.3.1.3.3.2" xref="Sx3.E3.m1.3.3.1.3.cmml"><mo stretchy="false" id="Sx3.E3.m1.3.3.1.3.3.2.1" xref="Sx3.E3.m1.3.3.1.3.cmml">(</mo><mi id="Sx3.E3.m1.3.3.1.1" xref="Sx3.E3.m1.3.3.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.E3.m1.3.3.1.3.3.2.2" xref="Sx3.E3.m1.3.3.1.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E3.m1.3.3.1.2" xref="Sx3.E3.m1.3.3.1.2.cmml">=</mo><mi id="Sx3.E3.m1.3.3.1.4" xref="Sx3.E3.m1.3.3.1.4.cmml">k</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="Sx3.E3.m1.5.5.1.1.3.3.2.2.1" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.1.cmml">⋅</mo><msub id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.cmml"><mi id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.2.cmml">L</mi><mi id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.3" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.5.5.1.1.3.3.2.1" xref="Sx3.E3.m1.5.5.1.1.3.3.2.1.cmml">​</mo><mrow id="Sx3.E3.m1.5.5.1.1.3.3.2.3.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.cmml"><mo stretchy="false" id="Sx3.E3.m1.5.5.1.1.3.3.2.3.2.1" xref="Sx3.E3.m1.5.5.1.1.3.3.2.cmml">(</mo><mi id="Sx3.E3.m1.4.4" xref="Sx3.E3.m1.4.4.cmml">θ</mi><mo stretchy="false" id="Sx3.E3.m1.5.5.1.1.3.3.2.3.2.2" xref="Sx3.E3.m1.5.5.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="Sx3.E3.m1.5.5.1.2" xref="Sx3.E3.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E3.m1.5b"><apply id="Sx3.E3.m1.5.5.1.1.cmml" xref="Sx3.E3.m1.5.5.1"><eq id="Sx3.E3.m1.5.5.1.1.1.cmml" xref="Sx3.E3.m1.5.5.1.1.1"></eq><apply id="Sx3.E3.m1.5.5.1.1.2.cmml" xref="Sx3.E3.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.2">superscript</csymbol><apply id="Sx3.E3.m1.5.5.1.1.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.2.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.2">subscript</csymbol><ci id="Sx3.E3.m1.5.5.1.1.2.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.2.2.2">𝜃</ci><ci id="Sx3.E3.m1.5.5.1.1.2.2.3.cmml" xref="Sx3.E3.m1.5.5.1.1.2.2.3">𝑘</ci></apply><times id="Sx3.E3.m1.5.5.1.1.2.3.cmml" xref="Sx3.E3.m1.5.5.1.1.2.3"></times></apply><apply id="Sx3.E3.m1.5.5.1.1.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3"><times id="Sx3.E3.m1.5.5.1.1.3.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.1"></times><apply id="Sx3.E3.m1.5.5.1.1.3.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2"><arg id="Sx3.E3.m1.5.5.1.1.3.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.1"></arg><apply id="Sx3.E3.m1.5.5.1.1.3.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2"><apply id="Sx3.E3.m1.5.5.1.1.3.2.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.3.2.2.1.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1">subscript</csymbol><min id="Sx3.E3.m1.5.5.1.1.3.2.2.1.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.2"></min><apply id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3"><in id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.1"></in><ci id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.2">𝜃</ci><apply id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3">superscript</csymbol><ci id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.2">ℝ</ci><ci id="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.2.2.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="Sx3.E3.m1.1.1.cmml" xref="Sx3.E3.m1.1.1"><divide id="Sx3.E3.m1.1.1.2.cmml" xref="Sx3.E3.m1.1.1"></divide><cn type="integer" id="Sx3.E3.m1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.3">1</cn><apply id="Sx3.E3.m1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1"><apply id="Sx3.E3.m1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.1.1.1.2">subscript</csymbol><sum id="Sx3.E3.m1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.1.1.1.2.2"></sum><apply id="Sx3.E3.m1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.1.1.1.2.3"><in id="Sx3.E3.m1.1.1.1.2.3.1.cmml" xref="Sx3.E3.m1.1.1.1.2.3.1"></in><ci id="Sx3.E3.m1.1.1.1.2.3.2.cmml" xref="Sx3.E3.m1.1.1.1.2.3.2">𝑖</ci><ci id="Sx3.E3.m1.1.1.1.2.3.3.cmml" xref="Sx3.E3.m1.1.1.1.2.3.3">𝐶</ci></apply></apply><apply id="Sx3.E3.m1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.1.1.1.3">subscript</csymbol><cn type="integer" id="Sx3.E3.m1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.1.1.1.3.2">1</cn><apply id="Sx3.E3.m1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1"><eq id="Sx3.E3.m1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.2"></eq><apply id="Sx3.E3.m1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.3"><times id="Sx3.E3.m1.1.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.3.1"></times><ci id="Sx3.E3.m1.1.1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.3.2">𝛼</ci><ci id="Sx3.E3.m1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1">𝑖</ci></apply><ci id="Sx3.E3.m1.1.1.1.1.1.4.cmml" xref="Sx3.E3.m1.1.1.1.1.1.4">𝑘</ci></apply></apply></apply></apply></apply></apply><apply id="Sx3.E3.m1.5.5.1.1.3.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3"><apply id="Sx3.E3.m1.5.5.1.1.3.3.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.3.3.1.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1">superscript</csymbol><apply id="Sx3.E3.m1.5.5.1.1.3.3.1.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.3.3.1.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1">subscript</csymbol><sum id="Sx3.E3.m1.5.5.1.1.3.3.1.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.2"></sum><apply id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3"><eq id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.1"></eq><ci id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="Sx3.E3.m1.2.2.1.2.cmml" xref="Sx3.E3.m1.2.2.1.3"><abs id="Sx3.E3.m1.2.2.1.2.1.cmml" xref="Sx3.E3.m1.2.2.1.3.1"></abs><ci id="Sx3.E3.m1.2.2.1.1.cmml" xref="Sx3.E3.m1.2.2.1.1">𝐶</ci></apply></apply><apply id="Sx3.E3.m1.5.5.1.1.3.3.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2"><times id="Sx3.E3.m1.5.5.1.1.3.3.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.1"></times><apply id="Sx3.E3.m1.5.5.1.1.3.3.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2"><ci id="Sx3.E3.m1.5.5.1.1.3.3.2.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.1">⋅</ci><apply id="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.2">subscript</csymbol><cn type="integer" id="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.2.2">1</cn><apply id="Sx3.E3.m1.3.3.1.cmml" xref="Sx3.E3.m1.3.3.1"><eq id="Sx3.E3.m1.3.3.1.2.cmml" xref="Sx3.E3.m1.3.3.1.2"></eq><apply id="Sx3.E3.m1.3.3.1.3.cmml" xref="Sx3.E3.m1.3.3.1.3"><times id="Sx3.E3.m1.3.3.1.3.1.cmml" xref="Sx3.E3.m1.3.3.1.3.1"></times><ci id="Sx3.E3.m1.3.3.1.3.2.cmml" xref="Sx3.E3.m1.3.3.1.3.2">𝛼</ci><ci id="Sx3.E3.m1.3.3.1.1.cmml" xref="Sx3.E3.m1.3.3.1.1">𝑖</ci></apply><ci id="Sx3.E3.m1.3.3.1.4.cmml" xref="Sx3.E3.m1.3.3.1.4">𝑘</ci></apply></apply><apply id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.1.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3">subscript</csymbol><ci id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.2.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.2">𝐿</ci><ci id="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.3.cmml" xref="Sx3.E3.m1.5.5.1.1.3.3.2.2.3.3">𝑖</ci></apply></apply><ci id="Sx3.E3.m1.4.4.cmml" xref="Sx3.E3.m1.4.4">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E3.m1.5c">\displaystyle\theta_{k}^{*}=\arg\min_{\theta\in\mathbb{R}^{d}}\,\,\frac{1}{\sum_{i\in C}\mathds{1}_{\alpha(i)=k}}\sum_{i=1}^{|C|}\mathds{1}_{\alpha(i)=k}\cdot L_{i}(\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.p10.9" class="ltx_p">where <math id="Sx3.p10.1.m1.7" class="ltx_Math" alttext="L_{i}(\theta)=\mathbb{E}_{(x,y)\sim\gamma_{i}}[l(\theta,x;y)]" display="inline"><semantics id="Sx3.p10.1.m1.7a"><mrow id="Sx3.p10.1.m1.7.7" xref="Sx3.p10.1.m1.7.7.cmml"><mrow id="Sx3.p10.1.m1.7.7.3" xref="Sx3.p10.1.m1.7.7.3.cmml"><msub id="Sx3.p10.1.m1.7.7.3.2" xref="Sx3.p10.1.m1.7.7.3.2.cmml"><mi id="Sx3.p10.1.m1.7.7.3.2.2" xref="Sx3.p10.1.m1.7.7.3.2.2.cmml">L</mi><mi id="Sx3.p10.1.m1.7.7.3.2.3" xref="Sx3.p10.1.m1.7.7.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.p10.1.m1.7.7.3.1" xref="Sx3.p10.1.m1.7.7.3.1.cmml">​</mo><mrow id="Sx3.p10.1.m1.7.7.3.3.2" xref="Sx3.p10.1.m1.7.7.3.cmml"><mo stretchy="false" id="Sx3.p10.1.m1.7.7.3.3.2.1" xref="Sx3.p10.1.m1.7.7.3.cmml">(</mo><mi id="Sx3.p10.1.m1.3.3" xref="Sx3.p10.1.m1.3.3.cmml">θ</mi><mo stretchy="false" id="Sx3.p10.1.m1.7.7.3.3.2.2" xref="Sx3.p10.1.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="Sx3.p10.1.m1.7.7.2" xref="Sx3.p10.1.m1.7.7.2.cmml">=</mo><mrow id="Sx3.p10.1.m1.7.7.1" xref="Sx3.p10.1.m1.7.7.1.cmml"><msub id="Sx3.p10.1.m1.7.7.1.3" xref="Sx3.p10.1.m1.7.7.1.3.cmml"><mi id="Sx3.p10.1.m1.7.7.1.3.2" xref="Sx3.p10.1.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="Sx3.p10.1.m1.2.2.2" xref="Sx3.p10.1.m1.2.2.2.cmml"><mrow id="Sx3.p10.1.m1.2.2.2.4.2" xref="Sx3.p10.1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="Sx3.p10.1.m1.2.2.2.4.2.1" xref="Sx3.p10.1.m1.2.2.2.4.1.cmml">(</mo><mi id="Sx3.p10.1.m1.1.1.1.1" xref="Sx3.p10.1.m1.1.1.1.1.cmml">x</mi><mo id="Sx3.p10.1.m1.2.2.2.4.2.2" xref="Sx3.p10.1.m1.2.2.2.4.1.cmml">,</mo><mi id="Sx3.p10.1.m1.2.2.2.2" xref="Sx3.p10.1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="Sx3.p10.1.m1.2.2.2.4.2.3" xref="Sx3.p10.1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="Sx3.p10.1.m1.2.2.2.3" xref="Sx3.p10.1.m1.2.2.2.3.cmml">∼</mo><msub id="Sx3.p10.1.m1.2.2.2.5" xref="Sx3.p10.1.m1.2.2.2.5.cmml"><mi id="Sx3.p10.1.m1.2.2.2.5.2" xref="Sx3.p10.1.m1.2.2.2.5.2.cmml">γ</mi><mi id="Sx3.p10.1.m1.2.2.2.5.3" xref="Sx3.p10.1.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.p10.1.m1.7.7.1.2" xref="Sx3.p10.1.m1.7.7.1.2.cmml">​</mo><mrow id="Sx3.p10.1.m1.7.7.1.1.1" xref="Sx3.p10.1.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="Sx3.p10.1.m1.7.7.1.1.1.2" xref="Sx3.p10.1.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="Sx3.p10.1.m1.7.7.1.1.1.1" xref="Sx3.p10.1.m1.7.7.1.1.1.1.cmml"><mi id="Sx3.p10.1.m1.7.7.1.1.1.1.2" xref="Sx3.p10.1.m1.7.7.1.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.p10.1.m1.7.7.1.1.1.1.1" xref="Sx3.p10.1.m1.7.7.1.1.1.1.1.cmml">​</mo><mrow id="Sx3.p10.1.m1.7.7.1.1.1.1.3.2" xref="Sx3.p10.1.m1.7.7.1.1.1.1.3.1.cmml"><mo stretchy="false" id="Sx3.p10.1.m1.7.7.1.1.1.1.3.2.1" xref="Sx3.p10.1.m1.7.7.1.1.1.1.3.1.cmml">(</mo><mi id="Sx3.p10.1.m1.4.4" xref="Sx3.p10.1.m1.4.4.cmml">θ</mi><mo id="Sx3.p10.1.m1.7.7.1.1.1.1.3.2.2" xref="Sx3.p10.1.m1.7.7.1.1.1.1.3.1.cmml">,</mo><mi id="Sx3.p10.1.m1.5.5" xref="Sx3.p10.1.m1.5.5.cmml">x</mi><mo id="Sx3.p10.1.m1.7.7.1.1.1.1.3.2.3" xref="Sx3.p10.1.m1.7.7.1.1.1.1.3.1.cmml">;</mo><mi id="Sx3.p10.1.m1.6.6" xref="Sx3.p10.1.m1.6.6.cmml">y</mi><mo stretchy="false" id="Sx3.p10.1.m1.7.7.1.1.1.1.3.2.4" xref="Sx3.p10.1.m1.7.7.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.p10.1.m1.7.7.1.1.1.3" xref="Sx3.p10.1.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p10.1.m1.7b"><apply id="Sx3.p10.1.m1.7.7.cmml" xref="Sx3.p10.1.m1.7.7"><eq id="Sx3.p10.1.m1.7.7.2.cmml" xref="Sx3.p10.1.m1.7.7.2"></eq><apply id="Sx3.p10.1.m1.7.7.3.cmml" xref="Sx3.p10.1.m1.7.7.3"><times id="Sx3.p10.1.m1.7.7.3.1.cmml" xref="Sx3.p10.1.m1.7.7.3.1"></times><apply id="Sx3.p10.1.m1.7.7.3.2.cmml" xref="Sx3.p10.1.m1.7.7.3.2"><csymbol cd="ambiguous" id="Sx3.p10.1.m1.7.7.3.2.1.cmml" xref="Sx3.p10.1.m1.7.7.3.2">subscript</csymbol><ci id="Sx3.p10.1.m1.7.7.3.2.2.cmml" xref="Sx3.p10.1.m1.7.7.3.2.2">𝐿</ci><ci id="Sx3.p10.1.m1.7.7.3.2.3.cmml" xref="Sx3.p10.1.m1.7.7.3.2.3">𝑖</ci></apply><ci id="Sx3.p10.1.m1.3.3.cmml" xref="Sx3.p10.1.m1.3.3">𝜃</ci></apply><apply id="Sx3.p10.1.m1.7.7.1.cmml" xref="Sx3.p10.1.m1.7.7.1"><times id="Sx3.p10.1.m1.7.7.1.2.cmml" xref="Sx3.p10.1.m1.7.7.1.2"></times><apply id="Sx3.p10.1.m1.7.7.1.3.cmml" xref="Sx3.p10.1.m1.7.7.1.3"><csymbol cd="ambiguous" id="Sx3.p10.1.m1.7.7.1.3.1.cmml" xref="Sx3.p10.1.m1.7.7.1.3">subscript</csymbol><ci id="Sx3.p10.1.m1.7.7.1.3.2.cmml" xref="Sx3.p10.1.m1.7.7.1.3.2">𝔼</ci><apply id="Sx3.p10.1.m1.2.2.2.cmml" xref="Sx3.p10.1.m1.2.2.2"><csymbol cd="latexml" id="Sx3.p10.1.m1.2.2.2.3.cmml" xref="Sx3.p10.1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="Sx3.p10.1.m1.2.2.2.4.1.cmml" xref="Sx3.p10.1.m1.2.2.2.4.2"><ci id="Sx3.p10.1.m1.1.1.1.1.cmml" xref="Sx3.p10.1.m1.1.1.1.1">𝑥</ci><ci id="Sx3.p10.1.m1.2.2.2.2.cmml" xref="Sx3.p10.1.m1.2.2.2.2">𝑦</ci></interval><apply id="Sx3.p10.1.m1.2.2.2.5.cmml" xref="Sx3.p10.1.m1.2.2.2.5"><csymbol cd="ambiguous" id="Sx3.p10.1.m1.2.2.2.5.1.cmml" xref="Sx3.p10.1.m1.2.2.2.5">subscript</csymbol><ci id="Sx3.p10.1.m1.2.2.2.5.2.cmml" xref="Sx3.p10.1.m1.2.2.2.5.2">𝛾</ci><ci id="Sx3.p10.1.m1.2.2.2.5.3.cmml" xref="Sx3.p10.1.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="Sx3.p10.1.m1.7.7.1.1.2.cmml" xref="Sx3.p10.1.m1.7.7.1.1.1"><csymbol cd="latexml" id="Sx3.p10.1.m1.7.7.1.1.2.1.cmml" xref="Sx3.p10.1.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.p10.1.m1.7.7.1.1.1.1.cmml" xref="Sx3.p10.1.m1.7.7.1.1.1.1"><times id="Sx3.p10.1.m1.7.7.1.1.1.1.1.cmml" xref="Sx3.p10.1.m1.7.7.1.1.1.1.1"></times><ci id="Sx3.p10.1.m1.7.7.1.1.1.1.2.cmml" xref="Sx3.p10.1.m1.7.7.1.1.1.1.2">𝑙</ci><vector id="Sx3.p10.1.m1.7.7.1.1.1.1.3.1.cmml" xref="Sx3.p10.1.m1.7.7.1.1.1.1.3.2"><ci id="Sx3.p10.1.m1.4.4.cmml" xref="Sx3.p10.1.m1.4.4">𝜃</ci><ci id="Sx3.p10.1.m1.5.5.cmml" xref="Sx3.p10.1.m1.5.5">𝑥</ci><ci id="Sx3.p10.1.m1.6.6.cmml" xref="Sx3.p10.1.m1.6.6">𝑦</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.1.m1.7c">L_{i}(\theta)=\mathbb{E}_{(x,y)\sim\gamma_{i}}[l(\theta,x;y)]</annotation></semantics></math> is the expected loss over client <math id="Sx3.p10.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.p10.2.m2.1a"><mi id="Sx3.p10.2.m2.1.1" xref="Sx3.p10.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.p10.2.m2.1b"><ci id="Sx3.p10.2.m2.1.1.cmml" xref="Sx3.p10.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.2.m2.1c">i</annotation></semantics></math>’s DGP of the model parametrized with <math id="Sx3.p10.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx3.p10.3.m3.1a"><mi id="Sx3.p10.3.m3.1.1" xref="Sx3.p10.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx3.p10.3.m3.1b"><ci id="Sx3.p10.3.m3.1.1.cmml" xref="Sx3.p10.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.3.m3.1c">\theta</annotation></semantics></math>, <math id="Sx3.p10.4.m4.1" class="ltx_Math" alttext="\mathds{1}_{\alpha(i)=k}" display="inline"><semantics id="Sx3.p10.4.m4.1a"><msub id="Sx3.p10.4.m4.1.2" xref="Sx3.p10.4.m4.1.2.cmml"><mn id="Sx3.p10.4.m4.1.2.2" xref="Sx3.p10.4.m4.1.2.2.cmml">𝟙</mn><mrow id="Sx3.p10.4.m4.1.1.1" xref="Sx3.p10.4.m4.1.1.1.cmml"><mrow id="Sx3.p10.4.m4.1.1.1.3" xref="Sx3.p10.4.m4.1.1.1.3.cmml"><mi id="Sx3.p10.4.m4.1.1.1.3.2" xref="Sx3.p10.4.m4.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.p10.4.m4.1.1.1.3.1" xref="Sx3.p10.4.m4.1.1.1.3.1.cmml">​</mo><mrow id="Sx3.p10.4.m4.1.1.1.3.3.2" xref="Sx3.p10.4.m4.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.p10.4.m4.1.1.1.3.3.2.1" xref="Sx3.p10.4.m4.1.1.1.3.cmml">(</mo><mi id="Sx3.p10.4.m4.1.1.1.1" xref="Sx3.p10.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.p10.4.m4.1.1.1.3.3.2.2" xref="Sx3.p10.4.m4.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="Sx3.p10.4.m4.1.1.1.2" xref="Sx3.p10.4.m4.1.1.1.2.cmml">=</mo><mi id="Sx3.p10.4.m4.1.1.1.4" xref="Sx3.p10.4.m4.1.1.1.4.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.p10.4.m4.1b"><apply id="Sx3.p10.4.m4.1.2.cmml" xref="Sx3.p10.4.m4.1.2"><csymbol cd="ambiguous" id="Sx3.p10.4.m4.1.2.1.cmml" xref="Sx3.p10.4.m4.1.2">subscript</csymbol><cn type="integer" id="Sx3.p10.4.m4.1.2.2.cmml" xref="Sx3.p10.4.m4.1.2.2">1</cn><apply id="Sx3.p10.4.m4.1.1.1.cmml" xref="Sx3.p10.4.m4.1.1.1"><eq id="Sx3.p10.4.m4.1.1.1.2.cmml" xref="Sx3.p10.4.m4.1.1.1.2"></eq><apply id="Sx3.p10.4.m4.1.1.1.3.cmml" xref="Sx3.p10.4.m4.1.1.1.3"><times id="Sx3.p10.4.m4.1.1.1.3.1.cmml" xref="Sx3.p10.4.m4.1.1.1.3.1"></times><ci id="Sx3.p10.4.m4.1.1.1.3.2.cmml" xref="Sx3.p10.4.m4.1.1.1.3.2">𝛼</ci><ci id="Sx3.p10.4.m4.1.1.1.1.cmml" xref="Sx3.p10.4.m4.1.1.1.1">𝑖</ci></apply><ci id="Sx3.p10.4.m4.1.1.1.4.cmml" xref="Sx3.p10.4.m4.1.1.1.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.4.m4.1c">\mathds{1}_{\alpha(i)=k}</annotation></semantics></math> is the indicator function taking value <math id="Sx3.p10.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="Sx3.p10.5.m5.1a"><mn id="Sx3.p10.5.m5.1.1" xref="Sx3.p10.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="Sx3.p10.5.m5.1b"><cn type="integer" id="Sx3.p10.5.m5.1.1.cmml" xref="Sx3.p10.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.5.m5.1c">1</annotation></semantics></math> if <math id="Sx3.p10.6.m6.1" class="ltx_Math" alttext="\alpha(i)=k" display="inline"><semantics id="Sx3.p10.6.m6.1a"><mrow id="Sx3.p10.6.m6.1.2" xref="Sx3.p10.6.m6.1.2.cmml"><mrow id="Sx3.p10.6.m6.1.2.2" xref="Sx3.p10.6.m6.1.2.2.cmml"><mi id="Sx3.p10.6.m6.1.2.2.2" xref="Sx3.p10.6.m6.1.2.2.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.p10.6.m6.1.2.2.1" xref="Sx3.p10.6.m6.1.2.2.1.cmml">​</mo><mrow id="Sx3.p10.6.m6.1.2.2.3.2" xref="Sx3.p10.6.m6.1.2.2.cmml"><mo stretchy="false" id="Sx3.p10.6.m6.1.2.2.3.2.1" xref="Sx3.p10.6.m6.1.2.2.cmml">(</mo><mi id="Sx3.p10.6.m6.1.1" xref="Sx3.p10.6.m6.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.p10.6.m6.1.2.2.3.2.2" xref="Sx3.p10.6.m6.1.2.2.cmml">)</mo></mrow></mrow><mo id="Sx3.p10.6.m6.1.2.1" xref="Sx3.p10.6.m6.1.2.1.cmml">=</mo><mi id="Sx3.p10.6.m6.1.2.3" xref="Sx3.p10.6.m6.1.2.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.p10.6.m6.1b"><apply id="Sx3.p10.6.m6.1.2.cmml" xref="Sx3.p10.6.m6.1.2"><eq id="Sx3.p10.6.m6.1.2.1.cmml" xref="Sx3.p10.6.m6.1.2.1"></eq><apply id="Sx3.p10.6.m6.1.2.2.cmml" xref="Sx3.p10.6.m6.1.2.2"><times id="Sx3.p10.6.m6.1.2.2.1.cmml" xref="Sx3.p10.6.m6.1.2.2.1"></times><ci id="Sx3.p10.6.m6.1.2.2.2.cmml" xref="Sx3.p10.6.m6.1.2.2.2">𝛼</ci><ci id="Sx3.p10.6.m6.1.1.cmml" xref="Sx3.p10.6.m6.1.1">𝑖</ci></apply><ci id="Sx3.p10.6.m6.1.2.3.cmml" xref="Sx3.p10.6.m6.1.2.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.6.m6.1c">\alpha(i)=k</annotation></semantics></math> else <math id="Sx3.p10.7.m7.1" class="ltx_Math" alttext="0" display="inline"><semantics id="Sx3.p10.7.m7.1a"><mn id="Sx3.p10.7.m7.1.1" xref="Sx3.p10.7.m7.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="Sx3.p10.7.m7.1b"><cn type="integer" id="Sx3.p10.7.m7.1.1.cmml" xref="Sx3.p10.7.m7.1.1">0</cn></annotation-xml></semantics></math>, and <math id="Sx3.p10.8.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx3.p10.8.m8.1a"><mi id="Sx3.p10.8.m8.1.1" xref="Sx3.p10.8.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx3.p10.8.m8.1b"><ci id="Sx3.p10.8.m8.1.1.cmml" xref="Sx3.p10.8.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.8.m8.1c">\alpha</annotation></semantics></math> a function that assigns every client to a cluster. The function <math id="Sx3.p10.9.m9.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx3.p10.9.m9.1a"><mi id="Sx3.p10.9.m9.1.1" xref="Sx3.p10.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx3.p10.9.m9.1b"><ci id="Sx3.p10.9.m9.1.1.cmml" xref="Sx3.p10.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p10.9.m9.1c">\alpha</annotation></semantics></math> logically consists of two steps: first, it computes the client embeddings of every available client and second, it uses such client embeddings to fit a clustering model and hence partition the clients.</p>
</div>
<div id="Sx3.p11" class="ltx_para">
<p id="Sx3.p11.4" class="ltx_p">After clients are clustered, training can proceed in a traditional FL way, i.e. at each server epoch <math id="Sx3.p11.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Sx3.p11.1.m1.1a"><mi id="Sx3.p11.1.m1.1.1" xref="Sx3.p11.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx3.p11.1.m1.1b"><ci id="Sx3.p11.1.m1.1.1.cmml" xref="Sx3.p11.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p11.1.m1.1c">t</annotation></semantics></math> every client <math id="Sx3.p11.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx3.p11.2.m2.1a"><mi id="Sx3.p11.2.m2.1.1" xref="Sx3.p11.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx3.p11.2.m2.1b"><ci id="Sx3.p11.2.m2.1.1.cmml" xref="Sx3.p11.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p11.2.m2.1c">i</annotation></semantics></math> selected for training receives the cluster model <math id="Sx3.p11.3.m3.1" class="ltx_Math" alttext="\theta_{\alpha(i)}^{t}" display="inline"><semantics id="Sx3.p11.3.m3.1a"><msubsup id="Sx3.p11.3.m3.1.2" xref="Sx3.p11.3.m3.1.2.cmml"><mi id="Sx3.p11.3.m3.1.2.2.2" xref="Sx3.p11.3.m3.1.2.2.2.cmml">θ</mi><mrow id="Sx3.p11.3.m3.1.1.1" xref="Sx3.p11.3.m3.1.1.1.cmml"><mi id="Sx3.p11.3.m3.1.1.1.3" xref="Sx3.p11.3.m3.1.1.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.p11.3.m3.1.1.1.2" xref="Sx3.p11.3.m3.1.1.1.2.cmml">​</mo><mrow id="Sx3.p11.3.m3.1.1.1.4.2" xref="Sx3.p11.3.m3.1.1.1.cmml"><mo stretchy="false" id="Sx3.p11.3.m3.1.1.1.4.2.1" xref="Sx3.p11.3.m3.1.1.1.cmml">(</mo><mi id="Sx3.p11.3.m3.1.1.1.1" xref="Sx3.p11.3.m3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.p11.3.m3.1.1.1.4.2.2" xref="Sx3.p11.3.m3.1.1.1.cmml">)</mo></mrow></mrow><mi id="Sx3.p11.3.m3.1.2.3" xref="Sx3.p11.3.m3.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.p11.3.m3.1b"><apply id="Sx3.p11.3.m3.1.2.cmml" xref="Sx3.p11.3.m3.1.2"><csymbol cd="ambiguous" id="Sx3.p11.3.m3.1.2.1.cmml" xref="Sx3.p11.3.m3.1.2">superscript</csymbol><apply id="Sx3.p11.3.m3.1.2.2.cmml" xref="Sx3.p11.3.m3.1.2"><csymbol cd="ambiguous" id="Sx3.p11.3.m3.1.2.2.1.cmml" xref="Sx3.p11.3.m3.1.2">subscript</csymbol><ci id="Sx3.p11.3.m3.1.2.2.2.cmml" xref="Sx3.p11.3.m3.1.2.2.2">𝜃</ci><apply id="Sx3.p11.3.m3.1.1.1.cmml" xref="Sx3.p11.3.m3.1.1.1"><times id="Sx3.p11.3.m3.1.1.1.2.cmml" xref="Sx3.p11.3.m3.1.1.1.2"></times><ci id="Sx3.p11.3.m3.1.1.1.3.cmml" xref="Sx3.p11.3.m3.1.1.1.3">𝛼</ci><ci id="Sx3.p11.3.m3.1.1.1.1.cmml" xref="Sx3.p11.3.m3.1.1.1.1">𝑖</ci></apply></apply><ci id="Sx3.p11.3.m3.1.2.3.cmml" xref="Sx3.p11.3.m3.1.2.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p11.3.m3.1c">\theta_{\alpha(i)}^{t}</annotation></semantics></math>, finetunes it so as to obtain the model <math id="Sx3.p11.4.m4.3" class="ltx_Math" alttext="\theta_{\alpha(i),i}^{t+1}" display="inline"><semantics id="Sx3.p11.4.m4.3a"><msubsup id="Sx3.p11.4.m4.3.4" xref="Sx3.p11.4.m4.3.4.cmml"><mi id="Sx3.p11.4.m4.3.4.2.2" xref="Sx3.p11.4.m4.3.4.2.2.cmml">θ</mi><mrow id="Sx3.p11.4.m4.3.3.3.3" xref="Sx3.p11.4.m4.3.3.3.4.cmml"><mrow id="Sx3.p11.4.m4.3.3.3.3.1" xref="Sx3.p11.4.m4.3.3.3.3.1.cmml"><mi id="Sx3.p11.4.m4.3.3.3.3.1.2" xref="Sx3.p11.4.m4.3.3.3.3.1.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.p11.4.m4.3.3.3.3.1.1" xref="Sx3.p11.4.m4.3.3.3.3.1.1.cmml">​</mo><mrow id="Sx3.p11.4.m4.3.3.3.3.1.3.2" xref="Sx3.p11.4.m4.3.3.3.3.1.cmml"><mo stretchy="false" id="Sx3.p11.4.m4.3.3.3.3.1.3.2.1" xref="Sx3.p11.4.m4.3.3.3.3.1.cmml">(</mo><mi id="Sx3.p11.4.m4.1.1.1.1" xref="Sx3.p11.4.m4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.p11.4.m4.3.3.3.3.1.3.2.2" xref="Sx3.p11.4.m4.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.p11.4.m4.3.3.3.3.2" xref="Sx3.p11.4.m4.3.3.3.4.cmml">,</mo><mi id="Sx3.p11.4.m4.2.2.2.2" xref="Sx3.p11.4.m4.2.2.2.2.cmml">i</mi></mrow><mrow id="Sx3.p11.4.m4.3.4.3" xref="Sx3.p11.4.m4.3.4.3.cmml"><mi id="Sx3.p11.4.m4.3.4.3.2" xref="Sx3.p11.4.m4.3.4.3.2.cmml">t</mi><mo id="Sx3.p11.4.m4.3.4.3.1" xref="Sx3.p11.4.m4.3.4.3.1.cmml">+</mo><mn id="Sx3.p11.4.m4.3.4.3.3" xref="Sx3.p11.4.m4.3.4.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.p11.4.m4.3b"><apply id="Sx3.p11.4.m4.3.4.cmml" xref="Sx3.p11.4.m4.3.4"><csymbol cd="ambiguous" id="Sx3.p11.4.m4.3.4.1.cmml" xref="Sx3.p11.4.m4.3.4">superscript</csymbol><apply id="Sx3.p11.4.m4.3.4.2.cmml" xref="Sx3.p11.4.m4.3.4"><csymbol cd="ambiguous" id="Sx3.p11.4.m4.3.4.2.1.cmml" xref="Sx3.p11.4.m4.3.4">subscript</csymbol><ci id="Sx3.p11.4.m4.3.4.2.2.cmml" xref="Sx3.p11.4.m4.3.4.2.2">𝜃</ci><list id="Sx3.p11.4.m4.3.3.3.4.cmml" xref="Sx3.p11.4.m4.3.3.3.3"><apply id="Sx3.p11.4.m4.3.3.3.3.1.cmml" xref="Sx3.p11.4.m4.3.3.3.3.1"><times id="Sx3.p11.4.m4.3.3.3.3.1.1.cmml" xref="Sx3.p11.4.m4.3.3.3.3.1.1"></times><ci id="Sx3.p11.4.m4.3.3.3.3.1.2.cmml" xref="Sx3.p11.4.m4.3.3.3.3.1.2">𝛼</ci><ci id="Sx3.p11.4.m4.1.1.1.1.cmml" xref="Sx3.p11.4.m4.1.1.1.1">𝑖</ci></apply><ci id="Sx3.p11.4.m4.2.2.2.2.cmml" xref="Sx3.p11.4.m4.2.2.2.2">𝑖</ci></list></apply><apply id="Sx3.p11.4.m4.3.4.3.cmml" xref="Sx3.p11.4.m4.3.4.3"><plus id="Sx3.p11.4.m4.3.4.3.1.cmml" xref="Sx3.p11.4.m4.3.4.3.1"></plus><ci id="Sx3.p11.4.m4.3.4.3.2.cmml" xref="Sx3.p11.4.m4.3.4.3.2">𝑡</ci><cn type="integer" id="Sx3.p11.4.m4.3.4.3.3.cmml" xref="Sx3.p11.4.m4.3.4.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p11.4.m4.3c">\theta_{\alpha(i),i}^{t+1}</annotation></semantics></math>, and returns it to the server. The latter then computes the new version of the cluster model as:</p>
</div>
<div id="Sx3.p12" class="ltx_para">
<table id="Sx6.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E4.m1.5" class="ltx_Math" alttext="\displaystyle\theta_{k}^{t+1}=W\Big{(}\bigcup_{i}\big{\{}(\theta_{\alpha(i),i}^{t+1},\epsilon_{i})~{}|~{}\alpha(i)=k\big{\}}\Big{)}," display="inline"><semantics id="Sx3.E4.m1.5a"><mrow id="Sx3.E4.m1.5.5.1" xref="Sx3.E4.m1.5.5.1.1.cmml"><mrow id="Sx3.E4.m1.5.5.1.1" xref="Sx3.E4.m1.5.5.1.1.cmml"><msubsup id="Sx3.E4.m1.5.5.1.1.3" xref="Sx3.E4.m1.5.5.1.1.3.cmml"><mi id="Sx3.E4.m1.5.5.1.1.3.2.2" xref="Sx3.E4.m1.5.5.1.1.3.2.2.cmml">θ</mi><mi id="Sx3.E4.m1.5.5.1.1.3.2.3" xref="Sx3.E4.m1.5.5.1.1.3.2.3.cmml">k</mi><mrow id="Sx3.E4.m1.5.5.1.1.3.3" xref="Sx3.E4.m1.5.5.1.1.3.3.cmml"><mi id="Sx3.E4.m1.5.5.1.1.3.3.2" xref="Sx3.E4.m1.5.5.1.1.3.3.2.cmml">t</mi><mo id="Sx3.E4.m1.5.5.1.1.3.3.1" xref="Sx3.E4.m1.5.5.1.1.3.3.1.cmml">+</mo><mn id="Sx3.E4.m1.5.5.1.1.3.3.3" xref="Sx3.E4.m1.5.5.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo id="Sx3.E4.m1.5.5.1.1.2" xref="Sx3.E4.m1.5.5.1.1.2.cmml">=</mo><mrow id="Sx3.E4.m1.5.5.1.1.1" xref="Sx3.E4.m1.5.5.1.1.1.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.3" xref="Sx3.E4.m1.5.5.1.1.1.3.cmml">W</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.5.5.1.1.1.2" xref="Sx3.E4.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mo maxsize="160%" minsize="160%" id="Sx3.E4.m1.5.5.1.1.1.1.1.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.cmml"><munder id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3a" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.cmml"><mo movablelimits="false" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.2.cmml">⋃</mo><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.3.cmml">i</mi></munder></mstyle><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.3.cmml"><mo maxsize="120%" minsize="120%" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">{</mo><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="Sx3.E4.m1.3.3.3.3" xref="Sx3.E4.m1.3.3.3.4.cmml"><mrow id="Sx3.E4.m1.3.3.3.3.1" xref="Sx3.E4.m1.3.3.3.3.1.cmml"><mi id="Sx3.E4.m1.3.3.3.3.1.2" xref="Sx3.E4.m1.3.3.3.3.1.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.3.3.3.3.1.1" xref="Sx3.E4.m1.3.3.3.3.1.1.cmml">​</mo><mrow id="Sx3.E4.m1.3.3.3.3.1.3.2" xref="Sx3.E4.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="Sx3.E4.m1.3.3.3.3.1.3.2.1" xref="Sx3.E4.m1.3.3.3.3.1.cmml">(</mo><mi id="Sx3.E4.m1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.E4.m1.3.3.3.3.1.3.2.2" xref="Sx3.E4.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E4.m1.3.3.3.3.2" xref="Sx3.E4.m1.3.3.3.4.cmml">,</mo><mi id="Sx3.E4.m1.2.2.2.2" xref="Sx3.E4.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.4" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ϵ</mi><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo rspace="0.052em" stretchy="false" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.5" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo rspace="0.330em" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.4" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">|</mo><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.cmml"><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.1.cmml">​</mo><mrow id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml"><mo stretchy="false" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="Sx3.E4.m1.4.4" xref="Sx3.E4.m1.4.4.cmml">i</mi><mo stretchy="false" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.3.2.2" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml">=</mo><mi id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></mrow><mo maxsize="120%" minsize="120%" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.5" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.3.1.cmml">}</mo></mrow></mrow><mo maxsize="160%" minsize="160%" id="Sx3.E4.m1.5.5.1.1.1.1.1.3" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E4.m1.5.5.1.2" xref="Sx3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E4.m1.5b"><apply id="Sx3.E4.m1.5.5.1.1.cmml" xref="Sx3.E4.m1.5.5.1"><eq id="Sx3.E4.m1.5.5.1.1.2.cmml" xref="Sx3.E4.m1.5.5.1.1.2"></eq><apply id="Sx3.E4.m1.5.5.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.3.1.cmml" xref="Sx3.E4.m1.5.5.1.1.3">superscript</csymbol><apply id="Sx3.E4.m1.5.5.1.1.3.2.cmml" xref="Sx3.E4.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.3.2.1.cmml" xref="Sx3.E4.m1.5.5.1.1.3">subscript</csymbol><ci id="Sx3.E4.m1.5.5.1.1.3.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.3.2.2">𝜃</ci><ci id="Sx3.E4.m1.5.5.1.1.3.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.3.2.3">𝑘</ci></apply><apply id="Sx3.E4.m1.5.5.1.1.3.3.cmml" xref="Sx3.E4.m1.5.5.1.1.3.3"><plus id="Sx3.E4.m1.5.5.1.1.3.3.1.cmml" xref="Sx3.E4.m1.5.5.1.1.3.3.1"></plus><ci id="Sx3.E4.m1.5.5.1.1.3.3.2.cmml" xref="Sx3.E4.m1.5.5.1.1.3.3.2">𝑡</ci><cn type="integer" id="Sx3.E4.m1.5.5.1.1.3.3.3.cmml" xref="Sx3.E4.m1.5.5.1.1.3.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.5.5.1.1.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1"><times id="Sx3.E4.m1.5.5.1.1.1.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.2"></times><ci id="Sx3.E4.m1.5.5.1.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.3">𝑊</ci><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1"><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><union id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.2"></union><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2"><csymbol cd="latexml" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.3.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.3">conditional-set</csymbol><interval closure="open" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2"><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.2">𝜃</ci><list id="Sx3.E4.m1.3.3.3.4.cmml" xref="Sx3.E4.m1.3.3.3.3"><apply id="Sx3.E4.m1.3.3.3.3.1.cmml" xref="Sx3.E4.m1.3.3.3.3.1"><times id="Sx3.E4.m1.3.3.3.3.1.1.cmml" xref="Sx3.E4.m1.3.3.3.3.1.1"></times><ci id="Sx3.E4.m1.3.3.3.3.1.2.cmml" xref="Sx3.E4.m1.3.3.3.3.1.2">𝛼</ci><ci id="Sx3.E4.m1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1">𝑖</ci></apply><ci id="Sx3.E4.m1.2.2.2.2.cmml" xref="Sx3.E4.m1.2.2.2.2">𝑖</ci></list></apply><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><plus id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1"></plus><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2">italic-ϵ</ci><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2"><eq id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1"></eq><apply id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2"><times id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.1"></times><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.2">𝛼</ci><ci id="Sx3.E4.m1.4.4.cmml" xref="Sx3.E4.m1.4.4">𝑖</ci></apply><ci id="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E4.m1.5.5.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E4.m1.5c">\displaystyle\theta_{k}^{t+1}=W\Big{(}\bigcup_{i}\big{\{}(\theta_{\alpha(i),i}^{t+1},\epsilon_{i})~{}|~{}\alpha(i)=k\big{\}}\Big{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx3.p12.3" class="ltx_p">where <math id="Sx3.p12.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="Sx3.p12.1.m1.1a"><mi id="Sx3.p12.1.m1.1.1" xref="Sx3.p12.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="Sx3.p12.1.m1.1b"><ci id="Sx3.p12.1.m1.1.1.cmml" xref="Sx3.p12.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p12.1.m1.1c">W</annotation></semantics></math> is the weight aggregation function and <math id="Sx3.p12.2.m2.1" class="ltx_Math" alttext="\epsilon_{i}" display="inline"><semantics id="Sx3.p12.2.m2.1a"><msub id="Sx3.p12.2.m2.1.1" xref="Sx3.p12.2.m2.1.1.cmml"><mi id="Sx3.p12.2.m2.1.1.2" xref="Sx3.p12.2.m2.1.1.2.cmml">ϵ</mi><mi id="Sx3.p12.2.m2.1.1.3" xref="Sx3.p12.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.p12.2.m2.1b"><apply id="Sx3.p12.2.m2.1.1.cmml" xref="Sx3.p12.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.p12.2.m2.1.1.1.cmml" xref="Sx3.p12.2.m2.1.1">subscript</csymbol><ci id="Sx3.p12.2.m2.1.1.2.cmml" xref="Sx3.p12.2.m2.1.1.2">italic-ϵ</ci><ci id="Sx3.p12.2.m2.1.1.3.cmml" xref="Sx3.p12.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p12.2.m2.1c">\epsilon_{i}</annotation></semantics></math> is the meta-information sent by the clients, e.g. the client’s training dataset size. When using the FedAvg algorithm, the function <math id="Sx3.p12.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="Sx3.p12.3.m3.1a"><mi id="Sx3.p12.3.m3.1.1" xref="Sx3.p12.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="Sx3.p12.3.m3.1b"><ci id="Sx3.p12.3.m3.1.1.cmml" xref="Sx3.p12.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.p12.3.m3.1c">W</annotation></semantics></math> simply computes the weighted average of the received model parameters.</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection"><span id="Sx3.SSx1.1.1" class="ltx_ERROR undefined">\acronym</span></h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.1" class="ltx_p">We now present <span id="Sx3.SSx1.p1.1.1" class="ltx_ERROR undefined">\acronym</span>, a novel algorithm for computing client embeddings that <span id="Sx3.SSx1.p1.1.2" class="ltx_text ltx_font_italic">does not involve any training</span> on the client’s datasets and that <span id="Sx3.SSx1.p1.1.3" class="ltx_text ltx_font_italic">can also be used for computing the embeddings of clients that do not possess a labeled dataset</span>, i.e. whose <math id="Sx3.SSx1.p1.1.m1.2" class="ltx_Math" alttext="y_{i,j}" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.2a"><msub id="Sx3.SSx1.p1.1.m1.2.3" xref="Sx3.SSx1.p1.1.m1.2.3.cmml"><mi id="Sx3.SSx1.p1.1.m1.2.3.2" xref="Sx3.SSx1.p1.1.m1.2.3.2.cmml">y</mi><mrow id="Sx3.SSx1.p1.1.m1.2.2.2.4" xref="Sx3.SSx1.p1.1.m1.2.2.2.3.cmml"><mi id="Sx3.SSx1.p1.1.m1.1.1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx1.p1.1.m1.2.2.2.4.1" xref="Sx3.SSx1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx1.p1.1.m1.2.2.2.2" xref="Sx3.SSx1.p1.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.2b"><apply id="Sx3.SSx1.p1.1.m1.2.3.cmml" xref="Sx3.SSx1.p1.1.m1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.1.m1.2.3.1.cmml" xref="Sx3.SSx1.p1.1.m1.2.3">subscript</csymbol><ci id="Sx3.SSx1.p1.1.m1.2.3.2.cmml" xref="Sx3.SSx1.p1.1.m1.2.3.2">𝑦</ci><list id="Sx3.SSx1.p1.1.m1.2.2.2.3.cmml" xref="Sx3.SSx1.p1.1.m1.2.2.2.4"><ci id="Sx3.SSx1.p1.1.m1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1.1.1">𝑖</ci><ci id="Sx3.SSx1.p1.1.m1.2.2.2.2.cmml" xref="Sx3.SSx1.p1.1.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.2c">y_{i,j}</annotation></semantics></math> in <a href="#Sx3.E1" title="In Preliminaries and General Framework for Clustered FL ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> are unknown. We first briefly discuss the rationale behind <span id="Sx3.SSx1.p1.1.4" class="ltx_ERROR undefined">\acronym</span>.</p>
</div>
<div id="Sx3.SSx1.p2" class="ltx_para">
<p id="Sx3.SSx1.p2.6" class="ltx_p">Aiming to devise an algorithm that may be used for computing embeddings of clients who do not possess a labeled dataset, we necessarily need to restrict ourselves to a set <math id="Sx3.SSx1.p2.1.m1.4" class="ltx_Math" alttext="\{X_{i,j}\}_{j=1}^{|D_{i}|}" display="inline"><semantics id="Sx3.SSx1.p2.1.m1.4a"><msubsup id="Sx3.SSx1.p2.1.m1.4.4" xref="Sx3.SSx1.p2.1.m1.4.4.cmml"><mrow id="Sx3.SSx1.p2.1.m1.4.4.1.1.1" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.2" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.2.cmml">{</mo><msub id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.cmml"><mi id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.2" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.2.cmml">X</mi><mrow id="Sx3.SSx1.p2.1.m1.2.2.2.4" xref="Sx3.SSx1.p2.1.m1.2.2.2.3.cmml"><mi id="Sx3.SSx1.p2.1.m1.1.1.1.1" xref="Sx3.SSx1.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx1.p2.1.m1.2.2.2.4.1" xref="Sx3.SSx1.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx1.p2.1.m1.2.2.2.2" xref="Sx3.SSx1.p2.1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.3" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.2.cmml">}</mo></mrow><mrow id="Sx3.SSx1.p2.1.m1.4.4.1.3" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.cmml"><mi id="Sx3.SSx1.p2.1.m1.4.4.1.3.2" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.2.cmml">j</mi><mo id="Sx3.SSx1.p2.1.m1.4.4.1.3.1" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.1.cmml">=</mo><mn id="Sx3.SSx1.p2.1.m1.4.4.1.3.3" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.3.cmml">1</mn></mrow><mrow id="Sx3.SSx1.p2.1.m1.3.3.1.1" xref="Sx3.SSx1.p2.1.m1.3.3.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.1.m1.3.3.1.1.2" xref="Sx3.SSx1.p2.1.m1.3.3.1.2.1.cmml">|</mo><msub id="Sx3.SSx1.p2.1.m1.3.3.1.1.1" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1.cmml"><mi id="Sx3.SSx1.p2.1.m1.3.3.1.1.1.2" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1.2.cmml">D</mi><mi id="Sx3.SSx1.p2.1.m1.3.3.1.1.1.3" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.SSx1.p2.1.m1.3.3.1.1.3" xref="Sx3.SSx1.p2.1.m1.3.3.1.2.1.cmml">|</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.1.m1.4b"><apply id="Sx3.SSx1.p2.1.m1.4.4.cmml" xref="Sx3.SSx1.p2.1.m1.4.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.1.m1.4.4.2.cmml" xref="Sx3.SSx1.p2.1.m1.4.4">superscript</csymbol><apply id="Sx3.SSx1.p2.1.m1.4.4.1.cmml" xref="Sx3.SSx1.p2.1.m1.4.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.1.m1.4.4.1.2.cmml" xref="Sx3.SSx1.p2.1.m1.4.4">subscript</csymbol><set id="Sx3.SSx1.p2.1.m1.4.4.1.1.2.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.1"><apply id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.2.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.1.1.1.2">𝑋</ci><list id="Sx3.SSx1.p2.1.m1.2.2.2.3.cmml" xref="Sx3.SSx1.p2.1.m1.2.2.2.4"><ci id="Sx3.SSx1.p2.1.m1.1.1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.1.1.1.1">𝑖</ci><ci id="Sx3.SSx1.p2.1.m1.2.2.2.2.cmml" xref="Sx3.SSx1.p2.1.m1.2.2.2.2">𝑗</ci></list></apply></set><apply id="Sx3.SSx1.p2.1.m1.4.4.1.3.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.3"><eq id="Sx3.SSx1.p2.1.m1.4.4.1.3.1.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.1"></eq><ci id="Sx3.SSx1.p2.1.m1.4.4.1.3.2.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.2">𝑗</ci><cn type="integer" id="Sx3.SSx1.p2.1.m1.4.4.1.3.3.cmml" xref="Sx3.SSx1.p2.1.m1.4.4.1.3.3">1</cn></apply></apply><apply id="Sx3.SSx1.p2.1.m1.3.3.1.2.cmml" xref="Sx3.SSx1.p2.1.m1.3.3.1.1"><abs id="Sx3.SSx1.p2.1.m1.3.3.1.2.1.cmml" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.2"></abs><apply id="Sx3.SSx1.p2.1.m1.3.3.1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.1.m1.3.3.1.1.1.1.cmml" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.1.m1.3.3.1.1.1.2.cmml" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1.2">𝐷</ci><ci id="Sx3.SSx1.p2.1.m1.3.3.1.1.1.3.cmml" xref="Sx3.SSx1.p2.1.m1.3.3.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.1.m1.4c">\{X_{i,j}\}_{j=1}^{|D_{i}|}</annotation></semantics></math>. Such a set is, from a probabilistic perspective, a collection of random variables following the distribution <math id="Sx3.SSx1.p2.2.m2.1" class="ltx_Math" alttext="p_{i}(x)" display="inline"><semantics id="Sx3.SSx1.p2.2.m2.1a"><mrow id="Sx3.SSx1.p2.2.m2.1.2" xref="Sx3.SSx1.p2.2.m2.1.2.cmml"><msub id="Sx3.SSx1.p2.2.m2.1.2.2" xref="Sx3.SSx1.p2.2.m2.1.2.2.cmml"><mi id="Sx3.SSx1.p2.2.m2.1.2.2.2" xref="Sx3.SSx1.p2.2.m2.1.2.2.2.cmml">p</mi><mi id="Sx3.SSx1.p2.2.m2.1.2.2.3" xref="Sx3.SSx1.p2.2.m2.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p2.2.m2.1.2.1" xref="Sx3.SSx1.p2.2.m2.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p2.2.m2.1.2.3.2" xref="Sx3.SSx1.p2.2.m2.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.2.m2.1.2.3.2.1" xref="Sx3.SSx1.p2.2.m2.1.2.cmml">(</mo><mi id="Sx3.SSx1.p2.2.m2.1.1" xref="Sx3.SSx1.p2.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="Sx3.SSx1.p2.2.m2.1.2.3.2.2" xref="Sx3.SSx1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.2.m2.1b"><apply id="Sx3.SSx1.p2.2.m2.1.2.cmml" xref="Sx3.SSx1.p2.2.m2.1.2"><times id="Sx3.SSx1.p2.2.m2.1.2.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.2.1"></times><apply id="Sx3.SSx1.p2.2.m2.1.2.2.cmml" xref="Sx3.SSx1.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.2.m2.1.2.2.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p2.2.m2.1.2.2.2.cmml" xref="Sx3.SSx1.p2.2.m2.1.2.2.2">𝑝</ci><ci id="Sx3.SSx1.p2.2.m2.1.2.2.3.cmml" xref="Sx3.SSx1.p2.2.m2.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p2.2.m2.1.1.cmml" xref="Sx3.SSx1.p2.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.2.m2.1c">p_{i}(x)</annotation></semantics></math>. Note, that <math id="Sx3.SSx1.p2.3.m3.1" class="ltx_Math" alttext="p_{i}(x)" display="inline"><semantics id="Sx3.SSx1.p2.3.m3.1a"><mrow id="Sx3.SSx1.p2.3.m3.1.2" xref="Sx3.SSx1.p2.3.m3.1.2.cmml"><msub id="Sx3.SSx1.p2.3.m3.1.2.2" xref="Sx3.SSx1.p2.3.m3.1.2.2.cmml"><mi id="Sx3.SSx1.p2.3.m3.1.2.2.2" xref="Sx3.SSx1.p2.3.m3.1.2.2.2.cmml">p</mi><mi id="Sx3.SSx1.p2.3.m3.1.2.2.3" xref="Sx3.SSx1.p2.3.m3.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p2.3.m3.1.2.1" xref="Sx3.SSx1.p2.3.m3.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p2.3.m3.1.2.3.2" xref="Sx3.SSx1.p2.3.m3.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.3.m3.1.2.3.2.1" xref="Sx3.SSx1.p2.3.m3.1.2.cmml">(</mo><mi id="Sx3.SSx1.p2.3.m3.1.1" xref="Sx3.SSx1.p2.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="Sx3.SSx1.p2.3.m3.1.2.3.2.2" xref="Sx3.SSx1.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.3.m3.1b"><apply id="Sx3.SSx1.p2.3.m3.1.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.2"><times id="Sx3.SSx1.p2.3.m3.1.2.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.1"></times><apply id="Sx3.SSx1.p2.3.m3.1.2.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.3.m3.1.2.2.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p2.3.m3.1.2.2.2.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.2.2">𝑝</ci><ci id="Sx3.SSx1.p2.3.m3.1.2.2.3.cmml" xref="Sx3.SSx1.p2.3.m3.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p2.3.m3.1.1.cmml" xref="Sx3.SSx1.p2.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.3.m3.1c">p_{i}(x)</annotation></semantics></math>, when mapped with a function <math id="Sx3.SSx1.p2.4.m4.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="Sx3.SSx1.p2.4.m4.1a"><mi id="Sx3.SSx1.p2.4.m4.1.1" xref="Sx3.SSx1.p2.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.4.m4.1b"><ci id="Sx3.SSx1.p2.4.m4.1.1.cmml" xref="Sx3.SSx1.p2.4.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.4.m4.1c">\phi</annotation></semantics></math> to another space, induces a probability distribution over that space<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>This holds only if the function <math id="footnote2.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="footnote2.m1.1b"><mi id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><ci id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">\phi</annotation></semantics></math> is Borel measurable.</span></span></span>. Although <math id="Sx3.SSx1.p2.5.m5.1" class="ltx_Math" alttext="p_{i}(x)" display="inline"><semantics id="Sx3.SSx1.p2.5.m5.1a"><mrow id="Sx3.SSx1.p2.5.m5.1.2" xref="Sx3.SSx1.p2.5.m5.1.2.cmml"><msub id="Sx3.SSx1.p2.5.m5.1.2.2" xref="Sx3.SSx1.p2.5.m5.1.2.2.cmml"><mi id="Sx3.SSx1.p2.5.m5.1.2.2.2" xref="Sx3.SSx1.p2.5.m5.1.2.2.2.cmml">p</mi><mi id="Sx3.SSx1.p2.5.m5.1.2.2.3" xref="Sx3.SSx1.p2.5.m5.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p2.5.m5.1.2.1" xref="Sx3.SSx1.p2.5.m5.1.2.1.cmml">​</mo><mrow id="Sx3.SSx1.p2.5.m5.1.2.3.2" xref="Sx3.SSx1.p2.5.m5.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.5.m5.1.2.3.2.1" xref="Sx3.SSx1.p2.5.m5.1.2.cmml">(</mo><mi id="Sx3.SSx1.p2.5.m5.1.1" xref="Sx3.SSx1.p2.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="Sx3.SSx1.p2.5.m5.1.2.3.2.2" xref="Sx3.SSx1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.5.m5.1b"><apply id="Sx3.SSx1.p2.5.m5.1.2.cmml" xref="Sx3.SSx1.p2.5.m5.1.2"><times id="Sx3.SSx1.p2.5.m5.1.2.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.2.1"></times><apply id="Sx3.SSx1.p2.5.m5.1.2.2.cmml" xref="Sx3.SSx1.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.5.m5.1.2.2.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p2.5.m5.1.2.2.2.cmml" xref="Sx3.SSx1.p2.5.m5.1.2.2.2">𝑝</ci><ci id="Sx3.SSx1.p2.5.m5.1.2.2.3.cmml" xref="Sx3.SSx1.p2.5.m5.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx1.p2.5.m5.1.1.cmml" xref="Sx3.SSx1.p2.5.m5.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.5.m5.1c">p_{i}(x)</annotation></semantics></math> is unknown, similar to the other distributions in the DGP, the available data forms an empirical distribution which, as the number of samples <math id="Sx3.SSx1.p2.6.m6.1" class="ltx_Math" alttext="|D_{i}|" display="inline"><semantics id="Sx3.SSx1.p2.6.m6.1a"><mrow id="Sx3.SSx1.p2.6.m6.1.1.1" xref="Sx3.SSx1.p2.6.m6.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p2.6.m6.1.1.1.2" xref="Sx3.SSx1.p2.6.m6.1.1.2.1.cmml">|</mo><msub id="Sx3.SSx1.p2.6.m6.1.1.1.1" xref="Sx3.SSx1.p2.6.m6.1.1.1.1.cmml"><mi id="Sx3.SSx1.p2.6.m6.1.1.1.1.2" xref="Sx3.SSx1.p2.6.m6.1.1.1.1.2.cmml">D</mi><mi id="Sx3.SSx1.p2.6.m6.1.1.1.1.3" xref="Sx3.SSx1.p2.6.m6.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.SSx1.p2.6.m6.1.1.1.3" xref="Sx3.SSx1.p2.6.m6.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p2.6.m6.1b"><apply id="Sx3.SSx1.p2.6.m6.1.1.2.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.1"><abs id="Sx3.SSx1.p2.6.m6.1.1.2.1.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.1.2"></abs><apply id="Sx3.SSx1.p2.6.m6.1.1.1.1.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p2.6.m6.1.1.1.1.1.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p2.6.m6.1.1.1.1.2.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.1.1.2">𝐷</ci><ci id="Sx3.SSx1.p2.6.m6.1.1.1.1.3.cmml" xref="Sx3.SSx1.p2.6.m6.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p2.6.m6.1c">|D_{i}|</annotation></semantics></math> increases, increasingly well approximates the true underlying distribution – this is formally defined by the limit theorems.</p>
</div>
<div id="Sx3.SSx1.p3" class="ltx_para">
<p id="Sx3.SSx1.p3.3" class="ltx_p">Input data points might be of very high dimensionality and not semantically rich enough, thus, our function <math id="Sx3.SSx1.p3.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="Sx3.SSx1.p3.1.m1.1a"><mi id="Sx3.SSx1.p3.1.m1.1.1" xref="Sx3.SSx1.p3.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.1.m1.1b"><ci id="Sx3.SSx1.p3.1.m1.1.1.cmml" xref="Sx3.SSx1.p3.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.1.m1.1c">\phi</annotation></semantics></math> harnesses deep learning to map input data to a lower dimensional and semantically richer embedding space <math id="Sx3.SSx1.p3.2.m2.1" class="ltx_Math" alttext="\mathbb{R}^{E}" display="inline"><semantics id="Sx3.SSx1.p3.2.m2.1a"><msup id="Sx3.SSx1.p3.2.m2.1.1" xref="Sx3.SSx1.p3.2.m2.1.1.cmml"><mi id="Sx3.SSx1.p3.2.m2.1.1.2" xref="Sx3.SSx1.p3.2.m2.1.1.2.cmml">ℝ</mi><mi id="Sx3.SSx1.p3.2.m2.1.1.3" xref="Sx3.SSx1.p3.2.m2.1.1.3.cmml">E</mi></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.2.m2.1b"><apply id="Sx3.SSx1.p3.2.m2.1.1.cmml" xref="Sx3.SSx1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p3.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p3.2.m2.1.1">superscript</csymbol><ci id="Sx3.SSx1.p3.2.m2.1.1.2.cmml" xref="Sx3.SSx1.p3.2.m2.1.1.2">ℝ</ci><ci id="Sx3.SSx1.p3.2.m2.1.1.3.cmml" xref="Sx3.SSx1.p3.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.2.m2.1c">\mathbb{R}^{E}</annotation></semantics></math>. The empirical distribution of the original DGP, when mapped to the embedding space with a Borel measurable function, induces an empirical distribution over the embedding space. We can summarize the properties of the embedding space by computing a number of statistics and concatenating them into a single vector with a function <math id="Sx3.SSx1.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{S}" display="inline"><semantics id="Sx3.SSx1.p3.3.m3.1a"><mi id="Sx3.SSx1.p3.3.m3.1.1" xref="Sx3.SSx1.p3.3.m3.1.1.cmml">𝐒</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p3.3.m3.1b"><ci id="Sx3.SSx1.p3.3.m3.1.1.cmml" xref="Sx3.SSx1.p3.3.m3.1.1">𝐒</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p3.3.m3.1c">\mathbf{S}</annotation></semantics></math>. Such statistics might include the mean vector, the cross-covariance matrix, the cross-correlation matrix, the principal components, or any statistics over the marginal distributions, e.g. the skewness, the kurtosis, and quantiles.</p>
</div>
<div id="Sx3.SSx1.p4" class="ltx_para">
<p id="Sx3.SSx1.p4.1" class="ltx_p">To summarize, our hypothesis, formalized in <a href="#Sx3.E5" title="In \acronym ‣ Preliminaries and General Framework for Clustered FL ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">5</span></a>, is that statistics computed over the embedding space reasonably well reflect the DGPs. As we cannot say a priori which statistics best summarize the properties of the unknown embedding space, we identify such statistics experimentally later in the paper.</p>
<table id="Sx6.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E5.m1.8" class="ltx_Math" alttext="\displaystyle e_{i}=F(\gamma_{i})\approx f(\mathcal{D}_{i},\kappa_{i},S)\stackrel{{\scriptstyle\text{REPA}}}{{=}}\mathbf{S}(\phi(\{X_{i,j}\}_{j=1}^{|\mathcal{D}_{i}|}))" display="inline"><semantics id="Sx3.E5.m1.8a"><mrow id="Sx3.E5.m1.8.8" xref="Sx3.E5.m1.8.8.cmml"><msub id="Sx3.E5.m1.8.8.6" xref="Sx3.E5.m1.8.8.6.cmml"><mi id="Sx3.E5.m1.8.8.6.2" xref="Sx3.E5.m1.8.8.6.2.cmml">e</mi><mi id="Sx3.E5.m1.8.8.6.3" xref="Sx3.E5.m1.8.8.6.3.cmml">i</mi></msub><mo id="Sx3.E5.m1.8.8.7" xref="Sx3.E5.m1.8.8.7.cmml">=</mo><mrow id="Sx3.E5.m1.5.5.1" xref="Sx3.E5.m1.5.5.1.cmml"><mi id="Sx3.E5.m1.5.5.1.3" xref="Sx3.E5.m1.5.5.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.5.5.1.2" xref="Sx3.E5.m1.5.5.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.5.5.1.1.1" xref="Sx3.E5.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.5.5.1.1.1.2" xref="Sx3.E5.m1.5.5.1.1.1.1.cmml">(</mo><msub id="Sx3.E5.m1.5.5.1.1.1.1" xref="Sx3.E5.m1.5.5.1.1.1.1.cmml"><mi id="Sx3.E5.m1.5.5.1.1.1.1.2" xref="Sx3.E5.m1.5.5.1.1.1.1.2.cmml">γ</mi><mi id="Sx3.E5.m1.5.5.1.1.1.1.3" xref="Sx3.E5.m1.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E5.m1.5.5.1.1.1.3" xref="Sx3.E5.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E5.m1.8.8.8" xref="Sx3.E5.m1.8.8.8.cmml">≈</mo><mrow id="Sx3.E5.m1.7.7.3" xref="Sx3.E5.m1.7.7.3.cmml"><mi id="Sx3.E5.m1.7.7.3.4" xref="Sx3.E5.m1.7.7.3.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.7.7.3.3" xref="Sx3.E5.m1.7.7.3.3.cmml">​</mo><mrow id="Sx3.E5.m1.7.7.3.2.2" xref="Sx3.E5.m1.7.7.3.2.3.cmml"><mo stretchy="false" id="Sx3.E5.m1.7.7.3.2.2.3" xref="Sx3.E5.m1.7.7.3.2.3.cmml">(</mo><msub id="Sx3.E5.m1.6.6.2.1.1.1" xref="Sx3.E5.m1.6.6.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E5.m1.6.6.2.1.1.1.2" xref="Sx3.E5.m1.6.6.2.1.1.1.2.cmml">𝒟</mi><mi id="Sx3.E5.m1.6.6.2.1.1.1.3" xref="Sx3.E5.m1.6.6.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E5.m1.7.7.3.2.2.4" xref="Sx3.E5.m1.7.7.3.2.3.cmml">,</mo><msub id="Sx3.E5.m1.7.7.3.2.2.2" xref="Sx3.E5.m1.7.7.3.2.2.2.cmml"><mi id="Sx3.E5.m1.7.7.3.2.2.2.2" xref="Sx3.E5.m1.7.7.3.2.2.2.2.cmml">κ</mi><mi id="Sx3.E5.m1.7.7.3.2.2.2.3" xref="Sx3.E5.m1.7.7.3.2.2.2.3.cmml">i</mi></msub><mo id="Sx3.E5.m1.7.7.3.2.2.5" xref="Sx3.E5.m1.7.7.3.2.3.cmml">,</mo><mi id="Sx3.E5.m1.4.4" xref="Sx3.E5.m1.4.4.cmml">S</mi><mo stretchy="false" id="Sx3.E5.m1.7.7.3.2.2.6" xref="Sx3.E5.m1.7.7.3.2.3.cmml">)</mo></mrow></mrow><mover id="Sx3.E5.m1.8.8.9" xref="Sx3.E5.m1.8.8.9.cmml"><mo id="Sx3.E5.m1.8.8.9.2" xref="Sx3.E5.m1.8.8.9.2.cmml">=</mo><mtext id="Sx3.E5.m1.8.8.9.3" xref="Sx3.E5.m1.8.8.9.3a.cmml">REPA</mtext></mover><mrow id="Sx3.E5.m1.8.8.4" xref="Sx3.E5.m1.8.8.4.cmml"><mi id="Sx3.E5.m1.8.8.4.3" xref="Sx3.E5.m1.8.8.4.3.cmml">𝐒</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.8.8.4.2" xref="Sx3.E5.m1.8.8.4.2.cmml">​</mo><mrow id="Sx3.E5.m1.8.8.4.1.1" xref="Sx3.E5.m1.8.8.4.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.8.8.4.1.1.2" xref="Sx3.E5.m1.8.8.4.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m1.8.8.4.1.1.1" xref="Sx3.E5.m1.8.8.4.1.1.1.cmml"><mi id="Sx3.E5.m1.8.8.4.1.1.1.3" xref="Sx3.E5.m1.8.8.4.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.8.8.4.1.1.1.2" xref="Sx3.E5.m1.8.8.4.1.1.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.8.8.4.1.1.1.1.1" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.2" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.cmml"><mrow id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.2.cmml">{</mo><msub id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mrow id="Sx3.E5.m1.2.2.2.4" xref="Sx3.E5.m1.2.2.2.3.cmml"><mi id="Sx3.E5.m1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.cmml">i</mi><mo id="Sx3.E5.m1.2.2.2.4.1" xref="Sx3.E5.m1.2.2.2.3.cmml">,</mo><mi id="Sx3.E5.m1.2.2.2.2" xref="Sx3.E5.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.2" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.1" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.3" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="Sx3.E5.m1.3.3.1.1" xref="Sx3.E5.m1.3.3.1.2.cmml"><mo stretchy="false" id="Sx3.E5.m1.3.3.1.1.2" xref="Sx3.E5.m1.3.3.1.2.1.cmml">|</mo><msub id="Sx3.E5.m1.3.3.1.1.1" xref="Sx3.E5.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E5.m1.3.3.1.1.1.2" xref="Sx3.E5.m1.3.3.1.1.1.2.cmml">𝒟</mi><mi id="Sx3.E5.m1.3.3.1.1.1.3" xref="Sx3.E5.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E5.m1.3.3.1.1.3" xref="Sx3.E5.m1.3.3.1.2.1.cmml">|</mo></mrow></msubsup><mo stretchy="false" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.3" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E5.m1.8.8.4.1.1.3" xref="Sx3.E5.m1.8.8.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.8b"><apply id="Sx3.E5.m1.8.8.cmml" xref="Sx3.E5.m1.8.8"><and id="Sx3.E5.m1.8.8a.cmml" xref="Sx3.E5.m1.8.8"></and><apply id="Sx3.E5.m1.8.8b.cmml" xref="Sx3.E5.m1.8.8"><eq id="Sx3.E5.m1.8.8.7.cmml" xref="Sx3.E5.m1.8.8.7"></eq><apply id="Sx3.E5.m1.8.8.6.cmml" xref="Sx3.E5.m1.8.8.6"><csymbol cd="ambiguous" id="Sx3.E5.m1.8.8.6.1.cmml" xref="Sx3.E5.m1.8.8.6">subscript</csymbol><ci id="Sx3.E5.m1.8.8.6.2.cmml" xref="Sx3.E5.m1.8.8.6.2">𝑒</ci><ci id="Sx3.E5.m1.8.8.6.3.cmml" xref="Sx3.E5.m1.8.8.6.3">𝑖</ci></apply><apply id="Sx3.E5.m1.5.5.1.cmml" xref="Sx3.E5.m1.5.5.1"><times id="Sx3.E5.m1.5.5.1.2.cmml" xref="Sx3.E5.m1.5.5.1.2"></times><ci id="Sx3.E5.m1.5.5.1.3.cmml" xref="Sx3.E5.m1.5.5.1.3">𝐹</ci><apply id="Sx3.E5.m1.5.5.1.1.1.1.cmml" xref="Sx3.E5.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.5.5.1.1.1.1.1.cmml" xref="Sx3.E5.m1.5.5.1.1.1">subscript</csymbol><ci id="Sx3.E5.m1.5.5.1.1.1.1.2.cmml" xref="Sx3.E5.m1.5.5.1.1.1.1.2">𝛾</ci><ci id="Sx3.E5.m1.5.5.1.1.1.1.3.cmml" xref="Sx3.E5.m1.5.5.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E5.m1.8.8c.cmml" xref="Sx3.E5.m1.8.8"><approx id="Sx3.E5.m1.8.8.8.cmml" xref="Sx3.E5.m1.8.8.8"></approx><share href="#Sx3.E5.m1.5.5.1.cmml" id="Sx3.E5.m1.8.8d.cmml" xref="Sx3.E5.m1.8.8"></share><apply id="Sx3.E5.m1.7.7.3.cmml" xref="Sx3.E5.m1.7.7.3"><times id="Sx3.E5.m1.7.7.3.3.cmml" xref="Sx3.E5.m1.7.7.3.3"></times><ci id="Sx3.E5.m1.7.7.3.4.cmml" xref="Sx3.E5.m1.7.7.3.4">𝑓</ci><vector id="Sx3.E5.m1.7.7.3.2.3.cmml" xref="Sx3.E5.m1.7.7.3.2.2"><apply id="Sx3.E5.m1.6.6.2.1.1.1.cmml" xref="Sx3.E5.m1.6.6.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.6.6.2.1.1.1.1.cmml" xref="Sx3.E5.m1.6.6.2.1.1.1">subscript</csymbol><ci id="Sx3.E5.m1.6.6.2.1.1.1.2.cmml" xref="Sx3.E5.m1.6.6.2.1.1.1.2">𝒟</ci><ci id="Sx3.E5.m1.6.6.2.1.1.1.3.cmml" xref="Sx3.E5.m1.6.6.2.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E5.m1.7.7.3.2.2.2.cmml" xref="Sx3.E5.m1.7.7.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.7.7.3.2.2.2.1.cmml" xref="Sx3.E5.m1.7.7.3.2.2.2">subscript</csymbol><ci id="Sx3.E5.m1.7.7.3.2.2.2.2.cmml" xref="Sx3.E5.m1.7.7.3.2.2.2.2">𝜅</ci><ci id="Sx3.E5.m1.7.7.3.2.2.2.3.cmml" xref="Sx3.E5.m1.7.7.3.2.2.2.3">𝑖</ci></apply><ci id="Sx3.E5.m1.4.4.cmml" xref="Sx3.E5.m1.4.4">𝑆</ci></vector></apply></apply><apply id="Sx3.E5.m1.8.8e.cmml" xref="Sx3.E5.m1.8.8"><apply id="Sx3.E5.m1.8.8.9.cmml" xref="Sx3.E5.m1.8.8.9"><csymbol cd="ambiguous" id="Sx3.E5.m1.8.8.9.1.cmml" xref="Sx3.E5.m1.8.8.9">superscript</csymbol><eq id="Sx3.E5.m1.8.8.9.2.cmml" xref="Sx3.E5.m1.8.8.9.2"></eq><ci id="Sx3.E5.m1.8.8.9.3a.cmml" xref="Sx3.E5.m1.8.8.9.3"><mtext mathsize="70%" id="Sx3.E5.m1.8.8.9.3.cmml" xref="Sx3.E5.m1.8.8.9.3">REPA</mtext></ci></apply><share href="#Sx3.E5.m1.7.7.3.cmml" id="Sx3.E5.m1.8.8f.cmml" xref="Sx3.E5.m1.8.8"></share><apply id="Sx3.E5.m1.8.8.4.cmml" xref="Sx3.E5.m1.8.8.4"><times id="Sx3.E5.m1.8.8.4.2.cmml" xref="Sx3.E5.m1.8.8.4.2"></times><ci id="Sx3.E5.m1.8.8.4.3.cmml" xref="Sx3.E5.m1.8.8.4.3">𝐒</ci><apply id="Sx3.E5.m1.8.8.4.1.1.1.cmml" xref="Sx3.E5.m1.8.8.4.1.1"><times id="Sx3.E5.m1.8.8.4.1.1.1.2.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.2"></times><ci id="Sx3.E5.m1.8.8.4.1.1.1.3.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.3">italic-ϕ</ci><apply id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1">subscript</csymbol><set id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1"><apply id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><list id="Sx3.E5.m1.2.2.2.3.cmml" xref="Sx3.E5.m1.2.2.2.4"><ci id="Sx3.E5.m1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1">𝑖</ci><ci id="Sx3.E5.m1.2.2.2.2.cmml" xref="Sx3.E5.m1.2.2.2.2">𝑗</ci></list></apply></set><apply id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3"><eq id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.1"></eq><ci id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E5.m1.8.8.4.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="Sx3.E5.m1.3.3.1.2.cmml" xref="Sx3.E5.m1.3.3.1.1"><abs id="Sx3.E5.m1.3.3.1.2.1.cmml" xref="Sx3.E5.m1.3.3.1.1.2"></abs><apply id="Sx3.E5.m1.3.3.1.1.1.cmml" xref="Sx3.E5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.3.3.1.1.1.1.cmml" xref="Sx3.E5.m1.3.3.1.1.1">subscript</csymbol><ci id="Sx3.E5.m1.3.3.1.1.1.2.cmml" xref="Sx3.E5.m1.3.3.1.1.1.2">𝒟</ci><ci id="Sx3.E5.m1.3.3.1.1.1.3.cmml" xref="Sx3.E5.m1.3.3.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.8c">\displaystyle e_{i}=F(\gamma_{i})\approx f(\mathcal{D}_{i},\kappa_{i},S)\stackrel{{\scriptstyle\text{REPA}}}{{=}}\mathbf{S}(\phi(\{X_{i,j}\}_{j=1}^{|\mathcal{D}_{i}|}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx3.SSx1.p5" class="ltx_para">
<p id="Sx3.SSx1.p5.2" class="ltx_p">The function <math id="Sx3.SSx1.p5.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="Sx3.SSx1.p5.1.m1.1a"><mi id="Sx3.SSx1.p5.1.m1.1.1" xref="Sx3.SSx1.p5.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.1.m1.1b"><ci id="Sx3.SSx1.p5.1.m1.1.1.cmml" xref="Sx3.SSx1.p5.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.1.m1.1c">\phi</annotation></semantics></math> used to map the individual data points <math id="Sx3.SSx1.p5.2.m2.2" class="ltx_Math" alttext="X_{i,j}" display="inline"><semantics id="Sx3.SSx1.p5.2.m2.2a"><msub id="Sx3.SSx1.p5.2.m2.2.3" xref="Sx3.SSx1.p5.2.m2.2.3.cmml"><mi id="Sx3.SSx1.p5.2.m2.2.3.2" xref="Sx3.SSx1.p5.2.m2.2.3.2.cmml">X</mi><mrow id="Sx3.SSx1.p5.2.m2.2.2.2.4" xref="Sx3.SSx1.p5.2.m2.2.2.2.3.cmml"><mi id="Sx3.SSx1.p5.2.m2.1.1.1.1" xref="Sx3.SSx1.p5.2.m2.1.1.1.1.cmml">i</mi><mo id="Sx3.SSx1.p5.2.m2.2.2.2.4.1" xref="Sx3.SSx1.p5.2.m2.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx1.p5.2.m2.2.2.2.2" xref="Sx3.SSx1.p5.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p5.2.m2.2b"><apply id="Sx3.SSx1.p5.2.m2.2.3.cmml" xref="Sx3.SSx1.p5.2.m2.2.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p5.2.m2.2.3.1.cmml" xref="Sx3.SSx1.p5.2.m2.2.3">subscript</csymbol><ci id="Sx3.SSx1.p5.2.m2.2.3.2.cmml" xref="Sx3.SSx1.p5.2.m2.2.3.2">𝑋</ci><list id="Sx3.SSx1.p5.2.m2.2.2.2.3.cmml" xref="Sx3.SSx1.p5.2.m2.2.2.2.4"><ci id="Sx3.SSx1.p5.2.m2.1.1.1.1.cmml" xref="Sx3.SSx1.p5.2.m2.1.1.1.1">𝑖</ci><ci id="Sx3.SSx1.p5.2.m2.2.2.2.2.cmml" xref="Sx3.SSx1.p5.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p5.2.m2.2c">X_{i,j}</annotation></semantics></math> to the embedding space might be a pre-trained encoder network or the encoder part of a network trained with FL. There are various ways to train such an encoder. For instance, through a self-supervised task with clients jointly training an autoencoder in an FL setting. Or, for instance, in a fully supervised manner, with clients training the target inference model for a predefined number of epochs, and after such a pre-training stage, the lower layers in the network might be used for mapping the input data points to the embedding space. The positive side of the former approach is that the encoder would not be tied to a particular classification and regression task, while the latter brings the benefit of the embeddings reflecting both the distribution over the target variables and the properties of the input data. Another benefit of using the target inference model is the fact, that there would be no need for training any additional model.</p>
</div>
<div id="Sx3.SSx1.p6" class="ltx_para">
<p id="Sx3.SSx1.p6.1" class="ltx_p">In <span id="Sx3.SSx1.p6.1.1" class="ltx_ERROR undefined">\acronym</span>, however, we also tested the appropriateness of an intermediate path, i.e. the <span id="Sx3.SSx1.p6.1.2" class="ltx_text ltx_font_italic">supervised autoencoder</span> <cite class="ltx_cite ltx_citemacro_citep">(Le, Patterson, and White <a href="#bib.bib11" title="" class="ltx_ref">2018</a>)</cite>. This model architecture is an example of the multi-loss training paradigm in which multiple losses are optimized at the same time – in our case, the classification or regression loss, and the reconstruction loss. The supervised autoencoder architecture consists therefore of <span id="Sx3.SSx1.p6.1.3" class="ltx_text ltx_font_italic">i) </span>an encoder network, which takes the input data points and produces the embeddings, <span id="Sx3.SSx1.p6.1.4" class="ltx_text ltx_font_italic">ii)</span> a classification or regression head, which takes the embeddings as produced by the encoder and uses them for predicting the target variables, and <span id="Sx3.SSx1.p6.1.5" class="ltx_text ltx_font_italic">iii)</span> a decoder head, which takes the same embeddings and aims to reconstruct the input data points. The rationale behind this approach is that by introducing the reconstruction term, the embedding space is expected to better reflect the properties of the underlying features of the data points.</p>
</div>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experimental Analysis</h2>

<div id="Sx4.p1" class="ltx_para">
<p id="Sx4.p1.1" class="ltx_p">The goal of our experimental analysis is twofold. First, we want to confirm that <span id="Sx4.p1.1.1" class="ltx_ERROR undefined">\acronym</span>client embeddings indeed reflect the actual data non-IIDness of federated datasets, and second, we want to assess the inference accuracy of clustered FL guided by <span id="Sx4.p1.1.2" class="ltx_ERROR undefined">\acronym</span>.</p>
</div>
<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Experimental setup</h3>

<div id="Sx4.SSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.p1.1" class="ltx_p">In our analysis, we focus on two types of non-IIDness that can be observed even in unlabeled data: the concept drift and the label skew described in the Preliminaries section. We investigate three datasets: 
<span id="Sx4.I4" class="ltx_inline-enumerate">
<span id="Sx4.I4.i1" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item"><span id="Sx4.I4.i1.1.1.1" class="ltx_text ltx_font_italic">a</span>)</span> <span id="Sx4.I4.i1.4" class="ltx_text">CIFAR10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky and Hinton <a href="#bib.bib10" title="" class="ltx_ref">2009</a>)</cite>, for which we simulate the label skew by sampling data in a biased way (i.e. each client has a number of over- and other under-represented classes), and the concept drift by applying a different image augmentation pipeline on every client (e.g. on some clients the images are blurred, on others, the images are transformed to black and white, etc.); </span></span>
<span id="Sx4.I4.i2" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item"><span id="Sx4.I4.i2.1.1.1" class="ltx_text ltx_font_italic">b</span>)</span> <span id="Sx4.I4.i2.4" class="ltx_text">FEMNIST <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al. <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>, which naturally contains the two considered non-IIDness types, and </span></span>
<span id="Sx4.I4.i3" class="ltx_inline-item"><span class="ltx_tag ltx_tag_inline-item"><span id="Sx4.I4.i3.1.1.1" class="ltx_text ltx_font_italic">c</span>)</span> <span id="Sx4.I4.i3.4" class="ltx_text">MNIST with pathological non-IIDness <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite>, which is obtained by partitioning the MNIST dataset <cite class="ltx_cite ltx_citemacro_citep">(Deng <a href="#bib.bib4" title="" class="ltx_ref">2012</a>)</cite> in such a way that each of the artificially-generated clients contains images belonging to only two out of the ten available classes. </span></span>
</span></p>
</div>
<div id="Sx4.SSx1.p2" class="ltx_para">
<p id="Sx4.SSx1.p2.2" class="ltx_p">Unless otherwise noted, the generated clients are randomly partitioned into two disjoint sets. The first set is the training clients <math id="Sx4.SSx1.p2.1.m1.1" class="ltx_Math" alttext="C_{t}" display="inline"><semantics id="Sx4.SSx1.p2.1.m1.1a"><msub id="Sx4.SSx1.p2.1.m1.1.1" xref="Sx4.SSx1.p2.1.m1.1.1.cmml"><mi id="Sx4.SSx1.p2.1.m1.1.1.2" xref="Sx4.SSx1.p2.1.m1.1.1.2.cmml">C</mi><mi id="Sx4.SSx1.p2.1.m1.1.1.3" xref="Sx4.SSx1.p2.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.1.m1.1b"><apply id="Sx4.SSx1.p2.1.m1.1.1.cmml" xref="Sx4.SSx1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p2.1.m1.1.1.1.cmml" xref="Sx4.SSx1.p2.1.m1.1.1">subscript</csymbol><ci id="Sx4.SSx1.p2.1.m1.1.1.2.cmml" xref="Sx4.SSx1.p2.1.m1.1.1.2">𝐶</ci><ci id="Sx4.SSx1.p2.1.m1.1.1.3.cmml" xref="Sx4.SSx1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.1.m1.1c">C_{t}</annotation></semantics></math>, which participate in the training procedure and therefore have both a training and validation set. The second set of clients <math id="Sx4.SSx1.p2.2.m2.1" class="ltx_Math" alttext="C_{h}" display="inline"><semantics id="Sx4.SSx1.p2.2.m2.1a"><msub id="Sx4.SSx1.p2.2.m2.1.1" xref="Sx4.SSx1.p2.2.m2.1.1.cmml"><mi id="Sx4.SSx1.p2.2.m2.1.1.2" xref="Sx4.SSx1.p2.2.m2.1.1.2.cmml">C</mi><mi id="Sx4.SSx1.p2.2.m2.1.1.3" xref="Sx4.SSx1.p2.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p2.2.m2.1b"><apply id="Sx4.SSx1.p2.2.m2.1.1.cmml" xref="Sx4.SSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p2.2.m2.1.1.1.cmml" xref="Sx4.SSx1.p2.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx1.p2.2.m2.1.1.2.cmml" xref="Sx4.SSx1.p2.2.m2.1.1.2">𝐶</ci><ci id="Sx4.SSx1.p2.2.m2.1.1.3.cmml" xref="Sx4.SSx1.p2.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p2.2.m2.1c">C_{h}</annotation></semantics></math> is composed of the holdout clients, which only have a validation set. For the purpose of clustering, the training clients compute their client embeddings using their training dataset, while holdout clients compute it using their validation dataset.</p>
</div>
<div id="Sx4.SSx1.p3" class="ltx_para">
<p id="Sx4.SSx1.p3.6" class="ltx_p">Throughout this experimental section, we are going to be comparing the client embeddings as produced by the <span id="Sx4.SSx1.p3.6.1" class="ltx_ERROR undefined">\acronym</span>algorithm with the method proposed by <cite class="ltx_cite ltx_citemacro_citep">(Briggs, Fan, and Andras <a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>, i.e. computing client embeddings as <math id="Sx4.SSx1.p3.1.m1.1" class="ltx_Math" alttext="e_{i}=\theta^{T}-\theta_{i}^{T+1}" display="inline"><semantics id="Sx4.SSx1.p3.1.m1.1a"><mrow id="Sx4.SSx1.p3.1.m1.1.1" xref="Sx4.SSx1.p3.1.m1.1.1.cmml"><msub id="Sx4.SSx1.p3.1.m1.1.1.2" xref="Sx4.SSx1.p3.1.m1.1.1.2.cmml"><mi id="Sx4.SSx1.p3.1.m1.1.1.2.2" xref="Sx4.SSx1.p3.1.m1.1.1.2.2.cmml">e</mi><mi id="Sx4.SSx1.p3.1.m1.1.1.2.3" xref="Sx4.SSx1.p3.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="Sx4.SSx1.p3.1.m1.1.1.1" xref="Sx4.SSx1.p3.1.m1.1.1.1.cmml">=</mo><mrow id="Sx4.SSx1.p3.1.m1.1.1.3" xref="Sx4.SSx1.p3.1.m1.1.1.3.cmml"><msup id="Sx4.SSx1.p3.1.m1.1.1.3.2" xref="Sx4.SSx1.p3.1.m1.1.1.3.2.cmml"><mi id="Sx4.SSx1.p3.1.m1.1.1.3.2.2" xref="Sx4.SSx1.p3.1.m1.1.1.3.2.2.cmml">θ</mi><mi id="Sx4.SSx1.p3.1.m1.1.1.3.2.3" xref="Sx4.SSx1.p3.1.m1.1.1.3.2.3.cmml">T</mi></msup><mo id="Sx4.SSx1.p3.1.m1.1.1.3.1" xref="Sx4.SSx1.p3.1.m1.1.1.3.1.cmml">−</mo><msubsup id="Sx4.SSx1.p3.1.m1.1.1.3.3" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.cmml"><mi id="Sx4.SSx1.p3.1.m1.1.1.3.3.2.2" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.2.2.cmml">θ</mi><mi id="Sx4.SSx1.p3.1.m1.1.1.3.3.2.3" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.2.3.cmml">i</mi><mrow id="Sx4.SSx1.p3.1.m1.1.1.3.3.3" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.cmml"><mi id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.2" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.2.cmml">T</mi><mo id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.1" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.1.cmml">+</mo><mn id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.3" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.1.m1.1b"><apply id="Sx4.SSx1.p3.1.m1.1.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1"><eq id="Sx4.SSx1.p3.1.m1.1.1.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.1"></eq><apply id="Sx4.SSx1.p3.1.m1.1.1.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.1.m1.1.1.2.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.2">subscript</csymbol><ci id="Sx4.SSx1.p3.1.m1.1.1.2.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.2.2">𝑒</ci><ci id="Sx4.SSx1.p3.1.m1.1.1.2.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.2.3">𝑖</ci></apply><apply id="Sx4.SSx1.p3.1.m1.1.1.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3"><minus id="Sx4.SSx1.p3.1.m1.1.1.3.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.1"></minus><apply id="Sx4.SSx1.p3.1.m1.1.1.3.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.1.m1.1.1.3.2.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.2">superscript</csymbol><ci id="Sx4.SSx1.p3.1.m1.1.1.3.2.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.2.2">𝜃</ci><ci id="Sx4.SSx1.p3.1.m1.1.1.3.2.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.2.3">𝑇</ci></apply><apply id="Sx4.SSx1.p3.1.m1.1.1.3.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.1.m1.1.1.3.3.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3">superscript</csymbol><apply id="Sx4.SSx1.p3.1.m1.1.1.3.3.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.1.m1.1.1.3.3.2.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="Sx4.SSx1.p3.1.m1.1.1.3.3.2.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.2.2">𝜃</ci><ci id="Sx4.SSx1.p3.1.m1.1.1.3.3.2.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.2.3">𝑖</ci></apply><apply id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3"><plus id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.1.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.1"></plus><ci id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.2.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.2">𝑇</ci><cn type="integer" id="Sx4.SSx1.p3.1.m1.1.1.3.3.3.3.cmml" xref="Sx4.SSx1.p3.1.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.1.m1.1c">e_{i}=\theta^{T}-\theta_{i}^{T+1}</annotation></semantics></math>, where <math id="Sx4.SSx1.p3.2.m2.1" class="ltx_Math" alttext="\theta_{i}^{T+1}" display="inline"><semantics id="Sx4.SSx1.p3.2.m2.1a"><msubsup id="Sx4.SSx1.p3.2.m2.1.1" xref="Sx4.SSx1.p3.2.m2.1.1.cmml"><mi id="Sx4.SSx1.p3.2.m2.1.1.2.2" xref="Sx4.SSx1.p3.2.m2.1.1.2.2.cmml">θ</mi><mi id="Sx4.SSx1.p3.2.m2.1.1.2.3" xref="Sx4.SSx1.p3.2.m2.1.1.2.3.cmml">i</mi><mrow id="Sx4.SSx1.p3.2.m2.1.1.3" xref="Sx4.SSx1.p3.2.m2.1.1.3.cmml"><mi id="Sx4.SSx1.p3.2.m2.1.1.3.2" xref="Sx4.SSx1.p3.2.m2.1.1.3.2.cmml">T</mi><mo id="Sx4.SSx1.p3.2.m2.1.1.3.1" xref="Sx4.SSx1.p3.2.m2.1.1.3.1.cmml">+</mo><mn id="Sx4.SSx1.p3.2.m2.1.1.3.3" xref="Sx4.SSx1.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.2.m2.1b"><apply id="Sx4.SSx1.p3.2.m2.1.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.2.m2.1.1.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1">superscript</csymbol><apply id="Sx4.SSx1.p3.2.m2.1.1.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.2.m2.1.1.2.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.2.m2.1.1.2.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.2.2">𝜃</ci><ci id="Sx4.SSx1.p3.2.m2.1.1.2.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.2.3">𝑖</ci></apply><apply id="Sx4.SSx1.p3.2.m2.1.1.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.3"><plus id="Sx4.SSx1.p3.2.m2.1.1.3.1.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.3.1"></plus><ci id="Sx4.SSx1.p3.2.m2.1.1.3.2.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.3.2">𝑇</ci><cn type="integer" id="Sx4.SSx1.p3.2.m2.1.1.3.3.cmml" xref="Sx4.SSx1.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.2.m2.1c">\theta_{i}^{T+1}</annotation></semantics></math> is the model obtained after training the model <math id="Sx4.SSx1.p3.3.m3.1" class="ltx_Math" alttext="\theta^{T}" display="inline"><semantics id="Sx4.SSx1.p3.3.m3.1a"><msup id="Sx4.SSx1.p3.3.m3.1.1" xref="Sx4.SSx1.p3.3.m3.1.1.cmml"><mi id="Sx4.SSx1.p3.3.m3.1.1.2" xref="Sx4.SSx1.p3.3.m3.1.1.2.cmml">θ</mi><mi id="Sx4.SSx1.p3.3.m3.1.1.3" xref="Sx4.SSx1.p3.3.m3.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.3.m3.1b"><apply id="Sx4.SSx1.p3.3.m3.1.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.3.m3.1.1.1.cmml" xref="Sx4.SSx1.p3.3.m3.1.1">superscript</csymbol><ci id="Sx4.SSx1.p3.3.m3.1.1.2.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.2">𝜃</ci><ci id="Sx4.SSx1.p3.3.m3.1.1.3.cmml" xref="Sx4.SSx1.p3.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.3.m3.1c">\theta^{T}</annotation></semantics></math> on client <math id="Sx4.SSx1.p3.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx4.SSx1.p3.4.m4.1a"><mi id="Sx4.SSx1.p3.4.m4.1.1" xref="Sx4.SSx1.p3.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.4.m4.1b"><ci id="Sx4.SSx1.p3.4.m4.1.1.cmml" xref="Sx4.SSx1.p3.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.4.m4.1c">i</annotation></semantics></math>’s dataset <math id="Sx4.SSx1.p3.5.m5.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx4.SSx1.p3.5.m5.1a"><msub id="Sx4.SSx1.p3.5.m5.1.1" xref="Sx4.SSx1.p3.5.m5.1.1.cmml"><mi id="Sx4.SSx1.p3.5.m5.1.1.2" xref="Sx4.SSx1.p3.5.m5.1.1.2.cmml">D</mi><mi id="Sx4.SSx1.p3.5.m5.1.1.3" xref="Sx4.SSx1.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.5.m5.1b"><apply id="Sx4.SSx1.p3.5.m5.1.1.cmml" xref="Sx4.SSx1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p3.5.m5.1.1.1.cmml" xref="Sx4.SSx1.p3.5.m5.1.1">subscript</csymbol><ci id="Sx4.SSx1.p3.5.m5.1.1.2.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.2">𝐷</ci><ci id="Sx4.SSx1.p3.5.m5.1.1.3.cmml" xref="Sx4.SSx1.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.5.m5.1c">D_{i}</annotation></semantics></math> for <math id="Sx4.SSx1.p3.6.m6.1" class="ltx_Math" alttext="f" display="inline"><semantics id="Sx4.SSx1.p3.6.m6.1a"><mi id="Sx4.SSx1.p3.6.m6.1.1" xref="Sx4.SSx1.p3.6.m6.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p3.6.m6.1b"><ci id="Sx4.SSx1.p3.6.m6.1.1.cmml" xref="Sx4.SSx1.p3.6.m6.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p3.6.m6.1c">f</annotation></semantics></math> training epochs – for conciseness, we refer to such an algorithm as WD (weight-difference). However, note that the WD method requires on-device training with a labeled dataset, thus, its use for computing client embeddings on holdout clients might not be possible in reality.</p>
</div>
<div id="Sx4.SSx1.p4" class="ltx_para">
<p id="Sx4.SSx1.p4.1" class="ltx_p">Regarding the model architecture, as a basis we use a simple encoder-decoder-classification head architecture with convolutional, ReLU, max pooling, and Softmax layers detailed in the Appendix. The encoder-classification head architecture is used for calculating WD’s embeddings, while the encoder output is used for the <span id="Sx4.SSx1.p4.1.1" class="ltx_ERROR undefined">\acronym</span>-based clustering. In case of <span id="Sx4.SSx1.p4.1.2" class="ltx_ERROR undefined">\acronym</span>, the encoder is connected to either the classification head only (CLF), the decoder, thus forming an autoencoder (AE), or to both the classification head and the decoder, forming a supervised autoencoder (SAE). Unless stated otherwise, we use SAE.</p>
</div>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Correlation between Client Embeddings and Data-Generation Processes</h3>

<div id="Sx4.SSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.p1.1" class="ltx_p">To estimate whether the embeddings reflect the actual non-IIDness, we first need to measure the similarity between two clients, i.e. the similarity of their underlying DGPs. Since we do not observe the DGPs directly we define the similarity between clients <math id="Sx4.SSx2.p1.1.m1.2" class="ltx_Math" alttext="i,j\in C" display="inline"><semantics id="Sx4.SSx2.p1.1.m1.2a"><mrow id="Sx4.SSx2.p1.1.m1.2.3" xref="Sx4.SSx2.p1.1.m1.2.3.cmml"><mrow id="Sx4.SSx2.p1.1.m1.2.3.2.2" xref="Sx4.SSx2.p1.1.m1.2.3.2.1.cmml"><mi id="Sx4.SSx2.p1.1.m1.1.1" xref="Sx4.SSx2.p1.1.m1.1.1.cmml">i</mi><mo id="Sx4.SSx2.p1.1.m1.2.3.2.2.1" xref="Sx4.SSx2.p1.1.m1.2.3.2.1.cmml">,</mo><mi id="Sx4.SSx2.p1.1.m1.2.2" xref="Sx4.SSx2.p1.1.m1.2.2.cmml">j</mi></mrow><mo id="Sx4.SSx2.p1.1.m1.2.3.1" xref="Sx4.SSx2.p1.1.m1.2.3.1.cmml">∈</mo><mi id="Sx4.SSx2.p1.1.m1.2.3.3" xref="Sx4.SSx2.p1.1.m1.2.3.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.1.m1.2b"><apply id="Sx4.SSx2.p1.1.m1.2.3.cmml" xref="Sx4.SSx2.p1.1.m1.2.3"><in id="Sx4.SSx2.p1.1.m1.2.3.1.cmml" xref="Sx4.SSx2.p1.1.m1.2.3.1"></in><list id="Sx4.SSx2.p1.1.m1.2.3.2.1.cmml" xref="Sx4.SSx2.p1.1.m1.2.3.2.2"><ci id="Sx4.SSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1">𝑖</ci><ci id="Sx4.SSx2.p1.1.m1.2.2.cmml" xref="Sx4.SSx2.p1.1.m1.2.2">𝑗</ci></list><ci id="Sx4.SSx2.p1.1.m1.2.3.3.cmml" xref="Sx4.SSx2.p1.1.m1.2.3.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.1.m1.2c">i,j\in C</annotation></semantics></math> as:</p>
<table id="Sx6.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx4.E6.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{S}(i,j)\stackrel{{\scriptstyle\text{def}}}{{=}}\mathcal{S}(\gamma_{i},\gamma_{j})\approx\mathcal{S}(D_{i},D_{j})." display="inline"><semantics id="Sx4.E6.m1.3a"><mrow id="Sx4.E6.m1.3.3.1" xref="Sx4.E6.m1.3.3.1.1.cmml"><mrow id="Sx4.E6.m1.3.3.1.1" xref="Sx4.E6.m1.3.3.1.1.cmml"><mrow id="Sx4.E6.m1.3.3.1.1.6" xref="Sx4.E6.m1.3.3.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.E6.m1.3.3.1.1.6.2" xref="Sx4.E6.m1.3.3.1.1.6.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Sx4.E6.m1.3.3.1.1.6.1" xref="Sx4.E6.m1.3.3.1.1.6.1.cmml">​</mo><mrow id="Sx4.E6.m1.3.3.1.1.6.3.2" xref="Sx4.E6.m1.3.3.1.1.6.3.1.cmml"><mo stretchy="false" id="Sx4.E6.m1.3.3.1.1.6.3.2.1" xref="Sx4.E6.m1.3.3.1.1.6.3.1.cmml">(</mo><mi id="Sx4.E6.m1.1.1" xref="Sx4.E6.m1.1.1.cmml">i</mi><mo id="Sx4.E6.m1.3.3.1.1.6.3.2.2" xref="Sx4.E6.m1.3.3.1.1.6.3.1.cmml">,</mo><mi id="Sx4.E6.m1.2.2" xref="Sx4.E6.m1.2.2.cmml">j</mi><mo stretchy="false" id="Sx4.E6.m1.3.3.1.1.6.3.2.3" xref="Sx4.E6.m1.3.3.1.1.6.3.1.cmml">)</mo></mrow></mrow><mover id="Sx4.E6.m1.3.3.1.1.7" xref="Sx4.E6.m1.3.3.1.1.7.cmml"><mo id="Sx4.E6.m1.3.3.1.1.7.2" xref="Sx4.E6.m1.3.3.1.1.7.2.cmml">=</mo><mtext id="Sx4.E6.m1.3.3.1.1.7.3" xref="Sx4.E6.m1.3.3.1.1.7.3a.cmml">def</mtext></mover><mrow id="Sx4.E6.m1.3.3.1.1.2" xref="Sx4.E6.m1.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.E6.m1.3.3.1.1.2.4" xref="Sx4.E6.m1.3.3.1.1.2.4.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Sx4.E6.m1.3.3.1.1.2.3" xref="Sx4.E6.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="Sx4.E6.m1.3.3.1.1.2.2.2" xref="Sx4.E6.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx4.E6.m1.3.3.1.1.2.2.2.3" xref="Sx4.E6.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="Sx4.E6.m1.3.3.1.1.1.1.1.1" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mi id="Sx4.E6.m1.3.3.1.1.1.1.1.1.2" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">γ</mi><mi id="Sx4.E6.m1.3.3.1.1.1.1.1.1.3" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx4.E6.m1.3.3.1.1.2.2.2.4" xref="Sx4.E6.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="Sx4.E6.m1.3.3.1.1.2.2.2.2" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2.cmml"><mi id="Sx4.E6.m1.3.3.1.1.2.2.2.2.2" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2.2.cmml">γ</mi><mi id="Sx4.E6.m1.3.3.1.1.2.2.2.2.3" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.E6.m1.3.3.1.1.2.2.2.5" xref="Sx4.E6.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx4.E6.m1.3.3.1.1.8" xref="Sx4.E6.m1.3.3.1.1.8.cmml">≈</mo><mrow id="Sx4.E6.m1.3.3.1.1.4" xref="Sx4.E6.m1.3.3.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.E6.m1.3.3.1.1.4.4" xref="Sx4.E6.m1.3.3.1.1.4.4.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Sx4.E6.m1.3.3.1.1.4.3" xref="Sx4.E6.m1.3.3.1.1.4.3.cmml">​</mo><mrow id="Sx4.E6.m1.3.3.1.1.4.2.2" xref="Sx4.E6.m1.3.3.1.1.4.2.3.cmml"><mo stretchy="false" id="Sx4.E6.m1.3.3.1.1.4.2.2.3" xref="Sx4.E6.m1.3.3.1.1.4.2.3.cmml">(</mo><msub id="Sx4.E6.m1.3.3.1.1.3.1.1.1" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1.cmml"><mi id="Sx4.E6.m1.3.3.1.1.3.1.1.1.2" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1.2.cmml">D</mi><mi id="Sx4.E6.m1.3.3.1.1.3.1.1.1.3" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1.3.cmml">i</mi></msub><mo id="Sx4.E6.m1.3.3.1.1.4.2.2.4" xref="Sx4.E6.m1.3.3.1.1.4.2.3.cmml">,</mo><msub id="Sx4.E6.m1.3.3.1.1.4.2.2.2" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2.cmml"><mi id="Sx4.E6.m1.3.3.1.1.4.2.2.2.2" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2.2.cmml">D</mi><mi id="Sx4.E6.m1.3.3.1.1.4.2.2.2.3" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.E6.m1.3.3.1.1.4.2.2.5" xref="Sx4.E6.m1.3.3.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx4.E6.m1.3.3.1.2" xref="Sx4.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E6.m1.3b"><apply id="Sx4.E6.m1.3.3.1.1.cmml" xref="Sx4.E6.m1.3.3.1"><and id="Sx4.E6.m1.3.3.1.1a.cmml" xref="Sx4.E6.m1.3.3.1"></and><apply id="Sx4.E6.m1.3.3.1.1b.cmml" xref="Sx4.E6.m1.3.3.1"><apply id="Sx4.E6.m1.3.3.1.1.7.cmml" xref="Sx4.E6.m1.3.3.1.1.7"><csymbol cd="ambiguous" id="Sx4.E6.m1.3.3.1.1.7.1.cmml" xref="Sx4.E6.m1.3.3.1.1.7">superscript</csymbol><eq id="Sx4.E6.m1.3.3.1.1.7.2.cmml" xref="Sx4.E6.m1.3.3.1.1.7.2"></eq><ci id="Sx4.E6.m1.3.3.1.1.7.3a.cmml" xref="Sx4.E6.m1.3.3.1.1.7.3"><mtext mathsize="70%" id="Sx4.E6.m1.3.3.1.1.7.3.cmml" xref="Sx4.E6.m1.3.3.1.1.7.3">def</mtext></ci></apply><apply id="Sx4.E6.m1.3.3.1.1.6.cmml" xref="Sx4.E6.m1.3.3.1.1.6"><times id="Sx4.E6.m1.3.3.1.1.6.1.cmml" xref="Sx4.E6.m1.3.3.1.1.6.1"></times><ci id="Sx4.E6.m1.3.3.1.1.6.2.cmml" xref="Sx4.E6.m1.3.3.1.1.6.2">𝒮</ci><interval closure="open" id="Sx4.E6.m1.3.3.1.1.6.3.1.cmml" xref="Sx4.E6.m1.3.3.1.1.6.3.2"><ci id="Sx4.E6.m1.1.1.cmml" xref="Sx4.E6.m1.1.1">𝑖</ci><ci id="Sx4.E6.m1.2.2.cmml" xref="Sx4.E6.m1.2.2">𝑗</ci></interval></apply><apply id="Sx4.E6.m1.3.3.1.1.2.cmml" xref="Sx4.E6.m1.3.3.1.1.2"><times id="Sx4.E6.m1.3.3.1.1.2.3.cmml" xref="Sx4.E6.m1.3.3.1.1.2.3"></times><ci id="Sx4.E6.m1.3.3.1.1.2.4.cmml" xref="Sx4.E6.m1.3.3.1.1.2.4">𝒮</ci><interval closure="open" id="Sx4.E6.m1.3.3.1.1.2.2.3.cmml" xref="Sx4.E6.m1.3.3.1.1.2.2.2"><apply id="Sx4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1.2">𝛾</ci><ci id="Sx4.E6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="Sx4.E6.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx4.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.E6.m1.3.3.1.1.2.2.2.2.1.cmml" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="Sx4.E6.m1.3.3.1.1.2.2.2.2.2.cmml" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2.2">𝛾</ci><ci id="Sx4.E6.m1.3.3.1.1.2.2.2.2.3.cmml" xref="Sx4.E6.m1.3.3.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply><apply id="Sx4.E6.m1.3.3.1.1c.cmml" xref="Sx4.E6.m1.3.3.1"><approx id="Sx4.E6.m1.3.3.1.1.8.cmml" xref="Sx4.E6.m1.3.3.1.1.8"></approx><share href="#Sx4.E6.m1.3.3.1.1.2.cmml" id="Sx4.E6.m1.3.3.1.1d.cmml" xref="Sx4.E6.m1.3.3.1"></share><apply id="Sx4.E6.m1.3.3.1.1.4.cmml" xref="Sx4.E6.m1.3.3.1.1.4"><times id="Sx4.E6.m1.3.3.1.1.4.3.cmml" xref="Sx4.E6.m1.3.3.1.1.4.3"></times><ci id="Sx4.E6.m1.3.3.1.1.4.4.cmml" xref="Sx4.E6.m1.3.3.1.1.4.4">𝒮</ci><interval closure="open" id="Sx4.E6.m1.3.3.1.1.4.2.3.cmml" xref="Sx4.E6.m1.3.3.1.1.4.2.2"><apply id="Sx4.E6.m1.3.3.1.1.3.1.1.1.cmml" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1"><csymbol cd="ambiguous" id="Sx4.E6.m1.3.3.1.1.3.1.1.1.1.cmml" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1">subscript</csymbol><ci id="Sx4.E6.m1.3.3.1.1.3.1.1.1.2.cmml" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1.2">𝐷</ci><ci id="Sx4.E6.m1.3.3.1.1.3.1.1.1.3.cmml" xref="Sx4.E6.m1.3.3.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="Sx4.E6.m1.3.3.1.1.4.2.2.2.cmml" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="Sx4.E6.m1.3.3.1.1.4.2.2.2.1.cmml" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2">subscript</csymbol><ci id="Sx4.E6.m1.3.3.1.1.4.2.2.2.2.cmml" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2.2">𝐷</ci><ci id="Sx4.E6.m1.3.3.1.1.4.2.2.2.3.cmml" xref="Sx4.E6.m1.3.3.1.1.4.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E6.m1.3c">\displaystyle\mathcal{S}(i,j)\stackrel{{\scriptstyle\text{def}}}{{=}}\mathcal{S}(\gamma_{i},\gamma_{j})\approx\mathcal{S}(D_{i},D_{j}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx4.SSx2.p2" class="ltx_para">
<p id="Sx4.SSx2.p2.1" class="ltx_p">How exactly is <math id="Sx4.SSx2.p2.1.m1.2" class="ltx_Math" alttext="\mathcal{S}(D_{i},D_{j})" display="inline"><semantics id="Sx4.SSx2.p2.1.m1.2a"><mrow id="Sx4.SSx2.p2.1.m1.2.2" xref="Sx4.SSx2.p2.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx2.p2.1.m1.2.2.4" xref="Sx4.SSx2.p2.1.m1.2.2.4.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p2.1.m1.2.2.3" xref="Sx4.SSx2.p2.1.m1.2.2.3.cmml">​</mo><mrow id="Sx4.SSx2.p2.1.m1.2.2.2.2" xref="Sx4.SSx2.p2.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="Sx4.SSx2.p2.1.m1.2.2.2.2.3" xref="Sx4.SSx2.p2.1.m1.2.2.2.3.cmml">(</mo><msub id="Sx4.SSx2.p2.1.m1.1.1.1.1.1" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1.cmml"><mi id="Sx4.SSx2.p2.1.m1.1.1.1.1.1.2" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1.2.cmml">D</mi><mi id="Sx4.SSx2.p2.1.m1.1.1.1.1.1.3" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx4.SSx2.p2.1.m1.2.2.2.2.4" xref="Sx4.SSx2.p2.1.m1.2.2.2.3.cmml">,</mo><msub id="Sx4.SSx2.p2.1.m1.2.2.2.2.2" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2.cmml"><mi id="Sx4.SSx2.p2.1.m1.2.2.2.2.2.2" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2.2.cmml">D</mi><mi id="Sx4.SSx2.p2.1.m1.2.2.2.2.2.3" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.SSx2.p2.1.m1.2.2.2.2.5" xref="Sx4.SSx2.p2.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p2.1.m1.2b"><apply id="Sx4.SSx2.p2.1.m1.2.2.cmml" xref="Sx4.SSx2.p2.1.m1.2.2"><times id="Sx4.SSx2.p2.1.m1.2.2.3.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.3"></times><ci id="Sx4.SSx2.p2.1.m1.2.2.4.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.4">𝒮</ci><interval closure="open" id="Sx4.SSx2.p2.1.m1.2.2.2.3.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.2.2"><apply id="Sx4.SSx2.p2.1.m1.1.1.1.1.1.cmml" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p2.1.m1.1.1.1.1.1.1.cmml" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx2.p2.1.m1.1.1.1.1.1.2.cmml" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1.2">𝐷</ci><ci id="Sx4.SSx2.p2.1.m1.1.1.1.1.1.3.cmml" xref="Sx4.SSx2.p2.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx4.SSx2.p2.1.m1.2.2.2.2.2.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx2.p2.1.m1.2.2.2.2.2.1.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="Sx4.SSx2.p2.1.m1.2.2.2.2.2.2.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2.2">𝐷</ci><ci id="Sx4.SSx2.p2.1.m1.2.2.2.2.2.3.cmml" xref="Sx4.SSx2.p2.1.m1.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p2.1.m1.2c">\mathcal{S}(D_{i},D_{j})</annotation></semantics></math> calculated depends on the nature of the non-IIDness. For the proposed CIFAR10 setting, the similarity may be computed as follows:</p>
<ul id="Sx4.I5" class="ltx_itemize">
<li id="Sx4.I5.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx4.I5.i1.p1" class="ltx_para">
<p id="Sx4.I5.i1.p1.9" class="ltx_p"><span id="Sx4.I5.i1.p1.9.1" class="ltx_text ltx_font_italic">Label skew</span>: We first define the distribution vector <math id="Sx4.I5.i1.p1.1.m1.1" class="ltx_Math" alttext="d_{i}" display="inline"><semantics id="Sx4.I5.i1.p1.1.m1.1a"><msub id="Sx4.I5.i1.p1.1.m1.1.1" xref="Sx4.I5.i1.p1.1.m1.1.1.cmml"><mi id="Sx4.I5.i1.p1.1.m1.1.1.2" xref="Sx4.I5.i1.p1.1.m1.1.1.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.1.m1.1.1.3" xref="Sx4.I5.i1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.1.m1.1b"><apply id="Sx4.I5.i1.p1.1.m1.1.1.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.1.m1.1.1.1.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.1.m1.1.1.2.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.2">𝑑</ci><ci id="Sx4.I5.i1.p1.1.m1.1.1.3.cmml" xref="Sx4.I5.i1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.1.m1.1c">d_{i}</annotation></semantics></math> as a vector in which every dimension <math id="Sx4.I5.i1.p1.2.m2.2" class="ltx_Math" alttext="d_{i,k}\in\mathbb{N}_{0}" display="inline"><semantics id="Sx4.I5.i1.p1.2.m2.2a"><mrow id="Sx4.I5.i1.p1.2.m2.2.3" xref="Sx4.I5.i1.p1.2.m2.2.3.cmml"><msub id="Sx4.I5.i1.p1.2.m2.2.3.2" xref="Sx4.I5.i1.p1.2.m2.2.3.2.cmml"><mi id="Sx4.I5.i1.p1.2.m2.2.3.2.2" xref="Sx4.I5.i1.p1.2.m2.2.3.2.2.cmml">d</mi><mrow id="Sx4.I5.i1.p1.2.m2.2.2.2.4" xref="Sx4.I5.i1.p1.2.m2.2.2.2.3.cmml"><mi id="Sx4.I5.i1.p1.2.m2.1.1.1.1" xref="Sx4.I5.i1.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="Sx4.I5.i1.p1.2.m2.2.2.2.4.1" xref="Sx4.I5.i1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="Sx4.I5.i1.p1.2.m2.2.2.2.2" xref="Sx4.I5.i1.p1.2.m2.2.2.2.2.cmml">k</mi></mrow></msub><mo id="Sx4.I5.i1.p1.2.m2.2.3.1" xref="Sx4.I5.i1.p1.2.m2.2.3.1.cmml">∈</mo><msub id="Sx4.I5.i1.p1.2.m2.2.3.3" xref="Sx4.I5.i1.p1.2.m2.2.3.3.cmml"><mi id="Sx4.I5.i1.p1.2.m2.2.3.3.2" xref="Sx4.I5.i1.p1.2.m2.2.3.3.2.cmml">ℕ</mi><mn id="Sx4.I5.i1.p1.2.m2.2.3.3.3" xref="Sx4.I5.i1.p1.2.m2.2.3.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.2.m2.2b"><apply id="Sx4.I5.i1.p1.2.m2.2.3.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3"><in id="Sx4.I5.i1.p1.2.m2.2.3.1.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.1"></in><apply id="Sx4.I5.i1.p1.2.m2.2.3.2.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.2.m2.2.3.2.1.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.2">subscript</csymbol><ci id="Sx4.I5.i1.p1.2.m2.2.3.2.2.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.2.2">𝑑</ci><list id="Sx4.I5.i1.p1.2.m2.2.2.2.3.cmml" xref="Sx4.I5.i1.p1.2.m2.2.2.2.4"><ci id="Sx4.I5.i1.p1.2.m2.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.2.m2.1.1.1.1">𝑖</ci><ci id="Sx4.I5.i1.p1.2.m2.2.2.2.2.cmml" xref="Sx4.I5.i1.p1.2.m2.2.2.2.2">𝑘</ci></list></apply><apply id="Sx4.I5.i1.p1.2.m2.2.3.3.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.3"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.2.m2.2.3.3.1.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.3">subscript</csymbol><ci id="Sx4.I5.i1.p1.2.m2.2.3.3.2.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.3.2">ℕ</ci><cn type="integer" id="Sx4.I5.i1.p1.2.m2.2.3.3.3.cmml" xref="Sx4.I5.i1.p1.2.m2.2.3.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.2.m2.2c">d_{i,k}\in\mathbb{N}_{0}</annotation></semantics></math> states the number of data points in <math id="Sx4.I5.i1.p1.3.m3.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx4.I5.i1.p1.3.m3.1a"><msub id="Sx4.I5.i1.p1.3.m3.1.1" xref="Sx4.I5.i1.p1.3.m3.1.1.cmml"><mi id="Sx4.I5.i1.p1.3.m3.1.1.2" xref="Sx4.I5.i1.p1.3.m3.1.1.2.cmml">D</mi><mi id="Sx4.I5.i1.p1.3.m3.1.1.3" xref="Sx4.I5.i1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.3.m3.1b"><apply id="Sx4.I5.i1.p1.3.m3.1.1.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.3.m3.1.1.1.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.3.m3.1.1.2.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.2">𝐷</ci><ci id="Sx4.I5.i1.p1.3.m3.1.1.3.cmml" xref="Sx4.I5.i1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.3.m3.1c">D_{i}</annotation></semantics></math> that belong to class <math id="Sx4.I5.i1.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx4.I5.i1.p1.4.m4.1a"><mi id="Sx4.I5.i1.p1.4.m4.1.1" xref="Sx4.I5.i1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.4.m4.1b"><ci id="Sx4.I5.i1.p1.4.m4.1.1.cmml" xref="Sx4.I5.i1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.4.m4.1c">k</annotation></semantics></math>; then, the similarity between two datasets <math id="Sx4.I5.i1.p1.5.m5.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx4.I5.i1.p1.5.m5.1a"><msub id="Sx4.I5.i1.p1.5.m5.1.1" xref="Sx4.I5.i1.p1.5.m5.1.1.cmml"><mi id="Sx4.I5.i1.p1.5.m5.1.1.2" xref="Sx4.I5.i1.p1.5.m5.1.1.2.cmml">D</mi><mi id="Sx4.I5.i1.p1.5.m5.1.1.3" xref="Sx4.I5.i1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.5.m5.1b"><apply id="Sx4.I5.i1.p1.5.m5.1.1.cmml" xref="Sx4.I5.i1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.5.m5.1.1.1.cmml" xref="Sx4.I5.i1.p1.5.m5.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.5.m5.1.1.2.cmml" xref="Sx4.I5.i1.p1.5.m5.1.1.2">𝐷</ci><ci id="Sx4.I5.i1.p1.5.m5.1.1.3.cmml" xref="Sx4.I5.i1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.5.m5.1c">D_{i}</annotation></semantics></math> and <math id="Sx4.I5.i1.p1.6.m6.1" class="ltx_Math" alttext="D_{j}" display="inline"><semantics id="Sx4.I5.i1.p1.6.m6.1a"><msub id="Sx4.I5.i1.p1.6.m6.1.1" xref="Sx4.I5.i1.p1.6.m6.1.1.cmml"><mi id="Sx4.I5.i1.p1.6.m6.1.1.2" xref="Sx4.I5.i1.p1.6.m6.1.1.2.cmml">D</mi><mi id="Sx4.I5.i1.p1.6.m6.1.1.3" xref="Sx4.I5.i1.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.6.m6.1b"><apply id="Sx4.I5.i1.p1.6.m6.1.1.cmml" xref="Sx4.I5.i1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.6.m6.1.1.1.cmml" xref="Sx4.I5.i1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.6.m6.1.1.2.cmml" xref="Sx4.I5.i1.p1.6.m6.1.1.2">𝐷</ci><ci id="Sx4.I5.i1.p1.6.m6.1.1.3.cmml" xref="Sx4.I5.i1.p1.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.6.m6.1c">D_{j}</annotation></semantics></math> can be estimated as the cosine similarity of the corresponding distribution vectors <math id="Sx4.I5.i1.p1.7.m7.1" class="ltx_Math" alttext="d_{i}" display="inline"><semantics id="Sx4.I5.i1.p1.7.m7.1a"><msub id="Sx4.I5.i1.p1.7.m7.1.1" xref="Sx4.I5.i1.p1.7.m7.1.1.cmml"><mi id="Sx4.I5.i1.p1.7.m7.1.1.2" xref="Sx4.I5.i1.p1.7.m7.1.1.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.7.m7.1.1.3" xref="Sx4.I5.i1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.7.m7.1b"><apply id="Sx4.I5.i1.p1.7.m7.1.1.cmml" xref="Sx4.I5.i1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.7.m7.1.1.1.cmml" xref="Sx4.I5.i1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.7.m7.1.1.2.cmml" xref="Sx4.I5.i1.p1.7.m7.1.1.2">𝑑</ci><ci id="Sx4.I5.i1.p1.7.m7.1.1.3.cmml" xref="Sx4.I5.i1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.7.m7.1c">d_{i}</annotation></semantics></math> and <math id="Sx4.I5.i1.p1.8.m8.1" class="ltx_Math" alttext="d_{j}" display="inline"><semantics id="Sx4.I5.i1.p1.8.m8.1a"><msub id="Sx4.I5.i1.p1.8.m8.1.1" xref="Sx4.I5.i1.p1.8.m8.1.1.cmml"><mi id="Sx4.I5.i1.p1.8.m8.1.1.2" xref="Sx4.I5.i1.p1.8.m8.1.1.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.8.m8.1.1.3" xref="Sx4.I5.i1.p1.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.8.m8.1b"><apply id="Sx4.I5.i1.p1.8.m8.1.1.cmml" xref="Sx4.I5.i1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.8.m8.1.1.1.cmml" xref="Sx4.I5.i1.p1.8.m8.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.8.m8.1.1.2.cmml" xref="Sx4.I5.i1.p1.8.m8.1.1.2">𝑑</ci><ci id="Sx4.I5.i1.p1.8.m8.1.1.3.cmml" xref="Sx4.I5.i1.p1.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.8.m8.1c">d_{j}</annotation></semantics></math>. That is, <math id="Sx4.I5.i1.p1.9.m9.4" class="ltx_Math" alttext="\mathcal{S}(D_{i},D_{j})=\frac{d_{i}^{T}d_{j}}{\|d_{i}\|_{2}\cdot\|d_{j}\|_{2}}" display="inline"><semantics id="Sx4.I5.i1.p1.9.m9.4a"><mrow id="Sx4.I5.i1.p1.9.m9.4.4" xref="Sx4.I5.i1.p1.9.m9.4.4.cmml"><mrow id="Sx4.I5.i1.p1.9.m9.4.4.2" xref="Sx4.I5.i1.p1.9.m9.4.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.I5.i1.p1.9.m9.4.4.2.4" xref="Sx4.I5.i1.p1.9.m9.4.4.2.4.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i1.p1.9.m9.4.4.2.3" xref="Sx4.I5.i1.p1.9.m9.4.4.2.3.cmml">​</mo><mrow id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.3.cmml"><mo stretchy="false" id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.3" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.3.cmml">(</mo><msub id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.cmml"><mi id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.2" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.2.cmml">D</mi><mi id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.3" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.4" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.3.cmml">,</mo><msub id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.cmml"><mi id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.2" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.2.cmml">D</mi><mi id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.3" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.5" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx4.I5.i1.p1.9.m9.4.4.3" xref="Sx4.I5.i1.p1.9.m9.4.4.3.cmml">=</mo><mfrac id="Sx4.I5.i1.p1.9.m9.2.2" xref="Sx4.I5.i1.p1.9.m9.2.2.cmml"><mrow id="Sx4.I5.i1.p1.9.m9.2.2.4" xref="Sx4.I5.i1.p1.9.m9.2.2.4.cmml"><msubsup id="Sx4.I5.i1.p1.9.m9.2.2.4.2" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.cmml"><mi id="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.2" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.3" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.3.cmml">i</mi><mi id="Sx4.I5.i1.p1.9.m9.2.2.4.2.3" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx4.I5.i1.p1.9.m9.2.2.4.1" xref="Sx4.I5.i1.p1.9.m9.2.2.4.1.cmml">​</mo><msub id="Sx4.I5.i1.p1.9.m9.2.2.4.3" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3.cmml"><mi id="Sx4.I5.i1.p1.9.m9.2.2.4.3.2" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.9.m9.2.2.4.3.3" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3.3.cmml">j</mi></msub></mrow><mrow id="Sx4.I5.i1.p1.9.m9.2.2.2" xref="Sx4.I5.i1.p1.9.m9.2.2.2.cmml"><msub id="Sx4.I5.i1.p1.9.m9.1.1.1.1" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.cmml"><mrow id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.2" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.2.1.cmml">‖</mo><msub id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.cmml"><mi id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.2" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.3" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.3" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx4.I5.i1.p1.9.m9.1.1.1.1.3" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.3.cmml">2</mn></msub><mo lspace="0.222em" rspace="0.222em" id="Sx4.I5.i1.p1.9.m9.2.2.2.3" xref="Sx4.I5.i1.p1.9.m9.2.2.2.3.cmml">⋅</mo><msub id="Sx4.I5.i1.p1.9.m9.2.2.2.2" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.cmml"><mrow id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.2.cmml"><mo stretchy="false" id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.2" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.2.1.cmml">‖</mo><msub id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.cmml"><mi id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.2" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.2.cmml">d</mi><mi id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.3" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.3" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="Sx4.I5.i1.p1.9.m9.2.2.2.2.3" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.3.cmml">2</mn></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i1.p1.9.m9.4b"><apply id="Sx4.I5.i1.p1.9.m9.4.4.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4"><eq id="Sx4.I5.i1.p1.9.m9.4.4.3.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.3"></eq><apply id="Sx4.I5.i1.p1.9.m9.4.4.2.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2"><times id="Sx4.I5.i1.p1.9.m9.4.4.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.3"></times><ci id="Sx4.I5.i1.p1.9.m9.4.4.2.4.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.4">𝒮</ci><interval closure="open" id="Sx4.I5.i1.p1.9.m9.4.4.2.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2"><apply id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.2.cmml" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.2">𝐷</ci><ci id="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.3.cmml" xref="Sx4.I5.i1.p1.9.m9.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.1.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2">subscript</csymbol><ci id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.2">𝐷</ci><ci id="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.4.4.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="Sx4.I5.i1.p1.9.m9.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2"><divide id="Sx4.I5.i1.p1.9.m9.2.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2"></divide><apply id="Sx4.I5.i1.p1.9.m9.2.2.4.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4"><times id="Sx4.I5.i1.p1.9.m9.2.2.4.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.1"></times><apply id="Sx4.I5.i1.p1.9.m9.2.2.4.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.2.2.4.2.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2">superscript</csymbol><apply id="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2">subscript</csymbol><ci id="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.2">𝑑</ci><ci id="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.2.3">𝑖</ci></apply><ci id="Sx4.I5.i1.p1.9.m9.2.2.4.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.2.3">𝑇</ci></apply><apply id="Sx4.I5.i1.p1.9.m9.2.2.4.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.2.2.4.3.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3">subscript</csymbol><ci id="Sx4.I5.i1.p1.9.m9.2.2.4.3.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3.2">𝑑</ci><ci id="Sx4.I5.i1.p1.9.m9.2.2.4.3.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.4.3.3">𝑗</ci></apply></apply><apply id="Sx4.I5.i1.p1.9.m9.2.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2"><ci id="Sx4.I5.i1.p1.9.m9.2.2.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.3">⋅</ci><apply id="Sx4.I5.i1.p1.9.m9.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.1.1.1.1.2.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1">subscript</csymbol><apply id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.2.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.2.1.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.2">norm</csymbol><apply id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.2.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.2">𝑑</ci><ci id="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.3.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="Sx4.I5.i1.p1.9.m9.1.1.1.1.3.cmml" xref="Sx4.I5.i1.p1.9.m9.1.1.1.1.3">2</cn></apply><apply id="Sx4.I5.i1.p1.9.m9.2.2.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.2.2.2.2.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2">subscript</csymbol><apply id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1"><csymbol cd="latexml" id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.2.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.2">norm</csymbol><apply id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.1.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1">subscript</csymbol><ci id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.2.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.2">𝑑</ci><ci id="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="Sx4.I5.i1.p1.9.m9.2.2.2.2.3.cmml" xref="Sx4.I5.i1.p1.9.m9.2.2.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i1.p1.9.m9.4c">\mathcal{S}(D_{i},D_{j})=\frac{d_{i}^{T}d_{j}}{\|d_{i}\|_{2}\cdot\|d_{j}\|_{2}}</annotation></semantics></math>;</p>
</div>
</li>
<li id="Sx4.I5.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx4.I5.i2.p1" class="ltx_para">
<p id="Sx4.I5.i2.p1.5" class="ltx_p"><span id="Sx4.I5.i2.p1.5.1" class="ltx_text ltx_font_italic">Concept drift</span>: in our setting, the similarity of the two datasets <math id="Sx4.I5.i2.p1.1.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx4.I5.i2.p1.1.m1.1a"><msub id="Sx4.I5.i2.p1.1.m1.1.1" xref="Sx4.I5.i2.p1.1.m1.1.1.cmml"><mi id="Sx4.I5.i2.p1.1.m1.1.1.2" xref="Sx4.I5.i2.p1.1.m1.1.1.2.cmml">D</mi><mi id="Sx4.I5.i2.p1.1.m1.1.1.3" xref="Sx4.I5.i2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.1.m1.1b"><apply id="Sx4.I5.i2.p1.1.m1.1.1.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i2.p1.1.m1.1.1.1.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1">subscript</csymbol><ci id="Sx4.I5.i2.p1.1.m1.1.1.2.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.2">𝐷</ci><ci id="Sx4.I5.i2.p1.1.m1.1.1.3.cmml" xref="Sx4.I5.i2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.1.m1.1c">D_{i}</annotation></semantics></math> and <math id="Sx4.I5.i2.p1.2.m2.1" class="ltx_Math" alttext="D_{j}" display="inline"><semantics id="Sx4.I5.i2.p1.2.m2.1a"><msub id="Sx4.I5.i2.p1.2.m2.1.1" xref="Sx4.I5.i2.p1.2.m2.1.1.cmml"><mi id="Sx4.I5.i2.p1.2.m2.1.1.2" xref="Sx4.I5.i2.p1.2.m2.1.1.2.cmml">D</mi><mi id="Sx4.I5.i2.p1.2.m2.1.1.3" xref="Sx4.I5.i2.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.2.m2.1b"><apply id="Sx4.I5.i2.p1.2.m2.1.1.cmml" xref="Sx4.I5.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.I5.i2.p1.2.m2.1.1.1.cmml" xref="Sx4.I5.i2.p1.2.m2.1.1">subscript</csymbol><ci id="Sx4.I5.i2.p1.2.m2.1.1.2.cmml" xref="Sx4.I5.i2.p1.2.m2.1.1.2">𝐷</ci><ci id="Sx4.I5.i2.p1.2.m2.1.1.3.cmml" xref="Sx4.I5.i2.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.2.m2.1c">D_{j}</annotation></semantics></math> is equal to the similarity of their clients’ image augmentation pipelines. Such similarity can be estimated by applying the <math id="Sx4.I5.i2.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Sx4.I5.i2.p1.3.m3.1a"><mi id="Sx4.I5.i2.p1.3.m3.1.1" xref="Sx4.I5.i2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.3.m3.1b"><ci id="Sx4.I5.i2.p1.3.m3.1.1.cmml" xref="Sx4.I5.i2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.3.m3.1c">i</annotation></semantics></math>’s and <math id="Sx4.I5.i2.p1.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="Sx4.I5.i2.p1.4.m4.1a"><mi id="Sx4.I5.i2.p1.4.m4.1.1" xref="Sx4.I5.i2.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.4.m4.1b"><ci id="Sx4.I5.i2.p1.4.m4.1.1.cmml" xref="Sx4.I5.i2.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.4.m4.1c">j</annotation></semantics></math>’s augmentation pipelines to the same set of images, mapping the resulting images to an embedding space with a pre-trained network, and applying the softmax function to the so-obtained image embeddings in order to obtain valid probability distributions. As a final step, we compute the Jensen-Shannon divergence between every pair of probabilities that correspond to the same image, average them out, and then we convert the obtained JS divergence to a similarity with the formula <math id="Sx4.I5.i2.p1.5.m5.1" class="ltx_Math" alttext="similarity=1-divergence" display="inline"><semantics id="Sx4.I5.i2.p1.5.m5.1a"><mrow id="Sx4.I5.i2.p1.5.m5.1.1" xref="Sx4.I5.i2.p1.5.m5.1.1.cmml"><mrow id="Sx4.I5.i2.p1.5.m5.1.1.2" xref="Sx4.I5.i2.p1.5.m5.1.1.2.cmml"><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.2" xref="Sx4.I5.i2.p1.5.m5.1.1.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.3" xref="Sx4.I5.i2.p1.5.m5.1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1a" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.4" xref="Sx4.I5.i2.p1.5.m5.1.1.2.4.cmml">m</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1b" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.5" xref="Sx4.I5.i2.p1.5.m5.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1c" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.6" xref="Sx4.I5.i2.p1.5.m5.1.1.2.6.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1d" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.7" xref="Sx4.I5.i2.p1.5.m5.1.1.2.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1e" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.8" xref="Sx4.I5.i2.p1.5.m5.1.1.2.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1f" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.9" xref="Sx4.I5.i2.p1.5.m5.1.1.2.9.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1g" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.10" xref="Sx4.I5.i2.p1.5.m5.1.1.2.10.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.2.1h" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.2.11" xref="Sx4.I5.i2.p1.5.m5.1.1.2.11.cmml">y</mi></mrow><mo id="Sx4.I5.i2.p1.5.m5.1.1.1" xref="Sx4.I5.i2.p1.5.m5.1.1.1.cmml">=</mo><mrow id="Sx4.I5.i2.p1.5.m5.1.1.3" xref="Sx4.I5.i2.p1.5.m5.1.1.3.cmml"><mn id="Sx4.I5.i2.p1.5.m5.1.1.3.2" xref="Sx4.I5.i2.p1.5.m5.1.1.3.2.cmml">1</mn><mo id="Sx4.I5.i2.p1.5.m5.1.1.3.1" xref="Sx4.I5.i2.p1.5.m5.1.1.3.1.cmml">−</mo><mrow id="Sx4.I5.i2.p1.5.m5.1.1.3.3" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.cmml"><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.2" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.3" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1a" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.4" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1b" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.5" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1c" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.6" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1d" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.7" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1e" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.8" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1f" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.9" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.9.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1g" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.10" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.10.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1h" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml">​</mo><mi id="Sx4.I5.i2.p1.5.m5.1.1.3.3.11" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.11.cmml">e</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I5.i2.p1.5.m5.1b"><apply id="Sx4.I5.i2.p1.5.m5.1.1.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1"><eq id="Sx4.I5.i2.p1.5.m5.1.1.1.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.1"></eq><apply id="Sx4.I5.i2.p1.5.m5.1.1.2.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2"><times id="Sx4.I5.i2.p1.5.m5.1.1.2.1.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.1"></times><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.2.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.2">𝑠</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.3.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.3">𝑖</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.4.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.4">𝑚</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.5.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.5">𝑖</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.6.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.6">𝑙</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.7.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.7">𝑎</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.8.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.8">𝑟</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.9.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.9">𝑖</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.10.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.10">𝑡</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.2.11.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.2.11">𝑦</ci></apply><apply id="Sx4.I5.i2.p1.5.m5.1.1.3.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3"><minus id="Sx4.I5.i2.p1.5.m5.1.1.3.1.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.1"></minus><cn type="integer" id="Sx4.I5.i2.p1.5.m5.1.1.3.2.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.2">1</cn><apply id="Sx4.I5.i2.p1.5.m5.1.1.3.3.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3"><times id="Sx4.I5.i2.p1.5.m5.1.1.3.3.1.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.1"></times><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.2.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.2">𝑑</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.3.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.3">𝑖</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.4.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.4">𝑣</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.5.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.5">𝑒</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.6.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.6">𝑟</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.7.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.7">𝑔</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.8.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.8">𝑒</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.9.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.9">𝑛</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.10.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.10">𝑐</ci><ci id="Sx4.I5.i2.p1.5.m5.1.1.3.3.11.cmml" xref="Sx4.I5.i2.p1.5.m5.1.1.3.3.11">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I5.i2.p1.5.m5.1c">similarity=1-divergence</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div id="Sx4.SSx2.p3" class="ltx_para">
<p id="Sx4.SSx2.p3.7" class="ltx_p">We set the number of training clients to <math id="Sx4.SSx2.p3.1.m1.1" class="ltx_Math" alttext="80" display="inline"><semantics id="Sx4.SSx2.p3.1.m1.1a"><mn id="Sx4.SSx2.p3.1.m1.1.1" xref="Sx4.SSx2.p3.1.m1.1.1.cmml">80</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.1.m1.1b"><cn type="integer" id="Sx4.SSx2.p3.1.m1.1.1.cmml" xref="Sx4.SSx2.p3.1.m1.1.1">80</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.1.m1.1c">80</annotation></semantics></math> and observe how the correlation between the similarity of clients <math id="Sx4.SSx2.p3.2.m2.2" class="ltx_Math" alttext="\mathcal{S}(i,j)" display="inline"><semantics id="Sx4.SSx2.p3.2.m2.2a"><mrow id="Sx4.SSx2.p3.2.m2.2.3" xref="Sx4.SSx2.p3.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx2.p3.2.m2.2.3.2" xref="Sx4.SSx2.p3.2.m2.2.3.2.cmml">𝒮</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx2.p3.2.m2.2.3.1" xref="Sx4.SSx2.p3.2.m2.2.3.1.cmml">​</mo><mrow id="Sx4.SSx2.p3.2.m2.2.3.3.2" xref="Sx4.SSx2.p3.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="Sx4.SSx2.p3.2.m2.2.3.3.2.1" xref="Sx4.SSx2.p3.2.m2.2.3.3.1.cmml">(</mo><mi id="Sx4.SSx2.p3.2.m2.1.1" xref="Sx4.SSx2.p3.2.m2.1.1.cmml">i</mi><mo id="Sx4.SSx2.p3.2.m2.2.3.3.2.2" xref="Sx4.SSx2.p3.2.m2.2.3.3.1.cmml">,</mo><mi id="Sx4.SSx2.p3.2.m2.2.2" xref="Sx4.SSx2.p3.2.m2.2.2.cmml">j</mi><mo stretchy="false" id="Sx4.SSx2.p3.2.m2.2.3.3.2.3" xref="Sx4.SSx2.p3.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.2.m2.2b"><apply id="Sx4.SSx2.p3.2.m2.2.3.cmml" xref="Sx4.SSx2.p3.2.m2.2.3"><times id="Sx4.SSx2.p3.2.m2.2.3.1.cmml" xref="Sx4.SSx2.p3.2.m2.2.3.1"></times><ci id="Sx4.SSx2.p3.2.m2.2.3.2.cmml" xref="Sx4.SSx2.p3.2.m2.2.3.2">𝒮</ci><interval closure="open" id="Sx4.SSx2.p3.2.m2.2.3.3.1.cmml" xref="Sx4.SSx2.p3.2.m2.2.3.3.2"><ci id="Sx4.SSx2.p3.2.m2.1.1.cmml" xref="Sx4.SSx2.p3.2.m2.1.1">𝑖</ci><ci id="Sx4.SSx2.p3.2.m2.2.2.cmml" xref="Sx4.SSx2.p3.2.m2.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.2.m2.2c">\mathcal{S}(i,j)</annotation></semantics></math> and the cosine similarity of the client embeddings produced by the two algorithms under observation – <span id="Sx4.SSx2.p3.7.1" class="ltx_ERROR undefined">\acronym</span>and WD – evolve through the training on the CIFAR10 dataset. The results in <a href="#Sx4.F1" title="In Cluster Uniformity ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a> show that WD is particularly successful at capturing the label skew type of non-IIDness as the correlation is, in some cases, even higher than <math id="Sx4.SSx2.p3.3.m3.1" class="ltx_Math" alttext="0.6" display="inline"><semantics id="Sx4.SSx2.p3.3.m3.1a"><mn id="Sx4.SSx2.p3.3.m3.1.1" xref="Sx4.SSx2.p3.3.m3.1.1.cmml">0.6</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.3.m3.1b"><cn type="float" id="Sx4.SSx2.p3.3.m3.1.1.cmml" xref="Sx4.SSx2.p3.3.m3.1.1">0.6</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.3.m3.1c">0.6</annotation></semantics></math>. This is unsurprising, as the algorithm relies on information stemming from local training, i.e. with local label (distributions) known. For <span id="Sx4.SSx2.p3.7.2" class="ltx_ERROR undefined">\acronym</span>we report the correlation of <math id="Sx4.SSx2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="Sx4.SSx2.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx2.p3.4.m4.1.1" xref="Sx4.SSx2.p3.4.m4.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.4.m4.1b"><ci id="Sx4.SSx2.p3.4.m4.1.1.cmml" xref="Sx4.SSx2.p3.4.m4.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.4.m4.1c">\mathcal{S}</annotation></semantics></math> with selected client embeddings statistics – the mean and the quantiles (we used <math id="Sx4.SSx2.p3.5.m5.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="Sx4.SSx2.p3.5.m5.1a"><mn id="Sx4.SSx2.p3.5.m5.1.1" xref="Sx4.SSx2.p3.5.m5.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.5.m5.1b"><cn type="float" id="Sx4.SSx2.p3.5.m5.1.1.cmml" xref="Sx4.SSx2.p3.5.m5.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.5.m5.1c">0.25</annotation></semantics></math>, <math id="Sx4.SSx2.p3.6.m6.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="Sx4.SSx2.p3.6.m6.1a"><mn id="Sx4.SSx2.p3.6.m6.1.1" xref="Sx4.SSx2.p3.6.m6.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.6.m6.1b"><cn type="float" id="Sx4.SSx2.p3.6.m6.1.1.cmml" xref="Sx4.SSx2.p3.6.m6.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.6.m6.1c">0.5</annotation></semantics></math>, and <math id="Sx4.SSx2.p3.7.m7.1" class="ltx_Math" alttext="0.75" display="inline"><semantics id="Sx4.SSx2.p3.7.m7.1a"><mn id="Sx4.SSx2.p3.7.m7.1.1" xref="Sx4.SSx2.p3.7.m7.1.1.cmml">0.75</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.7.m7.1b"><cn type="float" id="Sx4.SSx2.p3.7.m7.1.1.cmml" xref="Sx4.SSx2.p3.7.m7.1.1">0.75</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.7.m7.1c">0.75</annotation></semantics></math>) – that yield the best overall correlation. The figure demonstrates that, compared to WD, <span id="Sx4.SSx2.p3.7.3" class="ltx_ERROR undefined">\acronym</span>achieves a lower, but nevertheless, non-negligible correlation with the client similarity.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Cluster Uniformity</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.4" class="ltx_p">The goal of clustered FL is to bundle clients into groups exhibiting relative uniformity of the within-cluster clients’ datasets. Thus, we now evaluate the ability of the <span id="Sx4.SSx3.p1.4.1" class="ltx_ERROR undefined">\acronym</span>clustering algorithm to generate uniform clusters. We focus on the MNIST dataset with pathological non-IIDness and define the uniformity of clusters <math id="Sx4.SSx3.p1.1.m1.2" class="ltx_Math" alttext="\mathbb{C}=\{c_{k}\}_{k=1}^{|\mathbb{C}|}" display="inline"><semantics id="Sx4.SSx3.p1.1.m1.2a"><mrow id="Sx4.SSx3.p1.1.m1.2.2" xref="Sx4.SSx3.p1.1.m1.2.2.cmml"><mi id="Sx4.SSx3.p1.1.m1.2.2.3" xref="Sx4.SSx3.p1.1.m1.2.2.3.cmml">ℂ</mi><mo id="Sx4.SSx3.p1.1.m1.2.2.2" xref="Sx4.SSx3.p1.1.m1.2.2.2.cmml">=</mo><msubsup id="Sx4.SSx3.p1.1.m1.2.2.1" xref="Sx4.SSx3.p1.1.m1.2.2.1.cmml"><mrow id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.2" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.2.cmml">{</mo><msub id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.2" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.2.cmml">c</mi><mi id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.3" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.3" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="Sx4.SSx3.p1.1.m1.2.2.1.1.3" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.cmml"><mi id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.2" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.2.cmml">k</mi><mo id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.1" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.1.cmml">=</mo><mn id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.3" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="Sx4.SSx3.p1.1.m1.1.1.1.3" xref="Sx4.SSx3.p1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.SSx3.p1.1.m1.1.1.1.3.1" xref="Sx4.SSx3.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi id="Sx4.SSx3.p1.1.m1.1.1.1.1" xref="Sx4.SSx3.p1.1.m1.1.1.1.1.cmml">ℂ</mi><mo stretchy="false" id="Sx4.SSx3.p1.1.m1.1.1.1.3.2" xref="Sx4.SSx3.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.1.m1.2b"><apply id="Sx4.SSx3.p1.1.m1.2.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2"><eq id="Sx4.SSx3.p1.1.m1.2.2.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.2"></eq><ci id="Sx4.SSx3.p1.1.m1.2.2.3.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.3">ℂ</ci><apply id="Sx4.SSx3.p1.1.m1.2.2.1.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p1.1.m1.2.2.1.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1">superscript</csymbol><apply id="Sx4.SSx3.p1.1.m1.2.2.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p1.1.m1.2.2.1.1.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1">subscript</csymbol><set id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1"><apply id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.2">𝑐</ci><ci id="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3"><eq id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.1.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.1"></eq><ci id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.2.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="Sx4.SSx3.p1.1.m1.2.2.1.1.3.3.cmml" xref="Sx4.SSx3.p1.1.m1.2.2.1.1.3.3">1</cn></apply></apply><apply id="Sx4.SSx3.p1.1.m1.1.1.1.2.cmml" xref="Sx4.SSx3.p1.1.m1.1.1.1.3"><abs id="Sx4.SSx3.p1.1.m1.1.1.1.2.1.cmml" xref="Sx4.SSx3.p1.1.m1.1.1.1.3.1"></abs><ci id="Sx4.SSx3.p1.1.m1.1.1.1.1.cmml" xref="Sx4.SSx3.p1.1.m1.1.1.1.1">ℂ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.1.m1.2c">\mathbb{C}=\{c_{k}\}_{k=1}^{|\mathbb{C}|}</annotation></semantics></math>, where <math id="Sx4.SSx3.p1.2.m2.1" class="ltx_Math" alttext="c_{k}\subseteq C" display="inline"><semantics id="Sx4.SSx3.p1.2.m2.1a"><mrow id="Sx4.SSx3.p1.2.m2.1.1" xref="Sx4.SSx3.p1.2.m2.1.1.cmml"><msub id="Sx4.SSx3.p1.2.m2.1.1.2" xref="Sx4.SSx3.p1.2.m2.1.1.2.cmml"><mi id="Sx4.SSx3.p1.2.m2.1.1.2.2" xref="Sx4.SSx3.p1.2.m2.1.1.2.2.cmml">c</mi><mi id="Sx4.SSx3.p1.2.m2.1.1.2.3" xref="Sx4.SSx3.p1.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="Sx4.SSx3.p1.2.m2.1.1.1" xref="Sx4.SSx3.p1.2.m2.1.1.1.cmml">⊆</mo><mi id="Sx4.SSx3.p1.2.m2.1.1.3" xref="Sx4.SSx3.p1.2.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.2.m2.1b"><apply id="Sx4.SSx3.p1.2.m2.1.1.cmml" xref="Sx4.SSx3.p1.2.m2.1.1"><subset id="Sx4.SSx3.p1.2.m2.1.1.1.cmml" xref="Sx4.SSx3.p1.2.m2.1.1.1"></subset><apply id="Sx4.SSx3.p1.2.m2.1.1.2.cmml" xref="Sx4.SSx3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx3.p1.2.m2.1.1.2.1.cmml" xref="Sx4.SSx3.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx4.SSx3.p1.2.m2.1.1.2.2.cmml" xref="Sx4.SSx3.p1.2.m2.1.1.2.2">𝑐</ci><ci id="Sx4.SSx3.p1.2.m2.1.1.2.3.cmml" xref="Sx4.SSx3.p1.2.m2.1.1.2.3">𝑘</ci></apply><ci id="Sx4.SSx3.p1.2.m2.1.1.3.cmml" xref="Sx4.SSx3.p1.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.2.m2.1c">c_{k}\subseteq C</annotation></semantics></math> represents a set of clients in cluster <math id="Sx4.SSx3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx4.SSx3.p1.3.m3.1a"><mi id="Sx4.SSx3.p1.3.m3.1.1" xref="Sx4.SSx3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.3.m3.1b"><ci id="Sx4.SSx3.p1.3.m3.1.1.cmml" xref="Sx4.SSx3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.3.m3.1c">k</annotation></semantics></math>, as the average cosine similarity of the clustered clients’ data distributions <math id="Sx4.SSx3.p1.4.m4.1" class="ltx_Math" alttext="d_{i}" display="inline"><semantics id="Sx4.SSx3.p1.4.m4.1a"><msub id="Sx4.SSx3.p1.4.m4.1.1" xref="Sx4.SSx3.p1.4.m4.1.1.cmml"><mi id="Sx4.SSx3.p1.4.m4.1.1.2" xref="Sx4.SSx3.p1.4.m4.1.1.2.cmml">d</mi><mi id="Sx4.SSx3.p1.4.m4.1.1.3" xref="Sx4.SSx3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx3.p1.4.m4.1b"><apply id="Sx4.SSx3.p1.4.m4.1.1.cmml" xref="Sx4.SSx3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx4.SSx3.p1.4.m4.1.1.1.cmml" xref="Sx4.SSx3.p1.4.m4.1.1">subscript</csymbol><ci id="Sx4.SSx3.p1.4.m4.1.1.2.cmml" xref="Sx4.SSx3.p1.4.m4.1.1.2">𝑑</ci><ci id="Sx4.SSx3.p1.4.m4.1.1.3.cmml" xref="Sx4.SSx3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx3.p1.4.m4.1c">d_{i}</annotation></semantics></math>s, i.e.:</p>
<table id="Sx6.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx4.E7.m1.1" class="ltx_Math" alttext="\displaystyle U(C)" display="inline"><semantics id="Sx4.E7.m1.1a"><mrow id="Sx4.E7.m1.1.2" xref="Sx4.E7.m1.1.2.cmml"><mi id="Sx4.E7.m1.1.2.2" xref="Sx4.E7.m1.1.2.2.cmml">U</mi><mo lspace="0em" rspace="0em" id="Sx4.E7.m1.1.2.1" xref="Sx4.E7.m1.1.2.1.cmml">​</mo><mrow id="Sx4.E7.m1.1.2.3.2" xref="Sx4.E7.m1.1.2.cmml"><mo stretchy="false" id="Sx4.E7.m1.1.2.3.2.1" xref="Sx4.E7.m1.1.2.cmml">(</mo><mi id="Sx4.E7.m1.1.1" xref="Sx4.E7.m1.1.1.cmml">C</mi><mo stretchy="false" id="Sx4.E7.m1.1.2.3.2.2" xref="Sx4.E7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E7.m1.1b"><apply id="Sx4.E7.m1.1.2.cmml" xref="Sx4.E7.m1.1.2"><times id="Sx4.E7.m1.1.2.1.cmml" xref="Sx4.E7.m1.1.2.1"></times><ci id="Sx4.E7.m1.1.2.2.cmml" xref="Sx4.E7.m1.1.2.2">𝑈</ci><ci id="Sx4.E7.m1.1.1.cmml" xref="Sx4.E7.m1.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E7.m1.1c">\displaystyle U(C)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx4.E7.m2.11" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathbb{C}|}\sum_{c\in\mathbb{C}}\frac{1}{{|c|\choose 2}}\sum_{i,j\in c,i\neq j}\frac{d_{i}^{T}d_{j}}{\|d_{i}\|_{2}\|d_{j}\|_{2}}." display="inline"><semantics id="Sx4.E7.m2.11a"><mrow id="Sx4.E7.m2.11.11.1" xref="Sx4.E7.m2.11.11.1.1.cmml"><mrow id="Sx4.E7.m2.11.11.1.1" xref="Sx4.E7.m2.11.11.1.1.cmml"><mi id="Sx4.E7.m2.11.11.1.1.2" xref="Sx4.E7.m2.11.11.1.1.2.cmml"></mi><mo id="Sx4.E7.m2.11.11.1.1.1" xref="Sx4.E7.m2.11.11.1.1.1.cmml">=</mo><mrow id="Sx4.E7.m2.11.11.1.1.3" xref="Sx4.E7.m2.11.11.1.1.3.cmml"><mstyle displaystyle="true" id="Sx4.E7.m2.4.4" xref="Sx4.E7.m2.4.4.cmml"><mfrac id="Sx4.E7.m2.4.4a" xref="Sx4.E7.m2.4.4.cmml"><mn id="Sx4.E7.m2.4.4.3" xref="Sx4.E7.m2.4.4.3.cmml">1</mn><mrow id="Sx4.E7.m2.4.4.1.3" xref="Sx4.E7.m2.4.4.1.2.cmml"><mo stretchy="false" id="Sx4.E7.m2.4.4.1.3.1" xref="Sx4.E7.m2.4.4.1.2.1.cmml">|</mo><mi id="Sx4.E7.m2.4.4.1.1" xref="Sx4.E7.m2.4.4.1.1.cmml">ℂ</mi><mo stretchy="false" id="Sx4.E7.m2.4.4.1.3.2" xref="Sx4.E7.m2.4.4.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx4.E7.m2.11.11.1.1.3.1" xref="Sx4.E7.m2.11.11.1.1.3.1.cmml">​</mo><mrow id="Sx4.E7.m2.11.11.1.1.3.2" xref="Sx4.E7.m2.11.11.1.1.3.2.cmml"><mstyle displaystyle="true" id="Sx4.E7.m2.11.11.1.1.3.2.1" xref="Sx4.E7.m2.11.11.1.1.3.2.1.cmml"><munder id="Sx4.E7.m2.11.11.1.1.3.2.1a" xref="Sx4.E7.m2.11.11.1.1.3.2.1.cmml"><mo movablelimits="false" id="Sx4.E7.m2.11.11.1.1.3.2.1.2" xref="Sx4.E7.m2.11.11.1.1.3.2.1.2.cmml">∑</mo><mrow id="Sx4.E7.m2.11.11.1.1.3.2.1.3" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.cmml"><mi id="Sx4.E7.m2.11.11.1.1.3.2.1.3.2" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.2.cmml">c</mi><mo id="Sx4.E7.m2.11.11.1.1.3.2.1.3.1" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.1.cmml">∈</mo><mi id="Sx4.E7.m2.11.11.1.1.3.2.1.3.3" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.3.cmml">ℂ</mi></mrow></munder></mstyle><mrow id="Sx4.E7.m2.11.11.1.1.3.2.2" xref="Sx4.E7.m2.11.11.1.1.3.2.2.cmml"><mstyle displaystyle="true" id="Sx4.E7.m2.3.3a" xref="Sx4.E7.m2.3.3a.cmml"><mfrac id="Sx4.E7.m2.3.3aa" xref="Sx4.E7.m2.3.3a.cmml"><mn id="Sx4.E7.m2.3.3a.5" xref="Sx4.E7.m2.3.3a.5.cmml">1</mn><mrow id="Sx4.E7.m2.3.3.3a.5" xref="Sx4.E7.m2.3.3.3a.4.cmml"><mo id="Sx4.E7.m2.3.3.3a.5.1" xref="Sx4.E7.m2.1.1.1.1.1.1.1.cmml">(</mo><mfrac linethickness="0pt" id="Sx4.E7.m2.3.3.3.3.3.3a" xref="Sx4.E7.m2.3.3.3a.4.cmml"><mrow id="Sx4.E7.m2.2.2.2.2.2.2.2.3" xref="Sx4.E7.m2.2.2.2.2.2.2.2.2.cmml"><mo stretchy="false" id="Sx4.E7.m2.2.2.2.2.2.2.2.3.1" xref="Sx4.E7.m2.2.2.2.2.2.2.2.2.1.cmml">|</mo><mi id="Sx4.E7.m2.2.2.2.2.2.2.2.1" xref="Sx4.E7.m2.2.2.2.2.2.2.2.1.cmml">c</mi><mo stretchy="false" id="Sx4.E7.m2.2.2.2.2.2.2.2.3.2" xref="Sx4.E7.m2.2.2.2.2.2.2.2.2.1.cmml">|</mo></mrow><mn id="Sx4.E7.m2.3.3.3.3.3.3.3" xref="Sx4.E7.m2.3.3.3.3.3.3.3.cmml">2</mn></mfrac><mo id="Sx4.E7.m2.3.3.3a.5.2" xref="Sx4.E7.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx4.E7.m2.11.11.1.1.3.2.2.1" xref="Sx4.E7.m2.11.11.1.1.3.2.2.1.cmml">​</mo><mrow id="Sx4.E7.m2.11.11.1.1.3.2.2.2" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.cmml"><mstyle displaystyle="true" id="Sx4.E7.m2.11.11.1.1.3.2.2.2.1" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.cmml"><munder id="Sx4.E7.m2.11.11.1.1.3.2.2.2.1a" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.cmml"><mo movablelimits="false" id="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.2" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.2.cmml">∑</mo><mrow id="Sx4.E7.m2.8.8.4.4" xref="Sx4.E7.m2.8.8.4.5.cmml"><mrow id="Sx4.E7.m2.7.7.3.3.1" xref="Sx4.E7.m2.7.7.3.3.1.cmml"><mrow id="Sx4.E7.m2.7.7.3.3.1.2.2" xref="Sx4.E7.m2.7.7.3.3.1.2.1.cmml"><mi id="Sx4.E7.m2.5.5.1.1" xref="Sx4.E7.m2.5.5.1.1.cmml">i</mi><mo id="Sx4.E7.m2.7.7.3.3.1.2.2.1" xref="Sx4.E7.m2.7.7.3.3.1.2.1.cmml">,</mo><mi id="Sx4.E7.m2.6.6.2.2" xref="Sx4.E7.m2.6.6.2.2.cmml">j</mi></mrow><mo id="Sx4.E7.m2.7.7.3.3.1.1" xref="Sx4.E7.m2.7.7.3.3.1.1.cmml">∈</mo><mi id="Sx4.E7.m2.7.7.3.3.1.3" xref="Sx4.E7.m2.7.7.3.3.1.3.cmml">c</mi></mrow><mo id="Sx4.E7.m2.8.8.4.4.3" xref="Sx4.E7.m2.8.8.4.5a.cmml">,</mo><mrow id="Sx4.E7.m2.8.8.4.4.2" xref="Sx4.E7.m2.8.8.4.4.2.cmml"><mi id="Sx4.E7.m2.8.8.4.4.2.2" xref="Sx4.E7.m2.8.8.4.4.2.2.cmml">i</mi><mo id="Sx4.E7.m2.8.8.4.4.2.1" xref="Sx4.E7.m2.8.8.4.4.2.1.cmml">≠</mo><mi id="Sx4.E7.m2.8.8.4.4.2.3" xref="Sx4.E7.m2.8.8.4.4.2.3.cmml">j</mi></mrow></mrow></munder></mstyle><mstyle displaystyle="true" id="Sx4.E7.m2.10.10" xref="Sx4.E7.m2.10.10.cmml"><mfrac id="Sx4.E7.m2.10.10a" xref="Sx4.E7.m2.10.10.cmml"><mrow id="Sx4.E7.m2.10.10.4" xref="Sx4.E7.m2.10.10.4.cmml"><msubsup id="Sx4.E7.m2.10.10.4.2" xref="Sx4.E7.m2.10.10.4.2.cmml"><mi id="Sx4.E7.m2.10.10.4.2.2.2" xref="Sx4.E7.m2.10.10.4.2.2.2.cmml">d</mi><mi id="Sx4.E7.m2.10.10.4.2.2.3" xref="Sx4.E7.m2.10.10.4.2.2.3.cmml">i</mi><mi id="Sx4.E7.m2.10.10.4.2.3" xref="Sx4.E7.m2.10.10.4.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx4.E7.m2.10.10.4.1" xref="Sx4.E7.m2.10.10.4.1.cmml">​</mo><msub id="Sx4.E7.m2.10.10.4.3" xref="Sx4.E7.m2.10.10.4.3.cmml"><mi id="Sx4.E7.m2.10.10.4.3.2" xref="Sx4.E7.m2.10.10.4.3.2.cmml">d</mi><mi id="Sx4.E7.m2.10.10.4.3.3" xref="Sx4.E7.m2.10.10.4.3.3.cmml">j</mi></msub></mrow><mrow id="Sx4.E7.m2.10.10.2" xref="Sx4.E7.m2.10.10.2.cmml"><msub id="Sx4.E7.m2.9.9.1.1" xref="Sx4.E7.m2.9.9.1.1.cmml"><mrow id="Sx4.E7.m2.9.9.1.1.1.1" xref="Sx4.E7.m2.9.9.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.E7.m2.9.9.1.1.1.1.2" xref="Sx4.E7.m2.9.9.1.1.1.2.1.cmml">‖</mo><msub id="Sx4.E7.m2.9.9.1.1.1.1.1" xref="Sx4.E7.m2.9.9.1.1.1.1.1.cmml"><mi id="Sx4.E7.m2.9.9.1.1.1.1.1.2" xref="Sx4.E7.m2.9.9.1.1.1.1.1.2.cmml">d</mi><mi id="Sx4.E7.m2.9.9.1.1.1.1.1.3" xref="Sx4.E7.m2.9.9.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx4.E7.m2.9.9.1.1.1.1.3" xref="Sx4.E7.m2.9.9.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx4.E7.m2.9.9.1.1.3" xref="Sx4.E7.m2.9.9.1.1.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="Sx4.E7.m2.10.10.2.3" xref="Sx4.E7.m2.10.10.2.3.cmml">​</mo><msub id="Sx4.E7.m2.10.10.2.2" xref="Sx4.E7.m2.10.10.2.2.cmml"><mrow id="Sx4.E7.m2.10.10.2.2.1.1" xref="Sx4.E7.m2.10.10.2.2.1.2.cmml"><mo stretchy="false" id="Sx4.E7.m2.10.10.2.2.1.1.2" xref="Sx4.E7.m2.10.10.2.2.1.2.1.cmml">‖</mo><msub id="Sx4.E7.m2.10.10.2.2.1.1.1" xref="Sx4.E7.m2.10.10.2.2.1.1.1.cmml"><mi id="Sx4.E7.m2.10.10.2.2.1.1.1.2" xref="Sx4.E7.m2.10.10.2.2.1.1.1.2.cmml">d</mi><mi id="Sx4.E7.m2.10.10.2.2.1.1.1.3" xref="Sx4.E7.m2.10.10.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="Sx4.E7.m2.10.10.2.2.1.1.3" xref="Sx4.E7.m2.10.10.2.2.1.2.1.cmml">‖</mo></mrow><mn id="Sx4.E7.m2.10.10.2.2.3" xref="Sx4.E7.m2.10.10.2.2.3.cmml">2</mn></msub></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="Sx4.E7.m2.11.11.1.2" xref="Sx4.E7.m2.11.11.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E7.m2.11b"><apply id="Sx4.E7.m2.11.11.1.1.cmml" xref="Sx4.E7.m2.11.11.1"><eq id="Sx4.E7.m2.11.11.1.1.1.cmml" xref="Sx4.E7.m2.11.11.1.1.1"></eq><csymbol cd="latexml" id="Sx4.E7.m2.11.11.1.1.2.cmml" xref="Sx4.E7.m2.11.11.1.1.2">absent</csymbol><apply id="Sx4.E7.m2.11.11.1.1.3.cmml" xref="Sx4.E7.m2.11.11.1.1.3"><times id="Sx4.E7.m2.11.11.1.1.3.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.1"></times><apply id="Sx4.E7.m2.4.4.cmml" xref="Sx4.E7.m2.4.4"><divide id="Sx4.E7.m2.4.4.2.cmml" xref="Sx4.E7.m2.4.4"></divide><cn type="integer" id="Sx4.E7.m2.4.4.3.cmml" xref="Sx4.E7.m2.4.4.3">1</cn><apply id="Sx4.E7.m2.4.4.1.2.cmml" xref="Sx4.E7.m2.4.4.1.3"><abs id="Sx4.E7.m2.4.4.1.2.1.cmml" xref="Sx4.E7.m2.4.4.1.3.1"></abs><ci id="Sx4.E7.m2.4.4.1.1.cmml" xref="Sx4.E7.m2.4.4.1.1">ℂ</ci></apply></apply><apply id="Sx4.E7.m2.11.11.1.1.3.2.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2"><apply id="Sx4.E7.m2.11.11.1.1.3.2.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx4.E7.m2.11.11.1.1.3.2.1.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1">subscript</csymbol><sum id="Sx4.E7.m2.11.11.1.1.3.2.1.2.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1.2"></sum><apply id="Sx4.E7.m2.11.11.1.1.3.2.1.3.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3"><in id="Sx4.E7.m2.11.11.1.1.3.2.1.3.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.1"></in><ci id="Sx4.E7.m2.11.11.1.1.3.2.1.3.2.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.2">𝑐</ci><ci id="Sx4.E7.m2.11.11.1.1.3.2.1.3.3.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.1.3.3">ℂ</ci></apply></apply><apply id="Sx4.E7.m2.11.11.1.1.3.2.2.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.2"><times id="Sx4.E7.m2.11.11.1.1.3.2.2.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.2.1"></times><apply id="Sx4.E7.m2.3.3a.cmml" xref="Sx4.E7.m2.3.3a"><divide id="Sx4.E7.m2.3.3a.4.cmml" xref="Sx4.E7.m2.3.3a"></divide><cn type="integer" id="Sx4.E7.m2.3.3a.5.cmml" xref="Sx4.E7.m2.3.3a.5">1</cn><apply id="Sx4.E7.m2.3.3.3a.4.cmml" xref="Sx4.E7.m2.3.3.3a.5"><csymbol cd="latexml" id="Sx4.E7.m2.1.1.1.1.1.1.1.cmml" xref="Sx4.E7.m2.3.3.3a.5.1">binomial</csymbol><apply id="Sx4.E7.m2.2.2.2.2.2.2.2.2.cmml" xref="Sx4.E7.m2.2.2.2.2.2.2.2.3"><abs id="Sx4.E7.m2.2.2.2.2.2.2.2.2.1.cmml" xref="Sx4.E7.m2.2.2.2.2.2.2.2.3.1"></abs><ci id="Sx4.E7.m2.2.2.2.2.2.2.2.1.cmml" xref="Sx4.E7.m2.2.2.2.2.2.2.2.1">𝑐</ci></apply><cn type="integer" id="Sx4.E7.m2.3.3.3.3.3.3.3.cmml" xref="Sx4.E7.m2.3.3.3.3.3.3.3">2</cn></apply></apply><apply id="Sx4.E7.m2.11.11.1.1.3.2.2.2.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2"><apply id="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.1"><csymbol cd="ambiguous" id="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.1.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.1">subscript</csymbol><sum id="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.2.cmml" xref="Sx4.E7.m2.11.11.1.1.3.2.2.2.1.2"></sum><apply id="Sx4.E7.m2.8.8.4.5.cmml" xref="Sx4.E7.m2.8.8.4.4"><csymbol cd="ambiguous" id="Sx4.E7.m2.8.8.4.5a.cmml" xref="Sx4.E7.m2.8.8.4.4.3">formulae-sequence</csymbol><apply id="Sx4.E7.m2.7.7.3.3.1.cmml" xref="Sx4.E7.m2.7.7.3.3.1"><in id="Sx4.E7.m2.7.7.3.3.1.1.cmml" xref="Sx4.E7.m2.7.7.3.3.1.1"></in><list id="Sx4.E7.m2.7.7.3.3.1.2.1.cmml" xref="Sx4.E7.m2.7.7.3.3.1.2.2"><ci id="Sx4.E7.m2.5.5.1.1.cmml" xref="Sx4.E7.m2.5.5.1.1">𝑖</ci><ci id="Sx4.E7.m2.6.6.2.2.cmml" xref="Sx4.E7.m2.6.6.2.2">𝑗</ci></list><ci id="Sx4.E7.m2.7.7.3.3.1.3.cmml" xref="Sx4.E7.m2.7.7.3.3.1.3">𝑐</ci></apply><apply id="Sx4.E7.m2.8.8.4.4.2.cmml" xref="Sx4.E7.m2.8.8.4.4.2"><neq id="Sx4.E7.m2.8.8.4.4.2.1.cmml" xref="Sx4.E7.m2.8.8.4.4.2.1"></neq><ci id="Sx4.E7.m2.8.8.4.4.2.2.cmml" xref="Sx4.E7.m2.8.8.4.4.2.2">𝑖</ci><ci id="Sx4.E7.m2.8.8.4.4.2.3.cmml" xref="Sx4.E7.m2.8.8.4.4.2.3">𝑗</ci></apply></apply></apply><apply id="Sx4.E7.m2.10.10.cmml" xref="Sx4.E7.m2.10.10"><divide id="Sx4.E7.m2.10.10.3.cmml" xref="Sx4.E7.m2.10.10"></divide><apply id="Sx4.E7.m2.10.10.4.cmml" xref="Sx4.E7.m2.10.10.4"><times id="Sx4.E7.m2.10.10.4.1.cmml" xref="Sx4.E7.m2.10.10.4.1"></times><apply id="Sx4.E7.m2.10.10.4.2.cmml" xref="Sx4.E7.m2.10.10.4.2"><csymbol cd="ambiguous" id="Sx4.E7.m2.10.10.4.2.1.cmml" xref="Sx4.E7.m2.10.10.4.2">superscript</csymbol><apply id="Sx4.E7.m2.10.10.4.2.2.cmml" xref="Sx4.E7.m2.10.10.4.2"><csymbol cd="ambiguous" id="Sx4.E7.m2.10.10.4.2.2.1.cmml" xref="Sx4.E7.m2.10.10.4.2">subscript</csymbol><ci id="Sx4.E7.m2.10.10.4.2.2.2.cmml" xref="Sx4.E7.m2.10.10.4.2.2.2">𝑑</ci><ci id="Sx4.E7.m2.10.10.4.2.2.3.cmml" xref="Sx4.E7.m2.10.10.4.2.2.3">𝑖</ci></apply><ci id="Sx4.E7.m2.10.10.4.2.3.cmml" xref="Sx4.E7.m2.10.10.4.2.3">𝑇</ci></apply><apply id="Sx4.E7.m2.10.10.4.3.cmml" xref="Sx4.E7.m2.10.10.4.3"><csymbol cd="ambiguous" id="Sx4.E7.m2.10.10.4.3.1.cmml" xref="Sx4.E7.m2.10.10.4.3">subscript</csymbol><ci id="Sx4.E7.m2.10.10.4.3.2.cmml" xref="Sx4.E7.m2.10.10.4.3.2">𝑑</ci><ci id="Sx4.E7.m2.10.10.4.3.3.cmml" xref="Sx4.E7.m2.10.10.4.3.3">𝑗</ci></apply></apply><apply id="Sx4.E7.m2.10.10.2.cmml" xref="Sx4.E7.m2.10.10.2"><times id="Sx4.E7.m2.10.10.2.3.cmml" xref="Sx4.E7.m2.10.10.2.3"></times><apply id="Sx4.E7.m2.9.9.1.1.cmml" xref="Sx4.E7.m2.9.9.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m2.9.9.1.1.2.cmml" xref="Sx4.E7.m2.9.9.1.1">subscript</csymbol><apply id="Sx4.E7.m2.9.9.1.1.1.2.cmml" xref="Sx4.E7.m2.9.9.1.1.1.1"><csymbol cd="latexml" id="Sx4.E7.m2.9.9.1.1.1.2.1.cmml" xref="Sx4.E7.m2.9.9.1.1.1.1.2">norm</csymbol><apply id="Sx4.E7.m2.9.9.1.1.1.1.1.cmml" xref="Sx4.E7.m2.9.9.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m2.9.9.1.1.1.1.1.1.cmml" xref="Sx4.E7.m2.9.9.1.1.1.1.1">subscript</csymbol><ci id="Sx4.E7.m2.9.9.1.1.1.1.1.2.cmml" xref="Sx4.E7.m2.9.9.1.1.1.1.1.2">𝑑</ci><ci id="Sx4.E7.m2.9.9.1.1.1.1.1.3.cmml" xref="Sx4.E7.m2.9.9.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="Sx4.E7.m2.9.9.1.1.3.cmml" xref="Sx4.E7.m2.9.9.1.1.3">2</cn></apply><apply id="Sx4.E7.m2.10.10.2.2.cmml" xref="Sx4.E7.m2.10.10.2.2"><csymbol cd="ambiguous" id="Sx4.E7.m2.10.10.2.2.2.cmml" xref="Sx4.E7.m2.10.10.2.2">subscript</csymbol><apply id="Sx4.E7.m2.10.10.2.2.1.2.cmml" xref="Sx4.E7.m2.10.10.2.2.1.1"><csymbol cd="latexml" id="Sx4.E7.m2.10.10.2.2.1.2.1.cmml" xref="Sx4.E7.m2.10.10.2.2.1.1.2">norm</csymbol><apply id="Sx4.E7.m2.10.10.2.2.1.1.1.cmml" xref="Sx4.E7.m2.10.10.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx4.E7.m2.10.10.2.2.1.1.1.1.cmml" xref="Sx4.E7.m2.10.10.2.2.1.1.1">subscript</csymbol><ci id="Sx4.E7.m2.10.10.2.2.1.1.1.2.cmml" xref="Sx4.E7.m2.10.10.2.2.1.1.1.2">𝑑</ci><ci id="Sx4.E7.m2.10.10.2.2.1.1.1.3.cmml" xref="Sx4.E7.m2.10.10.2.2.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="Sx4.E7.m2.10.10.2.2.3.cmml" xref="Sx4.E7.m2.10.10.2.2.3">2</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E7.m2.11c">\displaystyle=\frac{1}{|\mathbb{C}|}\sum_{c\in\mathbb{C}}\frac{1}{{|c|\choose 2}}\sum_{i,j\in c,i\neq j}\frac{d_{i}^{T}d_{j}}{\|d_{i}\|_{2}\|d_{j}\|_{2}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="Sx4.SSx3.p2" class="ltx_para">
<p id="Sx4.SSx3.p2.1" class="ltx_p">In <a href="#Sx4.F2" title="In Cluster Uniformity ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> we report the evolution of uniformity with respect to the number of clusters. We compare the values with the ones we get by randomly assigning the clients to one of the available clusters (Random) and the ones we get by clustering the distribution vectors directly with the K-Means clustering (Distribution given). We observe that <span id="Sx4.SSx3.p2.1.1" class="ltx_ERROR undefined">\acronym</span>clusters remain highly uniform, occasionally reaching the optimal uniformity. We also plot the performance of WD and conclude that training data-based clustering does not bring additional improvements.</p>
</div>
<figure id="Sx4.F1" class="ltx_figure"><img src="/html/2309.14088/assets/correlation_summary_aaai.png" id="Sx4.F1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="202" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Correlation of dataset similarities and the corresponding client embeddings obtained with WD and <span id="Sx4.F1.2.1" class="ltx_ERROR undefined">\acronym</span>with client datasets sampled from CIFAR10.</figcaption>
</figure>
<figure id="Sx4.F2" class="ltx_figure"><img src="/html/2309.14088/assets/uniformity_mnist_aaai.png" id="Sx4.F2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="262" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Cluster uniformity when partitioning pathologically non-IID MNIST data.</figcaption>
</figure>
</section>
<section id="Sx4.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Cluster Robustness</h3>

<div id="Sx4.SSx4.p1" class="ltx_para">
<p id="Sx4.SSx4.p1.1" class="ltx_p">We argue that cluster robustness as defined in <a href="#Thmdefinition1" title="Definition 1 (Cluster robustness) ‣ Cluster Robustness ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Definition</span> <span class="ltx_text ltx_ref_tag">1</span></a> is a key metric of practical importance in clustered FL:</p>
</div>
<div id="Thmdefinition1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmdefinition1.1.1.1" class="ltx_text ltx_font_bold">Definition 1</span></span><span id="Thmdefinition1.2.2" class="ltx_text ltx_font_bold"> (Cluster robustness)</span>
</h6>
<div id="Thmdefinition1.p1" class="ltx_para">
<p id="Thmdefinition1.p1.1" class="ltx_p"><span id="Thmdefinition1.p1.1.1" class="ltx_text ltx_font_italic">Cluster robustness is the probability that two clients with similar dataset properties belong to the same cluster.</span></p>
</div>
</div>
<div id="Sx4.SSx4.p2" class="ltx_para">
<p id="Sx4.SSx4.p2.11" class="ltx_p">If we assume, that the cluster model <math id="Sx4.SSx4.p2.1.m1.1" class="ltx_Math" alttext="\theta_{\alpha(i)}" display="inline"><semantics id="Sx4.SSx4.p2.1.m1.1a"><msub id="Sx4.SSx4.p2.1.m1.1.2" xref="Sx4.SSx4.p2.1.m1.1.2.cmml"><mi id="Sx4.SSx4.p2.1.m1.1.2.2" xref="Sx4.SSx4.p2.1.m1.1.2.2.cmml">θ</mi><mrow id="Sx4.SSx4.p2.1.m1.1.1.1" xref="Sx4.SSx4.p2.1.m1.1.1.1.cmml"><mi id="Sx4.SSx4.p2.1.m1.1.1.1.3" xref="Sx4.SSx4.p2.1.m1.1.1.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.1.m1.1.1.1.2" xref="Sx4.SSx4.p2.1.m1.1.1.1.2.cmml">​</mo><mrow id="Sx4.SSx4.p2.1.m1.1.1.1.4.2" xref="Sx4.SSx4.p2.1.m1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.1.m1.1.1.1.4.2.1" xref="Sx4.SSx4.p2.1.m1.1.1.1.cmml">(</mo><mi id="Sx4.SSx4.p2.1.m1.1.1.1.1" xref="Sx4.SSx4.p2.1.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx4.SSx4.p2.1.m1.1.1.1.4.2.2" xref="Sx4.SSx4.p2.1.m1.1.1.1.cmml">)</mo></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.1.m1.1b"><apply id="Sx4.SSx4.p2.1.m1.1.2.cmml" xref="Sx4.SSx4.p2.1.m1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx4.p2.1.m1.1.2.1.cmml" xref="Sx4.SSx4.p2.1.m1.1.2">subscript</csymbol><ci id="Sx4.SSx4.p2.1.m1.1.2.2.cmml" xref="Sx4.SSx4.p2.1.m1.1.2.2">𝜃</ci><apply id="Sx4.SSx4.p2.1.m1.1.1.1.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1"><times id="Sx4.SSx4.p2.1.m1.1.1.1.2.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.2"></times><ci id="Sx4.SSx4.p2.1.m1.1.1.1.3.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.3">𝛼</ci><ci id="Sx4.SSx4.p2.1.m1.1.1.1.1.cmml" xref="Sx4.SSx4.p2.1.m1.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.1.m1.1c">\theta_{\alpha(i)}</annotation></semantics></math> is, among all the trained cluster models, the model that yields the best performance on dataset <math id="Sx4.SSx4.p2.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx4.SSx4.p2.2.m2.1a"><msub id="Sx4.SSx4.p2.2.m2.1.1" xref="Sx4.SSx4.p2.2.m2.1.1.cmml"><mi id="Sx4.SSx4.p2.2.m2.1.1.2" xref="Sx4.SSx4.p2.2.m2.1.1.2.cmml">D</mi><mi id="Sx4.SSx4.p2.2.m2.1.1.3" xref="Sx4.SSx4.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.2.m2.1b"><apply id="Sx4.SSx4.p2.2.m2.1.1.cmml" xref="Sx4.SSx4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx4.p2.2.m2.1.1.1.cmml" xref="Sx4.SSx4.p2.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx4.p2.2.m2.1.1.2.cmml" xref="Sx4.SSx4.p2.2.m2.1.1.2">𝐷</ci><ci id="Sx4.SSx4.p2.2.m2.1.1.3.cmml" xref="Sx4.SSx4.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.2.m2.1c">D_{i}</annotation></semantics></math>, and that the performance of the cluster models <math id="Sx4.SSx4.p2.3.m3.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="Sx4.SSx4.p2.3.m3.1a"><msub id="Sx4.SSx4.p2.3.m3.1.1" xref="Sx4.SSx4.p2.3.m3.1.1.cmml"><mi id="Sx4.SSx4.p2.3.m3.1.1.2" xref="Sx4.SSx4.p2.3.m3.1.1.2.cmml">θ</mi><mi id="Sx4.SSx4.p2.3.m3.1.1.3" xref="Sx4.SSx4.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.3.m3.1b"><apply id="Sx4.SSx4.p2.3.m3.1.1.cmml" xref="Sx4.SSx4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx4.p2.3.m3.1.1.1.cmml" xref="Sx4.SSx4.p2.3.m3.1.1">subscript</csymbol><ci id="Sx4.SSx4.p2.3.m3.1.1.2.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.2">𝜃</ci><ci id="Sx4.SSx4.p2.3.m3.1.1.3.cmml" xref="Sx4.SSx4.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.3.m3.1c">\theta_{k}</annotation></semantics></math> do not deviate significantly over similar datasets, then cluster robustness states the probability that a previously unseen client is served the cluster model best suited for its local dataset. This probability cannot be measured directly, thus we estimate the robustness of a single cluster <math id="Sx4.SSx4.p2.4.m4.1" class="ltx_Math" alttext="r(c)" display="inline"><semantics id="Sx4.SSx4.p2.4.m4.1a"><mrow id="Sx4.SSx4.p2.4.m4.1.2" xref="Sx4.SSx4.p2.4.m4.1.2.cmml"><mi id="Sx4.SSx4.p2.4.m4.1.2.2" xref="Sx4.SSx4.p2.4.m4.1.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.4.m4.1.2.1" xref="Sx4.SSx4.p2.4.m4.1.2.1.cmml">​</mo><mrow id="Sx4.SSx4.p2.4.m4.1.2.3.2" xref="Sx4.SSx4.p2.4.m4.1.2.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.4.m4.1.2.3.2.1" xref="Sx4.SSx4.p2.4.m4.1.2.cmml">(</mo><mi id="Sx4.SSx4.p2.4.m4.1.1" xref="Sx4.SSx4.p2.4.m4.1.1.cmml">c</mi><mo stretchy="false" id="Sx4.SSx4.p2.4.m4.1.2.3.2.2" xref="Sx4.SSx4.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.4.m4.1b"><apply id="Sx4.SSx4.p2.4.m4.1.2.cmml" xref="Sx4.SSx4.p2.4.m4.1.2"><times id="Sx4.SSx4.p2.4.m4.1.2.1.cmml" xref="Sx4.SSx4.p2.4.m4.1.2.1"></times><ci id="Sx4.SSx4.p2.4.m4.1.2.2.cmml" xref="Sx4.SSx4.p2.4.m4.1.2.2">𝑟</ci><ci id="Sx4.SSx4.p2.4.m4.1.1.cmml" xref="Sx4.SSx4.p2.4.m4.1.1">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.4.m4.1c">r(c)</annotation></semantics></math> empirically with <a href="#alg1" title="In Cluster Robustness ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>. The robustness of the whole clustering structure <math id="Sx4.SSx4.p2.5.m5.1" class="ltx_Math" alttext="\mathbb{C}" display="inline"><semantics id="Sx4.SSx4.p2.5.m5.1a"><mi id="Sx4.SSx4.p2.5.m5.1.1" xref="Sx4.SSx4.p2.5.m5.1.1.cmml">ℂ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.5.m5.1b"><ci id="Sx4.SSx4.p2.5.m5.1.1.cmml" xref="Sx4.SSx4.p2.5.m5.1.1">ℂ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.5.m5.1c">\mathbb{C}</annotation></semantics></math> is then defined as <math id="Sx4.SSx4.p2.6.m6.3" class="ltx_Math" alttext="r(\mathbb{C})=\frac{1}{|\mathbb{C}|}\sum_{c\in\mathbb{C}}r(c)" display="inline"><semantics id="Sx4.SSx4.p2.6.m6.3a"><mrow id="Sx4.SSx4.p2.6.m6.3.4" xref="Sx4.SSx4.p2.6.m6.3.4.cmml"><mrow id="Sx4.SSx4.p2.6.m6.3.4.2" xref="Sx4.SSx4.p2.6.m6.3.4.2.cmml"><mi id="Sx4.SSx4.p2.6.m6.3.4.2.2" xref="Sx4.SSx4.p2.6.m6.3.4.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.6.m6.3.4.2.1" xref="Sx4.SSx4.p2.6.m6.3.4.2.1.cmml">​</mo><mrow id="Sx4.SSx4.p2.6.m6.3.4.2.3.2" xref="Sx4.SSx4.p2.6.m6.3.4.2.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.6.m6.3.4.2.3.2.1" xref="Sx4.SSx4.p2.6.m6.3.4.2.cmml">(</mo><mi id="Sx4.SSx4.p2.6.m6.2.2" xref="Sx4.SSx4.p2.6.m6.2.2.cmml">ℂ</mi><mo stretchy="false" id="Sx4.SSx4.p2.6.m6.3.4.2.3.2.2" xref="Sx4.SSx4.p2.6.m6.3.4.2.cmml">)</mo></mrow></mrow><mo id="Sx4.SSx4.p2.6.m6.3.4.1" xref="Sx4.SSx4.p2.6.m6.3.4.1.cmml">=</mo><mrow id="Sx4.SSx4.p2.6.m6.3.4.3" xref="Sx4.SSx4.p2.6.m6.3.4.3.cmml"><mfrac id="Sx4.SSx4.p2.6.m6.1.1" xref="Sx4.SSx4.p2.6.m6.1.1.cmml"><mn id="Sx4.SSx4.p2.6.m6.1.1.3" xref="Sx4.SSx4.p2.6.m6.1.1.3.cmml">1</mn><mrow id="Sx4.SSx4.p2.6.m6.1.1.1.3" xref="Sx4.SSx4.p2.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.6.m6.1.1.1.3.1" xref="Sx4.SSx4.p2.6.m6.1.1.1.2.1.cmml">|</mo><mi id="Sx4.SSx4.p2.6.m6.1.1.1.1" xref="Sx4.SSx4.p2.6.m6.1.1.1.1.cmml">ℂ</mi><mo stretchy="false" id="Sx4.SSx4.p2.6.m6.1.1.1.3.2" xref="Sx4.SSx4.p2.6.m6.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.6.m6.3.4.3.1" xref="Sx4.SSx4.p2.6.m6.3.4.3.1.cmml">​</mo><mrow id="Sx4.SSx4.p2.6.m6.3.4.3.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.cmml"><msub id="Sx4.SSx4.p2.6.m6.3.4.3.2.1" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.cmml"><mo id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.2.cmml">∑</mo><mrow id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.cmml"><mi id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.2.cmml">c</mi><mo id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.1" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.1.cmml">∈</mo><mi id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.3" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.3.cmml">ℂ</mi></mrow></msub><mrow id="Sx4.SSx4.p2.6.m6.3.4.3.2.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.cmml"><mi id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.1" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.1.cmml">​</mo><mrow id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.3.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.3.2.1" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.cmml">(</mo><mi id="Sx4.SSx4.p2.6.m6.3.3" xref="Sx4.SSx4.p2.6.m6.3.3.cmml">c</mi><mo stretchy="false" id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.3.2.2" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.6.m6.3b"><apply id="Sx4.SSx4.p2.6.m6.3.4.cmml" xref="Sx4.SSx4.p2.6.m6.3.4"><eq id="Sx4.SSx4.p2.6.m6.3.4.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.1"></eq><apply id="Sx4.SSx4.p2.6.m6.3.4.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.2"><times id="Sx4.SSx4.p2.6.m6.3.4.2.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.2.1"></times><ci id="Sx4.SSx4.p2.6.m6.3.4.2.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.2.2">𝑟</ci><ci id="Sx4.SSx4.p2.6.m6.2.2.cmml" xref="Sx4.SSx4.p2.6.m6.2.2">ℂ</ci></apply><apply id="Sx4.SSx4.p2.6.m6.3.4.3.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3"><times id="Sx4.SSx4.p2.6.m6.3.4.3.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.1"></times><apply id="Sx4.SSx4.p2.6.m6.1.1.cmml" xref="Sx4.SSx4.p2.6.m6.1.1"><divide id="Sx4.SSx4.p2.6.m6.1.1.2.cmml" xref="Sx4.SSx4.p2.6.m6.1.1"></divide><cn type="integer" id="Sx4.SSx4.p2.6.m6.1.1.3.cmml" xref="Sx4.SSx4.p2.6.m6.1.1.3">1</cn><apply id="Sx4.SSx4.p2.6.m6.1.1.1.2.cmml" xref="Sx4.SSx4.p2.6.m6.1.1.1.3"><abs id="Sx4.SSx4.p2.6.m6.1.1.1.2.1.cmml" xref="Sx4.SSx4.p2.6.m6.1.1.1.3.1"></abs><ci id="Sx4.SSx4.p2.6.m6.1.1.1.1.cmml" xref="Sx4.SSx4.p2.6.m6.1.1.1.1">ℂ</ci></apply></apply><apply id="Sx4.SSx4.p2.6.m6.3.4.3.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2"><apply id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1"><csymbol cd="ambiguous" id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1">subscript</csymbol><sum id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.2"></sum><apply id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3"><in id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.1"></in><ci id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.2">𝑐</ci><ci id="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.3.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.1.3.3">ℂ</ci></apply></apply><apply id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2"><times id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.1.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.1"></times><ci id="Sx4.SSx4.p2.6.m6.3.4.3.2.2.2.cmml" xref="Sx4.SSx4.p2.6.m6.3.4.3.2.2.2">𝑟</ci><ci id="Sx4.SSx4.p2.6.m6.3.3.cmml" xref="Sx4.SSx4.p2.6.m6.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.6.m6.3c">r(\mathbb{C})=\frac{1}{|\mathbb{C}|}\sum_{c\in\mathbb{C}}r(c)</annotation></semantics></math>. Note that in line 4 of the algorithm, we generate a client with a DGP similar to the DGP of an existing client whose data distribution is described with vector <math id="Sx4.SSx4.p2.7.m7.1" class="ltx_Math" alttext="d_{i}" display="inline"><semantics id="Sx4.SSx4.p2.7.m7.1a"><msub id="Sx4.SSx4.p2.7.m7.1.1" xref="Sx4.SSx4.p2.7.m7.1.1.cmml"><mi id="Sx4.SSx4.p2.7.m7.1.1.2" xref="Sx4.SSx4.p2.7.m7.1.1.2.cmml">d</mi><mi id="Sx4.SSx4.p2.7.m7.1.1.3" xref="Sx4.SSx4.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.7.m7.1b"><apply id="Sx4.SSx4.p2.7.m7.1.1.cmml" xref="Sx4.SSx4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="Sx4.SSx4.p2.7.m7.1.1.1.cmml" xref="Sx4.SSx4.p2.7.m7.1.1">subscript</csymbol><ci id="Sx4.SSx4.p2.7.m7.1.1.2.cmml" xref="Sx4.SSx4.p2.7.m7.1.1.2">𝑑</ci><ci id="Sx4.SSx4.p2.7.m7.1.1.3.cmml" xref="Sx4.SSx4.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.7.m7.1c">d_{i}</annotation></semantics></math>. This is done by randomly sampling images so that the new client’s data is distributed according to <math id="Sx4.SSx4.p2.8.m8.1" class="ltx_Math" alttext="(d_{i}+n)\cdot s" display="inline"><semantics id="Sx4.SSx4.p2.8.m8.1a"><mrow id="Sx4.SSx4.p2.8.m8.1.1" xref="Sx4.SSx4.p2.8.m8.1.1.cmml"><mrow id="Sx4.SSx4.p2.8.m8.1.1.1.1" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx4.p2.8.m8.1.1.1.1.2" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.SSx4.p2.8.m8.1.1.1.1.1" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.cmml"><msub id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.cmml"><mi id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.2" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.2.cmml">d</mi><mi id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.3" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.1" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.1.cmml">+</mo><mi id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.3" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.3.cmml">n</mi></mrow><mo rspace="0.055em" stretchy="false" id="Sx4.SSx4.p2.8.m8.1.1.1.1.3" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Sx4.SSx4.p2.8.m8.1.1.2" xref="Sx4.SSx4.p2.8.m8.1.1.2.cmml">⋅</mo><mi id="Sx4.SSx4.p2.8.m8.1.1.3" xref="Sx4.SSx4.p2.8.m8.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.8.m8.1b"><apply id="Sx4.SSx4.p2.8.m8.1.1.cmml" xref="Sx4.SSx4.p2.8.m8.1.1"><ci id="Sx4.SSx4.p2.8.m8.1.1.2.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.2">⋅</ci><apply id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1"><plus id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.1.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.1"></plus><apply id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.1.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2">subscript</csymbol><ci id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.2.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.2">𝑑</ci><ci id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx4.p2.8.m8.1.1.1.1.1.3.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.1.1.1.3">𝑛</ci></apply><ci id="Sx4.SSx4.p2.8.m8.1.1.3.cmml" xref="Sx4.SSx4.p2.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.8.m8.1c">(d_{i}+n)\cdot s</annotation></semantics></math>, where <math id="Sx4.SSx4.p2.9.m9.1" class="ltx_Math" alttext="n" display="inline"><semantics id="Sx4.SSx4.p2.9.m9.1a"><mi id="Sx4.SSx4.p2.9.m9.1.1" xref="Sx4.SSx4.p2.9.m9.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.9.m9.1b"><ci id="Sx4.SSx4.p2.9.m9.1.1.cmml" xref="Sx4.SSx4.p2.9.m9.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.9.m9.1c">n</annotation></semantics></math> is a noise vector and <math id="Sx4.SSx4.p2.10.m10.1" class="ltx_Math" alttext="s" display="inline"><semantics id="Sx4.SSx4.p2.10.m10.1a"><mi id="Sx4.SSx4.p2.10.m10.1.1" xref="Sx4.SSx4.p2.10.m10.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.10.m10.1b"><ci id="Sx4.SSx4.p2.10.m10.1.1.cmml" xref="Sx4.SSx4.p2.10.m10.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.10.m10.1c">s</annotation></semantics></math> is a scaling factor allowing the similar client to have a dataset of a different size. After sampling the images that compose the generated client’s dataset, the reference client <math id="Sx4.SSx4.p2.11.m11.1" class="ltx_Math" alttext="r" display="inline"><semantics id="Sx4.SSx4.p2.11.m11.1a"><mi id="Sx4.SSx4.p2.11.m11.1.1" xref="Sx4.SSx4.p2.11.m11.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p2.11.m11.1b"><ci id="Sx4.SSx4.p2.11.m11.1.1.cmml" xref="Sx4.SSx4.p2.11.m11.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p2.11.m11.1c">r</annotation></semantics></math>’s image augmentation pipeline is applied to the generated dataset.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.10.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Algorithm for measuring cluster <math id="alg1.2.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.2.m1.1b"><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">c</annotation></semantics></math>’s robustness</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.8" class="ltx_p ltx_figure_panel"><span id="alg1.8.1" class="ltx_text ltx_font_bold">Input</span>: list of clients <math id="alg1.3.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.3.m1.1a"><mi id="alg1.3.m1.1.1" xref="alg1.3.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m1.1b"><ci id="alg1.3.m1.1.1.cmml" xref="alg1.3.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m1.1c">L</annotation></semantics></math> belonging to cluster <math id="alg1.4.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.4.m2.1a"><mi id="alg1.4.m2.1.1" xref="alg1.4.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m2.1b"><ci id="alg1.4.m2.1.1.cmml" xref="alg1.4.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m2.1c">c</annotation></semantics></math>, <math id="alg1.5.m3.1" class="ltx_Math" alttext="f_{emb}" display="inline"><semantics id="alg1.5.m3.1a"><msub id="alg1.5.m3.1.1" xref="alg1.5.m3.1.1.cmml"><mi id="alg1.5.m3.1.1.2" xref="alg1.5.m3.1.1.2.cmml">f</mi><mrow id="alg1.5.m3.1.1.3" xref="alg1.5.m3.1.1.3.cmml"><mi id="alg1.5.m3.1.1.3.2" xref="alg1.5.m3.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.5.m3.1.1.3.1" xref="alg1.5.m3.1.1.3.1.cmml">​</mo><mi id="alg1.5.m3.1.1.3.3" xref="alg1.5.m3.1.1.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.5.m3.1.1.3.1a" xref="alg1.5.m3.1.1.3.1.cmml">​</mo><mi id="alg1.5.m3.1.1.3.4" xref="alg1.5.m3.1.1.3.4.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.5.m3.1b"><apply id="alg1.5.m3.1.1.cmml" xref="alg1.5.m3.1.1"><csymbol cd="ambiguous" id="alg1.5.m3.1.1.1.cmml" xref="alg1.5.m3.1.1">subscript</csymbol><ci id="alg1.5.m3.1.1.2.cmml" xref="alg1.5.m3.1.1.2">𝑓</ci><apply id="alg1.5.m3.1.1.3.cmml" xref="alg1.5.m3.1.1.3"><times id="alg1.5.m3.1.1.3.1.cmml" xref="alg1.5.m3.1.1.3.1"></times><ci id="alg1.5.m3.1.1.3.2.cmml" xref="alg1.5.m3.1.1.3.2">𝑒</ci><ci id="alg1.5.m3.1.1.3.3.cmml" xref="alg1.5.m3.1.1.3.3">𝑚</ci><ci id="alg1.5.m3.1.1.3.4.cmml" xref="alg1.5.m3.1.1.3.4">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m3.1c">f_{emb}</annotation></semantics></math> algorithm for computing client embeddings, clustering model <math id="alg1.6.m4.1" class="ltx_Math" alttext="f_{clust}" display="inline"><semantics id="alg1.6.m4.1a"><msub id="alg1.6.m4.1.1" xref="alg1.6.m4.1.1.cmml"><mi id="alg1.6.m4.1.1.2" xref="alg1.6.m4.1.1.2.cmml">f</mi><mrow id="alg1.6.m4.1.1.3" xref="alg1.6.m4.1.1.3.cmml"><mi id="alg1.6.m4.1.1.3.2" xref="alg1.6.m4.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.6.m4.1.1.3.1" xref="alg1.6.m4.1.1.3.1.cmml">​</mo><mi id="alg1.6.m4.1.1.3.3" xref="alg1.6.m4.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.6.m4.1.1.3.1a" xref="alg1.6.m4.1.1.3.1.cmml">​</mo><mi id="alg1.6.m4.1.1.3.4" xref="alg1.6.m4.1.1.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.6.m4.1.1.3.1b" xref="alg1.6.m4.1.1.3.1.cmml">​</mo><mi id="alg1.6.m4.1.1.3.5" xref="alg1.6.m4.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.6.m4.1.1.3.1c" xref="alg1.6.m4.1.1.3.1.cmml">​</mo><mi id="alg1.6.m4.1.1.3.6" xref="alg1.6.m4.1.1.3.6.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.6.m4.1b"><apply id="alg1.6.m4.1.1.cmml" xref="alg1.6.m4.1.1"><csymbol cd="ambiguous" id="alg1.6.m4.1.1.1.cmml" xref="alg1.6.m4.1.1">subscript</csymbol><ci id="alg1.6.m4.1.1.2.cmml" xref="alg1.6.m4.1.1.2">𝑓</ci><apply id="alg1.6.m4.1.1.3.cmml" xref="alg1.6.m4.1.1.3"><times id="alg1.6.m4.1.1.3.1.cmml" xref="alg1.6.m4.1.1.3.1"></times><ci id="alg1.6.m4.1.1.3.2.cmml" xref="alg1.6.m4.1.1.3.2">𝑐</ci><ci id="alg1.6.m4.1.1.3.3.cmml" xref="alg1.6.m4.1.1.3.3">𝑙</ci><ci id="alg1.6.m4.1.1.3.4.cmml" xref="alg1.6.m4.1.1.3.4">𝑢</ci><ci id="alg1.6.m4.1.1.3.5.cmml" xref="alg1.6.m4.1.1.3.5">𝑠</ci><ci id="alg1.6.m4.1.1.3.6.cmml" xref="alg1.6.m4.1.1.3.6">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m4.1c">f_{clust}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.8.2" class="ltx_text ltx_font_bold">Parameter</span>: number of iterations <math id="alg1.7.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.7.m5.1a"><mi id="alg1.7.m5.1.1" xref="alg1.7.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m5.1b"><ci id="alg1.7.m5.1.1.cmml" xref="alg1.7.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m5.1c">n</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.8.3" class="ltx_text ltx_font_bold">Output</span>: Robustness of the cluster <math id="alg1.8.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="alg1.8.m6.1a"><mi id="alg1.8.m6.1.1" xref="alg1.8.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m6.1b"><ci id="alg1.8.m6.1.1.cmml" xref="alg1.8.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m6.1c">c</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.11" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg1.l1.m1.1" class="ltx_Math" alttext="n_{s}\leftarrow 0" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><msub id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">n</mi><mi id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝑛</ci><ci id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">𝑠</ci></apply><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">n_{s}\leftarrow 0</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="i\leftarrow 0" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">i\leftarrow 0</annotation></semantics></math> to <math id="alg1.l2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">n</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math id="alg1.l3.m1.1" class="ltx_Math" alttext="r\leftarrow" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑟</ci><csymbol cd="latexml" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">r\leftarrow</annotation></semantics></math> sample client from <math id="alg1.l3.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">L</annotation></semantics></math> uniformly at random

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math id="alg1.l4.m1.1" class="ltx_Math" alttext="p\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">p</mi><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑝</ci><csymbol cd="latexml" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">p\leftarrow</annotation></semantics></math> generate client with DGP similar as <math id="alg1.l4.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">r</annotation></semantics></math> 

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg1.l5.m1.1" class="ltx_Math" alttext="e_{p}\leftarrow f_{emb}(p)" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><msub id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml"><mi id="alg1.l5.m1.1.2.2.2" xref="alg1.l5.m1.1.2.2.2.cmml">e</mi><mi id="alg1.l5.m1.1.2.2.3" xref="alg1.l5.m1.1.2.2.3.cmml">p</mi></msub><mo stretchy="false" id="alg1.l5.m1.1.2.1" xref="alg1.l5.m1.1.2.1.cmml">←</mo><mrow id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3.cmml"><msub id="alg1.l5.m1.1.2.3.2" xref="alg1.l5.m1.1.2.3.2.cmml"><mi id="alg1.l5.m1.1.2.3.2.2" xref="alg1.l5.m1.1.2.3.2.2.cmml">f</mi><mrow id="alg1.l5.m1.1.2.3.2.3" xref="alg1.l5.m1.1.2.3.2.3.cmml"><mi id="alg1.l5.m1.1.2.3.2.3.2" xref="alg1.l5.m1.1.2.3.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.2.3.2.3.1" xref="alg1.l5.m1.1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.2.3.2.3.3" xref="alg1.l5.m1.1.2.3.2.3.3.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.2.3.2.3.1a" xref="alg1.l5.m1.1.2.3.2.3.1.cmml">​</mo><mi id="alg1.l5.m1.1.2.3.2.3.4" xref="alg1.l5.m1.1.2.3.2.3.4.cmml">b</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.2.3.1" xref="alg1.l5.m1.1.2.3.1.cmml">​</mo><mrow id="alg1.l5.m1.1.2.3.3.2" xref="alg1.l5.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.1.2.3.3.2.1" xref="alg1.l5.m1.1.2.3.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">p</mi><mo stretchy="false" id="alg1.l5.m1.1.2.3.3.2.2" xref="alg1.l5.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><ci id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1">←</ci><apply id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.2.1.cmml" xref="alg1.l5.m1.1.2.2">subscript</csymbol><ci id="alg1.l5.m1.1.2.2.2.cmml" xref="alg1.l5.m1.1.2.2.2">𝑒</ci><ci id="alg1.l5.m1.1.2.2.3.cmml" xref="alg1.l5.m1.1.2.2.3">𝑝</ci></apply><apply id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3"><times id="alg1.l5.m1.1.2.3.1.cmml" xref="alg1.l5.m1.1.2.3.1"></times><apply id="alg1.l5.m1.1.2.3.2.cmml" xref="alg1.l5.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.3.2.1.cmml" xref="alg1.l5.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l5.m1.1.2.3.2.2.cmml" xref="alg1.l5.m1.1.2.3.2.2">𝑓</ci><apply id="alg1.l5.m1.1.2.3.2.3.cmml" xref="alg1.l5.m1.1.2.3.2.3"><times id="alg1.l5.m1.1.2.3.2.3.1.cmml" xref="alg1.l5.m1.1.2.3.2.3.1"></times><ci id="alg1.l5.m1.1.2.3.2.3.2.cmml" xref="alg1.l5.m1.1.2.3.2.3.2">𝑒</ci><ci id="alg1.l5.m1.1.2.3.2.3.3.cmml" xref="alg1.l5.m1.1.2.3.2.3.3">𝑚</ci><ci id="alg1.l5.m1.1.2.3.2.3.4.cmml" xref="alg1.l5.m1.1.2.3.2.3.4">𝑏</ci></apply></apply><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">e_{p}\leftarrow f_{emb}(p)</annotation></semantics></math> {compute client embedding}

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.1" class="ltx_Math" alttext="c_{p}\leftarrow f_{clust}(e_{p})" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">c</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">p</mi></msub><mo stretchy="false" id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">←</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.3.2.cmml">f</mi><mrow id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.3.2" xref="alg1.l6.m1.1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.3.3.1" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.3.3.3" xref="alg1.l6.m1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.3.3.1a" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.3.3.4" xref="alg1.l6.m1.1.1.1.3.3.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.3.3.1b" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.3.3.5" xref="alg1.l6.m1.1.1.1.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.3.3.1c" xref="alg1.l6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.1.1.1.3.3.6" xref="alg1.l6.m1.1.1.1.3.3.6.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml">e</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml">p</mi></msub><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">←</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑐</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑝</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><times id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></times><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2">𝑓</ci><apply id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3"><times id="alg1.l6.m1.1.1.1.3.3.1.cmml" xref="alg1.l6.m1.1.1.1.3.3.1"></times><ci id="alg1.l6.m1.1.1.1.3.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.3.2">𝑐</ci><ci id="alg1.l6.m1.1.1.1.3.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3.3">𝑙</ci><ci id="alg1.l6.m1.1.1.1.3.3.4.cmml" xref="alg1.l6.m1.1.1.1.3.3.4">𝑢</ci><ci id="alg1.l6.m1.1.1.1.3.3.5.cmml" xref="alg1.l6.m1.1.1.1.3.3.5">𝑠</ci><ci id="alg1.l6.m1.1.1.1.3.3.6.cmml" xref="alg1.l6.m1.1.1.1.3.3.6">𝑡</ci></apply></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">𝑒</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">c_{p}\leftarrow f_{clust}(e_{p})</annotation></semantics></math> {determine cluster}

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span id="alg1.l7.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l7.m1.1" class="ltx_Math" alttext="c_{p}=c" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">c</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">p</mi></msub><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">=</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></eq><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑐</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑝</ci></apply><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">c_{p}=c</annotation></semantics></math> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>        <math id="alg1.l8.m1.1" class="ltx_Math" alttext="n_{s}\leftarrow n_{s}+1" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">n</mi><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><msub id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml"><mi id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml">n</mi><mi id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml">s</mi></msub><mo id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑛</ci><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑠</ci></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><plus id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></plus><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2">𝑛</ci><ci id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3">𝑠</ci></apply><cn type="integer" id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">n_{s}\leftarrow n_{s}+1</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  robustness <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\leftarrow\frac{n_{s}}{n}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"></mi><mo stretchy="false" id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mfrac id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><msub id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml"><mi id="alg1.l11.m1.1.1.3.2.2" xref="alg1.l11.m1.1.1.3.2.2.cmml">n</mi><mi id="alg1.l11.m1.1.1.3.2.3" xref="alg1.l11.m1.1.1.3.2.3.cmml">s</mi></msub><mi id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">n</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><csymbol cd="latexml" id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">absent</csymbol><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><divide id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3"></divide><apply id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.2.1.cmml" xref="alg1.l11.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.2.cmml" xref="alg1.l11.m1.1.1.3.2.2">𝑛</ci><ci id="alg1.l11.m1.1.1.3.2.3.cmml" xref="alg1.l11.m1.1.1.3.2.3">𝑠</ci></apply><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\leftarrow\frac{n_{s}}{n}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
<div id="Sx4.SSx4.p3" class="ltx_para">
<p id="Sx4.SSx4.p3.1" class="ltx_p">The robustness of the clusters obtained by the <span id="Sx4.SSx4.p3.1.1" class="ltx_ERROR undefined">\acronym</span>and WD is reported in <a href="#Sx4.T1" title="In Cluster Robustness ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>. <span id="Sx4.SSx4.p3.1.2" class="ltx_ERROR undefined">\acronym</span>manages to achieve overall robustness above 90%, irrespective of the non-IIDness type. WD, on the other hand, struggles with the concept drift type of non-IIDness, where its robustness remains barely above the robustness that would have been achieved by randomly assigning clients to one of the <math id="Sx4.SSx4.p3.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="Sx4.SSx4.p3.1.m1.1a"><mn id="Sx4.SSx4.p3.1.m1.1.1" xref="Sx4.SSx4.p3.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p3.1.m1.1b"><cn type="integer" id="Sx4.SSx4.p3.1.m1.1.1.cmml" xref="Sx4.SSx4.p3.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p3.1.m1.1c">10</annotation></semantics></math> available clusters. The table also shows that the supervised autoencoder (SAE) we embrace for <span id="Sx4.SSx4.p3.1.3" class="ltx_ERROR undefined">\acronym</span>outperforms alternative architectures.</p>
</div>
<figure id="Sx4.T1" class="ltx_table">
<p id="Sx4.T1.2" class="ltx_p ltx_align_center ltx_align_center"><span id="Sx4.T1.2.2" class="ltx_text">

<span id="Sx4.T1.2.2.2" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.2.2.2.3" class="ltx_tr">
<span id="Sx4.T1.2.2.2.3.1" class="ltx_td ltx_border_tt"></span>
<span id="Sx4.T1.2.2.2.3.2" class="ltx_td ltx_border_r ltx_border_tt"></span>
<span id="Sx4.T1.2.2.2.3.3" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2"><span id="Sx4.T1.2.2.2.3.3.1" class="ltx_text"></span> <span id="Sx4.T1.2.2.2.3.3.2" class="ltx_text">
<span id="Sx4.T1.2.2.2.3.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.2.2.2.3.3.2.1.1" class="ltx_tr">
<span id="Sx4.T1.2.2.2.3.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Concept drift,</span></span>
<span id="Sx4.T1.2.2.2.3.3.2.1.2" class="ltx_tr">
<span id="Sx4.T1.2.2.2.3.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">label skew</span></span>
</span></span><span id="Sx4.T1.2.2.2.3.3.3" class="ltx_text"></span></span>
<span id="Sx4.T1.2.2.2.3.4" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2"><span id="Sx4.T1.2.2.2.3.4.1" class="ltx_text"></span> <span id="Sx4.T1.2.2.2.3.4.2" class="ltx_text">
<span id="Sx4.T1.2.2.2.3.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.2.2.2.3.4.2.1.1" class="ltx_tr">
<span id="Sx4.T1.2.2.2.3.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Label skew</span></span>
</span></span><span id="Sx4.T1.2.2.2.3.4.3" class="ltx_text"></span></span>
<span id="Sx4.T1.2.2.2.3.5" class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2"><span id="Sx4.T1.2.2.2.3.5.1" class="ltx_text"></span> <span id="Sx4.T1.2.2.2.3.5.2" class="ltx_text">
<span id="Sx4.T1.2.2.2.3.5.2.1" class="ltx_tabular ltx_align_middle">
<span id="Sx4.T1.2.2.2.3.5.2.1.1" class="ltx_tr">
<span id="Sx4.T1.2.2.2.3.5.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Concept drift</span></span>
</span></span><span id="Sx4.T1.2.2.2.3.5.3" class="ltx_text"></span></span></span>
<span id="Sx4.T1.2.2.2.4" class="ltx_tr">
<span id="Sx4.T1.2.2.2.4.1" class="ltx_td"></span>
<span id="Sx4.T1.2.2.2.4.2" class="ltx_td ltx_border_r"></span>
<span id="Sx4.T1.2.2.2.4.3" class="ltx_td ltx_align_right">Mean</span>
<span id="Sx4.T1.2.2.2.4.4" class="ltx_td ltx_align_right ltx_border_r">SE</span>
<span id="Sx4.T1.2.2.2.4.5" class="ltx_td ltx_align_right">Mean</span>
<span id="Sx4.T1.2.2.2.4.6" class="ltx_td ltx_align_right ltx_border_r">SE</span>
<span id="Sx4.T1.2.2.2.4.7" class="ltx_td ltx_align_right">Mean</span>
<span id="Sx4.T1.2.2.2.4.8" class="ltx_td ltx_align_right">SE</span></span>
<span id="Sx4.T1.2.2.2.5" class="ltx_tr">
<span id="Sx4.T1.2.2.2.5.1" class="ltx_td ltx_align_left ltx_align_middle ltx_border_t ltx_rowspan ltx_rowspan_3"><span id="Sx4.T1.2.2.2.5.1.1" class="ltx_text"><span id="Sx4.T1.2.2.2.5.1.1.1" class="ltx_ERROR undefined">\acronym</span></span></span>
<span id="Sx4.T1.2.2.2.5.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">SAE</span>
<span id="Sx4.T1.2.2.2.5.3" class="ltx_td ltx_align_right ltx_border_t"><span id="Sx4.T1.2.2.2.5.3.1" class="ltx_text ltx_font_bold">0.91</span></span>
<span id="Sx4.T1.2.2.2.5.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.02</span>
<span id="Sx4.T1.2.2.2.5.5" class="ltx_td ltx_align_right ltx_border_t"><span id="Sx4.T1.2.2.2.5.5.1" class="ltx_text ltx_font_bold">0.90</span></span>
<span id="Sx4.T1.2.2.2.5.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.02</span>
<span id="Sx4.T1.2.2.2.5.7" class="ltx_td ltx_align_right ltx_border_t"><span id="Sx4.T1.2.2.2.5.7.1" class="ltx_text ltx_font_bold">0.92</span></span>
<span id="Sx4.T1.2.2.2.5.8" class="ltx_td ltx_align_right ltx_border_t">0.02</span></span>
<span id="Sx4.T1.2.2.2.6" class="ltx_tr">
<span id="Sx4.T1.2.2.2.6.1" class="ltx_td ltx_align_left ltx_border_r">CLF</span>
<span id="Sx4.T1.2.2.2.6.2" class="ltx_td ltx_align_right">0.87</span>
<span id="Sx4.T1.2.2.2.6.3" class="ltx_td ltx_align_right ltx_border_r">0.03</span>
<span id="Sx4.T1.2.2.2.6.4" class="ltx_td ltx_align_right"><span id="Sx4.T1.2.2.2.6.4.1" class="ltx_text ltx_font_bold">0.90</span></span>
<span id="Sx4.T1.2.2.2.6.5" class="ltx_td ltx_align_right ltx_border_r">0.02</span>
<span id="Sx4.T1.2.2.2.6.6" class="ltx_td ltx_align_right">0.89</span>
<span id="Sx4.T1.2.2.2.6.7" class="ltx_td ltx_align_right">0.03</span></span>
<span id="Sx4.T1.2.2.2.7" class="ltx_tr">
<span id="Sx4.T1.2.2.2.7.1" class="ltx_td ltx_align_left ltx_border_r">AE</span>
<span id="Sx4.T1.2.2.2.7.2" class="ltx_td ltx_align_right">0.89</span>
<span id="Sx4.T1.2.2.2.7.3" class="ltx_td ltx_align_right ltx_border_r">0.02</span>
<span id="Sx4.T1.2.2.2.7.4" class="ltx_td ltx_align_right">0.79</span>
<span id="Sx4.T1.2.2.2.7.5" class="ltx_td ltx_align_right ltx_border_r">0.03</span>
<span id="Sx4.T1.2.2.2.7.6" class="ltx_td ltx_align_right">0.89</span>
<span id="Sx4.T1.2.2.2.7.7" class="ltx_td ltx_align_right">0.03</span></span>
<span id="Sx4.T1.1.1.1.1" class="ltx_tr">
<span id="Sx4.T1.1.1.1.1.2" class="ltx_td ltx_align_left ltx_align_middle ltx_border_bb ltx_rowspan ltx_rowspan_2"><span id="Sx4.T1.1.1.1.1.2.1" class="ltx_text">WD</span></span>
<span id="Sx4.T1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><math id="Sx4.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="Sx4.T1.1.1.1.1.1.m1.1a"><mi id="Sx4.T1.1.1.1.1.1.m1.1.1" xref="Sx4.T1.1.1.1.1.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx4.T1.1.1.1.1.1.m1.1b"><ci id="Sx4.T1.1.1.1.1.1.m1.1.1.cmml" xref="Sx4.T1.1.1.1.1.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.1.1.1.1.1.m1.1c">f</annotation></semantics></math>=1</span>
<span id="Sx4.T1.1.1.1.1.3" class="ltx_td ltx_align_right ltx_border_t">0.75</span>
<span id="Sx4.T1.1.1.1.1.4" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.08</span>
<span id="Sx4.T1.1.1.1.1.5" class="ltx_td ltx_align_right ltx_border_t">0.68</span>
<span id="Sx4.T1.1.1.1.1.6" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">0.05</span>
<span id="Sx4.T1.1.1.1.1.7" class="ltx_td ltx_align_right ltx_border_t">0.25</span>
<span id="Sx4.T1.1.1.1.1.8" class="ltx_td ltx_align_right ltx_border_t">0.10</span></span>
<span id="Sx4.T1.2.2.2.2" class="ltx_tr">
<span id="Sx4.T1.2.2.2.2.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><math id="Sx4.T1.2.2.2.2.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="Sx4.T1.2.2.2.2.1.m1.1a"><mi id="Sx4.T1.2.2.2.2.1.m1.1.1" xref="Sx4.T1.2.2.2.2.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx4.T1.2.2.2.2.1.m1.1b"><ci id="Sx4.T1.2.2.2.2.1.m1.1.1.cmml" xref="Sx4.T1.2.2.2.2.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.2.2.2.2.1.m1.1c">f</annotation></semantics></math>=2</span>
<span id="Sx4.T1.2.2.2.2.2" class="ltx_td ltx_align_right ltx_border_bb">0.84</span>
<span id="Sx4.T1.2.2.2.2.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">0.03</span>
<span id="Sx4.T1.2.2.2.2.4" class="ltx_td ltx_align_right ltx_border_bb">0.77</span>
<span id="Sx4.T1.2.2.2.2.5" class="ltx_td ltx_align_right ltx_border_bb ltx_border_r">0.03</span>
<span id="Sx4.T1.2.2.2.2.6" class="ltx_td ltx_align_right ltx_border_bb">0.15</span>
<span id="Sx4.T1.2.2.2.2.7" class="ltx_td ltx_align_right ltx_border_bb">0.05</span></span>
</span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Robustness of clusters generated by <span id="Sx4.T1.7.1" class="ltx_ERROR undefined">\acronym</span>and WD under various non-IIDness types. SAE stands for supervised autoencoder, AE for standard autoencoder, and CLF for classifier-based embeddings in <span id="Sx4.T1.8.2" class="ltx_ERROR undefined">\acronym</span>, and <math id="Sx4.T1.4.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="Sx4.T1.4.m1.1b"><mi id="Sx4.T1.4.m1.1.1" xref="Sx4.T1.4.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx4.T1.4.m1.1c"><ci id="Sx4.T1.4.m1.1.1.cmml" xref="Sx4.T1.4.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.4.m1.1d">f</annotation></semantics></math> is the number of fine-tuning epochs performed on the clients in case of WD. The number of clusters is in all cases set to 10.</figcaption>
</figure>
</section>
<section id="Sx4.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Classification Accuracy</h3>

<div id="Sx4.SSx5.p1" class="ltx_para">
<p id="Sx4.SSx5.p1.1" class="ltx_p">We now assess the classification accuracy of the clustered FL models constructed by our <span id="Sx4.SSx5.p1.1.1" class="ltx_ERROR undefined">\acronym</span>approach as well as the alternative WD algorithm. As the baseline, we present the inference accuracy results achieved by the standard FedAvg approach. Throughout this section, we indicate with <span id="Sx4.SSx5.p1.1.2" class="ltx_text ltx_font_italic">VAL</span> the classification accuracy (CA) of the model on the validation set of the training clients and with <span id="Sx4.SSx5.p1.1.3" class="ltx_text ltx_font_italic">HO</span> the CA of the model on the validation set of the holdout clients. We conduct the evaluation on FEMNIST and MNIST with pathological non-IIDness, as these datasets naturally contain data distribution heterogeneity.</p>
</div>
<section id="Sx4.SSx5.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">FEMNIST dataset:</h4>

<div id="Sx4.SSx5.SSSx1.p1" class="ltx_para">
<p id="Sx4.SSx5.SSSx1.p1.1" class="ltx_p">In <a href="#Sx4.F3" title="In FEMNIST dataset: ‣ Classification Accuracy ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a> we see that <span id="Sx4.SSx5.SSSx1.p1.1.1" class="ltx_ERROR undefined">\acronym</span>and WD outperform the plain FedAvg approach on both VAL and HO, thus confirming the importance of client clustering when it comes to improving inference accuracy in FL over non-IID data. Note, however, that in reality the WD method cannot actually be used for computing the client embeddings of holdout clients, as it requires on-device training and a local labeled dataset, which is against our definition of the holdout client. We nevertheless report WD results here in order to assess a potential loss of inference accuracy in case a clustering approach such as <span id="Sx4.SSx5.SSSx1.p1.1.2" class="ltx_ERROR undefined">\acronym</span>is used on holdout clients that can actually perform the training. As evident from the figure, the loss is practically none.</p>
</div>
<figure id="Sx4.F3" class="ltx_figure"><img src="/html/2309.14088/assets/accuracy_femnist_aaai.png" id="Sx4.F3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="256" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Evolution of accuracy when training a model on the FEMNIST dataset with Federated Learning with respect to the algorithm used for computing the client embeddings. The number of clusters was set to <math id="Sx4.F3.2.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="Sx4.F3.2.m1.1b"><mn id="Sx4.F3.2.m1.1.1" xref="Sx4.F3.2.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="Sx4.F3.2.m1.1c"><cn type="integer" id="Sx4.F3.2.m1.1.1.cmml" xref="Sx4.F3.2.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.F3.2.m1.1d">10</annotation></semantics></math>.</figcaption>
</figure>
<div id="Sx4.SSx5.SSSx1.p2" class="ltx_para">
<p id="Sx4.SSx5.SSSx1.p2.2" class="ltx_p">As discussed in the related work, training loss regularization represents another means of improving FL performance in non-IID settings. Since the regularization remains orthogonal to the actual clustering scheme, we introduce the FedProx regularization term <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> during the individual client model training – the loss <math id="Sx4.SSx5.SSSx1.p2.1.m1.1" class="ltx_Math" alttext="l(\theta_{i})" display="inline"><semantics id="Sx4.SSx5.SSSx1.p2.1.m1.1a"><mrow id="Sx4.SSx5.SSSx1.p2.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.3" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.2.cmml">​</mo><mrow id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.2.cmml">θ</mi><mi id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.1.m1.1b"><apply id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1"><times id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.2"></times><ci id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.3">𝑙</ci><apply id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.2">𝜃</ci><ci id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.1.m1.1c">l(\theta_{i})</annotation></semantics></math> clients optimize over their datasets <math id="Sx4.SSx5.SSSx1.p2.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="Sx4.SSx5.SSSx1.p2.2.m2.1a"><msub id="Sx4.SSx5.SSSx1.p2.2.m2.1.1" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.2" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1.2.cmml">D</mi><mi id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.3" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.2.m2.1b"><apply id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1.2">𝐷</ci><ci id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.2.m2.1c">D_{i}</annotation></semantics></math> is updated to:</p>
<table id="Sx6.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx4.E8.m1.2" class="ltx_Math" alttext="\displaystyle l_{reg}(\theta_{i},\theta)=l(\theta_{i})+\frac{\mu}{2}\|\theta_{i}-\theta\|_{2}^{2}," display="inline"><semantics id="Sx4.E8.m1.2a"><mrow id="Sx4.E8.m1.2.2.1" xref="Sx4.E8.m1.2.2.1.1.cmml"><mrow id="Sx4.E8.m1.2.2.1.1" xref="Sx4.E8.m1.2.2.1.1.cmml"><mrow id="Sx4.E8.m1.2.2.1.1.1" xref="Sx4.E8.m1.2.2.1.1.1.cmml"><msub id="Sx4.E8.m1.2.2.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.1.3.cmml"><mi id="Sx4.E8.m1.2.2.1.1.1.3.2" xref="Sx4.E8.m1.2.2.1.1.1.3.2.cmml">l</mi><mrow id="Sx4.E8.m1.2.2.1.1.1.3.3" xref="Sx4.E8.m1.2.2.1.1.1.3.3.cmml"><mi id="Sx4.E8.m1.2.2.1.1.1.3.3.2" xref="Sx4.E8.m1.2.2.1.1.1.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.2.2.1.1.1.3.3.1" xref="Sx4.E8.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="Sx4.E8.m1.2.2.1.1.1.3.3.3" xref="Sx4.E8.m1.2.2.1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.2.2.1.1.1.3.3.1a" xref="Sx4.E8.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="Sx4.E8.m1.2.2.1.1.1.3.3.4" xref="Sx4.E8.m1.2.2.1.1.1.3.3.4.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.2.2.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx4.E8.m1.2.2.1.1.1.1.1" xref="Sx4.E8.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.E8.m1.2.2.1.1.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="Sx4.E8.m1.2.2.1.1.1.1.1.1" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="Sx4.E8.m1.2.2.1.1.1.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1.2.cmml">θ</mi><mi id="Sx4.E8.m1.2.2.1.1.1.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx4.E8.m1.2.2.1.1.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="Sx4.E8.m1.1.1" xref="Sx4.E8.m1.1.1.cmml">θ</mi><mo stretchy="false" id="Sx4.E8.m1.2.2.1.1.1.1.1.4" xref="Sx4.E8.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx4.E8.m1.2.2.1.1.4" xref="Sx4.E8.m1.2.2.1.1.4.cmml">=</mo><mrow id="Sx4.E8.m1.2.2.1.1.3" xref="Sx4.E8.m1.2.2.1.1.3.cmml"><mrow id="Sx4.E8.m1.2.2.1.1.2.1" xref="Sx4.E8.m1.2.2.1.1.2.1.cmml"><mi id="Sx4.E8.m1.2.2.1.1.2.1.3" xref="Sx4.E8.m1.2.2.1.1.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.2.2.1.1.2.1.2" xref="Sx4.E8.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="Sx4.E8.m1.2.2.1.1.2.1.1.1" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="Sx4.E8.m1.2.2.1.1.2.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><msub id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.cmml"><mi id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml">θ</mi><mi id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx4.E8.m1.2.2.1.1.2.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx4.E8.m1.2.2.1.1.3.3" xref="Sx4.E8.m1.2.2.1.1.3.3.cmml">+</mo><mrow id="Sx4.E8.m1.2.2.1.1.3.2" xref="Sx4.E8.m1.2.2.1.1.3.2.cmml"><mstyle displaystyle="true" id="Sx4.E8.m1.2.2.1.1.3.2.3" xref="Sx4.E8.m1.2.2.1.1.3.2.3.cmml"><mfrac id="Sx4.E8.m1.2.2.1.1.3.2.3a" xref="Sx4.E8.m1.2.2.1.1.3.2.3.cmml"><mi id="Sx4.E8.m1.2.2.1.1.3.2.3.2" xref="Sx4.E8.m1.2.2.1.1.3.2.3.2.cmml">μ</mi><mn id="Sx4.E8.m1.2.2.1.1.3.2.3.3" xref="Sx4.E8.m1.2.2.1.1.3.2.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx4.E8.m1.2.2.1.1.3.2.2" xref="Sx4.E8.m1.2.2.1.1.3.2.2.cmml">​</mo><msubsup id="Sx4.E8.m1.2.2.1.1.3.2.1" xref="Sx4.E8.m1.2.2.1.1.3.2.1.cmml"><mrow id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.2.1.cmml">‖</mo><mrow id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.cmml"><msub id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.cmml"><mi id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.2" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.2.cmml">θ</mi><mi id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.3" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.1" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.1.cmml">−</mo><mi id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.3.cmml">θ</mi></mrow><mo stretchy="false" id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.3" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx4.E8.m1.2.2.1.1.3.2.1.1.3" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.3.cmml">2</mn><mn id="Sx4.E8.m1.2.2.1.1.3.2.1.3" xref="Sx4.E8.m1.2.2.1.1.3.2.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="Sx4.E8.m1.2.2.1.2" xref="Sx4.E8.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E8.m1.2b"><apply id="Sx4.E8.m1.2.2.1.1.cmml" xref="Sx4.E8.m1.2.2.1"><eq id="Sx4.E8.m1.2.2.1.1.4.cmml" xref="Sx4.E8.m1.2.2.1.1.4"></eq><apply id="Sx4.E8.m1.2.2.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.1"><times id="Sx4.E8.m1.2.2.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.1.2"></times><apply id="Sx4.E8.m1.2.2.1.1.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.1.1.1.3.1.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3">subscript</csymbol><ci id="Sx4.E8.m1.2.2.1.1.1.3.2.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3.2">𝑙</ci><apply id="Sx4.E8.m1.2.2.1.1.1.3.3.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3.3"><times id="Sx4.E8.m1.2.2.1.1.1.3.3.1.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3.3.1"></times><ci id="Sx4.E8.m1.2.2.1.1.1.3.3.2.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3.3.2">𝑟</ci><ci id="Sx4.E8.m1.2.2.1.1.1.3.3.3.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3.3.3">𝑒</ci><ci id="Sx4.E8.m1.2.2.1.1.1.3.3.4.cmml" xref="Sx4.E8.m1.2.2.1.1.1.3.3.4">𝑔</ci></apply></apply><interval closure="open" id="Sx4.E8.m1.2.2.1.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.1.1.1"><apply id="Sx4.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1.2">𝜃</ci><ci id="Sx4.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="Sx4.E8.m1.1.1.cmml" xref="Sx4.E8.m1.1.1">𝜃</ci></interval></apply><apply id="Sx4.E8.m1.2.2.1.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3"><plus id="Sx4.E8.m1.2.2.1.1.3.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.3"></plus><apply id="Sx4.E8.m1.2.2.1.1.2.1.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1"><times id="Sx4.E8.m1.2.2.1.1.2.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1.2"></times><ci id="Sx4.E8.m1.2.2.1.1.2.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1.3">𝑙</ci><apply id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.2">𝜃</ci><ci id="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="Sx4.E8.m1.2.2.1.1.3.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2"><times id="Sx4.E8.m1.2.2.1.1.3.2.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.2"></times><apply id="Sx4.E8.m1.2.2.1.1.3.2.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.3"><divide id="Sx4.E8.m1.2.2.1.1.3.2.3.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.3"></divide><ci id="Sx4.E8.m1.2.2.1.1.3.2.3.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.3.2">𝜇</ci><cn type="integer" id="Sx4.E8.m1.2.2.1.1.3.2.3.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.3.3">2</cn></apply><apply id="Sx4.E8.m1.2.2.1.1.3.2.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.1.1.3.2.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1">superscript</csymbol><apply id="Sx4.E8.m1.2.2.1.1.3.2.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.1.1.3.2.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1">subscript</csymbol><apply id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1"><csymbol cd="latexml" id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.2.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.2">norm</csymbol><apply id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1"><minus id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.1"></minus><apply id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.1.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2">subscript</csymbol><ci id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.2.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.2">𝜃</ci><ci id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.1.1.1.3">𝜃</ci></apply></apply><cn type="integer" id="Sx4.E8.m1.2.2.1.1.3.2.1.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.1.3">2</cn></apply><cn type="integer" id="Sx4.E8.m1.2.2.1.1.3.2.1.3.cmml" xref="Sx4.E8.m1.2.2.1.1.3.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E8.m1.2c">\displaystyle l_{reg}(\theta_{i},\theta)=l(\theta_{i})+\frac{\mu}{2}\|\theta_{i}-\theta\|_{2}^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Sx4.SSx5.SSSx1.p2.4" class="ltx_p">where <math id="Sx4.SSx5.SSSx1.p2.3.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="Sx4.SSx5.SSSx1.p2.3.m1.1a"><mi id="Sx4.SSx5.SSSx1.p2.3.m1.1.1" xref="Sx4.SSx5.SSSx1.p2.3.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.3.m1.1b"><ci id="Sx4.SSx5.SSSx1.p2.3.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.3.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.3.m1.1c">\theta</annotation></semantics></math> is the model sent by the server and <math id="Sx4.SSx5.SSSx1.p2.4.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="Sx4.SSx5.SSSx1.p2.4.m2.1a"><mi id="Sx4.SSx5.SSSx1.p2.4.m2.1.1" xref="Sx4.SSx5.SSSx1.p2.4.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.4.m2.1b"><ci id="Sx4.SSx5.SSSx1.p2.4.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.4.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.4.m2.1c">\mu</annotation></semantics></math> the regularization strength. In <a href="#Sx4.F3" title="In FEMNIST dataset: ‣ Classification Accuracy ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a> we see that such a regularization scheme significantly improves the inference accuracy, and hence in the remaining experiments we use FedProx regularization for all methods, unless stated otherwise.</p>
</div>
<div id="Sx4.SSx5.SSSx1.p3" class="ltx_para">
<p id="Sx4.SSx5.SSSx1.p3.2" class="ltx_p">Finally, in <a href="#Sx4.F4" title="In FEMNIST dataset: ‣ Classification Accuracy ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a> we examine the importance of setting an appropriate number of clusters. In particular, we see that the WD algorithm achieves its highest accuracy when clustering the clients into <math id="Sx4.SSx5.SSSx1.p3.1.m1.1" class="ltx_Math" alttext="2" display="inline"><semantics id="Sx4.SSx5.SSSx1.p3.1.m1.1a"><mn id="Sx4.SSx5.SSSx1.p3.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p3.1.m1.1b"><cn type="integer" id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p3.1.m1.1c">2</annotation></semantics></math> clusters, while <span id="Sx4.SSx5.SSSx1.p3.2.1" class="ltx_ERROR undefined">\acronym</span>benefits from a higher number of clusters, such as <math id="Sx4.SSx5.SSSx1.p3.2.m2.1" class="ltx_Math" alttext="20" display="inline"><semantics id="Sx4.SSx5.SSSx1.p3.2.m2.1a"><mn id="Sx4.SSx5.SSSx1.p3.2.m2.1.1" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p3.2.m2.1b"><cn type="integer" id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p3.2.m2.1c">20</annotation></semantics></math>. This behavior can be in part explained by the results we reported for the robustness, as <span id="Sx4.SSx5.SSSx1.p3.2.2" class="ltx_ERROR undefined">\acronym</span>achieves significantly higher robustness than the WD algorithm. Note that, however, when clustering the clients there is a trade-off, as using a higher number of clusters results in increasingly uniform clusters, yet leads to fewer training clients within a cluster.</p>
</div>
<figure id="Sx4.F4" class="ltx_figure"><img src="/html/2309.14088/assets/femnist_n_clusters_aaai.png" id="Sx4.F4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="265" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Evolution of accuracy on holdout clients when training a model on the FEMNIST dataset with respect to the number of clusters.</figcaption>
</figure>
</section>
<section id="Sx4.SSx5.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">MNIST with pathological non-IIDness:</h4>

<div id="Sx4.SSx5.SSSx2.p1" class="ltx_para">
<p id="Sx4.SSx5.SSSx2.p1.3" class="ltx_p">Recall that in <a href="#Sx4.F2" title="In Cluster Uniformity ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> we confirmed that both <span id="Sx4.SSx5.SSSx2.p1.3.1" class="ltx_ERROR undefined">\acronym</span>and WD manage to construct uniform clusters of clients. However, the increased uniformity alone does not guarantee higher inference accuracy, especially in highly non-IID settings. To demonstrate this, in <a href="#Sx4.F5" title="In MNIST with pathological non-IIDness: ‣ Classification Accuracy ‣ Experimental Analysis ‣ \acronym: Client Clustering without Training and Data Labels for Improved Federated Learning in Non-IID Settings" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a> we plot the evolution of accuracy when <math id="Sx4.SSx5.SSSx2.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="Sx4.SSx5.SSSx2.p1.1.m1.1a"><mn id="Sx4.SSx5.SSSx2.p1.1.m1.1.1" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.1.m1.1b"><cn type="integer" id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.1.m1.1c">100</annotation></semantics></math> clients (we assume no holdout clients) are partitioned into <math id="Sx4.SSx5.SSSx2.p1.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="Sx4.SSx5.SSSx2.p1.2.m2.1a"><mn id="Sx4.SSx5.SSSx2.p1.2.m2.1.1" xref="Sx4.SSx5.SSSx2.p1.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.2.m2.1b"><cn type="integer" id="Sx4.SSx5.SSSx2.p1.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.2.m2.1c">10</annotation></semantics></math> and <math id="Sx4.SSx5.SSSx2.p1.3.m3.1" class="ltx_Math" alttext="30" display="inline"><semantics id="Sx4.SSx5.SSSx2.p1.3.m3.1a"><mn id="Sx4.SSx5.SSSx2.p1.3.m3.1.1" xref="Sx4.SSx5.SSSx2.p1.3.m3.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.3.m3.1b"><cn type="integer" id="Sx4.SSx5.SSSx2.p1.3.m3.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m3.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.3.m3.1c">30</annotation></semantics></math> clusters using the two algorithms under observation. We see that, irrespective of the clustering algorithm used, the accuracy of clustered FL often does not improve over the accuracy of vanilla FL with FedAvg. This is due to two main reasons. First, because of the peculiarities of the pathological non-IID setting, the average accuracy suffers if not all clients participate in every server training epoch. If only a fraction of clients participate (e.g. fraction fit set to 0.4 in the graph), in clusters with more than two classes it is highly probable that in a given training epoch the cluster model does not get exposed to all the potential target labels. Simultaneously, as we measure the accuracy of the cluster model on all the clients in the cluster, the model is evaluated on clients containing data belonging to classes that might not have been present in the training set of the previous epoch. Therefore, in a certain sense, the model “overfits” the training dataset, and hence the quality of the predictions on the clients, which possess labels unseen in the previous training epoch, decreases. Second, compared to vanilla FL, in highly non-IID settings the negative effects of the decreased amount of data when building clustered models outweigh the benefits of increased homogeneity of clients used for model training, if the number of clusters is not sufficiently high (in this case 30).</p>
</div>
<figure id="Sx4.F5" class="ltx_figure"><img src="/html/2309.14088/assets/mnist_pathological_fraction_fit_aaai.png" id="Sx4.F5.g1" class="ltx_graphics ltx_img_landscape" width="598" height="197" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Evolution of accuracy on the validation set of the training clients when training a model on the MNIST dataset with pathological non-IIDness. Models were trained with regularization. <span id="Sx4.F5.3.1" class="ltx_text ltx_font_italic">FF</span> stands for fraction fit, i.e. the percentage of clients that participate in every server training epoch. For <span id="Sx4.F5.4.2" class="ltx_ERROR undefined">\acronym</span>, the model used to map the images to the embedding space is a classifier, and the mean and the standard deviation are computed over the embedding space.</figcaption>
</figure>
</section>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Discussion and Future Work</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">While the issue of poor model convergence and reduced inference accuracy due to non-IIDness has received substantial attention in the FL research community, the problem of assigning the most appropriate flavor of the joint model to clients without sufficiently large local datasets or to clients who merely want to use the join model has received, to the best of our knowledge, virtually no attention from the community. This is surprising, having in mind that in practice the majority of clients using FL-trained models do not participate in model training <cite class="ltx_cite ltx_citemacro_citep">(Bonawitz et al. <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>. <span id="Sx5.p1.1.1" class="ltx_ERROR undefined">\acronym</span>tackles this uncomfortable issue and includes a novel approach to client clustering that focuses on profiling the underlying data-generating processes. The existing clustering methods almost exclusively rely on clustering local models and their properties, which, we believe, is not sustainable in the long run, as it restricts model personalization to clients that participate in the training. As the popularity of FL grows, the number of clients who merely wish to use the models is likely to grow as well.</p>
</div>
<div id="Sx5.p2" class="ltx_para">
<p id="Sx5.p2.1" class="ltx_p">In this paper, we focused on devising and demonstrating <span id="Sx5.p2.1.1" class="ltx_ERROR undefined">\acronym</span>. For practical applications, however, the clustering method would need to be optimized to the operating conditions. One of the main aspects of such optimization is the number of clusters in which the clients should be split. When determining this number we should aim to balance the homogeneity of individual clusters and the population of each cluster, as both the heterogeneity of the data within a cluster and the insufficient number of clients within a cluster may lead to poor model convergence. In future work, we plan on exploring various heuristics for determining the number of clusters within <span id="Sx5.p2.1.2" class="ltx_ERROR undefined">\acronym</span>.</p>
</div>
<div id="Sx5.p3" class="ltx_para">
<p id="Sx5.p3.1" class="ltx_p">Finally, while alleviating the need for labeled data, <span id="Sx5.p3.1.1" class="ltx_ERROR undefined">\acronym</span>still requires that FL clients collect a certain amount of unlabeled data for DGP profiling. In certain practical situations, even unlabeled data collection might not be possible, or the previously collected data might not accurately reflect the current DGP. This is especially true in mobile computing where a client might move to a different context (say, from a noisy outdoor area to a quiet indoor area), which might severely impact the underlying DGP. Nevertheless, contemporary mobile devices, such as smartphones, often host a range of embedded sensors that can be used to recognize context change. In forthcoming research, we intend to tap into this latent contextual data to infer information about the DGPs. This information, we believe, might enable client clustering even prior to data collection and, thus, further lower the entry bar for using personalized FL models.</p>
</div>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p">In this paper we proposed <span id="Sx6.p1.1.1" class="ltx_ERROR undefined">\acronym</span>, a client clustering scheme for federated learning that does not require labeled data, nor on-device training, yet enables clients to obtain model flavors tailored to the data distributions these clients observe. Extensive experimentation across different datasets demonstrates that <span id="Sx6.p1.1.2" class="ltx_ERROR undefined">\acronym</span>brings inference accuracy comparable to that of the state-of-the-art FL model personalization efforts over a much wider range of clients, including those who did not participate in model training at all. Consequently, we believe that <span id="Sx6.p1.1.3" class="ltx_ERROR undefined">\acronym</span>can facilitate a wider proliferation of federated learning, and can also serve as a basis for future efforts towards dynamic, context-aware FL adaptation.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al. (2019)</span>
<span class="ltx_bibblock">
Bonawitz, K.; Eichner, H.; Grieskamp, W.; Huba, D.; Ingerman, A.; Ivanov, V.; Kiddon, C.; Konečnỳ, J.; Mazzocchi, S.; McMahan, B.; et al. 2019.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">SysML (MLSys)</em>. Palo Alto, CA, USA.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briggs, Fan, and Andras (2020)</span>
<span class="ltx_bibblock">
Briggs, C.; Fan, Z.; and Andras, P. 2020.

</span>
<span class="ltx_bibblock">Federated learning with hierarchical clustering of local updates to improve training on non-IID data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Joint Conference on Neural Networks (IJCNN)</em>. Glasgow, UK.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al. (2018)</span>
<span class="ltx_bibblock">
Caldas, S.; Duddu, S. M. K.; Wu, P.; Li, T.; Konečnỳ, J.; McMahan, H. B.; Smith, V.; and Talwalkar, A. 2018.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng (2012)</span>
<span class="ltx_bibblock">
Deng, L. 2012.

</span>
<span class="ltx_bibblock">The mnist database of handwritten digit images for machine learning research.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE signal processing magazine</em>, 29(6): 141–142.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duan et al. (2021)</span>
<span class="ltx_bibblock">
Duan, M.; Liu, D.; Ji, X.; Liu, R.; Liang, L.; Chen, X.; and Tan, Y. 2021.

</span>
<span class="ltx_bibblock">Fedgroup: Efficient federated learning via decomposed similarity-based clustering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">2021 IEEE Intl Conf on Parallel &amp; Distributed Processing with Applications, Big Data &amp; Cloud Computing, Sustainable Computing &amp; Communications, Social Computing &amp; Networking (ISPA/BDCloud/SocialCom/SustainCom)</em>. New York City, NY, USA.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ester et al. (1996)</span>
<span class="ltx_bibblock">
Ester, M.; Kriegel, H.-P.; Sander, J.; Xu, X.; et al. 1996.

</span>
<span class="ltx_bibblock">A density-based algorithm for discovering clusters in large spatial databases with noise.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">KDD</em>. Portland, OR, USA.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al. (2020)</span>
<span class="ltx_bibblock">
Ghosh, A.; Chung, J.; Yin, D.; and Ramchandran, K. 2020.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>. Virtual.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2019)</span>
<span class="ltx_bibblock">
Huang, L.; Shea, A. L.; Qian, H.; Masurkar, A.; Deng, H.; and Liu, D. 2019.

</span>
<span class="ltx_bibblock">Patient clustering improves efficiency of federated machine learning to predict mortality and hospital stay time using distributed electronic medical records.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Journal of biomedical informatics</em>, 99: 103291.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P.; McMahan, H. B.; Avent, B.; Bellet, A.; Bennis, M.; Bhagoji, A. N.; Bonawitz, K.; Charles, Z.; Cormode, G.; Cummings, R.; et al. 2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, 14(1–2): 1–210.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky and Hinton (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A.; and Hinton, G. 2009.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">Technical Report 0, University of Toronto.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le, Patterson, and White (2018)</span>
<span class="ltx_bibblock">
Le, L.; Patterson, A.; and White, M. 2018.

</span>
<span class="ltx_bibblock">Supervised autoencoders: Improving generalization performance with unsupervised regularizers.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>. Montreal, Canada.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V. 2020.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">MLSys</em>. Austin, TX, USA.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lloyd (1982)</span>
<span class="ltx_bibblock">
Lloyd, S. 1982.

</span>
<span class="ltx_bibblock">Least squares quantization in PCM.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on information theory</em>, 28(2): 129–137.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al. (2023)</span>
<span class="ltx_bibblock">
Long, G.; Xie, M.; Shen, T.; Zhou, T.; Wang, X.; and Jiang, J. 2023.

</span>
<span class="ltx_bibblock">Multi-center federated learning: clients clustering for better personalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">World Wide Web</em>, 26(1): 481–500.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics (AISTATS)</em>. Lauderdale, FL, USA.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu et al. (2023)</span>
<span class="ltx_bibblock">
Mu, X.; Shen, Y.; Cheng, K.; Geng, X.; Fu, J.; Zhang, T.; and Zhang, Z. 2023.

</span>
<span class="ltx_bibblock">Fedproc: Prototypical contrastive federated learning on non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, 143: 93–104.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruan and Joe-Wong (2022)</span>
<span class="ltx_bibblock">
Ruan, Y.; and Joe-Wong, C. 2022.

</span>
<span class="ltx_bibblock">Fedsoft: Soft clustered federated learning with proximal local updating.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">AAAI</em>. Virtual.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler, Müller, and Samek (2020)</span>
<span class="ltx_bibblock">
Sattler, F.; Müller, K.-R.; and Samek, W. 2020.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multitask optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 32(8): 3710–3722.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y.; Li, M.; Lai, L.; Suda, N.; Civin, D.; and Chandra, V. 2018.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.14087" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.14088" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.14088">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.14088" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.14089" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 04:33:53 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
