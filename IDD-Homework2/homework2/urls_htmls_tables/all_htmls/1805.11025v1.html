<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1805.11025] Think Visually: Question Answering through Virtual Imagery</title><meta property="og:description" content="In this paper, we study the problem of geometric reasoning in the context of question-answering. We introduce Dynamic Spatial Memory Network (DSMN), a new deep network architecture designed for answering questions that…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Think Visually: Question Answering through Virtual Imagery">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Think Visually: Question Answering through Virtual Imagery">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1805.11025">

<!--Generated on Sat Mar  2 00:13:15 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Think Visually: Question Answering through Virtual Imagery</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ankit Goyal   Jian Wang   Jia Deng 
<br class="ltx_break">Computer Science and Engineering 
<br class="ltx_break">University of Michigan, Ann Arbor 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">{ankgoyal, jianwolf, jiadeng}@umich.edu</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">In this paper, we study the problem of geometric reasoning in the context of question-answering. We introduce Dynamic Spatial Memory Network (DSMN), a new deep network architecture designed for answering questions that admit latent visual representations. DSMN learns to generate and reason over such representations. Further, we propose two synthetic benchmarks, FloorPlanQA and ShapeIntersection, to evaluate the geometric reasoning capability of QA systems. Experimental results validate the effectiveness of our proposed DSMN for visual thinking tasks<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span> Code and datasets: <a target="_blank" href="https://github.com/umich-vl/think_visually" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/umich-vl/think_visually</a></span></span></span>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The ability to reason is a hallmark of intelligence and a requirement for building question-answering (QA) systems. In AI research, reasoning has been strongly associated with logic and symbol manipulation, as epitomized by work in automated theorem proving <cite class="ltx_cite ltx_citemacro_citep">(Fitting, <a href="#bib.bib3" title="" class="ltx_ref">2012</a>)</cite>. But for humans, reasoning involves not only symbols and logic, but also images and shapes. Einstein famously wrote: “The psychical entities which seem to serve as elements in thought are certain signs and more or less clear images which can be ‘voluntarily’ reproduced and combined… Conventional words or other signs have to be sought for laboriously only in a secondary state…” And the history of science abounds with discoveries from visual thinking, from the Benzene ring to the structure of DNA <cite class="ltx_cite ltx_citemacro_citep">(Pinker, <a href="#bib.bib22" title="" class="ltx_ref">2003</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">There are also plenty of ordinary examples of human visual thinking. Consider a square room with a door in the middle of its southern wall. Suppose you are standing in the room such that the eastern wall of the room is behind you. Where is the door with respect to you? The answer is ‘to your left.’ Note that in this case both the question and answer are just text. But in order to answer the question, it is natural to construct a mental picture of the room and use it in the process of reasoning. Similar to humans, the ability to ‘think visually’ is desirable for AI agents like household robots. An example could be to construct a rough map and navigation plan for an unknown environment from verbal descriptions and instructions.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we investigate how to model geometric reasoning (a form of visual reasoning) using deep neural networks (DNN). Specifically, we address the task of answering questions through geometric reasoning—both the question and answer are expressed in symbols or words, but a geometric representation is created and used as part of the reasoning process.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In order to focus on geometric reasoning, we do away with natural language by designing two synthetic QA datasets, FloorPlanQA and ShapeIntersection. In FloorPlanQA, we provide the blueprint of a house in words and ask questions about location and orientation of objects in it. For ShapeIntersection, we give a symbolic representation of various shapes and ask how many places they intersect. In both datasets, a reference visual representation is provided for each sample.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Further, we propose Dynamic Spatial Memory Network (DSMN), a novel DNN that uses virtual imagery for QA. DSMN is similar to existing memory networks <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>; Henaff et al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> in that it uses vector embeddings of questions and memory modules to perform reasoning. The main novelty of DSMN is that it creates virtual images for the input question and uses a spatial memory to aid the reasoning process.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We show through experiments that with the aid of an internal visual representation and a spatial memory, DSMN outperforms strong baselines on both FloorPlanQA and ShapeIntersection. We also demonstrate that explicitly learning to create visual representations further improves performance. Finally, we show that DSMN is substantially better than the baselines even when visual supervision is provided for only a small proportion of the samples.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">It’s important to note that our proposed datasets consist of synthetic questions as opposed to natural texts. Such a setup allows us to sidestep difficulties in parsing natural language and instead focus on geometric reasoning. However, synthetic data lacks the complexity and diversity of natural text. For example, spatial terms used in natural language have various ambiguities that need to resolved by context (e.g. how far is ”far” and whether ”to the left” is relative to the speaker or the listener) <cite class="ltx_cite ltx_citemacro_citep">(Shariff, <a href="#bib.bib26" title="" class="ltx_ref">1998</a>; Landau and Jackendoff, <a href="#bib.bib15" title="" class="ltx_ref">1993</a>)</cite>, but our synthetic data lacks such complexities. Therefore, our method and results do not automatically generalize to real-life tasks involving natural language. Additional research is needed to extend and validate our approach on natural data.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Our contributions are three-fold: First, we present Dynamic Spatial Memory Network (DSMN), a novel DNN that performs geometric reasoning for QA. Second, we introduce two synthetic datasets that evaluate a system’s visual thinking ability. Third, we demonstrate that on synthetic data, DSMN achieves superior performance for answering questions that require visual thinking.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Natural language datasets for QA:</span>
Several natural language QA datasets have been proposed to test AI systems on various reasoning abilities <cite class="ltx_cite ltx_citemacro_citep">(Levesque et al., <a href="#bib.bib17" title="" class="ltx_ref">2011</a>; Richardson et al., <a href="#bib.bib24" title="" class="ltx_ref">2013</a>)</cite>. Our work differs from them in two key aspects: first, we use synthetic data instead of natural data; and second, we specialize in geometrical reasoning instead of general language understanding. Using synthetic data helps us simplify language parsing and thereby focus on geometric reasoning. However, additional research is necessary to generalize our work to natural data.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Synthetic datasets for QA:</span>
Recently, synthetic datasets for QA are also becoming crucial in AI. In particular, bAbI <cite class="ltx_cite ltx_citemacro_citep">(Weston et al., <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite> has driven the development of several recent DNN-based QA systems <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>; Henaff et al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>. bAbI consists of 20 tasks to evaluate different reasoning abilities. Two tasks, Positional Reasoning (PR) and Path Finding (PF), are related to geometric reasoning. However, each Positional Reasoning question contains only two sentences, and can be solved through simple logical deduction such as ‘A is left of B implies B is right of A’. Similarly, Path Finding involves a search problem that requires simple spatial deductions such as ‘A is east of B implies B is west of A’. In contrast, the questions in our datasets involve longer descriptions, more entities, and more relations; they are thus harder to answer with simple deductions. We also provide reference visual representation for each sample, which is not available in bAbI.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Mental Imagery and Visual Reasoning:</span>
The importance of visual reasoning has been long recognized in AI <cite class="ltx_cite ltx_citemacro_citep">(Forbus et al., <a href="#bib.bib4" title="" class="ltx_ref">1991</a>; Lathrop and Laird, <a href="#bib.bib16" title="" class="ltx_ref">2007</a>)</cite>. Prior works in NLP <cite class="ltx_cite ltx_citemacro_citep">(Seo et al., <a href="#bib.bib25" title="" class="ltx_ref">2015</a>; Lin and Parikh, <a href="#bib.bib18" title="" class="ltx_ref">2015</a>)</cite> have also studied visual reasoning. Our work is different from them as we use synthetic language instead of natural language. Our synthetic language is easier to parse, allowing our evaluation to mainly reflect the performance of geometric reasoning. On the other hand, while our method and conclusions can potentially apply to natural text, this remains to be validated and involves nontrivial future work. There are other differences to prior works as well. Specifically, <cite class="ltx_cite ltx_citemacro_citep">(Seo et al., <a href="#bib.bib25" title="" class="ltx_ref">2015</a>)</cite> combined information from textual questions and diagrams to build a model for solving SAT geometry questions. However, our task is different as diagrams are not provided as part of the input, but are generated from the words/symbols themselves. Also, <cite class="ltx_cite ltx_citemacro_citep">(Lin and Parikh, <a href="#bib.bib18" title="" class="ltx_ref">2015</a>)</cite> take advantage of synthetic images to gather semantic common sense knowledge (visual common sense) and use it to perform fill-in-the-blank (FITB) and visual paraphrasing tasks. Similar to us, they also form ‘mental images’. However, there are two differences (apart from natural vs synthetic language): first, their benchmark tests higher level semantic knowledge (like “Mike is having lunch when he sees a bear.” <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="\implies" display="inline"><semantics id="S2.p3.1.m1.1a"><mo stretchy="false" id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">⟹</mo><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><implies id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"></implies></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\implies</annotation></semantics></math> “Mike tries to hide.”), while ours is more focused on geometric reasoning. Second, their model is based on hand-crafted features while we use a DNN.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Spatial language for Human-Robot Interaction:</span>
Our work is also related to prior work on making robots understand spatial commands (e.g. “put that box here”, “move closer to the box”) and complete tasks such as navigation and assembly. Earlier work <cite class="ltx_cite ltx_citemacro_citep">(Müller et al., <a href="#bib.bib20" title="" class="ltx_ref">2000</a>; Gribble et al., <a href="#bib.bib8" title="" class="ltx_ref">1998</a>; Zelek, <a href="#bib.bib32" title="" class="ltx_ref">1997</a>)</cite> in this domain used template-based commands, whereas more recent work <cite class="ltx_cite ltx_citemacro_citep">(Skubic et al., <a href="#bib.bib27" title="" class="ltx_ref">2004</a>)</cite> tried to make the commands more natural. This line of work differs from ours in that the robot has visual perception of its environment that allows grounding of the textual commands, whereas in our case the agent has no visual perception, and an environment needs to be imagined.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p"><span id="S2.p5.1.1" class="ltx_text ltx_font_bold">Image Generation:</span>
Our work is related to image generation using DNNs which has a large body of literature, with diverse approaches <cite class="ltx_cite ltx_citemacro_citep">(Reed et al., <a href="#bib.bib23" title="" class="ltx_ref">2016</a>; Gregor et al., <a href="#bib.bib7" title="" class="ltx_ref">2015</a>)</cite>. We also generate an image from the input. But in our task, image generation is in the service of reasoning rather than an end goal in itself—as a result, photorealism or artistic style of generated images is irrelevant and not considered.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p"><span id="S2.p6.1.1" class="ltx_text ltx_font_bold">Visual Question Answering:</span>
Our work is also related to visual QA (VQA) <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>; Antol et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>; Lu et al., <a href="#bib.bib19" title="" class="ltx_ref">2016</a>)</cite>. Our task is different from VQA because our questions are in terms of words/symbols whereas in VQA the questions are visual, consisting of both text descriptions and images. The images involved in our task are internal and virtual, and are not part of the input or output.</p>
</div>
<div id="S2.p7" class="ltx_para ltx_noindent">
<p id="S2.p7.1" class="ltx_p"><span id="S2.p7.1.1" class="ltx_text ltx_font_bold">Memory and Attention:</span>
Memory and attention have been increasingly incorporated into DNNs, especially for tasks involving algorithmic inference and/or natural language <cite class="ltx_cite ltx_citemacro_citep">(Graves et al., <a href="#bib.bib5" title="" class="ltx_ref">2014</a>; Vaswani et al., <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>. For QA tasks, memory and attention play an important role in state-of-the-art (SOTA) approaches. <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> introduced End-To-End Memory Network (MemN2N), a DNN with memory and recurrent attention mechanism, which can be trained end-to-end for diverse tasks like textual QA and language modeling. Concurrently, <cite class="ltx_cite ltx_citemacro_cite">Kumar et al. (<a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite> introduced Dynamic Memory Network (DMN), which also uses attention and memory. <cite class="ltx_cite ltx_citemacro_cite">Xiong et al. (<a href="#bib.bib31" title="" class="ltx_ref">2016</a>)</cite> proposed DMN+, with several improvements over the previous version of DMN and achieved SOTA results on VQA <cite class="ltx_cite ltx_citemacro_citep">(Antol et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>)</cite> and bAbI <cite class="ltx_cite ltx_citemacro_citep">(Weston et al., <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>. Our proposed DSMN is a strict generalization of DMN+ (see Sec. <a href="#S4.SS1" title="4.1 DSMN as a strict generalization of DMN ‣ 4 Dynamic Spatial Memory Network ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>). On removing the images and spatial memory from DSMN, it reduces to DMN+. Recently <cite class="ltx_cite ltx_citemacro_cite">Gupta et al. (<a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> also used spatial memory in their deep learning system, but for visual navigation. We are using spatial memory for QA.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/1805.11025/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="80" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example in the ShapeIntersection dataset.</figcaption>
</figure>
<figure id="S2.T1" class="ltx_table">
<table id="S2.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.1.1.1" class="ltx_tr">
<th id="S2.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr">Component</th>
<th id="S2.T1.1.1.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column">
<span id="S2.T1.1.1.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.1.1.2.1.1" class="ltx_p" style="width:389.8pt;">Template</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.1.2.1" class="ltx_tr">
<th id="S2.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt" rowspan="2"><span id="S2.T1.1.2.1.1.1" class="ltx_text">House door</span></th>
<td id="S2.T1.1.2.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt">
<span id="S2.T1.1.2.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.2.1.2.1.1" class="ltx_p" style="width:389.8pt;">The house door is in the middle of the {<span id="S2.T1.1.2.1.2.1.1.1" class="ltx_text ltx_font_italic">nr, sr, er, wr</span>} wall of the house.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.3.2" class="ltx_tr">
<td id="S2.T1.1.3.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.3.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.3.2.1.1.1" class="ltx_p" style="width:389.8pt;">The house door is located in the {<span id="S2.T1.1.3.2.1.1.1.1" class="ltx_text ltx_font_italic">n-er, s-er, n-wr, s-wr, n-er, s-er, n-wr, s-wr</span>} side of the house, such that it opens towards {<span id="S2.T1.1.3.2.1.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w</span>}.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.4.3" class="ltx_tr">
<th id="S2.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" rowspan="4"><span id="S2.T1.1.4.3.1.1" class="ltx_text">Room door</span></th>
<td id="S2.T1.1.4.3.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S2.T1.1.4.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.4.3.2.1.1" class="ltx_p" style="width:389.8pt;">The door for this room is in the middle of its {<span id="S2.T1.1.4.3.2.1.1.1" class="ltx_text ltx_font_italic">nr, sr, er, wr</span>} wall.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.5.4" class="ltx_tr">
<td id="S2.T1.1.5.4.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.5.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.5.4.1.1.1" class="ltx_p" style="width:389.8pt;">This room’s door is in the middle of its {<span id="S2.T1.1.5.4.1.1.1.1" class="ltx_text ltx_font_italic">nr, sr, er, wr</span>} wall.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.6.5" class="ltx_tr">
<td id="S2.T1.1.6.5.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.6.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.6.5.1.1.1" class="ltx_p" style="width:389.8pt;">The door for this room is located in its {<span id="S2.T1.1.6.5.1.1.1.1" class="ltx_text ltx_font_italic">n-er, s-er, n-wr, s-wr, n-er, s-er, n-wr, s-wr</span>} side, such that it opens towards {<span id="S2.T1.1.6.5.1.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w</span>}.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.7.6" class="ltx_tr">
<td id="S2.T1.1.7.6.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.7.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.7.6.1.1.1" class="ltx_p" style="width:389.8pt;">This room’s door is located in its {<span id="S2.T1.1.7.6.1.1.1.1" class="ltx_text ltx_font_italic">n-er, s-er, n-wr, s-wr, n-er, s-er, n-wr, s-wr</span>} side, such that it opens towards {<span id="S2.T1.1.7.6.1.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w</span>}.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.8.7" class="ltx_tr">
<th id="S2.T1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" rowspan="2"><span id="S2.T1.1.8.7.1.1" class="ltx_text">Small room</span></th>
<td id="S2.T1.1.8.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S2.T1.1.8.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.8.7.2.1.1" class="ltx_p" style="width:389.8pt;">Room {1, 2, 3} is small in size and it is located in the {<span id="S2.T1.1.8.7.2.1.1.1" class="ltx_text ltx_font_italic">n, s, e, w, c, n-e, s-e, n-w, s-w</span>} of the house.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.9.8" class="ltx_tr">
<td id="S2.T1.1.9.8.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.9.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.9.8.1.1.1" class="ltx_p" style="width:389.8pt;">Room {1, 2, 3} is located in the {<span id="S2.T1.1.9.8.1.1.1.1" class="ltx_text ltx_font_italic">n, s, e, w, c, n-e, s-e, n-w, s-w</span>} of the house and is small in size.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.10.9" class="ltx_tr">
<th id="S2.T1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" rowspan="2"><span id="S2.T1.1.10.9.1.1" class="ltx_text">Medium room</span></th>
<td id="S2.T1.1.10.9.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S2.T1.1.10.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.10.9.2.1.1" class="ltx_p" style="width:389.8pt;">Room {1, 2, 3} is medium in size and it extends from the {<span id="S2.T1.1.10.9.2.1.1.1" class="ltx_text ltx_font_italic">n, s, e, w, c, n-e, s-e, n-w, s-w</span>} to the {<span id="S2.T1.1.10.9.2.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w, c, n-e, s-e, n-w, s-w</span>} of the house.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.11.10" class="ltx_tr">
<td id="S2.T1.1.11.10.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.11.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.11.10.1.1.1" class="ltx_p" style="width:389.8pt;">Room {1, 2, 3} extends from the {<span id="S2.T1.1.11.10.1.1.1.1" class="ltx_text ltx_font_italic">n, s, e, w, c, n-e, s-e, n-w, s-w</span>} to the {<span id="S2.T1.1.11.10.1.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w, c, n-e, s-e, n-w, s-w</span>} of the house and is medium in size.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.12.11" class="ltx_tr">
<th id="S2.T1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" rowspan="2"><span id="S2.T1.1.12.11.1.1" class="ltx_text">Large room</span></th>
<td id="S2.T1.1.12.11.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S2.T1.1.12.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.12.11.2.1.1" class="ltx_p" style="width:389.8pt;">Room {1, 2, 3} is large in size and it stretches along the {<span id="S2.T1.1.12.11.2.1.1.1" class="ltx_text ltx_font_italic">n-s, e-w</span>}direction in the {<span id="S2.T1.1.12.11.2.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w, c</span>} of the house.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.13.12" class="ltx_tr">
<td id="S2.T1.1.13.12.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.13.12.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.13.12.1.1.1" class="ltx_p" style="width:389.8pt;">Room {1, 2, 3} stretches along the {<span id="S2.T1.1.13.12.1.1.1.1" class="ltx_text ltx_font_italic">n-s, e-w</span>} direction in the {<span id="S2.T1.1.13.12.1.1.1.2" class="ltx_text ltx_font_italic">n, s, e, w, c</span>} of the house and is large in size.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.14.13" class="ltx_tr">
<th id="S2.T1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr ltx_border_t" rowspan="4"><span id="S2.T1.1.14.13.1.1" class="ltx_text">Object</span></th>
<td id="S2.T1.1.14.13.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S2.T1.1.14.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.14.13.2.1.1" class="ltx_p" style="width:389.8pt;">A {<span id="S2.T1.1.14.13.2.1.1.1" class="ltx_text ltx_font_italic">cu, cd, sp, co</span>} is located in the middle of the {<span id="S2.T1.1.14.13.2.1.1.2" class="ltx_text ltx_font_italic">nr, sr, er, wr</span>} part of the house.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.15.14" class="ltx_tr">
<td id="S2.T1.1.15.14.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.15.14.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.15.14.1.1.1" class="ltx_p" style="width:389.8pt;">A {<span id="S2.T1.1.15.14.1.1.1.1" class="ltx_text ltx_font_italic">cu, cd, sp, co</span>} is located in the {<span id="S2.T1.1.15.14.1.1.1.2" class="ltx_text ltx_font_italic">n-er, s-er, n-wr, s-wr, n-er, s-er, n-wr, s-wr, cr</span>} part of the house.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.16.15" class="ltx_tr">
<td id="S2.T1.1.16.15.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S2.T1.1.16.15.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.16.15.1.1.1" class="ltx_p" style="width:389.8pt;">A {<span id="S2.T1.1.16.15.1.1.1.1" class="ltx_text ltx_font_italic">cu, cd, sp, co</span>} is located in the middle of the {<span id="S2.T1.1.16.15.1.1.1.2" class="ltx_text ltx_font_italic">nr, sr, er, wr</span>} part of this room.</span>
</span>
</td>
</tr>
<tr id="S2.T1.1.17.16" class="ltx_tr">
<td id="S2.T1.1.17.16.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b">
<span id="S2.T1.1.17.16.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.1.17.16.1.1.1" class="ltx_p" style="width:389.8pt;">A {<span id="S2.T1.1.17.16.1.1.1.1" class="ltx_text ltx_font_italic">cu, cd, sp, co</span>} is located in the {<span id="S2.T1.1.17.16.1.1.1.2" class="ltx_text ltx_font_italic">n-er, s-er, n-wr, s-wr, n-er, s-er, n-wr, s-wr, cr</span>} part of this room.</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Templates used by the description generator for FloorPlanQA. For compactness we used the following notations, <span id="S2.T1.16.1" class="ltx_text ltx_font_italic">n</span> - north, <span id="S2.T1.17.2" class="ltx_text ltx_font_italic">s</span> - south, <span id="S2.T1.18.3" class="ltx_text ltx_font_italic">e</span> - east, <span id="S2.T1.19.4" class="ltx_text ltx_font_italic">w</span> - west, <span id="S2.T1.20.5" class="ltx_text ltx_font_italic">c</span> - center, <span id="S2.T1.21.6" class="ltx_text ltx_font_italic">nr</span> - northern, <span id="S2.T1.22.7" class="ltx_text ltx_font_italic">sr</span> - southern, <span id="S2.T1.23.8" class="ltx_text ltx_font_italic">er</span> - eastern, <span id="S2.T1.24.9" class="ltx_text ltx_font_italic">wr</span> - western, <span id="S2.T1.25.10" class="ltx_text ltx_font_italic">cr</span> - central, <span id="S2.T1.26.11" class="ltx_text ltx_font_italic">cu</span> - cube, <span id="S2.T1.27.12" class="ltx_text ltx_font_italic">cd</span> - cuboid, <span id="S2.T1.28.13" class="ltx_text ltx_font_italic">sp</span> - sphere and <span id="S2.T1.29.14" class="ltx_text ltx_font_italic">co</span> - cone.</figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Datasets</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We introduce two synthetically-generated QA datasets to evaluate a system’s goemetrical reasoning ability: FloorPlanQA and ShapeIntersection. These datasets are not meant to test natural language understanding, but instead focus on geometrical reasoning. Owing to their synthetic nature, they are easy to parse, but nevertheless they are still challenging for DNNs like DMN+ <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a href="#bib.bib31" title="" class="ltx_ref">2016</a>)</cite> and MemN2N <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> that achieved SOTA results on existing QA datasets (see Table <a href="#S5.T2.st1" title="Table 2(a) ‣ Table 2 ‣ 5 Experiments ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>).</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">The proposed datasets are similar in spirit to bAbI <cite class="ltx_cite ltx_citemacro_citep">(Weston et al., <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>, which is also synthetic. In spite of its synthetic nature, bAbI has proved to be a crucial benchmark for the development of new models like MemN2N, DMN+, variants of which have proved successful in various natural domains <cite class="ltx_cite ltx_citemacro_citep">(Kumar et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Perez and Liu, <a href="#bib.bib21" title="" class="ltx_ref">2016</a>)</cite>. Our proposed dataset is first to explicitly test ‘visual thinking’, and its synthetic nature helps us avoid the expensive and tedious task of collecting human annotations. Meanwhile, it is important to note that conclusions drawn from synthetic data do not automatically translate to natural data, and methods developed on synthetic benchmarks need additional validation on natural domains.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">The proposed datasets also contain visual representations of the questions. Each of them has 38,400 questions, evenly split into a training set, a validation set and a test set (12,800 each).</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.1" class="ltx_p"><span id="S3.p4.1.1" class="ltx_text ltx_font_bold">FloorPlanQA:</span>
Each sample in FloorPlanQA involves the layout of a house that has multiple rooms (max 3). The rooms are either small, medium or large. All the rooms and the house have a door. Additionally, each room and empty-space in the house (i.e. the space in the house that is not part of any room) might also contain an object (either a cube, cuboid, sphere, or cone).</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.1" class="ltx_p">Each sample has four components, <span id="S3.p5.1.1" class="ltx_text ltx_font_italic">a description, a question, an answer</span>, and <span id="S3.p5.1.2" class="ltx_text ltx_font_italic">a visual representation</span>. Each sentence in the description describes either a room, a door or an object. A question is of the following template: <span id="S3.p5.1.3" class="ltx_text ltx_font_italic">Suppose you are entering the </span>{<span id="S3.p5.1.4" class="ltx_text ltx_font_italic">house, room 1, room 2, room 3</span>}<span id="S3.p5.1.5" class="ltx_text ltx_font_italic">, where is the </span>{<span id="S3.p5.1.6" class="ltx_text ltx_font_italic">house door, room 1 door, room 2 door, room 3 door, cube, cuboid, sphere, cone</span>}<span id="S3.p5.1.7" class="ltx_text ltx_font_italic"> with respect to you?</span>. The answer is either of <span id="S3.p5.1.8" class="ltx_text ltx_font_italic">left, right, front, </span> or <span id="S3.p5.1.9" class="ltx_text ltx_font_italic">back</span>. Other characteristics of FloorPlanQA are summarized in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Datasets ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.p6" class="ltx_para">
<p id="S3.p6.1" class="ltx_p">The visual representation of a sample consists of an ordered set of image channels, one per sentence in the description. An image channel pictorially represents the location and/or orientation of the described item (room, door, object) w.r.t. the house. An example is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Datasets ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.p7" class="ltx_para">
<p id="S3.p7.1" class="ltx_p">To generate samples for FloorPlanQA, we define a probabilistic generative process which produces tree structures representing layouts of houses, similar to scene graphs used in computer graphics. The root node of a tree represents an entire house, and the leaf nodes represent rooms. We use a description and visual generator to produce respectively the description and visual representation from the tree structure. The templates used by the description generator are described in Table <a href="#S2.T1" title="Table 1 ‣ 2 Related Work ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Furthermore, the order of sentences in a description is randomized while making sure that the description still makes sense. For example, in some sample, the description of room 1 can appear before that of the house-door, while in another sample, it could be reversed. Similarly, for a room, the sentence describing the room’s door could appear before or after the sentence describing the object in the room (if the room contains one). We perform rejection sampling to ensure that all the answers are equally likely, and thus removing bias.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.1" class="ltx_figure ltx_figure_panel"><img src="/html/1805.11025/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="484" height="142" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.fig1" class="ltx_figure ltx_figure_panel">
<table id="S3.F2.fig1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.F2.fig1.1.1.1" class="ltx_tr">
<td id="S3.F2.fig1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_rr">vocabulary size</td>
<td id="S3.F2.fig1.1.1.1.2" class="ltx_td ltx_align_center">66</td>
</tr>
<tr id="S3.F2.fig1.1.2.2" class="ltx_tr">
<td id="S3.F2.fig1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_rr"># unique sentences</td>
<td id="S3.F2.fig1.1.2.2.2" class="ltx_td ltx_align_center">264</td>
</tr>
<tr id="S3.F2.fig1.1.3.3" class="ltx_tr">
<td id="S3.F2.fig1.1.3.3.1" class="ltx_td ltx_align_left ltx_border_rr"># unique descriptions</td>
<td id="S3.F2.fig1.1.3.3.2" class="ltx_td ltx_align_center">38093</td>
</tr>
<tr id="S3.F2.fig1.1.4.4" class="ltx_tr">
<td id="S3.F2.fig1.1.4.4.1" class="ltx_td ltx_align_left ltx_border_rr"># unique questions</td>
<td id="S3.F2.fig1.1.4.4.2" class="ltx_td ltx_align_center">32</td>
</tr>
<tr id="S3.F2.fig1.1.5.5" class="ltx_tr">
<td id="S3.F2.fig1.1.5.5.1" class="ltx_td ltx_align_left ltx_border_rr"># unique question-description pairs</td>
<td id="S3.F2.fig1.1.5.5.2" class="ltx_td ltx_align_center">38228</td>
</tr>
<tr id="S3.F2.fig1.1.6.6" class="ltx_tr">
<td id="S3.F2.fig1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_rr">Avg. # words per sentence</td>
<td id="S3.F2.fig1.1.6.6.2" class="ltx_td ltx_align_center">15</td>
</tr>
<tr id="S3.F2.fig1.1.7.7" class="ltx_tr">
<td id="S3.F2.fig1.1.7.7.1" class="ltx_td ltx_align_left ltx_border_rr">Avg. # sentences per description</td>
<td id="S3.F2.fig1.1.7.7.2" class="ltx_td ltx_align_center">6.61</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An example and characteristics of FloorPlanQA (when considering all the 38,400 samples i.e. training, validation and test sets combined).</figcaption>
</figure>
<div id="S3.p8" class="ltx_para ltx_noindent">
<p id="S3.p8.1" class="ltx_p"><span id="S3.p8.1.1" class="ltx_text ltx_font_bold">ShapeIntersection:</span>
As the name suggests, ShapeIntersection is concerned with counting the number of intersection points between shapes. In this dataset, the description consists of symbols representing various shapes, and the question is always “how many points of intersection are there among these shapes?”</p>
</div>
<div id="S3.p9" class="ltx_para">
<p id="S3.p9.1" class="ltx_p">There are three types of shapes in ShapeIntersection: rectangles, circles, and lines. The description of shapes is provided in the form of a sequence of 1D vectors, each vector representing one shape. A vector in ShapeIntersection is analogous to a sentence in FloorPlanQA. Hence, for ShapeIntersection, the term ‘sentence’ actually refers to a vector. Each sentence describing a shape consists of 5 real numbers. The first number stands for the type of shape: 1 - line, 2 - circle, and 3 - rectangle. The subsequent four numbers specify the size and location of the shape. For example, in case of a rectangle, they represent its height, its width, and coordinates of its bottom-left corner. Note that one can also describe the shapes using a sentence, e.g. “there is a rectangle at (5, 5), with a height of 2 cm and width of 8 cm.” However, as our focus is to evaluate ‘visual thinking’, we work directly with the symbolic encoding.</p>
</div>
<div id="S3.p10" class="ltx_para">
<p id="S3.p10.1" class="ltx_p">In a given description, there are 6.5 shapes on average, and at most 6 lines, 3 rectangles and 3 circles. All the shapes in the dataset are unique and lie on a <math id="S3.p10.1.m1.1" class="ltx_Math" alttext="10\times 10" display="inline"><semantics id="S3.p10.1.m1.1a"><mrow id="S3.p10.1.m1.1.1" xref="S3.p10.1.m1.1.1.cmml"><mn id="S3.p10.1.m1.1.1.2" xref="S3.p10.1.m1.1.1.2.cmml">10</mn><mo lspace="0.222em" rspace="0.222em" id="S3.p10.1.m1.1.1.1" xref="S3.p10.1.m1.1.1.1.cmml">×</mo><mn id="S3.p10.1.m1.1.1.3" xref="S3.p10.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p10.1.m1.1b"><apply id="S3.p10.1.m1.1.1.cmml" xref="S3.p10.1.m1.1.1"><times id="S3.p10.1.m1.1.1.1.cmml" xref="S3.p10.1.m1.1.1.1"></times><cn type="integer" id="S3.p10.1.m1.1.1.2.cmml" xref="S3.p10.1.m1.1.1.2">10</cn><cn type="integer" id="S3.p10.1.m1.1.1.3.cmml" xref="S3.p10.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p10.1.m1.1c">10\times 10</annotation></semantics></math> canvas. While generating the dataset, we do rejection sampling to ensure that the number of intersections is uniformly distributed from 0 to the maximum possible number of intersections, regardless of the number of lines, rectangles, and circles. This ensures that the number of intersections cannot be estimated from the number of lines, circles or rectangles.</p>
</div>
<div id="S3.p11" class="ltx_para">
<p id="S3.p11.1" class="ltx_p">Similar to FloorPlanQA, the visual representation for a sample in this dataset is an ordered set of image channels. Each channel is associated with a sentence, and it plots the described shape. An example is shown in <a href="#S2.F1" title="In 2 Related Work ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Dynamic Spatial Memory Network</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We propose Dynamic Spatial Memory Network (DSMN), a novel DNN designed for QA with geometric reasoning. What differentiates DSMN from other QA DNNs is that it forms an internal visual representation of the input. It then uses a spatial memory to reason over this visual representation.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">A DSMN can be divided into five modules: <span id="S4.p2.1.1" class="ltx_text ltx_font_italic">the input module, visual representation module, question module, spatial memory module</span>, and <span id="S4.p2.1.2" class="ltx_text ltx_font_italic">answer module</span>. The input module generates an embedding for each sentence in the description. The visual representation module uses these embeddings to produce an intermediate visual representation for each sentence. In parallel, the question module produces an embedding for the question. The spatial memory module then goes over the question embedding, the sentence embeddings, and the visual representation multiple times to update the spatial memory. Finally, the answer module uses the spatial memory to output the answer. Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Dynamic Spatial Memory Network ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the overall architecture of DSMN.</p>
</div>
<div id="S4.p3" class="ltx_para ltx_noindent">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Input Module:</span>
This module produces an embedding for each sentence in the description. It is therefore customized based on how the descriptions are provided in a dataset. Since the descriptions are in words for FloorPlanQA, a position encoding (PE) layer is used to produce the initial sentence embeddings. This is done to ensure a fair comparison with DMN+ <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a href="#bib.bib31" title="" class="ltx_ref">2016</a>)</cite> and MemN2N <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite>, which also use a PE layer. A PE layer combines the word-embeddings to encode the position of words in a sentence (Please see  <cite class="ltx_cite ltx_citemacro_cite">Sukhbaatar et al. (<a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> for more information). For ShapeIntersection, the description is given as a sequence of vectors. Therefore, two FC layers (with ReLU in between) are used to obtain the initial sentence embeddings.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.5" class="ltx_p">These initial sentence embeddings are then fed into a bidirectional Gated Recurrent Unit (GRU) <cite class="ltx_cite ltx_citemacro_citep">(Cho et al., <a href="#bib.bib2" title="" class="ltx_ref">2014</a>)</cite> to propagate the information across sentences. Let <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="\overrightarrow{\bm{s_{i}}}" display="inline"><semantics id="S4.p4.1.m1.1a"><mover accent="true" id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><msub id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml"><mi id="S4.p4.1.m1.1.1.2.2" xref="S4.p4.1.m1.1.1.2.2.cmml">𝒔</mi><mi id="S4.p4.1.m1.1.1.2.3" xref="S4.p4.1.m1.1.1.2.3.cmml">𝒊</mi></msub><mo stretchy="false" id="S4.p4.1.m1.1.1.1" xref="S4.p4.1.m1.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><ci id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1">→</ci><apply id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.2.1.cmml" xref="S4.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.p4.1.m1.1.1.2.2.cmml" xref="S4.p4.1.m1.1.1.2.2">𝒔</ci><ci id="S4.p4.1.m1.1.1.2.3.cmml" xref="S4.p4.1.m1.1.1.2.3">𝒊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\overrightarrow{\bm{s_{i}}}</annotation></semantics></math> and <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="\overleftarrow{\bm{s_{i}}}" display="inline"><semantics id="S4.p4.2.m2.1a"><mover accent="true" id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml"><msub id="S4.p4.2.m2.1.1.2" xref="S4.p4.2.m2.1.1.2.cmml"><mi id="S4.p4.2.m2.1.1.2.2" xref="S4.p4.2.m2.1.1.2.2.cmml">𝒔</mi><mi id="S4.p4.2.m2.1.1.2.3" xref="S4.p4.2.m2.1.1.2.3.cmml">𝒊</mi></msub><mo stretchy="false" id="S4.p4.2.m2.1.1.1" xref="S4.p4.2.m2.1.1.1.cmml">←</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><apply id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1"><ci id="S4.p4.2.m2.1.1.1.cmml" xref="S4.p4.2.m2.1.1.1">←</ci><apply id="S4.p4.2.m2.1.1.2.cmml" xref="S4.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.p4.2.m2.1.1.2.1.cmml" xref="S4.p4.2.m2.1.1.2">subscript</csymbol><ci id="S4.p4.2.m2.1.1.2.2.cmml" xref="S4.p4.2.m2.1.1.2.2">𝒔</ci><ci id="S4.p4.2.m2.1.1.2.3.cmml" xref="S4.p4.2.m2.1.1.2.3">𝒊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">\overleftarrow{\bm{s_{i}}}</annotation></semantics></math> be the respective output of the forward and backward GRU at <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.p4.3.m3.1a"><msup id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml"><mi id="S4.p4.3.m3.1.1.2" xref="S4.p4.3.m3.1.1.2.cmml">i</mi><mrow id="S4.p4.3.m3.1.1.3" xref="S4.p4.3.m3.1.1.3.cmml"><mi id="S4.p4.3.m3.1.1.3.2" xref="S4.p4.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.3.m3.1.1.3.1" xref="S4.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.p4.3.m3.1.1.3.3" xref="S4.p4.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><apply id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p4.3.m3.1.1.1.cmml" xref="S4.p4.3.m3.1.1">superscript</csymbol><ci id="S4.p4.3.m3.1.1.2.cmml" xref="S4.p4.3.m3.1.1.2">𝑖</ci><apply id="S4.p4.3.m3.1.1.3.cmml" xref="S4.p4.3.m3.1.1.3"><times id="S4.p4.3.m3.1.1.3.1.cmml" xref="S4.p4.3.m3.1.1.3.1"></times><ci id="S4.p4.3.m3.1.1.3.2.cmml" xref="S4.p4.3.m3.1.1.3.2">𝑡</ci><ci id="S4.p4.3.m3.1.1.3.3.cmml" xref="S4.p4.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">i^{th}</annotation></semantics></math> step. Then, the final sentence embedding for the <math id="S4.p4.4.m4.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.p4.4.m4.1a"><msup id="S4.p4.4.m4.1.1" xref="S4.p4.4.m4.1.1.cmml"><mi id="S4.p4.4.m4.1.1.2" xref="S4.p4.4.m4.1.1.2.cmml">i</mi><mrow id="S4.p4.4.m4.1.1.3" xref="S4.p4.4.m4.1.1.3.cmml"><mi id="S4.p4.4.m4.1.1.3.2" xref="S4.p4.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p4.4.m4.1.1.3.1" xref="S4.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.p4.4.m4.1.1.3.3" xref="S4.p4.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p4.4.m4.1b"><apply id="S4.p4.4.m4.1.1.cmml" xref="S4.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p4.4.m4.1.1.1.cmml" xref="S4.p4.4.m4.1.1">superscript</csymbol><ci id="S4.p4.4.m4.1.1.2.cmml" xref="S4.p4.4.m4.1.1.2">𝑖</ci><apply id="S4.p4.4.m4.1.1.3.cmml" xref="S4.p4.4.m4.1.1.3"><times id="S4.p4.4.m4.1.1.3.1.cmml" xref="S4.p4.4.m4.1.1.3.1"></times><ci id="S4.p4.4.m4.1.1.3.2.cmml" xref="S4.p4.4.m4.1.1.3.2">𝑡</ci><ci id="S4.p4.4.m4.1.1.3.3.cmml" xref="S4.p4.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m4.1c">i^{th}</annotation></semantics></math> sentence is given by <math id="S4.p4.5.m5.1" class="ltx_Math" alttext="\bm{s_{i}}=\overrightarrow{\bm{s_{i}}}+\overleftarrow{\bm{s_{i}}}" display="inline"><semantics id="S4.p4.5.m5.1a"><mrow id="S4.p4.5.m5.1.1" xref="S4.p4.5.m5.1.1.cmml"><msub id="S4.p4.5.m5.1.1.2" xref="S4.p4.5.m5.1.1.2.cmml"><mi id="S4.p4.5.m5.1.1.2.2" xref="S4.p4.5.m5.1.1.2.2.cmml">𝒔</mi><mi id="S4.p4.5.m5.1.1.2.3" xref="S4.p4.5.m5.1.1.2.3.cmml">𝒊</mi></msub><mo id="S4.p4.5.m5.1.1.1" xref="S4.p4.5.m5.1.1.1.cmml">=</mo><mrow id="S4.p4.5.m5.1.1.3" xref="S4.p4.5.m5.1.1.3.cmml"><mover accent="true" id="S4.p4.5.m5.1.1.3.2" xref="S4.p4.5.m5.1.1.3.2.cmml"><msub id="S4.p4.5.m5.1.1.3.2.2" xref="S4.p4.5.m5.1.1.3.2.2.cmml"><mi id="S4.p4.5.m5.1.1.3.2.2.2" xref="S4.p4.5.m5.1.1.3.2.2.2.cmml">𝒔</mi><mi id="S4.p4.5.m5.1.1.3.2.2.3" xref="S4.p4.5.m5.1.1.3.2.2.3.cmml">𝒊</mi></msub><mo stretchy="false" id="S4.p4.5.m5.1.1.3.2.1" xref="S4.p4.5.m5.1.1.3.2.1.cmml">→</mo></mover><mo id="S4.p4.5.m5.1.1.3.1" xref="S4.p4.5.m5.1.1.3.1.cmml">+</mo><mover accent="true" id="S4.p4.5.m5.1.1.3.3" xref="S4.p4.5.m5.1.1.3.3.cmml"><msub id="S4.p4.5.m5.1.1.3.3.2" xref="S4.p4.5.m5.1.1.3.3.2.cmml"><mi id="S4.p4.5.m5.1.1.3.3.2.2" xref="S4.p4.5.m5.1.1.3.3.2.2.cmml">𝒔</mi><mi id="S4.p4.5.m5.1.1.3.3.2.3" xref="S4.p4.5.m5.1.1.3.3.2.3.cmml">𝒊</mi></msub><mo stretchy="false" id="S4.p4.5.m5.1.1.3.3.1" xref="S4.p4.5.m5.1.1.3.3.1.cmml">←</mo></mover></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.5.m5.1b"><apply id="S4.p4.5.m5.1.1.cmml" xref="S4.p4.5.m5.1.1"><eq id="S4.p4.5.m5.1.1.1.cmml" xref="S4.p4.5.m5.1.1.1"></eq><apply id="S4.p4.5.m5.1.1.2.cmml" xref="S4.p4.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.2.1.cmml" xref="S4.p4.5.m5.1.1.2">subscript</csymbol><ci id="S4.p4.5.m5.1.1.2.2.cmml" xref="S4.p4.5.m5.1.1.2.2">𝒔</ci><ci id="S4.p4.5.m5.1.1.2.3.cmml" xref="S4.p4.5.m5.1.1.2.3">𝒊</ci></apply><apply id="S4.p4.5.m5.1.1.3.cmml" xref="S4.p4.5.m5.1.1.3"><plus id="S4.p4.5.m5.1.1.3.1.cmml" xref="S4.p4.5.m5.1.1.3.1"></plus><apply id="S4.p4.5.m5.1.1.3.2.cmml" xref="S4.p4.5.m5.1.1.3.2"><ci id="S4.p4.5.m5.1.1.3.2.1.cmml" xref="S4.p4.5.m5.1.1.3.2.1">→</ci><apply id="S4.p4.5.m5.1.1.3.2.2.cmml" xref="S4.p4.5.m5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.3.2.2.1.cmml" xref="S4.p4.5.m5.1.1.3.2.2">subscript</csymbol><ci id="S4.p4.5.m5.1.1.3.2.2.2.cmml" xref="S4.p4.5.m5.1.1.3.2.2.2">𝒔</ci><ci id="S4.p4.5.m5.1.1.3.2.2.3.cmml" xref="S4.p4.5.m5.1.1.3.2.2.3">𝒊</ci></apply></apply><apply id="S4.p4.5.m5.1.1.3.3.cmml" xref="S4.p4.5.m5.1.1.3.3"><ci id="S4.p4.5.m5.1.1.3.3.1.cmml" xref="S4.p4.5.m5.1.1.3.3.1">←</ci><apply id="S4.p4.5.m5.1.1.3.3.2.cmml" xref="S4.p4.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.p4.5.m5.1.1.3.3.2.1.cmml" xref="S4.p4.5.m5.1.1.3.3.2">subscript</csymbol><ci id="S4.p4.5.m5.1.1.3.3.2.2.cmml" xref="S4.p4.5.m5.1.1.3.3.2.2">𝒔</ci><ci id="S4.p4.5.m5.1.1.3.3.2.3.cmml" xref="S4.p4.5.m5.1.1.3.3.2.3">𝒊</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m5.1c">\bm{s_{i}}=\overrightarrow{\bm{s_{i}}}+\overleftarrow{\bm{s_{i}}}</annotation></semantics></math>.</p>
</div>
<div id="S4.p5" class="ltx_para ltx_noindent">
<p id="S4.p5.1" class="ltx_p"><span id="S4.p5.1.1" class="ltx_text ltx_font_bold">Question Module:</span>
This module produces an embedding for the question. It is also customized to the dataset. For FloorPlanQA, the embeddings of the words in the question are fed to a GRU, and the final hidden state of the GRU is used as the question embedding. For ShapeIntersection, the question is always fixed, so we use an all-zero vector as the question embedding.</p>
</div>
<div id="S4.p6" class="ltx_para ltx_noindent">
<p id="S4.p6.1" class="ltx_p"><span id="S4.p6.1.1" class="ltx_text ltx_font_bold">Visual Representation Module:</span>
This module generates a visual representation for each sentence in the description. It consists of two sub-components: an attention network and an encoder-decoder network. The attention network gathers information from previous sentences that is important to produce the visual representation for the current sentence. For example, suppose the current sentence describes the location of an object with respect to a room. Then in order to infer the location of the object with respect to the house, one needs the location of the room with respect to the house, which is described in some previous sentence.</p>
</div>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.2" class="ltx_p">The encoder-decoder network encodes the visual information gathered by the attention network, combines it with the current sentence embedding, and decodes the visual representation of the current sentence. An encoder (<math id="S4.p7.1.m1.1" class="ltx_math_unparsed" alttext="En(.)" display="inline"><semantics id="S4.p7.1.m1.1a"><mrow id="S4.p7.1.m1.1b"><mi id="S4.p7.1.m1.1.1">E</mi><mi id="S4.p7.1.m1.1.2">n</mi><mrow id="S4.p7.1.m1.1.3"><mo stretchy="false" id="S4.p7.1.m1.1.3.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.p7.1.m1.1.3.2">.</mo><mo stretchy="false" id="S4.p7.1.m1.1.3.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">En(.)</annotation></semantics></math>) takes an image as input and produces an embedding, while a decoder (<math id="S4.p7.2.m2.1" class="ltx_math_unparsed" alttext="De(.)" display="inline"><semantics id="S4.p7.2.m2.1a"><mrow id="S4.p7.2.m2.1b"><mi id="S4.p7.2.m2.1.1">D</mi><mi id="S4.p7.2.m2.1.2">e</mi><mrow id="S4.p7.2.m2.1.3"><mo stretchy="false" id="S4.p7.2.m2.1.3.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.p7.2.m2.1.3.2">.</mo><mo stretchy="false" id="S4.p7.2.m2.1.3.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">De(.)</annotation></semantics></math>) takes an embedding as input and produces an image. An encoder is composed of series of convolution layers and a decoder is composed of series of deconvolution layers.</p>
</div>
<div id="S4.p8" class="ltx_para">
<p id="S4.p8.16" class="ltx_p">Suppose we are currently processing the sentence <math id="S4.p8.1.m1.1" class="ltx_Math" alttext="\bm{s_{t}}" display="inline"><semantics id="S4.p8.1.m1.1a"><msub id="S4.p8.1.m1.1.1" xref="S4.p8.1.m1.1.1.cmml"><mi id="S4.p8.1.m1.1.1.2" xref="S4.p8.1.m1.1.1.2.cmml">𝒔</mi><mi id="S4.p8.1.m1.1.1.3" xref="S4.p8.1.m1.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p8.1.m1.1b"><apply id="S4.p8.1.m1.1.1.cmml" xref="S4.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p8.1.m1.1.1.1.cmml" xref="S4.p8.1.m1.1.1">subscript</csymbol><ci id="S4.p8.1.m1.1.1.2.cmml" xref="S4.p8.1.m1.1.1.2">𝒔</ci><ci id="S4.p8.1.m1.1.1.3.cmml" xref="S4.p8.1.m1.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.1.m1.1c">\bm{s_{t}}</annotation></semantics></math>. This means we have already processed the sentences <math id="S4.p8.2.m2.4" class="ltx_Math" alttext="\bm{s_{1}},\bm{s_{2}},\ldots,\bm{s_{t-1}}" display="inline"><semantics id="S4.p8.2.m2.4a"><mrow id="S4.p8.2.m2.4.4.3" xref="S4.p8.2.m2.4.4.4.cmml"><msub id="S4.p8.2.m2.2.2.1.1" xref="S4.p8.2.m2.2.2.1.1.cmml"><mi id="S4.p8.2.m2.2.2.1.1.2" xref="S4.p8.2.m2.2.2.1.1.2.cmml">𝒔</mi><mn id="S4.p8.2.m2.2.2.1.1.3" xref="S4.p8.2.m2.2.2.1.1.3.cmml">𝟏</mn></msub><mo id="S4.p8.2.m2.4.4.3.4" xref="S4.p8.2.m2.4.4.4.cmml">,</mo><msub id="S4.p8.2.m2.3.3.2.2" xref="S4.p8.2.m2.3.3.2.2.cmml"><mi id="S4.p8.2.m2.3.3.2.2.2" xref="S4.p8.2.m2.3.3.2.2.2.cmml">𝒔</mi><mn id="S4.p8.2.m2.3.3.2.2.3" xref="S4.p8.2.m2.3.3.2.2.3.cmml">𝟐</mn></msub><mo id="S4.p8.2.m2.4.4.3.5" xref="S4.p8.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.p8.2.m2.1.1" xref="S4.p8.2.m2.1.1.cmml">…</mi><mo id="S4.p8.2.m2.4.4.3.6" xref="S4.p8.2.m2.4.4.4.cmml">,</mo><msub id="S4.p8.2.m2.4.4.3.3" xref="S4.p8.2.m2.4.4.3.3.cmml"><mi id="S4.p8.2.m2.4.4.3.3.2" xref="S4.p8.2.m2.4.4.3.3.2.cmml">𝒔</mi><mrow id="S4.p8.2.m2.4.4.3.3.3" xref="S4.p8.2.m2.4.4.3.3.3.cmml"><mi id="S4.p8.2.m2.4.4.3.3.3.2" xref="S4.p8.2.m2.4.4.3.3.3.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.p8.2.m2.4.4.3.3.3.1" xref="S4.p8.2.m2.4.4.3.3.3.1.cmml">−</mo><mn id="S4.p8.2.m2.4.4.3.3.3.3" xref="S4.p8.2.m2.4.4.3.3.3.3.cmml">𝟏</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.2.m2.4b"><list id="S4.p8.2.m2.4.4.4.cmml" xref="S4.p8.2.m2.4.4.3"><apply id="S4.p8.2.m2.2.2.1.1.cmml" xref="S4.p8.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.p8.2.m2.2.2.1.1.1.cmml" xref="S4.p8.2.m2.2.2.1.1">subscript</csymbol><ci id="S4.p8.2.m2.2.2.1.1.2.cmml" xref="S4.p8.2.m2.2.2.1.1.2">𝒔</ci><cn type="integer" id="S4.p8.2.m2.2.2.1.1.3.cmml" xref="S4.p8.2.m2.2.2.1.1.3">1</cn></apply><apply id="S4.p8.2.m2.3.3.2.2.cmml" xref="S4.p8.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.p8.2.m2.3.3.2.2.1.cmml" xref="S4.p8.2.m2.3.3.2.2">subscript</csymbol><ci id="S4.p8.2.m2.3.3.2.2.2.cmml" xref="S4.p8.2.m2.3.3.2.2.2">𝒔</ci><cn type="integer" id="S4.p8.2.m2.3.3.2.2.3.cmml" xref="S4.p8.2.m2.3.3.2.2.3">2</cn></apply><ci id="S4.p8.2.m2.1.1.cmml" xref="S4.p8.2.m2.1.1">…</ci><apply id="S4.p8.2.m2.4.4.3.3.cmml" xref="S4.p8.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.p8.2.m2.4.4.3.3.1.cmml" xref="S4.p8.2.m2.4.4.3.3">subscript</csymbol><ci id="S4.p8.2.m2.4.4.3.3.2.cmml" xref="S4.p8.2.m2.4.4.3.3.2">𝒔</ci><apply id="S4.p8.2.m2.4.4.3.3.3.cmml" xref="S4.p8.2.m2.4.4.3.3.3"><minus id="S4.p8.2.m2.4.4.3.3.3.1.cmml" xref="S4.p8.2.m2.4.4.3.3.3.1"></minus><ci id="S4.p8.2.m2.4.4.3.3.3.2.cmml" xref="S4.p8.2.m2.4.4.3.3.3.2">𝒕</ci><cn type="integer" id="S4.p8.2.m2.4.4.3.3.3.3.cmml" xref="S4.p8.2.m2.4.4.3.3.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.2.m2.4c">\bm{s_{1}},\bm{s_{2}},\ldots,\bm{s_{t-1}}</annotation></semantics></math> and produced the corresponding visual representations <math id="S4.p8.3.m3.4" class="ltx_Math" alttext="\bm{S_{1}},\bm{S_{2}},\ldots,\bm{S_{t-1}}" display="inline"><semantics id="S4.p8.3.m3.4a"><mrow id="S4.p8.3.m3.4.4.3" xref="S4.p8.3.m3.4.4.4.cmml"><msub id="S4.p8.3.m3.2.2.1.1" xref="S4.p8.3.m3.2.2.1.1.cmml"><mi id="S4.p8.3.m3.2.2.1.1.2" xref="S4.p8.3.m3.2.2.1.1.2.cmml">𝑺</mi><mn id="S4.p8.3.m3.2.2.1.1.3" xref="S4.p8.3.m3.2.2.1.1.3.cmml">𝟏</mn></msub><mo id="S4.p8.3.m3.4.4.3.4" xref="S4.p8.3.m3.4.4.4.cmml">,</mo><msub id="S4.p8.3.m3.3.3.2.2" xref="S4.p8.3.m3.3.3.2.2.cmml"><mi id="S4.p8.3.m3.3.3.2.2.2" xref="S4.p8.3.m3.3.3.2.2.2.cmml">𝑺</mi><mn id="S4.p8.3.m3.3.3.2.2.3" xref="S4.p8.3.m3.3.3.2.2.3.cmml">𝟐</mn></msub><mo id="S4.p8.3.m3.4.4.3.5" xref="S4.p8.3.m3.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.p8.3.m3.1.1" xref="S4.p8.3.m3.1.1.cmml">…</mi><mo id="S4.p8.3.m3.4.4.3.6" xref="S4.p8.3.m3.4.4.4.cmml">,</mo><msub id="S4.p8.3.m3.4.4.3.3" xref="S4.p8.3.m3.4.4.3.3.cmml"><mi id="S4.p8.3.m3.4.4.3.3.2" xref="S4.p8.3.m3.4.4.3.3.2.cmml">𝑺</mi><mrow id="S4.p8.3.m3.4.4.3.3.3" xref="S4.p8.3.m3.4.4.3.3.3.cmml"><mi id="S4.p8.3.m3.4.4.3.3.3.2" xref="S4.p8.3.m3.4.4.3.3.3.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.p8.3.m3.4.4.3.3.3.1" xref="S4.p8.3.m3.4.4.3.3.3.1.cmml">−</mo><mn id="S4.p8.3.m3.4.4.3.3.3.3" xref="S4.p8.3.m3.4.4.3.3.3.3.cmml">𝟏</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.3.m3.4b"><list id="S4.p8.3.m3.4.4.4.cmml" xref="S4.p8.3.m3.4.4.3"><apply id="S4.p8.3.m3.2.2.1.1.cmml" xref="S4.p8.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S4.p8.3.m3.2.2.1.1.1.cmml" xref="S4.p8.3.m3.2.2.1.1">subscript</csymbol><ci id="S4.p8.3.m3.2.2.1.1.2.cmml" xref="S4.p8.3.m3.2.2.1.1.2">𝑺</ci><cn type="integer" id="S4.p8.3.m3.2.2.1.1.3.cmml" xref="S4.p8.3.m3.2.2.1.1.3">1</cn></apply><apply id="S4.p8.3.m3.3.3.2.2.cmml" xref="S4.p8.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S4.p8.3.m3.3.3.2.2.1.cmml" xref="S4.p8.3.m3.3.3.2.2">subscript</csymbol><ci id="S4.p8.3.m3.3.3.2.2.2.cmml" xref="S4.p8.3.m3.3.3.2.2.2">𝑺</ci><cn type="integer" id="S4.p8.3.m3.3.3.2.2.3.cmml" xref="S4.p8.3.m3.3.3.2.2.3">2</cn></apply><ci id="S4.p8.3.m3.1.1.cmml" xref="S4.p8.3.m3.1.1">…</ci><apply id="S4.p8.3.m3.4.4.3.3.cmml" xref="S4.p8.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S4.p8.3.m3.4.4.3.3.1.cmml" xref="S4.p8.3.m3.4.4.3.3">subscript</csymbol><ci id="S4.p8.3.m3.4.4.3.3.2.cmml" xref="S4.p8.3.m3.4.4.3.3.2">𝑺</ci><apply id="S4.p8.3.m3.4.4.3.3.3.cmml" xref="S4.p8.3.m3.4.4.3.3.3"><minus id="S4.p8.3.m3.4.4.3.3.3.1.cmml" xref="S4.p8.3.m3.4.4.3.3.3.1"></minus><ci id="S4.p8.3.m3.4.4.3.3.3.2.cmml" xref="S4.p8.3.m3.4.4.3.3.3.2">𝒕</ci><cn type="integer" id="S4.p8.3.m3.4.4.3.3.3.3.cmml" xref="S4.p8.3.m3.4.4.3.3.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.3.m3.4c">\bm{S_{1}},\bm{S_{2}},\ldots,\bm{S_{t-1}}</annotation></semantics></math>. We also add <math id="S4.p8.4.m4.1" class="ltx_Math" alttext="\bm{s_{0}}" display="inline"><semantics id="S4.p8.4.m4.1a"><msub id="S4.p8.4.m4.1.1" xref="S4.p8.4.m4.1.1.cmml"><mi id="S4.p8.4.m4.1.1.2" xref="S4.p8.4.m4.1.1.2.cmml">𝒔</mi><mn id="S4.p8.4.m4.1.1.3" xref="S4.p8.4.m4.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p8.4.m4.1b"><apply id="S4.p8.4.m4.1.1.cmml" xref="S4.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p8.4.m4.1.1.1.cmml" xref="S4.p8.4.m4.1.1">subscript</csymbol><ci id="S4.p8.4.m4.1.1.2.cmml" xref="S4.p8.4.m4.1.1.2">𝒔</ci><cn type="integer" id="S4.p8.4.m4.1.1.3.cmml" xref="S4.p8.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.4.m4.1c">\bm{s_{0}}</annotation></semantics></math> and <math id="S4.p8.5.m5.1" class="ltx_Math" alttext="\bm{S_{0}}" display="inline"><semantics id="S4.p8.5.m5.1a"><msub id="S4.p8.5.m5.1.1" xref="S4.p8.5.m5.1.1.cmml"><mi id="S4.p8.5.m5.1.1.2" xref="S4.p8.5.m5.1.1.2.cmml">𝑺</mi><mn id="S4.p8.5.m5.1.1.3" xref="S4.p8.5.m5.1.1.3.cmml">𝟎</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p8.5.m5.1b"><apply id="S4.p8.5.m5.1.1.cmml" xref="S4.p8.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p8.5.m5.1.1.1.cmml" xref="S4.p8.5.m5.1.1">subscript</csymbol><ci id="S4.p8.5.m5.1.1.2.cmml" xref="S4.p8.5.m5.1.1.2">𝑺</ci><cn type="integer" id="S4.p8.5.m5.1.1.3.cmml" xref="S4.p8.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.5.m5.1c">\bm{S_{0}}</annotation></semantics></math>, which are all-zero vectors to represent the null sentence. The attention network produces a scalar attention weight <math id="S4.p8.6.m6.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S4.p8.6.m6.1a"><msub id="S4.p8.6.m6.1.1" xref="S4.p8.6.m6.1.1.cmml"><mi id="S4.p8.6.m6.1.1.2" xref="S4.p8.6.m6.1.1.2.cmml">a</mi><mi id="S4.p8.6.m6.1.1.3" xref="S4.p8.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p8.6.m6.1b"><apply id="S4.p8.6.m6.1.1.cmml" xref="S4.p8.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p8.6.m6.1.1.1.cmml" xref="S4.p8.6.m6.1.1">subscript</csymbol><ci id="S4.p8.6.m6.1.1.2.cmml" xref="S4.p8.6.m6.1.1.2">𝑎</ci><ci id="S4.p8.6.m6.1.1.3.cmml" xref="S4.p8.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.6.m6.1c">a_{i}</annotation></semantics></math> for the <math id="S4.p8.7.m7.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.p8.7.m7.1a"><msup id="S4.p8.7.m7.1.1" xref="S4.p8.7.m7.1.1.cmml"><mi id="S4.p8.7.m7.1.1.2" xref="S4.p8.7.m7.1.1.2.cmml">i</mi><mrow id="S4.p8.7.m7.1.1.3" xref="S4.p8.7.m7.1.1.3.cmml"><mi id="S4.p8.7.m7.1.1.3.2" xref="S4.p8.7.m7.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p8.7.m7.1.1.3.1" xref="S4.p8.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.p8.7.m7.1.1.3.3" xref="S4.p8.7.m7.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p8.7.m7.1b"><apply id="S4.p8.7.m7.1.1.cmml" xref="S4.p8.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p8.7.m7.1.1.1.cmml" xref="S4.p8.7.m7.1.1">superscript</csymbol><ci id="S4.p8.7.m7.1.1.2.cmml" xref="S4.p8.7.m7.1.1.2">𝑖</ci><apply id="S4.p8.7.m7.1.1.3.cmml" xref="S4.p8.7.m7.1.1.3"><times id="S4.p8.7.m7.1.1.3.1.cmml" xref="S4.p8.7.m7.1.1.3.1"></times><ci id="S4.p8.7.m7.1.1.3.2.cmml" xref="S4.p8.7.m7.1.1.3.2">𝑡</ci><ci id="S4.p8.7.m7.1.1.3.3.cmml" xref="S4.p8.7.m7.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.7.m7.1c">i^{th}</annotation></semantics></math> sentence which is given by <math id="S4.p8.8.m8.1" class="ltx_Math" alttext="a_{i}=\text{Softmax}({\bm{w_{s}}}^{t}\bm{z_{i}}+b_{s})" display="inline"><semantics id="S4.p8.8.m8.1a"><mrow id="S4.p8.8.m8.1.1" xref="S4.p8.8.m8.1.1.cmml"><msub id="S4.p8.8.m8.1.1.3" xref="S4.p8.8.m8.1.1.3.cmml"><mi id="S4.p8.8.m8.1.1.3.2" xref="S4.p8.8.m8.1.1.3.2.cmml">a</mi><mi id="S4.p8.8.m8.1.1.3.3" xref="S4.p8.8.m8.1.1.3.3.cmml">i</mi></msub><mo id="S4.p8.8.m8.1.1.2" xref="S4.p8.8.m8.1.1.2.cmml">=</mo><mrow id="S4.p8.8.m8.1.1.1" xref="S4.p8.8.m8.1.1.1.cmml"><mtext id="S4.p8.8.m8.1.1.1.3" xref="S4.p8.8.m8.1.1.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S4.p8.8.m8.1.1.1.2" xref="S4.p8.8.m8.1.1.1.2.cmml">​</mo><mrow id="S4.p8.8.m8.1.1.1.1.1" xref="S4.p8.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.8.m8.1.1.1.1.1.2" xref="S4.p8.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.p8.8.m8.1.1.1.1.1.1" xref="S4.p8.8.m8.1.1.1.1.1.1.cmml"><mrow id="S4.p8.8.m8.1.1.1.1.1.1.2" xref="S4.p8.8.m8.1.1.1.1.1.1.2.cmml"><mmultiscripts id="S4.p8.8.m8.1.1.1.1.1.1.2.2" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.cmml"><mi id="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.2" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.2.cmml">𝒘</mi><mi id="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.3" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.3.cmml">𝒔</mi><mrow id="S4.p8.8.m8.1.1.1.1.1.1.2.2a" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.cmml"></mrow><mrow id="S4.p8.8.m8.1.1.1.1.1.1.2.2b" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.cmml"></mrow><mi id="S4.p8.8.m8.1.1.1.1.1.1.2.2.3" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.3.cmml">t</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.p8.8.m8.1.1.1.1.1.1.2.1" xref="S4.p8.8.m8.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S4.p8.8.m8.1.1.1.1.1.1.2.3" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3.cmml"><mi id="S4.p8.8.m8.1.1.1.1.1.1.2.3.2" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3.2.cmml">𝒛</mi><mi id="S4.p8.8.m8.1.1.1.1.1.1.2.3.3" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3.3.cmml">𝒊</mi></msub></mrow><mo id="S4.p8.8.m8.1.1.1.1.1.1.1" xref="S4.p8.8.m8.1.1.1.1.1.1.1.cmml">+</mo><msub id="S4.p8.8.m8.1.1.1.1.1.1.3" xref="S4.p8.8.m8.1.1.1.1.1.1.3.cmml"><mi id="S4.p8.8.m8.1.1.1.1.1.1.3.2" xref="S4.p8.8.m8.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S4.p8.8.m8.1.1.1.1.1.1.3.3" xref="S4.p8.8.m8.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S4.p8.8.m8.1.1.1.1.1.3" xref="S4.p8.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.8.m8.1b"><apply id="S4.p8.8.m8.1.1.cmml" xref="S4.p8.8.m8.1.1"><eq id="S4.p8.8.m8.1.1.2.cmml" xref="S4.p8.8.m8.1.1.2"></eq><apply id="S4.p8.8.m8.1.1.3.cmml" xref="S4.p8.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.p8.8.m8.1.1.3.1.cmml" xref="S4.p8.8.m8.1.1.3">subscript</csymbol><ci id="S4.p8.8.m8.1.1.3.2.cmml" xref="S4.p8.8.m8.1.1.3.2">𝑎</ci><ci id="S4.p8.8.m8.1.1.3.3.cmml" xref="S4.p8.8.m8.1.1.3.3">𝑖</ci></apply><apply id="S4.p8.8.m8.1.1.1.cmml" xref="S4.p8.8.m8.1.1.1"><times id="S4.p8.8.m8.1.1.1.2.cmml" xref="S4.p8.8.m8.1.1.1.2"></times><ci id="S4.p8.8.m8.1.1.1.3a.cmml" xref="S4.p8.8.m8.1.1.1.3"><mtext id="S4.p8.8.m8.1.1.1.3.cmml" xref="S4.p8.8.m8.1.1.1.3">Softmax</mtext></ci><apply id="S4.p8.8.m8.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1"><plus id="S4.p8.8.m8.1.1.1.1.1.1.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.1"></plus><apply id="S4.p8.8.m8.1.1.1.1.1.1.2.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2"><times id="S4.p8.8.m8.1.1.1.1.1.1.2.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.1"></times><apply id="S4.p8.8.m8.1.1.1.1.1.1.2.2.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p8.8.m8.1.1.1.1.1.1.2.2.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.2">𝒘</ci><ci id="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.2.3">𝒔</ci></apply><ci id="S4.p8.8.m8.1.1.1.1.1.1.2.2.3.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><apply id="S4.p8.8.m8.1.1.1.1.1.1.2.3.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.p8.8.m8.1.1.1.1.1.1.2.3.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.p8.8.m8.1.1.1.1.1.1.2.3.2.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3.2">𝒛</ci><ci id="S4.p8.8.m8.1.1.1.1.1.1.2.3.3.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.2.3.3">𝒊</ci></apply></apply><apply id="S4.p8.8.m8.1.1.1.1.1.1.3.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p8.8.m8.1.1.1.1.1.1.3.1.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p8.8.m8.1.1.1.1.1.1.3.2.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S4.p8.8.m8.1.1.1.1.1.1.3.3.cmml" xref="S4.p8.8.m8.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.8.m8.1c">a_{i}=\text{Softmax}({\bm{w_{s}}}^{t}\bm{z_{i}}+b_{s})</annotation></semantics></math> where <math id="S4.p8.9.m9.2" class="ltx_Math" alttext="\bm{z_{i}}=[|\bm{s_{i}}-\bm{s_{t}}|;\bm{s_{i}}\circ\bm{s_{t}}]" display="inline"><semantics id="S4.p8.9.m9.2a"><mrow id="S4.p8.9.m9.2.2" xref="S4.p8.9.m9.2.2.cmml"><msub id="S4.p8.9.m9.2.2.4" xref="S4.p8.9.m9.2.2.4.cmml"><mi id="S4.p8.9.m9.2.2.4.2" xref="S4.p8.9.m9.2.2.4.2.cmml">𝒛</mi><mi id="S4.p8.9.m9.2.2.4.3" xref="S4.p8.9.m9.2.2.4.3.cmml">𝒊</mi></msub><mo id="S4.p8.9.m9.2.2.3" xref="S4.p8.9.m9.2.2.3.cmml">=</mo><mrow id="S4.p8.9.m9.2.2.2.2" xref="S4.p8.9.m9.2.2.2.3.cmml"><mo stretchy="false" id="S4.p8.9.m9.2.2.2.2.3" xref="S4.p8.9.m9.2.2.2.3.cmml">[</mo><mrow id="S4.p8.9.m9.1.1.1.1.1.1" xref="S4.p8.9.m9.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.p8.9.m9.1.1.1.1.1.1.2" xref="S4.p8.9.m9.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.p8.9.m9.1.1.1.1.1.1.1" xref="S4.p8.9.m9.1.1.1.1.1.1.1.cmml"><msub id="S4.p8.9.m9.1.1.1.1.1.1.1.2" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2.cmml"><mi id="S4.p8.9.m9.1.1.1.1.1.1.1.2.2" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2.2.cmml">𝒔</mi><mi id="S4.p8.9.m9.1.1.1.1.1.1.1.2.3" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2.3.cmml">𝒊</mi></msub><mo id="S4.p8.9.m9.1.1.1.1.1.1.1.1" xref="S4.p8.9.m9.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.p8.9.m9.1.1.1.1.1.1.1.3" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3.cmml"><mi id="S4.p8.9.m9.1.1.1.1.1.1.1.3.2" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3.2.cmml">𝒔</mi><mi id="S4.p8.9.m9.1.1.1.1.1.1.1.3.3" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3.3.cmml">𝒕</mi></msub></mrow><mo stretchy="false" id="S4.p8.9.m9.1.1.1.1.1.1.3" xref="S4.p8.9.m9.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.p8.9.m9.2.2.2.2.4" xref="S4.p8.9.m9.2.2.2.3.cmml">;</mo><mrow id="S4.p8.9.m9.2.2.2.2.2" xref="S4.p8.9.m9.2.2.2.2.2.cmml"><msub id="S4.p8.9.m9.2.2.2.2.2.2" xref="S4.p8.9.m9.2.2.2.2.2.2.cmml"><mi id="S4.p8.9.m9.2.2.2.2.2.2.2" xref="S4.p8.9.m9.2.2.2.2.2.2.2.cmml">𝒔</mi><mi id="S4.p8.9.m9.2.2.2.2.2.2.3" xref="S4.p8.9.m9.2.2.2.2.2.2.3.cmml">𝒊</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.p8.9.m9.2.2.2.2.2.1" xref="S4.p8.9.m9.2.2.2.2.2.1.cmml">∘</mo><msub id="S4.p8.9.m9.2.2.2.2.2.3" xref="S4.p8.9.m9.2.2.2.2.2.3.cmml"><mi id="S4.p8.9.m9.2.2.2.2.2.3.2" xref="S4.p8.9.m9.2.2.2.2.2.3.2.cmml">𝒔</mi><mi id="S4.p8.9.m9.2.2.2.2.2.3.3" xref="S4.p8.9.m9.2.2.2.2.2.3.3.cmml">𝒕</mi></msub></mrow><mo stretchy="false" id="S4.p8.9.m9.2.2.2.2.5" xref="S4.p8.9.m9.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.9.m9.2b"><apply id="S4.p8.9.m9.2.2.cmml" xref="S4.p8.9.m9.2.2"><eq id="S4.p8.9.m9.2.2.3.cmml" xref="S4.p8.9.m9.2.2.3"></eq><apply id="S4.p8.9.m9.2.2.4.cmml" xref="S4.p8.9.m9.2.2.4"><csymbol cd="ambiguous" id="S4.p8.9.m9.2.2.4.1.cmml" xref="S4.p8.9.m9.2.2.4">subscript</csymbol><ci id="S4.p8.9.m9.2.2.4.2.cmml" xref="S4.p8.9.m9.2.2.4.2">𝒛</ci><ci id="S4.p8.9.m9.2.2.4.3.cmml" xref="S4.p8.9.m9.2.2.4.3">𝒊</ci></apply><list id="S4.p8.9.m9.2.2.2.3.cmml" xref="S4.p8.9.m9.2.2.2.2"><apply id="S4.p8.9.m9.1.1.1.1.1.2.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1"><abs id="S4.p8.9.m9.1.1.1.1.1.2.1.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.2"></abs><apply id="S4.p8.9.m9.1.1.1.1.1.1.1.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1"><minus id="S4.p8.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.1"></minus><apply id="S4.p8.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p8.9.m9.1.1.1.1.1.1.1.2.1.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.p8.9.m9.1.1.1.1.1.1.1.2.2.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2.2">𝒔</ci><ci id="S4.p8.9.m9.1.1.1.1.1.1.1.2.3.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.2.3">𝒊</ci></apply><apply id="S4.p8.9.m9.1.1.1.1.1.1.1.3.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p8.9.m9.1.1.1.1.1.1.1.3.1.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.p8.9.m9.1.1.1.1.1.1.1.3.2.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3.2">𝒔</ci><ci id="S4.p8.9.m9.1.1.1.1.1.1.1.3.3.cmml" xref="S4.p8.9.m9.1.1.1.1.1.1.1.3.3">𝒕</ci></apply></apply></apply><apply id="S4.p8.9.m9.2.2.2.2.2.cmml" xref="S4.p8.9.m9.2.2.2.2.2"><compose id="S4.p8.9.m9.2.2.2.2.2.1.cmml" xref="S4.p8.9.m9.2.2.2.2.2.1"></compose><apply id="S4.p8.9.m9.2.2.2.2.2.2.cmml" xref="S4.p8.9.m9.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p8.9.m9.2.2.2.2.2.2.1.cmml" xref="S4.p8.9.m9.2.2.2.2.2.2">subscript</csymbol><ci id="S4.p8.9.m9.2.2.2.2.2.2.2.cmml" xref="S4.p8.9.m9.2.2.2.2.2.2.2">𝒔</ci><ci id="S4.p8.9.m9.2.2.2.2.2.2.3.cmml" xref="S4.p8.9.m9.2.2.2.2.2.2.3">𝒊</ci></apply><apply id="S4.p8.9.m9.2.2.2.2.2.3.cmml" xref="S4.p8.9.m9.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.p8.9.m9.2.2.2.2.2.3.1.cmml" xref="S4.p8.9.m9.2.2.2.2.2.3">subscript</csymbol><ci id="S4.p8.9.m9.2.2.2.2.2.3.2.cmml" xref="S4.p8.9.m9.2.2.2.2.2.3.2">𝒔</ci><ci id="S4.p8.9.m9.2.2.2.2.2.3.3.cmml" xref="S4.p8.9.m9.2.2.2.2.2.3.3">𝒕</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.9.m9.2c">\bm{z_{i}}=[|\bm{s_{i}}-\bm{s_{t}}|;\bm{s_{i}}\circ\bm{s_{t}}]</annotation></semantics></math>. Here, <math id="S4.p8.10.m10.1" class="ltx_Math" alttext="\bm{w_{s}}" display="inline"><semantics id="S4.p8.10.m10.1a"><msub id="S4.p8.10.m10.1.1" xref="S4.p8.10.m10.1.1.cmml"><mi id="S4.p8.10.m10.1.1.2" xref="S4.p8.10.m10.1.1.2.cmml">𝒘</mi><mi id="S4.p8.10.m10.1.1.3" xref="S4.p8.10.m10.1.1.3.cmml">𝒔</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p8.10.m10.1b"><apply id="S4.p8.10.m10.1.1.cmml" xref="S4.p8.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p8.10.m10.1.1.1.cmml" xref="S4.p8.10.m10.1.1">subscript</csymbol><ci id="S4.p8.10.m10.1.1.2.cmml" xref="S4.p8.10.m10.1.1.2">𝒘</ci><ci id="S4.p8.10.m10.1.1.3.cmml" xref="S4.p8.10.m10.1.1.3">𝒔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.10.m10.1c">\bm{w_{s}}</annotation></semantics></math> is a vector, <math id="S4.p8.11.m11.1" class="ltx_Math" alttext="b_{s}" display="inline"><semantics id="S4.p8.11.m11.1a"><msub id="S4.p8.11.m11.1.1" xref="S4.p8.11.m11.1.1.cmml"><mi id="S4.p8.11.m11.1.1.2" xref="S4.p8.11.m11.1.1.2.cmml">b</mi><mi id="S4.p8.11.m11.1.1.3" xref="S4.p8.11.m11.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p8.11.m11.1b"><apply id="S4.p8.11.m11.1.1.cmml" xref="S4.p8.11.m11.1.1"><csymbol cd="ambiguous" id="S4.p8.11.m11.1.1.1.cmml" xref="S4.p8.11.m11.1.1">subscript</csymbol><ci id="S4.p8.11.m11.1.1.2.cmml" xref="S4.p8.11.m11.1.1.2">𝑏</ci><ci id="S4.p8.11.m11.1.1.3.cmml" xref="S4.p8.11.m11.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.11.m11.1c">b_{s}</annotation></semantics></math> is a scalar, <math id="S4.p8.12.m12.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S4.p8.12.m12.1a"><mo id="S4.p8.12.m12.1.1" xref="S4.p8.12.m12.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S4.p8.12.m12.1b"><compose id="S4.p8.12.m12.1.1.cmml" xref="S4.p8.12.m12.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.12.m12.1c">\circ</annotation></semantics></math> represents element-wise multiplication, <math id="S4.p8.13.m13.1" class="ltx_math_unparsed" alttext="|.|" display="inline"><semantics id="S4.p8.13.m13.1a"><mrow id="S4.p8.13.m13.1b"><mo fence="false" stretchy="false" id="S4.p8.13.m13.1.1">|</mo><mo lspace="0.167em" rspace="0.167em" id="S4.p8.13.m13.1.2">.</mo><mo fence="false" stretchy="false" id="S4.p8.13.m13.1.3">|</mo></mrow><annotation encoding="application/x-tex" id="S4.p8.13.m13.1c">|.|</annotation></semantics></math> represents element-wise absolute value, and <math id="S4.p8.14.m14.2" class="ltx_Math" alttext="[\bm{v1};\bm{v2}]" display="inline"><semantics id="S4.p8.14.m14.2a"><mrow id="S4.p8.14.m14.2.2.2" xref="S4.p8.14.m14.2.2.3.cmml"><mo stretchy="false" id="S4.p8.14.m14.2.2.2.3" xref="S4.p8.14.m14.2.2.3.cmml">[</mo><mrow id="S4.p8.14.m14.1.1.1.1" xref="S4.p8.14.m14.1.1.1.1.cmml"><mi id="S4.p8.14.m14.1.1.1.1.2" xref="S4.p8.14.m14.1.1.1.1.2.cmml">𝒗</mi><mo lspace="0em" rspace="0em" id="S4.p8.14.m14.1.1.1.1.1" xref="S4.p8.14.m14.1.1.1.1.1.cmml">​</mo><mn id="S4.p8.14.m14.1.1.1.1.3" xref="S4.p8.14.m14.1.1.1.1.3.cmml">𝟏</mn></mrow><mo id="S4.p8.14.m14.2.2.2.4" xref="S4.p8.14.m14.2.2.3.cmml">;</mo><mrow id="S4.p8.14.m14.2.2.2.2" xref="S4.p8.14.m14.2.2.2.2.cmml"><mi id="S4.p8.14.m14.2.2.2.2.2" xref="S4.p8.14.m14.2.2.2.2.2.cmml">𝒗</mi><mo lspace="0em" rspace="0em" id="S4.p8.14.m14.2.2.2.2.1" xref="S4.p8.14.m14.2.2.2.2.1.cmml">​</mo><mn id="S4.p8.14.m14.2.2.2.2.3" xref="S4.p8.14.m14.2.2.2.2.3.cmml">𝟐</mn></mrow><mo stretchy="false" id="S4.p8.14.m14.2.2.2.5" xref="S4.p8.14.m14.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.14.m14.2b"><list id="S4.p8.14.m14.2.2.3.cmml" xref="S4.p8.14.m14.2.2.2"><apply id="S4.p8.14.m14.1.1.1.1.cmml" xref="S4.p8.14.m14.1.1.1.1"><times id="S4.p8.14.m14.1.1.1.1.1.cmml" xref="S4.p8.14.m14.1.1.1.1.1"></times><ci id="S4.p8.14.m14.1.1.1.1.2.cmml" xref="S4.p8.14.m14.1.1.1.1.2">𝒗</ci><cn type="integer" id="S4.p8.14.m14.1.1.1.1.3.cmml" xref="S4.p8.14.m14.1.1.1.1.3">1</cn></apply><apply id="S4.p8.14.m14.2.2.2.2.cmml" xref="S4.p8.14.m14.2.2.2.2"><times id="S4.p8.14.m14.2.2.2.2.1.cmml" xref="S4.p8.14.m14.2.2.2.2.1"></times><ci id="S4.p8.14.m14.2.2.2.2.2.cmml" xref="S4.p8.14.m14.2.2.2.2.2">𝒗</ci><cn type="integer" id="S4.p8.14.m14.2.2.2.2.3.cmml" xref="S4.p8.14.m14.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.14.m14.2c">[\bm{v1};\bm{v2}]</annotation></semantics></math> represents the concatenation of vectors <math id="S4.p8.15.m15.1" class="ltx_Math" alttext="\bm{v1}" display="inline"><semantics id="S4.p8.15.m15.1a"><mrow id="S4.p8.15.m15.1.1" xref="S4.p8.15.m15.1.1.cmml"><mi id="S4.p8.15.m15.1.1.2" xref="S4.p8.15.m15.1.1.2.cmml">𝒗</mi><mo lspace="0em" rspace="0em" id="S4.p8.15.m15.1.1.1" xref="S4.p8.15.m15.1.1.1.cmml">​</mo><mn id="S4.p8.15.m15.1.1.3" xref="S4.p8.15.m15.1.1.3.cmml">𝟏</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.15.m15.1b"><apply id="S4.p8.15.m15.1.1.cmml" xref="S4.p8.15.m15.1.1"><times id="S4.p8.15.m15.1.1.1.cmml" xref="S4.p8.15.m15.1.1.1"></times><ci id="S4.p8.15.m15.1.1.2.cmml" xref="S4.p8.15.m15.1.1.2">𝒗</ci><cn type="integer" id="S4.p8.15.m15.1.1.3.cmml" xref="S4.p8.15.m15.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.15.m15.1c">\bm{v1}</annotation></semantics></math> and <math id="S4.p8.16.m16.1" class="ltx_Math" alttext="\bm{v2}" display="inline"><semantics id="S4.p8.16.m16.1a"><mrow id="S4.p8.16.m16.1.1" xref="S4.p8.16.m16.1.1.cmml"><mi id="S4.p8.16.m16.1.1.2" xref="S4.p8.16.m16.1.1.2.cmml">𝒗</mi><mo lspace="0em" rspace="0em" id="S4.p8.16.m16.1.1.1" xref="S4.p8.16.m16.1.1.1.cmml">​</mo><mn id="S4.p8.16.m16.1.1.3" xref="S4.p8.16.m16.1.1.3.cmml">𝟐</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.16.m16.1b"><apply id="S4.p8.16.m16.1.1.cmml" xref="S4.p8.16.m16.1.1"><times id="S4.p8.16.m16.1.1.1.cmml" xref="S4.p8.16.m16.1.1.1"></times><ci id="S4.p8.16.m16.1.1.2.cmml" xref="S4.p8.16.m16.1.1.2">𝒗</ci><cn type="integer" id="S4.p8.16.m16.1.1.3.cmml" xref="S4.p8.16.m16.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.16.m16.1c">\bm{v2}</annotation></semantics></math>.</p>
</div>
<div id="S4.p9" class="ltx_para">
<p id="S4.p9.7" class="ltx_p">The gathered visual information is <math id="S4.p9.1.m1.1" class="ltx_Math" alttext="\bar{\bm{S_{t}}}=\sum_{i=0}^{t-1}a_{i}\bm{S_{i}}" display="inline"><semantics id="S4.p9.1.m1.1a"><mrow id="S4.p9.1.m1.1.1" xref="S4.p9.1.m1.1.1.cmml"><mover accent="true" id="S4.p9.1.m1.1.1.2" xref="S4.p9.1.m1.1.1.2.cmml"><msub id="S4.p9.1.m1.1.1.2.2" xref="S4.p9.1.m1.1.1.2.2.cmml"><mi id="S4.p9.1.m1.1.1.2.2.2" xref="S4.p9.1.m1.1.1.2.2.2.cmml">𝑺</mi><mi id="S4.p9.1.m1.1.1.2.2.3" xref="S4.p9.1.m1.1.1.2.2.3.cmml">𝒕</mi></msub><mo id="S4.p9.1.m1.1.1.2.1" xref="S4.p9.1.m1.1.1.2.1.cmml">¯</mo></mover><mo rspace="0.111em" id="S4.p9.1.m1.1.1.1" xref="S4.p9.1.m1.1.1.1.cmml">=</mo><mrow id="S4.p9.1.m1.1.1.3" xref="S4.p9.1.m1.1.1.3.cmml"><msubsup id="S4.p9.1.m1.1.1.3.1" xref="S4.p9.1.m1.1.1.3.1.cmml"><mo id="S4.p9.1.m1.1.1.3.1.2.2" xref="S4.p9.1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.p9.1.m1.1.1.3.1.2.3" xref="S4.p9.1.m1.1.1.3.1.2.3.cmml"><mi id="S4.p9.1.m1.1.1.3.1.2.3.2" xref="S4.p9.1.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.p9.1.m1.1.1.3.1.2.3.1" xref="S4.p9.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.p9.1.m1.1.1.3.1.2.3.3" xref="S4.p9.1.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.p9.1.m1.1.1.3.1.3" xref="S4.p9.1.m1.1.1.3.1.3.cmml"><mi id="S4.p9.1.m1.1.1.3.1.3.2" xref="S4.p9.1.m1.1.1.3.1.3.2.cmml">t</mi><mo id="S4.p9.1.m1.1.1.3.1.3.1" xref="S4.p9.1.m1.1.1.3.1.3.1.cmml">−</mo><mn id="S4.p9.1.m1.1.1.3.1.3.3" xref="S4.p9.1.m1.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><mrow id="S4.p9.1.m1.1.1.3.2" xref="S4.p9.1.m1.1.1.3.2.cmml"><msub id="S4.p9.1.m1.1.1.3.2.2" xref="S4.p9.1.m1.1.1.3.2.2.cmml"><mi id="S4.p9.1.m1.1.1.3.2.2.2" xref="S4.p9.1.m1.1.1.3.2.2.2.cmml">a</mi><mi id="S4.p9.1.m1.1.1.3.2.2.3" xref="S4.p9.1.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.p9.1.m1.1.1.3.2.1" xref="S4.p9.1.m1.1.1.3.2.1.cmml">​</mo><msub id="S4.p9.1.m1.1.1.3.2.3" xref="S4.p9.1.m1.1.1.3.2.3.cmml"><mi id="S4.p9.1.m1.1.1.3.2.3.2" xref="S4.p9.1.m1.1.1.3.2.3.2.cmml">𝑺</mi><mi id="S4.p9.1.m1.1.1.3.2.3.3" xref="S4.p9.1.m1.1.1.3.2.3.3.cmml">𝒊</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.1.m1.1b"><apply id="S4.p9.1.m1.1.1.cmml" xref="S4.p9.1.m1.1.1"><eq id="S4.p9.1.m1.1.1.1.cmml" xref="S4.p9.1.m1.1.1.1"></eq><apply id="S4.p9.1.m1.1.1.2.cmml" xref="S4.p9.1.m1.1.1.2"><ci id="S4.p9.1.m1.1.1.2.1.cmml" xref="S4.p9.1.m1.1.1.2.1">¯</ci><apply id="S4.p9.1.m1.1.1.2.2.cmml" xref="S4.p9.1.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.1.2.2.1.cmml" xref="S4.p9.1.m1.1.1.2.2">subscript</csymbol><ci id="S4.p9.1.m1.1.1.2.2.2.cmml" xref="S4.p9.1.m1.1.1.2.2.2">𝑺</ci><ci id="S4.p9.1.m1.1.1.2.2.3.cmml" xref="S4.p9.1.m1.1.1.2.2.3">𝒕</ci></apply></apply><apply id="S4.p9.1.m1.1.1.3.cmml" xref="S4.p9.1.m1.1.1.3"><apply id="S4.p9.1.m1.1.1.3.1.cmml" xref="S4.p9.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.1.3.1.1.cmml" xref="S4.p9.1.m1.1.1.3.1">superscript</csymbol><apply id="S4.p9.1.m1.1.1.3.1.2.cmml" xref="S4.p9.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.1.3.1.2.1.cmml" xref="S4.p9.1.m1.1.1.3.1">subscript</csymbol><sum id="S4.p9.1.m1.1.1.3.1.2.2.cmml" xref="S4.p9.1.m1.1.1.3.1.2.2"></sum><apply id="S4.p9.1.m1.1.1.3.1.2.3.cmml" xref="S4.p9.1.m1.1.1.3.1.2.3"><eq id="S4.p9.1.m1.1.1.3.1.2.3.1.cmml" xref="S4.p9.1.m1.1.1.3.1.2.3.1"></eq><ci id="S4.p9.1.m1.1.1.3.1.2.3.2.cmml" xref="S4.p9.1.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.p9.1.m1.1.1.3.1.2.3.3.cmml" xref="S4.p9.1.m1.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S4.p9.1.m1.1.1.3.1.3.cmml" xref="S4.p9.1.m1.1.1.3.1.3"><minus id="S4.p9.1.m1.1.1.3.1.3.1.cmml" xref="S4.p9.1.m1.1.1.3.1.3.1"></minus><ci id="S4.p9.1.m1.1.1.3.1.3.2.cmml" xref="S4.p9.1.m1.1.1.3.1.3.2">𝑡</ci><cn type="integer" id="S4.p9.1.m1.1.1.3.1.3.3.cmml" xref="S4.p9.1.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S4.p9.1.m1.1.1.3.2.cmml" xref="S4.p9.1.m1.1.1.3.2"><times id="S4.p9.1.m1.1.1.3.2.1.cmml" xref="S4.p9.1.m1.1.1.3.2.1"></times><apply id="S4.p9.1.m1.1.1.3.2.2.cmml" xref="S4.p9.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.1.3.2.2.1.cmml" xref="S4.p9.1.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.p9.1.m1.1.1.3.2.2.2.cmml" xref="S4.p9.1.m1.1.1.3.2.2.2">𝑎</ci><ci id="S4.p9.1.m1.1.1.3.2.2.3.cmml" xref="S4.p9.1.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.p9.1.m1.1.1.3.2.3.cmml" xref="S4.p9.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.1.3.2.3.1.cmml" xref="S4.p9.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S4.p9.1.m1.1.1.3.2.3.2.cmml" xref="S4.p9.1.m1.1.1.3.2.3.2">𝑺</ci><ci id="S4.p9.1.m1.1.1.3.2.3.3.cmml" xref="S4.p9.1.m1.1.1.3.2.3.3">𝒊</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.1.m1.1c">\bar{\bm{S_{t}}}=\sum_{i=0}^{t-1}a_{i}\bm{S_{i}}</annotation></semantics></math>. It is fed into the encoder-decoder network. The visual representation for <math id="S4.p9.2.m2.1" class="ltx_Math" alttext="\bm{s_{t}}" display="inline"><semantics id="S4.p9.2.m2.1a"><msub id="S4.p9.2.m2.1.1" xref="S4.p9.2.m2.1.1.cmml"><mi id="S4.p9.2.m2.1.1.2" xref="S4.p9.2.m2.1.1.2.cmml">𝒔</mi><mi id="S4.p9.2.m2.1.1.3" xref="S4.p9.2.m2.1.1.3.cmml">𝒕</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p9.2.m2.1b"><apply id="S4.p9.2.m2.1.1.cmml" xref="S4.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p9.2.m2.1.1.1.cmml" xref="S4.p9.2.m2.1.1">subscript</csymbol><ci id="S4.p9.2.m2.1.1.2.cmml" xref="S4.p9.2.m2.1.1.2">𝒔</ci><ci id="S4.p9.2.m2.1.1.3.cmml" xref="S4.p9.2.m2.1.1.3">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.2.m2.1c">\bm{s_{t}}</annotation></semantics></math> is given by <math id="S4.p9.3.m3.2" class="ltx_Math" alttext="\bm{S_{t}}=De_{s}\Big{(}\big{[}\bm{s_{t}};En_{s}(\bar{\bm{S_{t}}})\big{]}\Big{)}" display="inline"><semantics id="S4.p9.3.m3.2a"><mrow id="S4.p9.3.m3.2.2" xref="S4.p9.3.m3.2.2.cmml"><msub id="S4.p9.3.m3.2.2.3" xref="S4.p9.3.m3.2.2.3.cmml"><mi id="S4.p9.3.m3.2.2.3.2" xref="S4.p9.3.m3.2.2.3.2.cmml">𝑺</mi><mi id="S4.p9.3.m3.2.2.3.3" xref="S4.p9.3.m3.2.2.3.3.cmml">𝒕</mi></msub><mo id="S4.p9.3.m3.2.2.2" xref="S4.p9.3.m3.2.2.2.cmml">=</mo><mrow id="S4.p9.3.m3.2.2.1" xref="S4.p9.3.m3.2.2.1.cmml"><mi id="S4.p9.3.m3.2.2.1.3" xref="S4.p9.3.m3.2.2.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.p9.3.m3.2.2.1.2" xref="S4.p9.3.m3.2.2.1.2.cmml">​</mo><msub id="S4.p9.3.m3.2.2.1.4" xref="S4.p9.3.m3.2.2.1.4.cmml"><mi id="S4.p9.3.m3.2.2.1.4.2" xref="S4.p9.3.m3.2.2.1.4.2.cmml">e</mi><mi id="S4.p9.3.m3.2.2.1.4.3" xref="S4.p9.3.m3.2.2.1.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S4.p9.3.m3.2.2.1.2a" xref="S4.p9.3.m3.2.2.1.2.cmml">​</mo><mrow id="S4.p9.3.m3.2.2.1.1.1" xref="S4.p9.3.m3.2.2.1.cmml"><mo maxsize="160%" minsize="160%" id="S4.p9.3.m3.2.2.1.1.1.2" xref="S4.p9.3.m3.2.2.1.cmml">(</mo><mrow id="S4.p9.3.m3.2.2.1.1.1.1.2" xref="S4.p9.3.m3.2.2.1.1.1.1.3.cmml"><mo maxsize="120%" minsize="120%" id="S4.p9.3.m3.2.2.1.1.1.1.2.3" xref="S4.p9.3.m3.2.2.1.1.1.1.3.cmml">[</mo><msub id="S4.p9.3.m3.2.2.1.1.1.1.1.1" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S4.p9.3.m3.2.2.1.1.1.1.1.1.2" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1.2.cmml">𝒔</mi><mi id="S4.p9.3.m3.2.2.1.1.1.1.1.1.3" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1.3.cmml">𝒕</mi></msub><mo id="S4.p9.3.m3.2.2.1.1.1.1.2.4" xref="S4.p9.3.m3.2.2.1.1.1.1.3.cmml">;</mo><mrow id="S4.p9.3.m3.2.2.1.1.1.1.2.2" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.cmml"><mi id="S4.p9.3.m3.2.2.1.1.1.1.2.2.2" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.p9.3.m3.2.2.1.1.1.1.2.2.1" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.1.cmml">​</mo><msub id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.cmml"><mi id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.2" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.2.cmml">n</mi><mi id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.3" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S4.p9.3.m3.2.2.1.1.1.1.2.2.1a" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.1.cmml">​</mo><mrow id="S4.p9.3.m3.2.2.1.1.1.1.2.2.4.2" xref="S4.p9.3.m3.1.1.cmml"><mo stretchy="false" id="S4.p9.3.m3.2.2.1.1.1.1.2.2.4.2.1" xref="S4.p9.3.m3.1.1.cmml">(</mo><mover accent="true" id="S4.p9.3.m3.1.1" xref="S4.p9.3.m3.1.1.cmml"><msub id="S4.p9.3.m3.1.1.2" xref="S4.p9.3.m3.1.1.2.cmml"><mi id="S4.p9.3.m3.1.1.2.2" xref="S4.p9.3.m3.1.1.2.2.cmml">𝑺</mi><mi id="S4.p9.3.m3.1.1.2.3" xref="S4.p9.3.m3.1.1.2.3.cmml">𝒕</mi></msub><mo id="S4.p9.3.m3.1.1.1" xref="S4.p9.3.m3.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S4.p9.3.m3.2.2.1.1.1.1.2.2.4.2.2" xref="S4.p9.3.m3.1.1.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.p9.3.m3.2.2.1.1.1.1.2.5" xref="S4.p9.3.m3.2.2.1.1.1.1.3.cmml">]</mo></mrow><mo maxsize="160%" minsize="160%" id="S4.p9.3.m3.2.2.1.1.1.3" xref="S4.p9.3.m3.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.3.m3.2b"><apply id="S4.p9.3.m3.2.2.cmml" xref="S4.p9.3.m3.2.2"><eq id="S4.p9.3.m3.2.2.2.cmml" xref="S4.p9.3.m3.2.2.2"></eq><apply id="S4.p9.3.m3.2.2.3.cmml" xref="S4.p9.3.m3.2.2.3"><csymbol cd="ambiguous" id="S4.p9.3.m3.2.2.3.1.cmml" xref="S4.p9.3.m3.2.2.3">subscript</csymbol><ci id="S4.p9.3.m3.2.2.3.2.cmml" xref="S4.p9.3.m3.2.2.3.2">𝑺</ci><ci id="S4.p9.3.m3.2.2.3.3.cmml" xref="S4.p9.3.m3.2.2.3.3">𝒕</ci></apply><apply id="S4.p9.3.m3.2.2.1.cmml" xref="S4.p9.3.m3.2.2.1"><times id="S4.p9.3.m3.2.2.1.2.cmml" xref="S4.p9.3.m3.2.2.1.2"></times><ci id="S4.p9.3.m3.2.2.1.3.cmml" xref="S4.p9.3.m3.2.2.1.3">𝐷</ci><apply id="S4.p9.3.m3.2.2.1.4.cmml" xref="S4.p9.3.m3.2.2.1.4"><csymbol cd="ambiguous" id="S4.p9.3.m3.2.2.1.4.1.cmml" xref="S4.p9.3.m3.2.2.1.4">subscript</csymbol><ci id="S4.p9.3.m3.2.2.1.4.2.cmml" xref="S4.p9.3.m3.2.2.1.4.2">𝑒</ci><ci id="S4.p9.3.m3.2.2.1.4.3.cmml" xref="S4.p9.3.m3.2.2.1.4.3">𝑠</ci></apply><list id="S4.p9.3.m3.2.2.1.1.1.1.3.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2"><apply id="S4.p9.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p9.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p9.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1.2">𝒔</ci><ci id="S4.p9.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.1.1.3">𝒕</ci></apply><apply id="S4.p9.3.m3.2.2.1.1.1.1.2.2.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2"><times id="S4.p9.3.m3.2.2.1.1.1.1.2.2.1.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.1"></times><ci id="S4.p9.3.m3.2.2.1.1.1.1.2.2.2.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.2">𝐸</ci><apply id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.1.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3">subscript</csymbol><ci id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.2.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.2">𝑛</ci><ci id="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.3.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.3.3">𝑠</ci></apply><apply id="S4.p9.3.m3.1.1.cmml" xref="S4.p9.3.m3.2.2.1.1.1.1.2.2.4.2"><ci id="S4.p9.3.m3.1.1.1.cmml" xref="S4.p9.3.m3.1.1.1">¯</ci><apply id="S4.p9.3.m3.1.1.2.cmml" xref="S4.p9.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.p9.3.m3.1.1.2.1.cmml" xref="S4.p9.3.m3.1.1.2">subscript</csymbol><ci id="S4.p9.3.m3.1.1.2.2.cmml" xref="S4.p9.3.m3.1.1.2.2">𝑺</ci><ci id="S4.p9.3.m3.1.1.2.3.cmml" xref="S4.p9.3.m3.1.1.2.3">𝒕</ci></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.3.m3.2c">\bm{S_{t}}=De_{s}\Big{(}\big{[}\bm{s_{t}};En_{s}(\bar{\bm{S_{t}}})\big{]}\Big{)}</annotation></semantics></math>. The parameters of <math id="S4.p9.4.m4.1" class="ltx_math_unparsed" alttext="En_{s}(.)" display="inline"><semantics id="S4.p9.4.m4.1a"><mrow id="S4.p9.4.m4.1b"><mi id="S4.p9.4.m4.1.1">E</mi><msub id="S4.p9.4.m4.1.2"><mi id="S4.p9.4.m4.1.2.2">n</mi><mi id="S4.p9.4.m4.1.2.3">s</mi></msub><mrow id="S4.p9.4.m4.1.3"><mo stretchy="false" id="S4.p9.4.m4.1.3.1">(</mo><mo lspace="0em" rspace="0.167em" id="S4.p9.4.m4.1.3.2">.</mo><mo stretchy="false" id="S4.p9.4.m4.1.3.3">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.p9.4.m4.1c">En_{s}(.)</annotation></semantics></math>, <math id="S4.p9.5.m5.1" class="ltx_Math" alttext="De_{s}()" display="inline"><semantics id="S4.p9.5.m5.1a"><mrow id="S4.p9.5.m5.1.1" xref="S4.p9.5.m5.1.1.cmml"><mi id="S4.p9.5.m5.1.1.2" xref="S4.p9.5.m5.1.1.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.p9.5.m5.1.1.1" xref="S4.p9.5.m5.1.1.1.cmml">​</mo><msub id="S4.p9.5.m5.1.1.3" xref="S4.p9.5.m5.1.1.3.cmml"><mi id="S4.p9.5.m5.1.1.3.2" xref="S4.p9.5.m5.1.1.3.2.cmml">e</mi><mi id="S4.p9.5.m5.1.1.3.3" xref="S4.p9.5.m5.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S4.p9.5.m5.1.1.1a" xref="S4.p9.5.m5.1.1.1.cmml">​</mo><mrow id="S4.p9.5.m5.1.1.4.2" xref="S4.p9.5.m5.1.1.cmml"><mo stretchy="false" id="S4.p9.5.m5.1.1.4.2.1" xref="S4.p9.5.m5.1.1.4.1.cmml">(</mo><mo stretchy="false" id="S4.p9.5.m5.1.1.4.2.2" xref="S4.p9.5.m5.1.1.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.5.m5.1b"><apply id="S4.p9.5.m5.1.1.cmml" xref="S4.p9.5.m5.1.1"><times id="S4.p9.5.m5.1.1.1.cmml" xref="S4.p9.5.m5.1.1.1"></times><ci id="S4.p9.5.m5.1.1.2.cmml" xref="S4.p9.5.m5.1.1.2">𝐷</ci><apply id="S4.p9.5.m5.1.1.3.cmml" xref="S4.p9.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.p9.5.m5.1.1.3.1.cmml" xref="S4.p9.5.m5.1.1.3">subscript</csymbol><ci id="S4.p9.5.m5.1.1.3.2.cmml" xref="S4.p9.5.m5.1.1.3.2">𝑒</ci><ci id="S4.p9.5.m5.1.1.3.3.cmml" xref="S4.p9.5.m5.1.1.3.3">𝑠</ci></apply><list id="S4.p9.5.m5.1.1.4.1.cmml" xref="S4.p9.5.m5.1.1.4.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.5.m5.1c">De_{s}()</annotation></semantics></math>, <math id="S4.p9.6.m6.1" class="ltx_Math" alttext="\bm{w_{s}}" display="inline"><semantics id="S4.p9.6.m6.1a"><msub id="S4.p9.6.m6.1.1" xref="S4.p9.6.m6.1.1.cmml"><mi id="S4.p9.6.m6.1.1.2" xref="S4.p9.6.m6.1.1.2.cmml">𝒘</mi><mi id="S4.p9.6.m6.1.1.3" xref="S4.p9.6.m6.1.1.3.cmml">𝒔</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p9.6.m6.1b"><apply id="S4.p9.6.m6.1.1.cmml" xref="S4.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p9.6.m6.1.1.1.cmml" xref="S4.p9.6.m6.1.1">subscript</csymbol><ci id="S4.p9.6.m6.1.1.2.cmml" xref="S4.p9.6.m6.1.1.2">𝒘</ci><ci id="S4.p9.6.m6.1.1.3.cmml" xref="S4.p9.6.m6.1.1.3">𝒔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.6.m6.1c">\bm{w_{s}}</annotation></semantics></math>, and <math id="S4.p9.7.m7.1" class="ltx_Math" alttext="b_{s}" display="inline"><semantics id="S4.p9.7.m7.1a"><msub id="S4.p9.7.m7.1.1" xref="S4.p9.7.m7.1.1.cmml"><mi id="S4.p9.7.m7.1.1.2" xref="S4.p9.7.m7.1.1.2.cmml">b</mi><mi id="S4.p9.7.m7.1.1.3" xref="S4.p9.7.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p9.7.m7.1b"><apply id="S4.p9.7.m7.1.1.cmml" xref="S4.p9.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p9.7.m7.1.1.1.cmml" xref="S4.p9.7.m7.1.1">subscript</csymbol><ci id="S4.p9.7.m7.1.1.2.cmml" xref="S4.p9.7.m7.1.1.2">𝑏</ci><ci id="S4.p9.7.m7.1.1.3.cmml" xref="S4.p9.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.7.m7.1c">b_{s}</annotation></semantics></math> are shared across multiple iterations.</p>
</div>
<div id="S4.p10" class="ltx_para">
<p id="S4.p10.1" class="ltx_p">In the proposed model, we make the simplifying assumption that the visual representation of the current sentence does not depend on future sentences. In other words, it can be completely determined from the previous sentences in the description. Both FloorPlanQA and ShapeIntersection satisfy this assumption.</p>
</div>
<div id="S4.p11" class="ltx_para ltx_noindent">
<p id="S4.p11.1" class="ltx_p"><span id="S4.p11.1.1" class="ltx_text ltx_font_bold">Spatial Memory Module:</span>
This module gathers relevant information from the description and updates memory accordingly. Similar to DMN+ and MemN2N, it collects information and updates memory multiple times to perform transitive reasoning. One iteration of information collection and memory update is referred as a ‘hop’.</p>
</div>
<div id="S4.p12" class="ltx_para">
<p id="S4.p12.1" class="ltx_p">The memory consists of two components: a 2D spatial memory and a tag vector. The 2D spatial memory can be thought of as a visual scratch pad on which the network ‘sketches’ out the visual information. The tag vector is meant to represent what is ‘sketched’ on the 2D spatial memory. For example, the network can sketch the location of room 1 on its 2D spatial memory, and store the fact that it has sketched room 1 in the tag vector.</p>
</div>
<div id="S4.p13" class="ltx_para">
<p id="S4.p13.8" class="ltx_p">As mentioned earlier, each step of the spatial memory module involves gathering of relevant information and updating of memory. Suppose we are in step <math id="S4.p13.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.p13.1.m1.1a"><mi id="S4.p13.1.m1.1.1" xref="S4.p13.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p13.1.m1.1b"><ci id="S4.p13.1.m1.1.1.cmml" xref="S4.p13.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.1.m1.1c">t</annotation></semantics></math>. Let <math id="S4.p13.2.m2.1" class="ltx_Math" alttext="\bm{M^{(t-1)}}" display="inline"><semantics id="S4.p13.2.m2.1a"><msup id="S4.p13.2.m2.1.2" xref="S4.p13.2.m2.1.2.cmml"><mi id="S4.p13.2.m2.1.2.2" xref="S4.p13.2.m2.1.2.2.cmml">𝑴</mi><mrow id="S4.p13.2.m2.1.1.1.1" xref="S4.p13.2.m2.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.2.m2.1.1.1.1.2" xref="S4.p13.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.p13.2.m2.1.1.1.1.1" xref="S4.p13.2.m2.1.1.1.1.1.cmml"><mi id="S4.p13.2.m2.1.1.1.1.1.2" xref="S4.p13.2.m2.1.1.1.1.1.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.p13.2.m2.1.1.1.1.1.1" xref="S4.p13.2.m2.1.1.1.1.1.1.cmml">−</mo><mn id="S4.p13.2.m2.1.1.1.1.1.3" xref="S4.p13.2.m2.1.1.1.1.1.3.cmml">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.2.m2.1.1.1.1.3" xref="S4.p13.2.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p13.2.m2.1b"><apply id="S4.p13.2.m2.1.2.cmml" xref="S4.p13.2.m2.1.2"><csymbol cd="ambiguous" id="S4.p13.2.m2.1.2.1.cmml" xref="S4.p13.2.m2.1.2">superscript</csymbol><ci id="S4.p13.2.m2.1.2.2.cmml" xref="S4.p13.2.m2.1.2.2">𝑴</ci><apply id="S4.p13.2.m2.1.1.1.1.1.cmml" xref="S4.p13.2.m2.1.1.1.1"><minus id="S4.p13.2.m2.1.1.1.1.1.1.cmml" xref="S4.p13.2.m2.1.1.1.1.1.1"></minus><ci id="S4.p13.2.m2.1.1.1.1.1.2.cmml" xref="S4.p13.2.m2.1.1.1.1.1.2">𝒕</ci><cn type="integer" id="S4.p13.2.m2.1.1.1.1.1.3.cmml" xref="S4.p13.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.2.m2.1c">\bm{M^{(t-1)}}</annotation></semantics></math> represent the 2D spatial memory and <math id="S4.p13.3.m3.1" class="ltx_Math" alttext="\bm{m^{(t-1)}}" display="inline"><semantics id="S4.p13.3.m3.1a"><msup id="S4.p13.3.m3.1.2" xref="S4.p13.3.m3.1.2.cmml"><mi id="S4.p13.3.m3.1.2.2" xref="S4.p13.3.m3.1.2.2.cmml">𝒎</mi><mrow id="S4.p13.3.m3.1.1.1.1" xref="S4.p13.3.m3.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.3.m3.1.1.1.1.2" xref="S4.p13.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.p13.3.m3.1.1.1.1.1" xref="S4.p13.3.m3.1.1.1.1.1.cmml"><mi id="S4.p13.3.m3.1.1.1.1.1.2" xref="S4.p13.3.m3.1.1.1.1.1.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.p13.3.m3.1.1.1.1.1.1" xref="S4.p13.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S4.p13.3.m3.1.1.1.1.1.3" xref="S4.p13.3.m3.1.1.1.1.1.3.cmml">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.3.m3.1.1.1.1.3" xref="S4.p13.3.m3.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p13.3.m3.1b"><apply id="S4.p13.3.m3.1.2.cmml" xref="S4.p13.3.m3.1.2"><csymbol cd="ambiguous" id="S4.p13.3.m3.1.2.1.cmml" xref="S4.p13.3.m3.1.2">superscript</csymbol><ci id="S4.p13.3.m3.1.2.2.cmml" xref="S4.p13.3.m3.1.2.2">𝒎</ci><apply id="S4.p13.3.m3.1.1.1.1.1.cmml" xref="S4.p13.3.m3.1.1.1.1"><minus id="S4.p13.3.m3.1.1.1.1.1.1.cmml" xref="S4.p13.3.m3.1.1.1.1.1.1"></minus><ci id="S4.p13.3.m3.1.1.1.1.1.2.cmml" xref="S4.p13.3.m3.1.1.1.1.1.2">𝒕</ci><cn type="integer" id="S4.p13.3.m3.1.1.1.1.1.3.cmml" xref="S4.p13.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.3.m3.1c">\bm{m^{(t-1)}}</annotation></semantics></math> represent the tag vector after step <math id="S4.p13.4.m4.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="S4.p13.4.m4.1a"><mrow id="S4.p13.4.m4.1.1" xref="S4.p13.4.m4.1.1.cmml"><mi id="S4.p13.4.m4.1.1.2" xref="S4.p13.4.m4.1.1.2.cmml">t</mi><mo id="S4.p13.4.m4.1.1.1" xref="S4.p13.4.m4.1.1.1.cmml">−</mo><mn id="S4.p13.4.m4.1.1.3" xref="S4.p13.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p13.4.m4.1b"><apply id="S4.p13.4.m4.1.1.cmml" xref="S4.p13.4.m4.1.1"><minus id="S4.p13.4.m4.1.1.1.cmml" xref="S4.p13.4.m4.1.1.1"></minus><ci id="S4.p13.4.m4.1.1.2.cmml" xref="S4.p13.4.m4.1.1.2">𝑡</ci><cn type="integer" id="S4.p13.4.m4.1.1.3.cmml" xref="S4.p13.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.4.m4.1c">t-1</annotation></semantics></math>. The network gathers the relevant information by calculating the attention value for each sentence based on the question and the current memory. For sentence <math id="S4.p13.5.m5.1" class="ltx_Math" alttext="\bm{s_{i}}" display="inline"><semantics id="S4.p13.5.m5.1a"><msub id="S4.p13.5.m5.1.1" xref="S4.p13.5.m5.1.1.cmml"><mi id="S4.p13.5.m5.1.1.2" xref="S4.p13.5.m5.1.1.2.cmml">𝒔</mi><mi id="S4.p13.5.m5.1.1.3" xref="S4.p13.5.m5.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p13.5.m5.1b"><apply id="S4.p13.5.m5.1.1.cmml" xref="S4.p13.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p13.5.m5.1.1.1.cmml" xref="S4.p13.5.m5.1.1">subscript</csymbol><ci id="S4.p13.5.m5.1.1.2.cmml" xref="S4.p13.5.m5.1.1.2">𝒔</ci><ci id="S4.p13.5.m5.1.1.3.cmml" xref="S4.p13.5.m5.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.5.m5.1c">\bm{s_{i}}</annotation></semantics></math>, the scalar attention value <math id="S4.p13.6.m6.1" class="ltx_Math" alttext="g_{i}^{(t)}" display="inline"><semantics id="S4.p13.6.m6.1a"><msubsup id="S4.p13.6.m6.1.2" xref="S4.p13.6.m6.1.2.cmml"><mi id="S4.p13.6.m6.1.2.2.2" xref="S4.p13.6.m6.1.2.2.2.cmml">g</mi><mi id="S4.p13.6.m6.1.2.2.3" xref="S4.p13.6.m6.1.2.2.3.cmml">i</mi><mrow id="S4.p13.6.m6.1.1.1.3" xref="S4.p13.6.m6.1.2.cmml"><mo stretchy="false" id="S4.p13.6.m6.1.1.1.3.1" xref="S4.p13.6.m6.1.2.cmml">(</mo><mi id="S4.p13.6.m6.1.1.1.1" xref="S4.p13.6.m6.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.p13.6.m6.1.1.1.3.2" xref="S4.p13.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.p13.6.m6.1b"><apply id="S4.p13.6.m6.1.2.cmml" xref="S4.p13.6.m6.1.2"><csymbol cd="ambiguous" id="S4.p13.6.m6.1.2.1.cmml" xref="S4.p13.6.m6.1.2">superscript</csymbol><apply id="S4.p13.6.m6.1.2.2.cmml" xref="S4.p13.6.m6.1.2"><csymbol cd="ambiguous" id="S4.p13.6.m6.1.2.2.1.cmml" xref="S4.p13.6.m6.1.2">subscript</csymbol><ci id="S4.p13.6.m6.1.2.2.2.cmml" xref="S4.p13.6.m6.1.2.2.2">𝑔</ci><ci id="S4.p13.6.m6.1.2.2.3.cmml" xref="S4.p13.6.m6.1.2.2.3">𝑖</ci></apply><ci id="S4.p13.6.m6.1.1.1.1.cmml" xref="S4.p13.6.m6.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.6.m6.1c">g_{i}^{(t)}</annotation></semantics></math> equal to <math id="S4.p13.7.m7.2" class="ltx_Math" alttext="\text{Softmax}(\bm{w_{y}}^{t}\bm{p_{i}^{(t)}}+b_{y})" display="inline"><semantics id="S4.p13.7.m7.2a"><mrow id="S4.p13.7.m7.2.2" xref="S4.p13.7.m7.2.2.cmml"><mtext id="S4.p13.7.m7.2.2.3" xref="S4.p13.7.m7.2.2.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="S4.p13.7.m7.2.2.2" xref="S4.p13.7.m7.2.2.2.cmml">​</mo><mrow id="S4.p13.7.m7.2.2.1.1" xref="S4.p13.7.m7.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p13.7.m7.2.2.1.1.2" xref="S4.p13.7.m7.2.2.1.1.1.cmml">(</mo><mrow id="S4.p13.7.m7.2.2.1.1.1" xref="S4.p13.7.m7.2.2.1.1.1.cmml"><mrow id="S4.p13.7.m7.2.2.1.1.1.2" xref="S4.p13.7.m7.2.2.1.1.1.2.cmml"><mmultiscripts id="S4.p13.7.m7.2.2.1.1.1.2.2" xref="S4.p13.7.m7.2.2.1.1.1.2.2.cmml"><mi id="S4.p13.7.m7.2.2.1.1.1.2.2.2.2" xref="S4.p13.7.m7.2.2.1.1.1.2.2.2.2.cmml">𝒘</mi><mi id="S4.p13.7.m7.2.2.1.1.1.2.2.2.3" xref="S4.p13.7.m7.2.2.1.1.1.2.2.2.3.cmml">𝒚</mi><mrow id="S4.p13.7.m7.2.2.1.1.1.2.2a" xref="S4.p13.7.m7.2.2.1.1.1.2.2.cmml"></mrow><mrow id="S4.p13.7.m7.2.2.1.1.1.2.2b" xref="S4.p13.7.m7.2.2.1.1.1.2.2.cmml"></mrow><mi id="S4.p13.7.m7.2.2.1.1.1.2.2.3" xref="S4.p13.7.m7.2.2.1.1.1.2.2.3.cmml">t</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.p13.7.m7.2.2.1.1.1.2.1" xref="S4.p13.7.m7.2.2.1.1.1.2.1.cmml">​</mo><msubsup id="S4.p13.7.m7.2.2.1.1.1.2.3" xref="S4.p13.7.m7.2.2.1.1.1.2.3.cmml"><mi id="S4.p13.7.m7.2.2.1.1.1.2.3.2.2" xref="S4.p13.7.m7.2.2.1.1.1.2.3.2.2.cmml">𝒑</mi><mi id="S4.p13.7.m7.2.2.1.1.1.2.3.2.3" xref="S4.p13.7.m7.2.2.1.1.1.2.3.2.3.cmml">𝒊</mi><mrow id="S4.p13.7.m7.1.1.1.3" xref="S4.p13.7.m7.2.2.1.1.1.2.3.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.7.m7.1.1.1.3.1" xref="S4.p13.7.m7.2.2.1.1.1.2.3.cmml">(</mo><mi id="S4.p13.7.m7.1.1.1.1" xref="S4.p13.7.m7.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.7.m7.1.1.1.3.2" xref="S4.p13.7.m7.2.2.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.p13.7.m7.2.2.1.1.1.1" xref="S4.p13.7.m7.2.2.1.1.1.1.cmml">+</mo><msub id="S4.p13.7.m7.2.2.1.1.1.3" xref="S4.p13.7.m7.2.2.1.1.1.3.cmml"><mi id="S4.p13.7.m7.2.2.1.1.1.3.2" xref="S4.p13.7.m7.2.2.1.1.1.3.2.cmml">b</mi><mi id="S4.p13.7.m7.2.2.1.1.1.3.3" xref="S4.p13.7.m7.2.2.1.1.1.3.3.cmml">y</mi></msub></mrow><mo stretchy="false" id="S4.p13.7.m7.2.2.1.1.3" xref="S4.p13.7.m7.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p13.7.m7.2b"><apply id="S4.p13.7.m7.2.2.cmml" xref="S4.p13.7.m7.2.2"><times id="S4.p13.7.m7.2.2.2.cmml" xref="S4.p13.7.m7.2.2.2"></times><ci id="S4.p13.7.m7.2.2.3a.cmml" xref="S4.p13.7.m7.2.2.3"><mtext id="S4.p13.7.m7.2.2.3.cmml" xref="S4.p13.7.m7.2.2.3">Softmax</mtext></ci><apply id="S4.p13.7.m7.2.2.1.1.1.cmml" xref="S4.p13.7.m7.2.2.1.1"><plus id="S4.p13.7.m7.2.2.1.1.1.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.1"></plus><apply id="S4.p13.7.m7.2.2.1.1.1.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2"><times id="S4.p13.7.m7.2.2.1.1.1.2.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.1"></times><apply id="S4.p13.7.m7.2.2.1.1.1.2.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p13.7.m7.2.2.1.1.1.2.2.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2">superscript</csymbol><apply id="S4.p13.7.m7.2.2.1.1.1.2.2.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.p13.7.m7.2.2.1.1.1.2.2.2.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2">subscript</csymbol><ci id="S4.p13.7.m7.2.2.1.1.1.2.2.2.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2.2.2">𝒘</ci><ci id="S4.p13.7.m7.2.2.1.1.1.2.2.2.3.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2.2.3">𝒚</ci></apply><ci id="S4.p13.7.m7.2.2.1.1.1.2.2.3.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.2.3">𝑡</ci></apply><apply id="S4.p13.7.m7.2.2.1.1.1.2.3.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.p13.7.m7.2.2.1.1.1.2.3.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.3">superscript</csymbol><apply id="S4.p13.7.m7.2.2.1.1.1.2.3.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.p13.7.m7.2.2.1.1.1.2.3.2.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.p13.7.m7.2.2.1.1.1.2.3.2.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.3.2.2">𝒑</ci><ci id="S4.p13.7.m7.2.2.1.1.1.2.3.2.3.cmml" xref="S4.p13.7.m7.2.2.1.1.1.2.3.2.3">𝒊</ci></apply><ci id="S4.p13.7.m7.1.1.1.1.cmml" xref="S4.p13.7.m7.1.1.1.1">𝒕</ci></apply></apply><apply id="S4.p13.7.m7.2.2.1.1.1.3.cmml" xref="S4.p13.7.m7.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.p13.7.m7.2.2.1.1.1.3.1.cmml" xref="S4.p13.7.m7.2.2.1.1.1.3">subscript</csymbol><ci id="S4.p13.7.m7.2.2.1.1.1.3.2.cmml" xref="S4.p13.7.m7.2.2.1.1.1.3.2">𝑏</ci><ci id="S4.p13.7.m7.2.2.1.1.1.3.3.cmml" xref="S4.p13.7.m7.2.2.1.1.1.3.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.7.m7.2c">\text{Softmax}(\bm{w_{y}}^{t}\bm{p_{i}^{(t)}}+b_{y})</annotation></semantics></math>, where <math id="S4.p13.8.m8.1" class="ltx_Math" alttext="\bm{p_{i}^{(t)}}" display="inline"><semantics id="S4.p13.8.m8.1a"><msubsup id="S4.p13.8.m8.1.2" xref="S4.p13.8.m8.1.2.cmml"><mi id="S4.p13.8.m8.1.2.2.2" xref="S4.p13.8.m8.1.2.2.2.cmml">𝒑</mi><mi id="S4.p13.8.m8.1.2.2.3" xref="S4.p13.8.m8.1.2.2.3.cmml">𝒊</mi><mrow id="S4.p13.8.m8.1.1.1.3" xref="S4.p13.8.m8.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.8.m8.1.1.1.3.1" xref="S4.p13.8.m8.1.2.cmml">(</mo><mi id="S4.p13.8.m8.1.1.1.1" xref="S4.p13.8.m8.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.8.m8.1.1.1.3.2" xref="S4.p13.8.m8.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.p13.8.m8.1b"><apply id="S4.p13.8.m8.1.2.cmml" xref="S4.p13.8.m8.1.2"><csymbol cd="ambiguous" id="S4.p13.8.m8.1.2.1.cmml" xref="S4.p13.8.m8.1.2">superscript</csymbol><apply id="S4.p13.8.m8.1.2.2.cmml" xref="S4.p13.8.m8.1.2"><csymbol cd="ambiguous" id="S4.p13.8.m8.1.2.2.1.cmml" xref="S4.p13.8.m8.1.2">subscript</csymbol><ci id="S4.p13.8.m8.1.2.2.2.cmml" xref="S4.p13.8.m8.1.2.2.2">𝒑</ci><ci id="S4.p13.8.m8.1.2.2.3.cmml" xref="S4.p13.8.m8.1.2.2.3">𝒊</ci></apply><ci id="S4.p13.8.m8.1.1.1.1.cmml" xref="S4.p13.8.m8.1.1.1.1">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.8.m8.1c">\bm{p_{i}^{(t)}}</annotation></semantics></math> is given as</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{p_{i}^{(t)}}" display="inline"><semantics id="S4.Ex1.m1.1a"><msubsup id="S4.Ex1.m1.1.2" xref="S4.Ex1.m1.1.2.cmml"><mi id="S4.Ex1.m1.1.2.2.2" xref="S4.Ex1.m1.1.2.2.2.cmml">𝒑</mi><mi id="S4.Ex1.m1.1.2.2.3" xref="S4.Ex1.m1.1.2.2.3.cmml">𝒊</mi><mrow id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex1.m1.1.1.1.3.1" xref="S4.Ex1.m1.1.2.cmml">(</mo><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex1.m1.1.1.1.3.2" xref="S4.Ex1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.1b"><apply id="S4.Ex1.m1.1.2.cmml" xref="S4.Ex1.m1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.2.1.cmml" xref="S4.Ex1.m1.1.2">superscript</csymbol><apply id="S4.Ex1.m1.1.2.2.cmml" xref="S4.Ex1.m1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.2.2.1.cmml" xref="S4.Ex1.m1.1.2">subscript</csymbol><ci id="S4.Ex1.m1.1.2.2.2.cmml" xref="S4.Ex1.m1.1.2.2.2">𝒑</ci><ci id="S4.Ex1.m1.1.2.2.3.cmml" xref="S4.Ex1.m1.1.2.2.3">𝒊</ci></apply><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.1c">\displaystyle\bm{p_{i}^{(t)}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex1.m2.2" class="ltx_math_unparsed" alttext="\displaystyle=\big{[}|\bm{m^{(t-1)}}-\bm{s_{i}}|;\ \bm{m^{(t-1)}}\circ\bm{s_{i}};\ |\bm{q}-\bm{s_{i}}|;" display="inline"><semantics id="S4.Ex1.m2.2a"><mrow id="S4.Ex1.m2.2b"><mo id="S4.Ex1.m2.2.3">=</mo><mrow id="S4.Ex1.m2.2.4"><mo maxsize="120%" minsize="120%" id="S4.Ex1.m2.2.4.1">[</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m2.2.4.2">|</mo><msup id="S4.Ex1.m2.2.4.3"><mi id="S4.Ex1.m2.2.4.3.2">𝒎</mi><mrow id="S4.Ex1.m2.1.1.1.1"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex1.m2.1.1.1.1.2">(</mo><mrow id="S4.Ex1.m2.1.1.1.1.1"><mi id="S4.Ex1.m2.1.1.1.1.1.2">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.Ex1.m2.1.1.1.1.1.1">−</mo><mn id="S4.Ex1.m2.1.1.1.1.1.3">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex1.m2.1.1.1.1.3">)</mo></mrow></msup><mo id="S4.Ex1.m2.2.4.4">−</mo><msub id="S4.Ex1.m2.2.4.5"><mi id="S4.Ex1.m2.2.4.5.2">𝒔</mi><mi id="S4.Ex1.m2.2.4.5.3">𝒊</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m2.2.4.6">|</mo><mo rspace="0.667em" id="S4.Ex1.m2.2.4.7">;</mo><msup id="S4.Ex1.m2.2.4.8"><mi id="S4.Ex1.m2.2.4.8.2">𝒎</mi><mrow id="S4.Ex1.m2.2.2.1.1"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex1.m2.2.2.1.1.2">(</mo><mrow id="S4.Ex1.m2.2.2.1.1.1"><mi id="S4.Ex1.m2.2.2.1.1.1.2">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.Ex1.m2.2.2.1.1.1.1">−</mo><mn id="S4.Ex1.m2.2.2.1.1.1.3">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex1.m2.2.2.1.1.3">)</mo></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m2.2.4.9">∘</mo><msub id="S4.Ex1.m2.2.4.10"><mi id="S4.Ex1.m2.2.4.10.2">𝒔</mi><mi id="S4.Ex1.m2.2.4.10.3">𝒊</mi></msub><mo rspace="0.667em" id="S4.Ex1.m2.2.4.11">;</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m2.2.4.12">|</mo><mi id="S4.Ex1.m2.2.4.13">𝒒</mi><mo id="S4.Ex1.m2.2.4.14">−</mo><msub id="S4.Ex1.m2.2.4.15"><mi id="S4.Ex1.m2.2.4.15.2">𝒔</mi><mi id="S4.Ex1.m2.2.4.15.3">𝒊</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="S4.Ex1.m2.2.4.16">|</mo><mo id="S4.Ex1.m2.2.4.17">;</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex1.m2.2c">\displaystyle=\big{[}|\bm{m^{(t-1)}}-\bm{s_{i}}|;\ \bm{m^{(t-1)}}\circ\bm{s_{i}};\ |\bm{q}-\bm{s_{i}}|;</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex2.m1.3" class="ltx_Math" alttext="\displaystyle\bm{q}\circ\bm{s_{i}};\ {En}_{p_{1}}^{(t)}(|\bm{M^{(t-1)}}-\bm{S_{i}}|);" display="inline"><semantics id="S4.Ex2.m1.3a"><mrow id="S4.Ex2.m1.3.3.1"><mrow id="S4.Ex2.m1.3.3.1.1.2" xref="S4.Ex2.m1.3.3.1.1.3.cmml"><mrow id="S4.Ex2.m1.3.3.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.cmml"><mi id="S4.Ex2.m1.3.3.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.1.1.2.cmml">𝒒</mi><mo lspace="0.222em" rspace="0.222em" id="S4.Ex2.m1.3.3.1.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.1.cmml">∘</mo><msub id="S4.Ex2.m1.3.3.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.Ex2.m1.3.3.1.1.1.1.3.2" xref="S4.Ex2.m1.3.3.1.1.1.1.3.2.cmml">𝒔</mi><mi id="S4.Ex2.m1.3.3.1.1.1.1.3.3" xref="S4.Ex2.m1.3.3.1.1.1.1.3.3.cmml">𝒊</mi></msub></mrow><mo rspace="0.667em" id="S4.Ex2.m1.3.3.1.1.2.3" xref="S4.Ex2.m1.3.3.1.1.3.cmml">;</mo><mrow id="S4.Ex2.m1.3.3.1.1.2.2" xref="S4.Ex2.m1.3.3.1.1.2.2.cmml"><mi id="S4.Ex2.m1.3.3.1.1.2.2.3" xref="S4.Ex2.m1.3.3.1.1.2.2.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.3.3.1.1.2.2.2" xref="S4.Ex2.m1.3.3.1.1.2.2.2.cmml">​</mo><msubsup id="S4.Ex2.m1.3.3.1.1.2.2.4" xref="S4.Ex2.m1.3.3.1.1.2.2.4.cmml"><mi id="S4.Ex2.m1.3.3.1.1.2.2.4.2.2" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.2.cmml">n</mi><msub id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.cmml"><mi id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.2" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.2.cmml">p</mi><mn id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.3" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.3.cmml">1</mn></msub><mrow id="S4.Ex2.m1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.2.2.4.cmml"><mo stretchy="false" id="S4.Ex2.m1.1.1.1.3.1" xref="S4.Ex2.m1.3.3.1.1.2.2.4.cmml">(</mo><mi id="S4.Ex2.m1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.Ex2.m1.1.1.1.3.2" xref="S4.Ex2.m1.3.3.1.1.2.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.Ex2.m1.3.3.1.1.2.2.2a" xref="S4.Ex2.m1.3.3.1.1.2.2.2.cmml">​</mo><mrow id="S4.Ex2.m1.3.3.1.1.2.2.1.1" xref="S4.Ex2.m1.3.3.1.1.2.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.2.2.1.1.2" xref="S4.Ex2.m1.3.3.1.1.2.2.cmml">(</mo><mrow id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.2.1.cmml">|</mo><mrow id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.cmml"><msup id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml"><mi id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.2" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.cmml">𝑴</mi><mrow id="S4.Ex2.m1.2.2.1.1" xref="S4.Ex2.m1.2.2.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex2.m1.2.2.1.1.2" xref="S4.Ex2.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.Ex2.m1.2.2.1.1.1" xref="S4.Ex2.m1.2.2.1.1.1.cmml"><mi id="S4.Ex2.m1.2.2.1.1.1.2" xref="S4.Ex2.m1.2.2.1.1.1.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.Ex2.m1.2.2.1.1.1.1" xref="S4.Ex2.m1.2.2.1.1.1.1.cmml">−</mo><mn id="S4.Ex2.m1.2.2.1.1.1.3" xref="S4.Ex2.m1.2.2.1.1.1.3.cmml">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex2.m1.2.2.1.1.3" xref="S4.Ex2.m1.2.2.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml"><mi id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.2" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.cmml">𝑺</mi><mi id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.3" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.3.cmml">𝒊</mi></msub></mrow><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.2.1.cmml">|</mo></mrow><mo stretchy="false" id="S4.Ex2.m1.3.3.1.1.2.2.1.1.3" xref="S4.Ex2.m1.3.3.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex2.m1.3.3.1.2">;</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.3b"><list id="S4.Ex2.m1.3.3.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2"><apply id="S4.Ex2.m1.3.3.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1"><compose id="S4.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1"></compose><ci id="S4.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.2">𝒒</ci><apply id="S4.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.3.2">𝒔</ci><ci id="S4.Ex2.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.3.3">𝒊</ci></apply></apply><apply id="S4.Ex2.m1.3.3.1.1.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2"><times id="S4.Ex2.m1.3.3.1.1.2.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.2"></times><ci id="S4.Ex2.m1.3.3.1.1.2.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.3">𝐸</ci><apply id="S4.Ex2.m1.3.3.1.1.2.2.4.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.2.4.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4">superscript</csymbol><apply id="S4.Ex2.m1.3.3.1.1.2.2.4.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.2.4.2.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4">subscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.2.2.4.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.2">𝑛</ci><apply id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3">subscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.2">𝑝</ci><cn type="integer" id="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.4.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m1.1.1.1.1.cmml" xref="S4.Ex2.m1.1.1.1.1">𝑡</ci></apply><apply id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1"><abs id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.2.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.2"></abs><apply id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1"><minus id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.1"></minus><apply id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.2.2">𝑴</ci><apply id="S4.Ex2.m1.2.2.1.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1"><minus id="S4.Ex2.m1.2.2.1.1.1.1.cmml" xref="S4.Ex2.m1.2.2.1.1.1.1"></minus><ci id="S4.Ex2.m1.2.2.1.1.1.2.cmml" xref="S4.Ex2.m1.2.2.1.1.1.2">𝒕</ci><cn type="integer" id="S4.Ex2.m1.2.2.1.1.1.3.cmml" xref="S4.Ex2.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.2">𝑺</ci><ci id="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S4.Ex2.m1.3.3.1.1.2.2.1.1.1.1.1.3.3">𝒊</ci></apply></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.3c">\displaystyle\bm{q}\circ\bm{s_{i}};\ {En}_{p_{1}}^{(t)}(|\bm{M^{(t-1)}}-\bm{S_{i}}|);</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E1.m1.2" class="ltx_math_unparsed" alttext="\displaystyle{En}_{p_{2}}^{(t)}(\bm{M^{(t-1)}}\circ\bm{S_{i}})\big{]}" display="inline"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2b"><mi id="S4.E1.m1.2.3">E</mi><msubsup id="S4.E1.m1.2.4"><mi id="S4.E1.m1.2.4.2.2">n</mi><msub id="S4.E1.m1.2.4.2.3"><mi id="S4.E1.m1.2.4.2.3.2">p</mi><mn id="S4.E1.m1.2.4.2.3.3">2</mn></msub><mrow id="S4.E1.m1.1.1.1.3"><mo stretchy="false" id="S4.E1.m1.1.1.1.3.1">(</mo><mi id="S4.E1.m1.1.1.1.1">t</mi><mo stretchy="false" id="S4.E1.m1.1.1.1.3.2">)</mo></mrow></msubsup><mrow id="S4.E1.m1.2.5"><mo stretchy="false" id="S4.E1.m1.2.5.1">(</mo><msup id="S4.E1.m1.2.5.2"><mi id="S4.E1.m1.2.5.2.2">𝑴</mi><mrow id="S4.E1.m1.2.2.1.1"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E1.m1.2.2.1.1.2">(</mo><mrow id="S4.E1.m1.2.2.1.1.1"><mi id="S4.E1.m1.2.2.1.1.1.2">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.E1.m1.2.2.1.1.1.1">−</mo><mn id="S4.E1.m1.2.2.1.1.1.3">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E1.m1.2.2.1.1.3">)</mo></mrow></msup><mo lspace="0.222em" rspace="0.222em" id="S4.E1.m1.2.5.3">∘</mo><msub id="S4.E1.m1.2.5.4"><mi id="S4.E1.m1.2.5.4.2">𝑺</mi><mi id="S4.E1.m1.2.5.4.3">𝒊</mi></msub><mo stretchy="false" id="S4.E1.m1.2.5.5">)</mo></mrow><mo maxsize="120%" minsize="120%" id="S4.E1.m1.2.6">]</mo></mrow><annotation encoding="application/x-tex" id="S4.E1.m1.2c">\displaystyle{En}_{p_{2}}^{(t)}(\bm{M^{(t-1)}}\circ\bm{S_{i}})\big{]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.p13.12" class="ltx_p"><math id="S4.p13.9.m1.1" class="ltx_Math" alttext="\bm{M^{(0)}}" display="inline"><semantics id="S4.p13.9.m1.1a"><msup id="S4.p13.9.m1.1.2" xref="S4.p13.9.m1.1.2.cmml"><mi id="S4.p13.9.m1.1.2.2" xref="S4.p13.9.m1.1.2.2.cmml">𝑴</mi><mrow id="S4.p13.9.m1.1.1.1.3" xref="S4.p13.9.m1.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.9.m1.1.1.1.3.1" xref="S4.p13.9.m1.1.2.cmml">(</mo><mn id="S4.p13.9.m1.1.1.1.1" xref="S4.p13.9.m1.1.1.1.1.cmml">𝟎</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.9.m1.1.1.1.3.2" xref="S4.p13.9.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p13.9.m1.1b"><apply id="S4.p13.9.m1.1.2.cmml" xref="S4.p13.9.m1.1.2"><csymbol cd="ambiguous" id="S4.p13.9.m1.1.2.1.cmml" xref="S4.p13.9.m1.1.2">superscript</csymbol><ci id="S4.p13.9.m1.1.2.2.cmml" xref="S4.p13.9.m1.1.2.2">𝑴</ci><cn type="integer" id="S4.p13.9.m1.1.1.1.1.cmml" xref="S4.p13.9.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.9.m1.1c">\bm{M^{(0)}}</annotation></semantics></math> and <math id="S4.p13.10.m2.1" class="ltx_Math" alttext="\bm{m^{(0)}}" display="inline"><semantics id="S4.p13.10.m2.1a"><msup id="S4.p13.10.m2.1.2" xref="S4.p13.10.m2.1.2.cmml"><mi id="S4.p13.10.m2.1.2.2" xref="S4.p13.10.m2.1.2.2.cmml">𝒎</mi><mrow id="S4.p13.10.m2.1.1.1.3" xref="S4.p13.10.m2.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.10.m2.1.1.1.3.1" xref="S4.p13.10.m2.1.2.cmml">(</mo><mn id="S4.p13.10.m2.1.1.1.1" xref="S4.p13.10.m2.1.1.1.1.cmml">𝟎</mn><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.10.m2.1.1.1.3.2" xref="S4.p13.10.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p13.10.m2.1b"><apply id="S4.p13.10.m2.1.2.cmml" xref="S4.p13.10.m2.1.2"><csymbol cd="ambiguous" id="S4.p13.10.m2.1.2.1.cmml" xref="S4.p13.10.m2.1.2">superscript</csymbol><ci id="S4.p13.10.m2.1.2.2.cmml" xref="S4.p13.10.m2.1.2.2">𝒎</ci><cn type="integer" id="S4.p13.10.m2.1.1.1.1.cmml" xref="S4.p13.10.m2.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.10.m2.1c">\bm{m^{(0)}}</annotation></semantics></math> represent initial blank memory, and their elements are all zero. Then, gathered information is represented as a context tag vector, <math id="S4.p13.11.m3.3" class="ltx_Math" alttext="\bm{c^{(t)}}=\text{AttGRU}({g_{i}}^{(t)}\bm{s_{i}})" display="inline"><semantics id="S4.p13.11.m3.3a"><mrow id="S4.p13.11.m3.3.3" xref="S4.p13.11.m3.3.3.cmml"><msup id="S4.p13.11.m3.3.3.3" xref="S4.p13.11.m3.3.3.3.cmml"><mi id="S4.p13.11.m3.3.3.3.2" xref="S4.p13.11.m3.3.3.3.2.cmml">𝒄</mi><mrow id="S4.p13.11.m3.1.1.1.3" xref="S4.p13.11.m3.3.3.3.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.11.m3.1.1.1.3.1" xref="S4.p13.11.m3.3.3.3.cmml">(</mo><mi id="S4.p13.11.m3.1.1.1.1" xref="S4.p13.11.m3.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.11.m3.1.1.1.3.2" xref="S4.p13.11.m3.3.3.3.cmml">)</mo></mrow></msup><mo id="S4.p13.11.m3.3.3.2" xref="S4.p13.11.m3.3.3.2.cmml">=</mo><mrow id="S4.p13.11.m3.3.3.1" xref="S4.p13.11.m3.3.3.1.cmml"><mtext id="S4.p13.11.m3.3.3.1.3" xref="S4.p13.11.m3.3.3.1.3a.cmml">AttGRU</mtext><mo lspace="0em" rspace="0em" id="S4.p13.11.m3.3.3.1.2" xref="S4.p13.11.m3.3.3.1.2.cmml">​</mo><mrow id="S4.p13.11.m3.3.3.1.1.1" xref="S4.p13.11.m3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.p13.11.m3.3.3.1.1.1.2" xref="S4.p13.11.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.p13.11.m3.3.3.1.1.1.1" xref="S4.p13.11.m3.3.3.1.1.1.1.cmml"><mmultiscripts id="S4.p13.11.m3.3.3.1.1.1.1.2" xref="S4.p13.11.m3.3.3.1.1.1.1.2.cmml"><mi id="S4.p13.11.m3.3.3.1.1.1.1.2.2.2" xref="S4.p13.11.m3.3.3.1.1.1.1.2.2.2.cmml">g</mi><mi id="S4.p13.11.m3.3.3.1.1.1.1.2.2.3" xref="S4.p13.11.m3.3.3.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S4.p13.11.m3.3.3.1.1.1.1.2a" xref="S4.p13.11.m3.3.3.1.1.1.1.2.cmml"></mrow><mrow id="S4.p13.11.m3.3.3.1.1.1.1.2b" xref="S4.p13.11.m3.3.3.1.1.1.1.2.cmml"></mrow><mrow id="S4.p13.11.m3.2.2.1.3" xref="S4.p13.11.m3.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.p13.11.m3.2.2.1.3.1" xref="S4.p13.11.m3.3.3.1.1.1.1.2.cmml">(</mo><mi id="S4.p13.11.m3.2.2.1.1" xref="S4.p13.11.m3.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.p13.11.m3.2.2.1.3.2" xref="S4.p13.11.m3.3.3.1.1.1.1.2.cmml">)</mo></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.p13.11.m3.3.3.1.1.1.1.1" xref="S4.p13.11.m3.3.3.1.1.1.1.1.cmml">​</mo><msub id="S4.p13.11.m3.3.3.1.1.1.1.3" xref="S4.p13.11.m3.3.3.1.1.1.1.3.cmml"><mi id="S4.p13.11.m3.3.3.1.1.1.1.3.2" xref="S4.p13.11.m3.3.3.1.1.1.1.3.2.cmml">𝒔</mi><mi id="S4.p13.11.m3.3.3.1.1.1.1.3.3" xref="S4.p13.11.m3.3.3.1.1.1.1.3.3.cmml">𝒊</mi></msub></mrow><mo stretchy="false" id="S4.p13.11.m3.3.3.1.1.1.3" xref="S4.p13.11.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p13.11.m3.3b"><apply id="S4.p13.11.m3.3.3.cmml" xref="S4.p13.11.m3.3.3"><eq id="S4.p13.11.m3.3.3.2.cmml" xref="S4.p13.11.m3.3.3.2"></eq><apply id="S4.p13.11.m3.3.3.3.cmml" xref="S4.p13.11.m3.3.3.3"><csymbol cd="ambiguous" id="S4.p13.11.m3.3.3.3.1.cmml" xref="S4.p13.11.m3.3.3.3">superscript</csymbol><ci id="S4.p13.11.m3.3.3.3.2.cmml" xref="S4.p13.11.m3.3.3.3.2">𝒄</ci><ci id="S4.p13.11.m3.1.1.1.1.cmml" xref="S4.p13.11.m3.1.1.1.1">𝒕</ci></apply><apply id="S4.p13.11.m3.3.3.1.cmml" xref="S4.p13.11.m3.3.3.1"><times id="S4.p13.11.m3.3.3.1.2.cmml" xref="S4.p13.11.m3.3.3.1.2"></times><ci id="S4.p13.11.m3.3.3.1.3a.cmml" xref="S4.p13.11.m3.3.3.1.3"><mtext id="S4.p13.11.m3.3.3.1.3.cmml" xref="S4.p13.11.m3.3.3.1.3">AttGRU</mtext></ci><apply id="S4.p13.11.m3.3.3.1.1.1.1.cmml" xref="S4.p13.11.m3.3.3.1.1.1"><times id="S4.p13.11.m3.3.3.1.1.1.1.1.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.1"></times><apply id="S4.p13.11.m3.3.3.1.1.1.1.2.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p13.11.m3.3.3.1.1.1.1.2.1.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.2">superscript</csymbol><apply id="S4.p13.11.m3.3.3.1.1.1.1.2.2.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.p13.11.m3.3.3.1.1.1.1.2.2.1.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.p13.11.m3.3.3.1.1.1.1.2.2.2.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.2.2.2">𝑔</ci><ci id="S4.p13.11.m3.3.3.1.1.1.1.2.2.3.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S4.p13.11.m3.2.2.1.1.cmml" xref="S4.p13.11.m3.2.2.1.1">𝑡</ci></apply><apply id="S4.p13.11.m3.3.3.1.1.1.1.3.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.p13.11.m3.3.3.1.1.1.1.3.1.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.p13.11.m3.3.3.1.1.1.1.3.2.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.3.2">𝒔</ci><ci id="S4.p13.11.m3.3.3.1.1.1.1.3.3.cmml" xref="S4.p13.11.m3.3.3.1.1.1.1.3.3">𝒊</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.11.m3.3c">\bm{c^{(t)}}=\text{AttGRU}({g_{i}}^{(t)}\bm{s_{i}})</annotation></semantics></math> and 2D context, <math id="S4.p13.12.m4.2" class="ltx_Math" alttext="\bm{C^{(t)}}=\sum_{i=0}^{n}{g_{i}}^{(t)}\bm{S_{i}}" display="inline"><semantics id="S4.p13.12.m4.2a"><mrow id="S4.p13.12.m4.2.3" xref="S4.p13.12.m4.2.3.cmml"><msup id="S4.p13.12.m4.2.3.2" xref="S4.p13.12.m4.2.3.2.cmml"><mi id="S4.p13.12.m4.2.3.2.2" xref="S4.p13.12.m4.2.3.2.2.cmml">𝑪</mi><mrow id="S4.p13.12.m4.1.1.1.3" xref="S4.p13.12.m4.2.3.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.12.m4.1.1.1.3.1" xref="S4.p13.12.m4.2.3.2.cmml">(</mo><mi id="S4.p13.12.m4.1.1.1.1" xref="S4.p13.12.m4.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p13.12.m4.1.1.1.3.2" xref="S4.p13.12.m4.2.3.2.cmml">)</mo></mrow></msup><mo rspace="0.111em" id="S4.p13.12.m4.2.3.1" xref="S4.p13.12.m4.2.3.1.cmml">=</mo><mrow id="S4.p13.12.m4.2.3.3" xref="S4.p13.12.m4.2.3.3.cmml"><msubsup id="S4.p13.12.m4.2.3.3.1" xref="S4.p13.12.m4.2.3.3.1.cmml"><mo id="S4.p13.12.m4.2.3.3.1.2.2" xref="S4.p13.12.m4.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.p13.12.m4.2.3.3.1.2.3" xref="S4.p13.12.m4.2.3.3.1.2.3.cmml"><mi id="S4.p13.12.m4.2.3.3.1.2.3.2" xref="S4.p13.12.m4.2.3.3.1.2.3.2.cmml">i</mi><mo id="S4.p13.12.m4.2.3.3.1.2.3.1" xref="S4.p13.12.m4.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.p13.12.m4.2.3.3.1.2.3.3" xref="S4.p13.12.m4.2.3.3.1.2.3.3.cmml">0</mn></mrow><mi id="S4.p13.12.m4.2.3.3.1.3" xref="S4.p13.12.m4.2.3.3.1.3.cmml">n</mi></msubsup><mrow id="S4.p13.12.m4.2.3.3.2" xref="S4.p13.12.m4.2.3.3.2.cmml"><mmultiscripts id="S4.p13.12.m4.2.3.3.2.2" xref="S4.p13.12.m4.2.3.3.2.2.cmml"><mi id="S4.p13.12.m4.2.3.3.2.2.2.2" xref="S4.p13.12.m4.2.3.3.2.2.2.2.cmml">g</mi><mi id="S4.p13.12.m4.2.3.3.2.2.2.3" xref="S4.p13.12.m4.2.3.3.2.2.2.3.cmml">i</mi><mrow id="S4.p13.12.m4.2.3.3.2.2a" xref="S4.p13.12.m4.2.3.3.2.2.cmml"></mrow><mrow id="S4.p13.12.m4.2.3.3.2.2b" xref="S4.p13.12.m4.2.3.3.2.2.cmml"></mrow><mrow id="S4.p13.12.m4.2.2.1.3" xref="S4.p13.12.m4.2.3.3.2.2.cmml"><mo stretchy="false" id="S4.p13.12.m4.2.2.1.3.1" xref="S4.p13.12.m4.2.3.3.2.2.cmml">(</mo><mi id="S4.p13.12.m4.2.2.1.1" xref="S4.p13.12.m4.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.p13.12.m4.2.2.1.3.2" xref="S4.p13.12.m4.2.3.3.2.2.cmml">)</mo></mrow></mmultiscripts><mo lspace="0em" rspace="0em" id="S4.p13.12.m4.2.3.3.2.1" xref="S4.p13.12.m4.2.3.3.2.1.cmml">​</mo><msub id="S4.p13.12.m4.2.3.3.2.3" xref="S4.p13.12.m4.2.3.3.2.3.cmml"><mi id="S4.p13.12.m4.2.3.3.2.3.2" xref="S4.p13.12.m4.2.3.3.2.3.2.cmml">𝑺</mi><mi id="S4.p13.12.m4.2.3.3.2.3.3" xref="S4.p13.12.m4.2.3.3.2.3.3.cmml">𝒊</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p13.12.m4.2b"><apply id="S4.p13.12.m4.2.3.cmml" xref="S4.p13.12.m4.2.3"><eq id="S4.p13.12.m4.2.3.1.cmml" xref="S4.p13.12.m4.2.3.1"></eq><apply id="S4.p13.12.m4.2.3.2.cmml" xref="S4.p13.12.m4.2.3.2"><csymbol cd="ambiguous" id="S4.p13.12.m4.2.3.2.1.cmml" xref="S4.p13.12.m4.2.3.2">superscript</csymbol><ci id="S4.p13.12.m4.2.3.2.2.cmml" xref="S4.p13.12.m4.2.3.2.2">𝑪</ci><ci id="S4.p13.12.m4.1.1.1.1.cmml" xref="S4.p13.12.m4.1.1.1.1">𝒕</ci></apply><apply id="S4.p13.12.m4.2.3.3.cmml" xref="S4.p13.12.m4.2.3.3"><apply id="S4.p13.12.m4.2.3.3.1.cmml" xref="S4.p13.12.m4.2.3.3.1"><csymbol cd="ambiguous" id="S4.p13.12.m4.2.3.3.1.1.cmml" xref="S4.p13.12.m4.2.3.3.1">superscript</csymbol><apply id="S4.p13.12.m4.2.3.3.1.2.cmml" xref="S4.p13.12.m4.2.3.3.1"><csymbol cd="ambiguous" id="S4.p13.12.m4.2.3.3.1.2.1.cmml" xref="S4.p13.12.m4.2.3.3.1">subscript</csymbol><sum id="S4.p13.12.m4.2.3.3.1.2.2.cmml" xref="S4.p13.12.m4.2.3.3.1.2.2"></sum><apply id="S4.p13.12.m4.2.3.3.1.2.3.cmml" xref="S4.p13.12.m4.2.3.3.1.2.3"><eq id="S4.p13.12.m4.2.3.3.1.2.3.1.cmml" xref="S4.p13.12.m4.2.3.3.1.2.3.1"></eq><ci id="S4.p13.12.m4.2.3.3.1.2.3.2.cmml" xref="S4.p13.12.m4.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.p13.12.m4.2.3.3.1.2.3.3.cmml" xref="S4.p13.12.m4.2.3.3.1.2.3.3">0</cn></apply></apply><ci id="S4.p13.12.m4.2.3.3.1.3.cmml" xref="S4.p13.12.m4.2.3.3.1.3">𝑛</ci></apply><apply id="S4.p13.12.m4.2.3.3.2.cmml" xref="S4.p13.12.m4.2.3.3.2"><times id="S4.p13.12.m4.2.3.3.2.1.cmml" xref="S4.p13.12.m4.2.3.3.2.1"></times><apply id="S4.p13.12.m4.2.3.3.2.2.cmml" xref="S4.p13.12.m4.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.p13.12.m4.2.3.3.2.2.1.cmml" xref="S4.p13.12.m4.2.3.3.2.2">superscript</csymbol><apply id="S4.p13.12.m4.2.3.3.2.2.2.cmml" xref="S4.p13.12.m4.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.p13.12.m4.2.3.3.2.2.2.1.cmml" xref="S4.p13.12.m4.2.3.3.2.2">subscript</csymbol><ci id="S4.p13.12.m4.2.3.3.2.2.2.2.cmml" xref="S4.p13.12.m4.2.3.3.2.2.2.2">𝑔</ci><ci id="S4.p13.12.m4.2.3.3.2.2.2.3.cmml" xref="S4.p13.12.m4.2.3.3.2.2.2.3">𝑖</ci></apply><ci id="S4.p13.12.m4.2.2.1.1.cmml" xref="S4.p13.12.m4.2.2.1.1">𝑡</ci></apply><apply id="S4.p13.12.m4.2.3.3.2.3.cmml" xref="S4.p13.12.m4.2.3.3.2.3"><csymbol cd="ambiguous" id="S4.p13.12.m4.2.3.3.2.3.1.cmml" xref="S4.p13.12.m4.2.3.3.2.3">subscript</csymbol><ci id="S4.p13.12.m4.2.3.3.2.3.2.cmml" xref="S4.p13.12.m4.2.3.3.2.3.2">𝑺</ci><ci id="S4.p13.12.m4.2.3.3.2.3.3.cmml" xref="S4.p13.12.m4.2.3.3.2.3.3">𝒊</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.12.m4.2c">\bm{C^{(t)}}=\sum_{i=0}^{n}{g_{i}}^{(t)}\bm{S_{i}}</annotation></semantics></math>. Please refer to  <cite class="ltx_cite ltx_citemacro_cite">Xiong et al. (<a href="#bib.bib31" title="" class="ltx_ref">2016</a>)</cite> for information about AttGRU(.). Finally, we use the 2D context and context tag vector to update the memory as follows:</p>
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle\bm{m^{(t)}}" display="inline"><semantics id="S4.Ex3.m1.1a"><msup id="S4.Ex3.m1.1.2" xref="S4.Ex3.m1.1.2.cmml"><mi id="S4.Ex3.m1.1.2.2" xref="S4.Ex3.m1.1.2.2.cmml">𝒎</mi><mrow id="S4.Ex3.m1.1.1.1.3" xref="S4.Ex3.m1.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex3.m1.1.1.1.3.1" xref="S4.Ex3.m1.1.2.cmml">(</mo><mi id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex3.m1.1.1.1.3.2" xref="S4.Ex3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.1b"><apply id="S4.Ex3.m1.1.2.cmml" xref="S4.Ex3.m1.1.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.2.1.cmml" xref="S4.Ex3.m1.1.2">superscript</csymbol><ci id="S4.Ex3.m1.1.2.2.cmml" xref="S4.Ex3.m1.1.2.2">𝒎</ci><ci id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.1c">\displaystyle\bm{m^{(t)}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex3.m2.4" class="ltx_math_unparsed" alttext="\displaystyle=\text{ReLU}\Big{(}{\bm{W}_{m}}^{(t)}\big{[}\bm{m^{(t-1)}};\ \bm{q};\ \bm{c^{(t)}};" display="inline"><semantics id="S4.Ex3.m2.4a"><mrow id="S4.Ex3.m2.4b"><mo id="S4.Ex3.m2.4.5">=</mo><mtext id="S4.Ex3.m2.4.6">ReLU</mtext><mrow id="S4.Ex3.m2.4.7"><mo maxsize="160%" minsize="160%" id="S4.Ex3.m2.4.7.1">(</mo><mmultiscripts id="S4.Ex3.m2.4.7.2"><mi id="S4.Ex3.m2.4.7.2.2.2">𝑾</mi><mi id="S4.Ex3.m2.4.7.2.2.3">m</mi><mrow id="S4.Ex3.m2.4.7.2a"></mrow><mrow id="S4.Ex3.m2.4.7.2b"></mrow><mrow id="S4.Ex3.m2.1.1.1.3"><mo stretchy="false" id="S4.Ex3.m2.1.1.1.3.1">(</mo><mi id="S4.Ex3.m2.1.1.1.1">t</mi><mo stretchy="false" id="S4.Ex3.m2.1.1.1.3.2">)</mo></mrow></mmultiscripts><mrow id="S4.Ex3.m2.4.7.3"><mo maxsize="120%" minsize="120%" id="S4.Ex3.m2.4.7.3.1">[</mo><msup id="S4.Ex3.m2.4.7.3.2"><mi id="S4.Ex3.m2.4.7.3.2.2">𝒎</mi><mrow id="S4.Ex3.m2.2.2.1.1"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex3.m2.2.2.1.1.2">(</mo><mrow id="S4.Ex3.m2.2.2.1.1.1"><mi id="S4.Ex3.m2.2.2.1.1.1.2">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.Ex3.m2.2.2.1.1.1.1">−</mo><mn id="S4.Ex3.m2.2.2.1.1.1.3">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex3.m2.2.2.1.1.3">)</mo></mrow></msup><mo rspace="0.667em" id="S4.Ex3.m2.4.7.3.3">;</mo><mi id="S4.Ex3.m2.4.4">𝒒</mi><mo rspace="0.667em" id="S4.Ex3.m2.4.7.3.4">;</mo><msup id="S4.Ex3.m2.4.7.3.5"><mi id="S4.Ex3.m2.4.7.3.5.2">𝒄</mi><mrow id="S4.Ex3.m2.3.3.1.3"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex3.m2.3.3.1.3.1">(</mo><mi id="S4.Ex3.m2.3.3.1.1">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.Ex3.m2.3.3.1.3.2">)</mo></mrow></msup><mo id="S4.Ex3.m2.4.7.3.6">;</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex3.m2.4c">\displaystyle=\text{ReLU}\Big{(}{\bm{W}_{m}}^{(t)}\big{[}\bm{m^{(t-1)}};\ \bm{q};\ \bm{c^{(t)}};</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2.m1.2" class="ltx_math_unparsed" alttext="\displaystyle En_{c}(\bm{C^{(t)}})\big{]}+{\bm{b_{m}}}^{(t)}\Big{)}" display="inline"><semantics id="S4.E2.m1.2a"><mrow id="S4.E2.m1.2b"><mrow id="S4.E2.m1.2.3"><mi id="S4.E2.m1.2.3.1">E</mi><msub id="S4.E2.m1.2.3.2"><mi id="S4.E2.m1.2.3.2.2">n</mi><mi id="S4.E2.m1.2.3.2.3">c</mi></msub><mrow id="S4.E2.m1.2.3.3"><mo stretchy="false" id="S4.E2.m1.2.3.3.1">(</mo><msup id="S4.E2.m1.2.3.3.2"><mi id="S4.E2.m1.2.3.3.2.2">𝑪</mi><mrow id="S4.E2.m1.1.1.1.3"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E2.m1.1.1.1.3.1">(</mo><mi id="S4.E2.m1.1.1.1.1">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E2.m1.1.1.1.3.2">)</mo></mrow></msup><mo stretchy="false" id="S4.E2.m1.2.3.3.3">)</mo></mrow><mo maxsize="120%" minsize="120%" id="S4.E2.m1.2.3.4">]</mo></mrow><mo id="S4.E2.m1.2.4">+</mo><mmultiscripts id="S4.E2.m1.2.5"><mi id="S4.E2.m1.2.5.2.2">𝒃</mi><mi id="S4.E2.m1.2.5.2.3">𝒎</mi><mrow id="S4.E2.m1.2.5a"></mrow><mrow id="S4.E2.m1.2.5b"></mrow><mrow id="S4.E2.m1.2.2.1.3"><mo stretchy="false" id="S4.E2.m1.2.2.1.3.1">(</mo><mi id="S4.E2.m1.2.2.1.1">t</mi><mo stretchy="false" id="S4.E2.m1.2.2.1.3.2">)</mo></mrow></mmultiscripts><mo maxsize="160%" minsize="160%" id="S4.E2.m1.2.6">)</mo></mrow><annotation encoding="application/x-tex" id="S4.E2.m1.2c">\displaystyle En_{c}(\bm{C^{(t)}})\big{]}+{\bm{b_{m}}}^{(t)}\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\displaystyle\bm{M^{(t)}}" display="inline"><semantics id="S4.E3.m1.1a"><msup id="S4.E3.m1.1.2" xref="S4.E3.m1.1.2.cmml"><mi id="S4.E3.m1.1.2.2" xref="S4.E3.m1.1.2.2.cmml">𝑴</mi><mrow id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E3.m1.1.1.1.3.1" xref="S4.E3.m1.1.2.cmml">(</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E3.m1.1.1.1.3.2" xref="S4.E3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.2.cmml" xref="S4.E3.m1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.2.1.cmml" xref="S4.E3.m1.1.2">superscript</csymbol><ci id="S4.E3.m1.1.2.2.cmml" xref="S4.E3.m1.1.2.2">𝑴</ci><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝒕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle\bm{M^{(t)}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E3.m2.5" class="ltx_Math" alttext="\displaystyle=De_{m}^{(t)}\Big{(}\big{[}\bm{m^{(t)}};\ En_{m}^{(t)}(\bm{M^{(t-1)}})\big{]}\Big{)}" display="inline"><semantics id="S4.E3.m2.5a"><mrow id="S4.E3.m2.5.5" xref="S4.E3.m2.5.5.cmml"><mi id="S4.E3.m2.5.5.3" xref="S4.E3.m2.5.5.3.cmml"></mi><mo id="S4.E3.m2.5.5.2" xref="S4.E3.m2.5.5.2.cmml">=</mo><mrow id="S4.E3.m2.5.5.1" xref="S4.E3.m2.5.5.1.cmml"><mi id="S4.E3.m2.5.5.1.3" xref="S4.E3.m2.5.5.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.E3.m2.5.5.1.2" xref="S4.E3.m2.5.5.1.2.cmml">​</mo><msubsup id="S4.E3.m2.5.5.1.4" xref="S4.E3.m2.5.5.1.4.cmml"><mi id="S4.E3.m2.5.5.1.4.2.2" xref="S4.E3.m2.5.5.1.4.2.2.cmml">e</mi><mi id="S4.E3.m2.5.5.1.4.2.3" xref="S4.E3.m2.5.5.1.4.2.3.cmml">m</mi><mrow id="S4.E3.m2.1.1.1.3" xref="S4.E3.m2.5.5.1.4.cmml"><mo stretchy="false" id="S4.E3.m2.1.1.1.3.1" xref="S4.E3.m2.5.5.1.4.cmml">(</mo><mi id="S4.E3.m2.1.1.1.1" xref="S4.E3.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E3.m2.1.1.1.3.2" xref="S4.E3.m2.5.5.1.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m2.5.5.1.2a" xref="S4.E3.m2.5.5.1.2.cmml">​</mo><mrow id="S4.E3.m2.5.5.1.1.1" xref="S4.E3.m2.5.5.1.cmml"><mo maxsize="160%" minsize="160%" id="S4.E3.m2.5.5.1.1.1.2" xref="S4.E3.m2.5.5.1.cmml">(</mo><mrow id="S4.E3.m2.5.5.1.1.1.1.2" xref="S4.E3.m2.5.5.1.1.1.1.3.cmml"><mo maxsize="120%" minsize="120%" id="S4.E3.m2.5.5.1.1.1.1.2.3" xref="S4.E3.m2.5.5.1.1.1.1.3.cmml">[</mo><msup id="S4.E3.m2.5.5.1.1.1.1.1.1" xref="S4.E3.m2.5.5.1.1.1.1.1.1.cmml"><mi id="S4.E3.m2.5.5.1.1.1.1.1.1.2" xref="S4.E3.m2.5.5.1.1.1.1.1.1.2.cmml">𝒎</mi><mrow id="S4.E3.m2.2.2.1.3" xref="S4.E3.m2.5.5.1.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E3.m2.2.2.1.3.1" xref="S4.E3.m2.5.5.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E3.m2.2.2.1.1" xref="S4.E3.m2.2.2.1.1.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E3.m2.2.2.1.3.2" xref="S4.E3.m2.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo rspace="0.667em" id="S4.E3.m2.5.5.1.1.1.1.2.4" xref="S4.E3.m2.5.5.1.1.1.1.3.cmml">;</mo><mrow id="S4.E3.m2.5.5.1.1.1.1.2.2" xref="S4.E3.m2.5.5.1.1.1.1.2.2.cmml"><mi id="S4.E3.m2.5.5.1.1.1.1.2.2.3" xref="S4.E3.m2.5.5.1.1.1.1.2.2.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E3.m2.5.5.1.1.1.1.2.2.2" xref="S4.E3.m2.5.5.1.1.1.1.2.2.2.cmml">​</mo><msubsup id="S4.E3.m2.5.5.1.1.1.1.2.2.4" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.cmml"><mi id="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.2" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.2.cmml">n</mi><mi id="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.3" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.3.cmml">m</mi><mrow id="S4.E3.m2.3.3.1.3" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.cmml"><mo stretchy="false" id="S4.E3.m2.3.3.1.3.1" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.cmml">(</mo><mi id="S4.E3.m2.3.3.1.1" xref="S4.E3.m2.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S4.E3.m2.3.3.1.3.2" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E3.m2.5.5.1.1.1.1.2.2.2a" xref="S4.E3.m2.5.5.1.1.1.1.2.2.2.cmml">​</mo><mrow id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.2" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.cmml">(</mo><msup id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.cmml"><mi id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.2" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.2.cmml">𝑴</mi><mrow id="S4.E3.m2.4.4.1.1" xref="S4.E3.m2.4.4.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E3.m2.4.4.1.1.2" xref="S4.E3.m2.4.4.1.1.1.cmml">(</mo><mrow id="S4.E3.m2.4.4.1.1.1" xref="S4.E3.m2.4.4.1.1.1.cmml"><mi id="S4.E3.m2.4.4.1.1.1.2" xref="S4.E3.m2.4.4.1.1.1.2.cmml">𝒕</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S4.E3.m2.4.4.1.1.1.1" xref="S4.E3.m2.4.4.1.1.1.1.cmml">−</mo><mn id="S4.E3.m2.4.4.1.1.1.3" xref="S4.E3.m2.4.4.1.1.1.3.cmml">𝟏</mn></mrow><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E3.m2.4.4.1.1.3" xref="S4.E3.m2.4.4.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.3" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.E3.m2.5.5.1.1.1.1.2.5" xref="S4.E3.m2.5.5.1.1.1.1.3.cmml">]</mo></mrow><mo maxsize="160%" minsize="160%" id="S4.E3.m2.5.5.1.1.1.3" xref="S4.E3.m2.5.5.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m2.5b"><apply id="S4.E3.m2.5.5.cmml" xref="S4.E3.m2.5.5"><eq id="S4.E3.m2.5.5.2.cmml" xref="S4.E3.m2.5.5.2"></eq><csymbol cd="latexml" id="S4.E3.m2.5.5.3.cmml" xref="S4.E3.m2.5.5.3">absent</csymbol><apply id="S4.E3.m2.5.5.1.cmml" xref="S4.E3.m2.5.5.1"><times id="S4.E3.m2.5.5.1.2.cmml" xref="S4.E3.m2.5.5.1.2"></times><ci id="S4.E3.m2.5.5.1.3.cmml" xref="S4.E3.m2.5.5.1.3">𝐷</ci><apply id="S4.E3.m2.5.5.1.4.cmml" xref="S4.E3.m2.5.5.1.4"><csymbol cd="ambiguous" id="S4.E3.m2.5.5.1.4.1.cmml" xref="S4.E3.m2.5.5.1.4">superscript</csymbol><apply id="S4.E3.m2.5.5.1.4.2.cmml" xref="S4.E3.m2.5.5.1.4"><csymbol cd="ambiguous" id="S4.E3.m2.5.5.1.4.2.1.cmml" xref="S4.E3.m2.5.5.1.4">subscript</csymbol><ci id="S4.E3.m2.5.5.1.4.2.2.cmml" xref="S4.E3.m2.5.5.1.4.2.2">𝑒</ci><ci id="S4.E3.m2.5.5.1.4.2.3.cmml" xref="S4.E3.m2.5.5.1.4.2.3">𝑚</ci></apply><ci id="S4.E3.m2.1.1.1.1.cmml" xref="S4.E3.m2.1.1.1.1">𝑡</ci></apply><list id="S4.E3.m2.5.5.1.1.1.1.3.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2"><apply id="S4.E3.m2.5.5.1.1.1.1.1.1.cmml" xref="S4.E3.m2.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m2.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E3.m2.5.5.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E3.m2.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E3.m2.5.5.1.1.1.1.1.1.2">𝒎</ci><ci id="S4.E3.m2.2.2.1.1.cmml" xref="S4.E3.m2.2.2.1.1">𝒕</ci></apply><apply id="S4.E3.m2.5.5.1.1.1.1.2.2.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2"><times id="S4.E3.m2.5.5.1.1.1.1.2.2.2.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.2"></times><ci id="S4.E3.m2.5.5.1.1.1.1.2.2.3.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.3">𝐸</ci><apply id="S4.E3.m2.5.5.1.1.1.1.2.2.4.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m2.5.5.1.1.1.1.2.2.4.1.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4">superscript</csymbol><apply id="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.1.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4">subscript</csymbol><ci id="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.2.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.2">𝑛</ci><ci id="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.3.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.4.2.3">𝑚</ci></apply><ci id="S4.E3.m2.3.3.1.1.cmml" xref="S4.E3.m2.3.3.1.1">𝑡</ci></apply><apply id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.1.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1">superscript</csymbol><ci id="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E3.m2.5.5.1.1.1.1.2.2.1.1.1.2">𝑴</ci><apply id="S4.E3.m2.4.4.1.1.1.cmml" xref="S4.E3.m2.4.4.1.1"><minus id="S4.E3.m2.4.4.1.1.1.1.cmml" xref="S4.E3.m2.4.4.1.1.1.1"></minus><ci id="S4.E3.m2.4.4.1.1.1.2.cmml" xref="S4.E3.m2.4.4.1.1.1.2">𝒕</ci><cn type="integer" id="S4.E3.m2.4.4.1.1.1.3.cmml" xref="S4.E3.m2.4.4.1.1.1.3">1</cn></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m2.5c">\displaystyle=De_{m}^{(t)}\Big{(}\big{[}\bm{m^{(t)}};\ En_{m}^{(t)}(\bm{M^{(t-1)}})\big{]}\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/1805.11025/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_img_landscape" width="436" height="151" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The architecture of the proposed Dynamic Spatial Memory Network (DSMN).</figcaption>
</figure>
<div id="S4.p14" class="ltx_para">
<p id="S4.p14.3" class="ltx_p"><span id="S4.p14.3.1" class="ltx_text ltx_font_bold">Answer Module:</span>
This module uses the final memory and question embedding to generate the output. The feature vector used for predicting the answer is given by <math id="S4.p14.1.m1.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S4.p14.1.m1.1a"><mi id="S4.p14.1.m1.1.1" xref="S4.p14.1.m1.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S4.p14.1.m1.1b"><ci id="S4.p14.1.m1.1.1.cmml" xref="S4.p14.1.m1.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.1.m1.1c">\bm{f}</annotation></semantics></math>, where <math id="S4.p14.2.m2.1" class="ltx_Math" alttext="\bm{M^{(T)}}" display="inline"><semantics id="S4.p14.2.m2.1a"><msup id="S4.p14.2.m2.1.2" xref="S4.p14.2.m2.1.2.cmml"><mi id="S4.p14.2.m2.1.2.2" xref="S4.p14.2.m2.1.2.2.cmml">𝑴</mi><mrow id="S4.p14.2.m2.1.1.1.3" xref="S4.p14.2.m2.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p14.2.m2.1.1.1.3.1" xref="S4.p14.2.m2.1.2.cmml">(</mo><mi id="S4.p14.2.m2.1.1.1.1" xref="S4.p14.2.m2.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p14.2.m2.1.1.1.3.2" xref="S4.p14.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p14.2.m2.1b"><apply id="S4.p14.2.m2.1.2.cmml" xref="S4.p14.2.m2.1.2"><csymbol cd="ambiguous" id="S4.p14.2.m2.1.2.1.cmml" xref="S4.p14.2.m2.1.2">superscript</csymbol><ci id="S4.p14.2.m2.1.2.2.cmml" xref="S4.p14.2.m2.1.2.2">𝑴</ci><ci id="S4.p14.2.m2.1.1.1.1.cmml" xref="S4.p14.2.m2.1.1.1.1">𝑻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.2.m2.1c">\bm{M^{(T)}}</annotation></semantics></math> and <math id="S4.p14.3.m3.1" class="ltx_Math" alttext="\bm{m^{(T)}}" display="inline"><semantics id="S4.p14.3.m3.1a"><msup id="S4.p14.3.m3.1.2" xref="S4.p14.3.m3.1.2.cmml"><mi id="S4.p14.3.m3.1.2.2" xref="S4.p14.3.m3.1.2.2.cmml">𝒎</mi><mrow id="S4.p14.3.m3.1.1.1.3" xref="S4.p14.3.m3.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p14.3.m3.1.1.1.3.1" xref="S4.p14.3.m3.1.2.cmml">(</mo><mi id="S4.p14.3.m3.1.1.1.1" xref="S4.p14.3.m3.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.p14.3.m3.1.1.1.3.2" xref="S4.p14.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p14.3.m3.1b"><apply id="S4.p14.3.m3.1.2.cmml" xref="S4.p14.3.m3.1.2"><csymbol cd="ambiguous" id="S4.p14.3.m3.1.2.1.cmml" xref="S4.p14.3.m3.1.2">superscript</csymbol><ci id="S4.p14.3.m3.1.2.2.cmml" xref="S4.p14.3.m3.1.2.2">𝒎</ci><ci id="S4.p14.3.m3.1.1.1.1.cmml" xref="S4.p14.3.m3.1.1.1.1">𝑻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.3.m3.1c">\bm{m^{(T)}}</annotation></semantics></math> represent the final memory.</p>
<table id="A1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.5" class="ltx_Math" alttext="\displaystyle\bm{f}=\big{[}En_{f}(\bm{M^{(T)}});\ \bm{m^{(T)}};\ \bm{q}\big{]}" display="inline"><semantics id="S4.E4.m1.5a"><mrow id="S4.E4.m1.5.5" xref="S4.E4.m1.5.5.cmml"><mi id="S4.E4.m1.5.5.4" xref="S4.E4.m1.5.5.4.cmml">𝒇</mi><mo id="S4.E4.m1.5.5.3" xref="S4.E4.m1.5.5.3.cmml">=</mo><mrow id="S4.E4.m1.5.5.2.2" xref="S4.E4.m1.5.5.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S4.E4.m1.5.5.2.2.3" xref="S4.E4.m1.5.5.2.3.cmml">[</mo><mrow id="S4.E4.m1.4.4.1.1.1" xref="S4.E4.m1.4.4.1.1.1.cmml"><mi id="S4.E4.m1.4.4.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.2.cmml">​</mo><msub id="S4.E4.m1.4.4.1.1.1.4" xref="S4.E4.m1.4.4.1.1.1.4.cmml"><mi id="S4.E4.m1.4.4.1.1.1.4.2" xref="S4.E4.m1.4.4.1.1.1.4.2.cmml">n</mi><mi id="S4.E4.m1.4.4.1.1.1.4.3" xref="S4.E4.m1.4.4.1.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.1.2a" xref="S4.E4.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E4.m1.4.4.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E4.m1.1.1.1.3.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E4.m1.1.1.1.3.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.667em" id="S4.E4.m1.5.5.2.2.4" xref="S4.E4.m1.5.5.2.3.cmml">;</mo><msup id="S4.E4.m1.5.5.2.2.2" xref="S4.E4.m1.5.5.2.2.2.cmml"><mi id="S4.E4.m1.5.5.2.2.2.2" xref="S4.E4.m1.5.5.2.2.2.2.cmml">𝒎</mi><mrow id="S4.E4.m1.2.2.1.3" xref="S4.E4.m1.5.5.2.2.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E4.m1.2.2.1.3.1" xref="S4.E4.m1.5.5.2.2.2.cmml">(</mo><mi id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S4.E4.m1.2.2.1.3.2" xref="S4.E4.m1.5.5.2.2.2.cmml">)</mo></mrow></msup><mo rspace="0.667em" id="S4.E4.m1.5.5.2.2.5" xref="S4.E4.m1.5.5.2.3.cmml">;</mo><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S4.E4.m1.5.5.2.2.6" xref="S4.E4.m1.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.5b"><apply id="S4.E4.m1.5.5.cmml" xref="S4.E4.m1.5.5"><eq id="S4.E4.m1.5.5.3.cmml" xref="S4.E4.m1.5.5.3"></eq><ci id="S4.E4.m1.5.5.4.cmml" xref="S4.E4.m1.5.5.4">𝒇</ci><list id="S4.E4.m1.5.5.2.3.cmml" xref="S4.E4.m1.5.5.2.2"><apply id="S4.E4.m1.4.4.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1"><times id="S4.E4.m1.4.4.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.2"></times><ci id="S4.E4.m1.4.4.1.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.1.3">𝐸</ci><apply id="S4.E4.m1.4.4.1.1.1.4.cmml" xref="S4.E4.m1.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.4.1.cmml" xref="S4.E4.m1.4.4.1.1.1.4">subscript</csymbol><ci id="S4.E4.m1.4.4.1.1.1.4.2.cmml" xref="S4.E4.m1.4.4.1.1.1.4.2">𝑛</ci><ci id="S4.E4.m1.4.4.1.1.1.4.3.cmml" xref="S4.E4.m1.4.4.1.1.1.4.3">𝑓</ci></apply><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2">𝑴</ci><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑻</ci></apply></apply><apply id="S4.E4.m1.5.5.2.2.2.cmml" xref="S4.E4.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.2.2.2.1.cmml" xref="S4.E4.m1.5.5.2.2.2">superscript</csymbol><ci id="S4.E4.m1.5.5.2.2.2.2.cmml" xref="S4.E4.m1.5.5.2.2.2.2">𝒎</ci><ci id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1.1">𝑻</ci></apply><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">𝒒</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.5c">\displaystyle\bm{f}=\big{[}En_{f}(\bm{M^{(T)}});\ \bm{m^{(T)}};\ \bm{q}\big{]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.p14.6" class="ltx_p">To obtain the output, an FC layer is applied to <math id="S4.p14.4.m1.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S4.p14.4.m1.1a"><mi id="S4.p14.4.m1.1.1" xref="S4.p14.4.m1.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S4.p14.4.m1.1b"><ci id="S4.p14.4.m1.1.1.cmml" xref="S4.p14.4.m1.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.4.m1.1c">\bm{f}</annotation></semantics></math> in case of regression, while the FC layer is followed by softmax in case of classification. To keep DSMN similar to DMN+, we apply a dropout layer on sentence encodings (<math id="S4.p14.5.m2.1" class="ltx_Math" alttext="\bm{s_{i}}" display="inline"><semantics id="S4.p14.5.m2.1a"><msub id="S4.p14.5.m2.1.1" xref="S4.p14.5.m2.1.1.cmml"><mi id="S4.p14.5.m2.1.1.2" xref="S4.p14.5.m2.1.1.2.cmml">𝒔</mi><mi id="S4.p14.5.m2.1.1.3" xref="S4.p14.5.m2.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p14.5.m2.1b"><apply id="S4.p14.5.m2.1.1.cmml" xref="S4.p14.5.m2.1.1"><csymbol cd="ambiguous" id="S4.p14.5.m2.1.1.1.cmml" xref="S4.p14.5.m2.1.1">subscript</csymbol><ci id="S4.p14.5.m2.1.1.2.cmml" xref="S4.p14.5.m2.1.1.2">𝒔</ci><ci id="S4.p14.5.m2.1.1.3.cmml" xref="S4.p14.5.m2.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.5.m2.1c">\bm{s_{i}}</annotation></semantics></math>) and <math id="S4.p14.6.m3.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S4.p14.6.m3.1a"><mi id="S4.p14.6.m3.1.1" xref="S4.p14.6.m3.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S4.p14.6.m3.1b"><ci id="S4.p14.6.m3.1.1.cmml" xref="S4.p14.6.m3.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.6.m3.1c">\bm{f}</annotation></semantics></math>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>DSMN as a strict generalization of DMN</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">DSMN is a strict generalization of a DMN+. If we remove the visual representation of the input along with the 2D spatial memory, and just use vector representations with memory tags, then a DSMN reduces to DMN+. This ensures that comparison with DMN+ is fair.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>DSMN with or without intermediate visual supervision</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.4" class="ltx_p">As described in previous sections, a DSMN forms an intermediate visual representation of the input. Therefore, if we have a ‘ground-truth’ visual representation for the training data, we could use it to train our network better. This leads to two different ways for training a DSMN, one with intermediate visual supervision and one without it. Without intermediate visual supervision, we train the network in an end-to-end fashion by using a loss (<math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="L_{w/o\_vi}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">L</mi><mrow id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mrow id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2.2" xref="S4.SS2.p1.1.m1.1.1.3.2.2.cmml">w</mi><mo id="S4.SS2.p1.1.m1.1.1.3.2.1" xref="S4.SS2.p1.1.m1.1.1.3.2.1.cmml">/</mo><mi id="S4.SS2.p1.1.m1.1.1.3.2.3" xref="S4.SS2.p1.1.m1.1.1.3.2.3.cmml">o</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1a" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.4" xref="S4.SS2.p1.1.m1.1.1.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.3.1b" xref="S4.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.1.m1.1.1.3.5" xref="S4.SS2.p1.1.m1.1.1.3.5.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐿</ci><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><times id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.1"></times><apply id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2"><divide id="S4.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2.1"></divide><ci id="S4.SS2.p1.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2.2">𝑤</ci><ci id="S4.SS2.p1.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2.3">𝑜</ci></apply><ci id="S4.SS2.p1.1.m1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3.3">_</ci><ci id="S4.SS2.p1.1.m1.1.1.3.4.cmml" xref="S4.SS2.p1.1.m1.1.1.3.4">𝑣</ci><ci id="S4.SS2.p1.1.m1.1.1.3.5.cmml" xref="S4.SS2.p1.1.m1.1.1.3.5">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">L_{w/o\_vi}</annotation></semantics></math>) that compares the predicted answer with the ground truth. With intermediate visual supervision, we train our network using an additional visual representation loss (<math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="L_{vi}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">L</mi><mrow id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.3.2" xref="S4.SS2.p1.2.m2.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.1.3.1" xref="S4.SS2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.2.m2.1.1.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝐿</ci><apply id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><times id="S4.SS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3.1"></times><ci id="S4.SS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2">𝑣</ci><ci id="S4.SS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">L_{vi}</annotation></semantics></math>) that measures how close the generated visual representation is to the ground-truth representation. Thus, the loss used for training with intermediate supervision is given by <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="L_{w\_vi}=\lambda_{vi}L_{vi}+(1-\lambda_{vi})L_{w/o\_vi}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.3.2.cmml">L</mi><mrow id="S4.SS2.p1.3.m3.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.3.3.2" xref="S4.SS2.p1.3.m3.1.1.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.3.3.1" xref="S4.SS2.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS2.p1.3.m3.1.1.3.3.3" xref="S4.SS2.p1.3.m3.1.1.3.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.3.3.1a" xref="S4.SS2.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.3.3.4" xref="S4.SS2.p1.3.m3.1.1.3.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.3.3.1b" xref="S4.SS2.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.3.3.5" xref="S4.SS2.p1.3.m3.1.1.3.3.5.cmml">i</mi></mrow></msub><mo id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">=</mo><mrow id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml"><mrow id="S4.SS2.p1.3.m3.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.3.cmml"><msub id="S4.SS2.p1.3.m3.1.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.1.3.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.3.2.2" xref="S4.SS2.p1.3.m3.1.1.1.3.2.2.cmml">λ</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.3.2.3" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.3.2.3.2" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.3.2.3.1" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.1.3.2.3.3" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.3.1" xref="S4.SS2.p1.3.m3.1.1.1.3.1.cmml">​</mo><msub id="S4.SS2.p1.3.m3.1.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.1.3.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.3.3.2" xref="S4.SS2.p1.3.m3.1.1.1.3.3.2.cmml">L</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.3.3.3" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.3.3.3.2" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.3.3.3.1" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.1.3.3.3.3" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S4.SS2.p1.3.m3.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.2.cmml">+</mo><mrow id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml"><mrow id="S4.SS2.p1.3.m3.1.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="S4.SS2.p1.3.m3.1.1.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.cmml">​</mo><msub id="S4.SS2.p1.3.m3.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.3.2.cmml">L</mi><mrow id="S4.SS2.p1.3.m3.1.1.1.1.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.cmml"><mrow id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.2" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.2.cmml">w</mi><mo id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.1" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.1.cmml">/</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.3.cmml">o</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.1.3.3.1" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS2.p1.3.m3.1.1.1.1.3.3.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.1.3.3.1a" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1.3.3.4" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.4.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1.1.1.3.3.1b" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.3.m3.1.1.1.1.3.3.5" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.5.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><eq id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"></eq><apply id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.2">𝐿</ci><apply id="S4.SS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3"><times id="S4.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.1"></times><ci id="S4.SS2.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.2">𝑤</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.3">_</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.4.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.4">𝑣</ci><ci id="S4.SS2.p1.3.m3.1.1.3.3.5.cmml" xref="S4.SS2.p1.3.m3.1.1.3.3.5">𝑖</ci></apply></apply><apply id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"><plus id="S4.SS2.p1.3.m3.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.2"></plus><apply id="S4.SS2.p1.3.m3.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3"><times id="S4.SS2.p1.3.m3.1.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.1"></times><apply id="S4.SS2.p1.3.m3.1.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.3.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.3.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2.2">𝜆</ci><apply id="S4.SS2.p1.3.m3.1.1.1.3.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3"><times id="S4.SS2.p1.3.m3.1.1.1.3.2.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.1"></times><ci id="S4.SS2.p1.3.m3.1.1.1.3.2.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.2">𝑣</ci><ci id="S4.SS2.p1.3.m3.1.1.1.3.2.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS2.p1.3.m3.1.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3.2">𝐿</ci><apply id="S4.SS2.p1.3.m3.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3"><times id="S4.SS2.p1.3.m3.1.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.1"></times><ci id="S4.SS2.p1.3.m3.1.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.2">𝑣</ci><ci id="S4.SS2.p1.3.m3.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1"><times id="S4.SS2.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2"></times><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1"><minus id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.2">1</cn><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.2">𝜆</ci><apply id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3"><times id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.1"></times><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.2">𝑣</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.SS2.p1.3.m3.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.2">𝐿</ci><apply id="S4.SS2.p1.3.m3.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3"><times id="S4.SS2.p1.3.m3.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.1"></times><apply id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2"><divide id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.1"></divide><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.2">𝑤</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.2.3">𝑜</ci></apply><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.3.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.3">_</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.3.4.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.4">𝑣</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.3.3.5.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3.3.5">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">L_{w\_vi}=\lambda_{vi}L_{vi}+(1-\lambda_{vi})L_{w/o\_vi}</annotation></semantics></math>, where <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\lambda_{vi}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msub id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">λ</mi><mrow id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.1.3.1" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝜆</ci><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><times id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2">𝑣</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\lambda_{vi}</annotation></semantics></math> is a hyperparameter which can be tuned for each dataset. Note that in neither case do we need any visual input once the network is trained. During testing, the only input to the network is the description and question.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Also note that we can provide intermediate visual supervision to DSMN even when the visual representations for only a portion of samples in the training data are available. This can be useful when obtaining visual representation is expensive and time-consuming.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span id="S5.p1.1.1" class="ltx_text ltx_font_bold">Baselines:</span>
LSTM <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter and Schmidhuber, <a href="#bib.bib11" title="" class="ltx_ref">1997</a>)</cite> is a popular neural network for sequence processing tasks. We use two versions of LSTM-based baselines. LSTM-1 is a common version that is used as a baseline for textual QA <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>; Graves et al., <a href="#bib.bib6" title="" class="ltx_ref">2016</a>)</cite>. In LSTM-1, we concatenate all the sentences and the question to a single string. For FloorPlanQA, we do word embedding look-up, while for ShapeIntersection, we project each real number into higher dimension via a series of FC layers. The sequence of vectors is fed into an LSTM. The final output vector of the LSTM is then used for prediction.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">We develop another version of LSTM that we call LSTM-2, in which the question is concatenated to the description. We use a two-level hierarchy to embed the description. We first extract an embedding for each sentence. For FloorPlanQA, we use an LSTM to get the sentence embeddings, and for ShapeIntersection, we use a series of FC layers. We then feed the sentence embeddings into an LSTM, whose output is used for prediction.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">Further, we compare our model to DMN+ <cite class="ltx_cite ltx_citemacro_citep">(Xiong et al., <a href="#bib.bib31" title="" class="ltx_ref">2016</a>)</cite> and MemN2N <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite>, which achieved state-of-the-art results on bAbI <cite class="ltx_cite ltx_citemacro_citep">(Weston et al., <a href="#bib.bib30" title="" class="ltx_ref">2015</a>)</cite>. In particular, we compare the 3-hop versions of DSMN, DMN+, and MemN2N.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.T2.st1" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S5.T2.st1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.st1.1.1.1" class="ltx_tr">
<th id="S5.T2.st1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_rr"></th>
<th id="S5.T2.st1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">FloorPlanQA</th>
<th id="S5.T2.st1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">ShapeIntersection</th>
</tr>
<tr id="S5.T2.st1.1.2.2" class="ltx_tr">
<th id="S5.T2.st1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr">MODEL</th>
<th id="S5.T2.st1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">(accuracy in %)</th>
<th id="S5.T2.st1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">(rmse)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.st1.1.3.1" class="ltx_tr">
<th id="S5.T2.st1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">LSTM-1</th>
<td id="S5.T2.st1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">41.36</td>
<td id="S5.T2.st1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_tt">3.28</td>
</tr>
<tr id="S5.T2.st1.1.4.2" class="ltx_tr">
<th id="S5.T2.st1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">LSTM-2</th>
<td id="S5.T2.st1.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r">50.69</td>
<td id="S5.T2.st1.1.4.2.3" class="ltx_td ltx_align_center">2.99</td>
</tr>
<tr id="S5.T2.st1.1.5.3" class="ltx_tr">
<th id="S5.T2.st1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MemN2N</th>
<td id="S5.T2.st1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r">45.92</td>
<td id="S5.T2.st1.1.5.3.3" class="ltx_td ltx_align_center">3.51</td>
</tr>
<tr id="S5.T2.st1.1.6.4" class="ltx_tr">
<th id="S5.T2.st1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DMN+</th>
<td id="S5.T2.st1.1.6.4.2" class="ltx_td ltx_align_center ltx_border_r">60.29</td>
<td id="S5.T2.st1.1.6.4.3" class="ltx_td ltx_align_center">2.98</td>
</tr>
<tr id="S5.T2.st1.1.7.5" class="ltx_tr">
<th id="S5.T2.st1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DSMN</th>
<td id="S5.T2.st1.1.7.5.2" class="ltx_td ltx_align_center ltx_border_r">68.01</td>
<td id="S5.T2.st1.1.7.5.3" class="ltx_td ltx_align_center">2.84</td>
</tr>
<tr id="S5.T2.st1.1.8.6" class="ltx_tr">
<th id="S5.T2.st1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DSMN*</th>
<td id="S5.T2.st1.1.8.6.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T2.st1.1.8.6.2.1" class="ltx_text ltx_font_bold">97.73</span></td>
<td id="S5.T2.st1.1.8.6.3" class="ltx_td ltx_align_center"><span id="S5.T2.st1.1.8.6.3.1" class="ltx_text ltx_font_bold">2.14</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(a) </span>The test set performance of different models on FloorPlanQA and ShapeIntersection. DSMN* refers to the model with intermediate supervision.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.T2.st2" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S5.T2.st2.8.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.st2.8.8.9.1" class="ltx_tr">
<th id="S5.T2.st2.8.8.9.1.1" class="ltx_td ltx_th ltx_th_column ltx_border_rr"></th>
<th id="S5.T2.st2.8.8.9.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_r"></th>
<th id="S5.T2.st2.8.8.9.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FloorPlanQA</th>
</tr>
<tr id="S5.T2.st2.2.2.2" class="ltx_tr">
<th id="S5.T2.st2.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_rr">MODEL</th>
<th id="S5.T2.st2.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r">
<math id="S5.T2.st2.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S5.T2.st2.1.1.1.1.m1.1a"><mi id="S5.T2.st2.1.1.1.1.m1.1.1" xref="S5.T2.st2.1.1.1.1.m1.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S5.T2.st2.1.1.1.1.m1.1b"><ci id="S5.T2.st2.1.1.1.1.m1.1.1.cmml" xref="S5.T2.st2.1.1.1.1.m1.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.1.1.1.1.m1.1c">\bm{f}</annotation></semantics></math> in Eqn. <a href="#S4.E4" title="Equation 4 ‣ 4 Dynamic Spatial Memory Network ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref ltx_markedasmath ltx_font_italic"><span class="ltx_text ltx_ref_tag">4</span></a>
</th>
<th id="S5.T2.st2.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">(accuracy in %)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.st2.3.3.3" class="ltx_tr">
<td id="S5.T2.st2.3.3.3.2" class="ltx_td ltx_align_left ltx_border_rr ltx_border_tt">DSMN</td>
<td id="S5.T2.st2.3.3.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt"><math id="S5.T2.st2.3.3.3.1.m1.3" class="ltx_Math" alttext="\big{[}\bm{m^{(T)}};\ \bm{q}\big{]}" display="inline"><semantics id="S5.T2.st2.3.3.3.1.m1.3a"><mrow id="S5.T2.st2.3.3.3.1.m1.3.3.1" xref="S5.T2.st2.3.3.3.1.m1.3.3.2.cmml"><mo maxsize="120%" minsize="120%" id="S5.T2.st2.3.3.3.1.m1.3.3.1.2" xref="S5.T2.st2.3.3.3.1.m1.3.3.2.cmml">[</mo><msup id="S5.T2.st2.3.3.3.1.m1.3.3.1.1" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1.cmml"><mi id="S5.T2.st2.3.3.3.1.m1.3.3.1.1.2" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1.2.cmml">𝒎</mi><mrow id="S5.T2.st2.3.3.3.1.m1.1.1.1.3" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.3.3.3.1.m1.1.1.1.3.1" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1.cmml">(</mo><mi id="S5.T2.st2.3.3.3.1.m1.1.1.1.1" xref="S5.T2.st2.3.3.3.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.3.3.3.1.m1.1.1.1.3.2" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1.cmml">)</mo></mrow></msup><mo rspace="0.667em" id="S5.T2.st2.3.3.3.1.m1.3.3.1.3" xref="S5.T2.st2.3.3.3.1.m1.3.3.2.cmml">;</mo><mi id="S5.T2.st2.3.3.3.1.m1.2.2" xref="S5.T2.st2.3.3.3.1.m1.2.2.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.T2.st2.3.3.3.1.m1.3.3.1.4" xref="S5.T2.st2.3.3.3.1.m1.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.st2.3.3.3.1.m1.3b"><list id="S5.T2.st2.3.3.3.1.m1.3.3.2.cmml" xref="S5.T2.st2.3.3.3.1.m1.3.3.1"><apply id="S5.T2.st2.3.3.3.1.m1.3.3.1.1.cmml" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S5.T2.st2.3.3.3.1.m1.3.3.1.1.1.cmml" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1">superscript</csymbol><ci id="S5.T2.st2.3.3.3.1.m1.3.3.1.1.2.cmml" xref="S5.T2.st2.3.3.3.1.m1.3.3.1.1.2">𝒎</ci><ci id="S5.T2.st2.3.3.3.1.m1.1.1.1.1.cmml" xref="S5.T2.st2.3.3.3.1.m1.1.1.1.1">𝑻</ci></apply><ci id="S5.T2.st2.3.3.3.1.m1.2.2.cmml" xref="S5.T2.st2.3.3.3.1.m1.2.2">𝒒</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.3.3.3.1.m1.3c">\big{[}\bm{m^{(T)}};\ \bm{q}\big{]}</annotation></semantics></math></td>
<td id="S5.T2.st2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt">67.65</td>
</tr>
<tr id="S5.T2.st2.4.4.4" class="ltx_tr">
<td id="S5.T2.st2.4.4.4.2" class="ltx_td ltx_align_left ltx_border_rr">DSMN</td>
<td id="S5.T2.st2.4.4.4.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S5.T2.st2.4.4.4.1.m1.3" class="ltx_Math" alttext="\big{[}En_{f}(\bm{M^{(T)}});\ \bm{q}\big{]}" display="inline"><semantics id="S5.T2.st2.4.4.4.1.m1.3a"><mrow id="S5.T2.st2.4.4.4.1.m1.3.3.1" xref="S5.T2.st2.4.4.4.1.m1.3.3.2.cmml"><mo maxsize="120%" minsize="120%" id="S5.T2.st2.4.4.4.1.m1.3.3.1.2" xref="S5.T2.st2.4.4.4.1.m1.3.3.2.cmml">[</mo><mrow id="S5.T2.st2.4.4.4.1.m1.3.3.1.1" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.cmml"><mi id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.3" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.2" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.2.cmml">​</mo><msub id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.cmml"><mi id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.2" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.2.cmml">n</mi><mi id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.3" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.2a" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.2" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml">(</mo><msup id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.2" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S5.T2.st2.4.4.4.1.m1.1.1.1.3" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.4.4.4.1.m1.1.1.1.3.1" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S5.T2.st2.4.4.4.1.m1.1.1.1.1" xref="S5.T2.st2.4.4.4.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.4.4.4.1.m1.1.1.1.3.2" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.3" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.667em" id="S5.T2.st2.4.4.4.1.m1.3.3.1.3" xref="S5.T2.st2.4.4.4.1.m1.3.3.2.cmml">;</mo><mi id="S5.T2.st2.4.4.4.1.m1.2.2" xref="S5.T2.st2.4.4.4.1.m1.2.2.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.T2.st2.4.4.4.1.m1.3.3.1.4" xref="S5.T2.st2.4.4.4.1.m1.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.st2.4.4.4.1.m1.3b"><list id="S5.T2.st2.4.4.4.1.m1.3.3.2.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1"><apply id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1"><times id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.2.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.2"></times><ci id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.3.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.3">𝐸</ci><apply id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.1.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4">subscript</csymbol><ci id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.2.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.2">𝑛</ci><ci id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.3.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.4.3">𝑓</ci></apply><apply id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S5.T2.st2.4.4.4.1.m1.3.3.1.1.1.1.1.2">𝑴</ci><ci id="S5.T2.st2.4.4.4.1.m1.1.1.1.1.cmml" xref="S5.T2.st2.4.4.4.1.m1.1.1.1.1">𝑻</ci></apply></apply><ci id="S5.T2.st2.4.4.4.1.m1.2.2.cmml" xref="S5.T2.st2.4.4.4.1.m1.2.2">𝒒</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.4.4.4.1.m1.3c">\big{[}En_{f}(\bm{M^{(T)}});\ \bm{q}\big{]}</annotation></semantics></math></td>
<td id="S5.T2.st2.4.4.4.3" class="ltx_td ltx_align_center">43.90</td>
</tr>
<tr id="S5.T2.st2.5.5.5" class="ltx_tr">
<td id="S5.T2.st2.5.5.5.2" class="ltx_td ltx_align_left ltx_border_rr">DSMN</td>
<td id="S5.T2.st2.5.5.5.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S5.T2.st2.5.5.5.1.m1.5" class="ltx_Math" alttext="\big{[}En_{f}(\bm{M^{(T)}});\ \bm{m^{(T)}};\ \bm{q}\big{]}" display="inline"><semantics id="S5.T2.st2.5.5.5.1.m1.5a"><mrow id="S5.T2.st2.5.5.5.1.m1.5.5.2" xref="S5.T2.st2.5.5.5.1.m1.5.5.3.cmml"><mo maxsize="120%" minsize="120%" id="S5.T2.st2.5.5.5.1.m1.5.5.2.3" xref="S5.T2.st2.5.5.5.1.m1.5.5.3.cmml">[</mo><mrow id="S5.T2.st2.5.5.5.1.m1.4.4.1.1" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.cmml"><mi id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.3" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.2" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.2.cmml">​</mo><msub id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.cmml"><mi id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.2" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.2.cmml">n</mi><mi id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.3" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.2a" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.2.cmml">​</mo><mrow id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.2" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml">(</mo><msup id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.2" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S5.T2.st2.5.5.5.1.m1.1.1.1.3" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.5.5.5.1.m1.1.1.1.3.1" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S5.T2.st2.5.5.5.1.m1.1.1.1.1" xref="S5.T2.st2.5.5.5.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.5.5.5.1.m1.1.1.1.3.2" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.3" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.667em" id="S5.T2.st2.5.5.5.1.m1.5.5.2.4" xref="S5.T2.st2.5.5.5.1.m1.5.5.3.cmml">;</mo><msup id="S5.T2.st2.5.5.5.1.m1.5.5.2.2" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2.cmml"><mi id="S5.T2.st2.5.5.5.1.m1.5.5.2.2.2" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2.2.cmml">𝒎</mi><mrow id="S5.T2.st2.5.5.5.1.m1.2.2.1.3" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.5.5.5.1.m1.2.2.1.3.1" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2.cmml">(</mo><mi id="S5.T2.st2.5.5.5.1.m1.2.2.1.1" xref="S5.T2.st2.5.5.5.1.m1.2.2.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.5.5.5.1.m1.2.2.1.3.2" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2.cmml">)</mo></mrow></msup><mo rspace="0.667em" id="S5.T2.st2.5.5.5.1.m1.5.5.2.5" xref="S5.T2.st2.5.5.5.1.m1.5.5.3.cmml">;</mo><mi id="S5.T2.st2.5.5.5.1.m1.3.3" xref="S5.T2.st2.5.5.5.1.m1.3.3.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.T2.st2.5.5.5.1.m1.5.5.2.6" xref="S5.T2.st2.5.5.5.1.m1.5.5.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.st2.5.5.5.1.m1.5b"><list id="S5.T2.st2.5.5.5.1.m1.5.5.3.cmml" xref="S5.T2.st2.5.5.5.1.m1.5.5.2"><apply id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1"><times id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.2.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.2"></times><ci id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.3.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.3">𝐸</ci><apply id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4">subscript</csymbol><ci id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.2.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.2">𝑛</ci><ci id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.3.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.4.3">𝑓</ci></apply><apply id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1">superscript</csymbol><ci id="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S5.T2.st2.5.5.5.1.m1.4.4.1.1.1.1.1.2">𝑴</ci><ci id="S5.T2.st2.5.5.5.1.m1.1.1.1.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.1.1.1.1">𝑻</ci></apply></apply><apply id="S5.T2.st2.5.5.5.1.m1.5.5.2.2.cmml" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S5.T2.st2.5.5.5.1.m1.5.5.2.2.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2">superscript</csymbol><ci id="S5.T2.st2.5.5.5.1.m1.5.5.2.2.2.cmml" xref="S5.T2.st2.5.5.5.1.m1.5.5.2.2.2">𝒎</ci><ci id="S5.T2.st2.5.5.5.1.m1.2.2.1.1.cmml" xref="S5.T2.st2.5.5.5.1.m1.2.2.1.1">𝑻</ci></apply><ci id="S5.T2.st2.5.5.5.1.m1.3.3.cmml" xref="S5.T2.st2.5.5.5.1.m1.3.3">𝒒</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.5.5.5.1.m1.5c">\big{[}En_{f}(\bm{M^{(T)}});\ \bm{m^{(T)}};\ \bm{q}\big{]}</annotation></semantics></math></td>
<td id="S5.T2.st2.5.5.5.3" class="ltx_td ltx_align_center">68.12</td>
</tr>
<tr id="S5.T2.st2.6.6.6" class="ltx_tr">
<td id="S5.T2.st2.6.6.6.2" class="ltx_td ltx_align_left ltx_border_rr">DSMN*</td>
<td id="S5.T2.st2.6.6.6.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S5.T2.st2.6.6.6.1.m1.3" class="ltx_Math" alttext="\big{[}\bm{m^{(T)}};\ \bm{q}\big{]}" display="inline"><semantics id="S5.T2.st2.6.6.6.1.m1.3a"><mrow id="S5.T2.st2.6.6.6.1.m1.3.3.1" xref="S5.T2.st2.6.6.6.1.m1.3.3.2.cmml"><mo maxsize="120%" minsize="120%" id="S5.T2.st2.6.6.6.1.m1.3.3.1.2" xref="S5.T2.st2.6.6.6.1.m1.3.3.2.cmml">[</mo><msup id="S5.T2.st2.6.6.6.1.m1.3.3.1.1" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1.cmml"><mi id="S5.T2.st2.6.6.6.1.m1.3.3.1.1.2" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1.2.cmml">𝒎</mi><mrow id="S5.T2.st2.6.6.6.1.m1.1.1.1.3" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.6.6.6.1.m1.1.1.1.3.1" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1.cmml">(</mo><mi id="S5.T2.st2.6.6.6.1.m1.1.1.1.1" xref="S5.T2.st2.6.6.6.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.6.6.6.1.m1.1.1.1.3.2" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1.cmml">)</mo></mrow></msup><mo rspace="0.667em" id="S5.T2.st2.6.6.6.1.m1.3.3.1.3" xref="S5.T2.st2.6.6.6.1.m1.3.3.2.cmml">;</mo><mi id="S5.T2.st2.6.6.6.1.m1.2.2" xref="S5.T2.st2.6.6.6.1.m1.2.2.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.T2.st2.6.6.6.1.m1.3.3.1.4" xref="S5.T2.st2.6.6.6.1.m1.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.st2.6.6.6.1.m1.3b"><list id="S5.T2.st2.6.6.6.1.m1.3.3.2.cmml" xref="S5.T2.st2.6.6.6.1.m1.3.3.1"><apply id="S5.T2.st2.6.6.6.1.m1.3.3.1.1.cmml" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S5.T2.st2.6.6.6.1.m1.3.3.1.1.1.cmml" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1">superscript</csymbol><ci id="S5.T2.st2.6.6.6.1.m1.3.3.1.1.2.cmml" xref="S5.T2.st2.6.6.6.1.m1.3.3.1.1.2">𝒎</ci><ci id="S5.T2.st2.6.6.6.1.m1.1.1.1.1.cmml" xref="S5.T2.st2.6.6.6.1.m1.1.1.1.1">𝑻</ci></apply><ci id="S5.T2.st2.6.6.6.1.m1.2.2.cmml" xref="S5.T2.st2.6.6.6.1.m1.2.2">𝒒</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.6.6.6.1.m1.3c">\big{[}\bm{m^{(T)}};\ \bm{q}\big{]}</annotation></semantics></math></td>
<td id="S5.T2.st2.6.6.6.3" class="ltx_td ltx_align_center">97.24</td>
</tr>
<tr id="S5.T2.st2.7.7.7" class="ltx_tr">
<td id="S5.T2.st2.7.7.7.2" class="ltx_td ltx_align_left ltx_border_rr">DSMN*</td>
<td id="S5.T2.st2.7.7.7.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S5.T2.st2.7.7.7.1.m1.3" class="ltx_Math" alttext="\big{[}En_{f}(\bm{M^{(T)}});\ \bm{q}\big{]}" display="inline"><semantics id="S5.T2.st2.7.7.7.1.m1.3a"><mrow id="S5.T2.st2.7.7.7.1.m1.3.3.1" xref="S5.T2.st2.7.7.7.1.m1.3.3.2.cmml"><mo maxsize="120%" minsize="120%" id="S5.T2.st2.7.7.7.1.m1.3.3.1.2" xref="S5.T2.st2.7.7.7.1.m1.3.3.2.cmml">[</mo><mrow id="S5.T2.st2.7.7.7.1.m1.3.3.1.1" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.cmml"><mi id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.3" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.2" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.2.cmml">​</mo><msub id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.cmml"><mi id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.2" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.2.cmml">n</mi><mi id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.3" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.2a" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.2.cmml">​</mo><mrow id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.2" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml">(</mo><msup id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.2" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S5.T2.st2.7.7.7.1.m1.1.1.1.3" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.7.7.7.1.m1.1.1.1.3.1" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S5.T2.st2.7.7.7.1.m1.1.1.1.1" xref="S5.T2.st2.7.7.7.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.7.7.7.1.m1.1.1.1.3.2" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.3" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.667em" id="S5.T2.st2.7.7.7.1.m1.3.3.1.3" xref="S5.T2.st2.7.7.7.1.m1.3.3.2.cmml">;</mo><mi id="S5.T2.st2.7.7.7.1.m1.2.2" xref="S5.T2.st2.7.7.7.1.m1.2.2.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.T2.st2.7.7.7.1.m1.3.3.1.4" xref="S5.T2.st2.7.7.7.1.m1.3.3.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.st2.7.7.7.1.m1.3b"><list id="S5.T2.st2.7.7.7.1.m1.3.3.2.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1"><apply id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1"><times id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.2.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.2"></times><ci id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.3.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.3">𝐸</ci><apply id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.1.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4">subscript</csymbol><ci id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.2.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.2">𝑛</ci><ci id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.3.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.4.3">𝑓</ci></apply><apply id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S5.T2.st2.7.7.7.1.m1.3.3.1.1.1.1.1.2">𝑴</ci><ci id="S5.T2.st2.7.7.7.1.m1.1.1.1.1.cmml" xref="S5.T2.st2.7.7.7.1.m1.1.1.1.1">𝑻</ci></apply></apply><ci id="S5.T2.st2.7.7.7.1.m1.2.2.cmml" xref="S5.T2.st2.7.7.7.1.m1.2.2">𝒒</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.7.7.7.1.m1.3c">\big{[}En_{f}(\bm{M^{(T)}});\ \bm{q}\big{]}</annotation></semantics></math></td>
<td id="S5.T2.st2.7.7.7.3" class="ltx_td ltx_align_center">95.17</td>
</tr>
<tr id="S5.T2.st2.8.8.8" class="ltx_tr">
<td id="S5.T2.st2.8.8.8.2" class="ltx_td ltx_align_left ltx_border_rr">DSMN*</td>
<td id="S5.T2.st2.8.8.8.1" class="ltx_td ltx_align_left ltx_border_r"><math id="S5.T2.st2.8.8.8.1.m1.5" class="ltx_Math" alttext="\big{[}En_{f}(\bm{M^{(T)}});\ \bm{m^{(T)}};\ \bm{q}\big{]}" display="inline"><semantics id="S5.T2.st2.8.8.8.1.m1.5a"><mrow id="S5.T2.st2.8.8.8.1.m1.5.5.2" xref="S5.T2.st2.8.8.8.1.m1.5.5.3.cmml"><mo maxsize="120%" minsize="120%" id="S5.T2.st2.8.8.8.1.m1.5.5.2.3" xref="S5.T2.st2.8.8.8.1.m1.5.5.3.cmml">[</mo><mrow id="S5.T2.st2.8.8.8.1.m1.4.4.1.1" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.cmml"><mi id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.3" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.2" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.2.cmml">​</mo><msub id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.cmml"><mi id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.2" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.2.cmml">n</mi><mi id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.3" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.2a" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.2.cmml">​</mo><mrow id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.2" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml">(</mo><msup id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.2" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S5.T2.st2.8.8.8.1.m1.1.1.1.3" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.8.8.8.1.m1.1.1.1.3.1" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S5.T2.st2.8.8.8.1.m1.1.1.1.1" xref="S5.T2.st2.8.8.8.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.8.8.8.1.m1.1.1.1.3.2" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.3" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.667em" id="S5.T2.st2.8.8.8.1.m1.5.5.2.4" xref="S5.T2.st2.8.8.8.1.m1.5.5.3.cmml">;</mo><msup id="S5.T2.st2.8.8.8.1.m1.5.5.2.2" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2.cmml"><mi id="S5.T2.st2.8.8.8.1.m1.5.5.2.2.2" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2.2.cmml">𝒎</mi><mrow id="S5.T2.st2.8.8.8.1.m1.2.2.1.3" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.8.8.8.1.m1.2.2.1.3.1" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2.cmml">(</mo><mi id="S5.T2.st2.8.8.8.1.m1.2.2.1.1" xref="S5.T2.st2.8.8.8.1.m1.2.2.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.8.8.8.1.m1.2.2.1.3.2" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2.cmml">)</mo></mrow></msup><mo rspace="0.667em" id="S5.T2.st2.8.8.8.1.m1.5.5.2.5" xref="S5.T2.st2.8.8.8.1.m1.5.5.3.cmml">;</mo><mi id="S5.T2.st2.8.8.8.1.m1.3.3" xref="S5.T2.st2.8.8.8.1.m1.3.3.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.T2.st2.8.8.8.1.m1.5.5.2.6" xref="S5.T2.st2.8.8.8.1.m1.5.5.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.st2.8.8.8.1.m1.5b"><list id="S5.T2.st2.8.8.8.1.m1.5.5.3.cmml" xref="S5.T2.st2.8.8.8.1.m1.5.5.2"><apply id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1"><times id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.2.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.2"></times><ci id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.3.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.3">𝐸</ci><apply id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4">subscript</csymbol><ci id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.2.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.2">𝑛</ci><ci id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.3.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.4.3">𝑓</ci></apply><apply id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1">superscript</csymbol><ci id="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S5.T2.st2.8.8.8.1.m1.4.4.1.1.1.1.1.2">𝑴</ci><ci id="S5.T2.st2.8.8.8.1.m1.1.1.1.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.1.1.1.1">𝑻</ci></apply></apply><apply id="S5.T2.st2.8.8.8.1.m1.5.5.2.2.cmml" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S5.T2.st2.8.8.8.1.m1.5.5.2.2.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2">superscript</csymbol><ci id="S5.T2.st2.8.8.8.1.m1.5.5.2.2.2.cmml" xref="S5.T2.st2.8.8.8.1.m1.5.5.2.2.2">𝒎</ci><ci id="S5.T2.st2.8.8.8.1.m1.2.2.1.1.cmml" xref="S5.T2.st2.8.8.8.1.m1.2.2.1.1">𝑻</ci></apply><ci id="S5.T2.st2.8.8.8.1.m1.3.3.cmml" xref="S5.T2.st2.8.8.8.1.m1.3.3">𝒒</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.8.8.8.1.m1.5c">\big{[}En_{f}(\bm{M^{(T)}});\ \bm{m^{(T)}};\ \bm{q}\big{]}</annotation></semantics></math></td>
<td id="S5.T2.st2.8.8.8.3" class="ltx_td ltx_align_center">98.08</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(b) </span>The validation set performances for the ablation study on the usefulness of tag (<math id="S5.T2.st2.12.m1.1" class="ltx_Math" alttext="\bm{m^{(T)}}" display="inline"><semantics id="S5.T2.st2.12.m1.1b"><msup id="S5.T2.st2.12.m1.1.2" xref="S5.T2.st2.12.m1.1.2.cmml"><mi id="S5.T2.st2.12.m1.1.2.2" xref="S5.T2.st2.12.m1.1.2.2.cmml">𝒎</mi><mrow id="S5.T2.st2.12.m1.1.1.1.3" xref="S5.T2.st2.12.m1.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.12.m1.1.1.1.3.1" xref="S5.T2.st2.12.m1.1.2.cmml">(</mo><mi id="S5.T2.st2.12.m1.1.1.1.1" xref="S5.T2.st2.12.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.12.m1.1.1.1.3.2" xref="S5.T2.st2.12.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T2.st2.12.m1.1c"><apply id="S5.T2.st2.12.m1.1.2.cmml" xref="S5.T2.st2.12.m1.1.2"><csymbol cd="ambiguous" id="S5.T2.st2.12.m1.1.2.1.cmml" xref="S5.T2.st2.12.m1.1.2">superscript</csymbol><ci id="S5.T2.st2.12.m1.1.2.2.cmml" xref="S5.T2.st2.12.m1.1.2.2">𝒎</ci><ci id="S5.T2.st2.12.m1.1.1.1.1.cmml" xref="S5.T2.st2.12.m1.1.1.1.1">𝑻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.12.m1.1d">\bm{m^{(T)}}</annotation></semantics></math>) and 2D spatial memory (<math id="S5.T2.st2.13.m2.1" class="ltx_Math" alttext="\bm{M^{(T)}}" display="inline"><semantics id="S5.T2.st2.13.m2.1b"><msup id="S5.T2.st2.13.m2.1.2" xref="S5.T2.st2.13.m2.1.2.cmml"><mi id="S5.T2.st2.13.m2.1.2.2" xref="S5.T2.st2.13.m2.1.2.2.cmml">𝑴</mi><mrow id="S5.T2.st2.13.m2.1.1.1.3" xref="S5.T2.st2.13.m2.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.13.m2.1.1.1.3.1" xref="S5.T2.st2.13.m2.1.2.cmml">(</mo><mi id="S5.T2.st2.13.m2.1.1.1.1" xref="S5.T2.st2.13.m2.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.T2.st2.13.m2.1.1.1.3.2" xref="S5.T2.st2.13.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.T2.st2.13.m2.1c"><apply id="S5.T2.st2.13.m2.1.2.cmml" xref="S5.T2.st2.13.m2.1.2"><csymbol cd="ambiguous" id="S5.T2.st2.13.m2.1.2.1.cmml" xref="S5.T2.st2.13.m2.1.2">superscript</csymbol><ci id="S5.T2.st2.13.m2.1.2.2.cmml" xref="S5.T2.st2.13.m2.1.2.2">𝑴</ci><ci id="S5.T2.st2.13.m2.1.1.1.1.cmml" xref="S5.T2.st2.13.m2.1.1.1.1">𝑻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.13.m2.1d">\bm{M^{(T)}}</annotation></semantics></math>) in the answer feature vector for <math id="S5.T2.st2.14.m3.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S5.T2.st2.14.m3.1b"><mi id="S5.T2.st2.14.m3.1.1" xref="S5.T2.st2.14.m3.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S5.T2.st2.14.m3.1c"><ci id="S5.T2.st2.14.m3.1.1.cmml" xref="S5.T2.st2.14.m3.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.st2.14.m3.1d">\bm{f}</annotation></semantics></math>.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.T2.st3" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S5.T2.st3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.st3.1.1.1" class="ltx_tr">
<th id="S5.T2.st3.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_rr"></th>
<td id="S5.T2.st3.1.1.1.2" class="ltx_td ltx_align_center">FloorPlanQA</td>
</tr>
<tr id="S5.T2.st3.1.2.2" class="ltx_tr">
<th id="S5.T2.st3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MODEL</th>
<td id="S5.T2.st3.1.2.2.2" class="ltx_td ltx_align_center">(accuracy in %)</td>
</tr>
<tr id="S5.T2.st3.1.3.3" class="ltx_tr">
<th id="S5.T2.st3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">1-Hop DSMN</th>
<td id="S5.T2.st3.1.3.3.2" class="ltx_td ltx_align_center ltx_border_tt">63.32</td>
</tr>
<tr id="S5.T2.st3.1.4.4" class="ltx_tr">
<th id="S5.T2.st3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">2-Hop DSMN</th>
<td id="S5.T2.st3.1.4.4.2" class="ltx_td ltx_align_center">65.59</td>
</tr>
<tr id="S5.T2.st3.1.5.5" class="ltx_tr">
<th id="S5.T2.st3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">3-Hop DSMN</th>
<td id="S5.T2.st3.1.5.5.2" class="ltx_td ltx_align_center">68.12</td>
</tr>
<tr id="S5.T2.st3.1.6.6" class="ltx_tr">
<th id="S5.T2.st3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">1-Hop DSMN*</th>
<td id="S5.T2.st3.1.6.6.2" class="ltx_td ltx_align_center">90.09</td>
</tr>
<tr id="S5.T2.st3.1.7.7" class="ltx_tr">
<th id="S5.T2.st3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">2-Hop DSMN*</th>
<td id="S5.T2.st3.1.7.7.2" class="ltx_td ltx_align_center">97.45</td>
</tr>
<tr id="S5.T2.st3.1.8.8" class="ltx_tr">
<th id="S5.T2.st3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">3-Hop DSMN*</th>
<td id="S5.T2.st3.1.8.8.2" class="ltx_td ltx_align_center">98.08</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">(c) </span>The validation set performance for the ablation study on variation in performance with hops.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Experimental results showing comparison with baselines, and ablation study of DSMN</figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1805.11025/assets/fig/part1.png" id="S5.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="628" height="284" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Test set rmse on ShapeIntersection.</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/1805.11025/assets/fig/part2.png" id="S5.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="628" height="277" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Test set accuracy on FloorPlanQA.</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance of DSMN* with varying percentage of intermediate visual supervision.</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1805.11025/assets/fig/visualize4.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="553" height="120" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Attention values on each sentence during different memory ‘hops’ for a sample from FloorPlanQA. Darker color indicates more attention. To answer, one needs the location of room 1’s door and the house door. To infer the location of room 1’s door, DSMN* directly jumps to sent. 3. Since DMN+ does not form a visual representation, it tries to infer the location of room 1’s door w.r.t the house by finding the location of the room’s door w.r.t the room (sent. 3) and the location of the room w.r.t the house (sent. 2). Both DSMN* and DMN+ use one hop to infer the location of the house door (sent. 1).</figcaption>
</figure>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.1" class="ltx_p"><span id="S5.p4.1.1" class="ltx_text ltx_font_bold">Training Details:</span>
We used ADAM <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a href="#bib.bib13" title="" class="ltx_ref">2014</a>)</cite> to train all models, and the learning rate for each model is tuned for each dataset. We tune the embedding size and <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S5.p4.1.m1.1a"><msub id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml"><mi id="S5.p4.1.m1.1.1.2" xref="S5.p4.1.m1.1.1.2.cmml">l</mi><mn id="S5.p4.1.m1.1.1.3" xref="S5.p4.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><apply id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p4.1.m1.1.1.1.cmml" xref="S5.p4.1.m1.1.1">subscript</csymbol><ci id="S5.p4.1.m1.1.1.2.cmml" xref="S5.p4.1.m1.1.1.2">𝑙</ci><cn type="integer" id="S5.p4.1.m1.1.1.3.cmml" xref="S5.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">l_{2}</annotation></semantics></math> regularization weight for each model and dataset pair separately. For reproducibility, the value of the best-tuned hyperparameters is mentioned in the appendix. As reported by <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>; Kumar et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>; Henaff et al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite>, we also observe that the results of memory networks are unstable across multiple runs. Therefore for each hyperparameter choice, we run all the models 10 times and select the run with the best performance on the validation set. For FloorPlanQA, all models are trained up to a maximum of 1600 epochs, with early stopping after 80 epochs if the validation accuracy did not increase. The maximum number of epochs for ShapeIntersection is 800 epochs, with early stopping after 80 epochs. Additionally, we modify the input module and question module of DMN+ and MemN2N to be same as ours for the ShapeIntersection dataset.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p">For MemN2N, we use the publicly available implementation<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://github.com/domluna/memn2n" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/domluna/memn2n</a></span></span></span> and train it exactly as all other models (same optimizer, total epochs, and early stopping criteria) for fairness. While the reported best result for MemN2N is on the version with position encoding, linear start training, and random-injection of time index noise <cite class="ltx_cite ltx_citemacro_citep">(Sukhbaatar et al., <a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite>, the version we use has only position encoding. Note that the comparison is still meaningful because linear start training and time index noise are not used in DMN+ (and as a result, neither in our proposed DSMN).</p>
</div>
<div id="S5.p6" class="ltx_para ltx_noindent">
<p id="S5.p6.1" class="ltx_p"><span id="S5.p6.1.1" class="ltx_text ltx_font_bold">Results:</span>
The results for FloorPlanQA and ShapeIntersection are summarized in Table <a href="#S5.T2.st1" title="Table 2(a) ‣ Table 2 ‣ 5 Experiments ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(a)</span></a>. For brevity, we will refer to the DSMN model trained without intermediate visual supervision as DSMN, and the one with intermediate visual supervision as DSMN*. We see that DSMN (i.e the one without intermediate supervision) outperforms DMN+, MemN2N and the LSTM baselines on both datasets. However, we consider DSMN to be only slightly better than DMN+ because both are observed to be unstable across multiple runs and so the gap between the two has a large variance. Finally, DSMN* outperforms all other approaches by a large margin on both datasets, which demonstrates the utility of visual supervision in proposed tasks. While the variation can be significant across runs, if we run each model 10 times and choose the best run, we observe consistent results. We visualized the intermediate visual representations, but when no visual supervision is provided, they were not interpretable (sometimes they looked like random noise, sometimes blank). In the case when visual supervision is provided, the intermediate visual representation is well-formed and similar to the ground-truth.</p>
</div>
<div id="S5.p7" class="ltx_para">
<p id="S5.p7.1" class="ltx_p">We further investigate how DSMN* performs when intermediate visual supervision is available for only a portion of training samples. As shown in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5 Experiments ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, DSMN* outperforms DMN+ by a large margin, even when intermediate visual supervision is provided for only <math id="S5.p7.1.m1.1" class="ltx_Math" alttext="~{}1\%" display="inline"><semantics id="S5.p7.1.m1.1a"><mrow id="S5.p7.1.m1.1.1" xref="S5.p7.1.m1.1.1.cmml"><mn id="S5.p7.1.m1.1.1.2" xref="S5.p7.1.m1.1.1.2.cmml">1</mn><mo id="S5.p7.1.m1.1.1.1" xref="S5.p7.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.1.m1.1b"><apply id="S5.p7.1.m1.1.1.cmml" xref="S5.p7.1.m1.1.1"><csymbol cd="latexml" id="S5.p7.1.m1.1.1.1.cmml" xref="S5.p7.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.p7.1.m1.1.1.2.cmml" xref="S5.p7.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.1.m1.1c">~{}1\%</annotation></semantics></math> of the training samples. This can be useful when obtaining visual representations is expensive and time-consuming. One possible justification for why visual supervision (even in a small amount) helps a lot is that it constrains the high­-dimensional space of possible intermediate visual representations. With limited data and no explicit supervision, automatically learning these high-dimensional representations can be difficult.</p>
</div>
<div id="S5.p8" class="ltx_para">
<p id="S5.p8.7" class="ltx_p">Additonally, we performed ablation study (see Table <a href="#S5.T2.st2" title="Table 2(b) ‣ Table 2 ‣ 5 Experiments ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(b)</span></a>) on the usefulness of final memory tag vector (<math id="S5.p8.1.m1.1" class="ltx_Math" alttext="\bm{m^{(T)}}" display="inline"><semantics id="S5.p8.1.m1.1a"><msup id="S5.p8.1.m1.1.2" xref="S5.p8.1.m1.1.2.cmml"><mi id="S5.p8.1.m1.1.2.2" xref="S5.p8.1.m1.1.2.2.cmml">𝒎</mi><mrow id="S5.p8.1.m1.1.1.1.3" xref="S5.p8.1.m1.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.1.m1.1.1.1.3.1" xref="S5.p8.1.m1.1.2.cmml">(</mo><mi id="S5.p8.1.m1.1.1.1.1" xref="S5.p8.1.m1.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.1.m1.1.1.1.3.2" xref="S5.p8.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.p8.1.m1.1b"><apply id="S5.p8.1.m1.1.2.cmml" xref="S5.p8.1.m1.1.2"><csymbol cd="ambiguous" id="S5.p8.1.m1.1.2.1.cmml" xref="S5.p8.1.m1.1.2">superscript</csymbol><ci id="S5.p8.1.m1.1.2.2.cmml" xref="S5.p8.1.m1.1.2.2">𝒎</ci><ci id="S5.p8.1.m1.1.1.1.1.cmml" xref="S5.p8.1.m1.1.1.1.1">𝑻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.1.m1.1c">\bm{m^{(T)}}</annotation></semantics></math>) and 2D spatial memory (<math id="S5.p8.2.m2.1" class="ltx_Math" alttext="\bm{M^{(T)}}" display="inline"><semantics id="S5.p8.2.m2.1a"><msup id="S5.p8.2.m2.1.2" xref="S5.p8.2.m2.1.2.cmml"><mi id="S5.p8.2.m2.1.2.2" xref="S5.p8.2.m2.1.2.2.cmml">𝑴</mi><mrow id="S5.p8.2.m2.1.1.1.3" xref="S5.p8.2.m2.1.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.2.m2.1.1.1.3.1" xref="S5.p8.2.m2.1.2.cmml">(</mo><mi id="S5.p8.2.m2.1.1.1.1" xref="S5.p8.2.m2.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.2.m2.1.1.1.3.2" xref="S5.p8.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.p8.2.m2.1b"><apply id="S5.p8.2.m2.1.2.cmml" xref="S5.p8.2.m2.1.2"><csymbol cd="ambiguous" id="S5.p8.2.m2.1.2.1.cmml" xref="S5.p8.2.m2.1.2">superscript</csymbol><ci id="S5.p8.2.m2.1.2.2.cmml" xref="S5.p8.2.m2.1.2.2">𝑴</ci><ci id="S5.p8.2.m2.1.1.1.1.cmml" xref="S5.p8.2.m2.1.1.1.1">𝑻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.2.m2.1c">\bm{M^{(T)}}</annotation></semantics></math>) in the answer feature vector <math id="S5.p8.3.m3.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S5.p8.3.m3.1a"><mi id="S5.p8.3.m3.1.1" xref="S5.p8.3.m3.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S5.p8.3.m3.1b"><ci id="S5.p8.3.m3.1.1.cmml" xref="S5.p8.3.m3.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.3.m3.1c">\bm{f}</annotation></semantics></math> (see Eqn. <a href="#S4.E4" title="Equation 4 ‣ 4 Dynamic Spatial Memory Network ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). We removed each of them one at a time, and retrained (with hyperparameter tuning) the DSMN and DSMN* models. Note that they are removed only from the final feature vector <math id="S5.p8.4.m4.1" class="ltx_Math" alttext="\bm{f}" display="inline"><semantics id="S5.p8.4.m4.1a"><mi id="S5.p8.4.m4.1.1" xref="S5.p8.4.m4.1.1.cmml">𝒇</mi><annotation-xml encoding="MathML-Content" id="S5.p8.4.m4.1b"><ci id="S5.p8.4.m4.1.1.cmml" xref="S5.p8.4.m4.1.1">𝒇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.4.m4.1c">\bm{f}</annotation></semantics></math>, and both of them are still coupled. The model with both tag and 2D spatial memory (<math id="S5.p8.5.m5.5" class="ltx_Math" alttext="\bm{f}=\big{[}En_{f}(\bm{M^{(T)}});\bm{m^{(T)}};\bm{q}\big{]}" display="inline"><semantics id="S5.p8.5.m5.5a"><mrow id="S5.p8.5.m5.5.5" xref="S5.p8.5.m5.5.5.cmml"><mi id="S5.p8.5.m5.5.5.4" xref="S5.p8.5.m5.5.5.4.cmml">𝒇</mi><mo id="S5.p8.5.m5.5.5.3" xref="S5.p8.5.m5.5.5.3.cmml">=</mo><mrow id="S5.p8.5.m5.5.5.2.2" xref="S5.p8.5.m5.5.5.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S5.p8.5.m5.5.5.2.2.3" xref="S5.p8.5.m5.5.5.2.3.cmml">[</mo><mrow id="S5.p8.5.m5.4.4.1.1.1" xref="S5.p8.5.m5.4.4.1.1.1.cmml"><mi id="S5.p8.5.m5.4.4.1.1.1.3" xref="S5.p8.5.m5.4.4.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.p8.5.m5.4.4.1.1.1.2" xref="S5.p8.5.m5.4.4.1.1.1.2.cmml">​</mo><msub id="S5.p8.5.m5.4.4.1.1.1.4" xref="S5.p8.5.m5.4.4.1.1.1.4.cmml"><mi id="S5.p8.5.m5.4.4.1.1.1.4.2" xref="S5.p8.5.m5.4.4.1.1.1.4.2.cmml">n</mi><mi id="S5.p8.5.m5.4.4.1.1.1.4.3" xref="S5.p8.5.m5.4.4.1.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S5.p8.5.m5.4.4.1.1.1.2a" xref="S5.p8.5.m5.4.4.1.1.1.2.cmml">​</mo><mrow id="S5.p8.5.m5.4.4.1.1.1.1.1" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.p8.5.m5.4.4.1.1.1.1.1.2" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml">(</mo><msup id="S5.p8.5.m5.4.4.1.1.1.1.1.1" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml"><mi id="S5.p8.5.m5.4.4.1.1.1.1.1.1.2" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S5.p8.5.m5.1.1.1.3" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.5.m5.1.1.1.3.1" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S5.p8.5.m5.1.1.1.1" xref="S5.p8.5.m5.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.5.m5.1.1.1.3.2" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.p8.5.m5.4.4.1.1.1.1.1.3" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.p8.5.m5.5.5.2.2.4" xref="S5.p8.5.m5.5.5.2.3.cmml">;</mo><msup id="S5.p8.5.m5.5.5.2.2.2" xref="S5.p8.5.m5.5.5.2.2.2.cmml"><mi id="S5.p8.5.m5.5.5.2.2.2.2" xref="S5.p8.5.m5.5.5.2.2.2.2.cmml">𝒎</mi><mrow id="S5.p8.5.m5.2.2.1.3" xref="S5.p8.5.m5.5.5.2.2.2.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.5.m5.2.2.1.3.1" xref="S5.p8.5.m5.5.5.2.2.2.cmml">(</mo><mi id="S5.p8.5.m5.2.2.1.1" xref="S5.p8.5.m5.2.2.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.5.m5.2.2.1.3.2" xref="S5.p8.5.m5.5.5.2.2.2.cmml">)</mo></mrow></msup><mo id="S5.p8.5.m5.5.5.2.2.5" xref="S5.p8.5.m5.5.5.2.3.cmml">;</mo><mi id="S5.p8.5.m5.3.3" xref="S5.p8.5.m5.3.3.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.p8.5.m5.5.5.2.2.6" xref="S5.p8.5.m5.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p8.5.m5.5b"><apply id="S5.p8.5.m5.5.5.cmml" xref="S5.p8.5.m5.5.5"><eq id="S5.p8.5.m5.5.5.3.cmml" xref="S5.p8.5.m5.5.5.3"></eq><ci id="S5.p8.5.m5.5.5.4.cmml" xref="S5.p8.5.m5.5.5.4">𝒇</ci><list id="S5.p8.5.m5.5.5.2.3.cmml" xref="S5.p8.5.m5.5.5.2.2"><apply id="S5.p8.5.m5.4.4.1.1.1.cmml" xref="S5.p8.5.m5.4.4.1.1.1"><times id="S5.p8.5.m5.4.4.1.1.1.2.cmml" xref="S5.p8.5.m5.4.4.1.1.1.2"></times><ci id="S5.p8.5.m5.4.4.1.1.1.3.cmml" xref="S5.p8.5.m5.4.4.1.1.1.3">𝐸</ci><apply id="S5.p8.5.m5.4.4.1.1.1.4.cmml" xref="S5.p8.5.m5.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S5.p8.5.m5.4.4.1.1.1.4.1.cmml" xref="S5.p8.5.m5.4.4.1.1.1.4">subscript</csymbol><ci id="S5.p8.5.m5.4.4.1.1.1.4.2.cmml" xref="S5.p8.5.m5.4.4.1.1.1.4.2">𝑛</ci><ci id="S5.p8.5.m5.4.4.1.1.1.4.3.cmml" xref="S5.p8.5.m5.4.4.1.1.1.4.3">𝑓</ci></apply><apply id="S5.p8.5.m5.4.4.1.1.1.1.1.1.cmml" xref="S5.p8.5.m5.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.p8.5.m5.4.4.1.1.1.1.1.1.1.cmml" xref="S5.p8.5.m5.4.4.1.1.1.1.1">superscript</csymbol><ci id="S5.p8.5.m5.4.4.1.1.1.1.1.1.2.cmml" xref="S5.p8.5.m5.4.4.1.1.1.1.1.1.2">𝑴</ci><ci id="S5.p8.5.m5.1.1.1.1.cmml" xref="S5.p8.5.m5.1.1.1.1">𝑻</ci></apply></apply><apply id="S5.p8.5.m5.5.5.2.2.2.cmml" xref="S5.p8.5.m5.5.5.2.2.2"><csymbol cd="ambiguous" id="S5.p8.5.m5.5.5.2.2.2.1.cmml" xref="S5.p8.5.m5.5.5.2.2.2">superscript</csymbol><ci id="S5.p8.5.m5.5.5.2.2.2.2.cmml" xref="S5.p8.5.m5.5.5.2.2.2.2">𝒎</ci><ci id="S5.p8.5.m5.2.2.1.1.cmml" xref="S5.p8.5.m5.2.2.1.1">𝑻</ci></apply><ci id="S5.p8.5.m5.3.3.cmml" xref="S5.p8.5.m5.3.3">𝒒</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.5.m5.5c">\bm{f}=\big{[}En_{f}(\bm{M^{(T)}});\bm{m^{(T)}};\bm{q}\big{]}</annotation></semantics></math>) performs slightly better than the only tag vector model (<math id="S5.p8.6.m6.3" class="ltx_Math" alttext="\bm{f}=\big{[}\bm{m^{(T)}};\bm{q}\big{]}" display="inline"><semantics id="S5.p8.6.m6.3a"><mrow id="S5.p8.6.m6.3.3" xref="S5.p8.6.m6.3.3.cmml"><mi id="S5.p8.6.m6.3.3.3" xref="S5.p8.6.m6.3.3.3.cmml">𝒇</mi><mo id="S5.p8.6.m6.3.3.2" xref="S5.p8.6.m6.3.3.2.cmml">=</mo><mrow id="S5.p8.6.m6.3.3.1.1" xref="S5.p8.6.m6.3.3.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S5.p8.6.m6.3.3.1.1.2" xref="S5.p8.6.m6.3.3.1.2.cmml">[</mo><msup id="S5.p8.6.m6.3.3.1.1.1" xref="S5.p8.6.m6.3.3.1.1.1.cmml"><mi id="S5.p8.6.m6.3.3.1.1.1.2" xref="S5.p8.6.m6.3.3.1.1.1.2.cmml">𝒎</mi><mrow id="S5.p8.6.m6.1.1.1.3" xref="S5.p8.6.m6.3.3.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.6.m6.1.1.1.3.1" xref="S5.p8.6.m6.3.3.1.1.1.cmml">(</mo><mi id="S5.p8.6.m6.1.1.1.1" xref="S5.p8.6.m6.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.6.m6.1.1.1.3.2" xref="S5.p8.6.m6.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S5.p8.6.m6.3.3.1.1.3" xref="S5.p8.6.m6.3.3.1.2.cmml">;</mo><mi id="S5.p8.6.m6.2.2" xref="S5.p8.6.m6.2.2.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.p8.6.m6.3.3.1.1.4" xref="S5.p8.6.m6.3.3.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p8.6.m6.3b"><apply id="S5.p8.6.m6.3.3.cmml" xref="S5.p8.6.m6.3.3"><eq id="S5.p8.6.m6.3.3.2.cmml" xref="S5.p8.6.m6.3.3.2"></eq><ci id="S5.p8.6.m6.3.3.3.cmml" xref="S5.p8.6.m6.3.3.3">𝒇</ci><list id="S5.p8.6.m6.3.3.1.2.cmml" xref="S5.p8.6.m6.3.3.1.1"><apply id="S5.p8.6.m6.3.3.1.1.1.cmml" xref="S5.p8.6.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="S5.p8.6.m6.3.3.1.1.1.1.cmml" xref="S5.p8.6.m6.3.3.1.1.1">superscript</csymbol><ci id="S5.p8.6.m6.3.3.1.1.1.2.cmml" xref="S5.p8.6.m6.3.3.1.1.1.2">𝒎</ci><ci id="S5.p8.6.m6.1.1.1.1.cmml" xref="S5.p8.6.m6.1.1.1.1">𝑻</ci></apply><ci id="S5.p8.6.m6.2.2.cmml" xref="S5.p8.6.m6.2.2">𝒒</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.6.m6.3c">\bm{f}=\big{[}\bm{m^{(T)}};\bm{q}\big{]}</annotation></semantics></math>). Also, as expected the only 2D spatial memory model (<math id="S5.p8.7.m7.3" class="ltx_Math" alttext="\bm{f}=\big{[}En_{f}(\bm{M^{(T)}});\bm{q}\big{]}" display="inline"><semantics id="S5.p8.7.m7.3a"><mrow id="S5.p8.7.m7.3.3" xref="S5.p8.7.m7.3.3.cmml"><mi id="S5.p8.7.m7.3.3.3" xref="S5.p8.7.m7.3.3.3.cmml">𝒇</mi><mo id="S5.p8.7.m7.3.3.2" xref="S5.p8.7.m7.3.3.2.cmml">=</mo><mrow id="S5.p8.7.m7.3.3.1.1" xref="S5.p8.7.m7.3.3.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S5.p8.7.m7.3.3.1.1.2" xref="S5.p8.7.m7.3.3.1.2.cmml">[</mo><mrow id="S5.p8.7.m7.3.3.1.1.1" xref="S5.p8.7.m7.3.3.1.1.1.cmml"><mi id="S5.p8.7.m7.3.3.1.1.1.3" xref="S5.p8.7.m7.3.3.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S5.p8.7.m7.3.3.1.1.1.2" xref="S5.p8.7.m7.3.3.1.1.1.2.cmml">​</mo><msub id="S5.p8.7.m7.3.3.1.1.1.4" xref="S5.p8.7.m7.3.3.1.1.1.4.cmml"><mi id="S5.p8.7.m7.3.3.1.1.1.4.2" xref="S5.p8.7.m7.3.3.1.1.1.4.2.cmml">n</mi><mi id="S5.p8.7.m7.3.3.1.1.1.4.3" xref="S5.p8.7.m7.3.3.1.1.1.4.3.cmml">f</mi></msub><mo lspace="0em" rspace="0em" id="S5.p8.7.m7.3.3.1.1.1.2a" xref="S5.p8.7.m7.3.3.1.1.1.2.cmml">​</mo><mrow id="S5.p8.7.m7.3.3.1.1.1.1.1" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.p8.7.m7.3.3.1.1.1.1.1.2" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml">(</mo><msup id="S5.p8.7.m7.3.3.1.1.1.1.1.1" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml"><mi id="S5.p8.7.m7.3.3.1.1.1.1.1.1.2" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.2.cmml">𝑴</mi><mrow id="S5.p8.7.m7.1.1.1.3" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.7.m7.1.1.1.3.1" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S5.p8.7.m7.1.1.1.1" xref="S5.p8.7.m7.1.1.1.1.cmml">𝑻</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" stretchy="false" id="S5.p8.7.m7.1.1.1.3.2" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.p8.7.m7.3.3.1.1.1.1.1.3" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.p8.7.m7.3.3.1.1.3" xref="S5.p8.7.m7.3.3.1.2.cmml">;</mo><mi id="S5.p8.7.m7.2.2" xref="S5.p8.7.m7.2.2.cmml">𝒒</mi><mo maxsize="120%" minsize="120%" id="S5.p8.7.m7.3.3.1.1.4" xref="S5.p8.7.m7.3.3.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p8.7.m7.3b"><apply id="S5.p8.7.m7.3.3.cmml" xref="S5.p8.7.m7.3.3"><eq id="S5.p8.7.m7.3.3.2.cmml" xref="S5.p8.7.m7.3.3.2"></eq><ci id="S5.p8.7.m7.3.3.3.cmml" xref="S5.p8.7.m7.3.3.3">𝒇</ci><list id="S5.p8.7.m7.3.3.1.2.cmml" xref="S5.p8.7.m7.3.3.1.1"><apply id="S5.p8.7.m7.3.3.1.1.1.cmml" xref="S5.p8.7.m7.3.3.1.1.1"><times id="S5.p8.7.m7.3.3.1.1.1.2.cmml" xref="S5.p8.7.m7.3.3.1.1.1.2"></times><ci id="S5.p8.7.m7.3.3.1.1.1.3.cmml" xref="S5.p8.7.m7.3.3.1.1.1.3">𝐸</ci><apply id="S5.p8.7.m7.3.3.1.1.1.4.cmml" xref="S5.p8.7.m7.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S5.p8.7.m7.3.3.1.1.1.4.1.cmml" xref="S5.p8.7.m7.3.3.1.1.1.4">subscript</csymbol><ci id="S5.p8.7.m7.3.3.1.1.1.4.2.cmml" xref="S5.p8.7.m7.3.3.1.1.1.4.2">𝑛</ci><ci id="S5.p8.7.m7.3.3.1.1.1.4.3.cmml" xref="S5.p8.7.m7.3.3.1.1.1.4.3">𝑓</ci></apply><apply id="S5.p8.7.m7.3.3.1.1.1.1.1.1.cmml" xref="S5.p8.7.m7.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.p8.7.m7.3.3.1.1.1.1.1.1.1.cmml" xref="S5.p8.7.m7.3.3.1.1.1.1.1">superscript</csymbol><ci id="S5.p8.7.m7.3.3.1.1.1.1.1.1.2.cmml" xref="S5.p8.7.m7.3.3.1.1.1.1.1.1.2">𝑴</ci><ci id="S5.p8.7.m7.1.1.1.1.cmml" xref="S5.p8.7.m7.1.1.1.1">𝑻</ci></apply></apply><ci id="S5.p8.7.m7.2.2.cmml" xref="S5.p8.7.m7.2.2">𝒒</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p8.7.m7.3c">\bm{f}=\big{[}En_{f}(\bm{M^{(T)}});\bm{q}\big{]}</annotation></semantics></math>) performs much better for DSMN* than DSMN becuase of the intermdiate supervision.</p>
</div>
<div id="S5.p9" class="ltx_para">
<p id="S5.p9.1" class="ltx_p">Further, Table <a href="#S5.T2.st3" title="Table 2(c) ‣ Table 2 ‣ 5 Experiments ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2(c)</span></a> shows the effect of varying the number of memory ‘hops’ for DSMN and DSMN* on FloorPlanQA. The performance of both DSMN and DSMN* increases with the number of ‘hops’. Note that even the 1-hop DSMN* performs well (better than baselines). Also, note that the difference in performance between 2-hop DSMN* and 3-hop DSMN* is not much. A possible justification for why DSMN* performs well even with fewer memory ‘hops’ is that DSMN* completes some ‘hops of reasoning’ in the visual representation module itself. Suppose one needs to find the location of an object placed in a room, w.r.t. the house. To do so, one first needs to find the location of the room w.r.t. the house, and then the location of the object w.r.t. the room. However, if one has already ‘sketched’ out the location of the object in the house, one can directly fetch it. It is during sketching the object’s location that one has completed a ‘hop of reasoning’. For a sample from FloorPlanQA, we visualize the attention maps in the memory module of 3-hop DMN+ and 3-hop DSMN* in Fig. <a href="#S5.F5" title="Figure 5 ‣ 5 Experiments ‣ Think Visually: Question Answering through Virtual Imagery" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. To infer the location of room 1’s door, DSMN* directly fetches sentence 3, while DMN+ tries to do so by fetching two sentences (one for the room’s door location w.r.t the room and one for the room’s location w.r.t the house).</p>
</div>
<div id="S5.p10" class="ltx_para ltx_noindent">
<p id="S5.p10.1" class="ltx_p"><span id="S5.p10.1.1" class="ltx_text ltx_font_bold">Conclusion:</span> We have investigated how to use DNNs for modeling visual thinking. We have introduced two synthetic QA datasets, FloorPlanQA and ShapeIntersection, that test a system’s ability to think visually. We have developed DSMN, a novel DNN that reasons in the visual space for answering questions. Experimental results have demonstrated the effectiveness of DSMN for geometric reasoning on synthetic data.</p>
</div>
<div id="S5.p11" class="ltx_para ltx_noindent">
<p id="S5.p11.1" class="ltx_p"><span id="S5.p11.1.1" class="ltx_text ltx_font_bold">Acknowledgements:</span> This work is partially supported by the National Science Foundation under Grant No. 1633157.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>

<figure id="A1.T3" class="ltx_table">
<table id="A1.T3.1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T3.1.1.1" class="ltx_tr">
<th id="A1.T3.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr">MODEL</th>
<th id="A1.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Embedding size</th>
<th id="A1.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<math id="A1.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="A1.T3.1.1.1.1.m1.1a"><msub id="A1.T3.1.1.1.1.m1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.cmml"><mi id="A1.T3.1.1.1.1.m1.1.1.2" xref="A1.T3.1.1.1.1.m1.1.1.2.cmml">l</mi><mn id="A1.T3.1.1.1.1.m1.1.1.3" xref="A1.T3.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.1.m1.1b"><apply id="A1.T3.1.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T3.1.1.1.1.m1.1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.T3.1.1.1.1.m1.1.1.2.cmml" xref="A1.T3.1.1.1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="A1.T3.1.1.1.1.m1.1.1.3.cmml" xref="A1.T3.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.1.m1.1c">l_{2}</annotation></semantics></math> regularization</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T3.1.1.2.1" class="ltx_tr">
<th id="A1.T3.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">LSTM-1</th>
<td id="A1.T3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">128</td>
<td id="A1.T3.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt">1e-4</td>
</tr>
<tr id="A1.T3.1.1.3.2" class="ltx_tr">
<th id="A1.T3.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">LSTM-2</th>
<td id="A1.T3.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">512</td>
<td id="A1.T3.1.1.3.2.3" class="ltx_td ltx_align_center">1e-5</td>
</tr>
<tr id="A1.T3.1.1.4.3" class="ltx_tr">
<th id="A1.T3.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MemN2N</th>
<td id="A1.T3.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">64</td>
<td id="A1.T3.1.1.4.3.3" class="ltx_td ltx_align_center">NA</td>
</tr>
<tr id="A1.T3.1.1.5.4" class="ltx_tr">
<th id="A1.T3.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DMN+</th>
<td id="A1.T3.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">64</td>
<td id="A1.T3.1.1.5.4.3" class="ltx_td ltx_align_center">1e-3</td>
</tr>
<tr id="A1.T3.1.1.6.5" class="ltx_tr">
<th id="A1.T3.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DSMN</th>
<td id="A1.T3.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r">32</td>
<td id="A1.T3.1.1.6.5.3" class="ltx_td ltx_align_center">1e-3</td>
</tr>
<tr id="A1.T3.1.1.7.6" class="ltx_tr">
<th id="A1.T3.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DSMN*</th>
<td id="A1.T3.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r">32</td>
<td id="A1.T3.1.1.7.6.3" class="ltx_td ltx_align_center">1e-4</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>The value of the tuned hyper-parameters for all the models on FloorPlanQA. MemN2N <cite class="ltx_cite ltx_citemacro_cite">Sukhbaatar et al. (<a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> model does not use <math id="A1.T3.3.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="A1.T3.3.m1.1b"><msub id="A1.T3.3.m1.1.1" xref="A1.T3.3.m1.1.1.cmml"><mi id="A1.T3.3.m1.1.1.2" xref="A1.T3.3.m1.1.1.2.cmml">l</mi><mn id="A1.T3.3.m1.1.1.3" xref="A1.T3.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T3.3.m1.1c"><apply id="A1.T3.3.m1.1.1.cmml" xref="A1.T3.3.m1.1.1"><csymbol cd="ambiguous" id="A1.T3.3.m1.1.1.1.cmml" xref="A1.T3.3.m1.1.1">subscript</csymbol><ci id="A1.T3.3.m1.1.1.2.cmml" xref="A1.T3.3.m1.1.1.2">𝑙</ci><cn type="integer" id="A1.T3.3.m1.1.1.3.cmml" xref="A1.T3.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.m1.1d">l_{2}</annotation></semantics></math> regularization, so we tuned only the embedding size</figcaption>
</figure>
<figure id="A1.T4" class="ltx_table">
<table id="A1.T4.1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.1.1.1" class="ltx_tr">
<th id="A1.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr">MODEL</th>
<th id="A1.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Embedding size</th>
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">
<math id="A1.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="A1.T4.1.1.1.1.m1.1a"><msub id="A1.T4.1.1.1.1.m1.1.1" xref="A1.T4.1.1.1.1.m1.1.1.cmml"><mi id="A1.T4.1.1.1.1.m1.1.1.2" xref="A1.T4.1.1.1.1.m1.1.1.2.cmml">l</mi><mn id="A1.T4.1.1.1.1.m1.1.1.3" xref="A1.T4.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.1.m1.1b"><apply id="A1.T4.1.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T4.1.1.1.1.m1.1.1.1.cmml" xref="A1.T4.1.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.T4.1.1.1.1.m1.1.1.2.cmml" xref="A1.T4.1.1.1.1.m1.1.1.2">𝑙</ci><cn type="integer" id="A1.T4.1.1.1.1.m1.1.1.3.cmml" xref="A1.T4.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.1.m1.1c">l_{2}</annotation></semantics></math> regularization</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.1.1.2.1" class="ltx_tr">
<th id="A1.T4.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt">LSTM-1</th>
<td id="A1.T4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">2048</td>
<td id="A1.T4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt">0.01</td>
</tr>
<tr id="A1.T4.1.1.3.2" class="ltx_tr">
<th id="A1.T4.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">LSTM-2</th>
<td id="A1.T4.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r">512</td>
<td id="A1.T4.1.1.3.2.3" class="ltx_td ltx_align_center">0.1</td>
</tr>
<tr id="A1.T4.1.1.4.3" class="ltx_tr">
<th id="A1.T4.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">MemN2N</th>
<td id="A1.T4.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r">512</td>
<td id="A1.T4.1.1.4.3.3" class="ltx_td ltx_align_center">NA</td>
</tr>
<tr id="A1.T4.1.1.5.4" class="ltx_tr">
<th id="A1.T4.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DMN+</th>
<td id="A1.T4.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r">128</td>
<td id="A1.T4.1.1.5.4.3" class="ltx_td ltx_align_center">0.1</td>
</tr>
<tr id="A1.T4.1.1.6.5" class="ltx_tr">
<th id="A1.T4.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DSMN</th>
<td id="A1.T4.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r">32</td>
<td id="A1.T4.1.1.6.5.3" class="ltx_td ltx_align_center">0.1</td>
</tr>
<tr id="A1.T4.1.1.7.6" class="ltx_tr">
<th id="A1.T4.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">DSMN*</th>
<td id="A1.T4.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_r">64</td>
<td id="A1.T4.1.1.7.6.3" class="ltx_td ltx_align_center">0.01</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The value of the tuned hyper-parameters for all the models on ShapeIntersection. MemN2N <cite class="ltx_cite ltx_citemacro_cite">Sukhbaatar et al. (<a href="#bib.bib28" title="" class="ltx_ref">2015</a>)</cite> model does not use <math id="A1.T4.3.m1.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="A1.T4.3.m1.1b"><msub id="A1.T4.3.m1.1.1" xref="A1.T4.3.m1.1.1.cmml"><mi id="A1.T4.3.m1.1.1.2" xref="A1.T4.3.m1.1.1.2.cmml">l</mi><mn id="A1.T4.3.m1.1.1.3" xref="A1.T4.3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.T4.3.m1.1c"><apply id="A1.T4.3.m1.1.1.cmml" xref="A1.T4.3.m1.1.1"><csymbol cd="ambiguous" id="A1.T4.3.m1.1.1.1.cmml" xref="A1.T4.3.m1.1.1">subscript</csymbol><ci id="A1.T4.3.m1.1.1.2.cmml" xref="A1.T4.3.m1.1.1.2">𝑙</ci><cn type="integer" id="A1.T4.3.m1.1.1.3.cmml" xref="A1.T4.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.3.m1.1d">l_{2}</annotation></semantics></math> regularization, so we tuned only the embedding size.</figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antol et al. (2015)</span>
<span class="ltx_bibblock">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C Lawrence Zitnick, and Devi Parikh. 2015.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pages 2425–2433.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cho et al. (2014)</span>
<span class="ltx_bibblock">
Kyunghyun Cho, Bart Van Merriënboer, Dzmitry Bahdanau, and Yoshua Bengio.
2014.

</span>
<span class="ltx_bibblock">On the properties of neural machine translation: Encoder-decoder
approaches.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1409.1259</em>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fitting (2012)</span>
<span class="ltx_bibblock">
Melvin Fitting. 2012.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">First-order logic and automated theorem proving</em>.

</span>
<span class="ltx_bibblock">Springer Science &amp; Business Media.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Forbus et al. (1991)</span>
<span class="ltx_bibblock">
Kenneth D Forbus, Paul Nielsen, and Boi Faltings. 1991.

</span>
<span class="ltx_bibblock">Qualitative spatial reasoning: The clock project.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence</em>, 51(1-3):417–471.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et al. (2014)</span>
<span class="ltx_bibblock">
Alex Graves, Greg Wayne, and Ivo Danihelka. 2014.

</span>
<span class="ltx_bibblock">Neural turing machines.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1410.5401</em>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Graves et al. (2016)</span>
<span class="ltx_bibblock">
Alex Graves, Greg Wayne, Malcolm Reynolds, Tim Harley, Ivo Danihelka, Agnieszka
Grabska-Barwińska, Sergio Gómez Colmenarejo, Edward Grefenstette,
Tiago Ramalho, John Agapiou, et al. 2016.

</span>
<span class="ltx_bibblock">Hybrid computing using a neural network with dynamic external memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Nature</em>, pages 471–476.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gregor et al. (2015)</span>
<span class="ltx_bibblock">
Karol Gregor, Ivo Danihelka, Alex Graves, Danilo Jimenez Rezende, and Daan
Wierstra. 2015.

</span>
<span class="ltx_bibblock">Draw: A recurrent neural network for image generation.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1502.04623</em>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gribble et al. (1998)</span>
<span class="ltx_bibblock">
William S Gribble, Robert L Browning, Micheal Hewett, Emilio Remolina, and
Benjamin J Kuipers. 1998.

</span>
<span class="ltx_bibblock">Integrating vision and spatial reasoning for assistive navigation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Assistive Technology and artificial intelligence</em>, pages
179–193.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2017)</span>
<span class="ltx_bibblock">
Saurabh Gupta, James Davidson, Sergey Levine, Rahul Sukthankar, and Jitendra
Malik. 2017.

</span>
<span class="ltx_bibblock">Cognitive mapping and planning for visual navigation.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1702.03920</em>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Henaff et al. (2016)</span>
<span class="ltx_bibblock">
Mikael Henaff, Jason Weston, Arthur Szlam, Antoine Bordes, and Yann LeCun.
2016.

</span>
<span class="ltx_bibblock">Tracking the world state with recurrent entity networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1612.03969</em>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter and Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber. 1997.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, pages 1735–1780.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2016)</span>
<span class="ltx_bibblock">
Justin Johnson, Bharath Hariharan, Laurens van der Maaten, Li Fei-Fei,
C Lawrence Zitnick, and Ross Girshick. 2016.

</span>
<span class="ltx_bibblock">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1612.06890</em>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar et al. (2016)</span>
<span class="ltx_bibblock">
Ankit Kumar, Ozan Irsoy, Peter Ondruska, Mohit Iyyer, James Bradbury, Ishaan
Gulrajani, Victor Zhong, Romain Paulus, and Richard Socher. 2016.

</span>
<span class="ltx_bibblock">Ask me anything: Dynamic memory networks for natural language
processing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ICML</em>, pages 1378–1387.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Landau and Jackendoff (1993)</span>
<span class="ltx_bibblock">
Barbara Landau and Ray Jackendoff. 1993.

</span>
<span class="ltx_bibblock">Whence and whither in spatial language and spatial cognition?

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Behavioral and brain sciences</em>, 16:255–265.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lathrop and Laird (2007)</span>
<span class="ltx_bibblock">
Scott D Lathrop and John E Laird. 2007.

</span>
<span class="ltx_bibblock">Towards incorporating visual imagery into a cognitive architecture.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International conference on cognitive modeling</em>, page 25.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levesque et al. (2011)</span>
<span class="ltx_bibblock">
Hector J Levesque, Ernest Davis, and Leora Morgenstern. 2011.

</span>
<span class="ltx_bibblock">The winograd schema challenge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">AAAI Spring Symposium</em>, volume 46, page 47.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin and Parikh (2015)</span>
<span class="ltx_bibblock">
Xiao Lin and Devi Parikh. 2015.

</span>
<span class="ltx_bibblock">Don’t just listen, use your imagination: Leveraging visual common
sense for non-visual tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, pages 2984–2993.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2016)</span>
<span class="ltx_bibblock">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh. 2016.

</span>
<span class="ltx_bibblock">Hierarchical question-image co-attention for visual question
answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, pages 289–297.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Müller et al. (2000)</span>
<span class="ltx_bibblock">
Rolf Müller, Thomas Röfer, Axel Lankenau, Alexandra Musto, Klaus Stein,
and Andreas Eisenkolb. 2000.

</span>
<span class="ltx_bibblock">Coarse qualitative descriptions in robot navigation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Spatial Cognition II</em>, pages 265–276.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Perez and Liu (2016)</span>
<span class="ltx_bibblock">
Julien Perez and Fei Liu. 2016.

</span>
<span class="ltx_bibblock">Dialog state tracking, a machine reading approach using memory
network.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.04052</em>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pinker (2003)</span>
<span class="ltx_bibblock">
Steven Pinker. 2003.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">The language instinct: How the mind creates language</em>.

</span>
<span class="ltx_bibblock">Penguin UK.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reed et al. (2016)</span>
<span class="ltx_bibblock">
Scott Reed, Zeynep Akata, Xinchen Yan, Lajanugen Logeswaran, Bernt Schiele, and
Honglak Lee. 2016.

</span>
<span class="ltx_bibblock">Generative adversarial text to image synthesis.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1605.05396</em>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Richardson et al. (2013)</span>
<span class="ltx_bibblock">
Matthew Richardson, Christopher JC Burges, and Erin Renshaw. 2013.

</span>
<span class="ltx_bibblock">Mctest: A challenge dataset for the open-domain machine comprehension
of text.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, volume 3, page 4.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seo et al. (2015)</span>
<span class="ltx_bibblock">
Minjoon Seo, Hannaneh Hajishirzi, Ali Farhadi, Oren Etzioni, and Clint Malcolm.
2015.

</span>
<span class="ltx_bibblock">Solving geometry problems: Combining text and diagram interpretation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, pages 1466–1476.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shariff (1998)</span>
<span class="ltx_bibblock">
A Rashid BM Shariff. 1998.

</span>
<span class="ltx_bibblock">Natural-language spatial relations between linear and areal objects:
the topology and metric of english-language terms.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">International journal of geographical information science</em>,
12:215–245.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Skubic et al. (2004)</span>
<span class="ltx_bibblock">
Marjorie Skubic, Dennis Perzanowski, Samuel Blisard, Alan Schultz, William
Adams, Magda Bugajska, and Derek Brock. 2004.

</span>
<span class="ltx_bibblock">Spatial language for human-robot dialogs.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Systems, Man, and Cybernetics, Part C
(Applications and Reviews)</em>, pages 154–167.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sukhbaatar et al. (2015)</span>
<span class="ltx_bibblock">
Sainbayar Sukhbaatar, Jason Weston, Rob Fergus, et al. 2015.

</span>
<span class="ltx_bibblock">End-to-end memory networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, pages 2440–2448.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Lukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1706.03762</em>.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weston et al. (2015)</span>
<span class="ltx_bibblock">
Jason Weston, Antoine Bordes, Sumit Chopra, Alexander M Rush, Bart van
Merriënboer, Armand Joulin, and Tomas Mikolov. 2015.

</span>
<span class="ltx_bibblock">Towards ai-complete question answering: A set of prerequisite toy
tasks.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1502.05698</em>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2016)</span>
<span class="ltx_bibblock">
Caiming Xiong, Stephen Merity, and Richard Socher. 2016.

</span>
<span class="ltx_bibblock">Dynamic memory networks for visual and textual question answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">ICML</em>, pages 2397–2406.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zelek (1997)</span>
<span class="ltx_bibblock">
John S Zelek. 1997.

</span>
<span class="ltx_bibblock">Human-robot interaction with minimal spanning natural language
template for autonomous and tele-operated control.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IROS</em>, pages 299–305.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1805.11024" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1805.11025" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1805.11025">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1805.11025" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1805.11026" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 00:13:15 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
