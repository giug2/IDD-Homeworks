<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2106.06921] Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient</title><meta property="og:description" content="Federated Learning (FL) has emerged as a new paradigm for training machine learning models distributively without sacrificing data security and privacy. Learning models on edge devices such as mobile phones is one of t…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2106.06921">

<!--Generated on Tue Mar 19 11:51:07 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

Sixing Yu 1<sup id="id1.1.id1" class="ltx_sup">§</sup>,
Phuong Nguyen1<sup id="id2.2.id2" class="ltx_sup">§</sup>,
Ali Anwar2 and
Ali Jannesari1
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
1 Department of Computer Science,
Iowa State University

</span>
<span class="ltx_contact ltx_role_affiliation">
2 Department of Computer Science &amp; Engineering,
University of Minnesota

</span>
<span class="ltx_contact ltx_role_affiliation">
yusx@iastate.edu,
dphuong@iastate.edu,
aanwar@umn.edu,
jannesar@iastate.edu

</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Federated Learning (FL) has emerged as a new paradigm for training machine learning models distributively without sacrificing data security and privacy. Learning models on edge devices such as mobile phones is one of the most common use cases for FL.
However, Non-identical independent distributed (non-IID) data in edge devices easily leads to training failures. Especially, over-parameterized machine learning models can easily be over-fitted on such data, hence, resulting in inefficient federated learning and poor model performance.
To overcome the over-fitting issue, we proposed an adaptive dynamic pruning approach for FL, which can dynamically slim the model by dropping out unimportant parameters, hence, preventing over-fittings. Since the machine learning model’s parameters react differently for different training samples, adaptive dynamic pruning will evaluate the salience of the model’s parameter according to the input training sample, and only retain the salient parameter’s gradients when doing back-propagation.
We performed comprehensive experiments to evaluate our approach. The results show that our approach by removing the redundant parameters in neural networks can significantly reduce the over-fitting issue and greatly improves the training efficiency. In particular, when training the ResNet-32 on CIFAR-10, our approach reduces the communication cost by 57%. We further demonstrate the inference acceleration capability of the proposed algorithm. Our approach reduce up to 50% FLOPs inference of DNNs on edge devices while maintaining the model’s quality.
</p>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">§</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">§</sup><span class="ltx_note_type">footnotetext: </span>Equal contribution</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">With the increasing concern about user-privacy data, training AI models on edge devices without private data access has become a challenge.
Federated learning (FL) is developed as a decentralized machine learning approach to not only cope with the privacy issue but also to efficiently optimize AI models on imbalanced distributed data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
Intuitively, FL aims to optimize deployed AI models in a distributed manner and aggregate decentralized training results on a cloud/central server without touching private data.
Recently, numerous algorithms for FL and its variants have been proposed, such as SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, which significantly stabilize the optimizing process of the original FL algorithm, i.e., FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
However, regardless of these novel ideas, the issue of imbalanced and non-identical independent distributed data (Non-IID) still leads to the training failure of FL.
Since the model is trained in a decentralized setting without access and understanding of the whole training data in the FL setting, and the data on the local device is inherently non-IID, the model performance is not as high as that trained in the centralized setting.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">We observe that a critical factor explaining the poor converging accuracy of FL that has been overlooked by researchers so far is the over-fitting issue, which significantly reduces the convergence speed and increases unexpected training fluctuations.
Since modern AI models deployed on the decentralized system are typically over-parameterized (e.g., deep neural network), the tiny and imbalanced local data at the edges can easily be over-fitted.
An effective way to address over-fitting is to increase the amount of data. Nevertheless, in the FL scenario, the local data is created by the user and has privacy restrictions, and most importantly, edge devices have limited computational and storage resources. Therefore, it is not practical to augment data on edge clients.
Another solution for over-fittings is to slim the model size. However, the non-IID and imbalanced data in edge clients raise challenges. For instance, some clients may have plenty of training samples to train the model well, while other clients may have limited training samples to get over-fitting. Hence, shrinking the model size mechanically would lead to unfairness and biases among edge clients.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we come up with an approach to slim the model dynamically.
In a neural network, neurons respond differently depending on different inputs. For a given batch of data, only a subset of salient parameters contributes to the final prediction. For any input sample, we dynamically select the corresponding salient parameter and retain the gradient to update.
We propose adaptive <span id="S1.p3.1.1" class="ltx_text ltx_framed ltx_framed_underline">D</span>ynamic <span id="S1.p3.1.2" class="ltx_text ltx_framed ltx_framed_underline">P</span>runing for efficient <span id="S1.p3.1.3" class="ltx_text ltx_framed ltx_framed_underline">Fed</span>erated learning (FedDP).
Specifically, we introduce a dynamic pruning component on each edge device. The component selectively predicts the salient parameters for every given training sample, which masks the unimportant and redundant parameters of the given training sample and only calculates the gradients for the remaining important parameters. Moreover, to further prevent the gradient drift among heterogeneous edge devices, we leverage global gradient control algorithm that corrects the heterogeneity and guides the gradient toward a generic global direction among all edge devices.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In essence, this paper makes the following contributions:
</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Mitigating the over-fitting issue on edge clients through a novel adaptive pruning technique.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">An adaptive network pruning method for non-IID edge devices with no additional communication cost.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Dataset-aware pruning policy for each edge device on federated learning network.
</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Reduction up to <math id="S1.I1.i4.p1.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S1.I1.i4.p1.1.m1.1a"><mrow id="S1.I1.i4.p1.1.m1.1b"><mn id="S1.I1.i4.p1.1.m1.1.1">2</mn><mo lspace="0.222em" id="S1.I1.i4.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S1.I1.i4.p1.1.m1.1c">2\times</annotation></semantics></math> on communication cost and 50% FLOPs on local inference.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2106.06921/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="323" height="180" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Adaptive gradient control local updates. </figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Motivation</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Nowadays, edge applications are ubiquitous with the popularity and enhanced performance of mobile and embedded devices. Improved ML models and tremendous data created on edge mean a remarkable amount of future ML workload will come from training and optimization on edge devices.
However, great challenges are coming from edge devices due to strict imbalanced data distribution, and privacy constraints, which invalidate centralized training ML models and cause training failures.
Therefore, the prevailing edge computing trend alongside FL requirements and edge constraints motivates FedDP to address challenges in HPC.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Firstly, decentralized training on edge devices needs significantly more training rounds than centralized training. Besides, Optimizing ML model on edge devices requires frequent sharing of model weights between edge devices and the central server. These incur hefty communication costs between edge devices and the server.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Secondly, the optimization process in over-parameterized ML (e.g. deep neural networks) models require mass computing, memory, and storage resources, which are hard to accomplish on resource-constrained Internet-of-Things (IoT) and edge devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Hence, reasonably pruning redundant weights and dropping out unnecessary gradients can be a viable solution to efficiently optimize ML models.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Thirdly, with the increasing concern of privacy issues in the digital world, how to reasonably utilize these private data on such privacy sensitive-manner proves to be challenging.
Therefore, efficiently optimizing ML models without directly accessing user-private data is important in FL and HPC settings.
</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">Lastly, tech giants (such as Google, Apple, and NVIDIA) are actively using FL for their applications (e.g., Google Keyboard <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, Apple Siri <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, NVIDIA medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>). The huge number of clients produces an incredible amount of data every second. The imbalanced and heterogeneous data created on edge amplify many issues for decentralized model optimization. As a result, designing dynamic and adaptive algorithms to process the data will be important to improve the performance of future edge computing.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Related work</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Federated learning</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Federated learning is a decentralized machine learning approach by communication with the model parameters by leaving the training data on each client’s devices in order to keep the clients’ privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
General FL involves two entities, the server and the clients (edges), and consists of three phases such as downstream, upstream, and edge computation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
The downstream means transmitting the initialized model from the server to clients and then training the model on each local data in the edge computation phase. After that, the clients have the upstream phase uploading the weights (parameters) trained on each client to the server and aggregating the local models.
The key idea is to train the model on each local device, which results in the computation and storage limitation on the edges’ device. The compression scheme is one of the directions in order to improve communication efficiency.
Konečnỳ et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed structure updates and sketched updates in the client upstream phase by enforcing the size of update parameters and sub-sampling the update using quantization and random rotations, respectively.
Caldas et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> suggested adopting the lossy compression on the downstream phase from server to clients and dropout on the upstream phase and local round in order to decrease the communication cost.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.2" class="ltx_p">Reducing the computation on clients’ devices is also related to achieving the efficient strategy of FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Moreover, theoretical schemes, following Independent and Identical Distributed <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="(" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">(</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">(</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">(</annotation></semantics></math>IID<math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext=")" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">)</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">)</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">)</annotation></semantics></math> data, could not be applied in a practical environment <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Therefore, the non-IID issue is also one of the challenges in federated learning because data on each device is following different distributions.
McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> proposed Federated Averaging (FedAvg) to resolve the non-IID issue by iterative model averaging with local stochastic gradient descent (SGD) on each local client’s data. Moreover, they demonstrated the robustness of FedAvg to train convolutional neural networks (CNNs) on benchmark image classification datasets (e.g., MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
and CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>). Other state-of-the-art (SoTA) algorithms includes FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. These are all variants from FedAvg. For instance, FedProx restricts local update sizes while FedNova introduces weight modification to improve the aggregation phase and SCAFFOLD corrects update direction by maintaining a drift in local training.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Non-Independent and Identical Distributed Data (non-IID)</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Non-IID data issue or heterogeneity is one of the main challenges in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.
There are two types of heterogeneity: (a) statistical heterogeneity, and (b) system heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Heterogeneity affects various aspects of the machine learning pipeline in FL. It can lead to slower convergence, reduced stability of convergence procedure, and divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Another problem is we might perform very well on average but in general, there are no accuracy guarantees for individual devices and the performance may therefore vary wildly across the network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. Finally, modeling is an overarching issue <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. Traditionally, the goal is to learn one model across the entire network, when data is very heterogeneous, it can be important to consider models that go beyond that and can personalize to data that’s being generated on these devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
To improve FL with model compression from non-IID distribution, Sattler et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> propose the communication efficient FL with non-IID data distribution by compressing the model on both phases, upstream and downstream, using k-sparsification.
Xu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> suggested accelerating the FL model with three stages: pruning, quantization, and selective updating. However, the pruning is to adopt structured pruning as a static pruning model. This limits the flexibility of the non-IID issue because the structured pruning reduces the model size without considering the current input. This paper focuses on statistical heterogeneity.
<br class="ltx_break"></p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Model compression</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Model compression such as network pruning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>, knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, and network quantization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> focus on efficient deployment of deep neural networks (DNNs) on edge devices. Within the scope of this paper, we mainly discuss network pruning.
Network pruning can be categorised to static pruning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and dynamic pruning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
Static pruning evaluates model parameters’ importance and removes those with a lower rank permanently. Static pruning can reduce the model size but will permanently lose pruned parameter’s information. Otherwise, the static pruning policy is highly input-dependent, a universal pruning policy for non-IID edge devices is not practical.
Dynamic pruning, instead of simply reducing model size at the cost of accuracy with pruning, accelerate convolution by selectively computing only a subset of channels predicted to be important at run-time while considering the sparse input from the preceding convolution layer. In addition to saving computational resources, a dynamic model preserves all neurons of the full model, which minimizes the impact on task accuracy.
However, only dynamic pruning fails to shrink the model size and will not improve communication efficiency.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">The limited computing resources of edge devices on federated learning and the frequent communication between edge devices and server makes FL more challenging. Resolving these issues is vital for a successful FL and further applications. Only a limited number of research try to address the above issues by performing model compression techniques on edge devices (e.g., pruning on edge devices PruneFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> or model/gradient quantization compression techniques <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>). However, there is no available solution to perform both the communication overhead and the limited computing resource issue simultaneously.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Approach</span>
</h2>

<figure id="S4.F2" class="ltx_figure"><img src="/html/2106.06921/assets/Figures/cnn_dp.png" id="S4.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="280" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Dynamic pruning components for CNN. </figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Figure <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the high-level overview of FedDP. The edge clients first download the model from the server and then optimize it on the local Non-IID dataset. For each input training sample, FedDP dynamically drops off unimportant parameters when calculating the gradient according to the given sample.
The dynamic pruning component is used to adaptively prune redundant and unimportant weights, which have a low response to the input sample.
Hence, when performing back-propagate, those dropped parameters and corresponding feature maps would not retain gradients.
Dynamically pruning/dropping out redundant parameters makes the model robust and easy to converge, which can significantly relieve the over-fitting issue and accelerate the model inference on edge devices.
</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Adaptive dynamically pruning</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">To prevent the model suffer from over-fittings on non-IID local datasets,
we apply adaptive dynamic pruning to selectively drop off unimportant parameters based on the parameter’s reactions to the input training sample.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">To intuitively explain our approach, as depicted in Figure <a href="#S4.F2" title="Figure 2 ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we take the CNNs as an example.
To dynamically prune a neural network, we introduced a dynamic pruning gate for each hidden layer. The gate will take the feature maps (previous layer’s output) as input, predict which channels (Conv Filter) are important in the current layer, and drop out unimportant parameters.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">Formally, we formulate a <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="l-" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">l</mi><mo id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">−</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">limit-from</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">𝑙</ci><minus id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">l-</annotation></semantics></math>layer CNN as equation <a href="#S4.E1" title="In IV-A Adaptive dynamically pruning ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.2" class="ltx_Math" alttext="CNN(x)=f_{l}(f_{l-1}(...f_{1}(x_{0})...))" display="block"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml"><mrow id="S4.E1.m1.2.2.3" xref="S4.E1.m1.2.2.3.cmml"><mi id="S4.E1.m1.2.2.3.2" xref="S4.E1.m1.2.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.3.1" xref="S4.E1.m1.2.2.3.1.cmml">​</mo><mi id="S4.E1.m1.2.2.3.3" xref="S4.E1.m1.2.2.3.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.3.1a" xref="S4.E1.m1.2.2.3.1.cmml">​</mo><mi id="S4.E1.m1.2.2.3.4" xref="S4.E1.m1.2.2.3.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.3.1b" xref="S4.E1.m1.2.2.3.1.cmml">​</mo><mrow id="S4.E1.m1.2.2.3.5.2" xref="S4.E1.m1.2.2.3.cmml"><mo stretchy="false" id="S4.E1.m1.2.2.3.5.2.1" xref="S4.E1.m1.2.2.3.cmml">(</mo><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E1.m1.2.2.3.5.2.2" xref="S4.E1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.2.2.2" xref="S4.E1.m1.2.2.2.cmml">=</mo><mrow id="S4.E1.m1.2.2.1" xref="S4.E1.m1.2.2.1.cmml"><msub id="S4.E1.m1.2.2.1.3" xref="S4.E1.m1.2.2.1.3.cmml"><mi id="S4.E1.m1.2.2.1.3.2" xref="S4.E1.m1.2.2.1.3.2.cmml">f</mi><mi id="S4.E1.m1.2.2.1.3.3" xref="S4.E1.m1.2.2.1.3.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.1.2" xref="S4.E1.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E1.m1.2.2.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.2.2.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.2.2.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.cmml"><msub id="S4.E1.m1.2.2.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.3.2" xref="S4.E1.m1.2.2.1.1.1.1.3.2.cmml">f</mi><mrow id="S4.E1.m1.2.2.1.1.1.1.3.3" xref="S4.E1.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.3.3.2" xref="S4.E1.m1.2.2.1.1.1.1.3.3.2.cmml">l</mi><mo id="S4.E1.m1.2.2.1.1.1.1.3.3.1" xref="S4.E1.m1.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E1.m1.2.2.1.1.1.1.3.3.3" xref="S4.E1.m1.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.2.2.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.2.cmml">f</mi><mn id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.2a" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.2b" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.5" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.5.cmml">…</mi></mrow><mo stretchy="false" id="S4.E1.m1.2.2.1.1.1.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E1.m1.2.2.1.1.1.3" xref="S4.E1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.2b"><apply id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2"><eq id="S4.E1.m1.2.2.2.cmml" xref="S4.E1.m1.2.2.2"></eq><apply id="S4.E1.m1.2.2.3.cmml" xref="S4.E1.m1.2.2.3"><times id="S4.E1.m1.2.2.3.1.cmml" xref="S4.E1.m1.2.2.3.1"></times><ci id="S4.E1.m1.2.2.3.2.cmml" xref="S4.E1.m1.2.2.3.2">𝐶</ci><ci id="S4.E1.m1.2.2.3.3.cmml" xref="S4.E1.m1.2.2.3.3">𝑁</ci><ci id="S4.E1.m1.2.2.3.4.cmml" xref="S4.E1.m1.2.2.3.4">𝑁</ci><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝑥</ci></apply><apply id="S4.E1.m1.2.2.1.cmml" xref="S4.E1.m1.2.2.1"><times id="S4.E1.m1.2.2.1.2.cmml" xref="S4.E1.m1.2.2.1.2"></times><apply id="S4.E1.m1.2.2.1.3.cmml" xref="S4.E1.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.3.1.cmml" xref="S4.E1.m1.2.2.1.3">subscript</csymbol><ci id="S4.E1.m1.2.2.1.3.2.cmml" xref="S4.E1.m1.2.2.1.3.2">𝑓</ci><ci id="S4.E1.m1.2.2.1.3.3.cmml" xref="S4.E1.m1.2.2.1.3.3">𝑙</ci></apply><apply id="S4.E1.m1.2.2.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1"><times id="S4.E1.m1.2.2.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.2"></times><apply id="S4.E1.m1.2.2.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.2">𝑓</ci><apply id="S4.E1.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3"><minus id="S4.E1.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3.1"></minus><ci id="S4.E1.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.E1.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1"><times id="S4.E1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.2"></times><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.3">…</ci><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.2">𝑓</ci><cn type="integer" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.4.3">1</cn></apply><apply id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply><ci id="S4.E1.m1.2.2.1.1.1.1.1.1.1.5.cmml" xref="S4.E1.m1.2.2.1.1.1.1.1.1.1.5">…</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.2c">CNN(x)=f_{l}(f_{l-1}(...f_{1}(x_{0})...))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.9" class="ltx_p">, where the <math id="S4.SS1.p3.2.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S4.SS1.p3.2.m1.1a"><msub id="S4.SS1.p3.2.m1.1.1" xref="S4.SS1.p3.2.m1.1.1.cmml"><mi id="S4.SS1.p3.2.m1.1.1.2" xref="S4.SS1.p3.2.m1.1.1.2.cmml">x</mi><mi id="S4.SS1.p3.2.m1.1.1.3" xref="S4.SS1.p3.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m1.1b"><apply id="S4.SS1.p3.2.m1.1.1.cmml" xref="S4.SS1.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m1.1.1.1.cmml" xref="S4.SS1.p3.2.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m1.1.1.2.cmml" xref="S4.SS1.p3.2.m1.1.1.2">𝑥</ci><ci id="S4.SS1.p3.2.m1.1.1.3.cmml" xref="S4.SS1.p3.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m1.1c">x_{i}</annotation></semantics></math> is the feature map in <math id="S4.SS1.p3.3.m2.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S4.SS1.p3.3.m2.1a"><msup id="S4.SS1.p3.3.m2.1.1" xref="S4.SS1.p3.3.m2.1.1.cmml"><mi id="S4.SS1.p3.3.m2.1.1.2" xref="S4.SS1.p3.3.m2.1.1.2.cmml">i</mi><mrow id="S4.SS1.p3.3.m2.1.1.3" xref="S4.SS1.p3.3.m2.1.1.3.cmml"><mi id="S4.SS1.p3.3.m2.1.1.3.2" xref="S4.SS1.p3.3.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.3.m2.1.1.3.1" xref="S4.SS1.p3.3.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.3.m2.1.1.3.3" xref="S4.SS1.p3.3.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m2.1b"><apply id="S4.SS1.p3.3.m2.1.1.cmml" xref="S4.SS1.p3.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m2.1.1.1.cmml" xref="S4.SS1.p3.3.m2.1.1">superscript</csymbol><ci id="S4.SS1.p3.3.m2.1.1.2.cmml" xref="S4.SS1.p3.3.m2.1.1.2">𝑖</ci><apply id="S4.SS1.p3.3.m2.1.1.3.cmml" xref="S4.SS1.p3.3.m2.1.1.3"><times id="S4.SS1.p3.3.m2.1.1.3.1.cmml" xref="S4.SS1.p3.3.m2.1.1.3.1"></times><ci id="S4.SS1.p3.3.m2.1.1.3.2.cmml" xref="S4.SS1.p3.3.m2.1.1.3.2">𝑡</ci><ci id="S4.SS1.p3.3.m2.1.1.3.3.cmml" xref="S4.SS1.p3.3.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m2.1c">i^{th}</annotation></semantics></math> layer, <math id="S4.SS1.p3.4.m3.1" class="ltx_Math" alttext="CNN(x)" display="inline"><semantics id="S4.SS1.p3.4.m3.1a"><mrow id="S4.SS1.p3.4.m3.1.2" xref="S4.SS1.p3.4.m3.1.2.cmml"><mi id="S4.SS1.p3.4.m3.1.2.2" xref="S4.SS1.p3.4.m3.1.2.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m3.1.2.1" xref="S4.SS1.p3.4.m3.1.2.1.cmml">​</mo><mi id="S4.SS1.p3.4.m3.1.2.3" xref="S4.SS1.p3.4.m3.1.2.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m3.1.2.1a" xref="S4.SS1.p3.4.m3.1.2.1.cmml">​</mo><mi id="S4.SS1.p3.4.m3.1.2.4" xref="S4.SS1.p3.4.m3.1.2.4.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.4.m3.1.2.1b" xref="S4.SS1.p3.4.m3.1.2.1.cmml">​</mo><mrow id="S4.SS1.p3.4.m3.1.2.5.2" xref="S4.SS1.p3.4.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.4.m3.1.2.5.2.1" xref="S4.SS1.p3.4.m3.1.2.cmml">(</mo><mi id="S4.SS1.p3.4.m3.1.1" xref="S4.SS1.p3.4.m3.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.p3.4.m3.1.2.5.2.2" xref="S4.SS1.p3.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m3.1b"><apply id="S4.SS1.p3.4.m3.1.2.cmml" xref="S4.SS1.p3.4.m3.1.2"><times id="S4.SS1.p3.4.m3.1.2.1.cmml" xref="S4.SS1.p3.4.m3.1.2.1"></times><ci id="S4.SS1.p3.4.m3.1.2.2.cmml" xref="S4.SS1.p3.4.m3.1.2.2">𝐶</ci><ci id="S4.SS1.p3.4.m3.1.2.3.cmml" xref="S4.SS1.p3.4.m3.1.2.3">𝑁</ci><ci id="S4.SS1.p3.4.m3.1.2.4.cmml" xref="S4.SS1.p3.4.m3.1.2.4">𝑁</ci><ci id="S4.SS1.p3.4.m3.1.1.cmml" xref="S4.SS1.p3.4.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m3.1c">CNN(x)</annotation></semantics></math> is the forward propagate function of the neural network, and the <math id="S4.SS1.p3.5.m4.1" class="ltx_Math" alttext="f_{k}" display="inline"><semantics id="S4.SS1.p3.5.m4.1a"><msub id="S4.SS1.p3.5.m4.1.1" xref="S4.SS1.p3.5.m4.1.1.cmml"><mi id="S4.SS1.p3.5.m4.1.1.2" xref="S4.SS1.p3.5.m4.1.1.2.cmml">f</mi><mi id="S4.SS1.p3.5.m4.1.1.3" xref="S4.SS1.p3.5.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m4.1b"><apply id="S4.SS1.p3.5.m4.1.1.cmml" xref="S4.SS1.p3.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m4.1.1.1.cmml" xref="S4.SS1.p3.5.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m4.1.1.2.cmml" xref="S4.SS1.p3.5.m4.1.1.2">𝑓</ci><ci id="S4.SS1.p3.5.m4.1.1.3.cmml" xref="S4.SS1.p3.5.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m4.1c">f_{k}</annotation></semantics></math> is the <math id="S4.SS1.p3.6.m5.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S4.SS1.p3.6.m5.1a"><msup id="S4.SS1.p3.6.m5.1.1" xref="S4.SS1.p3.6.m5.1.1.cmml"><mi id="S4.SS1.p3.6.m5.1.1.2" xref="S4.SS1.p3.6.m5.1.1.2.cmml">k</mi><mrow id="S4.SS1.p3.6.m5.1.1.3" xref="S4.SS1.p3.6.m5.1.1.3.cmml"><mi id="S4.SS1.p3.6.m5.1.1.3.2" xref="S4.SS1.p3.6.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.6.m5.1.1.3.1" xref="S4.SS1.p3.6.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.6.m5.1.1.3.3" xref="S4.SS1.p3.6.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m5.1b"><apply id="S4.SS1.p3.6.m5.1.1.cmml" xref="S4.SS1.p3.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m5.1.1.1.cmml" xref="S4.SS1.p3.6.m5.1.1">superscript</csymbol><ci id="S4.SS1.p3.6.m5.1.1.2.cmml" xref="S4.SS1.p3.6.m5.1.1.2">𝑘</ci><apply id="S4.SS1.p3.6.m5.1.1.3.cmml" xref="S4.SS1.p3.6.m5.1.1.3"><times id="S4.SS1.p3.6.m5.1.1.3.1.cmml" xref="S4.SS1.p3.6.m5.1.1.3.1"></times><ci id="S4.SS1.p3.6.m5.1.1.3.2.cmml" xref="S4.SS1.p3.6.m5.1.1.3.2">𝑡</ci><ci id="S4.SS1.p3.6.m5.1.1.3.3.cmml" xref="S4.SS1.p3.6.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m5.1c">k^{th}</annotation></semantics></math> hidden layer, which projects the feature maps from <math id="S4.SS1.p3.7.m6.1" class="ltx_Math" alttext="(k-1)^{th}" display="inline"><semantics id="S4.SS1.p3.7.m6.1a"><msup id="S4.SS1.p3.7.m6.1.1" xref="S4.SS1.p3.7.m6.1.1.cmml"><mrow id="S4.SS1.p3.7.m6.1.1.1.1" xref="S4.SS1.p3.7.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.7.m6.1.1.1.1.2" xref="S4.SS1.p3.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.7.m6.1.1.1.1.1" xref="S4.SS1.p3.7.m6.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.7.m6.1.1.1.1.1.2" xref="S4.SS1.p3.7.m6.1.1.1.1.1.2.cmml">k</mi><mo id="S4.SS1.p3.7.m6.1.1.1.1.1.1" xref="S4.SS1.p3.7.m6.1.1.1.1.1.1.cmml">−</mo><mn id="S4.SS1.p3.7.m6.1.1.1.1.1.3" xref="S4.SS1.p3.7.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p3.7.m6.1.1.1.1.3" xref="S4.SS1.p3.7.m6.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p3.7.m6.1.1.3" xref="S4.SS1.p3.7.m6.1.1.3.cmml"><mi id="S4.SS1.p3.7.m6.1.1.3.2" xref="S4.SS1.p3.7.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.7.m6.1.1.3.1" xref="S4.SS1.p3.7.m6.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.7.m6.1.1.3.3" xref="S4.SS1.p3.7.m6.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m6.1b"><apply id="S4.SS1.p3.7.m6.1.1.cmml" xref="S4.SS1.p3.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m6.1.1.2.cmml" xref="S4.SS1.p3.7.m6.1.1">superscript</csymbol><apply id="S4.SS1.p3.7.m6.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m6.1.1.1.1"><minus id="S4.SS1.p3.7.m6.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.7.m6.1.1.1.1.1.1"></minus><ci id="S4.SS1.p3.7.m6.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.7.m6.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="S4.SS1.p3.7.m6.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.7.m6.1.1.1.1.1.3">1</cn></apply><apply id="S4.SS1.p3.7.m6.1.1.3.cmml" xref="S4.SS1.p3.7.m6.1.1.3"><times id="S4.SS1.p3.7.m6.1.1.3.1.cmml" xref="S4.SS1.p3.7.m6.1.1.3.1"></times><ci id="S4.SS1.p3.7.m6.1.1.3.2.cmml" xref="S4.SS1.p3.7.m6.1.1.3.2">𝑡</ci><ci id="S4.SS1.p3.7.m6.1.1.3.3.cmml" xref="S4.SS1.p3.7.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m6.1c">(k-1)^{th}</annotation></semantics></math> layer to <math id="S4.SS1.p3.8.m7.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S4.SS1.p3.8.m7.1a"><msup id="S4.SS1.p3.8.m7.1.1" xref="S4.SS1.p3.8.m7.1.1.cmml"><mi id="S4.SS1.p3.8.m7.1.1.2" xref="S4.SS1.p3.8.m7.1.1.2.cmml">k</mi><mrow id="S4.SS1.p3.8.m7.1.1.3" xref="S4.SS1.p3.8.m7.1.1.3.cmml"><mi id="S4.SS1.p3.8.m7.1.1.3.2" xref="S4.SS1.p3.8.m7.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.8.m7.1.1.3.1" xref="S4.SS1.p3.8.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.8.m7.1.1.3.3" xref="S4.SS1.p3.8.m7.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m7.1b"><apply id="S4.SS1.p3.8.m7.1.1.cmml" xref="S4.SS1.p3.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m7.1.1.1.cmml" xref="S4.SS1.p3.8.m7.1.1">superscript</csymbol><ci id="S4.SS1.p3.8.m7.1.1.2.cmml" xref="S4.SS1.p3.8.m7.1.1.2">𝑘</ci><apply id="S4.SS1.p3.8.m7.1.1.3.cmml" xref="S4.SS1.p3.8.m7.1.1.3"><times id="S4.SS1.p3.8.m7.1.1.3.1.cmml" xref="S4.SS1.p3.8.m7.1.1.3.1"></times><ci id="S4.SS1.p3.8.m7.1.1.3.2.cmml" xref="S4.SS1.p3.8.m7.1.1.3.2">𝑡</ci><ci id="S4.SS1.p3.8.m7.1.1.3.3.cmml" xref="S4.SS1.p3.8.m7.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m7.1c">k^{th}</annotation></semantics></math> layer. In CNN model, a commonly used hidden layer <math id="S4.SS1.p3.9.m8.1" class="ltx_Math" alttext="f_{k}" display="inline"><semantics id="S4.SS1.p3.9.m8.1a"><msub id="S4.SS1.p3.9.m8.1.1" xref="S4.SS1.p3.9.m8.1.1.cmml"><mi id="S4.SS1.p3.9.m8.1.1.2" xref="S4.SS1.p3.9.m8.1.1.2.cmml">f</mi><mi id="S4.SS1.p3.9.m8.1.1.3" xref="S4.SS1.p3.9.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m8.1b"><apply id="S4.SS1.p3.9.m8.1.1.cmml" xref="S4.SS1.p3.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m8.1.1.1.cmml" xref="S4.SS1.p3.9.m8.1.1">subscript</csymbol><ci id="S4.SS1.p3.9.m8.1.1.2.cmml" xref="S4.SS1.p3.9.m8.1.1.2">𝑓</ci><ci id="S4.SS1.p3.9.m8.1.1.3.cmml" xref="S4.SS1.p3.9.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m8.1c">f_{k}</annotation></semantics></math> can be represented as equation <a href="#S4.E2" title="In IV-A Adaptive dynamically pruning ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.2" class="ltx_Math" alttext="f_{k}(x_{k-1})=ReLu(norm(Conv_{k}(x_{k-1},\theta_{k})))" display="block"><semantics id="S4.E2.m1.2a"><mrow id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.cmml"><msub id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.3.2.cmml">f</mi><mi id="S4.E2.m1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.E2.m1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E2.m1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.2.2.3" xref="S4.E2.m1.2.2.3.cmml">=</mo><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.3" xref="S4.E2.m1.2.2.2.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">​</mo><mi id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.2a" xref="S4.E2.m1.2.2.2.2.cmml">​</mo><mi id="S4.E2.m1.2.2.2.5" xref="S4.E2.m1.2.2.2.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.2b" xref="S4.E2.m1.2.2.2.2.cmml">​</mo><mi id="S4.E2.m1.2.2.2.6" xref="S4.E2.m1.2.2.2.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.2c" xref="S4.E2.m1.2.2.2.2.cmml">​</mo><mrow id="S4.E2.m1.2.2.2.1.1" xref="S4.E2.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.2" xref="S4.E2.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.2.2.2.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.3" xref="S4.E2.m1.2.2.2.1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.2" xref="S4.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.2.2.2.1.1.1.4" xref="S4.E2.m1.2.2.2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.2a" xref="S4.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.2.2.2.1.1.1.5" xref="S4.E2.m1.2.2.2.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.2b" xref="S4.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E2.m1.2.2.2.1.1.1.6" xref="S4.E2.m1.2.2.2.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.2c" xref="S4.E2.m1.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.2.2.2.1.1.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.1.1.1.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.2.2.2.1.1.1.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.4" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.5" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.3a" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.6" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.3b" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><msub id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.2.cmml">v</mi><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.3c" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.4" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.5" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.1.1.1.3" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2.m1.2.2.2.1.1.3" xref="S4.E2.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.2b"><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><eq id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2.3"></eq><apply id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><times id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.2"></times><apply id="S4.E2.m1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.3.2">𝑓</ci><ci id="S4.E2.m1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E2.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3"><minus id="S4.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><times id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2"></times><ci id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3">𝑅</ci><ci id="S4.E2.m1.2.2.2.4.cmml" xref="S4.E2.m1.2.2.2.4">𝑒</ci><ci id="S4.E2.m1.2.2.2.5.cmml" xref="S4.E2.m1.2.2.2.5">𝐿</ci><ci id="S4.E2.m1.2.2.2.6.cmml" xref="S4.E2.m1.2.2.2.6">𝑢</ci><apply id="S4.E2.m1.2.2.2.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1"><times id="S4.E2.m1.2.2.2.1.1.1.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.2"></times><ci id="S4.E2.m1.2.2.2.1.1.1.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.3">𝑛</ci><ci id="S4.E2.m1.2.2.2.1.1.1.4.cmml" xref="S4.E2.m1.2.2.2.1.1.1.4">𝑜</ci><ci id="S4.E2.m1.2.2.2.1.1.1.5.cmml" xref="S4.E2.m1.2.2.2.1.1.1.5">𝑟</ci><ci id="S4.E2.m1.2.2.2.1.1.1.6.cmml" xref="S4.E2.m1.2.2.2.1.1.1.6">𝑚</ci><apply id="S4.E2.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1"><times id="S4.E2.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.3"></times><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.4">𝐶</ci><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.5.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.5">𝑜</ci><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.6.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.6">𝑛</ci><apply id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7">subscript</csymbol><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.2">𝑣</ci><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.7.3">𝑘</ci></apply><interval closure="open" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2"><apply id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.2c">f_{k}(x_{k-1})=ReLu(norm(Conv_{k}(x_{k-1},\theta_{k})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.13" class="ltx_p">, where the <math id="S4.SS1.p3.10.m1.1" class="ltx_Math" alttext="\theta_{k}\in\mathbb{R}^{C_{out}\times C_{in}\times K\times K}" display="inline"><semantics id="S4.SS1.p3.10.m1.1a"><mrow id="S4.SS1.p3.10.m1.1.1" xref="S4.SS1.p3.10.m1.1.1.cmml"><msub id="S4.SS1.p3.10.m1.1.1.2" xref="S4.SS1.p3.10.m1.1.1.2.cmml"><mi id="S4.SS1.p3.10.m1.1.1.2.2" xref="S4.SS1.p3.10.m1.1.1.2.2.cmml">θ</mi><mi id="S4.SS1.p3.10.m1.1.1.2.3" xref="S4.SS1.p3.10.m1.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p3.10.m1.1.1.1" xref="S4.SS1.p3.10.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.10.m1.1.1.3" xref="S4.SS1.p3.10.m1.1.1.3.cmml"><mi id="S4.SS1.p3.10.m1.1.1.3.2" xref="S4.SS1.p3.10.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.10.m1.1.1.3.3" xref="S4.SS1.p3.10.m1.1.1.3.3.cmml"><msub id="S4.SS1.p3.10.m1.1.1.3.3.2" xref="S4.SS1.p3.10.m1.1.1.3.3.2.cmml"><mi id="S4.SS1.p3.10.m1.1.1.3.3.2.2" xref="S4.SS1.p3.10.m1.1.1.3.3.2.2.cmml">C</mi><mrow id="S4.SS1.p3.10.m1.1.1.3.3.2.3" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.cmml"><mi id="S4.SS1.p3.10.m1.1.1.3.3.2.3.2" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.10.m1.1.1.3.3.2.3.1" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p3.10.m1.1.1.3.3.2.3.3" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.10.m1.1.1.3.3.2.3.1a" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p3.10.m1.1.1.3.3.2.3.4" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.10.m1.1.1.3.3.1" xref="S4.SS1.p3.10.m1.1.1.3.3.1.cmml">×</mo><msub id="S4.SS1.p3.10.m1.1.1.3.3.3" xref="S4.SS1.p3.10.m1.1.1.3.3.3.cmml"><mi id="S4.SS1.p3.10.m1.1.1.3.3.3.2" xref="S4.SS1.p3.10.m1.1.1.3.3.3.2.cmml">C</mi><mrow id="S4.SS1.p3.10.m1.1.1.3.3.3.3" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.cmml"><mi id="S4.SS1.p3.10.m1.1.1.3.3.3.3.2" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.10.m1.1.1.3.3.3.3.1" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S4.SS1.p3.10.m1.1.1.3.3.3.3.3" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.3.cmml">n</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.10.m1.1.1.3.3.1a" xref="S4.SS1.p3.10.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p3.10.m1.1.1.3.3.4" xref="S4.SS1.p3.10.m1.1.1.3.3.4.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p3.10.m1.1.1.3.3.1b" xref="S4.SS1.p3.10.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p3.10.m1.1.1.3.3.5" xref="S4.SS1.p3.10.m1.1.1.3.3.5.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m1.1b"><apply id="S4.SS1.p3.10.m1.1.1.cmml" xref="S4.SS1.p3.10.m1.1.1"><in id="S4.SS1.p3.10.m1.1.1.1.cmml" xref="S4.SS1.p3.10.m1.1.1.1"></in><apply id="S4.SS1.p3.10.m1.1.1.2.cmml" xref="S4.SS1.p3.10.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m1.1.1.2.1.cmml" xref="S4.SS1.p3.10.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p3.10.m1.1.1.2.2.cmml" xref="S4.SS1.p3.10.m1.1.1.2.2">𝜃</ci><ci id="S4.SS1.p3.10.m1.1.1.2.3.cmml" xref="S4.SS1.p3.10.m1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS1.p3.10.m1.1.1.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m1.1.1.3.1.cmml" xref="S4.SS1.p3.10.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.10.m1.1.1.3.2.cmml" xref="S4.SS1.p3.10.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p3.10.m1.1.1.3.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3"><times id="S4.SS1.p3.10.m1.1.1.3.3.1.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.1"></times><apply id="S4.SS1.p3.10.m1.1.1.3.3.2.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m1.1.1.3.3.2.1.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.SS1.p3.10.m1.1.1.3.3.2.2.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2.2">𝐶</ci><apply id="S4.SS1.p3.10.m1.1.1.3.3.2.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3"><times id="S4.SS1.p3.10.m1.1.1.3.3.2.3.1.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.1"></times><ci id="S4.SS1.p3.10.m1.1.1.3.3.2.3.2.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.2">𝑜</ci><ci id="S4.SS1.p3.10.m1.1.1.3.3.2.3.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.3">𝑢</ci><ci id="S4.SS1.p3.10.m1.1.1.3.3.2.3.4.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.2.3.4">𝑡</ci></apply></apply><apply id="S4.SS1.p3.10.m1.1.1.3.3.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m1.1.1.3.3.3.1.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.SS1.p3.10.m1.1.1.3.3.3.2.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3.2">𝐶</ci><apply id="S4.SS1.p3.10.m1.1.1.3.3.3.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3"><times id="S4.SS1.p3.10.m1.1.1.3.3.3.3.1.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.1"></times><ci id="S4.SS1.p3.10.m1.1.1.3.3.3.3.2.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.2">𝑖</ci><ci id="S4.SS1.p3.10.m1.1.1.3.3.3.3.3.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.3.3.3">𝑛</ci></apply></apply><ci id="S4.SS1.p3.10.m1.1.1.3.3.4.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.4">𝐾</ci><ci id="S4.SS1.p3.10.m1.1.1.3.3.5.cmml" xref="S4.SS1.p3.10.m1.1.1.3.3.5">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m1.1c">\theta_{k}\in\mathbb{R}^{C_{out}\times C_{in}\times K\times K}</annotation></semantics></math> is the learnable parameter, <math id="S4.SS1.p3.11.m2.1" class="ltx_Math" alttext="C_{out}" display="inline"><semantics id="S4.SS1.p3.11.m2.1a"><msub id="S4.SS1.p3.11.m2.1.1" xref="S4.SS1.p3.11.m2.1.1.cmml"><mi id="S4.SS1.p3.11.m2.1.1.2" xref="S4.SS1.p3.11.m2.1.1.2.cmml">C</mi><mrow id="S4.SS1.p3.11.m2.1.1.3" xref="S4.SS1.p3.11.m2.1.1.3.cmml"><mi id="S4.SS1.p3.11.m2.1.1.3.2" xref="S4.SS1.p3.11.m2.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.11.m2.1.1.3.1" xref="S4.SS1.p3.11.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.11.m2.1.1.3.3" xref="S4.SS1.p3.11.m2.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.11.m2.1.1.3.1a" xref="S4.SS1.p3.11.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.11.m2.1.1.3.4" xref="S4.SS1.p3.11.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.11.m2.1b"><apply id="S4.SS1.p3.11.m2.1.1.cmml" xref="S4.SS1.p3.11.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m2.1.1.1.cmml" xref="S4.SS1.p3.11.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.11.m2.1.1.2.cmml" xref="S4.SS1.p3.11.m2.1.1.2">𝐶</ci><apply id="S4.SS1.p3.11.m2.1.1.3.cmml" xref="S4.SS1.p3.11.m2.1.1.3"><times id="S4.SS1.p3.11.m2.1.1.3.1.cmml" xref="S4.SS1.p3.11.m2.1.1.3.1"></times><ci id="S4.SS1.p3.11.m2.1.1.3.2.cmml" xref="S4.SS1.p3.11.m2.1.1.3.2">𝑜</ci><ci id="S4.SS1.p3.11.m2.1.1.3.3.cmml" xref="S4.SS1.p3.11.m2.1.1.3.3">𝑢</ci><ci id="S4.SS1.p3.11.m2.1.1.3.4.cmml" xref="S4.SS1.p3.11.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.11.m2.1c">C_{out}</annotation></semantics></math> and <math id="S4.SS1.p3.12.m3.1" class="ltx_Math" alttext="C_{in}" display="inline"><semantics id="S4.SS1.p3.12.m3.1a"><msub id="S4.SS1.p3.12.m3.1.1" xref="S4.SS1.p3.12.m3.1.1.cmml"><mi id="S4.SS1.p3.12.m3.1.1.2" xref="S4.SS1.p3.12.m3.1.1.2.cmml">C</mi><mrow id="S4.SS1.p3.12.m3.1.1.3" xref="S4.SS1.p3.12.m3.1.1.3.cmml"><mi id="S4.SS1.p3.12.m3.1.1.3.2" xref="S4.SS1.p3.12.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.12.m3.1.1.3.1" xref="S4.SS1.p3.12.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p3.12.m3.1.1.3.3" xref="S4.SS1.p3.12.m3.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.12.m3.1b"><apply id="S4.SS1.p3.12.m3.1.1.cmml" xref="S4.SS1.p3.12.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m3.1.1.1.cmml" xref="S4.SS1.p3.12.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.12.m3.1.1.2.cmml" xref="S4.SS1.p3.12.m3.1.1.2">𝐶</ci><apply id="S4.SS1.p3.12.m3.1.1.3.cmml" xref="S4.SS1.p3.12.m3.1.1.3"><times id="S4.SS1.p3.12.m3.1.1.3.1.cmml" xref="S4.SS1.p3.12.m3.1.1.3.1"></times><ci id="S4.SS1.p3.12.m3.1.1.3.2.cmml" xref="S4.SS1.p3.12.m3.1.1.3.2">𝑖</ci><ci id="S4.SS1.p3.12.m3.1.1.3.3.cmml" xref="S4.SS1.p3.12.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.12.m3.1c">C_{in}</annotation></semantics></math> is the output and input channel, K is the kernel size, <math id="S4.SS1.p3.13.m4.1" class="ltx_Math" alttext="Conv_{k}" display="inline"><semantics id="S4.SS1.p3.13.m4.1a"><mrow id="S4.SS1.p3.13.m4.1.1" xref="S4.SS1.p3.13.m4.1.1.cmml"><mi id="S4.SS1.p3.13.m4.1.1.2" xref="S4.SS1.p3.13.m4.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.13.m4.1.1.1" xref="S4.SS1.p3.13.m4.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.13.m4.1.1.3" xref="S4.SS1.p3.13.m4.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.13.m4.1.1.1a" xref="S4.SS1.p3.13.m4.1.1.1.cmml">​</mo><mi id="S4.SS1.p3.13.m4.1.1.4" xref="S4.SS1.p3.13.m4.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p3.13.m4.1.1.1b" xref="S4.SS1.p3.13.m4.1.1.1.cmml">​</mo><msub id="S4.SS1.p3.13.m4.1.1.5" xref="S4.SS1.p3.13.m4.1.1.5.cmml"><mi id="S4.SS1.p3.13.m4.1.1.5.2" xref="S4.SS1.p3.13.m4.1.1.5.2.cmml">v</mi><mi id="S4.SS1.p3.13.m4.1.1.5.3" xref="S4.SS1.p3.13.m4.1.1.5.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.13.m4.1b"><apply id="S4.SS1.p3.13.m4.1.1.cmml" xref="S4.SS1.p3.13.m4.1.1"><times id="S4.SS1.p3.13.m4.1.1.1.cmml" xref="S4.SS1.p3.13.m4.1.1.1"></times><ci id="S4.SS1.p3.13.m4.1.1.2.cmml" xref="S4.SS1.p3.13.m4.1.1.2">𝐶</ci><ci id="S4.SS1.p3.13.m4.1.1.3.cmml" xref="S4.SS1.p3.13.m4.1.1.3">𝑜</ci><ci id="S4.SS1.p3.13.m4.1.1.4.cmml" xref="S4.SS1.p3.13.m4.1.1.4">𝑛</ci><apply id="S4.SS1.p3.13.m4.1.1.5.cmml" xref="S4.SS1.p3.13.m4.1.1.5"><csymbol cd="ambiguous" id="S4.SS1.p3.13.m4.1.1.5.1.cmml" xref="S4.SS1.p3.13.m4.1.1.5">subscript</csymbol><ci id="S4.SS1.p3.13.m4.1.1.5.2.cmml" xref="S4.SS1.p3.13.m4.1.1.5.2">𝑣</ci><ci id="S4.SS1.p3.13.m4.1.1.5.3.cmml" xref="S4.SS1.p3.13.m4.1.1.5.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.13.m4.1c">Conv_{k}</annotation></semantics></math> is the convolutional operation, the norm is the normalization, and ReLu is the activation function.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">In CNNs, each hidden layer can be viewed as a feature extractor, and it would respond differently according to input samples. We introduced dynamic pruning gates among each hidden layer to capture hidden layers’ reactions with different inputs. The dynamic pruning gate will adaptively drop off low response parameters.
For example, in the <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">k</annotation></semantics></math> hidden layer, the gate convolutional layer is defined as equation <a href="#S4.E3" title="In IV-A Adaptive dynamically pruning ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#S4.E4" title="In IV-A Adaptive dynamically pruning ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.4" class="ltx_Math" alttext="\hat{\theta}_{k}=\theta_{k}[Gate_{k}(x_{k-1}),Gate_{k-1}(x_{k-2}),:,:]" display="block"><semantics id="S4.E3.m1.4a"><mrow id="S4.E3.m1.4.4" xref="S4.E3.m1.4.4.cmml"><msub id="S4.E3.m1.4.4.4" xref="S4.E3.m1.4.4.4.cmml"><mover accent="true" id="S4.E3.m1.4.4.4.2" xref="S4.E3.m1.4.4.4.2.cmml"><mi id="S4.E3.m1.4.4.4.2.2" xref="S4.E3.m1.4.4.4.2.2.cmml">θ</mi><mo id="S4.E3.m1.4.4.4.2.1" xref="S4.E3.m1.4.4.4.2.1.cmml">^</mo></mover><mi id="S4.E3.m1.4.4.4.3" xref="S4.E3.m1.4.4.4.3.cmml">k</mi></msub><mo id="S4.E3.m1.4.4.3" xref="S4.E3.m1.4.4.3.cmml">=</mo><mrow id="S4.E3.m1.4.4.2" xref="S4.E3.m1.4.4.2.cmml"><msub id="S4.E3.m1.4.4.2.4" xref="S4.E3.m1.4.4.2.4.cmml"><mi id="S4.E3.m1.4.4.2.4.2" xref="S4.E3.m1.4.4.2.4.2.cmml">θ</mi><mi id="S4.E3.m1.4.4.2.4.3" xref="S4.E3.m1.4.4.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.4.4.2.3" xref="S4.E3.m1.4.4.2.3.cmml">​</mo><mrow id="S4.E3.m1.4.4.2.2.2" xref="S4.E3.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.4.4.2.2.2.3" xref="S4.E3.m1.4.4.2.2.3.cmml">[</mo><mrow id="S4.E3.m1.3.3.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.1.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.3.3.1.1.1.1.4" xref="S4.E3.m1.3.3.1.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.1.1.1.1.2a" xref="S4.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.3.3.1.1.1.1.5" xref="S4.E3.m1.3.3.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.1.1.1.1.2b" xref="S4.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><msub id="S4.E3.m1.3.3.1.1.1.1.6" xref="S4.E3.m1.3.3.1.1.1.1.6.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.6.2" xref="S4.E3.m1.3.3.1.1.1.1.6.2.cmml">e</mi><mi id="S4.E3.m1.3.3.1.1.1.1.6.3" xref="S4.E3.m1.3.3.1.1.1.1.6.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.1.1.1.1.2c" xref="S4.E3.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.3.3.1.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.3.3.1.1.1.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E3.m1.3.3.1.1.1.1.1.1.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E3.m1.3.3.1.1.1.1.1.1.3" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.4.2.2.2.4" xref="S4.E3.m1.4.4.2.2.3.cmml">,</mo><mrow id="S4.E3.m1.4.4.2.2.2.2" xref="S4.E3.m1.4.4.2.2.2.2.cmml"><mi id="S4.E3.m1.4.4.2.2.2.2.3" xref="S4.E3.m1.4.4.2.2.2.2.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.4.4.2.2.2.2.2" xref="S4.E3.m1.4.4.2.2.2.2.2.cmml">​</mo><mi id="S4.E3.m1.4.4.2.2.2.2.4" xref="S4.E3.m1.4.4.2.2.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.4.4.2.2.2.2.2a" xref="S4.E3.m1.4.4.2.2.2.2.2.cmml">​</mo><mi id="S4.E3.m1.4.4.2.2.2.2.5" xref="S4.E3.m1.4.4.2.2.2.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.4.4.2.2.2.2.2b" xref="S4.E3.m1.4.4.2.2.2.2.2.cmml">​</mo><msub id="S4.E3.m1.4.4.2.2.2.2.6" xref="S4.E3.m1.4.4.2.2.2.2.6.cmml"><mi id="S4.E3.m1.4.4.2.2.2.2.6.2" xref="S4.E3.m1.4.4.2.2.2.2.6.2.cmml">e</mi><mrow id="S4.E3.m1.4.4.2.2.2.2.6.3" xref="S4.E3.m1.4.4.2.2.2.2.6.3.cmml"><mi id="S4.E3.m1.4.4.2.2.2.2.6.3.2" xref="S4.E3.m1.4.4.2.2.2.2.6.3.2.cmml">k</mi><mo id="S4.E3.m1.4.4.2.2.2.2.6.3.1" xref="S4.E3.m1.4.4.2.2.2.2.6.3.1.cmml">−</mo><mn id="S4.E3.m1.4.4.2.2.2.2.6.3.3" xref="S4.E3.m1.4.4.2.2.2.2.6.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.4.4.2.2.2.2.2c" xref="S4.E3.m1.4.4.2.2.2.2.2.cmml">​</mo><mrow id="S4.E3.m1.4.4.2.2.2.2.1.1" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.4.4.2.2.2.2.1.1.2" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.cmml">(</mo><msub id="S4.E3.m1.4.4.2.2.2.2.1.1.1" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="S4.E3.m1.4.4.2.2.2.2.1.1.1.2" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.2.cmml">x</mi><mrow id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.2" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.2.cmml">k</mi><mo id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.1" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.3" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.3.cmml">2</mn></mrow></msub><mo stretchy="false" id="S4.E3.m1.4.4.2.2.2.2.1.1.3" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.4.2.2.2.5" xref="S4.E3.m1.4.4.2.2.3.cmml">,</mo><mo rspace="0em" id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">:</mo><mo id="S4.E3.m1.4.4.2.2.2.6" xref="S4.E3.m1.4.4.2.2.3.cmml">,</mo><mo rspace="0em" id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml">:</mo><mo stretchy="false" id="S4.E3.m1.4.4.2.2.2.7" xref="S4.E3.m1.4.4.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.4b"><apply id="S4.E3.m1.4.4.cmml" xref="S4.E3.m1.4.4"><eq id="S4.E3.m1.4.4.3.cmml" xref="S4.E3.m1.4.4.3"></eq><apply id="S4.E3.m1.4.4.4.cmml" xref="S4.E3.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.4.1.cmml" xref="S4.E3.m1.4.4.4">subscript</csymbol><apply id="S4.E3.m1.4.4.4.2.cmml" xref="S4.E3.m1.4.4.4.2"><ci id="S4.E3.m1.4.4.4.2.1.cmml" xref="S4.E3.m1.4.4.4.2.1">^</ci><ci id="S4.E3.m1.4.4.4.2.2.cmml" xref="S4.E3.m1.4.4.4.2.2">𝜃</ci></apply><ci id="S4.E3.m1.4.4.4.3.cmml" xref="S4.E3.m1.4.4.4.3">𝑘</ci></apply><apply id="S4.E3.m1.4.4.2.cmml" xref="S4.E3.m1.4.4.2"><times id="S4.E3.m1.4.4.2.3.cmml" xref="S4.E3.m1.4.4.2.3"></times><apply id="S4.E3.m1.4.4.2.4.cmml" xref="S4.E3.m1.4.4.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.2.4.1.cmml" xref="S4.E3.m1.4.4.2.4">subscript</csymbol><ci id="S4.E3.m1.4.4.2.4.2.cmml" xref="S4.E3.m1.4.4.2.4.2">𝜃</ci><ci id="S4.E3.m1.4.4.2.4.3.cmml" xref="S4.E3.m1.4.4.2.4.3">𝑘</ci></apply><list id="S4.E3.m1.4.4.2.2.3.cmml" xref="S4.E3.m1.4.4.2.2.2"><apply id="S4.E3.m1.3.3.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1"><times id="S4.E3.m1.3.3.1.1.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.2"></times><ci id="S4.E3.m1.3.3.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.3">𝐺</ci><ci id="S4.E3.m1.3.3.1.1.1.1.4.cmml" xref="S4.E3.m1.3.3.1.1.1.1.4">𝑎</ci><ci id="S4.E3.m1.3.3.1.1.1.1.5.cmml" xref="S4.E3.m1.3.3.1.1.1.1.5">𝑡</ci><apply id="S4.E3.m1.3.3.1.1.1.1.6.cmml" xref="S4.E3.m1.3.3.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.6.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.6">subscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.1.6.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.6.2">𝑒</ci><ci id="S4.E3.m1.3.3.1.1.1.1.6.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.6.3">𝑘</ci></apply><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3"><minus id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.3.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S4.E3.m1.4.4.2.2.2.2.cmml" xref="S4.E3.m1.4.4.2.2.2.2"><times id="S4.E3.m1.4.4.2.2.2.2.2.cmml" xref="S4.E3.m1.4.4.2.2.2.2.2"></times><ci id="S4.E3.m1.4.4.2.2.2.2.3.cmml" xref="S4.E3.m1.4.4.2.2.2.2.3">𝐺</ci><ci id="S4.E3.m1.4.4.2.2.2.2.4.cmml" xref="S4.E3.m1.4.4.2.2.2.2.4">𝑎</ci><ci id="S4.E3.m1.4.4.2.2.2.2.5.cmml" xref="S4.E3.m1.4.4.2.2.2.2.5">𝑡</ci><apply id="S4.E3.m1.4.4.2.2.2.2.6.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.2.2.2.2.6.1.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6">subscript</csymbol><ci id="S4.E3.m1.4.4.2.2.2.2.6.2.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6.2">𝑒</ci><apply id="S4.E3.m1.4.4.2.2.2.2.6.3.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6.3"><minus id="S4.E3.m1.4.4.2.2.2.2.6.3.1.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6.3.1"></minus><ci id="S4.E3.m1.4.4.2.2.2.2.6.3.2.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6.3.2">𝑘</ci><cn type="integer" id="S4.E3.m1.4.4.2.2.2.2.6.3.3.cmml" xref="S4.E3.m1.4.4.2.2.2.2.6.3.3">1</cn></apply></apply><apply id="S4.E3.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.2.2.2.2.1.1.1.1.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E3.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.2">𝑥</ci><apply id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3"><minus id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.1"></minus><ci id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E3.m1.4.4.2.2.2.2.1.1.1.3.3">2</cn></apply></apply></apply><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">:</ci><ci id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2">:</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.4c">\hat{\theta}_{k}=\theta_{k}[Gate_{k}(x_{k-1}),Gate_{k-1}(x_{k-2}),:,:]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\hat{f_{k}}(x_{k-1})=ReLu(norm(Conv_{k}(x_{k-1},\hat{\theta}_{k})))" display="block"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mover accent="true" id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml"><msub id="S4.E4.m1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.3.2.2.cmml">f</mi><mi id="S4.E4.m1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.3.2.3.cmml">k</mi></msub><mo id="S4.E4.m1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.3.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E4.m1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.E4.m1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E4.m1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.3" xref="S4.E4.m1.2.2.3.cmml">=</mo><mrow id="S4.E4.m1.2.2.2" xref="S4.E4.m1.2.2.2.cmml"><mi id="S4.E4.m1.2.2.2.3" xref="S4.E4.m1.2.2.2.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.2.cmml">​</mo><mi id="S4.E4.m1.2.2.2.4" xref="S4.E4.m1.2.2.2.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.2a" xref="S4.E4.m1.2.2.2.2.cmml">​</mo><mi id="S4.E4.m1.2.2.2.5" xref="S4.E4.m1.2.2.2.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.2b" xref="S4.E4.m1.2.2.2.2.cmml">​</mo><mi id="S4.E4.m1.2.2.2.6" xref="S4.E4.m1.2.2.2.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.2c" xref="S4.E4.m1.2.2.2.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.2.1.1" xref="S4.E4.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.2.1.1.2" xref="S4.E4.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.2.2.2.1.1.1" xref="S4.E4.m1.2.2.2.1.1.1.cmml"><mi id="S4.E4.m1.2.2.2.1.1.1.3" xref="S4.E4.m1.2.2.2.1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.2" xref="S4.E4.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E4.m1.2.2.2.1.1.1.4" xref="S4.E4.m1.2.2.2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.2a" xref="S4.E4.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E4.m1.2.2.2.1.1.1.5" xref="S4.E4.m1.2.2.2.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.2b" xref="S4.E4.m1.2.2.2.1.1.1.2.cmml">​</mo><mi id="S4.E4.m1.2.2.2.1.1.1.6" xref="S4.E4.m1.2.2.2.1.1.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.2c" xref="S4.E4.m1.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.2.1.1.1.1.1" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.2.1.1.1.1.1.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.2.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.4" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.5" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.3a" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.6" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.6.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.3b" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><msub id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.cmml"><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.2.cmml">v</mi><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.3c" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.4" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mo id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.5" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.2.2.2.1.1.1.1.1.3" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.2.2.2.1.1.3" xref="S4.E4.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2"><eq id="S4.E4.m1.2.2.3.cmml" xref="S4.E4.m1.2.2.3"></eq><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><times id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></times><apply id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3"><ci id="S4.E4.m1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.3.1">^</ci><apply id="S4.E4.m1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.3.2.2">𝑓</ci><ci id="S4.E4.m1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E4.m1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3"><minus id="S4.E4.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E4.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S4.E4.m1.2.2.2.cmml" xref="S4.E4.m1.2.2.2"><times id="S4.E4.m1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.2"></times><ci id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.3">𝑅</ci><ci id="S4.E4.m1.2.2.2.4.cmml" xref="S4.E4.m1.2.2.2.4">𝑒</ci><ci id="S4.E4.m1.2.2.2.5.cmml" xref="S4.E4.m1.2.2.2.5">𝐿</ci><ci id="S4.E4.m1.2.2.2.6.cmml" xref="S4.E4.m1.2.2.2.6">𝑢</ci><apply id="S4.E4.m1.2.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.2.1.1"><times id="S4.E4.m1.2.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.2"></times><ci id="S4.E4.m1.2.2.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.3">𝑛</ci><ci id="S4.E4.m1.2.2.2.1.1.1.4.cmml" xref="S4.E4.m1.2.2.2.1.1.1.4">𝑜</ci><ci id="S4.E4.m1.2.2.2.1.1.1.5.cmml" xref="S4.E4.m1.2.2.2.1.1.1.5">𝑟</ci><ci id="S4.E4.m1.2.2.2.1.1.1.6.cmml" xref="S4.E4.m1.2.2.2.1.1.1.6">𝑚</ci><apply id="S4.E4.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1"><times id="S4.E4.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.3"></times><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.4.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.4">𝐶</ci><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.5.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.5">𝑜</ci><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.6.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.6">𝑛</ci><apply id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7">subscript</csymbol><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.2">𝑣</ci><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.7.3">𝑘</ci></apply><interval closure="open" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2"><apply id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3"><minus id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2"><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.2.2">𝜃</ci></apply><ci id="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\hat{f_{k}}(x_{k-1})=ReLu(norm(Conv_{k}(x_{k-1},\hat{\theta}_{k})))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p4.6" class="ltx_p">The <math id="S4.SS1.p4.2.m1.1" class="ltx_Math" alttext="Gate_{k}(x_{k-1})" display="inline"><semantics id="S4.SS1.p4.2.m1.1a"><mrow id="S4.SS1.p4.2.m1.1.1" xref="S4.SS1.p4.2.m1.1.1.cmml"><mi id="S4.SS1.p4.2.m1.1.1.3" xref="S4.SS1.p4.2.m1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m1.1.1.2" xref="S4.SS1.p4.2.m1.1.1.2.cmml">​</mo><mi id="S4.SS1.p4.2.m1.1.1.4" xref="S4.SS1.p4.2.m1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m1.1.1.2a" xref="S4.SS1.p4.2.m1.1.1.2.cmml">​</mo><mi id="S4.SS1.p4.2.m1.1.1.5" xref="S4.SS1.p4.2.m1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m1.1.1.2b" xref="S4.SS1.p4.2.m1.1.1.2.cmml">​</mo><msub id="S4.SS1.p4.2.m1.1.1.6" xref="S4.SS1.p4.2.m1.1.1.6.cmml"><mi id="S4.SS1.p4.2.m1.1.1.6.2" xref="S4.SS1.p4.2.m1.1.1.6.2.cmml">e</mi><mi id="S4.SS1.p4.2.m1.1.1.6.3" xref="S4.SS1.p4.2.m1.1.1.6.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m1.1.1.2c" xref="S4.SS1.p4.2.m1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p4.2.m1.1.1.1.1" xref="S4.SS1.p4.2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p4.2.m1.1.1.1.1.2" xref="S4.SS1.p4.2.m1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.p4.2.m1.1.1.1.1.1" xref="S4.SS1.p4.2.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p4.2.m1.1.1.1.1.1.2" xref="S4.SS1.p4.2.m1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.SS1.p4.2.m1.1.1.1.1.1.3" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p4.2.m1.1.1.1.1.1.3.2" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS1.p4.2.m1.1.1.1.1.1.3.1" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p4.2.m1.1.1.1.1.1.3.3" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS1.p4.2.m1.1.1.1.1.3" xref="S4.SS1.p4.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m1.1b"><apply id="S4.SS1.p4.2.m1.1.1.cmml" xref="S4.SS1.p4.2.m1.1.1"><times id="S4.SS1.p4.2.m1.1.1.2.cmml" xref="S4.SS1.p4.2.m1.1.1.2"></times><ci id="S4.SS1.p4.2.m1.1.1.3.cmml" xref="S4.SS1.p4.2.m1.1.1.3">𝐺</ci><ci id="S4.SS1.p4.2.m1.1.1.4.cmml" xref="S4.SS1.p4.2.m1.1.1.4">𝑎</ci><ci id="S4.SS1.p4.2.m1.1.1.5.cmml" xref="S4.SS1.p4.2.m1.1.1.5">𝑡</ci><apply id="S4.SS1.p4.2.m1.1.1.6.cmml" xref="S4.SS1.p4.2.m1.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m1.1.1.6.1.cmml" xref="S4.SS1.p4.2.m1.1.1.6">subscript</csymbol><ci id="S4.SS1.p4.2.m1.1.1.6.2.cmml" xref="S4.SS1.p4.2.m1.1.1.6.2">𝑒</ci><ci id="S4.SS1.p4.2.m1.1.1.6.3.cmml" xref="S4.SS1.p4.2.m1.1.1.6.3">𝑘</ci></apply><apply id="S4.SS1.p4.2.m1.1.1.1.1.1.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1.1.2">𝑥</ci><apply id="S4.SS1.p4.2.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3"><minus id="S4.SS1.p4.2.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.1"></minus><ci id="S4.SS1.p4.2.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.SS1.p4.2.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p4.2.m1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m1.1c">Gate_{k}(x_{k-1})</annotation></semantics></math> predicts the important channels and produces the channel index tensor with shape <math id="S4.SS1.p4.3.m2.1" class="ltx_Math" alttext="\mathbb{R}^{\hat{C}_{out}\times 1}" display="inline"><semantics id="S4.SS1.p4.3.m2.1a"><msup id="S4.SS1.p4.3.m2.1.1" xref="S4.SS1.p4.3.m2.1.1.cmml"><mi id="S4.SS1.p4.3.m2.1.1.2" xref="S4.SS1.p4.3.m2.1.1.2.cmml">ℝ</mi><mrow id="S4.SS1.p4.3.m2.1.1.3" xref="S4.SS1.p4.3.m2.1.1.3.cmml"><msub id="S4.SS1.p4.3.m2.1.1.3.2" xref="S4.SS1.p4.3.m2.1.1.3.2.cmml"><mover accent="true" id="S4.SS1.p4.3.m2.1.1.3.2.2" xref="S4.SS1.p4.3.m2.1.1.3.2.2.cmml"><mi id="S4.SS1.p4.3.m2.1.1.3.2.2.2" xref="S4.SS1.p4.3.m2.1.1.3.2.2.2.cmml">C</mi><mo id="S4.SS1.p4.3.m2.1.1.3.2.2.1" xref="S4.SS1.p4.3.m2.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p4.3.m2.1.1.3.2.3" xref="S4.SS1.p4.3.m2.1.1.3.2.3.cmml"><mi id="S4.SS1.p4.3.m2.1.1.3.2.3.2" xref="S4.SS1.p4.3.m2.1.1.3.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m2.1.1.3.2.3.1" xref="S4.SS1.p4.3.m2.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.3.m2.1.1.3.2.3.3" xref="S4.SS1.p4.3.m2.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.3.m2.1.1.3.2.3.1a" xref="S4.SS1.p4.3.m2.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.3.m2.1.1.3.2.3.4" xref="S4.SS1.p4.3.m2.1.1.3.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p4.3.m2.1.1.3.1" xref="S4.SS1.p4.3.m2.1.1.3.1.cmml">×</mo><mn id="S4.SS1.p4.3.m2.1.1.3.3" xref="S4.SS1.p4.3.m2.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m2.1b"><apply id="S4.SS1.p4.3.m2.1.1.cmml" xref="S4.SS1.p4.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m2.1.1.1.cmml" xref="S4.SS1.p4.3.m2.1.1">superscript</csymbol><ci id="S4.SS1.p4.3.m2.1.1.2.cmml" xref="S4.SS1.p4.3.m2.1.1.2">ℝ</ci><apply id="S4.SS1.p4.3.m2.1.1.3.cmml" xref="S4.SS1.p4.3.m2.1.1.3"><times id="S4.SS1.p4.3.m2.1.1.3.1.cmml" xref="S4.SS1.p4.3.m2.1.1.3.1"></times><apply id="S4.SS1.p4.3.m2.1.1.3.2.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.3.m2.1.1.3.2.1.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2">subscript</csymbol><apply id="S4.SS1.p4.3.m2.1.1.3.2.2.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.2"><ci id="S4.SS1.p4.3.m2.1.1.3.2.2.1.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.2.1">^</ci><ci id="S4.SS1.p4.3.m2.1.1.3.2.2.2.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.2.2">𝐶</ci></apply><apply id="S4.SS1.p4.3.m2.1.1.3.2.3.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.3"><times id="S4.SS1.p4.3.m2.1.1.3.2.3.1.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.3.1"></times><ci id="S4.SS1.p4.3.m2.1.1.3.2.3.2.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.3.2">𝑜</ci><ci id="S4.SS1.p4.3.m2.1.1.3.2.3.3.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.3.3">𝑢</ci><ci id="S4.SS1.p4.3.m2.1.1.3.2.3.4.cmml" xref="S4.SS1.p4.3.m2.1.1.3.2.3.4">𝑡</ci></apply></apply><cn type="integer" id="S4.SS1.p4.3.m2.1.1.3.3.cmml" xref="S4.SS1.p4.3.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m2.1c">\mathbb{R}^{\hat{C}_{out}\times 1}</annotation></semantics></math>, where the <math id="S4.SS1.p4.4.m3.1" class="ltx_Math" alttext="\hat{C}_{out}" display="inline"><semantics id="S4.SS1.p4.4.m3.1a"><msub id="S4.SS1.p4.4.m3.1.1" xref="S4.SS1.p4.4.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p4.4.m3.1.1.2" xref="S4.SS1.p4.4.m3.1.1.2.cmml"><mi id="S4.SS1.p4.4.m3.1.1.2.2" xref="S4.SS1.p4.4.m3.1.1.2.2.cmml">C</mi><mo id="S4.SS1.p4.4.m3.1.1.2.1" xref="S4.SS1.p4.4.m3.1.1.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p4.4.m3.1.1.3" xref="S4.SS1.p4.4.m3.1.1.3.cmml"><mi id="S4.SS1.p4.4.m3.1.1.3.2" xref="S4.SS1.p4.4.m3.1.1.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.4.m3.1.1.3.1" xref="S4.SS1.p4.4.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.4.m3.1.1.3.3" xref="S4.SS1.p4.4.m3.1.1.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.4.m3.1.1.3.1a" xref="S4.SS1.p4.4.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p4.4.m3.1.1.3.4" xref="S4.SS1.p4.4.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m3.1b"><apply id="S4.SS1.p4.4.m3.1.1.cmml" xref="S4.SS1.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.4.m3.1.1.1.cmml" xref="S4.SS1.p4.4.m3.1.1">subscript</csymbol><apply id="S4.SS1.p4.4.m3.1.1.2.cmml" xref="S4.SS1.p4.4.m3.1.1.2"><ci id="S4.SS1.p4.4.m3.1.1.2.1.cmml" xref="S4.SS1.p4.4.m3.1.1.2.1">^</ci><ci id="S4.SS1.p4.4.m3.1.1.2.2.cmml" xref="S4.SS1.p4.4.m3.1.1.2.2">𝐶</ci></apply><apply id="S4.SS1.p4.4.m3.1.1.3.cmml" xref="S4.SS1.p4.4.m3.1.1.3"><times id="S4.SS1.p4.4.m3.1.1.3.1.cmml" xref="S4.SS1.p4.4.m3.1.1.3.1"></times><ci id="S4.SS1.p4.4.m3.1.1.3.2.cmml" xref="S4.SS1.p4.4.m3.1.1.3.2">𝑜</ci><ci id="S4.SS1.p4.4.m3.1.1.3.3.cmml" xref="S4.SS1.p4.4.m3.1.1.3.3">𝑢</ci><ci id="S4.SS1.p4.4.m3.1.1.3.4.cmml" xref="S4.SS1.p4.4.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m3.1c">\hat{C}_{out}</annotation></semantics></math> is the number of channels predicted to be important for k-th convolution layers. In the gate convolutional layer, we have the selected parameter <math id="S4.SS1.p4.5.m4.1" class="ltx_Math" alttext="\hat{\theta}_{k}" display="inline"><semantics id="S4.SS1.p4.5.m4.1a"><msub id="S4.SS1.p4.5.m4.1.1" xref="S4.SS1.p4.5.m4.1.1.cmml"><mover accent="true" id="S4.SS1.p4.5.m4.1.1.2" xref="S4.SS1.p4.5.m4.1.1.2.cmml"><mi id="S4.SS1.p4.5.m4.1.1.2.2" xref="S4.SS1.p4.5.m4.1.1.2.2.cmml">θ</mi><mo id="S4.SS1.p4.5.m4.1.1.2.1" xref="S4.SS1.p4.5.m4.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p4.5.m4.1.1.3" xref="S4.SS1.p4.5.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m4.1b"><apply id="S4.SS1.p4.5.m4.1.1.cmml" xref="S4.SS1.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m4.1.1.1.cmml" xref="S4.SS1.p4.5.m4.1.1">subscript</csymbol><apply id="S4.SS1.p4.5.m4.1.1.2.cmml" xref="S4.SS1.p4.5.m4.1.1.2"><ci id="S4.SS1.p4.5.m4.1.1.2.1.cmml" xref="S4.SS1.p4.5.m4.1.1.2.1">^</ci><ci id="S4.SS1.p4.5.m4.1.1.2.2.cmml" xref="S4.SS1.p4.5.m4.1.1.2.2">𝜃</ci></apply><ci id="S4.SS1.p4.5.m4.1.1.3.cmml" xref="S4.SS1.p4.5.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m4.1c">\hat{\theta}_{k}</annotation></semantics></math> with size <math id="S4.SS1.p4.6.m5.1" class="ltx_Math" alttext="\mathbb{R}^{\hat{C}_{out}\times\hat{C}_{in}\times K\times K}" display="inline"><semantics id="S4.SS1.p4.6.m5.1a"><msup id="S4.SS1.p4.6.m5.1.1" xref="S4.SS1.p4.6.m5.1.1.cmml"><mi id="S4.SS1.p4.6.m5.1.1.2" xref="S4.SS1.p4.6.m5.1.1.2.cmml">ℝ</mi><mrow id="S4.SS1.p4.6.m5.1.1.3" xref="S4.SS1.p4.6.m5.1.1.3.cmml"><msub id="S4.SS1.p4.6.m5.1.1.3.2" xref="S4.SS1.p4.6.m5.1.1.3.2.cmml"><mover accent="true" id="S4.SS1.p4.6.m5.1.1.3.2.2" xref="S4.SS1.p4.6.m5.1.1.3.2.2.cmml"><mi id="S4.SS1.p4.6.m5.1.1.3.2.2.2" xref="S4.SS1.p4.6.m5.1.1.3.2.2.2.cmml">C</mi><mo id="S4.SS1.p4.6.m5.1.1.3.2.2.1" xref="S4.SS1.p4.6.m5.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p4.6.m5.1.1.3.2.3" xref="S4.SS1.p4.6.m5.1.1.3.2.3.cmml"><mi id="S4.SS1.p4.6.m5.1.1.3.2.3.2" xref="S4.SS1.p4.6.m5.1.1.3.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.6.m5.1.1.3.2.3.1" xref="S4.SS1.p4.6.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.6.m5.1.1.3.2.3.3" xref="S4.SS1.p4.6.m5.1.1.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.6.m5.1.1.3.2.3.1a" xref="S4.SS1.p4.6.m5.1.1.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p4.6.m5.1.1.3.2.3.4" xref="S4.SS1.p4.6.m5.1.1.3.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p4.6.m5.1.1.3.1" xref="S4.SS1.p4.6.m5.1.1.3.1.cmml">×</mo><msub id="S4.SS1.p4.6.m5.1.1.3.3" xref="S4.SS1.p4.6.m5.1.1.3.3.cmml"><mover accent="true" id="S4.SS1.p4.6.m5.1.1.3.3.2" xref="S4.SS1.p4.6.m5.1.1.3.3.2.cmml"><mi id="S4.SS1.p4.6.m5.1.1.3.3.2.2" xref="S4.SS1.p4.6.m5.1.1.3.3.2.2.cmml">C</mi><mo id="S4.SS1.p4.6.m5.1.1.3.3.2.1" xref="S4.SS1.p4.6.m5.1.1.3.3.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p4.6.m5.1.1.3.3.3" xref="S4.SS1.p4.6.m5.1.1.3.3.3.cmml"><mi id="S4.SS1.p4.6.m5.1.1.3.3.3.2" xref="S4.SS1.p4.6.m5.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.6.m5.1.1.3.3.3.1" xref="S4.SS1.p4.6.m5.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS1.p4.6.m5.1.1.3.3.3.3" xref="S4.SS1.p4.6.m5.1.1.3.3.3.3.cmml">n</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p4.6.m5.1.1.3.1a" xref="S4.SS1.p4.6.m5.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p4.6.m5.1.1.3.4" xref="S4.SS1.p4.6.m5.1.1.3.4.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p4.6.m5.1.1.3.1b" xref="S4.SS1.p4.6.m5.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p4.6.m5.1.1.3.5" xref="S4.SS1.p4.6.m5.1.1.3.5.cmml">K</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m5.1b"><apply id="S4.SS1.p4.6.m5.1.1.cmml" xref="S4.SS1.p4.6.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.6.m5.1.1.1.cmml" xref="S4.SS1.p4.6.m5.1.1">superscript</csymbol><ci id="S4.SS1.p4.6.m5.1.1.2.cmml" xref="S4.SS1.p4.6.m5.1.1.2">ℝ</ci><apply id="S4.SS1.p4.6.m5.1.1.3.cmml" xref="S4.SS1.p4.6.m5.1.1.3"><times id="S4.SS1.p4.6.m5.1.1.3.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.1"></times><apply id="S4.SS1.p4.6.m5.1.1.3.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.6.m5.1.1.3.2.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2">subscript</csymbol><apply id="S4.SS1.p4.6.m5.1.1.3.2.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.2"><ci id="S4.SS1.p4.6.m5.1.1.3.2.2.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.2.1">^</ci><ci id="S4.SS1.p4.6.m5.1.1.3.2.2.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.2.2">𝐶</ci></apply><apply id="S4.SS1.p4.6.m5.1.1.3.2.3.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.3"><times id="S4.SS1.p4.6.m5.1.1.3.2.3.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.3.1"></times><ci id="S4.SS1.p4.6.m5.1.1.3.2.3.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.3.2">𝑜</ci><ci id="S4.SS1.p4.6.m5.1.1.3.2.3.3.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.3.3">𝑢</ci><ci id="S4.SS1.p4.6.m5.1.1.3.2.3.4.cmml" xref="S4.SS1.p4.6.m5.1.1.3.2.3.4">𝑡</ci></apply></apply><apply id="S4.SS1.p4.6.m5.1.1.3.3.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p4.6.m5.1.1.3.3.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3">subscript</csymbol><apply id="S4.SS1.p4.6.m5.1.1.3.3.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.2"><ci id="S4.SS1.p4.6.m5.1.1.3.3.2.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.2.1">^</ci><ci id="S4.SS1.p4.6.m5.1.1.3.3.2.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.2.2">𝐶</ci></apply><apply id="S4.SS1.p4.6.m5.1.1.3.3.3.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.3"><times id="S4.SS1.p4.6.m5.1.1.3.3.3.1.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.3.1"></times><ci id="S4.SS1.p4.6.m5.1.1.3.3.3.2.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.3.2">𝑖</ci><ci id="S4.SS1.p4.6.m5.1.1.3.3.3.3.cmml" xref="S4.SS1.p4.6.m5.1.1.3.3.3.3">𝑛</ci></apply></apply><ci id="S4.SS1.p4.6.m5.1.1.3.4.cmml" xref="S4.SS1.p4.6.m5.1.1.3.4">𝐾</ci><ci id="S4.SS1.p4.6.m5.1.1.3.5.cmml" xref="S4.SS1.p4.6.m5.1.1.3.5">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m5.1c">\mathbb{R}^{\hat{C}_{out}\times\hat{C}_{in}\times K\times K}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.7" class="ltx_p">In the back-propagation, only important parameters would be updated, as unimportant parameters have been dropped out and no gradient retained for them. Equation <a href="#S4.E5" title="In IV-A Adaptive dynamically pruning ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the local updates objective function.</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.4" class="ltx_Math" alttext="\min_{w}\mathcal{L}(w)=\frac{1}{n_{i}}\sum l(w_{i},x_{i},y_{i})" display="block"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml"><mrow id="S4.E5.m1.4.4.5" xref="S4.E5.m1.4.4.5.cmml"><mrow id="S4.E5.m1.4.4.5.2" xref="S4.E5.m1.4.4.5.2.cmml"><munder id="S4.E5.m1.4.4.5.2.1" xref="S4.E5.m1.4.4.5.2.1.cmml"><mi id="S4.E5.m1.4.4.5.2.1.2" xref="S4.E5.m1.4.4.5.2.1.2.cmml">min</mi><mi id="S4.E5.m1.4.4.5.2.1.3" xref="S4.E5.m1.4.4.5.2.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S4.E5.m1.4.4.5.2a" xref="S4.E5.m1.4.4.5.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.5.2.2" xref="S4.E5.m1.4.4.5.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.5.1" xref="S4.E5.m1.4.4.5.1.cmml">​</mo><mrow id="S4.E5.m1.4.4.5.3.2" xref="S4.E5.m1.4.4.5.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.5.3.2.1" xref="S4.E5.m1.4.4.5.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">w</mi><mo stretchy="false" id="S4.E5.m1.4.4.5.3.2.2" xref="S4.E5.m1.4.4.5.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.4.4.4" xref="S4.E5.m1.4.4.4.cmml">=</mo><mrow id="S4.E5.m1.4.4.3" xref="S4.E5.m1.4.4.3.cmml"><mfrac id="S4.E5.m1.4.4.3.5" xref="S4.E5.m1.4.4.3.5.cmml"><mn id="S4.E5.m1.4.4.3.5.2" xref="S4.E5.m1.4.4.3.5.2.cmml">1</mn><msub id="S4.E5.m1.4.4.3.5.3" xref="S4.E5.m1.4.4.3.5.3.cmml"><mi id="S4.E5.m1.4.4.3.5.3.2" xref="S4.E5.m1.4.4.3.5.3.2.cmml">n</mi><mi id="S4.E5.m1.4.4.3.5.3.3" xref="S4.E5.m1.4.4.3.5.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.4" xref="S4.E5.m1.4.4.3.4.cmml">​</mo><mrow id="S4.E5.m1.4.4.3.3" xref="S4.E5.m1.4.4.3.3.cmml"><mo movablelimits="false" id="S4.E5.m1.4.4.3.3.4" xref="S4.E5.m1.4.4.3.3.4.cmml">∑</mo><mrow id="S4.E5.m1.4.4.3.3.3" xref="S4.E5.m1.4.4.3.3.3.cmml"><mi id="S4.E5.m1.4.4.3.3.3.5" xref="S4.E5.m1.4.4.3.3.3.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.4.4.3.3.3.4" xref="S4.E5.m1.4.4.3.3.3.4.cmml">​</mo><mrow id="S4.E5.m1.4.4.3.3.3.3.3" xref="S4.E5.m1.4.4.3.3.3.3.4.cmml"><mo stretchy="false" id="S4.E5.m1.4.4.3.3.3.3.3.4" xref="S4.E5.m1.4.4.3.3.3.3.4.cmml">(</mo><msub id="S4.E5.m1.2.2.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5.m1.4.4.3.3.3.3.3.5" xref="S4.E5.m1.4.4.3.3.3.3.4.cmml">,</mo><msub id="S4.E5.m1.3.3.2.2.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S4.E5.m1.3.3.2.2.2.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.2.2.2.cmml">x</mi><mi id="S4.E5.m1.3.3.2.2.2.2.2.2.3" xref="S4.E5.m1.3.3.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.4.4.3.3.3.3.3.6" xref="S4.E5.m1.4.4.3.3.3.3.4.cmml">,</mo><msub id="S4.E5.m1.4.4.3.3.3.3.3.3" xref="S4.E5.m1.4.4.3.3.3.3.3.3.cmml"><mi id="S4.E5.m1.4.4.3.3.3.3.3.3.2" xref="S4.E5.m1.4.4.3.3.3.3.3.3.2.cmml">y</mi><mi id="S4.E5.m1.4.4.3.3.3.3.3.3.3" xref="S4.E5.m1.4.4.3.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E5.m1.4.4.3.3.3.3.3.7" xref="S4.E5.m1.4.4.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4"><eq id="S4.E5.m1.4.4.4.cmml" xref="S4.E5.m1.4.4.4"></eq><apply id="S4.E5.m1.4.4.5.cmml" xref="S4.E5.m1.4.4.5"><times id="S4.E5.m1.4.4.5.1.cmml" xref="S4.E5.m1.4.4.5.1"></times><apply id="S4.E5.m1.4.4.5.2.cmml" xref="S4.E5.m1.4.4.5.2"><apply id="S4.E5.m1.4.4.5.2.1.cmml" xref="S4.E5.m1.4.4.5.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.5.2.1.1.cmml" xref="S4.E5.m1.4.4.5.2.1">subscript</csymbol><min id="S4.E5.m1.4.4.5.2.1.2.cmml" xref="S4.E5.m1.4.4.5.2.1.2"></min><ci id="S4.E5.m1.4.4.5.2.1.3.cmml" xref="S4.E5.m1.4.4.5.2.1.3">𝑤</ci></apply><ci id="S4.E5.m1.4.4.5.2.2.cmml" xref="S4.E5.m1.4.4.5.2.2">ℒ</ci></apply><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝑤</ci></apply><apply id="S4.E5.m1.4.4.3.cmml" xref="S4.E5.m1.4.4.3"><times id="S4.E5.m1.4.4.3.4.cmml" xref="S4.E5.m1.4.4.3.4"></times><apply id="S4.E5.m1.4.4.3.5.cmml" xref="S4.E5.m1.4.4.3.5"><divide id="S4.E5.m1.4.4.3.5.1.cmml" xref="S4.E5.m1.4.4.3.5"></divide><cn type="integer" id="S4.E5.m1.4.4.3.5.2.cmml" xref="S4.E5.m1.4.4.3.5.2">1</cn><apply id="S4.E5.m1.4.4.3.5.3.cmml" xref="S4.E5.m1.4.4.3.5.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.5.3.1.cmml" xref="S4.E5.m1.4.4.3.5.3">subscript</csymbol><ci id="S4.E5.m1.4.4.3.5.3.2.cmml" xref="S4.E5.m1.4.4.3.5.3.2">𝑛</ci><ci id="S4.E5.m1.4.4.3.5.3.3.cmml" xref="S4.E5.m1.4.4.3.5.3.3">𝑖</ci></apply></apply><apply id="S4.E5.m1.4.4.3.3.cmml" xref="S4.E5.m1.4.4.3.3"><sum id="S4.E5.m1.4.4.3.3.4.cmml" xref="S4.E5.m1.4.4.3.3.4"></sum><apply id="S4.E5.m1.4.4.3.3.3.cmml" xref="S4.E5.m1.4.4.3.3.3"><times id="S4.E5.m1.4.4.3.3.3.4.cmml" xref="S4.E5.m1.4.4.3.3.3.4"></times><ci id="S4.E5.m1.4.4.3.3.3.5.cmml" xref="S4.E5.m1.4.4.3.3.3.5">𝑙</ci><vector id="S4.E5.m1.4.4.3.3.3.3.4.cmml" xref="S4.E5.m1.4.4.3.3.3.3.3"><apply id="S4.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m1.3.3.2.2.2.2.2.2.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2.2.2">𝑥</ci><ci id="S4.E5.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.E5.m1.4.4.3.3.3.3.3.3.cmml" xref="S4.E5.m1.4.4.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.3.3.3.3.3.3.1.cmml" xref="S4.E5.m1.4.4.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E5.m1.4.4.3.3.3.3.3.3.2.cmml" xref="S4.E5.m1.4.4.3.3.3.3.3.3.2">𝑦</ci><ci id="S4.E5.m1.4.4.3.3.3.3.3.3.3.cmml" xref="S4.E5.m1.4.4.3.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">\min_{w}\mathcal{L}(w)=\frac{1}{n_{i}}\sum l(w_{i},x_{i},y_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p5.6" class="ltx_p">, <math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><mi id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><ci id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">l</annotation></semantics></math> refers to the loss when fitting the label <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><msub id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml"><mi id="S4.SS1.p5.2.m2.1.1.2" xref="S4.SS1.p5.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.p5.2.m2.1.1.3" xref="S4.SS1.p5.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><apply id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.p5.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.p5.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">y_{i}</annotation></semantics></math> for data <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><msub id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.p5.3.m3.1.1.2" xref="S4.SS1.p5.3.m3.1.1.2.cmml">x</mi><mi id="S4.SS1.p5.3.m3.1.1.3" xref="S4.SS1.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><apply id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.p5.3.m3.1.1.2">𝑥</ci><ci id="S4.SS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">x_{i}</annotation></semantics></math>, and <math id="S4.SS1.p5.4.m4.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S4.SS1.p5.4.m4.1a"><msub id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.p5.4.m4.1.1.2" xref="S4.SS1.p5.4.m4.1.1.2.cmml">n</mi><mi id="S4.SS1.p5.4.m4.1.1.3" xref="S4.SS1.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><apply id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.p5.4.m4.1.1.2">𝑛</ci><ci id="S4.SS1.p5.4.m4.1.1.3.cmml" xref="S4.SS1.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">n_{i}</annotation></semantics></math> is the constant coefficient, <math id="S4.SS1.p5.5.m5.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.SS1.p5.5.m5.1a"><msub id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml"><mi id="S4.SS1.p5.5.m5.1.1.2" xref="S4.SS1.p5.5.m5.1.1.2.cmml">w</mi><mi id="S4.SS1.p5.5.m5.1.1.3" xref="S4.SS1.p5.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><apply id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.p5.5.m5.1.1.2">𝑤</ci><ci id="S4.SS1.p5.5.m5.1.1.3.cmml" xref="S4.SS1.p5.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">w_{i}</annotation></semantics></math> is the salient parameter for the input <math id="S4.SS1.p5.6.m6.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S4.SS1.p5.6.m6.1a"><msub id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml"><mi id="S4.SS1.p5.6.m6.1.1.2" xref="S4.SS1.p5.6.m6.1.1.2.cmml">x</mi><mi id="S4.SS1.p5.6.m6.1.1.3" xref="S4.SS1.p5.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><apply id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.6.m6.1.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p5.6.m6.1.1.2.cmml" xref="S4.SS1.p5.6.m6.1.1.2">𝑥</ci><ci id="S4.SS1.p5.6.m6.1.1.3.cmml" xref="S4.SS1.p5.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">x_{i}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Dynamic pruning gate</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The dynamic pruning gate takes the current layer’s feature map as input and predicts the important channels (convolutional filters) to be selected.
Essentially, the dynamic pruning gate sub-samples the spatial dimensions of the feature map to scalars and a linear layer to make the prediction. The <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="Gate_{k}(x_{k-1})" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">​</mo><mi id="S4.SS2.p1.1.m1.1.1.4" xref="S4.SS2.p1.1.m1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.2a" xref="S4.SS2.p1.1.m1.1.1.2.cmml">​</mo><mi id="S4.SS2.p1.1.m1.1.1.5" xref="S4.SS2.p1.1.m1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.2b" xref="S4.SS2.p1.1.m1.1.1.2.cmml">​</mo><msub id="S4.SS2.p1.1.m1.1.1.6" xref="S4.SS2.p1.1.m1.1.1.6.cmml"><mi id="S4.SS2.p1.1.m1.1.1.6.2" xref="S4.SS2.p1.1.m1.1.1.6.2.cmml">e</mi><mi id="S4.SS2.p1.1.m1.1.1.6.3" xref="S4.SS2.p1.1.m1.1.1.6.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1.2c" xref="S4.SS2.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.SS2.p1.1.m1.1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S4.SS2.p1.1.m1.1.1.1.1.1.3.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><times id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"></times><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝐺</ci><ci id="S4.SS2.p1.1.m1.1.1.4.cmml" xref="S4.SS2.p1.1.m1.1.1.4">𝑎</ci><ci id="S4.SS2.p1.1.m1.1.1.5.cmml" xref="S4.SS2.p1.1.m1.1.1.5">𝑡</ci><apply id="S4.SS2.p1.1.m1.1.1.6.cmml" xref="S4.SS2.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.6.1.cmml" xref="S4.SS2.p1.1.m1.1.1.6">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.6.2.cmml" xref="S4.SS2.p1.1.m1.1.1.6.2">𝑒</ci><ci id="S4.SS2.p1.1.m1.1.1.6.3.cmml" xref="S4.SS2.p1.1.m1.1.1.6.3">𝑘</ci></apply><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.2">𝑥</ci><apply id="S4.SS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3"><minus id="S4.SS2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.1"></minus><ci id="S4.SS2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">Gate_{k}(x_{k-1})</annotation></semantics></math> can be formulate as equation <a href="#S4.E6" title="In IV-B Dynamic pruning gate ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and  <a href="#S4.E7" title="In IV-B Dynamic pruning gate ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.2" class="ltx_Math" alttext="s_{k}=\operatorname{subsample}(x_{k})\in\mathbb{R}^{\hat{C}_{in}\times 1\times 1}" display="block"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><msub id="S4.E6.m1.2.2.3" xref="S4.E6.m1.2.2.3.cmml"><mi id="S4.E6.m1.2.2.3.2" xref="S4.E6.m1.2.2.3.2.cmml">s</mi><mi id="S4.E6.m1.2.2.3.3" xref="S4.E6.m1.2.2.3.3.cmml">k</mi></msub><mo id="S4.E6.m1.2.2.4" xref="S4.E6.m1.2.2.4.cmml">=</mo><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.2.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">subsample</mi><mo id="S4.E6.m1.2.2.1.1a" xref="S4.E6.m1.2.2.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.1.2" xref="S4.E6.m1.2.2.1.2.cmml">(</mo><msub id="S4.E6.m1.2.2.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.2.cmml">x</mi><mi id="S4.E6.m1.2.2.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.2.2.5" xref="S4.E6.m1.2.2.5.cmml">∈</mo><msup id="S4.E6.m1.2.2.6" xref="S4.E6.m1.2.2.6.cmml"><mi id="S4.E6.m1.2.2.6.2" xref="S4.E6.m1.2.2.6.2.cmml">ℝ</mi><mrow id="S4.E6.m1.2.2.6.3" xref="S4.E6.m1.2.2.6.3.cmml"><msub id="S4.E6.m1.2.2.6.3.2" xref="S4.E6.m1.2.2.6.3.2.cmml"><mover accent="true" id="S4.E6.m1.2.2.6.3.2.2" xref="S4.E6.m1.2.2.6.3.2.2.cmml"><mi id="S4.E6.m1.2.2.6.3.2.2.2" xref="S4.E6.m1.2.2.6.3.2.2.2.cmml">C</mi><mo id="S4.E6.m1.2.2.6.3.2.2.1" xref="S4.E6.m1.2.2.6.3.2.2.1.cmml">^</mo></mover><mrow id="S4.E6.m1.2.2.6.3.2.3" xref="S4.E6.m1.2.2.6.3.2.3.cmml"><mi id="S4.E6.m1.2.2.6.3.2.3.2" xref="S4.E6.m1.2.2.6.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.6.3.2.3.1" xref="S4.E6.m1.2.2.6.3.2.3.1.cmml">​</mo><mi id="S4.E6.m1.2.2.6.3.2.3.3" xref="S4.E6.m1.2.2.6.3.2.3.3.cmml">n</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.2.2.6.3.1" xref="S4.E6.m1.2.2.6.3.1.cmml">×</mo><mn id="S4.E6.m1.2.2.6.3.3" xref="S4.E6.m1.2.2.6.3.3.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.E6.m1.2.2.6.3.1a" xref="S4.E6.m1.2.2.6.3.1.cmml">×</mo><mn id="S4.E6.m1.2.2.6.3.4" xref="S4.E6.m1.2.2.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><and id="S4.E6.m1.2.2a.cmml" xref="S4.E6.m1.2.2"></and><apply id="S4.E6.m1.2.2b.cmml" xref="S4.E6.m1.2.2"><eq id="S4.E6.m1.2.2.4.cmml" xref="S4.E6.m1.2.2.4"></eq><apply id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.3.1.cmml" xref="S4.E6.m1.2.2.3">subscript</csymbol><ci id="S4.E6.m1.2.2.3.2.cmml" xref="S4.E6.m1.2.2.3.2">𝑠</ci><ci id="S4.E6.m1.2.2.3.3.cmml" xref="S4.E6.m1.2.2.3.3">𝑘</ci></apply><apply id="S4.E6.m1.2.2.1.2.cmml" xref="S4.E6.m1.2.2.1.1"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">subsample</ci><apply id="S4.E6.m1.2.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="S4.E6.m1.2.2.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S4.E6.m1.2.2c.cmml" xref="S4.E6.m1.2.2"><in id="S4.E6.m1.2.2.5.cmml" xref="S4.E6.m1.2.2.5"></in><share href="#S4.E6.m1.2.2.1.cmml" id="S4.E6.m1.2.2d.cmml" xref="S4.E6.m1.2.2"></share><apply id="S4.E6.m1.2.2.6.cmml" xref="S4.E6.m1.2.2.6"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.6.1.cmml" xref="S4.E6.m1.2.2.6">superscript</csymbol><ci id="S4.E6.m1.2.2.6.2.cmml" xref="S4.E6.m1.2.2.6.2">ℝ</ci><apply id="S4.E6.m1.2.2.6.3.cmml" xref="S4.E6.m1.2.2.6.3"><times id="S4.E6.m1.2.2.6.3.1.cmml" xref="S4.E6.m1.2.2.6.3.1"></times><apply id="S4.E6.m1.2.2.6.3.2.cmml" xref="S4.E6.m1.2.2.6.3.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.6.3.2.1.cmml" xref="S4.E6.m1.2.2.6.3.2">subscript</csymbol><apply id="S4.E6.m1.2.2.6.3.2.2.cmml" xref="S4.E6.m1.2.2.6.3.2.2"><ci id="S4.E6.m1.2.2.6.3.2.2.1.cmml" xref="S4.E6.m1.2.2.6.3.2.2.1">^</ci><ci id="S4.E6.m1.2.2.6.3.2.2.2.cmml" xref="S4.E6.m1.2.2.6.3.2.2.2">𝐶</ci></apply><apply id="S4.E6.m1.2.2.6.3.2.3.cmml" xref="S4.E6.m1.2.2.6.3.2.3"><times id="S4.E6.m1.2.2.6.3.2.3.1.cmml" xref="S4.E6.m1.2.2.6.3.2.3.1"></times><ci id="S4.E6.m1.2.2.6.3.2.3.2.cmml" xref="S4.E6.m1.2.2.6.3.2.3.2">𝑖</ci><ci id="S4.E6.m1.2.2.6.3.2.3.3.cmml" xref="S4.E6.m1.2.2.6.3.2.3.3">𝑛</ci></apply></apply><cn type="integer" id="S4.E6.m1.2.2.6.3.3.cmml" xref="S4.E6.m1.2.2.6.3.3">1</cn><cn type="integer" id="S4.E6.m1.2.2.6.3.4.cmml" xref="S4.E6.m1.2.2.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">s_{k}=\operatorname{subsample}(x_{k})\in\mathbb{R}^{\hat{C}_{in}\times 1\times 1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.4" class="ltx_Math" alttext="g_{k}={\operatorname{K-argmax}}(\operatorname{Sigmoid}(\operatorname{linear}(s_{k})))\in\mathbb{R}^{\hat{C}_{out}\times 1\times 1}" display="block"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml"><msub id="S4.E7.m1.4.4.3" xref="S4.E7.m1.4.4.3.cmml"><mi id="S4.E7.m1.4.4.3.2" xref="S4.E7.m1.4.4.3.2.cmml">g</mi><mi id="S4.E7.m1.4.4.3.3" xref="S4.E7.m1.4.4.3.3.cmml">k</mi></msub><mo id="S4.E7.m1.4.4.4" xref="S4.E7.m1.4.4.4.cmml">=</mo><mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.2.cmml"><mrow id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml"><mi mathvariant="normal" id="S4.E7.m1.3.3.2" xref="S4.E7.m1.3.3.2.cmml">K</mi><mo id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.cmml">−</mo><mi id="S4.E7.m1.3.3.3" xref="S4.E7.m1.3.3.3.cmml">argmax</mi></mrow><mo id="S4.E7.m1.4.4.1.1a" xref="S4.E7.m1.4.4.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.4.4.1.1.1.2" xref="S4.E7.m1.4.4.1.2.cmml">(</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">Sigmoid</mi><mo id="S4.E7.m1.4.4.1.1.1.1.1a" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.4.4.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">(</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">linear</mi><mo id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1a" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E7.m1.4.4.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E7.m1.4.4.1.1.1.3" xref="S4.E7.m1.4.4.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.4.5" xref="S4.E7.m1.4.4.5.cmml">∈</mo><msup id="S4.E7.m1.4.4.6" xref="S4.E7.m1.4.4.6.cmml"><mi id="S4.E7.m1.4.4.6.2" xref="S4.E7.m1.4.4.6.2.cmml">ℝ</mi><mrow id="S4.E7.m1.4.4.6.3" xref="S4.E7.m1.4.4.6.3.cmml"><msub id="S4.E7.m1.4.4.6.3.2" xref="S4.E7.m1.4.4.6.3.2.cmml"><mover accent="true" id="S4.E7.m1.4.4.6.3.2.2" xref="S4.E7.m1.4.4.6.3.2.2.cmml"><mi id="S4.E7.m1.4.4.6.3.2.2.2" xref="S4.E7.m1.4.4.6.3.2.2.2.cmml">C</mi><mo id="S4.E7.m1.4.4.6.3.2.2.1" xref="S4.E7.m1.4.4.6.3.2.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.4.4.6.3.2.3" xref="S4.E7.m1.4.4.6.3.2.3.cmml"><mi id="S4.E7.m1.4.4.6.3.2.3.2" xref="S4.E7.m1.4.4.6.3.2.3.2.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.4.6.3.2.3.1" xref="S4.E7.m1.4.4.6.3.2.3.1.cmml">​</mo><mi id="S4.E7.m1.4.4.6.3.2.3.3" xref="S4.E7.m1.4.4.6.3.2.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.4.4.6.3.2.3.1a" xref="S4.E7.m1.4.4.6.3.2.3.1.cmml">​</mo><mi id="S4.E7.m1.4.4.6.3.2.3.4" xref="S4.E7.m1.4.4.6.3.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E7.m1.4.4.6.3.1" xref="S4.E7.m1.4.4.6.3.1.cmml">×</mo><mn id="S4.E7.m1.4.4.6.3.3" xref="S4.E7.m1.4.4.6.3.3.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.E7.m1.4.4.6.3.1a" xref="S4.E7.m1.4.4.6.3.1.cmml">×</mo><mn id="S4.E7.m1.4.4.6.3.4" xref="S4.E7.m1.4.4.6.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4"><and id="S4.E7.m1.4.4a.cmml" xref="S4.E7.m1.4.4"></and><apply id="S4.E7.m1.4.4b.cmml" xref="S4.E7.m1.4.4"><eq id="S4.E7.m1.4.4.4.cmml" xref="S4.E7.m1.4.4.4"></eq><apply id="S4.E7.m1.4.4.3.cmml" xref="S4.E7.m1.4.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.3.1.cmml" xref="S4.E7.m1.4.4.3">subscript</csymbol><ci id="S4.E7.m1.4.4.3.2.cmml" xref="S4.E7.m1.4.4.3.2">𝑔</ci><ci id="S4.E7.m1.4.4.3.3.cmml" xref="S4.E7.m1.4.4.3.3">𝑘</ci></apply><apply id="S4.E7.m1.4.4.1.2.cmml" xref="S4.E7.m1.4.4.1.1"><apply id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3"><minus id="S4.E7.m1.3.3.1.cmml" xref="S4.E7.m1.3.3.1"></minus><ci id="S4.E7.m1.3.3.2.cmml" xref="S4.E7.m1.3.3.2">K</ci><ci id="S4.E7.m1.3.3.3.cmml" xref="S4.E7.m1.3.3.3">argmax</ci></apply><apply id="S4.E7.m1.4.4.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1"><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">Sigmoid</ci><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">linear</ci><apply id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply><apply id="S4.E7.m1.4.4c.cmml" xref="S4.E7.m1.4.4"><in id="S4.E7.m1.4.4.5.cmml" xref="S4.E7.m1.4.4.5"></in><share href="#S4.E7.m1.4.4.1.cmml" id="S4.E7.m1.4.4d.cmml" xref="S4.E7.m1.4.4"></share><apply id="S4.E7.m1.4.4.6.cmml" xref="S4.E7.m1.4.4.6"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.6.1.cmml" xref="S4.E7.m1.4.4.6">superscript</csymbol><ci id="S4.E7.m1.4.4.6.2.cmml" xref="S4.E7.m1.4.4.6.2">ℝ</ci><apply id="S4.E7.m1.4.4.6.3.cmml" xref="S4.E7.m1.4.4.6.3"><times id="S4.E7.m1.4.4.6.3.1.cmml" xref="S4.E7.m1.4.4.6.3.1"></times><apply id="S4.E7.m1.4.4.6.3.2.cmml" xref="S4.E7.m1.4.4.6.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.6.3.2.1.cmml" xref="S4.E7.m1.4.4.6.3.2">subscript</csymbol><apply id="S4.E7.m1.4.4.6.3.2.2.cmml" xref="S4.E7.m1.4.4.6.3.2.2"><ci id="S4.E7.m1.4.4.6.3.2.2.1.cmml" xref="S4.E7.m1.4.4.6.3.2.2.1">^</ci><ci id="S4.E7.m1.4.4.6.3.2.2.2.cmml" xref="S4.E7.m1.4.4.6.3.2.2.2">𝐶</ci></apply><apply id="S4.E7.m1.4.4.6.3.2.3.cmml" xref="S4.E7.m1.4.4.6.3.2.3"><times id="S4.E7.m1.4.4.6.3.2.3.1.cmml" xref="S4.E7.m1.4.4.6.3.2.3.1"></times><ci id="S4.E7.m1.4.4.6.3.2.3.2.cmml" xref="S4.E7.m1.4.4.6.3.2.3.2">𝑜</ci><ci id="S4.E7.m1.4.4.6.3.2.3.3.cmml" xref="S4.E7.m1.4.4.6.3.2.3.3">𝑢</ci><ci id="S4.E7.m1.4.4.6.3.2.3.4.cmml" xref="S4.E7.m1.4.4.6.3.2.3.4">𝑡</ci></apply></apply><cn type="integer" id="S4.E7.m1.4.4.6.3.3.cmml" xref="S4.E7.m1.4.4.6.3.3">1</cn><cn type="integer" id="S4.E7.m1.4.4.6.3.4.cmml" xref="S4.E7.m1.4.4.6.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">g_{k}={\operatorname{K-argmax}}(\operatorname{Sigmoid}(\operatorname{linear}(s_{k})))\in\mathbb{R}^{\hat{C}_{out}\times 1\times 1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.4" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.4.5" class="ltx_listingline">





















































<div id="alg1.4.5.1" class="ltx_listing ltx_listing">
</div>
</div>
<div id="alg1.4.6" class="ltx_listingline">
</div>
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">K</annotation></semantics></math> clients indexed by <math id="alg1.l1.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">k</annotation></semantics></math>, number of communication rounds <math id="alg1.l1.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">T</annotation></semantics></math>, number of local epochs <math id="alg1.l1.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">E</annotation></semantics></math>, learning rate <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\eta</annotation></semantics></math>, total number of samples <math id="alg1.l1.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">n</annotation></semantics></math>, number of sample in <math id="alg1.l1.m7.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="alg1.l1.m7.1a"><msup id="alg1.l1.m7.1.1" xref="alg1.l1.m7.1.1.cmml"><mi id="alg1.l1.m7.1.1.2" xref="alg1.l1.m7.1.1.2.cmml">k</mi><mrow id="alg1.l1.m7.1.1.3" xref="alg1.l1.m7.1.1.3.cmml"><mi id="alg1.l1.m7.1.1.3.2" xref="alg1.l1.m7.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m7.1.1.3.1" xref="alg1.l1.m7.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m7.1.1.3.3" xref="alg1.l1.m7.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.1b"><apply id="alg1.l1.m7.1.1.cmml" xref="alg1.l1.m7.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.1.1.1.cmml" xref="alg1.l1.m7.1.1">superscript</csymbol><ci id="alg1.l1.m7.1.1.2.cmml" xref="alg1.l1.m7.1.1.2">𝑘</ci><apply id="alg1.l1.m7.1.1.3.cmml" xref="alg1.l1.m7.1.1.3"><times id="alg1.l1.m7.1.1.3.1.cmml" xref="alg1.l1.m7.1.1.3.1"></times><ci id="alg1.l1.m7.1.1.3.2.cmml" xref="alg1.l1.m7.1.1.3.2">𝑡</ci><ci id="alg1.l1.m7.1.1.3.3.cmml" xref="alg1.l1.m7.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.1c">k^{th}</annotation></semantics></math> client <math id="alg1.l1.m8.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="alg1.l1.m8.1a"><msub id="alg1.l1.m8.1.1" xref="alg1.l1.m8.1.1.cmml"><mi id="alg1.l1.m8.1.1.2" xref="alg1.l1.m8.1.1.2.cmml">n</mi><mi id="alg1.l1.m8.1.1.3" xref="alg1.l1.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m8.1b"><apply id="alg1.l1.m8.1.1.cmml" xref="alg1.l1.m8.1.1"><csymbol cd="ambiguous" id="alg1.l1.m8.1.1.1.cmml" xref="alg1.l1.m8.1.1">subscript</csymbol><ci id="alg1.l1.m8.1.1.2.cmml" xref="alg1.l1.m8.1.1.2">𝑛</ci><ci id="alg1.l1.m8.1.1.3.cmml" xref="alg1.l1.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m8.1c">n_{k}</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Output:</span> final model <math id="alg1.l2.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">w</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑤</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">w^{T}</annotation></semantics></math>.

</div>
<div id="alg1.4.7" class="ltx_listingline">
</div>
<div id="alg1.l3" class="ltx_listingline">  
</div>
<div id="alg1.4.8" class="ltx_listingline">
</div>
<div id="alg1.l4" class="ltx_listingline">  <span id="alg1.l4.1" class="ltx_text ltx_font_bold">Server executes:</span>

</div>
<div id="alg1.l5" class="ltx_listingline">  initialize <math id="alg1.l5.m1.2" class="ltx_Math" alttext="w^{0},c_{g}" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.3.cmml"><msup id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.2.cmml">w</mi><mn id="alg1.l5.m1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.3.cmml">0</mn></msup><mo id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">,</mo><msub id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml">c</mi><mi id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><list id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.2">𝑤</ci><cn type="integer" id="alg1.l5.m1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.3">0</cn></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2">𝑐</ci><ci id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3">𝑔</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">w^{0},c_{g}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">  <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l6.m1.4" class="ltx_Math" alttext="t=0,1,\ldots,T" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.5" xref="alg1.l6.m1.4.5.cmml"><mi id="alg1.l6.m1.4.5.2" xref="alg1.l6.m1.4.5.2.cmml">t</mi><mo id="alg1.l6.m1.4.5.1" xref="alg1.l6.m1.4.5.1.cmml">=</mo><mrow id="alg1.l6.m1.4.5.3.2" xref="alg1.l6.m1.4.5.3.1.cmml"><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">0</mn><mo id="alg1.l6.m1.4.5.3.2.1" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">1</mn><mo id="alg1.l6.m1.4.5.3.2.2" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">…</mi><mo id="alg1.l6.m1.4.5.3.2.3" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.5.cmml" xref="alg1.l6.m1.4.5"><eq id="alg1.l6.m1.4.5.1.cmml" xref="alg1.l6.m1.4.5.1"></eq><ci id="alg1.l6.m1.4.5.2.cmml" xref="alg1.l6.m1.4.5.2">𝑡</ci><list id="alg1.l6.m1.4.5.3.1.cmml" xref="alg1.l6.m1.4.5.3.2"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">0</cn><cn type="integer" id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">1</cn><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">…</ci><ci id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">t=0,1,\ldots,T</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.4.9" class="ltx_listingline">
</div>
<div id="alg1.l7" class="ltx_listingline">     <math id="alg1.l7.m1.1" class="ltx_Math" alttext="K\leftarrow" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">K</mi><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝐾</ci><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">K\leftarrow</annotation></semantics></math> random set of clients

</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l8.m1.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">k</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">∈</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><in id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></in><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑘</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">k\in K</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">        send <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l9.m1.1a"><msup id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑤</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w^{t}</annotation></semantics></math> to client <math id="alg1.l9.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">k</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">        <math id="alg1.l10.m1.2" class="ltx_Math" alttext="\hat{w}^{t+1}_{k},{}{\hat{c}}_{k}\leftarrow" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><mrow id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.3.cmml"><msubsup id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l10.m1.1.1.1.1.1.2.2" xref="alg1.l10.m1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2.2.2" xref="alg1.l10.m1.1.1.1.1.1.2.2.2.cmml">w</mi><mo id="alg1.l10.m1.1.1.1.1.1.2.2.1" xref="alg1.l10.m1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.3.cmml">k</mi><mrow id="alg1.l10.m1.1.1.1.1.1.2.3" xref="alg1.l10.m1.1.1.1.1.1.2.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.2.3.2" xref="alg1.l10.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.1.1.1.2.3.1" xref="alg1.l10.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l10.m1.1.1.1.1.1.2.3.3" xref="alg1.l10.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l10.m1.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.2.cmml">c</mi><mo id="alg1.l10.m1.2.2.2.2.2.2.1" xref="alg1.l10.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l10.m1.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="alg1.l10.m1.2.2.3" xref="alg1.l10.m1.2.2.3.cmml">←</mo><mi id="alg1.l10.m1.2.2.4" xref="alg1.l10.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><ci id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3">←</ci><list id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2"><apply id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.2"><ci id="alg1.l10.m1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.2.1">^</ci><ci id="alg1.l10.m1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.2.2">𝑤</ci></apply><apply id="alg1.l10.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.3"><plus id="alg1.l10.m1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.3.1"></plus><ci id="alg1.l10.m1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="alg1.l10.m1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2"><ci id="alg1.l10.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.1">^</ci><ci id="alg1.l10.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.2">𝑐</ci></apply><ci id="alg1.l10.m1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.3">𝑘</ci></apply></list><csymbol cd="latexml" id="alg1.l10.m1.2.2.4.cmml" xref="alg1.l10.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\hat{w}^{t+1}_{k},{}{\hat{c}}_{k}\leftarrow</annotation></semantics></math> ClientUpdate<math id="alg1.l10.m2.3" class="ltx_Math" alttext="(k,w^{t},{}{c_{g}})" display="inline"><semantics id="alg1.l10.m2.3a"><mrow id="alg1.l10.m2.3.3.2" xref="alg1.l10.m2.3.3.3.cmml"><mo stretchy="false" id="alg1.l10.m2.3.3.2.3" xref="alg1.l10.m2.3.3.3.cmml">(</mo><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">k</mi><mo id="alg1.l10.m2.3.3.2.4" xref="alg1.l10.m2.3.3.3.cmml">,</mo><msup id="alg1.l10.m2.2.2.1.1" xref="alg1.l10.m2.2.2.1.1.cmml"><mi id="alg1.l10.m2.2.2.1.1.2" xref="alg1.l10.m2.2.2.1.1.2.cmml">w</mi><mi id="alg1.l10.m2.2.2.1.1.3" xref="alg1.l10.m2.2.2.1.1.3.cmml">t</mi></msup><mo id="alg1.l10.m2.3.3.2.5" xref="alg1.l10.m2.3.3.3.cmml">,</mo><msub id="alg1.l10.m2.3.3.2.2" xref="alg1.l10.m2.3.3.2.2.cmml"><mi id="alg1.l10.m2.3.3.2.2.2" xref="alg1.l10.m2.3.3.2.2.2.cmml">c</mi><mi id="alg1.l10.m2.3.3.2.2.3" xref="alg1.l10.m2.3.3.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.l10.m2.3.3.2.6" xref="alg1.l10.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.3b"><vector id="alg1.l10.m2.3.3.3.cmml" xref="alg1.l10.m2.3.3.2"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑘</ci><apply id="alg1.l10.m2.2.2.1.1.cmml" xref="alg1.l10.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.2.2.1.1.1.cmml" xref="alg1.l10.m2.2.2.1.1">superscript</csymbol><ci id="alg1.l10.m2.2.2.1.1.2.cmml" xref="alg1.l10.m2.2.2.1.1.2">𝑤</ci><ci id="alg1.l10.m2.2.2.1.1.3.cmml" xref="alg1.l10.m2.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l10.m2.3.3.2.2.cmml" xref="alg1.l10.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m2.3.3.2.2.1.cmml" xref="alg1.l10.m2.3.3.2.2">subscript</csymbol><ci id="alg1.l10.m2.3.3.2.2.2.cmml" xref="alg1.l10.m2.3.3.2.2.2">𝑐</ci><ci id="alg1.l10.m2.3.3.2.2.3.cmml" xref="alg1.l10.m2.3.3.2.2.3">𝑔</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.3c">(k,w^{t},{}{c_{g}})</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.4.10" class="ltx_listingline">
</div>
<div id="alg1.l12" class="ltx_listingline">     <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w^{t+1}\leftarrow w^{t}+\sum_{k=1}^{K}\frac{n_{k}}{n}\hat{w}^{t}_{k}" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><msup id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">w</mi><mrow id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.2.3.2" xref="alg1.l12.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.2.3.1" xref="alg1.l12.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.2.3.3" xref="alg1.l12.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">←</mo><mrow id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><msup id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml"><mi id="alg1.l12.m1.1.1.3.2.2" xref="alg1.l12.m1.1.1.3.2.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.3.2.3" xref="alg1.l12.m1.1.1.3.2.3.cmml">t</mi></msup><mo rspace="0.055em" id="alg1.l12.m1.1.1.3.1" xref="alg1.l12.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><msubsup id="alg1.l12.m1.1.1.3.3.1" xref="alg1.l12.m1.1.1.3.3.1.cmml"><mo id="alg1.l12.m1.1.1.3.3.1.2.2" xref="alg1.l12.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l12.m1.1.1.3.3.1.2.3" xref="alg1.l12.m1.1.1.3.3.1.2.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.1.2.3.2" xref="alg1.l12.m1.1.1.3.3.1.2.3.2.cmml">k</mi><mo id="alg1.l12.m1.1.1.3.3.1.2.3.1" xref="alg1.l12.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l12.m1.1.1.3.3.1.2.3.3" xref="alg1.l12.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l12.m1.1.1.3.3.1.3" xref="alg1.l12.m1.1.1.3.3.1.3.cmml">K</mi></msubsup><mrow id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml"><mfrac id="alg1.l12.m1.1.1.3.3.2.2" xref="alg1.l12.m1.1.1.3.3.2.2.cmml"><msub id="alg1.l12.m1.1.1.3.3.2.2.2" xref="alg1.l12.m1.1.1.3.3.2.2.2.cmml"><mi id="alg1.l12.m1.1.1.3.3.2.2.2.2" xref="alg1.l12.m1.1.1.3.3.2.2.2.2.cmml">n</mi><mi id="alg1.l12.m1.1.1.3.3.2.2.2.3" xref="alg1.l12.m1.1.1.3.3.2.2.2.3.cmml">k</mi></msub><mi id="alg1.l12.m1.1.1.3.3.2.2.3" xref="alg1.l12.m1.1.1.3.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1.3.3.2.1" xref="alg1.l12.m1.1.1.3.3.2.1.cmml">​</mo><msubsup id="alg1.l12.m1.1.1.3.3.2.3" xref="alg1.l12.m1.1.1.3.3.2.3.cmml"><mover accent="true" id="alg1.l12.m1.1.1.3.3.2.3.2.2" xref="alg1.l12.m1.1.1.3.3.2.3.2.2.cmml"><mi id="alg1.l12.m1.1.1.3.3.2.3.2.2.2" xref="alg1.l12.m1.1.1.3.3.2.3.2.2.2.cmml">w</mi><mo id="alg1.l12.m1.1.1.3.3.2.3.2.2.1" xref="alg1.l12.m1.1.1.3.3.2.3.2.2.1.cmml">^</mo></mover><mi id="alg1.l12.m1.1.1.3.3.2.3.3" xref="alg1.l12.m1.1.1.3.3.2.3.3.cmml">k</mi><mi id="alg1.l12.m1.1.1.3.3.2.3.2.3" xref="alg1.l12.m1.1.1.3.3.2.3.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><ci id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">←</ci><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.2">superscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑤</ci><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><plus id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3.1"></plus><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.1.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><plus id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3.1"></plus><apply id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.2">superscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.2.2">𝑤</ci><ci id="alg1.l12.m1.1.1.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><apply id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.1.cmml" xref="alg1.l12.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.3.1.2.cmml" xref="alg1.l12.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l12.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.1.2.2"></sum><apply id="alg1.l12.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.1.2.3"><eq id="alg1.l12.m1.1.1.3.3.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg1.l12.m1.1.1.3.3.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l12.m1.1.1.3.3.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l12.m1.1.1.3.3.1.3.cmml" xref="alg1.l12.m1.1.1.3.3.1.3">𝐾</ci></apply><apply id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2"><times id="alg1.l12.m1.1.1.3.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.1"></times><apply id="alg1.l12.m1.1.1.3.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.2"><divide id="alg1.l12.m1.1.1.3.3.2.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.2"></divide><apply id="alg1.l12.m1.1.1.3.3.2.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.2.2.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.2.2.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.2.2">𝑛</ci><ci id="alg1.l12.m1.1.1.3.3.2.2.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.2.3">𝑘</ci></apply><ci id="alg1.l12.m1.1.1.3.3.2.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.2.3">𝑛</ci></apply><apply id="alg1.l12.m1.1.1.3.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.2.3.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.3">subscript</csymbol><apply id="alg1.l12.m1.1.1.3.3.2.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.2.3.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.3">superscript</csymbol><apply id="alg1.l12.m1.1.1.3.3.2.3.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.2.2"><ci id="alg1.l12.m1.1.1.3.3.2.3.2.2.1.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.2.2.1">^</ci><ci id="alg1.l12.m1.1.1.3.3.2.3.2.2.2.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.2.2.2">𝑤</ci></apply><ci id="alg1.l12.m1.1.1.3.3.2.3.2.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.2.3">𝑡</ci></apply><ci id="alg1.l12.m1.1.1.3.3.2.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w^{t+1}\leftarrow w^{t}+\sum_{k=1}^{K}\frac{n_{k}}{n}\hat{w}^{t}_{k}</annotation></semantics></math>

</div>
<div id="alg1.1.1" class="ltx_listingline">
<math id="alg1.1.1.m1.1" class="ltx_Math" alttext="c_{g}\leftarrow c_{g}+\frac{1}{|N|}\sum_{k\in K}\Delta\hat{c}_{k}" display="inline"><semantics id="alg1.1.1.m1.1a"><mrow id="alg1.1.1.m1.1.2" xref="alg1.1.1.m1.1.2.cmml"><msub id="alg1.1.1.m1.1.2.2" xref="alg1.1.1.m1.1.2.2.cmml"><mi id="alg1.1.1.m1.1.2.2.2" xref="alg1.1.1.m1.1.2.2.2.cmml">c</mi><mi id="alg1.1.1.m1.1.2.2.3" xref="alg1.1.1.m1.1.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.1.1.m1.1.2.1" xref="alg1.1.1.m1.1.2.1.cmml">←</mo><mrow id="alg1.1.1.m1.1.2.3" xref="alg1.1.1.m1.1.2.3.cmml"><msub id="alg1.1.1.m1.1.2.3.2" xref="alg1.1.1.m1.1.2.3.2.cmml"><mi id="alg1.1.1.m1.1.2.3.2.2" xref="alg1.1.1.m1.1.2.3.2.2.cmml">c</mi><mi id="alg1.1.1.m1.1.2.3.2.3" xref="alg1.1.1.m1.1.2.3.2.3.cmml">g</mi></msub><mo id="alg1.1.1.m1.1.2.3.1" xref="alg1.1.1.m1.1.2.3.1.cmml">+</mo><mrow id="alg1.1.1.m1.1.2.3.3" xref="alg1.1.1.m1.1.2.3.3.cmml"><mfrac id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml"><mn id="alg1.1.1.m1.1.1.3" xref="alg1.1.1.m1.1.1.3.cmml">1</mn><mrow id="alg1.1.1.m1.1.1.1.3" xref="alg1.1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.1.1.m1.1.1.1.3.1" xref="alg1.1.1.m1.1.1.1.2.1.cmml">|</mo><mi id="alg1.1.1.m1.1.1.1.1" xref="alg1.1.1.m1.1.1.1.1.cmml">N</mi><mo stretchy="false" id="alg1.1.1.m1.1.1.1.3.2" xref="alg1.1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.1.1.m1.1.2.3.3.1" xref="alg1.1.1.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg1.1.1.m1.1.2.3.3.2" xref="alg1.1.1.m1.1.2.3.3.2.cmml"><msub id="alg1.1.1.m1.1.2.3.3.2.1" xref="alg1.1.1.m1.1.2.3.3.2.1.cmml"><mo id="alg1.1.1.m1.1.2.3.3.2.1.2" xref="alg1.1.1.m1.1.2.3.3.2.1.2.cmml">∑</mo><mrow id="alg1.1.1.m1.1.2.3.3.2.1.3" xref="alg1.1.1.m1.1.2.3.3.2.1.3.cmml"><mi id="alg1.1.1.m1.1.2.3.3.2.1.3.2" xref="alg1.1.1.m1.1.2.3.3.2.1.3.2.cmml">k</mi><mo id="alg1.1.1.m1.1.2.3.3.2.1.3.1" xref="alg1.1.1.m1.1.2.3.3.2.1.3.1.cmml">∈</mo><mi id="alg1.1.1.m1.1.2.3.3.2.1.3.3" xref="alg1.1.1.m1.1.2.3.3.2.1.3.3.cmml">K</mi></mrow></msub><mrow id="alg1.1.1.m1.1.2.3.3.2.2" xref="alg1.1.1.m1.1.2.3.3.2.2.cmml"><mi mathvariant="normal" id="alg1.1.1.m1.1.2.3.3.2.2.2" xref="alg1.1.1.m1.1.2.3.3.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.1.1.m1.1.2.3.3.2.2.1" xref="alg1.1.1.m1.1.2.3.3.2.2.1.cmml">​</mo><msub id="alg1.1.1.m1.1.2.3.3.2.2.3" xref="alg1.1.1.m1.1.2.3.3.2.2.3.cmml"><mover accent="true" id="alg1.1.1.m1.1.2.3.3.2.2.3.2" xref="alg1.1.1.m1.1.2.3.3.2.2.3.2.cmml"><mi id="alg1.1.1.m1.1.2.3.3.2.2.3.2.2" xref="alg1.1.1.m1.1.2.3.3.2.2.3.2.2.cmml">c</mi><mo id="alg1.1.1.m1.1.2.3.3.2.2.3.2.1" xref="alg1.1.1.m1.1.2.3.3.2.2.3.2.1.cmml">^</mo></mover><mi id="alg1.1.1.m1.1.2.3.3.2.2.3.3" xref="alg1.1.1.m1.1.2.3.3.2.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.1b"><apply id="alg1.1.1.m1.1.2.cmml" xref="alg1.1.1.m1.1.2"><ci id="alg1.1.1.m1.1.2.1.cmml" xref="alg1.1.1.m1.1.2.1">←</ci><apply id="alg1.1.1.m1.1.2.2.cmml" xref="alg1.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.1.1.m1.1.2.2.1.cmml" xref="alg1.1.1.m1.1.2.2">subscript</csymbol><ci id="alg1.1.1.m1.1.2.2.2.cmml" xref="alg1.1.1.m1.1.2.2.2">𝑐</ci><ci id="alg1.1.1.m1.1.2.2.3.cmml" xref="alg1.1.1.m1.1.2.2.3">𝑔</ci></apply><apply id="alg1.1.1.m1.1.2.3.cmml" xref="alg1.1.1.m1.1.2.3"><plus id="alg1.1.1.m1.1.2.3.1.cmml" xref="alg1.1.1.m1.1.2.3.1"></plus><apply id="alg1.1.1.m1.1.2.3.2.cmml" xref="alg1.1.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.1.1.m1.1.2.3.2.1.cmml" xref="alg1.1.1.m1.1.2.3.2">subscript</csymbol><ci id="alg1.1.1.m1.1.2.3.2.2.cmml" xref="alg1.1.1.m1.1.2.3.2.2">𝑐</ci><ci id="alg1.1.1.m1.1.2.3.2.3.cmml" xref="alg1.1.1.m1.1.2.3.2.3">𝑔</ci></apply><apply id="alg1.1.1.m1.1.2.3.3.cmml" xref="alg1.1.1.m1.1.2.3.3"><times id="alg1.1.1.m1.1.2.3.3.1.cmml" xref="alg1.1.1.m1.1.2.3.3.1"></times><apply id="alg1.1.1.m1.1.1.cmml" xref="alg1.1.1.m1.1.1"><divide id="alg1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.m1.1.1"></divide><cn type="integer" id="alg1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.m1.1.1.3">1</cn><apply id="alg1.1.1.m1.1.1.1.2.cmml" xref="alg1.1.1.m1.1.1.1.3"><abs id="alg1.1.1.m1.1.1.1.2.1.cmml" xref="alg1.1.1.m1.1.1.1.3.1"></abs><ci id="alg1.1.1.m1.1.1.1.1.cmml" xref="alg1.1.1.m1.1.1.1.1">𝑁</ci></apply></apply><apply id="alg1.1.1.m1.1.2.3.3.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2"><apply id="alg1.1.1.m1.1.2.3.3.2.1.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1"><csymbol cd="ambiguous" id="alg1.1.1.m1.1.2.3.3.2.1.1.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1">subscript</csymbol><sum id="alg1.1.1.m1.1.2.3.3.2.1.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1.2"></sum><apply id="alg1.1.1.m1.1.2.3.3.2.1.3.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1.3"><in id="alg1.1.1.m1.1.2.3.3.2.1.3.1.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1.3.1"></in><ci id="alg1.1.1.m1.1.2.3.3.2.1.3.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1.3.2">𝑘</ci><ci id="alg1.1.1.m1.1.2.3.3.2.1.3.3.cmml" xref="alg1.1.1.m1.1.2.3.3.2.1.3.3">𝐾</ci></apply></apply><apply id="alg1.1.1.m1.1.2.3.3.2.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2"><times id="alg1.1.1.m1.1.2.3.3.2.2.1.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.1"></times><ci id="alg1.1.1.m1.1.2.3.3.2.2.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.2">Δ</ci><apply id="alg1.1.1.m1.1.2.3.3.2.2.3.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="alg1.1.1.m1.1.2.3.3.2.2.3.1.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.3">subscript</csymbol><apply id="alg1.1.1.m1.1.2.3.3.2.2.3.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.3.2"><ci id="alg1.1.1.m1.1.2.3.3.2.2.3.2.1.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.3.2.1">^</ci><ci id="alg1.1.1.m1.1.2.3.3.2.2.3.2.2.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.3.2.2">𝑐</ci></apply><ci id="alg1.1.1.m1.1.2.3.3.2.2.3.3.cmml" xref="alg1.1.1.m1.1.2.3.3.2.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.1c">c_{g}\leftarrow c_{g}+\frac{1}{|N|}\sum_{k\in K}\Delta\hat{c}_{k}</annotation></semantics></math>

</div>
<div id="alg1.4.11" class="ltx_listingline">
</div>
<div id="alg1.l13" class="ltx_listingline">  <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.4.12" class="ltx_listingline">
</div>
<div id="alg1.l14" class="ltx_listingline">  
</div>
<div id="alg1.l15" class="ltx_listingline">  <span id="alg1.l15.1" class="ltx_text ltx_font_bold">ClientUpdate(<math id="alg1.l15.1.m1.3" class="ltx_Math" alttext="k,w^{t},{c_{g}}" display="inline"><semantics id="alg1.l15.1.m1.3a"><mrow id="alg1.l15.1.m1.3.3.2" xref="alg1.l15.1.m1.3.3.3.cmml"><mi id="alg1.l15.1.m1.1.1" xref="alg1.l15.1.m1.1.1.cmml">k</mi><mo id="alg1.l15.1.m1.3.3.2.3" xref="alg1.l15.1.m1.3.3.3.cmml">,</mo><msup id="alg1.l15.1.m1.2.2.1.1" xref="alg1.l15.1.m1.2.2.1.1.cmml"><mi id="alg1.l15.1.m1.2.2.1.1.2" xref="alg1.l15.1.m1.2.2.1.1.2.cmml">w</mi><mi id="alg1.l15.1.m1.2.2.1.1.3" xref="alg1.l15.1.m1.2.2.1.1.3.cmml">t</mi></msup><mo id="alg1.l15.1.m1.3.3.2.4" xref="alg1.l15.1.m1.3.3.3.cmml">,</mo><msub id="alg1.l15.1.m1.3.3.2.2" xref="alg1.l15.1.m1.3.3.2.2.cmml"><mi id="alg1.l15.1.m1.3.3.2.2.2" xref="alg1.l15.1.m1.3.3.2.2.2.cmml">c</mi><mi id="alg1.l15.1.m1.3.3.2.2.3" xref="alg1.l15.1.m1.3.3.2.2.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.1.m1.3b"><list id="alg1.l15.1.m1.3.3.3.cmml" xref="alg1.l15.1.m1.3.3.2"><ci id="alg1.l15.1.m1.1.1.cmml" xref="alg1.l15.1.m1.1.1">𝑘</ci><apply id="alg1.l15.1.m1.2.2.1.1.cmml" xref="alg1.l15.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l15.1.m1.2.2.1.1.1.cmml" xref="alg1.l15.1.m1.2.2.1.1">superscript</csymbol><ci id="alg1.l15.1.m1.2.2.1.1.2.cmml" xref="alg1.l15.1.m1.2.2.1.1.2">𝑤</ci><ci id="alg1.l15.1.m1.2.2.1.1.3.cmml" xref="alg1.l15.1.m1.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l15.1.m1.3.3.2.2.cmml" xref="alg1.l15.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l15.1.m1.3.3.2.2.1.cmml" xref="alg1.l15.1.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l15.1.m1.3.3.2.2.2.cmml" xref="alg1.l15.1.m1.3.3.2.2.2">𝑐</ci><ci id="alg1.l15.1.m1.3.3.2.2.3.cmml" xref="alg1.l15.1.m1.3.3.2.2.3">𝑔</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.1.m1.3c">k,w^{t},{c_{g}}</annotation></semantics></math>):</span>

</div>
<div id="alg1.l16" class="ltx_listingline">  <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\mathcal{B}\leftarrow" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">ℬ</mi><mo stretchy="false" id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">ℬ</ci><csymbol cd="latexml" id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\mathcal{B}\leftarrow</annotation></semantics></math> split local dataset into batches

</div>
<div id="alg1.l17" class="ltx_listingline">  <math id="alg1.l17.m1.2" class="ltx_Math" alttext="w_{k}^{t},{c_{g}}\leftarrow" display="inline"><semantics id="alg1.l17.m1.2a"><mrow id="alg1.l17.m1.2.2" xref="alg1.l17.m1.2.2.cmml"><mrow id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml"><msubsup id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l17.m1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.2.3.cmml">k</mi><mi id="alg1.l17.m1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l17.m1.2.2.2.2.3" xref="alg1.l17.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l17.m1.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.2.cmml"><mi id="alg1.l17.m1.2.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.2.2.2.cmml">c</mi><mi id="alg1.l17.m1.2.2.2.2.2.3" xref="alg1.l17.m1.2.2.2.2.2.3.cmml">g</mi></msub></mrow><mo stretchy="false" id="alg1.l17.m1.2.2.3" xref="alg1.l17.m1.2.2.3.cmml">←</mo><mi id="alg1.l17.m1.2.2.4" xref="alg1.l17.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.2b"><apply id="alg1.l17.m1.2.2.cmml" xref="alg1.l17.m1.2.2"><ci id="alg1.l17.m1.2.2.3.cmml" xref="alg1.l17.m1.2.2.3">←</ci><list id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2"><apply id="alg1.l17.m1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l17.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg1.l17.m1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg1.l17.m1.2.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.2.2.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l17.m1.2.2.2.2.2.2.cmml" xref="alg1.l17.m1.2.2.2.2.2.2">𝑐</ci><ci id="alg1.l17.m1.2.2.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2.2.3">𝑔</ci></apply></list><csymbol cd="latexml" id="alg1.l17.m1.2.2.4.cmml" xref="alg1.l17.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.2c">w_{k}^{t},{c_{g}}\leftarrow</annotation></semantics></math> download global model parameter <math id="alg1.l17.m2.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l17.m2.1a"><msup id="alg1.l17.m2.1.1" xref="alg1.l17.m2.1.1.cmml"><mi id="alg1.l17.m2.1.1.2" xref="alg1.l17.m2.1.1.2.cmml">w</mi><mi id="alg1.l17.m2.1.1.3" xref="alg1.l17.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.1b"><apply id="alg1.l17.m2.1.1.cmml" xref="alg1.l17.m2.1.1"><csymbol cd="ambiguous" id="alg1.l17.m2.1.1.1.cmml" xref="alg1.l17.m2.1.1">superscript</csymbol><ci id="alg1.l17.m2.1.1.2.cmml" xref="alg1.l17.m2.1.1.2">𝑤</ci><ci id="alg1.l17.m2.1.1.3.cmml" xref="alg1.l17.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.1c">w^{t}</annotation></semantics></math>, and gradient control variates <math id="alg1.l17.m3.1" class="ltx_Math" alttext="{c_{g}}" display="inline"><semantics id="alg1.l17.m3.1a"><msub id="alg1.l17.m3.1.1" xref="alg1.l17.m3.1.1.cmml"><mi id="alg1.l17.m3.1.1.2" xref="alg1.l17.m3.1.1.2.cmml">c</mi><mi id="alg1.l17.m3.1.1.3" xref="alg1.l17.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l17.m3.1b"><apply id="alg1.l17.m3.1.1.cmml" xref="alg1.l17.m3.1.1"><csymbol cd="ambiguous" id="alg1.l17.m3.1.1.1.cmml" xref="alg1.l17.m3.1.1">subscript</csymbol><ci id="alg1.l17.m3.1.1.2.cmml" xref="alg1.l17.m3.1.1.2">𝑐</ci><ci id="alg1.l17.m3.1.1.3.cmml" xref="alg1.l17.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m3.1c">{c_{g}}</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">  <math id="alg1.l18.m1.1" class="ltx_Math" alttext="c_{l}\leftarrow" display="inline"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msub id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.2.2" xref="alg1.l18.m1.1.1.2.2.cmml">c</mi><mi id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml">l</mi></msub><mo stretchy="false" id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">←</mo><mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><ci id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1">←</ci><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">𝑐</ci><ci id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3">𝑙</ci></apply><csymbol cd="latexml" id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">c_{l}\leftarrow</annotation></semantics></math> initialize local control <math id="alg1.l18.m2.1" class="ltx_Math" alttext="c_{l}" display="inline"><semantics id="alg1.l18.m2.1a"><msub id="alg1.l18.m2.1.1" xref="alg1.l18.m2.1.1.cmml"><mi id="alg1.l18.m2.1.1.2" xref="alg1.l18.m2.1.1.2.cmml">c</mi><mi id="alg1.l18.m2.1.1.3" xref="alg1.l18.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l18.m2.1b"><apply id="alg1.l18.m2.1.1.cmml" xref="alg1.l18.m2.1.1"><csymbol cd="ambiguous" id="alg1.l18.m2.1.1.1.cmml" xref="alg1.l18.m2.1.1">subscript</csymbol><ci id="alg1.l18.m2.1.1.2.cmml" xref="alg1.l18.m2.1.1.2">𝑐</ci><ci id="alg1.l18.m2.1.1.3.cmml" xref="alg1.l18.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m2.1c">c_{l}</annotation></semantics></math>

</div>
<div id="alg1.4.13" class="ltx_listingline">
</div>
<div id="alg1.l19" class="ltx_listingline">  <span id="alg1.l19.1" class="ltx_text ltx_font_bold">for</span> epoch<math id="alg1.l19.m1.4" class="ltx_Math" alttext="=1,2,\ldots,E" display="inline"><semantics id="alg1.l19.m1.4a"><mrow id="alg1.l19.m1.4.5" xref="alg1.l19.m1.4.5.cmml"><mi id="alg1.l19.m1.4.5.2" xref="alg1.l19.m1.4.5.2.cmml"></mi><mo id="alg1.l19.m1.4.5.1" xref="alg1.l19.m1.4.5.1.cmml">=</mo><mrow id="alg1.l19.m1.4.5.3.2" xref="alg1.l19.m1.4.5.3.1.cmml"><mn id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">1</mn><mo id="alg1.l19.m1.4.5.3.2.1" xref="alg1.l19.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml">2</mn><mo id="alg1.l19.m1.4.5.3.2.2" xref="alg1.l19.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l19.m1.3.3" xref="alg1.l19.m1.3.3.cmml">…</mi><mo id="alg1.l19.m1.4.5.3.2.3" xref="alg1.l19.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l19.m1.4.4" xref="alg1.l19.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.4b"><apply id="alg1.l19.m1.4.5.cmml" xref="alg1.l19.m1.4.5"><eq id="alg1.l19.m1.4.5.1.cmml" xref="alg1.l19.m1.4.5.1"></eq><csymbol cd="latexml" id="alg1.l19.m1.4.5.2.cmml" xref="alg1.l19.m1.4.5.2">absent</csymbol><list id="alg1.l19.m1.4.5.3.1.cmml" xref="alg1.l19.m1.4.5.3.2"><cn type="integer" id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">1</cn><cn type="integer" id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2">2</cn><ci id="alg1.l19.m1.3.3.cmml" xref="alg1.l19.m1.3.3">…</ci><ci id="alg1.l19.m1.4.4.cmml" xref="alg1.l19.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.4c">=1,2,\ldots,E</annotation></semantics></math> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l20" class="ltx_listingline">     <span id="alg1.l20.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l20.m1.1" class="ltx_Math" alttext="b\in\mathcal{B}" display="inline"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">b</mi><mo id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml">ℬ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><in id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"></in><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝑏</ci><ci id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3">ℬ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">b\in\mathcal{B}</annotation></semantics></math> <span id="alg1.l20.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.4.14" class="ltx_listingline">
</div>
<div id="alg1.l21" class="ltx_listingline">        <math id="alg1.l21.m1.2" class="ltx_Math" alttext="w^{t}_{k}\leftarrow w^{t}_{k}-\eta\triangledown\mathcal{L}((w^{t}_{k},w_{g};b){}{-c_{l}+c_{g}})" display="inline"><semantics id="alg1.l21.m1.2a"><mrow id="alg1.l21.m1.2.2" xref="alg1.l21.m1.2.2.cmml"><msubsup id="alg1.l21.m1.2.2.3" xref="alg1.l21.m1.2.2.3.cmml"><mi id="alg1.l21.m1.2.2.3.2.2" xref="alg1.l21.m1.2.2.3.2.2.cmml">w</mi><mi id="alg1.l21.m1.2.2.3.3" xref="alg1.l21.m1.2.2.3.3.cmml">k</mi><mi id="alg1.l21.m1.2.2.3.2.3" xref="alg1.l21.m1.2.2.3.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l21.m1.2.2.2" xref="alg1.l21.m1.2.2.2.cmml">←</mo><mrow id="alg1.l21.m1.2.2.1" xref="alg1.l21.m1.2.2.1.cmml"><msubsup id="alg1.l21.m1.2.2.1.3" xref="alg1.l21.m1.2.2.1.3.cmml"><mi id="alg1.l21.m1.2.2.1.3.2.2" xref="alg1.l21.m1.2.2.1.3.2.2.cmml">w</mi><mi id="alg1.l21.m1.2.2.1.3.3" xref="alg1.l21.m1.2.2.1.3.3.cmml">k</mi><mi id="alg1.l21.m1.2.2.1.3.2.3" xref="alg1.l21.m1.2.2.1.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l21.m1.2.2.1.2" xref="alg1.l21.m1.2.2.1.2.cmml">−</mo><mrow id="alg1.l21.m1.2.2.1.1" xref="alg1.l21.m1.2.2.1.1.cmml"><mi id="alg1.l21.m1.2.2.1.1.3" xref="alg1.l21.m1.2.2.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.1.2" xref="alg1.l21.m1.2.2.1.1.2.cmml">​</mo><mi mathvariant="normal" id="alg1.l21.m1.2.2.1.1.4" xref="alg1.l21.m1.2.2.1.1.4.cmml">▽</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.1.2a" xref="alg1.l21.m1.2.2.1.1.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.2.2.1.1.5" xref="alg1.l21.m1.2.2.1.1.5.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="alg1.l21.m1.2.2.1.1.2b" xref="alg1.l21.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg1.l21.m1.2.2.1.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.1.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l21.m1.2.2.1.1.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.1.cmml"><mrow id="alg1.l21.m1.2.2.1.1.1.1.1.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml"><mrow id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.4" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.cmml"><mi id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml">g</mi></msub><mo id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.5" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.3.cmml">;</mo><mi id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.6" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.3.cmml">)</mo></mrow><mo id="alg1.l21.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.3.cmml">−</mo><msub id="alg1.l21.m1.2.2.1.1.1.1.1.2.4" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4.cmml"><mi id="alg1.l21.m1.2.2.1.1.1.1.1.2.4.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4.2.cmml">c</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.2.4.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4.3.cmml">l</mi></msub></mrow><mo id="alg1.l21.m1.2.2.1.1.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.3.cmml">+</mo><msub id="alg1.l21.m1.2.2.1.1.1.1.1.4" xref="alg1.l21.m1.2.2.1.1.1.1.1.4.cmml"><mi id="alg1.l21.m1.2.2.1.1.1.1.1.4.2" xref="alg1.l21.m1.2.2.1.1.1.1.1.4.2.cmml">c</mi><mi id="alg1.l21.m1.2.2.1.1.1.1.1.4.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.4.3.cmml">g</mi></msub></mrow><mo stretchy="false" id="alg1.l21.m1.2.2.1.1.1.1.3" xref="alg1.l21.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.2b"><apply id="alg1.l21.m1.2.2.cmml" xref="alg1.l21.m1.2.2"><ci id="alg1.l21.m1.2.2.2.cmml" xref="alg1.l21.m1.2.2.2">←</ci><apply id="alg1.l21.m1.2.2.3.cmml" xref="alg1.l21.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.3.1.cmml" xref="alg1.l21.m1.2.2.3">subscript</csymbol><apply id="alg1.l21.m1.2.2.3.2.cmml" xref="alg1.l21.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.3.2.1.cmml" xref="alg1.l21.m1.2.2.3">superscript</csymbol><ci id="alg1.l21.m1.2.2.3.2.2.cmml" xref="alg1.l21.m1.2.2.3.2.2">𝑤</ci><ci id="alg1.l21.m1.2.2.3.2.3.cmml" xref="alg1.l21.m1.2.2.3.2.3">𝑡</ci></apply><ci id="alg1.l21.m1.2.2.3.3.cmml" xref="alg1.l21.m1.2.2.3.3">𝑘</ci></apply><apply id="alg1.l21.m1.2.2.1.cmml" xref="alg1.l21.m1.2.2.1"><minus id="alg1.l21.m1.2.2.1.2.cmml" xref="alg1.l21.m1.2.2.1.2"></minus><apply id="alg1.l21.m1.2.2.1.3.cmml" xref="alg1.l21.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.3.1.cmml" xref="alg1.l21.m1.2.2.1.3">subscript</csymbol><apply id="alg1.l21.m1.2.2.1.3.2.cmml" xref="alg1.l21.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.3.2.1.cmml" xref="alg1.l21.m1.2.2.1.3">superscript</csymbol><ci id="alg1.l21.m1.2.2.1.3.2.2.cmml" xref="alg1.l21.m1.2.2.1.3.2.2">𝑤</ci><ci id="alg1.l21.m1.2.2.1.3.2.3.cmml" xref="alg1.l21.m1.2.2.1.3.2.3">𝑡</ci></apply><ci id="alg1.l21.m1.2.2.1.3.3.cmml" xref="alg1.l21.m1.2.2.1.3.3">𝑘</ci></apply><apply id="alg1.l21.m1.2.2.1.1.cmml" xref="alg1.l21.m1.2.2.1.1"><times id="alg1.l21.m1.2.2.1.1.2.cmml" xref="alg1.l21.m1.2.2.1.1.2"></times><ci id="alg1.l21.m1.2.2.1.1.3.cmml" xref="alg1.l21.m1.2.2.1.1.3">𝜂</ci><ci id="alg1.l21.m1.2.2.1.1.4.cmml" xref="alg1.l21.m1.2.2.1.1.4">▽</ci><ci id="alg1.l21.m1.2.2.1.1.5.cmml" xref="alg1.l21.m1.2.2.1.1.5">ℒ</ci><apply id="alg1.l21.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1"><plus id="alg1.l21.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.3"></plus><apply id="alg1.l21.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2"><minus id="alg1.l21.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.3"></minus><vector id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2"><apply id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.2">𝑤</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.2.2.2.3">𝑔</ci></apply><ci id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">𝑏</ci></vector><apply id="alg1.l21.m1.2.2.1.1.1.1.1.2.4.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.2.4.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4">subscript</csymbol><ci id="alg1.l21.m1.2.2.1.1.1.1.1.2.4.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4.2">𝑐</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.1.2.4.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.2.4.3">𝑙</ci></apply></apply><apply id="alg1.l21.m1.2.2.1.1.1.1.1.4.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l21.m1.2.2.1.1.1.1.1.4.1.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l21.m1.2.2.1.1.1.1.1.4.2.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.4.2">𝑐</ci><ci id="alg1.l21.m1.2.2.1.1.1.1.1.4.3.cmml" xref="alg1.l21.m1.2.2.1.1.1.1.1.4.3">𝑔</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.2c">w^{t}_{k}\leftarrow w^{t}_{k}-\eta\triangledown\mathcal{L}((w^{t}_{k},w_{g};b){}{-c_{l}+c_{g}})</annotation></semantics></math> # update neural network

</div>
<div id="alg1.l22" class="ltx_listingline">        <math id="alg1.l22.m1.3" class="ltx_Math" alttext="w_{g}\leftarrow w_{g}-\eta\triangledown\mathcal{L}(w^{t}_{k},w_{g};b)" display="inline"><semantics id="alg1.l22.m1.3a"><mrow id="alg1.l22.m1.3.3" xref="alg1.l22.m1.3.3.cmml"><msub id="alg1.l22.m1.3.3.4" xref="alg1.l22.m1.3.3.4.cmml"><mi id="alg1.l22.m1.3.3.4.2" xref="alg1.l22.m1.3.3.4.2.cmml">w</mi><mi id="alg1.l22.m1.3.3.4.3" xref="alg1.l22.m1.3.3.4.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.l22.m1.3.3.3" xref="alg1.l22.m1.3.3.3.cmml">←</mo><mrow id="alg1.l22.m1.3.3.2" xref="alg1.l22.m1.3.3.2.cmml"><msub id="alg1.l22.m1.3.3.2.4" xref="alg1.l22.m1.3.3.2.4.cmml"><mi id="alg1.l22.m1.3.3.2.4.2" xref="alg1.l22.m1.3.3.2.4.2.cmml">w</mi><mi id="alg1.l22.m1.3.3.2.4.3" xref="alg1.l22.m1.3.3.2.4.3.cmml">g</mi></msub><mo id="alg1.l22.m1.3.3.2.3" xref="alg1.l22.m1.3.3.2.3.cmml">−</mo><mrow id="alg1.l22.m1.3.3.2.2" xref="alg1.l22.m1.3.3.2.2.cmml"><mi id="alg1.l22.m1.3.3.2.2.4" xref="alg1.l22.m1.3.3.2.2.4.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.3.3.2.2.3" xref="alg1.l22.m1.3.3.2.2.3.cmml">​</mo><mi mathvariant="normal" id="alg1.l22.m1.3.3.2.2.5" xref="alg1.l22.m1.3.3.2.2.5.cmml">▽</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.3.3.2.2.3a" xref="alg1.l22.m1.3.3.2.2.3.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l22.m1.3.3.2.2.6" xref="alg1.l22.m1.3.3.2.2.6.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="alg1.l22.m1.3.3.2.2.3b" xref="alg1.l22.m1.3.3.2.2.3.cmml">​</mo><mrow id="alg1.l22.m1.3.3.2.2.2.2" xref="alg1.l22.m1.3.3.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l22.m1.3.3.2.2.2.2.3" xref="alg1.l22.m1.3.3.2.2.2.3.cmml">(</mo><msubsup id="alg1.l22.m1.2.2.1.1.1.1.1" xref="alg1.l22.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l22.m1.2.2.1.1.1.1.1.2.2" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l22.m1.2.2.1.1.1.1.1.3" xref="alg1.l22.m1.2.2.1.1.1.1.1.3.cmml">k</mi><mi id="alg1.l22.m1.2.2.1.1.1.1.1.2.3" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l22.m1.3.3.2.2.2.2.4" xref="alg1.l22.m1.3.3.2.2.2.3.cmml">,</mo><msub id="alg1.l22.m1.3.3.2.2.2.2.2" xref="alg1.l22.m1.3.3.2.2.2.2.2.cmml"><mi id="alg1.l22.m1.3.3.2.2.2.2.2.2" xref="alg1.l22.m1.3.3.2.2.2.2.2.2.cmml">w</mi><mi id="alg1.l22.m1.3.3.2.2.2.2.2.3" xref="alg1.l22.m1.3.3.2.2.2.2.2.3.cmml">g</mi></msub><mo id="alg1.l22.m1.3.3.2.2.2.2.5" xref="alg1.l22.m1.3.3.2.2.2.3.cmml">;</mo><mi id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l22.m1.3.3.2.2.2.2.6" xref="alg1.l22.m1.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.3b"><apply id="alg1.l22.m1.3.3.cmml" xref="alg1.l22.m1.3.3"><ci id="alg1.l22.m1.3.3.3.cmml" xref="alg1.l22.m1.3.3.3">←</ci><apply id="alg1.l22.m1.3.3.4.cmml" xref="alg1.l22.m1.3.3.4"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.4.1.cmml" xref="alg1.l22.m1.3.3.4">subscript</csymbol><ci id="alg1.l22.m1.3.3.4.2.cmml" xref="alg1.l22.m1.3.3.4.2">𝑤</ci><ci id="alg1.l22.m1.3.3.4.3.cmml" xref="alg1.l22.m1.3.3.4.3">𝑔</ci></apply><apply id="alg1.l22.m1.3.3.2.cmml" xref="alg1.l22.m1.3.3.2"><minus id="alg1.l22.m1.3.3.2.3.cmml" xref="alg1.l22.m1.3.3.2.3"></minus><apply id="alg1.l22.m1.3.3.2.4.cmml" xref="alg1.l22.m1.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.2.4.1.cmml" xref="alg1.l22.m1.3.3.2.4">subscript</csymbol><ci id="alg1.l22.m1.3.3.2.4.2.cmml" xref="alg1.l22.m1.3.3.2.4.2">𝑤</ci><ci id="alg1.l22.m1.3.3.2.4.3.cmml" xref="alg1.l22.m1.3.3.2.4.3">𝑔</ci></apply><apply id="alg1.l22.m1.3.3.2.2.cmml" xref="alg1.l22.m1.3.3.2.2"><times id="alg1.l22.m1.3.3.2.2.3.cmml" xref="alg1.l22.m1.3.3.2.2.3"></times><ci id="alg1.l22.m1.3.3.2.2.4.cmml" xref="alg1.l22.m1.3.3.2.2.4">𝜂</ci><ci id="alg1.l22.m1.3.3.2.2.5.cmml" xref="alg1.l22.m1.3.3.2.2.5">▽</ci><ci id="alg1.l22.m1.3.3.2.2.6.cmml" xref="alg1.l22.m1.3.3.2.2.6">ℒ</ci><vector id="alg1.l22.m1.3.3.2.2.2.3.cmml" xref="alg1.l22.m1.3.3.2.2.2.2"><apply id="alg1.l22.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="alg1.l22.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l22.m1.2.2.1.1.1.1.1.2.1.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l22.m1.2.2.1.1.1.1.1.2.2.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l22.m1.2.2.1.1.1.1.1.2.3.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l22.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l22.m1.2.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l22.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l22.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l22.m1.3.3.2.2.2.2.2.1.cmml" xref="alg1.l22.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="alg1.l22.m1.3.3.2.2.2.2.2.2.cmml" xref="alg1.l22.m1.3.3.2.2.2.2.2.2">𝑤</ci><ci id="alg1.l22.m1.3.3.2.2.2.2.2.3.cmml" xref="alg1.l22.m1.3.3.2.2.2.2.2.3">𝑔</ci></apply><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">𝑏</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.3c">w_{g}\leftarrow w_{g}-\eta\triangledown\mathcal{L}(w^{t}_{k},w_{g};b)</annotation></semantics></math> # update pruning gate

</div>
<div id="alg1.l23" class="ltx_listingline">     <span id="alg1.l23.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l23.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.4.15" class="ltx_listingline">
</div>
<div id="alg1.l24" class="ltx_listingline">  <span id="alg1.l24.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l24.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.2.2" class="ltx_listingline">
<math id="alg1.2.2.m1.1" class="ltx_Math" alttext="c_{l}^{*}\leftarrow c_{l}-c_{g}+\frac{1}{E\eta}(w^{t}-w_{k}^{t})" display="inline"><semantics id="alg1.2.2.m1.1a"><mrow id="alg1.2.2.m1.1.1" xref="alg1.2.2.m1.1.1.cmml"><msubsup id="alg1.2.2.m1.1.1.3" xref="alg1.2.2.m1.1.1.3.cmml"><mi id="alg1.2.2.m1.1.1.3.2.2" xref="alg1.2.2.m1.1.1.3.2.2.cmml">c</mi><mi id="alg1.2.2.m1.1.1.3.2.3" xref="alg1.2.2.m1.1.1.3.2.3.cmml">l</mi><mo id="alg1.2.2.m1.1.1.3.3" xref="alg1.2.2.m1.1.1.3.3.cmml">∗</mo></msubsup><mo stretchy="false" id="alg1.2.2.m1.1.1.2" xref="alg1.2.2.m1.1.1.2.cmml">←</mo><mrow id="alg1.2.2.m1.1.1.1" xref="alg1.2.2.m1.1.1.1.cmml"><mrow id="alg1.2.2.m1.1.1.1.3" xref="alg1.2.2.m1.1.1.1.3.cmml"><msub id="alg1.2.2.m1.1.1.1.3.2" xref="alg1.2.2.m1.1.1.1.3.2.cmml"><mi id="alg1.2.2.m1.1.1.1.3.2.2" xref="alg1.2.2.m1.1.1.1.3.2.2.cmml">c</mi><mi id="alg1.2.2.m1.1.1.1.3.2.3" xref="alg1.2.2.m1.1.1.1.3.2.3.cmml">l</mi></msub><mo id="alg1.2.2.m1.1.1.1.3.1" xref="alg1.2.2.m1.1.1.1.3.1.cmml">−</mo><msub id="alg1.2.2.m1.1.1.1.3.3" xref="alg1.2.2.m1.1.1.1.3.3.cmml"><mi id="alg1.2.2.m1.1.1.1.3.3.2" xref="alg1.2.2.m1.1.1.1.3.3.2.cmml">c</mi><mi id="alg1.2.2.m1.1.1.1.3.3.3" xref="alg1.2.2.m1.1.1.1.3.3.3.cmml">g</mi></msub></mrow><mo id="alg1.2.2.m1.1.1.1.2" xref="alg1.2.2.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.2.2.m1.1.1.1.1" xref="alg1.2.2.m1.1.1.1.1.cmml"><mfrac id="alg1.2.2.m1.1.1.1.1.3" xref="alg1.2.2.m1.1.1.1.1.3.cmml"><mn id="alg1.2.2.m1.1.1.1.1.3.2" xref="alg1.2.2.m1.1.1.1.1.3.2.cmml">1</mn><mrow id="alg1.2.2.m1.1.1.1.1.3.3" xref="alg1.2.2.m1.1.1.1.1.3.3.cmml"><mi id="alg1.2.2.m1.1.1.1.1.3.3.2" xref="alg1.2.2.m1.1.1.1.1.3.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="alg1.2.2.m1.1.1.1.1.3.3.1" xref="alg1.2.2.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg1.2.2.m1.1.1.1.1.3.3.3" xref="alg1.2.2.m1.1.1.1.1.3.3.3.cmml">η</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.2.2.m1.1.1.1.1.2" xref="alg1.2.2.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.2.2.m1.1.1.1.1.1.1" xref="alg1.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.2.2.m1.1.1.1.1.1.1.2" xref="alg1.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.2.2.m1.1.1.1.1.1.1.1" xref="alg1.2.2.m1.1.1.1.1.1.1.1.cmml"><msup id="alg1.2.2.m1.1.1.1.1.1.1.1.2" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.2.2.m1.1.1.1.1.1.1.1.2.2" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.2.2.m1.1.1.1.1.1.1.1.2.3" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msup><mo id="alg1.2.2.m1.1.1.1.1.1.1.1.1" xref="alg1.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="alg1.2.2.m1.1.1.1.1.1.1.1.3" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.2" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.3" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="alg1.2.2.m1.1.1.1.1.1.1.1.3.3" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="alg1.2.2.m1.1.1.1.1.1.1.3" xref="alg1.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.2.m1.1b"><apply id="alg1.2.2.m1.1.1.cmml" xref="alg1.2.2.m1.1.1"><ci id="alg1.2.2.m1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.2">←</ci><apply id="alg1.2.2.m1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.3.1.cmml" xref="alg1.2.2.m1.1.1.3">superscript</csymbol><apply id="alg1.2.2.m1.1.1.3.2.cmml" xref="alg1.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.3.2.1.cmml" xref="alg1.2.2.m1.1.1.3">subscript</csymbol><ci id="alg1.2.2.m1.1.1.3.2.2.cmml" xref="alg1.2.2.m1.1.1.3.2.2">𝑐</ci><ci id="alg1.2.2.m1.1.1.3.2.3.cmml" xref="alg1.2.2.m1.1.1.3.2.3">𝑙</ci></apply><times id="alg1.2.2.m1.1.1.3.3.cmml" xref="alg1.2.2.m1.1.1.3.3"></times></apply><apply id="alg1.2.2.m1.1.1.1.cmml" xref="alg1.2.2.m1.1.1.1"><plus id="alg1.2.2.m1.1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.1.2"></plus><apply id="alg1.2.2.m1.1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.1.3"><minus id="alg1.2.2.m1.1.1.1.3.1.cmml" xref="alg1.2.2.m1.1.1.1.3.1"></minus><apply id="alg1.2.2.m1.1.1.1.3.2.cmml" xref="alg1.2.2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.3.2.1.cmml" xref="alg1.2.2.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.2.2.m1.1.1.1.3.2.2.cmml" xref="alg1.2.2.m1.1.1.1.3.2.2">𝑐</ci><ci id="alg1.2.2.m1.1.1.1.3.2.3.cmml" xref="alg1.2.2.m1.1.1.1.3.2.3">𝑙</ci></apply><apply id="alg1.2.2.m1.1.1.1.3.3.cmml" xref="alg1.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.3.3.1.cmml" xref="alg1.2.2.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.2.2.m1.1.1.1.3.3.2.cmml" xref="alg1.2.2.m1.1.1.1.3.3.2">𝑐</ci><ci id="alg1.2.2.m1.1.1.1.3.3.3.cmml" xref="alg1.2.2.m1.1.1.1.3.3.3">𝑔</ci></apply></apply><apply id="alg1.2.2.m1.1.1.1.1.cmml" xref="alg1.2.2.m1.1.1.1.1"><times id="alg1.2.2.m1.1.1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.1.1.2"></times><apply id="alg1.2.2.m1.1.1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.1.1.3"><divide id="alg1.2.2.m1.1.1.1.1.3.1.cmml" xref="alg1.2.2.m1.1.1.1.1.3"></divide><cn type="integer" id="alg1.2.2.m1.1.1.1.1.3.2.cmml" xref="alg1.2.2.m1.1.1.1.1.3.2">1</cn><apply id="alg1.2.2.m1.1.1.1.1.3.3.cmml" xref="alg1.2.2.m1.1.1.1.1.3.3"><times id="alg1.2.2.m1.1.1.1.1.3.3.1.cmml" xref="alg1.2.2.m1.1.1.1.1.3.3.1"></times><ci id="alg1.2.2.m1.1.1.1.1.3.3.2.cmml" xref="alg1.2.2.m1.1.1.1.1.3.3.2">𝐸</ci><ci id="alg1.2.2.m1.1.1.1.1.3.3.3.cmml" xref="alg1.2.2.m1.1.1.1.1.3.3.3">𝜂</ci></apply></apply><apply id="alg1.2.2.m1.1.1.1.1.1.1.1.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1"><minus id="alg1.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="alg1.2.2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.2.2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.2">𝑤</ci><ci id="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="alg1.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.2.2.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m1.1c">c_{l}^{*}\leftarrow c_{l}-c_{g}+\frac{1}{E\eta}(w^{t}-w_{k}^{t})</annotation></semantics></math>

</div>
<div id="alg1.3.3" class="ltx_listingline">
<math id="alg1.3.3.m1.1" class="ltx_Math" alttext="\hat{c}_{k}\leftarrow(c_{l}^{*}-c_{l})" display="inline"><semantics id="alg1.3.3.m1.1a"><mrow id="alg1.3.3.m1.1.1" xref="alg1.3.3.m1.1.1.cmml"><msub id="alg1.3.3.m1.1.1.3" xref="alg1.3.3.m1.1.1.3.cmml"><mover accent="true" id="alg1.3.3.m1.1.1.3.2" xref="alg1.3.3.m1.1.1.3.2.cmml"><mi id="alg1.3.3.m1.1.1.3.2.2" xref="alg1.3.3.m1.1.1.3.2.2.cmml">c</mi><mo id="alg1.3.3.m1.1.1.3.2.1" xref="alg1.3.3.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg1.3.3.m1.1.1.3.3" xref="alg1.3.3.m1.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.3.3.m1.1.1.2" xref="alg1.3.3.m1.1.1.2.cmml">←</mo><mrow id="alg1.3.3.m1.1.1.1.1" xref="alg1.3.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.3.3.m1.1.1.1.1.2" xref="alg1.3.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.3.3.m1.1.1.1.1.1" xref="alg1.3.3.m1.1.1.1.1.1.cmml"><msubsup id="alg1.3.3.m1.1.1.1.1.1.2" xref="alg1.3.3.m1.1.1.1.1.1.2.cmml"><mi id="alg1.3.3.m1.1.1.1.1.1.2.2.2" xref="alg1.3.3.m1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="alg1.3.3.m1.1.1.1.1.1.2.2.3" xref="alg1.3.3.m1.1.1.1.1.1.2.2.3.cmml">l</mi><mo id="alg1.3.3.m1.1.1.1.1.1.2.3" xref="alg1.3.3.m1.1.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="alg1.3.3.m1.1.1.1.1.1.1" xref="alg1.3.3.m1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.3.3.m1.1.1.1.1.1.3" xref="alg1.3.3.m1.1.1.1.1.1.3.cmml"><mi id="alg1.3.3.m1.1.1.1.1.1.3.2" xref="alg1.3.3.m1.1.1.1.1.1.3.2.cmml">c</mi><mi id="alg1.3.3.m1.1.1.1.1.1.3.3" xref="alg1.3.3.m1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="alg1.3.3.m1.1.1.1.1.3" xref="alg1.3.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.3.m1.1b"><apply id="alg1.3.3.m1.1.1.cmml" xref="alg1.3.3.m1.1.1"><ci id="alg1.3.3.m1.1.1.2.cmml" xref="alg1.3.3.m1.1.1.2">←</ci><apply id="alg1.3.3.m1.1.1.3.cmml" xref="alg1.3.3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.3.3.m1.1.1.3.1.cmml" xref="alg1.3.3.m1.1.1.3">subscript</csymbol><apply id="alg1.3.3.m1.1.1.3.2.cmml" xref="alg1.3.3.m1.1.1.3.2"><ci id="alg1.3.3.m1.1.1.3.2.1.cmml" xref="alg1.3.3.m1.1.1.3.2.1">^</ci><ci id="alg1.3.3.m1.1.1.3.2.2.cmml" xref="alg1.3.3.m1.1.1.3.2.2">𝑐</ci></apply><ci id="alg1.3.3.m1.1.1.3.3.cmml" xref="alg1.3.3.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.3.3.m1.1.1.1.1.1.cmml" xref="alg1.3.3.m1.1.1.1.1"><minus id="alg1.3.3.m1.1.1.1.1.1.1.cmml" xref="alg1.3.3.m1.1.1.1.1.1.1"></minus><apply id="alg1.3.3.m1.1.1.1.1.1.2.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.3.3.m1.1.1.1.1.1.2.1.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2">superscript</csymbol><apply id="alg1.3.3.m1.1.1.1.1.1.2.2.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.3.3.m1.1.1.1.1.1.2.2.1.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.3.3.m1.1.1.1.1.1.2.2.2.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="alg1.3.3.m1.1.1.1.1.1.2.2.3.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2.2.3">𝑙</ci></apply><times id="alg1.3.3.m1.1.1.1.1.1.2.3.cmml" xref="alg1.3.3.m1.1.1.1.1.1.2.3"></times></apply><apply id="alg1.3.3.m1.1.1.1.1.1.3.cmml" xref="alg1.3.3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.3.3.m1.1.1.1.1.1.3.1.cmml" xref="alg1.3.3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.3.3.m1.1.1.1.1.1.3.2.cmml" xref="alg1.3.3.m1.1.1.1.1.1.3.2">𝑐</ci><ci id="alg1.3.3.m1.1.1.1.1.1.3.3.cmml" xref="alg1.3.3.m1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m1.1c">\hat{c}_{k}\leftarrow(c_{l}^{*}-c_{l})</annotation></semantics></math>

</div>
<div id="alg1.4.4" class="ltx_listingline">
<math id="alg1.4.4.m1.1" class="ltx_Math" alttext="c_{l}\leftarrow c_{l}^{*}" display="inline"><semantics id="alg1.4.4.m1.1a"><mrow id="alg1.4.4.m1.1.1" xref="alg1.4.4.m1.1.1.cmml"><msub id="alg1.4.4.m1.1.1.2" xref="alg1.4.4.m1.1.1.2.cmml"><mi id="alg1.4.4.m1.1.1.2.2" xref="alg1.4.4.m1.1.1.2.2.cmml">c</mi><mi id="alg1.4.4.m1.1.1.2.3" xref="alg1.4.4.m1.1.1.2.3.cmml">l</mi></msub><mo stretchy="false" id="alg1.4.4.m1.1.1.1" xref="alg1.4.4.m1.1.1.1.cmml">←</mo><msubsup id="alg1.4.4.m1.1.1.3" xref="alg1.4.4.m1.1.1.3.cmml"><mi id="alg1.4.4.m1.1.1.3.2.2" xref="alg1.4.4.m1.1.1.3.2.2.cmml">c</mi><mi id="alg1.4.4.m1.1.1.3.2.3" xref="alg1.4.4.m1.1.1.3.2.3.cmml">l</mi><mo id="alg1.4.4.m1.1.1.3.3" xref="alg1.4.4.m1.1.1.3.3.cmml">∗</mo></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.4.4.m1.1b"><apply id="alg1.4.4.m1.1.1.cmml" xref="alg1.4.4.m1.1.1"><ci id="alg1.4.4.m1.1.1.1.cmml" xref="alg1.4.4.m1.1.1.1">←</ci><apply id="alg1.4.4.m1.1.1.2.cmml" xref="alg1.4.4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.4.4.m1.1.1.2.1.cmml" xref="alg1.4.4.m1.1.1.2">subscript</csymbol><ci id="alg1.4.4.m1.1.1.2.2.cmml" xref="alg1.4.4.m1.1.1.2.2">𝑐</ci><ci id="alg1.4.4.m1.1.1.2.3.cmml" xref="alg1.4.4.m1.1.1.2.3">𝑙</ci></apply><apply id="alg1.4.4.m1.1.1.3.cmml" xref="alg1.4.4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.4.4.m1.1.1.3.1.cmml" xref="alg1.4.4.m1.1.1.3">superscript</csymbol><apply id="alg1.4.4.m1.1.1.3.2.cmml" xref="alg1.4.4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.4.4.m1.1.1.3.2.1.cmml" xref="alg1.4.4.m1.1.1.3">subscript</csymbol><ci id="alg1.4.4.m1.1.1.3.2.2.cmml" xref="alg1.4.4.m1.1.1.3.2.2">𝑐</ci><ci id="alg1.4.4.m1.1.1.3.2.3.cmml" xref="alg1.4.4.m1.1.1.3.2.3">𝑙</ci></apply><times id="alg1.4.4.m1.1.1.3.3.cmml" xref="alg1.4.4.m1.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m1.1c">c_{l}\leftarrow c_{l}^{*}</annotation></semantics></math>

</div>
<div id="alg1.4.16" class="ltx_listingline">
</div>
<div id="alg1.l25" class="ltx_listingline">  <span id="alg1.l25.1" class="ltx_text ltx_font_bold">communicate</span> <math id="alg1.l25.m1.2" class="ltx_Math" alttext="w^{t}_{k},{\hat{c}_{k}}" display="inline"><semantics id="alg1.l25.m1.2a"><mrow id="alg1.l25.m1.2.2.2" xref="alg1.l25.m1.2.2.3.cmml"><msubsup id="alg1.l25.m1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.cmml"><mi id="alg1.l25.m1.1.1.1.1.2.2" xref="alg1.l25.m1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l25.m1.1.1.1.1.3" xref="alg1.l25.m1.1.1.1.1.3.cmml">k</mi><mi id="alg1.l25.m1.1.1.1.1.2.3" xref="alg1.l25.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l25.m1.2.2.2.3" xref="alg1.l25.m1.2.2.3.cmml">,</mo><msub id="alg1.l25.m1.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.cmml"><mover accent="true" id="alg1.l25.m1.2.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.2.cmml"><mi id="alg1.l25.m1.2.2.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.2.2.cmml">c</mi><mo id="alg1.l25.m1.2.2.2.2.2.1" xref="alg1.l25.m1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l25.m1.2.2.2.2.3" xref="alg1.l25.m1.2.2.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.2b"><list id="alg1.l25.m1.2.2.3.cmml" xref="alg1.l25.m1.2.2.2"><apply id="alg1.l25.m1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l25.m1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l25.m1.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l25.m1.1.1.1.1.2.3.cmml" xref="alg1.l25.m1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l25.m1.1.1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l25.m1.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.2.2.1.cmml" xref="alg1.l25.m1.2.2.2.2">subscript</csymbol><apply id="alg1.l25.m1.2.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2.2"><ci id="alg1.l25.m1.2.2.2.2.2.1.cmml" xref="alg1.l25.m1.2.2.2.2.2.1">^</ci><ci id="alg1.l25.m1.2.2.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2.2.2">𝑐</ci></apply><ci id="alg1.l25.m1.2.2.2.2.3.cmml" xref="alg1.l25.m1.2.2.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.2c">w^{t}_{k},{\hat{c}_{k}}</annotation></semantics></math> to server

</div>
<div id="alg1.4.17" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.6.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>FedDP </figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.6" class="ltx_p">In the implementation, we use the average pool to subsample the feature map, and the <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">K</annotation></semantics></math>-argmax operation will return the top-<math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">K</annotation></semantics></math> most significant value’s index. The <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">K</annotation></semantics></math> is a hyper-parameter, which defines the dynamic channel pruning ratio for hidden layers.
Similar to the <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, we train the gate together with the neural network, and regularize all layers with the Lasso <math id="S4.SS2.p2.4.m4.2" class="ltx_Math" alttext="\mathcal{L}_{g}=\lambda\sum_{k=1}^{l}\mathbb{E}[||\operatorname{linear(s_{k})}||_{1}]" display="inline"><semantics id="S4.SS2.p2.4.m4.2a"><mrow id="S4.SS2.p2.4.m4.2.2" xref="S4.SS2.p2.4.m4.2.2.cmml"><msub id="S4.SS2.p2.4.m4.2.2.3" xref="S4.SS2.p2.4.m4.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.2.2.3.2" xref="S4.SS2.p2.4.m4.2.2.3.2.cmml">ℒ</mi><mi id="S4.SS2.p2.4.m4.2.2.3.3" xref="S4.SS2.p2.4.m4.2.2.3.3.cmml">g</mi></msub><mo id="S4.SS2.p2.4.m4.2.2.2" xref="S4.SS2.p2.4.m4.2.2.2.cmml">=</mo><mrow id="S4.SS2.p2.4.m4.2.2.1" xref="S4.SS2.p2.4.m4.2.2.1.cmml"><mi id="S4.SS2.p2.4.m4.2.2.1.3" xref="S4.SS2.p2.4.m4.2.2.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.2.2.1.2" xref="S4.SS2.p2.4.m4.2.2.1.2.cmml">​</mo><mrow id="S4.SS2.p2.4.m4.2.2.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.cmml"><msubsup id="S4.SS2.p2.4.m4.2.2.1.1.2" xref="S4.SS2.p2.4.m4.2.2.1.1.2.cmml"><mo id="S4.SS2.p2.4.m4.2.2.1.1.2.2.2" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.cmml"><mi id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.2" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.2.cmml">k</mi><mo id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.1" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.3" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p2.4.m4.2.2.1.1.2.3" xref="S4.SS2.p2.4.m4.2.2.1.1.2.3.cmml">l</mi></msubsup><mrow id="S4.SS2.p2.4.m4.2.2.1.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.cmml"><mi id="S4.SS2.p2.4.m4.2.2.1.1.1.3" xref="S4.SS2.p2.4.m4.2.2.1.1.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.2.2.1.1.1.2" xref="S4.SS2.p2.4.m4.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.2" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.1.cmml">[</mo><msub id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.2" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.1.cmml"><mo stretchy="false" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.2.1" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.1.1.cmml">‖</mo><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">linear</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S4.SS2.p2.4.m4.1.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.4.m4.1.1.1.1.2" xref="S4.SS2.p2.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p2.4.m4.1.1.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p2.4.m4.1.1.1.1.1.2" xref="S4.SS2.p2.4.m4.1.1.1.1.1.2.cmml">s</mi><mi mathvariant="normal" id="S4.SS2.p2.4.m4.1.1.1.1.1.3" xref="S4.SS2.p2.4.m4.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S4.SS2.p2.4.m4.1.1.1.1.3" xref="S4.SS2.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.1.1.cmml">‖</mo></mrow><mn id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.3" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.3" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.2b"><apply id="S4.SS2.p2.4.m4.2.2.cmml" xref="S4.SS2.p2.4.m4.2.2"><eq id="S4.SS2.p2.4.m4.2.2.2.cmml" xref="S4.SS2.p2.4.m4.2.2.2"></eq><apply id="S4.SS2.p2.4.m4.2.2.3.cmml" xref="S4.SS2.p2.4.m4.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.2.2.3.1.cmml" xref="S4.SS2.p2.4.m4.2.2.3">subscript</csymbol><ci id="S4.SS2.p2.4.m4.2.2.3.2.cmml" xref="S4.SS2.p2.4.m4.2.2.3.2">ℒ</ci><ci id="S4.SS2.p2.4.m4.2.2.3.3.cmml" xref="S4.SS2.p2.4.m4.2.2.3.3">𝑔</ci></apply><apply id="S4.SS2.p2.4.m4.2.2.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1"><times id="S4.SS2.p2.4.m4.2.2.1.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.2"></times><ci id="S4.SS2.p2.4.m4.2.2.1.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.3">𝜆</ci><apply id="S4.SS2.p2.4.m4.2.2.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1"><apply id="S4.SS2.p2.4.m4.2.2.1.1.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.2.2.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2">superscript</csymbol><apply id="S4.SS2.p2.4.m4.2.2.1.1.2.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.2.2.1.1.2.2.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2">subscript</csymbol><sum id="S4.SS2.p2.4.m4.2.2.1.1.2.2.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.2"></sum><apply id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3"><eq id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.1"></eq><ci id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p2.4.m4.2.2.1.1.2.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.2.3">𝑙</ci></apply><apply id="S4.SS2.p2.4.m4.2.2.1.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1"><times id="S4.SS2.p2.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.2"></times><ci id="S4.SS2.p2.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.3">𝔼</ci><apply id="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.2"><csymbol cd="latexml" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.1.1.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.2.2.1">norm</csymbol><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><times id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2"></times><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">linear</ci><apply id="S4.SS2.p2.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.1.1.1.2">s</ci><ci id="S4.SS2.p2.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.1.1.1.3">k</ci></apply></apply></apply><cn type="integer" id="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.4.m4.2.2.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.2c">\mathcal{L}_{g}=\lambda\sum_{k=1}^{l}\mathbb{E}[||\operatorname{linear(s_{k})}||_{1}]</annotation></semantics></math> in the total loss, where <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="s_{k}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝑠</ci><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">s_{k}</annotation></semantics></math> is the subsample vector of <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="x_{k}" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><msub id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml"><mi id="S4.SS2.p2.6.m6.1.1.2" xref="S4.SS2.p2.6.m6.1.1.2.cmml">x</mi><mi id="S4.SS2.p2.6.m6.1.1.3" xref="S4.SS2.p2.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><apply id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.6.m6.1.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p2.6.m6.1.1.2.cmml" xref="S4.SS2.p2.6.m6.1.1.2">𝑥</ci><ci id="S4.SS2.p2.6.m6.1.1.3.cmml" xref="S4.SS2.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">x_{k}</annotation></semantics></math>.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<p id="S4.F3.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F3.1.1.1" class="ltx_text"><img src="/html/2106.06921/assets/x2.png" id="S4.F3.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="107" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Comparison of FedDP with SoTA: the top-1 average test accuracy vs. communication rounds.</figcaption>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Global gradient control variates</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In FedDP, we use the SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> as the backend FL aggregating algorithm.
Straightforwardly, we maintain a gradient control variate to stabilize the federated learning process. The variate in the cloud server tracks the global gradient direction among heterogeneous edge clients. The edge clients will use the gradient control variates to correct their gradient drift when performing local updates.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.6" class="ltx_p">Algorithm <a href="#alg1" title="In IV-B Dynamic pruning gate ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows FedDP with gradient controlled FL.
In each update round, the client downloads the global model’s parameter <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msup id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">w</mi><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑤</ci><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">w^{t}</annotation></semantics></math> and the global optimization direction <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="c_{g}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">c</mi><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑐</ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">c_{g}</annotation></semantics></math> from the server and performs local updates.
In local clients, we maintain a local optimization control variate <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="c_{l}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">c</mi><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑐</ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">c_{l}</annotation></semantics></math>,
and when training the local model <math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="w_{k}^{t}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><msubsup id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2.2" xref="S4.SS3.p2.4.m4.1.1.2.2.cmml">w</mi><mi id="S4.SS3.p2.4.m4.1.1.2.3" xref="S4.SS3.p2.4.m4.1.1.2.3.cmml">k</mi><mi id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">superscript</csymbol><apply id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.2.1.cmml" xref="S4.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.2.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2.2">𝑤</ci><ci id="S4.SS3.p2.4.m4.1.1.2.3.cmml" xref="S4.SS3.p2.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">w_{k}^{t}</annotation></semantics></math>, <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="(c_{g}-c_{l})" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.5.m5.1.1.1.2" xref="S4.SS3.p2.5.m5.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p2.5.m5.1.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.1.cmml"><msub id="S4.SS3.p2.5.m5.1.1.1.1.2" xref="S4.SS3.p2.5.m5.1.1.1.1.2.cmml"><mi id="S4.SS3.p2.5.m5.1.1.1.1.2.2" xref="S4.SS3.p2.5.m5.1.1.1.1.2.2.cmml">c</mi><mi id="S4.SS3.p2.5.m5.1.1.1.1.2.3" xref="S4.SS3.p2.5.m5.1.1.1.1.2.3.cmml">g</mi></msub><mo id="S4.SS3.p2.5.m5.1.1.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.1.1.cmml">−</mo><msub id="S4.SS3.p2.5.m5.1.1.1.1.3" xref="S4.SS3.p2.5.m5.1.1.1.1.3.cmml"><mi id="S4.SS3.p2.5.m5.1.1.1.1.3.2" xref="S4.SS3.p2.5.m5.1.1.1.1.3.2.cmml">c</mi><mi id="S4.SS3.p2.5.m5.1.1.1.1.3.3" xref="S4.SS3.p2.5.m5.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="S4.SS3.p2.5.m5.1.1.1.3" xref="S4.SS3.p2.5.m5.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1"><minus id="S4.SS3.p2.5.m5.1.1.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.1"></minus><apply id="S4.SS3.p2.5.m5.1.1.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.1.1.1.2.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p2.5.m5.1.1.1.1.2.2.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p2.5.m5.1.1.1.1.2.3.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.2.3">𝑔</ci></apply><apply id="S4.SS3.p2.5.m5.1.1.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.5.m5.1.1.1.1.3.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.5.m5.1.1.1.1.3.2.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p2.5.m5.1.1.1.1.3.3.cmml" xref="S4.SS3.p2.5.m5.1.1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">(c_{g}-c_{l})</annotation></semantics></math> is applied to correct the gradient drift. After the local training is finished, the local control variate <math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="c_{l}" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><msub id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">c</mi><mi id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><apply id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m6.1.1.2.cmml" xref="S4.SS3.p2.6.m6.1.1.2">𝑐</ci><ci id="S4.SS3.p2.6.m6.1.1.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">c_{l}</annotation></semantics></math> is updated by estimating the gradient drift between local and global models.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Adaptive gradient control federated learning</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">Inspired by stochastic controlled averaging federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we equipped dynamic pruning with gradient-controlled federated learning to enable a much more stable and robust federated learning process.
Due to client heterogeneity, local gradient update directions will move towards local optima and may diverge across all clients. To correct overall gradient divergence by estimating gradient update directions, we maintain control variates both on clients and the cloud aggregator.
This section shows how we equip adaptive dynamic pruning to gradient control federated learning.
Algorithm <a href="#alg1" title="In IV-B Dynamic pruning gate ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the local updates and server aggregates process.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.3" class="ltx_p">In the server execution, the procedure is exactly the same as the SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, where the server aggregates the parameter from the selected clients. When doing the local update, the client first downloads the neural network’s parameter <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><msup id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">w</mi><mi id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑤</ci><ci id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">w^{t}</annotation></semantics></math> from the cloud server at the <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">t</annotation></semantics></math> communication round. Then, training the neural network and dynamic pruning components together using the local dataset. After training is finished, the client will upload the neural network’s parameter to the server, and the dynamic pruning component’s parameter <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><msub id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">w</mi><mi id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝑤</ci><ci id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">w_{g}</annotation></semantics></math> is stored locally. Therefore, updating models from the clients to the server would not incur extra communication costs.
The loss function is defined in equation <a href="#S4.E8" title="In IV-D Adaptive gradient control federated learning ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.3" class="ltx_Math" alttext="\mathcal{L}(w,w_{g};\mathcal{B})=\mathcal{L}_{nn}+\mathcal{L}_{g}" display="block"><semantics id="S4.E8.m1.3a"><mrow id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml"><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.3.3.1.3" xref="S4.E8.m1.3.3.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.2" xref="S4.E8.m1.3.3.1.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.1" xref="S4.E8.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml">(</mo><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">w</mi><mo id="S4.E8.m1.3.3.1.1.1.3" xref="S4.E8.m1.3.3.1.1.2.cmml">,</mo><msub id="S4.E8.m1.3.3.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.2.cmml">w</mi><mi id="S4.E8.m1.3.3.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.3.cmml">g</mi></msub><mo id="S4.E8.m1.3.3.1.1.1.4" xref="S4.E8.m1.3.3.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">ℬ</mi><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.5" xref="S4.E8.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.3.3.2" xref="S4.E8.m1.3.3.2.cmml">=</mo><mrow id="S4.E8.m1.3.3.3" xref="S4.E8.m1.3.3.3.cmml"><msub id="S4.E8.m1.3.3.3.2" xref="S4.E8.m1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.3.3.3.2.2" xref="S4.E8.m1.3.3.3.2.2.cmml">ℒ</mi><mrow id="S4.E8.m1.3.3.3.2.3" xref="S4.E8.m1.3.3.3.2.3.cmml"><mi id="S4.E8.m1.3.3.3.2.3.2" xref="S4.E8.m1.3.3.3.2.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.3.2.3.1" xref="S4.E8.m1.3.3.3.2.3.1.cmml">​</mo><mi id="S4.E8.m1.3.3.3.2.3.3" xref="S4.E8.m1.3.3.3.2.3.3.cmml">n</mi></mrow></msub><mo id="S4.E8.m1.3.3.3.1" xref="S4.E8.m1.3.3.3.1.cmml">+</mo><msub id="S4.E8.m1.3.3.3.3" xref="S4.E8.m1.3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.3.3.3.3.2" xref="S4.E8.m1.3.3.3.3.2.cmml">ℒ</mi><mi id="S4.E8.m1.3.3.3.3.3" xref="S4.E8.m1.3.3.3.3.3.cmml">g</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.3b"><apply id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3"><eq id="S4.E8.m1.3.3.2.cmml" xref="S4.E8.m1.3.3.2"></eq><apply id="S4.E8.m1.3.3.1.cmml" xref="S4.E8.m1.3.3.1"><times id="S4.E8.m1.3.3.1.2.cmml" xref="S4.E8.m1.3.3.1.2"></times><ci id="S4.E8.m1.3.3.1.3.cmml" xref="S4.E8.m1.3.3.1.3">ℒ</ci><vector id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1"><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">𝑤</ci><apply id="S4.E8.m1.3.3.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.2">𝑤</ci><ci id="S4.E8.m1.3.3.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.3">𝑔</ci></apply><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">ℬ</ci></vector></apply><apply id="S4.E8.m1.3.3.3.cmml" xref="S4.E8.m1.3.3.3"><plus id="S4.E8.m1.3.3.3.1.cmml" xref="S4.E8.m1.3.3.3.1"></plus><apply id="S4.E8.m1.3.3.3.2.cmml" xref="S4.E8.m1.3.3.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.2.1.cmml" xref="S4.E8.m1.3.3.3.2">subscript</csymbol><ci id="S4.E8.m1.3.3.3.2.2.cmml" xref="S4.E8.m1.3.3.3.2.2">ℒ</ci><apply id="S4.E8.m1.3.3.3.2.3.cmml" xref="S4.E8.m1.3.3.3.2.3"><times id="S4.E8.m1.3.3.3.2.3.1.cmml" xref="S4.E8.m1.3.3.3.2.3.1"></times><ci id="S4.E8.m1.3.3.3.2.3.2.cmml" xref="S4.E8.m1.3.3.3.2.3.2">𝑛</ci><ci id="S4.E8.m1.3.3.3.2.3.3.cmml" xref="S4.E8.m1.3.3.3.2.3.3">𝑛</ci></apply></apply><apply id="S4.E8.m1.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.cmml" xref="S4.E8.m1.3.3.3.3">subscript</csymbol><ci id="S4.E8.m1.3.3.3.3.2.cmml" xref="S4.E8.m1.3.3.3.3.2">ℒ</ci><ci id="S4.E8.m1.3.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3.3">𝑔</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.3c">\mathcal{L}(w,w_{g};\mathcal{B})=\mathcal{L}_{nn}+\mathcal{L}_{g}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p3.3" class="ltx_p">where the <math id="S4.SS4.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{nn}" display="inline"><semantics id="S4.SS4.p3.1.m1.1a"><msub id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml"><mi id="S4.SS4.p3.1.m1.1.1.3.2" xref="S4.SS4.p3.1.m1.1.1.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.1.m1.1.1.3.1" xref="S4.SS4.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p3.1.m1.1.1.3.3" xref="S4.SS4.p3.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">ℒ</ci><apply id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3"><times id="S4.SS4.p3.1.m1.1.1.3.1.cmml" xref="S4.SS4.p3.1.m1.1.1.3.1"></times><ci id="S4.SS4.p3.1.m1.1.1.3.2.cmml" xref="S4.SS4.p3.1.m1.1.1.3.2">𝑛</ci><ci id="S4.SS4.p3.1.m1.1.1.3.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\mathcal{L}_{nn}</annotation></semantics></math> is the Cross-Entropy loss of the neural network, the <math id="S4.SS4.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{g}" display="inline"><semantics id="S4.SS4.p3.2.m2.1a"><msub id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">ℒ</mi><mi id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p3.2.m2.1.1.2.cmml" xref="S4.SS4.p3.2.m2.1.1.2">ℒ</ci><ci id="S4.SS4.p3.2.m2.1.1.3.cmml" xref="S4.SS4.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">\mathcal{L}_{g}</annotation></semantics></math> is the gate loss defines in section <a href="#alg1" title="In IV-B Dynamic pruning gate ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and the <math id="S4.SS4.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S4.SS4.p3.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><ci id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">\mathcal{B}</annotation></semantics></math> is the local data.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experiment</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Implementation details</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.6" class="ltx_p"><span id="S5.SS1.p1.6.1" class="ltx_text ltx_font_bold">Dataset.</span> The experiments are done on CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. We do not use LEAF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> benchmark because they contain tiny datasets (such as EMNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>) that are trivial to modern CNNs. We used distribution-based label imbalance to simulate label imbalance between each client <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. Here, each client is allocated a proportion of the samples of each label according to Dirichlet distribution (with concentration <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><ci id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\beta</annotation></semantics></math>). Specifically, we sample <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="p_{k}\sim Dir_{N}(\beta)" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.2" xref="S5.SS1.p1.2.m2.1.2.cmml"><msub id="S5.SS1.p1.2.m2.1.2.2" xref="S5.SS1.p1.2.m2.1.2.2.cmml"><mi id="S5.SS1.p1.2.m2.1.2.2.2" xref="S5.SS1.p1.2.m2.1.2.2.2.cmml">p</mi><mi id="S5.SS1.p1.2.m2.1.2.2.3" xref="S5.SS1.p1.2.m2.1.2.2.3.cmml">k</mi></msub><mo id="S5.SS1.p1.2.m2.1.2.1" xref="S5.SS1.p1.2.m2.1.2.1.cmml">∼</mo><mrow id="S5.SS1.p1.2.m2.1.2.3" xref="S5.SS1.p1.2.m2.1.2.3.cmml"><mi id="S5.SS1.p1.2.m2.1.2.3.2" xref="S5.SS1.p1.2.m2.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.2.3.1" xref="S5.SS1.p1.2.m2.1.2.3.1.cmml">​</mo><mi id="S5.SS1.p1.2.m2.1.2.3.3" xref="S5.SS1.p1.2.m2.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.2.3.1a" xref="S5.SS1.p1.2.m2.1.2.3.1.cmml">​</mo><msub id="S5.SS1.p1.2.m2.1.2.3.4" xref="S5.SS1.p1.2.m2.1.2.3.4.cmml"><mi id="S5.SS1.p1.2.m2.1.2.3.4.2" xref="S5.SS1.p1.2.m2.1.2.3.4.2.cmml">r</mi><mi id="S5.SS1.p1.2.m2.1.2.3.4.3" xref="S5.SS1.p1.2.m2.1.2.3.4.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S5.SS1.p1.2.m2.1.2.3.1b" xref="S5.SS1.p1.2.m2.1.2.3.1.cmml">​</mo><mrow id="S5.SS1.p1.2.m2.1.2.3.5.2" xref="S5.SS1.p1.2.m2.1.2.3.cmml"><mo stretchy="false" id="S5.SS1.p1.2.m2.1.2.3.5.2.1" xref="S5.SS1.p1.2.m2.1.2.3.cmml">(</mo><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">β</mi><mo stretchy="false" id="S5.SS1.p1.2.m2.1.2.3.5.2.2" xref="S5.SS1.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.2.cmml" xref="S5.SS1.p1.2.m2.1.2"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.2.1.cmml" xref="S5.SS1.p1.2.m2.1.2.1">similar-to</csymbol><apply id="S5.SS1.p1.2.m2.1.2.2.cmml" xref="S5.SS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.2.2.1.cmml" xref="S5.SS1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.2.2.2.cmml" xref="S5.SS1.p1.2.m2.1.2.2.2">𝑝</ci><ci id="S5.SS1.p1.2.m2.1.2.2.3.cmml" xref="S5.SS1.p1.2.m2.1.2.2.3">𝑘</ci></apply><apply id="S5.SS1.p1.2.m2.1.2.3.cmml" xref="S5.SS1.p1.2.m2.1.2.3"><times id="S5.SS1.p1.2.m2.1.2.3.1.cmml" xref="S5.SS1.p1.2.m2.1.2.3.1"></times><ci id="S5.SS1.p1.2.m2.1.2.3.2.cmml" xref="S5.SS1.p1.2.m2.1.2.3.2">𝐷</ci><ci id="S5.SS1.p1.2.m2.1.2.3.3.cmml" xref="S5.SS1.p1.2.m2.1.2.3.3">𝑖</ci><apply id="S5.SS1.p1.2.m2.1.2.3.4.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4"><csymbol cd="ambiguous" id="S5.SS1.p1.2.m2.1.2.3.4.1.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4">subscript</csymbol><ci id="S5.SS1.p1.2.m2.1.2.3.4.2.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4.2">𝑟</ci><ci id="S5.SS1.p1.2.m2.1.2.3.4.3.cmml" xref="S5.SS1.p1.2.m2.1.2.3.4.3">𝑁</ci></apply><ci id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">𝛽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">p_{k}\sim Dir_{N}(\beta)</annotation></semantics></math> and allocate a <math id="S5.SS1.p1.3.m3.2" class="ltx_Math" alttext="p_{k,j}" display="inline"><semantics id="S5.SS1.p1.3.m3.2a"><msub id="S5.SS1.p1.3.m3.2.3" xref="S5.SS1.p1.3.m3.2.3.cmml"><mi id="S5.SS1.p1.3.m3.2.3.2" xref="S5.SS1.p1.3.m3.2.3.2.cmml">p</mi><mrow id="S5.SS1.p1.3.m3.2.2.2.4" xref="S5.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S5.SS1.p1.3.m3.1.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.1.cmml">k</mi><mo id="S5.SS1.p1.3.m3.2.2.2.4.1" xref="S5.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S5.SS1.p1.3.m3.2.2.2.2" xref="S5.SS1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.2b"><apply id="S5.SS1.p1.3.m3.2.3.cmml" xref="S5.SS1.p1.3.m3.2.3"><csymbol cd="ambiguous" id="S5.SS1.p1.3.m3.2.3.1.cmml" xref="S5.SS1.p1.3.m3.2.3">subscript</csymbol><ci id="S5.SS1.p1.3.m3.2.3.2.cmml" xref="S5.SS1.p1.3.m3.2.3.2">𝑝</ci><list id="S5.SS1.p1.3.m3.2.2.2.3.cmml" xref="S5.SS1.p1.3.m3.2.2.2.4"><ci id="S5.SS1.p1.3.m3.1.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1.1">𝑘</ci><ci id="S5.SS1.p1.3.m3.2.2.2.2.cmml" xref="S5.SS1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.2c">p_{k,j}</annotation></semantics></math> proportion of the instances of class <math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mi id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><ci id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">k</annotation></semantics></math> to party <math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mi id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><ci id="S5.SS1.p1.5.m5.1.1.cmml" xref="S5.SS1.p1.5.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">j</annotation></semantics></math>. Here we choose the <math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="\beta=0.1" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mrow id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml"><mi id="S5.SS1.p1.6.m6.1.1.2" xref="S5.SS1.p1.6.m6.1.1.2.cmml">β</mi><mo id="S5.SS1.p1.6.m6.1.1.1" xref="S5.SS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.6.m6.1.1.3" xref="S5.SS1.p1.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><apply id="S5.SS1.p1.6.m6.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1"><eq id="S5.SS1.p1.6.m6.1.1.1.cmml" xref="S5.SS1.p1.6.m6.1.1.1"></eq><ci id="S5.SS1.p1.6.m6.1.1.2.cmml" xref="S5.SS1.p1.6.m6.1.1.2">𝛽</ci><cn type="float" id="S5.SS1.p1.6.m6.1.1.3.cmml" xref="S5.SS1.p1.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">\beta=0.1</annotation></semantics></math>.
Moreover, to test the FedDP’s dataset-aware pruning policy on each device, we further allocate a local validation dataset for each of them.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Model architectures.</span> Two large modern CNN architectures are evaluated: VGG-11 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> and ResNet-32 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>. Simple models (like CNN with several convolutional layers in LEAF) are not chosen because the effect of pruning cannot be realized in those cases.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.3" class="ltx_p"><span id="S5.SS1.p3.3.1" class="ltx_text ltx_font_bold">Federated learning settings.</span>
We experiment with different numbers of clients from 10, 30, 50 to 100 with sample rates 100%, 40%, 70%, and 40% respectively. For each training round, there are 10 epochs of local updates and in each epoch, the cosine learning rate decay is applied. We use the SGD optimizer (mini-batch gradient descend), where the <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\alpha=5~{}\times 10^{-3}" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mrow id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mi id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS1.p3.1.m1.1.1.1" xref="S5.SS1.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml"><mn id="S5.SS1.p3.1.m1.1.1.3.2" xref="S5.SS1.p3.1.m1.1.1.3.2.cmml">5</mn><mo lspace="0.552em" rspace="0.222em" id="S5.SS1.p3.1.m1.1.1.3.1" xref="S5.SS1.p3.1.m1.1.1.3.1.cmml">×</mo><msup id="S5.SS1.p3.1.m1.1.1.3.3" xref="S5.SS1.p3.1.m1.1.1.3.3.cmml"><mn id="S5.SS1.p3.1.m1.1.1.3.3.2" xref="S5.SS1.p3.1.m1.1.1.3.3.2.cmml">10</mn><mrow id="S5.SS1.p3.1.m1.1.1.3.3.3" xref="S5.SS1.p3.1.m1.1.1.3.3.3.cmml"><mo id="S5.SS1.p3.1.m1.1.1.3.3.3a" xref="S5.SS1.p3.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S5.SS1.p3.1.m1.1.1.3.3.3.2" xref="S5.SS1.p3.1.m1.1.1.3.3.3.2.cmml">3</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><eq id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1.1"></eq><ci id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2">𝛼</ci><apply id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3"><times id="S5.SS1.p3.1.m1.1.1.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.1"></times><cn type="integer" id="S5.SS1.p3.1.m1.1.1.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2">5</cn><apply id="S5.SS1.p3.1.m1.1.1.3.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3">superscript</csymbol><cn type="integer" id="S5.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.2">10</cn><apply id="S5.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.3"><minus id="S5.SS1.p3.1.m1.1.1.3.3.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.3"></minus><cn type="integer" id="S5.SS1.p3.1.m1.1.1.3.3.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.3.2">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\alpha=5~{}\times 10^{-3}</annotation></semantics></math>, the learning rate is <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><mn id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><cn type="float" id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">0.1</annotation></semantics></math>, batch size is 64, and the weight decay is <math id="S5.SS1.p3.3.m3.1" class="ltx_Math" alttext="5~{}\times 10^{-4}" display="inline"><semantics id="S5.SS1.p3.3.m3.1a"><mrow id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml"><mn id="S5.SS1.p3.3.m3.1.1.2" xref="S5.SS1.p3.3.m3.1.1.2.cmml">5</mn><mo lspace="0.552em" rspace="0.222em" id="S5.SS1.p3.3.m3.1.1.1" xref="S5.SS1.p3.3.m3.1.1.1.cmml">×</mo><msup id="S5.SS1.p3.3.m3.1.1.3" xref="S5.SS1.p3.3.m3.1.1.3.cmml"><mn id="S5.SS1.p3.3.m3.1.1.3.2" xref="S5.SS1.p3.3.m3.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p3.3.m3.1.1.3.3" xref="S5.SS1.p3.3.m3.1.1.3.3.cmml"><mo id="S5.SS1.p3.3.m3.1.1.3.3a" xref="S5.SS1.p3.3.m3.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p3.3.m3.1.1.3.3.2" xref="S5.SS1.p3.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><apply id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1"><times id="S5.SS1.p3.3.m3.1.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1.1"></times><cn type="integer" id="S5.SS1.p3.3.m3.1.1.2.cmml" xref="S5.SS1.p3.3.m3.1.1.2">5</cn><apply id="S5.SS1.p3.3.m3.1.1.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p3.3.m3.1.1.3.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S5.SS1.p3.3.m3.1.1.3.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.2">10</cn><apply id="S5.SS1.p3.3.m3.1.1.3.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3"><minus id="S5.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3"></minus><cn type="integer" id="S5.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S5.SS1.p3.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">5~{}\times 10^{-4}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Comparison with SoTA</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">The goal of this part is to assess FedDP’s learning efficiency by looking at the relationship between communication rounds and the model’s Top-1 accuracy, i.e., the answer that has the highest possibility of being correct must be the highest probability forecast. We train the VGG-11 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> on CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> until convergence on the global model and compare the results with SoTA (i.e., FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>).</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<p id="S5.F4.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S5.F4.1.1.1" class="ltx_text"><img src="/html/2106.06921/assets/x3.png" id="S5.F4.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="322" height="150" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Communication cost to achieve target <math id="S5.F4.3.3.m1.1" class="ltx_Math" alttext="78\%" display="inline"><semantics id="S5.F4.3.3.m1.1b"><mrow id="S5.F4.3.3.m1.1.1" xref="S5.F4.3.3.m1.1.1.cmml"><mn id="S5.F4.3.3.m1.1.1.2" xref="S5.F4.3.3.m1.1.1.2.cmml">78</mn><mo id="S5.F4.3.3.m1.1.1.1" xref="S5.F4.3.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.3.3.m1.1c"><apply id="S5.F4.3.3.m1.1.1.cmml" xref="S5.F4.3.3.m1.1.1"><csymbol cd="latexml" id="S5.F4.3.3.m1.1.1.1.cmml" xref="S5.F4.3.3.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.F4.3.3.m1.1.1.2.cmml" xref="S5.F4.3.3.m1.1.1.2">78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.3.m1.1d">78\%</annotation></semantics></math> accuracy.</figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Figure <a href="#S4.F3" title="Figure 3 ‣ IV-B Dynamic pruning gate ‣ IV Approach ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the results of FedDP on different configurations. More specifically, with 10 clients, FedDP can yield a comparable training process with other methods. That means deploying dynamic pruning components in the local clients does not add extra challenges to the federated learning process.
For the over-parameterized neural networks, such as VGG-11, FedDP’s highest accuracy is similar to that of SCAFFOLD (which has the best converging accuracy of all vanilla FL methods), where the accuracies achieved by FedDP are 83.52% and 84.21% respectively. Moreover, the effectiveness of our proposed method is demonstrated in more complex FL settings, i.e., in which we scaled the total client numbers to 30, 50, and 100 with different sample ratios.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">With the same dataset, increasing the number of clients will naturally cause more heterogeneity. The results indicate that FedDP is suitable for dealing with non-IID data.
Experiment results in Figure <a href="#S5.F5" title="Figure 5 ‣ V-C Inference acceleration ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> show that with a more complex FL setting, the FedDP consistently outperforms SoTAs, especially in the early stage.
In the case of 30 and 100 clients <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>There are some biased results shown in Fig. <a href="#S5.F5" title="Figure 5 ‣ V-C Inference acceleration ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, where the SCAFFOLD<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> diverges with gradient explosion in our experiment settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> when there are more than 10 clients.</span></span></span>,
for VGG-11, FedDP outperforms all SoTA FL methods by a significant margin. Noticeably, FedDP requires much fewer rounds in the beginning to reach the target accuracy and then saturates. The difference is more pronounced in 50 clients setting where FedDP needs only 25 rounds to reach 35% accuracy.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p">We found it is because of the fact that over-parameterized neural networks are easily overfitting on local non-IID datasets by analyzing the training logs, which drifts local optima with respect to the global gradient optimum and thus makes the training process challenging. We claim that dynamic pruning is a good way to eliminate over-fitting.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.5.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.6.2" class="ltx_text ltx_font_italic">Inference acceleration</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We further evaluate the inference acceleration of FedDP.
One key contribution of FedDP is to accelerate the inference time of deployed models. When doing inference in the local clients, we forward the input instance to the selected salient sub-model, accelerating the inference time and reducing computational consumption. Table <a href="#S5.T1" title="TABLE I ‣ V-C Inference acceleration ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> shows the inference acceleration status after training is finished. FedDP notably reduced the FLOPs (floating point operations per second) in all the evaluated models. For VGG-11 and ResNet-32, the FLOPs reduction among all clients is <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mn id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">50</mn><mo id="S5.SS3.p1.1.m1.1.1.1" xref="S5.SS3.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">50\%</annotation></semantics></math> lower
than the original model, while the client models have a relatively low sparsity ratio (the sparsity ratio represents the ratio of salient parameters compared to the entire model parameters).</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.2" class="ltx_p">The total FLOPs consumption of our best performing method (SCAFFOLD) with and without dynamic pruning is recorded in Table <a href="#S5.T1" title="TABLE I ‣ V-C Inference acceleration ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. The original VGG-11 has 15.48 billion FLOPs and under <math id="S5.SS3.p2.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1b"><mn id="S5.SS3.p2.1.m1.1.1">2</mn><mo lspace="0.222em" id="S5.SS3.p2.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">2\times</annotation></semantics></math> acceleration, we reduced 7.36 billion FLOPs (<math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mn id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">50</mn><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">50\%</annotation></semantics></math> FLOPs compared to the original model). Similarly, the FLOPs of ResNet-32 have been reduced from 7.36 billion to 3.68 billion.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Comparison table for FLOPs.</figcaption>
<table id="S5.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.2.3.1" class="ltx_tr">
<th id="S5.T1.2.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Model</th>
<th id="S5.T1.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Original FLOPs</th>
<th id="S5.T1.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FLOPs After Pruning</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.1" class="ltx_tr">
<td id="S5.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">VGG-11</td>
<td id="S5.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">15.48 G</td>
<td id="S5.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">7.74 G (<math id="S5.T1.1.1.1.m1.1" class="ltx_Math" alttext="50\%\downarrow" display="inline"><semantics id="S5.T1.1.1.1.m1.1a"><mrow id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml"><mrow id="S5.T1.1.1.1.m1.1.1.2" xref="S5.T1.1.1.1.m1.1.1.2.cmml"><mn id="S5.T1.1.1.1.m1.1.1.2.2" xref="S5.T1.1.1.1.m1.1.1.2.2.cmml">50</mn><mo id="S5.T1.1.1.1.m1.1.1.2.1" xref="S5.T1.1.1.1.m1.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S5.T1.1.1.1.m1.1.1.1" xref="S5.T1.1.1.1.m1.1.1.1.cmml">↓</mo><mi id="S5.T1.1.1.1.m1.1.1.3" xref="S5.T1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><apply id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1"><ci id="S5.T1.1.1.1.m1.1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1.1">↓</ci><apply id="S5.T1.1.1.1.m1.1.1.2.cmml" xref="S5.T1.1.1.1.m1.1.1.2"><csymbol cd="latexml" id="S5.T1.1.1.1.m1.1.1.2.1.cmml" xref="S5.T1.1.1.1.m1.1.1.2.1">percent</csymbol><cn type="integer" id="S5.T1.1.1.1.m1.1.1.2.2.cmml" xref="S5.T1.1.1.1.m1.1.1.2.2">50</cn></apply><csymbol cd="latexml" id="S5.T1.1.1.1.m1.1.1.3.cmml" xref="S5.T1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">50\%\downarrow</annotation></semantics></math>)</td>
</tr>
<tr id="S5.T1.2.2" class="ltx_tr">
<td id="S5.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_bb">ResNet-32</td>
<td id="S5.T1.2.2.3" class="ltx_td ltx_align_center ltx_border_bb">7.36 G</td>
<td id="S5.T1.2.2.1" class="ltx_td ltx_align_center ltx_border_bb">3.68 G (<math id="S5.T1.2.2.1.m1.1" class="ltx_Math" alttext="50\%\downarrow" display="inline"><semantics id="S5.T1.2.2.1.m1.1a"><mrow id="S5.T1.2.2.1.m1.1.1" xref="S5.T1.2.2.1.m1.1.1.cmml"><mrow id="S5.T1.2.2.1.m1.1.1.2" xref="S5.T1.2.2.1.m1.1.1.2.cmml"><mn id="S5.T1.2.2.1.m1.1.1.2.2" xref="S5.T1.2.2.1.m1.1.1.2.2.cmml">50</mn><mo id="S5.T1.2.2.1.m1.1.1.2.1" xref="S5.T1.2.2.1.m1.1.1.2.1.cmml">%</mo></mrow><mo stretchy="false" id="S5.T1.2.2.1.m1.1.1.1" xref="S5.T1.2.2.1.m1.1.1.1.cmml">↓</mo><mi id="S5.T1.2.2.1.m1.1.1.3" xref="S5.T1.2.2.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.1.m1.1b"><apply id="S5.T1.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.1.m1.1.1"><ci id="S5.T1.2.2.1.m1.1.1.1.cmml" xref="S5.T1.2.2.1.m1.1.1.1">↓</ci><apply id="S5.T1.2.2.1.m1.1.1.2.cmml" xref="S5.T1.2.2.1.m1.1.1.2"><csymbol cd="latexml" id="S5.T1.2.2.1.m1.1.1.2.1.cmml" xref="S5.T1.2.2.1.m1.1.1.2.1">percent</csymbol><cn type="integer" id="S5.T1.2.2.1.m1.1.1.2.2.cmml" xref="S5.T1.2.2.1.m1.1.1.2.2">50</cn></apply><csymbol cd="latexml" id="S5.T1.2.2.1.m1.1.1.3.cmml" xref="S5.T1.2.2.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.1.m1.1c">50\%\downarrow</annotation></semantics></math>)</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.1.1" class="ltx_p ltx_align_center ltx_figure_panel ltx_align_center"><span id="S5.F5.1.1.1" class="ltx_text"><img src="/html/2106.06921/assets/x4.png" id="S5.F5.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="107" alt="Refer to caption"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.2.2" class="ltx_p ltx_align_center ltx_figure_panel ltx_align_center"><span id="S5.F5.2.2.1" class="ltx_text"><img src="/html/2106.06921/assets/x5.png" id="S5.F5.2.2.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="107" alt="Refer to caption"></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.3.3" class="ltx_p ltx_align_center ltx_figure_panel ltx_align_center"><span id="S5.F5.3.3.1" class="ltx_text"><img src="/html/2106.06921/assets/x6.png" id="S5.F5.3.3.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="107" alt="Refer to caption"></span></p>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Varieties of FedDP with SoTA: the top-1 average test accuracy vs. communication rounds.</figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.5.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.6.2" class="ltx_text ltx_font_italic">Training efficiency</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">One key issue to the federated learning poor convergence is the deployed model’s overfitting on local non-IID data. To investigate if dynamic pruning can significantly reduce the chance and contribute to FL’s training efficiency, in this section, we use SoTA FL methods and FedDP to train a deployed model to a target accuracy, and analysis their communication and computational cost. In practice, we train the deployed model to reach 78% accuracy. As Figure <a href="#S5.F4" title="Figure 4 ‣ V-B Comparison with SoTA ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates, FedDP with less probability to over-fitting can achieve the target accuracy much faster.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">Figure <a href="#S5.F4" title="Figure 4 ‣ V-B Comparison with SoTA ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the training details on VGG-11 with and without pruning on three FL algorithms: FedAvg, FedNova, and SCAFFOLD. We can see that FedDP reduces communication rounds to reach the target accuracy (<math id="S5.SS4.p2.1.m1.1" class="ltx_Math" alttext="78\%" display="inline"><semantics id="S5.SS4.p2.1.m1.1a"><mrow id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml"><mn id="S5.SS4.p2.1.m1.1.1.2" xref="S5.SS4.p2.1.m1.1.1.2.cmml">78</mn><mo id="S5.SS4.p2.1.m1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><apply id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.p2.1.m1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS4.p2.1.m1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.2">78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">78\%</annotation></semantics></math>) in all methods while having lower total communication costs.</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.1" class="ltx_p">The function for computing the cost is defined as:</p>
<table id="S5.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S5.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.Ex1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{Cost}=\text{Number of Parameters}\times\text{Rounds to reach target}" display="inline"><semantics id="S5.Ex1X.2.1.1.m1.1a"><mrow id="S5.Ex1X.2.1.1.m1.1.1" xref="S5.Ex1X.2.1.1.m1.1.1.cmml"><mtext id="S5.Ex1X.2.1.1.m1.1.1.2" xref="S5.Ex1X.2.1.1.m1.1.1.2a.cmml">Cost</mtext><mo id="S5.Ex1X.2.1.1.m1.1.1.1" xref="S5.Ex1X.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S5.Ex1X.2.1.1.m1.1.1.3" xref="S5.Ex1X.2.1.1.m1.1.1.3.cmml"><mtext id="S5.Ex1X.2.1.1.m1.1.1.3.2" xref="S5.Ex1X.2.1.1.m1.1.1.3.2a.cmml">Number of Parameters</mtext><mo lspace="0.222em" rspace="0.222em" id="S5.Ex1X.2.1.1.m1.1.1.3.1" xref="S5.Ex1X.2.1.1.m1.1.1.3.1.cmml">×</mo><mtext id="S5.Ex1X.2.1.1.m1.1.1.3.3" xref="S5.Ex1X.2.1.1.m1.1.1.3.3a.cmml">Rounds to reach target</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1X.2.1.1.m1.1b"><apply id="S5.Ex1X.2.1.1.m1.1.1.cmml" xref="S5.Ex1X.2.1.1.m1.1.1"><eq id="S5.Ex1X.2.1.1.m1.1.1.1.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.1"></eq><ci id="S5.Ex1X.2.1.1.m1.1.1.2a.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.2"><mtext id="S5.Ex1X.2.1.1.m1.1.1.2.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.2">Cost</mtext></ci><apply id="S5.Ex1X.2.1.1.m1.1.1.3.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.3"><times id="S5.Ex1X.2.1.1.m1.1.1.3.1.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.3.1"></times><ci id="S5.Ex1X.2.1.1.m1.1.1.3.2a.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.3.2"><mtext id="S5.Ex1X.2.1.1.m1.1.1.3.2.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.3.2">Number of Parameters</mtext></ci><ci id="S5.Ex1X.2.1.1.m1.1.1.3.3a.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.3.3"><mtext id="S5.Ex1X.2.1.1.m1.1.1.3.3.cmml" xref="S5.Ex1X.2.1.1.m1.1.1.3.3">Rounds to reach target</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1X.2.1.1.m1.1c">\displaystyle\text{Cost}=\text{Number of Parameters}\times\text{Rounds to reach target}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.Ex1Xa"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.Ex1Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\text{accuracy}\times\text{Number of clients}\times\text{Sample rate}" display="inline"><semantics id="S5.Ex1Xa.2.1.1.m1.1a"><mrow id="S5.Ex1Xa.2.1.1.m1.1.1" xref="S5.Ex1Xa.2.1.1.m1.1.1.cmml"><mtext id="S5.Ex1Xa.2.1.1.m1.1.1.2" xref="S5.Ex1Xa.2.1.1.m1.1.1.2a.cmml">accuracy</mtext><mo lspace="0.222em" rspace="0.222em" id="S5.Ex1Xa.2.1.1.m1.1.1.1" xref="S5.Ex1Xa.2.1.1.m1.1.1.1.cmml">×</mo><mtext id="S5.Ex1Xa.2.1.1.m1.1.1.3" xref="S5.Ex1Xa.2.1.1.m1.1.1.3a.cmml">Number of clients</mtext><mo lspace="0.222em" rspace="0.222em" id="S5.Ex1Xa.2.1.1.m1.1.1.1a" xref="S5.Ex1Xa.2.1.1.m1.1.1.1.cmml">×</mo><mtext id="S5.Ex1Xa.2.1.1.m1.1.1.4" xref="S5.Ex1Xa.2.1.1.m1.1.1.4a.cmml">Sample rate</mtext></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex1Xa.2.1.1.m1.1b"><apply id="S5.Ex1Xa.2.1.1.m1.1.1.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1"><times id="S5.Ex1Xa.2.1.1.m1.1.1.1.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.1"></times><ci id="S5.Ex1Xa.2.1.1.m1.1.1.2a.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.2"><mtext id="S5.Ex1Xa.2.1.1.m1.1.1.2.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.2">accuracy</mtext></ci><ci id="S5.Ex1Xa.2.1.1.m1.1.1.3a.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.3"><mtext id="S5.Ex1Xa.2.1.1.m1.1.1.3.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.3">Number of clients</mtext></ci><ci id="S5.Ex1Xa.2.1.1.m1.1.1.4a.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.4"><mtext id="S5.Ex1Xa.2.1.1.m1.1.1.4.cmml" xref="S5.Ex1Xa.2.1.1.m1.1.1.4">Sample rate</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex1Xa.2.1.1.m1.1c">\displaystyle\text{accuracy}\times\text{Number of clients}\times\text{Sample rate}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S5.SS4.p4" class="ltx_para">
<p id="S5.SS4.p4.1" class="ltx_p">The total communication cost when training the VGG-11 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> and ResNet-32 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite> is recorded in Figure <a href="#S5.F4" title="Figure 4 ‣ V-B Comparison with SoTA ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We have applied the FedDP to various FL methods. The results show our approach can significantly reduce the communication cost of all the FL methods. Especially, on FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, by applying the FedDP with VGG-11, 65 GB communication cost had been reduced, which is <math id="S5.SS4.p4.1.m1.1" class="ltx_math_unparsed" alttext="2\times" display="inline"><semantics id="S5.SS4.p4.1.m1.1a"><mrow id="S5.SS4.p4.1.m1.1b"><mn id="S5.SS4.p4.1.m1.1.1">2</mn><mo lspace="0.222em" id="S5.SS4.p4.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS4.p4.1.m1.1c">2\times</annotation></semantics></math> less cost than the original FedProx. Additionally, we found the FedDP achieves the best performance on the SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, where training the VGG-11 and ResNet-32 only takes 20 GB and 3 GB communication cost respectively, which is significantly superior to others.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Ablation study</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this section, we investigate the effect of dynamic pruning on federated learning algorithms. In essence, we equip dynamic pruning with the rest of FL learning algorithms: FedAvg, FedNova, and FedProx. The results are summarized in Figure <a href="#S5.F5" title="Figure 5 ‣ V-C Inference acceleration ‣ V Experiment ‣ Heterogeneous Federated Learning using Dynamic Model Pruning and Adaptive Gradient" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Across all FL methods with different numbers of clients and sample rates, each method when paired with FedDP shows strong performance. Specifically, with 10 clients settings, FedDP converges at the same accuracy as others while needing fewer rounds. Moreover, dynamic pruning can markedly improve final accuracies for all methods in the cases of 30, 50, or 100 clients (meaning more heterogeneity in local datasets). The general trend throughout experiments is that FedDP helps to achieve a target accuracy faster in the beginning and it’s converged accuracy is at least as good as the vanilla methods. This has demonstrated the applicability of FedDP over many SoTA federated learning methods.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span><span id="S7.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">In this paper, we study non-IID data as one key challenge in federated learning and develop pruning methods to customize each device’s model further. We show that with dataset-aware dynamic pruning, the quality of the model is almost always better than the original across state-of-the-art federated learning approaches. Furthermore, while dynamic pruning can adapt different pruning policies for each client’s data, our method reduces communication costs as well as FLOPs. This work is a starting point for addressing network pruning on the heterogeneity problem in federated learning. There are still many challenges left to make the idea more robust and applicable in real-life scenarios.
In future work, we want to extend dataset-aware dynamic pruning towards communication effectiveness to improve the robustness of the idea with federated learning and enable additional algorithms for faster and better converging. More extensive experiments on different datasets and models will be another direction for our method.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Artificial Intelligence
and Statistics (AISTATS)</em>, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. J. Reddi, S. U. Stich, and A. T.
Suresh, “SCAFFOLD: Stochastic controlled averaging for federated
learning,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Machine Learning
(ICML)</em>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
J. Wang, Q. Liu, H. Liang, G. Joshi, and H. V. Poor, “Tackling the objective
inconsistency problem in heterogeneous federated optimization,” in
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on Neural Information Processing Systems
(NeurIPS)</em>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Imteaj, U. Thakker, S. Wang, J. Li, and M. H. Amini, “A survey on federated
learning for resource-constrained iot devices,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of
Things Journal</em>, vol. 9, no. 1, pp. 1–24, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
D. C. Nguyen, M. Ding, P. N. Pathirana, A. Seneviratne, J. Li, and H. V. Poor,
“Federated learning for internet of things: A comprehensive survey,”
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE Communications Surveys Tutorials</em>, vol. 23, no. 3, pp.
1622–1658, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
T. Yang, G. Andrew, H. Eichner, H. Sun, W. Li, N. Kong, D. Ramage, and
F. Beaufays, “Applied federated learning: Improving Google Keyboard query
suggestions,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.02903</em>, 2018.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
M. Chen, R. Mathews, T. Ouyang, and F. Beaufays, “Federated learning of
Out-Of-Vocabulary words,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1903.10635</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
J. Freudiger, “Private federated learning,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">NeurIPS Expo Talk</em>,
2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
M. Paulik, M. Seigel, H. Mason, D. Telaar, J. Kluivers, R. van Dalen, C. W.
Lau, L. Carlson, F. Granqvist, C. Vandevelde, S. Agarwal, J. Freudiger,
A. Byde, A. Bhowmick, G. Kapoor, S. Beaumont, Áine Cahill, D. Hughes,
O. Javidbakht, F. Dong, R. Rishi, and S. Hung, “Federated evaluation and
tuning for On-Device personalization: System design &amp; applications,”
<em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.08503</em>, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
W. Li, F. Milletarì, D. Xu, N. Rieke, J. Hancox, W. Zhu, M. Baust, Y. Cheng,
S. Ourselin, M. J. Cardoso, and A. Feng, “Privacy-preserving federated brain
tumour segmentation,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proc. of MICCAI Workshop on Machine Learning
in Medical Imaging (MLMI)</em>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
W. Y. B. Lim, N. C. Luong, D. T. Hoang, Y. Jiao, Y. Liang, Q. Yang, D. Niyato,
and C. Miao, “Federated learning in mobile edge networks: A comprehensive
survey,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE Communications Surveys &amp; Tutorials</em>, vol. 22, no. 3,
pp. 2031–2063, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Konečný, H. B. McMahan, F. X. Yu, P. Richtarik, A. T. Suresh, and
D. Bacon, “Federated learning: Strategies for improving communication
efficiency,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proc. of NeurIPS Workshop on Private Multi-Party
Machine Learning</em>, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. Caldas, J. Konečný, H. B. McMahan, and A. Talwalkar, “Expanding
the reach of federated learning by reducing client resource requirements,”
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.07210</em>, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. S. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol. 37, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Y. Lecun, L. Bottou, Y. Bengio, and P. Haffner, “Gradient-based learning
applied to document recognition,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">In Proc. of the IEEE</em>, 1998.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
A. Krizhevsky and G. Hinton, “Learning multiple layers of features from tiny
images,” Master’s thesis, Department of Computer Science, University of
Toronto, 2009.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proc. of
Conference on Machine Learning and Systems (MLSys)</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings, R. G. L. D’Oliveira,
H. Eichner, S. E. Rouayheb, D. Evans, J. Gardner, Z. Garrett, A. Gascón,
B. Ghazi, P. B. Gibbons, M. Gruteser, Z. Harchaoui, C. He, L. He, Z. Huo,
B. Hutchinson, J. Hsu, M. Jaggi, T. Javidi, G. Joshi, M. Khodak,
J. Konečný, A. Korolova, F. Koushanfar, S. Koyejo, T. Lepoint,
Y. Liu, P. Mittal, M. Mohri, R. Nock, A. Özgür, R. Pagh, H. Qi,
D. Ramage, R. Raskar, M. Raykova, D. Song, W. Song, S. U. Stich, Z. Sun,
A. T. Suresh, F. Tramèr, P. Vepakomma, J. Wang, L. Xiong, Z. Xu, Q. Yang,
F. X. Yu, H. Yu, and S. Zhao, “Advances and open problems in federated
learning,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, vol. 14, no.
1–2, pp. 1–210, 2021. [Online]. Available:
<a target="_blank" href="http://dx.doi.org/10.1561/2200000083" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1561/2200000083</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
T. Nishio and R. Yonetani, “Client selection for federated learning with
heterogeneous resources in mobile edge,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. of IEEE
International Conference on Communications (ICC)</em>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with Non-IID data,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
K. Hsieh, A. Phanishayee, O. Mutlu, and P. B. Gibbons, “The Non-IID data
quagmire of decentralized machine learning,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proc. of International
Conference on Machine Learning (ICML)</em>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
X. Li, K. Huang, W. Yang, S. Wang, and Z. Zhang, “On the convergence of
FedAvg on Non-IID data,” in <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proc, of International Conference on
Learning Representations (ICML)</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
S. J. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečný,
S. Kumar, and H. B. McMahan, “Adaptive federated optimization,” in
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Learning Representations (ICLR)</em>,
2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
J. Zhang, S. Guo, Z. Qu, D. Zeng, Y. Zhan, Q. Liu, and R. A. Akerkar,
“Adaptive federated learning on Non-IID data with resource constraint,”
in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proc. of IEEE Transactions on Computers</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
M. Yang, A. Wong, H. Zhu, H. Wang, and H. Qian, “Federated learning with class
imbalance reduction,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2011.11266</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
T. Li, M. Sanjabi, A. Beirami, and V. Smith, “Fair resource allocation in
federated learning,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Learning
Representations (ICLR)</em>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
T. B. Hashimoto, M. Srivastava, H. Namkoong, and P. Liang, “Fairness without
demographics in repeated loss minimization,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proc. of International
Conference on Machine Learning (ICML)</em>, 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
M. Mohri, G. Sivek, and A. T. Suresh, “Agnostic federated learning,” in
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Machine Learning (ICML)</em>, 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
T. Li, A. Beirami, M. Sanjabi, and V. Smith, “Tilted empirical risk
minimization,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Learning
Representations (ICLR)</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
V. Smith, C.-K. Chiang, M. Sanjabi, and A. Talwalkar, “Federated multi-task
learning,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on Neural Information Processing
Systems (NeurIPS)</em>, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
F. Sattler, S. Wiedemann, K. Müller, and W. Samek, “Robust and
communication-efficient federated learning from non-iid data,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE
transactions on neural networks and learning systems</em>, vol. 31, no. 9, pp.
3400–3413, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
W. Xu, W. Fang, Y. Ding, M. Zou, and N. Xiong, “Accelerating federated
learning for IoT in big data analytics with pruning, quantization and
selective updating,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, vol. 9, pp. 38 457–38 466, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
B. Li, B. Wu, J. Su, G. Wang, and L. Lin, “EagleEye: Fast sub-net evaluation
for efficient neural network pruning,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proc. of European Conference
on Computer Vision (ECCV)</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
M. Ye, C. Gong, L. Nie, D. Zhou, A. Klivans, and Q. Liu, “Good subnetworks
provably exist: Pruning via greedy forward selection,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proc. of
International Conference on Machine Learning (ICML)</em>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
S. Yu, A. Mazaheri, and A. Jannesari, “Auto graph encoder-decoder for model
compression and network acceleration,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proc. of International
Conference on Computer Vision (ICCV)</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
——, “GNN-RL compression: Topology-aware network pruning using
multi-stage graph embedding and reinforcement learning,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2102.03214</em>, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
G. Chen, W. Choi, X. Yu, T. Han, and M. Chandraker, “Learning efficient object
detection models with knowledge distillation,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proc. of
International Conference on Neural Information Processing Systems (NeurIPS)</em>,
2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
A. Polino, R. Pascanu, and D. Alistarh, “Model compression via distillation
and quantization,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference on Learning
Representations (ICML)</em>, 2018.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
T. Chin, R. Ding, C. Zhang, and D. Marculescu, “Towards efficient model
compression via learned global ranking,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on
Computer Vision and Pattern Recognition (CVPR)</em>, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
S. Guo, Y. Wang, Q. Li, and J. Yan, “DMCP: Differentiable Markov channel
pruning for neural networks,” in <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on Computer
Vision and Pattern Recognition (CVPR)</em>, 2020.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
C. Li, G. Wang, B. Wang, X. Liang, Z. Li, and X. Chang, “Dynamic slimmable
network,” in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
X. Gao, Y. Zhao, Łukasz Dudziak, R. Mullins, and C. Xu, “Dynamic channel
pruning: Feature boosting and suppression,” in <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Proc. of International
Conference on Learning Representations (ICLR)</em>, 2019.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Y. Jiang, S. Wang, V. Valls, B. J. Ko, W. Lee, K. K. Leung, and L. Tassiulas,
“Model pruning enables efficient federated learning on edge devices,” in
<em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proc. of International Workshop on Scalability, Privacy, and Security
in Federated Learning (SpicyFL)</em>, 2020.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Z. Xu, F. Yu, J. Xiong, and X. Chen, “Helios: Heterogeneity-aware federated
learning with dynamically balanced collaboration,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proc. of Design
Automation Conference</em>, 2021.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
P. Han, S. Wang, and K. K. Leung, “Adaptive gradient sparsification for
efficient federated learning: An online learning approach,” in <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Proc.
of IEEE International Conference on Distributed Computing Systems (ICDCS)</em>,
2020.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
S. Caldas, S. M. K. Duddu, P. Wu, T. Li, J. Konečnỳ, H. B. McMahan,
V. Smith, and A. Talwalkar, “LEAF: A benchmark for federated settings,”
in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on Neural Information Processing Systems
(NeurIPS)</em>, 2019.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
G. Cohen, S. Afshar, J. Tapson, and A. van Schaik, “EMNIST: an extension of
MNIST to handwritten letters,” <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1702.05373</em>,
2017.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Q. Li, Y. Diao, Q. Chen, and B. He, “Federated learning on non-iid data silos:
An experimental study,” <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.02079</em>, 2021.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
K. Simonyan and A. Zisserman, “Very deep convolutional networks for
large-scale image recognition,” in <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Proc. of International Conference
on Learning Representations (ICLR)</em>, 2015.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Proc. of Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, 2016.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Q. Li, Y. Diao, Q. Chen, and B. He, “Federated learning on non-iid data silos:
An experimental study,” in <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Data
Engineering (ICDE)</em>, 2022.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2106.06920" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2106.06921" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2106.06921">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2106.06921" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2106.06922" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 11:51:07 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
