<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2407.19410] AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering</title><meta property="og:description" content="Visual question answering aims to provide responses to natural language questions given visual input.
Recently, visual programmatic models (VPMs), which generate executable programs to answer questions through large laâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2407.19410">

<!--Generated on Mon Aug  5 13:45:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Visual programmatic models,  Visual question answering,  Prompt compression,  Large language models.">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mahiro Ukai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">Tokyo Institute of Technology</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_country">Tokyo, Japan</span>
</span></span></span>
<span class="ltx_author_before">,Â </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shuhei Kurita
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_affiliation_institution">National Institute of Informatics</span><span id="id4.2.id2" class="ltx_text ltx_affiliation_country">Tokyo, Japan</span>
</span></span></span>
<span class="ltx_author_before">,Â </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Atsushi Hashimoto
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_affiliation_institution">OMRON SINIC X Corporation</span><span id="id6.2.id2" class="ltx_text ltx_affiliation_country">Tokyo, Japan</span>
</span></span></span>
<span class="ltx_author_before">,Â </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yoshitaka Ushiku
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id7.1.id1" class="ltx_text ltx_affiliation_institution">OMRON SINIC X Corporation</span><span id="id8.2.id2" class="ltx_text ltx_affiliation_country">Tokyo, Japan</span>
</span></span></span>
<span class="ltx_author_before">Â andÂ </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Nakamasa Inoue
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id9.1.id1" class="ltx_text ltx_affiliation_institution">Tokyo Institute of Technology</span><span id="id10.2.id2" class="ltx_text ltx_affiliation_country">Tokyo, Japan</span>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id11.id1" class="ltx_p">Visual question answering aims to provide responses to natural language questions given visual input.
Recently, visual programmatic models (VPMs), which generate executable programs to answer questions through large language models (LLMs), have attracted research interest.
However, they often require long input prompts to provide the LLM with sufficient API usage details to generate relevant code. To address this limitation, we propose AdaCoder, an adaptive prompt compression framework for VPMs.
AdaCoder operates in two phases: a compression phase and an inference phase.
In the compression phase, given a preprompt that describes all API definitions in the Python language with example snippets of code, a set of compressed preprompts is generated, each depending on a specific question type.
In the inference phase, given an input question, AdaCoder predicts the question type and chooses the appropriate corresponding compressed preprompt to generate code to answer the question.
Notably, AdaCoder employs a single frozen LLM and pre-defined prompts, negating the necessity of additional training and maintaining adaptability across different powerful black-box LLMs such as GPT and Claude.
In experiments, we apply AdaCoder to ViperGPT and demonstrate that it reduces token length by 71.1%, while maintaining or even improving the performance of visual question answering.</p>
</div>
<div class="ltx_keywords">Visual programmatic models, Visual question answering, Prompt compression, Large language models.
</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2407.19410/assets/x1.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="453" height="481" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Inference procedure of AdaCoder. Given an input question, an adaptive programming instruction <math id="S0.F1.2.m1.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize pre}}" display="inline"><semantics id="S0.F1.2.m1.1b"><msub id="S0.F1.2.m1.1.1" xref="S0.F1.2.m1.1.1.cmml"><mover accent="true" id="S0.F1.2.m1.1.1.2" xref="S0.F1.2.m1.1.1.2.cmml"><mi id="S0.F1.2.m1.1.1.2.2" xref="S0.F1.2.m1.1.1.2.2.cmml">p</mi><mo id="S0.F1.2.m1.1.1.2.1" xref="S0.F1.2.m1.1.1.2.1.cmml">^</mo></mover><mtext id="S0.F1.2.m1.1.1.3" xref="S0.F1.2.m1.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S0.F1.2.m1.1c"><apply id="S0.F1.2.m1.1.1.cmml" xref="S0.F1.2.m1.1.1"><csymbol cd="ambiguous" id="S0.F1.2.m1.1.1.1.cmml" xref="S0.F1.2.m1.1.1">subscript</csymbol><apply id="S0.F1.2.m1.1.1.2.cmml" xref="S0.F1.2.m1.1.1.2"><ci id="S0.F1.2.m1.1.1.2.1.cmml" xref="S0.F1.2.m1.1.1.2.1">^</ci><ci id="S0.F1.2.m1.1.1.2.2.cmml" xref="S0.F1.2.m1.1.1.2.2">ğ‘</ci></apply><ci id="S0.F1.2.m1.1.1.3a.cmml" xref="S0.F1.2.m1.1.1.3"><mtext mathsize="70%" id="S0.F1.2.m1.1.1.3.cmml" xref="S0.F1.2.m1.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S0.F1.2.m1.1d">\hat{p}_{\text{\scriptsize pre}}</annotation></semantics></math> for the specific question type is used to generate a Python program for visual question answering.</figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual question answering (VQA), which aims to automatically provide answers to questions related to visual content, is a challenging research topic in the fields of multimedia analysis, computer vision, and natural language processingÂ <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2023b</a>; Yang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2022</a>; Antol etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2015</a>; Goyal etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2017</a>; Suhr etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>; Hudson and Manning, <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>.
Thanks to the advantages of deep learning techniques, significant progress has been made in VQA over the past decade with end-to-end learning models such as GLIPÂ <cite class="ltx_cite ltx_citemacro_citep">(Li etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2022b</a>)</cite>.
However, these models do not explicitly distinguish between visual processing and reasoning, which limits their generalizability and interpretability.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To overcome this limitation, several pioneering studies have introduced visual programmatic models (VPMs), models that generate executable programs specifically designed to answer questions, providing a more manageable and transparent inference processÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>; Gupta and Kembhavi, <a href="#bib.bib16" title="" class="ltx_ref">2022</a>; Subramanian etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2023</a>; Shen etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2024</a>; Hu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2024</a>; Ge etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2024</a>)</cite>.
VPMs typically consist of a large language model (LLM) for code generation and a set of APIs for image processing. Given an input question, the LLM analyzes the text to understand the intent and the required computational steps. It then generates a program that, when executed, can manipulate and analyze images by using APIs to produce the desired answer, where the APIs include both low-level modules (<span id="S1.p2.1.1" class="ltx_text ltx_font_italic">e.g.</span>, image cropping) and high-level modules (<span id="S1.p2.1.2" class="ltx_text ltx_font_italic">e.g.</span>, object detection). VPMs have proven effective and are gaining traction; however, they also face challenges in terms of computational complexity, as long prompts are required to enable the LLM to understand API usage for generating appropriate programs.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To reduce computational costs, the development of efficient neural network architectures has been extensively studied. However, these approaches require retraining or additional learning, which is not feasible for application to LLMs trained with huge data, such as GPT and Claude, which we refer to as black-box LLMs. Recently, research has begun to focus on prompt compressionÂ <cite class="ltx_cite ltx_citemacro_citep">(Mu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>; Jiang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>; Chevalier etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2023</a>)</cite>, which involves optimizing input prompts to achieve high performance with shorter inputs. For example, LLMLinguaÂ <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>; Pan etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2024</a>)</cite> compresses prompts using smaller models before using black-box LLMs.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Inspired by these studies, we introduce AdaCoder, a framework of adaptive prompt compression for VPMs. More specifically, AdaCoder operates in two phases: a compression phase and an inference phase.
The compression phase generates a set of compressed preprompts, each depending on a specific question type, given a preprompt that describes all API definitions in the Python language with example snippets of code.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The inference phase adaptively selects a compressed prompt by classifying the question type and generates a Python program to answer the input question, as shown in FigureÂ <a href="#S0.F1" title="Figure 1 â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Notably, we implement all of the modules of AdaCoder with a single frozen LLM, which allows implementation with black-box LLMs.
Our contributions are summarized as follows:</p>
</div>
<div id="S1.p6" class="ltx_para">
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1)</span> 
<div id="S1.I1.ix1.p1" class="ltx_para">
<p id="S1.I1.ix1.p1.1" class="ltx_p">We propose AdaCoder, a novel prompt compression framework for VPMs. It adaptively selects a short instruction for code generation based on question type.</p>
</div>
</li>
<li id="S1.I1.ix2" class="ltx_item" style="list-style-type:none;padding-top:2.0pt;">
<span class="ltx_tag ltx_tag_item">2)</span> 
<div id="S1.I1.ix2.p1" class="ltx_para">
<p id="S1.I1.ix2.p1.1" class="ltx_p">We define and formulate all procedures of AdaCoder with a single frozen LLM. This avoids additional training and enables implementation with black-box LLMs.</p>
</div>
</li>
<li id="S1.I1.ix3" class="ltx_item" style="list-style-type:none;padding-top:2.0pt;">
<span class="ltx_tag ltx_tag_item">3)</span> 
<div id="S1.I1.ix3.p1" class="ltx_para">
<p id="S1.I1.ix3.p1.1" class="ltx_p">We demonstrate the effectiveness of AdaCoder over the state-of-the-art ViperGPTÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite> model on three VQA datasets with GPT and Claude.
We show that the token length of input prompts is reduced by 71.1%, while maintaining or even improving question answering performance. We also show that AdaCoder outperforms LLMLinguaÂ <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> in our evaluations.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Visual question answering</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p"><span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_bold">End-to-end models.</span>
In the early phase of VQA research history, a number of neural network architectures designed to process multimodal inputs were introduced. These include a combination of a convolutional neural network (CNN) for visual feature extraction and a recurrent neural network (RNN) for textual feature extractionÂ <cite class="ltx_cite ltx_citemacro_citep">(Malinowski etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2015</a>; Huang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2021</a>; Zhang and Wu, <a href="#bib.bib48" title="" class="ltx_ref">2022</a>)</cite>. Recent models often include attention modules to enhance individual feature extraction for each modality and to combine features of multiple modalities effectivelyÂ <cite class="ltx_cite ltx_citemacro_citep">(Yang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib44" title="" class="ltx_ref">2016</a>; Anderson etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Sarkar and Rahnemoonfar, <a href="#bib.bib33" title="" class="ltx_ref">2022</a>; Wu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2022</a>)</cite>.
Large-scale pre-training has become a critical component in improving the performance of these models, enabling them to answer complex questions by implicitly associating words with specific regions in imagesÂ <cite class="ltx_cite ltx_citemacro_citep">(Li etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2021</a>; Le etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2021</a>; Li etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2022b</a>)</cite>.
More recently, LLMs have been incorporated into VQA frameworks with prompt tuning techniques such as self-prompt tuningÂ <cite class="ltx_cite ltx_citemacro_citep">(Yuan etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite>.
However, these models do not explicitly distinguish between visual
processing and reasoning, limiting their interpretability.
Some recent studies have focused on techniques to improve interpretability such as causal inferenceÂ <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2023a</a>)</cite>, reasoning pathÂ <cite class="ltx_cite ltx_citemacro_citep">(Li etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2022a</a>)</cite>, reasoning promptsÂ <cite class="ltx_cite ltx_citemacro_citep">(Lan etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2023</a>)</cite> and gradient-based explainability methodÂ <cite class="ltx_cite ltx_citemacro_citep">(Wang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_bold">Visual programmatic models.</span>
To improve interpretability and generalizability, VPMs that generate programs to answer questions based on visual input have been gaining research attention. This is a novel approach that leads to more manageable and traceable inferences because the generated programs contain logical sequences that are understandable to humans and articulate a step-by-step methodology for reaching conclusions.
Examples of VPMs include ViperGPTÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>, VisProgÂ <cite class="ltx_cite ltx_citemacro_citep">(Gupta and Kembhavi, <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>, and CodeVQAÂ <cite class="ltx_cite ltx_citemacro_citep">(Roziere etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>.
All of these generate Python programs utilizing image processing APIs, such as object detection, through a frozen LLM. However, generating programs to answer complex and compositional questions requires many APIs and example codes for them. As a result, the length of the input prompt becomes long. To the best of our knowledge, this work is the first to propose adaptive prompt compression for VPMs.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2407.19410/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="128" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>AdaCoder framework. (a) Compression phase generates a set of compressed prompts <math id="S2.F2.8.m1.1" class="ltx_Math" alttext="\mathcal{C}" display="inline"><semantics id="S2.F2.8.m1.1b"><mi class="ltx_font_mathcaligraphic" id="S2.F2.8.m1.1.1" xref="S2.F2.8.m1.1.1.cmml">ğ’</mi><annotation-xml encoding="MathML-Content" id="S2.F2.8.m1.1c"><ci id="S2.F2.8.m1.1.1.cmml" xref="S2.F2.8.m1.1.1">ğ’</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.m1.1d">\mathcal{C}</annotation></semantics></math> by utilizing an LLM <math id="S2.F2.9.m2.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S2.F2.9.m2.1b"><mi id="S2.F2.9.m2.1.1" xref="S2.F2.9.m2.1.1.cmml">Ï€</mi><annotation-xml encoding="MathML-Content" id="S2.F2.9.m2.1c"><ci id="S2.F2.9.m2.1.1.cmml" xref="S2.F2.9.m2.1.1">ğœ‹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.m2.1d">\pi</annotation></semantics></math> with two instructions <math id="S2.F2.10.m3.1" class="ltx_Math" alttext="r_{\text{\scriptsize pre}}" display="inline"><semantics id="S2.F2.10.m3.1b"><msub id="S2.F2.10.m3.1.1" xref="S2.F2.10.m3.1.1.cmml"><mi id="S2.F2.10.m3.1.1.2" xref="S2.F2.10.m3.1.1.2.cmml">r</mi><mtext id="S2.F2.10.m3.1.1.3" xref="S2.F2.10.m3.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.10.m3.1c"><apply id="S2.F2.10.m3.1.1.cmml" xref="S2.F2.10.m3.1.1"><csymbol cd="ambiguous" id="S2.F2.10.m3.1.1.1.cmml" xref="S2.F2.10.m3.1.1">subscript</csymbol><ci id="S2.F2.10.m3.1.1.2.cmml" xref="S2.F2.10.m3.1.1.2">ğ‘Ÿ</ci><ci id="S2.F2.10.m3.1.1.3a.cmml" xref="S2.F2.10.m3.1.1.3"><mtext mathsize="70%" id="S2.F2.10.m3.1.1.3.cmml" xref="S2.F2.10.m3.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.10.m3.1d">r_{\text{\scriptsize pre}}</annotation></semantics></math> for rewriting API definitions and <math id="S2.F2.11.m4.1" class="ltx_Math" alttext="r_{\text{\scriptsize code}}+r_{\text{\scriptsize sp}}" display="inline"><semantics id="S2.F2.11.m4.1b"><mrow id="S2.F2.11.m4.1.1" xref="S2.F2.11.m4.1.1.cmml"><msub id="S2.F2.11.m4.1.1.2" xref="S2.F2.11.m4.1.1.2.cmml"><mi id="S2.F2.11.m4.1.1.2.2" xref="S2.F2.11.m4.1.1.2.2.cmml">r</mi><mtext id="S2.F2.11.m4.1.1.2.3" xref="S2.F2.11.m4.1.1.2.3a.cmml">code</mtext></msub><mo id="S2.F2.11.m4.1.1.1" xref="S2.F2.11.m4.1.1.1.cmml">+</mo><msub id="S2.F2.11.m4.1.1.3" xref="S2.F2.11.m4.1.1.3.cmml"><mi id="S2.F2.11.m4.1.1.3.2" xref="S2.F2.11.m4.1.1.3.2.cmml">r</mi><mtext id="S2.F2.11.m4.1.1.3.3" xref="S2.F2.11.m4.1.1.3.3a.cmml">sp</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.11.m4.1c"><apply id="S2.F2.11.m4.1.1.cmml" xref="S2.F2.11.m4.1.1"><plus id="S2.F2.11.m4.1.1.1.cmml" xref="S2.F2.11.m4.1.1.1"></plus><apply id="S2.F2.11.m4.1.1.2.cmml" xref="S2.F2.11.m4.1.1.2"><csymbol cd="ambiguous" id="S2.F2.11.m4.1.1.2.1.cmml" xref="S2.F2.11.m4.1.1.2">subscript</csymbol><ci id="S2.F2.11.m4.1.1.2.2.cmml" xref="S2.F2.11.m4.1.1.2.2">ğ‘Ÿ</ci><ci id="S2.F2.11.m4.1.1.2.3a.cmml" xref="S2.F2.11.m4.1.1.2.3"><mtext mathsize="70%" id="S2.F2.11.m4.1.1.2.3.cmml" xref="S2.F2.11.m4.1.1.2.3">code</mtext></ci></apply><apply id="S2.F2.11.m4.1.1.3.cmml" xref="S2.F2.11.m4.1.1.3"><csymbol cd="ambiguous" id="S2.F2.11.m4.1.1.3.1.cmml" xref="S2.F2.11.m4.1.1.3">subscript</csymbol><ci id="S2.F2.11.m4.1.1.3.2.cmml" xref="S2.F2.11.m4.1.1.3.2">ğ‘Ÿ</ci><ci id="S2.F2.11.m4.1.1.3.3a.cmml" xref="S2.F2.11.m4.1.1.3.3"><mtext mathsize="70%" id="S2.F2.11.m4.1.1.3.3.cmml" xref="S2.F2.11.m4.1.1.3.3">sp</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.11.m4.1d">r_{\text{\scriptsize code}}+r_{\text{\scriptsize sp}}</annotation></semantics></math> for writing snippets of code specialized for each question type <math id="S2.F2.12.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.F2.12.m5.1b"><mi id="S2.F2.12.m5.1.1" xref="S2.F2.12.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.F2.12.m5.1c"><ci id="S2.F2.12.m5.1.1.cmml" xref="S2.F2.12.m5.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.12.m5.1d">t</annotation></semantics></math>.
(b) Inference phase adaptively selects code snippets to create compressed preprompt <math id="S2.F2.13.m6.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize pre}}" display="inline"><semantics id="S2.F2.13.m6.1b"><msub id="S2.F2.13.m6.1.1" xref="S2.F2.13.m6.1.1.cmml"><mover accent="true" id="S2.F2.13.m6.1.1.2" xref="S2.F2.13.m6.1.1.2.cmml"><mi id="S2.F2.13.m6.1.1.2.2" xref="S2.F2.13.m6.1.1.2.2.cmml">p</mi><mo id="S2.F2.13.m6.1.1.2.1" xref="S2.F2.13.m6.1.1.2.1.cmml">^</mo></mover><mtext id="S2.F2.13.m6.1.1.3" xref="S2.F2.13.m6.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.F2.13.m6.1c"><apply id="S2.F2.13.m6.1.1.cmml" xref="S2.F2.13.m6.1.1"><csymbol cd="ambiguous" id="S2.F2.13.m6.1.1.1.cmml" xref="S2.F2.13.m6.1.1">subscript</csymbol><apply id="S2.F2.13.m6.1.1.2.cmml" xref="S2.F2.13.m6.1.1.2"><ci id="S2.F2.13.m6.1.1.2.1.cmml" xref="S2.F2.13.m6.1.1.2.1">^</ci><ci id="S2.F2.13.m6.1.1.2.2.cmml" xref="S2.F2.13.m6.1.1.2.2">ğ‘</ci></apply><ci id="S2.F2.13.m6.1.1.3a.cmml" xref="S2.F2.13.m6.1.1.3"><mtext mathsize="70%" id="S2.F2.13.m6.1.1.3.cmml" xref="S2.F2.13.m6.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.13.m6.1d">\hat{p}_{\text{\scriptsize pre}}</annotation></semantics></math> for generating a Python code <math id="S2.F2.14.m7.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S2.F2.14.m7.1b"><mi id="S2.F2.14.m7.1.1" xref="S2.F2.14.m7.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S2.F2.14.m7.1c"><ci id="S2.F2.14.m7.1.1.cmml" xref="S2.F2.14.m7.1.1">ğ‘§</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.14.m7.1d">z</annotation></semantics></math> for visual question answering.</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Large language models</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p"><span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_bold">Code generation.</span>
Extensive research and development in the field of natural language processing (NLP) has led to the creation of LLMs that excel at a variety of NLP tasks. Among these, a distinct group of LLMs is specifically designed for programming code generation, having been trained on large amounts of programs and documents related to programming.
For example, CodexÂ <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>, a variant of the GPT-3 lineup, demonstrates its proficiency in multiple programming languages. CodeLlamaÂ <cite class="ltx_cite ltx_citemacro_citep">(Roziere etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>, which is built on Llama2Â <cite class="ltx_cite ltx_citemacro_citep">(Touvron etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2023</a>)</cite> and has an expanded code dataset, shows improved performance in handling larger contexts in programming.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Most recently, black-box LLMs such as GPT-3.5/4Â <cite class="ltx_cite ltx_citemacro_citep">(Brown etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>, Claude<cite class="ltx_cite ltx_citemacro_citep">(Anthropic Claude AIP., <a href="#bib.bib3" title="" class="ltx_ref">2023</a>)</cite> and GeminiÂ <cite class="ltx_cite ltx_citemacro_citep">(Team etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite> integrate extensive knowledge from a broad spectrum of domains, including programming, allowing them not only to generate code but also to understand and execute complex instructions given by humans.
Since their zero-shot performance on programming tasks is remarkably high, they are expected to automate many aspects of coding in future that were previously manual and time-consuming, and are also useful for integration into VPMs for visual question answering.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_bold">Reasoning and interpretability.</span>
Interpretability is an important consideration when integrating LLMs into real-world systems, especially in contexts that require high reliability and accountability. Various prompting techniques have significantly improved the interpretability of LLMs. For example, chain-of-thought promptingÂ <cite class="ltx_cite ltx_citemacro_citep">(Jin and Lu, <a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite>, which provides an LLM with a series of contextual examples, enables intermediate reasoning to reach final conclusions.
Tree-of-thought promptingÂ <cite class="ltx_cite ltx_citemacro_citep">(Yao etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite> constructs a tree structure of thoughts, enriching the decision-making process by branching out various reasoning pathways.
VPMs can also be viewed as an extended prompting method that improves interpretability because they show a sequence of logical steps leading to a conclusion by understandable programs.
However, these methods also increase the complexity of input prompts because the instructions for LLMs need to be detailed, thus increasing computational costs.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p"><span id="S2.SS2.p4.1.1" class="ltx_text ltx_font_bold">Prompt compression.</span> Several strategies have been developed to compress prompts, notably by creating specialized tokens through prompt-based fine-tuning of LLMsÂ <cite class="ltx_cite ltx_citemacro_citep">(Mu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib30" title="" class="ltx_ref">2023</a>; Chevalier etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2023</a>; Wingate etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2022</a>; Ge etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite>, with the goal of minimizing the number of tokens processed during inference. However, fine-tuning of LLMs often limits their generalizability and is not always applicable to black-box LLMs.
Other efforts have focused on token reduction.
These include token pruning during inferenceÂ <cite class="ltx_cite ltx_citemacro_citep">(Goyal etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Kim and Cho, <a href="#bib.bib22" title="" class="ltx_ref">2021</a>; Kim etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> and token merging Â <cite class="ltx_cite ltx_citemacro_citep">(Bolya etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite>.
However, these methods are generally proposed for small models such as BERT and ViT, and rely on fine-tuning or intermediate inference results.
Most recently, Jiang <span id="S2.SS2.p4.1.2" class="ltx_text ltx_font_italic">et al.</span>Â <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> have introduced LLMLingua, which compresses prompts with a small model and feeds the compressed prompts to an LLM.
This method can be applied to black-box LLMs because it does not require comprehensive fine-tuning of LLMs.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p">In contrast to these previous studies, this work aims to define and formulate all procedures of prompt compression and inference for code generation with a single frozen LLM to fully leverage the advantages of powerful black-box LLMs.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>AdaCoder framework</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">This section introduces AdaCoder, a framework for adaptive prompt compression for VPMs.
FigureÂ <a href="#S2.F2" title="Figure 2 â€£ 2.1. Visual question answering â€£ 2. Related work â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows an overview of the AdaCoder framework, which consists of two phases: the compression phase and the inference phase.
The compression phase is run only once to prepare compressed prompts, each of which is specialized for a specific question type.
The inference phase classifies question type and adaptively selects a compressed preprompt to generate code for visual question answering.
Below, we begin with a preliminary formulation of a VPM. We then present each phase of AdaCoder.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Preliminary</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.8" class="ltx_p"><span id="S3.SS1.p1.8.1" class="ltx_text ltx_font_bold">Notation and settings.</span>
We follow the notation used in previous work on VPMsÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>; Subramanian etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite>.
Let <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="x\in X" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">ğ‘¥</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">ğ‘‹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x\in X</annotation></semantics></math> be an input image and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="q\in Q" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">q</mi><mo id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><in id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"></in><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">ğ‘</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">ğ‘„</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">q\in Q</annotation></semantics></math> be an input question about the image, where <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">ğ‘‹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">X</annotation></semantics></math> is a set of images and <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">ğ‘„</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">Q</annotation></semantics></math> is a set of questions.
VPMs aim to generate a code <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="z\in Z" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">z</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">ğ‘§</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">z\in Z</annotation></semantics></math> that returns the answer <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="a\in A" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">a</mi><mo id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"></in><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">ğ‘</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">ğ´</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">a\in A</annotation></semantics></math> to the question, where <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">Z</annotation></semantics></math> is a set of executable codes and <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">ğ´</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">A</annotation></semantics></math> is a set of answers.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.4" class="ltx_p">The process of answering questions is divided into two steps: the code generation step and the execution step.
The former generates a code as</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\displaystyle z=\Pi(q)," display="inline"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml">z</mi><mo id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml"><mi mathvariant="normal" id="S3.E1.m1.2.2.1.1.3.2" xref="S3.E1.m1.2.2.1.1.3.2.cmml">Î </mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.3.1" xref="S3.E1.m1.2.2.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E1.m1.2.2.1.1.3.3.2" xref="S3.E1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3.3.2.1" xref="S3.E1.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3.3.2.2" xref="S3.E1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"></eq><ci id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2">ğ‘§</ci><apply id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"><times id="S3.E1.m1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.3.1"></times><ci id="S3.E1.m1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.3.2">Î </ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\displaystyle z=\Pi(q),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.1" class="ltx_p">where <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\Pi:Q\to Z" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">Î </mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">Q</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">â†’</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">Z</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><ci id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1">:</ci><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">Î </ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><ci id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1">â†’</ci><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ğ‘„</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\Pi:Q\to Z</annotation></semantics></math> is a code generation module. The latter executes the code with an input image by</p>
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\displaystyle a=\Lambda(x,z)," display="inline"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml">a</mi><mo id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">Î›</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.1" xref="S3.E2.m1.3.3.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E2.m1.3.3.1.1.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.3.2.1" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">x</mi><mo id="S3.E2.m1.3.3.1.1.3.3.2.2" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">z</mi><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.3.2.3" xref="S3.E2.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"></eq><ci id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2">ğ‘</ci><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2">Î›</ci><interval closure="open" id="S3.E2.m1.3.3.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">ğ‘¥</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">ğ‘§</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\displaystyle a=\Lambda(x,z),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.3" class="ltx_p">where <math id="S3.SS1.p2.2.m1.1" class="ltx_Math" alttext="\Lambda:X\times Z\to A" display="inline"><semantics id="S3.SS1.p2.2.m1.1a"><mrow id="S3.SS1.p2.2.m1.1.1" xref="S3.SS1.p2.2.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS1.p2.2.m1.1.1.2" xref="S3.SS1.p2.2.m1.1.1.2.cmml">Î›</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.2.m1.1.1.1" xref="S3.SS1.p2.2.m1.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.2.m1.1.1.3" xref="S3.SS1.p2.2.m1.1.1.3.cmml"><mrow id="S3.SS1.p2.2.m1.1.1.3.2" xref="S3.SS1.p2.2.m1.1.1.3.2.cmml"><mi id="S3.SS1.p2.2.m1.1.1.3.2.2" xref="S3.SS1.p2.2.m1.1.1.3.2.2.cmml">X</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.2.m1.1.1.3.2.1" xref="S3.SS1.p2.2.m1.1.1.3.2.1.cmml">Ã—</mo><mi id="S3.SS1.p2.2.m1.1.1.3.2.3" xref="S3.SS1.p2.2.m1.1.1.3.2.3.cmml">Z</mi></mrow><mo stretchy="false" id="S3.SS1.p2.2.m1.1.1.3.1" xref="S3.SS1.p2.2.m1.1.1.3.1.cmml">â†’</mo><mi id="S3.SS1.p2.2.m1.1.1.3.3" xref="S3.SS1.p2.2.m1.1.1.3.3.cmml">A</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m1.1b"><apply id="S3.SS1.p2.2.m1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1"><ci id="S3.SS1.p2.2.m1.1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1.1">:</ci><ci id="S3.SS1.p2.2.m1.1.1.2.cmml" xref="S3.SS1.p2.2.m1.1.1.2">Î›</ci><apply id="S3.SS1.p2.2.m1.1.1.3.cmml" xref="S3.SS1.p2.2.m1.1.1.3"><ci id="S3.SS1.p2.2.m1.1.1.3.1.cmml" xref="S3.SS1.p2.2.m1.1.1.3.1">â†’</ci><apply id="S3.SS1.p2.2.m1.1.1.3.2.cmml" xref="S3.SS1.p2.2.m1.1.1.3.2"><times id="S3.SS1.p2.2.m1.1.1.3.2.1.cmml" xref="S3.SS1.p2.2.m1.1.1.3.2.1"></times><ci id="S3.SS1.p2.2.m1.1.1.3.2.2.cmml" xref="S3.SS1.p2.2.m1.1.1.3.2.2">ğ‘‹</ci><ci id="S3.SS1.p2.2.m1.1.1.3.2.3.cmml" xref="S3.SS1.p2.2.m1.1.1.3.2.3">ğ‘</ci></apply><ci id="S3.SS1.p2.2.m1.1.1.3.3.cmml" xref="S3.SS1.p2.2.m1.1.1.3.3">ğ´</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m1.1c">\Lambda:X\times Z\to A</annotation></semantics></math> is the execution engine. This work utilizes the Python execution engine for <math id="S3.SS1.p2.3.m2.1" class="ltx_Math" alttext="\Lambda" display="inline"><semantics id="S3.SS1.p2.3.m2.1a"><mi mathvariant="normal" id="S3.SS1.p2.3.m2.1.1" xref="S3.SS1.p2.3.m2.1.1.cmml">Î›</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m2.1b"><ci id="S3.SS1.p2.3.m2.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1">Î›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m2.1c">\Lambda</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.3" class="ltx_p"><span id="S3.SS1.p3.3.1" class="ltx_text ltx_font_bold">Large language model.</span>
To implement the code generation module, a single frozen LLM <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="\pi:T\to T" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">Ï€</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">T</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.3.1" xref="S3.SS1.p3.1.m1.1.1.3.1.cmml">â†’</mo><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><ci id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1">:</ci><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">ğœ‹</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><ci id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3.1">â†’</ci><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">ğ‘‡</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">ğ‘‡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\pi:T\to T</annotation></semantics></math> is often used, where <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">T</annotation></semantics></math> is a set of texts<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>This work assumes that questions, answers, and codes are in text form, <span id="footnote1.1" class="ltx_text ltx_font_italic">i.e.</span>, <math id="footnote1.m1.2" class="ltx_Math" alttext="Q,A" display="inline"><semantics id="footnote1.m1.2b"><mrow id="footnote1.m1.2.3.2" xref="footnote1.m1.2.3.1.cmml"><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">Q</mi><mo id="footnote1.m1.2.3.2.1" xref="footnote1.m1.2.3.1.cmml">,</mo><mi id="footnote1.m1.2.2" xref="footnote1.m1.2.2.cmml">A</mi></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.2c"><list id="footnote1.m1.2.3.1.cmml" xref="footnote1.m1.2.3.2"><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">ğ‘„</ci><ci id="footnote1.m1.2.2.cmml" xref="footnote1.m1.2.2">ğ´</ci></list></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.2d">Q,A</annotation></semantics></math>, and <math id="footnote1.m2.1" class="ltx_Math" alttext="Z" display="inline"><semantics id="footnote1.m2.1b"><mi id="footnote1.m2.1.1" xref="footnote1.m2.1.1.cmml">Z</mi><annotation-xml encoding="MathML-Content" id="footnote1.m2.1c"><ci id="footnote1.m2.1.1.cmml" xref="footnote1.m2.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m2.1d">Z</annotation></semantics></math> are subsets of <math id="footnote1.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="footnote1.m3.1b"><mi id="footnote1.m3.1.1" xref="footnote1.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="footnote1.m3.1c"><ci id="footnote1.m3.1.1.cmml" xref="footnote1.m3.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m3.1d">T</annotation></semantics></math>.</span></span></span>.
For example, the code generation module <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\Pi" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi mathvariant="normal" id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">Î </mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">Î </ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\Pi</annotation></semantics></math> can be definedÂ by</p>
<table id="Sx1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\displaystyle\Pi(q)=\pi(p_{\text{\scriptsize pre}}+q)," display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.2.2.1.1.3.2" xref="S3.E3.m1.2.2.1.1.3.2.cmml">Î </mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.3.1" xref="S3.E3.m1.2.2.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E3.m1.2.2.1.1.3.3.2" xref="S3.E3.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.3.2.1" xref="S3.E3.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">q</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.1.3.3.2.2" xref="S3.E3.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.2.2.1.1.2" xref="S3.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3a.cmml">pre</mtext></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E3.m1.2.2.1.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.2"></eq><apply id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"><times id="S3.E3.m1.2.2.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.3.1"></times><ci id="S3.E3.m1.2.2.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.3.2">Î </ci><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">ğ‘</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2"></times><ci id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3">ğœ‹</ci><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><plus id="S3.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.2">ğ‘</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3a.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E3.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.2.3">pre</mtext></ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle\Pi(q)=\pi(p_{\text{\scriptsize pre}}+q),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.6" class="ltx_p">where <math id="S3.SS1.p3.4.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize pre}}\in T" display="inline"><semantics id="S3.SS1.p3.4.m1.1a"><mrow id="S3.SS1.p3.4.m1.1.1" xref="S3.SS1.p3.4.m1.1.1.cmml"><msub id="S3.SS1.p3.4.m1.1.1.2" xref="S3.SS1.p3.4.m1.1.1.2.cmml"><mi id="S3.SS1.p3.4.m1.1.1.2.2" xref="S3.SS1.p3.4.m1.1.1.2.2.cmml">p</mi><mtext id="S3.SS1.p3.4.m1.1.1.2.3" xref="S3.SS1.p3.4.m1.1.1.2.3a.cmml">pre</mtext></msub><mo id="S3.SS1.p3.4.m1.1.1.1" xref="S3.SS1.p3.4.m1.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p3.4.m1.1.1.3" xref="S3.SS1.p3.4.m1.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m1.1b"><apply id="S3.SS1.p3.4.m1.1.1.cmml" xref="S3.SS1.p3.4.m1.1.1"><in id="S3.SS1.p3.4.m1.1.1.1.cmml" xref="S3.SS1.p3.4.m1.1.1.1"></in><apply id="S3.SS1.p3.4.m1.1.1.2.cmml" xref="S3.SS1.p3.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m1.1.1.2.1.cmml" xref="S3.SS1.p3.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.4.m1.1.1.2.2.cmml" xref="S3.SS1.p3.4.m1.1.1.2.2">ğ‘</ci><ci id="S3.SS1.p3.4.m1.1.1.2.3a.cmml" xref="S3.SS1.p3.4.m1.1.1.2.3"><mtext mathsize="70%" id="S3.SS1.p3.4.m1.1.1.2.3.cmml" xref="S3.SS1.p3.4.m1.1.1.2.3">pre</mtext></ci></apply><ci id="S3.SS1.p3.4.m1.1.1.3.cmml" xref="S3.SS1.p3.4.m1.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m1.1c">p_{\text{\scriptsize pre}}\in T</annotation></semantics></math> is a preprompt that gives instructions to generate code using image and text processing APIs, <math id="S3.SS1.p3.5.m2.1" class="ltx_Math" alttext="q\in Q" display="inline"><semantics id="S3.SS1.p3.5.m2.1a"><mrow id="S3.SS1.p3.5.m2.1.1" xref="S3.SS1.p3.5.m2.1.1.cmml"><mi id="S3.SS1.p3.5.m2.1.1.2" xref="S3.SS1.p3.5.m2.1.1.2.cmml">q</mi><mo id="S3.SS1.p3.5.m2.1.1.1" xref="S3.SS1.p3.5.m2.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p3.5.m2.1.1.3" xref="S3.SS1.p3.5.m2.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m2.1b"><apply id="S3.SS1.p3.5.m2.1.1.cmml" xref="S3.SS1.p3.5.m2.1.1"><in id="S3.SS1.p3.5.m2.1.1.1.cmml" xref="S3.SS1.p3.5.m2.1.1.1"></in><ci id="S3.SS1.p3.5.m2.1.1.2.cmml" xref="S3.SS1.p3.5.m2.1.1.2">ğ‘</ci><ci id="S3.SS1.p3.5.m2.1.1.3.cmml" xref="S3.SS1.p3.5.m2.1.1.3">ğ‘„</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m2.1c">q\in Q</annotation></semantics></math> is an input question, and <math id="S3.SS1.p3.6.m3.1" class="ltx_Math" alttext="+" display="inline"><semantics id="S3.SS1.p3.6.m3.1a"><mo id="S3.SS1.p3.6.m3.1.1" xref="S3.SS1.p3.6.m3.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m3.1b"><plus id="S3.SS1.p3.6.m3.1.1.cmml" xref="S3.SS1.p3.6.m3.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m3.1c">+</annotation></semantics></math> indicates textual concatenation.
Here, APIs include both low-level functions, such as image cropping, and high-level functions, such as object detection.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.2" class="ltx_p"><span id="S3.SS1.p4.2.1" class="ltx_text ltx_font_bold">Preprompt definition.</span>
In order to provide the LLM with detailed instructions on how to use the APIs, the preprompt <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">p</mi><mtext id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS1.p4.1.m1.1.1.3a.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">p_{\text{\scriptsize pre}}</annotation></semantics></math> typically includes API definitions, coding instructions, and example snippets of code.
We define a preprompt <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="p_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msub id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">p</mi><mtext id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">ğ‘</ci><ci id="S3.SS1.p4.2.m2.1.1.3a.cmml" xref="S3.SS1.p4.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">p_{\text{\scriptsize pre}}</annotation></semantics></math> by</p>
<table id="Sx1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle p_{\text{\scriptsize pre}}=\Psi(p_{\text{\scriptsize def}},c,p_{\text{\scriptsize inst}})," display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.4" xref="S3.E4.m1.2.2.1.1.4.cmml"><mi id="S3.E4.m1.2.2.1.1.4.2" xref="S3.E4.m1.2.2.1.1.4.2.cmml">p</mi><mtext id="S3.E4.m1.2.2.1.1.4.3" xref="S3.E4.m1.2.2.1.1.4.3a.cmml">pre</mtext></msub><mo id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml"><mi mathvariant="normal" id="S3.E4.m1.2.2.1.1.2.4" xref="S3.E4.m1.2.2.1.1.2.4.cmml">Î¨</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.2.3" xref="S3.E4.m1.2.2.1.1.2.3.cmml">â€‹</mo><mrow id="S3.E4.m1.2.2.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">p</mi><mtext id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3a.cmml">def</mtext></msub><mo id="S3.E4.m1.2.2.1.1.2.2.2.4" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">,</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">c</mi><mo id="S3.E4.m1.2.2.1.1.2.2.2.5" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E4.m1.2.2.1.1.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2.cmml">p</mi><mtext id="S3.E4.m1.2.2.1.1.2.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3a.cmml">inst</mtext></msub><mo stretchy="false" id="S3.E4.m1.2.2.1.1.2.2.2.6" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"></eq><apply id="S3.E4.m1.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2">ğ‘</ci><ci id="S3.E4.m1.2.2.1.1.4.3a.cmml" xref="S3.E4.m1.2.2.1.1.4.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.4.3">pre</mtext></ci></apply><apply id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"><times id="S3.E4.m1.2.2.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.3"></times><ci id="S3.E4.m1.2.2.1.1.2.4.cmml" xref="S3.E4.m1.2.2.1.1.2.4">Î¨</ci><vector id="S3.E4.m1.2.2.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">ğ‘</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">def</mtext></ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">ğ‘</ci><apply id="S3.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.2">ğ‘</ci><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.3a.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S3.E4.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2.3">inst</mtext></ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle p_{\text{\scriptsize pre}}=\Psi(p_{\text{\scriptsize def}},c,p_{\text{\scriptsize inst}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.6" class="ltx_p">where <math id="S3.SS1.p4.3.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize def}}" display="inline"><semantics id="S3.SS1.p4.3.m1.1a"><msub id="S3.SS1.p4.3.m1.1.1" xref="S3.SS1.p4.3.m1.1.1.cmml"><mi id="S3.SS1.p4.3.m1.1.1.2" xref="S3.SS1.p4.3.m1.1.1.2.cmml">p</mi><mtext id="S3.SS1.p4.3.m1.1.1.3" xref="S3.SS1.p4.3.m1.1.1.3a.cmml">def</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m1.1b"><apply id="S3.SS1.p4.3.m1.1.1.cmml" xref="S3.SS1.p4.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m1.1.1.1.cmml" xref="S3.SS1.p4.3.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.3.m1.1.1.2.cmml" xref="S3.SS1.p4.3.m1.1.1.2">ğ‘</ci><ci id="S3.SS1.p4.3.m1.1.1.3a.cmml" xref="S3.SS1.p4.3.m1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p4.3.m1.1.1.3.cmml" xref="S3.SS1.p4.3.m1.1.1.3">def</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m1.1c">p_{\text{\scriptsize def}}</annotation></semantics></math> is a text of API definitions,
<math id="S3.SS1.p4.4.m2.1" class="ltx_Math" alttext="c\in Z" display="inline"><semantics id="S3.SS1.p4.4.m2.1a"><mrow id="S3.SS1.p4.4.m2.1.1" xref="S3.SS1.p4.4.m2.1.1.cmml"><mi id="S3.SS1.p4.4.m2.1.1.2" xref="S3.SS1.p4.4.m2.1.1.2.cmml">c</mi><mo id="S3.SS1.p4.4.m2.1.1.1" xref="S3.SS1.p4.4.m2.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p4.4.m2.1.1.3" xref="S3.SS1.p4.4.m2.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m2.1b"><apply id="S3.SS1.p4.4.m2.1.1.cmml" xref="S3.SS1.p4.4.m2.1.1"><in id="S3.SS1.p4.4.m2.1.1.1.cmml" xref="S3.SS1.p4.4.m2.1.1.1"></in><ci id="S3.SS1.p4.4.m2.1.1.2.cmml" xref="S3.SS1.p4.4.m2.1.1.2">ğ‘</ci><ci id="S3.SS1.p4.4.m2.1.1.3.cmml" xref="S3.SS1.p4.4.m2.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m2.1c">c\in Z</annotation></semantics></math> is textually concatenated example snippets of Python code,
<math id="S3.SS1.p4.5.m3.1" class="ltx_Math" alttext="p_{\text{\scriptsize inst}}\in T" display="inline"><semantics id="S3.SS1.p4.5.m3.1a"><mrow id="S3.SS1.p4.5.m3.1.1" xref="S3.SS1.p4.5.m3.1.1.cmml"><msub id="S3.SS1.p4.5.m3.1.1.2" xref="S3.SS1.p4.5.m3.1.1.2.cmml"><mi id="S3.SS1.p4.5.m3.1.1.2.2" xref="S3.SS1.p4.5.m3.1.1.2.2.cmml">p</mi><mtext id="S3.SS1.p4.5.m3.1.1.2.3" xref="S3.SS1.p4.5.m3.1.1.2.3a.cmml">inst</mtext></msub><mo id="S3.SS1.p4.5.m3.1.1.1" xref="S3.SS1.p4.5.m3.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p4.5.m3.1.1.3" xref="S3.SS1.p4.5.m3.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m3.1b"><apply id="S3.SS1.p4.5.m3.1.1.cmml" xref="S3.SS1.p4.5.m3.1.1"><in id="S3.SS1.p4.5.m3.1.1.1.cmml" xref="S3.SS1.p4.5.m3.1.1.1"></in><apply id="S3.SS1.p4.5.m3.1.1.2.cmml" xref="S3.SS1.p4.5.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m3.1.1.2.1.cmml" xref="S3.SS1.p4.5.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.5.m3.1.1.2.2.cmml" xref="S3.SS1.p4.5.m3.1.1.2.2">ğ‘</ci><ci id="S3.SS1.p4.5.m3.1.1.2.3a.cmml" xref="S3.SS1.p4.5.m3.1.1.2.3"><mtext mathsize="70%" id="S3.SS1.p4.5.m3.1.1.2.3.cmml" xref="S3.SS1.p4.5.m3.1.1.2.3">inst</mtext></ci></apply><ci id="S3.SS1.p4.5.m3.1.1.3.cmml" xref="S3.SS1.p4.5.m3.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m3.1c">p_{\text{\scriptsize inst}}\in T</annotation></semantics></math> is a coding instruction written in a natural language,
and <math id="S3.SS1.p4.6.m4.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S3.SS1.p4.6.m4.1a"><mi mathvariant="normal" id="S3.SS1.p4.6.m4.1.1" xref="S3.SS1.p4.6.m4.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m4.1b"><ci id="S3.SS1.p4.6.m4.1.1.cmml" xref="S3.SS1.p4.6.m4.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m4.1c">\Psi</annotation></semantics></math> is a structural aggregation function to insert code snippets to immediately after function definitions as comments.
For example, a code snippet for comparing the positions of objects is inserted immediately after the definition of the object detection function.
Below, we review the preprompt of
ViperGPTÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>, which we use in SectionÂ <a href="#S4" title="4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<p id="S3.SS1.p5.1" class="ltx_p"><span id="S3.SS1.p5.1.1" class="ltx_text ltx_font_italic">1) API definitions.</span>
The text of API definitions for <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize def}}\in Z" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><mrow id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><msub id="S3.SS1.p5.1.m1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.2.cmml"><mi id="S3.SS1.p5.1.m1.1.1.2.2" xref="S3.SS1.p5.1.m1.1.1.2.2.cmml">p</mi><mtext id="S3.SS1.p5.1.m1.1.1.2.3" xref="S3.SS1.p5.1.m1.1.1.2.3a.cmml">def</mtext></msub><mo id="S3.SS1.p5.1.m1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml">Z</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><in id="S3.SS1.p5.1.m1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1"></in><apply id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.1.2.2">ğ‘</ci><ci id="S3.SS1.p5.1.m1.1.1.2.3a.cmml" xref="S3.SS1.p5.1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.SS1.p5.1.m1.1.1.2.3.cmml" xref="S3.SS1.p5.1.m1.1.1.2.3">def</mtext></ci></apply><ci id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3">ğ‘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">p_{\text{\scriptsize def}}\in Z</annotation></semantics></math> is written in Python and includes both class, method and function definitions. Specifically, it consists of the Python class <span id="S3.SS1.p5.1.2" class="ltx_text ltx_font_typewriter">ImagePatch</span> to represent an image patch and a set of auxiliary functions.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS1.p6.1" class="ltx_p"><span id="S3.SS1.p6.1.1" class="ltx_text ltx_font_italic">2) Code snippets.</span>
For each function and method, one or two code snippets are provided. Each code snippet calls the function or method at least once. For example, the following code snippet is given for the <span id="S3.SS1.p6.1.2" class="ltx_text ltx_font_typewriter">find</span> method that detects objects in images.</p>
<div id="S3.SS1.p6.2" class="ltx_listing ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,IyBSZXR1cm4gdGhlIGZvbwpkZWYgZXhlY3V0ZV9jb21tYW5kKGltYWdlKSAtPiBMaXN0W0ltYWdlUGF0Y2hdOgogICAgaW1hZ2VfcGF0Y2ggPSBJbWFnZVBhdGNoKGltYWdlKQogICAgZm9vX3BhdGNoZXMgPSBpbWFnZV9wYXRjaC5maW5kKCJmb28iKQogICAgcmV0dXJuIGZvb19wYXRjaGVz" download="">â¬‡</a></div>
<div id="lstnumberx1" class="ltx_listingline">
<span id="lstnumberx1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">#</span><span id="lstnumberx1.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx1.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Return</span><span id="lstnumberx1.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx1.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">the</span><span id="lstnumberx1.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx1.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">foo</span>
</div>
<div id="lstnumberx2" class="ltx_listingline">
<span id="lstnumberx2.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">def</span><span id="lstnumberx2.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx2.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">execute_command</span><span id="lstnumberx2.4" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(</span><span id="lstnumberx2.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">image</span><span id="lstnumberx2.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">)</span><span id="lstnumberx2.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx2.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">-&gt;</span><span id="lstnumberx2.9" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx2.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">List</span><span id="lstnumberx2.11" class="ltx_text ltx_font_typewriter" style="font-size:80%;">[</span><span id="lstnumberx2.12" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">ImagePatch</span><span id="lstnumberx2.13" class="ltx_text ltx_font_typewriter" style="font-size:80%;">]:</span>
</div>
<div id="lstnumberx3" class="ltx_listingline">
<span id="lstnumberx3.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">    </span><span id="lstnumberx3.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">image_patch</span><span id="lstnumberx3.3" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx3.4" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx3.5" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx3.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">ImagePatch</span><span id="lstnumberx3.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(</span><span id="lstnumberx3.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">image</span><span id="lstnumberx3.9" class="ltx_text ltx_font_typewriter" style="font-size:80%;">)</span>
</div>
<div id="lstnumberx4" class="ltx_listingline">
<span id="lstnumberx4.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">    </span><span id="lstnumberx4.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">foo_patches</span><span id="lstnumberx4.3" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx4.4" class="ltx_text ltx_font_typewriter" style="font-size:80%;">=</span><span id="lstnumberx4.5" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx4.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">image_patch</span><span id="lstnumberx4.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">.</span><span id="lstnumberx4.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">find</span><span id="lstnumberx4.9" class="ltx_text ltx_font_typewriter" style="font-size:80%;">("</span><span id="lstnumberx4.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">foo</span><span id="lstnumberx4.11" class="ltx_text ltx_font_typewriter" style="font-size:80%;">")</span>
</div>
<div id="lstnumberx5" class="ltx_listingline">
<span id="lstnumberx5.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">    </span><span id="lstnumberx5.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">return</span><span id="lstnumberx5.3" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx5.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">foo_patches</span>
</div>
</div>
</div>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS1.p7.1" class="ltx_p"><span id="S3.SS1.p7.1.1" class="ltx_text ltx_font_italic">3) Coding instruction.</span>
The coding instruction provides short instructions describing how to write code, specifying a programming language and how APIs should be used.
Specifically, <math id="S3.SS1.p7.1.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize inst}}" display="inline"><semantics id="S3.SS1.p7.1.m1.1a"><msub id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml"><mi id="S3.SS1.p7.1.m1.1.1.2" xref="S3.SS1.p7.1.m1.1.1.2.cmml">p</mi><mtext id="S3.SS1.p7.1.m1.1.1.3" xref="S3.SS1.p7.1.m1.1.1.3a.cmml">inst</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><apply id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p7.1.m1.1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p7.1.m1.1.1.2.cmml" xref="S3.SS1.p7.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS1.p7.1.m1.1.1.3a.cmml" xref="S3.SS1.p7.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS1.p7.1.m1.1.1.3.cmml" xref="S3.SS1.p7.1.m1.1.1.3">inst</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">p_{\text{\scriptsize inst}}</annotation></semantics></math> is the following text:</p>
<div id="S3.SS1.p7.2" class="ltx_listing ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,V3JpdGUgYSBmdW5jdGlvbiB1c2luZyBQeXRob24gYW5kIHRoZSBJbWFnZVBhdGNoIGNsYXNzCihhYm92ZSkgdGhhdCBjb3VsZCBiZSBleGVjdXRlZCB0byBwcm92aWRlIGFuIGFuc3dlciB0bwp0aGUgcXVlcnkuCgpDb25zaWRlciB0aGUgZm9sbG93aW5nIGd1aWRlbGluZXM6Ci0gVXNlIGJhc2UgUHl0aG9uIChjb21wYXJpc29uLCBzb3J0aW5nKSBmb3IgYmFzaWMgbG9naWNhbAogIG9wZXJhdGlvbnMsIGxlZnQvcmlnaHQvdXAvZG93biwgbWF0aCwgZXRjLgotIFVzZSB0aGUgbGxtX3F1ZXJ5IGZ1bmN0aW9uIHRvIGFjY2VzcyBleHRlcm5hbAogIGluZm9ybWF0aW9uIGFuZCBhbnN3ZXIgaW5mb3JtYXRpb25hbCBxdWVzdGlvbnMgbm90CiAgY29uY2VybmluZyB0aGUgaW1hZ2Uu" download="">â¬‡</a></div>
<div id="lstnumberx6" class="ltx_listingline">
<span id="lstnumberx6.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Write</span><span id="lstnumberx6.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">a</span><span id="lstnumberx6.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">function</span><span id="lstnumberx6.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">using</span><span id="lstnumberx6.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Python</span><span id="lstnumberx6.10" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.11" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">and</span><span id="lstnumberx6.12" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">the</span><span id="lstnumberx6.14" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.15" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">ImagePatch</span><span id="lstnumberx6.16" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx6.17" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">class</span>
</div>
<div id="lstnumberx7" class="ltx_listingline">
<span id="lstnumberx7.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(</span><span id="lstnumberx7.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">above</span><span id="lstnumberx7.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">)</span><span id="lstnumberx7.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">that</span><span id="lstnumberx7.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">could</span><span id="lstnumberx7.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">be</span><span id="lstnumberx7.10" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.11" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">executed</span><span id="lstnumberx7.12" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">to</span><span id="lstnumberx7.14" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.15" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">provide</span><span id="lstnumberx7.16" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.17" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">an</span><span id="lstnumberx7.18" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.19" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">answer</span><span id="lstnumberx7.20" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx7.21" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">to</span>
</div>
<div id="lstnumberx8" class="ltx_listingline">
<span id="lstnumberx8.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">the</span><span id="lstnumberx8.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx8.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">query</span><span id="lstnumberx8.4" class="ltx_text ltx_font_typewriter" style="font-size:80%;">.</span>
</div>
<div id="lstnumberx9" class="ltx_listingline">
</div>
<div id="lstnumberx10" class="ltx_listingline">
<span id="lstnumberx10.1" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Consider</span><span id="lstnumberx10.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx10.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">the</span><span id="lstnumberx10.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx10.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">following</span><span id="lstnumberx10.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx10.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">guidelines</span><span id="lstnumberx10.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">:</span>
</div>
<div id="lstnumberx11" class="ltx_listingline">
<span id="lstnumberx11.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">-</span><span id="lstnumberx11.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Use</span><span id="lstnumberx11.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">base</span><span id="lstnumberx11.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Python</span><span id="lstnumberx11.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.9" class="ltx_text ltx_font_typewriter" style="font-size:80%;">(</span><span id="lstnumberx11.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">comparison</span><span id="lstnumberx11.11" class="ltx_text ltx_font_typewriter" style="font-size:80%;">,</span><span id="lstnumberx11.12" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">sorting</span><span id="lstnumberx11.14" class="ltx_text ltx_font_typewriter" style="font-size:80%;">)</span><span id="lstnumberx11.15" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.16" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">for</span><span id="lstnumberx11.17" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.18" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">basic</span><span id="lstnumberx11.19" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx11.20" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">logical</span>
</div>
<div id="lstnumberx12" class="ltx_listingline">
<span id="lstnumberx12.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">  </span><span id="lstnumberx12.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">operations</span><span id="lstnumberx12.3" class="ltx_text ltx_font_typewriter" style="font-size:80%;">,</span><span id="lstnumberx12.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx12.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">left</span><span id="lstnumberx12.6" class="ltx_text ltx_font_typewriter" style="font-size:80%;">/</span><span id="lstnumberx12.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">right</span><span id="lstnumberx12.8" class="ltx_text ltx_font_typewriter" style="font-size:80%;">/</span><span id="lstnumberx12.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">up</span><span id="lstnumberx12.10" class="ltx_text ltx_font_typewriter" style="font-size:80%;">/</span><span id="lstnumberx12.11" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">down</span><span id="lstnumberx12.12" class="ltx_text ltx_font_typewriter" style="font-size:80%;">,</span><span id="lstnumberx12.13" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx12.14" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">math</span><span id="lstnumberx12.15" class="ltx_text ltx_font_typewriter" style="font-size:80%;">,</span><span id="lstnumberx12.16" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx12.17" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">etc</span><span id="lstnumberx12.18" class="ltx_text ltx_font_typewriter" style="font-size:80%;">.</span>
</div>
<div id="lstnumberx13" class="ltx_listingline">
<span id="lstnumberx13.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;">-</span><span id="lstnumberx13.2" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.3" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">Use</span><span id="lstnumberx13.4" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.5" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">the</span><span id="lstnumberx13.6" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.7" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">llm_query</span><span id="lstnumberx13.8" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.9" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">function</span><span id="lstnumberx13.10" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.11" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">to</span><span id="lstnumberx13.12" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.13" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">access</span><span id="lstnumberx13.14" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx13.15" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">external</span>
</div>
<div id="lstnumberx14" class="ltx_listingline">
<span id="lstnumberx14.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">  </span><span id="lstnumberx14.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">information</span><span id="lstnumberx14.3" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">and</span><span id="lstnumberx14.5" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">answer</span><span id="lstnumberx14.7" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.8" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">informational</span><span id="lstnumberx14.9" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.10" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">questions</span><span id="lstnumberx14.11" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx14.12" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">not</span>
</div>
<div id="lstnumberx15" class="ltx_listingline">
<span id="lstnumberx15.1" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;">  </span><span id="lstnumberx15.2" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">concerning</span><span id="lstnumberx15.3" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx15.4" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">the</span><span id="lstnumberx15.5" class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:80%;"> </span><span id="lstnumberx15.6" class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:80%;">image</span><span id="lstnumberx15.7" class="ltx_text ltx_font_typewriter" style="font-size:80%;">.</span>
</div>
</div>
</div>
<div id="S3.SS1.p8" class="ltx_para ltx_noindent">
<p id="S3.SS1.p8.3" class="ltx_p"><span id="S3.SS1.p8.3.1" class="ltx_text ltx_font_bold">Token length.</span>
One of major limitations of previous VPMs is that the input token length is long, resulting in a large computational load.
This work addresses this limitation by introducing an adaptive prompt compression method.
More specifically, we define the input token length of the code generation module in Eq.Â (<a href="#S3.E3" title="In 3.1. Preliminary â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) as</p>
<table id="Sx1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.4" class="ltx_Math" alttext="\displaystyle\ell(q;\Pi)=|p_{\text{\scriptsize pre}}|+|q|," display="inline"><semantics id="S3.E5.m1.4a"><mrow id="S3.E5.m1.4.4.1" xref="S3.E5.m1.4.4.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1" xref="S3.E5.m1.4.4.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.3" xref="S3.E5.m1.4.4.1.1.3.cmml"><mi mathvariant="normal" id="S3.E5.m1.4.4.1.1.3.2" xref="S3.E5.m1.4.4.1.1.3.2.cmml">â„“</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.4.4.1.1.3.1" xref="S3.E5.m1.4.4.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E5.m1.4.4.1.1.3.3.2" xref="S3.E5.m1.4.4.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.1.1.3.3.2.1" xref="S3.E5.m1.4.4.1.1.3.3.1.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">q</mi><mo id="S3.E5.m1.4.4.1.1.3.3.2.2" xref="S3.E5.m1.4.4.1.1.3.3.1.cmml">;</mo><mi mathvariant="normal" id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">Î </mi><mo stretchy="false" id="S3.E5.m1.4.4.1.1.3.3.2.3" xref="S3.E5.m1.4.4.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.4.4.1.1.2" xref="S3.E5.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.4.4.1.1.1" xref="S3.E5.m1.4.4.1.1.1.cmml"><mrow id="S3.E5.m1.4.4.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E5.m1.4.4.1.1.1.1.1.1" xref="S3.E5.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2.cmml">p</mi><mtext id="S3.E5.m1.4.4.1.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3a.cmml">pre</mtext></msub><mo stretchy="false" id="S3.E5.m1.4.4.1.1.1.1.1.3" xref="S3.E5.m1.4.4.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E5.m1.4.4.1.1.1.2" xref="S3.E5.m1.4.4.1.1.1.2.cmml">+</mo><mrow id="S3.E5.m1.4.4.1.1.1.3.2" xref="S3.E5.m1.4.4.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E5.m1.4.4.1.1.1.3.2.1" xref="S3.E5.m1.4.4.1.1.1.3.1.1.cmml">|</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">q</mi><mo stretchy="false" id="S3.E5.m1.4.4.1.1.1.3.2.2" xref="S3.E5.m1.4.4.1.1.1.3.1.1.cmml">|</mo></mrow></mrow></mrow><mo id="S3.E5.m1.4.4.1.2" xref="S3.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.4b"><apply id="S3.E5.m1.4.4.1.1.cmml" xref="S3.E5.m1.4.4.1"><eq id="S3.E5.m1.4.4.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.2"></eq><apply id="S3.E5.m1.4.4.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.3"><times id="S3.E5.m1.4.4.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.1"></times><ci id="S3.E5.m1.4.4.1.1.3.2.cmml" xref="S3.E5.m1.4.4.1.1.3.2">â„“</ci><list id="S3.E5.m1.4.4.1.1.3.3.1.cmml" xref="S3.E5.m1.4.4.1.1.3.3.2"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">ğ‘</ci><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">Î </ci></list></apply><apply id="S3.E5.m1.4.4.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1"><plus id="S3.E5.m1.4.4.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.2"></plus><apply id="S3.E5.m1.4.4.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1"><abs id="S3.E5.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.2"></abs><apply id="S3.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.2">ğ‘</ci><ci id="S3.E5.m1.4.4.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E5.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.4.4.1.1.1.1.1.1.3">pre</mtext></ci></apply></apply><apply id="S3.E5.m1.4.4.1.1.1.3.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2"><abs id="S3.E5.m1.4.4.1.1.1.3.1.1.cmml" xref="S3.E5.m1.4.4.1.1.1.3.2.1"></abs><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.4c">\displaystyle\ell(q;\Pi)=|p_{\text{\scriptsize pre}}|+|q|,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p8.2" class="ltx_p">where <math id="S3.SS1.p8.1.m1.1" class="ltx_Math" alttext="|t|" display="inline"><semantics id="S3.SS1.p8.1.m1.1a"><mrow id="S3.SS1.p8.1.m1.1.2.2" xref="S3.SS1.p8.1.m1.1.2.1.cmml"><mo stretchy="false" id="S3.SS1.p8.1.m1.1.2.2.1" xref="S3.SS1.p8.1.m1.1.2.1.1.cmml">|</mo><mi id="S3.SS1.p8.1.m1.1.1" xref="S3.SS1.p8.1.m1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p8.1.m1.1.2.2.2" xref="S3.SS1.p8.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.1.m1.1b"><apply id="S3.SS1.p8.1.m1.1.2.1.cmml" xref="S3.SS1.p8.1.m1.1.2.2"><abs id="S3.SS1.p8.1.m1.1.2.1.1.cmml" xref="S3.SS1.p8.1.m1.1.2.2.1"></abs><ci id="S3.SS1.p8.1.m1.1.1.cmml" xref="S3.SS1.p8.1.m1.1.1">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.1.m1.1c">|t|</annotation></semantics></math> is the number of tokens of a text <math id="S3.SS1.p8.2.m2.1" class="ltx_Math" alttext="t\in T" display="inline"><semantics id="S3.SS1.p8.2.m2.1a"><mrow id="S3.SS1.p8.2.m2.1.1" xref="S3.SS1.p8.2.m2.1.1.cmml"><mi id="S3.SS1.p8.2.m2.1.1.2" xref="S3.SS1.p8.2.m2.1.1.2.cmml">t</mi><mo id="S3.SS1.p8.2.m2.1.1.1" xref="S3.SS1.p8.2.m2.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS1.p8.2.m2.1.1.3" xref="S3.SS1.p8.2.m2.1.1.3.cmml">T</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p8.2.m2.1b"><apply id="S3.SS1.p8.2.m2.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1"><in id="S3.SS1.p8.2.m2.1.1.1.cmml" xref="S3.SS1.p8.2.m2.1.1.1"></in><ci id="S3.SS1.p8.2.m2.1.1.2.cmml" xref="S3.SS1.p8.2.m2.1.1.2">ğ‘¡</ci><ci id="S3.SS1.p8.2.m2.1.1.3.cmml" xref="S3.SS1.p8.2.m2.1.1.3">ğ‘‡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p8.2.m2.1c">t\in T</annotation></semantics></math>. Our goal is to reduce this length.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Compression phase</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.5" class="ltx_p">As shown in FigureÂ <a href="#S2.F2" title="Figure 2 â€£ 2.1. Visual question answering â€£ 2. Related work â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>a, the compression phase creates a set of compressed prompts <math id="S3.SS2.p1.1.m1.3" class="ltx_Math" alttext="\mathcal{C}=\{\hat{p}_{\text{\scriptsize def}}\}\cup\{\hat{c}_{t}:t\in Y\}" display="inline"><semantics id="S3.SS2.p1.1.m1.3a"><mrow id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.3.3.5" xref="S3.SS2.p1.1.m1.3.3.5.cmml">ğ’</mi><mo id="S3.SS2.p1.1.m1.3.3.4" xref="S3.SS2.p1.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.3.3.3" xref="S3.SS2.p1.1.m1.3.3.3.cmml"><mrow id="S3.SS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mo id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.1" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mtext id="S3.SS2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.3a.cmml">def</mtext></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mo id="S3.SS2.p1.1.m1.3.3.3.4" xref="S3.SS2.p1.1.m1.3.3.3.4.cmml">âˆª</mo><mrow id="S3.SS2.p1.1.m1.3.3.3.3.2" xref="S3.SS2.p1.1.m1.3.3.3.3.3.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.3.3.2.3" xref="S3.SS2.p1.1.m1.3.3.3.3.3.1.cmml">{</mo><msub id="S3.SS2.p1.1.m1.2.2.2.2.1.1" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml"><mover accent="true" id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.2" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.2.cmml">c</mi><mo id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.1" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.1.m1.2.2.2.2.1.1.3" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.1.m1.3.3.3.3.2.4" xref="S3.SS2.p1.1.m1.3.3.3.3.3.1.cmml">:</mo><mrow id="S3.SS2.p1.1.m1.3.3.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.2.cmml">t</mi><mo id="S3.SS2.p1.1.m1.3.3.3.3.2.2.1" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.1.cmml">âˆˆ</mo><mi id="S3.SS2.p1.1.m1.3.3.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.3.cmml">Y</mi></mrow><mo stretchy="false" id="S3.SS2.p1.1.m1.3.3.3.3.2.5" xref="S3.SS2.p1.1.m1.3.3.3.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b"><apply id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3"><eq id="S3.SS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.p1.1.m1.3.3.4"></eq><ci id="S3.SS2.p1.1.m1.3.3.5.cmml" xref="S3.SS2.p1.1.m1.3.3.5">ğ’</ci><apply id="S3.SS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3"><union id="S3.SS2.p1.1.m1.3.3.3.4.cmml" xref="S3.SS2.p1.1.m1.3.3.3.4"></union><set id="S3.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1"><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2"><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.2.2">ğ‘</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.1.1.1.1.3a.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.1.1.3">def</mtext></ci></apply></set><apply id="S3.SS2.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3.3.2"><csymbol cd="latexml" id="S3.SS2.p1.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.3.3.3.3.2.3">conditional-set</csymbol><apply id="S3.SS2.p1.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1">subscript</csymbol><apply id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2"><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.1">^</ci><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.2.2">ğ‘</ci></apply><ci id="S3.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.2.2.1.1.3">ğ‘¡</ci></apply><apply id="S3.SS2.p1.1.m1.3.3.3.3.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2"><in id="S3.SS2.p1.1.m1.3.3.3.3.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.1"></in><ci id="S3.SS2.p1.1.m1.3.3.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.2">ğ‘¡</ci><ci id="S3.SS2.p1.1.m1.3.3.3.3.2.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3.3.2.2.3">ğ‘Œ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">\mathcal{C}=\{\hat{p}_{\text{\scriptsize def}}\}\cup\{\hat{c}_{t}:t\in Y\}</annotation></semantics></math>, where <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize def}}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mover accent="true" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">p</mi><mo id="S3.SS2.p1.2.m2.1.1.2.1" xref="S3.SS2.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mtext id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3a.cmml">def</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><ci id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2.1">^</ci><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">ğ‘</ci></apply><ci id="S3.SS2.p1.2.m2.1.1.3a.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">def</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\hat{p}_{\text{\scriptsize def}}</annotation></semantics></math> is a compressed text of API definitions, <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\hat{c}_{t}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mover accent="true" id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">c</mi><mo id="S3.SS2.p1.3.m3.1.1.2.1" xref="S3.SS2.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><ci id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2.1">^</ci><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">ğ‘</ci></apply><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\hat{c}_{t}</annotation></semantics></math> is a compressed code snippet for question type <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="t\in Y" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">t</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><in id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></in><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">ğ‘¡</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">ğ‘Œ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">t\in Y</annotation></semantics></math>, and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">ğ‘Œ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">Y</annotation></semantics></math> is a set of question types. Below, we detail the two-step process for compressing API definitions and code snippets.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.5" class="ltx_p"><span id="S3.SS2.p2.5.1" class="ltx_text ltx_font_bold">Compressing API definitions.</span>
This step compresses the API definitions by</p>
<table id="Sx1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\displaystyle\hat{p}_{\text{\scriptsize def}}=\pi(p_{\text{\scriptsize pre}}+r_{\text{\scriptsize pre}})" display="inline"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml">p</mi><mo id="S3.E6.m1.1.1.3.2.1" xref="S3.E6.m1.1.1.3.2.1.cmml">^</mo></mover><mtext id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3a.cmml">def</mtext></msub><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3a.cmml">pre</mtext></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml">r</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3a.cmml">pre</mtext></msub></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><ci id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2.1">^</ci><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">ğ‘</ci></apply><ci id="S3.E6.m1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.3.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">def</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><ci id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3">ğœ‹</ci><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><plus id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2">ğ‘</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3">pre</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">ğ‘Ÿ</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3">pre</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\displaystyle\hat{p}_{\text{\scriptsize def}}=\pi(p_{\text{\scriptsize pre}}+r_{\text{\scriptsize pre}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.4" class="ltx_p">where <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">p</mi><mtext id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS2.p2.1.m1.1.1.3a.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">p_{\text{\scriptsize pre}}</annotation></semantics></math> is the original preprompt in Eq.Â (<a href="#S3.E4" title="In 3.1. Preliminary â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">Ï€</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">ğœ‹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\pi</annotation></semantics></math> is a frozen LLM, and <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="r_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">r</mi><mtext id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">ğ‘Ÿ</ci><ci id="S3.SS2.p2.3.m3.1.1.3a.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">r_{\text{\scriptsize pre}}</annotation></semantics></math> is the instruction to rewrite API definitions. FigureÂ <a href="#S3.F3" title="Figure 3 â€£ 3.3. Inference phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>a shows the definition of <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="r_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">r</mi><mtext id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">ğ‘Ÿ</ci><ci id="S3.SS2.p2.4.m4.1.1.3a.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><mtext mathsize="70%" id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">r_{\text{\scriptsize pre}}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.9" class="ltx_p"><span id="S3.SS2.p3.9.1" class="ltx_text ltx_font_bold">Compressing code snippets.</span>
This step compresses the code snippets for each question type as follows:</p>
<table id="Sx1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle\hat{c}_{t}=\pi(p_{\text{\scriptsize pre}}+r_{\text{\scriptsize code}}+r_{\text{\scriptsize sp}}(d_{t}))," display="inline"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">c</mi><mo id="S3.E7.m1.1.1.1.1.3.2.1" xref="S3.E7.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.3a.cmml">pre</mtext></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.2.cmml">r</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.3a.cmml">code</mtext></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.2a" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mtext id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml">sp</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><ci id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">ğ‘</ci></apply><ci id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3">ğ‘¡</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">ğœ‹</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2"></plus><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.2">ğ‘</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.3">pre</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.2">ğ‘Ÿ</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.4.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.4.3">code</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.2">ğ‘Ÿ</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.3.3">sp</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">ğ‘‘</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ‘¡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle\hat{c}_{t}=\pi(p_{\text{\scriptsize pre}}+r_{\text{\scriptsize code}}+r_{\text{\scriptsize sp}}(d_{t})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.8" class="ltx_p">where <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">p</mi><mtext id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS2.p3.1.m1.1.1.3a.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">p_{\text{\scriptsize pre}}</annotation></semantics></math> is the original preprompt,
<math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="r_{\text{\scriptsize code}}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">r</mi><mtext id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3a.cmml">code</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">ğ‘Ÿ</ci><ci id="S3.SS2.p3.2.m2.1.1.3a.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">code</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">r_{\text{\scriptsize code}}</annotation></semantics></math> is the instruction to write code snippets, <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="r_{\text{\scriptsize sp}}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">r</mi><mtext id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3a.cmml">sp</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">ğ‘Ÿ</ci><ci id="S3.SS2.p3.3.m3.1.1.3a.cmml" xref="S3.SS2.p3.3.m3.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">sp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">r_{\text{\scriptsize sp}}</annotation></semantics></math> is an additional instruction to write code specialized for a specific question type with a placeholder to insert the definition of question type <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">d</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">ğ‘‘</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">d_{t}</annotation></semantics></math>, and <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="t\in Y" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">t</mi><mo id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><in id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1"></in><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">ğ‘¡</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">ğ‘Œ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">t\in Y</annotation></semantics></math> is a question type.
FigureÂ <a href="#S3.F3" title="Figure 3 â€£ 3.3. Inference phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>b and <a href="#S3.F3" title="Figure 3 â€£ 3.3. Inference phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>c show the definitions of <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="r_{\text{\scriptsize code}}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">r</mi><mtext id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3a.cmml">code</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">ğ‘Ÿ</ci><ci id="S3.SS2.p3.6.m6.1.1.3a.cmml" xref="S3.SS2.p3.6.m6.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">code</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">r_{\text{\scriptsize code}}</annotation></semantics></math> and <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="r_{\text{\scriptsize sp}}" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">r</mi><mtext id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3a.cmml">sp</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">ğ‘Ÿ</ci><ci id="S3.SS2.p3.7.m7.1.1.3a.cmml" xref="S3.SS2.p3.7.m7.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">sp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">r_{\text{\scriptsize sp}}</annotation></semantics></math>, respectively.
Here, we assumed that a pre-defined set of question types <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">ğ‘Œ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">Y</annotation></semantics></math> is given.
For example, with the GQA datasetÂ <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>, five question types shown in TableÂ <a href="#S3.T1" title="Table 1 â€£ 3.4. Discussion â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> are provided with their definitions.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Inference phase</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The inference phase generates a code to answer the input question by utilizing a compressed preprompt adaptively selected based on the question type as shown in FigureÂ <a href="#S2.F2" title="Figure 2 â€£ 2.1. Visual question answering â€£ 2. Related work â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>b.
More specifically, this phase consists of four steps: question classification, preprompt generation, code generation, and execution.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2407.19410/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="343" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Instruction prompts for the compression phase.
<span id="S3.F3.4.1" class="ltx_text ltx_font_typewriter">{type_definition[i]}</span> is a placeholder to which a question type definition <math id="S3.F3.2.m1.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S3.F3.2.m1.1b"><msub id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml"><mi id="S3.F3.2.m1.1.1.2" xref="S3.F3.2.m1.1.1.2.cmml">d</mi><mi id="S3.F3.2.m1.1.1.3" xref="S3.F3.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><apply id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.2.m1.1.1.1.cmml" xref="S3.F3.2.m1.1.1">subscript</csymbol><ci id="S3.F3.2.m1.1.1.2.cmml" xref="S3.F3.2.m1.1.1.2">ğ‘‘</ci><ci id="S3.F3.2.m1.1.1.3.cmml" xref="S3.F3.2.m1.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">d_{t}</annotation></semantics></math>. See TableÂ <a href="#S3.T1" title="Table 1 â€£ 3.4. Discussion â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for example type definitions.</figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.3" class="ltx_p"><span id="S3.SS3.p2.3.1" class="ltx_text ltx_font_bold">Question classification.</span>
Given an input question <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="q\in Q" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">q</mi><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">âˆˆ</mo><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><in id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></in><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">ğ‘</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">ğ‘„</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">q\in Q</annotation></semantics></math>, this step predicts the question type.
We define classification prompt <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="p_{\text{\scriptsize cls}}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">p</mi><mtext id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3a.cmml">cls</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">ğ‘</ci><ci id="S3.SS3.p2.2.m2.1.1.3a.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">cls</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">p_{\text{\scriptsize cls}}</annotation></semantics></math> and use the LLM <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">Ï€</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">ğœ‹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\pi</annotation></semantics></math> for question classification as follows:</p>
<table id="Sx1.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle\hat{t}=\pi(p_{\text{\scriptsize cls}}+q)," display="inline"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mover accent="true" id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">^</mo></mover><mo id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mtext id="S3.E8.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.3a.cmml">cls</mtext></msub><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"></eq><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><ci id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1">^</ci><ci id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2">ğ‘¡</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2"></times><ci id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">ğœ‹</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><plus id="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.2">ğ‘</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.3">cls</mtext></ci></apply><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle\hat{t}=\pi(p_{\text{\scriptsize cls}}+q),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.4" class="ltx_p">where <math id="S3.SS3.p2.4.m1.1" class="ltx_Math" alttext="\hat{t}" display="inline"><semantics id="S3.SS3.p2.4.m1.1a"><mover accent="true" id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml"><mi id="S3.SS3.p2.4.m1.1.1.2" xref="S3.SS3.p2.4.m1.1.1.2.cmml">t</mi><mo id="S3.SS3.p2.4.m1.1.1.1" xref="S3.SS3.p2.4.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><apply id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1"><ci id="S3.SS3.p2.4.m1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1.1">^</ci><ci id="S3.SS3.p2.4.m1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">\hat{t}</annotation></semantics></math> is the predicted question type.
The classification prompt consists of a short instruction for classification and a list of definitions of question types.
The definition of classification prompt is shown in FigureÂ <a href="#S4.F4" title="Figure 4 â€£ 4.1. Experimental settings â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.9" class="ltx_p"><span id="S3.SS3.p3.9.1" class="ltx_text ltx_font_bold">Preprompt generation.</span>
This step generates a compressed preprompt given the question type as follows:</p>
<table id="Sx1.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.3" class="ltx_Math" alttext="\displaystyle\hat{p}_{\text{\scriptsize pre}}=\Psi(\hat{p}_{\text{\scriptsize def}},p_{\text{\scriptsize inst}},\hat{c}_{\hat{t}})" display="inline"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml"><msub id="S3.E9.m1.3.3.5" xref="S3.E9.m1.3.3.5.cmml"><mover accent="true" id="S3.E9.m1.3.3.5.2" xref="S3.E9.m1.3.3.5.2.cmml"><mi id="S3.E9.m1.3.3.5.2.2" xref="S3.E9.m1.3.3.5.2.2.cmml">p</mi><mo id="S3.E9.m1.3.3.5.2.1" xref="S3.E9.m1.3.3.5.2.1.cmml">^</mo></mover><mtext id="S3.E9.m1.3.3.5.3" xref="S3.E9.m1.3.3.5.3a.cmml">pre</mtext></msub><mo id="S3.E9.m1.3.3.4" xref="S3.E9.m1.3.3.4.cmml">=</mo><mrow id="S3.E9.m1.3.3.3" xref="S3.E9.m1.3.3.3.cmml"><mi mathvariant="normal" id="S3.E9.m1.3.3.3.5" xref="S3.E9.m1.3.3.3.5.cmml">Î¨</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.3.3.3.4" xref="S3.E9.m1.3.3.3.4.cmml">â€‹</mo><mrow id="S3.E9.m1.3.3.3.3.3" xref="S3.E9.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="S3.E9.m1.3.3.3.3.3.4" xref="S3.E9.m1.3.3.3.3.4.cmml">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mo id="S3.E9.m1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mtext id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3a.cmml">def</mtext></msub><mo id="S3.E9.m1.3.3.3.3.3.5" xref="S3.E9.m1.3.3.3.3.4.cmml">,</mo><msub id="S3.E9.m1.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.2.cmml">p</mi><mtext id="S3.E9.m1.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.3a.cmml">inst</mtext></msub><mo id="S3.E9.m1.3.3.3.3.3.6" xref="S3.E9.m1.3.3.3.3.4.cmml">,</mo><msub id="S3.E9.m1.3.3.3.3.3.3" xref="S3.E9.m1.3.3.3.3.3.3.cmml"><mover accent="true" id="S3.E9.m1.3.3.3.3.3.3.2" xref="S3.E9.m1.3.3.3.3.3.3.2.cmml"><mi id="S3.E9.m1.3.3.3.3.3.3.2.2" xref="S3.E9.m1.3.3.3.3.3.3.2.2.cmml">c</mi><mo id="S3.E9.m1.3.3.3.3.3.3.2.1" xref="S3.E9.m1.3.3.3.3.3.3.2.1.cmml">^</mo></mover><mover accent="true" id="S3.E9.m1.3.3.3.3.3.3.3" xref="S3.E9.m1.3.3.3.3.3.3.3.cmml"><mi id="S3.E9.m1.3.3.3.3.3.3.3.2" xref="S3.E9.m1.3.3.3.3.3.3.3.2.cmml">t</mi><mo id="S3.E9.m1.3.3.3.3.3.3.3.1" xref="S3.E9.m1.3.3.3.3.3.3.3.1.cmml">^</mo></mover></msub><mo stretchy="false" id="S3.E9.m1.3.3.3.3.3.7" xref="S3.E9.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"><eq id="S3.E9.m1.3.3.4.cmml" xref="S3.E9.m1.3.3.4"></eq><apply id="S3.E9.m1.3.3.5.cmml" xref="S3.E9.m1.3.3.5"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.5.1.cmml" xref="S3.E9.m1.3.3.5">subscript</csymbol><apply id="S3.E9.m1.3.3.5.2.cmml" xref="S3.E9.m1.3.3.5.2"><ci id="S3.E9.m1.3.3.5.2.1.cmml" xref="S3.E9.m1.3.3.5.2.1">^</ci><ci id="S3.E9.m1.3.3.5.2.2.cmml" xref="S3.E9.m1.3.3.5.2.2">ğ‘</ci></apply><ci id="S3.E9.m1.3.3.5.3a.cmml" xref="S3.E9.m1.3.3.5.3"><mtext mathsize="70%" id="S3.E9.m1.3.3.5.3.cmml" xref="S3.E9.m1.3.3.5.3">pre</mtext></ci></apply><apply id="S3.E9.m1.3.3.3.cmml" xref="S3.E9.m1.3.3.3"><times id="S3.E9.m1.3.3.3.4.cmml" xref="S3.E9.m1.3.3.3.4"></times><ci id="S3.E9.m1.3.3.3.5.cmml" xref="S3.E9.m1.3.3.3.5">Î¨</ci><vector id="S3.E9.m1.3.3.3.3.4.cmml" xref="S3.E9.m1.3.3.3.3.3"><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2">ğ‘</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">def</mtext></ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2">ğ‘</ci><ci id="S3.E9.m1.2.2.2.2.2.2.3a.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3"><mtext mathsize="70%" id="S3.E9.m1.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3">inst</mtext></ci></apply><apply id="S3.E9.m1.3.3.3.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.3.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3">subscript</csymbol><apply id="S3.E9.m1.3.3.3.3.3.3.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3.2"><ci id="S3.E9.m1.3.3.3.3.3.3.2.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3.2.1">^</ci><ci id="S3.E9.m1.3.3.3.3.3.3.2.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3.2.2">ğ‘</ci></apply><apply id="S3.E9.m1.3.3.3.3.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3.3"><ci id="S3.E9.m1.3.3.3.3.3.3.3.1.cmml" xref="S3.E9.m1.3.3.3.3.3.3.3.1">^</ci><ci id="S3.E9.m1.3.3.3.3.3.3.3.2.cmml" xref="S3.E9.m1.3.3.3.3.3.3.3.2">ğ‘¡</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\displaystyle\hat{p}_{\text{\scriptsize pre}}=\Psi(\hat{p}_{\text{\scriptsize def}},p_{\text{\scriptsize inst}},\hat{c}_{\hat{t}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.8" class="ltx_p">where <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize def}}\in\mathcal{C}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mrow id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><msub id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml"><mover accent="true" id="S3.SS3.p3.1.m1.1.1.2.2" xref="S3.SS3.p3.1.m1.1.1.2.2.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2.2.2" xref="S3.SS3.p3.1.m1.1.1.2.2.2.cmml">p</mi><mo id="S3.SS3.p3.1.m1.1.1.2.2.1" xref="S3.SS3.p3.1.m1.1.1.2.2.1.cmml">^</mo></mover><mtext id="S3.SS3.p3.1.m1.1.1.2.3" xref="S3.SS3.p3.1.m1.1.1.2.3a.cmml">def</mtext></msub><mo id="S3.SS3.p3.1.m1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">ğ’</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><in id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1"></in><apply id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.2">subscript</csymbol><apply id="S3.SS3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2.2"><ci id="S3.SS3.p3.1.m1.1.1.2.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.1.m1.1.1.2.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2.2.2">ğ‘</ci></apply><ci id="S3.SS3.p3.1.m1.1.1.2.3a.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3"><mtext mathsize="70%" id="S3.SS3.p3.1.m1.1.1.2.3.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3">def</mtext></ci></apply><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">ğ’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\hat{p}_{\text{\scriptsize def}}\in\mathcal{C}</annotation></semantics></math> is the compressed API definitions in Eq.Â <a href="#S3.E6" title="In 3.2. Compression phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>,
<math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="p_{\text{\scriptsize inst}}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msub id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">p</mi><mtext id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3a.cmml">inst</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">ğ‘</ci><ci id="S3.SS3.p3.2.m2.1.1.3a.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">inst</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">p_{\text{\scriptsize inst}}</annotation></semantics></math> is the coding instruction, <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\hat{c}_{\hat{t}}\in\mathcal{C}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msub id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml"><mover accent="true" id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.2.cmml">c</mi><mo id="S3.SS3.p3.3.m3.1.1.2.2.1" xref="S3.SS3.p3.3.m3.1.1.2.2.1.cmml">^</mo></mover><mover accent="true" id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.3.2" xref="S3.SS3.p3.3.m3.1.1.2.3.2.cmml">t</mi><mo id="S3.SS3.p3.3.m3.1.1.2.3.1" xref="S3.SS3.p3.3.m3.1.1.2.3.1.cmml">^</mo></mover></msub><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">âˆˆ</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">ğ’</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><in id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></in><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2">subscript</csymbol><apply id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2"><ci id="S3.SS3.p3.3.m3.1.1.2.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2.1">^</ci><ci id="S3.SS3.p3.3.m3.1.1.2.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2.2">ğ‘</ci></apply><apply id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3"><ci id="S3.SS3.p3.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3.1">^</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3.2">ğ‘¡</ci></apply></apply><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">ğ’</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\hat{c}_{\hat{t}}\in\mathcal{C}</annotation></semantics></math> is the snippets of code for the question type <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\hat{t}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mover accent="true" id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">t</mi><mo id="S3.SS3.p3.4.m4.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><ci id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1">^</ci><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\hat{t}</annotation></semantics></math>, and <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\Psi" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mi mathvariant="normal" id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml">Î¨</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><ci id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">Î¨</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\Psi</annotation></semantics></math> is the structural aggregation function in Eq.Â (<a href="#S3.E4" title="In 3.1. Preliminary â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
Note that the computational cost of this step is almost negligible because both compressed prompts, <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize def}}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msub id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mover accent="true" id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2.2" xref="S3.SS3.p3.6.m6.1.1.2.2.cmml">p</mi><mo id="S3.SS3.p3.6.m6.1.1.2.1" xref="S3.SS3.p3.6.m6.1.1.2.1.cmml">^</mo></mover><mtext id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3a.cmml">def</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">subscript</csymbol><apply id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2"><ci id="S3.SS3.p3.6.m6.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1">^</ci><ci id="S3.SS3.p3.6.m6.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2">ğ‘</ci></apply><ci id="S3.SS3.p3.6.m6.1.1.3a.cmml" xref="S3.SS3.p3.6.m6.1.1.3"><mtext mathsize="70%" id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">def</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\hat{p}_{\text{\scriptsize def}}</annotation></semantics></math> and <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="\hat{c}_{\hat{t}}" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><msub id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml"><mover accent="true" id="S3.SS3.p3.7.m7.1.1.2" xref="S3.SS3.p3.7.m7.1.1.2.cmml"><mi id="S3.SS3.p3.7.m7.1.1.2.2" xref="S3.SS3.p3.7.m7.1.1.2.2.cmml">c</mi><mo id="S3.SS3.p3.7.m7.1.1.2.1" xref="S3.SS3.p3.7.m7.1.1.2.1.cmml">^</mo></mover><mover accent="true" id="S3.SS3.p3.7.m7.1.1.3" xref="S3.SS3.p3.7.m7.1.1.3.cmml"><mi id="S3.SS3.p3.7.m7.1.1.3.2" xref="S3.SS3.p3.7.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p3.7.m7.1.1.3.1" xref="S3.SS3.p3.7.m7.1.1.3.1.cmml">^</mo></mover></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><apply id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m7.1.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">subscript</csymbol><apply id="S3.SS3.p3.7.m7.1.1.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2"><ci id="S3.SS3.p3.7.m7.1.1.2.1.cmml" xref="S3.SS3.p3.7.m7.1.1.2.1">^</ci><ci id="S3.SS3.p3.7.m7.1.1.2.2.cmml" xref="S3.SS3.p3.7.m7.1.1.2.2">ğ‘</ci></apply><apply id="S3.SS3.p3.7.m7.1.1.3.cmml" xref="S3.SS3.p3.7.m7.1.1.3"><ci id="S3.SS3.p3.7.m7.1.1.3.1.cmml" xref="S3.SS3.p3.7.m7.1.1.3.1">^</ci><ci id="S3.SS3.p3.7.m7.1.1.3.2.cmml" xref="S3.SS3.p3.7.m7.1.1.3.2">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">\hat{c}_{\hat{t}}</annotation></semantics></math>, have already been computed in the compression phase.
We do not compress the coding instruction <math id="S3.SS3.p3.8.m8.1" class="ltx_Math" alttext="p_{\text{\scriptsize inst}}" display="inline"><semantics id="S3.SS3.p3.8.m8.1a"><msub id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml"><mi id="S3.SS3.p3.8.m8.1.1.2" xref="S3.SS3.p3.8.m8.1.1.2.cmml">p</mi><mtext id="S3.SS3.p3.8.m8.1.1.3" xref="S3.SS3.p3.8.m8.1.1.3a.cmml">inst</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><apply id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS3.p3.8.m8.1.1.2.cmml" xref="S3.SS3.p3.8.m8.1.1.2">ğ‘</ci><ci id="S3.SS3.p3.8.m8.1.1.3a.cmml" xref="S3.SS3.p3.8.m8.1.1.3"><mtext mathsize="70%" id="S3.SS3.p3.8.m8.1.1.3.cmml" xref="S3.SS3.p3.8.m8.1.1.3">inst</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">p_{\text{\scriptsize inst}}</annotation></semantics></math>, because it is already short.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.1" class="ltx_p"><span id="S3.SS3.p4.1.1" class="ltx_text ltx_font_bold">Code generation.</span>
This step generates a Python code <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">ğ‘§</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">z</annotation></semantics></math> as follows:</p>
<table id="Sx1.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.1" class="ltx_Math" alttext="\displaystyle z=\pi(\hat{p}_{\text{\scriptsize pre}}+q)," display="inline"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml">z</mi><mo id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">p</mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mtext id="S3.E10.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.3a.cmml">pre</mtext></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></eq><ci id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3">ğ‘§</ci><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3">ğœ‹</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><plus id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.2.2">ğ‘</ci></apply><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E10.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.3">pre</mtext></ci></apply><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\displaystyle z=\pi(\hat{p}_{\text{\scriptsize pre}}+q),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.2" class="ltx_p">where <math id="S3.SS3.p4.2.m1.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize pre}}" display="inline"><semantics id="S3.SS3.p4.2.m1.1a"><msub id="S3.SS3.p4.2.m1.1.1" xref="S3.SS3.p4.2.m1.1.1.cmml"><mover accent="true" id="S3.SS3.p4.2.m1.1.1.2" xref="S3.SS3.p4.2.m1.1.1.2.cmml"><mi id="S3.SS3.p4.2.m1.1.1.2.2" xref="S3.SS3.p4.2.m1.1.1.2.2.cmml">p</mi><mo id="S3.SS3.p4.2.m1.1.1.2.1" xref="S3.SS3.p4.2.m1.1.1.2.1.cmml">^</mo></mover><mtext id="S3.SS3.p4.2.m1.1.1.3" xref="S3.SS3.p4.2.m1.1.1.3a.cmml">pre</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m1.1b"><apply id="S3.SS3.p4.2.m1.1.1.cmml" xref="S3.SS3.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m1.1.1.1.cmml" xref="S3.SS3.p4.2.m1.1.1">subscript</csymbol><apply id="S3.SS3.p4.2.m1.1.1.2.cmml" xref="S3.SS3.p4.2.m1.1.1.2"><ci id="S3.SS3.p4.2.m1.1.1.2.1.cmml" xref="S3.SS3.p4.2.m1.1.1.2.1">^</ci><ci id="S3.SS3.p4.2.m1.1.1.2.2.cmml" xref="S3.SS3.p4.2.m1.1.1.2.2">ğ‘</ci></apply><ci id="S3.SS3.p4.2.m1.1.1.3a.cmml" xref="S3.SS3.p4.2.m1.1.1.3"><mtext mathsize="70%" id="S3.SS3.p4.2.m1.1.1.3.cmml" xref="S3.SS3.p4.2.m1.1.1.3">pre</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m1.1c">\hat{p}_{\text{\scriptsize pre}}</annotation></semantics></math> is the compressed preprompt.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.1" class="ltx_p"><span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_bold">Execution.</span>
Finally, the predicted answer <math id="S3.SS3.p5.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">a</annotation></semantics></math> to the question is obtained by executing the code as follows:</p>
<table id="Sx1.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E11.m1.3" class="ltx_Math" alttext="\displaystyle a=\Lambda(x,z)," display="inline"><semantics id="S3.E11.m1.3a"><mrow id="S3.E11.m1.3.3.1" xref="S3.E11.m1.3.3.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml"><mi id="S3.E11.m1.3.3.1.1.2" xref="S3.E11.m1.3.3.1.1.2.cmml">a</mi><mo id="S3.E11.m1.3.3.1.1.1" xref="S3.E11.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E11.m1.3.3.1.1.3" xref="S3.E11.m1.3.3.1.1.3.cmml"><mi mathvariant="normal" id="S3.E11.m1.3.3.1.1.3.2" xref="S3.E11.m1.3.3.1.1.3.2.cmml">Î›</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.3.1" xref="S3.E11.m1.3.3.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E11.m1.3.3.1.1.3.3.2" xref="S3.E11.m1.3.3.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E11.m1.3.3.1.1.3.3.2.1" xref="S3.E11.m1.3.3.1.1.3.3.1.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">x</mi><mo id="S3.E11.m1.3.3.1.1.3.3.2.2" xref="S3.E11.m1.3.3.1.1.3.3.1.cmml">,</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">z</mi><mo stretchy="false" id="S3.E11.m1.3.3.1.1.3.3.2.3" xref="S3.E11.m1.3.3.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m1.3.3.1.2" xref="S3.E11.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.3b"><apply id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1"><eq id="S3.E11.m1.3.3.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1"></eq><ci id="S3.E11.m1.3.3.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2">ğ‘</ci><apply id="S3.E11.m1.3.3.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.3"><times id="S3.E11.m1.3.3.1.1.3.1.cmml" xref="S3.E11.m1.3.3.1.1.3.1"></times><ci id="S3.E11.m1.3.3.1.1.3.2.cmml" xref="S3.E11.m1.3.3.1.1.3.2">Î›</ci><interval closure="open" id="S3.E11.m1.3.3.1.1.3.3.1.cmml" xref="S3.E11.m1.3.3.1.1.3.3.2"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">ğ‘¥</ci><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">ğ‘§</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.3c">\displaystyle a=\Lambda(x,z),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p5.3" class="ltx_p">where <math id="S3.SS3.p5.2.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.p5.2.m1.1a"><mi id="S3.SS3.p5.2.m1.1.1" xref="S3.SS3.p5.2.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m1.1b"><ci id="S3.SS3.p5.2.m1.1.1.cmml" xref="S3.SS3.p5.2.m1.1.1">ğ‘¥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m1.1c">x</annotation></semantics></math> is an input image, and <math id="S3.SS3.p5.3.m2.1" class="ltx_Math" alttext="\Lambda" display="inline"><semantics id="S3.SS3.p5.3.m2.1a"><mi mathvariant="normal" id="S3.SS3.p5.3.m2.1.1" xref="S3.SS3.p5.3.m2.1.1.cmml">Î›</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m2.1b"><ci id="S3.SS3.p5.3.m2.1.1.cmml" xref="S3.SS3.p5.3.m2.1.1">Î›</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m2.1c">\Lambda</annotation></semantics></math> is the Python execution engine.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Discussion</h3>

<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.1" class="ltx_p"><span id="S3.SS4.p1.1.1" class="ltx_text ltx_font_bold">AdaCoder formulation.</span>
By substituting Eqs.Â (<a href="#S3.E8" title="In 3.3. Inference phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) and (<a href="#S3.E9" title="In 3.3. Inference phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) into Eq.Â (<a href="#S3.E10" title="In 3.3. Inference phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>), we can finally define the code generation module <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\Pi_{\text{\scriptsize Ada}}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">Î </mi><mtext id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3a.cmml">Ada</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">Î </ci><ci id="S3.SS4.p1.1.m1.1.1.3a.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">Ada</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\Pi_{\text{\scriptsize Ada}}</annotation></semantics></math> of AdaCoder as follows:</p>
<table id="Sx1.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E12.m1.3" class="ltx_Math" alttext="\displaystyle\Pi_{\text{\scriptsize Ada}}(q)=\pi\left(\Psi\left(\hat{p}_{\text{\scriptsize def}},p_{\text{\scriptsize inst}},\hat{c}_{\pi(p_{\text{\scriptsize cls}}+q)}\right)+q\right)," display="inline"><semantics id="S3.E12.m1.3a"><mrow id="S3.E12.m1.3.3.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1.3" xref="S3.E12.m1.3.3.1.1.3.cmml"><msub id="S3.E12.m1.3.3.1.1.3.2" xref="S3.E12.m1.3.3.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.E12.m1.3.3.1.1.3.2.2" xref="S3.E12.m1.3.3.1.1.3.2.2.cmml">Î </mi><mtext id="S3.E12.m1.3.3.1.1.3.2.3" xref="S3.E12.m1.3.3.1.1.3.2.3a.cmml">Ada</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.1.1.3.1" xref="S3.E12.m1.3.3.1.1.3.1.cmml">â€‹</mo><mrow id="S3.E12.m1.3.3.1.1.3.3.2" xref="S3.E12.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E12.m1.3.3.1.1.3.3.2.1" xref="S3.E12.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E12.m1.2.2" xref="S3.E12.m1.2.2.cmml">q</mi><mo stretchy="false" id="S3.E12.m1.3.3.1.1.3.3.2.2" xref="S3.E12.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.2" xref="S3.E12.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.1.cmml"><mi id="S3.E12.m1.3.3.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.3.3.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E12.m1.3.3.1.1.1.1.1.1.3.5" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.5.cmml">Î¨</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.1.1.1.1.1.1.3.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.4.cmml">â€‹</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.4.cmml"><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mtext id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.3a.cmml">def</mtext></msub><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.5" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml">p</mi><mtext id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.3a.cmml">inst</mtext></msub><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.6" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.cmml"><mover accent="true" id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.2.cmml">c</mi><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.1.cmml">^</mo></mover><mrow id="S3.E12.m1.1.1.1" xref="S3.E12.m1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.3" xref="S3.E12.m1.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.2" xref="S3.E12.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E12.m1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><msub id="S3.E12.m1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mtext mathsize="140%" id="S3.E12.m1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.1.1.2.3a.cmml">cls</mtext></msub><mo id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E12.m1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.7" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.4" xref="S3.E12.m1.3.3.1.1.1.1.1.1.4.cmml">+</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.5" xref="S3.E12.m1.3.3.1.1.1.1.1.1.5.cmml">q</mi></mrow><mo id="S3.E12.m1.3.3.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.3.3.1.2" xref="S3.E12.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.3b"><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1"><eq id="S3.E12.m1.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2"></eq><apply id="S3.E12.m1.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3"><times id="S3.E12.m1.3.3.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.3.1"></times><apply id="S3.E12.m1.3.3.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.2.1.cmml" xref="S3.E12.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.3.2.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2.2">Î </ci><ci id="S3.E12.m1.3.3.1.1.3.2.3a.cmml" xref="S3.E12.m1.3.3.1.1.3.2.3"><mtext mathsize="70%" id="S3.E12.m1.3.3.1.1.3.2.3.cmml" xref="S3.E12.m1.3.3.1.1.3.2.3">Ada</mtext></ci></apply><ci id="S3.E12.m1.2.2.cmml" xref="S3.E12.m1.2.2">ğ‘</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1"><times id="S3.E12.m1.3.3.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.2"></times><ci id="S3.E12.m1.3.3.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.3">ğœ‹</ci><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1"><plus id="S3.E12.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.4"></plus><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3"><times id="S3.E12.m1.3.3.1.1.1.1.1.1.3.4.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.4"></times><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.5.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.5">Î¨</ci><vector id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3"><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">ğ‘</ci></apply><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">def</mtext></ci></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.2">ğ‘</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.3a.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.2.3">inst</mtext></ci></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2"><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.1">^</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.3.3.2.2">ğ‘</ci></apply><apply id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1.1"><times id="S3.E12.m1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.2"></times><ci id="S3.E12.m1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.3">ğœ‹</ci><apply id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1"><plus id="S3.E12.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E12.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.2">ğ‘</ci><ci id="S3.E12.m1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E12.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2.3">cls</mtext></ci></apply><ci id="S3.E12.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3">ğ‘</ci></apply></apply></apply></vector></apply><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.5.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.5">ğ‘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.3c">\displaystyle\Pi_{\text{\scriptsize Ada}}(q)=\pi\left(\Psi\left(\hat{p}_{\text{\scriptsize def}},p_{\text{\scriptsize inst}},\hat{c}_{\pi(p_{\text{\scriptsize cls}}+q)}\right)+q\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.2" class="ltx_p">by which a code is generated as <math id="S3.SS4.p1.2.m1.1" class="ltx_Math" alttext="z=\Pi_{\text{\scriptsize Ada}}(q)" display="inline"><semantics id="S3.SS4.p1.2.m1.1a"><mrow id="S3.SS4.p1.2.m1.1.2" xref="S3.SS4.p1.2.m1.1.2.cmml"><mi id="S3.SS4.p1.2.m1.1.2.2" xref="S3.SS4.p1.2.m1.1.2.2.cmml">z</mi><mo id="S3.SS4.p1.2.m1.1.2.1" xref="S3.SS4.p1.2.m1.1.2.1.cmml">=</mo><mrow id="S3.SS4.p1.2.m1.1.2.3" xref="S3.SS4.p1.2.m1.1.2.3.cmml"><msub id="S3.SS4.p1.2.m1.1.2.3.2" xref="S3.SS4.p1.2.m1.1.2.3.2.cmml"><mi mathvariant="normal" id="S3.SS4.p1.2.m1.1.2.3.2.2" xref="S3.SS4.p1.2.m1.1.2.3.2.2.cmml">Î </mi><mtext id="S3.SS4.p1.2.m1.1.2.3.2.3" xref="S3.SS4.p1.2.m1.1.2.3.2.3a.cmml">Ada</mtext></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m1.1.2.3.1" xref="S3.SS4.p1.2.m1.1.2.3.1.cmml">â€‹</mo><mrow id="S3.SS4.p1.2.m1.1.2.3.3.2" xref="S3.SS4.p1.2.m1.1.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m1.1.2.3.3.2.1" xref="S3.SS4.p1.2.m1.1.2.3.cmml">(</mo><mi id="S3.SS4.p1.2.m1.1.1" xref="S3.SS4.p1.2.m1.1.1.cmml">q</mi><mo stretchy="false" id="S3.SS4.p1.2.m1.1.2.3.3.2.2" xref="S3.SS4.p1.2.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m1.1b"><apply id="S3.SS4.p1.2.m1.1.2.cmml" xref="S3.SS4.p1.2.m1.1.2"><eq id="S3.SS4.p1.2.m1.1.2.1.cmml" xref="S3.SS4.p1.2.m1.1.2.1"></eq><ci id="S3.SS4.p1.2.m1.1.2.2.cmml" xref="S3.SS4.p1.2.m1.1.2.2">ğ‘§</ci><apply id="S3.SS4.p1.2.m1.1.2.3.cmml" xref="S3.SS4.p1.2.m1.1.2.3"><times id="S3.SS4.p1.2.m1.1.2.3.1.cmml" xref="S3.SS4.p1.2.m1.1.2.3.1"></times><apply id="S3.SS4.p1.2.m1.1.2.3.2.cmml" xref="S3.SS4.p1.2.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m1.1.2.3.2.1.cmml" xref="S3.SS4.p1.2.m1.1.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.2.m1.1.2.3.2.2.cmml" xref="S3.SS4.p1.2.m1.1.2.3.2.2">Î </ci><ci id="S3.SS4.p1.2.m1.1.2.3.2.3a.cmml" xref="S3.SS4.p1.2.m1.1.2.3.2.3"><mtext mathsize="70%" id="S3.SS4.p1.2.m1.1.2.3.2.3.cmml" xref="S3.SS4.p1.2.m1.1.2.3.2.3">Ada</mtext></ci></apply><ci id="S3.SS4.p1.2.m1.1.1.cmml" xref="S3.SS4.p1.2.m1.1.1">ğ‘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m1.1c">z=\Pi_{\text{\scriptsize Ada}}(q)</annotation></semantics></math>.
The total token length is given by</p>
<table id="Sx1.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.4" class="ltx_Math" alttext="\displaystyle\ell(q;\Pi_{\text{\scriptsize Ada}})=|\hat{p}_{\text{\scriptsize def}}|+|p_{\text{\scriptsize inst}}|+|p_{\text{\scriptsize cls}}|+|\hat{c}_{\pi(p_{\text{\scriptsize cls}}+q)}|+2|q|." display="inline"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4.4.1" xref="S3.E13.m1.4.4.1.1.cmml"><mrow id="S3.E13.m1.4.4.1.1" xref="S3.E13.m1.4.4.1.1.cmml"><mrow id="S3.E13.m1.4.4.1.1.1" xref="S3.E13.m1.4.4.1.1.1.cmml"><mi mathvariant="normal" id="S3.E13.m1.4.4.1.1.1.3" xref="S3.E13.m1.4.4.1.1.1.3.cmml">â„“</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E13.m1.4.4.1.1.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml">q</mi><mo id="S3.E13.m1.4.4.1.1.1.1.1.3" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml">;</mo><msub id="S3.E13.m1.4.4.1.1.1.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E13.m1.4.4.1.1.1.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.1.1.1.2.cmml">Î </mi><mtext id="S3.E13.m1.4.4.1.1.1.1.1.1.3" xref="S3.E13.m1.4.4.1.1.1.1.1.1.3a.cmml">Ada</mtext></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.1.1.1.4" xref="S3.E13.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.4.4.1.1.6" xref="S3.E13.m1.4.4.1.1.6.cmml">=</mo><mrow id="S3.E13.m1.4.4.1.1.5" xref="S3.E13.m1.4.4.1.1.5.cmml"><mrow id="S3.E13.m1.4.4.1.1.2.1.1" xref="S3.E13.m1.4.4.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.2.1.1.2" xref="S3.E13.m1.4.4.1.1.2.1.2.1.cmml">|</mo><msub id="S3.E13.m1.4.4.1.1.2.1.1.1" xref="S3.E13.m1.4.4.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.E13.m1.4.4.1.1.2.1.1.1.2" xref="S3.E13.m1.4.4.1.1.2.1.1.1.2.cmml"><mi id="S3.E13.m1.4.4.1.1.2.1.1.1.2.2" xref="S3.E13.m1.4.4.1.1.2.1.1.1.2.2.cmml">p</mi><mo id="S3.E13.m1.4.4.1.1.2.1.1.1.2.1" xref="S3.E13.m1.4.4.1.1.2.1.1.1.2.1.cmml">^</mo></mover><mtext id="S3.E13.m1.4.4.1.1.2.1.1.1.3" xref="S3.E13.m1.4.4.1.1.2.1.1.1.3a.cmml">def</mtext></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.2.1.1.3" xref="S3.E13.m1.4.4.1.1.2.1.2.1.cmml">|</mo></mrow><mo id="S3.E13.m1.4.4.1.1.5.5" xref="S3.E13.m1.4.4.1.1.5.5.cmml">+</mo><mrow id="S3.E13.m1.4.4.1.1.3.2.1" xref="S3.E13.m1.4.4.1.1.3.2.2.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.3.2.1.2" xref="S3.E13.m1.4.4.1.1.3.2.2.1.cmml">|</mo><msub id="S3.E13.m1.4.4.1.1.3.2.1.1" xref="S3.E13.m1.4.4.1.1.3.2.1.1.cmml"><mi id="S3.E13.m1.4.4.1.1.3.2.1.1.2" xref="S3.E13.m1.4.4.1.1.3.2.1.1.2.cmml">p</mi><mtext id="S3.E13.m1.4.4.1.1.3.2.1.1.3" xref="S3.E13.m1.4.4.1.1.3.2.1.1.3a.cmml">inst</mtext></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.3.2.1.3" xref="S3.E13.m1.4.4.1.1.3.2.2.1.cmml">|</mo></mrow><mo id="S3.E13.m1.4.4.1.1.5.5a" xref="S3.E13.m1.4.4.1.1.5.5.cmml">+</mo><mrow id="S3.E13.m1.4.4.1.1.4.3.1" xref="S3.E13.m1.4.4.1.1.4.3.2.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.4.3.1.2" xref="S3.E13.m1.4.4.1.1.4.3.2.1.cmml">|</mo><msub id="S3.E13.m1.4.4.1.1.4.3.1.1" xref="S3.E13.m1.4.4.1.1.4.3.1.1.cmml"><mi id="S3.E13.m1.4.4.1.1.4.3.1.1.2" xref="S3.E13.m1.4.4.1.1.4.3.1.1.2.cmml">p</mi><mtext id="S3.E13.m1.4.4.1.1.4.3.1.1.3" xref="S3.E13.m1.4.4.1.1.4.3.1.1.3a.cmml">cls</mtext></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.4.3.1.3" xref="S3.E13.m1.4.4.1.1.4.3.2.1.cmml">|</mo></mrow><mo id="S3.E13.m1.4.4.1.1.5.5b" xref="S3.E13.m1.4.4.1.1.5.5.cmml">+</mo><mrow id="S3.E13.m1.4.4.1.1.5.4.1" xref="S3.E13.m1.4.4.1.1.5.4.2.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.5.4.1.2" xref="S3.E13.m1.4.4.1.1.5.4.2.1.cmml">|</mo><msub id="S3.E13.m1.4.4.1.1.5.4.1.1" xref="S3.E13.m1.4.4.1.1.5.4.1.1.cmml"><mover accent="true" id="S3.E13.m1.4.4.1.1.5.4.1.1.2" xref="S3.E13.m1.4.4.1.1.5.4.1.1.2.cmml"><mi id="S3.E13.m1.4.4.1.1.5.4.1.1.2.2" xref="S3.E13.m1.4.4.1.1.5.4.1.1.2.2.cmml">c</mi><mo id="S3.E13.m1.4.4.1.1.5.4.1.1.2.1" xref="S3.E13.m1.4.4.1.1.5.4.1.1.2.1.cmml">^</mo></mover><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.3" xref="S3.E13.m1.1.1.1.3.cmml">Ï€</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><msub id="S3.E13.m1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.2.2" xref="S3.E13.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mtext mathsize="140%" id="S3.E13.m1.1.1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.1.1.2.3a.cmml">cls</mtext></msub><mo id="S3.E13.m1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E13.m1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.5.4.1.3" xref="S3.E13.m1.4.4.1.1.5.4.2.1.cmml">|</mo></mrow><mo id="S3.E13.m1.4.4.1.1.5.5c" xref="S3.E13.m1.4.4.1.1.5.5.cmml">+</mo><mrow id="S3.E13.m1.4.4.1.1.5.6" xref="S3.E13.m1.4.4.1.1.5.6.cmml"><mn id="S3.E13.m1.4.4.1.1.5.6.2" xref="S3.E13.m1.4.4.1.1.5.6.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.5.6.1" xref="S3.E13.m1.4.4.1.1.5.6.1.cmml">â€‹</mo><mrow id="S3.E13.m1.4.4.1.1.5.6.3.2" xref="S3.E13.m1.4.4.1.1.5.6.3.1.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.5.6.3.2.1" xref="S3.E13.m1.4.4.1.1.5.6.3.1.1.cmml">|</mo><mi id="S3.E13.m1.3.3" xref="S3.E13.m1.3.3.cmml">q</mi><mo stretchy="false" id="S3.E13.m1.4.4.1.1.5.6.3.2.2" xref="S3.E13.m1.4.4.1.1.5.6.3.1.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E13.m1.4.4.1.2" xref="S3.E13.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.4b"><apply id="S3.E13.m1.4.4.1.1.cmml" xref="S3.E13.m1.4.4.1"><eq id="S3.E13.m1.4.4.1.1.6.cmml" xref="S3.E13.m1.4.4.1.1.6"></eq><apply id="S3.E13.m1.4.4.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1"><times id="S3.E13.m1.4.4.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.1.2"></times><ci id="S3.E13.m1.4.4.1.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.1.3">â„“</ci><list id="S3.E13.m1.4.4.1.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1"><ci id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2">ğ‘</ci><apply id="S3.E13.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1.2">Î </ci><ci id="S3.E13.m1.4.4.1.1.1.1.1.1.3a.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S3.E13.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1.3">Ada</mtext></ci></apply></list></apply><apply id="S3.E13.m1.4.4.1.1.5.cmml" xref="S3.E13.m1.4.4.1.1.5"><plus id="S3.E13.m1.4.4.1.1.5.5.cmml" xref="S3.E13.m1.4.4.1.1.5.5"></plus><apply id="S3.E13.m1.4.4.1.1.2.1.2.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1"><abs id="S3.E13.m1.4.4.1.1.2.1.2.1.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.2"></abs><apply id="S3.E13.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1">subscript</csymbol><apply id="S3.E13.m1.4.4.1.1.2.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1.2"><ci id="S3.E13.m1.4.4.1.1.2.1.1.1.2.1.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1.2.1">^</ci><ci id="S3.E13.m1.4.4.1.1.2.1.1.1.2.2.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1.2.2">ğ‘</ci></apply><ci id="S3.E13.m1.4.4.1.1.2.1.1.1.3a.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1.3"><mtext mathsize="70%" id="S3.E13.m1.4.4.1.1.2.1.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.2.1.1.1.3">def</mtext></ci></apply></apply><apply id="S3.E13.m1.4.4.1.1.3.2.2.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1"><abs id="S3.E13.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1.2"></abs><apply id="S3.E13.m1.4.4.1.1.3.2.1.1.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.3.2.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1.1">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.3.2.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1.1.2">ğ‘</ci><ci id="S3.E13.m1.4.4.1.1.3.2.1.1.3a.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1.1.3"><mtext mathsize="70%" id="S3.E13.m1.4.4.1.1.3.2.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.3.2.1.1.3">inst</mtext></ci></apply></apply><apply id="S3.E13.m1.4.4.1.1.4.3.2.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1"><abs id="S3.E13.m1.4.4.1.1.4.3.2.1.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1.2"></abs><apply id="S3.E13.m1.4.4.1.1.4.3.1.1.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.4.3.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1.1">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.4.3.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1.1.2">ğ‘</ci><ci id="S3.E13.m1.4.4.1.1.4.3.1.1.3a.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1.1.3"><mtext mathsize="70%" id="S3.E13.m1.4.4.1.1.4.3.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.4.3.1.1.3">cls</mtext></ci></apply></apply><apply id="S3.E13.m1.4.4.1.1.5.4.2.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1"><abs id="S3.E13.m1.4.4.1.1.5.4.2.1.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1.2"></abs><apply id="S3.E13.m1.4.4.1.1.5.4.1.1.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.5.4.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1.1">subscript</csymbol><apply id="S3.E13.m1.4.4.1.1.5.4.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1.1.2"><ci id="S3.E13.m1.4.4.1.1.5.4.1.1.2.1.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1.1.2.1">^</ci><ci id="S3.E13.m1.4.4.1.1.5.4.1.1.2.2.cmml" xref="S3.E13.m1.4.4.1.1.5.4.1.1.2.2">ğ‘</ci></apply><apply id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><times id="S3.E13.m1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.2"></times><ci id="S3.E13.m1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.3">ğœ‹</ci><apply id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"><plus id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E13.m1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2">ğ‘</ci><ci id="S3.E13.m1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.3"><mtext mathsize="70%" id="S3.E13.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.3">cls</mtext></ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.3">ğ‘</ci></apply></apply></apply></apply><apply id="S3.E13.m1.4.4.1.1.5.6.cmml" xref="S3.E13.m1.4.4.1.1.5.6"><times id="S3.E13.m1.4.4.1.1.5.6.1.cmml" xref="S3.E13.m1.4.4.1.1.5.6.1"></times><cn type="integer" id="S3.E13.m1.4.4.1.1.5.6.2.cmml" xref="S3.E13.m1.4.4.1.1.5.6.2">2</cn><apply id="S3.E13.m1.4.4.1.1.5.6.3.1.cmml" xref="S3.E13.m1.4.4.1.1.5.6.3.2"><abs id="S3.E13.m1.4.4.1.1.5.6.3.1.1.cmml" xref="S3.E13.m1.4.4.1.1.5.6.3.2.1"></abs><ci id="S3.E13.m1.3.3.cmml" xref="S3.E13.m1.3.3">ğ‘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.4c">\displaystyle\ell(q;\Pi_{\text{\scriptsize Ada}})=|\hat{p}_{\text{\scriptsize def}}|+|p_{\text{\scriptsize inst}}|+|p_{\text{\scriptsize cls}}|+|\hat{c}_{\pi(p_{\text{\scriptsize cls}}+q)}|+2|q|.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.3" class="ltx_p">Below, we discuss the computational cost and adaptiveness.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.2" class="ltx_p"><span id="S3.SS4.p2.2.1" class="ltx_text ltx_font_bold">Computational cost.</span>
Although, in the first sight, AdaCoder seems computationally more expensive than the conventional code generation module in Eq.Â (<a href="#S3.E3" title="In 3.1. Preliminary â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) because the LLM <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">Ï€</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">ğœ‹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\pi</annotation></semantics></math> is called twice in Eq.Â (<a href="#S3.E12" title="In 3.4. Discussion â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>); indeed, AdaCoder improves the computational efficiency in practice when a black-box LLM such as GPT or Claude is used for <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">Ï€</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">ğœ‹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\pi</annotation></semantics></math> with state-of-the-art VPMs such as ViperGPT, because the input token length is significantly shortened.
Compared to previous prompt compression methods such as LLMLingua, our approach is more efficient and effective because it can
reduce the token length while preserving the structure of code.
We will experimentally demonstrate this in SectionÂ <a href="#S4.SS2" title="4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.1.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Question type definition for the GQA dataset.</figcaption>
<table id="S3.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.2.2" class="ltx_tr">
<th id="S3.T1.1.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S3.T1.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.1.1.1.1.1" class="ltx_p" style="width:37.3pt;"><span id="S3.T1.1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">Type </span><math id="S3.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.T1.1.1.1.1.1.m1.1a"><mi mathsize="80%" id="S3.T1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.m1.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.m1.1c">t</annotation></semantics></math></span>
</span>
</th>
<th id="S3.T1.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S3.T1.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.2.2.1.1" class="ltx_p" style="width:368.6pt;"><span id="S3.T1.2.2.2.1.1.1" class="ltx_text" style="font-size:80%;">Definition </span><math id="S3.T1.2.2.2.1.1.m1.1" class="ltx_Math" alttext="d_{t}" display="inline"><semantics id="S3.T1.2.2.2.1.1.m1.1a"><msub id="S3.T1.2.2.2.1.1.m1.1.1" xref="S3.T1.2.2.2.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S3.T1.2.2.2.1.1.m1.1.1.2" xref="S3.T1.2.2.2.1.1.m1.1.1.2.cmml">d</mi><mi mathsize="80%" id="S3.T1.2.2.2.1.1.m1.1.1.3" xref="S3.T1.2.2.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.1.1.m1.1b"><apply id="S3.T1.2.2.2.1.1.m1.1.1.cmml" xref="S3.T1.2.2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.2.2.1.1.m1.1.1.1.cmml" xref="S3.T1.2.2.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.2.2.2.1.1.m1.1.1.2.cmml" xref="S3.T1.2.2.2.1.1.m1.1.1.2">ğ‘‘</ci><ci id="S3.T1.2.2.2.1.1.m1.1.1.3.cmml" xref="S3.T1.2.2.2.1.1.m1.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.1.1.m1.1c">d_{t}</annotation></semantics></math></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.2.3.1" class="ltx_tr">
<td id="S3.T1.2.3.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S3.T1.2.3.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.3.1.1.1.1" class="ltx_p" style="width:37.3pt;"><span id="S3.T1.2.3.1.1.1.1.1" class="ltx_text" style="font-size:80%;">obj</span></span>
</span>
</td>
<td id="S3.T1.2.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" style="background-color:#ECECEC;">
<span id="S3.T1.2.3.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.3.1.2.1.1" class="ltx_p" style="width:368.6pt;"><span id="S3.T1.2.3.1.2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;background-color:#ECECEC;">question asking existence of object.</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.2.4.2" class="ltx_tr">
<td id="S3.T1.2.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.2.4.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.4.2.1.1.1" class="ltx_p" style="width:37.3pt;"><span id="S3.T1.2.4.2.1.1.1.1" class="ltx_text" style="font-size:80%;">cat</span></span>
</span>
</td>
<td id="S3.T1.2.4.2.2" class="ltx_td ltx_align_justify ltx_align_top" style="background-color:#ECECEC;">
<span id="S3.T1.2.4.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.4.2.2.1.1" class="ltx_p" style="width:368.6pt;"><span id="S3.T1.2.4.2.2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;background-color:#ECECEC;">question related to object identification within some category.</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.2.5.3" class="ltx_tr">
<td id="S3.T1.2.5.3.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.2.5.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.5.3.1.1.1" class="ltx_p" style="width:37.3pt;"><span id="S3.T1.2.5.3.1.1.1.1" class="ltx_text" style="font-size:80%;">attr</span></span>
</span>
</td>
<td id="S3.T1.2.5.3.2" class="ltx_td ltx_align_justify ltx_align_top" style="background-color:#ECECEC;">
<span id="S3.T1.2.5.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.5.3.2.1.1" class="ltx_p" style="width:368.6pt;"><span id="S3.T1.2.5.3.2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;background-color:#ECECEC;">question asking about the attributes or position of an object. (e.g. "What is the color of bar?", "On which of image is the foo?")</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.2.6.4" class="ltx_tr">
<td id="S3.T1.2.6.4.1" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.T1.2.6.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.6.4.1.1.1" class="ltx_p" style="width:37.3pt;"><span id="S3.T1.2.6.4.1.1.1.1" class="ltx_text" style="font-size:80%;">rel</span></span>
</span>
</td>
<td id="S3.T1.2.6.4.2" class="ltx_td ltx_align_justify ltx_align_top" style="background-color:#ECECEC;">
<span id="S3.T1.2.6.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.6.4.2.1.1" class="ltx_p" style="width:368.6pt;"><span id="S3.T1.2.6.4.2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;background-color:#ECECEC;">question derived from an affirmative sentence and asking about its subject or object (e.g. "What is the foo next to the baz wearing?", "Is the qux holding a quux?").</span></span>
</span>
</td>
</tr>
<tr id="S3.T1.2.7.5" class="ltx_tr">
<td id="S3.T1.2.7.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">
<span id="S3.T1.2.7.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.7.5.1.1.1" class="ltx_p" style="width:37.3pt;"><span id="S3.T1.2.7.5.1.1.1.1" class="ltx_text" style="font-size:80%;">global</span></span>
</span>
</td>
<td id="S3.T1.2.7.5.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" style="background-color:#ECECEC;">
<span id="S3.T1.2.7.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.T1.2.7.5.2.1.1" class="ltx_p" style="width:368.6pt;"><span id="S3.T1.2.7.5.2.1.1.1" class="ltx_text ltx_font_typewriter" style="font-size:80%;background-color:#ECECEC;">question asking about the entire situation of the scene, such as weather or facility (e.g. "Is it foo?").</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS4.p3" class="ltx_para ltx_noindent">
<p id="S3.SS4.p3.1" class="ltx_p"><span id="S3.SS4.p3.1.1" class="ltx_text ltx_font_bold">Adaptiveness.</span> A major strength of AdaCoder is that it does not require additional training to adaptively compress the preprompt. Since recent black-box LLMs exhibit quite high zero-shot performance on text processing tasks such as text classification and summarization, AdaCoder leverages these capabilities to enhance efficiency and reduce the computational costs of VPMs.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental settings</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span>
We use three VQA datasets for evaluation:
GQAÂ <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>, VQAv2Â <cite class="ltx_cite ltx_citemacro_citep">(Goyal etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite>, and NLVR2Â <cite class="ltx_cite ltx_citemacro_citep">(Suhr etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>)</cite>.
The GQA dataset is designed to test a modelâ€™s visual reasoning abilities, encompassing five question types: existence of objects (obj), category of objects (cat), attributes of objects (attr), relationships between subjects and/or objects (rel), and global questions (global).
The VQAv2 dataset contains open-ended questions about images that require an understanding of visual content to generate answers.
The NLVR2 dataset is designed to test a modelâ€™s ability to understand complex natural language statements and their correspondence to a given pair of images.
From each of these two dataset, we randomly choose 2,000 QAs<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>This is due to the usage limits of Claude and GPT. The list of sampled QA IDs will be provided along with our code.</span></span></span>.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2407.19410/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="147" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Classification prompt for the inference phase. <span id="S4.F4.7.1" class="ltx_text ltx_font_typewriter">{type[i]}</span> and <span id="S4.F4.8.2" class="ltx_text ltx_font_typewriter">{type_definition[i]}</span> are placeholders for names and definitions of question type, respectively, for <math id="S4.F4.3.m1.4" class="ltx_Math" alttext="i=0,1,\cdots,n" display="inline"><semantics id="S4.F4.3.m1.4b"><mrow id="S4.F4.3.m1.4.5" xref="S4.F4.3.m1.4.5.cmml"><mi id="S4.F4.3.m1.4.5.2" xref="S4.F4.3.m1.4.5.2.cmml">i</mi><mo id="S4.F4.3.m1.4.5.1" xref="S4.F4.3.m1.4.5.1.cmml">=</mo><mrow id="S4.F4.3.m1.4.5.3.2" xref="S4.F4.3.m1.4.5.3.1.cmml"><mn id="S4.F4.3.m1.1.1" xref="S4.F4.3.m1.1.1.cmml">0</mn><mo id="S4.F4.3.m1.4.5.3.2.1" xref="S4.F4.3.m1.4.5.3.1.cmml">,</mo><mn id="S4.F4.3.m1.2.2" xref="S4.F4.3.m1.2.2.cmml">1</mn><mo id="S4.F4.3.m1.4.5.3.2.2" xref="S4.F4.3.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.F4.3.m1.3.3" xref="S4.F4.3.m1.3.3.cmml">â‹¯</mi><mo id="S4.F4.3.m1.4.5.3.2.3" xref="S4.F4.3.m1.4.5.3.1.cmml">,</mo><mi id="S4.F4.3.m1.4.4" xref="S4.F4.3.m1.4.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.3.m1.4c"><apply id="S4.F4.3.m1.4.5.cmml" xref="S4.F4.3.m1.4.5"><eq id="S4.F4.3.m1.4.5.1.cmml" xref="S4.F4.3.m1.4.5.1"></eq><ci id="S4.F4.3.m1.4.5.2.cmml" xref="S4.F4.3.m1.4.5.2">ğ‘–</ci><list id="S4.F4.3.m1.4.5.3.1.cmml" xref="S4.F4.3.m1.4.5.3.2"><cn type="integer" id="S4.F4.3.m1.1.1.cmml" xref="S4.F4.3.m1.1.1">0</cn><cn type="integer" id="S4.F4.3.m1.2.2.cmml" xref="S4.F4.3.m1.2.2">1</cn><ci id="S4.F4.3.m1.3.3.cmml" xref="S4.F4.3.m1.3.3">â‹¯</ci><ci id="S4.F4.3.m1.4.4.cmml" xref="S4.F4.3.m1.4.4">ğ‘›</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.3.m1.4d">i=0,1,\cdots,n</annotation></semantics></math> where <math id="S4.F4.4.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.F4.4.m2.1b"><mi id="S4.F4.4.m2.1.1" xref="S4.F4.4.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.F4.4.m2.1c"><ci id="S4.F4.4.m2.1.1.cmml" xref="S4.F4.4.m2.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.m2.1d">n</annotation></semantics></math> is the number of question types.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Comparison with other methods.
AdaCoder is compared with ViperGPTÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite>, LLMLinguaÂ <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite>, and Simple compression that omits QA classification prompts.
</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.4.1" class="ltx_tr">
<th id="S4.T2.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.3.4.1.1.1" class="ltx_text">Method</span></th>
<th id="S4.T2.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.3.4.1.2.1" class="ltx_text">LLM</span></th>
<th id="S4.T2.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3">Accuracy (%)</th>
<th id="S4.T2.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="3">Input prompt</th>
<th id="S4.T2.3.4.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Output</th>
</tr>
<tr id="S4.T2.3.3" class="ltx_tr">
<th id="S4.T2.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">GQA</th>
<th id="S4.T2.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">VQAv2</th>
<th id="S4.T2.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">NLVR2</th>
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column">Token length <math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><mo stretchy="false" id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column">Characters <math id="S4.T2.2.2.2.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T2.2.2.2.m1.1a"><mo stretchy="false" id="S4.T2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.m1.1.1.cmml">â†“</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">â†“</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Reduction <math id="S4.T2.3.3.3.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T2.3.3.3.m1.1a"><mo stretchy="false" id="S4.T2.3.3.3.m1.1.1" xref="S4.T2.3.3.3.m1.1.1.cmml">â†‘</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.m1.1b"><ci id="S4.T2.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.m1.1.1">â†‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.m1.1c">\uparrow</annotation></semantics></math>
</th>
<th id="S4.T2.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">Token length</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.5.1" class="ltx_tr">
<td id="S4.T2.3.5.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ViperGPT baseline</td>
<td id="S4.T2.3.5.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">gpt-3.5-turbo</td>
<td id="S4.T2.3.5.1.3" class="ltx_td ltx_align_center ltx_border_t">41.3</td>
<td id="S4.T2.3.5.1.4" class="ltx_td ltx_align_center ltx_border_t">42.7</td>
<td id="S4.T2.3.5.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.2</td>
<td id="S4.T2.3.5.1.6" class="ltx_td ltx_align_center ltx_border_t">3,434</td>
<td id="S4.T2.3.5.1.7" class="ltx_td ltx_align_center ltx_border_t">15,950</td>
<td id="S4.T2.3.5.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T2.3.5.1.9" class="ltx_td ltx_align_center ltx_border_t">78</td>
</tr>
<tr id="S4.T2.3.6.2" class="ltx_tr">
<td id="S4.T2.3.6.2.1" class="ltx_td ltx_align_left ltx_border_r">LLMLingua</td>
<td id="S4.T2.3.6.2.2" class="ltx_td ltx_align_center ltx_border_r">gpt-3.5-turbo</td>
<td id="S4.T2.3.6.2.3" class="ltx_td ltx_align_center">39.1</td>
<td id="S4.T2.3.6.2.4" class="ltx_td ltx_align_center">45.2</td>
<td id="S4.T2.3.6.2.5" class="ltx_td ltx_align_center ltx_border_r">47.3</td>
<td id="S4.T2.3.6.2.6" class="ltx_td ltx_align_center">2,536</td>
<td id="S4.T2.3.6.2.7" class="ltx_td ltx_align_center">11,507</td>
<td id="S4.T2.3.6.2.8" class="ltx_td ltx_align_center ltx_border_r">26.2%</td>
<td id="S4.T2.3.6.2.9" class="ltx_td ltx_align_center">71</td>
</tr>
<tr id="S4.T2.3.7.3" class="ltx_tr">
<td id="S4.T2.3.7.3.1" class="ltx_td ltx_align_left ltx_border_r">Simple compression</td>
<td id="S4.T2.3.7.3.2" class="ltx_td ltx_align_center ltx_border_r">gpt-3.5-turbo</td>
<td id="S4.T2.3.7.3.3" class="ltx_td ltx_align_center">28.9</td>
<td id="S4.T2.3.7.3.4" class="ltx_td ltx_align_center">42.6</td>
<td id="S4.T2.3.7.3.5" class="ltx_td ltx_align_center ltx_border_r">50.3</td>
<td id="S4.T2.3.7.3.6" class="ltx_td ltx_align_center">810</td>
<td id="S4.T2.3.7.3.7" class="ltx_td ltx_align_center">3,553</td>
<td id="S4.T2.3.7.3.8" class="ltx_td ltx_align_center ltx_border_r">76.4%</td>
<td id="S4.T2.3.7.3.9" class="ltx_td ltx_align_center">80</td>
</tr>
<tr id="S4.T2.3.8.4" class="ltx_tr">
<td id="S4.T2.3.8.4.1" class="ltx_td ltx_align_left ltx_border_r">AdaCoder (Ours)</td>
<td id="S4.T2.3.8.4.2" class="ltx_td ltx_align_center ltx_border_r">gpt-3.5-turbo</td>
<td id="S4.T2.3.8.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.3.8.4.3.1" class="ltx_text ltx_font_bold">43.6</span></td>
<td id="S4.T2.3.8.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.3.8.4.4.1" class="ltx_text ltx_font_bold">46.2</span></td>
<td id="S4.T2.3.8.4.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T2.3.8.4.5.1" class="ltx_text ltx_font_bold">60.8</span></td>
<td id="S4.T2.3.8.4.6" class="ltx_td ltx_align_center">993</td>
<td id="S4.T2.3.8.4.7" class="ltx_td ltx_align_center">4,343</td>
<td id="S4.T2.3.8.4.8" class="ltx_td ltx_align_center ltx_border_r">71.1%</td>
<td id="S4.T2.3.8.4.9" class="ltx_td ltx_align_center">77</td>
</tr>
<tr id="S4.T2.3.9.5" class="ltx_tr">
<td id="S4.T2.3.9.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">ViperGPT baseline</td>
<td id="S4.T2.3.9.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">claude-3-haiku</td>
<td id="S4.T2.3.9.5.3" class="ltx_td ltx_align_center ltx_border_t">40.4</td>
<td id="S4.T2.3.9.5.4" class="ltx_td ltx_align_center ltx_border_t">42.6</td>
<td id="S4.T2.3.9.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.9.5.5.1" class="ltx_text ltx_font_bold">60.1</span></td>
<td id="S4.T2.3.9.5.6" class="ltx_td ltx_align_center ltx_border_t">3,777</td>
<td id="S4.T2.3.9.5.7" class="ltx_td ltx_align_center ltx_border_t">15,950</td>
<td id="S4.T2.3.9.5.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T2.3.9.5.9" class="ltx_td ltx_align_center ltx_border_t">300</td>
</tr>
<tr id="S4.T2.3.10.6" class="ltx_tr">
<td id="S4.T2.3.10.6.1" class="ltx_td ltx_align_left ltx_border_r">LLMLingua</td>
<td id="S4.T2.3.10.6.2" class="ltx_td ltx_align_center ltx_border_r">claude-3-haiku</td>
<td id="S4.T2.3.10.6.3" class="ltx_td ltx_align_center">37.0</td>
<td id="S4.T2.3.10.6.4" class="ltx_td ltx_align_center">43.1</td>
<td id="S4.T2.3.10.6.5" class="ltx_td ltx_align_center ltx_border_r">59.5</td>
<td id="S4.T2.3.10.6.6" class="ltx_td ltx_align_center">2,766</td>
<td id="S4.T2.3.10.6.7" class="ltx_td ltx_align_center">11,507</td>
<td id="S4.T2.3.10.6.8" class="ltx_td ltx_align_center ltx_border_r">26.8%</td>
<td id="S4.T2.3.10.6.9" class="ltx_td ltx_align_center">306</td>
</tr>
<tr id="S4.T2.3.11.7" class="ltx_tr">
<td id="S4.T2.3.11.7.1" class="ltx_td ltx_align_left ltx_border_r">Simple compression</td>
<td id="S4.T2.3.11.7.2" class="ltx_td ltx_align_center ltx_border_r">claude-3-haiku</td>
<td id="S4.T2.3.11.7.3" class="ltx_td ltx_align_center">14.5</td>
<td id="S4.T2.3.11.7.4" class="ltx_td ltx_align_center">23.6</td>
<td id="S4.T2.3.11.7.5" class="ltx_td ltx_align_center ltx_border_r">54,3</td>
<td id="S4.T2.3.11.7.6" class="ltx_td ltx_align_center">1,181</td>
<td id="S4.T2.3.11.7.7" class="ltx_td ltx_align_center">4,535</td>
<td id="S4.T2.3.11.7.8" class="ltx_td ltx_align_center ltx_border_r">68.7%</td>
<td id="S4.T2.3.11.7.9" class="ltx_td ltx_align_center">245</td>
</tr>
<tr id="S4.T2.3.12.8" class="ltx_tr">
<td id="S4.T2.3.12.8.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">AdaCoder (Ours)</td>
<td id="S4.T2.3.12.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">claude-3-haiku</td>
<td id="S4.T2.3.12.8.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.3.12.8.3.1" class="ltx_text ltx_font_bold">41.6</span></td>
<td id="S4.T2.3.12.8.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.3.12.8.4.1" class="ltx_text ltx_font_bold">44.7</span></td>
<td id="S4.T2.3.12.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T2.3.12.8.5.1" class="ltx_text ltx_font_bold">60.1</span></td>
<td id="S4.T2.3.12.8.6" class="ltx_td ltx_align_center ltx_border_bb">1,170</td>
<td id="S4.T2.3.12.8.7" class="ltx_td ltx_align_center ltx_border_bb">4,503</td>
<td id="S4.T2.3.12.8.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">69.0%</td>
<td id="S4.T2.3.12.8.9" class="ltx_td ltx_align_center ltx_border_bb">234</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Evaluation metrics.</span>
We use the exact match accuracy (%) for case-insensitive answers as a QA performance evaluation metric.
The reduction rate (%) of the input token length is used to evaluate the compression performance.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines.</span>
The baselines are ViperGPTÂ <cite class="ltx_cite ltx_citemacro_citep">(SurÃ­s etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2023</a>)</cite> and LLMLinguaÂ <cite class="ltx_cite ltx_citemacro_citep">(Jiang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>)</cite> applied to it. They are state-of-the-art VPM and prompt compression method, respectively.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.2" class="ltx_p"><span id="S4.SS1.p4.2.1" class="ltx_text ltx_font_bold">Implementation details.</span>
We implement AdaCoder on top of the official implementation of ViperGPT<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/cvlab-columbia/viper</span></span></span>.
The API set consists of basic image and text processing functions. Specifically, it consists of the <span id="S4.SS1.p4.2.2" class="ltx_text ltx_font_typewriter">ImagePatch</span> class and a set of auxiliary functions. The <span id="S4.SS1.p4.2.3" class="ltx_text ltx_font_typewriter">ImagePatch</span> class is a class to store a image region and has the following nine methods.</p>
<div id="S4.SS1.p4.1" class="ltx_logical-block ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:3pt;border-width:0.4pt;">
<div id="S4.SS1.p4.1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1.p1.1" class="ltx_p"><span id="S4.SS1.p4.1.p1.1.1" class="ltx_text" style="font-size:90%;">1) crop, 2) overlaps_with, 3) find, 4) exists, 5) best_text_match,</span>
<br class="ltx_break"><span id="S4.SS1.p4.1.p1.1.2" class="ltx_text" style="font-size:90%;">6) verify_property,
7) simple_query, 8) llm_query, 9) compute_depth.</span></p>
</div>
</div>
<p id="S4.SS1.p4.3" class="ltx_p">The auxiliary function set consists of the following four functions.</p>
<p id="S4.SS1.p4.4" class="ltx_p ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:3pt;border-width:0.4pt;"><span id="S4.SS1.p4.4.1" class="ltx_text" style="font-size:90%;">1) distance, 2) best_image_match, 3) bool_to_yesno, 4) coerce_to_numeric.</span></p>
<p id="S4.SS1.p4.5" class="ltx_p">Each method or function is provided with its definition in Python and example code snippets.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS1.p5.1" class="ltx_p"><span id="S4.SS1.p5.1.1" class="ltx_text ltx_font_bold">LLMs.</span>
We use GPT and Claude for both ViperGPT and AdaCoder.
For GPT, we use <span id="S4.SS1.p5.1.2" class="ltx_text ltx_font_typewriter">gpt-3.5-turbo</span>, released as version 1106, which is trained on data up to September 2021 and is provided by the OpenAI platform.
For Claude, we use <span id="S4.SS1.p5.1.3" class="ltx_text ltx_font_typewriter">claude-3-haiku</span>, released as version 20240307. This is a model trained using large amounts of feedback on long document tasks. Note that the original ViperGPT used <span id="S4.SS1.p5.1.4" class="ltx_text ltx_font_typewriter">code-davinci-002</span> (the GPT-3 CodexÂ <cite class="ltx_cite ltx_citemacro_citep">(Chen etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>), which was fine-tuned for code generation tasks and is no longer accessible.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Experimental results</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p"><a href="#S4.SS2" title="4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref ltx_font_bold" style="font-size:120%;"><span class="ltx_text ltx_ref_tag">4.2</span></a><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold" style="font-size:120%;">.1 â€„ Main results</span></p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">QA accuracy.</span>
TableÂ <a href="#S4.T2" title="Table 2 â€£ 4.1. Experimental settings â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows QA accuracy in comparison to the ViperGPT baseline. We see that AdaCoder reduces the input token length by 71.1%, while improving QA accuracy on all of the three datasets. This shows the effectiveness and efficiency of the proposed prompt compression method.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The simple compression setup omits the instruction prompt <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="r_{\text{\scriptsize sp}}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msub id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">r</mi><mtext id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3a.cmml">sp</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">ğ‘Ÿ</ci><ci id="S4.SS2.p3.1.m1.1.1.3a.cmml" xref="S4.SS2.p3.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">sp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">r_{\text{\scriptsize sp}}</annotation></semantics></math> to compress for specific question type (<span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_italic">i.e., </span> question type classification is omitted).
We see that the QA accuracy is significant degraded by this omission.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p">With LLMLingua, we observed that it cannot maintain the structure of code snippets in the preprompt after compression at a reduction rate of 71.1% (the same rate as ours), resulting in a QA accuracy of 0%. Therefore, the results in TableÂ <a href="#S4.T2" title="Table 2 â€£ 4.1. Experimental settings â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> are given at a lower reduction rate <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\simeq" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mo id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">â‰ƒ</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">similar-to-or-equals</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\simeq</annotation></semantics></math> 25% by adjusting the compression ratio parameter accordingly.
With this setting, LLMs can generate executable code with a probability of 98%; however, the QA accuracy is degraded by 2.2 points on GQA.
This shows that prompt compression for VPMs is challenging.
It is also worth noting that while our method is effective, it relies on QA classification and is not inherently a robust compression approach across all problems.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2407.19410/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="254" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Confusion matrix of question classification. Overall classification accuracy was 58.1%. (GQA dataset, gpt-3.5-turbo)</figcaption>
</figure>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.1" class="ltx_p"><span id="S4.SS2.p5.1.1" class="ltx_text ltx_font_bold">Question type classification.</span>
FigureÂ <a href="#S4.F5" title="Figure 5 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the confusion matrix of question type classification for the GQA dataset. We observe that two question types, â€œattrâ€ and â€œglobalâ€, achieve accuracies greater than 75%. The types â€œrelâ€ and â€œobjâ€ are often misclassified as â€œattrâ€ and â€œcatâ€, respectively. This is because the questions are often short, making it difficult to distinguish between them.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.2" class="ltx_p">To investigate how these classification errors affect the final QA accuracy, TableÂ <a href="#S4.T3" title="Table 3 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> compares AdaCoder using 1) predicted question types, 2) ground-truth question types, 3) random question types, and 4) without using question type based compression.
We observe three key findings.
First, the best performance is achieved by using ground truth question types. This highlights the importance of classifying question types to improve overall accuracy.
Second, the performance drop due to classification errors is less than 1.0 points.
This suggests that AdaCoder effectively classified the critical question types necessary for code generation, even though the accuracy for question classification is not very high.
Third, the method using random question types, which compresses prompts for each question type and randomly choose one of them in inference, is better than the method without question type based compression.
This is because the instruction prompt <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="r_{\text{\scriptsize sp}}" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><msub id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml">r</mi><mtext id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3a.cmml">sp</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2">ğ‘Ÿ</ci><ci id="S4.SS2.p6.1.m1.1.1.3a.cmml" xref="S4.SS2.p6.1.m1.1.1.3"><mtext mathsize="70%" id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3">sp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">r_{\text{\scriptsize sp}}</annotation></semantics></math> in Eq.Â (<a href="#S3.E7" title="In 3.2. Compression phase â€£ 3. AdaCoder framework â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) for specializing code snippets to each question type makes it more likely to provide code snippets that are related to each other, thereby increasing the probability of completing the program. When this instruction is omitted and compression is performed regardless of the question type, code snippets that are effective for any question type tend to be retained after compression.
However, this approach results in the loss of some specific snippets that are necessary to complete the program, thereby reducing QA accuracy. These results suggest that the instruction <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="r_{\text{\scriptsize sp}}" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><msub id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml"><mi id="S4.SS2.p6.2.m2.1.1.2" xref="S4.SS2.p6.2.m2.1.1.2.cmml">r</mi><mtext id="S4.SS2.p6.2.m2.1.1.3" xref="S4.SS2.p6.2.m2.1.1.3a.cmml">sp</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><apply id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p6.2.m2.1.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p6.2.m2.1.1.2.cmml" xref="S4.SS2.p6.2.m2.1.1.2">ğ‘Ÿ</ci><ci id="S4.SS2.p6.2.m2.1.1.3a.cmml" xref="S4.SS2.p6.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS2.p6.2.m2.1.1.3.cmml" xref="S4.SS2.p6.2.m2.1.1.3">sp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">r_{\text{\scriptsize sp}}</annotation></semantics></math> is important for compressing code snippets.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Analysis on effect of question type classification.</figcaption>
<table id="S4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:3.2pt;padding-right:3.2pt;">Method</th>
<th id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:3.2pt;padding-right:3.2pt;">Token length</th>
<th id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:3.2pt;padding-right:3.2pt;">Accuracy (%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.2.1" class="ltx_tr">
<th id="S4.T3.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:3.2pt;padding-right:3.2pt;">w/ Predicted question types</th>
<td id="S4.T3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:3.2pt;padding-right:3.2pt;">993</td>
<td id="S4.T3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:3.2pt;padding-right:3.2pt;">43.6</td>
</tr>
<tr id="S4.T3.1.3.2" class="ltx_tr">
<th id="S4.T3.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:3.2pt;padding-right:3.2pt;">w/ Oracle question types</th>
<td id="S4.T3.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.2pt;padding-right:3.2pt;">851</td>
<td id="S4.T3.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:3.2pt;padding-right:3.2pt;">44.5</td>
</tr>
<tr id="S4.T3.1.4.3" class="ltx_tr">
<th id="S4.T3.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:3.2pt;padding-right:3.2pt;">w/ Random question types</th>
<td id="S4.T3.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:3.2pt;padding-right:3.2pt;">851</td>
<td id="S4.T3.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:3.2pt;padding-right:3.2pt;">37.6</td>
</tr>
<tr id="S4.T3.1.5.4" class="ltx_tr">
<th id="S4.T3.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:3.2pt;padding-right:3.2pt;">w/o Q. type based compression</th>
<td id="S4.T3.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:3.2pt;padding-right:3.2pt;">810</td>
<td id="S4.T3.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:3.2pt;padding-right:3.2pt;">28.9</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.p7" class="ltx_para ltx_noindent">
<p id="S4.SS2.p7.1" class="ltx_p"><span id="S4.SS2.p7.1.1" class="ltx_text ltx_font_bold">Compressed prompts.</span>
TableÂ <a href="#S4.T4" title="Table 4 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> summarizes the token length and compression performance for each component of the input preprompt.
We see that both API definitions and code snippets are significantly compressed.
A comparison of the original and compressed API definitions is shown in FigureÂ <a href="#S4.F6" title="Figure 6 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
We see that descriptions of methods unnecessary for coding, such as those for the initialization method, are omitted, and the remaining sections are condensed into shorter sentences. This is an effective compression achieved by the language understanding and summarization capabilities of black-box LLMs.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Token length and number of characters for each component of input prompt. Reduction rate is measured by token length.</figcaption>
<table id="S4.T4.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.1" class="ltx_tr">
<td id="S4.T4.1.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;" rowspan="2"><span id="S4.T4.1.1.1.1.1" class="ltx_text">Component</span></td>
<td id="S4.T4.1.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;" colspan="2">ViperGPT</td>
<td id="S4.T4.1.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.5pt;padding-right:1.5pt;" colspan="3">AdaCoder</td>
</tr>
<tr id="S4.T4.1.2.2" class="ltx_tr">
<td id="S4.T4.1.2.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Tokens</td>
<td id="S4.T4.1.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">Characters</td>
<td id="S4.T4.1.2.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Tokens</td>
<td id="S4.T4.1.2.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Characters</td>
<td id="S4.T4.1.2.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">Reduction</td>
</tr>
<tr id="S4.T4.1.3.3" class="ltx_tr">
<td id="S4.T4.1.3.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">API defs</td>
<td id="S4.T4.1.3.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">1,971</td>
<td id="S4.T4.1.3.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">9,299</td>
<td id="S4.T4.1.3.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">541</td>
<td id="S4.T4.1.3.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">2,360</td>
<td id="S4.T4.1.3.3.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">72.6%</td>
</tr>
<tr id="S4.T4.1.4.4" class="ltx_tr">
<td id="S4.T4.1.4.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">Code snippets</td>
<td id="S4.T4.1.4.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">1,386</td>
<td id="S4.T4.1.4.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">6,263</td>
<td id="S4.T4.1.4.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">234</td>
<td id="S4.T4.1.4.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">971</td>
<td id="S4.T4.1.4.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">83.1%</td>
</tr>
<tr id="S4.T4.1.5.5" class="ltx_tr">
<td id="S4.T4.1.5.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">Instruction</td>
<td id="S4.T4.1.5.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">77</td>
<td id="S4.T4.1.5.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">388</td>
<td id="S4.T4.1.5.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">77</td>
<td id="S4.T4.1.5.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">388</td>
<td id="S4.T4.1.5.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">-</td>
</tr>
<tr id="S4.T4.1.6.6" class="ltx_tr">
<td id="S4.T4.1.6.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">Classification</td>
<td id="S4.T4.1.6.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">0</td>
<td id="S4.T4.1.6.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">0</td>
<td id="S4.T4.1.6.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">141</td>
<td id="S4.T4.1.6.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">618</td>
<td id="S4.T4.1.6.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">-</td>
</tr>
<tr id="S4.T4.1.7.7" class="ltx_tr">
<td id="S4.T4.1.7.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Total</td>
<td id="S4.T4.1.7.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">3,434</td>
<td id="S4.T4.1.7.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">15,950</td>
<td id="S4.T4.1.7.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">993</td>
<td id="S4.T4.1.7.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">4,337</td>
<td id="S4.T4.1.7.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">71.7%</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2407.19410/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="461" height="592" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Comparison of the original and compressed API definitions (<math id="S4.F6.3.m1.1" class="ltx_Math" alttext="p_{\text{\scriptsize def}}" display="inline"><semantics id="S4.F6.3.m1.1b"><msub id="S4.F6.3.m1.1.1" xref="S4.F6.3.m1.1.1.cmml"><mi id="S4.F6.3.m1.1.1.2" xref="S4.F6.3.m1.1.1.2.cmml">p</mi><mtext id="S4.F6.3.m1.1.1.3" xref="S4.F6.3.m1.1.1.3a.cmml">def</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.F6.3.m1.1c"><apply id="S4.F6.3.m1.1.1.cmml" xref="S4.F6.3.m1.1.1"><csymbol cd="ambiguous" id="S4.F6.3.m1.1.1.1.cmml" xref="S4.F6.3.m1.1.1">subscript</csymbol><ci id="S4.F6.3.m1.1.1.2.cmml" xref="S4.F6.3.m1.1.1.2">ğ‘</ci><ci id="S4.F6.3.m1.1.1.3a.cmml" xref="S4.F6.3.m1.1.1.3"><mtext mathsize="70%" id="S4.F6.3.m1.1.1.3.cmml" xref="S4.F6.3.m1.1.1.3">def</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.m1.1d">p_{\text{\scriptsize def}}</annotation></semantics></math> and <math id="S4.F6.4.m2.1" class="ltx_Math" alttext="\hat{p}_{\text{\scriptsize def}}" display="inline"><semantics id="S4.F6.4.m2.1b"><msub id="S4.F6.4.m2.1.1" xref="S4.F6.4.m2.1.1.cmml"><mover accent="true" id="S4.F6.4.m2.1.1.2" xref="S4.F6.4.m2.1.1.2.cmml"><mi id="S4.F6.4.m2.1.1.2.2" xref="S4.F6.4.m2.1.1.2.2.cmml">p</mi><mo id="S4.F6.4.m2.1.1.2.1" xref="S4.F6.4.m2.1.1.2.1.cmml">^</mo></mover><mtext id="S4.F6.4.m2.1.1.3" xref="S4.F6.4.m2.1.1.3a.cmml">def</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.F6.4.m2.1c"><apply id="S4.F6.4.m2.1.1.cmml" xref="S4.F6.4.m2.1.1"><csymbol cd="ambiguous" id="S4.F6.4.m2.1.1.1.cmml" xref="S4.F6.4.m2.1.1">subscript</csymbol><apply id="S4.F6.4.m2.1.1.2.cmml" xref="S4.F6.4.m2.1.1.2"><ci id="S4.F6.4.m2.1.1.2.1.cmml" xref="S4.F6.4.m2.1.1.2.1">^</ci><ci id="S4.F6.4.m2.1.1.2.2.cmml" xref="S4.F6.4.m2.1.1.2.2">ğ‘</ci></apply><ci id="S4.F6.4.m2.1.1.3a.cmml" xref="S4.F6.4.m2.1.1.3"><mtext mathsize="70%" id="S4.F6.4.m2.1.1.3.cmml" xref="S4.F6.4.m2.1.1.3">def</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.m2.1d">\hat{p}_{\text{\scriptsize def}}</annotation></semantics></math>). AdaCoder reduced the token length by 72.5%.</figcaption>
</figure>
<div id="S4.SS2.p8" class="ltx_para ltx_noindent">
<p id="S4.SS2.p8.1" class="ltx_p"><span id="S4.SS2.p8.1.1" class="ltx_text ltx_font_bold">Computational time.</span>
Since the model weights and details of the black-box LLMs are not publicly available, and API response times can be affected by server congestion, a detailed analysis of computation times is not possible. However, the total time for experiments on the GQA dataset was reduced by 55%.</p>
</div>
<div id="S4.SS2.p9" class="ltx_para ltx_noindent">
<p id="S4.SS2.p9.1" class="ltx_p"><a href="#S4.SS2" title="4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref ltx_font_bold" style="font-size:120%;"><span class="ltx_text ltx_ref_tag">4.2</span></a><span id="S4.SS2.p9.1.1" class="ltx_text ltx_font_bold" style="font-size:120%;">.1 â€„ Ablation study and analysis</span></p>
</div>
<div id="S4.SS2.p10" class="ltx_para ltx_noindent">
<p id="S4.SS2.p10.1" class="ltx_p"><span id="S4.SS2.p10.1.1" class="ltx_text ltx_font_bold">Ablation study.</span>
TableÂ <a href="#S4.T5" title="Table 5 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> presents the results of an ablation study. We see that both compression of API definitions and code snippets contribute to each other for both reducing the input token length and improving QA accuracy.
TableÂ <a href="#S4.T6" title="Table 6 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> summarizes the QA accuracy obtained by using a single compressed prompt. We see that even with one prompt of either â€œattrâ€ or â€œrelâ€, our method achieves comparable or slightly better performance than the ViperGPT baseline (41.3%). However, using one prompt of either â€œobjâ€ or â€œglobalâ€, the QA accuracy is significantly degraded. These results demonstrate that our adaptation approach is essential for improving QA accuracy while compressing input prompts.
The detailed QA accuracy by question type is analyzed in TableÂ <a href="#S4.T7" title="Table 7 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
We see that the four compressed prompt specialized for â€œobjâ€, â€œcatâ€, â€œattrâ€, and â€œrelâ€ performed the best for corresponding questions.
For the â€œglobalâ€ questions, the prompt for â€œattrâ€ was the best.
This is because â€œglobalâ€ questions are highly varied and not easily categorized.
Defining fine-grained QA types would be interesting as a next step in future research.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Ablation study w.r.t prompt compression (GQA, gpt-3.5-turbo).</figcaption>
<table id="S4.T5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T5.1.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Method</th>
<td id="S4.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Tokens</td>
<td id="S4.T5.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Acc.</td>
</tr>
<tr id="S4.T5.1.2.2" class="ltx_tr">
<th id="S4.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">AdaCoder</th>
<td id="S4.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">993</td>
<td id="S4.T5.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T5.1.2.2.3.1" class="ltx_text ltx_font_bold">43.6</span></td>
</tr>
<tr id="S4.T5.1.3.3" class="ltx_tr">
<th id="S4.T5.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">w/o compressing API defs.</th>
<td id="S4.T5.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">2,422</td>
<td id="S4.T5.1.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">40.6</td>
</tr>
<tr id="S4.T5.1.4.4" class="ltx_tr">
<th id="S4.T5.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/o compressing code snips.</th>
<td id="S4.T5.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">2,145</td>
<td id="S4.T5.1.4.4.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">41.1</td>
</tr>
<tr id="S4.T5.1.5.5" class="ltx_tr">
<th id="S4.T5.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/o QA classification</th>
<td id="S4.T5.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">810</td>
<td id="S4.T5.1.5.5.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">28.9</td>
</tr>
<tr id="S4.T5.1.6.6" class="ltx_tr">
<th id="S4.T5.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/o any compression</th>
<td id="S4.T5.1.6.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">3,434</td>
<td id="S4.T5.1.6.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.0pt;padding-right:9.0pt;">41.3</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6. </span>Ablation study using a single specialized prompt (GQA, gpt-3.5-turbo).</figcaption>
<table id="S4.T6.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.1.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Method</th>
<th id="S4.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Tokens</th>
<th id="S4.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:9.0pt;padding-right:9.0pt;">Acc.</th>
</tr>
<tr id="S4.T6.1.2.2" class="ltx_tr">
<th id="S4.T6.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">AdaCoder</th>
<th id="S4.T6.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">993</th>
<th id="S4.T6.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;"><span id="S4.T6.1.2.2.3.1" class="ltx_text ltx_font_bold">43.6</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.1.3.1" class="ltx_tr">
<td id="S4.T6.1.3.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">w/ fixed prompt of obj</td>
<td id="S4.T6.1.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">967</td>
<td id="S4.T6.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:9.0pt;padding-right:9.0pt;">30.9</td>
</tr>
<tr id="S4.T6.1.4.2" class="ltx_tr">
<td id="S4.T6.1.4.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/ fixed prompt of cat</td>
<td id="S4.T6.1.4.2.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">1,015</td>
<td id="S4.T6.1.4.2.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">39.0</td>
</tr>
<tr id="S4.T6.1.5.3" class="ltx_tr">
<td id="S4.T6.1.5.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/ fixed prompt of attr</td>
<td id="S4.T6.1.5.3.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">1,008</td>
<td id="S4.T6.1.5.3.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">41.7</td>
</tr>
<tr id="S4.T6.1.6.4" class="ltx_tr">
<td id="S4.T6.1.6.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/ fixed prompt of rel</td>
<td id="S4.T6.1.6.4.2" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">993</td>
<td id="S4.T6.1.6.4.3" class="ltx_td ltx_align_center" style="padding-left:9.0pt;padding-right:9.0pt;">42.3</td>
</tr>
<tr id="S4.T6.1.7.5" class="ltx_tr">
<td id="S4.T6.1.7.5.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">w/ fixed prompt of global</td>
<td id="S4.T6.1.7.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:9.0pt;padding-right:9.0pt;">977</td>
<td id="S4.T6.1.7.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:9.0pt;padding-right:9.0pt;">35.3</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T7" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7. </span>Cross question type evaluation (GQA, gpt-3.5-turbo).</figcaption>
<table id="S4.T7.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T7.1.1.1" class="ltx_tr">
<th id="S4.T7.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;">QA type</th>
<th id="S4.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;">obj</th>
<th id="S4.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;">cat</th>
<th id="S4.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;">attr</th>
<th id="S4.T7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;">rel</th>
<th id="S4.T7.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:8.0pt;padding-right:8.0pt;">global</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T7.1.2.1" class="ltx_tr">
<th id="S4.T7.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">obj</th>
<td id="S4.T7.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T7.1.2.1.2.1" class="ltx_text ltx_font_bold">77.0</span></td>
<td id="S4.T7.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">17.5</td>
<td id="S4.T7.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">31.1</td>
<td id="S4.T7.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">21.8</td>
<td id="S4.T7.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.0pt;padding-right:8.0pt;">16.9</td>
</tr>
<tr id="S4.T7.1.3.2" class="ltx_tr">
<th id="S4.T7.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">cat</th>
<td id="S4.T7.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">74.5</td>
<td id="S4.T7.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T7.1.3.2.3.1" class="ltx_text ltx_font_bold">45.3</span></td>
<td id="S4.T7.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">39.9</td>
<td id="S4.T7.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">28.5</td>
<td id="S4.T7.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">35.4</td>
</tr>
<tr id="S4.T7.1.4.3" class="ltx_tr">
<th id="S4.T7.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">attr</th>
<td id="S4.T7.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">68.9</td>
<td id="S4.T7.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">30.7</td>
<td id="S4.T7.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T7.1.4.3.4.1" class="ltx_text ltx_font_bold">52.4</span></td>
<td id="S4.T7.1.4.3.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">28.9</td>
<td id="S4.T7.1.4.3.6" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T7.1.4.3.6.1" class="ltx_text ltx_font_bold">36.9</span></td>
</tr>
<tr id="S4.T7.1.5.4" class="ltx_tr">
<th id="S4.T7.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">rel</th>
<td id="S4.T7.1.5.4.2" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">70.2</td>
<td id="S4.T7.1.5.4.3" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">35.8</td>
<td id="S4.T7.1.5.4.4" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">50.9</td>
<td id="S4.T7.1.5.4.5" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;"><span id="S4.T7.1.5.4.5.1" class="ltx_text ltx_font_bold">30.3</span></td>
<td id="S4.T7.1.5.4.6" class="ltx_td ltx_align_center" style="padding-left:8.0pt;padding-right:8.0pt;">33.9</td>
</tr>
<tr id="S4.T7.1.6.5" class="ltx_tr">
<th id="S4.T7.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:8.0pt;padding-right:8.0pt;">global</th>
<td id="S4.T7.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">71.1</td>
<td id="S4.T7.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">31.4</td>
<td id="S4.T7.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">38.0</td>
<td id="S4.T7.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">24.8</td>
<td id="S4.T7.1.6.5.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:8.0pt;padding-right:8.0pt;">32.3</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2407.19410/assets/x7.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="460" height="220" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Qualitative examples.
(a) Input of questions and images.
(b) Adaptively selected example code snippets. Each compressed prompt involves three or four snippets, and two of them are shown. These examples are fed into LLM with the compressed API definition in FigureÂ <a href="#S4.F6" title="Figure 6 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
(c) Generated Python program for question answering.
(d) Visualization of intermediate outputs to derive the answer.
</figcaption>
</figure>
<div id="S4.SS2.p11" class="ltx_para ltx_noindent">
<p id="S4.SS2.p11.1" class="ltx_p"><span id="S4.SS2.p11.1.1" class="ltx_text ltx_font_bold">Error analysis.</span>
TableÂ <a href="#S4.T8" title="Table 8 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows an error analysis, where we manually counted the occurrence of four types of errors.
â€œCoding errorâ€ indicates that the generated program is not executable or returns nothing.
â€œCannot answer to simple queryâ€ indicates that the program is correct but the <span id="S4.SS2.p11.1.2" class="ltx_text ltx_font_typewriter">simple_query</span> method returned a response such as â€œI cannot answerâ€.
â€œNo object detectedâ€ indicates that no object is detected by the <span id="S4.SS2.p11.1.3" class="ltx_text ltx_font_typewriter">find</span> method.
â€œWrong answerâ€ indicates that the returned answer was wrong.
We have two observations. First, the predominant type of error was wrong answers, and AdaCoder reduced their frequency.
Second, despite AdaCoderâ€™s improvement in coding quality, there is still a 7.8% incidence of coding errors. This suggests that there is still room for improvement in instructing LLMs about API usage.</p>
</div>
<figure id="S4.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8. </span>Error analysis (individual error rates as percentages).</figcaption>
<table id="S4.T8.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T8.1.1.1" class="ltx_tr">
<td id="S4.T8.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">Error type</td>
<td id="S4.T8.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">ViperGPT</td>
<td id="S4.T8.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">AdaCoder</td>
</tr>
<tr id="S4.T8.1.2.2" class="ltx_tr">
<td id="S4.T8.1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Correct but with unnecessary details</td>
<td id="S4.T8.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">0.5</td>
<td id="S4.T8.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">0.5</td>
</tr>
<tr id="S4.T8.1.3.3" class="ltx_tr">
<td id="S4.T8.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r">Correct except for articles</td>
<td id="S4.T8.1.3.3.2" class="ltx_td ltx_align_center">1.1</td>
<td id="S4.T8.1.3.3.3" class="ltx_td ltx_align_center">1.5</td>
</tr>
<tr id="S4.T8.1.4.4" class="ltx_tr">
<td id="S4.T8.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r">Correct by paraphrasing</td>
<td id="S4.T8.1.4.4.2" class="ltx_td ltx_align_center">1.4</td>
<td id="S4.T8.1.4.4.3" class="ltx_td ltx_align_center">1.6</td>
</tr>
<tr id="S4.T8.1.5.5" class="ltx_tr">
<td id="S4.T8.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Coding error</td>
<td id="S4.T8.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">8.3</td>
<td id="S4.T8.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">7.8</td>
</tr>
<tr id="S4.T8.1.6.6" class="ltx_tr">
<td id="S4.T8.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r">Cannot answer to simple query</td>
<td id="S4.T8.1.6.6.2" class="ltx_td ltx_align_center">6.1</td>
<td id="S4.T8.1.6.6.3" class="ltx_td ltx_align_center">6.1</td>
</tr>
<tr id="S4.T8.1.7.7" class="ltx_tr">
<td id="S4.T8.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r">No object detected</td>
<td id="S4.T8.1.7.7.2" class="ltx_td ltx_align_center">0.7</td>
<td id="S4.T8.1.7.7.3" class="ltx_td ltx_align_center">1.6</td>
</tr>
<tr id="S4.T8.1.8.8" class="ltx_tr">
<td id="S4.T8.1.8.8.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">Wrong answer</td>
<td id="S4.T8.1.8.8.2" class="ltx_td ltx_align_center ltx_border_bb">40.6</td>
<td id="S4.T8.1.8.8.3" class="ltx_td ltx_align_center ltx_border_bb">37.3</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.p12" class="ltx_para">
<p id="S4.SS2.p12.1" class="ltx_p">Several minor errors were also observed. â€œCorrect but with unnecessary detailsâ€ refers to responses that were marked incorrect because they provided additional, unnecessary information, such as the response â€œYes, there is an apple on the tableâ€ where the ground truth is â€œYesâ€.
â€œCorrect except with articlesâ€ refers to cases where the instruction to respond with a single word was ignored and an article was added, resulting in responses such as â€œa carâ€ instead of â€œcarâ€.
â€œCorrect by paraphrasingâ€ refers to errors resulting from the use of interchangeable terms that do not change the meaning, such as using â€œladyâ€ instead of â€œwomanâ€.</p>
</div>
<div id="S4.SS2.p13" class="ltx_para ltx_noindent">
<p id="S4.SS2.p13.1" class="ltx_p"><span id="S4.SS2.p13.1.1" class="ltx_text ltx_font_bold">Qualitative examples.</span>
FigureÂ <a href="#S4.F7" title="Figure 7 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> presents qualitative examples of the generated programs.
As shown, few example code snippets related to the input question are adaptively selected.
These examples help LLM to generate a program to answer the question.
When the program is executed, the object patches are detected and then the relative position or colors are compared to derive a correct answer.</p>
</div>
<div id="S4.SS2.p14" class="ltx_para ltx_noindent">
<p id="S4.SS2.p14.1" class="ltx_p"><span id="S4.SS2.p14.1.1" class="ltx_text ltx_font_bold">Evaluation on various tasks.</span>
Finally, we evaluated the generalizability of our method across various multimodal tasks, including visual grounding (VG), counting (CT), relative depth estimation (RDE), visual reasoning (VR), image editing (IE), and object tagging (OT).
As shown in TableÂ <a href="#S4.T9" title="Table 9 â€£ 4.2. Experimental results â€£ 4. Experiments â€£ AdaCoder: Adaptive Prompt Compression for Programmatic Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, our method is consistently effective for all of these tasks.</p>
</div>
<figure id="S4.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9. </span>Evaluation on various multimodal tasks.
Token and Red. indicate token length and reduction rate, respectively.
</figcaption>
<table id="S4.T9.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T9.1.2.1" class="ltx_tr">
<td id="S4.T9.1.2.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_border_tt" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<td id="S4.T9.1.2.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_tt" style="padding-left:1.0pt;padding-right:1.0pt;" rowspan="2"><span id="S4.T9.1.2.1.2.1" class="ltx_text">Task</span></td>
<td id="S4.T9.1.2.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:1.0pt;padding-right:1.0pt;" rowspan="2"><span id="S4.T9.1.2.1.3.1" class="ltx_text">Dataset</span></td>
<td id="S4.T9.1.2.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_tt" style="padding-left:1.0pt;padding-right:1.0pt;" colspan="2">Baseline</td>
<td id="S4.T9.1.2.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_tt" style="padding-left:1.0pt;padding-right:1.0pt;" colspan="3">AdaCoder</td>
</tr>
<tr id="S4.T9.1.1" class="ltx_tr">
<td id="S4.T9.1.1.2" class="ltx_td ltx_nopad_l ltx_nopad_r" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
<td id="S4.T9.1.1.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">Acc.</td>
<td id="S4.T9.1.1.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">Token</td>
<td id="S4.T9.1.1.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">Acc.</td>
<td id="S4.T9.1.1.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">Token</td>
<td id="S4.T9.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">Red.<math id="S4.T9.1.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S4.T9.1.1.1.m1.1a"><mo stretchy="false" id="S4.T9.1.1.1.m1.1.1" xref="S4.T9.1.1.1.m1.1.1.cmml">â†‘</mo><annotation-xml encoding="MathML-Content" id="S4.T9.1.1.1.m1.1b"><ci id="S4.T9.1.1.1.m1.1.1.cmml" xref="S4.T9.1.1.1.m1.1.1">â†‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T9.1.1.1.m1.1c">\uparrow</annotation></semantics></math>
</td>
</tr>
<tr id="S4.T9.1.3.2" class="ltx_tr">
<td id="S4.T9.1.3.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;" rowspan="3"><span id="S4.T9.1.3.2.1.1" class="ltx_text">
<span id="S4.T9.1.3.2.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:7.9pt;height:41.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:41.7pt;transform:translate(-16.91pt,-16.03pt) rotate(-90deg) ;">
<span id="S4.T9.1.3.2.1.1.1.1" class="ltx_p"><span id="S4.T9.1.3.2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">ViperGPT</span></span>
</span></span></span></td>
<td id="S4.T9.1.3.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">Visual grounding</td>
<td id="S4.T9.1.3.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">RefCOCO <cite class="ltx_cite ltx_citemacro_citep">(Yu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib46" title="" class="ltx_ref">2016</a>)</cite>
</td>
<td id="S4.T9.1.3.2.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">39.5</td>
<td id="S4.T9.1.3.2.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">3,434</td>
<td id="S4.T9.1.3.2.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.3.2.6.1" class="ltx_text ltx_font_bold">49.0</span></td>
<td id="S4.T9.1.3.2.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">853</td>
<td id="S4.T9.1.3.2.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">75.2%</td>
</tr>
<tr id="S4.T9.1.4.3" class="ltx_tr">
<td id="S4.T9.1.4.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">Counting</td>
<td id="S4.T9.1.4.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">BLINKÂ <cite class="ltx_cite ltx_citemacro_citep">(Fu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2024</a>)</cite>
</td>
<td id="S4.T9.1.4.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">38.3</td>
<td id="S4.T9.1.4.3.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">3,434</td>
<td id="S4.T9.1.4.3.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.4.3.5.1" class="ltx_text ltx_font_bold">39.2</span></td>
<td id="S4.T9.1.4.3.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">935</td>
<td id="S4.T9.1.4.3.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">72.8%</td>
</tr>
<tr id="S4.T9.1.5.4" class="ltx_tr">
<td id="S4.T9.1.5.4.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">Relative depth</td>
<td id="S4.T9.1.5.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">BLINKÂ <cite class="ltx_cite ltx_citemacro_citep">(Fu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2024</a>)</cite>
</td>
<td id="S4.T9.1.5.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.5.4.3.1" class="ltx_text ltx_font_bold">59.7</span></td>
<td id="S4.T9.1.5.4.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">3,434</td>
<td id="S4.T9.1.5.4.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.5.4.5.1" class="ltx_text ltx_font_bold">59.7</span></td>
<td id="S4.T9.1.5.4.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">847</td>
<td id="S4.T9.1.5.4.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">75.3%</td>
</tr>
<tr id="S4.T9.1.6.5" class="ltx_tr">
<td id="S4.T9.1.6.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;" rowspan="4"><span id="S4.T9.1.6.5.1.1" class="ltx_text">
<span id="S4.T9.1.6.5.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:7.9pt;height:31.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:31.5pt;transform:translate(-11.78pt,-10.9pt) rotate(-90deg) ;">
<span id="S4.T9.1.6.5.1.1.1.1" class="ltx_p"><span id="S4.T9.1.6.5.1.1.1.1.1" class="ltx_text" style="font-size:90%;">VisProg</span></span>
</span></span></span></td>
<td id="S4.T9.1.6.5.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">Visual QA</td>
<td id="S4.T9.1.6.5.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">GQAÂ <cite class="ltx_cite ltx_citemacro_citep">(Hudson and Manning, <a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite>
</td>
<td id="S4.T9.1.6.5.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">47.5</td>
<td id="S4.T9.1.6.5.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">1,836</td>
<td id="S4.T9.1.6.5.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.6.5.6.1" class="ltx_text ltx_font_bold">49.0</span></td>
<td id="S4.T9.1.6.5.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">657</td>
<td id="S4.T9.1.6.5.8" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.0pt;padding-right:1.0pt;">64.2%</td>
</tr>
<tr id="S4.T9.1.7.6" class="ltx_tr">
<td id="S4.T9.1.7.6.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">Visual reasoning</td>
<td id="S4.T9.1.7.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">NLVR2Â <cite class="ltx_cite ltx_citemacro_citep">(Suhr etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2019</a>)</cite>
</td>
<td id="S4.T9.1.7.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">62.0</td>
<td id="S4.T9.1.7.6.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">1,495</td>
<td id="S4.T9.1.7.6.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.7.6.5.1" class="ltx_text ltx_font_bold">62.5</span></td>
<td id="S4.T9.1.7.6.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">338</td>
<td id="S4.T9.1.7.6.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">77.4%</td>
</tr>
<tr id="S4.T9.1.8.7" class="ltx_tr">
<td id="S4.T9.1.8.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">Image editing</td>
<td id="S4.T9.1.8.7.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">MagicBrushÂ <cite class="ltx_cite ltx_citemacro_citep">(Zhang etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib49" title="" class="ltx_ref">2023</a>)</cite>
</td>
<td id="S4.T9.1.8.7.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">68.3</td>
<td id="S4.T9.1.8.7.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">879</td>
<td id="S4.T9.1.8.7.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.8.7.5.1" class="ltx_text ltx_font_bold">70.0</span></td>
<td id="S4.T9.1.8.7.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">219</td>
<td id="S4.T9.1.8.7.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.0pt;padding-right:1.0pt;">75.1%</td>
</tr>
<tr id="S4.T9.1.9.8" class="ltx_tr">
<td id="S4.T9.1.9.8.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">Object tagging</td>
<td id="S4.T9.1.9.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">RefCOCO <cite class="ltx_cite ltx_citemacro_citep">(Yu etÂ al<span class="ltx_text">.</span>, <a href="#bib.bib46" title="" class="ltx_ref">2016</a>)</cite>
</td>
<td id="S4.T9.1.9.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.9.8.3.1" class="ltx_text ltx_font_bold">43.3</span></td>
<td id="S4.T9.1.9.8.4" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:1.0pt;padding-right:1.0pt;">1,836</td>
<td id="S4.T9.1.9.8.5" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.0pt;padding-right:1.0pt;"><span id="S4.T9.1.9.8.5.1" class="ltx_text ltx_font_bold">43.3</span></td>
<td id="S4.T9.1.9.8.6" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.0pt;padding-right:1.0pt;">216</td>
<td id="S4.T9.1.9.8.7" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_bb" style="padding-left:1.0pt;padding-right:1.0pt;">88.2%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We introduced AdaCoder, a framework for adaptive prompt compression for visual programmatic models.
AdaCoder efficiently generated programs for visual question answering by compressing and selecting prompts depending on the question type.
A single black-box LLM is effectively employed to perform question type classification, textual compression and code generation, eliminating the need for additional training.
In experiments, we demonstrated the effectiveness and efficiency of AdaCoder in comparison to ViperGPT and LLMLingua.
Finally, we discuss limitations and future work.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Limitations.</span>
As this work relies on black-box LLMs,
analysis from the perspective of neural network architecture is limited.
Alternative choices to LLMs for code generation may include open-source white-box models, such as CodeLlama and StarCoder. However, since AdaCoder requires high-quality text classification and summarization, these models were not suitable for prompt compression.
New research directions leveraging the combination of white-box and black-box LLMs need to be further explored.</p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Future work.</span>
To advance multimodal automated programming, future research directions that focus on pushing the boundaries beyond the traditional scope of VQA would be interesting. This includes developing methods for interactive code modification to enable a more dynamic and responsive programming environment.
Additionally, we plan to explore the automatic extension of APIs to facilitate their evolution in becoming more efficient and effective in addressing the complex requirements of multimodal interactions.
From a long-term perspective, we believe that adaptively extracting necessary API definitions and coding examples will be a critical step in automating large-scale multimodal software development to reduce computational costs and save energy.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported by JSPS KAKENHI Grant Numbers 21H04910 and 22K12089.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson etÂ al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Peter Anderson, Xiaodong He, Chris Buehler, etÂ al<span id="bib.bib2.3.1" class="ltx_text">.</span> 2018.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual question answering. In <em id="bib.bib2.4.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>. 6077â€“6086.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anthropic Claude AIP. (2023)</span>
<span class="ltx_bibblock">
Anthropic Claude AIP. 2023.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">https://claude.ai.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antol etÂ al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra, CÂ Lawrence Zitnick, and Devi Parikh. 2015.

</span>
<span class="ltx_bibblock">VQA: Visual question answering. In <em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</em>. 2425â€“2433.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bolya etÂ al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Daniel Bolya, Cheng-Yang Fu, Xiaoliang Dai, Peizhao Zhang, Christoph Feichtenhofer, and Judy Hoffman. 2023.

</span>
<span class="ltx_bibblock">Token Merging: Your ViT But Faster. In <em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Learning Representations (ICLR)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown etÂ al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, etÂ al<span id="bib.bib6.3.1" class="ltx_text">.</span> 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners. In <em id="bib.bib6.4.1" class="ltx_emph ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</em>. 1877â€“1901.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2023a)</span>
<span class="ltx_bibblock">
Jiali Chen, Zhenjun Guo, Jiayuan Xie, Yi Cai, and Qing Li. 2023a.

</span>
<span class="ltx_bibblock">Deconfounded Visual Question Generation with Causal Inference. In <em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>. 5132â€“5142.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2023b)</span>
<span class="ltx_bibblock">
Kang Chen, Tianli Zhao, and Xiangqian Wu. 2023b.

</span>
<span class="ltx_bibblock">VTQA2023: ACM Multimedia 2023 Visual Text Question Answering Challenge. In <em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>. 9646â€“9650.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen etÂ al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Mark Chen, Jerry Tworek, etÂ al<span id="bib.bib9.3.1" class="ltx_text">.</span> 2021.

</span>
<span class="ltx_bibblock">Evaluating Large Language Models Trained on Code.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.4.1" class="ltx_emph ltx_font_italic">arXiv2107.03374</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chevalier etÂ al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Alexis Chevalier, Alexander Wettig, Anirudh Ajith, and Danqi Chen. 2023.

</span>
<span class="ltx_bibblock">Adapting Language Models to Compress Contexts. In <em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">Proc. Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu etÂ al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Xiang Fu, Yuxin Hu, Baoxu Li, Yasheng Feng, Hao Wang, Xian Lin, Dan Roth, NoahÂ A. Smith, Wei-Chiu Ma, and Ranjay Krishna. 2024.

</span>
<span class="ltx_bibblock">BLINK: Multimodal Large Language Models Can See but Not Perceive. In <em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">Proc. European Conference on Computer Vision (ECCV)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge etÂ al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Jiaxin Ge, Sanjay Subramanian, Baifeng Shi, Roei Herzig, and Trevor Darrell. 2024.

</span>
<span class="ltx_bibblock">Recursive Visual Programming. In <em id="bib.bib12.3.1" class="ltx_emph ltx_font_italic">Proc. European Conference on Computer Vision (ECCV)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ge etÂ al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Tao Ge, Jing Hu, Li Dong, Shaoguang Mao, Yan Xia, Xun Wang, Si-Qing Chen, and Furu Wei. 2022.

</span>
<span class="ltx_bibblock">Extensible Prompts for Language Models on Zero-shot Language Style Customization. In <em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal etÂ al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Saurabh Goyal, AnamitraÂ Roy Choudhury, Saurabh Raje, VenkatesanÂ T. Chakaravarthy, Yogish Sabharwal, and Ashish Verma. 2020.

</span>
<span class="ltx_bibblock">Power-bert: Accelerating BERT inference via progressive word-vector elimination. In <em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Machine Learning (ICML)</em>. 3690â€“3699.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal etÂ al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, etÂ al<span id="bib.bib15.3.1" class="ltx_text">.</span> 2017.

</span>
<span class="ltx_bibblock">Making the V in VQA matter: Elevating the role of image understanding in Visual Question Answering. In <em id="bib.bib15.4.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>. 6904â€“6913.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta and Kembhavi (2022)</span>
<span class="ltx_bibblock">
Tanmay Gupta and Aniruddha Kembhavi. 2022.

</span>
<span class="ltx_bibblock">Visual Programming: Compositional visual reasoning without training. In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu etÂ al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Yushi Hu, Otilia Stretcu, Chun-Ta Lu, Krishnamurthy Viswanathan, Kenji Hata, Enming Luo, Ranjay Krishna, and Ariel Fuxman. 2024.

</span>
<span class="ltx_bibblock">Visual Program Distillation: Distilling Tools and Programmatic Reasoning into Vision-Language Models. In <em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>. 9590â€“9601.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang etÂ al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Ziqi Huang, Hongyuan Zhu, Ying Sun, etÂ al<span id="bib.bib18.3.1" class="ltx_text">.</span> 2021.

</span>
<span class="ltx_bibblock">A diagnostic study of visual question answering with analogical reasoning. In <em id="bib.bib18.4.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</em>. IEEE, 2463â€“2467.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson and Manning (2019)</span>
<span class="ltx_bibblock">
DrewÂ A. Hudson and ChristopherÂ D. Manning. 2019.

</span>
<span class="ltx_bibblock">GQA: A New Dataset for Real-World Visual Reasoning and Compositional Question Answering. In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang etÂ al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Huiqiang Jiang, Qianhui Wu, Chin-Yew Lin, Yuqing Yang, and Lili Qiu. 2023.

</span>
<span class="ltx_bibblock">LLMLingua: Compressing Prompts for Accelerated Inference of Large Language Models. In <em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">Proc. Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin and Lu (2023)</span>
<span class="ltx_bibblock">
Ziqi Jin and Wei Lu. 2023.

</span>
<span class="ltx_bibblock">Tab-CoT: Zero-shot Tabular Chain of Thought. In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proc. Findings of the Association for Computational Linguistics (ACL Findings)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim and Cho (2021)</span>
<span class="ltx_bibblock">
Gyuwan Kim and Kyunghyun Cho. 2021.

</span>
<span class="ltx_bibblock">Length-adaptive transformer: Train once with length drop, use anytime with search. In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proc. Annual Meeting of the Association for Computational Linguistics (ACL)</em>. 6501â€“6511.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim etÂ al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Sehoon Kim, Sheng Shen, David Thorsley, Amir Gholami, Woosuk Kwon, Joseph Hassoun, and Kurt Keutzer. 2022.

</span>
<span class="ltx_bibblock">Learned Token Pruning for Transformers. In <em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">Proc. ACM SIGKDD Conference on Knowledge Discovery and Data Mining (SIGKDD)</em>. 784â€“794.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lan etÂ al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunshi Lan, Xiang Li, Xin Liu, Yang Li, Wei Qin, and Weining Qian. 2023.

</span>
<span class="ltx_bibblock">Improving Zero-shot Visual Question Answering via Large Language Models with Reasoning Question Prompts. In <em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Le etÂ al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Tung Le, HuyÂ Tien Nguyen, and Minh LeÂ Nguyen. 2021.

</span>
<span class="ltx_bibblock">Vision and text transformer for predicting answerability on visual question answering. In <em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</em>. IEEE, 934â€“938.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
LiunianÂ Harold Li, Haoxuan You, Zhecan Wang, etÂ al<span id="bib.bib26.3.1" class="ltx_text">.</span> 2021.

</span>
<span class="ltx_bibblock">Unsupervised Vision-and-Language Pre-training Without Parallel Images and Captions. In <em id="bib.bib26.4.1" class="ltx_emph ltx_font_italic">Proc. Annual Conference of the North American Chapter of the Association for Computational Linguistics (NAACL)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2022b)</span>
<span class="ltx_bibblock">
LiunianÂ Harold Li, Pengchuan Zhang, Haotian Zhang, Jianwei Yang, Chunyuan Li, Yiwu Zhong, Lijuan Wang, Lu Yuan, Lei Zhang, Jenq-Neng Hwang, etÂ al<span id="bib.bib27.3.1" class="ltx_text">.</span> 2022b.

</span>
<span class="ltx_bibblock">Grounded language-image pre-training. In <em id="bib.bib27.4.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2022a)</span>
<span class="ltx_bibblock">
Rengang Li, Cong Xu, Zhenhua Guo, Baoyu Fan, Runze Zhang, Wei Liu, Yaqian Zhao, Weifeng Gong, and Endong Wang. 2022a.

</span>
<span class="ltx_bibblock">AI-VQA: Visual Question Answering based on Agent Interaction with Interpretability. In <em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>. 5274â€“5282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malinowski etÂ al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Mateusz Malinowski, Marcus Rohrbach, and Mario Fritz. 2015.

</span>
<span class="ltx_bibblock">Ask Your Neurons: A Neural-based Approach to Answering Questions about Images. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</em>. 1â€“9.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu etÂ al<span id="bib.bib30.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Jesse Mu, XiangÂ Lisa Li, and Noah Goodman. 2023.

</span>
<span class="ltx_bibblock">Learning to Compress Prompts with Gist Tokens. In <em id="bib.bib30.3.1" class="ltx_emph ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan etÂ al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhuoshi Pan, Qianhui Wu, Huiqiang Jiang, Menglin Xia, Xufang Luo, Jue Zhang, Qingwei Lin, Victor RÃ¼hle, Yuqing Yang, Chin-Yew Lin, H.Â Vicky Zhao, Lili Qiu, and Dongmei Zhang. 2024.

</span>
<span class="ltx_bibblock">LLMLingua-2: Data Distillation for Efficient and Faithful Task-Agnostic Prompt Compression.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2403.12968</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roziere etÂ al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Baptiste Roziere, Jonas Gehring, Fabian Gloeckle, etÂ al<span id="bib.bib32.3.1" class="ltx_text">.</span> 2023.

</span>
<span class="ltx_bibblock">Code llama: Open foundation models for code.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.4.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2308.12950</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarkar and Rahnemoonfar (2022)</span>
<span class="ltx_bibblock">
Argho Sarkar and Maryam Rahnemoonfar. 2022.

</span>
<span class="ltx_bibblock">Grad-CAM aware supervised attention for visual question answering for post-disaster damage assessment. In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</em>. IEEE, 3783â€“3787.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen etÂ al<span id="bib.bib34.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Ruoyue Shen, Nakamasa Inoue, and Koichi Shinoda. 2024.

</span>
<span class="ltx_bibblock">Pyramid Coder: Hierarchical Code Generator for Compositional Visual Question Answering. In <em id="bib.bib34.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Subramanian etÂ al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Sanjay Subramanian, Medhini Narasimhan, etÂ al<span id="bib.bib35.3.1" class="ltx_text">.</span> 2023.

</span>
<span class="ltx_bibblock">Modular Visual Question Answering via Code Generation. In <em id="bib.bib35.4.1" class="ltx_emph ltx_font_italic">Proc. Annual Meeting of the Association for Computational Linguistics (ACL)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suhr etÂ al<span id="bib.bib36.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Alane Suhr, Stephanie Zhou, Ally Zhang, Iris Zhang, Huajun Bai, and Yoav Artzi. 2019.

</span>
<span class="ltx_bibblock">A Corpus for Reasoning About Natural Language Grounded in Photographs. In <em id="bib.bib36.3.1" class="ltx_emph ltx_font_italic">Proc. Annual Meeting of the Association for Computational Linguistics (ACL)</em>. 6418â€“6428.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">SurÃ­s etÂ al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
DÃ­dac SurÃ­s, Sachit Menon, and Carl Vondrick. 2023.

</span>
<span class="ltx_bibblock">ViperGPT: Visual Inference via Python Execution for Reasoning. In <em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF International Conference on Computer Vision (ICCV)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Team etÂ al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Gemini Team, Rohan Anil, etÂ al<span id="bib.bib38.3.1" class="ltx_text">.</span> 2023.

</span>
<span class="ltx_bibblock">Gemini: a family of highly capable multimodal models.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.4.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2312.11805</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron etÂ al<span id="bib.bib39.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, etÂ al<span id="bib.bib39.3.1" class="ltx_text">.</span> 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.4.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2307.09288</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang etÂ al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Qingqing Wang, Liqiang Xiao, Yue Lu, Yaohui Jin, and Hao He. 2022.

</span>
<span class="ltx_bibblock">Towards Reasoning Ability in Scene Text Visual Question Answering. In <em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>. 2281â€“2289.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wingate etÂ al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
David Wingate, Mohammad Shoeybi, and Taylor Sorensen. 2022.

</span>
<span class="ltx_bibblock">Prompt Compression and Contrastive Conditioning for Controllability and Toxicity Reduction in Language Models. In <em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">Proc. Findings of Empirical Methods in Natural Language Processing (EMNLP Findings)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu etÂ al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Xiangyu Wu, Jianfeng Lu, Zhuanfeng Li, and Fengchao Xiong. 2022.

</span>
<span class="ltx_bibblock">Ques-to-Visual Guided Visual Question Answering. In <em id="bib.bib42.3.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</em>. IEEE, 4193â€“4197.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang etÂ al<span id="bib.bib43.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Pinci Yang, Xin Wang, Xuguang Duan, Hong Chen, Runze Hou, Cong Jin, and Wenwu Zhu. 2022.

</span>
<span class="ltx_bibblock">AVQA: A Dataset for Audio-Visual Question Answering on Videos. In <em id="bib.bib43.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>. 3480â€“3491.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang etÂ al<span id="bib.bib44.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Zichao Yang, Xiaodong He, Jianfeng Gao, etÂ al<span id="bib.bib44.3.1" class="ltx_text">.</span> 2016.

</span>
<span class="ltx_bibblock">Stacked Attention Networks for Image Question Answering. In <em id="bib.bib44.4.1" class="ltx_emph ltx_font_italic">Proc. IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao etÂ al<span id="bib.bib45.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Shunyu Yao, Dian Yu, Jeffrey Zhao, etÂ al<span id="bib.bib45.3.1" class="ltx_text">.</span> 2023.

</span>
<span class="ltx_bibblock">Tree of Thoughts: Deliberate Problem Solving with Large Language Models. In <em id="bib.bib45.4.1" class="ltx_emph ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu etÂ al<span id="bib.bib46.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Licheng Yu, Patrick Poirson, Shan Yang, AlexanderÂ C. Berg, and TamaraÂ L. Berg. 2016.

</span>
<span class="ltx_bibblock">Modeling context in referring expressions. In <em id="bib.bib46.3.1" class="ltx_emph ltx_font_italic">Proc. European Conference on Computer Vision (ECCV)</em>. 69â€“85.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan etÂ al<span id="bib.bib47.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Bowen Yuan, Sisi You, and Bing-Kun Bao. 2023.

</span>
<span class="ltx_bibblock">Self-PT: Adaptive Self-Prompt Tuning for Low-Resource Visual Question Answering. In <em id="bib.bib47.3.1" class="ltx_emph ltx_font_italic">Proc. ACM International Conference on Multimedia (ACMMM)</em>. 5089â€“5098.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Wu (2022)</span>
<span class="ltx_bibblock">
Haotian Zhang and Wei Wu. 2022.

</span>
<span class="ltx_bibblock">Context Relation Fusion Model for Visual Question Answering. In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE International Conference on Image Processing (ICIP)</em>. IEEE, 2112â€“2116.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al<span id="bib.bib49.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Kai Zhang, Li Mo, Wei Chen, Hao Sun, and Yejin Su. 2023.

</span>
<span class="ltx_bibblock">MagicBrush: A manually annotated dataset for instruction-guided image editing. In <em id="bib.bib49.3.1" class="ltx_emph ltx_font_italic">Proc. Annual Conference on Neural Information Processing Systems (NeurIPS)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2407.19409" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2407.19410" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2407.19410">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2407.19410" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2407.19411" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Aug  5 13:45:55 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
