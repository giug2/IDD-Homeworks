<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation</title>
<!--Generated on Mon Jul 22 13:56:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender systems,  Factorization machines,  Low rank factorization" lang="en" name="keywords"/>
<base href="/html/2408.00801v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S1" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S2" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background and problem formulation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.SS1" title="In 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Efficiency of factorization machines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.SS2" title="In 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Inefficiency of field-weighted factorization machines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.SS3" title="In 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Problem formulation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Low-rank field-weighted factorization machines</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.SS1" title="In 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Mathematical foundation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.SS2" title="In 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>The modified model and fast inference algorithm</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.SS2.SSS1" title="In 4.2. The modified model and fast inference algorithm ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>The diagonal plus low-rank FwFM model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.SS2.SSS2" title="In 4.2. The modified model and fast inference algorithm ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Fast inference for item ranking</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.SS1" title="In 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Accuracy on public data-sets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.SS2" title="In 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Synthetic latency measurements</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.SS3" title="In 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Proprietary online advertising system</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.SS3.SSS1" title="In 5.3. Proprietary online advertising system ‣ 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span>Accuracy experiment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.SS3.SSS2" title="In 5.3. Proprietary online advertising system ‣ 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span>Latency experiment</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.SS4" title="In 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Post-hoc factorization of the field interaction matrix</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S6" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusions and future work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#A1" title="In Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Latency charts</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Low Rank Field-Weighted Factorization Machines
<br class="ltx_break"/>for Low Latency Item Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alex Shtoff
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:alex.shtoff@yahooinc.com">alex.shtoff@yahooinc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Michael Viderman
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:viderman@yahooinc.com">viderman@yahooinc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Naama Haramaty-Krasne
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:naamah@yahooinc.com">naamah@yahooinc.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Yahoo Research</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2"></span><span class="ltx_text ltx_affiliation_city" id="id3.3.id3"></span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Oren Somekh
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:orens@yahooinc.com">orens@yahooinc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ariel Raviv
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:arielr@yahooinc.com">arielr@yahooinc.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tularam Ban
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:tularam@yahooinc.com">tularam@yahooinc.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Yahoo Research</span><span class="ltx_text ltx_affiliation_country" id="id5.2.id2"></span><span class="ltx_text ltx_affiliation_city" id="id6.3.id3"></span>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id7.id1">Factorization machine (FM) variants are widely used in recommendation systems that operate under strict throughput and latency requirements, such as online advertising systems. FMs have two prominent strengths. First, is their ability to model pairwise feature interactions while being resilient to data sparsity by learning factorized representations. Second, their computational graphs facilitate fast inference and training. Moreover, when items are ranked as a part of a query for each incoming user, these graphs facilitate computing the portion stemming from the user and context fields only once per query. Thus, the computational cost for each ranked item is proportional only to the number of fields that vary among the ranked items. Consequently, in terms of inference cost, the number of user or context fields is practically unlimited.</p>
<p class="ltx_p" id="id8.id2">More advanced variants of FMs, such as field-aware and field-weighted FMs, provide better accuracy by learning a representation of field-wise interactions, but require computing all pairwise interaction terms explicitly. In particular, the computational cost during inference is proportional to the square of the number of fields, including user, context, and item. When the number of fields is large, this is prohibitive in systems with strict latency constraints, and imposes a limit on the number of user and context fields for a given computational budget. To mitigate this caveat, heuristic pruning of low intensity field interactions is commonly used to accelerate inference.</p>
<p class="ltx_p" id="id9.id3">In this work we propose an alternative to the pruning heuristic in field-weighted FMs using a diagonal plus symmetric low-rank decomposition. Our technique reduces the computational cost of inference, by allowing it to be proportional to the number of item fields only. Using a set of experiments on real-world datasets, we show that aggressive rank reduction outperforms similarly aggressive pruning, both in terms of accuracy and item recommendation speed. Beyond computational complexity analysis, we corroborate our claim of faster inference experimentally, both via a synthetic test, and by having deployed our solution to a major online advertising system, where we observed significant ranking latency improvements. We made the code to reproduce the results on public datasets and synthetic tests available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://anonymous.4open.science/r/pytorch-fm-0EC0" title="">https://anonymous.4open.science/r/pytorch-fm-0EC0</a>.</p>
</div>
<div class="ltx_keywords">Recommender systems, Factorization machines, Low rank factorization
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Factorization methods</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Online advertising</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Mathematics of computing Computations on matrices</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommendation systems driven by machine-learned predictive models are widely used throughout the industry for a large variety of applications, from movie recommendation, to ad ranking in online advertising systems. In some applications, recommendation quality is the main objective, where sophisticated and computationally complex deep learning techniques are used to capture the affinity between the users and the recommended items. But other applications require striking an intricate balance between the accuracy of the predictive models, their training and inference speed. For example, real-time bidding systems in programmatic advertising are required to compute a ranking score for a large number of ads in a matter of a few milliseconds, and to train quickly in order to adapt to the ever-changing ad marketplace conditions. Such systems often deploy variants of the celebrated factorization machine (FM) models <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib30" title="">2010a</a>)</cite> in order to overcome data sparsity issues, while excelling at achieving a good balance between prediction accuracy and speed.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1"><cite class="ltx_cite ltx_citemacro_citet">Rendle (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib30" title="">2010a</a>)</cite> also showed that while FMs model pairwise feature interactions, whose number is quadratic in the number of features, there is an equivalent formulation of FMs whose computational complexity is <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">linear</em> in the number features. This already facilitates fast training. Moreover, when ranking items for a given user in a given context, the user and context features are the same for all items. The equivalent formulation allows caching the user and context computation results once, meaning that the computational cost per item is linear in the number of item features only. Therefore, factorization machines are also extremely efficient for ranking.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Many real-world applications involve large-scale multi-field data (e.g., gender and item category). However, FMs have a limited predictive accuracy, since they fail to capture the fact that the same feature can behave differently when interacting with features from different fields. To resolve this issue, many variants that incorporate field information have been proposed in recent years, including field-aware <cite class="ltx_cite ltx_citemacro_citep">(Juan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib16" title="">2016a</a>)</cite>, field-weighted <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite>, and field-embedded <cite class="ltx_cite ltx_citemacro_citep">(Pande, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib28" title="">2021</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib35" title="">2021a</a>)</cite> factorization machines. Unfortunately, none of these variants admit an equivalent formulation whose computational complexity is linear in the number of features. This poses a challenge when building cost-effective, large-scale real-time recommendation systems, as the additional gain from incorporating field information comes at the cost of additional computing power.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The focus of this work is the <em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">field-weighted factorization machine</em> (FwFM) variant <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite>, under the large-scale and low inference latency regime. It is similar to a regular factorization machine, with an additional symmetric matrix of parameters modeling the strength of pairwise field interactions. It is attractive in practice due to the fact that in terms of memory consumption and the number of parameters, it is on par with a regular FM. In addition, it is less prone to over-fitting, as pointed out by <cite class="ltx_cite ltx_citemacro_citet">Juan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib16" title="">2016a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Pan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite>, and admits a simple heuristic for reducing the computational complexity at the inference stage by pruning low-magnitude field interactions. However, pruning has some cost in terms of accuracy. In this work, we devise a different way to significantly reduce the computational cost of field-weighted factorization machines by decomposition the matrix of pairwise field interactions. Motivated by the visualization of the field interaction matrices in <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite>, that resembles a block-like structure due to field groups exhibiting similar interaction behavior, we employ the well-known diagonal plus low-rank (DPLR) matrix decomposition, to produce an FwFM variant we call DPLR-FwFM. We show that our idea facilitates utilizing the additional accuracy provided by incorporating field information, while benefiting from a per-item computational cost that is linear in the number of item fields, albeit slower than regular FM by a factor proportional to the rank of the low-rank part of the decomposition.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">We evaluate our technique on public datasets, and on proprietary data from a large-scale online advertising system of a major company. Our results demonstrate that, in practice, DPLR-FwFM with extremely low ranks outperform aggressively pruned FwFM models both in terms of latency and accuracy. . Finally, we deploy our solution in an online advertising system of a major company, and show that the latency incurred by a prediction module based on our DPLR-FwFM model is better than that of the module currently used in production and is based on a pruned FwFM.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To summarize, the main contributions of our paper are:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Reformulate FwFM models to make their computational cost on par, or higher by a small constant factor of our choice, compared to regular FMs, and significantly cheaper than FwFMs. This, while benefiting from the higher accuracy provided by incorporating field information.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Show that the accuracy of the obtained models is on par or higher than pruned FwFM models on public and proprietary data-sets.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(3)</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Demonstrate that, in practice, in a real-world online advertising system, our approach can significantly reduce the computational costs, thus achieving lower latency with a given computational budget, or reducing the computational power required to achieve a given latency.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Recommendation technologies such as <span class="ltx_text ltx_font_italic" id="S2.p1.1.1">Collaborative Filtering</span> (CF) <cite class="ltx_cite ltx_citemacro_citep">(Goldberg et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib12" title="">1992</a>)</cite>, help users discover new items based on past preferences. <span class="ltx_text ltx_font_italic" id="S2.p1.1.2">Matrix Factorization</span> (MF) is a leading approach in CF, addressing data expansion and sparsity by using a latent factor model <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib19" title="">2009</a>)</cite>. Such systems find applications in various domains, including movie recommendation <cite class="ltx_cite ltx_citemacro_citep">(Bell and Koren, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib7" title="">2007</a>)</cite>, music recommendation <cite class="ltx_cite ltx_citemacro_citep">(Aizenberg et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib4" title="">2012</a>)</cite>, ad matching <cite class="ltx_cite ltx_citemacro_citep">(Aharon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib3" title="">2013</a>)</cite> and more.
<span class="ltx_text ltx_font_italic" id="S2.p1.1.3">Factorization machine</span> (FM) variants excel in benchmark tabular classification tasks, particularly when dealing with a large number of interactions and requiring fast predictions. This family includes several members as the original FM <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib31" title="">2010b</a>)</cite>, <span class="ltx_text ltx_font_italic" id="S2.p1.1.4">field-aware factorization machine</span> (FFM) <cite class="ltx_cite ltx_citemacro_citep">(Juan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib17" title="">2016b</a>)</cite>, <span class="ltx_text ltx_font_italic" id="S2.p1.1.5">field weighted factorization machine</span> (FwFM) <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib27" title="">2018b</a>)</cite> and the <span class="ltx_text ltx_font_italic" id="S2.p1.1.6">field-matrixed factorization machine</span> (FmFM) <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib36" title="">2021b</a>)</cite>.
For handling a wider range of features with non-linear interactions, <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib10" title="">2016</a>)</cite> presented <span class="ltx_text ltx_font_italic" id="S2.p1.1.7">Wide &amp; Deep</span> learning approach, which trains a network that combines a linear model and a deep neural network. Their work was followed by a wave of deep learning techniques aimed at improving prediction accuracy, while also being sensitive to low-latency efficiency. An essential application that motivated such works, and also the focus of this work, is CTR prediction for online advertising. It has been the topic of many techniques as DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib13" title="">2017</a>)</cite>, xDeepFM <cite class="ltx_cite ltx_citemacro_citep">(Lian et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib20" title="">2018</a>)</cite>, DCN <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib38" title="">2017</a>)</cite>, AutoInt <cite class="ltx_cite ltx_citemacro_citep">(Song et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib34" title="">2019</a>)</cite>, DeepLight <cite class="ltx_cite ltx_citemacro_citep">(Deng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib11" title="">2021</a>)</cite> and more. While these methods offer improved predictions, their high latency and long training time cause many applications to still prefer FM-based approaches.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Low-rank factorizations have emerged as a versatile and powerful tool in <span class="ltx_text ltx_font_italic" id="S2.p2.1.1">machine learning</span> (ML) and <span class="ltx_text ltx_font_italic" id="S2.p2.1.2">artificial intelligence</span> (AI), finding applications across a spectrum of domains. For instance, low-rank matrix-factorization in the context of recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Koren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib19" title="">2009</a>; Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib31" title="">2010b</a>)</cite>, in natural language processing for topic modeling, and dimensionality reduction <cite class="ltx_cite ltx_citemacro_citep">(Blei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib9" title="">2003</a>)</cite>, and more recently, for large-scale pre-training and fine-tuning of models on diverse natural language understanding tasks <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib15" title="">2021</a>)</cite>.
In cases where the involved matrices are full-ranked and low-rank factorizations are less effective, <span class="ltx_text ltx_font_italic" id="S2.p2.1.3">diagonal plus low-rank factorization</span> (DPLR) may be considered (see the work of <cite class="ltx_cite ltx_citemacro_citep">(Saunderson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib32" title="">2012</a>)</cite> and references therein).
DPLR involves approximating a given matrix, often a large, and high-dimensional one, by decomposing it into the sum of two matrices: a diagonal matrix and a low-rank matrix. In statistics, DPLR is used to approximate high-dimensional covariance matrices of multivariate normal distributions <cite class="ltx_cite ltx_citemacro_citep">(Liutkus and Yoshii, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib22" title="">2017</a>; Ong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib25" title="">2018</a>)</cite>. In ML, DPLR is used for enhancing the efficiency of models (see the work of <cite class="ltx_cite ltx_citemacro_citep">(Bingham et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib8" title="">2019</a>)</cite> for an ML library that uses DPLR covariance matrices). For instance, DPLR-based methods have been employed in deep learning architectures for more efficient and accurate models <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib40" title="">2016</a>; Tomczak et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib37" title="">2020</a>; Mishkin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib24" title="">2018</a>)</cite>. Inspired by an observation of <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib21" title="">2018</a>)</cite>, that the regular FM field-interaction matrix equals a rank-one matrix minus the identity matrix, we apply DPLR to FwFM and improve its training and inference efficiency.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">One FM-like approach that resembles our work is of <cite class="ltx_cite ltx_citemacro_citep">(Almagor and Hoshen, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib6" title="">2022</a>)</cite>, where the authors apply a low-rank factorization to a generalized FM family representation (that includes FM, FFM, FwFM and FmFM as special cases). At first glance, their method seems to have much in common with our work, as both works use low-rank factorization to represent field interactions. However, there are two key differences. First, <cite class="ltx_cite ltx_citemacro_citep">(Almagor and Hoshen, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib6" title="">2022</a>)</cite> takes a modeling approach to show that a family of FMs can be implemented as standard feed-forward networks. Our paper takes a different direction, that of recommendation systems: we focus on using a low-rank factorization to represent the separation into context and item fields, to improve item recommendation accuracy with FwFM models under strict latency constraints. Second, in contrast to <cite class="ltx_cite ltx_citemacro_citep">(Almagor and Hoshen, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib6" title="">2022</a>)</cite>, our work adds a diagonal component to the low-rank factorization, which plays a key role in the ability to be efficient for real-time systems, as shown in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.SS1" title="4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Background and problem formulation</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we provide a detailed explanation of the computational efficiency properties of FMs in recommending items, and the efficiency drop introduced by switching to field-aware variants. We then formulate the problem of reducing the gap between the two.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Efficiency of factorization machines</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Given a feature vector <math alttext="{\bm{x}}\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝒙</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝒙</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">{\bm{x}}\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_italic_x ∈ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, the FM model proposed by <cite class="ltx_cite ltx_citemacro_citet">Rendle (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib30" title="">2010a</a>)</cite> computes</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Phi_{\mathrm{FM}}({\bm{x}};b_{0},{\bm{b}},{\bm{w}}_{1},\dots,{\bm{w}}_{n})=b_%
{0}+\langle{\bm{b}},{\bm{x}}\rangle+\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_{i%
}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}\rangle," class="ltx_Math" display="block" id="S3.Ex1.m1.6"><semantics id="S3.Ex1.m1.6a"><mrow id="S3.Ex1.m1.6.6.1" xref="S3.Ex1.m1.6.6.1.1.cmml"><mrow id="S3.Ex1.m1.6.6.1.1" xref="S3.Ex1.m1.6.6.1.1.cmml"><mrow id="S3.Ex1.m1.6.6.1.1.3" xref="S3.Ex1.m1.6.6.1.1.3.cmml"><msub id="S3.Ex1.m1.6.6.1.1.3.5" xref="S3.Ex1.m1.6.6.1.1.3.5.cmml"><mi id="S3.Ex1.m1.6.6.1.1.3.5.2" mathvariant="normal" xref="S3.Ex1.m1.6.6.1.1.3.5.2.cmml">Φ</mi><mi id="S3.Ex1.m1.6.6.1.1.3.5.3" xref="S3.Ex1.m1.6.6.1.1.3.5.3.cmml">FM</mi></msub><mo id="S3.Ex1.m1.6.6.1.1.3.4" xref="S3.Ex1.m1.6.6.1.1.3.4.cmml">⁢</mo><mrow id="S3.Ex1.m1.6.6.1.1.3.3.3" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml"><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.4" stretchy="false" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝒙</mi><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.5" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">;</mo><msub id="S3.Ex1.m1.6.6.1.1.1.1.1.1" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.6.6.1.1.1.1.1.1.2" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1.2.cmml">b</mi><mn id="S3.Ex1.m1.6.6.1.1.1.1.1.1.3" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.6" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">𝒃</mi><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.7" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">,</mo><msub id="S3.Ex1.m1.6.6.1.1.2.2.2.2" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S3.Ex1.m1.6.6.1.1.2.2.2.2.2" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2.2.cmml">𝒘</mi><mn id="S3.Ex1.m1.6.6.1.1.2.2.2.2.3" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.8" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">,</mo><mi id="S3.Ex1.m1.3.3" mathvariant="normal" xref="S3.Ex1.m1.3.3.cmml">…</mi><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.9" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">,</mo><msub id="S3.Ex1.m1.6.6.1.1.3.3.3.3" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3.cmml"><mi id="S3.Ex1.m1.6.6.1.1.3.3.3.3.2" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3.2.cmml">𝒘</mi><mi id="S3.Ex1.m1.6.6.1.1.3.3.3.3.3" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3.3.cmml">n</mi></msub><mo id="S3.Ex1.m1.6.6.1.1.3.3.3.10" stretchy="false" xref="S3.Ex1.m1.6.6.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.6.6.1.1.6" xref="S3.Ex1.m1.6.6.1.1.6.cmml">=</mo><mrow id="S3.Ex1.m1.6.6.1.1.5" xref="S3.Ex1.m1.6.6.1.1.5.cmml"><msub id="S3.Ex1.m1.6.6.1.1.5.4" xref="S3.Ex1.m1.6.6.1.1.5.4.cmml"><mi id="S3.Ex1.m1.6.6.1.1.5.4.2" xref="S3.Ex1.m1.6.6.1.1.5.4.2.cmml">b</mi><mn id="S3.Ex1.m1.6.6.1.1.5.4.3" xref="S3.Ex1.m1.6.6.1.1.5.4.3.cmml">0</mn></msub><mo id="S3.Ex1.m1.6.6.1.1.5.3" xref="S3.Ex1.m1.6.6.1.1.5.3.cmml">+</mo><mrow id="S3.Ex1.m1.6.6.1.1.5.5.2" xref="S3.Ex1.m1.6.6.1.1.5.5.1.cmml"><mo id="S3.Ex1.m1.6.6.1.1.5.5.2.1" stretchy="false" xref="S3.Ex1.m1.6.6.1.1.5.5.1.cmml">⟨</mo><mi id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.4.cmml">𝒃</mi><mo id="S3.Ex1.m1.6.6.1.1.5.5.2.2" xref="S3.Ex1.m1.6.6.1.1.5.5.1.cmml">,</mo><mi id="S3.Ex1.m1.5.5" xref="S3.Ex1.m1.5.5.cmml">𝒙</mi><mo id="S3.Ex1.m1.6.6.1.1.5.5.2.3" stretchy="false" xref="S3.Ex1.m1.6.6.1.1.5.5.1.cmml">⟩</mo></mrow><mo id="S3.Ex1.m1.6.6.1.1.5.3a" rspace="0.055em" xref="S3.Ex1.m1.6.6.1.1.5.3.cmml">+</mo><mrow id="S3.Ex1.m1.6.6.1.1.5.2" xref="S3.Ex1.m1.6.6.1.1.5.2.cmml"><munderover id="S3.Ex1.m1.6.6.1.1.5.2.3" xref="S3.Ex1.m1.6.6.1.1.5.2.3.cmml"><mo id="S3.Ex1.m1.6.6.1.1.5.2.3.2.2" movablelimits="false" rspace="0em" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.cmml"><mi id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.2" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.1" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.3" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.6.6.1.1.5.2.3.3" xref="S3.Ex1.m1.6.6.1.1.5.2.3.3.cmml">n</mi></munderover><mrow id="S3.Ex1.m1.6.6.1.1.5.2.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.cmml"><munderover id="S3.Ex1.m1.6.6.1.1.5.2.2.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.cmml"><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.2" movablelimits="false" rspace="0em" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.cmml"><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.2.cmml">j</mi><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.1" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.1.cmml">=</mo><mrow id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.cmml"><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.2.cmml">i</mi><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.1" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.1.cmml">+</mo><mn id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.3.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.3.cmml">n</mi></munderover><mrow id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.3.cmml"><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.3" stretchy="false" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.3.cmml">⟨</mo><mrow id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.cmml"><msub id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.2" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.3" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.1" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.2" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.2.cmml">𝒘</mi><mi id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.3" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.4" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.3.cmml">,</mo><mrow id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.cmml"><msub id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.cmml"><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.2.cmml">x</mi><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.1" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.cmml"><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.2" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.2.cmml">𝒘</mi><mi id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.3" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.5" stretchy="false" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m1.6.6.1.2" xref="S3.Ex1.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.6b"><apply id="S3.Ex1.m1.6.6.1.1.cmml" xref="S3.Ex1.m1.6.6.1"><eq id="S3.Ex1.m1.6.6.1.1.6.cmml" xref="S3.Ex1.m1.6.6.1.1.6"></eq><apply id="S3.Ex1.m1.6.6.1.1.3.cmml" xref="S3.Ex1.m1.6.6.1.1.3"><times id="S3.Ex1.m1.6.6.1.1.3.4.cmml" xref="S3.Ex1.m1.6.6.1.1.3.4"></times><apply id="S3.Ex1.m1.6.6.1.1.3.5.cmml" xref="S3.Ex1.m1.6.6.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.3.5.1.cmml" xref="S3.Ex1.m1.6.6.1.1.3.5">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.3.5.2.cmml" xref="S3.Ex1.m1.6.6.1.1.3.5.2">Φ</ci><ci id="S3.Ex1.m1.6.6.1.1.3.5.3.cmml" xref="S3.Ex1.m1.6.6.1.1.3.5.3">FM</ci></apply><list id="S3.Ex1.m1.6.6.1.1.3.3.4.cmml" xref="S3.Ex1.m1.6.6.1.1.3.3.3"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝒙</ci><apply id="S3.Ex1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1.2">𝑏</ci><cn id="S3.Ex1.m1.6.6.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.1.1.1.1.1.1.3">0</cn></apply><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝒃</ci><apply id="S3.Ex1.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2.2">𝒘</ci><cn id="S3.Ex1.m1.6.6.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.1.1.2.2.2.2.3">1</cn></apply><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">…</ci><apply id="S3.Ex1.m1.6.6.1.1.3.3.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.3.3.3.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.3.3.3.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3.2">𝒘</ci><ci id="S3.Ex1.m1.6.6.1.1.3.3.3.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.3.3.3.3.3">𝑛</ci></apply></list></apply><apply id="S3.Ex1.m1.6.6.1.1.5.cmml" xref="S3.Ex1.m1.6.6.1.1.5"><plus id="S3.Ex1.m1.6.6.1.1.5.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.3"></plus><apply id="S3.Ex1.m1.6.6.1.1.5.4.cmml" xref="S3.Ex1.m1.6.6.1.1.5.4"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.4.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.4">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.5.4.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.4.2">𝑏</ci><cn id="S3.Ex1.m1.6.6.1.1.5.4.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.1.1.5.4.3">0</cn></apply><list id="S3.Ex1.m1.6.6.1.1.5.5.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.5.2"><ci id="S3.Ex1.m1.4.4.cmml" xref="S3.Ex1.m1.4.4">𝒃</ci><ci id="S3.Ex1.m1.5.5.cmml" xref="S3.Ex1.m1.5.5">𝒙</ci></list><apply id="S3.Ex1.m1.6.6.1.1.5.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2"><apply id="S3.Ex1.m1.6.6.1.1.5.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.2.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3">superscript</csymbol><apply id="S3.Ex1.m1.6.6.1.1.5.2.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.2.3.2.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3">subscript</csymbol><sum id="S3.Ex1.m1.6.6.1.1.5.2.3.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.2"></sum><apply id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3"><eq id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.1"></eq><ci id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.2">𝑖</ci><cn id="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.1.1.5.2.3.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.6.6.1.1.5.2.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.3.3">𝑛</ci></apply><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2"><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.2.2.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3">superscript</csymbol><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3">subscript</csymbol><sum id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.2"></sum><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3"><eq id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.1"></eq><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.2">𝑗</ci><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3"><plus id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.1"></plus><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.2">𝑖</ci><cn id="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.3.cmml" type="integer" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.3.3">𝑛</ci></apply><list id="S3.Ex1.m1.6.6.1.1.5.2.2.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2"><apply id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1"><times id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.1"></times><apply id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.2">𝒘</ci><ci id="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.4.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2"><times id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.1"></times><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.2">𝑥</ci><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.1.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.2.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.2">𝒘</ci><ci id="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.3.cmml" xref="S3.Ex1.m1.6.6.1.1.5.2.2.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.6c">\Phi_{\mathrm{FM}}({\bm{x}};b_{0},{\bm{b}},{\bm{w}}_{1},\dots,{\bm{w}}_{n})=b_%
{0}+\langle{\bm{b}},{\bm{x}}\rangle+\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_{i%
}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}\rangle,</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.6d">roman_Φ start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT ( bold_italic_x ; italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_italic_b , bold_italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + ⟨ bold_italic_b , bold_italic_x ⟩ + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⟨ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.7">where <math alttext="b_{0}\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m1.1"><semantics id="S3.SS1.p1.2.m1.1a"><mrow id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml"><msub id="S3.SS1.p1.2.m1.1.1.2" xref="S3.SS1.p1.2.m1.1.1.2.cmml"><mi id="S3.SS1.p1.2.m1.1.1.2.2" xref="S3.SS1.p1.2.m1.1.1.2.2.cmml">b</mi><mn id="S3.SS1.p1.2.m1.1.1.2.3" xref="S3.SS1.p1.2.m1.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS1.p1.2.m1.1.1.1" xref="S3.SS1.p1.2.m1.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.2.m1.1.1.3" xref="S3.SS1.p1.2.m1.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.1b"><apply id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1"><in id="S3.SS1.p1.2.m1.1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1.1"></in><apply id="S3.SS1.p1.2.m1.1.1.2.cmml" xref="S3.SS1.p1.2.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.2.m1.1.1.2.2.cmml" xref="S3.SS1.p1.2.m1.1.1.2.2">𝑏</ci><cn id="S3.SS1.p1.2.m1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m1.1.1.2.3">0</cn></apply><ci id="S3.SS1.p1.2.m1.1.1.3.cmml" xref="S3.SS1.p1.2.m1.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.1c">b_{0}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m1.1d">italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ blackboard_R</annotation></semantics></math>, <math alttext="{\bm{b}}\in\mathbb{R}^{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m2.1"><semantics id="S3.SS1.p1.3.m2.1a"><mrow id="S3.SS1.p1.3.m2.1.1" xref="S3.SS1.p1.3.m2.1.1.cmml"><mi id="S3.SS1.p1.3.m2.1.1.2" xref="S3.SS1.p1.3.m2.1.1.2.cmml">𝒃</mi><mo id="S3.SS1.p1.3.m2.1.1.1" xref="S3.SS1.p1.3.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m2.1.1.3" xref="S3.SS1.p1.3.m2.1.1.3.cmml"><mi id="S3.SS1.p1.3.m2.1.1.3.2" xref="S3.SS1.p1.3.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.3.m2.1.1.3.3" xref="S3.SS1.p1.3.m2.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m2.1b"><apply id="S3.SS1.p1.3.m2.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1"><in id="S3.SS1.p1.3.m2.1.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1.1"></in><ci id="S3.SS1.p1.3.m2.1.1.2.cmml" xref="S3.SS1.p1.3.m2.1.1.2">𝒃</ci><apply id="S3.SS1.p1.3.m2.1.1.3.cmml" xref="S3.SS1.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m2.1.1.3.1.cmml" xref="S3.SS1.p1.3.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m2.1.1.3.2.cmml" xref="S3.SS1.p1.3.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.p1.3.m2.1.1.3.3.cmml" xref="S3.SS1.p1.3.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m2.1c">{\bm{b}}\in\mathbb{R}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m2.1d">bold_italic_b ∈ blackboard_R start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="{\bm{w}}_{1},\dots,{\bm{w}}_{n}\in\mathbb{R}^{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m3.3"><semantics id="S3.SS1.p1.4.m3.3a"><mrow id="S3.SS1.p1.4.m3.3.3" xref="S3.SS1.p1.4.m3.3.3.cmml"><mrow id="S3.SS1.p1.4.m3.3.3.2.2" xref="S3.SS1.p1.4.m3.3.3.2.3.cmml"><msub id="S3.SS1.p1.4.m3.2.2.1.1.1" xref="S3.SS1.p1.4.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.4.m3.2.2.1.1.1.2" xref="S3.SS1.p1.4.m3.2.2.1.1.1.2.cmml">𝒘</mi><mn id="S3.SS1.p1.4.m3.2.2.1.1.1.3" xref="S3.SS1.p1.4.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m3.3.3.2.2.3" xref="S3.SS1.p1.4.m3.3.3.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m3.1.1" mathvariant="normal" xref="S3.SS1.p1.4.m3.1.1.cmml">…</mi><mo id="S3.SS1.p1.4.m3.3.3.2.2.4" xref="S3.SS1.p1.4.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.4.m3.3.3.2.2.2" xref="S3.SS1.p1.4.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.4.m3.3.3.2.2.2.2" xref="S3.SS1.p1.4.m3.3.3.2.2.2.2.cmml">𝒘</mi><mi id="S3.SS1.p1.4.m3.3.3.2.2.2.3" xref="S3.SS1.p1.4.m3.3.3.2.2.2.3.cmml">n</mi></msub></mrow><mo id="S3.SS1.p1.4.m3.3.3.3" xref="S3.SS1.p1.4.m3.3.3.3.cmml">∈</mo><msup id="S3.SS1.p1.4.m3.3.3.4" xref="S3.SS1.p1.4.m3.3.3.4.cmml"><mi id="S3.SS1.p1.4.m3.3.3.4.2" xref="S3.SS1.p1.4.m3.3.3.4.2.cmml">ℝ</mi><mi id="S3.SS1.p1.4.m3.3.3.4.3" xref="S3.SS1.p1.4.m3.3.3.4.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m3.3b"><apply id="S3.SS1.p1.4.m3.3.3.cmml" xref="S3.SS1.p1.4.m3.3.3"><in id="S3.SS1.p1.4.m3.3.3.3.cmml" xref="S3.SS1.p1.4.m3.3.3.3"></in><list id="S3.SS1.p1.4.m3.3.3.2.3.cmml" xref="S3.SS1.p1.4.m3.3.3.2.2"><apply id="S3.SS1.p1.4.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.4.m3.2.2.1.1.1.2">𝒘</ci><cn id="S3.SS1.p1.4.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.4.m3.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1">…</ci><apply id="S3.SS1.p1.4.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.4.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.4.m3.3.3.2.2.2.2">𝒘</ci><ci id="S3.SS1.p1.4.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.4.m3.3.3.2.2.2.3">𝑛</ci></apply></list><apply id="S3.SS1.p1.4.m3.3.3.4.cmml" xref="S3.SS1.p1.4.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m3.3.3.4.1.cmml" xref="S3.SS1.p1.4.m3.3.3.4">superscript</csymbol><ci id="S3.SS1.p1.4.m3.3.3.4.2.cmml" xref="S3.SS1.p1.4.m3.3.3.4.2">ℝ</ci><ci id="S3.SS1.p1.4.m3.3.3.4.3.cmml" xref="S3.SS1.p1.4.m3.3.3.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m3.3c">{\bm{w}}_{1},\dots,{\bm{w}}_{n}\in\mathbb{R}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m3.3d">bold_italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> are trainable parameters. Overall, the model has <math alttext="1+n+nk" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m4.1"><semantics id="S3.SS1.p1.5.m4.1a"><mrow id="S3.SS1.p1.5.m4.1.1" xref="S3.SS1.p1.5.m4.1.1.cmml"><mn id="S3.SS1.p1.5.m4.1.1.2" xref="S3.SS1.p1.5.m4.1.1.2.cmml">1</mn><mo id="S3.SS1.p1.5.m4.1.1.1" xref="S3.SS1.p1.5.m4.1.1.1.cmml">+</mo><mi id="S3.SS1.p1.5.m4.1.1.3" xref="S3.SS1.p1.5.m4.1.1.3.cmml">n</mi><mo id="S3.SS1.p1.5.m4.1.1.1a" xref="S3.SS1.p1.5.m4.1.1.1.cmml">+</mo><mrow id="S3.SS1.p1.5.m4.1.1.4" xref="S3.SS1.p1.5.m4.1.1.4.cmml"><mi id="S3.SS1.p1.5.m4.1.1.4.2" xref="S3.SS1.p1.5.m4.1.1.4.2.cmml">n</mi><mo id="S3.SS1.p1.5.m4.1.1.4.1" xref="S3.SS1.p1.5.m4.1.1.4.1.cmml">⁢</mo><mi id="S3.SS1.p1.5.m4.1.1.4.3" xref="S3.SS1.p1.5.m4.1.1.4.3.cmml">k</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m4.1b"><apply id="S3.SS1.p1.5.m4.1.1.cmml" xref="S3.SS1.p1.5.m4.1.1"><plus id="S3.SS1.p1.5.m4.1.1.1.cmml" xref="S3.SS1.p1.5.m4.1.1.1"></plus><cn id="S3.SS1.p1.5.m4.1.1.2.cmml" type="integer" xref="S3.SS1.p1.5.m4.1.1.2">1</cn><ci id="S3.SS1.p1.5.m4.1.1.3.cmml" xref="S3.SS1.p1.5.m4.1.1.3">𝑛</ci><apply id="S3.SS1.p1.5.m4.1.1.4.cmml" xref="S3.SS1.p1.5.m4.1.1.4"><times id="S3.SS1.p1.5.m4.1.1.4.1.cmml" xref="S3.SS1.p1.5.m4.1.1.4.1"></times><ci id="S3.SS1.p1.5.m4.1.1.4.2.cmml" xref="S3.SS1.p1.5.m4.1.1.4.2">𝑛</ci><ci id="S3.SS1.p1.5.m4.1.1.4.3.cmml" xref="S3.SS1.p1.5.m4.1.1.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m4.1c">1+n+nk</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m4.1d">1 + italic_n + italic_n italic_k</annotation></semantics></math> trainable parameters, and the direct formula above for <math alttext="\Phi_{\mathrm{FM}}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m5.1"><semantics id="S3.SS1.p1.6.m5.1a"><msub id="S3.SS1.p1.6.m5.1.1" xref="S3.SS1.p1.6.m5.1.1.cmml"><mi id="S3.SS1.p1.6.m5.1.1.2" mathvariant="normal" xref="S3.SS1.p1.6.m5.1.1.2.cmml">Φ</mi><mi id="S3.SS1.p1.6.m5.1.1.3" xref="S3.SS1.p1.6.m5.1.1.3.cmml">FM</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m5.1b"><apply id="S3.SS1.p1.6.m5.1.1.cmml" xref="S3.SS1.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m5.1.1.1.cmml" xref="S3.SS1.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m5.1.1.2.cmml" xref="S3.SS1.p1.6.m5.1.1.2">Φ</ci><ci id="S3.SS1.p1.6.m5.1.1.3.cmml" xref="S3.SS1.p1.6.m5.1.1.3">FM</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m5.1c">\Phi_{\mathrm{FM}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m5.1d">roman_Φ start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT</annotation></semantics></math> can be computed in <math alttext="O(n^{2}k)" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m6.1"><semantics id="S3.SS1.p1.7.m6.1a"><mrow id="S3.SS1.p1.7.m6.1.1" xref="S3.SS1.p1.7.m6.1.1.cmml"><mi id="S3.SS1.p1.7.m6.1.1.3" xref="S3.SS1.p1.7.m6.1.1.3.cmml">O</mi><mo id="S3.SS1.p1.7.m6.1.1.2" xref="S3.SS1.p1.7.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.7.m6.1.1.1.1" xref="S3.SS1.p1.7.m6.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.7.m6.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.7.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.7.m6.1.1.1.1.1" xref="S3.SS1.p1.7.m6.1.1.1.1.1.cmml"><msup id="S3.SS1.p1.7.m6.1.1.1.1.1.2" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.7.m6.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2.2.cmml">n</mi><mn id="S3.SS1.p1.7.m6.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS1.p1.7.m6.1.1.1.1.1.1" xref="S3.SS1.p1.7.m6.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.7.m6.1.1.1.1.1.3" xref="S3.SS1.p1.7.m6.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS1.p1.7.m6.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.7.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m6.1b"><apply id="S3.SS1.p1.7.m6.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1"><times id="S3.SS1.p1.7.m6.1.1.2.cmml" xref="S3.SS1.p1.7.m6.1.1.2"></times><ci id="S3.SS1.p1.7.m6.1.1.3.cmml" xref="S3.SS1.p1.7.m6.1.1.3">𝑂</ci><apply id="S3.SS1.p1.7.m6.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1.1.1"><times id="S3.SS1.p1.7.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1.1.1.1.1"></times><apply id="S3.SS1.p1.7.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m6.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.7.m6.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2.2">𝑛</ci><cn id="S3.SS1.p1.7.m6.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.7.m6.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS1.p1.7.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m6.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m6.1c">O(n^{2}k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m6.1d">italic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_k )</annotation></semantics></math> time. But as <cite class="ltx_cite ltx_citemacro_citet">Rendle (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib30" title="">2010a</a>)</cite> pointed out, the pairwise interaction terms can be re-written as</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}%
\rangle=\frac{1}{2}\left(\Bigl{\|}\sum_{i=1}^{n}x_{i}{\bm{w}}_{i}\Bigr{\|}^{2}%
-\sum_{i=1}^{n}\Bigl{\|}x_{i}{\bm{w}}_{i}\Bigr{\|}^{2}\right)." class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml"><mo id="S3.E1.m1.1.1.1.1.2.3.2.2" movablelimits="false" xref="S3.E1.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.2.3.2.3" xref="S3.E1.m1.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.3.2.3.2" xref="S3.E1.m1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.3.2.3.1" xref="S3.E1.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.3.2.3.3" xref="S3.E1.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.2.3.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml"><mo id="S3.E1.m1.1.1.1.1.2.2.3.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S3.E1.m1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.3.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.3.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E1.m1.1.1.1.1.2.2.3.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.2" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.1" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E1.m1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">⟨</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒘</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml"><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.2.cmml">𝒘</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mfrac id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml"><mn id="S3.E1.m1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.3.3.2.cmml">1</mn><mn id="S3.E1.m1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.3.cmml">2</mn></mfrac><mo id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.3.1.1.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.cmml"><msup id="S3.E1.m1.1.1.1.1.3.1.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.2.cmml"><mo fence="true" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.cmml">n</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.2.cmml">𝒘</mi><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mo fence="true" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E1.m1.1.1.1.1.3.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.3" rspace="0.055em" xref="S3.E1.m1.1.1.1.1.3.1.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.cmml"><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.2" movablelimits="false" rspace="0em" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.3.cmml">n</mi></munderover><msup id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.2.cmml"><mo fence="true" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.2.1.cmml">∥</mo><mrow id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.2.cmml">𝒘</mi><mi id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo fence="true" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.3.1.1.3" xref="S3.E1.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" lspace="0em" xref="S3.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"></eq><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><apply id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.3.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3.2.3"><eq id="S3.E1.m1.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.3.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><apply id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3"><eq id="S3.E1.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.2">𝑗</ci><apply id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3"><plus id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.1"></plus><ci id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.3">𝑛</ci></apply><list id="S3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.2">𝒘</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><times id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.1"></times><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.2">𝒘</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.3">𝑗</ci></apply></apply></list></apply></apply><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><times id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2"></times><apply id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3"><divide id="S3.E1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.3"></divide><cn id="S3.E1.m1.1.1.1.1.3.3.2.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.3.3.2">1</cn><cn id="S3.E1.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.3.3.3">2</cn></apply><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1"><minus id="S3.E1.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.3"></minus><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.2">𝒘</ci><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply></apply><cn id="S3.E1.m1.1.1.1.1.3.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.3.1.1.1.1.3">2</cn></apply><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2"><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3"><eq id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.2">𝑖</ci><cn id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.2.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.1"></times><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.2">𝒘</ci><ci id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn id="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.3.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}%
\rangle=\frac{1}{2}\left(\Bigl{\|}\sum_{i=1}^{n}x_{i}{\bm{w}}_{i}\Bigr{\|}^{2}%
-\sum_{i=1}^{n}\Bigl{\|}x_{i}{\bm{w}}_{i}\Bigr{\|}^{2}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⟨ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( ∥ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∥ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.8">This dramatically reduces the time complexity to <math alttext="O(nk)" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m1.1"><semantics id="S3.SS1.p1.8.m1.1a"><mrow id="S3.SS1.p1.8.m1.1.1" xref="S3.SS1.p1.8.m1.1.1.cmml"><mi id="S3.SS1.p1.8.m1.1.1.3" xref="S3.SS1.p1.8.m1.1.1.3.cmml">O</mi><mo id="S3.SS1.p1.8.m1.1.1.2" xref="S3.SS1.p1.8.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.8.m1.1.1.1.1" xref="S3.SS1.p1.8.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.8.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.8.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.8.m1.1.1.1.1.1" xref="S3.SS1.p1.8.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m1.1.1.1.1.1.2" xref="S3.SS1.p1.8.m1.1.1.1.1.1.2.cmml">n</mi><mo id="S3.SS1.p1.8.m1.1.1.1.1.1.1" xref="S3.SS1.p1.8.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p1.8.m1.1.1.1.1.1.3" xref="S3.SS1.p1.8.m1.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS1.p1.8.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.8.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m1.1b"><apply id="S3.SS1.p1.8.m1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1"><times id="S3.SS1.p1.8.m1.1.1.2.cmml" xref="S3.SS1.p1.8.m1.1.1.2"></times><ci id="S3.SS1.p1.8.m1.1.1.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3">𝑂</ci><apply id="S3.SS1.p1.8.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1.1.1"><times id="S3.SS1.p1.8.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1.1.1.1.1"></times><ci id="S3.SS1.p1.8.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m1.1.1.1.1.1.2">𝑛</ci><ci id="S3.SS1.p1.8.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.8.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m1.1c">O(nk)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m1.1d">italic_O ( italic_n italic_k )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">In practice, the feature vector encodes a row in a tabular data-set of past interactions between users and items, whose columns, often named <em class="ltx_emph ltx_font_italic" id="S3.SS1.p2.1.1">fields</em>, contain categorical features. Some columns describe the context (including the user), whereas others describe the item. Thus, <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">bold_italic_x</annotation></semantics></math> formally consists of field-wise one-hot encodings, for example:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{x}}=(\underbrace{\underbrace{0,1,0,0,0,}_{\text{field 1}}\underbrace{1,0,%
0,0,}_{\text{field 2}}\dots\underbrace{0,0,1,0,0,0,}_{\text{field $m_{c}$}}}_{%
\text{context fields}}\underbrace{\underbrace{0,0,1,0,}_{\text{field $m_{c}+1$%
}}\dots\underbrace{0,0,0,0,1}_{\text{field $m$}}}_{\text{item fields}})^{T}," class="ltx_math_unparsed" display="block" id="S3.Ex2.m1.28"><semantics id="S3.Ex2.m1.28a"><mrow id="S3.Ex2.m1.28.28.1"><mrow id="S3.Ex2.m1.28.28.1.1"><mi id="S3.Ex2.m1.28.28.1.1.3">𝒙</mi><mo id="S3.Ex2.m1.28.28.1.1.2">=</mo><msup id="S3.Ex2.m1.28.28.1.1.1"><mrow id="S3.Ex2.m1.28.28.1.1.1.1.1"><mo id="S3.Ex2.m1.28.28.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.Ex2.m1.28.28.1.1.1.1.1.1"><munder id="S3.Ex2.m1.28.28.1.1.1.1.1.1.2"><munder accentunder="true" id="S3.Ex2.m1.18.18"><mrow id="S3.Ex2.m1.18.18.16"><munder id="S3.Ex2.m1.18.18.16.18"><munder accentunder="true" id="S3.Ex2.m1.8.8.6.6"><mrow id="S3.Ex2.m1.8.8.6.6.5"><mn id="S3.Ex2.m1.4.4.2.2.1.1">0</mn><mo id="S3.Ex2.m1.8.8.6.6.5.6">,</mo><mn id="S3.Ex2.m1.5.5.3.3.2.2">1</mn><mo id="S3.Ex2.m1.8.8.6.6.5.7">,</mo><mn id="S3.Ex2.m1.6.6.4.4.3.3">0</mn><mo id="S3.Ex2.m1.8.8.6.6.5.8">,</mo><mn id="S3.Ex2.m1.7.7.5.5.4.4">0</mn><mo id="S3.Ex2.m1.8.8.6.6.5.9">,</mo><mn id="S3.Ex2.m1.8.8.6.6.5.5">0</mn><mo id="S3.Ex2.m1.8.8.6.6.5.10">,</mo></mrow><mo id="S3.Ex2.m1.8.8.6.6.6">⏟</mo></munder><mtext id="S3.Ex2.m1.18.18.16.18.2">field 1</mtext></munder><mo id="S3.Ex2.m1.18.18.16.17">⁢</mo><munder id="S3.Ex2.m1.18.18.16.19"><munder accentunder="true" id="S3.Ex2.m1.12.12.10.10"><mrow id="S3.Ex2.m1.12.12.10.10.4"><mn id="S3.Ex2.m1.9.9.7.7.1.1">1</mn><mo id="S3.Ex2.m1.12.12.10.10.4.5">,</mo><mn id="S3.Ex2.m1.10.10.8.8.2.2">0</mn><mo id="S3.Ex2.m1.12.12.10.10.4.6">,</mo><mn id="S3.Ex2.m1.11.11.9.9.3.3">0</mn><mo id="S3.Ex2.m1.12.12.10.10.4.7">,</mo><mn id="S3.Ex2.m1.12.12.10.10.4.4">0</mn><mo id="S3.Ex2.m1.12.12.10.10.4.8">,</mo></mrow><mo id="S3.Ex2.m1.12.12.10.10.5">⏟</mo></munder><mtext id="S3.Ex2.m1.18.18.16.19.2">field 2</mtext></munder><mo id="S3.Ex2.m1.18.18.16.17a">⁢</mo><mi id="S3.Ex2.m1.18.18.16.20" mathvariant="normal">…</mi><mo id="S3.Ex2.m1.18.18.16.17b">⁢</mo><munder id="S3.Ex2.m1.18.18.16.21"><munder accentunder="true" id="S3.Ex2.m1.18.18.16.16"><mrow id="S3.Ex2.m1.18.18.16.16.6"><mn id="S3.Ex2.m1.13.13.11.11.1.1">0</mn><mo id="S3.Ex2.m1.18.18.16.16.6.7">,</mo><mn id="S3.Ex2.m1.14.14.12.12.2.2">0</mn><mo id="S3.Ex2.m1.18.18.16.16.6.8">,</mo><mn id="S3.Ex2.m1.15.15.13.13.3.3">1</mn><mo id="S3.Ex2.m1.18.18.16.16.6.9">,</mo><mn id="S3.Ex2.m1.16.16.14.14.4.4">0</mn><mo id="S3.Ex2.m1.18.18.16.16.6.10">,</mo><mn id="S3.Ex2.m1.17.17.15.15.5.5">0</mn><mo id="S3.Ex2.m1.18.18.16.16.6.11">,</mo><mn id="S3.Ex2.m1.18.18.16.16.6.6">0</mn><mo id="S3.Ex2.m1.18.18.16.16.6.12">,</mo></mrow><mo id="S3.Ex2.m1.18.18.16.16.7">⏟</mo></munder><mrow id="S3.Ex2.m1.1.1.1.1.1"><mtext id="S3.Ex2.m1.1.1.1.1.1a">field </mtext><msub id="S3.Ex2.m1.1.1.1.1.1.1.1.m1.1.1"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.m1.1.1.2">m</mi><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.m1.1.1.3" mathsize="98%">c</mi></msub></mrow></munder></mrow><mo id="S3.Ex2.m1.18.18.17">⏟</mo></munder><mtext id="S3.Ex2.m1.28.28.1.1.1.1.1.1.2.2">context fields</mtext></munder><mo id="S3.Ex2.m1.28.28.1.1.1.1.1.1.1">⁢</mo><munder id="S3.Ex2.m1.28.28.1.1.1.1.1.1.3"><munder accentunder="true" id="S3.Ex2.m1.27.27"><mrow id="S3.Ex2.m1.27.27.11"><munder id="S3.Ex2.m1.27.27.11.13"><munder accentunder="true" id="S3.Ex2.m1.22.22.6.6"><mrow id="S3.Ex2.m1.22.22.6.6.4"><mn id="S3.Ex2.m1.19.19.3.3.1.1">0</mn><mo id="S3.Ex2.m1.22.22.6.6.4.5">,</mo><mn id="S3.Ex2.m1.20.20.4.4.2.2">0</mn><mo id="S3.Ex2.m1.22.22.6.6.4.6">,</mo><mn id="S3.Ex2.m1.21.21.5.5.3.3">1</mn><mo id="S3.Ex2.m1.22.22.6.6.4.7">,</mo><mn id="S3.Ex2.m1.22.22.6.6.4.4">0</mn><mo id="S3.Ex2.m1.22.22.6.6.4.8">,</mo></mrow><mo id="S3.Ex2.m1.22.22.6.6.5">⏟</mo></munder><mrow id="S3.Ex2.m1.2.2.1.1.1"><mtext id="S3.Ex2.m1.2.2.1.1.1a">field </mtext><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1.m1.1.1"><msub id="S3.Ex2.m1.2.2.1.1.1.1.1.m1.1.1.2"><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.m1.1.1.2.2">m</mi><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.m1.1.1.2.3" mathsize="98%">c</mi></msub><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.m1.1.1.1">+</mo><mn id="S3.Ex2.m1.2.2.1.1.1.1.1.m1.1.1.3">1</mn></mrow></mrow></munder><mo id="S3.Ex2.m1.27.27.11.12">⁢</mo><mi id="S3.Ex2.m1.27.27.11.14" mathvariant="normal">…</mi><mo id="S3.Ex2.m1.27.27.11.12a">⁢</mo><munder id="S3.Ex2.m1.27.27.11.15"><munder accentunder="true" id="S3.Ex2.m1.27.27.11.11"><mrow id="S3.Ex2.m1.27.27.11.11.5.7"><mn id="S3.Ex2.m1.23.23.7.7.1.1">0</mn><mo id="S3.Ex2.m1.27.27.11.11.5.7.1">,</mo><mn id="S3.Ex2.m1.24.24.8.8.2.2">0</mn><mo id="S3.Ex2.m1.27.27.11.11.5.7.2">,</mo><mn id="S3.Ex2.m1.25.25.9.9.3.3">0</mn><mo id="S3.Ex2.m1.27.27.11.11.5.7.3">,</mo><mn id="S3.Ex2.m1.26.26.10.10.4.4">0</mn><mo id="S3.Ex2.m1.27.27.11.11.5.7.4">,</mo><mn id="S3.Ex2.m1.27.27.11.11.5.5">1</mn></mrow><mo id="S3.Ex2.m1.27.27.11.11.6">⏟</mo></munder><mrow id="S3.Ex2.m1.3.3.2.2.1"><mtext id="S3.Ex2.m1.3.3.2.2.1a">field </mtext><mi id="S3.Ex2.m1.3.3.2.2.1.1.1.m1.1.1">m</mi></mrow></munder></mrow><mo id="S3.Ex2.m1.27.27.12">⏟</mo></munder><mtext id="S3.Ex2.m1.28.28.1.1.1.1.1.1.3.2">item fields</mtext></munder></mrow><mo id="S3.Ex2.m1.28.28.1.1.1.1.1.3" stretchy="false">)</mo></mrow><mi id="S3.Ex2.m1.28.28.1.1.1.3">T</mi></msup></mrow><mo id="S3.Ex2.m1.28.28.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.Ex2.m1.28b">{\bm{x}}=(\underbrace{\underbrace{0,1,0,0,0,}_{\text{field 1}}\underbrace{1,0,%
0,0,}_{\text{field 2}}\dots\underbrace{0,0,1,0,0,0,}_{\text{field $m_{c}$}}}_{%
\text{context fields}}\underbrace{\underbrace{0,0,1,0,}_{\text{field $m_{c}+1$%
}}\dots\underbrace{0,0,0,0,1}_{\text{field $m$}}}_{\text{item fields}})^{T},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.28c">bold_italic_x = ( under⏟ start_ARG under⏟ start_ARG 0 , 1 , 0 , 0 , 0 , end_ARG start_POSTSUBSCRIPT field 1 end_POSTSUBSCRIPT under⏟ start_ARG 1 , 0 , 0 , 0 , end_ARG start_POSTSUBSCRIPT field 2 end_POSTSUBSCRIPT … under⏟ start_ARG 0 , 0 , 1 , 0 , 0 , 0 , end_ARG start_POSTSUBSCRIPT field italic_m start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT context fields end_POSTSUBSCRIPT under⏟ start_ARG under⏟ start_ARG 0 , 0 , 1 , 0 , end_ARG start_POSTSUBSCRIPT field italic_m start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + 1 end_POSTSUBSCRIPT … under⏟ start_ARG 0 , 0 , 0 , 0 , 1 end_ARG start_POSTSUBSCRIPT field italic_m end_POSTSUBSCRIPT end_ARG start_POSTSUBSCRIPT item fields end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.5">Therefore, when computing <math alttext="\Phi_{\mathrm{FM}}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m1.1"><semantics id="S3.SS1.p2.2.m1.1a"><msub id="S3.SS1.p2.2.m1.1.1" xref="S3.SS1.p2.2.m1.1.1.cmml"><mi id="S3.SS1.p2.2.m1.1.1.2" mathvariant="normal" xref="S3.SS1.p2.2.m1.1.1.2.cmml">Φ</mi><mi id="S3.SS1.p2.2.m1.1.1.3" xref="S3.SS1.p2.2.m1.1.1.3.cmml">FM</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m1.1b"><apply id="S3.SS1.p2.2.m1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m1.1.1.1.cmml" xref="S3.SS1.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m1.1.1.2.cmml" xref="S3.SS1.p2.2.m1.1.1.2">Φ</ci><ci id="S3.SS1.p2.2.m1.1.1.3.cmml" xref="S3.SS1.p2.2.m1.1.1.3">FM</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m1.1c">\Phi_{\mathrm{FM}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m1.1d">roman_Φ start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT</annotation></semantics></math> we can only use the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m2.1"><semantics id="S3.SS1.p2.3.m2.1a"><mi id="S3.SS1.p2.3.m2.1.1" xref="S3.SS1.p2.3.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m2.1b"><ci id="S3.SS1.p2.3.m2.1.1.cmml" xref="S3.SS1.p2.3.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m2.1d">italic_m</annotation></semantics></math> nonzero entries of <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m3.1"><semantics id="S3.SS1.p2.4.m3.1a"><mi id="S3.SS1.p2.4.m3.1.1" xref="S3.SS1.p2.4.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m3.1b"><ci id="S3.SS1.p2.4.m3.1.1.cmml" xref="S3.SS1.p2.4.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m3.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m3.1d">bold_italic_x</annotation></semantics></math> corresponding to the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m4.1"><semantics id="S3.SS1.p2.5.m4.1a"><mi id="S3.SS1.p2.5.m4.1.1" xref="S3.SS1.p2.5.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m4.1b"><ci id="S3.SS1.p2.5.m4.1.1.cmml" xref="S3.SS1.p2.5.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m4.1d">italic_m</annotation></semantics></math> fields. We note that there may be fields having multiple values, such as a list of movie genres, but we defer their treatment to the discussion of FwFM models in the sequel.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.5">Formally, for a given feature vector <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">bold_italic_x</annotation></semantics></math>, let <math alttext="\ell_{1},\dots,\ell_{m}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.3"><semantics id="S3.SS1.p3.2.m2.3a"><mrow id="S3.SS1.p3.2.m2.3.3.2" xref="S3.SS1.p3.2.m2.3.3.3.cmml"><msub id="S3.SS1.p3.2.m2.2.2.1.1" xref="S3.SS1.p3.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.2.2.1.1.2" mathvariant="normal" xref="S3.SS1.p3.2.m2.2.2.1.1.2.cmml">ℓ</mi><mn id="S3.SS1.p3.2.m2.2.2.1.1.3" xref="S3.SS1.p3.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p3.2.m2.3.3.2.3" xref="S3.SS1.p3.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS1.p3.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p3.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p3.2.m2.3.3.2.4" xref="S3.SS1.p3.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p3.2.m2.3.3.2.2" xref="S3.SS1.p3.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p3.2.m2.3.3.2.2.2" mathvariant="normal" xref="S3.SS1.p3.2.m2.3.3.2.2.2.cmml">ℓ</mi><mi id="S3.SS1.p3.2.m2.3.3.2.2.3" xref="S3.SS1.p3.2.m2.3.3.2.2.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.3b"><list id="S3.SS1.p3.2.m2.3.3.3.cmml" xref="S3.SS1.p3.2.m2.3.3.2"><apply id="S3.SS1.p3.2.m2.2.2.1.1.cmml" xref="S3.SS1.p3.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.2.2.1.1.2">ℓ</ci><cn id="S3.SS1.p3.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p3.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">…</ci><apply id="S3.SS1.p3.2.m2.3.3.2.2.cmml" xref="S3.SS1.p3.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p3.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p3.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p3.2.m2.3.3.2.2.2">ℓ</ci><ci id="S3.SS1.p3.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p3.2.m2.3.3.2.2.3">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.3c">\ell_{1},\dots,\ell_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.3d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , roman_ℓ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> denote the nonzero indices, and define <math alttext="{\bm{v}}_{i}\equiv{\bm{w}}_{\ell_{i}}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><msub id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2.2" xref="S3.SS1.p3.3.m3.1.1.2.2.cmml">𝒗</mi><mi id="S3.SS1.p3.3.m3.1.1.2.3" xref="S3.SS1.p3.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p3.3.m3.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.cmml">≡</mo><msub id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">𝒘</mi><msub id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.3.2" mathvariant="normal" xref="S3.SS1.p3.3.m3.1.1.3.3.2.cmml">ℓ</mi><mi id="S3.SS1.p3.3.m3.1.1.3.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.3.cmml">i</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><equivalent id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1"></equivalent><apply id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.2.1.cmml" xref="S3.SS1.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2.2">𝒗</ci><ci id="S3.SS1.p3.3.m3.1.1.2.3.cmml" xref="S3.SS1.p3.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">𝒘</ci><apply id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.2">ℓ</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">{\bm{v}}_{i}\equiv{\bm{w}}_{\ell_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ≡ bold_italic_w start_POSTSUBSCRIPT roman_ℓ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. Hence, the formula in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E1" title="In 3.1. Efficiency of factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>) can be reformulated by summing over the fields, rather than the features. Moreover, we can split the summation over all fields to a summation over the context fields <math alttext="\mathcal{C}=\{1,\dots,m_{c}\}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.3"><semantics id="S3.SS1.p3.4.m4.3a"><mrow id="S3.SS1.p3.4.m4.3.3" xref="S3.SS1.p3.4.m4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.4.m4.3.3.3" xref="S3.SS1.p3.4.m4.3.3.3.cmml">𝒞</mi><mo id="S3.SS1.p3.4.m4.3.3.2" xref="S3.SS1.p3.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS1.p3.4.m4.3.3.1.1" xref="S3.SS1.p3.4.m4.3.3.1.2.cmml"><mo id="S3.SS1.p3.4.m4.3.3.1.1.2" stretchy="false" xref="S3.SS1.p3.4.m4.3.3.1.2.cmml">{</mo><mn id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">1</mn><mo id="S3.SS1.p3.4.m4.3.3.1.1.3" xref="S3.SS1.p3.4.m4.3.3.1.2.cmml">,</mo><mi id="S3.SS1.p3.4.m4.2.2" mathvariant="normal" xref="S3.SS1.p3.4.m4.2.2.cmml">…</mi><mo id="S3.SS1.p3.4.m4.3.3.1.1.4" xref="S3.SS1.p3.4.m4.3.3.1.2.cmml">,</mo><msub id="S3.SS1.p3.4.m4.3.3.1.1.1" xref="S3.SS1.p3.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS1.p3.4.m4.3.3.1.1.1.2" xref="S3.SS1.p3.4.m4.3.3.1.1.1.2.cmml">m</mi><mi id="S3.SS1.p3.4.m4.3.3.1.1.1.3" xref="S3.SS1.p3.4.m4.3.3.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS1.p3.4.m4.3.3.1.1.5" stretchy="false" xref="S3.SS1.p3.4.m4.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.3b"><apply id="S3.SS1.p3.4.m4.3.3.cmml" xref="S3.SS1.p3.4.m4.3.3"><eq id="S3.SS1.p3.4.m4.3.3.2.cmml" xref="S3.SS1.p3.4.m4.3.3.2"></eq><ci id="S3.SS1.p3.4.m4.3.3.3.cmml" xref="S3.SS1.p3.4.m4.3.3.3">𝒞</ci><set id="S3.SS1.p3.4.m4.3.3.1.2.cmml" xref="S3.SS1.p3.4.m4.3.3.1.1"><cn id="S3.SS1.p3.4.m4.1.1.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1">1</cn><ci id="S3.SS1.p3.4.m4.2.2.cmml" xref="S3.SS1.p3.4.m4.2.2">…</ci><apply id="S3.SS1.p3.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p3.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS1.p3.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS1.p3.4.m4.3.3.1.1.1.2">𝑚</ci><ci id="S3.SS1.p3.4.m4.3.3.1.1.1.3.cmml" xref="S3.SS1.p3.4.m4.3.3.1.1.1.3">𝑐</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.3c">\mathcal{C}=\{1,\dots,m_{c}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.3d">caligraphic_C = { 1 , … , italic_m start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT }</annotation></semantics></math> and the item fields <math alttext="\mathcal{I}=\{m_{c}+1,\dots,m\}" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.3"><semantics id="S3.SS1.p3.5.m5.3a"><mrow id="S3.SS1.p3.5.m5.3.3" xref="S3.SS1.p3.5.m5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.5.m5.3.3.3" xref="S3.SS1.p3.5.m5.3.3.3.cmml">ℐ</mi><mo id="S3.SS1.p3.5.m5.3.3.2" xref="S3.SS1.p3.5.m5.3.3.2.cmml">=</mo><mrow id="S3.SS1.p3.5.m5.3.3.1.1" xref="S3.SS1.p3.5.m5.3.3.1.2.cmml"><mo id="S3.SS1.p3.5.m5.3.3.1.1.2" stretchy="false" xref="S3.SS1.p3.5.m5.3.3.1.2.cmml">{</mo><mrow id="S3.SS1.p3.5.m5.3.3.1.1.1" xref="S3.SS1.p3.5.m5.3.3.1.1.1.cmml"><msub id="S3.SS1.p3.5.m5.3.3.1.1.1.2" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2.cmml"><mi id="S3.SS1.p3.5.m5.3.3.1.1.1.2.2" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2.2.cmml">m</mi><mi id="S3.SS1.p3.5.m5.3.3.1.1.1.2.3" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS1.p3.5.m5.3.3.1.1.1.1" xref="S3.SS1.p3.5.m5.3.3.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p3.5.m5.3.3.1.1.1.3" xref="S3.SS1.p3.5.m5.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p3.5.m5.3.3.1.1.3" xref="S3.SS1.p3.5.m5.3.3.1.2.cmml">,</mo><mi id="S3.SS1.p3.5.m5.1.1" mathvariant="normal" xref="S3.SS1.p3.5.m5.1.1.cmml">…</mi><mo id="S3.SS1.p3.5.m5.3.3.1.1.4" xref="S3.SS1.p3.5.m5.3.3.1.2.cmml">,</mo><mi id="S3.SS1.p3.5.m5.2.2" xref="S3.SS1.p3.5.m5.2.2.cmml">m</mi><mo id="S3.SS1.p3.5.m5.3.3.1.1.5" stretchy="false" xref="S3.SS1.p3.5.m5.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.3b"><apply id="S3.SS1.p3.5.m5.3.3.cmml" xref="S3.SS1.p3.5.m5.3.3"><eq id="S3.SS1.p3.5.m5.3.3.2.cmml" xref="S3.SS1.p3.5.m5.3.3.2"></eq><ci id="S3.SS1.p3.5.m5.3.3.3.cmml" xref="S3.SS1.p3.5.m5.3.3.3">ℐ</ci><set id="S3.SS1.p3.5.m5.3.3.1.2.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1"><apply id="S3.SS1.p3.5.m5.3.3.1.1.1.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1.1"><plus id="S3.SS1.p3.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1.1.1"></plus><apply id="S3.SS1.p3.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2.2">𝑚</ci><ci id="S3.SS1.p3.5.m5.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p3.5.m5.3.3.1.1.1.2.3">𝑐</ci></apply><cn id="S3.SS1.p3.5.m5.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.5.m5.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">…</ci><ci id="S3.SS1.p3.5.m5.2.2.cmml" xref="S3.SS1.p3.5.m5.2.2">𝑚</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.3c">\mathcal{I}=\{m_{c}+1,\dots,m\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.3d">caligraphic_I = { italic_m start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + 1 , … , italic_m }</annotation></semantics></math>, and obtain:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E2">
<tbody>
<tr class="ltx_eqn_row" id="A1.EGx1"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2.1">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2a)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\sum_{i=1}^{n}\sum_{j=i+1}^{n}" class="ltx_Math" display="inline" id="S3.E2.1.m1.1"><semantics id="S3.E2.1.m1.1a"><mrow id="S3.E2.1.m1.1.1" xref="S3.E2.1.m1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.1.m1.1.1.1" xref="S3.E2.1.m1.1.1.1.cmml"><munderover id="S3.E2.1.m1.1.1.1a" xref="S3.E2.1.m1.1.1.1.cmml"><mo id="S3.E2.1.m1.1.1.1.2.2" movablelimits="false" xref="S3.E2.1.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E2.1.m1.1.1.1.2.3" xref="S3.E2.1.m1.1.1.1.2.3.cmml"><mi id="S3.E2.1.m1.1.1.1.2.3.2" xref="S3.E2.1.m1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E2.1.m1.1.1.1.2.3.1" xref="S3.E2.1.m1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E2.1.m1.1.1.1.2.3.3" xref="S3.E2.1.m1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.1.m1.1.1.1.3" xref="S3.E2.1.m1.1.1.1.3.cmml">n</mi></munderover></mstyle><mstyle displaystyle="true" id="S3.E2.1.m1.1.1.2" xref="S3.E2.1.m1.1.1.2.cmml"><munderover id="S3.E2.1.m1.1.1.2a" xref="S3.E2.1.m1.1.1.2.cmml"><mo id="S3.E2.1.m1.1.1.2.2.2" movablelimits="false" xref="S3.E2.1.m1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.1.m1.1.1.2.2.3" xref="S3.E2.1.m1.1.1.2.2.3.cmml"><mi id="S3.E2.1.m1.1.1.2.2.3.2" xref="S3.E2.1.m1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E2.1.m1.1.1.2.2.3.1" xref="S3.E2.1.m1.1.1.2.2.3.1.cmml">=</mo><mrow id="S3.E2.1.m1.1.1.2.2.3.3" xref="S3.E2.1.m1.1.1.2.2.3.3.cmml"><mi id="S3.E2.1.m1.1.1.2.2.3.3.2" xref="S3.E2.1.m1.1.1.2.2.3.3.2.cmml">i</mi><mo id="S3.E2.1.m1.1.1.2.2.3.3.1" xref="S3.E2.1.m1.1.1.2.2.3.3.1.cmml">+</mo><mn id="S3.E2.1.m1.1.1.2.2.3.3.3" xref="S3.E2.1.m1.1.1.2.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E2.1.m1.1.1.2.3" xref="S3.E2.1.m1.1.1.2.3.cmml">n</mi></munderover></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.1.m1.1b"><apply id="S3.E2.1.m1.1.1.cmml" xref="S3.E2.1.m1.1.1"><apply id="S3.E2.1.m1.1.1.1.cmml" xref="S3.E2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.1.m1.1.1.1.1.cmml" xref="S3.E2.1.m1.1.1.1">superscript</csymbol><apply id="S3.E2.1.m1.1.1.1.2.cmml" xref="S3.E2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.1.m1.1.1.1.2.1.cmml" xref="S3.E2.1.m1.1.1.1">subscript</csymbol><sum id="S3.E2.1.m1.1.1.1.2.2.cmml" xref="S3.E2.1.m1.1.1.1.2.2"></sum><apply id="S3.E2.1.m1.1.1.1.2.3.cmml" xref="S3.E2.1.m1.1.1.1.2.3"><eq id="S3.E2.1.m1.1.1.1.2.3.1.cmml" xref="S3.E2.1.m1.1.1.1.2.3.1"></eq><ci id="S3.E2.1.m1.1.1.1.2.3.2.cmml" xref="S3.E2.1.m1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E2.1.m1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E2.1.m1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.1.m1.1.1.1.3.cmml" xref="S3.E2.1.m1.1.1.1.3">𝑛</ci></apply><apply id="S3.E2.1.m1.1.1.2.cmml" xref="S3.E2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.1.m1.1.1.2.1.cmml" xref="S3.E2.1.m1.1.1.2">superscript</csymbol><apply id="S3.E2.1.m1.1.1.2.2.cmml" xref="S3.E2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.1.m1.1.1.2.2.1.cmml" xref="S3.E2.1.m1.1.1.2">subscript</csymbol><sum id="S3.E2.1.m1.1.1.2.2.2.cmml" xref="S3.E2.1.m1.1.1.2.2.2"></sum><apply id="S3.E2.1.m1.1.1.2.2.3.cmml" xref="S3.E2.1.m1.1.1.2.2.3"><eq id="S3.E2.1.m1.1.1.2.2.3.1.cmml" xref="S3.E2.1.m1.1.1.2.2.3.1"></eq><ci id="S3.E2.1.m1.1.1.2.2.3.2.cmml" xref="S3.E2.1.m1.1.1.2.2.3.2">𝑗</ci><apply id="S3.E2.1.m1.1.1.2.2.3.3.cmml" xref="S3.E2.1.m1.1.1.2.2.3.3"><plus id="S3.E2.1.m1.1.1.2.2.3.3.1.cmml" xref="S3.E2.1.m1.1.1.2.2.3.3.1"></plus><ci id="S3.E2.1.m1.1.1.2.2.3.3.2.cmml" xref="S3.E2.1.m1.1.1.2.2.3.3.2">𝑖</ci><cn id="S3.E2.1.m1.1.1.2.2.3.3.3.cmml" type="integer" xref="S3.E2.1.m1.1.1.2.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.E2.1.m1.1.1.2.3.cmml" xref="S3.E2.1.m1.1.1.2.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.1.m1.1c">\displaystyle\sum_{i=1}^{n}\sum_{j=i+1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.1.m1.1d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\langle x_{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}\rangle" class="ltx_Math" display="inline" id="S3.E2.1.m2.2"><semantics id="S3.E2.1.m2.2a"><mrow id="S3.E2.1.m2.2.2.2" xref="S3.E2.1.m2.2.2.3.cmml"><mo id="S3.E2.1.m2.2.2.2.3" stretchy="false" xref="S3.E2.1.m2.2.2.3.cmml">⟨</mo><mrow id="S3.E2.1.m2.1.1.1.1" xref="S3.E2.1.m2.1.1.1.1.cmml"><msub id="S3.E2.1.m2.1.1.1.1.2" xref="S3.E2.1.m2.1.1.1.1.2.cmml"><mi id="S3.E2.1.m2.1.1.1.1.2.2" xref="S3.E2.1.m2.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.1.m2.1.1.1.1.2.3" xref="S3.E2.1.m2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E2.1.m2.1.1.1.1.1" xref="S3.E2.1.m2.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E2.1.m2.1.1.1.1.3" xref="S3.E2.1.m2.1.1.1.1.3.cmml"><mi id="S3.E2.1.m2.1.1.1.1.3.2" xref="S3.E2.1.m2.1.1.1.1.3.2.cmml">𝒘</mi><mi id="S3.E2.1.m2.1.1.1.1.3.3" xref="S3.E2.1.m2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E2.1.m2.2.2.2.4" xref="S3.E2.1.m2.2.2.3.cmml">,</mo><mrow id="S3.E2.1.m2.2.2.2.2" xref="S3.E2.1.m2.2.2.2.2.cmml"><msub id="S3.E2.1.m2.2.2.2.2.2" xref="S3.E2.1.m2.2.2.2.2.2.cmml"><mi id="S3.E2.1.m2.2.2.2.2.2.2" xref="S3.E2.1.m2.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E2.1.m2.2.2.2.2.2.3" xref="S3.E2.1.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E2.1.m2.2.2.2.2.1" xref="S3.E2.1.m2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.E2.1.m2.2.2.2.2.3" xref="S3.E2.1.m2.2.2.2.2.3.cmml"><mi id="S3.E2.1.m2.2.2.2.2.3.2" xref="S3.E2.1.m2.2.2.2.2.3.2.cmml">𝒘</mi><mi id="S3.E2.1.m2.2.2.2.2.3.3" xref="S3.E2.1.m2.2.2.2.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E2.1.m2.2.2.2.5" stretchy="false" xref="S3.E2.1.m2.2.2.3.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.1.m2.2b"><list id="S3.E2.1.m2.2.2.3.cmml" xref="S3.E2.1.m2.2.2.2"><apply id="S3.E2.1.m2.1.1.1.1.cmml" xref="S3.E2.1.m2.1.1.1.1"><times id="S3.E2.1.m2.1.1.1.1.1.cmml" xref="S3.E2.1.m2.1.1.1.1.1"></times><apply id="S3.E2.1.m2.1.1.1.1.2.cmml" xref="S3.E2.1.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.1.m2.1.1.1.1.2.1.cmml" xref="S3.E2.1.m2.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.1.m2.1.1.1.1.2.2.cmml" xref="S3.E2.1.m2.1.1.1.1.2.2">𝑥</ci><ci id="S3.E2.1.m2.1.1.1.1.2.3.cmml" xref="S3.E2.1.m2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.1.m2.1.1.1.1.3.cmml" xref="S3.E2.1.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.1.m2.1.1.1.1.3.1.cmml" xref="S3.E2.1.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.1.m2.1.1.1.1.3.2.cmml" xref="S3.E2.1.m2.1.1.1.1.3.2">𝒘</ci><ci id="S3.E2.1.m2.1.1.1.1.3.3.cmml" xref="S3.E2.1.m2.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E2.1.m2.2.2.2.2.cmml" xref="S3.E2.1.m2.2.2.2.2"><times id="S3.E2.1.m2.2.2.2.2.1.cmml" xref="S3.E2.1.m2.2.2.2.2.1"></times><apply id="S3.E2.1.m2.2.2.2.2.2.cmml" xref="S3.E2.1.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.1.m2.2.2.2.2.2.1.cmml" xref="S3.E2.1.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.1.m2.2.2.2.2.2.2.cmml" xref="S3.E2.1.m2.2.2.2.2.2.2">𝑥</ci><ci id="S3.E2.1.m2.2.2.2.2.2.3.cmml" xref="S3.E2.1.m2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.E2.1.m2.2.2.2.2.3.cmml" xref="S3.E2.1.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.1.m2.2.2.2.2.3.1.cmml" xref="S3.E2.1.m2.2.2.2.2.3">subscript</csymbol><ci id="S3.E2.1.m2.2.2.2.2.3.2.cmml" xref="S3.E2.1.m2.2.2.2.2.3.2">𝒘</ci><ci id="S3.E2.1.m2.2.2.2.2.3.3.cmml" xref="S3.E2.1.m2.2.2.2.2.3.3">𝑗</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.1.m2.2c">\displaystyle\langle x_{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.E2.1.m2.2d">⟨ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2.2">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2b)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{m}\sum_{j=i+1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle" class="ltx_Math" display="inline" id="S3.E2.2.m1.2"><semantics id="S3.E2.2.m1.2a"><mrow id="S3.E2.2.m1.2.2" xref="S3.E2.2.m1.2.2.cmml"><mi id="S3.E2.2.m1.2.2.4" xref="S3.E2.2.m1.2.2.4.cmml"></mi><mo id="S3.E2.2.m1.2.2.3" xref="S3.E2.2.m1.2.2.3.cmml">=</mo><mrow id="S3.E2.2.m1.2.2.2" xref="S3.E2.2.m1.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E2.2.m1.2.2.2.3" xref="S3.E2.2.m1.2.2.2.3.cmml"><munderover id="S3.E2.2.m1.2.2.2.3a" xref="S3.E2.2.m1.2.2.2.3.cmml"><mo id="S3.E2.2.m1.2.2.2.3.2.2" movablelimits="false" xref="S3.E2.2.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.2.m1.2.2.2.3.2.3" xref="S3.E2.2.m1.2.2.2.3.2.3.cmml"><mi id="S3.E2.2.m1.2.2.2.3.2.3.2" xref="S3.E2.2.m1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E2.2.m1.2.2.2.3.2.3.1" xref="S3.E2.2.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E2.2.m1.2.2.2.3.2.3.3" xref="S3.E2.2.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.2.m1.2.2.2.3.3" xref="S3.E2.2.m1.2.2.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S3.E2.2.m1.2.2.2.2" xref="S3.E2.2.m1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S3.E2.2.m1.2.2.2.2.3" xref="S3.E2.2.m1.2.2.2.2.3.cmml"><munderover id="S3.E2.2.m1.2.2.2.2.3a" xref="S3.E2.2.m1.2.2.2.2.3.cmml"><mo id="S3.E2.2.m1.2.2.2.2.3.2.2" movablelimits="false" xref="S3.E2.2.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.2.m1.2.2.2.2.3.2.3" xref="S3.E2.2.m1.2.2.2.2.3.2.3.cmml"><mi id="S3.E2.2.m1.2.2.2.2.3.2.3.2" xref="S3.E2.2.m1.2.2.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E2.2.m1.2.2.2.2.3.2.3.1" xref="S3.E2.2.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mrow id="S3.E2.2.m1.2.2.2.2.3.2.3.3" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.cmml"><mi id="S3.E2.2.m1.2.2.2.2.3.2.3.3.2" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.2.cmml">i</mi><mo id="S3.E2.2.m1.2.2.2.2.3.2.3.3.1" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.1.cmml">+</mo><mn id="S3.E2.2.m1.2.2.2.2.3.2.3.3.3" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E2.2.m1.2.2.2.2.3.3" xref="S3.E2.2.m1.2.2.2.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S3.E2.2.m1.2.2.2.2.2.2" xref="S3.E2.2.m1.2.2.2.2.2.3.cmml"><mo id="S3.E2.2.m1.2.2.2.2.2.2.3" stretchy="false" xref="S3.E2.2.m1.2.2.2.2.2.3.cmml">⟨</mo><msub id="S3.E2.2.m1.1.1.1.1.1.1.1" xref="S3.E2.2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.2.m1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.E2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.2.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.2.m1.2.2.2.2.2.2.4" xref="S3.E2.2.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E2.2.m1.2.2.2.2.2.2.2" xref="S3.E2.2.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E2.2.m1.2.2.2.2.2.2.2.2" xref="S3.E2.2.m1.2.2.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S3.E2.2.m1.2.2.2.2.2.2.2.3" xref="S3.E2.2.m1.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E2.2.m1.2.2.2.2.2.2.5" stretchy="false" xref="S3.E2.2.m1.2.2.2.2.2.3.cmml">⟩</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.2.m1.2b"><apply id="S3.E2.2.m1.2.2.cmml" xref="S3.E2.2.m1.2.2"><eq id="S3.E2.2.m1.2.2.3.cmml" xref="S3.E2.2.m1.2.2.3"></eq><csymbol cd="latexml" id="S3.E2.2.m1.2.2.4.cmml" xref="S3.E2.2.m1.2.2.4">absent</csymbol><apply id="S3.E2.2.m1.2.2.2.cmml" xref="S3.E2.2.m1.2.2.2"><apply id="S3.E2.2.m1.2.2.2.3.cmml" xref="S3.E2.2.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.2.m1.2.2.2.3.1.cmml" xref="S3.E2.2.m1.2.2.2.3">superscript</csymbol><apply id="S3.E2.2.m1.2.2.2.3.2.cmml" xref="S3.E2.2.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.2.m1.2.2.2.3.2.1.cmml" xref="S3.E2.2.m1.2.2.2.3">subscript</csymbol><sum id="S3.E2.2.m1.2.2.2.3.2.2.cmml" xref="S3.E2.2.m1.2.2.2.3.2.2"></sum><apply id="S3.E2.2.m1.2.2.2.3.2.3.cmml" xref="S3.E2.2.m1.2.2.2.3.2.3"><eq id="S3.E2.2.m1.2.2.2.3.2.3.1.cmml" xref="S3.E2.2.m1.2.2.2.3.2.3.1"></eq><ci id="S3.E2.2.m1.2.2.2.3.2.3.2.cmml" xref="S3.E2.2.m1.2.2.2.3.2.3.2">𝑖</ci><cn id="S3.E2.2.m1.2.2.2.3.2.3.3.cmml" type="integer" xref="S3.E2.2.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2.2.m1.2.2.2.3.3.cmml" xref="S3.E2.2.m1.2.2.2.3.3">𝑚</ci></apply><apply id="S3.E2.2.m1.2.2.2.2.cmml" xref="S3.E2.2.m1.2.2.2.2"><apply id="S3.E2.2.m1.2.2.2.2.3.cmml" xref="S3.E2.2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.2.m1.2.2.2.2.3.1.cmml" xref="S3.E2.2.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.E2.2.m1.2.2.2.2.3.2.cmml" xref="S3.E2.2.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.2.m1.2.2.2.2.3.2.1.cmml" xref="S3.E2.2.m1.2.2.2.2.3">subscript</csymbol><sum id="S3.E2.2.m1.2.2.2.2.3.2.2.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.2"></sum><apply id="S3.E2.2.m1.2.2.2.2.3.2.3.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.3"><eq id="S3.E2.2.m1.2.2.2.2.3.2.3.1.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.3.1"></eq><ci id="S3.E2.2.m1.2.2.2.2.3.2.3.2.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.3.2">𝑗</ci><apply id="S3.E2.2.m1.2.2.2.2.3.2.3.3.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3"><plus id="S3.E2.2.m1.2.2.2.2.3.2.3.3.1.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.1"></plus><ci id="S3.E2.2.m1.2.2.2.2.3.2.3.3.2.cmml" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.2">𝑖</ci><cn id="S3.E2.2.m1.2.2.2.2.3.2.3.3.3.cmml" type="integer" xref="S3.E2.2.m1.2.2.2.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.E2.2.m1.2.2.2.2.3.3.cmml" xref="S3.E2.2.m1.2.2.2.2.3.3">𝑚</ci></apply><list id="S3.E2.2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.2.m1.2.2.2.2.2.2"><apply id="S3.E2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.2.m1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S3.E2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.2.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E2.2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.2.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.2.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.2.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.2.m1.2.2.2.2.2.2.2.2">𝒗</ci><ci id="S3.E2.2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.2.m1.2.2.2.2.2.2.2.3">𝑗</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.2.m1.2c">\displaystyle=\sum_{i=1}^{m}\sum_{j=i+1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle</annotation><annotation encoding="application/x-llamapun" id="S3.E2.2.m1.2d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2.3">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2c)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{2}\left(\Bigl{\|}\sum_{i=1}^{m}{\bm{v}}_{i}\Bigr{\|}^{2%
}-\sum_{i=1}^{m}\Bigl{\|}{\bm{v}}_{i}\Bigr{\|}^{2}\right)" class="ltx_Math" display="inline" id="S3.E2.3.m1.1"><semantics id="S3.E2.3.m1.1a"><mrow id="S3.E2.3.m1.1.1" xref="S3.E2.3.m1.1.1.cmml"><mi id="S3.E2.3.m1.1.1.3" xref="S3.E2.3.m1.1.1.3.cmml"></mi><mo id="S3.E2.3.m1.1.1.2" xref="S3.E2.3.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.3.m1.1.1.1" xref="S3.E2.3.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.3.m1.1.1.1.3" xref="S3.E2.3.m1.1.1.1.3.cmml"><mfrac id="S3.E2.3.m1.1.1.1.3a" xref="S3.E2.3.m1.1.1.1.3.cmml"><mn id="S3.E2.3.m1.1.1.1.3.2" xref="S3.E2.3.m1.1.1.1.3.2.cmml">1</mn><mn id="S3.E2.3.m1.1.1.1.3.3" xref="S3.E2.3.m1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo id="S3.E2.3.m1.1.1.1.2" xref="S3.E2.3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.3.m1.1.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.cmml"><mo id="S3.E2.3.m1.1.1.1.1.1.2" xref="S3.E2.3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.3.m1.1.1.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.cmml"><msup id="S3.E2.3.m1.1.1.1.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.2.cmml"><mo fence="true" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" movablelimits="false" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></munderover></mstyle><msub id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒗</mi><mi id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub></mrow><mo fence="true" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E2.3.m1.1.1.1.1.1.1.1.3" xref="S3.E2.3.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E2.3.m1.1.1.1.1.1.1.3" xref="S3.E2.3.m1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E2.3.m1.1.1.1.1.1.1.2" xref="S3.E2.3.m1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E2.3.m1.1.1.1.1.1.1.2.2" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.cmml"><munderover id="S3.E2.3.m1.1.1.1.1.1.1.2.2a" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.cmml"><mo id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.2" movablelimits="false" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.2" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.1" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.3.m1.1.1.1.1.1.1.2.2.3" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.3.cmml">m</mi></munderover></mstyle><msup id="S3.E2.3.m1.1.1.1.1.1.1.2.1" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.cmml"><mrow id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.2.cmml"><mo fence="true" id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.2.1.cmml">∥</mo><msub id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E2.3.m1.1.1.1.1.1.1.2.1.3" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E2.3.m1.1.1.1.1.1.3" xref="S3.E2.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.3.m1.1b"><apply id="S3.E2.3.m1.1.1.cmml" xref="S3.E2.3.m1.1.1"><eq id="S3.E2.3.m1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E2.3.m1.1.1.3.cmml" xref="S3.E2.3.m1.1.1.3">absent</csymbol><apply id="S3.E2.3.m1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1"><times id="S3.E2.3.m1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.2"></times><apply id="S3.E2.3.m1.1.1.1.3.cmml" xref="S3.E2.3.m1.1.1.1.3"><divide id="S3.E2.3.m1.1.1.1.3.1.cmml" xref="S3.E2.3.m1.1.1.1.3"></divide><cn id="S3.E2.3.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E2.3.m1.1.1.1.3.2">1</cn><cn id="S3.E2.3.m1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.3.m1.1.1.1.3.3">2</cn></apply><apply id="S3.E2.3.m1.1.1.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1"><minus id="S3.E2.3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.3"></minus><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><eq id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝒗</ci><ci id="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply></apply></apply><cn id="S3.E2.3.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.3.m1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2"><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.2"></sum><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3"><eq id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.1"></eq><ci id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><cn id="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.2.3">𝑚</ci></apply><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.2">𝒗</ci><ci id="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E2.3.m1.1.1.1.1.1.1.2.1.3.cmml" type="integer" xref="S3.E2.3.m1.1.1.1.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.3.m1.1c">\displaystyle=\frac{1}{2}\left(\Bigl{\|}\sum_{i=1}^{m}{\bm{v}}_{i}\Bigr{\|}^{2%
}-\sum_{i=1}^{m}\Bigl{\|}{\bm{v}}_{i}\Bigr{\|}^{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.3.m1.1d">= divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( ∥ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2.4">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2d)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{2}\left(\Bigl{\|}\sum_{i\in\mathcal{C}}{\bm{v}}_{i}+%
\sum_{i\in\mathcal{I}}{\bm{v}}_{i}\Bigr{\|}^{2}-\sum_{i\in\mathcal{C}}\Bigl{\|%
}{\bm{v}}_{i}\Bigr{\|}^{2}-\sum_{i\in\mathcal{I}}\Bigl{\|}{\bm{v}}_{i}\Bigr{\|%
}^{2}\right)" class="ltx_Math" display="inline" id="S3.E2.4.m1.1"><semantics id="S3.E2.4.m1.1a"><mrow id="S3.E2.4.m1.1.1" xref="S3.E2.4.m1.1.1.cmml"><mi id="S3.E2.4.m1.1.1.3" xref="S3.E2.4.m1.1.1.3.cmml"></mi><mo id="S3.E2.4.m1.1.1.2" xref="S3.E2.4.m1.1.1.2.cmml">=</mo><mrow id="S3.E2.4.m1.1.1.1" xref="S3.E2.4.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2.4.m1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.3.cmml"><mfrac id="S3.E2.4.m1.1.1.1.3a" xref="S3.E2.4.m1.1.1.1.3.cmml"><mn id="S3.E2.4.m1.1.1.1.3.2" xref="S3.E2.4.m1.1.1.1.3.2.cmml">1</mn><mn id="S3.E2.4.m1.1.1.1.3.3" xref="S3.E2.4.m1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo id="S3.E2.4.m1.1.1.1.2" xref="S3.E2.4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.4.m1.1.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.cmml"><mo id="S3.E2.4.m1.1.1.1.1.1.2" xref="S3.E2.4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.cmml"><msup id="S3.E2.4.m1.1.1.1.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.2.cmml"><mo fence="true" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"><munder id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1a" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.2" movablelimits="false" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.2.cmml">i</mi><mo id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.3.cmml">𝒞</mi></mrow></munder></mstyle><msub id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒗</mi><mi id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub></mrow><mo id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><munder id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.2" movablelimits="false" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2.cmml">i</mi><mo id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3.cmml">ℐ</mi></mrow></munder></mstyle><msub id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒗</mi><mi id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><mo fence="true" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E2.4.m1.1.1.1.1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.E2.4.m1.1.1.1.1.1.1.4" xref="S3.E2.4.m1.1.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.2" xref="S3.E2.4.m1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E2.4.m1.1.1.1.1.1.1.2.2" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.cmml"><munder id="S3.E2.4.m1.1.1.1.1.1.1.2.2a" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.cmml"><mo id="S3.E2.4.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.3.cmml">𝒞</mi></mrow></munder></mstyle><msup id="S3.E2.4.m1.1.1.1.1.1.1.2.1" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.cmml"><mrow id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.2.cmml"><mo fence="true" id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.2.1.cmml">∥</mo><msub id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E2.4.m1.1.1.1.1.1.1.2.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.3.cmml">2</mn></msup></mrow><mo id="S3.E2.4.m1.1.1.1.1.1.1.4a" xref="S3.E2.4.m1.1.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E2.4.m1.1.1.1.1.1.1.3.2" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.cmml"><munder id="S3.E2.4.m1.1.1.1.1.1.1.3.2a" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.cmml"><mo id="S3.E2.4.m1.1.1.1.1.1.1.3.2.2" movablelimits="false" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.2.cmml">∑</mo><mrow id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.2.cmml">i</mi><mo id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.1" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.3.cmml">ℐ</mi></mrow></munder></mstyle><msup id="S3.E2.4.m1.1.1.1.1.1.1.3.1" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.cmml"><mrow id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.2.cmml"><mo fence="true" id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.2" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.2.1.cmml">∥</mo><msub id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.cmml"><mi id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.2" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.3.cmml">i</mi></msub><mo fence="true" id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.3" lspace="0em" mathsize="160%" rspace="0em" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.2.1.cmml">∥</mo></mrow><mn id="S3.E2.4.m1.1.1.1.1.1.1.3.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S3.E2.4.m1.1.1.1.1.1.3" xref="S3.E2.4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.4.m1.1b"><apply id="S3.E2.4.m1.1.1.cmml" xref="S3.E2.4.m1.1.1"><eq id="S3.E2.4.m1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E2.4.m1.1.1.3.cmml" xref="S3.E2.4.m1.1.1.3">absent</csymbol><apply id="S3.E2.4.m1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1"><times id="S3.E2.4.m1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.2"></times><apply id="S3.E2.4.m1.1.1.1.3.cmml" xref="S3.E2.4.m1.1.1.1.3"><divide id="S3.E2.4.m1.1.1.1.3.1.cmml" xref="S3.E2.4.m1.1.1.1.3"></divide><cn id="S3.E2.4.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E2.4.m1.1.1.1.3.2">1</cn><cn id="S3.E2.4.m1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.4.m1.1.1.1.3.3">2</cn></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1"><minus id="S3.E2.4.m1.1.1.1.1.1.1.4.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.4"></minus><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1"><plus id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2"><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1">subscript</csymbol><sum id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.2"></sum><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3"><in id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.1"></in><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.2">𝑖</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.1.3.3">𝒞</ci></apply></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝒗</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3"><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.2"></sum><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3"><in id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.1"></in><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.2">𝑖</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.1.3.3">ℐ</ci></apply></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.2">𝒗</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply></apply></apply></apply><cn id="S3.E2.4.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.4.m1.1.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2"><apply id="S3.E2.4.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="S3.E2.4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3"><in id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.1"></in><ci id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.2.3.3">𝒞</ci></apply></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.2">𝒗</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E2.4.m1.1.1.1.1.1.1.2.1.3.cmml" type="integer" xref="S3.E2.4.m1.1.1.1.1.1.1.2.1.3">2</cn></apply></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3"><apply id="S3.E2.4.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2">subscript</csymbol><sum id="S3.E2.4.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.2"></sum><apply id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3"><in id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.1"></in><ci id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.2.3.3">ℐ</ci></apply></apply><apply id="S3.E2.4.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="latexml" id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.2.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.2">delimited-∥∥</csymbol><apply id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.1.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1">subscript</csymbol><ci id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.2.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.2">𝒗</ci><ci id="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.3.cmml" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S3.E2.4.m1.1.1.1.1.1.1.3.1.3.cmml" type="integer" xref="S3.E2.4.m1.1.1.1.1.1.1.3.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.4.m1.1c">\displaystyle=\frac{1}{2}\left(\Bigl{\|}\sum_{i\in\mathcal{C}}{\bm{v}}_{i}+%
\sum_{i\in\mathcal{I}}{\bm{v}}_{i}\Bigr{\|}^{2}-\sum_{i\in\mathcal{C}}\Bigl{\|%
}{\bm{v}}_{i}\Bigr{\|}^{2}-\sum_{i\in\mathcal{I}}\Bigl{\|}{\bm{v}}_{i}\Bigr{\|%
}^{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.4.m1.1d">= divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( ∥ ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_C end_POSTSUBSCRIPT bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_I end_POSTSUBSCRIPT bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_C end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT - ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_I end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS1.p3.7">By Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E2.4" title="In 2 ‣ 3.1. Efficiency of factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">2d</span></a>), we see that when ranking a large number of items for a given context, the sums over <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m1.1"><semantics id="S3.SS1.p3.6.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.6.m1.1.1" xref="S3.SS1.p3.6.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m1.1b"><ci id="S3.SS1.p3.6.m1.1.1.cmml" xref="S3.SS1.p3.6.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m1.1d">caligraphic_C</annotation></semantics></math> can be computed only <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.7.1">once</em>. For each item, the computational complexity is <math alttext="O(|\mathcal{I}|k)" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m2.2"><semantics id="S3.SS1.p3.7.m2.2a"><mrow id="S3.SS1.p3.7.m2.2.2" xref="S3.SS1.p3.7.m2.2.2.cmml"><mi id="S3.SS1.p3.7.m2.2.2.3" xref="S3.SS1.p3.7.m2.2.2.3.cmml">O</mi><mo id="S3.SS1.p3.7.m2.2.2.2" xref="S3.SS1.p3.7.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS1.p3.7.m2.2.2.1.1" xref="S3.SS1.p3.7.m2.2.2.1.1.1.cmml"><mo id="S3.SS1.p3.7.m2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p3.7.m2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p3.7.m2.2.2.1.1.1" xref="S3.SS1.p3.7.m2.2.2.1.1.1.cmml"><mrow id="S3.SS1.p3.7.m2.2.2.1.1.1.2.2" xref="S3.SS1.p3.7.m2.2.2.1.1.1.2.1.cmml"><mo id="S3.SS1.p3.7.m2.2.2.1.1.1.2.2.1" stretchy="false" xref="S3.SS1.p3.7.m2.2.2.1.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.7.m2.1.1" xref="S3.SS1.p3.7.m2.1.1.cmml">ℐ</mi><mo id="S3.SS1.p3.7.m2.2.2.1.1.1.2.2.2" stretchy="false" xref="S3.SS1.p3.7.m2.2.2.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS1.p3.7.m2.2.2.1.1.1.1" xref="S3.SS1.p3.7.m2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.SS1.p3.7.m2.2.2.1.1.1.3" xref="S3.SS1.p3.7.m2.2.2.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS1.p3.7.m2.2.2.1.1.3" stretchy="false" xref="S3.SS1.p3.7.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m2.2b"><apply id="S3.SS1.p3.7.m2.2.2.cmml" xref="S3.SS1.p3.7.m2.2.2"><times id="S3.SS1.p3.7.m2.2.2.2.cmml" xref="S3.SS1.p3.7.m2.2.2.2"></times><ci id="S3.SS1.p3.7.m2.2.2.3.cmml" xref="S3.SS1.p3.7.m2.2.2.3">𝑂</ci><apply id="S3.SS1.p3.7.m2.2.2.1.1.1.cmml" xref="S3.SS1.p3.7.m2.2.2.1.1"><times id="S3.SS1.p3.7.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p3.7.m2.2.2.1.1.1.1"></times><apply id="S3.SS1.p3.7.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p3.7.m2.2.2.1.1.1.2.2"><abs id="S3.SS1.p3.7.m2.2.2.1.1.1.2.1.1.cmml" xref="S3.SS1.p3.7.m2.2.2.1.1.1.2.2.1"></abs><ci id="S3.SS1.p3.7.m2.1.1.cmml" xref="S3.SS1.p3.7.m2.1.1">ℐ</ci></apply><ci id="S3.SS1.p3.7.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p3.7.m2.2.2.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m2.2c">O(|\mathcal{I}|k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m2.2d">italic_O ( | caligraphic_I | italic_k )</annotation></semantics></math>, namely, and it depends largely on the number of <em class="ltx_emph ltx_font_italic" id="S3.SS1.p3.7.2">item fields</em>. Thus, in practice, we can use a model with a large number of user or context features to achieve a high degree of personalization, without incurring a significant computational cost during item ranking.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Inefficiency of field-weighted factorization machines</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.4">Field-weighted factorization machines (FwFM) <cite class="ltx_cite ltx_citemacro_citep">(Pan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite> model the varying behavior of a feature belonging to some field when interacting with features from different fields in the form of a trainable symmetric field interaction matrix <math alttext="{\bm{R}}\in\mathbb{R}^{m\times m}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝑹</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.3.2" xref="S3.SS2.p1.1.m1.1.1.3.3.2.cmml">m</mi><mo id="S3.SS2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><in id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></in><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑹</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3"><times id="S3.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.2">𝑚</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{\bm{R}}\in\mathbb{R}^{m\times m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">bold_italic_R ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>. Its components <math alttext="{R}_{i,j}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.2"><semantics id="S3.SS2.p1.2.m2.2a"><msub id="S3.SS2.p1.2.m2.2.3" xref="S3.SS2.p1.2.m2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.2.3.2" xref="S3.SS2.p1.2.m2.2.3.2.cmml">R</mi><mrow id="S3.SS2.p1.2.m2.2.2.2.4" xref="S3.SS2.p1.2.m2.2.2.2.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS2.p1.2.m2.2.2.2.4.1" xref="S3.SS2.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.2.m2.2.2.2.2" xref="S3.SS2.p1.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.3.2">𝑅</ci><list id="S3.SS2.p1.2.m2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.2.4"><ci id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS2.p1.2.m2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">{R}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.2d">italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> model the <em class="ltx_emph ltx_font_italic" id="S3.SS2.p1.4.1">intensity</em> of the interaction between field <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_i</annotation></semantics></math> and field <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_j</annotation></semantics></math>. The model’s output is</p>
<table class="ltx_equation ltx_eqn_table" id="S3.SS2.p1.5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Phi_{\mathrm{FwFM}}({\bm{x}};b_{0},{\bm{b}},{\bm{w}}_{1},\dots,{\bm{w}}_{n},{%
\bm{R}})=\\
b_{0}+\langle{\bm{b}},{\bm{x}}\rangle+\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_%
{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}\rangle{R}_{f_{i},f_{j}}," class="ltx_Math" display="block" id="S3.SS2.p1.5.m1.55"><semantics id="S3.SS2.p1.5.m1.55a"><mtable displaystyle="true" id="S3.SS2.p1.5.m1.55.55.5" rowspacing="0pt"><mtr id="S3.SS2.p1.5.m1.55.55.5a"><mtd class="ltx_align_left" columnalign="left" id="S3.SS2.p1.5.m1.55.55.5b"><mrow id="S3.SS2.p1.5.m1.54.54.4.53.24.24"><mrow id="S3.SS2.p1.5.m1.54.54.4.53.24.24.24"><msub id="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.5"><mi id="S3.SS2.p1.5.m1.1.1.1.1.1.1" mathvariant="normal" xref="S3.SS2.p1.5.m1.1.1.1.1.1.1.cmml">Φ</mi><mi id="S3.SS2.p1.5.m1.2.2.2.2.2.2.1" xref="S3.SS2.p1.5.m1.2.2.2.2.2.2.1.cmml">FwFM</mi></msub><mo id="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.3.3"><mo id="S3.SS2.p1.5.m1.3.3.3.3.3.3" stretchy="false" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">(</mo><mi id="S3.SS2.p1.5.m1.4.4.4.4.4.4" xref="S3.SS2.p1.5.m1.4.4.4.4.4.4.cmml">𝒙</mi><mo id="S3.SS2.p1.5.m1.5.5.5.5.5.5" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">;</mo><msub id="S3.SS2.p1.5.m1.52.52.2.51.22.22.22.1.1.1"><mi id="S3.SS2.p1.5.m1.6.6.6.6.6.6" xref="S3.SS2.p1.5.m1.6.6.6.6.6.6.cmml">b</mi><mn id="S3.SS2.p1.5.m1.7.7.7.7.7.7.1" xref="S3.SS2.p1.5.m1.7.7.7.7.7.7.1.cmml">0</mn></msub><mo id="S3.SS2.p1.5.m1.8.8.8.8.8.8" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.SS2.p1.5.m1.9.9.9.9.9.9" xref="S3.SS2.p1.5.m1.9.9.9.9.9.9.cmml">𝒃</mi><mo id="S3.SS2.p1.5.m1.10.10.10.10.10.10" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><msub id="S3.SS2.p1.5.m1.53.53.3.52.23.23.23.2.2.2"><mi id="S3.SS2.p1.5.m1.11.11.11.11.11.11" xref="S3.SS2.p1.5.m1.11.11.11.11.11.11.cmml">𝒘</mi><mn id="S3.SS2.p1.5.m1.12.12.12.12.12.12.1" xref="S3.SS2.p1.5.m1.12.12.12.12.12.12.1.cmml">1</mn></msub><mo id="S3.SS2.p1.5.m1.13.13.13.13.13.13" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.SS2.p1.5.m1.14.14.14.14.14.14" mathvariant="normal" xref="S3.SS2.p1.5.m1.14.14.14.14.14.14.cmml">…</mi><mo id="S3.SS2.p1.5.m1.15.15.15.15.15.15" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><msub id="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.3.3.3"><mi id="S3.SS2.p1.5.m1.16.16.16.16.16.16" xref="S3.SS2.p1.5.m1.16.16.16.16.16.16.cmml">𝒘</mi><mi id="S3.SS2.p1.5.m1.17.17.17.17.17.17.1" xref="S3.SS2.p1.5.m1.17.17.17.17.17.17.1.cmml">n</mi></msub><mo id="S3.SS2.p1.5.m1.18.18.18.18.18.18" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.SS2.p1.5.m1.19.19.19.19.19.19" xref="S3.SS2.p1.5.m1.19.19.19.19.19.19.cmml">𝑹</mi><mo id="S3.SS2.p1.5.m1.20.20.20.20.20.20" stretchy="false" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.5.m1.21.21.21.21.21.21" xref="S3.SS2.p1.5.m1.21.21.21.21.21.21.cmml">=</mo><mi id="S3.SS2.p1.5.m1.54.54.4.53.24.24.25" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml"></mi></mrow></mtd></mtr><mtr id="S3.SS2.p1.5.m1.55.55.5c"><mtd class="ltx_align_right" columnalign="right" id="S3.SS2.p1.5.m1.55.55.5d"><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30"><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1"><msub id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.3"><mi id="S3.SS2.p1.5.m1.22.22.22.1.1.1" xref="S3.SS2.p1.5.m1.22.22.22.1.1.1.cmml">b</mi><mn id="S3.SS2.p1.5.m1.23.23.23.2.2.2.1" xref="S3.SS2.p1.5.m1.23.23.23.2.2.2.1.cmml">0</mn></msub><mo id="S3.SS2.p1.5.m1.24.24.24.3.3.3" xref="S3.SS2.p1.5.m1.24.24.24.3.3.3.cmml">+</mo><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.4"><mo id="S3.SS2.p1.5.m1.25.25.25.4.4.4" stretchy="false" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⟨</mo><mi id="S3.SS2.p1.5.m1.26.26.26.5.5.5" xref="S3.SS2.p1.5.m1.26.26.26.5.5.5.cmml">𝒃</mi><mo id="S3.SS2.p1.5.m1.27.27.27.6.6.6" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><mi id="S3.SS2.p1.5.m1.28.28.28.7.7.7" xref="S3.SS2.p1.5.m1.28.28.28.7.7.7.cmml">𝒙</mi><mo id="S3.SS2.p1.5.m1.29.29.29.8.8.8" stretchy="false" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⟩</mo></mrow><mo id="S3.SS2.p1.5.m1.24.24.24.3.3.3a" rspace="0.055em" xref="S3.SS2.p1.5.m1.24.24.24.3.3.3.cmml">+</mo><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2"><munderover id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.3"><mo id="S3.SS2.p1.5.m1.31.31.31.10.10.10" movablelimits="false" rspace="0em" xref="S3.SS2.p1.5.m1.31.31.31.10.10.10.cmml">∑</mo><mrow id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.cmml"><mi id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.2" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.2.cmml">i</mi><mo id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.1" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.1.cmml">=</mo><mn id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.3" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.5.m1.33.33.33.12.12.12.1" xref="S3.SS2.p1.5.m1.33.33.33.12.12.12.1.cmml">n</mi></munderover><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2"><munderover id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.3"><mo id="S3.SS2.p1.5.m1.34.34.34.13.13.13" movablelimits="false" rspace="0em" xref="S3.SS2.p1.5.m1.34.34.34.13.13.13.cmml">∑</mo><mrow id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.cmml"><mi id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.2" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.2.cmml">j</mi><mo id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.1" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.1.cmml">=</mo><mrow id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.cmml"><mi id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.2" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.1" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.1.cmml">+</mo><mn id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.3" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.3.cmml">1</mn></mrow></mrow><mi id="S3.SS2.p1.5.m1.36.36.36.15.15.15.1" xref="S3.SS2.p1.5.m1.36.36.36.15.15.15.1.cmml">n</mi></munderover><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2"><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.2.2"><mo id="S3.SS2.p1.5.m1.37.37.37.16.16.16" stretchy="false" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⟨</mo><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.1.1.1.1.1.1"><msub id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.1.1.1.1.1.1.2"><mi id="S3.SS2.p1.5.m1.38.38.38.17.17.17" xref="S3.SS2.p1.5.m1.38.38.38.17.17.17.cmml">x</mi><mi id="S3.SS2.p1.5.m1.39.39.39.18.18.18.1" xref="S3.SS2.p1.5.m1.39.39.39.18.18.18.1.cmml">i</mi></msub><mo id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.1.1.1.1.1.1.3"><mi id="S3.SS2.p1.5.m1.40.40.40.19.19.19" xref="S3.SS2.p1.5.m1.40.40.40.19.19.19.cmml">𝒘</mi><mi id="S3.SS2.p1.5.m1.41.41.41.20.20.20.1" xref="S3.SS2.p1.5.m1.41.41.41.20.20.20.1.cmml">i</mi></msub></mrow><mo id="S3.SS2.p1.5.m1.42.42.42.21.21.21" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo><mrow id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.2.2.2"><msub id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.2.2.2.2"><mi id="S3.SS2.p1.5.m1.43.43.43.22.22.22" xref="S3.SS2.p1.5.m1.43.43.43.22.22.22.cmml">x</mi><mi id="S3.SS2.p1.5.m1.44.44.44.23.23.23.1" xref="S3.SS2.p1.5.m1.44.44.44.23.23.23.1.cmml">j</mi></msub><mo id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.2.2.2.1" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.2.2.2.3"><mi id="S3.SS2.p1.5.m1.45.45.45.24.24.24" xref="S3.SS2.p1.5.m1.45.45.45.24.24.24.cmml">𝒘</mi><mi id="S3.SS2.p1.5.m1.46.46.46.25.25.25.1" xref="S3.SS2.p1.5.m1.46.46.46.25.25.25.1.cmml">j</mi></msub></mrow><mo id="S3.SS2.p1.5.m1.47.47.47.26.26.26" stretchy="false" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⟩</mo></mrow><mo id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.3" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.5.m1.55.55.5.54.30.30.30.1.2.2.2.4"><mi id="S3.SS2.p1.5.m1.48.48.48.27.27.27" xref="S3.SS2.p1.5.m1.48.48.48.27.27.27.cmml">R</mi><mrow id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.3.cmml"><msub id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.cmml"><mi id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.2" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.3" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.3" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.3.cmml">,</mo><msub id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.cmml"><mi id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.2" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.2.cmml">f</mi><mi id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.3" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.3.cmml">j</mi></msub></mrow></msub></mrow></mrow></mrow></mrow><mo id="S3.SS2.p1.5.m1.50.50.50.29.29.29" xref="S3.SS2.p1.5.m1.51.51.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.55b"><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><eq id="S3.SS2.p1.5.m1.21.21.21.21.21.21.cmml" xref="S3.SS2.p1.5.m1.21.21.21.21.21.21"></eq><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><times id="S3.SS2.p1.5.m1.51.51.1.1.1.3.4.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"></times><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.3.5.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.3.5.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1.1.1.1.1">Φ</ci><ci id="S3.SS2.p1.5.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m1.2.2.2.2.2.2.1">FwFM</ci></apply><list id="S3.SS2.p1.5.m1.51.51.1.1.1.3.3.4.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><ci id="S3.SS2.p1.5.m1.4.4.4.4.4.4.cmml" xref="S3.SS2.p1.5.m1.4.4.4.4.4.4">𝒙</ci><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.6.6.6.6.6.6.cmml" xref="S3.SS2.p1.5.m1.6.6.6.6.6.6">𝑏</ci><cn id="S3.SS2.p1.5.m1.7.7.7.7.7.7.1.cmml" type="integer" xref="S3.SS2.p1.5.m1.7.7.7.7.7.7.1">0</cn></apply><ci id="S3.SS2.p1.5.m1.9.9.9.9.9.9.cmml" xref="S3.SS2.p1.5.m1.9.9.9.9.9.9">𝒃</ci><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.2.2.2.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.11.11.11.11.11.11.cmml" xref="S3.SS2.p1.5.m1.11.11.11.11.11.11">𝒘</ci><cn id="S3.SS2.p1.5.m1.12.12.12.12.12.12.1.cmml" type="integer" xref="S3.SS2.p1.5.m1.12.12.12.12.12.12.1">1</cn></apply><ci id="S3.SS2.p1.5.m1.14.14.14.14.14.14.cmml" xref="S3.SS2.p1.5.m1.14.14.14.14.14.14">…</ci><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.3.3.3.3.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.16.16.16.16.16.16.cmml" xref="S3.SS2.p1.5.m1.16.16.16.16.16.16">𝒘</ci><ci id="S3.SS2.p1.5.m1.17.17.17.17.17.17.1.cmml" xref="S3.SS2.p1.5.m1.17.17.17.17.17.17.1">𝑛</ci></apply><ci id="S3.SS2.p1.5.m1.19.19.19.19.19.19.cmml" xref="S3.SS2.p1.5.m1.19.19.19.19.19.19">𝑹</ci></list></apply><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><plus id="S3.SS2.p1.5.m1.24.24.24.3.3.3.cmml" xref="S3.SS2.p1.5.m1.24.24.24.3.3.3"></plus><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.4.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.4.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.22.22.22.1.1.1.cmml" xref="S3.SS2.p1.5.m1.22.22.22.1.1.1">𝑏</ci><cn id="S3.SS2.p1.5.m1.23.23.23.2.2.2.1.cmml" type="integer" xref="S3.SS2.p1.5.m1.23.23.23.2.2.2.1">0</cn></apply><list id="S3.SS2.p1.5.m1.51.51.1.1.1.5.5.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><ci id="S3.SS2.p1.5.m1.26.26.26.5.5.5.cmml" xref="S3.SS2.p1.5.m1.26.26.26.5.5.5">𝒃</ci><ci id="S3.SS2.p1.5.m1.28.28.28.7.7.7.cmml" xref="S3.SS2.p1.5.m1.28.28.28.7.7.7">𝒙</ci></list><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.3.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">superscript</csymbol><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.3.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.3.2.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><sum id="S3.SS2.p1.5.m1.31.31.31.10.10.10.cmml" xref="S3.SS2.p1.5.m1.31.31.31.10.10.10"></sum><apply id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.cmml" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1"><eq id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.1.cmml" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.1"></eq><ci id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.2.cmml" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.2">𝑖</ci><cn id="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.3.cmml" type="integer" xref="S3.SS2.p1.5.m1.32.32.32.11.11.11.1.3">1</cn></apply></apply><ci id="S3.SS2.p1.5.m1.33.33.33.12.12.12.1.cmml" xref="S3.SS2.p1.5.m1.33.33.33.12.12.12.1">𝑛</ci></apply><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.3.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">superscript</csymbol><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.3.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.3.2.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><sum id="S3.SS2.p1.5.m1.34.34.34.13.13.13.cmml" xref="S3.SS2.p1.5.m1.34.34.34.13.13.13"></sum><apply id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.cmml" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1"><eq id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.1.cmml" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.1"></eq><ci id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.2.cmml" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.2">𝑗</ci><apply id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.cmml" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3"><plus id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.1.cmml" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.1"></plus><ci id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.2.cmml" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.2">𝑖</ci><cn id="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.3.cmml" type="integer" xref="S3.SS2.p1.5.m1.35.35.35.14.14.14.1.3.3">1</cn></apply></apply></apply><ci id="S3.SS2.p1.5.m1.36.36.36.15.15.15.1.cmml" xref="S3.SS2.p1.5.m1.36.36.36.15.15.15.1">𝑛</ci></apply><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><times id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"></times><list id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.4.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><times id="S3.SS2.p1.5.m1.51.51.1.1.1.4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"></times><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.38.38.38.17.17.17.cmml" xref="S3.SS2.p1.5.m1.38.38.38.17.17.17">𝑥</ci><ci id="S3.SS2.p1.5.m1.39.39.39.18.18.18.1.cmml" xref="S3.SS2.p1.5.m1.39.39.39.18.18.18.1">𝑖</ci></apply><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.4.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.40.40.40.19.19.19.cmml" xref="S3.SS2.p1.5.m1.40.40.40.19.19.19">𝒘</ci><ci id="S3.SS2.p1.5.m1.41.41.41.20.20.20.1.cmml" xref="S3.SS2.p1.5.m1.41.41.41.20.20.20.1">𝑖</ci></apply></apply><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><times id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"></times><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.43.43.43.22.22.22.cmml" xref="S3.SS2.p1.5.m1.43.43.43.22.22.22">𝑥</ci><ci id="S3.SS2.p1.5.m1.44.44.44.23.23.23.1.cmml" xref="S3.SS2.p1.5.m1.44.44.44.23.23.23.1">𝑗</ci></apply><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.45.45.45.24.24.24.cmml" xref="S3.SS2.p1.5.m1.45.45.45.24.24.24">𝒘</ci><ci id="S3.SS2.p1.5.m1.46.46.46.25.25.25.1.cmml" xref="S3.SS2.p1.5.m1.46.46.46.25.25.25.1">𝑗</ci></apply></apply></list><apply id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.4.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.51.51.1.1.1.5.2.2.2.4.1.cmml" xref="S3.SS2.p1.5.m1.54.54.4.53.24.24.24.4">subscript</csymbol><ci id="S3.SS2.p1.5.m1.48.48.48.27.27.27.cmml" xref="S3.SS2.p1.5.m1.48.48.48.27.27.27">𝑅</ci><list id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.3.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2"><apply id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.2.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.3.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.1.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.2.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.2">𝑓</ci><ci id="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.3.cmml" xref="S3.SS2.p1.5.m1.49.49.49.28.28.28.1.2.2.3">𝑗</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.55c">\Phi_{\mathrm{FwFM}}({\bm{x}};b_{0},{\bm{b}},{\bm{w}}_{1},\dots,{\bm{w}}_{n},{%
\bm{R}})=\\
b_{0}+\langle{\bm{b}},{\bm{x}}\rangle+\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_%
{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}\rangle{R}_{f_{i},f_{j}},</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m1.55d">start_ROW start_CELL roman_Φ start_POSTSUBSCRIPT roman_FwFM end_POSTSUBSCRIPT ( bold_italic_x ; italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , bold_italic_b , bold_italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_R ) = end_CELL end_ROW start_ROW start_CELL italic_b start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + ⟨ bold_italic_b , bold_italic_x ⟩ + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⟨ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.9">where <math alttext="f_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m1.1"><semantics id="S3.SS2.p1.6.m1.1a"><msub id="S3.SS2.p1.6.m1.1.1" xref="S3.SS2.p1.6.m1.1.1.cmml"><mi id="S3.SS2.p1.6.m1.1.1.2" xref="S3.SS2.p1.6.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.6.m1.1.1.3" xref="S3.SS2.p1.6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m1.1b"><apply id="S3.SS2.p1.6.m1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m1.1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m1.1.1.2.cmml" xref="S3.SS2.p1.6.m1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.6.m1.1.1.3.cmml" xref="S3.SS2.p1.6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m1.1c">f_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m1.1d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the field corresponding to feature <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m2.1"><semantics id="S3.SS2.p1.7.m2.1a"><mi id="S3.SS2.p1.7.m2.1.1" xref="S3.SS2.p1.7.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m2.1b"><ci id="S3.SS2.p1.7.m2.1.1.cmml" xref="S3.SS2.p1.7.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m2.1d">italic_i</annotation></semantics></math>. <cite class="ltx_cite ltx_citemacro_citet">Pan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite> demonstrate that this model family achieves a significantly higher accuracy compared to a regular FM, and is comparable with other field-aware variants. One attractive property of this variant is its number of parameters and memory requirements - it has only <math alttext="\frac{m(m-1)}{2}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m3.1"><semantics id="S3.SS2.p1.8.m3.1a"><mfrac id="S3.SS2.p1.8.m3.1.1" xref="S3.SS2.p1.8.m3.1.1.cmml"><mrow id="S3.SS2.p1.8.m3.1.1.1" xref="S3.SS2.p1.8.m3.1.1.1.cmml"><mi id="S3.SS2.p1.8.m3.1.1.1.3" xref="S3.SS2.p1.8.m3.1.1.1.3.cmml">m</mi><mo id="S3.SS2.p1.8.m3.1.1.1.2" xref="S3.SS2.p1.8.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.8.m3.1.1.1.1.1" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.8.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.8.m3.1.1.1.1.1.1" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.8.m3.1.1.1.1.1.1.2" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.SS2.p1.8.m3.1.1.1.1.1.1.1" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS2.p1.8.m3.1.1.1.1.1.1.3" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.p1.8.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S3.SS2.p1.8.m3.1.1.3" xref="S3.SS2.p1.8.m3.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m3.1b"><apply id="S3.SS2.p1.8.m3.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1"><divide id="S3.SS2.p1.8.m3.1.1.2.cmml" xref="S3.SS2.p1.8.m3.1.1"></divide><apply id="S3.SS2.p1.8.m3.1.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1.1"><times id="S3.SS2.p1.8.m3.1.1.1.2.cmml" xref="S3.SS2.p1.8.m3.1.1.1.2"></times><ci id="S3.SS2.p1.8.m3.1.1.1.3.cmml" xref="S3.SS2.p1.8.m3.1.1.1.3">𝑚</ci><apply id="S3.SS2.p1.8.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1.1.1.1"><minus id="S3.SS2.p1.8.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.1"></minus><ci id="S3.SS2.p1.8.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.2">𝑚</ci><cn id="S3.SS2.p1.8.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m3.1.1.1.1.1.1.3">1</cn></apply></apply><cn id="S3.SS2.p1.8.m3.1.1.3.cmml" type="integer" xref="S3.SS2.p1.8.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m3.1c">\frac{m(m-1)}{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m3.1d">divide start_ARG italic_m ( italic_m - 1 ) end_ARG start_ARG 2 end_ARG</annotation></semantics></math> additional parameters compares to a regular FM comprising the above-diagonal entries of the field interaction matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m4.1"><semantics id="S3.SS2.p1.9.m4.1a"><mi id="S3.SS2.p1.9.m4.1.1" xref="S3.SS2.p1.9.m4.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m4.1b"><ci id="S3.SS2.p1.9.m4.1.1.cmml" xref="S3.SS2.p1.9.m4.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m4.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m4.1d">bold_italic_R</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.5">Similarly to Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E2.2" title="In 2 ‣ 3.1. Efficiency of factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">2b</span></a>), under the one-hot encoding assumption, given an input <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">bold_italic_x</annotation></semantics></math>, the pairwise interaction term can be written in terms of the field vectors <math alttext="{\bm{v}}_{1},\dots,{\bm{v}}_{m}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.3"><semantics id="S3.SS2.p2.2.m2.3a"><mrow id="S3.SS2.p2.2.m2.3.3.2" xref="S3.SS2.p2.2.m2.3.3.3.cmml"><msub id="S3.SS2.p2.2.m2.2.2.1.1" xref="S3.SS2.p2.2.m2.2.2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.2.2.1.1.2" xref="S3.SS2.p2.2.m2.2.2.1.1.2.cmml">𝒗</mi><mn id="S3.SS2.p2.2.m2.2.2.1.1.3" xref="S3.SS2.p2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.2.m2.3.3.2.3" xref="S3.SS2.p2.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS2.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS2.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p2.2.m2.3.3.2.4" xref="S3.SS2.p2.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS2.p2.2.m2.3.3.2.2" xref="S3.SS2.p2.2.m2.3.3.2.2.cmml"><mi id="S3.SS2.p2.2.m2.3.3.2.2.2" xref="S3.SS2.p2.2.m2.3.3.2.2.2.cmml">𝒗</mi><mi id="S3.SS2.p2.2.m2.3.3.2.2.3" xref="S3.SS2.p2.2.m2.3.3.2.2.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.3b"><list id="S3.SS2.p2.2.m2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2"><apply id="S3.SS2.p2.2.m2.2.2.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.2.2.1.1.2">𝒗</ci><cn id="S3.SS2.p2.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">…</ci><apply id="S3.SS2.p2.2.m2.3.3.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.3.3.2.2.1.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.2">𝒗</ci><ci id="S3.SS2.p2.2.m2.3.3.2.2.3.cmml" xref="S3.SS2.p2.2.m2.3.3.2.2.3">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.3c">{\bm{v}}_{1},\dots,{\bm{v}}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.3d">bold_italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> that are a subset of the embedding vectors <math alttext="{\bm{w}}_{1},\dots,{\bm{w}}_{n}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.3"><semantics id="S3.SS2.p2.3.m3.3a"><mrow id="S3.SS2.p2.3.m3.3.3.2" xref="S3.SS2.p2.3.m3.3.3.3.cmml"><msub id="S3.SS2.p2.3.m3.2.2.1.1" xref="S3.SS2.p2.3.m3.2.2.1.1.cmml"><mi id="S3.SS2.p2.3.m3.2.2.1.1.2" xref="S3.SS2.p2.3.m3.2.2.1.1.2.cmml">𝒘</mi><mn id="S3.SS2.p2.3.m3.2.2.1.1.3" xref="S3.SS2.p2.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.3.m3.3.3.2.3" xref="S3.SS2.p2.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS2.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS2.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p2.3.m3.3.3.2.4" xref="S3.SS2.p2.3.m3.3.3.3.cmml">,</mo><msub id="S3.SS2.p2.3.m3.3.3.2.2" xref="S3.SS2.p2.3.m3.3.3.2.2.cmml"><mi id="S3.SS2.p2.3.m3.3.3.2.2.2" xref="S3.SS2.p2.3.m3.3.3.2.2.2.cmml">𝒘</mi><mi id="S3.SS2.p2.3.m3.3.3.2.2.3" xref="S3.SS2.p2.3.m3.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.3b"><list id="S3.SS2.p2.3.m3.3.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3.2"><apply id="S3.SS2.p2.3.m3.2.2.1.1.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS2.p2.3.m3.2.2.1.1.2">𝒘</ci><cn id="S3.SS2.p2.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p2.3.m3.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">…</ci><apply id="S3.SS2.p2.3.m3.3.3.2.2.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.3.3.2.2.1.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.2">𝒘</ci><ci id="S3.SS2.p2.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.p2.3.m3.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.3c">{\bm{w}}_{1},\dots,{\bm{w}}_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.3d">bold_italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_w start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> that correspond to the <math alttext="m" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_m</annotation></semantics></math> nonzero entries of <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">bold_italic_x</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}%
\rangle{R}_{f_{i},f_{j}}=\sum_{i=1}^{m}\sum_{j=i+1}^{m}\langle{\bm{v}}_{i},{%
\bm{v}}_{j}\rangle{R}_{i,j}" class="ltx_Math" display="block" id="S3.E3.m1.8"><semantics id="S3.E3.m1.8a"><mrow id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml"><mrow id="S3.E3.m1.6.6.2" xref="S3.E3.m1.6.6.2.cmml"><munderover id="S3.E3.m1.6.6.2.3" xref="S3.E3.m1.6.6.2.3.cmml"><mo id="S3.E3.m1.6.6.2.3.2.2" movablelimits="false" xref="S3.E3.m1.6.6.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.2.3.2.3" xref="S3.E3.m1.6.6.2.3.2.3.cmml"><mi id="S3.E3.m1.6.6.2.3.2.3.2" xref="S3.E3.m1.6.6.2.3.2.3.2.cmml">i</mi><mo id="S3.E3.m1.6.6.2.3.2.3.1" xref="S3.E3.m1.6.6.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.6.6.2.3.2.3.3" xref="S3.E3.m1.6.6.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.6.6.2.3.3" xref="S3.E3.m1.6.6.2.3.3.cmml">n</mi></munderover><mrow id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml"><munderover id="S3.E3.m1.6.6.2.2.3" xref="S3.E3.m1.6.6.2.2.3.cmml"><mo id="S3.E3.m1.6.6.2.2.3.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S3.E3.m1.6.6.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.6.6.2.2.3.2.3" xref="S3.E3.m1.6.6.2.2.3.2.3.cmml"><mi id="S3.E3.m1.6.6.2.2.3.2.3.2" xref="S3.E3.m1.6.6.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E3.m1.6.6.2.2.3.2.3.1" xref="S3.E3.m1.6.6.2.2.3.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.6.6.2.2.3.2.3.3" xref="S3.E3.m1.6.6.2.2.3.2.3.3.cmml"><mi id="S3.E3.m1.6.6.2.2.3.2.3.3.2" xref="S3.E3.m1.6.6.2.2.3.2.3.3.2.cmml">i</mi><mo id="S3.E3.m1.6.6.2.2.3.2.3.3.1" xref="S3.E3.m1.6.6.2.2.3.2.3.3.1.cmml">+</mo><mn id="S3.E3.m1.6.6.2.2.3.2.3.3.3" xref="S3.E3.m1.6.6.2.2.3.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E3.m1.6.6.2.2.3.3" xref="S3.E3.m1.6.6.2.2.3.3.cmml">n</mi></munderover><mrow id="S3.E3.m1.6.6.2.2.2" xref="S3.E3.m1.6.6.2.2.2.cmml"><mrow id="S3.E3.m1.6.6.2.2.2.2.2" xref="S3.E3.m1.6.6.2.2.2.2.3.cmml"><mo id="S3.E3.m1.6.6.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.6.6.2.2.2.2.3.cmml">⟨</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.cmml">𝒘</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.6.6.2.2.2.2.2.4" xref="S3.E3.m1.6.6.2.2.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.6.6.2.2.2.2.2.2" xref="S3.E3.m1.6.6.2.2.2.2.2.2.cmml"><msub id="S3.E3.m1.6.6.2.2.2.2.2.2.2" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.6.6.2.2.2.2.2.2.2.2" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E3.m1.6.6.2.2.2.2.2.2.2.3" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E3.m1.6.6.2.2.2.2.2.2.1" xref="S3.E3.m1.6.6.2.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.E3.m1.6.6.2.2.2.2.2.2.3" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.6.6.2.2.2.2.2.2.3.2" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3.2.cmml">𝒘</mi><mi id="S3.E3.m1.6.6.2.2.2.2.2.2.3.3" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E3.m1.6.6.2.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.6.6.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="S3.E3.m1.6.6.2.2.2.3" xref="S3.E3.m1.6.6.2.2.2.3.cmml">⁢</mo><msub id="S3.E3.m1.6.6.2.2.2.4" xref="S3.E3.m1.6.6.2.2.2.4.cmml"><mi id="S3.E3.m1.6.6.2.2.2.4.2" xref="S3.E3.m1.6.6.2.2.2.4.2.cmml">R</mi><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.3.cmml"><msub id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">f</mi><mi id="S3.E3.m1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.3.cmml">j</mi></msub></mrow></msub></mrow></mrow></mrow><mo id="S3.E3.m1.8.8.5" rspace="0.111em" xref="S3.E3.m1.8.8.5.cmml">=</mo><mrow id="S3.E3.m1.8.8.4" xref="S3.E3.m1.8.8.4.cmml"><munderover id="S3.E3.m1.8.8.4.3" xref="S3.E3.m1.8.8.4.3.cmml"><mo id="S3.E3.m1.8.8.4.3.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.8.8.4.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.8.8.4.3.2.3" xref="S3.E3.m1.8.8.4.3.2.3.cmml"><mi id="S3.E3.m1.8.8.4.3.2.3.2" xref="S3.E3.m1.8.8.4.3.2.3.2.cmml">i</mi><mo id="S3.E3.m1.8.8.4.3.2.3.1" xref="S3.E3.m1.8.8.4.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.8.8.4.3.2.3.3" xref="S3.E3.m1.8.8.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.8.8.4.3.3" xref="S3.E3.m1.8.8.4.3.3.cmml">m</mi></munderover><mrow id="S3.E3.m1.8.8.4.2" xref="S3.E3.m1.8.8.4.2.cmml"><munderover id="S3.E3.m1.8.8.4.2.3" xref="S3.E3.m1.8.8.4.2.3.cmml"><mo id="S3.E3.m1.8.8.4.2.3.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.8.8.4.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.8.8.4.2.3.2.3" xref="S3.E3.m1.8.8.4.2.3.2.3.cmml"><mi id="S3.E3.m1.8.8.4.2.3.2.3.2" xref="S3.E3.m1.8.8.4.2.3.2.3.2.cmml">j</mi><mo id="S3.E3.m1.8.8.4.2.3.2.3.1" xref="S3.E3.m1.8.8.4.2.3.2.3.1.cmml">=</mo><mrow id="S3.E3.m1.8.8.4.2.3.2.3.3" xref="S3.E3.m1.8.8.4.2.3.2.3.3.cmml"><mi id="S3.E3.m1.8.8.4.2.3.2.3.3.2" xref="S3.E3.m1.8.8.4.2.3.2.3.3.2.cmml">i</mi><mo id="S3.E3.m1.8.8.4.2.3.2.3.3.1" xref="S3.E3.m1.8.8.4.2.3.2.3.3.1.cmml">+</mo><mn id="S3.E3.m1.8.8.4.2.3.2.3.3.3" xref="S3.E3.m1.8.8.4.2.3.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E3.m1.8.8.4.2.3.3" xref="S3.E3.m1.8.8.4.2.3.3.cmml">m</mi></munderover><mrow id="S3.E3.m1.8.8.4.2.2" xref="S3.E3.m1.8.8.4.2.2.cmml"><mrow id="S3.E3.m1.8.8.4.2.2.2.2" xref="S3.E3.m1.8.8.4.2.2.2.3.cmml"><mo id="S3.E3.m1.8.8.4.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.8.8.4.2.2.2.3.cmml">⟨</mo><msub id="S3.E3.m1.7.7.3.1.1.1.1.1" xref="S3.E3.m1.7.7.3.1.1.1.1.1.cmml"><mi id="S3.E3.m1.7.7.3.1.1.1.1.1.2" xref="S3.E3.m1.7.7.3.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S3.E3.m1.7.7.3.1.1.1.1.1.3" xref="S3.E3.m1.7.7.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.8.8.4.2.2.2.2.4" xref="S3.E3.m1.8.8.4.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.8.8.4.2.2.2.2.2" xref="S3.E3.m1.8.8.4.2.2.2.2.2.cmml"><mi id="S3.E3.m1.8.8.4.2.2.2.2.2.2" xref="S3.E3.m1.8.8.4.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S3.E3.m1.8.8.4.2.2.2.2.2.3" xref="S3.E3.m1.8.8.4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E3.m1.8.8.4.2.2.2.2.5" stretchy="false" xref="S3.E3.m1.8.8.4.2.2.2.3.cmml">⟩</mo></mrow><mo id="S3.E3.m1.8.8.4.2.2.3" xref="S3.E3.m1.8.8.4.2.2.3.cmml">⁢</mo><msub id="S3.E3.m1.8.8.4.2.2.4" xref="S3.E3.m1.8.8.4.2.2.4.cmml"><mi id="S3.E3.m1.8.8.4.2.2.4.2" xref="S3.E3.m1.8.8.4.2.2.4.2.cmml">R</mi><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">i</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.8b"><apply id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8"><eq id="S3.E3.m1.8.8.5.cmml" xref="S3.E3.m1.8.8.5"></eq><apply id="S3.E3.m1.6.6.2.cmml" xref="S3.E3.m1.6.6.2"><apply id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.3.1.cmml" xref="S3.E3.m1.6.6.2.3">superscript</csymbol><apply id="S3.E3.m1.6.6.2.3.2.cmml" xref="S3.E3.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.3.2.1.cmml" xref="S3.E3.m1.6.6.2.3">subscript</csymbol><sum id="S3.E3.m1.6.6.2.3.2.2.cmml" xref="S3.E3.m1.6.6.2.3.2.2"></sum><apply id="S3.E3.m1.6.6.2.3.2.3.cmml" xref="S3.E3.m1.6.6.2.3.2.3"><eq id="S3.E3.m1.6.6.2.3.2.3.1.cmml" xref="S3.E3.m1.6.6.2.3.2.3.1"></eq><ci id="S3.E3.m1.6.6.2.3.2.3.2.cmml" xref="S3.E3.m1.6.6.2.3.2.3.2">𝑖</ci><cn id="S3.E3.m1.6.6.2.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.6.6.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.6.6.2.3.3.cmml" xref="S3.E3.m1.6.6.2.3.3">𝑛</ci></apply><apply id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2"><apply id="S3.E3.m1.6.6.2.2.3.cmml" xref="S3.E3.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.3.1.cmml" xref="S3.E3.m1.6.6.2.2.3">superscript</csymbol><apply id="S3.E3.m1.6.6.2.2.3.2.cmml" xref="S3.E3.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.3.2.1.cmml" xref="S3.E3.m1.6.6.2.2.3">subscript</csymbol><sum id="S3.E3.m1.6.6.2.2.3.2.2.cmml" xref="S3.E3.m1.6.6.2.2.3.2.2"></sum><apply id="S3.E3.m1.6.6.2.2.3.2.3.cmml" xref="S3.E3.m1.6.6.2.2.3.2.3"><eq id="S3.E3.m1.6.6.2.2.3.2.3.1.cmml" xref="S3.E3.m1.6.6.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.6.6.2.2.3.2.3.2.cmml" xref="S3.E3.m1.6.6.2.2.3.2.3.2">𝑗</ci><apply id="S3.E3.m1.6.6.2.2.3.2.3.3.cmml" xref="S3.E3.m1.6.6.2.2.3.2.3.3"><plus id="S3.E3.m1.6.6.2.2.3.2.3.3.1.cmml" xref="S3.E3.m1.6.6.2.2.3.2.3.3.1"></plus><ci id="S3.E3.m1.6.6.2.2.3.2.3.3.2.cmml" xref="S3.E3.m1.6.6.2.2.3.2.3.3.2">𝑖</ci><cn id="S3.E3.m1.6.6.2.2.3.2.3.3.3.cmml" type="integer" xref="S3.E3.m1.6.6.2.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.E3.m1.6.6.2.2.3.3.cmml" xref="S3.E3.m1.6.6.2.2.3.3">𝑛</ci></apply><apply id="S3.E3.m1.6.6.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2"><times id="S3.E3.m1.6.6.2.2.2.3.cmml" xref="S3.E3.m1.6.6.2.2.2.3"></times><list id="S3.E3.m1.6.6.2.2.2.2.3.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2"><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2">𝒘</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2"><times id="S3.E3.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.1"></times><apply id="S3.E3.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.6.6.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2.2">𝑥</ci><ci id="S3.E3.m1.6.6.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.E3.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.6.6.2.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3.2">𝒘</ci><ci id="S3.E3.m1.6.6.2.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.6.6.2.2.2.2.2.2.3.3">𝑗</ci></apply></apply></list><apply id="S3.E3.m1.6.6.2.2.2.4.cmml" xref="S3.E3.m1.6.6.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.2.2.2.4.1.cmml" xref="S3.E3.m1.6.6.2.2.2.4">subscript</csymbol><ci id="S3.E3.m1.6.6.2.2.2.4.2.cmml" xref="S3.E3.m1.6.6.2.2.2.4.2">𝑅</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2">𝑓</ci><ci id="S3.E3.m1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.3">𝑗</ci></apply></list></apply></apply></apply></apply><apply id="S3.E3.m1.8.8.4.cmml" xref="S3.E3.m1.8.8.4"><apply id="S3.E3.m1.8.8.4.3.cmml" xref="S3.E3.m1.8.8.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.3.1.cmml" xref="S3.E3.m1.8.8.4.3">superscript</csymbol><apply id="S3.E3.m1.8.8.4.3.2.cmml" xref="S3.E3.m1.8.8.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.3.2.1.cmml" xref="S3.E3.m1.8.8.4.3">subscript</csymbol><sum id="S3.E3.m1.8.8.4.3.2.2.cmml" xref="S3.E3.m1.8.8.4.3.2.2"></sum><apply id="S3.E3.m1.8.8.4.3.2.3.cmml" xref="S3.E3.m1.8.8.4.3.2.3"><eq id="S3.E3.m1.8.8.4.3.2.3.1.cmml" xref="S3.E3.m1.8.8.4.3.2.3.1"></eq><ci id="S3.E3.m1.8.8.4.3.2.3.2.cmml" xref="S3.E3.m1.8.8.4.3.2.3.2">𝑖</ci><cn id="S3.E3.m1.8.8.4.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.8.8.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.8.8.4.3.3.cmml" xref="S3.E3.m1.8.8.4.3.3">𝑚</ci></apply><apply id="S3.E3.m1.8.8.4.2.cmml" xref="S3.E3.m1.8.8.4.2"><apply id="S3.E3.m1.8.8.4.2.3.cmml" xref="S3.E3.m1.8.8.4.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.2.3.1.cmml" xref="S3.E3.m1.8.8.4.2.3">superscript</csymbol><apply id="S3.E3.m1.8.8.4.2.3.2.cmml" xref="S3.E3.m1.8.8.4.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.2.3.2.1.cmml" xref="S3.E3.m1.8.8.4.2.3">subscript</csymbol><sum id="S3.E3.m1.8.8.4.2.3.2.2.cmml" xref="S3.E3.m1.8.8.4.2.3.2.2"></sum><apply id="S3.E3.m1.8.8.4.2.3.2.3.cmml" xref="S3.E3.m1.8.8.4.2.3.2.3"><eq id="S3.E3.m1.8.8.4.2.3.2.3.1.cmml" xref="S3.E3.m1.8.8.4.2.3.2.3.1"></eq><ci id="S3.E3.m1.8.8.4.2.3.2.3.2.cmml" xref="S3.E3.m1.8.8.4.2.3.2.3.2">𝑗</ci><apply id="S3.E3.m1.8.8.4.2.3.2.3.3.cmml" xref="S3.E3.m1.8.8.4.2.3.2.3.3"><plus id="S3.E3.m1.8.8.4.2.3.2.3.3.1.cmml" xref="S3.E3.m1.8.8.4.2.3.2.3.3.1"></plus><ci id="S3.E3.m1.8.8.4.2.3.2.3.3.2.cmml" xref="S3.E3.m1.8.8.4.2.3.2.3.3.2">𝑖</ci><cn id="S3.E3.m1.8.8.4.2.3.2.3.3.3.cmml" type="integer" xref="S3.E3.m1.8.8.4.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S3.E3.m1.8.8.4.2.3.3.cmml" xref="S3.E3.m1.8.8.4.2.3.3">𝑚</ci></apply><apply id="S3.E3.m1.8.8.4.2.2.cmml" xref="S3.E3.m1.8.8.4.2.2"><times id="S3.E3.m1.8.8.4.2.2.3.cmml" xref="S3.E3.m1.8.8.4.2.2.3"></times><list id="S3.E3.m1.8.8.4.2.2.2.3.cmml" xref="S3.E3.m1.8.8.4.2.2.2.2"><apply id="S3.E3.m1.7.7.3.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.7.7.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.7.7.3.1.1.1.1.1.2">𝒗</ci><ci id="S3.E3.m1.7.7.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.7.7.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3.m1.8.8.4.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.2.2.2.2.2.1.cmml" xref="S3.E3.m1.8.8.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.8.8.4.2.2.2.2.2.2.cmml" xref="S3.E3.m1.8.8.4.2.2.2.2.2.2">𝒗</ci><ci id="S3.E3.m1.8.8.4.2.2.2.2.2.3.cmml" xref="S3.E3.m1.8.8.4.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S3.E3.m1.8.8.4.2.2.4.cmml" xref="S3.E3.m1.8.8.4.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.4.2.2.4.1.cmml" xref="S3.E3.m1.8.8.4.2.2.4">subscript</csymbol><ci id="S3.E3.m1.8.8.4.2.2.4.2.cmml" xref="S3.E3.m1.8.8.4.2.2.4.2">𝑅</ci><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑖</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.8c">\sum_{i=1}^{n}\sum_{j=i+1}^{n}\langle x_{i}{\bm{w}}_{i},x_{j}{\bm{w}}_{j}%
\rangle{R}_{f_{i},f_{j}}=\sum_{i=1}^{m}\sum_{j=i+1}^{m}\langle{\bm{v}}_{i},{%
\bm{v}}_{j}\rangle{R}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.8d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ⟨ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT bold_italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p2.8">However, the time complexity of computing its output <math alttext="\Phi_{\mathrm{FwFM}}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m1.1"><semantics id="S3.SS2.p2.6.m1.1a"><msub id="S3.SS2.p2.6.m1.1.1" xref="S3.SS2.p2.6.m1.1.1.cmml"><mi id="S3.SS2.p2.6.m1.1.1.2" mathvariant="normal" xref="S3.SS2.p2.6.m1.1.1.2.cmml">Φ</mi><mi id="S3.SS2.p2.6.m1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.3.cmml">FwFM</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m1.1b"><apply id="S3.SS2.p2.6.m1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2">Φ</ci><ci id="S3.SS2.p2.6.m1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3">FwFM</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m1.1c">\Phi_{\mathrm{FwFM}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m1.1d">roman_Φ start_POSTSUBSCRIPT roman_FwFM end_POSTSUBSCRIPT</annotation></semantics></math> is dominated by the <math alttext="O(m^{2}k)" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m2.1"><semantics id="S3.SS2.p2.7.m2.1a"><mrow id="S3.SS2.p2.7.m2.1.1" xref="S3.SS2.p2.7.m2.1.1.cmml"><mi id="S3.SS2.p2.7.m2.1.1.3" xref="S3.SS2.p2.7.m2.1.1.3.cmml">O</mi><mo id="S3.SS2.p2.7.m2.1.1.2" xref="S3.SS2.p2.7.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.7.m2.1.1.1.1" xref="S3.SS2.p2.7.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.7.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.7.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.7.m2.1.1.1.1.1" xref="S3.SS2.p2.7.m2.1.1.1.1.1.cmml"><msup id="S3.SS2.p2.7.m2.1.1.1.1.1.2" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.7.m2.1.1.1.1.1.2.2" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2.2.cmml">m</mi><mn id="S3.SS2.p2.7.m2.1.1.1.1.1.2.3" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS2.p2.7.m2.1.1.1.1.1.1" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.7.m2.1.1.1.1.1.3" xref="S3.SS2.p2.7.m2.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS2.p2.7.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.7.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m2.1b"><apply id="S3.SS2.p2.7.m2.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1"><times id="S3.SS2.p2.7.m2.1.1.2.cmml" xref="S3.SS2.p2.7.m2.1.1.2"></times><ci id="S3.SS2.p2.7.m2.1.1.3.cmml" xref="S3.SS2.p2.7.m2.1.1.3">𝑂</ci><apply id="S3.SS2.p2.7.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1"><times id="S3.SS2.p2.7.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.1"></times><apply id="S3.SS2.p2.7.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.p2.7.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2.2">𝑚</ci><cn id="S3.SS2.p2.7.m2.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.p2.7.m2.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS2.p2.7.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.7.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m2.1c">O(m^{2}k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m2.1d">italic_O ( italic_m start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_k )</annotation></semantics></math> complexity of computing the pairwise term in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E3" title="In 3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>), which is quadratic in the total number of fields. Compared to the <math alttext="O(|\mathcal{I}|k)" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m3.2"><semantics id="S3.SS2.p2.8.m3.2a"><mrow id="S3.SS2.p2.8.m3.2.2" xref="S3.SS2.p2.8.m3.2.2.cmml"><mi id="S3.SS2.p2.8.m3.2.2.3" xref="S3.SS2.p2.8.m3.2.2.3.cmml">O</mi><mo id="S3.SS2.p2.8.m3.2.2.2" xref="S3.SS2.p2.8.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p2.8.m3.2.2.1.1" xref="S3.SS2.p2.8.m3.2.2.1.1.1.cmml"><mo id="S3.SS2.p2.8.m3.2.2.1.1.2" stretchy="false" xref="S3.SS2.p2.8.m3.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.8.m3.2.2.1.1.1" xref="S3.SS2.p2.8.m3.2.2.1.1.1.cmml"><mrow id="S3.SS2.p2.8.m3.2.2.1.1.1.2.2" xref="S3.SS2.p2.8.m3.2.2.1.1.1.2.1.cmml"><mo id="S3.SS2.p2.8.m3.2.2.1.1.1.2.2.1" stretchy="false" xref="S3.SS2.p2.8.m3.2.2.1.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m3.1.1" xref="S3.SS2.p2.8.m3.1.1.cmml">ℐ</mi><mo id="S3.SS2.p2.8.m3.2.2.1.1.1.2.2.2" stretchy="false" xref="S3.SS2.p2.8.m3.2.2.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p2.8.m3.2.2.1.1.1.1" xref="S3.SS2.p2.8.m3.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p2.8.m3.2.2.1.1.1.3" xref="S3.SS2.p2.8.m3.2.2.1.1.1.3.cmml">k</mi></mrow><mo id="S3.SS2.p2.8.m3.2.2.1.1.3" stretchy="false" xref="S3.SS2.p2.8.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m3.2b"><apply id="S3.SS2.p2.8.m3.2.2.cmml" xref="S3.SS2.p2.8.m3.2.2"><times id="S3.SS2.p2.8.m3.2.2.2.cmml" xref="S3.SS2.p2.8.m3.2.2.2"></times><ci id="S3.SS2.p2.8.m3.2.2.3.cmml" xref="S3.SS2.p2.8.m3.2.2.3">𝑂</ci><apply id="S3.SS2.p2.8.m3.2.2.1.1.1.cmml" xref="S3.SS2.p2.8.m3.2.2.1.1"><times id="S3.SS2.p2.8.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.8.m3.2.2.1.1.1.1"></times><apply id="S3.SS2.p2.8.m3.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p2.8.m3.2.2.1.1.1.2.2"><abs id="S3.SS2.p2.8.m3.2.2.1.1.1.2.1.1.cmml" xref="S3.SS2.p2.8.m3.2.2.1.1.1.2.2.1"></abs><ci id="S3.SS2.p2.8.m3.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1">ℐ</ci></apply><ci id="S3.SS2.p2.8.m3.2.2.1.1.1.3.cmml" xref="S3.SS2.p2.8.m3.2.2.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m3.2c">O(|\mathcal{I}|k)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m3.2d">italic_O ( | caligraphic_I | italic_k )</annotation></semantics></math> per item complexity of a regular FM, which is linear in the number of item fields, FwFMs pose a serious challenge for applications where inference speed is critical. While the quadratic complexity property is shared by many other field-aware variants, such as <cite class="ltx_cite ltx_citemacro_citet">Juan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib16" title="">2016a</a>); Pande (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib28" title="">2021</a>); Sun et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib35" title="">2021a</a>)</cite>, in this work, we focus on addressing this challenge for FwFM models.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.5">The one-hot encoding assumption does not cover the case when a field has multiple values, such as a list of movie genres. In this case, we assume that multiple components of a field’s encoding, that correspond to multiple values, may be nonzero. We handle this case by assuming that a field does not interact with itself, i.e. <math alttext="R_{f,f}=0" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.2"><semantics id="S3.SS2.p3.1.m1.2a"><mrow id="S3.SS2.p3.1.m1.2.3" xref="S3.SS2.p3.1.m1.2.3.cmml"><msub id="S3.SS2.p3.1.m1.2.3.2" xref="S3.SS2.p3.1.m1.2.3.2.cmml"><mi id="S3.SS2.p3.1.m1.2.3.2.2" xref="S3.SS2.p3.1.m1.2.3.2.2.cmml">R</mi><mrow id="S3.SS2.p3.1.m1.2.2.2.4" xref="S3.SS2.p3.1.m1.2.2.2.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.1.cmml">f</mi><mo id="S3.SS2.p3.1.m1.2.2.2.4.1" xref="S3.SS2.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.1.m1.2.2.2.2" xref="S3.SS2.p3.1.m1.2.2.2.2.cmml">f</mi></mrow></msub><mo id="S3.SS2.p3.1.m1.2.3.1" xref="S3.SS2.p3.1.m1.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.1.m1.2.3.3" xref="S3.SS2.p3.1.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.2b"><apply id="S3.SS2.p3.1.m1.2.3.cmml" xref="S3.SS2.p3.1.m1.2.3"><eq id="S3.SS2.p3.1.m1.2.3.1.cmml" xref="S3.SS2.p3.1.m1.2.3.1"></eq><apply id="S3.SS2.p3.1.m1.2.3.2.cmml" xref="S3.SS2.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.3.2.1.cmml" xref="S3.SS2.p3.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.3.2.2.cmml" xref="S3.SS2.p3.1.m1.2.3.2.2">𝑅</ci><list id="S3.SS2.p3.1.m1.2.2.2.3.cmml" xref="S3.SS2.p3.1.m1.2.2.2.4"><ci id="S3.SS2.p3.1.m1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1.1">𝑓</ci><ci id="S3.SS2.p3.1.m1.2.2.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2.2.2">𝑓</ci></list></apply><cn id="S3.SS2.p3.1.m1.2.3.3.cmml" type="integer" xref="S3.SS2.p3.1.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.2c">R_{f,f}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.2d">italic_R start_POSTSUBSCRIPT italic_f , italic_f end_POSTSUBSCRIPT = 0</annotation></semantics></math> for any field <math alttext="f" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_f</annotation></semantics></math>. A direct consequence is that the pairwise interaction term can be written in terms of field vectors, as in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E3" title="In 3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>), but each vector <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑣</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> may be a weighted sum of the corresponding feature embedding vectors. For example, a movie with 3 genres may be encoded by placing <math alttext="\frac{1}{3}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mfrac id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mn id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">1</mn><mn id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">3</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><divide id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"></divide><cn id="S3.SS2.p3.4.m4.1.1.2.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.2">1</cn><cn id="S3.SS2.p3.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p3.4.m4.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\frac{1}{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">divide start_ARG 1 end_ARG start_ARG 3 end_ARG</annotation></semantics></math> in the corresponding components of <math alttext="{\bm{x}}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">{\bm{x}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">bold_italic_x</annotation></semantics></math>, which will result in an average of the genre embedding vectors.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Problem formulation</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.3">A typical approach used in practice to speed up inference is pruning the matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">bold_italic_R</annotation></semantics></math> by zeroing-out entries whose magnitude is below a threshold, as suggested by <cite class="ltx_cite ltx_citemacro_citet">Pan et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib26" title="">2018a</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Sun et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib35" title="">2021a</a>)</cite>. However, as we show in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5" title="5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, aggressive pruning reduces the accuracy of the model. In this work, we aim to devise a method to achieve inference speed that is proportional to the number of <em class="ltx_emph ltx_font_italic" id="S3.SS3.p1.3.1">item fields</em>, and is only <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_ρ</annotation></semantics></math> times slower than a regular FM, where <math alttext="0&lt;\rho\ll m" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mn id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">0</mn><mo id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">&lt;</mo><mi id="S3.SS3.p1.3.m3.1.1.4" xref="S3.SS3.p1.3.m3.1.1.4.cmml">ρ</mi><mo id="S3.SS3.p1.3.m3.1.1.5" xref="S3.SS3.p1.3.m3.1.1.5.cmml">≪</mo><mi id="S3.SS3.p1.3.m3.1.1.6" xref="S3.SS3.p1.3.m3.1.1.6.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><and id="S3.SS3.p1.3.m3.1.1a.cmml" xref="S3.SS3.p1.3.m3.1.1"></and><apply id="S3.SS3.p1.3.m3.1.1b.cmml" xref="S3.SS3.p1.3.m3.1.1"><lt id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"></lt><cn id="S3.SS3.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS3.p1.3.m3.1.1.2">0</cn><ci id="S3.SS3.p1.3.m3.1.1.4.cmml" xref="S3.SS3.p1.3.m3.1.1.4">𝜌</ci></apply><apply id="S3.SS3.p1.3.m3.1.1c.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS3.p1.3.m3.1.1.5.cmml" xref="S3.SS3.p1.3.m3.1.1.5">much-less-than</csymbol><share href="https://arxiv.org/html/2408.00801v1#S3.SS3.p1.3.m3.1.1.4.cmml" id="S3.SS3.p1.3.m3.1.1d.cmml" xref="S3.SS3.p1.3.m3.1.1"></share><ci id="S3.SS3.p1.3.m3.1.1.6.cmml" xref="S3.SS3.p1.3.m3.1.1.6">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">0&lt;\rho\ll m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">0 &lt; italic_ρ ≪ italic_m</annotation></semantics></math> is a configurable factor. This, while retaining an accuracy that is comparable with that of a regular FwFM model, and significantly better than pruned model with a similar number of parameters.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Low-rank field-weighted factorization machines</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.2">In this section we reformulate the pairwise field interaction term in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E3" title="In 3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>) in an equivalent, but significantly more efficient manner. Throughout this section, we assume that the field vectors <math alttext="{\bm{v}}_{1},\dots,{\bm{v}}_{m}\in\mathbb{R}^{k}" class="ltx_Math" display="inline" id="S4.p1.1.m1.3"><semantics id="S4.p1.1.m1.3a"><mrow id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml"><mrow id="S4.p1.1.m1.3.3.2.2" xref="S4.p1.1.m1.3.3.2.3.cmml"><msub id="S4.p1.1.m1.2.2.1.1.1" xref="S4.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.p1.1.m1.2.2.1.1.1.2" xref="S4.p1.1.m1.2.2.1.1.1.2.cmml">𝒗</mi><mn id="S4.p1.1.m1.2.2.1.1.1.3" xref="S4.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.p1.1.m1.3.3.2.2.3" xref="S4.p1.1.m1.3.3.2.3.cmml">,</mo><mi id="S4.p1.1.m1.1.1" mathvariant="normal" xref="S4.p1.1.m1.1.1.cmml">…</mi><mo id="S4.p1.1.m1.3.3.2.2.4" xref="S4.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.p1.1.m1.3.3.2.2.2" xref="S4.p1.1.m1.3.3.2.2.2.cmml"><mi id="S4.p1.1.m1.3.3.2.2.2.2" xref="S4.p1.1.m1.3.3.2.2.2.2.cmml">𝒗</mi><mi id="S4.p1.1.m1.3.3.2.2.2.3" xref="S4.p1.1.m1.3.3.2.2.2.3.cmml">m</mi></msub></mrow><mo id="S4.p1.1.m1.3.3.3" xref="S4.p1.1.m1.3.3.3.cmml">∈</mo><msup id="S4.p1.1.m1.3.3.4" xref="S4.p1.1.m1.3.3.4.cmml"><mi id="S4.p1.1.m1.3.3.4.2" xref="S4.p1.1.m1.3.3.4.2.cmml">ℝ</mi><mi id="S4.p1.1.m1.3.3.4.3" xref="S4.p1.1.m1.3.3.4.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.3b"><apply id="S4.p1.1.m1.3.3.cmml" xref="S4.p1.1.m1.3.3"><in id="S4.p1.1.m1.3.3.3.cmml" xref="S4.p1.1.m1.3.3.3"></in><list id="S4.p1.1.m1.3.3.2.3.cmml" xref="S4.p1.1.m1.3.3.2.2"><apply id="S4.p1.1.m1.2.2.1.1.1.cmml" xref="S4.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.p1.1.m1.2.2.1.1.1.2">𝒗</ci><cn id="S4.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S4.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">…</ci><apply id="S4.p1.1.m1.3.3.2.2.2.cmml" xref="S4.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.2.2.2.1.cmml" xref="S4.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.p1.1.m1.3.3.2.2.2.2.cmml" xref="S4.p1.1.m1.3.3.2.2.2.2">𝒗</ci><ci id="S4.p1.1.m1.3.3.2.2.2.3.cmml" xref="S4.p1.1.m1.3.3.2.2.2.3">𝑚</ci></apply></list><apply id="S4.p1.1.m1.3.3.4.cmml" xref="S4.p1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.4.1.cmml" xref="S4.p1.1.m1.3.3.4">superscript</csymbol><ci id="S4.p1.1.m1.3.3.4.2.cmml" xref="S4.p1.1.m1.3.3.4.2">ℝ</ci><ci id="S4.p1.1.m1.3.3.4.3.cmml" xref="S4.p1.1.m1.3.3.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.3c">{\bm{v}}_{1},\dots,{\bm{v}}_{m}\in\mathbb{R}^{k}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.3d">bold_italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> are embedded into the <em class="ltx_emph ltx_font_italic" id="S4.p1.2.1">rows</em> of the matrix <math alttext="{\bm{V}}\in\mathbb{R}^{m\times k}" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">𝑽</mi><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml"><mi id="S4.p1.2.m2.1.1.3.2" xref="S4.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.p1.2.m2.1.1.3.3" xref="S4.p1.2.m2.1.1.3.3.cmml"><mi id="S4.p1.2.m2.1.1.3.3.2" xref="S4.p1.2.m2.1.1.3.3.2.cmml">m</mi><mo id="S4.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.p1.2.m2.1.1.3.3.3" xref="S4.p1.2.m2.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><in id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></in><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝑽</ci><apply id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.1.3.1.cmml" xref="S4.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.p1.2.m2.1.1.3.2.cmml" xref="S4.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S4.p1.2.m2.1.1.3.3.cmml" xref="S4.p1.2.m2.1.1.3.3"><times id="S4.p1.2.m2.1.1.3.3.1.cmml" xref="S4.p1.2.m2.1.1.3.3.1"></times><ci id="S4.p1.2.m2.1.1.3.3.2.cmml" xref="S4.p1.2.m2.1.1.3.3.2">𝑚</ci><ci id="S4.p1.2.m2.1.1.3.3.3.cmml" xref="S4.p1.2.m2.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">{\bm{V}}\in\mathbb{R}^{m\times k}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">bold_italic_V ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{V}}=\begin{bmatrix}\,\textrm{---}\,{\bm{v}}_{1}\,\textrm{---}\,\\
\,\textrm{---}\,{\bm{v}}_{2}\,\textrm{---}\,\\
\vdots\\
\,\textrm{---}\,{\bm{v}}_{m}\,\textrm{---}\,\end{bmatrix}" class="ltx_Math" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.2" xref="S4.E4.m1.1.2.cmml"><mi id="S4.E4.m1.1.2.2" xref="S4.E4.m1.1.2.2.cmml">𝑽</mi><mo id="S4.E4.m1.1.2.1" xref="S4.E4.m1.1.2.1.cmml">=</mo><mrow id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.2.cmml"><mo id="S4.E4.m1.1.1.3.1" xref="S4.E4.m1.1.1.2.1.cmml">[</mo><mtable displaystyle="true" id="S4.E4.m1.1.1.1.1" rowspacing="0pt" xref="S4.E4.m1.1.1.1.1.cmml"><mtr id="S4.E4.m1.1.1.1.1a" xref="S4.E4.m1.1.1.1.1.cmml"><mtd id="S4.E4.m1.1.1.1.1b" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E4.m1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.2a.cmml">—</mtext><mo id="S4.E4.m1.1.1.1.1.1.1.1.1" lspace="0.170em" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.3.2.cmml">𝒗</mi><mn id="S4.E4.m1.1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S4.E4.m1.1.1.1.1.1.1.1.1a" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mtext id="S4.E4.m1.1.1.1.1.1.1.1.4" xref="S4.E4.m1.1.1.1.1.1.1.1.4a.cmml">—</mtext></mrow></mtd></mtr><mtr id="S4.E4.m1.1.1.1.1c" xref="S4.E4.m1.1.1.1.1.cmml"><mtd id="S4.E4.m1.1.1.1.1d" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.2.1.1" xref="S4.E4.m1.1.1.1.1.2.1.1.cmml"><mtext id="S4.E4.m1.1.1.1.1.2.1.1.2" xref="S4.E4.m1.1.1.1.1.2.1.1.2a.cmml">—</mtext><mo id="S4.E4.m1.1.1.1.1.2.1.1.1" lspace="0.170em" xref="S4.E4.m1.1.1.1.1.2.1.1.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.2.1.1.3" xref="S4.E4.m1.1.1.1.1.2.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.1.1.3.2" xref="S4.E4.m1.1.1.1.1.2.1.1.3.2.cmml">𝒗</mi><mn id="S4.E4.m1.1.1.1.1.2.1.1.3.3" xref="S4.E4.m1.1.1.1.1.2.1.1.3.3.cmml">2</mn></msub><mo id="S4.E4.m1.1.1.1.1.2.1.1.1a" xref="S4.E4.m1.1.1.1.1.2.1.1.1.cmml">⁢</mo><mtext id="S4.E4.m1.1.1.1.1.2.1.1.4" xref="S4.E4.m1.1.1.1.1.2.1.1.4a.cmml">—</mtext></mrow></mtd></mtr><mtr id="S4.E4.m1.1.1.1.1e" xref="S4.E4.m1.1.1.1.1.cmml"><mtd id="S4.E4.m1.1.1.1.1f" xref="S4.E4.m1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.3.1.1" mathvariant="normal" xref="S4.E4.m1.1.1.1.1.3.1.1.cmml">⋮</mi></mtd></mtr><mtr id="S4.E4.m1.1.1.1.1g" xref="S4.E4.m1.1.1.1.1.cmml"><mtd id="S4.E4.m1.1.1.1.1h" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.4.1.1" xref="S4.E4.m1.1.1.1.1.4.1.1.cmml"><mtext id="S4.E4.m1.1.1.1.1.4.1.1.2" xref="S4.E4.m1.1.1.1.1.4.1.1.2a.cmml">—</mtext><mo id="S4.E4.m1.1.1.1.1.4.1.1.1" lspace="0.170em" xref="S4.E4.m1.1.1.1.1.4.1.1.1.cmml">⁢</mo><msub id="S4.E4.m1.1.1.1.1.4.1.1.3" xref="S4.E4.m1.1.1.1.1.4.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.4.1.1.3.2" xref="S4.E4.m1.1.1.1.1.4.1.1.3.2.cmml">𝒗</mi><mi id="S4.E4.m1.1.1.1.1.4.1.1.3.3" xref="S4.E4.m1.1.1.1.1.4.1.1.3.3.cmml">m</mi></msub><mo id="S4.E4.m1.1.1.1.1.4.1.1.1a" xref="S4.E4.m1.1.1.1.1.4.1.1.1.cmml">⁢</mo><mtext id="S4.E4.m1.1.1.1.1.4.1.1.4" xref="S4.E4.m1.1.1.1.1.4.1.1.4a.cmml">—</mtext></mrow></mtd></mtr></mtable><mo id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.2.cmml" xref="S4.E4.m1.1.2"><eq id="S4.E4.m1.1.2.1.cmml" xref="S4.E4.m1.1.2.1"></eq><ci id="S4.E4.m1.1.2.2.cmml" xref="S4.E4.m1.1.2.2">𝑽</ci><apply id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.3"><csymbol cd="latexml" id="S4.E4.m1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.3.1">matrix</csymbol><matrix id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1"><matrixrow id="S4.E4.m1.1.1.1.1a.cmml" xref="S4.E4.m1.1.1.1.1"><apply id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.1.2a.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2"><mtext id="S4.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2">—</mtext></ci><apply id="S4.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3.2">𝒗</ci><cn id="S4.E4.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E4.m1.1.1.1.1.1.1.1.3.3">1</cn></apply><ci id="S4.E4.m1.1.1.1.1.1.1.1.4a.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.4"><mtext id="S4.E4.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.4">—</mtext></ci></apply></matrixrow><matrixrow id="S4.E4.m1.1.1.1.1b.cmml" xref="S4.E4.m1.1.1.1.1"><apply id="S4.E4.m1.1.1.1.1.2.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1"><times id="S4.E4.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.1"></times><ci id="S4.E4.m1.1.1.1.1.2.1.1.2a.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.2"><mtext id="S4.E4.m1.1.1.1.1.2.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.2">—</mtext></ci><apply id="S4.E4.m1.1.1.1.1.2.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.3.2">𝒗</ci><cn id="S4.E4.m1.1.1.1.1.2.1.1.3.3.cmml" type="integer" xref="S4.E4.m1.1.1.1.1.2.1.1.3.3">2</cn></apply><ci id="S4.E4.m1.1.1.1.1.2.1.1.4a.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.4"><mtext id="S4.E4.m1.1.1.1.1.2.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.2.1.1.4">—</mtext></ci></apply></matrixrow><matrixrow id="S4.E4.m1.1.1.1.1c.cmml" xref="S4.E4.m1.1.1.1.1"><ci id="S4.E4.m1.1.1.1.1.3.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1.1">⋮</ci></matrixrow><matrixrow id="S4.E4.m1.1.1.1.1d.cmml" xref="S4.E4.m1.1.1.1.1"><apply id="S4.E4.m1.1.1.1.1.4.1.1.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1"><times id="S4.E4.m1.1.1.1.1.4.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.1"></times><ci id="S4.E4.m1.1.1.1.1.4.1.1.2a.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.2"><mtext id="S4.E4.m1.1.1.1.1.4.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.2">—</mtext></ci><apply id="S4.E4.m1.1.1.1.1.4.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.4.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.4.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.3.2">𝒗</ci><ci id="S4.E4.m1.1.1.1.1.4.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.3.3">𝑚</ci></apply><ci id="S4.E4.m1.1.1.1.1.4.1.1.4a.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.4"><mtext id="S4.E4.m1.1.1.1.1.4.1.1.4.cmml" xref="S4.E4.m1.1.1.1.1.4.1.1.4">—</mtext></ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">{\bm{V}}=\begin{bmatrix}\,\textrm{---}\,{\bm{v}}_{1}\,\textrm{---}\,\\
\,\textrm{---}\,{\bm{v}}_{2}\,\textrm{---}\,\\
\vdots\\
\,\textrm{---}\,{\bm{v}}_{m}\,\textrm{---}\,\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">bold_italic_V = [ start_ARG start_ROW start_CELL — bold_italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT — end_CELL end_ROW start_ROW start_CELL — bold_italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT — end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL — bold_italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT — end_CELL end_ROW end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p1.4">Moreover, since Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E3" title="In 3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>) uses only the upper triangular part of <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.p1.3.m1.1"><semantics id="S4.p1.3.m1.1a"><mi id="S4.p1.3.m1.1.1" xref="S4.p1.3.m1.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m1.1b"><ci id="S4.p1.3.m1.1.1.cmml" xref="S4.p1.3.m1.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m1.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m1.1d">bold_italic_R</annotation></semantics></math>, we may choose the remaining entries arbitrarily to our convenience, and throughout this section we assume that <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.p1.4.m2.1"><semantics id="S4.p1.4.m2.1a"><mi id="S4.p1.4.m2.1.1" xref="S4.p1.4.m2.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m2.1b"><ci id="S4.p1.4.m2.1.1.cmml" xref="S4.p1.4.m2.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m2.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m2.1d">bold_italic_R</annotation></semantics></math> is symmetric with a zero diagonal. Under this assumption, Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E3" title="In 3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>) can be re-written as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{m}\sum_{j=i+1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}%
=\frac{1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}%
\rangle{R}_{i,j}." class="ltx_Math" display="block" id="S4.E5.m1.5"><semantics id="S4.E5.m1.5a"><mrow id="S4.E5.m1.5.5.1" xref="S4.E5.m1.5.5.1.1.cmml"><mrow id="S4.E5.m1.5.5.1.1" xref="S4.E5.m1.5.5.1.1.cmml"><mrow id="S4.E5.m1.5.5.1.1.2" xref="S4.E5.m1.5.5.1.1.2.cmml"><munderover id="S4.E5.m1.5.5.1.1.2.3" xref="S4.E5.m1.5.5.1.1.2.3.cmml"><mo id="S4.E5.m1.5.5.1.1.2.3.2.2" movablelimits="false" xref="S4.E5.m1.5.5.1.1.2.3.2.2.cmml">∑</mo><mrow id="S4.E5.m1.5.5.1.1.2.3.2.3" xref="S4.E5.m1.5.5.1.1.2.3.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.2.3.2.3.2" xref="S4.E5.m1.5.5.1.1.2.3.2.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.1.2.3.2.3.1" xref="S4.E5.m1.5.5.1.1.2.3.2.3.1.cmml">=</mo><mn id="S4.E5.m1.5.5.1.1.2.3.2.3.3" xref="S4.E5.m1.5.5.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.5.5.1.1.2.3.3" xref="S4.E5.m1.5.5.1.1.2.3.3.cmml">m</mi></munderover><mrow id="S4.E5.m1.5.5.1.1.2.2" xref="S4.E5.m1.5.5.1.1.2.2.cmml"><munderover id="S4.E5.m1.5.5.1.1.2.2.3" xref="S4.E5.m1.5.5.1.1.2.2.3.cmml"><mo id="S4.E5.m1.5.5.1.1.2.2.3.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S4.E5.m1.5.5.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E5.m1.5.5.1.1.2.2.3.2.3" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.2.2.3.2.3.2" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E5.m1.5.5.1.1.2.2.3.2.3.1" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.1.cmml">=</mo><mrow id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.cmml"><mi id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.2" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.1" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.1.cmml">+</mo><mn id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.3" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.3.cmml">1</mn></mrow></mrow><mi id="S4.E5.m1.5.5.1.1.2.2.3.3" xref="S4.E5.m1.5.5.1.1.2.2.3.3.cmml">m</mi></munderover><mrow id="S4.E5.m1.5.5.1.1.2.2.2" xref="S4.E5.m1.5.5.1.1.2.2.2.cmml"><mrow id="S4.E5.m1.5.5.1.1.2.2.2.2.2" xref="S4.E5.m1.5.5.1.1.2.2.2.2.3.cmml"><mo id="S4.E5.m1.5.5.1.1.2.2.2.2.2.3" stretchy="false" xref="S4.E5.m1.5.5.1.1.2.2.2.2.3.cmml">⟨</mo><msub id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5.m1.5.5.1.1.2.2.2.2.2.4" xref="S4.E5.m1.5.5.1.1.2.2.2.2.3.cmml">,</mo><msub id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.2" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.3" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E5.m1.5.5.1.1.2.2.2.2.2.5" stretchy="false" xref="S4.E5.m1.5.5.1.1.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.E5.m1.5.5.1.1.2.2.2.3" xref="S4.E5.m1.5.5.1.1.2.2.2.3.cmml">⁢</mo><msub id="S4.E5.m1.5.5.1.1.2.2.2.4" xref="S4.E5.m1.5.5.1.1.2.2.2.4.cmml"><mi id="S4.E5.m1.5.5.1.1.2.2.2.4.2" xref="S4.E5.m1.5.5.1.1.2.2.2.4.2.cmml">R</mi><mrow id="S4.E5.m1.2.2.2.4" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">i</mi><mo id="S4.E5.m1.2.2.2.4.1" xref="S4.E5.m1.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E5.m1.5.5.1.1.5" xref="S4.E5.m1.5.5.1.1.5.cmml">=</mo><mrow id="S4.E5.m1.5.5.1.1.4" xref="S4.E5.m1.5.5.1.1.4.cmml"><mfrac id="S4.E5.m1.5.5.1.1.4.4" xref="S4.E5.m1.5.5.1.1.4.4.cmml"><mn id="S4.E5.m1.5.5.1.1.4.4.2" xref="S4.E5.m1.5.5.1.1.4.4.2.cmml">1</mn><mn id="S4.E5.m1.5.5.1.1.4.4.3" xref="S4.E5.m1.5.5.1.1.4.4.3.cmml">2</mn></mfrac><mo id="S4.E5.m1.5.5.1.1.4.3" xref="S4.E5.m1.5.5.1.1.4.3.cmml">⁢</mo><mrow id="S4.E5.m1.5.5.1.1.4.2" xref="S4.E5.m1.5.5.1.1.4.2.cmml"><munderover id="S4.E5.m1.5.5.1.1.4.2.3" xref="S4.E5.m1.5.5.1.1.4.2.3.cmml"><mo id="S4.E5.m1.5.5.1.1.4.2.3.2.2" movablelimits="false" rspace="0em" xref="S4.E5.m1.5.5.1.1.4.2.3.2.2.cmml">∑</mo><mrow id="S4.E5.m1.5.5.1.1.4.2.3.2.3" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.4.2.3.2.3.2" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.1.4.2.3.2.3.1" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.1.cmml">=</mo><mn id="S4.E5.m1.5.5.1.1.4.2.3.2.3.3" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.5.5.1.1.4.2.3.3" xref="S4.E5.m1.5.5.1.1.4.2.3.3.cmml">m</mi></munderover><mrow id="S4.E5.m1.5.5.1.1.4.2.2" xref="S4.E5.m1.5.5.1.1.4.2.2.cmml"><munderover id="S4.E5.m1.5.5.1.1.4.2.2.3" xref="S4.E5.m1.5.5.1.1.4.2.2.3.cmml"><mo id="S4.E5.m1.5.5.1.1.4.2.2.3.2.2" movablelimits="false" rspace="0em" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.cmml"><mi id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.2" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.1" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.3" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.5.5.1.1.4.2.2.3.3" xref="S4.E5.m1.5.5.1.1.4.2.2.3.3.cmml">m</mi></munderover><mrow id="S4.E5.m1.5.5.1.1.4.2.2.2" xref="S4.E5.m1.5.5.1.1.4.2.2.2.cmml"><mrow id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.3.cmml"><mo id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.3" stretchy="false" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.3.cmml">⟨</mo><msub id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.4" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.3.cmml">,</mo><msub id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.cmml"><mi id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.2" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.3" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.5" stretchy="false" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.E5.m1.5.5.1.1.4.2.2.2.3" xref="S4.E5.m1.5.5.1.1.4.2.2.2.3.cmml">⁢</mo><msub id="S4.E5.m1.5.5.1.1.4.2.2.2.4" xref="S4.E5.m1.5.5.1.1.4.2.2.2.4.cmml"><mi id="S4.E5.m1.5.5.1.1.4.2.2.2.4.2" xref="S4.E5.m1.5.5.1.1.4.2.2.2.4.2.cmml">R</mi><mrow id="S4.E5.m1.4.4.2.4" xref="S4.E5.m1.4.4.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml">i</mi><mo id="S4.E5.m1.4.4.2.4.1" xref="S4.E5.m1.4.4.2.3.cmml">,</mo><mi id="S4.E5.m1.4.4.2.2" xref="S4.E5.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.5.5.1.2" lspace="0em" xref="S4.E5.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.5b"><apply id="S4.E5.m1.5.5.1.1.cmml" xref="S4.E5.m1.5.5.1"><eq id="S4.E5.m1.5.5.1.1.5.cmml" xref="S4.E5.m1.5.5.1.1.5"></eq><apply id="S4.E5.m1.5.5.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.2"><apply id="S4.E5.m1.5.5.1.1.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3">superscript</csymbol><apply id="S4.E5.m1.5.5.1.1.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.3.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3">subscript</csymbol><sum id="S4.E5.m1.5.5.1.1.2.3.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3.2.2"></sum><apply id="S4.E5.m1.5.5.1.1.2.3.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3.2.3"><eq id="S4.E5.m1.5.5.1.1.2.3.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.3.2.3.1"></eq><ci id="S4.E5.m1.5.5.1.1.2.3.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.3.2.3.2">𝑖</ci><cn id="S4.E5.m1.5.5.1.1.2.3.2.3.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.5.5.1.1.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.2.3.3">𝑚</ci></apply><apply id="S4.E5.m1.5.5.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2"><apply id="S4.E5.m1.5.5.1.1.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3">superscript</csymbol><apply id="S4.E5.m1.5.5.1.1.2.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.2.3.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3">subscript</csymbol><sum id="S4.E5.m1.5.5.1.1.2.2.3.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.2"></sum><apply id="S4.E5.m1.5.5.1.1.2.2.3.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3"><eq id="S4.E5.m1.5.5.1.1.2.2.3.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.1"></eq><ci id="S4.E5.m1.5.5.1.1.2.2.3.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.2">𝑗</ci><apply id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3"><plus id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.1"></plus><ci id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.2">𝑖</ci><cn id="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.2.2.3.2.3.3.3">1</cn></apply></apply></apply><ci id="S4.E5.m1.5.5.1.1.2.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3.3">𝑚</ci></apply><apply id="S4.E5.m1.5.5.1.1.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2"><times id="S4.E5.m1.5.5.1.1.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.3"></times><list id="S4.E5.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2"><apply id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.2">𝒗</ci><ci id="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S4.E5.m1.5.5.1.1.2.2.2.4.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.2.2.4.1.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.4">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.2.2.4.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2.4.2">𝑅</ci><list id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.4"><ci id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1">𝑖</ci><ci id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply><apply id="S4.E5.m1.5.5.1.1.4.cmml" xref="S4.E5.m1.5.5.1.1.4"><times id="S4.E5.m1.5.5.1.1.4.3.cmml" xref="S4.E5.m1.5.5.1.1.4.3"></times><apply id="S4.E5.m1.5.5.1.1.4.4.cmml" xref="S4.E5.m1.5.5.1.1.4.4"><divide id="S4.E5.m1.5.5.1.1.4.4.1.cmml" xref="S4.E5.m1.5.5.1.1.4.4"></divide><cn id="S4.E5.m1.5.5.1.1.4.4.2.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.4.4.2">1</cn><cn id="S4.E5.m1.5.5.1.1.4.4.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.4.4.3">2</cn></apply><apply id="S4.E5.m1.5.5.1.1.4.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2"><apply id="S4.E5.m1.5.5.1.1.4.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.4.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3">superscript</csymbol><apply id="S4.E5.m1.5.5.1.1.4.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.4.2.3.2.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3">subscript</csymbol><sum id="S4.E5.m1.5.5.1.1.4.2.3.2.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3.2.2"></sum><apply id="S4.E5.m1.5.5.1.1.4.2.3.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3"><eq id="S4.E5.m1.5.5.1.1.4.2.3.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.1"></eq><ci id="S4.E5.m1.5.5.1.1.4.2.3.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.2">𝑖</ci><cn id="S4.E5.m1.5.5.1.1.4.2.3.2.3.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.4.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.5.5.1.1.4.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.3.3">𝑚</ci></apply><apply id="S4.E5.m1.5.5.1.1.4.2.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2"><apply id="S4.E5.m1.5.5.1.1.4.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.4.2.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3">superscript</csymbol><apply id="S4.E5.m1.5.5.1.1.4.2.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.4.2.2.3.2.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3">subscript</csymbol><sum id="S4.E5.m1.5.5.1.1.4.2.2.3.2.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.2"></sum><apply id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3"><eq id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.1"></eq><ci id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.2">𝑗</ci><cn id="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.4.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.5.5.1.1.4.2.2.3.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.3.3">𝑚</ci></apply><apply id="S4.E5.m1.5.5.1.1.4.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2"><times id="S4.E5.m1.5.5.1.1.4.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.3"></times><list id="S4.E5.m1.5.5.1.1.4.2.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2"><apply id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.2">𝒗</ci><ci id="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S4.E5.m1.5.5.1.1.4.2.2.2.4.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.4"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.4.2.2.2.4.1.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.4">subscript</csymbol><ci id="S4.E5.m1.5.5.1.1.4.2.2.2.4.2.cmml" xref="S4.E5.m1.5.5.1.1.4.2.2.2.4.2">𝑅</ci><list id="S4.E5.m1.4.4.2.3.cmml" xref="S4.E5.m1.4.4.2.4"><ci id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1.1">𝑖</ci><ci id="S4.E5.m1.4.4.2.2.cmml" xref="S4.E5.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.5c">\sum_{i=1}^{m}\sum_{j=i+1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}%
=\frac{1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}%
\rangle{R}_{i,j}.</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.5d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = italic_i + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p1.5">In the sequel, we describe our method to efficiently compute the double sum in the right-hand side of Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.E5" title="In 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>). We first review the mathematical background, and then the complete method.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Mathematical foundation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In this section we present a technical result that provides the motivation for factorizing the matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">bold_italic_R</annotation></semantics></math> to obtain an efficient algorithm. Then, we present an example explaining why the widely used <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.1.1">low-rank factorization</em> lacks expressive power, and use it to motivate a <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.1.2">diagonal plus low-rank factorization</em>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The following identity let us reformulate the pairwise interaction formula as the one in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.E5" title="In 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>) in a matrix form, that is inspired by the reformulation in <cite class="ltx_cite ltx_citemacro_citet">Lin et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib21" title="">2018</a>)</cite> for regular FMs.</p>
</div>
<div class="ltx_theorem ltx_theorem_identity" id="Thmidentity1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Identity 1.</h6>
<div class="ltx_para" id="Thmidentity1.p1">
<p class="ltx_p" id="Thmidentity1.p1.2"><span class="ltx_text ltx_font_italic" id="Thmidentity1.p1.2.2">Let <math alttext="{\bm{A}}\in\mathbb{R}^{m\times k}" class="ltx_Math" display="inline" id="Thmidentity1.p1.1.1.m1.1"><semantics id="Thmidentity1.p1.1.1.m1.1a"><mrow id="Thmidentity1.p1.1.1.m1.1.1" xref="Thmidentity1.p1.1.1.m1.1.1.cmml"><mi id="Thmidentity1.p1.1.1.m1.1.1.2" xref="Thmidentity1.p1.1.1.m1.1.1.2.cmml">𝐀</mi><mo id="Thmidentity1.p1.1.1.m1.1.1.1" xref="Thmidentity1.p1.1.1.m1.1.1.1.cmml">∈</mo><msup id="Thmidentity1.p1.1.1.m1.1.1.3" xref="Thmidentity1.p1.1.1.m1.1.1.3.cmml"><mi id="Thmidentity1.p1.1.1.m1.1.1.3.2" xref="Thmidentity1.p1.1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="Thmidentity1.p1.1.1.m1.1.1.3.3" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.cmml"><mi id="Thmidentity1.p1.1.1.m1.1.1.3.3.2" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.2.cmml">m</mi><mo id="Thmidentity1.p1.1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="Thmidentity1.p1.1.1.m1.1.1.3.3.3" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmidentity1.p1.1.1.m1.1b"><apply id="Thmidentity1.p1.1.1.m1.1.1.cmml" xref="Thmidentity1.p1.1.1.m1.1.1"><in id="Thmidentity1.p1.1.1.m1.1.1.1.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.1"></in><ci id="Thmidentity1.p1.1.1.m1.1.1.2.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.2">𝐀</ci><apply id="Thmidentity1.p1.1.1.m1.1.1.3.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Thmidentity1.p1.1.1.m1.1.1.3.1.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3">superscript</csymbol><ci id="Thmidentity1.p1.1.1.m1.1.1.3.2.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3.2">ℝ</ci><apply id="Thmidentity1.p1.1.1.m1.1.1.3.3.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3.3"><times id="Thmidentity1.p1.1.1.m1.1.1.3.3.1.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.1"></times><ci id="Thmidentity1.p1.1.1.m1.1.1.3.3.2.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.2">𝑚</ci><ci id="Thmidentity1.p1.1.1.m1.1.1.3.3.3.cmml" xref="Thmidentity1.p1.1.1.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmidentity1.p1.1.1.m1.1c">{\bm{A}}\in\mathbb{R}^{m\times k}</annotation><annotation encoding="application/x-llamapun" id="Thmidentity1.p1.1.1.m1.1d">bold_italic_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>. Then, for any matrix <math alttext="{\bm{Q}}\in\mathbb{R}^{m\times m}" class="ltx_Math" display="inline" id="Thmidentity1.p1.2.2.m2.1"><semantics id="Thmidentity1.p1.2.2.m2.1a"><mrow id="Thmidentity1.p1.2.2.m2.1.1" xref="Thmidentity1.p1.2.2.m2.1.1.cmml"><mi id="Thmidentity1.p1.2.2.m2.1.1.2" xref="Thmidentity1.p1.2.2.m2.1.1.2.cmml">𝐐</mi><mo id="Thmidentity1.p1.2.2.m2.1.1.1" xref="Thmidentity1.p1.2.2.m2.1.1.1.cmml">∈</mo><msup id="Thmidentity1.p1.2.2.m2.1.1.3" xref="Thmidentity1.p1.2.2.m2.1.1.3.cmml"><mi id="Thmidentity1.p1.2.2.m2.1.1.3.2" xref="Thmidentity1.p1.2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Thmidentity1.p1.2.2.m2.1.1.3.3" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.cmml"><mi id="Thmidentity1.p1.2.2.m2.1.1.3.3.2" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.2.cmml">m</mi><mo id="Thmidentity1.p1.2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="Thmidentity1.p1.2.2.m2.1.1.3.3.3" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Thmidentity1.p1.2.2.m2.1b"><apply id="Thmidentity1.p1.2.2.m2.1.1.cmml" xref="Thmidentity1.p1.2.2.m2.1.1"><in id="Thmidentity1.p1.2.2.m2.1.1.1.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.1"></in><ci id="Thmidentity1.p1.2.2.m2.1.1.2.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.2">𝐐</ci><apply id="Thmidentity1.p1.2.2.m2.1.1.3.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="Thmidentity1.p1.2.2.m2.1.1.3.1.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3">superscript</csymbol><ci id="Thmidentity1.p1.2.2.m2.1.1.3.2.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3.2">ℝ</ci><apply id="Thmidentity1.p1.2.2.m2.1.1.3.3.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3.3"><times id="Thmidentity1.p1.2.2.m2.1.1.3.3.1.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.1"></times><ci id="Thmidentity1.p1.2.2.m2.1.1.3.3.2.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.2">𝑚</ci><ci id="Thmidentity1.p1.2.2.m2.1.1.3.3.3.cmml" xref="Thmidentity1.p1.2.2.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmidentity1.p1.2.2.m2.1c">{\bm{Q}}\in\mathbb{R}^{m\times m}</annotation><annotation encoding="application/x-llamapun" id="Thmidentity1.p1.2.2.m2.1d">bold_italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> we have</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{A}}_{i,:},{\bm{A}}_{j,:}\rangle{Q}_{i,%
j}=\operatorname{Tr}({\bm{A}}^{T}{\bm{Q}}{\bm{A}})" class="ltx_Math" display="block" id="S4.E6.m1.10"><semantics id="S4.E6.m1.10a"><mrow id="S4.E6.m1.10.10" xref="S4.E6.m1.10.10.cmml"><mrow id="S4.E6.m1.9.9.2" xref="S4.E6.m1.9.9.2.cmml"><munderover id="S4.E6.m1.9.9.2.3" xref="S4.E6.m1.9.9.2.3.cmml"><mo id="S4.E6.m1.9.9.2.3.2.2" movablelimits="false" xref="S4.E6.m1.9.9.2.3.2.2.cmml">∑</mo><mrow id="S4.E6.m1.9.9.2.3.2.3" xref="S4.E6.m1.9.9.2.3.2.3.cmml"><mi id="S4.E6.m1.9.9.2.3.2.3.2" xref="S4.E6.m1.9.9.2.3.2.3.2.cmml">i</mi><mo id="S4.E6.m1.9.9.2.3.2.3.1" xref="S4.E6.m1.9.9.2.3.2.3.1.cmml">=</mo><mn id="S4.E6.m1.9.9.2.3.2.3.3" xref="S4.E6.m1.9.9.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.9.9.2.3.3" xref="S4.E6.m1.9.9.2.3.3.cmml">m</mi></munderover><mrow id="S4.E6.m1.9.9.2.2" xref="S4.E6.m1.9.9.2.2.cmml"><munderover id="S4.E6.m1.9.9.2.2.3" xref="S4.E6.m1.9.9.2.2.3.cmml"><mo id="S4.E6.m1.9.9.2.2.3.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S4.E6.m1.9.9.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E6.m1.9.9.2.2.3.2.3" xref="S4.E6.m1.9.9.2.2.3.2.3.cmml"><mi id="S4.E6.m1.9.9.2.2.3.2.3.2" xref="S4.E6.m1.9.9.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E6.m1.9.9.2.2.3.2.3.1" xref="S4.E6.m1.9.9.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E6.m1.9.9.2.2.3.2.3.3" xref="S4.E6.m1.9.9.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E6.m1.9.9.2.2.3.3" xref="S4.E6.m1.9.9.2.2.3.3.cmml">m</mi></munderover><mrow id="S4.E6.m1.9.9.2.2.2" xref="S4.E6.m1.9.9.2.2.2.cmml"><mrow id="S4.E6.m1.9.9.2.2.2.2.2" xref="S4.E6.m1.9.9.2.2.2.2.3.cmml"><mo id="S4.E6.m1.9.9.2.2.2.2.2.3" stretchy="false" xref="S4.E6.m1.9.9.2.2.2.2.3.cmml">⟨</mo><msub id="S4.E6.m1.8.8.1.1.1.1.1.1" xref="S4.E6.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.8.8.1.1.1.1.1.1.2" xref="S4.E6.m1.8.8.1.1.1.1.1.1.2.cmml">𝑨</mi><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">i</mi><mo id="S4.E6.m1.2.2.2.4.1" xref="S4.E6.m1.2.2.2.3.cmml">,</mo><mo id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">:</mo></mrow></msub><mo id="S4.E6.m1.9.9.2.2.2.2.2.4" xref="S4.E6.m1.9.9.2.2.2.2.3.cmml">,</mo><msub id="S4.E6.m1.9.9.2.2.2.2.2.2" xref="S4.E6.m1.9.9.2.2.2.2.2.2.cmml"><mi id="S4.E6.m1.9.9.2.2.2.2.2.2.2" xref="S4.E6.m1.9.9.2.2.2.2.2.2.2.cmml">𝑨</mi><mrow id="S4.E6.m1.4.4.2.4" xref="S4.E6.m1.4.4.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">j</mi><mo id="S4.E6.m1.4.4.2.4.1" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><mo id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml">:</mo></mrow></msub><mo id="S4.E6.m1.9.9.2.2.2.2.2.5" stretchy="false" xref="S4.E6.m1.9.9.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.E6.m1.9.9.2.2.2.3" xref="S4.E6.m1.9.9.2.2.2.3.cmml">⁢</mo><msub id="S4.E6.m1.9.9.2.2.2.4" xref="S4.E6.m1.9.9.2.2.2.4.cmml"><mi id="S4.E6.m1.9.9.2.2.2.4.2" xref="S4.E6.m1.9.9.2.2.2.4.2.cmml">Q</mi><mrow id="S4.E6.m1.6.6.2.4" xref="S4.E6.m1.6.6.2.3.cmml"><mi id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml">i</mi><mo id="S4.E6.m1.6.6.2.4.1" xref="S4.E6.m1.6.6.2.3.cmml">,</mo><mi id="S4.E6.m1.6.6.2.2" xref="S4.E6.m1.6.6.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E6.m1.10.10.4" xref="S4.E6.m1.10.10.4.cmml">=</mo><mrow id="S4.E6.m1.10.10.3.1" xref="S4.E6.m1.10.10.3.2.cmml"><mi id="S4.E6.m1.7.7" xref="S4.E6.m1.7.7.cmml">Tr</mi><mo id="S4.E6.m1.10.10.3.1a" xref="S4.E6.m1.10.10.3.2.cmml">⁡</mo><mrow id="S4.E6.m1.10.10.3.1.1" xref="S4.E6.m1.10.10.3.2.cmml"><mo id="S4.E6.m1.10.10.3.1.1.2" stretchy="false" xref="S4.E6.m1.10.10.3.2.cmml">(</mo><mrow id="S4.E6.m1.10.10.3.1.1.1" xref="S4.E6.m1.10.10.3.1.1.1.cmml"><msup id="S4.E6.m1.10.10.3.1.1.1.2" xref="S4.E6.m1.10.10.3.1.1.1.2.cmml"><mi id="S4.E6.m1.10.10.3.1.1.1.2.2" xref="S4.E6.m1.10.10.3.1.1.1.2.2.cmml">𝑨</mi><mi id="S4.E6.m1.10.10.3.1.1.1.2.3" xref="S4.E6.m1.10.10.3.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.E6.m1.10.10.3.1.1.1.1" xref="S4.E6.m1.10.10.3.1.1.1.1.cmml">⁢</mo><mi id="S4.E6.m1.10.10.3.1.1.1.3" xref="S4.E6.m1.10.10.3.1.1.1.3.cmml">𝑸</mi><mo id="S4.E6.m1.10.10.3.1.1.1.1a" xref="S4.E6.m1.10.10.3.1.1.1.1.cmml">⁢</mo><mi id="S4.E6.m1.10.10.3.1.1.1.4" xref="S4.E6.m1.10.10.3.1.1.1.4.cmml">𝑨</mi></mrow><mo id="S4.E6.m1.10.10.3.1.1.3" stretchy="false" xref="S4.E6.m1.10.10.3.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.10b"><apply id="S4.E6.m1.10.10.cmml" xref="S4.E6.m1.10.10"><eq id="S4.E6.m1.10.10.4.cmml" xref="S4.E6.m1.10.10.4"></eq><apply id="S4.E6.m1.9.9.2.cmml" xref="S4.E6.m1.9.9.2"><apply id="S4.E6.m1.9.9.2.3.cmml" xref="S4.E6.m1.9.9.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.2.3.1.cmml" xref="S4.E6.m1.9.9.2.3">superscript</csymbol><apply id="S4.E6.m1.9.9.2.3.2.cmml" xref="S4.E6.m1.9.9.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.2.3.2.1.cmml" xref="S4.E6.m1.9.9.2.3">subscript</csymbol><sum id="S4.E6.m1.9.9.2.3.2.2.cmml" xref="S4.E6.m1.9.9.2.3.2.2"></sum><apply id="S4.E6.m1.9.9.2.3.2.3.cmml" xref="S4.E6.m1.9.9.2.3.2.3"><eq id="S4.E6.m1.9.9.2.3.2.3.1.cmml" xref="S4.E6.m1.9.9.2.3.2.3.1"></eq><ci id="S4.E6.m1.9.9.2.3.2.3.2.cmml" xref="S4.E6.m1.9.9.2.3.2.3.2">𝑖</ci><cn id="S4.E6.m1.9.9.2.3.2.3.3.cmml" type="integer" xref="S4.E6.m1.9.9.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.9.9.2.3.3.cmml" xref="S4.E6.m1.9.9.2.3.3">𝑚</ci></apply><apply id="S4.E6.m1.9.9.2.2.cmml" xref="S4.E6.m1.9.9.2.2"><apply id="S4.E6.m1.9.9.2.2.3.cmml" xref="S4.E6.m1.9.9.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.2.2.3.1.cmml" xref="S4.E6.m1.9.9.2.2.3">superscript</csymbol><apply id="S4.E6.m1.9.9.2.2.3.2.cmml" xref="S4.E6.m1.9.9.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.2.2.3.2.1.cmml" xref="S4.E6.m1.9.9.2.2.3">subscript</csymbol><sum id="S4.E6.m1.9.9.2.2.3.2.2.cmml" xref="S4.E6.m1.9.9.2.2.3.2.2"></sum><apply id="S4.E6.m1.9.9.2.2.3.2.3.cmml" xref="S4.E6.m1.9.9.2.2.3.2.3"><eq id="S4.E6.m1.9.9.2.2.3.2.3.1.cmml" xref="S4.E6.m1.9.9.2.2.3.2.3.1"></eq><ci id="S4.E6.m1.9.9.2.2.3.2.3.2.cmml" xref="S4.E6.m1.9.9.2.2.3.2.3.2">𝑗</ci><cn id="S4.E6.m1.9.9.2.2.3.2.3.3.cmml" type="integer" xref="S4.E6.m1.9.9.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E6.m1.9.9.2.2.3.3.cmml" xref="S4.E6.m1.9.9.2.2.3.3">𝑚</ci></apply><apply id="S4.E6.m1.9.9.2.2.2.cmml" xref="S4.E6.m1.9.9.2.2.2"><times id="S4.E6.m1.9.9.2.2.2.3.cmml" xref="S4.E6.m1.9.9.2.2.2.3"></times><list id="S4.E6.m1.9.9.2.2.2.2.3.cmml" xref="S4.E6.m1.9.9.2.2.2.2.2"><apply id="S4.E6.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.8.8.1.1.1.1.1.1.2">𝑨</ci><list id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.4"><ci id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1">𝑖</ci><ci id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2">:</ci></list></apply><apply id="S4.E6.m1.9.9.2.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.2.2.2.2.2.2.1.cmml" xref="S4.E6.m1.9.9.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.9.9.2.2.2.2.2.2.2.cmml" xref="S4.E6.m1.9.9.2.2.2.2.2.2.2">𝑨</ci><list id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.4"><ci id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1.1">𝑗</ci><ci id="S4.E6.m1.4.4.2.2.cmml" xref="S4.E6.m1.4.4.2.2">:</ci></list></apply></list><apply id="S4.E6.m1.9.9.2.2.2.4.cmml" xref="S4.E6.m1.9.9.2.2.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.2.2.2.4.1.cmml" xref="S4.E6.m1.9.9.2.2.2.4">subscript</csymbol><ci id="S4.E6.m1.9.9.2.2.2.4.2.cmml" xref="S4.E6.m1.9.9.2.2.2.4.2">𝑄</ci><list id="S4.E6.m1.6.6.2.3.cmml" xref="S4.E6.m1.6.6.2.4"><ci id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1.1">𝑖</ci><ci id="S4.E6.m1.6.6.2.2.cmml" xref="S4.E6.m1.6.6.2.2">𝑗</ci></list></apply></apply></apply></apply><apply id="S4.E6.m1.10.10.3.2.cmml" xref="S4.E6.m1.10.10.3.1"><ci id="S4.E6.m1.7.7.cmml" xref="S4.E6.m1.7.7">Tr</ci><apply id="S4.E6.m1.10.10.3.1.1.1.cmml" xref="S4.E6.m1.10.10.3.1.1.1"><times id="S4.E6.m1.10.10.3.1.1.1.1.cmml" xref="S4.E6.m1.10.10.3.1.1.1.1"></times><apply id="S4.E6.m1.10.10.3.1.1.1.2.cmml" xref="S4.E6.m1.10.10.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.10.10.3.1.1.1.2.1.cmml" xref="S4.E6.m1.10.10.3.1.1.1.2">superscript</csymbol><ci id="S4.E6.m1.10.10.3.1.1.1.2.2.cmml" xref="S4.E6.m1.10.10.3.1.1.1.2.2">𝑨</ci><ci id="S4.E6.m1.10.10.3.1.1.1.2.3.cmml" xref="S4.E6.m1.10.10.3.1.1.1.2.3">𝑇</ci></apply><ci id="S4.E6.m1.10.10.3.1.1.1.3.cmml" xref="S4.E6.m1.10.10.3.1.1.1.3">𝑸</ci><ci id="S4.E6.m1.10.10.3.1.1.1.4.cmml" xref="S4.E6.m1.10.10.3.1.1.1.4">𝑨</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.10c">\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{A}}_{i,:},{\bm{A}}_{j,:}\rangle{Q}_{i,%
j}=\operatorname{Tr}({\bm{A}}^{T}{\bm{Q}}{\bm{A}})</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.10d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_A start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT , bold_italic_A start_POSTSUBSCRIPT italic_j , : end_POSTSUBSCRIPT ⟩ italic_Q start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = roman_Tr ( bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_Q bold_italic_A )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="S4.SS1.2">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S4.SS1.1.p1">
<p class="ltx_p" id="S4.SS1.1.p1.1">Recall the definition of the Frobenius inner product of matrices:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\langle{\bm{A}},{\bm{B}}\rangle=\sum_{i=1}^{m}\sum_{j=1}^{n}{A}_{i,j}{B}_{i,j}%
=\operatorname{Tr}({\bm{A}}^{T}{\bm{B}})," class="ltx_Math" display="block" id="S4.Ex1.m1.8"><semantics id="S4.Ex1.m1.8a"><mrow id="S4.Ex1.m1.8.8.1" xref="S4.Ex1.m1.8.8.1.1.cmml"><mrow id="S4.Ex1.m1.8.8.1.1" xref="S4.Ex1.m1.8.8.1.1.cmml"><mrow id="S4.Ex1.m1.8.8.1.1.3.2" xref="S4.Ex1.m1.8.8.1.1.3.1.cmml"><mo id="S4.Ex1.m1.8.8.1.1.3.2.1" stretchy="false" xref="S4.Ex1.m1.8.8.1.1.3.1.cmml">⟨</mo><mi id="S4.Ex1.m1.5.5" xref="S4.Ex1.m1.5.5.cmml">𝑨</mi><mo id="S4.Ex1.m1.8.8.1.1.3.2.2" xref="S4.Ex1.m1.8.8.1.1.3.1.cmml">,</mo><mi id="S4.Ex1.m1.6.6" xref="S4.Ex1.m1.6.6.cmml">𝑩</mi><mo id="S4.Ex1.m1.8.8.1.1.3.2.3" stretchy="false" xref="S4.Ex1.m1.8.8.1.1.3.1.cmml">⟩</mo></mrow><mo id="S4.Ex1.m1.8.8.1.1.4" rspace="0.111em" xref="S4.Ex1.m1.8.8.1.1.4.cmml">=</mo><mrow id="S4.Ex1.m1.8.8.1.1.5" xref="S4.Ex1.m1.8.8.1.1.5.cmml"><munderover id="S4.Ex1.m1.8.8.1.1.5.1" xref="S4.Ex1.m1.8.8.1.1.5.1.cmml"><mo id="S4.Ex1.m1.8.8.1.1.5.1.2.2" movablelimits="false" rspace="0em" xref="S4.Ex1.m1.8.8.1.1.5.1.2.2.cmml">∑</mo><mrow id="S4.Ex1.m1.8.8.1.1.5.1.2.3" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.cmml"><mi id="S4.Ex1.m1.8.8.1.1.5.1.2.3.2" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.2.cmml">i</mi><mo id="S4.Ex1.m1.8.8.1.1.5.1.2.3.1" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.1.cmml">=</mo><mn id="S4.Ex1.m1.8.8.1.1.5.1.2.3.3" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex1.m1.8.8.1.1.5.1.3" xref="S4.Ex1.m1.8.8.1.1.5.1.3.cmml">m</mi></munderover><mrow id="S4.Ex1.m1.8.8.1.1.5.2" xref="S4.Ex1.m1.8.8.1.1.5.2.cmml"><munderover id="S4.Ex1.m1.8.8.1.1.5.2.1" xref="S4.Ex1.m1.8.8.1.1.5.2.1.cmml"><mo id="S4.Ex1.m1.8.8.1.1.5.2.1.2.2" movablelimits="false" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.2.cmml">∑</mo><mrow id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.cmml"><mi id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.2" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.2.cmml">j</mi><mo id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.1" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.1.cmml">=</mo><mn id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.3" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex1.m1.8.8.1.1.5.2.1.3" xref="S4.Ex1.m1.8.8.1.1.5.2.1.3.cmml">n</mi></munderover><mrow id="S4.Ex1.m1.8.8.1.1.5.2.2" xref="S4.Ex1.m1.8.8.1.1.5.2.2.cmml"><msub id="S4.Ex1.m1.8.8.1.1.5.2.2.2" xref="S4.Ex1.m1.8.8.1.1.5.2.2.2.cmml"><mi id="S4.Ex1.m1.8.8.1.1.5.2.2.2.2" xref="S4.Ex1.m1.8.8.1.1.5.2.2.2.2.cmml">A</mi><mrow id="S4.Ex1.m1.2.2.2.4" xref="S4.Ex1.m1.2.2.2.3.cmml"><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex1.m1.2.2.2.4.1" xref="S4.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.Ex1.m1.8.8.1.1.5.2.2.1" xref="S4.Ex1.m1.8.8.1.1.5.2.2.1.cmml">⁢</mo><msub id="S4.Ex1.m1.8.8.1.1.5.2.2.3" xref="S4.Ex1.m1.8.8.1.1.5.2.2.3.cmml"><mi id="S4.Ex1.m1.8.8.1.1.5.2.2.3.2" xref="S4.Ex1.m1.8.8.1.1.5.2.2.3.2.cmml">B</mi><mrow id="S4.Ex1.m1.4.4.2.4" xref="S4.Ex1.m1.4.4.2.3.cmml"><mi id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex1.m1.4.4.2.4.1" xref="S4.Ex1.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex1.m1.4.4.2.2" xref="S4.Ex1.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.Ex1.m1.8.8.1.1.6" xref="S4.Ex1.m1.8.8.1.1.6.cmml">=</mo><mrow id="S4.Ex1.m1.8.8.1.1.1.1" xref="S4.Ex1.m1.8.8.1.1.1.2.cmml"><mi id="S4.Ex1.m1.7.7" xref="S4.Ex1.m1.7.7.cmml">Tr</mi><mo id="S4.Ex1.m1.8.8.1.1.1.1a" xref="S4.Ex1.m1.8.8.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex1.m1.8.8.1.1.1.1.1" xref="S4.Ex1.m1.8.8.1.1.1.2.cmml"><mo id="S4.Ex1.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S4.Ex1.m1.8.8.1.1.1.2.cmml">(</mo><mrow id="S4.Ex1.m1.8.8.1.1.1.1.1.1" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.cmml"><msup id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.2" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.2.cmml">𝑨</mi><mi id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.3" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.Ex1.m1.8.8.1.1.1.1.1.1.1" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex1.m1.8.8.1.1.1.1.1.1.3" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.3.cmml">𝑩</mi></mrow><mo id="S4.Ex1.m1.8.8.1.1.1.1.1.3" stretchy="false" xref="S4.Ex1.m1.8.8.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.Ex1.m1.8.8.1.2" xref="S4.Ex1.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.8b"><apply id="S4.Ex1.m1.8.8.1.1.cmml" xref="S4.Ex1.m1.8.8.1"><and id="S4.Ex1.m1.8.8.1.1a.cmml" xref="S4.Ex1.m1.8.8.1"></and><apply id="S4.Ex1.m1.8.8.1.1b.cmml" xref="S4.Ex1.m1.8.8.1"><eq id="S4.Ex1.m1.8.8.1.1.4.cmml" xref="S4.Ex1.m1.8.8.1.1.4"></eq><list id="S4.Ex1.m1.8.8.1.1.3.1.cmml" xref="S4.Ex1.m1.8.8.1.1.3.2"><ci id="S4.Ex1.m1.5.5.cmml" xref="S4.Ex1.m1.5.5">𝑨</ci><ci id="S4.Ex1.m1.6.6.cmml" xref="S4.Ex1.m1.6.6">𝑩</ci></list><apply id="S4.Ex1.m1.8.8.1.1.5.cmml" xref="S4.Ex1.m1.8.8.1.1.5"><apply id="S4.Ex1.m1.8.8.1.1.5.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.5.1.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1">superscript</csymbol><apply id="S4.Ex1.m1.8.8.1.1.5.1.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.5.1.2.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1">subscript</csymbol><sum id="S4.Ex1.m1.8.8.1.1.5.1.2.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1.2.2"></sum><apply id="S4.Ex1.m1.8.8.1.1.5.1.2.3.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3"><eq id="S4.Ex1.m1.8.8.1.1.5.1.2.3.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.1"></eq><ci id="S4.Ex1.m1.8.8.1.1.5.1.2.3.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.2">𝑖</ci><cn id="S4.Ex1.m1.8.8.1.1.5.1.2.3.3.cmml" type="integer" xref="S4.Ex1.m1.8.8.1.1.5.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex1.m1.8.8.1.1.5.1.3.cmml" xref="S4.Ex1.m1.8.8.1.1.5.1.3">𝑚</ci></apply><apply id="S4.Ex1.m1.8.8.1.1.5.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2"><apply id="S4.Ex1.m1.8.8.1.1.5.2.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.5.2.1.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1">superscript</csymbol><apply id="S4.Ex1.m1.8.8.1.1.5.2.1.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.5.2.1.2.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1">subscript</csymbol><sum id="S4.Ex1.m1.8.8.1.1.5.2.1.2.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.2"></sum><apply id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3"><eq id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.1"></eq><ci id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.2">𝑗</ci><cn id="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.3.cmml" type="integer" xref="S4.Ex1.m1.8.8.1.1.5.2.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex1.m1.8.8.1.1.5.2.1.3.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.1.3">𝑛</ci></apply><apply id="S4.Ex1.m1.8.8.1.1.5.2.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2"><times id="S4.Ex1.m1.8.8.1.1.5.2.2.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.1"></times><apply id="S4.Ex1.m1.8.8.1.1.5.2.2.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.5.2.2.2.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.2">subscript</csymbol><ci id="S4.Ex1.m1.8.8.1.1.5.2.2.2.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.2.2">𝐴</ci><list id="S4.Ex1.m1.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.4"><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex1.m1.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S4.Ex1.m1.8.8.1.1.5.2.2.3.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.5.2.2.3.1.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.3">subscript</csymbol><ci id="S4.Ex1.m1.8.8.1.1.5.2.2.3.2.cmml" xref="S4.Ex1.m1.8.8.1.1.5.2.2.3.2">𝐵</ci><list id="S4.Ex1.m1.4.4.2.3.cmml" xref="S4.Ex1.m1.4.4.2.4"><ci id="S4.Ex1.m1.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex1.m1.4.4.2.2.cmml" xref="S4.Ex1.m1.4.4.2.2">𝑗</ci></list></apply></apply></apply></apply></apply><apply id="S4.Ex1.m1.8.8.1.1c.cmml" xref="S4.Ex1.m1.8.8.1"><eq id="S4.Ex1.m1.8.8.1.1.6.cmml" xref="S4.Ex1.m1.8.8.1.1.6"></eq><share href="https://arxiv.org/html/2408.00801v1#S4.Ex1.m1.8.8.1.1.5.cmml" id="S4.Ex1.m1.8.8.1.1d.cmml" xref="S4.Ex1.m1.8.8.1"></share><apply id="S4.Ex1.m1.8.8.1.1.1.2.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1"><ci id="S4.Ex1.m1.7.7.cmml" xref="S4.Ex1.m1.7.7">Tr</ci><apply id="S4.Ex1.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1"><times id="S4.Ex1.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.1"></times><apply id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.2">𝑨</ci><ci id="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S4.Ex1.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.8.8.1.1.1.1.1.1.3">𝑩</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.8c">\langle{\bm{A}},{\bm{B}}\rangle=\sum_{i=1}^{m}\sum_{j=1}^{n}{A}_{i,j}{B}_{i,j}%
=\operatorname{Tr}({\bm{A}}^{T}{\bm{B}}),</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.8d">⟨ bold_italic_A , bold_italic_B ⟩ = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_A start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = roman_Tr ( bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_B ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.1.p1.2">and the circular shift invariance property of the trace operator <cite class="ltx_cite ltx_citemacro_citep">(Petersen and Pedersen, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib29" title="">2012</a>, Section 1.1)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{Tr}({\bm{A}}{\bm{B}}{\bm{C}})=\operatorname{Tr}({\bm{B}}{\bm{C}}%
{\bm{A}})" class="ltx_Math" display="block" id="S4.Ex2.m1.4"><semantics id="S4.Ex2.m1.4a"><mrow id="S4.Ex2.m1.4.4" xref="S4.Ex2.m1.4.4.cmml"><mrow id="S4.Ex2.m1.3.3.1.1" xref="S4.Ex2.m1.3.3.1.2.cmml"><mi id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml">Tr</mi><mo id="S4.Ex2.m1.3.3.1.1a" xref="S4.Ex2.m1.3.3.1.2.cmml">⁡</mo><mrow id="S4.Ex2.m1.3.3.1.1.1" xref="S4.Ex2.m1.3.3.1.2.cmml"><mo id="S4.Ex2.m1.3.3.1.1.1.2" stretchy="false" xref="S4.Ex2.m1.3.3.1.2.cmml">(</mo><mrow id="S4.Ex2.m1.3.3.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.cmml"><mi id="S4.Ex2.m1.3.3.1.1.1.1.2" xref="S4.Ex2.m1.3.3.1.1.1.1.2.cmml">𝑨</mi><mo id="S4.Ex2.m1.3.3.1.1.1.1.1" xref="S4.Ex2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex2.m1.3.3.1.1.1.1.3" xref="S4.Ex2.m1.3.3.1.1.1.1.3.cmml">𝑩</mi><mo id="S4.Ex2.m1.3.3.1.1.1.1.1a" xref="S4.Ex2.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex2.m1.3.3.1.1.1.1.4" xref="S4.Ex2.m1.3.3.1.1.1.1.4.cmml">𝑪</mi></mrow><mo id="S4.Ex2.m1.3.3.1.1.1.3" stretchy="false" xref="S4.Ex2.m1.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex2.m1.4.4.3" xref="S4.Ex2.m1.4.4.3.cmml">=</mo><mrow id="S4.Ex2.m1.4.4.2.1" xref="S4.Ex2.m1.4.4.2.2.cmml"><mi id="S4.Ex2.m1.2.2" xref="S4.Ex2.m1.2.2.cmml">Tr</mi><mo id="S4.Ex2.m1.4.4.2.1a" xref="S4.Ex2.m1.4.4.2.2.cmml">⁡</mo><mrow id="S4.Ex2.m1.4.4.2.1.1" xref="S4.Ex2.m1.4.4.2.2.cmml"><mo id="S4.Ex2.m1.4.4.2.1.1.2" stretchy="false" xref="S4.Ex2.m1.4.4.2.2.cmml">(</mo><mrow id="S4.Ex2.m1.4.4.2.1.1.1" xref="S4.Ex2.m1.4.4.2.1.1.1.cmml"><mi id="S4.Ex2.m1.4.4.2.1.1.1.2" xref="S4.Ex2.m1.4.4.2.1.1.1.2.cmml">𝑩</mi><mo id="S4.Ex2.m1.4.4.2.1.1.1.1" xref="S4.Ex2.m1.4.4.2.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex2.m1.4.4.2.1.1.1.3" xref="S4.Ex2.m1.4.4.2.1.1.1.3.cmml">𝑪</mi><mo id="S4.Ex2.m1.4.4.2.1.1.1.1a" xref="S4.Ex2.m1.4.4.2.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex2.m1.4.4.2.1.1.1.4" xref="S4.Ex2.m1.4.4.2.1.1.1.4.cmml">𝑨</mi></mrow><mo id="S4.Ex2.m1.4.4.2.1.1.3" stretchy="false" xref="S4.Ex2.m1.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.4b"><apply id="S4.Ex2.m1.4.4.cmml" xref="S4.Ex2.m1.4.4"><eq id="S4.Ex2.m1.4.4.3.cmml" xref="S4.Ex2.m1.4.4.3"></eq><apply id="S4.Ex2.m1.3.3.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1"><ci id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1">Tr</ci><apply id="S4.Ex2.m1.3.3.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1"><times id="S4.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.1"></times><ci id="S4.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.2">𝑨</ci><ci id="S4.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.3">𝑩</ci><ci id="S4.Ex2.m1.3.3.1.1.1.1.4.cmml" xref="S4.Ex2.m1.3.3.1.1.1.1.4">𝑪</ci></apply></apply><apply id="S4.Ex2.m1.4.4.2.2.cmml" xref="S4.Ex2.m1.4.4.2.1"><ci id="S4.Ex2.m1.2.2.cmml" xref="S4.Ex2.m1.2.2">Tr</ci><apply id="S4.Ex2.m1.4.4.2.1.1.1.cmml" xref="S4.Ex2.m1.4.4.2.1.1.1"><times id="S4.Ex2.m1.4.4.2.1.1.1.1.cmml" xref="S4.Ex2.m1.4.4.2.1.1.1.1"></times><ci id="S4.Ex2.m1.4.4.2.1.1.1.2.cmml" xref="S4.Ex2.m1.4.4.2.1.1.1.2">𝑩</ci><ci id="S4.Ex2.m1.4.4.2.1.1.1.3.cmml" xref="S4.Ex2.m1.4.4.2.1.1.1.3">𝑪</ci><ci id="S4.Ex2.m1.4.4.2.1.1.1.4.cmml" xref="S4.Ex2.m1.4.4.2.1.1.1.4">𝑨</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.4c">\operatorname{Tr}({\bm{A}}{\bm{B}}{\bm{C}})=\operatorname{Tr}({\bm{B}}{\bm{C}}%
{\bm{A}})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.4d">roman_Tr ( bold_italic_A bold_italic_B bold_italic_C ) = roman_Tr ( bold_italic_B bold_italic_C bold_italic_A )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.2.p2">
<p class="ltx_p" id="S4.SS1.2.p2.2">For any <math alttext="1\leq i,j\leq m" class="ltx_Math" display="inline" id="S4.SS1.2.p2.1.m1.2"><semantics id="S4.SS1.2.p2.1.m1.2a"><mrow id="S4.SS1.2.p2.1.m1.2.2.2" xref="S4.SS1.2.p2.1.m1.2.2.3.cmml"><mrow id="S4.SS1.2.p2.1.m1.1.1.1.1" xref="S4.SS1.2.p2.1.m1.1.1.1.1.cmml"><mn id="S4.SS1.2.p2.1.m1.1.1.1.1.2" xref="S4.SS1.2.p2.1.m1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.2.p2.1.m1.1.1.1.1.1" xref="S4.SS1.2.p2.1.m1.1.1.1.1.1.cmml">≤</mo><mi id="S4.SS1.2.p2.1.m1.1.1.1.1.3" xref="S4.SS1.2.p2.1.m1.1.1.1.1.3.cmml">i</mi></mrow><mo id="S4.SS1.2.p2.1.m1.2.2.2.3" xref="S4.SS1.2.p2.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.SS1.2.p2.1.m1.2.2.2.2" xref="S4.SS1.2.p2.1.m1.2.2.2.2.cmml"><mi id="S4.SS1.2.p2.1.m1.2.2.2.2.2" xref="S4.SS1.2.p2.1.m1.2.2.2.2.2.cmml">j</mi><mo id="S4.SS1.2.p2.1.m1.2.2.2.2.1" xref="S4.SS1.2.p2.1.m1.2.2.2.2.1.cmml">≤</mo><mi id="S4.SS1.2.p2.1.m1.2.2.2.2.3" xref="S4.SS1.2.p2.1.m1.2.2.2.2.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.2.p2.1.m1.2b"><apply id="S4.SS1.2.p2.1.m1.2.2.3.cmml" xref="S4.SS1.2.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.2.p2.1.m1.2.2.3a.cmml" xref="S4.SS1.2.p2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS1.2.p2.1.m1.1.1.1.1"><leq id="S4.SS1.2.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.1.m1.1.1.1.1.1"></leq><cn id="S4.SS1.2.p2.1.m1.1.1.1.1.2.cmml" type="integer" xref="S4.SS1.2.p2.1.m1.1.1.1.1.2">1</cn><ci id="S4.SS1.2.p2.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.2.p2.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.2.p2.1.m1.2.2.2.2.cmml" xref="S4.SS1.2.p2.1.m1.2.2.2.2"><leq id="S4.SS1.2.p2.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.2.p2.1.m1.2.2.2.2.1"></leq><ci id="S4.SS1.2.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.2.p2.1.m1.2.2.2.2.2">𝑗</ci><ci id="S4.SS1.2.p2.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.2.p2.1.m1.2.2.2.2.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.p2.1.m1.2c">1\leq i,j\leq m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.p2.1.m1.2d">1 ≤ italic_i , italic_j ≤ italic_m</annotation></semantics></math> it holds that <math alttext="\langle{\bm{A}}_{i,:},{\bm{A}}_{j,:}\rangle=({\bm{A}}{\bm{A}}^{T})_{i,j}" class="ltx_Math" display="inline" id="S4.SS1.2.p2.2.m2.9"><semantics id="S4.SS1.2.p2.2.m2.9a"><mrow id="S4.SS1.2.p2.2.m2.9.9" xref="S4.SS1.2.p2.2.m2.9.9.cmml"><mrow id="S4.SS1.2.p2.2.m2.8.8.2.2" xref="S4.SS1.2.p2.2.m2.8.8.2.3.cmml"><mo id="S4.SS1.2.p2.2.m2.8.8.2.2.3" stretchy="false" xref="S4.SS1.2.p2.2.m2.8.8.2.3.cmml">⟨</mo><msub id="S4.SS1.2.p2.2.m2.7.7.1.1.1" xref="S4.SS1.2.p2.2.m2.7.7.1.1.1.cmml"><mi id="S4.SS1.2.p2.2.m2.7.7.1.1.1.2" xref="S4.SS1.2.p2.2.m2.7.7.1.1.1.2.cmml">𝑨</mi><mrow id="S4.SS1.2.p2.2.m2.2.2.2.4" xref="S4.SS1.2.p2.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.2.p2.2.m2.1.1.1.1" xref="S4.SS1.2.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.2.p2.2.m2.2.2.2.4.1" xref="S4.SS1.2.p2.2.m2.2.2.2.3.cmml">,</mo><mo id="S4.SS1.2.p2.2.m2.2.2.2.2" xref="S4.SS1.2.p2.2.m2.2.2.2.2.cmml">:</mo></mrow></msub><mo id="S4.SS1.2.p2.2.m2.8.8.2.2.4" xref="S4.SS1.2.p2.2.m2.8.8.2.3.cmml">,</mo><msub id="S4.SS1.2.p2.2.m2.8.8.2.2.2" xref="S4.SS1.2.p2.2.m2.8.8.2.2.2.cmml"><mi id="S4.SS1.2.p2.2.m2.8.8.2.2.2.2" xref="S4.SS1.2.p2.2.m2.8.8.2.2.2.2.cmml">𝑨</mi><mrow id="S4.SS1.2.p2.2.m2.4.4.2.4" xref="S4.SS1.2.p2.2.m2.4.4.2.3.cmml"><mi id="S4.SS1.2.p2.2.m2.3.3.1.1" xref="S4.SS1.2.p2.2.m2.3.3.1.1.cmml">j</mi><mo id="S4.SS1.2.p2.2.m2.4.4.2.4.1" xref="S4.SS1.2.p2.2.m2.4.4.2.3.cmml">,</mo><mo id="S4.SS1.2.p2.2.m2.4.4.2.2" xref="S4.SS1.2.p2.2.m2.4.4.2.2.cmml">:</mo></mrow></msub><mo id="S4.SS1.2.p2.2.m2.8.8.2.2.5" stretchy="false" xref="S4.SS1.2.p2.2.m2.8.8.2.3.cmml">⟩</mo></mrow><mo id="S4.SS1.2.p2.2.m2.9.9.4" xref="S4.SS1.2.p2.2.m2.9.9.4.cmml">=</mo><msub id="S4.SS1.2.p2.2.m2.9.9.3" xref="S4.SS1.2.p2.2.m2.9.9.3.cmml"><mrow id="S4.SS1.2.p2.2.m2.9.9.3.1.1" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.cmml"><mo id="S4.SS1.2.p2.2.m2.9.9.3.1.1.2" stretchy="false" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.cmml">(</mo><mrow id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.cmml"><mi id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.2" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.2.cmml">𝑨</mi><mo id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.1" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.cmml"><mi id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.2" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.2.cmml">𝑨</mi><mi id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.3" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S4.SS1.2.p2.2.m2.9.9.3.1.1.3" stretchy="false" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.2.p2.2.m2.6.6.2.4" xref="S4.SS1.2.p2.2.m2.6.6.2.3.cmml"><mi id="S4.SS1.2.p2.2.m2.5.5.1.1" xref="S4.SS1.2.p2.2.m2.5.5.1.1.cmml">i</mi><mo id="S4.SS1.2.p2.2.m2.6.6.2.4.1" xref="S4.SS1.2.p2.2.m2.6.6.2.3.cmml">,</mo><mi id="S4.SS1.2.p2.2.m2.6.6.2.2" xref="S4.SS1.2.p2.2.m2.6.6.2.2.cmml">j</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.2.p2.2.m2.9b"><apply id="S4.SS1.2.p2.2.m2.9.9.cmml" xref="S4.SS1.2.p2.2.m2.9.9"><eq id="S4.SS1.2.p2.2.m2.9.9.4.cmml" xref="S4.SS1.2.p2.2.m2.9.9.4"></eq><list id="S4.SS1.2.p2.2.m2.8.8.2.3.cmml" xref="S4.SS1.2.p2.2.m2.8.8.2.2"><apply id="S4.SS1.2.p2.2.m2.7.7.1.1.1.cmml" xref="S4.SS1.2.p2.2.m2.7.7.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.2.p2.2.m2.7.7.1.1.1.1.cmml" xref="S4.SS1.2.p2.2.m2.7.7.1.1.1">subscript</csymbol><ci id="S4.SS1.2.p2.2.m2.7.7.1.1.1.2.cmml" xref="S4.SS1.2.p2.2.m2.7.7.1.1.1.2">𝑨</ci><list id="S4.SS1.2.p2.2.m2.2.2.2.3.cmml" xref="S4.SS1.2.p2.2.m2.2.2.2.4"><ci id="S4.SS1.2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS1.2.p2.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.2.p2.2.m2.2.2.2.2.cmml" xref="S4.SS1.2.p2.2.m2.2.2.2.2">:</ci></list></apply><apply id="S4.SS1.2.p2.2.m2.8.8.2.2.2.cmml" xref="S4.SS1.2.p2.2.m2.8.8.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.2.p2.2.m2.8.8.2.2.2.1.cmml" xref="S4.SS1.2.p2.2.m2.8.8.2.2.2">subscript</csymbol><ci id="S4.SS1.2.p2.2.m2.8.8.2.2.2.2.cmml" xref="S4.SS1.2.p2.2.m2.8.8.2.2.2.2">𝑨</ci><list id="S4.SS1.2.p2.2.m2.4.4.2.3.cmml" xref="S4.SS1.2.p2.2.m2.4.4.2.4"><ci id="S4.SS1.2.p2.2.m2.3.3.1.1.cmml" xref="S4.SS1.2.p2.2.m2.3.3.1.1">𝑗</ci><ci id="S4.SS1.2.p2.2.m2.4.4.2.2.cmml" xref="S4.SS1.2.p2.2.m2.4.4.2.2">:</ci></list></apply></list><apply id="S4.SS1.2.p2.2.m2.9.9.3.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3"><csymbol cd="ambiguous" id="S4.SS1.2.p2.2.m2.9.9.3.2.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3">subscript</csymbol><apply id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1"><times id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.1.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.1"></times><ci id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.2.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.2">𝑨</ci><apply id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.1.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3">superscript</csymbol><ci id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.2.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.2">𝑨</ci><ci id="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.3.cmml" xref="S4.SS1.2.p2.2.m2.9.9.3.1.1.1.3.3">𝑇</ci></apply></apply><list id="S4.SS1.2.p2.2.m2.6.6.2.3.cmml" xref="S4.SS1.2.p2.2.m2.6.6.2.4"><ci id="S4.SS1.2.p2.2.m2.5.5.1.1.cmml" xref="S4.SS1.2.p2.2.m2.5.5.1.1">𝑖</ci><ci id="S4.SS1.2.p2.2.m2.6.6.2.2.cmml" xref="S4.SS1.2.p2.2.m2.6.6.2.2">𝑗</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.p2.2.m2.9c">\langle{\bm{A}}_{i,:},{\bm{A}}_{j,:}\rangle=({\bm{A}}{\bm{A}}^{T})_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.p2.2.m2.9d">⟨ bold_italic_A start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT , bold_italic_A start_POSTSUBSCRIPT italic_j , : end_POSTSUBSCRIPT ⟩ = ( bold_italic_A bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, and thus</p>
<table class="ltx_equation ltx_eqn_table" id="S4.SS1.2.p2.3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{A}}_{i,:},{\bm{A}}_{j,:}\rangle{Q}_{i,%
j}\\
=\sum_{i=1}^{m}\sum_{j=1}^{m}\left({\bm{A}}{\bm{A}}^{T}\right)_{i,j}{Q}_{i,j}=%
\langle{\bm{A}}{\bm{A}}^{T},{\bm{Q}}\rangle=\operatorname{Tr}({\bm{A}}{\bm{A}}%
^{T}{\bm{Q}})," class="ltx_Math" display="block" id="S4.SS1.2.p2.3.m1.51"><semantics id="S4.SS1.2.p2.3.m1.51a"><mtable displaystyle="true" id="S4.SS1.2.p2.3.m1.51.51.4" rowspacing="0pt"><mtr id="S4.SS1.2.p2.3.m1.51.51.4a"><mtd class="ltx_align_left" columnalign="left" id="S4.SS1.2.p2.3.m1.51.51.4b"><mrow id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17"><munderover id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.18"><mo id="S4.SS1.2.p2.3.m1.1.1.1.1.1.1" movablelimits="false" xref="S4.SS1.2.p2.3.m1.1.1.1.1.1.1.cmml">∑</mo><mrow id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.2" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.1" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.1.cmml">=</mo><mn id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.3" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mi id="S4.SS1.2.p2.3.m1.3.3.3.3.3.3.1" xref="S4.SS1.2.p2.3.m1.3.3.3.3.3.3.1.cmml">m</mi></munderover><mrow id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17"><munderover id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17.3"><mo id="S4.SS1.2.p2.3.m1.4.4.4.4.4.4" lspace="0.167em" movablelimits="false" rspace="0em" xref="S4.SS1.2.p2.3.m1.4.4.4.4.4.4.cmml">∑</mo><mrow id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.cmml"><mi id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.2" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.2.cmml">j</mi><mo id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.1" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.1.cmml">=</mo><mn id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.3" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.3.cmml">1</mn></mrow><mi id="S4.SS1.2.p2.3.m1.6.6.6.6.6.6.1" xref="S4.SS1.2.p2.3.m1.6.6.6.6.6.6.1.cmml">m</mi></munderover><mrow id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17.2"><mrow id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17.2.2.2"><mo id="S4.SS1.2.p2.3.m1.7.7.7.7.7.7" stretchy="false" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⟨</mo><msub id="S4.SS1.2.p2.3.m1.49.49.2.48.16.16.16.1.1.1.1"><mi id="S4.SS1.2.p2.3.m1.8.8.8.8.8.8" xref="S4.SS1.2.p2.3.m1.8.8.8.8.8.8.cmml">𝑨</mi><mrow id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.4" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.3.cmml"><mi id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.1" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.1.cmml">i</mi><mo id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.4.1" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.3.cmml">,</mo><mo id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.2" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.2.cmml">:</mo></mrow></msub><mo id="S4.SS1.2.p2.3.m1.10.10.10.10.10.10" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">,</mo><msub id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17.2.2.2.2"><mi id="S4.SS1.2.p2.3.m1.11.11.11.11.11.11" xref="S4.SS1.2.p2.3.m1.11.11.11.11.11.11.cmml">𝑨</mi><mrow id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.4" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.3.cmml"><mi id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.1" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.1.cmml">j</mi><mo id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.4.1" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.3.cmml">,</mo><mo id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.2" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.2.cmml">:</mo></mrow></msub><mo id="S4.SS1.2.p2.3.m1.13.13.13.13.13.13" stretchy="false" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⟩</mo></mrow><mo id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17.2.3" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁢</mo><msub id="S4.SS1.2.p2.3.m1.50.50.3.49.17.17.17.2.4"><mi id="S4.SS1.2.p2.3.m1.14.14.14.14.14.14" xref="S4.SS1.2.p2.3.m1.14.14.14.14.14.14.cmml">Q</mi><mrow id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.4" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.3.cmml"><mi id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.1" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.1.cmml">i</mi><mo id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.4.1" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.3.cmml">,</mo><mi id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.2" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mtd></mtr><mtr id="S4.SS1.2.p2.3.m1.51.51.4c"><mtd class="ltx_align_right" columnalign="right" id="S4.SS1.2.p2.3.m1.51.51.4d"><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33"><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1"><mi id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.5" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml"></mi><mo id="S4.SS1.2.p2.3.m1.16.16.16.1.1.1" rspace="0.111em" xref="S4.SS1.2.p2.3.m1.16.16.16.1.1.1.cmml">=</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1"><munderover id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.2"><mo id="S4.SS1.2.p2.3.m1.17.17.17.2.2.2" movablelimits="false" rspace="0em" xref="S4.SS1.2.p2.3.m1.17.17.17.2.2.2.cmml">∑</mo><mrow id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.cmml"><mi id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.2" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.2.cmml">i</mi><mo id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.1" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.1.cmml">=</mo><mn id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.3" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.3.cmml">1</mn></mrow><mi id="S4.SS1.2.p2.3.m1.19.19.19.4.4.4.1" xref="S4.SS1.2.p2.3.m1.19.19.19.4.4.4.1.cmml">m</mi></munderover><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1"><munderover id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.2"><mo id="S4.SS1.2.p2.3.m1.20.20.20.5.5.5" movablelimits="false" rspace="0em" xref="S4.SS1.2.p2.3.m1.20.20.20.5.5.5.cmml">∑</mo><mrow id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.cmml"><mi id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.2" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.2.cmml">j</mi><mo id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.1" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.1.cmml">=</mo><mn id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.3" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.3.cmml">1</mn></mrow><mi id="S4.SS1.2.p2.3.m1.22.22.22.7.7.7.1" xref="S4.SS1.2.p2.3.m1.22.22.22.7.7.7.1.cmml">m</mi></munderover><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1"><msub id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.1"><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.1.1.1"><mo id="S4.SS1.2.p2.3.m1.23.23.23.8.8.8" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">(</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.1.1.1.1"><mi id="S4.SS1.2.p2.3.m1.24.24.24.9.9.9" xref="S4.SS1.2.p2.3.m1.24.24.24.9.9.9.cmml">𝑨</mi><mo id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.1.1.1.1.1" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁢</mo><msup id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.1.1.1.1.2"><mi id="S4.SS1.2.p2.3.m1.25.25.25.10.10.10" xref="S4.SS1.2.p2.3.m1.25.25.25.10.10.10.cmml">𝑨</mi><mi id="S4.SS1.2.p2.3.m1.26.26.26.11.11.11.1" xref="S4.SS1.2.p2.3.m1.26.26.26.11.11.11.1.cmml">T</mi></msup></mrow><mo id="S4.SS1.2.p2.3.m1.27.27.27.12.12.12" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.4" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.3.cmml"><mi id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.1" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.1.cmml">i</mi><mo id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.4.1" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.3.cmml">,</mo><mi id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.2" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.2.cmml">j</mi></mrow></msub><mo id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.2" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁢</mo><msub id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.1.1.1.3"><mi id="S4.SS1.2.p2.3.m1.29.29.29.14.14.14" xref="S4.SS1.2.p2.3.m1.29.29.29.14.14.14.cmml">Q</mi><mrow id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.4" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.3.cmml"><mi id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.1" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.1.cmml">i</mi><mo id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.4.1" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.3.cmml">,</mo><mi id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.2" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.SS1.2.p2.3.m1.31.31.31.16.16.16" xref="S4.SS1.2.p2.3.m1.31.31.31.16.16.16.cmml">=</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.2.1"><mo id="S4.SS1.2.p2.3.m1.32.32.32.17.17.17" stretchy="false" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⟨</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.2.1.1"><mi id="S4.SS1.2.p2.3.m1.33.33.33.18.18.18" xref="S4.SS1.2.p2.3.m1.33.33.33.18.18.18.cmml">𝑨</mi><mo id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.2.1.1.1" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁢</mo><msup id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.2.1.1.2"><mi id="S4.SS1.2.p2.3.m1.34.34.34.19.19.19" xref="S4.SS1.2.p2.3.m1.34.34.34.19.19.19.cmml">𝑨</mi><mi id="S4.SS1.2.p2.3.m1.35.35.35.20.20.20.1" xref="S4.SS1.2.p2.3.m1.35.35.35.20.20.20.1.cmml">T</mi></msup></mrow><mo id="S4.SS1.2.p2.3.m1.36.36.36.21.21.21" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">,</mo><mi id="S4.SS1.2.p2.3.m1.37.37.37.22.22.22" xref="S4.SS1.2.p2.3.m1.37.37.37.22.22.22.cmml">𝑸</mi><mo id="S4.SS1.2.p2.3.m1.38.38.38.23.23.23" stretchy="false" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⟩</mo></mrow><mo id="S4.SS1.2.p2.3.m1.39.39.39.24.24.24" xref="S4.SS1.2.p2.3.m1.39.39.39.24.24.24.cmml">=</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1"><mi id="S4.SS1.2.p2.3.m1.40.40.40.25.25.25" xref="S4.SS1.2.p2.3.m1.40.40.40.25.25.25.cmml">Tr</mi><mo id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1a" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁡</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1.1"><mo id="S4.SS1.2.p2.3.m1.41.41.41.26.26.26" stretchy="false" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">(</mo><mrow id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1.1.1"><mi id="S4.SS1.2.p2.3.m1.42.42.42.27.27.27" xref="S4.SS1.2.p2.3.m1.42.42.42.27.27.27.cmml">𝑨</mi><mo id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1.1.1.1" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁢</mo><msup id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1.1.1.2"><mi id="S4.SS1.2.p2.3.m1.43.43.43.28.28.28" xref="S4.SS1.2.p2.3.m1.43.43.43.28.28.28.cmml">𝑨</mi><mi id="S4.SS1.2.p2.3.m1.44.44.44.29.29.29.1" xref="S4.SS1.2.p2.3.m1.44.44.44.29.29.29.1.cmml">T</mi></msup><mo id="S4.SS1.2.p2.3.m1.51.51.4.50.33.33.33.1.3.1.1.1.1a" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">⁢</mo><mi id="S4.SS1.2.p2.3.m1.45.45.45.30.30.30" xref="S4.SS1.2.p2.3.m1.45.45.45.30.30.30.cmml">𝑸</mi></mrow><mo id="S4.SS1.2.p2.3.m1.46.46.46.31.31.31" stretchy="false" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS1.2.p2.3.m1.47.47.47.32.32.32" xref="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.SS1.2.p2.3.m1.51b"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><and id="S4.SS1.2.p2.3.m1.48.48.1.1.1a.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></and><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1b.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><eq id="S4.SS1.2.p2.3.m1.16.16.16.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.16.16.16.1.1.1"></eq><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.3.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.3.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><sum id="S4.SS1.2.p2.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.1.1.1.1.1.1"></sum><apply id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.cmml" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1"><eq id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.1"></eq><ci id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.2">𝑖</ci><cn id="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S4.SS1.2.p2.3.m1.2.2.2.2.2.2.1.3">1</cn></apply></apply><ci id="S4.SS1.2.p2.3.m1.3.3.3.3.3.3.1.cmml" xref="S4.SS1.2.p2.3.m1.3.3.3.3.3.3.1">𝑚</ci></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.3.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.3.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><sum id="S4.SS1.2.p2.3.m1.4.4.4.4.4.4.cmml" xref="S4.SS1.2.p2.3.m1.4.4.4.4.4.4"></sum><apply id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.cmml" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1"><eq id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.1.cmml" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.1"></eq><ci id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.2.cmml" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.2">𝑗</ci><cn id="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.3.cmml" type="integer" xref="S4.SS1.2.p2.3.m1.5.5.5.5.5.5.1.3">1</cn></apply></apply><ci id="S4.SS1.2.p2.3.m1.6.6.6.6.6.6.1.cmml" xref="S4.SS1.2.p2.3.m1.6.6.6.6.6.6.1">𝑚</ci></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><times id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></times><list id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.2.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><ci id="S4.SS1.2.p2.3.m1.8.8.8.8.8.8.cmml" xref="S4.SS1.2.p2.3.m1.8.8.8.8.8.8">𝑨</ci><list id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.3.cmml" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.4"><ci id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.1.cmml" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.1">𝑖</ci><ci id="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.2.cmml" xref="S4.SS1.2.p2.3.m1.9.9.9.9.9.9.1.2">:</ci></list></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.2.2.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><ci id="S4.SS1.2.p2.3.m1.11.11.11.11.11.11.cmml" xref="S4.SS1.2.p2.3.m1.11.11.11.11.11.11">𝑨</ci><list id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.3.cmml" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.4"><ci id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.1.cmml" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.1">𝑗</ci><ci id="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.2.cmml" xref="S4.SS1.2.p2.3.m1.12.12.12.12.12.12.1.2">:</ci></list></apply></list><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.4.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.2.2.2.4.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><ci id="S4.SS1.2.p2.3.m1.14.14.14.14.14.14.cmml" xref="S4.SS1.2.p2.3.m1.14.14.14.14.14.14">𝑄</ci><list id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.3.cmml" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.4"><ci id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.1.cmml" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.1">𝑖</ci><ci id="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.2.cmml" xref="S4.SS1.2.p2.3.m1.15.15.15.15.15.15.1.2">𝑗</ci></list></apply></apply></apply></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.2.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.2.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><sum id="S4.SS1.2.p2.3.m1.17.17.17.2.2.2.cmml" xref="S4.SS1.2.p2.3.m1.17.17.17.2.2.2"></sum><apply id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.cmml" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1"><eq id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.1.cmml" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.1"></eq><ci id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.2.cmml" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.2">𝑖</ci><cn id="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.3.cmml" type="integer" xref="S4.SS1.2.p2.3.m1.18.18.18.3.3.3.1.3">1</cn></apply></apply><ci id="S4.SS1.2.p2.3.m1.19.19.19.4.4.4.1.cmml" xref="S4.SS1.2.p2.3.m1.19.19.19.4.4.4.1">𝑚</ci></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.2.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.2.2.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><sum id="S4.SS1.2.p2.3.m1.20.20.20.5.5.5.cmml" xref="S4.SS1.2.p2.3.m1.20.20.20.5.5.5"></sum><apply id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.cmml" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1"><eq id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.1.cmml" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.1"></eq><ci id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.2.cmml" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.2">𝑗</ci><cn id="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.3.cmml" type="integer" xref="S4.SS1.2.p2.3.m1.21.21.21.6.6.6.1.3">1</cn></apply></apply><ci id="S4.SS1.2.p2.3.m1.22.22.22.7.7.7.1.cmml" xref="S4.SS1.2.p2.3.m1.22.22.22.7.7.7.1">𝑚</ci></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><times id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></times><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.1.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><times id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></times><ci id="S4.SS1.2.p2.3.m1.24.24.24.9.9.9.cmml" xref="S4.SS1.2.p2.3.m1.24.24.24.9.9.9">𝑨</ci><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><ci id="S4.SS1.2.p2.3.m1.25.25.25.10.10.10.cmml" xref="S4.SS1.2.p2.3.m1.25.25.25.10.10.10">𝑨</ci><ci id="S4.SS1.2.p2.3.m1.26.26.26.11.11.11.1.cmml" xref="S4.SS1.2.p2.3.m1.26.26.26.11.11.11.1">𝑇</ci></apply></apply><list id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.3.cmml" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.4"><ci id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.1.cmml" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.1">𝑖</ci><ci id="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.2.cmml" xref="S4.SS1.2.p2.3.m1.28.28.28.13.13.13.1.2">𝑗</ci></list></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.3.1.1.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">subscript</csymbol><ci id="S4.SS1.2.p2.3.m1.29.29.29.14.14.14.cmml" xref="S4.SS1.2.p2.3.m1.29.29.29.14.14.14">𝑄</ci><list id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.3.cmml" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.4"><ci id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.1.cmml" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.1">𝑖</ci><ci id="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.2.cmml" xref="S4.SS1.2.p2.3.m1.30.30.30.15.15.15.1.2">𝑗</ci></list></apply></apply></apply></apply></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1c.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><eq id="S4.SS1.2.p2.3.m1.31.31.31.16.16.16.cmml" xref="S4.SS1.2.p2.3.m1.31.31.31.16.16.16"></eq><share href="https://arxiv.org/html/2408.00801v1#S4.SS1.2.p2.3.m1.48.48.1.1.1.3.cmml" id="S4.SS1.2.p2.3.m1.48.48.1.1.1d.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></share><list id="S4.SS1.2.p2.3.m1.48.48.1.1.1.4.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.4.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><times id="S4.SS1.2.p2.3.m1.48.48.1.1.1.4.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></times><ci id="S4.SS1.2.p2.3.m1.33.33.33.18.18.18.cmml" xref="S4.SS1.2.p2.3.m1.33.33.33.18.18.18">𝑨</ci><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.4.1.1.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.4.1.1.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><ci id="S4.SS1.2.p2.3.m1.34.34.34.19.19.19.cmml" xref="S4.SS1.2.p2.3.m1.34.34.34.19.19.19">𝑨</ci><ci id="S4.SS1.2.p2.3.m1.35.35.35.20.20.20.1.cmml" xref="S4.SS1.2.p2.3.m1.35.35.35.20.20.20.1">𝑇</ci></apply></apply><ci id="S4.SS1.2.p2.3.m1.37.37.37.22.22.22.cmml" xref="S4.SS1.2.p2.3.m1.37.37.37.22.22.22">𝑸</ci></list></apply><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1e.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><eq id="S4.SS1.2.p2.3.m1.39.39.39.24.24.24.cmml" xref="S4.SS1.2.p2.3.m1.39.39.39.24.24.24"></eq><share href="https://arxiv.org/html/2408.00801v1#S4.SS1.2.p2.3.m1.48.48.1.1.1.4.cmml" id="S4.SS1.2.p2.3.m1.48.48.1.1.1f.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></share><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.5.2.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><ci id="S4.SS1.2.p2.3.m1.40.40.40.25.25.25.cmml" xref="S4.SS1.2.p2.3.m1.40.40.40.25.25.25">Tr</ci><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.5.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><times id="S4.SS1.2.p2.3.m1.48.48.1.1.1.5.1.1.1.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"></times><ci id="S4.SS1.2.p2.3.m1.42.42.42.27.27.27.cmml" xref="S4.SS1.2.p2.3.m1.42.42.42.27.27.27">𝑨</ci><apply id="S4.SS1.2.p2.3.m1.48.48.1.1.1.5.1.1.1.3.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7"><csymbol cd="ambiguous" id="S4.SS1.2.p2.3.m1.48.48.1.1.1.5.1.1.1.3.1.cmml" xref="S4.SS1.2.p2.3.m1.7.7.7.7.7.7">superscript</csymbol><ci id="S4.SS1.2.p2.3.m1.43.43.43.28.28.28.cmml" xref="S4.SS1.2.p2.3.m1.43.43.43.28.28.28">𝑨</ci><ci id="S4.SS1.2.p2.3.m1.44.44.44.29.29.29.1.cmml" xref="S4.SS1.2.p2.3.m1.44.44.44.29.29.29.1">𝑇</ci></apply><ci id="S4.SS1.2.p2.3.m1.45.45.45.30.30.30.cmml" xref="S4.SS1.2.p2.3.m1.45.45.45.30.30.30">𝑸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.p2.3.m1.51c">\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{A}}_{i,:},{\bm{A}}_{j,:}\rangle{Q}_{i,%
j}\\
=\sum_{i=1}^{m}\sum_{j=1}^{m}\left({\bm{A}}{\bm{A}}^{T}\right)_{i,j}{Q}_{i,j}=%
\langle{\bm{A}}{\bm{A}}^{T},{\bm{Q}}\rangle=\operatorname{Tr}({\bm{A}}{\bm{A}}%
^{T}{\bm{Q}}),</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.p2.3.m1.51d">start_ROW start_CELL ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_A start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT , bold_italic_A start_POSTSUBSCRIPT italic_j , : end_POSTSUBSCRIPT ⟩ italic_Q start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ( bold_italic_A bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT italic_Q start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = ⟨ bold_italic_A bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT , bold_italic_Q ⟩ = roman_Tr ( bold_italic_A bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_Q ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.2.p2.5">where the last two equalities follow from the definition of the Frobenius inner product, and the fact that <math alttext="{\bm{A}}{\bm{A}}^{T}" class="ltx_Math" display="inline" id="S4.SS1.2.p2.4.m1.1"><semantics id="S4.SS1.2.p2.4.m1.1a"><mrow id="S4.SS1.2.p2.4.m1.1.1" xref="S4.SS1.2.p2.4.m1.1.1.cmml"><mi id="S4.SS1.2.p2.4.m1.1.1.2" xref="S4.SS1.2.p2.4.m1.1.1.2.cmml">𝑨</mi><mo id="S4.SS1.2.p2.4.m1.1.1.1" xref="S4.SS1.2.p2.4.m1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.2.p2.4.m1.1.1.3" xref="S4.SS1.2.p2.4.m1.1.1.3.cmml"><mi id="S4.SS1.2.p2.4.m1.1.1.3.2" xref="S4.SS1.2.p2.4.m1.1.1.3.2.cmml">𝑨</mi><mi id="S4.SS1.2.p2.4.m1.1.1.3.3" xref="S4.SS1.2.p2.4.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.2.p2.4.m1.1b"><apply id="S4.SS1.2.p2.4.m1.1.1.cmml" xref="S4.SS1.2.p2.4.m1.1.1"><times id="S4.SS1.2.p2.4.m1.1.1.1.cmml" xref="S4.SS1.2.p2.4.m1.1.1.1"></times><ci id="S4.SS1.2.p2.4.m1.1.1.2.cmml" xref="S4.SS1.2.p2.4.m1.1.1.2">𝑨</ci><apply id="S4.SS1.2.p2.4.m1.1.1.3.cmml" xref="S4.SS1.2.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.2.p2.4.m1.1.1.3.1.cmml" xref="S4.SS1.2.p2.4.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.2.p2.4.m1.1.1.3.2.cmml" xref="S4.SS1.2.p2.4.m1.1.1.3.2">𝑨</ci><ci id="S4.SS1.2.p2.4.m1.1.1.3.3.cmml" xref="S4.SS1.2.p2.4.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.p2.4.m1.1c">{\bm{A}}{\bm{A}}^{T}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.p2.4.m1.1d">bold_italic_A bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> is symmetric. Finally, the circular shift invariance property implies that <math alttext="\operatorname{Tr}({\bm{A}}{\bm{A}}^{T}{\bm{Q}})=\operatorname{Tr}({\bm{A}}^{T}%
{\bm{Q}}{\bm{A}})" class="ltx_Math" display="inline" id="S4.SS1.2.p2.5.m2.4"><semantics id="S4.SS1.2.p2.5.m2.4a"><mrow id="S4.SS1.2.p2.5.m2.4.4" xref="S4.SS1.2.p2.5.m2.4.4.cmml"><mrow id="S4.SS1.2.p2.5.m2.3.3.1.1" xref="S4.SS1.2.p2.5.m2.3.3.1.2.cmml"><mi id="S4.SS1.2.p2.5.m2.1.1" xref="S4.SS1.2.p2.5.m2.1.1.cmml">Tr</mi><mo id="S4.SS1.2.p2.5.m2.3.3.1.1a" xref="S4.SS1.2.p2.5.m2.3.3.1.2.cmml">⁡</mo><mrow id="S4.SS1.2.p2.5.m2.3.3.1.1.1" xref="S4.SS1.2.p2.5.m2.3.3.1.2.cmml"><mo id="S4.SS1.2.p2.5.m2.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.2.p2.5.m2.3.3.1.2.cmml">(</mo><mrow id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.cmml"><mi id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.2" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.2.cmml">𝑨</mi><mo id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.1" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.cmml"><mi id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.2" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.2.cmml">𝑨</mi><mi id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.3" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.3.cmml">T</mi></msup><mo id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.1a" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.4" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.4.cmml">𝑸</mi></mrow><mo id="S4.SS1.2.p2.5.m2.3.3.1.1.1.3" stretchy="false" xref="S4.SS1.2.p2.5.m2.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.2.p2.5.m2.4.4.3" xref="S4.SS1.2.p2.5.m2.4.4.3.cmml">=</mo><mrow id="S4.SS1.2.p2.5.m2.4.4.2.1" xref="S4.SS1.2.p2.5.m2.4.4.2.2.cmml"><mi id="S4.SS1.2.p2.5.m2.2.2" xref="S4.SS1.2.p2.5.m2.2.2.cmml">Tr</mi><mo id="S4.SS1.2.p2.5.m2.4.4.2.1a" xref="S4.SS1.2.p2.5.m2.4.4.2.2.cmml">⁡</mo><mrow id="S4.SS1.2.p2.5.m2.4.4.2.1.1" xref="S4.SS1.2.p2.5.m2.4.4.2.2.cmml"><mo id="S4.SS1.2.p2.5.m2.4.4.2.1.1.2" stretchy="false" xref="S4.SS1.2.p2.5.m2.4.4.2.2.cmml">(</mo><mrow id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.cmml"><msup id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.cmml"><mi id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.2" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.2.cmml">𝑨</mi><mi id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.3" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.1" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.3" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.3.cmml">𝑸</mi><mo id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.1a" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.1.cmml">⁢</mo><mi id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.4" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.4.cmml">𝑨</mi></mrow><mo id="S4.SS1.2.p2.5.m2.4.4.2.1.1.3" stretchy="false" xref="S4.SS1.2.p2.5.m2.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.2.p2.5.m2.4b"><apply id="S4.SS1.2.p2.5.m2.4.4.cmml" xref="S4.SS1.2.p2.5.m2.4.4"><eq id="S4.SS1.2.p2.5.m2.4.4.3.cmml" xref="S4.SS1.2.p2.5.m2.4.4.3"></eq><apply id="S4.SS1.2.p2.5.m2.3.3.1.2.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1"><ci id="S4.SS1.2.p2.5.m2.1.1.cmml" xref="S4.SS1.2.p2.5.m2.1.1">Tr</ci><apply id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1"><times id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.1"></times><ci id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.2">𝑨</ci><apply id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.1.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3">superscript</csymbol><ci id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.2.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.2">𝑨</ci><ci id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.3.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.3.3">𝑇</ci></apply><ci id="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.4.cmml" xref="S4.SS1.2.p2.5.m2.3.3.1.1.1.1.4">𝑸</ci></apply></apply><apply id="S4.SS1.2.p2.5.m2.4.4.2.2.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1"><ci id="S4.SS1.2.p2.5.m2.2.2.cmml" xref="S4.SS1.2.p2.5.m2.2.2">Tr</ci><apply id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1"><times id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.1.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.1"></times><apply id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.1.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2">superscript</csymbol><ci id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.2.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.2">𝑨</ci><ci id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.3.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.2.3">𝑇</ci></apply><ci id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.3.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.3">𝑸</ci><ci id="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.4.cmml" xref="S4.SS1.2.p2.5.m2.4.4.2.1.1.1.4">𝑨</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.p2.5.m2.4c">\operatorname{Tr}({\bm{A}}{\bm{A}}^{T}{\bm{Q}})=\operatorname{Tr}({\bm{A}}^{T}%
{\bm{Q}}{\bm{A}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.p2.5.m2.4d">roman_Tr ( bold_italic_A bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_Q ) = roman_Tr ( bold_italic_A start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_Q bold_italic_A )</annotation></semantics></math>, completing the proof.
∎</p>
</div>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.6">Since <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">bold_italic_R</annotation></semantics></math> is a real symmetrical square matrix its eigenvalue decomposition is composed of real eigenvalues. If the eigenvalues decay quickly, we can use an approximation obtained by using the <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_ρ</annotation></semantics></math> largest magnitude eigenvalues, for some <math alttext="0&lt;\rho\ll m" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mn id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">0</mn><mo id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">&lt;</mo><mi id="S4.SS1.p3.3.m3.1.1.4" xref="S4.SS1.p3.3.m3.1.1.4.cmml">ρ</mi><mo id="S4.SS1.p3.3.m3.1.1.5" xref="S4.SS1.p3.3.m3.1.1.5.cmml">≪</mo><mi id="S4.SS1.p3.3.m3.1.1.6" xref="S4.SS1.p3.3.m3.1.1.6.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><and id="S4.SS1.p3.3.m3.1.1a.cmml" xref="S4.SS1.p3.3.m3.1.1"></and><apply id="S4.SS1.p3.3.m3.1.1b.cmml" xref="S4.SS1.p3.3.m3.1.1"><lt id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3"></lt><cn id="S4.SS1.p3.3.m3.1.1.2.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.2">0</cn><ci id="S4.SS1.p3.3.m3.1.1.4.cmml" xref="S4.SS1.p3.3.m3.1.1.4">𝜌</ci></apply><apply id="S4.SS1.p3.3.m3.1.1c.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.p3.3.m3.1.1.5.cmml" xref="S4.SS1.p3.3.m3.1.1.5">much-less-than</csymbol><share href="https://arxiv.org/html/2408.00801v1#S4.SS1.p3.3.m3.1.1.4.cmml" id="S4.SS1.p3.3.m3.1.1d.cmml" xref="S4.SS1.p3.3.m3.1.1"></share><ci id="S4.SS1.p3.3.m3.1.1.6.cmml" xref="S4.SS1.p3.3.m3.1.1.6">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">0&lt;\rho\ll m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">0 &lt; italic_ρ ≪ italic_m</annotation></semantics></math>, in the form <math alttext="{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.2"><semantics id="S4.SS1.p3.4.m4.2a"><mrow id="S4.SS1.p3.4.m4.2.3" xref="S4.SS1.p3.4.m4.2.3.cmml"><mi id="S4.SS1.p3.4.m4.2.3.2" xref="S4.SS1.p3.4.m4.2.3.2.cmml">𝑹</mi><mo id="S4.SS1.p3.4.m4.2.3.1" xref="S4.SS1.p3.4.m4.2.3.1.cmml">=</mo><mrow id="S4.SS1.p3.4.m4.2.3.3" xref="S4.SS1.p3.4.m4.2.3.3.cmml"><msup id="S4.SS1.p3.4.m4.2.3.3.2" xref="S4.SS1.p3.4.m4.2.3.3.2.cmml"><mi id="S4.SS1.p3.4.m4.2.3.3.2.2" xref="S4.SS1.p3.4.m4.2.3.3.2.2.cmml">𝑼</mi><mi id="S4.SS1.p3.4.m4.2.3.3.2.3" xref="S4.SS1.p3.4.m4.2.3.3.2.3.cmml">T</mi></msup><mo id="S4.SS1.p3.4.m4.2.3.3.1" lspace="0.167em" xref="S4.SS1.p3.4.m4.2.3.3.1.cmml">⁢</mo><mrow id="S4.SS1.p3.4.m4.2.3.3.3.2" xref="S4.SS1.p3.4.m4.2.3.3.3.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">diag</mi><mo id="S4.SS1.p3.4.m4.2.3.3.3.2a" xref="S4.SS1.p3.4.m4.2.3.3.3.1.cmml">⁡</mo><mrow id="S4.SS1.p3.4.m4.2.3.3.3.2.1" xref="S4.SS1.p3.4.m4.2.3.3.3.1.cmml"><mo id="S4.SS1.p3.4.m4.2.3.3.3.2.1.1" stretchy="false" xref="S4.SS1.p3.4.m4.2.3.3.3.1.cmml">(</mo><mi id="S4.SS1.p3.4.m4.2.2" xref="S4.SS1.p3.4.m4.2.2.cmml">𝒆</mi><mo id="S4.SS1.p3.4.m4.2.3.3.3.2.1.2" stretchy="false" xref="S4.SS1.p3.4.m4.2.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p3.4.m4.2.3.3.1a" xref="S4.SS1.p3.4.m4.2.3.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.4.m4.2.3.3.4" xref="S4.SS1.p3.4.m4.2.3.3.4.cmml">𝑼</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.2b"><apply id="S4.SS1.p3.4.m4.2.3.cmml" xref="S4.SS1.p3.4.m4.2.3"><eq id="S4.SS1.p3.4.m4.2.3.1.cmml" xref="S4.SS1.p3.4.m4.2.3.1"></eq><ci id="S4.SS1.p3.4.m4.2.3.2.cmml" xref="S4.SS1.p3.4.m4.2.3.2">𝑹</ci><apply id="S4.SS1.p3.4.m4.2.3.3.cmml" xref="S4.SS1.p3.4.m4.2.3.3"><times id="S4.SS1.p3.4.m4.2.3.3.1.cmml" xref="S4.SS1.p3.4.m4.2.3.3.1"></times><apply id="S4.SS1.p3.4.m4.2.3.3.2.cmml" xref="S4.SS1.p3.4.m4.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.3.3.2.1.cmml" xref="S4.SS1.p3.4.m4.2.3.3.2">superscript</csymbol><ci id="S4.SS1.p3.4.m4.2.3.3.2.2.cmml" xref="S4.SS1.p3.4.m4.2.3.3.2.2">𝑼</ci><ci id="S4.SS1.p3.4.m4.2.3.3.2.3.cmml" xref="S4.SS1.p3.4.m4.2.3.3.2.3">𝑇</ci></apply><apply id="S4.SS1.p3.4.m4.2.3.3.3.1.cmml" xref="S4.SS1.p3.4.m4.2.3.3.3.2"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">diag</ci><ci id="S4.SS1.p3.4.m4.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2">𝒆</ci></apply><ci id="S4.SS1.p3.4.m4.2.3.3.4.cmml" xref="S4.SS1.p3.4.m4.2.3.3.4">𝑼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.2c">{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.2d">bold_italic_R = bold_italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_e ) bold_italic_U</annotation></semantics></math>, where <math alttext="{\bm{U}}\in\mathbb{R}^{\rho\times m}" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1"><semantics id="S4.SS1.p3.5.m5.1a"><mrow id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1.2" xref="S4.SS1.p3.5.m5.1.1.2.cmml">𝑼</mi><mo id="S4.SS1.p3.5.m5.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml"><mi id="S4.SS1.p3.5.m5.1.1.3.2" xref="S4.SS1.p3.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.5.m5.1.1.3.3" xref="S4.SS1.p3.5.m5.1.1.3.3.cmml"><mi id="S4.SS1.p3.5.m5.1.1.3.3.2" xref="S4.SS1.p3.5.m5.1.1.3.3.2.cmml">ρ</mi><mo id="S4.SS1.p3.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p3.5.m5.1.1.3.3.3" xref="S4.SS1.p3.5.m5.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1"><in id="S4.SS1.p3.5.m5.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1"></in><ci id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">𝑼</ci><apply id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.5.m5.1.1.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS1.p3.5.m5.1.1.3.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3"><times id="S4.SS1.p3.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3.1"></times><ci id="S4.SS1.p3.5.m5.1.1.3.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3.2">𝜌</ci><ci id="S4.SS1.p3.5.m5.1.1.3.3.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">{\bm{U}}\in\mathbb{R}^{\rho\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.1d">bold_italic_U ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\bm{e}}\in\mathbb{R}^{\rho}" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m6.1"><semantics id="S4.SS1.p3.6.m6.1a"><mrow id="S4.SS1.p3.6.m6.1.1" xref="S4.SS1.p3.6.m6.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.2" xref="S4.SS1.p3.6.m6.1.1.2.cmml">𝒆</mi><mo id="S4.SS1.p3.6.m6.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.6.m6.1.1.3" xref="S4.SS1.p3.6.m6.1.1.3.cmml"><mi id="S4.SS1.p3.6.m6.1.1.3.2" xref="S4.SS1.p3.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p3.6.m6.1.1.3.3" xref="S4.SS1.p3.6.m6.1.1.3.3.cmml">ρ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.1b"><apply id="S4.SS1.p3.6.m6.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1"><in id="S4.SS1.p3.6.m6.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1.1"></in><ci id="S4.SS1.p3.6.m6.1.1.2.cmml" xref="S4.SS1.p3.6.m6.1.1.2">𝒆</ci><apply id="S4.SS1.p3.6.m6.1.1.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.1.1.3.1.cmml" xref="S4.SS1.p3.6.m6.1.1.3">superscript</csymbol><ci id="S4.SS1.p3.6.m6.1.1.3.2.cmml" xref="S4.SS1.p3.6.m6.1.1.3.2">ℝ</ci><ci id="S4.SS1.p3.6.m6.1.1.3.3.cmml" xref="S4.SS1.p3.6.m6.1.1.3.3">𝜌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.1c">{\bm{e}}\in\mathbb{R}^{\rho}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m6.1d">bold_italic_e ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.6">However, a low-rank decomposition lacks the expressive power we need. To see why, consider a regular FM, which is equivalent to an FwFM where all field interactions are 1, meaning that the field-interaction matrix is:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{R}}_{\mathrm{FM}}=\begin{pmatrix}0&amp;1&amp;\dots&amp;1\\
1&amp;0&amp;\dots&amp;1\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
1&amp;1&amp;\dots&amp;0\end{pmatrix}" class="ltx_Math" display="block" id="S4.Ex3.m1.1"><semantics id="S4.Ex3.m1.1a"><mrow id="S4.Ex3.m1.1.2" xref="S4.Ex3.m1.1.2.cmml"><msub id="S4.Ex3.m1.1.2.2" xref="S4.Ex3.m1.1.2.2.cmml"><mi id="S4.Ex3.m1.1.2.2.2" xref="S4.Ex3.m1.1.2.2.2.cmml">𝑹</mi><mi id="S4.Ex3.m1.1.2.2.3" xref="S4.Ex3.m1.1.2.2.3.cmml">FM</mi></msub><mo id="S4.Ex3.m1.1.2.1" xref="S4.Ex3.m1.1.2.1.cmml">=</mo><mrow id="S4.Ex3.m1.1.1.3" xref="S4.Ex3.m1.1.1.2.cmml"><mo id="S4.Ex3.m1.1.1.3.1" xref="S4.Ex3.m1.1.1.2.1.cmml">(</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.Ex3.m1.1.1.1.1" rowspacing="0pt" xref="S4.Ex3.m1.1.1.1.1.cmml"><mtr id="S4.Ex3.m1.1.1.1.1a" xref="S4.Ex3.m1.1.1.1.1.cmml"><mtd id="S4.Ex3.m1.1.1.1.1b" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.1.1.1.cmml">0</mn></mtd><mtd id="S4.Ex3.m1.1.1.1.1c" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.1.2.1" xref="S4.Ex3.m1.1.1.1.1.1.2.1.cmml">1</mn></mtd><mtd id="S4.Ex3.m1.1.1.1.1d" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.1.3.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.1.3.1.cmml">…</mi></mtd><mtd id="S4.Ex3.m1.1.1.1.1e" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.1.4.1" xref="S4.Ex3.m1.1.1.1.1.1.4.1.cmml">1</mn></mtd></mtr><mtr id="S4.Ex3.m1.1.1.1.1f" xref="S4.Ex3.m1.1.1.1.1.cmml"><mtd id="S4.Ex3.m1.1.1.1.1g" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.2.1.1" xref="S4.Ex3.m1.1.1.1.1.2.1.1.cmml">1</mn></mtd><mtd id="S4.Ex3.m1.1.1.1.1h" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.2.2.1" xref="S4.Ex3.m1.1.1.1.1.2.2.1.cmml">0</mn></mtd><mtd id="S4.Ex3.m1.1.1.1.1i" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.2.3.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.2.3.1.cmml">…</mi></mtd><mtd id="S4.Ex3.m1.1.1.1.1j" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.2.4.1" xref="S4.Ex3.m1.1.1.1.1.2.4.1.cmml">1</mn></mtd></mtr><mtr id="S4.Ex3.m1.1.1.1.1k" xref="S4.Ex3.m1.1.1.1.1.cmml"><mtd id="S4.Ex3.m1.1.1.1.1l" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.3.1.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.3.1.1.cmml">⋮</mi></mtd><mtd id="S4.Ex3.m1.1.1.1.1m" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.3.2.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.3.2.1.cmml">⋮</mi></mtd><mtd id="S4.Ex3.m1.1.1.1.1n" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.3.3.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.3.3.1.cmml">⋱</mi></mtd><mtd id="S4.Ex3.m1.1.1.1.1o" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.3.4.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.3.4.1.cmml">⋮</mi></mtd></mtr><mtr id="S4.Ex3.m1.1.1.1.1p" xref="S4.Ex3.m1.1.1.1.1.cmml"><mtd id="S4.Ex3.m1.1.1.1.1q" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.4.1.1" xref="S4.Ex3.m1.1.1.1.1.4.1.1.cmml">1</mn></mtd><mtd id="S4.Ex3.m1.1.1.1.1r" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.4.2.1" xref="S4.Ex3.m1.1.1.1.1.4.2.1.cmml">1</mn></mtd><mtd id="S4.Ex3.m1.1.1.1.1s" xref="S4.Ex3.m1.1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.1.4.3.1" mathvariant="normal" xref="S4.Ex3.m1.1.1.1.1.4.3.1.cmml">…</mi></mtd><mtd id="S4.Ex3.m1.1.1.1.1t" xref="S4.Ex3.m1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.1.1.1.1.4.4.1" xref="S4.Ex3.m1.1.1.1.1.4.4.1.cmml">0</mn></mtd></mtr></mtable><mo id="S4.Ex3.m1.1.1.3.2" xref="S4.Ex3.m1.1.1.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.1b"><apply id="S4.Ex3.m1.1.2.cmml" xref="S4.Ex3.m1.1.2"><eq id="S4.Ex3.m1.1.2.1.cmml" xref="S4.Ex3.m1.1.2.1"></eq><apply id="S4.Ex3.m1.1.2.2.cmml" xref="S4.Ex3.m1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.1.2.2.1.cmml" xref="S4.Ex3.m1.1.2.2">subscript</csymbol><ci id="S4.Ex3.m1.1.2.2.2.cmml" xref="S4.Ex3.m1.1.2.2.2">𝑹</ci><ci id="S4.Ex3.m1.1.2.2.3.cmml" xref="S4.Ex3.m1.1.2.2.3">FM</ci></apply><apply id="S4.Ex3.m1.1.1.2.cmml" xref="S4.Ex3.m1.1.1.3"><csymbol cd="latexml" id="S4.Ex3.m1.1.1.2.1.cmml" xref="S4.Ex3.m1.1.1.3.1">matrix</csymbol><matrix id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1"><matrixrow id="S4.Ex3.m1.1.1.1.1a.cmml" xref="S4.Ex3.m1.1.1.1.1"><cn id="S4.Ex3.m1.1.1.1.1.1.1.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.1.1.1">0</cn><cn id="S4.Ex3.m1.1.1.1.1.1.2.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.1.2.1">1</cn><ci id="S4.Ex3.m1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.1.3.1">…</ci><cn id="S4.Ex3.m1.1.1.1.1.1.4.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.1.4.1">1</cn></matrixrow><matrixrow id="S4.Ex3.m1.1.1.1.1b.cmml" xref="S4.Ex3.m1.1.1.1.1"><cn id="S4.Ex3.m1.1.1.1.1.2.1.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.2.1.1">1</cn><cn id="S4.Ex3.m1.1.1.1.1.2.2.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.2.2.1">0</cn><ci id="S4.Ex3.m1.1.1.1.1.2.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.2.3.1">…</ci><cn id="S4.Ex3.m1.1.1.1.1.2.4.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.2.4.1">1</cn></matrixrow><matrixrow id="S4.Ex3.m1.1.1.1.1c.cmml" xref="S4.Ex3.m1.1.1.1.1"><ci id="S4.Ex3.m1.1.1.1.1.3.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1.3.1.1">⋮</ci><ci id="S4.Ex3.m1.1.1.1.1.3.2.1.cmml" xref="S4.Ex3.m1.1.1.1.1.3.2.1">⋮</ci><ci id="S4.Ex3.m1.1.1.1.1.3.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.3.3.1">⋱</ci><ci id="S4.Ex3.m1.1.1.1.1.3.4.1.cmml" xref="S4.Ex3.m1.1.1.1.1.3.4.1">⋮</ci></matrixrow><matrixrow id="S4.Ex3.m1.1.1.1.1d.cmml" xref="S4.Ex3.m1.1.1.1.1"><cn id="S4.Ex3.m1.1.1.1.1.4.1.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.4.1.1">1</cn><cn id="S4.Ex3.m1.1.1.1.1.4.2.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.4.2.1">1</cn><ci id="S4.Ex3.m1.1.1.1.1.4.3.1.cmml" xref="S4.Ex3.m1.1.1.1.1.4.3.1">…</ci><cn id="S4.Ex3.m1.1.1.1.1.4.4.1.cmml" type="integer" xref="S4.Ex3.m1.1.1.1.1.4.4.1">0</cn></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.1c">{\bm{R}}_{\mathrm{FM}}=\begin{pmatrix}0&amp;1&amp;\dots&amp;1\\
1&amp;0&amp;\dots&amp;1\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
1&amp;1&amp;\dots&amp;0\end{pmatrix}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex3.m1.1d">bold_italic_R start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT = ( start_ARG start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL … end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL start_CELL … end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL ⋮ end_CELL start_CELL ⋮ end_CELL start_CELL ⋱ end_CELL start_CELL ⋮ end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL 1 end_CELL start_CELL … end_CELL start_CELL 0 end_CELL end_ROW end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p4.3">We have <math alttext="\operatorname{rank}({\bm{R}}_{\mathrm{FM}})=m" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.2"><semantics id="S4.SS1.p4.1.m1.2a"><mrow id="S4.SS1.p4.1.m1.2.2" xref="S4.SS1.p4.1.m1.2.2.cmml"><mrow id="S4.SS1.p4.1.m1.2.2.1.1" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">rank</mi><mo id="S4.SS1.p4.1.m1.2.2.1.1a" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml">⁡</mo><mrow id="S4.SS1.p4.1.m1.2.2.1.1.1" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml"><mo id="S4.SS1.p4.1.m1.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml">(</mo><msub id="S4.SS1.p4.1.m1.2.2.1.1.1.1" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.2.2.1.1.1.1.2" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1.2.cmml">𝑹</mi><mi id="S4.SS1.p4.1.m1.2.2.1.1.1.1.3" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1.3.cmml">FM</mi></msub><mo id="S4.SS1.p4.1.m1.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.p4.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p4.1.m1.2.2.2" xref="S4.SS1.p4.1.m1.2.2.2.cmml">=</mo><mi id="S4.SS1.p4.1.m1.2.2.3" xref="S4.SS1.p4.1.m1.2.2.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.2b"><apply id="S4.SS1.p4.1.m1.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2"><eq id="S4.SS1.p4.1.m1.2.2.2.cmml" xref="S4.SS1.p4.1.m1.2.2.2"></eq><apply id="S4.SS1.p4.1.m1.2.2.1.2.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">rank</ci><apply id="S4.SS1.p4.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p4.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1.2">𝑹</ci><ci id="S4.SS1.p4.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.2.2.1.1.1.1.3">FM</ci></apply></apply><ci id="S4.SS1.p4.1.m1.2.2.3.cmml" xref="S4.SS1.p4.1.m1.2.2.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.2c">\operatorname{rank}({\bm{R}}_{\mathrm{FM}})=m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.2d">roman_rank ( bold_italic_R start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT ) = italic_m</annotation></semantics></math>, and its eigenvalues are <math alttext="\{m-1,-1,\dots,-1\}" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.4"><semantics id="S4.SS1.p4.2.m2.4a"><mrow id="S4.SS1.p4.2.m2.4.4.3" xref="S4.SS1.p4.2.m2.4.4.4.cmml"><mo id="S4.SS1.p4.2.m2.4.4.3.4" stretchy="false" xref="S4.SS1.p4.2.m2.4.4.4.cmml">{</mo><mrow id="S4.SS1.p4.2.m2.2.2.1.1" xref="S4.SS1.p4.2.m2.2.2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.2.2.1.1.2" xref="S4.SS1.p4.2.m2.2.2.1.1.2.cmml">m</mi><mo id="S4.SS1.p4.2.m2.2.2.1.1.1" xref="S4.SS1.p4.2.m2.2.2.1.1.1.cmml">−</mo><mn id="S4.SS1.p4.2.m2.2.2.1.1.3" xref="S4.SS1.p4.2.m2.2.2.1.1.3.cmml">1</mn></mrow><mo id="S4.SS1.p4.2.m2.4.4.3.5" xref="S4.SS1.p4.2.m2.4.4.4.cmml">,</mo><mrow id="S4.SS1.p4.2.m2.3.3.2.2" xref="S4.SS1.p4.2.m2.3.3.2.2.cmml"><mo id="S4.SS1.p4.2.m2.3.3.2.2a" xref="S4.SS1.p4.2.m2.3.3.2.2.cmml">−</mo><mn id="S4.SS1.p4.2.m2.3.3.2.2.2" xref="S4.SS1.p4.2.m2.3.3.2.2.2.cmml">1</mn></mrow><mo id="S4.SS1.p4.2.m2.4.4.3.6" xref="S4.SS1.p4.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS1.p4.2.m2.1.1" mathvariant="normal" xref="S4.SS1.p4.2.m2.1.1.cmml">…</mi><mo id="S4.SS1.p4.2.m2.4.4.3.7" xref="S4.SS1.p4.2.m2.4.4.4.cmml">,</mo><mrow id="S4.SS1.p4.2.m2.4.4.3.3" xref="S4.SS1.p4.2.m2.4.4.3.3.cmml"><mo id="S4.SS1.p4.2.m2.4.4.3.3a" xref="S4.SS1.p4.2.m2.4.4.3.3.cmml">−</mo><mn id="S4.SS1.p4.2.m2.4.4.3.3.2" xref="S4.SS1.p4.2.m2.4.4.3.3.2.cmml">1</mn></mrow><mo id="S4.SS1.p4.2.m2.4.4.3.8" stretchy="false" xref="S4.SS1.p4.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.4b"><set id="S4.SS1.p4.2.m2.4.4.4.cmml" xref="S4.SS1.p4.2.m2.4.4.3"><apply id="S4.SS1.p4.2.m2.2.2.1.1.cmml" xref="S4.SS1.p4.2.m2.2.2.1.1"><minus id="S4.SS1.p4.2.m2.2.2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.2.2.1.1.1"></minus><ci id="S4.SS1.p4.2.m2.2.2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.2.2.1.1.2">𝑚</ci><cn id="S4.SS1.p4.2.m2.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.p4.2.m2.2.2.1.1.3">1</cn></apply><apply id="S4.SS1.p4.2.m2.3.3.2.2.cmml" xref="S4.SS1.p4.2.m2.3.3.2.2"><minus id="S4.SS1.p4.2.m2.3.3.2.2.1.cmml" xref="S4.SS1.p4.2.m2.3.3.2.2"></minus><cn id="S4.SS1.p4.2.m2.3.3.2.2.2.cmml" type="integer" xref="S4.SS1.p4.2.m2.3.3.2.2.2">1</cn></apply><ci id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">…</ci><apply id="S4.SS1.p4.2.m2.4.4.3.3.cmml" xref="S4.SS1.p4.2.m2.4.4.3.3"><minus id="S4.SS1.p4.2.m2.4.4.3.3.1.cmml" xref="S4.SS1.p4.2.m2.4.4.3.3"></minus><cn id="S4.SS1.p4.2.m2.4.4.3.3.2.cmml" type="integer" xref="S4.SS1.p4.2.m2.4.4.3.3.2">1</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.4c">\{m-1,-1,\dots,-1\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.4d">{ italic_m - 1 , - 1 , … , - 1 }</annotation></semantics></math>, and hence a low-rank approximation within a reasonable accuracy is impossible. Since a low-rank decomposition does not even have enough expressive to model a regular FM, an FwFM is clearly out of reach. The obstacle stems from the zero diagonal of <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS1.p4.3.m3.1"><semantics id="S4.SS1.p4.3.m3.1a"><mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.3.m3.1d">bold_italic_R</annotation></semantics></math>, which is an “anomaly” in the matrix. But as <cite class="ltx_cite ltx_citemacro_citet">Lin et al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib21" title="">2018</a>)</cite> pointed out, this anomaly can be easily handled using a diagonal matrix:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{R}}_{\mathrm{FM}}=\bm{1}\bm{1}^{T}-{\bm{I}}," class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.2.cmml"><mi id="S4.E7.m1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.2.2.cmml">𝑹</mi><mi id="S4.E7.m1.1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.1.2.3.cmml">FM</mi></msub><mo id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.3.cmml"><msup id="S4.E7.m1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.3.2.cmml"><mn id="S4.E7.m1.1.1.1.1.3.2.2" xref="S4.E7.m1.1.1.1.1.3.2.2.cmml">𝟏𝟏</mn><mi id="S4.E7.m1.1.1.1.1.3.2.3" xref="S4.E7.m1.1.1.1.1.3.2.3.cmml">T</mi></msup><mo id="S4.E7.m1.1.1.1.1.3.1" xref="S4.E7.m1.1.1.1.1.3.1.cmml">−</mo><mi id="S4.E7.m1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.3.3.cmml">𝑰</mi></mrow></mrow><mo id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><eq id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"></eq><apply id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.2.2">𝑹</ci><ci id="S4.E7.m1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.1.1.2.3">FM</ci></apply><apply id="S4.E7.m1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3"><minus id="S4.E7.m1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.1"></minus><apply id="S4.E7.m1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.2">superscript</csymbol><cn id="S4.E7.m1.1.1.1.1.3.2.2.cmml" type="integer" xref="S4.E7.m1.1.1.1.1.3.2.2">11</cn><ci id="S4.E7.m1.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.2.3">𝑇</ci></apply><ci id="S4.E7.m1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3">𝑰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">{\bm{R}}_{\mathrm{FM}}=\bm{1}\bm{1}^{T}-{\bm{I}},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">bold_italic_R start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT = bold_11 start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT - bold_italic_I ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p4.5">where <math alttext="\bm{1}" class="ltx_Math" display="inline" id="S4.SS1.p4.4.m1.1"><semantics id="S4.SS1.p4.4.m1.1a"><mn id="S4.SS1.p4.4.m1.1.1" xref="S4.SS1.p4.4.m1.1.1.cmml">𝟏</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m1.1b"><cn id="S4.SS1.p4.4.m1.1.1.cmml" type="integer" xref="S4.SS1.p4.4.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m1.1c">\bm{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.4.m1.1d">bold_1</annotation></semantics></math> is a column vector whose components are all 1. In other words, the matrix <math alttext="{\bm{R}}_{\mathrm{FM}}" class="ltx_Math" display="inline" id="S4.SS1.p4.5.m2.1"><semantics id="S4.SS1.p4.5.m2.1a"><msub id="S4.SS1.p4.5.m2.1.1" xref="S4.SS1.p4.5.m2.1.1.cmml"><mi id="S4.SS1.p4.5.m2.1.1.2" xref="S4.SS1.p4.5.m2.1.1.2.cmml">𝑹</mi><mi id="S4.SS1.p4.5.m2.1.1.3" xref="S4.SS1.p4.5.m2.1.1.3.cmml">FM</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m2.1b"><apply id="S4.SS1.p4.5.m2.1.1.cmml" xref="S4.SS1.p4.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m2.1.1.1.cmml" xref="S4.SS1.p4.5.m2.1.1">subscript</csymbol><ci id="S4.SS1.p4.5.m2.1.1.2.cmml" xref="S4.SS1.p4.5.m2.1.1.2">𝑹</ci><ci id="S4.SS1.p4.5.m2.1.1.3.cmml" xref="S4.SS1.p4.5.m2.1.1.3">FM</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m2.1c">{\bm{R}}_{\mathrm{FM}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.5.m2.1d">bold_italic_R start_POSTSUBSCRIPT roman_FM end_POSTSUBSCRIPT</annotation></semantics></math> can be decomposed into a sum of a diagonal matrix and a low-rank matrix. Motivated by the above, we use a diagonal plus low-rank (DPLR) decomposition to facilitate fast inference, as is shown in the proposition below. The low-rank part resembles the eigenvalue decomposition, to be able to model arbitrary symmetric matrices, including indefinite ones.</p>
</div>
<div class="ltx_theorem ltx_theorem_proposition" id="S4.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Proposition 0.</h6>
<div class="ltx_para" id="S4.Thmtheorem1.p1">
<p class="ltx_p" id="S4.Thmtheorem1.p1.5"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.5.5">Let <math alttext="{\bm{V}}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.1.1.m1.1"><semantics id="S4.Thmtheorem1.p1.1.1.m1.1a"><mi id="S4.Thmtheorem1.p1.1.1.m1.1.1" xref="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.1.1.m1.1b"><ci id="S4.Thmtheorem1.p1.1.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.1.1.m1.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.1.1.m1.1c">{\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.1.1.m1.1d">bold_italic_V</annotation></semantics></math> be as defined in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.E4" title="In 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>), let <math alttext="{\bm{R}}\in\mathbb{R}^{m\times m}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.2.2.m2.1"><semantics id="S4.Thmtheorem1.p1.2.2.m2.1a"><mrow id="S4.Thmtheorem1.p1.2.2.m2.1.1" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1.2" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.2.cmml">𝐑</mi><mo id="S4.Thmtheorem1.p1.2.2.m2.1.1.1" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.Thmtheorem1.p1.2.2.m2.1.1.3" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.2" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.cmml"><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.2" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.2.cmml">m</mi><mo id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.3" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.2.2.m2.1b"><apply id="S4.Thmtheorem1.p1.2.2.m2.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1"><in id="S4.Thmtheorem1.p1.2.2.m2.1.1.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.1"></in><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.2.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.2">𝐑</ci><apply id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3">superscript</csymbol><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3"><times id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.1.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.1"></times><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.2.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.2">𝑚</ci><ci id="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.3.cmml" xref="S4.Thmtheorem1.p1.2.2.m2.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.2.2.m2.1c">{\bm{R}}\in\mathbb{R}^{m\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.2.2.m2.1d">bold_italic_R ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> be a symmetric matrix, and suppose that <math alttext="{\bm{U}}\in\mathbb{R}^{\rho\times m}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.3.3.m3.1"><semantics id="S4.Thmtheorem1.p1.3.3.m3.1a"><mrow id="S4.Thmtheorem1.p1.3.3.m3.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.2" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml">𝐔</mi><mo id="S4.Thmtheorem1.p1.3.3.m3.1.1.1" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1.cmml">∈</mo><msup id="S4.Thmtheorem1.p1.3.3.m3.1.1.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.2" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml"><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.2" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.2.cmml">ρ</mi><mo id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.3" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.3.3.m3.1b"><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1"><in id="S4.Thmtheorem1.p1.3.3.m3.1.1.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.1"></in><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.2">𝐔</ci><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3">superscript</csymbol><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.2">ℝ</ci><apply id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3"><times id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.1.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.1"></times><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.2.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.2">𝜌</ci><ci id="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.3.cmml" xref="S4.Thmtheorem1.p1.3.3.m3.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.3.3.m3.1c">{\bm{U}}\in\mathbb{R}^{\rho\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.3.3.m3.1d">bold_italic_U ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="{\bm{e}}\in\mathbb{R}^{\rho}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.4.4.m4.1"><semantics id="S4.Thmtheorem1.p1.4.4.m4.1a"><mrow id="S4.Thmtheorem1.p1.4.4.m4.1.1" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.cmml"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.2" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.2.cmml">𝐞</mi><mo id="S4.Thmtheorem1.p1.4.4.m4.1.1.1" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.1.cmml">∈</mo><msup id="S4.Thmtheorem1.p1.4.4.m4.1.1.3" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.2" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.3" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3.3.cmml">ρ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.4.4.m4.1b"><apply id="S4.Thmtheorem1.p1.4.4.m4.1.1.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1"><in id="S4.Thmtheorem1.p1.4.4.m4.1.1.1.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.1"></in><ci id="S4.Thmtheorem1.p1.4.4.m4.1.1.2.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.2">𝐞</ci><apply id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3">superscript</csymbol><ci id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3.2">ℝ</ci><ci id="S4.Thmtheorem1.p1.4.4.m4.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.4.4.m4.1.1.3.3">𝜌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.4.4.m4.1c">{\bm{e}}\in\mathbb{R}^{\rho}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.4.4.m4.1d">bold_italic_e ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="{\bm{d}}\in\mathbb{R}^{m}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.5.5.m5.1"><semantics id="S4.Thmtheorem1.p1.5.5.m5.1a"><mrow id="S4.Thmtheorem1.p1.5.5.m5.1.1" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.cmml"><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.2.cmml">𝐝</mi><mo id="S4.Thmtheorem1.p1.5.5.m5.1.1.1" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.1.cmml">∈</mo><msup id="S4.Thmtheorem1.p1.5.5.m5.1.1.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.2" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.3" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.5.5.m5.1b"><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1"><in id="S4.Thmtheorem1.p1.5.5.m5.1.1.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.1"></in><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.2.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.2">𝐝</ci><apply id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3">superscript</csymbol><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3.2">ℝ</ci><ci id="S4.Thmtheorem1.p1.5.5.m5.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.5.5.m5.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.5.5.m5.1c">{\bm{d}}\in\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.5.5.m5.1d">bold_italic_d ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> are such that</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}+\operatorname{diag}%
({\bm{d}})." class="ltx_Math" display="block" id="S4.E8.m1.5"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5.1" xref="S4.E8.m1.5.5.1.1.cmml"><mrow id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1.cmml"><mi id="S4.E8.m1.5.5.1.1.2" xref="S4.E8.m1.5.5.1.1.2.cmml">𝑹</mi><mo id="S4.E8.m1.5.5.1.1.1" xref="S4.E8.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.5.5.1.1.3" xref="S4.E8.m1.5.5.1.1.3.cmml"><mrow id="S4.E8.m1.5.5.1.1.3.2" xref="S4.E8.m1.5.5.1.1.3.2.cmml"><msup id="S4.E8.m1.5.5.1.1.3.2.2" xref="S4.E8.m1.5.5.1.1.3.2.2.cmml"><mi id="S4.E8.m1.5.5.1.1.3.2.2.2" xref="S4.E8.m1.5.5.1.1.3.2.2.2.cmml">𝑼</mi><mi id="S4.E8.m1.5.5.1.1.3.2.2.3" xref="S4.E8.m1.5.5.1.1.3.2.2.3.cmml">T</mi></msup><mo id="S4.E8.m1.5.5.1.1.3.2.1" lspace="0.167em" xref="S4.E8.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E8.m1.5.5.1.1.3.2.3.2" xref="S4.E8.m1.5.5.1.1.3.2.3.1.cmml"><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">diag</mi><mo id="S4.E8.m1.5.5.1.1.3.2.3.2a" xref="S4.E8.m1.5.5.1.1.3.2.3.1.cmml">⁡</mo><mrow id="S4.E8.m1.5.5.1.1.3.2.3.2.1" xref="S4.E8.m1.5.5.1.1.3.2.3.1.cmml"><mo id="S4.E8.m1.5.5.1.1.3.2.3.2.1.1" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.2.3.1.cmml">(</mo><mi id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">𝒆</mi><mo id="S4.E8.m1.5.5.1.1.3.2.3.2.1.2" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.5.5.1.1.3.2.1a" xref="S4.E8.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.E8.m1.5.5.1.1.3.2.4" xref="S4.E8.m1.5.5.1.1.3.2.4.cmml">𝑼</mi></mrow><mo id="S4.E8.m1.5.5.1.1.3.1" xref="S4.E8.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S4.E8.m1.5.5.1.1.3.3.2" xref="S4.E8.m1.5.5.1.1.3.3.1.cmml"><mi id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml">diag</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2a" xref="S4.E8.m1.5.5.1.1.3.3.1.cmml">⁡</mo><mrow id="S4.E8.m1.5.5.1.1.3.3.2.1" xref="S4.E8.m1.5.5.1.1.3.3.1.cmml"><mo id="S4.E8.m1.5.5.1.1.3.3.2.1.1" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml">𝒅</mi><mo id="S4.E8.m1.5.5.1.1.3.3.2.1.2" stretchy="false" xref="S4.E8.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.5.5.1.2" lspace="0em" xref="S4.E8.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1"><eq id="S4.E8.m1.5.5.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.1"></eq><ci id="S4.E8.m1.5.5.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.2">𝑹</ci><apply id="S4.E8.m1.5.5.1.1.3.cmml" xref="S4.E8.m1.5.5.1.1.3"><plus id="S4.E8.m1.5.5.1.1.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.1"></plus><apply id="S4.E8.m1.5.5.1.1.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2"><times id="S4.E8.m1.5.5.1.1.3.2.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.1"></times><apply id="S4.E8.m1.5.5.1.1.3.2.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.2">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2.2.2">𝑼</ci><ci id="S4.E8.m1.5.5.1.1.3.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.3.2.2.3">𝑇</ci></apply><apply id="S4.E8.m1.5.5.1.1.3.2.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.3.2"><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">diag</ci><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">𝒆</ci></apply><ci id="S4.E8.m1.5.5.1.1.3.2.4.cmml" xref="S4.E8.m1.5.5.1.1.3.2.4">𝑼</ci></apply><apply id="S4.E8.m1.5.5.1.1.3.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3.3.2"><ci id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3">diag</ci><ci id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.4.4">𝒅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}+\operatorname{diag}%
({\bm{d}}).</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.5d">bold_italic_R = bold_italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_e ) bold_italic_U + roman_diag ( bold_italic_d ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.Thmtheorem1.p1.6"><span class="ltx_text ltx_font_italic" id="S4.Thmtheorem1.p1.6.1">Define <math alttext="{\bm{P}}={\bm{U}}{\bm{V}}" class="ltx_Math" display="inline" id="S4.Thmtheorem1.p1.6.1.m1.1"><semantics id="S4.Thmtheorem1.p1.6.1.m1.1a"><mrow id="S4.Thmtheorem1.p1.6.1.m1.1.1" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.cmml"><mi id="S4.Thmtheorem1.p1.6.1.m1.1.1.2" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.2.cmml">𝐏</mi><mo id="S4.Thmtheorem1.p1.6.1.m1.1.1.1" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.1.cmml">=</mo><mrow id="S4.Thmtheorem1.p1.6.1.m1.1.1.3" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.cmml"><mi id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.2" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.2.cmml">𝐔</mi><mo id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.1" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.3" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.3.cmml">𝐕</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Thmtheorem1.p1.6.1.m1.1b"><apply id="S4.Thmtheorem1.p1.6.1.m1.1.1.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1"><eq id="S4.Thmtheorem1.p1.6.1.m1.1.1.1.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.1"></eq><ci id="S4.Thmtheorem1.p1.6.1.m1.1.1.2.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.2">𝐏</ci><apply id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3"><times id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.1.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.1"></times><ci id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.2.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.2">𝐔</ci><ci id="S4.Thmtheorem1.p1.6.1.m1.1.1.3.3.cmml" xref="S4.Thmtheorem1.p1.6.1.m1.1.1.3.3">𝐕</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Thmtheorem1.p1.6.1.m1.1c">{\bm{P}}={\bm{U}}{\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.Thmtheorem1.p1.6.1.m1.1d">bold_italic_P = bold_italic_U bold_italic_V</annotation></semantics></math>. Then,</span></p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}=%
\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{\rho}{e}_{i}\|{\bm{P}}_{%
i,:}\|^{2}" class="ltx_Math" display="block" id="S4.E9.m1.8"><semantics id="S4.E9.m1.8a"><mrow id="S4.E9.m1.8.8" xref="S4.E9.m1.8.8.cmml"><mrow id="S4.E9.m1.6.6.2" xref="S4.E9.m1.6.6.2.cmml"><munderover id="S4.E9.m1.6.6.2.3" xref="S4.E9.m1.6.6.2.3.cmml"><mo id="S4.E9.m1.6.6.2.3.2.2" movablelimits="false" xref="S4.E9.m1.6.6.2.3.2.2.cmml">∑</mo><mrow id="S4.E9.m1.6.6.2.3.2.3" xref="S4.E9.m1.6.6.2.3.2.3.cmml"><mi id="S4.E9.m1.6.6.2.3.2.3.2" xref="S4.E9.m1.6.6.2.3.2.3.2.cmml">i</mi><mo id="S4.E9.m1.6.6.2.3.2.3.1" xref="S4.E9.m1.6.6.2.3.2.3.1.cmml">=</mo><mn id="S4.E9.m1.6.6.2.3.2.3.3" xref="S4.E9.m1.6.6.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.6.6.2.3.3" xref="S4.E9.m1.6.6.2.3.3.cmml">m</mi></munderover><mrow id="S4.E9.m1.6.6.2.2" xref="S4.E9.m1.6.6.2.2.cmml"><munderover id="S4.E9.m1.6.6.2.2.3" xref="S4.E9.m1.6.6.2.2.3.cmml"><mo id="S4.E9.m1.6.6.2.2.3.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S4.E9.m1.6.6.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E9.m1.6.6.2.2.3.2.3" xref="S4.E9.m1.6.6.2.2.3.2.3.cmml"><mi id="S4.E9.m1.6.6.2.2.3.2.3.2" xref="S4.E9.m1.6.6.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E9.m1.6.6.2.2.3.2.3.1" xref="S4.E9.m1.6.6.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E9.m1.6.6.2.2.3.2.3.3" xref="S4.E9.m1.6.6.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.6.6.2.2.3.3" xref="S4.E9.m1.6.6.2.2.3.3.cmml">m</mi></munderover><mrow id="S4.E9.m1.6.6.2.2.2" xref="S4.E9.m1.6.6.2.2.2.cmml"><mrow id="S4.E9.m1.6.6.2.2.2.2.2" xref="S4.E9.m1.6.6.2.2.2.2.3.cmml"><mo id="S4.E9.m1.6.6.2.2.2.2.2.3" stretchy="false" xref="S4.E9.m1.6.6.2.2.2.2.3.cmml">⟨</mo><msub id="S4.E9.m1.5.5.1.1.1.1.1.1" xref="S4.E9.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.5.5.1.1.1.1.1.1.2" xref="S4.E9.m1.5.5.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.E9.m1.5.5.1.1.1.1.1.1.3" xref="S4.E9.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.6.6.2.2.2.2.2.4" xref="S4.E9.m1.6.6.2.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.6.6.2.2.2.2.2.2" xref="S4.E9.m1.6.6.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.6.6.2.2.2.2.2.2.2" xref="S4.E9.m1.6.6.2.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S4.E9.m1.6.6.2.2.2.2.2.2.3" xref="S4.E9.m1.6.6.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E9.m1.6.6.2.2.2.2.2.5" stretchy="false" xref="S4.E9.m1.6.6.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.E9.m1.6.6.2.2.2.3" xref="S4.E9.m1.6.6.2.2.2.3.cmml">⁢</mo><msub id="S4.E9.m1.6.6.2.2.2.4" xref="S4.E9.m1.6.6.2.2.2.4.cmml"><mi id="S4.E9.m1.6.6.2.2.2.4.2" xref="S4.E9.m1.6.6.2.2.2.4.2.cmml">R</mi><mrow id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">i</mi><mo id="S4.E9.m1.2.2.2.4.1" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E9.m1.8.8.5" rspace="0.111em" xref="S4.E9.m1.8.8.5.cmml">=</mo><mrow id="S4.E9.m1.8.8.4" xref="S4.E9.m1.8.8.4.cmml"><mrow id="S4.E9.m1.7.7.3.1" xref="S4.E9.m1.7.7.3.1.cmml"><munderover id="S4.E9.m1.7.7.3.1.2" xref="S4.E9.m1.7.7.3.1.2.cmml"><mo id="S4.E9.m1.7.7.3.1.2.2.2" movablelimits="false" xref="S4.E9.m1.7.7.3.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.7.7.3.1.2.2.3" xref="S4.E9.m1.7.7.3.1.2.2.3.cmml"><mi id="S4.E9.m1.7.7.3.1.2.2.3.2" xref="S4.E9.m1.7.7.3.1.2.2.3.2.cmml">i</mi><mo id="S4.E9.m1.7.7.3.1.2.2.3.1" xref="S4.E9.m1.7.7.3.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.7.7.3.1.2.2.3.3" xref="S4.E9.m1.7.7.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.7.7.3.1.2.3" xref="S4.E9.m1.7.7.3.1.2.3.cmml">m</mi></munderover><mrow id="S4.E9.m1.7.7.3.1.1" xref="S4.E9.m1.7.7.3.1.1.cmml"><msub id="S4.E9.m1.7.7.3.1.1.3" xref="S4.E9.m1.7.7.3.1.1.3.cmml"><mi id="S4.E9.m1.7.7.3.1.1.3.2" xref="S4.E9.m1.7.7.3.1.1.3.2.cmml">d</mi><mi id="S4.E9.m1.7.7.3.1.1.3.3" xref="S4.E9.m1.7.7.3.1.1.3.3.cmml">i</mi></msub><mo id="S4.E9.m1.7.7.3.1.1.2" xref="S4.E9.m1.7.7.3.1.1.2.cmml">⁢</mo><msup id="S4.E9.m1.7.7.3.1.1.1" xref="S4.E9.m1.7.7.3.1.1.1.cmml"><mrow id="S4.E9.m1.7.7.3.1.1.1.1.1" xref="S4.E9.m1.7.7.3.1.1.1.1.2.cmml"><mo id="S4.E9.m1.7.7.3.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.7.7.3.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.E9.m1.7.7.3.1.1.1.1.1.1" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.7.7.3.1.1.1.1.1.1.2" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.E9.m1.7.7.3.1.1.1.1.1.1.3" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E9.m1.7.7.3.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.7.7.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E9.m1.7.7.3.1.1.1.3" xref="S4.E9.m1.7.7.3.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.E9.m1.8.8.4.3" rspace="0.055em" xref="S4.E9.m1.8.8.4.3.cmml">+</mo><mrow id="S4.E9.m1.8.8.4.2" xref="S4.E9.m1.8.8.4.2.cmml"><munderover id="S4.E9.m1.8.8.4.2.2" xref="S4.E9.m1.8.8.4.2.2.cmml"><mo id="S4.E9.m1.8.8.4.2.2.2.2" movablelimits="false" xref="S4.E9.m1.8.8.4.2.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.8.8.4.2.2.2.3" xref="S4.E9.m1.8.8.4.2.2.2.3.cmml"><mi id="S4.E9.m1.8.8.4.2.2.2.3.2" xref="S4.E9.m1.8.8.4.2.2.2.3.2.cmml">i</mi><mo id="S4.E9.m1.8.8.4.2.2.2.3.1" xref="S4.E9.m1.8.8.4.2.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.8.8.4.2.2.2.3.3" xref="S4.E9.m1.8.8.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.8.8.4.2.2.3" xref="S4.E9.m1.8.8.4.2.2.3.cmml">ρ</mi></munderover><mrow id="S4.E9.m1.8.8.4.2.1" xref="S4.E9.m1.8.8.4.2.1.cmml"><msub id="S4.E9.m1.8.8.4.2.1.3" xref="S4.E9.m1.8.8.4.2.1.3.cmml"><mi id="S4.E9.m1.8.8.4.2.1.3.2" xref="S4.E9.m1.8.8.4.2.1.3.2.cmml">e</mi><mi id="S4.E9.m1.8.8.4.2.1.3.3" xref="S4.E9.m1.8.8.4.2.1.3.3.cmml">i</mi></msub><mo id="S4.E9.m1.8.8.4.2.1.2" xref="S4.E9.m1.8.8.4.2.1.2.cmml">⁢</mo><msup id="S4.E9.m1.8.8.4.2.1.1" xref="S4.E9.m1.8.8.4.2.1.1.cmml"><mrow id="S4.E9.m1.8.8.4.2.1.1.1.1" xref="S4.E9.m1.8.8.4.2.1.1.1.2.cmml"><mo id="S4.E9.m1.8.8.4.2.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.8.8.4.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.E9.m1.8.8.4.2.1.1.1.1.1" xref="S4.E9.m1.8.8.4.2.1.1.1.1.1.cmml"><mi id="S4.E9.m1.8.8.4.2.1.1.1.1.1.2" xref="S4.E9.m1.8.8.4.2.1.1.1.1.1.2.cmml">𝑷</mi><mrow id="S4.E9.m1.4.4.2.4" xref="S4.E9.m1.4.4.2.3.cmml"><mi id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml">i</mi><mo id="S4.E9.m1.4.4.2.4.1" xref="S4.E9.m1.4.4.2.3.cmml">,</mo><mo id="S4.E9.m1.4.4.2.2" xref="S4.E9.m1.4.4.2.2.cmml">:</mo></mrow></msub><mo id="S4.E9.m1.8.8.4.2.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.8.8.4.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E9.m1.8.8.4.2.1.1.3" xref="S4.E9.m1.8.8.4.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.8b"><apply id="S4.E9.m1.8.8.cmml" xref="S4.E9.m1.8.8"><eq id="S4.E9.m1.8.8.5.cmml" xref="S4.E9.m1.8.8.5"></eq><apply id="S4.E9.m1.6.6.2.cmml" xref="S4.E9.m1.6.6.2"><apply id="S4.E9.m1.6.6.2.3.cmml" xref="S4.E9.m1.6.6.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.3.1.cmml" xref="S4.E9.m1.6.6.2.3">superscript</csymbol><apply id="S4.E9.m1.6.6.2.3.2.cmml" xref="S4.E9.m1.6.6.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.3.2.1.cmml" xref="S4.E9.m1.6.6.2.3">subscript</csymbol><sum id="S4.E9.m1.6.6.2.3.2.2.cmml" xref="S4.E9.m1.6.6.2.3.2.2"></sum><apply id="S4.E9.m1.6.6.2.3.2.3.cmml" xref="S4.E9.m1.6.6.2.3.2.3"><eq id="S4.E9.m1.6.6.2.3.2.3.1.cmml" xref="S4.E9.m1.6.6.2.3.2.3.1"></eq><ci id="S4.E9.m1.6.6.2.3.2.3.2.cmml" xref="S4.E9.m1.6.6.2.3.2.3.2">𝑖</ci><cn id="S4.E9.m1.6.6.2.3.2.3.3.cmml" type="integer" xref="S4.E9.m1.6.6.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.6.6.2.3.3.cmml" xref="S4.E9.m1.6.6.2.3.3">𝑚</ci></apply><apply id="S4.E9.m1.6.6.2.2.cmml" xref="S4.E9.m1.6.6.2.2"><apply id="S4.E9.m1.6.6.2.2.3.cmml" xref="S4.E9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.3.1.cmml" xref="S4.E9.m1.6.6.2.2.3">superscript</csymbol><apply id="S4.E9.m1.6.6.2.2.3.2.cmml" xref="S4.E9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.3.2.1.cmml" xref="S4.E9.m1.6.6.2.2.3">subscript</csymbol><sum id="S4.E9.m1.6.6.2.2.3.2.2.cmml" xref="S4.E9.m1.6.6.2.2.3.2.2"></sum><apply id="S4.E9.m1.6.6.2.2.3.2.3.cmml" xref="S4.E9.m1.6.6.2.2.3.2.3"><eq id="S4.E9.m1.6.6.2.2.3.2.3.1.cmml" xref="S4.E9.m1.6.6.2.2.3.2.3.1"></eq><ci id="S4.E9.m1.6.6.2.2.3.2.3.2.cmml" xref="S4.E9.m1.6.6.2.2.3.2.3.2">𝑗</ci><cn id="S4.E9.m1.6.6.2.2.3.2.3.3.cmml" type="integer" xref="S4.E9.m1.6.6.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.6.6.2.2.3.3.cmml" xref="S4.E9.m1.6.6.2.2.3.3">𝑚</ci></apply><apply id="S4.E9.m1.6.6.2.2.2.cmml" xref="S4.E9.m1.6.6.2.2.2"><times id="S4.E9.m1.6.6.2.2.2.3.cmml" xref="S4.E9.m1.6.6.2.2.2.3"></times><list id="S4.E9.m1.6.6.2.2.2.2.3.cmml" xref="S4.E9.m1.6.6.2.2.2.2.2"><apply id="S4.E9.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.E9.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E9.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.E9.m1.6.6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.6.6.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.6.6.2.2.2.2.2.2.2">𝒗</ci><ci id="S4.E9.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.6.6.2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S4.E9.m1.6.6.2.2.2.4.cmml" xref="S4.E9.m1.6.6.2.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.2.2.2.4.1.cmml" xref="S4.E9.m1.6.6.2.2.2.4">subscript</csymbol><ci id="S4.E9.m1.6.6.2.2.2.4.2.cmml" xref="S4.E9.m1.6.6.2.2.2.4.2">𝑅</ci><list id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.4"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑖</ci><ci id="S4.E9.m1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply><apply id="S4.E9.m1.8.8.4.cmml" xref="S4.E9.m1.8.8.4"><plus id="S4.E9.m1.8.8.4.3.cmml" xref="S4.E9.m1.8.8.4.3"></plus><apply id="S4.E9.m1.7.7.3.1.cmml" xref="S4.E9.m1.7.7.3.1"><apply id="S4.E9.m1.7.7.3.1.2.cmml" xref="S4.E9.m1.7.7.3.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.3.1.2.1.cmml" xref="S4.E9.m1.7.7.3.1.2">superscript</csymbol><apply id="S4.E9.m1.7.7.3.1.2.2.cmml" xref="S4.E9.m1.7.7.3.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.3.1.2.2.1.cmml" xref="S4.E9.m1.7.7.3.1.2">subscript</csymbol><sum id="S4.E9.m1.7.7.3.1.2.2.2.cmml" xref="S4.E9.m1.7.7.3.1.2.2.2"></sum><apply id="S4.E9.m1.7.7.3.1.2.2.3.cmml" xref="S4.E9.m1.7.7.3.1.2.2.3"><eq id="S4.E9.m1.7.7.3.1.2.2.3.1.cmml" xref="S4.E9.m1.7.7.3.1.2.2.3.1"></eq><ci id="S4.E9.m1.7.7.3.1.2.2.3.2.cmml" xref="S4.E9.m1.7.7.3.1.2.2.3.2">𝑖</ci><cn id="S4.E9.m1.7.7.3.1.2.2.3.3.cmml" type="integer" xref="S4.E9.m1.7.7.3.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.7.7.3.1.2.3.cmml" xref="S4.E9.m1.7.7.3.1.2.3">𝑚</ci></apply><apply id="S4.E9.m1.7.7.3.1.1.cmml" xref="S4.E9.m1.7.7.3.1.1"><times id="S4.E9.m1.7.7.3.1.1.2.cmml" xref="S4.E9.m1.7.7.3.1.1.2"></times><apply id="S4.E9.m1.7.7.3.1.1.3.cmml" xref="S4.E9.m1.7.7.3.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.3.1.1.3.1.cmml" xref="S4.E9.m1.7.7.3.1.1.3">subscript</csymbol><ci id="S4.E9.m1.7.7.3.1.1.3.2.cmml" xref="S4.E9.m1.7.7.3.1.1.3.2">𝑑</ci><ci id="S4.E9.m1.7.7.3.1.1.3.3.cmml" xref="S4.E9.m1.7.7.3.1.1.3.3">𝑖</ci></apply><apply id="S4.E9.m1.7.7.3.1.1.1.cmml" xref="S4.E9.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.3.1.1.1.2.cmml" xref="S4.E9.m1.7.7.3.1.1.1">superscript</csymbol><apply id="S4.E9.m1.7.7.3.1.1.1.1.2.cmml" xref="S4.E9.m1.7.7.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.7.7.3.1.1.1.1.2.1.cmml" xref="S4.E9.m1.7.7.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.E9.m1.7.7.3.1.1.1.1.1.1.cmml" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.3.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.7.7.3.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.E9.m1.7.7.3.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.7.7.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.E9.m1.7.7.3.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.7.7.3.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.E9.m1.8.8.4.2.cmml" xref="S4.E9.m1.8.8.4.2"><apply id="S4.E9.m1.8.8.4.2.2.cmml" xref="S4.E9.m1.8.8.4.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.4.2.2.1.cmml" xref="S4.E9.m1.8.8.4.2.2">superscript</csymbol><apply id="S4.E9.m1.8.8.4.2.2.2.cmml" xref="S4.E9.m1.8.8.4.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.4.2.2.2.1.cmml" xref="S4.E9.m1.8.8.4.2.2">subscript</csymbol><sum id="S4.E9.m1.8.8.4.2.2.2.2.cmml" xref="S4.E9.m1.8.8.4.2.2.2.2"></sum><apply id="S4.E9.m1.8.8.4.2.2.2.3.cmml" xref="S4.E9.m1.8.8.4.2.2.2.3"><eq id="S4.E9.m1.8.8.4.2.2.2.3.1.cmml" xref="S4.E9.m1.8.8.4.2.2.2.3.1"></eq><ci id="S4.E9.m1.8.8.4.2.2.2.3.2.cmml" xref="S4.E9.m1.8.8.4.2.2.2.3.2">𝑖</ci><cn id="S4.E9.m1.8.8.4.2.2.2.3.3.cmml" type="integer" xref="S4.E9.m1.8.8.4.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.8.8.4.2.2.3.cmml" xref="S4.E9.m1.8.8.4.2.2.3">𝜌</ci></apply><apply id="S4.E9.m1.8.8.4.2.1.cmml" xref="S4.E9.m1.8.8.4.2.1"><times id="S4.E9.m1.8.8.4.2.1.2.cmml" xref="S4.E9.m1.8.8.4.2.1.2"></times><apply id="S4.E9.m1.8.8.4.2.1.3.cmml" xref="S4.E9.m1.8.8.4.2.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.4.2.1.3.1.cmml" xref="S4.E9.m1.8.8.4.2.1.3">subscript</csymbol><ci id="S4.E9.m1.8.8.4.2.1.3.2.cmml" xref="S4.E9.m1.8.8.4.2.1.3.2">𝑒</ci><ci id="S4.E9.m1.8.8.4.2.1.3.3.cmml" xref="S4.E9.m1.8.8.4.2.1.3.3">𝑖</ci></apply><apply id="S4.E9.m1.8.8.4.2.1.1.cmml" xref="S4.E9.m1.8.8.4.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.4.2.1.1.2.cmml" xref="S4.E9.m1.8.8.4.2.1.1">superscript</csymbol><apply id="S4.E9.m1.8.8.4.2.1.1.1.2.cmml" xref="S4.E9.m1.8.8.4.2.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.8.8.4.2.1.1.1.2.1.cmml" xref="S4.E9.m1.8.8.4.2.1.1.1.1.2">norm</csymbol><apply id="S4.E9.m1.8.8.4.2.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.4.2.1.1.1.1.1.1.cmml" xref="S4.E9.m1.8.8.4.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.8.8.4.2.1.1.1.1.1.2.cmml" xref="S4.E9.m1.8.8.4.2.1.1.1.1.1.2">𝑷</ci><list id="S4.E9.m1.4.4.2.3.cmml" xref="S4.E9.m1.4.4.2.4"><ci id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1">𝑖</ci><ci id="S4.E9.m1.4.4.2.2.cmml" xref="S4.E9.m1.4.4.2.2">:</ci></list></apply></apply><cn id="S4.E9.m1.8.8.4.2.1.1.3.cmml" type="integer" xref="S4.E9.m1.8.8.4.2.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.8c">\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}=%
\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{\rho}{e}_{i}\|{\bm{P}}_{%
i,:}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.8d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_P start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_proof" id="S4.SS1.3">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div class="ltx_para" id="S4.SS1.3.p1">
<p class="ltx_p" id="S4.SS1.3.p1.2">Invoking Identity <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#Thmidentity1" title="Identity 1. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> with <math alttext="{\bm{A}}={\bm{V}}" class="ltx_Math" display="inline" id="S4.SS1.3.p1.1.m1.1"><semantics id="S4.SS1.3.p1.1.m1.1a"><mrow id="S4.SS1.3.p1.1.m1.1.1" xref="S4.SS1.3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.3.p1.1.m1.1.1.2" xref="S4.SS1.3.p1.1.m1.1.1.2.cmml">𝑨</mi><mo id="S4.SS1.3.p1.1.m1.1.1.1" xref="S4.SS1.3.p1.1.m1.1.1.1.cmml">=</mo><mi id="S4.SS1.3.p1.1.m1.1.1.3" xref="S4.SS1.3.p1.1.m1.1.1.3.cmml">𝑽</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.p1.1.m1.1b"><apply id="S4.SS1.3.p1.1.m1.1.1.cmml" xref="S4.SS1.3.p1.1.m1.1.1"><eq id="S4.SS1.3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.3.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.3.p1.1.m1.1.1.2">𝑨</ci><ci id="S4.SS1.3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.3.p1.1.m1.1.1.3">𝑽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.p1.1.m1.1c">{\bm{A}}={\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.p1.1.m1.1d">bold_italic_A = bold_italic_V</annotation></semantics></math> and <math alttext="{\bm{Q}}={\bm{R}}" class="ltx_Math" display="inline" id="S4.SS1.3.p1.2.m2.1"><semantics id="S4.SS1.3.p1.2.m2.1a"><mrow id="S4.SS1.3.p1.2.m2.1.1" xref="S4.SS1.3.p1.2.m2.1.1.cmml"><mi id="S4.SS1.3.p1.2.m2.1.1.2" xref="S4.SS1.3.p1.2.m2.1.1.2.cmml">𝑸</mi><mo id="S4.SS1.3.p1.2.m2.1.1.1" xref="S4.SS1.3.p1.2.m2.1.1.1.cmml">=</mo><mi id="S4.SS1.3.p1.2.m2.1.1.3" xref="S4.SS1.3.p1.2.m2.1.1.3.cmml">𝑹</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.p1.2.m2.1b"><apply id="S4.SS1.3.p1.2.m2.1.1.cmml" xref="S4.SS1.3.p1.2.m2.1.1"><eq id="S4.SS1.3.p1.2.m2.1.1.1.cmml" xref="S4.SS1.3.p1.2.m2.1.1.1"></eq><ci id="S4.SS1.3.p1.2.m2.1.1.2.cmml" xref="S4.SS1.3.p1.2.m2.1.1.2">𝑸</ci><ci id="S4.SS1.3.p1.2.m2.1.1.3.cmml" xref="S4.SS1.3.p1.2.m2.1.1.3">𝑹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.p1.2.m2.1c">{\bm{Q}}={\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.p1.2.m2.1d">bold_italic_Q = bold_italic_R</annotation></semantics></math>, and then using the decomposition in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.E8" title="In Proposition 0. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>) we have</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}%
\rangle{R}_{i,j}" class="ltx_Math" display="inline" id="S4.Ex4.m1.4"><semantics id="S4.Ex4.m1.4a"><mrow id="S4.Ex4.m1.4.4" xref="S4.Ex4.m1.4.4.cmml"><mstyle displaystyle="true" id="S4.Ex4.m1.4.4.3" xref="S4.Ex4.m1.4.4.3.cmml"><munderover id="S4.Ex4.m1.4.4.3a" xref="S4.Ex4.m1.4.4.3.cmml"><mo id="S4.Ex4.m1.4.4.3.2.2" movablelimits="false" xref="S4.Ex4.m1.4.4.3.2.2.cmml">∑</mo><mrow id="S4.Ex4.m1.4.4.3.2.3" xref="S4.Ex4.m1.4.4.3.2.3.cmml"><mi id="S4.Ex4.m1.4.4.3.2.3.2" xref="S4.Ex4.m1.4.4.3.2.3.2.cmml">i</mi><mo id="S4.Ex4.m1.4.4.3.2.3.1" xref="S4.Ex4.m1.4.4.3.2.3.1.cmml">=</mo><mn id="S4.Ex4.m1.4.4.3.2.3.3" xref="S4.Ex4.m1.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex4.m1.4.4.3.3" xref="S4.Ex4.m1.4.4.3.3.cmml">m</mi></munderover></mstyle><mrow id="S4.Ex4.m1.4.4.2" xref="S4.Ex4.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S4.Ex4.m1.4.4.2.3" xref="S4.Ex4.m1.4.4.2.3.cmml"><munderover id="S4.Ex4.m1.4.4.2.3a" xref="S4.Ex4.m1.4.4.2.3.cmml"><mo id="S4.Ex4.m1.4.4.2.3.2.2" movablelimits="false" xref="S4.Ex4.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex4.m1.4.4.2.3.2.3" xref="S4.Ex4.m1.4.4.2.3.2.3.cmml"><mi id="S4.Ex4.m1.4.4.2.3.2.3.2" xref="S4.Ex4.m1.4.4.2.3.2.3.2.cmml">j</mi><mo id="S4.Ex4.m1.4.4.2.3.2.3.1" xref="S4.Ex4.m1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex4.m1.4.4.2.3.2.3.3" xref="S4.Ex4.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex4.m1.4.4.2.3.3" xref="S4.Ex4.m1.4.4.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S4.Ex4.m1.4.4.2.2" xref="S4.Ex4.m1.4.4.2.2.cmml"><mrow id="S4.Ex4.m1.4.4.2.2.2.2" xref="S4.Ex4.m1.4.4.2.2.2.3.cmml"><mo id="S4.Ex4.m1.4.4.2.2.2.2.3" stretchy="false" xref="S4.Ex4.m1.4.4.2.2.2.3.cmml">⟨</mo><msub id="S4.Ex4.m1.3.3.1.1.1.1.1" xref="S4.Ex4.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.Ex4.m1.3.3.1.1.1.1.1.2" xref="S4.Ex4.m1.3.3.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex4.m1.3.3.1.1.1.1.1.3" xref="S4.Ex4.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex4.m1.4.4.2.2.2.2.4" xref="S4.Ex4.m1.4.4.2.2.2.3.cmml">,</mo><msub id="S4.Ex4.m1.4.4.2.2.2.2.2" xref="S4.Ex4.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.Ex4.m1.4.4.2.2.2.2.2.2" xref="S4.Ex4.m1.4.4.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S4.Ex4.m1.4.4.2.2.2.2.2.3" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.Ex4.m1.4.4.2.2.2.2.5" stretchy="false" xref="S4.Ex4.m1.4.4.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.Ex4.m1.4.4.2.2.3" xref="S4.Ex4.m1.4.4.2.2.3.cmml">⁢</mo><msub id="S4.Ex4.m1.4.4.2.2.4" xref="S4.Ex4.m1.4.4.2.2.4.cmml"><mi id="S4.Ex4.m1.4.4.2.2.4.2" xref="S4.Ex4.m1.4.4.2.2.4.2.cmml">R</mi><mrow id="S4.Ex4.m1.2.2.2.4" xref="S4.Ex4.m1.2.2.2.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex4.m1.2.2.2.4.1" xref="S4.Ex4.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex4.m1.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.4b"><apply id="S4.Ex4.m1.4.4.cmml" xref="S4.Ex4.m1.4.4"><apply id="S4.Ex4.m1.4.4.3.cmml" xref="S4.Ex4.m1.4.4.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.3.1.cmml" xref="S4.Ex4.m1.4.4.3">superscript</csymbol><apply id="S4.Ex4.m1.4.4.3.2.cmml" xref="S4.Ex4.m1.4.4.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.3.2.1.cmml" xref="S4.Ex4.m1.4.4.3">subscript</csymbol><sum id="S4.Ex4.m1.4.4.3.2.2.cmml" xref="S4.Ex4.m1.4.4.3.2.2"></sum><apply id="S4.Ex4.m1.4.4.3.2.3.cmml" xref="S4.Ex4.m1.4.4.3.2.3"><eq id="S4.Ex4.m1.4.4.3.2.3.1.cmml" xref="S4.Ex4.m1.4.4.3.2.3.1"></eq><ci id="S4.Ex4.m1.4.4.3.2.3.2.cmml" xref="S4.Ex4.m1.4.4.3.2.3.2">𝑖</ci><cn id="S4.Ex4.m1.4.4.3.2.3.3.cmml" type="integer" xref="S4.Ex4.m1.4.4.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex4.m1.4.4.3.3.cmml" xref="S4.Ex4.m1.4.4.3.3">𝑚</ci></apply><apply id="S4.Ex4.m1.4.4.2.cmml" xref="S4.Ex4.m1.4.4.2"><apply id="S4.Ex4.m1.4.4.2.3.cmml" xref="S4.Ex4.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.3.1.cmml" xref="S4.Ex4.m1.4.4.2.3">superscript</csymbol><apply id="S4.Ex4.m1.4.4.2.3.2.cmml" xref="S4.Ex4.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.3.2.1.cmml" xref="S4.Ex4.m1.4.4.2.3">subscript</csymbol><sum id="S4.Ex4.m1.4.4.2.3.2.2.cmml" xref="S4.Ex4.m1.4.4.2.3.2.2"></sum><apply id="S4.Ex4.m1.4.4.2.3.2.3.cmml" xref="S4.Ex4.m1.4.4.2.3.2.3"><eq id="S4.Ex4.m1.4.4.2.3.2.3.1.cmml" xref="S4.Ex4.m1.4.4.2.3.2.3.1"></eq><ci id="S4.Ex4.m1.4.4.2.3.2.3.2.cmml" xref="S4.Ex4.m1.4.4.2.3.2.3.2">𝑗</ci><cn id="S4.Ex4.m1.4.4.2.3.2.3.3.cmml" type="integer" xref="S4.Ex4.m1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex4.m1.4.4.2.3.3.cmml" xref="S4.Ex4.m1.4.4.2.3.3">𝑚</ci></apply><apply id="S4.Ex4.m1.4.4.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2"><times id="S4.Ex4.m1.4.4.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.3"></times><list id="S4.Ex4.m1.4.4.2.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2"><apply id="S4.Ex4.m1.3.3.1.1.1.1.1.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex4.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex4.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.Ex4.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.Ex4.m1.4.4.2.2.2.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex4.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.2">𝒗</ci><ci id="S4.Ex4.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.4.4.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S4.Ex4.m1.4.4.2.2.4.cmml" xref="S4.Ex4.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S4.Ex4.m1.4.4.2.2.4.1.cmml" xref="S4.Ex4.m1.4.4.2.2.4">subscript</csymbol><ci id="S4.Ex4.m1.4.4.2.2.4.2.cmml" xref="S4.Ex4.m1.4.4.2.2.4.2">𝑅</ci><list id="S4.Ex4.m1.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.2.4"><ci id="S4.Ex4.m1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex4.m1.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.4c">\displaystyle\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}%
\rangle{R}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m1.4d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tr}({\bm{V}}^{T}{\bm{R}}{\bm{V}})" class="ltx_Math" display="inline" id="S4.Ex4.m2.2"><semantics id="S4.Ex4.m2.2a"><mrow id="S4.Ex4.m2.2.2" xref="S4.Ex4.m2.2.2.cmml"><mi id="S4.Ex4.m2.2.2.3" xref="S4.Ex4.m2.2.2.3.cmml"></mi><mo id="S4.Ex4.m2.2.2.2" xref="S4.Ex4.m2.2.2.2.cmml">=</mo><mrow id="S4.Ex4.m2.2.2.1.1" xref="S4.Ex4.m2.2.2.1.2.cmml"><mi id="S4.Ex4.m2.1.1" xref="S4.Ex4.m2.1.1.cmml">Tr</mi><mo id="S4.Ex4.m2.2.2.1.1a" xref="S4.Ex4.m2.2.2.1.2.cmml">⁡</mo><mrow id="S4.Ex4.m2.2.2.1.1.1" xref="S4.Ex4.m2.2.2.1.2.cmml"><mo id="S4.Ex4.m2.2.2.1.1.1.2" stretchy="false" xref="S4.Ex4.m2.2.2.1.2.cmml">(</mo><mrow id="S4.Ex4.m2.2.2.1.1.1.1" xref="S4.Ex4.m2.2.2.1.1.1.1.cmml"><msup id="S4.Ex4.m2.2.2.1.1.1.1.2" xref="S4.Ex4.m2.2.2.1.1.1.1.2.cmml"><mi id="S4.Ex4.m2.2.2.1.1.1.1.2.2" xref="S4.Ex4.m2.2.2.1.1.1.1.2.2.cmml">𝑽</mi><mi id="S4.Ex4.m2.2.2.1.1.1.1.2.3" xref="S4.Ex4.m2.2.2.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.Ex4.m2.2.2.1.1.1.1.1" xref="S4.Ex4.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex4.m2.2.2.1.1.1.1.3" xref="S4.Ex4.m2.2.2.1.1.1.1.3.cmml">𝑹</mi><mo id="S4.Ex4.m2.2.2.1.1.1.1.1a" xref="S4.Ex4.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex4.m2.2.2.1.1.1.1.4" xref="S4.Ex4.m2.2.2.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S4.Ex4.m2.2.2.1.1.1.3" stretchy="false" xref="S4.Ex4.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m2.2b"><apply id="S4.Ex4.m2.2.2.cmml" xref="S4.Ex4.m2.2.2"><eq id="S4.Ex4.m2.2.2.2.cmml" xref="S4.Ex4.m2.2.2.2"></eq><csymbol cd="latexml" id="S4.Ex4.m2.2.2.3.cmml" xref="S4.Ex4.m2.2.2.3">absent</csymbol><apply id="S4.Ex4.m2.2.2.1.2.cmml" xref="S4.Ex4.m2.2.2.1.1"><ci id="S4.Ex4.m2.1.1.cmml" xref="S4.Ex4.m2.1.1">Tr</ci><apply id="S4.Ex4.m2.2.2.1.1.1.1.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1"><times id="S4.Ex4.m2.2.2.1.1.1.1.1.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.1"></times><apply id="S4.Ex4.m2.2.2.1.1.1.1.2.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex4.m2.2.2.1.1.1.1.2.1.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex4.m2.2.2.1.1.1.1.2.2.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.2.2">𝑽</ci><ci id="S4.Ex4.m2.2.2.1.1.1.1.2.3.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.2.3">𝑇</ci></apply><ci id="S4.Ex4.m2.2.2.1.1.1.1.3.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.3">𝑹</ci><ci id="S4.Ex4.m2.2.2.1.1.1.1.4.cmml" xref="S4.Ex4.m2.2.2.1.1.1.1.4">𝑽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m2.2c">\displaystyle=\operatorname{Tr}({\bm{V}}^{T}{\bm{R}}{\bm{V}})</annotation><annotation encoding="application/x-llamapun" id="S4.Ex4.m2.2d">= roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_R bold_italic_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tr}\left({\bm{V}}^{T}(\operatorname{diag}({\bm{d}}%
)+{\bm{U}}^{T}\cdot\operatorname{diag}({\bm{e}})\cdot{\bm{U}}){\bm{V}}\right)" class="ltx_Math" display="inline" id="S4.Ex5.m1.6"><semantics id="S4.Ex5.m1.6a"><mrow id="S4.Ex5.m1.6.6" xref="S4.Ex5.m1.6.6.cmml"><mi id="S4.Ex5.m1.6.6.3" xref="S4.Ex5.m1.6.6.3.cmml"></mi><mo id="S4.Ex5.m1.6.6.2" xref="S4.Ex5.m1.6.6.2.cmml">=</mo><mrow id="S4.Ex5.m1.6.6.1.1" xref="S4.Ex5.m1.6.6.1.2.cmml"><mi id="S4.Ex5.m1.5.5" xref="S4.Ex5.m1.5.5.cmml">Tr</mi><mo id="S4.Ex5.m1.6.6.1.1a" xref="S4.Ex5.m1.6.6.1.2.cmml">⁡</mo><mrow id="S4.Ex5.m1.6.6.1.1.1" xref="S4.Ex5.m1.6.6.1.2.cmml"><mo id="S4.Ex5.m1.6.6.1.1.1.2" xref="S4.Ex5.m1.6.6.1.2.cmml">(</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1" xref="S4.Ex5.m1.6.6.1.1.1.1.cmml"><msup id="S4.Ex5.m1.6.6.1.1.1.1.3" xref="S4.Ex5.m1.6.6.1.1.1.1.3.cmml"><mi id="S4.Ex5.m1.6.6.1.1.1.1.3.2" xref="S4.Ex5.m1.6.6.1.1.1.1.3.2.cmml">𝑽</mi><mi id="S4.Ex5.m1.6.6.1.1.1.1.3.3" xref="S4.Ex5.m1.6.6.1.1.1.1.3.3.cmml">T</mi></msup><mo id="S4.Ex5.m1.6.6.1.1.1.1.2" xref="S4.Ex5.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.2" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.1.cmml"><mi id="S4.Ex5.m1.1.1" xref="S4.Ex5.m1.1.1.cmml">diag</mi><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.2a" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">⁡</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.2.1" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.1.cmml"><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.2.1.1" stretchy="false" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">(</mo><mi id="S4.Ex5.m1.2.2" xref="S4.Ex5.m1.2.2.cmml">𝒅</mi><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.2.1.2" stretchy="false" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.1" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.cmml"><msup id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.2" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.2.cmml">𝑼</mi><mi id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.3" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.3.cmml">T</mi></msup><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml"><mi id="S4.Ex5.m1.3.3" xref="S4.Ex5.m1.3.3.cmml">diag</mi><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2a" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml">⁡</mo><mrow id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2.1" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2.1.1" stretchy="false" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S4.Ex5.m1.4.4" xref="S4.Ex5.m1.4.4.cmml">𝒆</mi><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2.1.2" rspace="0.055em" stretchy="false" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1a" rspace="0.222em" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.4" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.4.cmml">𝑼</mi></mrow></mrow><mo id="S4.Ex5.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex5.m1.6.6.1.1.1.1.2a" xref="S4.Ex5.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mi id="S4.Ex5.m1.6.6.1.1.1.1.4" xref="S4.Ex5.m1.6.6.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S4.Ex5.m1.6.6.1.1.1.3" xref="S4.Ex5.m1.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex5.m1.6b"><apply id="S4.Ex5.m1.6.6.cmml" xref="S4.Ex5.m1.6.6"><eq id="S4.Ex5.m1.6.6.2.cmml" xref="S4.Ex5.m1.6.6.2"></eq><csymbol cd="latexml" id="S4.Ex5.m1.6.6.3.cmml" xref="S4.Ex5.m1.6.6.3">absent</csymbol><apply id="S4.Ex5.m1.6.6.1.2.cmml" xref="S4.Ex5.m1.6.6.1.1"><ci id="S4.Ex5.m1.5.5.cmml" xref="S4.Ex5.m1.5.5">Tr</ci><apply id="S4.Ex5.m1.6.6.1.1.1.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1"><times id="S4.Ex5.m1.6.6.1.1.1.1.2.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.2"></times><apply id="S4.Ex5.m1.6.6.1.1.1.1.3.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex5.m1.6.6.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.3">superscript</csymbol><ci id="S4.Ex5.m1.6.6.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.3.2">𝑽</ci><ci id="S4.Ex5.m1.6.6.1.1.1.1.3.3.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.3.3">𝑇</ci></apply><apply id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1"><plus id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.1"></plus><apply id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.2.2"><ci id="S4.Ex5.m1.1.1.cmml" xref="S4.Ex5.m1.1.1">diag</ci><ci id="S4.Ex5.m1.2.2.cmml" xref="S4.Ex5.m1.2.2">𝒅</ci></apply><apply id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3"><ci id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.2">𝑼</ci><ci id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.3.2"><ci id="S4.Ex5.m1.3.3.cmml" xref="S4.Ex5.m1.3.3">diag</ci><ci id="S4.Ex5.m1.4.4.cmml" xref="S4.Ex5.m1.4.4">𝒆</ci></apply><ci id="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.4.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.1.1.1.3.4">𝑼</ci></apply></apply><ci id="S4.Ex5.m1.6.6.1.1.1.1.4.cmml" xref="S4.Ex5.m1.6.6.1.1.1.1.4">𝑽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex5.m1.6c">\displaystyle=\operatorname{Tr}\left({\bm{V}}^{T}(\operatorname{diag}({\bm{d}}%
)+{\bm{U}}^{T}\cdot\operatorname{diag}({\bm{e}})\cdot{\bm{U}}){\bm{V}}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.Ex5.m1.6d">= roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( roman_diag ( bold_italic_d ) + bold_italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ⋅ roman_diag ( bold_italic_e ) ⋅ bold_italic_U ) bold_italic_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tr}({\bm{V}}^{T}\operatorname{diag}({\bm{d}}){\bm{%
V}})+\operatorname{Tr}(\underbrace{({\bm{U}}{\bm{V}})^{T}}_{{\bm{P}}^{T}}%
\operatorname{diag}({\bm{e}})\underbrace{({\bm{U}}{\bm{V}})}_{{\bm{P}}})." class="ltx_Math" display="inline" id="S4.Ex6.m1.9"><semantics id="S4.Ex6.m1.9a"><mrow id="S4.Ex6.m1.9.9.1" xref="S4.Ex6.m1.9.9.1.1.cmml"><mrow id="S4.Ex6.m1.9.9.1.1" xref="S4.Ex6.m1.9.9.1.1.cmml"><mi id="S4.Ex6.m1.9.9.1.1.4" xref="S4.Ex6.m1.9.9.1.1.4.cmml"></mi><mo id="S4.Ex6.m1.9.9.1.1.3" xref="S4.Ex6.m1.9.9.1.1.3.cmml">=</mo><mrow id="S4.Ex6.m1.9.9.1.1.2" xref="S4.Ex6.m1.9.9.1.1.2.cmml"><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.2.cmml"><mi id="S4.Ex6.m1.5.5" xref="S4.Ex6.m1.5.5.cmml">Tr</mi><mo id="S4.Ex6.m1.9.9.1.1.1.1.1a" xref="S4.Ex6.m1.9.9.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.2.cmml"><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.2.cmml">(</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml"><msup id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.2.cmml">𝑽</mi><mi id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.3" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1" lspace="0.167em" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.1.cmml"><mi id="S4.Ex6.m1.3.3" xref="S4.Ex6.m1.3.3.cmml">diag</mi><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.2a" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.2.1" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.2.1.1" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex6.m1.4.4" xref="S4.Ex6.m1.4.4.cmml">𝒅</mi><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.2.1.2" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1a" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.4" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S4.Ex6.m1.9.9.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex6.m1.9.9.1.1.2.3" xref="S4.Ex6.m1.9.9.1.1.2.3.cmml">+</mo><mrow id="S4.Ex6.m1.9.9.1.1.2.2.1" xref="S4.Ex6.m1.9.9.1.1.2.2.2.cmml"><mi id="S4.Ex6.m1.8.8" xref="S4.Ex6.m1.8.8.cmml">Tr</mi><mo id="S4.Ex6.m1.9.9.1.1.2.2.1a" xref="S4.Ex6.m1.9.9.1.1.2.2.2.cmml">⁡</mo><mrow id="S4.Ex6.m1.9.9.1.1.2.2.1.1" xref="S4.Ex6.m1.9.9.1.1.2.2.2.cmml"><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.2" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.2.2.2.cmml">(</mo><mrow id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.cmml"><munder id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.cmml"><munder accentunder="true" id="S4.Ex6.m1.1.1" xref="S4.Ex6.m1.1.1.cmml"><msup id="S4.Ex6.m1.1.1.1" xref="S4.Ex6.m1.1.1.1.cmml"><mrow id="S4.Ex6.m1.1.1.1.1.1" xref="S4.Ex6.m1.1.1.1.1.1.1.cmml"><mo id="S4.Ex6.m1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex6.m1.1.1.1.1.1.1" xref="S4.Ex6.m1.1.1.1.1.1.1.cmml"><mi id="S4.Ex6.m1.1.1.1.1.1.1.2" xref="S4.Ex6.m1.1.1.1.1.1.1.2.cmml">𝑼</mi><mo id="S4.Ex6.m1.1.1.1.1.1.1.1" xref="S4.Ex6.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex6.m1.1.1.1.1.1.1.3" xref="S4.Ex6.m1.1.1.1.1.1.1.3.cmml">𝑽</mi></mrow><mo id="S4.Ex6.m1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex6.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S4.Ex6.m1.1.1.1.3" xref="S4.Ex6.m1.1.1.1.3.cmml">T</mi></msup><mo id="S4.Ex6.m1.1.1.2" xref="S4.Ex6.m1.1.1.2.cmml">⏟</mo></munder><msup id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.cmml"><mi id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.2" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.2.cmml">𝑷</mi><mi id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.3" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.3.cmml">T</mi></msup></munder><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.1" lspace="0.167em" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.2" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.1.cmml"><mi id="S4.Ex6.m1.6.6" xref="S4.Ex6.m1.6.6.cmml">diag</mi><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.2a" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.2.1" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.1.cmml"><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.2.1.1" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex6.m1.7.7" xref="S4.Ex6.m1.7.7.cmml">𝒆</mi><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.2.1.2" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.1a" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.1.cmml">⁢</mo><munder id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.cmml"><munder accentunder="true" id="S4.Ex6.m1.2.2" xref="S4.Ex6.m1.2.2.cmml"><mrow id="S4.Ex6.m1.2.2.1.1" xref="S4.Ex6.m1.2.2.1.1.1.cmml"><mo id="S4.Ex6.m1.2.2.1.1.2" stretchy="false" xref="S4.Ex6.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.Ex6.m1.2.2.1.1.1" xref="S4.Ex6.m1.2.2.1.1.1.cmml"><mi id="S4.Ex6.m1.2.2.1.1.1.2" xref="S4.Ex6.m1.2.2.1.1.1.2.cmml">𝑼</mi><mo id="S4.Ex6.m1.2.2.1.1.1.1" xref="S4.Ex6.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex6.m1.2.2.1.1.1.3" xref="S4.Ex6.m1.2.2.1.1.1.3.cmml">𝑽</mi></mrow><mo id="S4.Ex6.m1.2.2.1.1.3" stretchy="false" xref="S4.Ex6.m1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex6.m1.2.2.2" xref="S4.Ex6.m1.2.2.2.cmml">⏟</mo></munder><mi id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.2" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.2.cmml">𝑷</mi></munder></mrow><mo id="S4.Ex6.m1.9.9.1.1.2.2.1.1.3" stretchy="false" xref="S4.Ex6.m1.9.9.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex6.m1.9.9.1.2" lspace="0em" xref="S4.Ex6.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex6.m1.9b"><apply id="S4.Ex6.m1.9.9.1.1.cmml" xref="S4.Ex6.m1.9.9.1"><eq id="S4.Ex6.m1.9.9.1.1.3.cmml" xref="S4.Ex6.m1.9.9.1.1.3"></eq><csymbol cd="latexml" id="S4.Ex6.m1.9.9.1.1.4.cmml" xref="S4.Ex6.m1.9.9.1.1.4">absent</csymbol><apply id="S4.Ex6.m1.9.9.1.1.2.cmml" xref="S4.Ex6.m1.9.9.1.1.2"><plus id="S4.Ex6.m1.9.9.1.1.2.3.cmml" xref="S4.Ex6.m1.9.9.1.1.2.3"></plus><apply id="S4.Ex6.m1.9.9.1.1.1.1.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1"><ci id="S4.Ex6.m1.5.5.cmml" xref="S4.Ex6.m1.5.5">Tr</ci><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1"><times id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.1"></times><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.2">𝑽</ci><ci id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.3.2"><ci id="S4.Ex6.m1.3.3.cmml" xref="S4.Ex6.m1.3.3">diag</ci><ci id="S4.Ex6.m1.4.4.cmml" xref="S4.Ex6.m1.4.4">𝒅</ci></apply><ci id="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex6.m1.9.9.1.1.1.1.1.1.1.4">𝑽</ci></apply></apply><apply id="S4.Ex6.m1.9.9.1.1.2.2.2.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1"><ci id="S4.Ex6.m1.8.8.cmml" xref="S4.Ex6.m1.8.8">Tr</ci><apply id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1"><times id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.1.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.1"></times><apply id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.1.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2">subscript</csymbol><apply id="S4.Ex6.m1.1.1.cmml" xref="S4.Ex6.m1.1.1"><ci id="S4.Ex6.m1.1.1.2.cmml" xref="S4.Ex6.m1.1.1.2">⏟</ci><apply id="S4.Ex6.m1.1.1.1.cmml" xref="S4.Ex6.m1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex6.m1.1.1.1.2.cmml" xref="S4.Ex6.m1.1.1.1">superscript</csymbol><apply id="S4.Ex6.m1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.1.1.1.1.1"><times id="S4.Ex6.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex6.m1.1.1.1.1.1.1.1"></times><ci id="S4.Ex6.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex6.m1.1.1.1.1.1.1.2">𝑼</ci><ci id="S4.Ex6.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex6.m1.1.1.1.1.1.1.3">𝑽</ci></apply><ci id="S4.Ex6.m1.1.1.1.3.cmml" xref="S4.Ex6.m1.1.1.1.3">𝑇</ci></apply></apply><apply id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.1.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2">superscript</csymbol><ci id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.2.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.2">𝑷</ci><ci id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.3.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.2.2.3">𝑇</ci></apply></apply><apply id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.1.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.3.2"><ci id="S4.Ex6.m1.6.6.cmml" xref="S4.Ex6.m1.6.6">diag</ci><ci id="S4.Ex6.m1.7.7.cmml" xref="S4.Ex6.m1.7.7">𝒆</ci></apply><apply id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.1.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4">subscript</csymbol><apply id="S4.Ex6.m1.2.2.cmml" xref="S4.Ex6.m1.2.2"><ci id="S4.Ex6.m1.2.2.2.cmml" xref="S4.Ex6.m1.2.2.2">⏟</ci><apply id="S4.Ex6.m1.2.2.1.1.1.cmml" xref="S4.Ex6.m1.2.2.1.1"><times id="S4.Ex6.m1.2.2.1.1.1.1.cmml" xref="S4.Ex6.m1.2.2.1.1.1.1"></times><ci id="S4.Ex6.m1.2.2.1.1.1.2.cmml" xref="S4.Ex6.m1.2.2.1.1.1.2">𝑼</ci><ci id="S4.Ex6.m1.2.2.1.1.1.3.cmml" xref="S4.Ex6.m1.2.2.1.1.1.3">𝑽</ci></apply></apply><ci id="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.2.cmml" xref="S4.Ex6.m1.9.9.1.1.2.2.1.1.1.4.2">𝑷</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex6.m1.9c">\displaystyle=\operatorname{Tr}({\bm{V}}^{T}\operatorname{diag}({\bm{d}}){\bm{%
V}})+\operatorname{Tr}(\underbrace{({\bm{U}}{\bm{V}})^{T}}_{{\bm{P}}^{T}}%
\operatorname{diag}({\bm{e}})\underbrace{({\bm{U}}{\bm{V}})}_{{\bm{P}}}).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex6.m1.9d">= roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_d ) bold_italic_V ) + roman_Tr ( under⏟ start_ARG ( bold_italic_U bold_italic_V ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT bold_italic_P start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_diag ( bold_italic_e ) under⏟ start_ARG ( bold_italic_U bold_italic_V ) end_ARG start_POSTSUBSCRIPT bold_italic_P end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.3.p1.4">Invoking Identity <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#Thmidentity1" title="Identity 1. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> with <math alttext="{\bm{A}}={\bm{V}}" class="ltx_Math" display="inline" id="S4.SS1.3.p1.3.m1.1"><semantics id="S4.SS1.3.p1.3.m1.1a"><mrow id="S4.SS1.3.p1.3.m1.1.1" xref="S4.SS1.3.p1.3.m1.1.1.cmml"><mi id="S4.SS1.3.p1.3.m1.1.1.2" xref="S4.SS1.3.p1.3.m1.1.1.2.cmml">𝑨</mi><mo id="S4.SS1.3.p1.3.m1.1.1.1" xref="S4.SS1.3.p1.3.m1.1.1.1.cmml">=</mo><mi id="S4.SS1.3.p1.3.m1.1.1.3" xref="S4.SS1.3.p1.3.m1.1.1.3.cmml">𝑽</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.p1.3.m1.1b"><apply id="S4.SS1.3.p1.3.m1.1.1.cmml" xref="S4.SS1.3.p1.3.m1.1.1"><eq id="S4.SS1.3.p1.3.m1.1.1.1.cmml" xref="S4.SS1.3.p1.3.m1.1.1.1"></eq><ci id="S4.SS1.3.p1.3.m1.1.1.2.cmml" xref="S4.SS1.3.p1.3.m1.1.1.2">𝑨</ci><ci id="S4.SS1.3.p1.3.m1.1.1.3.cmml" xref="S4.SS1.3.p1.3.m1.1.1.3">𝑽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.p1.3.m1.1c">{\bm{A}}={\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.p1.3.m1.1d">bold_italic_A = bold_italic_V</annotation></semantics></math> and <math alttext="{\bm{Q}}=\operatorname{diag}({\bm{d}})" class="ltx_Math" display="inline" id="S4.SS1.3.p1.4.m2.2"><semantics id="S4.SS1.3.p1.4.m2.2a"><mrow id="S4.SS1.3.p1.4.m2.2.3" xref="S4.SS1.3.p1.4.m2.2.3.cmml"><mi id="S4.SS1.3.p1.4.m2.2.3.2" xref="S4.SS1.3.p1.4.m2.2.3.2.cmml">𝑸</mi><mo id="S4.SS1.3.p1.4.m2.2.3.1" xref="S4.SS1.3.p1.4.m2.2.3.1.cmml">=</mo><mrow id="S4.SS1.3.p1.4.m2.2.3.3.2" xref="S4.SS1.3.p1.4.m2.2.3.3.1.cmml"><mi id="S4.SS1.3.p1.4.m2.1.1" xref="S4.SS1.3.p1.4.m2.1.1.cmml">diag</mi><mo id="S4.SS1.3.p1.4.m2.2.3.3.2a" xref="S4.SS1.3.p1.4.m2.2.3.3.1.cmml">⁡</mo><mrow id="S4.SS1.3.p1.4.m2.2.3.3.2.1" xref="S4.SS1.3.p1.4.m2.2.3.3.1.cmml"><mo id="S4.SS1.3.p1.4.m2.2.3.3.2.1.1" stretchy="false" xref="S4.SS1.3.p1.4.m2.2.3.3.1.cmml">(</mo><mi id="S4.SS1.3.p1.4.m2.2.2" xref="S4.SS1.3.p1.4.m2.2.2.cmml">𝒅</mi><mo id="S4.SS1.3.p1.4.m2.2.3.3.2.1.2" stretchy="false" xref="S4.SS1.3.p1.4.m2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.p1.4.m2.2b"><apply id="S4.SS1.3.p1.4.m2.2.3.cmml" xref="S4.SS1.3.p1.4.m2.2.3"><eq id="S4.SS1.3.p1.4.m2.2.3.1.cmml" xref="S4.SS1.3.p1.4.m2.2.3.1"></eq><ci id="S4.SS1.3.p1.4.m2.2.3.2.cmml" xref="S4.SS1.3.p1.4.m2.2.3.2">𝑸</ci><apply id="S4.SS1.3.p1.4.m2.2.3.3.1.cmml" xref="S4.SS1.3.p1.4.m2.2.3.3.2"><ci id="S4.SS1.3.p1.4.m2.1.1.cmml" xref="S4.SS1.3.p1.4.m2.1.1">diag</ci><ci id="S4.SS1.3.p1.4.m2.2.2.cmml" xref="S4.SS1.3.p1.4.m2.2.2">𝒅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.p1.4.m2.2c">{\bm{Q}}=\operatorname{diag}({\bm{d}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.p1.4.m2.2d">bold_italic_Q = roman_diag ( bold_italic_d )</annotation></semantics></math>, we obtain</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{Tr}({\bm{V}}^{T}\operatorname{diag}({\bm{d}}){\bm{V}})=\sum_{i=1%
}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}," class="ltx_Math" display="block" id="S4.Ex7.m1.4"><semantics id="S4.Ex7.m1.4a"><mrow id="S4.Ex7.m1.4.4.1" xref="S4.Ex7.m1.4.4.1.1.cmml"><mrow id="S4.Ex7.m1.4.4.1.1" xref="S4.Ex7.m1.4.4.1.1.cmml"><mrow id="S4.Ex7.m1.4.4.1.1.1.1" xref="S4.Ex7.m1.4.4.1.1.1.2.cmml"><mi id="S4.Ex7.m1.3.3" xref="S4.Ex7.m1.3.3.cmml">Tr</mi><mo id="S4.Ex7.m1.4.4.1.1.1.1a" xref="S4.Ex7.m1.4.4.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex7.m1.4.4.1.1.1.1.1" xref="S4.Ex7.m1.4.4.1.1.1.2.cmml"><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.Ex7.m1.4.4.1.1.1.2.cmml">(</mo><mrow id="S4.Ex7.m1.4.4.1.1.1.1.1.1" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.cmml"><msup id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.2" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝑽</mi><mi id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.1.1" lspace="0.167em" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mi id="S4.Ex7.m1.1.1" xref="S4.Ex7.m1.1.1.cmml">diag</mi><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.2a" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.2.1" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.2.1.1" stretchy="false" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex7.m1.2.2" xref="S4.Ex7.m1.2.2.cmml">𝒅</mi><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.2.1.2" stretchy="false" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.1.1a" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex7.m1.4.4.1.1.1.1.1.1.4" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S4.Ex7.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.Ex7.m1.4.4.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex7.m1.4.4.1.1.3" rspace="0.111em" xref="S4.Ex7.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.Ex7.m1.4.4.1.1.2" xref="S4.Ex7.m1.4.4.1.1.2.cmml"><munderover id="S4.Ex7.m1.4.4.1.1.2.2" xref="S4.Ex7.m1.4.4.1.1.2.2.cmml"><mo id="S4.Ex7.m1.4.4.1.1.2.2.2.2" movablelimits="false" xref="S4.Ex7.m1.4.4.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.Ex7.m1.4.4.1.1.2.2.2.3" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.cmml"><mi id="S4.Ex7.m1.4.4.1.1.2.2.2.3.2" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.Ex7.m1.4.4.1.1.2.2.2.3.1" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.Ex7.m1.4.4.1.1.2.2.2.3.3" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex7.m1.4.4.1.1.2.2.3" xref="S4.Ex7.m1.4.4.1.1.2.2.3.cmml">m</mi></munderover><mrow id="S4.Ex7.m1.4.4.1.1.2.1" xref="S4.Ex7.m1.4.4.1.1.2.1.cmml"><msub id="S4.Ex7.m1.4.4.1.1.2.1.3" xref="S4.Ex7.m1.4.4.1.1.2.1.3.cmml"><mi id="S4.Ex7.m1.4.4.1.1.2.1.3.2" xref="S4.Ex7.m1.4.4.1.1.2.1.3.2.cmml">d</mi><mi id="S4.Ex7.m1.4.4.1.1.2.1.3.3" xref="S4.Ex7.m1.4.4.1.1.2.1.3.3.cmml">i</mi></msub><mo id="S4.Ex7.m1.4.4.1.1.2.1.2" xref="S4.Ex7.m1.4.4.1.1.2.1.2.cmml">⁢</mo><msup id="S4.Ex7.m1.4.4.1.1.2.1.1" xref="S4.Ex7.m1.4.4.1.1.2.1.1.cmml"><mrow id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.2.cmml"><mo id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.2" stretchy="false" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.cmml"><mi id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.2" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.3" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.3" stretchy="false" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex7.m1.4.4.1.1.2.1.1.3" xref="S4.Ex7.m1.4.4.1.1.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S4.Ex7.m1.4.4.1.2" xref="S4.Ex7.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex7.m1.4b"><apply id="S4.Ex7.m1.4.4.1.1.cmml" xref="S4.Ex7.m1.4.4.1"><eq id="S4.Ex7.m1.4.4.1.1.3.cmml" xref="S4.Ex7.m1.4.4.1.1.3"></eq><apply id="S4.Ex7.m1.4.4.1.1.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1"><ci id="S4.Ex7.m1.3.3.cmml" xref="S4.Ex7.m1.3.3">Tr</ci><apply id="S4.Ex7.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1"><times id="S4.Ex7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.1"></times><apply id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.2">𝑽</ci><ci id="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.3.2"><ci id="S4.Ex7.m1.1.1.cmml" xref="S4.Ex7.m1.1.1">diag</ci><ci id="S4.Ex7.m1.2.2.cmml" xref="S4.Ex7.m1.2.2">𝒅</ci></apply><ci id="S4.Ex7.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S4.Ex7.m1.4.4.1.1.1.1.1.1.4">𝑽</ci></apply></apply><apply id="S4.Ex7.m1.4.4.1.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2"><apply id="S4.Ex7.m1.4.4.1.1.2.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex7.m1.4.4.1.1.2.2.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2">superscript</csymbol><apply id="S4.Ex7.m1.4.4.1.1.2.2.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex7.m1.4.4.1.1.2.2.2.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2">subscript</csymbol><sum id="S4.Ex7.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2.2.2"></sum><apply id="S4.Ex7.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3"><eq id="S4.Ex7.m1.4.4.1.1.2.2.2.3.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.1"></eq><ci id="S4.Ex7.m1.4.4.1.1.2.2.2.3.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.2">𝑖</ci><cn id="S4.Ex7.m1.4.4.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.Ex7.m1.4.4.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex7.m1.4.4.1.1.2.2.3.cmml" xref="S4.Ex7.m1.4.4.1.1.2.2.3">𝑚</ci></apply><apply id="S4.Ex7.m1.4.4.1.1.2.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1"><times id="S4.Ex7.m1.4.4.1.1.2.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.2"></times><apply id="S4.Ex7.m1.4.4.1.1.2.1.3.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.Ex7.m1.4.4.1.1.2.1.3.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.3">subscript</csymbol><ci id="S4.Ex7.m1.4.4.1.1.2.1.3.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.3.2">𝑑</ci><ci id="S4.Ex7.m1.4.4.1.1.2.1.3.3.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.3.3">𝑖</ci></apply><apply id="S4.Ex7.m1.4.4.1.1.2.1.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.Ex7.m1.4.4.1.1.2.1.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1">superscript</csymbol><apply id="S4.Ex7.m1.4.4.1.1.2.1.1.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S4.Ex7.m1.4.4.1.1.2.1.1.1.2.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.2">norm</csymbol><apply id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.2.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.3.cmml" xref="S4.Ex7.m1.4.4.1.1.2.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.Ex7.m1.4.4.1.1.2.1.1.3.cmml" type="integer" xref="S4.Ex7.m1.4.4.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex7.m1.4c">\operatorname{Tr}({\bm{V}}^{T}\operatorname{diag}({\bm{d}}){\bm{V}})=\sum_{i=1%
}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex7.m1.4d">roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_d ) bold_italic_V ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.3.p1.6">and again with <math alttext="{\bm{A}}={\bm{P}}" class="ltx_Math" display="inline" id="S4.SS1.3.p1.5.m1.1"><semantics id="S4.SS1.3.p1.5.m1.1a"><mrow id="S4.SS1.3.p1.5.m1.1.1" xref="S4.SS1.3.p1.5.m1.1.1.cmml"><mi id="S4.SS1.3.p1.5.m1.1.1.2" xref="S4.SS1.3.p1.5.m1.1.1.2.cmml">𝑨</mi><mo id="S4.SS1.3.p1.5.m1.1.1.1" xref="S4.SS1.3.p1.5.m1.1.1.1.cmml">=</mo><mi id="S4.SS1.3.p1.5.m1.1.1.3" xref="S4.SS1.3.p1.5.m1.1.1.3.cmml">𝑷</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.p1.5.m1.1b"><apply id="S4.SS1.3.p1.5.m1.1.1.cmml" xref="S4.SS1.3.p1.5.m1.1.1"><eq id="S4.SS1.3.p1.5.m1.1.1.1.cmml" xref="S4.SS1.3.p1.5.m1.1.1.1"></eq><ci id="S4.SS1.3.p1.5.m1.1.1.2.cmml" xref="S4.SS1.3.p1.5.m1.1.1.2">𝑨</ci><ci id="S4.SS1.3.p1.5.m1.1.1.3.cmml" xref="S4.SS1.3.p1.5.m1.1.1.3">𝑷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.p1.5.m1.1c">{\bm{A}}={\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.p1.5.m1.1d">bold_italic_A = bold_italic_P</annotation></semantics></math> and <math alttext="{\bm{Q}}=\operatorname{diag}({\bm{e}})" class="ltx_Math" display="inline" id="S4.SS1.3.p1.6.m2.2"><semantics id="S4.SS1.3.p1.6.m2.2a"><mrow id="S4.SS1.3.p1.6.m2.2.3" xref="S4.SS1.3.p1.6.m2.2.3.cmml"><mi id="S4.SS1.3.p1.6.m2.2.3.2" xref="S4.SS1.3.p1.6.m2.2.3.2.cmml">𝑸</mi><mo id="S4.SS1.3.p1.6.m2.2.3.1" xref="S4.SS1.3.p1.6.m2.2.3.1.cmml">=</mo><mrow id="S4.SS1.3.p1.6.m2.2.3.3.2" xref="S4.SS1.3.p1.6.m2.2.3.3.1.cmml"><mi id="S4.SS1.3.p1.6.m2.1.1" xref="S4.SS1.3.p1.6.m2.1.1.cmml">diag</mi><mo id="S4.SS1.3.p1.6.m2.2.3.3.2a" xref="S4.SS1.3.p1.6.m2.2.3.3.1.cmml">⁡</mo><mrow id="S4.SS1.3.p1.6.m2.2.3.3.2.1" xref="S4.SS1.3.p1.6.m2.2.3.3.1.cmml"><mo id="S4.SS1.3.p1.6.m2.2.3.3.2.1.1" stretchy="false" xref="S4.SS1.3.p1.6.m2.2.3.3.1.cmml">(</mo><mi id="S4.SS1.3.p1.6.m2.2.2" xref="S4.SS1.3.p1.6.m2.2.2.cmml">𝒆</mi><mo id="S4.SS1.3.p1.6.m2.2.3.3.2.1.2" stretchy="false" xref="S4.SS1.3.p1.6.m2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.p1.6.m2.2b"><apply id="S4.SS1.3.p1.6.m2.2.3.cmml" xref="S4.SS1.3.p1.6.m2.2.3"><eq id="S4.SS1.3.p1.6.m2.2.3.1.cmml" xref="S4.SS1.3.p1.6.m2.2.3.1"></eq><ci id="S4.SS1.3.p1.6.m2.2.3.2.cmml" xref="S4.SS1.3.p1.6.m2.2.3.2">𝑸</ci><apply id="S4.SS1.3.p1.6.m2.2.3.3.1.cmml" xref="S4.SS1.3.p1.6.m2.2.3.3.2"><ci id="S4.SS1.3.p1.6.m2.1.1.cmml" xref="S4.SS1.3.p1.6.m2.1.1">diag</ci><ci id="S4.SS1.3.p1.6.m2.2.2.cmml" xref="S4.SS1.3.p1.6.m2.2.2">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.p1.6.m2.2c">{\bm{Q}}=\operatorname{diag}({\bm{e}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.p1.6.m2.2d">bold_italic_Q = roman_diag ( bold_italic_e )</annotation></semantics></math> we obtain</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{Tr}({\bm{P}}^{T}\operatorname{diag}({\bm{e}}){\bm{P}})=\sum_{i=1%
}^{\rho}{e}_{i}\|{\bm{P}}_{i,:}\|^{2}." class="ltx_Math" display="block" id="S4.Ex8.m1.6"><semantics id="S4.Ex8.m1.6a"><mrow id="S4.Ex8.m1.6.6.1" xref="S4.Ex8.m1.6.6.1.1.cmml"><mrow id="S4.Ex8.m1.6.6.1.1" xref="S4.Ex8.m1.6.6.1.1.cmml"><mrow id="S4.Ex8.m1.6.6.1.1.1.1" xref="S4.Ex8.m1.6.6.1.1.1.2.cmml"><mi id="S4.Ex8.m1.5.5" xref="S4.Ex8.m1.5.5.cmml">Tr</mi><mo id="S4.Ex8.m1.6.6.1.1.1.1a" xref="S4.Ex8.m1.6.6.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex8.m1.6.6.1.1.1.1.1" xref="S4.Ex8.m1.6.6.1.1.1.2.cmml"><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S4.Ex8.m1.6.6.1.1.1.2.cmml">(</mo><mrow id="S4.Ex8.m1.6.6.1.1.1.1.1.1" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.cmml"><msup id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.2" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.2.cmml">𝑷</mi><mi id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.3" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.1.1" lspace="0.167em" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.2" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.1.cmml"><mi id="S4.Ex8.m1.3.3" xref="S4.Ex8.m1.3.3.cmml">diag</mi><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.2a" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.2.1" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.2.1.1" stretchy="false" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex8.m1.4.4" xref="S4.Ex8.m1.4.4.cmml">𝒆</mi><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.2.1.2" stretchy="false" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.1.1a" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex8.m1.6.6.1.1.1.1.1.1.4" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.4.cmml">𝑷</mi></mrow><mo id="S4.Ex8.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S4.Ex8.m1.6.6.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.Ex8.m1.6.6.1.1.3" rspace="0.111em" xref="S4.Ex8.m1.6.6.1.1.3.cmml">=</mo><mrow id="S4.Ex8.m1.6.6.1.1.2" xref="S4.Ex8.m1.6.6.1.1.2.cmml"><munderover id="S4.Ex8.m1.6.6.1.1.2.2" xref="S4.Ex8.m1.6.6.1.1.2.2.cmml"><mo id="S4.Ex8.m1.6.6.1.1.2.2.2.2" movablelimits="false" xref="S4.Ex8.m1.6.6.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.Ex8.m1.6.6.1.1.2.2.2.3" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.cmml"><mi id="S4.Ex8.m1.6.6.1.1.2.2.2.3.2" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.Ex8.m1.6.6.1.1.2.2.2.3.1" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.Ex8.m1.6.6.1.1.2.2.2.3.3" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex8.m1.6.6.1.1.2.2.3" xref="S4.Ex8.m1.6.6.1.1.2.2.3.cmml">ρ</mi></munderover><mrow id="S4.Ex8.m1.6.6.1.1.2.1" xref="S4.Ex8.m1.6.6.1.1.2.1.cmml"><msub id="S4.Ex8.m1.6.6.1.1.2.1.3" xref="S4.Ex8.m1.6.6.1.1.2.1.3.cmml"><mi id="S4.Ex8.m1.6.6.1.1.2.1.3.2" xref="S4.Ex8.m1.6.6.1.1.2.1.3.2.cmml">e</mi><mi id="S4.Ex8.m1.6.6.1.1.2.1.3.3" xref="S4.Ex8.m1.6.6.1.1.2.1.3.3.cmml">i</mi></msub><mo id="S4.Ex8.m1.6.6.1.1.2.1.2" xref="S4.Ex8.m1.6.6.1.1.2.1.2.cmml">⁢</mo><msup id="S4.Ex8.m1.6.6.1.1.2.1.1" xref="S4.Ex8.m1.6.6.1.1.2.1.1.cmml"><mrow id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.2.cmml"><mo id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.2" stretchy="false" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.cmml"><mi id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.2" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.2.cmml">𝑷</mi><mrow id="S4.Ex8.m1.2.2.2.4" xref="S4.Ex8.m1.2.2.2.3.cmml"><mi id="S4.Ex8.m1.1.1.1.1" xref="S4.Ex8.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex8.m1.2.2.2.4.1" xref="S4.Ex8.m1.2.2.2.3.cmml">,</mo><mo id="S4.Ex8.m1.2.2.2.2" xref="S4.Ex8.m1.2.2.2.2.cmml">:</mo></mrow></msub><mo id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.3" stretchy="false" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex8.m1.6.6.1.1.2.1.1.3" xref="S4.Ex8.m1.6.6.1.1.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S4.Ex8.m1.6.6.1.2" lspace="0em" xref="S4.Ex8.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex8.m1.6b"><apply id="S4.Ex8.m1.6.6.1.1.cmml" xref="S4.Ex8.m1.6.6.1"><eq id="S4.Ex8.m1.6.6.1.1.3.cmml" xref="S4.Ex8.m1.6.6.1.1.3"></eq><apply id="S4.Ex8.m1.6.6.1.1.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1"><ci id="S4.Ex8.m1.5.5.cmml" xref="S4.Ex8.m1.5.5">Tr</ci><apply id="S4.Ex8.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1"><times id="S4.Ex8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.1"></times><apply id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.2">𝑷</ci><ci id="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.3.2"><ci id="S4.Ex8.m1.3.3.cmml" xref="S4.Ex8.m1.3.3">diag</ci><ci id="S4.Ex8.m1.4.4.cmml" xref="S4.Ex8.m1.4.4">𝒆</ci></apply><ci id="S4.Ex8.m1.6.6.1.1.1.1.1.1.4.cmml" xref="S4.Ex8.m1.6.6.1.1.1.1.1.1.4">𝑷</ci></apply></apply><apply id="S4.Ex8.m1.6.6.1.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2"><apply id="S4.Ex8.m1.6.6.1.1.2.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.6.6.1.1.2.2.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2">superscript</csymbol><apply id="S4.Ex8.m1.6.6.1.1.2.2.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex8.m1.6.6.1.1.2.2.2.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2">subscript</csymbol><sum id="S4.Ex8.m1.6.6.1.1.2.2.2.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2.2.2"></sum><apply id="S4.Ex8.m1.6.6.1.1.2.2.2.3.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3"><eq id="S4.Ex8.m1.6.6.1.1.2.2.2.3.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.1"></eq><ci id="S4.Ex8.m1.6.6.1.1.2.2.2.3.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.2">𝑖</ci><cn id="S4.Ex8.m1.6.6.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.Ex8.m1.6.6.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex8.m1.6.6.1.1.2.2.3.cmml" xref="S4.Ex8.m1.6.6.1.1.2.2.3">𝜌</ci></apply><apply id="S4.Ex8.m1.6.6.1.1.2.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1"><times id="S4.Ex8.m1.6.6.1.1.2.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.2"></times><apply id="S4.Ex8.m1.6.6.1.1.2.1.3.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.Ex8.m1.6.6.1.1.2.1.3.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.3">subscript</csymbol><ci id="S4.Ex8.m1.6.6.1.1.2.1.3.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.3.2">𝑒</ci><ci id="S4.Ex8.m1.6.6.1.1.2.1.3.3.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.3.3">𝑖</ci></apply><apply id="S4.Ex8.m1.6.6.1.1.2.1.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.Ex8.m1.6.6.1.1.2.1.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1">superscript</csymbol><apply id="S4.Ex8.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S4.Ex8.m1.6.6.1.1.2.1.1.1.2.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.2">norm</csymbol><apply id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.1.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.2.cmml" xref="S4.Ex8.m1.6.6.1.1.2.1.1.1.1.1.2">𝑷</ci><list id="S4.Ex8.m1.2.2.2.3.cmml" xref="S4.Ex8.m1.2.2.2.4"><ci id="S4.Ex8.m1.1.1.1.1.cmml" xref="S4.Ex8.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex8.m1.2.2.2.2.cmml" xref="S4.Ex8.m1.2.2.2.2">:</ci></list></apply></apply><cn id="S4.Ex8.m1.6.6.1.1.2.1.1.3.cmml" type="integer" xref="S4.Ex8.m1.6.6.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex8.m1.6c">\operatorname{Tr}({\bm{P}}^{T}\operatorname{diag}({\bm{e}}){\bm{P}})=\sum_{i=1%
}^{\rho}{e}_{i}\|{\bm{P}}_{i,:}\|^{2}.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex8.m1.6d">roman_Tr ( bold_italic_P start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_e ) bold_italic_P ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_P start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.3.p1.7">Therefore,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}=%
\sum_{i=1}^{m}d_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{\rho}e_{i}\|{\bm{P}}_{i,:}%
\|^{2}" class="ltx_Math" display="block" id="S4.Ex9.m1.8"><semantics id="S4.Ex9.m1.8a"><mrow id="S4.Ex9.m1.8.8" xref="S4.Ex9.m1.8.8.cmml"><mrow id="S4.Ex9.m1.6.6.2" xref="S4.Ex9.m1.6.6.2.cmml"><munderover id="S4.Ex9.m1.6.6.2.3" xref="S4.Ex9.m1.6.6.2.3.cmml"><mo id="S4.Ex9.m1.6.6.2.3.2.2" movablelimits="false" xref="S4.Ex9.m1.6.6.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex9.m1.6.6.2.3.2.3" xref="S4.Ex9.m1.6.6.2.3.2.3.cmml"><mi id="S4.Ex9.m1.6.6.2.3.2.3.2" xref="S4.Ex9.m1.6.6.2.3.2.3.2.cmml">i</mi><mo id="S4.Ex9.m1.6.6.2.3.2.3.1" xref="S4.Ex9.m1.6.6.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex9.m1.6.6.2.3.2.3.3" xref="S4.Ex9.m1.6.6.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex9.m1.6.6.2.3.3" xref="S4.Ex9.m1.6.6.2.3.3.cmml">m</mi></munderover><mrow id="S4.Ex9.m1.6.6.2.2" xref="S4.Ex9.m1.6.6.2.2.cmml"><munderover id="S4.Ex9.m1.6.6.2.2.3" xref="S4.Ex9.m1.6.6.2.2.3.cmml"><mo id="S4.Ex9.m1.6.6.2.2.3.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S4.Ex9.m1.6.6.2.2.3.2.2.cmml">∑</mo><mrow id="S4.Ex9.m1.6.6.2.2.3.2.3" xref="S4.Ex9.m1.6.6.2.2.3.2.3.cmml"><mi id="S4.Ex9.m1.6.6.2.2.3.2.3.2" xref="S4.Ex9.m1.6.6.2.2.3.2.3.2.cmml">j</mi><mo id="S4.Ex9.m1.6.6.2.2.3.2.3.1" xref="S4.Ex9.m1.6.6.2.2.3.2.3.1.cmml">=</mo><mn id="S4.Ex9.m1.6.6.2.2.3.2.3.3" xref="S4.Ex9.m1.6.6.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex9.m1.6.6.2.2.3.3" xref="S4.Ex9.m1.6.6.2.2.3.3.cmml">m</mi></munderover><mrow id="S4.Ex9.m1.6.6.2.2.2" xref="S4.Ex9.m1.6.6.2.2.2.cmml"><mrow id="S4.Ex9.m1.6.6.2.2.2.2.2" xref="S4.Ex9.m1.6.6.2.2.2.2.3.cmml"><mo id="S4.Ex9.m1.6.6.2.2.2.2.2.3" stretchy="false" xref="S4.Ex9.m1.6.6.2.2.2.2.3.cmml">⟨</mo><msub id="S4.Ex9.m1.5.5.1.1.1.1.1.1" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.Ex9.m1.5.5.1.1.1.1.1.1.2" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex9.m1.5.5.1.1.1.1.1.1.3" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex9.m1.6.6.2.2.2.2.2.4" xref="S4.Ex9.m1.6.6.2.2.2.2.3.cmml">,</mo><msub id="S4.Ex9.m1.6.6.2.2.2.2.2.2" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2.cmml"><mi id="S4.Ex9.m1.6.6.2.2.2.2.2.2.2" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S4.Ex9.m1.6.6.2.2.2.2.2.2.3" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.Ex9.m1.6.6.2.2.2.2.2.5" stretchy="false" xref="S4.Ex9.m1.6.6.2.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.Ex9.m1.6.6.2.2.2.3" xref="S4.Ex9.m1.6.6.2.2.2.3.cmml">⁢</mo><msub id="S4.Ex9.m1.6.6.2.2.2.4" xref="S4.Ex9.m1.6.6.2.2.2.4.cmml"><mi id="S4.Ex9.m1.6.6.2.2.2.4.2" xref="S4.Ex9.m1.6.6.2.2.2.4.2.cmml">R</mi><mrow id="S4.Ex9.m1.2.2.2.4" xref="S4.Ex9.m1.2.2.2.3.cmml"><mi id="S4.Ex9.m1.1.1.1.1" xref="S4.Ex9.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex9.m1.2.2.2.4.1" xref="S4.Ex9.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex9.m1.2.2.2.2" xref="S4.Ex9.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.Ex9.m1.8.8.5" rspace="0.111em" xref="S4.Ex9.m1.8.8.5.cmml">=</mo><mrow id="S4.Ex9.m1.8.8.4" xref="S4.Ex9.m1.8.8.4.cmml"><mrow id="S4.Ex9.m1.7.7.3.1" xref="S4.Ex9.m1.7.7.3.1.cmml"><munderover id="S4.Ex9.m1.7.7.3.1.2" xref="S4.Ex9.m1.7.7.3.1.2.cmml"><mo id="S4.Ex9.m1.7.7.3.1.2.2.2" movablelimits="false" xref="S4.Ex9.m1.7.7.3.1.2.2.2.cmml">∑</mo><mrow id="S4.Ex9.m1.7.7.3.1.2.2.3" xref="S4.Ex9.m1.7.7.3.1.2.2.3.cmml"><mi id="S4.Ex9.m1.7.7.3.1.2.2.3.2" xref="S4.Ex9.m1.7.7.3.1.2.2.3.2.cmml">i</mi><mo id="S4.Ex9.m1.7.7.3.1.2.2.3.1" xref="S4.Ex9.m1.7.7.3.1.2.2.3.1.cmml">=</mo><mn id="S4.Ex9.m1.7.7.3.1.2.2.3.3" xref="S4.Ex9.m1.7.7.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex9.m1.7.7.3.1.2.3" xref="S4.Ex9.m1.7.7.3.1.2.3.cmml">m</mi></munderover><mrow id="S4.Ex9.m1.7.7.3.1.1" xref="S4.Ex9.m1.7.7.3.1.1.cmml"><msub id="S4.Ex9.m1.7.7.3.1.1.3" xref="S4.Ex9.m1.7.7.3.1.1.3.cmml"><mi id="S4.Ex9.m1.7.7.3.1.1.3.2" xref="S4.Ex9.m1.7.7.3.1.1.3.2.cmml">d</mi><mi id="S4.Ex9.m1.7.7.3.1.1.3.3" xref="S4.Ex9.m1.7.7.3.1.1.3.3.cmml">i</mi></msub><mo id="S4.Ex9.m1.7.7.3.1.1.2" xref="S4.Ex9.m1.7.7.3.1.1.2.cmml">⁢</mo><msup id="S4.Ex9.m1.7.7.3.1.1.1" xref="S4.Ex9.m1.7.7.3.1.1.1.cmml"><mrow id="S4.Ex9.m1.7.7.3.1.1.1.1.1" xref="S4.Ex9.m1.7.7.3.1.1.1.1.2.cmml"><mo id="S4.Ex9.m1.7.7.3.1.1.1.1.1.2" stretchy="false" xref="S4.Ex9.m1.7.7.3.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.cmml"><mi id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.2" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.3" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex9.m1.7.7.3.1.1.1.1.1.3" stretchy="false" xref="S4.Ex9.m1.7.7.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex9.m1.7.7.3.1.1.1.3" xref="S4.Ex9.m1.7.7.3.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.Ex9.m1.8.8.4.3" rspace="0.055em" xref="S4.Ex9.m1.8.8.4.3.cmml">+</mo><mrow id="S4.Ex9.m1.8.8.4.2" xref="S4.Ex9.m1.8.8.4.2.cmml"><munderover id="S4.Ex9.m1.8.8.4.2.2" xref="S4.Ex9.m1.8.8.4.2.2.cmml"><mo id="S4.Ex9.m1.8.8.4.2.2.2.2" movablelimits="false" xref="S4.Ex9.m1.8.8.4.2.2.2.2.cmml">∑</mo><mrow id="S4.Ex9.m1.8.8.4.2.2.2.3" xref="S4.Ex9.m1.8.8.4.2.2.2.3.cmml"><mi id="S4.Ex9.m1.8.8.4.2.2.2.3.2" xref="S4.Ex9.m1.8.8.4.2.2.2.3.2.cmml">i</mi><mo id="S4.Ex9.m1.8.8.4.2.2.2.3.1" xref="S4.Ex9.m1.8.8.4.2.2.2.3.1.cmml">=</mo><mn id="S4.Ex9.m1.8.8.4.2.2.2.3.3" xref="S4.Ex9.m1.8.8.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex9.m1.8.8.4.2.2.3" xref="S4.Ex9.m1.8.8.4.2.2.3.cmml">ρ</mi></munderover><mrow id="S4.Ex9.m1.8.8.4.2.1" xref="S4.Ex9.m1.8.8.4.2.1.cmml"><msub id="S4.Ex9.m1.8.8.4.2.1.3" xref="S4.Ex9.m1.8.8.4.2.1.3.cmml"><mi id="S4.Ex9.m1.8.8.4.2.1.3.2" xref="S4.Ex9.m1.8.8.4.2.1.3.2.cmml">e</mi><mi id="S4.Ex9.m1.8.8.4.2.1.3.3" xref="S4.Ex9.m1.8.8.4.2.1.3.3.cmml">i</mi></msub><mo id="S4.Ex9.m1.8.8.4.2.1.2" xref="S4.Ex9.m1.8.8.4.2.1.2.cmml">⁢</mo><msup id="S4.Ex9.m1.8.8.4.2.1.1" xref="S4.Ex9.m1.8.8.4.2.1.1.cmml"><mrow id="S4.Ex9.m1.8.8.4.2.1.1.1.1" xref="S4.Ex9.m1.8.8.4.2.1.1.1.2.cmml"><mo id="S4.Ex9.m1.8.8.4.2.1.1.1.1.2" stretchy="false" xref="S4.Ex9.m1.8.8.4.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex9.m1.8.8.4.2.1.1.1.1.1" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.cmml"><mi id="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.2" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.2.cmml">𝑷</mi><mrow id="S4.Ex9.m1.4.4.2.4" xref="S4.Ex9.m1.4.4.2.3.cmml"><mi id="S4.Ex9.m1.3.3.1.1" xref="S4.Ex9.m1.3.3.1.1.cmml">i</mi><mo id="S4.Ex9.m1.4.4.2.4.1" xref="S4.Ex9.m1.4.4.2.3.cmml">,</mo><mo id="S4.Ex9.m1.4.4.2.2" xref="S4.Ex9.m1.4.4.2.2.cmml">:</mo></mrow></msub><mo id="S4.Ex9.m1.8.8.4.2.1.1.1.1.3" stretchy="false" xref="S4.Ex9.m1.8.8.4.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex9.m1.8.8.4.2.1.1.3" xref="S4.Ex9.m1.8.8.4.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex9.m1.8b"><apply id="S4.Ex9.m1.8.8.cmml" xref="S4.Ex9.m1.8.8"><eq id="S4.Ex9.m1.8.8.5.cmml" xref="S4.Ex9.m1.8.8.5"></eq><apply id="S4.Ex9.m1.6.6.2.cmml" xref="S4.Ex9.m1.6.6.2"><apply id="S4.Ex9.m1.6.6.2.3.cmml" xref="S4.Ex9.m1.6.6.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.3.1.cmml" xref="S4.Ex9.m1.6.6.2.3">superscript</csymbol><apply id="S4.Ex9.m1.6.6.2.3.2.cmml" xref="S4.Ex9.m1.6.6.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.3.2.1.cmml" xref="S4.Ex9.m1.6.6.2.3">subscript</csymbol><sum id="S4.Ex9.m1.6.6.2.3.2.2.cmml" xref="S4.Ex9.m1.6.6.2.3.2.2"></sum><apply id="S4.Ex9.m1.6.6.2.3.2.3.cmml" xref="S4.Ex9.m1.6.6.2.3.2.3"><eq id="S4.Ex9.m1.6.6.2.3.2.3.1.cmml" xref="S4.Ex9.m1.6.6.2.3.2.3.1"></eq><ci id="S4.Ex9.m1.6.6.2.3.2.3.2.cmml" xref="S4.Ex9.m1.6.6.2.3.2.3.2">𝑖</ci><cn id="S4.Ex9.m1.6.6.2.3.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.6.6.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex9.m1.6.6.2.3.3.cmml" xref="S4.Ex9.m1.6.6.2.3.3">𝑚</ci></apply><apply id="S4.Ex9.m1.6.6.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2"><apply id="S4.Ex9.m1.6.6.2.2.3.cmml" xref="S4.Ex9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.2.3.1.cmml" xref="S4.Ex9.m1.6.6.2.2.3">superscript</csymbol><apply id="S4.Ex9.m1.6.6.2.2.3.2.cmml" xref="S4.Ex9.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.2.3.2.1.cmml" xref="S4.Ex9.m1.6.6.2.2.3">subscript</csymbol><sum id="S4.Ex9.m1.6.6.2.2.3.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2.3.2.2"></sum><apply id="S4.Ex9.m1.6.6.2.2.3.2.3.cmml" xref="S4.Ex9.m1.6.6.2.2.3.2.3"><eq id="S4.Ex9.m1.6.6.2.2.3.2.3.1.cmml" xref="S4.Ex9.m1.6.6.2.2.3.2.3.1"></eq><ci id="S4.Ex9.m1.6.6.2.2.3.2.3.2.cmml" xref="S4.Ex9.m1.6.6.2.2.3.2.3.2">𝑗</ci><cn id="S4.Ex9.m1.6.6.2.2.3.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.6.6.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.Ex9.m1.6.6.2.2.3.3.cmml" xref="S4.Ex9.m1.6.6.2.2.3.3">𝑚</ci></apply><apply id="S4.Ex9.m1.6.6.2.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2.2"><times id="S4.Ex9.m1.6.6.2.2.2.3.cmml" xref="S4.Ex9.m1.6.6.2.2.2.3"></times><list id="S4.Ex9.m1.6.6.2.2.2.2.3.cmml" xref="S4.Ex9.m1.6.6.2.2.2.2.2"><apply id="S4.Ex9.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex9.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex9.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.Ex9.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.Ex9.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2">subscript</csymbol><ci id="S4.Ex9.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2.2">𝒗</ci><ci id="S4.Ex9.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S4.Ex9.m1.6.6.2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S4.Ex9.m1.6.6.2.2.2.4.cmml" xref="S4.Ex9.m1.6.6.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex9.m1.6.6.2.2.2.4.1.cmml" xref="S4.Ex9.m1.6.6.2.2.2.4">subscript</csymbol><ci id="S4.Ex9.m1.6.6.2.2.2.4.2.cmml" xref="S4.Ex9.m1.6.6.2.2.2.4.2">𝑅</ci><list id="S4.Ex9.m1.2.2.2.3.cmml" xref="S4.Ex9.m1.2.2.2.4"><ci id="S4.Ex9.m1.1.1.1.1.cmml" xref="S4.Ex9.m1.1.1.1.1">𝑖</ci><ci id="S4.Ex9.m1.2.2.2.2.cmml" xref="S4.Ex9.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply><apply id="S4.Ex9.m1.8.8.4.cmml" xref="S4.Ex9.m1.8.8.4"><plus id="S4.Ex9.m1.8.8.4.3.cmml" xref="S4.Ex9.m1.8.8.4.3"></plus><apply id="S4.Ex9.m1.7.7.3.1.cmml" xref="S4.Ex9.m1.7.7.3.1"><apply id="S4.Ex9.m1.7.7.3.1.2.cmml" xref="S4.Ex9.m1.7.7.3.1.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.7.7.3.1.2.1.cmml" xref="S4.Ex9.m1.7.7.3.1.2">superscript</csymbol><apply id="S4.Ex9.m1.7.7.3.1.2.2.cmml" xref="S4.Ex9.m1.7.7.3.1.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.7.7.3.1.2.2.1.cmml" xref="S4.Ex9.m1.7.7.3.1.2">subscript</csymbol><sum id="S4.Ex9.m1.7.7.3.1.2.2.2.cmml" xref="S4.Ex9.m1.7.7.3.1.2.2.2"></sum><apply id="S4.Ex9.m1.7.7.3.1.2.2.3.cmml" xref="S4.Ex9.m1.7.7.3.1.2.2.3"><eq id="S4.Ex9.m1.7.7.3.1.2.2.3.1.cmml" xref="S4.Ex9.m1.7.7.3.1.2.2.3.1"></eq><ci id="S4.Ex9.m1.7.7.3.1.2.2.3.2.cmml" xref="S4.Ex9.m1.7.7.3.1.2.2.3.2">𝑖</ci><cn id="S4.Ex9.m1.7.7.3.1.2.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.7.7.3.1.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex9.m1.7.7.3.1.2.3.cmml" xref="S4.Ex9.m1.7.7.3.1.2.3">𝑚</ci></apply><apply id="S4.Ex9.m1.7.7.3.1.1.cmml" xref="S4.Ex9.m1.7.7.3.1.1"><times id="S4.Ex9.m1.7.7.3.1.1.2.cmml" xref="S4.Ex9.m1.7.7.3.1.1.2"></times><apply id="S4.Ex9.m1.7.7.3.1.1.3.cmml" xref="S4.Ex9.m1.7.7.3.1.1.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.7.7.3.1.1.3.1.cmml" xref="S4.Ex9.m1.7.7.3.1.1.3">subscript</csymbol><ci id="S4.Ex9.m1.7.7.3.1.1.3.2.cmml" xref="S4.Ex9.m1.7.7.3.1.1.3.2">𝑑</ci><ci id="S4.Ex9.m1.7.7.3.1.1.3.3.cmml" xref="S4.Ex9.m1.7.7.3.1.1.3.3">𝑖</ci></apply><apply id="S4.Ex9.m1.7.7.3.1.1.1.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.7.7.3.1.1.1.2.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1">superscript</csymbol><apply id="S4.Ex9.m1.7.7.3.1.1.1.1.2.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex9.m1.7.7.3.1.1.1.1.2.1.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.3.cmml" xref="S4.Ex9.m1.7.7.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.Ex9.m1.7.7.3.1.1.1.3.cmml" type="integer" xref="S4.Ex9.m1.7.7.3.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.Ex9.m1.8.8.4.2.cmml" xref="S4.Ex9.m1.8.8.4.2"><apply id="S4.Ex9.m1.8.8.4.2.2.cmml" xref="S4.Ex9.m1.8.8.4.2.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.8.8.4.2.2.1.cmml" xref="S4.Ex9.m1.8.8.4.2.2">superscript</csymbol><apply id="S4.Ex9.m1.8.8.4.2.2.2.cmml" xref="S4.Ex9.m1.8.8.4.2.2"><csymbol cd="ambiguous" id="S4.Ex9.m1.8.8.4.2.2.2.1.cmml" xref="S4.Ex9.m1.8.8.4.2.2">subscript</csymbol><sum id="S4.Ex9.m1.8.8.4.2.2.2.2.cmml" xref="S4.Ex9.m1.8.8.4.2.2.2.2"></sum><apply id="S4.Ex9.m1.8.8.4.2.2.2.3.cmml" xref="S4.Ex9.m1.8.8.4.2.2.2.3"><eq id="S4.Ex9.m1.8.8.4.2.2.2.3.1.cmml" xref="S4.Ex9.m1.8.8.4.2.2.2.3.1"></eq><ci id="S4.Ex9.m1.8.8.4.2.2.2.3.2.cmml" xref="S4.Ex9.m1.8.8.4.2.2.2.3.2">𝑖</ci><cn id="S4.Ex9.m1.8.8.4.2.2.2.3.3.cmml" type="integer" xref="S4.Ex9.m1.8.8.4.2.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex9.m1.8.8.4.2.2.3.cmml" xref="S4.Ex9.m1.8.8.4.2.2.3">𝜌</ci></apply><apply id="S4.Ex9.m1.8.8.4.2.1.cmml" xref="S4.Ex9.m1.8.8.4.2.1"><times id="S4.Ex9.m1.8.8.4.2.1.2.cmml" xref="S4.Ex9.m1.8.8.4.2.1.2"></times><apply id="S4.Ex9.m1.8.8.4.2.1.3.cmml" xref="S4.Ex9.m1.8.8.4.2.1.3"><csymbol cd="ambiguous" id="S4.Ex9.m1.8.8.4.2.1.3.1.cmml" xref="S4.Ex9.m1.8.8.4.2.1.3">subscript</csymbol><ci id="S4.Ex9.m1.8.8.4.2.1.3.2.cmml" xref="S4.Ex9.m1.8.8.4.2.1.3.2">𝑒</ci><ci id="S4.Ex9.m1.8.8.4.2.1.3.3.cmml" xref="S4.Ex9.m1.8.8.4.2.1.3.3">𝑖</ci></apply><apply id="S4.Ex9.m1.8.8.4.2.1.1.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.8.8.4.2.1.1.2.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1">superscript</csymbol><apply id="S4.Ex9.m1.8.8.4.2.1.1.1.2.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1"><csymbol cd="latexml" id="S4.Ex9.m1.8.8.4.2.1.1.1.2.1.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1.2">norm</csymbol><apply id="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.1.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.2.cmml" xref="S4.Ex9.m1.8.8.4.2.1.1.1.1.1.2">𝑷</ci><list id="S4.Ex9.m1.4.4.2.3.cmml" xref="S4.Ex9.m1.4.4.2.4"><ci id="S4.Ex9.m1.3.3.1.1.cmml" xref="S4.Ex9.m1.3.3.1.1">𝑖</ci><ci id="S4.Ex9.m1.4.4.2.2.cmml" xref="S4.Ex9.m1.4.4.2.2">:</ci></list></apply></apply><cn id="S4.Ex9.m1.8.8.4.2.1.1.3.cmml" type="integer" xref="S4.Ex9.m1.8.8.4.2.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex9.m1.8c">\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}=%
\sum_{i=1}^{m}d_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{\rho}e_{i}\|{\bm{P}}_{i,:}%
\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex9.m1.8d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_P start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.3.p1.8">∎</p>
</div>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1">Now we are ready to present our solution based on Proposition <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.Thmtheorem1" title="Proposition 0. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>The modified model and fast inference algorithm</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Our solution consists of a modification of the FwFM model, and an algorithm that achieves inference during ranking in <math alttext="O(\rho|\mathcal{I}|k)" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.2"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.2" xref="S4.SS2.p1.1.m1.2.2.cmml"><mi id="S4.SS2.p1.1.m1.2.2.3" xref="S4.SS2.p1.1.m1.2.2.3.cmml">O</mi><mo id="S4.SS2.p1.1.m1.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="S4.SS2.p1.1.m1.2.2.1.1" xref="S4.SS2.p1.1.m1.2.2.1.1.1.cmml"><mo id="S4.SS2.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S4.SS2.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.1.m1.2.2.1.1.1" xref="S4.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.2.2.1.1.1.2" xref="S4.SS2.p1.1.m1.2.2.1.1.1.2.cmml">ρ</mi><mo id="S4.SS2.p1.1.m1.2.2.1.1.1.1" xref="S4.SS2.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.p1.1.m1.2.2.1.1.1.3.2" xref="S4.SS2.p1.1.m1.2.2.1.1.1.3.1.cmml"><mo id="S4.SS2.p1.1.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.p1.1.m1.2.2.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">ℐ</mi><mo id="S4.SS2.p1.1.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.p1.1.m1.2.2.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p1.1.m1.2.2.1.1.1.1a" xref="S4.SS2.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.1.m1.2.2.1.1.1.4" xref="S4.SS2.p1.1.m1.2.2.1.1.1.4.cmml">k</mi></mrow><mo id="S4.SS2.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S4.SS2.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2"><times id="S4.SS2.p1.1.m1.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2"></times><ci id="S4.SS2.p1.1.m1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.3">𝑂</ci><apply id="S4.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1"><times id="S4.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.1.1"></times><ci id="S4.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.1.2">𝜌</ci><apply id="S4.SS2.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.1.3.2"><abs id="S4.SS2.p1.1.m1.2.2.1.1.1.3.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.1.3.2.1"></abs><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">ℐ</ci></apply><ci id="S4.SS2.p1.1.m1.2.2.1.1.1.4.cmml" xref="S4.SS2.p1.1.m1.2.2.1.1.1.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">O(\rho|\mathcal{I}|k)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.2d">italic_O ( italic_ρ | caligraphic_I | italic_k )</annotation></semantics></math> per item.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>The diagonal plus low-rank FwFM model</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.7">Instead of learning the field interaction matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.1"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">bold_italic_R</annotation></semantics></math> directly, we learn its decomposition in the diagonal plus low-rank form. Since <math alttext="\operatorname{diag}({\bm{R}})=\bm{0}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.2.m2.2"><semantics id="S4.SS2.SSS1.p1.2.m2.2a"><mrow id="S4.SS2.SSS1.p1.2.m2.2.3" xref="S4.SS2.SSS1.p1.2.m2.2.3.cmml"><mrow id="S4.SS2.SSS1.p1.2.m2.2.3.2.2" xref="S4.SS2.SSS1.p1.2.m2.2.3.2.1.cmml"><mi id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">diag</mi><mo id="S4.SS2.SSS1.p1.2.m2.2.3.2.2a" xref="S4.SS2.SSS1.p1.2.m2.2.3.2.1.cmml">⁡</mo><mrow id="S4.SS2.SSS1.p1.2.m2.2.3.2.2.1" xref="S4.SS2.SSS1.p1.2.m2.2.3.2.1.cmml"><mo id="S4.SS2.SSS1.p1.2.m2.2.3.2.2.1.1" stretchy="false" xref="S4.SS2.SSS1.p1.2.m2.2.3.2.1.cmml">(</mo><mi id="S4.SS2.SSS1.p1.2.m2.2.2" xref="S4.SS2.SSS1.p1.2.m2.2.2.cmml">𝑹</mi><mo id="S4.SS2.SSS1.p1.2.m2.2.3.2.2.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.2.m2.2.3.2.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS1.p1.2.m2.2.3.1" xref="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.2.m2.2.3.3" xref="S4.SS2.SSS1.p1.2.m2.2.3.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.2b"><apply id="S4.SS2.SSS1.p1.2.m2.2.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.2.3"><eq id="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.2.3.1"></eq><apply id="S4.SS2.SSS1.p1.2.m2.2.3.2.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.2.3.2.2"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">diag</ci><ci id="S4.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.2.2">𝑹</ci></apply><cn id="S4.SS2.SSS1.p1.2.m2.2.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.2.m2.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.2c">\operatorname{diag}({\bm{R}})=\bm{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.2d">roman_diag ( bold_italic_R ) = bold_0</annotation></semantics></math>, the diagonal component is fully determined by the low-rank decomposition. Formally, we replace the learned parameter <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.3.m3.1"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mi id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.3.m3.1d">bold_italic_R</annotation></semantics></math>, with the learned parameters <math alttext="{\bm{U}}\in\mathbb{R}^{\rho\times m}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.4.m4.1"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><mrow id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p1.4.m4.1.1.2" xref="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml">𝑼</mi><mo id="S4.SS2.SSS1.p1.4.m4.1.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p1.4.m4.1.1.3" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.4.m4.1.1.3.2" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p1.4.m4.1.1.3.3" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.2" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.2.cmml">ρ</mi><mo id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.3" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><apply id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1"><in id="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.1"></in><ci id="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.2">𝑼</ci><apply id="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3"><times id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.1"></times><ci id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.2">𝜌</ci><ci id="S4.SS2.SSS1.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">{\bm{U}}\in\mathbb{R}^{\rho\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.4.m4.1d">bold_italic_U ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="{\bm{e}}\in\mathbb{R}^{\rho\times m}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.5.m5.1"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><mrow id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml">𝒆</mi><mo id="S4.SS2.SSS1.p1.5.m5.1.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS2.SSS1.p1.5.m5.1.1.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.3.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.SSS1.p1.5.m5.1.1.3.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.cmml">ρ</mi><mo id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><apply id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1"><in id="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.1"></in><ci id="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2">𝒆</ci><apply id="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3"><times id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.1"></times><ci id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.2">𝜌</ci><ci id="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">{\bm{e}}\in\mathbb{R}^{\rho\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.5.m5.1d">bold_italic_e ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.6.m6.1"><semantics id="S4.SS2.SSS1.p1.6.m6.1a"><mi id="S4.SS2.SSS1.p1.6.m6.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m6.1b"><ci id="S4.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m6.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.6.m6.1d">italic_ρ</annotation></semantics></math> is a hyper-parameter. The matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.7.m7.1"><semantics id="S4.SS2.SSS1.p1.7.m7.1a"><mi id="S4.SS2.SSS1.p1.7.m7.1.1" xref="S4.SS2.SSS1.p1.7.m7.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.7.m7.1b"><ci id="S4.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS1.p1.7.m7.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.7.m7.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.7.m7.1d">bold_italic_R</annotation></semantics></math> is formally defined as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}+\operatorname{diag}%
({\bm{d}})," class="ltx_Math" display="block" id="S4.E10.m1.5"><semantics id="S4.E10.m1.5a"><mrow id="S4.E10.m1.5.5.1" xref="S4.E10.m1.5.5.1.1.cmml"><mrow id="S4.E10.m1.5.5.1.1" xref="S4.E10.m1.5.5.1.1.cmml"><mi id="S4.E10.m1.5.5.1.1.2" xref="S4.E10.m1.5.5.1.1.2.cmml">𝑹</mi><mo id="S4.E10.m1.5.5.1.1.1" xref="S4.E10.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E10.m1.5.5.1.1.3" xref="S4.E10.m1.5.5.1.1.3.cmml"><mrow id="S4.E10.m1.5.5.1.1.3.2" xref="S4.E10.m1.5.5.1.1.3.2.cmml"><msup id="S4.E10.m1.5.5.1.1.3.2.2" xref="S4.E10.m1.5.5.1.1.3.2.2.cmml"><mi id="S4.E10.m1.5.5.1.1.3.2.2.2" xref="S4.E10.m1.5.5.1.1.3.2.2.2.cmml">𝑼</mi><mi id="S4.E10.m1.5.5.1.1.3.2.2.3" xref="S4.E10.m1.5.5.1.1.3.2.2.3.cmml">T</mi></msup><mo id="S4.E10.m1.5.5.1.1.3.2.1" lspace="0.167em" xref="S4.E10.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S4.E10.m1.5.5.1.1.3.2.3.2" xref="S4.E10.m1.5.5.1.1.3.2.3.1.cmml"><mi id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">diag</mi><mo id="S4.E10.m1.5.5.1.1.3.2.3.2a" xref="S4.E10.m1.5.5.1.1.3.2.3.1.cmml">⁡</mo><mrow id="S4.E10.m1.5.5.1.1.3.2.3.2.1" xref="S4.E10.m1.5.5.1.1.3.2.3.1.cmml"><mo id="S4.E10.m1.5.5.1.1.3.2.3.2.1.1" stretchy="false" xref="S4.E10.m1.5.5.1.1.3.2.3.1.cmml">(</mo><mi id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml">𝒆</mi><mo id="S4.E10.m1.5.5.1.1.3.2.3.2.1.2" stretchy="false" xref="S4.E10.m1.5.5.1.1.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.5.5.1.1.3.2.1a" xref="S4.E10.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.E10.m1.5.5.1.1.3.2.4" xref="S4.E10.m1.5.5.1.1.3.2.4.cmml">𝑼</mi></mrow><mo id="S4.E10.m1.5.5.1.1.3.1" xref="S4.E10.m1.5.5.1.1.3.1.cmml">+</mo><mrow id="S4.E10.m1.5.5.1.1.3.3.2" xref="S4.E10.m1.5.5.1.1.3.3.1.cmml"><mi id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml">diag</mi><mo id="S4.E10.m1.5.5.1.1.3.3.2a" xref="S4.E10.m1.5.5.1.1.3.3.1.cmml">⁡</mo><mrow id="S4.E10.m1.5.5.1.1.3.3.2.1" xref="S4.E10.m1.5.5.1.1.3.3.1.cmml"><mo id="S4.E10.m1.5.5.1.1.3.3.2.1.1" stretchy="false" xref="S4.E10.m1.5.5.1.1.3.3.1.cmml">(</mo><mi id="S4.E10.m1.4.4" xref="S4.E10.m1.4.4.cmml">𝒅</mi><mo id="S4.E10.m1.5.5.1.1.3.3.2.1.2" stretchy="false" xref="S4.E10.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.5.5.1.2" xref="S4.E10.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.5b"><apply id="S4.E10.m1.5.5.1.1.cmml" xref="S4.E10.m1.5.5.1"><eq id="S4.E10.m1.5.5.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1"></eq><ci id="S4.E10.m1.5.5.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.2">𝑹</ci><apply id="S4.E10.m1.5.5.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.3"><plus id="S4.E10.m1.5.5.1.1.3.1.cmml" xref="S4.E10.m1.5.5.1.1.3.1"></plus><apply id="S4.E10.m1.5.5.1.1.3.2.cmml" xref="S4.E10.m1.5.5.1.1.3.2"><times id="S4.E10.m1.5.5.1.1.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.3.2.1"></times><apply id="S4.E10.m1.5.5.1.1.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E10.m1.5.5.1.1.3.2.2">superscript</csymbol><ci id="S4.E10.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E10.m1.5.5.1.1.3.2.2.2">𝑼</ci><ci id="S4.E10.m1.5.5.1.1.3.2.2.3.cmml" xref="S4.E10.m1.5.5.1.1.3.2.2.3">𝑇</ci></apply><apply id="S4.E10.m1.5.5.1.1.3.2.3.1.cmml" xref="S4.E10.m1.5.5.1.1.3.2.3.2"><ci id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1">diag</ci><ci id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2">𝒆</ci></apply><ci id="S4.E10.m1.5.5.1.1.3.2.4.cmml" xref="S4.E10.m1.5.5.1.1.3.2.4">𝑼</ci></apply><apply id="S4.E10.m1.5.5.1.1.3.3.1.cmml" xref="S4.E10.m1.5.5.1.1.3.3.2"><ci id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3">diag</ci><ci id="S4.E10.m1.4.4.cmml" xref="S4.E10.m1.4.4">𝒅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.5c">{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}+\operatorname{diag}%
({\bm{d}}),</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.5d">bold_italic_R = bold_italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_e ) bold_italic_U + roman_diag ( bold_italic_d ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p1.15">where</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{d}}\equiv-\operatorname{diag\_of}({\bm{U}}^{T}\operatorname{diag}({\bm{e}%
}){\bm{U}})." class="ltx_Math" display="block" id="S4.Ex10.m1.4"><semantics id="S4.Ex10.m1.4a"><mrow id="S4.Ex10.m1.4.4.1" xref="S4.Ex10.m1.4.4.1.1.cmml"><mrow id="S4.Ex10.m1.4.4.1.1" xref="S4.Ex10.m1.4.4.1.1.cmml"><mi id="S4.Ex10.m1.4.4.1.1.3" xref="S4.Ex10.m1.4.4.1.1.3.cmml">𝒅</mi><mo id="S4.Ex10.m1.4.4.1.1.2" xref="S4.Ex10.m1.4.4.1.1.2.cmml">≡</mo><mrow id="S4.Ex10.m1.4.4.1.1.1" xref="S4.Ex10.m1.4.4.1.1.1.cmml"><mo id="S4.Ex10.m1.4.4.1.1.1a" xref="S4.Ex10.m1.4.4.1.1.1.cmml">−</mo><mrow id="S4.Ex10.m1.4.4.1.1.1.1.1" xref="S4.Ex10.m1.4.4.1.1.1.1.2.cmml"><mrow id="S4.Ex10.m1.3.3" xref="S4.Ex10.m1.3.3.cmml"><mi id="S4.Ex10.m1.3.3.2" xref="S4.Ex10.m1.3.3.2.cmml">diag</mi><mo id="S4.Ex10.m1.3.3.1" xref="S4.Ex10.m1.3.3.1.cmml">⁢</mo><mi id="S4.Ex10.m1.3.3.3" mathvariant="normal" xref="S4.Ex10.m1.3.3.3.cmml">_</mi><mo id="S4.Ex10.m1.3.3.1a" xref="S4.Ex10.m1.3.3.1.cmml">⁢</mo><mi id="S4.Ex10.m1.3.3.4" xref="S4.Ex10.m1.3.3.4.cmml">of</mi></mrow><mo id="S4.Ex10.m1.4.4.1.1.1.1.1a" xref="S4.Ex10.m1.4.4.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.Ex10.m1.4.4.1.1.1.1.1.1" xref="S4.Ex10.m1.4.4.1.1.1.1.2.cmml"><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex10.m1.4.4.1.1.1.1.2.cmml">(</mo><mrow id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.cmml"><msup id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">𝑼</mi><mi id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.1" lspace="0.167em" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml"><mi id="S4.Ex10.m1.1.1" xref="S4.Ex10.m1.1.1.cmml">diag</mi><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.2a" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.2.1" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml"><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.2.1.1" stretchy="false" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.Ex10.m1.2.2" xref="S4.Ex10.m1.2.2.cmml">𝒆</mi><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.2.1.2" stretchy="false" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.1a" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.4" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.4.cmml">𝑼</mi></mrow><mo id="S4.Ex10.m1.4.4.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex10.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex10.m1.4.4.1.2" lspace="0em" xref="S4.Ex10.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex10.m1.4b"><apply id="S4.Ex10.m1.4.4.1.1.cmml" xref="S4.Ex10.m1.4.4.1"><equivalent id="S4.Ex10.m1.4.4.1.1.2.cmml" xref="S4.Ex10.m1.4.4.1.1.2"></equivalent><ci id="S4.Ex10.m1.4.4.1.1.3.cmml" xref="S4.Ex10.m1.4.4.1.1.3">𝒅</ci><apply id="S4.Ex10.m1.4.4.1.1.1.cmml" xref="S4.Ex10.m1.4.4.1.1.1"><minus id="S4.Ex10.m1.4.4.1.1.1.2.cmml" xref="S4.Ex10.m1.4.4.1.1.1"></minus><apply id="S4.Ex10.m1.4.4.1.1.1.1.2.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1"><apply id="S4.Ex10.m1.3.3.cmml" xref="S4.Ex10.m1.3.3"><times id="S4.Ex10.m1.3.3.1.cmml" xref="S4.Ex10.m1.3.3.1"></times><ci id="S4.Ex10.m1.3.3.2.cmml" xref="S4.Ex10.m1.3.3.2">diag</ci><ci id="S4.Ex10.m1.3.3.3.cmml" xref="S4.Ex10.m1.3.3.3">_</ci><ci id="S4.Ex10.m1.3.3.4.cmml" xref="S4.Ex10.m1.3.3.4">of</ci></apply><apply id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1"><times id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.1"></times><apply id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.2">𝑼</ci><ci id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.3.2"><ci id="S4.Ex10.m1.1.1.cmml" xref="S4.Ex10.m1.1.1">diag</ci><ci id="S4.Ex10.m1.2.2.cmml" xref="S4.Ex10.m1.2.2">𝒆</ci></apply><ci id="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.4.cmml" xref="S4.Ex10.m1.4.4.1.1.1.1.1.1.1.4">𝑼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex10.m1.4c">{\bm{d}}\equiv-\operatorname{diag\_of}({\bm{U}}^{T}\operatorname{diag}({\bm{e}%
}){\bm{U}}).</annotation><annotation encoding="application/x-llamapun" id="S4.Ex10.m1.4d">bold_italic_d ≡ - start_OPFUNCTION roman_diag _ roman_of end_OPFUNCTION ( bold_italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_e ) bold_italic_U ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p1.14">In other words, we ensure that <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.8.m1.1"><semantics id="S4.SS2.SSS1.p1.8.m1.1a"><mi id="S4.SS2.SSS1.p1.8.m1.1.1" xref="S4.SS2.SSS1.p1.8.m1.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.8.m1.1b"><ci id="S4.SS2.SSS1.p1.8.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.8.m1.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.8.m1.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.8.m1.1d">bold_italic_R</annotation></semantics></math> is defined to be a symmetric matrix with a zero diagonal by forming a symmetric eigenvalue-like decomposition, and subtracting the diagonal of the resulting matrix. The formal definition of <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.9.m2.1"><semantics id="S4.SS2.SSS1.p1.9.m2.1a"><mi id="S4.SS2.SSS1.p1.9.m2.1.1" xref="S4.SS2.SSS1.p1.9.m2.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.9.m2.1b"><ci id="S4.SS2.SSS1.p1.9.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.9.m2.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.9.m2.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.9.m2.1d">bold_italic_R</annotation></semantics></math> allows us to apply Proposition <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.Thmtheorem1" title="Proposition 0. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">4.1</span></a>. This means that, we do not need to compute the matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.10.m3.1"><semantics id="S4.SS2.SSS1.p1.10.m3.1a"><mi id="S4.SS2.SSS1.p1.10.m3.1.1" xref="S4.SS2.SSS1.p1.10.m3.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.10.m3.1b"><ci id="S4.SS2.SSS1.p1.10.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.10.m3.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.10.m3.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.10.m3.1d">bold_italic_R</annotation></semantics></math> itself at any stage. Instead, we replace the FwFM pairwise interaction term in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.E3" title="In 3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>), with the outcome of the proposition in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.E9" title="In Proposition 0. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>). Namely, we compute <math alttext="{\bm{P}}={\bm{U}}{\bm{V}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.11.m4.1"><semantics id="S4.SS2.SSS1.p1.11.m4.1a"><mrow id="S4.SS2.SSS1.p1.11.m4.1.1" xref="S4.SS2.SSS1.p1.11.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p1.11.m4.1.1.2" xref="S4.SS2.SSS1.p1.11.m4.1.1.2.cmml">𝑷</mi><mo id="S4.SS2.SSS1.p1.11.m4.1.1.1" xref="S4.SS2.SSS1.p1.11.m4.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p1.11.m4.1.1.3" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.11.m4.1.1.3.2" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.2.cmml">𝑼</mi><mo id="S4.SS2.SSS1.p1.11.m4.1.1.3.1" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.11.m4.1.1.3.3" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.3.cmml">𝑽</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.11.m4.1b"><apply id="S4.SS2.SSS1.p1.11.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1"><eq id="S4.SS2.SSS1.p1.11.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.11.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1.2">𝑷</ci><apply id="S4.SS2.SSS1.p1.11.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1.3"><times id="S4.SS2.SSS1.p1.11.m4.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.1"></times><ci id="S4.SS2.SSS1.p1.11.m4.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.2">𝑼</ci><ci id="S4.SS2.SSS1.p1.11.m4.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.11.m4.1.1.3.3">𝑽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.11.m4.1c">{\bm{P}}={\bm{U}}{\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.11.m4.1d">bold_italic_P = bold_italic_U bold_italic_V</annotation></semantics></math> in <math alttext="O(\rho mk)" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.12.m5.1"><semantics id="S4.SS2.SSS1.p1.12.m5.1a"><mrow id="S4.SS2.SSS1.p1.12.m5.1.1" xref="S4.SS2.SSS1.p1.12.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p1.12.m5.1.1.3" xref="S4.SS2.SSS1.p1.12.m5.1.1.3.cmml">O</mi><mo id="S4.SS2.SSS1.p1.12.m5.1.1.2" xref="S4.SS2.SSS1.p1.12.m5.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p1.12.m5.1.1.1.1" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.2.cmml">ρ</mi><mo id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.3.cmml">m</mi><mo id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.1a" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.4" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.4.cmml">k</mi></mrow><mo id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.12.m5.1b"><apply id="S4.SS2.SSS1.p1.12.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1"><times id="S4.SS2.SSS1.p1.12.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.2"></times><ci id="S4.SS2.SSS1.p1.12.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.3">𝑂</ci><apply id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1"><times id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.1"></times><ci id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.2">𝜌</ci><ci id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.3">𝑚</ci><ci id="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.4.cmml" xref="S4.SS2.SSS1.p1.12.m5.1.1.1.1.1.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.12.m5.1c">O(\rho mk)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.12.m5.1d">italic_O ( italic_ρ italic_m italic_k )</annotation></semantics></math> time, and then compute <math alttext="\frac{1}{2}\left(\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{\rho}{e%
}_{i}\|{\bm{P}}_{i,:}\|^{2}\right)" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.13.m6.3"><semantics id="S4.SS2.SSS1.p1.13.m6.3a"><mrow id="S4.SS2.SSS1.p1.13.m6.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.cmml"><mfrac id="S4.SS2.SSS1.p1.13.m6.3.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.3.cmml"><mn id="S4.SS2.SSS1.p1.13.m6.3.3.3.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.3.2.cmml">1</mn><mn id="S4.SS2.SSS1.p1.13.m6.3.3.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.3.3.cmml">2</mn></mfrac><mo id="S4.SS2.SSS1.p1.13.m6.3.3.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.2.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.cmml"><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.cmml"><msubsup id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.2" lspace="0em" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.3.cmml">m</mi></msubsup><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.cmml"><msub id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.2.cmml">d</mi><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.3" rspace="0.055em" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.3.cmml">+</mo><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.cmml"><msubsup id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.cmml"><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.3.cmml">ρ</mi></msubsup><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.cmml"><msub id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.2.cmml">e</mi><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.2.cmml">⁢</mo><msup id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.2.cmml"><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.2.cmml">𝑷</mi><mrow id="S4.SS2.SSS1.p1.13.m6.2.2.2.4" xref="S4.SS2.SSS1.p1.13.m6.2.2.2.3.cmml"><mi id="S4.SS2.SSS1.p1.13.m6.1.1.1.1" xref="S4.SS2.SSS1.p1.13.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS2.SSS1.p1.13.m6.2.2.2.4.1" xref="S4.SS2.SSS1.p1.13.m6.2.2.2.3.cmml">,</mo><mo id="S4.SS2.SSS1.p1.13.m6.2.2.2.2" xref="S4.SS2.SSS1.p1.13.m6.2.2.2.2.cmml">:</mo></mrow></msub><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.3" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.13.m6.3b"><apply id="S4.SS2.SSS1.p1.13.m6.3.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3"><times id="S4.SS2.SSS1.p1.13.m6.3.3.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.2"></times><apply id="S4.SS2.SSS1.p1.13.m6.3.3.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.3"><divide id="S4.SS2.SSS1.p1.13.m6.3.3.3.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.3"></divide><cn id="S4.SS2.SSS1.p1.13.m6.3.3.3.2.cmml" type="integer" xref="S4.SS2.SSS1.p1.13.m6.3.3.3.2">1</cn><cn id="S4.SS2.SSS1.p1.13.m6.3.3.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.13.m6.3.3.3.3">2</cn></apply><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1"><plus id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.3"></plus><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1"><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2">subscript</csymbol><sum id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.2"></sum><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3"><eq id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.2.3">𝑚</ci></apply><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1"><times id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.2"></times><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.2">𝑑</ci><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2"><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2">superscript</csymbol><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2">subscript</csymbol><sum id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.2"></sum><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3"><eq id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.1"></eq><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.2">𝑖</ci><cn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.2.3">𝜌</ci></apply><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1"><times id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.2"></times><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.2">𝑒</ci><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.3.3">𝑖</ci></apply><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.1.1.1.2">𝑷</ci><list id="S4.SS2.SSS1.p1.13.m6.2.2.2.3.cmml" xref="S4.SS2.SSS1.p1.13.m6.2.2.2.4"><ci id="S4.SS2.SSS1.p1.13.m6.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.13.m6.1.1.1.1">𝑖</ci><ci id="S4.SS2.SSS1.p1.13.m6.2.2.2.2.cmml" xref="S4.SS2.SSS1.p1.13.m6.2.2.2.2">:</ci></list></apply></apply><cn id="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.3.cmml" type="integer" xref="S4.SS2.SSS1.p1.13.m6.3.3.1.1.1.2.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.13.m6.3c">\frac{1}{2}\left(\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{\rho}{e%
}_{i}\|{\bm{P}}_{i,:}\|^{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.13.m6.3d">divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_P start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> in <math alttext="O(\rho k+mk)" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.14.m7.1"><semantics id="S4.SS2.SSS1.p1.14.m7.1a"><mrow id="S4.SS2.SSS1.p1.14.m7.1.1" xref="S4.SS2.SSS1.p1.14.m7.1.1.cmml"><mi id="S4.SS2.SSS1.p1.14.m7.1.1.3" xref="S4.SS2.SSS1.p1.14.m7.1.1.3.cmml">O</mi><mo id="S4.SS2.SSS1.p1.14.m7.1.1.2" xref="S4.SS2.SSS1.p1.14.m7.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p1.14.m7.1.1.1.1" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.cmml"><mi id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.2" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.2.cmml">ρ</mi><mo id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.1" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.3" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.3.cmml">k</mi></mrow><mo id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.2" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.2.cmml">m</mi><mo id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.1" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.3" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.3.cmml">k</mi></mrow></mrow><mo id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.14.m7.1b"><apply id="S4.SS2.SSS1.p1.14.m7.1.1.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1"><times id="S4.SS2.SSS1.p1.14.m7.1.1.2.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.2"></times><ci id="S4.SS2.SSS1.p1.14.m7.1.1.3.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.3">𝑂</ci><apply id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1"><plus id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.1"></plus><apply id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2"><times id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.1"></times><ci id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.2">𝜌</ci><ci id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3"><times id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.1"></times><ci id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.2">𝑚</ci><ci id="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.14.m7.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.14.m7.1c">O(\rho k+mk)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.14.m7.1d">italic_O ( italic_ρ italic_k + italic_m italic_k )</annotation></semantics></math> time.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.2">We call the resulting model a diagonal plus low-rank field weighted factorization machine, or DPLR-FwFM. Although this is not our main objective, a nice byproduct is that training also becomes slightly faster, since the above two steps cost <math alttext="O(\rho mk)" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.1.m1.1"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mrow id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml">O</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p2.1.m1.1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.2.cmml">ρ</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.1a" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.4" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.4.cmml">k</mi></mrow><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><apply id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1"><times id="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.2"></times><ci id="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3">𝑂</ci><apply id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1"><times id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.1"></times><ci id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.2">𝜌</ci><ci id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.3">𝑚</ci><ci id="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.4.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.1.1.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">O(\rho mk)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.1.m1.1d">italic_O ( italic_ρ italic_m italic_k )</annotation></semantics></math> time instead the naïve <math alttext="O(m^{2}k)" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.2.m2.1"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mrow id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p2.2.m2.1.1.3" xref="S4.SS2.SSS1.p2.2.m2.1.1.3.cmml">O</mi><mo id="S4.SS2.SSS1.p2.2.m2.1.1.2" xref="S4.SS2.SSS1.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p2.2.m2.1.1.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.cmml"><mo id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.cmml"><msup id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.cmml"><mi id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.2" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.2.cmml">m</mi><mn id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.3" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.3.cmml">k</mi></mrow><mo id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.1b"><apply id="S4.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1"><times id="S4.SS2.SSS1.p2.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.2"></times><ci id="S4.SS2.SSS1.p2.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.3">𝑂</ci><apply id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1"><times id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.1"></times><apply id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2">superscript</csymbol><ci id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.2">𝑚</ci><cn id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.1c">O(m^{2}k)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.2.m2.1d">italic_O ( italic_m start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_k )</annotation></semantics></math>. This is important for some online advertising systems that require deploying a “fresh” model as soon as possible, to adapt to the quickly evolving marketplace conditions <cite class="ltx_cite ltx_citemacro_citep">(Sculley et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib33" title="">2015</a>; Lommatzsch et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib23" title="">2017</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib39" title="">2020</a>)</cite>. However, for inference during <em class="ltx_emph ltx_font_italic" id="S4.SS2.SSS1.p2.2.1">ranking</em> we need to take the result of the proposition one step further.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Fast inference for item ranking</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">Observe that the field vectors embedded into the rows of <math alttext="{\bm{V}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.1"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mi id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">{\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">bold_italic_V</annotation></semantics></math> can be decomposed into context and item vectors:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{V}}=\begin{bmatrix}{\bm{V}}_{\mathcal{C}}\\
\vphantom{m}\\
{\bm{V}}_{\mathcal{I}}\end{bmatrix}" class="ltx_Math" display="block" id="S4.Ex11.m1.1"><semantics id="S4.Ex11.m1.1a"><mrow id="S4.Ex11.m1.1.2" xref="S4.Ex11.m1.1.2.cmml"><mi id="S4.Ex11.m1.1.2.2" xref="S4.Ex11.m1.1.2.2.cmml">𝑽</mi><mo id="S4.Ex11.m1.1.2.1" xref="S4.Ex11.m1.1.2.1.cmml">=</mo><mrow id="S4.Ex11.m1.1.1.3" xref="S4.Ex11.m1.1.1.2.cmml"><mo id="S4.Ex11.m1.1.1.3.1" xref="S4.Ex11.m1.1.1.2.1.cmml">[</mo><mtable displaystyle="true" id="S4.Ex11.m1.1.1.1.1" rowspacing="0pt" xref="S4.Ex11.m1.1.1.1.1.cmml"><mtr id="S4.Ex11.m1.1.1.1.1a" xref="S4.Ex11.m1.1.1.1.1.cmml"><mtd id="S4.Ex11.m1.1.1.1.1b" xref="S4.Ex11.m1.1.1.1.1.cmml"><msub id="S4.Ex11.m1.1.1.1.1.1.1.1" xref="S4.Ex11.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex11.m1.1.1.1.1.1.1.1.2" xref="S4.Ex11.m1.1.1.1.1.1.1.1.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex11.m1.1.1.1.1.1.1.1.3" xref="S4.Ex11.m1.1.1.1.1.1.1.1.3.cmml">𝒞</mi></msub></mtd></mtr><mtr id="S4.Ex11.m1.1.1.1.1c" xref="S4.Ex11.m1.1.1.1.1.cmml"><mtd id="S4.Ex11.m1.1.1.1.1d" xref="S4.Ex11.m1.1.1.1.1.cmml"></mtd></mtr><mtr id="S4.Ex11.m1.1.1.1.1e" xref="S4.Ex11.m1.1.1.1.1.cmml"><mtd id="S4.Ex11.m1.1.1.1.1f" xref="S4.Ex11.m1.1.1.1.1.cmml"><msub id="S4.Ex11.m1.1.1.1.1.3.1.1" xref="S4.Ex11.m1.1.1.1.1.3.1.1.cmml"><mi id="S4.Ex11.m1.1.1.1.1.3.1.1.2" xref="S4.Ex11.m1.1.1.1.1.3.1.1.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex11.m1.1.1.1.1.3.1.1.3" xref="S4.Ex11.m1.1.1.1.1.3.1.1.3.cmml">ℐ</mi></msub></mtd></mtr></mtable><mo id="S4.Ex11.m1.1.1.3.2" xref="S4.Ex11.m1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex11.m1.1b"><apply id="S4.Ex11.m1.1.2.cmml" xref="S4.Ex11.m1.1.2"><eq id="S4.Ex11.m1.1.2.1.cmml" xref="S4.Ex11.m1.1.2.1"></eq><ci id="S4.Ex11.m1.1.2.2.cmml" xref="S4.Ex11.m1.1.2.2">𝑽</ci><apply id="S4.Ex11.m1.1.1.2.cmml" xref="S4.Ex11.m1.1.1.3"><csymbol cd="latexml" id="S4.Ex11.m1.1.1.2.1.cmml" xref="S4.Ex11.m1.1.1.3.1">matrix</csymbol><matrix id="S4.Ex11.m1.1.1.1.1.cmml" xref="S4.Ex11.m1.1.1.1.1"><matrixrow id="S4.Ex11.m1.1.1.1.1a.cmml" xref="S4.Ex11.m1.1.1.1.1"><apply id="S4.Ex11.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex11.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex11.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex11.m1.1.1.1.1.1.1.1.2">𝑽</ci><ci id="S4.Ex11.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex11.m1.1.1.1.1.1.1.1.3">𝒞</ci></apply></matrixrow><matrixrow id="S4.Ex11.m1.1.1.1.1b.cmml" xref="S4.Ex11.m1.1.1.1.1"><cerror id="S4.Ex11.m1.1.1.1.1c.cmml" xref="S4.Ex11.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.1.1d.cmml" xref="S4.Ex11.m1.1.1.1.1">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S4.Ex11.m1.1.1.1.1e.cmml" xref="S4.Ex11.m1.1.1.1.1"><apply id="S4.Ex11.m1.1.1.1.1.3.1.1.cmml" xref="S4.Ex11.m1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.Ex11.m1.1.1.1.1.3.1.1.1.cmml" xref="S4.Ex11.m1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S4.Ex11.m1.1.1.1.1.3.1.1.2.cmml" xref="S4.Ex11.m1.1.1.1.1.3.1.1.2">𝑽</ci><ci id="S4.Ex11.m1.1.1.1.1.3.1.1.3.cmml" xref="S4.Ex11.m1.1.1.1.1.3.1.1.3">ℐ</ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex11.m1.1c">{\bm{V}}=\begin{bmatrix}{\bm{V}}_{\mathcal{C}}\\
\vphantom{m}\\
{\bm{V}}_{\mathcal{I}}\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex11.m1.1d">bold_italic_V = [ start_ARG start_ROW start_CELL bold_italic_V start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL end_ROW start_ROW start_CELL bold_italic_V start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p1.2">The corresponding columns of <math alttext="{\bm{U}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.2.m1.1"><semantics id="S4.SS2.SSS2.p1.2.m1.1a"><mi id="S4.SS2.SSS2.p1.2.m1.1.1" xref="S4.SS2.SSS2.p1.2.m1.1.1.cmml">𝑼</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m1.1b"><ci id="S4.SS2.SSS2.p1.2.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m1.1.1">𝑼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m1.1c">{\bm{U}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m1.1d">bold_italic_U</annotation></semantics></math> can be decomposed similarly:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{U}}=\begin{bmatrix}{\bm{U}}_{\mathcal{C}}&amp;{\bm{U}}_{\mathcal{I}}\end{bmatrix}" class="ltx_Math" display="block" id="S4.Ex12.m1.1"><semantics id="S4.Ex12.m1.1a"><mrow id="S4.Ex12.m1.1.2" xref="S4.Ex12.m1.1.2.cmml"><mi id="S4.Ex12.m1.1.2.2" xref="S4.Ex12.m1.1.2.2.cmml">𝑼</mi><mo id="S4.Ex12.m1.1.2.1" xref="S4.Ex12.m1.1.2.1.cmml">=</mo><mrow id="S4.Ex12.m1.1.1.3" xref="S4.Ex12.m1.1.1.2.cmml"><mo id="S4.Ex12.m1.1.1.3.1" xref="S4.Ex12.m1.1.1.2.1.cmml">[</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.Ex12.m1.1.1.1.1" xref="S4.Ex12.m1.1.1.1.1.cmml"><mtr id="S4.Ex12.m1.1.1.1.1a" xref="S4.Ex12.m1.1.1.1.1.cmml"><mtd id="S4.Ex12.m1.1.1.1.1b" xref="S4.Ex12.m1.1.1.1.1.cmml"><msub id="S4.Ex12.m1.1.1.1.1.1.1.1" xref="S4.Ex12.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex12.m1.1.1.1.1.1.1.1.2" xref="S4.Ex12.m1.1.1.1.1.1.1.1.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex12.m1.1.1.1.1.1.1.1.3" xref="S4.Ex12.m1.1.1.1.1.1.1.1.3.cmml">𝒞</mi></msub></mtd><mtd id="S4.Ex12.m1.1.1.1.1c" xref="S4.Ex12.m1.1.1.1.1.cmml"><msub id="S4.Ex12.m1.1.1.1.1.1.2.1" xref="S4.Ex12.m1.1.1.1.1.1.2.1.cmml"><mi id="S4.Ex12.m1.1.1.1.1.1.2.1.2" xref="S4.Ex12.m1.1.1.1.1.1.2.1.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex12.m1.1.1.1.1.1.2.1.3" xref="S4.Ex12.m1.1.1.1.1.1.2.1.3.cmml">ℐ</mi></msub></mtd></mtr></mtable><mo id="S4.Ex12.m1.1.1.3.2" xref="S4.Ex12.m1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex12.m1.1b"><apply id="S4.Ex12.m1.1.2.cmml" xref="S4.Ex12.m1.1.2"><eq id="S4.Ex12.m1.1.2.1.cmml" xref="S4.Ex12.m1.1.2.1"></eq><ci id="S4.Ex12.m1.1.2.2.cmml" xref="S4.Ex12.m1.1.2.2">𝑼</ci><apply id="S4.Ex12.m1.1.1.2.cmml" xref="S4.Ex12.m1.1.1.3"><csymbol cd="latexml" id="S4.Ex12.m1.1.1.2.1.cmml" xref="S4.Ex12.m1.1.1.3.1">matrix</csymbol><matrix id="S4.Ex12.m1.1.1.1.1.cmml" xref="S4.Ex12.m1.1.1.1.1"><matrixrow id="S4.Ex12.m1.1.1.1.1a.cmml" xref="S4.Ex12.m1.1.1.1.1"><apply id="S4.Ex12.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex12.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex12.m1.1.1.1.1.1.1.1.2">𝑼</ci><ci id="S4.Ex12.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex12.m1.1.1.1.1.1.1.1.3">𝒞</ci></apply><apply id="S4.Ex12.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex12.m1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S4.Ex12.m1.1.1.1.1.1.2.1.1.cmml" xref="S4.Ex12.m1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S4.Ex12.m1.1.1.1.1.1.2.1.2.cmml" xref="S4.Ex12.m1.1.1.1.1.1.2.1.2">𝑼</ci><ci id="S4.Ex12.m1.1.1.1.1.1.2.1.3.cmml" xref="S4.Ex12.m1.1.1.1.1.1.2.1.3">ℐ</ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex12.m1.1c">{\bm{U}}=\begin{bmatrix}{\bm{U}}_{\mathcal{C}}&amp;{\bm{U}}_{\mathcal{I}}\end{bmatrix}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex12.m1.1d">bold_italic_U = [ start_ARG start_ROW start_CELL bold_italic_U start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT end_CELL start_CELL bold_italic_U start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT end_CELL end_ROW end_ARG ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p1.3">Consequently, matrix <math alttext="{\bm{P}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m1.1"><semantics id="S4.SS2.SSS2.p1.3.m1.1a"><mi id="S4.SS2.SSS2.p1.3.m1.1.1" xref="S4.SS2.SSS2.p1.3.m1.1.1.cmml">𝑷</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m1.1b"><ci id="S4.SS2.SSS2.p1.3.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m1.1.1">𝑷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m1.1c">{\bm{P}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m1.1d">bold_italic_P</annotation></semantics></math> can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\bm{P}}={\bm{U}}_{\mathcal{C}}{\bm{V}}_{\mathcal{C}}+{\bm{U}}_{\mathcal{I}}{%
\bm{V}}_{\mathcal{I}}," class="ltx_Math" display="block" id="S4.Ex13.m1.1"><semantics id="S4.Ex13.m1.1a"><mrow id="S4.Ex13.m1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.cmml"><mrow id="S4.Ex13.m1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.cmml"><mi id="S4.Ex13.m1.1.1.1.1.2" xref="S4.Ex13.m1.1.1.1.1.2.cmml">𝑷</mi><mo id="S4.Ex13.m1.1.1.1.1.1" xref="S4.Ex13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.Ex13.m1.1.1.1.1.3" xref="S4.Ex13.m1.1.1.1.1.3.cmml"><mrow id="S4.Ex13.m1.1.1.1.1.3.2" xref="S4.Ex13.m1.1.1.1.1.3.2.cmml"><msub id="S4.Ex13.m1.1.1.1.1.3.2.2" xref="S4.Ex13.m1.1.1.1.1.3.2.2.cmml"><mi id="S4.Ex13.m1.1.1.1.1.3.2.2.2" xref="S4.Ex13.m1.1.1.1.1.3.2.2.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex13.m1.1.1.1.1.3.2.2.3" xref="S4.Ex13.m1.1.1.1.1.3.2.2.3.cmml">𝒞</mi></msub><mo id="S4.Ex13.m1.1.1.1.1.3.2.1" xref="S4.Ex13.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S4.Ex13.m1.1.1.1.1.3.2.3" xref="S4.Ex13.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.Ex13.m1.1.1.1.1.3.2.3.2" xref="S4.Ex13.m1.1.1.1.1.3.2.3.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex13.m1.1.1.1.1.3.2.3.3" xref="S4.Ex13.m1.1.1.1.1.3.2.3.3.cmml">𝒞</mi></msub></mrow><mo id="S4.Ex13.m1.1.1.1.1.3.1" xref="S4.Ex13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.Ex13.m1.1.1.1.1.3.3" xref="S4.Ex13.m1.1.1.1.1.3.3.cmml"><msub id="S4.Ex13.m1.1.1.1.1.3.3.2" xref="S4.Ex13.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.Ex13.m1.1.1.1.1.3.3.2.2" xref="S4.Ex13.m1.1.1.1.1.3.3.2.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex13.m1.1.1.1.1.3.3.2.3" xref="S4.Ex13.m1.1.1.1.1.3.3.2.3.cmml">ℐ</mi></msub><mo id="S4.Ex13.m1.1.1.1.1.3.3.1" xref="S4.Ex13.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.Ex13.m1.1.1.1.1.3.3.3" xref="S4.Ex13.m1.1.1.1.1.3.3.3.cmml"><mi id="S4.Ex13.m1.1.1.1.1.3.3.3.2" xref="S4.Ex13.m1.1.1.1.1.3.3.3.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.Ex13.m1.1.1.1.1.3.3.3.3" xref="S4.Ex13.m1.1.1.1.1.3.3.3.3.cmml">ℐ</mi></msub></mrow></mrow></mrow><mo id="S4.Ex13.m1.1.1.1.2" xref="S4.Ex13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex13.m1.1b"><apply id="S4.Ex13.m1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1"><eq id="S4.Ex13.m1.1.1.1.1.1.cmml" xref="S4.Ex13.m1.1.1.1.1.1"></eq><ci id="S4.Ex13.m1.1.1.1.1.2.cmml" xref="S4.Ex13.m1.1.1.1.1.2">𝑷</ci><apply id="S4.Ex13.m1.1.1.1.1.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3"><plus id="S4.Ex13.m1.1.1.1.1.3.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.1"></plus><apply id="S4.Ex13.m1.1.1.1.1.3.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2"><times id="S4.Ex13.m1.1.1.1.1.3.2.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.1"></times><apply id="S4.Ex13.m1.1.1.1.1.3.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.2.2">𝑼</ci><ci id="S4.Ex13.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.2.3">𝒞</ci></apply><apply id="S4.Ex13.m1.1.1.1.1.3.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.3.2">𝑽</ci><ci id="S4.Ex13.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.2.3.3">𝒞</ci></apply></apply><apply id="S4.Ex13.m1.1.1.1.1.3.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3"><times id="S4.Ex13.m1.1.1.1.1.3.3.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.1"></times><apply id="S4.Ex13.m1.1.1.1.1.3.3.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.2.2">𝑼</ci><ci id="S4.Ex13.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.2.3">ℐ</ci></apply><apply id="S4.Ex13.m1.1.1.1.1.3.3.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.Ex13.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.Ex13.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.3.2">𝑽</ci><ci id="S4.Ex13.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.Ex13.m1.1.1.1.1.3.3.3.3">ℐ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex13.m1.1c">{\bm{P}}={\bm{U}}_{\mathcal{C}}{\bm{V}}_{\mathcal{C}}+{\bm{U}}_{\mathcal{I}}{%
\bm{V}}_{\mathcal{I}},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex13.m1.1d">bold_italic_P = bold_italic_U start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT bold_italic_V start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT + bold_italic_U start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT bold_italic_V start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p1.5">The product <math alttext="{\bm{U}}_{\mathcal{C}}{\bm{V}}_{\mathcal{C}}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.4.m1.1"><semantics id="S4.SS2.SSS2.p1.4.m1.1a"><mrow id="S4.SS2.SSS2.p1.4.m1.1.1" xref="S4.SS2.SSS2.p1.4.m1.1.1.cmml"><msub id="S4.SS2.SSS2.p1.4.m1.1.1.2" xref="S4.SS2.SSS2.p1.4.m1.1.1.2.cmml"><mi id="S4.SS2.SSS2.p1.4.m1.1.1.2.2" xref="S4.SS2.SSS2.p1.4.m1.1.1.2.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p1.4.m1.1.1.2.3" xref="S4.SS2.SSS2.p1.4.m1.1.1.2.3.cmml">𝒞</mi></msub><mo id="S4.SS2.SSS2.p1.4.m1.1.1.1" xref="S4.SS2.SSS2.p1.4.m1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS2.p1.4.m1.1.1.3" xref="S4.SS2.SSS2.p1.4.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.4.m1.1.1.3.2" xref="S4.SS2.SSS2.p1.4.m1.1.1.3.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p1.4.m1.1.1.3.3" xref="S4.SS2.SSS2.p1.4.m1.1.1.3.3.cmml">𝒞</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m1.1b"><apply id="S4.SS2.SSS2.p1.4.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1"><times id="S4.SS2.SSS2.p1.4.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.1"></times><apply id="S4.SS2.SSS2.p1.4.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.4.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.4.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.2.2">𝑼</ci><ci id="S4.SS2.SSS2.p1.4.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.2.3">𝒞</ci></apply><apply id="S4.SS2.SSS2.p1.4.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.4.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.4.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.3.2">𝑽</ci><ci id="S4.SS2.SSS2.p1.4.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.4.m1.1.1.3.3">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m1.1c">{\bm{U}}_{\mathcal{C}}{\bm{V}}_{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.4.m1.1d">bold_italic_U start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT bold_italic_V start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT</annotation></semantics></math> can be computed only once when ranking with a given context. The sum <math alttext="\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.5.m2.1"><semantics id="S4.SS2.SSS2.p1.5.m2.1a"><mrow id="S4.SS2.SSS2.p1.5.m2.1.1" xref="S4.SS2.SSS2.p1.5.m2.1.1.cmml"><msubsup id="S4.SS2.SSS2.p1.5.m2.1.1.2" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.cmml"><mo id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.2" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.cmml"><mi id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.2" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.1" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p1.5.m2.1.1.2.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.3.cmml">m</mi></msubsup><mrow id="S4.SS2.SSS2.p1.5.m2.1.1.1" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.cmml"><msub id="S4.SS2.SSS2.p1.5.m2.1.1.1.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.5.m2.1.1.1.3.2" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3.2.cmml">d</mi><mi id="S4.SS2.SSS2.p1.5.m2.1.1.1.3.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p1.5.m2.1.1.1.2" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.2.cmml">⁢</mo><msup id="S4.SS2.SSS2.p1.5.m2.1.1.1.1" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.cmml"><mrow id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.3" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.5.m2.1b"><apply id="S4.SS2.SSS2.p1.5.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1"><apply id="S4.SS2.SSS2.p1.5.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m2.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2">superscript</csymbol><apply id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2">subscript</csymbol><sum id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.2"></sum><apply id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3"><eq id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.1"></eq><ci id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.2">𝑖</ci><cn id="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p1.5.m2.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.2.3">𝑚</ci></apply><apply id="S4.SS2.SSS2.p1.5.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1"><times id="S4.SS2.SSS2.p1.5.m2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.2"></times><apply id="S4.SS2.SSS2.p1.5.m2.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m2.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.5.m2.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3.2">𝑑</ci><ci id="S4.SS2.SSS2.p1.5.m2.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.SS2.SSS2.p1.5.m2.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.5.m2.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.5.m2.1c">\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.5.m2.1d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> can also be similarly decomposed as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}=\sum_{i\in\mathcal{C}}{d}_{i}\|{\bm{%
v}}_{i}\|^{2}+\sum_{i\in\mathcal{I}}{d}_{i}\|{\bm{v}}_{i}\|^{2}," class="ltx_Math" display="block" id="S4.Ex14.m1.1"><semantics id="S4.Ex14.m1.1a"><mrow id="S4.Ex14.m1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.cmml"><munderover id="S4.Ex14.m1.1.1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.1.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.Ex14.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.Ex14.m1.1.1.1.1.1.2.2.3" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.1.2.2.3.2" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.Ex14.m1.1.1.1.1.1.2.2.3.1" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.Ex14.m1.1.1.1.1.1.2.2.3.3" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex14.m1.1.1.1.1.1.2.3" xref="S4.Ex14.m1.1.1.1.1.1.2.3.cmml">m</mi></munderover><mrow id="S4.Ex14.m1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.1.cmml"><msub id="S4.Ex14.m1.1.1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.1.1.3.2" xref="S4.Ex14.m1.1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S4.Ex14.m1.1.1.1.1.1.1.3.3" xref="S4.Ex14.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.Ex14.m1.1.1.1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.Ex14.m1.1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex14.m1.1.1.1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.Ex14.m1.1.1.1.1.4" rspace="0.111em" xref="S4.Ex14.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.Ex14.m1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.3.cmml"><mrow id="S4.Ex14.m1.1.1.1.1.2.1" xref="S4.Ex14.m1.1.1.1.1.2.1.cmml"><munder id="S4.Ex14.m1.1.1.1.1.2.1.2" xref="S4.Ex14.m1.1.1.1.1.2.1.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.2.1.2.2" movablelimits="false" xref="S4.Ex14.m1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.Ex14.m1.1.1.1.1.2.1.2.3" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.2.1.2.3.2" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.2.cmml">i</mi><mo id="S4.Ex14.m1.1.1.1.1.2.1.2.3.1" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex14.m1.1.1.1.1.2.1.2.3.3" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.3.cmml">𝒞</mi></mrow></munder><mrow id="S4.Ex14.m1.1.1.1.1.2.1.1" xref="S4.Ex14.m1.1.1.1.1.2.1.1.cmml"><msub id="S4.Ex14.m1.1.1.1.1.2.1.1.3" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.2.1.1.3.2" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3.2.cmml">d</mi><mi id="S4.Ex14.m1.1.1.1.1.2.1.1.3.3" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3.3.cmml">i</mi></msub><mo id="S4.Ex14.m1.1.1.1.1.2.1.1.2" xref="S4.Ex14.m1.1.1.1.1.2.1.1.2.cmml">⁢</mo><msup id="S4.Ex14.m1.1.1.1.1.2.1.1.1" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex14.m1.1.1.1.1.2.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.Ex14.m1.1.1.1.1.3.3" rspace="0.055em" xref="S4.Ex14.m1.1.1.1.1.3.3.cmml">+</mo><mrow id="S4.Ex14.m1.1.1.1.1.3.2" xref="S4.Ex14.m1.1.1.1.1.3.2.cmml"><munder id="S4.Ex14.m1.1.1.1.1.3.2.2" xref="S4.Ex14.m1.1.1.1.1.3.2.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.3.2.2.2" movablelimits="false" xref="S4.Ex14.m1.1.1.1.1.3.2.2.2.cmml">∑</mo><mrow id="S4.Ex14.m1.1.1.1.1.3.2.2.3" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.3.2.2.3.2" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S4.Ex14.m1.1.1.1.1.3.2.2.3.1" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex14.m1.1.1.1.1.3.2.2.3.3" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.3.cmml">ℐ</mi></mrow></munder><mrow id="S4.Ex14.m1.1.1.1.1.3.2.1" xref="S4.Ex14.m1.1.1.1.1.3.2.1.cmml"><msub id="S4.Ex14.m1.1.1.1.1.3.2.1.3" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3.cmml"><mi id="S4.Ex14.m1.1.1.1.1.3.2.1.3.2" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3.2.cmml">d</mi><mi id="S4.Ex14.m1.1.1.1.1.3.2.1.3.3" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3.3.cmml">i</mi></msub><mo id="S4.Ex14.m1.1.1.1.1.3.2.1.2" xref="S4.Ex14.m1.1.1.1.1.3.2.1.2.cmml">⁢</mo><msup id="S4.Ex14.m1.1.1.1.1.3.2.1.1" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.cmml"><mrow id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.2.cmml"><mo id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.2" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.cmml"><mi id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.3" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.3" stretchy="false" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.Ex14.m1.1.1.1.1.3.2.1.1.3" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo id="S4.Ex14.m1.1.1.1.2" xref="S4.Ex14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex14.m1.1b"><apply id="S4.Ex14.m1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1"><eq id="S4.Ex14.m1.1.1.1.1.4.cmml" xref="S4.Ex14.m1.1.1.1.1.4"></eq><apply id="S4.Ex14.m1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1"><apply id="S4.Ex14.m1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.Ex14.m1.1.1.1.1.1.2.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.Ex14.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.Ex14.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3"><eq id="S4.Ex14.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.Ex14.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.Ex14.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.Ex14.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.Ex14.m1.1.1.1.1.1.2.3.cmml" xref="S4.Ex14.m1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S4.Ex14.m1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1"><times id="S4.Ex14.m1.1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.2"></times><apply id="S4.Ex14.m1.1.1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex14.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S4.Ex14.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.Ex14.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.Ex14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.Ex14.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.Ex14.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.Ex14.m1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3"><plus id="S4.Ex14.m1.1.1.1.1.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.3"></plus><apply id="S4.Ex14.m1.1.1.1.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1"><apply id="S4.Ex14.m1.1.1.1.1.2.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.2.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2">subscript</csymbol><sum id="S4.Ex14.m1.1.1.1.1.2.1.2.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2.2"></sum><apply id="S4.Ex14.m1.1.1.1.1.2.1.2.3.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3"><in id="S4.Ex14.m1.1.1.1.1.2.1.2.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.1"></in><ci id="S4.Ex14.m1.1.1.1.1.2.1.2.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.2">𝑖</ci><ci id="S4.Ex14.m1.1.1.1.1.2.1.2.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.2.3.3">𝒞</ci></apply></apply><apply id="S4.Ex14.m1.1.1.1.1.2.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1"><times id="S4.Ex14.m1.1.1.1.1.2.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.2"></times><apply id="S4.Ex14.m1.1.1.1.1.2.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.2.1.1.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3">subscript</csymbol><ci id="S4.Ex14.m1.1.1.1.1.2.1.1.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3.2">𝑑</ci><ci id="S4.Ex14.m1.1.1.1.1.2.1.1.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.3.3">𝑖</ci></apply><apply id="S4.Ex14.m1.1.1.1.1.2.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1">superscript</csymbol><apply id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.2">norm</csymbol><apply id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.Ex14.m1.1.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S4.Ex14.m1.1.1.1.1.2.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.Ex14.m1.1.1.1.1.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2"><apply id="S4.Ex14.m1.1.1.1.1.3.2.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2">subscript</csymbol><sum id="S4.Ex14.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2.2"></sum><apply id="S4.Ex14.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3"><in id="S4.Ex14.m1.1.1.1.1.3.2.2.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.1"></in><ci id="S4.Ex14.m1.1.1.1.1.3.2.2.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.2">𝑖</ci><ci id="S4.Ex14.m1.1.1.1.1.3.2.2.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.2.3.3">ℐ</ci></apply></apply><apply id="S4.Ex14.m1.1.1.1.1.3.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1"><times id="S4.Ex14.m1.1.1.1.1.3.2.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.2"></times><apply id="S4.Ex14.m1.1.1.1.1.3.2.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.3.2.1.3.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3">subscript</csymbol><ci id="S4.Ex14.m1.1.1.1.1.3.2.1.3.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3.2">𝑑</ci><ci id="S4.Ex14.m1.1.1.1.1.3.2.1.3.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.3.3">𝑖</ci></apply><apply id="S4.Ex14.m1.1.1.1.1.3.2.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.3.2.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1">superscript</csymbol><apply id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1"><csymbol cd="latexml" id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.2.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.2">norm</csymbol><apply id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.1.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1">subscript</csymbol><ci id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.2.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.2">𝒗</ci><ci id="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.3.cmml" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.Ex14.m1.1.1.1.1.3.2.1.1.3.cmml" type="integer" xref="S4.Ex14.m1.1.1.1.1.3.2.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex14.m1.1c">\sum_{i=1}^{m}{d}_{i}\|{\bm{v}}_{i}\|^{2}=\sum_{i\in\mathcal{C}}{d}_{i}\|{\bm{%
v}}_{i}\|^{2}+\sum_{i\in\mathcal{I}}{d}_{i}\|{\bm{v}}_{i}\|^{2},</annotation><annotation encoding="application/x-llamapun" id="S4.Ex14.m1.1d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_C end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_I end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p1.8">where <math alttext="\sum_{i\in\mathcal{C}}{d}_{i}\|{\bm{v}}_{i}\|^{2}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.6.m1.1"><semantics id="S4.SS2.SSS2.p1.6.m1.1a"><mrow id="S4.SS2.SSS2.p1.6.m1.1.1" xref="S4.SS2.SSS2.p1.6.m1.1.1.cmml"><msub id="S4.SS2.SSS2.p1.6.m1.1.1.2" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.cmml"><mo id="S4.SS2.SSS2.p1.6.m1.1.1.2.2" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS2.p1.6.m1.1.1.2.3" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.cmml"><mi id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.2" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.1" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.3" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.3.cmml">𝒞</mi></mrow></msub><mrow id="S4.SS2.SSS2.p1.6.m1.1.1.1" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.cmml"><msub id="S4.SS2.SSS2.p1.6.m1.1.1.1.3" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p1.6.m1.1.1.1.3.2" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3.2.cmml">d</mi><mi id="S4.SS2.SSS2.p1.6.m1.1.1.1.3.3" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p1.6.m1.1.1.1.2" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.2.cmml">⁢</mo><msup id="S4.SS2.SSS2.p1.6.m1.1.1.1.1" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.cmml"><mrow id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.6.m1.1b"><apply id="S4.SS2.SSS2.p1.6.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1"><apply id="S4.SS2.SSS2.p1.6.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2">subscript</csymbol><sum id="S4.SS2.SSS2.p1.6.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.2"></sum><apply id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3"><in id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.1"></in><ci id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.2">𝑖</ci><ci id="S4.SS2.SSS2.p1.6.m1.1.1.2.3.3.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S4.SS2.SSS2.p1.6.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1"><times id="S4.SS2.SSS2.p1.6.m1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.2"></times><apply id="S4.SS2.SSS2.p1.6.m1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m1.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p1.6.m1.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3.2">𝑑</ci><ci id="S4.SS2.SSS2.p1.6.m1.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.SS2.SSS2.p1.6.m1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.6.m1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.6.m1.1c">\sum_{i\in\mathcal{C}}{d}_{i}\|{\bm{v}}_{i}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.6.m1.1d">∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_C end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> can be computed once when ranking with a given context.
To summarize, during ranking, the pairwise interaction term of each item during ranking using DPLR-FwFM can be computed by the following algorithm: 
<br class="ltx_break"/>
<span class="ltx_inline-logical-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="S4.SS2.SSS2.p1.8.2.2" style="width:411.9pt;">
<span class="ltx_para" id="S4.SS2.SSS2.p1.8.2.2.p2">
<span class="ltx_p ltx_align_center" id="S4.SS2.SSS2.p1.8.2.2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p1.8.2.2.p2.1.1">Algorithm 1</span></span>
<span class="ltx_p ltx_align_center" id="S4.SS2.SSS2.p1.8.2.2.p2.2">DPLR FwFM pairwise interaction inference with cached context</span>
</span>
<span class="ltx_para ltx_noindent" id="S4.SS2.SSS2.p1.7.1.1.p1">
<br class="ltx_break"/>
<span class="ltx_p" id="S4.SS2.SSS2.p1.7.1.1.p1.2"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p1.7.1.1.p1.2.1">Input</span>:</span>
<span class="ltx_itemize" id="S4.I1">
<span class="ltx_item" id="S4.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I1.i1.p1">
<span class="ltx_p" id="S4.I1.i1.p1.3">The field matrix <math alttext="{\bm{V}}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mi id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><ci id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">{\bm{V}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">bold_italic_V</annotation></semantics></math>, partitioned into <math alttext="{\bm{V}}_{\mathcal{C}}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><msub id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2" xref="S4.I1.i1.p1.2.m2.1.1.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml">𝒞</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.2.m2.1.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2">𝑽</ci><ci id="S4.I1.i1.p1.2.m2.1.1.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">{\bm{V}}_{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">bold_italic_V start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{V}}_{\mathcal{I}}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><msub id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.3.m3.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.3.cmml">ℐ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2">𝑽</ci><ci id="S4.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">{\bm{V}}_{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">bold_italic_V start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></span>
<span class="ltx_item" id="S4.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">•</span>
<span class="ltx_para" id="S4.I1.i2.p1">
<span class="ltx_p" id="S4.I1.i2.p1.7"><math alttext="{\bm{U}}\in\mathbb{R}^{\rho\times m}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">𝑼</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.3.2" xref="S4.I1.i2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.I1.i2.p1.1.m1.1.1.3.3" xref="S4.I1.i2.p1.1.m1.1.1.3.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.3.3.2" xref="S4.I1.i2.p1.1.m1.1.1.3.3.2.cmml">ρ</mi><mo id="S4.I1.i2.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.I1.i2.p1.1.m1.1.1.3.3.3" xref="S4.I1.i2.p1.1.m1.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><in id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1"></in><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝑼</ci><apply id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S4.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3"><times id="S4.I1.i2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3.1"></times><ci id="S4.I1.i2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3.2">𝜌</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">{\bm{U}}\in\mathbb{R}^{\rho\times m}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">bold_italic_U ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ × italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="{\bm{d}}\in\mathbb{R}^{m}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><mrow id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml">𝒅</mi><mo id="S4.I1.i2.p1.2.m2.1.1.1" xref="S4.I1.i2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.3.2" xref="S4.I1.i2.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.I1.i2.p1.2.m2.1.1.3.3" xref="S4.I1.i2.p1.2.m2.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><in id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.1"></in><ci id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2">𝒅</ci><apply id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.2">ℝ</ci><ci id="S4.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">{\bm{d}}\in\mathbb{R}^{m}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">bold_italic_d ∈ blackboard_R start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="{\bm{e}}\in\mathbb{R}^{\rho}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><mrow id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">𝒆</mi><mo id="S4.I1.i2.p1.3.m3.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3.3" xref="S4.I1.i2.p1.3.m3.1.1.3.3.cmml">ρ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><in id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1"></in><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">𝒆</ci><apply id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2">ℝ</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3">𝜌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">{\bm{e}}\in\mathbb{R}^{\rho}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">bold_italic_e ∈ blackboard_R start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT</annotation></semantics></math>, that form the decomposition <math alttext="{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}+\operatorname{diag}%
({\bm{d}})" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.4"><semantics id="S4.I1.i2.p1.4.m4.4a"><mrow id="S4.I1.i2.p1.4.m4.4.5" xref="S4.I1.i2.p1.4.m4.4.5.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.2" xref="S4.I1.i2.p1.4.m4.4.5.2.cmml">𝑹</mi><mo id="S4.I1.i2.p1.4.m4.4.5.1" xref="S4.I1.i2.p1.4.m4.4.5.1.cmml">=</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.3" xref="S4.I1.i2.p1.4.m4.4.5.3.cmml"><mrow id="S4.I1.i2.p1.4.m4.4.5.3.2" xref="S4.I1.i2.p1.4.m4.4.5.3.2.cmml"><msup id="S4.I1.i2.p1.4.m4.4.5.3.2.2" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2.cmml"><mi id="S4.I1.i2.p1.4.m4.4.5.3.2.2.2" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2.2.cmml">𝑼</mi><mi id="S4.I1.i2.p1.4.m4.4.5.3.2.2.3" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2.3.cmml">T</mi></msup><mo id="S4.I1.i2.p1.4.m4.4.5.3.2.1" lspace="0.167em" xref="S4.I1.i2.p1.4.m4.4.5.3.2.1.cmml">⁢</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.3.2.3.2" xref="S4.I1.i2.p1.4.m4.4.5.3.2.3.1.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml">diag</mi><mo id="S4.I1.i2.p1.4.m4.4.5.3.2.3.2a" xref="S4.I1.i2.p1.4.m4.4.5.3.2.3.1.cmml">⁡</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.3.2.3.2.1" xref="S4.I1.i2.p1.4.m4.4.5.3.2.3.1.cmml"><mo id="S4.I1.i2.p1.4.m4.4.5.3.2.3.2.1.1" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.5.3.2.3.1.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.2.2" xref="S4.I1.i2.p1.4.m4.2.2.cmml">𝒆</mi><mo id="S4.I1.i2.p1.4.m4.4.5.3.2.3.2.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.5.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.I1.i2.p1.4.m4.4.5.3.2.1a" xref="S4.I1.i2.p1.4.m4.4.5.3.2.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.4.m4.4.5.3.2.4" xref="S4.I1.i2.p1.4.m4.4.5.3.2.4.cmml">𝑼</mi></mrow><mo id="S4.I1.i2.p1.4.m4.4.5.3.1" xref="S4.I1.i2.p1.4.m4.4.5.3.1.cmml">+</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.3.3.2" xref="S4.I1.i2.p1.4.m4.4.5.3.3.1.cmml"><mi id="S4.I1.i2.p1.4.m4.3.3" xref="S4.I1.i2.p1.4.m4.3.3.cmml">diag</mi><mo id="S4.I1.i2.p1.4.m4.4.5.3.3.2a" xref="S4.I1.i2.p1.4.m4.4.5.3.3.1.cmml">⁡</mo><mrow id="S4.I1.i2.p1.4.m4.4.5.3.3.2.1" xref="S4.I1.i2.p1.4.m4.4.5.3.3.1.cmml"><mo id="S4.I1.i2.p1.4.m4.4.5.3.3.2.1.1" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.5.3.3.1.cmml">(</mo><mi id="S4.I1.i2.p1.4.m4.4.4" xref="S4.I1.i2.p1.4.m4.4.4.cmml">𝒅</mi><mo id="S4.I1.i2.p1.4.m4.4.5.3.3.2.1.2" stretchy="false" xref="S4.I1.i2.p1.4.m4.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.4b"><apply id="S4.I1.i2.p1.4.m4.4.5.cmml" xref="S4.I1.i2.p1.4.m4.4.5"><eq id="S4.I1.i2.p1.4.m4.4.5.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.1"></eq><ci id="S4.I1.i2.p1.4.m4.4.5.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.2">𝑹</ci><apply id="S4.I1.i2.p1.4.m4.4.5.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3"><plus id="S4.I1.i2.p1.4.m4.4.5.3.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.1"></plus><apply id="S4.I1.i2.p1.4.m4.4.5.3.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2"><times id="S4.I1.i2.p1.4.m4.4.5.3.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.1"></times><apply id="S4.I1.i2.p1.4.m4.4.5.3.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.4.5.3.2.2.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2">superscript</csymbol><ci id="S4.I1.i2.p1.4.m4.4.5.3.2.2.2.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2.2">𝑼</ci><ci id="S4.I1.i2.p1.4.m4.4.5.3.2.2.3.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.2.3">𝑇</ci></apply><apply id="S4.I1.i2.p1.4.m4.4.5.3.2.3.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.3.2"><ci id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1">diag</ci><ci id="S4.I1.i2.p1.4.m4.2.2.cmml" xref="S4.I1.i2.p1.4.m4.2.2">𝒆</ci></apply><ci id="S4.I1.i2.p1.4.m4.4.5.3.2.4.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.2.4">𝑼</ci></apply><apply id="S4.I1.i2.p1.4.m4.4.5.3.3.1.cmml" xref="S4.I1.i2.p1.4.m4.4.5.3.3.2"><ci id="S4.I1.i2.p1.4.m4.3.3.cmml" xref="S4.I1.i2.p1.4.m4.3.3">diag</ci><ci id="S4.I1.i2.p1.4.m4.4.4.cmml" xref="S4.I1.i2.p1.4.m4.4.4">𝒅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.4c">{\bm{R}}={\bm{U}}^{T}\operatorname{diag}({\bm{e}}){\bm{U}}+\operatorname{diag}%
({\bm{d}})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.4d">bold_italic_R = bold_italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_diag ( bold_italic_e ) bold_italic_U + roman_diag ( bold_italic_d )</annotation></semantics></math>, with <math alttext="{\bm{U}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><mi id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml">𝑼</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><ci id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">𝑼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">{\bm{U}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">bold_italic_U</annotation></semantics></math> partitioned into <math alttext="{\bm{U}}_{\mathcal{C}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.6.m6.1"><semantics id="S4.I1.i2.p1.6.m6.1a"><msub id="S4.I1.i2.p1.6.m6.1.1" xref="S4.I1.i2.p1.6.m6.1.1.cmml"><mi id="S4.I1.i2.p1.6.m6.1.1.2" xref="S4.I1.i2.p1.6.m6.1.1.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.6.m6.1.1.3" xref="S4.I1.i2.p1.6.m6.1.1.3.cmml">𝒞</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.6.m6.1b"><apply id="S4.I1.i2.p1.6.m6.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.6.m6.1.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.6.m6.1.1.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.2">𝑼</ci><ci id="S4.I1.i2.p1.6.m6.1.1.3.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.6.m6.1c">{\bm{U}}_{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.6.m6.1d">bold_italic_U start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="{\bm{U}}_{\mathcal{I}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.7.m7.1"><semantics id="S4.I1.i2.p1.7.m7.1a"><msub id="S4.I1.i2.p1.7.m7.1.1" xref="S4.I1.i2.p1.7.m7.1.1.cmml"><mi id="S4.I1.i2.p1.7.m7.1.1.2" xref="S4.I1.i2.p1.7.m7.1.1.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.7.m7.1.1.3" xref="S4.I1.i2.p1.7.m7.1.1.3.cmml">ℐ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.7.m7.1b"><apply id="S4.I1.i2.p1.7.m7.1.1.cmml" xref="S4.I1.i2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.7.m7.1.1.1.cmml" xref="S4.I1.i2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.7.m7.1.1.2.cmml" xref="S4.I1.i2.p1.7.m7.1.1.2">𝑼</ci><ci id="S4.I1.i2.p1.7.m7.1.1.3.cmml" xref="S4.I1.i2.p1.7.m7.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.7.m7.1c">{\bm{U}}_{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.7.m7.1d">bold_italic_U start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></span>
</span>
<span class="ltx_p" id="S4.SS2.SSS2.p1.7.1.1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p1.7.1.1.p1.1.1">Output</span>: The pairwise interactions <math alttext="\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4"><semantics id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4a"><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.cmml"><msubsup id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.cmml"><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.cmml"><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.1" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.3.cmml">m</mi></msubsup><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.cmml"><msubsup id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.cmml"><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.2" lspace="0.167em" rspace="0em" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.cmml"><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.2.cmml">j</mi><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.1" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.3.cmml">m</mi></msubsup><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.cmml"><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.3.cmml"><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.3" stretchy="false" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.3.cmml">⟨</mo><msub id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.4" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.3.cmml">,</mo><msub id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.5" stretchy="false" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.3.cmml">⟩</mo></mrow><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.3" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.3.cmml">⁢</mo><msub id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.cmml"><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.2.cmml">R</mi><mrow id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.4" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.1.1.1.1" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.4.1" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.2" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4b"><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4"><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3">superscript</csymbol><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3">subscript</csymbol><sum id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.2"></sum><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3"><eq id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.1"></eq><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.2">𝑖</ci><cn id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.3.3">𝑚</ci></apply><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2"><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3">superscript</csymbol><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3">subscript</csymbol><sum id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.2"></sum><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3"><eq id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.1"></eq><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.2">𝑗</ci><cn id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.3.cmml" type="integer" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.3.3">𝑚</ci></apply><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2"><times id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.3"></times><list id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2"><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.2">𝒗</ci><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.2">𝒗</ci><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4">subscript</csymbol><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4.4.2.2.4.2">𝑅</ci><list id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.3.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.4"><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.2.cmml" xref="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4c">\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}\rangle{R}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.7.1.1.p1.1.m1.4d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ italic_R start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.p1.7.1.1.p1.1.2">Steps</span>:</span>
<span class="ltx_enumerate" id="S4.I2">
<span class="ltx_item" id="S4.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">(1)</span>
<span class="ltx_para" id="S4.I2.i1.p1">
<span class="ltx_p" id="S4.I2.i1.p1.1">Once per context, compute:</span>
<span class="ltx_enumerate" id="S4.I2.i1.I1">
<span class="ltx_item" id="S4.I2.i1.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">(a)</span>
<span class="ltx_para" id="S4.I2.i1.I1.i1.p1">
<span class="ltx_p" id="S4.I2.i1.I1.i1.p1.1">Compute <math alttext="{\bm{P}}_{\mathcal{C}}={\bm{V}}_{\mathcal{C}}{\bm{U}}_{\mathcal{C}}" class="ltx_Math" display="inline" id="S4.I2.i1.I1.i1.p1.1.m1.1"><semantics id="S4.I2.i1.I1.i1.p1.1.m1.1a"><mrow id="S4.I2.i1.I1.i1.p1.1.m1.1.1" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.cmml"><msub id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.cmml"><mi id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.2" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.2.cmml">𝑷</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.3" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.3.cmml">𝒞</mi></msub><mo id="S4.I2.i1.I1.i1.p1.1.m1.1.1.1" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.cmml"><msub id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.cmml"><mi id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.2" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.3" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.3.cmml">𝒞</mi></msub><mo id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.1" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.cmml"><mi id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.2" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.3" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.3.cmml">𝒞</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i1.I1.i1.p1.1.m1.1b"><apply id="S4.I2.i1.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1"><eq id="S4.I2.i1.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.1"></eq><apply id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.2.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.2">𝑷</ci><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.3.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.2.3">𝒞</ci></apply><apply id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3"><times id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.1"></times><apply id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.2.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.2">𝑽</ci><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.3.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.2.3">𝒞</ci></apply><apply id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.1.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.2.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.2">𝑼</ci><ci id="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.3.cmml" xref="S4.I2.i1.I1.i1.p1.1.m1.1.1.3.3.3">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.I1.i1.p1.1.m1.1c">{\bm{P}}_{\mathcal{C}}={\bm{V}}_{\mathcal{C}}{\bm{U}}_{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.I1.i1.p1.1.m1.1d">bold_italic_P start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT = bold_italic_V start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT bold_italic_U start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></span>
<span class="ltx_item" id="S4.I2.i1.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">(b)</span>
<span class="ltx_para" id="S4.I2.i1.I1.i2.p1">
<span class="ltx_p" id="S4.I2.i1.I1.i2.p1.1">Compute <math alttext="s_{\mathcal{C}}=\sum_{i\in\mathcal{C}}{d}_{i}\|{\bm{v}}_{i}\|^{2}" class="ltx_Math" display="inline" id="S4.I2.i1.I1.i2.p1.1.m1.1"><semantics id="S4.I2.i1.I1.i2.p1.1.m1.1a"><mrow id="S4.I2.i1.I1.i2.p1.1.m1.1.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.cmml"><msub id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.3.cmml">𝒞</mi></msub><mo id="S4.I2.i1.I1.i2.p1.1.m1.1.1.2" rspace="0.111em" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.cmml"><msub id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.cmml"><mo id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.cmml"><mi id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.2.cmml">i</mi><mo id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.3.cmml">𝒞</mi></mrow></msub><mrow id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.cmml"><msub id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.cmml"><mi id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.2.cmml">d</mi><mi id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.2.cmml">⁢</mo><msup id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.cmml"><mrow id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.3" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i1.I1.i2.p1.1.m1.1b"><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1"><eq id="S4.I2.i1.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.2"></eq><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.3.3">𝒞</ci></apply><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1"><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2">subscript</csymbol><sum id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.2"></sum><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3"><in id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.1"></in><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.2">𝑖</ci><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.2.3.3">𝒞</ci></apply></apply><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1"><times id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.2"></times><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.2">𝑑</ci><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I2.i1.I1.i2.p1.1.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.I1.i2.p1.1.m1.1c">s_{\mathcal{C}}=\sum_{i\in\mathcal{C}}{d}_{i}\|{\bm{v}}_{i}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.I1.i2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_C end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></span>
</span></span>
</span>
</span></span>
<span class="ltx_item" id="S4.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">(2)</span>
<span class="ltx_para" id="S4.I2.i2.p1">
<span class="ltx_p" id="S4.I2.i2.p1.1">Compute <math alttext="{\bm{P}}={\bm{P}}_{c}+{\bm{U}}_{\mathcal{I}}{\bm{V}}_{\mathcal{I}}" class="ltx_Math" display="inline" id="S4.I2.i2.p1.1.m1.1"><semantics id="S4.I2.i2.p1.1.m1.1a"><mrow id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">𝑷</mi><mo id="S4.I2.i2.p1.1.m1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3.cmml"><msub id="S4.I2.i2.p1.1.m1.1.1.3.2" xref="S4.I2.i2.p1.1.m1.1.1.3.2.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.3.2.2" xref="S4.I2.i2.p1.1.m1.1.1.3.2.2.cmml">𝑷</mi><mi id="S4.I2.i2.p1.1.m1.1.1.3.2.3" xref="S4.I2.i2.p1.1.m1.1.1.3.2.3.cmml">c</mi></msub><mo id="S4.I2.i2.p1.1.m1.1.1.3.1" xref="S4.I2.i2.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.I2.i2.p1.1.m1.1.1.3.3" xref="S4.I2.i2.p1.1.m1.1.1.3.3.cmml"><msub id="S4.I2.i2.p1.1.m1.1.1.3.3.2" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.3.3.2.2" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2.2.cmml">𝑼</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i2.p1.1.m1.1.1.3.3.2.3" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2.3.cmml">ℐ</mi></msub><mo id="S4.I2.i2.p1.1.m1.1.1.3.3.1" xref="S4.I2.i2.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S4.I2.i2.p1.1.m1.1.1.3.3.3" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.3.3.3.2" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3.2.cmml">𝑽</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i2.p1.1.m1.1.1.3.3.3.3" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3.3.cmml">ℐ</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><apply id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1"><eq id="S4.I2.i2.p1.1.m1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1"></eq><ci id="S4.I2.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.2">𝑷</ci><apply id="S4.I2.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3"><plus id="S4.I2.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.1"></plus><apply id="S4.I2.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.3.2.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.2">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.3.2.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.2.2">𝑷</ci><ci id="S4.I2.i2.p1.1.m1.1.1.3.2.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.2.3">𝑐</ci></apply><apply id="S4.I2.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3"><times id="S4.I2.i2.p1.1.m1.1.1.3.3.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.1"></times><apply id="S4.I2.i2.p1.1.m1.1.1.3.3.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.3.3.2.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.3.3.2.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2.2">𝑼</ci><ci id="S4.I2.i2.p1.1.m1.1.1.3.3.2.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.2.3">ℐ</ci></apply><apply id="S4.I2.i2.p1.1.m1.1.1.3.3.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.I2.i2.p1.1.m1.1.1.3.3.3.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S4.I2.i2.p1.1.m1.1.1.3.3.3.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3.2">𝑽</ci><ci id="S4.I2.i2.p1.1.m1.1.1.3.3.3.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3.3.3.3">ℐ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">{\bm{P}}={\bm{P}}_{c}+{\bm{U}}_{\mathcal{I}}{\bm{V}}_{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i2.p1.1.m1.1d">bold_italic_P = bold_italic_P start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT + bold_italic_U start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT bold_italic_V start_POSTSUBSCRIPT caligraphic_I end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></span>
<span class="ltx_item" id="S4.I2.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">(3)</span>
<span class="ltx_para" id="S4.I2.i3.p1">
<span class="ltx_p" id="S4.I2.i3.p1.1">Return <math alttext="s_{\mathcal{C}}+\sum_{i\in\mathcal{I}}{d}_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{%
\rho}{e}_{i}\|{\bm{P}}_{i,:}\|^{2}" class="ltx_Math" display="inline" id="S4.I2.i3.p1.1.m1.4"><semantics id="S4.I2.i3.p1.1.m1.4a"><mrow id="S4.I2.i3.p1.1.m1.4.4" xref="S4.I2.i3.p1.1.m1.4.4.cmml"><msub id="S4.I2.i3.p1.1.m1.4.4.4" xref="S4.I2.i3.p1.1.m1.4.4.4.cmml"><mi id="S4.I2.i3.p1.1.m1.4.4.4.2" xref="S4.I2.i3.p1.1.m1.4.4.4.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.I2.i3.p1.1.m1.4.4.4.3" xref="S4.I2.i3.p1.1.m1.4.4.4.3.cmml">𝒞</mi></msub><mo id="S4.I2.i3.p1.1.m1.4.4.3" rspace="0.055em" xref="S4.I2.i3.p1.1.m1.4.4.3.cmml">+</mo><mrow id="S4.I2.i3.p1.1.m1.3.3.1" xref="S4.I2.i3.p1.1.m1.3.3.1.cmml"><msub id="S4.I2.i3.p1.1.m1.3.3.1.2" xref="S4.I2.i3.p1.1.m1.3.3.1.2.cmml"><mo id="S4.I2.i3.p1.1.m1.3.3.1.2.2" xref="S4.I2.i3.p1.1.m1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.I2.i3.p1.1.m1.3.3.1.2.3" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.cmml"><mi id="S4.I2.i3.p1.1.m1.3.3.1.2.3.2" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.2.cmml">i</mi><mo id="S4.I2.i3.p1.1.m1.3.3.1.2.3.1" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.I2.i3.p1.1.m1.3.3.1.2.3.3" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.3.cmml">ℐ</mi></mrow></msub><mrow id="S4.I2.i3.p1.1.m1.3.3.1.1" xref="S4.I2.i3.p1.1.m1.3.3.1.1.cmml"><msub id="S4.I2.i3.p1.1.m1.3.3.1.1.3" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3.cmml"><mi id="S4.I2.i3.p1.1.m1.3.3.1.1.3.2" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3.2.cmml">d</mi><mi id="S4.I2.i3.p1.1.m1.3.3.1.1.3.3" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3.3.cmml">i</mi></msub><mo id="S4.I2.i3.p1.1.m1.3.3.1.1.2" xref="S4.I2.i3.p1.1.m1.3.3.1.1.2.cmml">⁢</mo><msup id="S4.I2.i3.p1.1.m1.3.3.1.1.1" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.cmml"><mrow id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.2.cmml"><mo id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.3" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.I2.i3.p1.1.m1.3.3.1.1.1.3" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S4.I2.i3.p1.1.m1.4.4.3a" rspace="0.055em" xref="S4.I2.i3.p1.1.m1.4.4.3.cmml">+</mo><mrow id="S4.I2.i3.p1.1.m1.4.4.2" xref="S4.I2.i3.p1.1.m1.4.4.2.cmml"><msubsup id="S4.I2.i3.p1.1.m1.4.4.2.2" xref="S4.I2.i3.p1.1.m1.4.4.2.2.cmml"><mo id="S4.I2.i3.p1.1.m1.4.4.2.2.2.2" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.2.cmml">∑</mo><mrow id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.cmml"><mi id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.2" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.2.cmml">i</mi><mo id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.1" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.1.cmml">=</mo><mn id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.3" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.I2.i3.p1.1.m1.4.4.2.2.3" xref="S4.I2.i3.p1.1.m1.4.4.2.2.3.cmml">ρ</mi></msubsup><mrow id="S4.I2.i3.p1.1.m1.4.4.2.1" xref="S4.I2.i3.p1.1.m1.4.4.2.1.cmml"><msub id="S4.I2.i3.p1.1.m1.4.4.2.1.3" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3.cmml"><mi id="S4.I2.i3.p1.1.m1.4.4.2.1.3.2" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3.2.cmml">e</mi><mi id="S4.I2.i3.p1.1.m1.4.4.2.1.3.3" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3.3.cmml">i</mi></msub><mo id="S4.I2.i3.p1.1.m1.4.4.2.1.2" xref="S4.I2.i3.p1.1.m1.4.4.2.1.2.cmml">⁢</mo><msup id="S4.I2.i3.p1.1.m1.4.4.2.1.1" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.cmml"><mrow id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.2.cmml"><mo id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.2" stretchy="false" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.2.1.cmml">‖</mo><msub id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.cmml"><mi id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.2" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.2.cmml">𝑷</mi><mrow id="S4.I2.i3.p1.1.m1.2.2.2.4" xref="S4.I2.i3.p1.1.m1.2.2.2.3.cmml"><mi id="S4.I2.i3.p1.1.m1.1.1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.I2.i3.p1.1.m1.2.2.2.4.1" xref="S4.I2.i3.p1.1.m1.2.2.2.3.cmml">,</mo><mo id="S4.I2.i3.p1.1.m1.2.2.2.2" xref="S4.I2.i3.p1.1.m1.2.2.2.2.cmml">:</mo></mrow></msub><mo id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.3" stretchy="false" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.I2.i3.p1.1.m1.4.4.2.1.1.3" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i3.p1.1.m1.4b"><apply id="S4.I2.i3.p1.1.m1.4.4.cmml" xref="S4.I2.i3.p1.1.m1.4.4"><plus id="S4.I2.i3.p1.1.m1.4.4.3.cmml" xref="S4.I2.i3.p1.1.m1.4.4.3"></plus><apply id="S4.I2.i3.p1.1.m1.4.4.4.cmml" xref="S4.I2.i3.p1.1.m1.4.4.4"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.4.4.4.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.4">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.4.4.4.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.4.2">𝑠</ci><ci id="S4.I2.i3.p1.1.m1.4.4.4.3.cmml" xref="S4.I2.i3.p1.1.m1.4.4.4.3">𝒞</ci></apply><apply id="S4.I2.i3.p1.1.m1.3.3.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1"><apply id="S4.I2.i3.p1.1.m1.3.3.1.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.3.3.1.2.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2">subscript</csymbol><sum id="S4.I2.i3.p1.1.m1.3.3.1.2.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2.2"></sum><apply id="S4.I2.i3.p1.1.m1.3.3.1.2.3.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3"><in id="S4.I2.i3.p1.1.m1.3.3.1.2.3.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.1"></in><ci id="S4.I2.i3.p1.1.m1.3.3.1.2.3.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.2">𝑖</ci><ci id="S4.I2.i3.p1.1.m1.3.3.1.2.3.3.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.2.3.3">ℐ</ci></apply></apply><apply id="S4.I2.i3.p1.1.m1.3.3.1.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1"><times id="S4.I2.i3.p1.1.m1.3.3.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.2"></times><apply id="S4.I2.i3.p1.1.m1.3.3.1.1.3.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.3.3.1.1.3.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.3.3.1.1.3.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3.2">𝑑</ci><ci id="S4.I2.i3.p1.1.m1.3.3.1.1.3.3.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.3.3">𝑖</ci></apply><apply id="S4.I2.i3.p1.1.m1.3.3.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1">superscript</csymbol><apply id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.2">norm</csymbol><apply id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.2">𝒗</ci><ci id="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn id="S4.I2.i3.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.3.3.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.I2.i3.p1.1.m1.4.4.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2"><apply id="S4.I2.i3.p1.1.m1.4.4.2.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.4.4.2.2.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2">superscript</csymbol><apply id="S4.I2.i3.p1.1.m1.4.4.2.2.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.4.4.2.2.2.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2">subscript</csymbol><sum id="S4.I2.i3.p1.1.m1.4.4.2.2.2.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.2"></sum><apply id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3"><eq id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.1"></eq><ci id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.2">𝑖</ci><cn id="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.3.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.4.4.2.2.2.3.3">1</cn></apply></apply><ci id="S4.I2.i3.p1.1.m1.4.4.2.2.3.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.2.3">𝜌</ci></apply><apply id="S4.I2.i3.p1.1.m1.4.4.2.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1"><times id="S4.I2.i3.p1.1.m1.4.4.2.1.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.2"></times><apply id="S4.I2.i3.p1.1.m1.4.4.2.1.3.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.4.4.2.1.3.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.4.4.2.1.3.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3.2">𝑒</ci><ci id="S4.I2.i3.p1.1.m1.4.4.2.1.3.3.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.3.3">𝑖</ci></apply><apply id="S4.I2.i3.p1.1.m1.4.4.2.1.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.4.4.2.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1">superscript</csymbol><apply id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1"><csymbol cd="latexml" id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.2.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.2">norm</csymbol><apply id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1">subscript</csymbol><ci id="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.1.1.1.2">𝑷</ci><list id="S4.I2.i3.p1.1.m1.2.2.2.3.cmml" xref="S4.I2.i3.p1.1.m1.2.2.2.4"><ci id="S4.I2.i3.p1.1.m1.1.1.1.1.cmml" xref="S4.I2.i3.p1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.I2.i3.p1.1.m1.2.2.2.2.cmml" xref="S4.I2.i3.p1.1.m1.2.2.2.2">:</ci></list></apply></apply><cn id="S4.I2.i3.p1.1.m1.4.4.2.1.1.3.cmml" type="integer" xref="S4.I2.i3.p1.1.m1.4.4.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i3.p1.1.m1.4c">s_{\mathcal{C}}+\sum_{i\in\mathcal{I}}{d}_{i}\|{\bm{v}}_{i}\|^{2}+\sum_{i=1}^{%
\rho}{e}_{i}\|{\bm{P}}_{i,:}\|^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i3.p1.1.m1.4d">italic_s start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT italic_i ∈ caligraphic_I end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_ρ end_POSTSUPERSCRIPT italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ bold_italic_P start_POSTSUBSCRIPT italic_i , : end_POSTSUBSCRIPT ∥ start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></span>
</span></span>
</span>
</span></span>
</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.4.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S4.T1.5.2" style="font-size:90%;">Results for public data-sets. A lower LogLoss or MSE, and a higher AUC are better. The pruned sparsity column shows the percentage of entries in the pruned model equivalent to a DPLR model of the given rank, in terms of the number of parameters. The FM/FwFM columns show results without pruning or rank reduction, for reference, and are replicated across ranks. The next columns show results with pruning and rank reduction. Finally, the last column shows the improvement percentage of the DPLR over the equivalently pruned model.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.2.2">
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_tt" id="S4.T1.2.2.3" rowspan="2"><span class="ltx_text" id="S4.T1.2.2.3.1" style="font-size:80%;">Dataset (Metric)</span></td>
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_tt" id="S4.T1.2.2.4" rowspan="2"><span class="ltx_text" id="S4.T1.2.2.4.1" style="font-size:80%;">Rank</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T1.2.2.5" rowspan="2"><span class="ltx_text" id="S4.T1.2.2.5.1" style="font-size:80%;">
<span class="ltx_inline-block ltx_align_left" id="S4.T1.2.2.5.1.1">
<span class="ltx_p" id="S4.T1.2.2.5.1.1.1">Pruned</span>
<span class="ltx_p" id="S4.T1.2.2.5.1.1.2">sparsity</span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S4.T1.1.1.1"><math alttext="k=8" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.m1.1.1.2" mathsize="80%" xref="S4.T1.1.1.1.m1.1.1.2.cmml">k</mi><mo id="S4.T1.1.1.1.m1.1.1.1" mathsize="80%" xref="S4.T1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T1.1.1.1.m1.1.1.3" mathsize="80%" xref="S4.T1.1.1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><eq id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1.1"></eq><ci id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">𝑘</ci><cn id="S4.T1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.1.1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">k=8</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">italic_k = 8</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="5" id="S4.T1.2.2.2"><math alttext="k=16" class="ltx_Math" display="inline" id="S4.T1.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.m1.1.1" xref="S4.T1.2.2.2.m1.1.1.cmml"><mi id="S4.T1.2.2.2.m1.1.1.2" mathsize="80%" xref="S4.T1.2.2.2.m1.1.1.2.cmml">k</mi><mo id="S4.T1.2.2.2.m1.1.1.1" mathsize="80%" xref="S4.T1.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T1.2.2.2.m1.1.1.3" mathsize="80%" xref="S4.T1.2.2.2.m1.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1"><eq id="S4.T1.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.m1.1.1.1"></eq><ci id="S4.T1.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.m1.1.1.2">𝑘</ci><cn id="S4.T1.2.2.2.m1.1.1.3.cmml" type="integer" xref="S4.T1.2.2.2.m1.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.m1.1c">k=16</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.m1.1d">italic_k = 16</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.3.1">
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.1"><span class="ltx_text" id="S4.T1.2.3.1.1.1" style="font-size:80%;">FM</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.2"><span class="ltx_text" id="S4.T1.2.3.1.2.1" style="font-size:80%;">FwFM</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.3"><span class="ltx_text" id="S4.T1.2.3.1.3.1" style="font-size:80%;">DPLR</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.4"><span class="ltx_text" id="S4.T1.2.3.1.4.1" style="font-size:80%;">Pruned</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.2.3.1.5">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.3.1.5.1">
<span class="ltx_p" id="S4.T1.2.3.1.5.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.3.1.5.1.1.1" style="font-size:80%;">DPLR vs</span></span>
<span class="ltx_p" id="S4.T1.2.3.1.5.1.2"><span class="ltx_text" id="S4.T1.2.3.1.5.1.2.1" style="font-size:80%;">Pruned (%)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.6"><span class="ltx_text" id="S4.T1.2.3.1.6.1" style="font-size:80%;">FM</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.7"><span class="ltx_text" id="S4.T1.2.3.1.7.1" style="font-size:80%;">FwFM</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.8"><span class="ltx_text" id="S4.T1.2.3.1.8.1" style="font-size:80%;">DPLR</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.3.1.9"><span class="ltx_text" id="S4.T1.2.3.1.9.1" style="font-size:80%;">Pruned</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.2.3.1.10">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.3.1.10.1">
<span class="ltx_p" id="S4.T1.2.3.1.10.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.3.1.10.1.1.1" style="font-size:80%;">DPLR vs</span></span>
<span class="ltx_p" id="S4.T1.2.3.1.10.1.2"><span class="ltx_text" id="S4.T1.2.3.1.10.1.2.1" style="font-size:80%;">Pruned (%)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.4.2">
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_t" id="S4.T1.2.4.2.1" rowspan="5"><span class="ltx_text" id="S4.T1.2.4.2.1.1" style="font-size:80%;">Criteo (AUC)</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.2.4.2.2"><span class="ltx_text" id="S4.T1.2.4.2.2.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.4.2.3"><span class="ltx_text" id="S4.T1.2.4.2.3.1" style="font-size:80%;">5.4%</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.4"><span class="ltx_text" id="S4.T1.2.4.2.4.1" style="font-size:80%;">0.8044</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.5"><span class="ltx_text" id="S4.T1.2.4.2.5.1" style="font-size:80%;">0.8088</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.6"><span class="ltx_text" id="S4.T1.2.4.2.6.1" style="font-size:80%;">0.8050</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.7"><span class="ltx_text" id="S4.T1.2.4.2.7.1" style="font-size:80%;">0.8008</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.2.4.2.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.4.2.8.1">
<span class="ltx_p" id="S4.T1.2.4.2.8.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.4.2.8.1.1.1" style="font-size:80%;">0.52%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.9"><span class="ltx_text" id="S4.T1.2.4.2.9.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.10"><span class="ltx_text" id="S4.T1.2.4.2.10.1" style="font-size:80%;">0.8100</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.11"><span class="ltx_text" id="S4.T1.2.4.2.11.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.4.2.12"><span class="ltx_text" id="S4.T1.2.4.2.12.1" style="font-size:80%;">0.8020</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.2.4.2.13">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.4.2.13.1">
<span class="ltx_p" id="S4.T1.2.4.2.13.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.4.2.13.1.1.1" style="font-size:80%;">0.61%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.5.3">
<td class="ltx_td ltx_align_left" id="S4.T1.2.5.3.1"><span class="ltx_text" id="S4.T1.2.5.3.1.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.5.3.2"><span class="ltx_text" id="S4.T1.2.5.3.2.1" style="font-size:80%;">10.8%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.3"><span class="ltx_text" id="S4.T1.2.5.3.3.1" style="font-size:80%;">0.8044</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.4"><span class="ltx_text" id="S4.T1.2.5.3.4.1" style="font-size:80%;">0.8088</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.5"><span class="ltx_text" id="S4.T1.2.5.3.5.1" style="font-size:80%;">0.8066</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.6"><span class="ltx_text" id="S4.T1.2.5.3.6.1" style="font-size:80%;">0.8049</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.5.3.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.5.3.7.1">
<span class="ltx_p" id="S4.T1.2.5.3.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.5.3.7.1.1.1" style="font-size:80%;">0.21%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.8"><span class="ltx_text" id="S4.T1.2.5.3.8.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.9"><span class="ltx_text" id="S4.T1.2.5.3.9.1" style="font-size:80%;">0.8100</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.10"><span class="ltx_text" id="S4.T1.2.5.3.10.1" style="font-size:80%;">0.8080</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.5.3.11"><span class="ltx_text" id="S4.T1.2.5.3.11.1" style="font-size:80%;">0.8057</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.5.3.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.5.3.12.1">
<span class="ltx_p" id="S4.T1.2.5.3.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.5.3.12.1.1.1" style="font-size:80%;">0.29%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.6.4">
<td class="ltx_td ltx_align_left" id="S4.T1.2.6.4.1"><span class="ltx_text" id="S4.T1.2.6.4.1.1" style="font-size:80%;">3</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.6.4.2"><span class="ltx_text" id="S4.T1.2.6.4.2.1" style="font-size:80%;">16.2%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.3"><span class="ltx_text" id="S4.T1.2.6.4.3.1" style="font-size:80%;">0.8044</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.4"><span class="ltx_text" id="S4.T1.2.6.4.4.1" style="font-size:80%;">0.8088</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.5"><span class="ltx_text" id="S4.T1.2.6.4.5.1" style="font-size:80%;">0.8067</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.6"><span class="ltx_text" id="S4.T1.2.6.4.6.1" style="font-size:80%;">0.8065</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.6.4.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.6.4.7.1">
<span class="ltx_p" id="S4.T1.2.6.4.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.6.4.7.1.1.1" style="font-size:80%;">0.02%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.8"><span class="ltx_text" id="S4.T1.2.6.4.8.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.9"><span class="ltx_text" id="S4.T1.2.6.4.9.1" style="font-size:80%;">0.8100</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.10"><span class="ltx_text" id="S4.T1.2.6.4.10.1" style="font-size:80%;">0.8083</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.6.4.11"><span class="ltx_text" id="S4.T1.2.6.4.11.1" style="font-size:80%;">0.8076</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.6.4.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.6.4.12.1">
<span class="ltx_p" id="S4.T1.2.6.4.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.6.4.12.1.1.1" style="font-size:80%;">0.09%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.7.5">
<td class="ltx_td ltx_align_left" id="S4.T1.2.7.5.1"><span class="ltx_text" id="S4.T1.2.7.5.1.1" style="font-size:80%;">4</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.7.5.2"><span class="ltx_text" id="S4.T1.2.7.5.2.1" style="font-size:80%;">21.6%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.3"><span class="ltx_text" id="S4.T1.2.7.5.3.1" style="font-size:80%;">0.8044</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.4"><span class="ltx_text" id="S4.T1.2.7.5.4.1" style="font-size:80%;">0.8088</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.5"><span class="ltx_text" id="S4.T1.2.7.5.5.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.6"><span class="ltx_text" id="S4.T1.2.7.5.6.1" style="font-size:80%;">0.8074</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.7.5.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.7.5.7.1">
<span class="ltx_p" id="S4.T1.2.7.5.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.7.5.7.1.1.1" style="font-size:80%;">-0.05%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.8"><span class="ltx_text" id="S4.T1.2.7.5.8.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.9"><span class="ltx_text" id="S4.T1.2.7.5.9.1" style="font-size:80%;">0.8100</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.10"><span class="ltx_text" id="S4.T1.2.7.5.10.1" style="font-size:80%;">0.8085</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.7.5.11"><span class="ltx_text" id="S4.T1.2.7.5.11.1" style="font-size:80%;">0.8086</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.7.5.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.7.5.12.1">
<span class="ltx_p" id="S4.T1.2.7.5.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.7.5.12.1.1.1" style="font-size:80%;">-0.01%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.8.6">
<td class="ltx_td ltx_align_left" id="S4.T1.2.8.6.1"><span class="ltx_text" id="S4.T1.2.8.6.1.1" style="font-size:80%;">5</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.8.6.2"><span class="ltx_text" id="S4.T1.2.8.6.2.1" style="font-size:80%;">27%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.3"><span class="ltx_text" id="S4.T1.2.8.6.3.1" style="font-size:80%;">0.8044</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.4"><span class="ltx_text" id="S4.T1.2.8.6.4.1" style="font-size:80%;">0.8088</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.5"><span class="ltx_text" id="S4.T1.2.8.6.5.1" style="font-size:80%;">0.8070</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.6"><span class="ltx_text" id="S4.T1.2.8.6.6.1" style="font-size:80%;">0.8078</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.8.6.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.8.6.7.1">
<span class="ltx_p" id="S4.T1.2.8.6.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.8.6.7.1.1.1" style="font-size:80%;">-0.10%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.8"><span class="ltx_text" id="S4.T1.2.8.6.8.1" style="font-size:80%;">0.8069</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.9"><span class="ltx_text" id="S4.T1.2.8.6.9.1" style="font-size:80%;">0.8100</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.10"><span class="ltx_text" id="S4.T1.2.8.6.10.1" style="font-size:80%;">0.8085</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.8.6.11"><span class="ltx_text" id="S4.T1.2.8.6.11.1" style="font-size:80%;">0.8091</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.8.6.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.8.6.12.1">
<span class="ltx_p" id="S4.T1.2.8.6.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.8.6.12.1.1.1" style="font-size:80%;">-0.07%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.9.7">
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_t" id="S4.T1.2.9.7.1" rowspan="5"><span class="ltx_text" id="S4.T1.2.9.7.1.1" style="font-size:80%;">Criteo (LogLoss)</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.2.9.7.2"><span class="ltx_text" id="S4.T1.2.9.7.2.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.9.7.3"><span class="ltx_text" id="S4.T1.2.9.7.3.1" style="font-size:80%;">5.4%</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.4"><span class="ltx_text" id="S4.T1.2.9.7.4.1" style="font-size:80%;">0.4470</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.5"><span class="ltx_text" id="S4.T1.2.9.7.5.1" style="font-size:80%;">0.4429</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.6"><span class="ltx_text" id="S4.T1.2.9.7.6.1" style="font-size:80%;">0.4467</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.7"><span class="ltx_text" id="S4.T1.2.9.7.7.1" style="font-size:80%;">0.4510</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.2.9.7.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.9.7.8.1">
<span class="ltx_p" id="S4.T1.2.9.7.8.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.9.7.8.1.1.1" style="font-size:80%;">0.97%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.9"><span class="ltx_text" id="S4.T1.2.9.7.9.1" style="font-size:80%;">0.4449</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.10"><span class="ltx_text" id="S4.T1.2.9.7.10.1" style="font-size:80%;">0.4417</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.11"><span class="ltx_text" id="S4.T1.2.9.7.11.1" style="font-size:80%;">0.4449</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.9.7.12"><span class="ltx_text" id="S4.T1.2.9.7.12.1" style="font-size:80%;">0.4508</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.2.9.7.13">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.9.7.13.1">
<span class="ltx_p" id="S4.T1.2.9.7.13.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.9.7.13.1.1.1" style="font-size:80%;">1.30%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.10.8">
<td class="ltx_td ltx_align_left" id="S4.T1.2.10.8.1"><span class="ltx_text" id="S4.T1.2.10.8.1.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.10.8.2"><span class="ltx_text" id="S4.T1.2.10.8.2.1" style="font-size:80%;">10.8%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.3"><span class="ltx_text" id="S4.T1.2.10.8.3.1" style="font-size:80%;">0.4470</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.4"><span class="ltx_text" id="S4.T1.2.10.8.4.1" style="font-size:80%;">0.4429</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.5"><span class="ltx_text" id="S4.T1.2.10.8.5.1" style="font-size:80%;">0.4454</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.6"><span class="ltx_text" id="S4.T1.2.10.8.6.1" style="font-size:80%;">0.4469</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.10.8.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.10.8.7.1">
<span class="ltx_p" id="S4.T1.2.10.8.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.10.8.7.1.1.1" style="font-size:80%;">0.34%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.8"><span class="ltx_text" id="S4.T1.2.10.8.8.1" style="font-size:80%;">0.4449</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.9"><span class="ltx_text" id="S4.T1.2.10.8.9.1" style="font-size:80%;">0.4417</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.10"><span class="ltx_text" id="S4.T1.2.10.8.10.1" style="font-size:80%;">0.4437</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.10.8.11"><span class="ltx_text" id="S4.T1.2.10.8.11.1" style="font-size:80%;">0.4464</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.10.8.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.10.8.12.1">
<span class="ltx_p" id="S4.T1.2.10.8.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.10.8.12.1.1.1" style="font-size:80%;">0.60%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.11.9">
<td class="ltx_td ltx_align_left" id="S4.T1.2.11.9.1"><span class="ltx_text" id="S4.T1.2.11.9.1.1" style="font-size:80%;">3</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.11.9.2"><span class="ltx_text" id="S4.T1.2.11.9.2.1" style="font-size:80%;">16.2%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.3"><span class="ltx_text" id="S4.T1.2.11.9.3.1" style="font-size:80%;">0.4470</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.4"><span class="ltx_text" id="S4.T1.2.11.9.4.1" style="font-size:80%;">0.4429</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.5"><span class="ltx_text" id="S4.T1.2.11.9.5.1" style="font-size:80%;">0.4450</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.6"><span class="ltx_text" id="S4.T1.2.11.9.6.1" style="font-size:80%;">0.4451</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.11.9.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.11.9.7.1">
<span class="ltx_p" id="S4.T1.2.11.9.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.11.9.7.1.1.1" style="font-size:80%;">0.01%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.8"><span class="ltx_text" id="S4.T1.2.11.9.8.1" style="font-size:80%;">0.4449</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.9"><span class="ltx_text" id="S4.T1.2.11.9.9.1" style="font-size:80%;">0.4417</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.10"><span class="ltx_text" id="S4.T1.2.11.9.10.1" style="font-size:80%;">0.4435</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.11.9.11"><span class="ltx_text" id="S4.T1.2.11.9.11.1" style="font-size:80%;">0.4444</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.11.9.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.11.9.12.1">
<span class="ltx_p" id="S4.T1.2.11.9.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.11.9.12.1.1.1" style="font-size:80%;">0.21%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.12.10">
<td class="ltx_td ltx_align_left" id="S4.T1.2.12.10.1"><span class="ltx_text" id="S4.T1.2.12.10.1.1" style="font-size:80%;">4</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.12.10.2"><span class="ltx_text" id="S4.T1.2.12.10.2.1" style="font-size:80%;">21.6%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.3"><span class="ltx_text" id="S4.T1.2.12.10.3.1" style="font-size:80%;">0.4470</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.4"><span class="ltx_text" id="S4.T1.2.12.10.4.1" style="font-size:80%;">0.4429</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.5"><span class="ltx_text" id="S4.T1.2.12.10.5.1" style="font-size:80%;">0.4443</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.6"><span class="ltx_text" id="S4.T1.2.12.10.6.1" style="font-size:80%;">0.4443</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.12.10.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.12.10.7.1">
<span class="ltx_p" id="S4.T1.2.12.10.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.12.10.7.1.1.1" style="font-size:80%;">0.00%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.8"><span class="ltx_text" id="S4.T1.2.12.10.8.1" style="font-size:80%;">0.4449</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.9"><span class="ltx_text" id="S4.T1.2.12.10.9.1" style="font-size:80%;">0.4417</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.10"><span class="ltx_text" id="S4.T1.2.12.10.10.1" style="font-size:80%;">0.4431</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.12.10.11"><span class="ltx_text" id="S4.T1.2.12.10.11.1" style="font-size:80%;">0.4431</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.12.10.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.12.10.12.1">
<span class="ltx_p" id="S4.T1.2.12.10.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.12.10.12.1.1.1" style="font-size:80%;">-0.00%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.13.11">
<td class="ltx_td ltx_align_left" id="S4.T1.2.13.11.1"><span class="ltx_text" id="S4.T1.2.13.11.1.1" style="font-size:80%;">5</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.13.11.2"><span class="ltx_text" id="S4.T1.2.13.11.2.1" style="font-size:80%;">27%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.3"><span class="ltx_text" id="S4.T1.2.13.11.3.1" style="font-size:80%;">0.4470</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.4"><span class="ltx_text" id="S4.T1.2.13.11.4.1" style="font-size:80%;">0.4429</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.5"><span class="ltx_text" id="S4.T1.2.13.11.5.1" style="font-size:80%;">0.4443</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.6"><span class="ltx_text" id="S4.T1.2.13.11.6.1" style="font-size:80%;">0.4439</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.13.11.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.13.11.7.1">
<span class="ltx_p" id="S4.T1.2.13.11.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.13.11.7.1.1.1" style="font-size:80%;">-0.10%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.8"><span class="ltx_text" id="S4.T1.2.13.11.8.1" style="font-size:80%;">0.4449</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.9"><span class="ltx_text" id="S4.T1.2.13.11.9.1" style="font-size:80%;">0.4417</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.10"><span class="ltx_text" id="S4.T1.2.13.11.10.1" style="font-size:80%;">0.4430</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.13.11.11"><span class="ltx_text" id="S4.T1.2.13.11.11.1" style="font-size:80%;">0.4426</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.13.11.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.13.11.12.1">
<span class="ltx_p" id="S4.T1.2.13.11.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.13.11.12.1.1.1" style="font-size:80%;">-0.08%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.14.12">
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_t" id="S4.T1.2.14.12.1" rowspan="5"><span class="ltx_text" id="S4.T1.2.14.12.1.1" style="font-size:80%;">Avazu (AUC)</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.2.14.12.2"><span class="ltx_text" id="S4.T1.2.14.12.2.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.14.12.3"><span class="ltx_text" id="S4.T1.2.14.12.3.1" style="font-size:80%;">6.4%</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.4"><span class="ltx_text" id="S4.T1.2.14.12.4.1" style="font-size:80%;">0.7768</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.5"><span class="ltx_text" id="S4.T1.2.14.12.5.1" style="font-size:80%;">0.7777</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.6"><span class="ltx_text" id="S4.T1.2.14.12.6.1" style="font-size:80%;">0.7764</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.7"><span class="ltx_text" id="S4.T1.2.14.12.7.1" style="font-size:80%;">0.7727</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.2.14.12.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.14.12.8.1">
<span class="ltx_p" id="S4.T1.2.14.12.8.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.14.12.8.1.1.1" style="font-size:80%;">0.49%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.9"><span class="ltx_text" id="S4.T1.2.14.12.9.1" style="font-size:80%;">0.7787</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.10"><span class="ltx_text" id="S4.T1.2.14.12.10.1" style="font-size:80%;">0.7796</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.11"><span class="ltx_text" id="S4.T1.2.14.12.11.1" style="font-size:80%;">0.7776</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.14.12.12"><span class="ltx_text" id="S4.T1.2.14.12.12.1" style="font-size:80%;">0.7738</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.2.14.12.13">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.14.12.13.1">
<span class="ltx_p" id="S4.T1.2.14.12.13.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.14.12.13.1.1.1" style="font-size:80%;">0.49%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.15.13">
<td class="ltx_td ltx_align_left" id="S4.T1.2.15.13.1"><span class="ltx_text" id="S4.T1.2.15.13.1.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.15.13.2"><span class="ltx_text" id="S4.T1.2.15.13.2.1" style="font-size:80%;">12.9%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.3"><span class="ltx_text" id="S4.T1.2.15.13.3.1" style="font-size:80%;">0.7768</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.4"><span class="ltx_text" id="S4.T1.2.15.13.4.1" style="font-size:80%;">0.7777</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.5"><span class="ltx_text" id="S4.T1.2.15.13.5.1" style="font-size:80%;">0.7769</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.6"><span class="ltx_text" id="S4.T1.2.15.13.6.1" style="font-size:80%;">0.7756</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.15.13.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.15.13.7.1">
<span class="ltx_p" id="S4.T1.2.15.13.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.15.13.7.1.1.1" style="font-size:80%;">0.16%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.8"><span class="ltx_text" id="S4.T1.2.15.13.8.1" style="font-size:80%;">0.7787</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.9"><span class="ltx_text" id="S4.T1.2.15.13.9.1" style="font-size:80%;">0.7796</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.10"><span class="ltx_text" id="S4.T1.2.15.13.10.1" style="font-size:80%;">0.7784</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.15.13.11"><span class="ltx_text" id="S4.T1.2.15.13.11.1" style="font-size:80%;">0.7779</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.15.13.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.15.13.12.1">
<span class="ltx_p" id="S4.T1.2.15.13.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.15.13.12.1.1.1" style="font-size:80%;">0.05%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.16.14">
<td class="ltx_td ltx_align_left" id="S4.T1.2.16.14.1"><span class="ltx_text" id="S4.T1.2.16.14.1.1" style="font-size:80%;">3</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.16.14.2"><span class="ltx_text" id="S4.T1.2.16.14.2.1" style="font-size:80%;">19.3%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.3"><span class="ltx_text" id="S4.T1.2.16.14.3.1" style="font-size:80%;">0.7768</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.4"><span class="ltx_text" id="S4.T1.2.16.14.4.1" style="font-size:80%;">0.7777</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.5"><span class="ltx_text" id="S4.T1.2.16.14.5.1" style="font-size:80%;">0.7772</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.6"><span class="ltx_text" id="S4.T1.2.16.14.6.1" style="font-size:80%;">0.7764</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.16.14.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.16.14.7.1">
<span class="ltx_p" id="S4.T1.2.16.14.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.16.14.7.1.1.1" style="font-size:80%;">0.10%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.8"><span class="ltx_text" id="S4.T1.2.16.14.8.1" style="font-size:80%;">0.7787</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.9"><span class="ltx_text" id="S4.T1.2.16.14.9.1" style="font-size:80%;">0.7796</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.10"><span class="ltx_text" id="S4.T1.2.16.14.10.1" style="font-size:80%;">0.7789</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.16.14.11"><span class="ltx_text" id="S4.T1.2.16.14.11.1" style="font-size:80%;">0.7789</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.16.14.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.16.14.12.1">
<span class="ltx_p" id="S4.T1.2.16.14.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.16.14.12.1.1.1" style="font-size:80%;">0.00%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.17.15">
<td class="ltx_td ltx_align_left" id="S4.T1.2.17.15.1"><span class="ltx_text" id="S4.T1.2.17.15.1.1" style="font-size:80%;">4</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.17.15.2"><span class="ltx_text" id="S4.T1.2.17.15.2.1" style="font-size:80%;">25.8%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.3"><span class="ltx_text" id="S4.T1.2.17.15.3.1" style="font-size:80%;">0.7768</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.4"><span class="ltx_text" id="S4.T1.2.17.15.4.1" style="font-size:80%;">0.7777</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.5"><span class="ltx_text" id="S4.T1.2.17.15.5.1" style="font-size:80%;">0.7772</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.6"><span class="ltx_text" id="S4.T1.2.17.15.6.1" style="font-size:80%;">0.7770</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.17.15.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.17.15.7.1">
<span class="ltx_p" id="S4.T1.2.17.15.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.17.15.7.1.1.1" style="font-size:80%;">0.03%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.8"><span class="ltx_text" id="S4.T1.2.17.15.8.1" style="font-size:80%;">0.7787</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.9"><span class="ltx_text" id="S4.T1.2.17.15.9.1" style="font-size:80%;">0.7796</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.10"><span class="ltx_text" id="S4.T1.2.17.15.10.1" style="font-size:80%;">0.7789</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.17.15.11"><span class="ltx_text" id="S4.T1.2.17.15.11.1" style="font-size:80%;">0.7794</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.17.15.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.17.15.12.1">
<span class="ltx_p" id="S4.T1.2.17.15.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.17.15.12.1.1.1" style="font-size:80%;">-0.06%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.18.16">
<td class="ltx_td ltx_align_left" id="S4.T1.2.18.16.1"><span class="ltx_text" id="S4.T1.2.18.16.1.1" style="font-size:80%;">5</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.18.16.2"><span class="ltx_text" id="S4.T1.2.18.16.2.1" style="font-size:80%;">32.2%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.3"><span class="ltx_text" id="S4.T1.2.18.16.3.1" style="font-size:80%;">0.7768</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.4"><span class="ltx_text" id="S4.T1.2.18.16.4.1" style="font-size:80%;">0.7777</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.5"><span class="ltx_text" id="S4.T1.2.18.16.5.1" style="font-size:80%;">0.7774</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.6"><span class="ltx_text" id="S4.T1.2.18.16.6.1" style="font-size:80%;">0.7774</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.18.16.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.18.16.7.1">
<span class="ltx_p" id="S4.T1.2.18.16.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.18.16.7.1.1.1" style="font-size:80%;">-0.00%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.8"><span class="ltx_text" id="S4.T1.2.18.16.8.1" style="font-size:80%;">0.7787</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.9"><span class="ltx_text" id="S4.T1.2.18.16.9.1" style="font-size:80%;">0.7796</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.10"><span class="ltx_text" id="S4.T1.2.18.16.10.1" style="font-size:80%;">0.7788</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.18.16.11"><span class="ltx_text" id="S4.T1.2.18.16.11.1" style="font-size:80%;">0.7796</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.18.16.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.18.16.12.1">
<span class="ltx_p" id="S4.T1.2.18.16.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.18.16.12.1.1.1" style="font-size:80%;">-0.10%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.19.17">
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_t" id="S4.T1.2.19.17.1" rowspan="5"><span class="ltx_text" id="S4.T1.2.19.17.1.1" style="font-size:80%;">Avazu (LogLoss)</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.2.19.17.2"><span class="ltx_text" id="S4.T1.2.19.17.2.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.19.17.3"><span class="ltx_text" id="S4.T1.2.19.17.3.1" style="font-size:80%;">6.4%</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.4"><span class="ltx_text" id="S4.T1.2.19.17.4.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.5"><span class="ltx_text" id="S4.T1.2.19.17.5.1" style="font-size:80%;">0.3808</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.6"><span class="ltx_text" id="S4.T1.2.19.17.6.1" style="font-size:80%;">0.3817</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.7"><span class="ltx_text" id="S4.T1.2.19.17.7.1" style="font-size:80%;">0.3841</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.2.19.17.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.19.17.8.1">
<span class="ltx_p" id="S4.T1.2.19.17.8.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.19.17.8.1.1.1" style="font-size:80%;">0.62%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.9"><span class="ltx_text" id="S4.T1.2.19.17.9.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.10"><span class="ltx_text" id="S4.T1.2.19.17.10.1" style="font-size:80%;">0.3795</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.11"><span class="ltx_text" id="S4.T1.2.19.17.11.1" style="font-size:80%;">0.3810</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.19.17.12"><span class="ltx_text" id="S4.T1.2.19.17.12.1" style="font-size:80%;">0.3830</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.2.19.17.13">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.19.17.13.1">
<span class="ltx_p" id="S4.T1.2.19.17.13.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.19.17.13.1.1.1" style="font-size:80%;">0.52%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.20.18">
<td class="ltx_td ltx_align_left" id="S4.T1.2.20.18.1"><span class="ltx_text" id="S4.T1.2.20.18.1.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.20.18.2"><span class="ltx_text" id="S4.T1.2.20.18.2.1" style="font-size:80%;">12.9%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.3"><span class="ltx_text" id="S4.T1.2.20.18.3.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.4"><span class="ltx_text" id="S4.T1.2.20.18.4.1" style="font-size:80%;">0.3808</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.5"><span class="ltx_text" id="S4.T1.2.20.18.5.1" style="font-size:80%;">0.3812</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.6"><span class="ltx_text" id="S4.T1.2.20.18.6.1" style="font-size:80%;">0.3817</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.20.18.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.20.18.7.1">
<span class="ltx_p" id="S4.T1.2.20.18.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.20.18.7.1.1.1" style="font-size:80%;">0.11%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.8"><span class="ltx_text" id="S4.T1.2.20.18.8.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.9"><span class="ltx_text" id="S4.T1.2.20.18.9.1" style="font-size:80%;">0.3795</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.10"><span class="ltx_text" id="S4.T1.2.20.18.10.1" style="font-size:80%;">0.3801</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.20.18.11"><span class="ltx_text" id="S4.T1.2.20.18.11.1" style="font-size:80%;">0.3802</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.20.18.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.20.18.12.1">
<span class="ltx_p" id="S4.T1.2.20.18.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.20.18.12.1.1.1" style="font-size:80%;">0.02%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.21.19">
<td class="ltx_td ltx_align_left" id="S4.T1.2.21.19.1"><span class="ltx_text" id="S4.T1.2.21.19.1.1" style="font-size:80%;">3</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.21.19.2"><span class="ltx_text" id="S4.T1.2.21.19.2.1" style="font-size:80%;">19.3%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.3"><span class="ltx_text" id="S4.T1.2.21.19.3.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.4"><span class="ltx_text" id="S4.T1.2.21.19.4.1" style="font-size:80%;">0.3808</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.5"><span class="ltx_text" id="S4.T1.2.21.19.5.1" style="font-size:80%;">0.3812</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.6"><span class="ltx_text" id="S4.T1.2.21.19.6.1" style="font-size:80%;">0.3814</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.21.19.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.21.19.7.1">
<span class="ltx_p" id="S4.T1.2.21.19.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.21.19.7.1.1.1" style="font-size:80%;">0.07%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.8"><span class="ltx_text" id="S4.T1.2.21.19.8.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.9"><span class="ltx_text" id="S4.T1.2.21.19.9.1" style="font-size:80%;">0.3795</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.10"><span class="ltx_text" id="S4.T1.2.21.19.10.1" style="font-size:80%;">0.3801</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.21.19.11"><span class="ltx_text" id="S4.T1.2.21.19.11.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.21.19.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.21.19.12.1">
<span class="ltx_p" id="S4.T1.2.21.19.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.21.19.12.1.1.1" style="font-size:80%;">-0.02%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.22.20">
<td class="ltx_td ltx_align_left" id="S4.T1.2.22.20.1"><span class="ltx_text" id="S4.T1.2.22.20.1.1" style="font-size:80%;">4</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.22.20.2"><span class="ltx_text" id="S4.T1.2.22.20.2.1" style="font-size:80%;">25.8%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.3"><span class="ltx_text" id="S4.T1.2.22.20.3.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.4"><span class="ltx_text" id="S4.T1.2.22.20.4.1" style="font-size:80%;">0.3808</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.5"><span class="ltx_text" id="S4.T1.2.22.20.5.1" style="font-size:80%;">0.3810</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.6"><span class="ltx_text" id="S4.T1.2.22.20.6.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.22.20.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.22.20.7.1">
<span class="ltx_p" id="S4.T1.2.22.20.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.22.20.7.1.1.1" style="font-size:80%;">0.01%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.8"><span class="ltx_text" id="S4.T1.2.22.20.8.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.9"><span class="ltx_text" id="S4.T1.2.22.20.9.1" style="font-size:80%;">0.3795</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.10"><span class="ltx_text" id="S4.T1.2.22.20.10.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.22.20.11"><span class="ltx_text" id="S4.T1.2.22.20.11.1" style="font-size:80%;">0.3796</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.22.20.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.22.20.12.1">
<span class="ltx_p" id="S4.T1.2.22.20.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.22.20.12.1.1.1" style="font-size:80%;">-0.12%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.23.21">
<td class="ltx_td ltx_align_left" id="S4.T1.2.23.21.1"><span class="ltx_text" id="S4.T1.2.23.21.1.1" style="font-size:80%;">5</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.2.23.21.2"><span class="ltx_text" id="S4.T1.2.23.21.2.1" style="font-size:80%;">32.2%</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.3"><span class="ltx_text" id="S4.T1.2.23.21.3.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.4"><span class="ltx_text" id="S4.T1.2.23.21.4.1" style="font-size:80%;">0.3808</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.5"><span class="ltx_text" id="S4.T1.2.23.21.5.1" style="font-size:80%;">0.3811</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.6"><span class="ltx_text" id="S4.T1.2.23.21.6.1" style="font-size:80%;">0.3810</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S4.T1.2.23.21.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.23.21.7.1">
<span class="ltx_p" id="S4.T1.2.23.21.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.23.21.7.1.1.1" style="font-size:80%;">-0.05%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.8"><span class="ltx_text" id="S4.T1.2.23.21.8.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.9"><span class="ltx_text" id="S4.T1.2.23.21.9.1" style="font-size:80%;">0.3795</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.10"><span class="ltx_text" id="S4.T1.2.23.21.10.1" style="font-size:80%;">0.3800</span></td>
<td class="ltx_td ltx_align_right" id="S4.T1.2.23.21.11"><span class="ltx_text" id="S4.T1.2.23.21.11.1" style="font-size:80%;">0.3796</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top" id="S4.T1.2.23.21.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.23.21.12.1">
<span class="ltx_p" id="S4.T1.2.23.21.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.23.21.12.1.1.1" style="font-size:80%;">-0.11%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.24.22">
<td class="ltx_td ltx_align_left ltx_align_top ltx_border_bb ltx_border_t" id="S4.T1.2.24.22.1" rowspan="2"><span class="ltx_text" id="S4.T1.2.24.22.1.1" style="font-size:80%;">Movielens (MSE)</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.2.24.22.2"><span class="ltx_text" id="S4.T1.2.24.22.2.1" style="font-size:80%;">1</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.2.24.22.3"><span class="ltx_text" id="S4.T1.2.24.22.3.1" style="font-size:80%;">33.1%</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.4"><span class="ltx_text" id="S4.T1.2.24.22.4.1" style="font-size:80%;">0.7431</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.5"><span class="ltx_text" id="S4.T1.2.24.22.5.1" style="font-size:80%;">0.7407</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.6"><span class="ltx_text" id="S4.T1.2.24.22.6.1" style="font-size:80%;">0.7449</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.7"><span class="ltx_text" id="S4.T1.2.24.22.7.1" style="font-size:80%;">0.7572</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S4.T1.2.24.22.8">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.24.22.8.1">
<span class="ltx_p" id="S4.T1.2.24.22.8.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.24.22.8.1.1.1" style="font-size:80%;">1.61%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.9"><span class="ltx_text" id="S4.T1.2.24.22.9.1" style="font-size:80%;">0.7376</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.10"><span class="ltx_text" id="S4.T1.2.24.22.10.1" style="font-size:80%;">0.7394</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.11"><span class="ltx_text" id="S4.T1.2.24.22.11.1" style="font-size:80%;">0.7445</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.2.24.22.12"><span class="ltx_text" id="S4.T1.2.24.22.12.1" style="font-size:80%;">0.7630</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S4.T1.2.24.22.13">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.24.22.13.1">
<span class="ltx_p" id="S4.T1.2.24.22.13.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.24.22.13.1.1.1" style="font-size:80%;">2.43%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.25.23">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.2.25.23.1"><span class="ltx_text" id="S4.T1.2.25.23.1.1" style="font-size:80%;">2</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S4.T1.2.25.23.2"><span class="ltx_text" id="S4.T1.2.25.23.2.1" style="font-size:80%;">64.3%</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.3"><span class="ltx_text" id="S4.T1.2.25.23.3.1" style="font-size:80%;">0.7431</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.4"><span class="ltx_text" id="S4.T1.2.25.23.4.1" style="font-size:80%;">0.7407</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.5"><span class="ltx_text" id="S4.T1.2.25.23.5.1" style="font-size:80%;">0.7418</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.6"><span class="ltx_text" id="S4.T1.2.25.23.6.1" style="font-size:80%;">0.7464</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_r" id="S4.T1.2.25.23.7">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.25.23.7.1">
<span class="ltx_p" id="S4.T1.2.25.23.7.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.25.23.7.1.1.1" style="font-size:80%;">0.62%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.8"><span class="ltx_text" id="S4.T1.2.25.23.8.1" style="font-size:80%;">0.7376</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.9"><span class="ltx_text" id="S4.T1.2.25.23.9.1" style="font-size:80%;">0.7394</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.10"><span class="ltx_text" id="S4.T1.2.25.23.10.1" style="font-size:80%;">0.7398</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T1.2.25.23.11"><span class="ltx_text" id="S4.T1.2.25.23.11.1" style="font-size:80%;">0.7484</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="S4.T1.2.25.23.12">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.2.25.23.12.1">
<span class="ltx_p" id="S4.T1.2.25.23.12.1.1" style="width:34.7pt;"><span class="ltx_text" id="S4.T1.2.25.23.12.1.1.1" style="font-size:80%;">1.15%</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.2">The first step is computed only once per context in <math alttext="O(\rho|\mathcal{C}|k)" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.1.m1.2"><semantics id="S4.SS2.SSS2.p2.1.m1.2a"><mrow id="S4.SS2.SSS2.p2.1.m1.2.2" xref="S4.SS2.SSS2.p2.1.m1.2.2.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.2.2.3" xref="S4.SS2.SSS2.p2.1.m1.2.2.3.cmml">O</mi><mo id="S4.SS2.SSS2.p2.1.m1.2.2.2" xref="S4.SS2.SSS2.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p2.1.m1.2.2.1.1" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.cmml"><mo id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.2" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.2.cmml">ρ</mi><mo id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.1" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.2" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.1.cmml"><mo id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml">𝒞</mi><mo id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.1a" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.4" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.4.cmml">k</mi></mrow><mo id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.2b"><apply id="S4.SS2.SSS2.p2.1.m1.2.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2"><times id="S4.SS2.SSS2.p2.1.m1.2.2.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.2"></times><ci id="S4.SS2.SSS2.p2.1.m1.2.2.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.3">𝑂</ci><apply id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1"><times id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.1"></times><ci id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.2">𝜌</ci><apply id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.2"><abs id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.3.2.1"></abs><ci id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">𝒞</ci></apply><ci id="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.4.cmml" xref="S4.SS2.SSS2.p2.1.m1.2.2.1.1.1.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.2c">O(\rho|\mathcal{C}|k)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.1.m1.2d">italic_O ( italic_ρ | caligraphic_C | italic_k )</annotation></semantics></math> time, and its results are cached. The last two steps are computed for every item, and their complexity is <math alttext="O(\rho|\mathcal{I}|k)" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.2.m2.2"><semantics id="S4.SS2.SSS2.p2.2.m2.2a"><mrow id="S4.SS2.SSS2.p2.2.m2.2.2" xref="S4.SS2.SSS2.p2.2.m2.2.2.cmml"><mi id="S4.SS2.SSS2.p2.2.m2.2.2.3" xref="S4.SS2.SSS2.p2.2.m2.2.2.3.cmml">O</mi><mo id="S4.SS2.SSS2.p2.2.m2.2.2.2" xref="S4.SS2.SSS2.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p2.2.m2.2.2.1.1" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml"><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.2" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.2.cmml">ρ</mi><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.1" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.2" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.1.cmml"><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.2.1" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml">ℐ</mi><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.2.2" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.1a" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.4" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.4.cmml">k</mi></mrow><mo id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.3" stretchy="false" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m2.2b"><apply id="S4.SS2.SSS2.p2.2.m2.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2"><times id="S4.SS2.SSS2.p2.2.m2.2.2.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.2"></times><ci id="S4.SS2.SSS2.p2.2.m2.2.2.3.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.3">𝑂</ci><apply id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1"><times id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.1"></times><ci id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.2">𝜌</ci><apply id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.2"><abs id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.3.2.1"></abs><ci id="S4.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m2.1.1">ℐ</ci></apply><ci id="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.4.cmml" xref="S4.SS2.SSS2.p2.2.m2.2.2.1.1.1.4">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m2.2c">O(\rho|\mathcal{I}|k)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.2.m2.2d">italic_O ( italic_ρ | caligraphic_I | italic_k )</annotation></semantics></math> per item, as we desire.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section we present experimental results demonstrating that our approach significantly reduces the cost of item recommendation serving without compromising accuracy, in comparison to the pruning approach.
Finally, we demonstrate that finding a DPLR factorization of the field interaction matrix of a regular FwFM, instead of training a DPLR representation, may not be a good approach in practice.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Accuracy on public data-sets</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.3">We compare our approach to an FwFM, an FM, and a pruned FwFM using the Criteo Display Advertising Challenge<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.kaggle.com/c/criteo-display-ad-challenge</span></span></span> data-set, comprising of 39 fields and <math alttext="\sim 45\mathrm{M}" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">∼</mo><mrow id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml"><mn id="S5.SS1.p1.1.m1.1.1.3.2" xref="S5.SS1.p1.1.m1.1.1.3.2.cmml">45</mn><mo id="S5.SS1.p1.1.m1.1.1.3.1" xref="S5.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p1.1.m1.1.1.3.3" mathvariant="normal" xref="S5.SS1.p1.1.m1.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">absent</csymbol><apply id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3"><times id="S5.SS1.p1.1.m1.1.1.3.1.cmml" xref="S5.SS1.p1.1.m1.1.1.3.1"></times><cn id="S5.SS1.p1.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3.2">45</cn><ci id="S5.SS1.p1.1.m1.1.1.3.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3.3">M</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\sim 45\mathrm{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">∼ 45 roman_M</annotation></semantics></math> samples, the Avazu challenge dataset<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.kaggle.com/c/avazu-ctr-prediction</span></span></span> comprising of 33 fields and <math alttext="\sim 40\mathrm{M}" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml"></mi><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">∼</mo><mrow id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml"><mn id="S5.SS1.p1.2.m2.1.1.3.2" xref="S5.SS1.p1.2.m2.1.1.3.2.cmml">40</mn><mo id="S5.SS1.p1.2.m2.1.1.3.1" xref="S5.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p1.2.m2.1.1.3.3" mathvariant="normal" xref="S5.SS1.p1.2.m2.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">absent</csymbol><apply id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3"><times id="S5.SS1.p1.2.m2.1.1.3.1.cmml" xref="S5.SS1.p1.2.m2.1.1.3.1"></times><cn id="S5.SS1.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.3.2">40</cn><ci id="S5.SS1.p1.2.m2.1.1.3.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3.3">M</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\sim 40\mathrm{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">∼ 40 roman_M</annotation></semantics></math> samples, and the Movielens 1M <cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib14" title="">2015</a>)</cite> data-set, with 8 fields and <math alttext="\sim 1\mathrm{M}" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml"></mi><mo id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">∼</mo><mrow id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml"><mn id="S5.SS1.p1.3.m3.1.1.3.2" xref="S5.SS1.p1.3.m3.1.1.3.2.cmml">1</mn><mo id="S5.SS1.p1.3.m3.1.1.3.1" xref="S5.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S5.SS1.p1.3.m3.1.1.3.3" mathvariant="normal" xref="S5.SS1.p1.3.m3.1.1.3.3.cmml">M</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">absent</csymbol><apply id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3"><times id="S5.SS1.p1.3.m3.1.1.3.1.cmml" xref="S5.SS1.p1.3.m3.1.1.3.1"></times><cn id="S5.SS1.p1.3.m3.1.1.3.2.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.3.2">1</cn><ci id="S5.SS1.p1.3.m3.1.1.3.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3.3">M</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\sim 1\mathrm{M}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">∼ 1 roman_M</annotation></semantics></math> samples. Out of the available MovieLens data-sets, we chose the one with the most number of informative context and item fields. The timestamp is converted into year, month, day of week, and hour of day, creating a 11 field data-set. The “genres” field in the MovieLens data-set has multiple values, and as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S3.SS2" title="3.2. Inefficiency of field-weighted factorization machines ‣ 3. Background and problem formulation ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we average the genre embedding vectors to produce one genre vector.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.3">All data-sets were randomly split into 80% training, 10% validation, and 10% test sets. The validation sets were used for tuning the learning rate using Optuna <cite class="ltx_cite ltx_citemacro_citep">(Akiba et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib5" title="">2019</a>)</cite>. Features with less than 10 occurrences in the training set, and those appearing in the test and validation set that did not appear in the training set, are replaced with a special “rare feature”. Numerical features are binned similarly to the strategy used by the Criteo Challenge winners <cite class="ltx_cite ltx_citemacro_citep">(cri, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib2" title="">2014</a>)</cite>, via the <math alttext="x\to\lfloor\ln^{2}(x)\rfloor" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.2"><semantics id="S5.SS1.p2.1.m1.2a"><mrow id="S5.SS1.p2.1.m1.2.2" xref="S5.SS1.p2.1.m1.2.2.cmml"><mi id="S5.SS1.p2.1.m1.2.2.3" xref="S5.SS1.p2.1.m1.2.2.3.cmml">x</mi><mo id="S5.SS1.p2.1.m1.2.2.2" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.2.cmml">→</mo><mrow id="S5.SS1.p2.1.m1.2.2.1.1" xref="S5.SS1.p2.1.m1.2.2.1.2.cmml"><mo id="S5.SS1.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.1.2.1.cmml">⌊</mo><mrow id="S5.SS1.p2.1.m1.2.2.1.1.1.1" xref="S5.SS1.p2.1.m1.2.2.1.1.1.2.cmml"><msup id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.2" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.2.cmml">ln</mi><mn id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.3" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S5.SS1.p2.1.m1.2.2.1.1.1.1a" xref="S5.SS1.p2.1.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S5.SS1.p2.1.m1.2.2.1.1.1.1.2" xref="S5.SS1.p2.1.m1.2.2.1.1.1.2.cmml"><mo id="S5.SS1.p2.1.m1.2.2.1.1.1.1.2.1" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.1.1.1.2.cmml">(</mo><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">x</mi><mo id="S5.SS1.p2.1.m1.2.2.1.1.1.1.2.2" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.SS1.p2.1.m1.2.2.1.1.3" stretchy="false" xref="S5.SS1.p2.1.m1.2.2.1.2.1.cmml">⌋</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.2b"><apply id="S5.SS1.p2.1.m1.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2"><ci id="S5.SS1.p2.1.m1.2.2.2.cmml" xref="S5.SS1.p2.1.m1.2.2.2">→</ci><ci id="S5.SS1.p2.1.m1.2.2.3.cmml" xref="S5.SS1.p2.1.m1.2.2.3">𝑥</ci><apply id="S5.SS1.p2.1.m1.2.2.1.2.cmml" xref="S5.SS1.p2.1.m1.2.2.1.1"><floor id="S5.SS1.p2.1.m1.2.2.1.2.1.cmml" xref="S5.SS1.p2.1.m1.2.2.1.1.2"></floor><apply id="S5.SS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1"><apply id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ln id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.2"></ln><cn id="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p2.1.m1.2.2.1.1.1.1.1.3">2</cn></apply><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.2c">x\to\lfloor\ln^{2}(x)\rfloor</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.2d">italic_x → ⌊ roman_ln start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( italic_x ) ⌋</annotation></semantics></math> function. We tested embedding dimensions of <math alttext="8" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1"><semantics id="S5.SS1.p2.2.m2.1a"><mn id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><cn id="S5.SS1.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS1.p2.2.m2.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">8</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.1d">8</annotation></semantics></math> and <math alttext="16" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.1"><semantics id="S5.SS1.p2.3.m3.1a"><mn id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><cn id="S5.SS1.p2.3.m3.1.1.cmml" type="integer" xref="S5.SS1.p2.3.m3.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">16</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.3.m3.1d">16</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.4">We compare DPLR with pruning by matching the number of entries we retain in the pruned field interaction matrix to the number of parameters in the DPLR model. For a rank <math alttext="\rho" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1"><semantics id="S5.SS1.p3.1.m1.1a"><mi id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><ci id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.1.m1.1d">italic_ρ</annotation></semantics></math>, we use <math alttext="\rho(m+1)" class="ltx_Math" display="inline" id="S5.SS1.p3.2.m2.1"><semantics id="S5.SS1.p3.2.m2.1a"><mrow id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml"><mi id="S5.SS1.p3.2.m2.1.1.3" xref="S5.SS1.p3.2.m2.1.1.3.cmml">ρ</mi><mo id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.p3.2.m2.1.1.1.1" xref="S5.SS1.p3.2.m2.1.1.1.1.1.cmml"><mo id="S5.SS1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S5.SS1.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p3.2.m2.1.1.1.1.1" xref="S5.SS1.p3.2.m2.1.1.1.1.1.cmml"><mi id="S5.SS1.p3.2.m2.1.1.1.1.1.2" xref="S5.SS1.p3.2.m2.1.1.1.1.1.2.cmml">m</mi><mo id="S5.SS1.p3.2.m2.1.1.1.1.1.1" xref="S5.SS1.p3.2.m2.1.1.1.1.1.1.cmml">+</mo><mn id="S5.SS1.p3.2.m2.1.1.1.1.1.3" xref="S5.SS1.p3.2.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S5.SS1.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"><times id="S5.SS1.p3.2.m2.1.1.2.cmml" xref="S5.SS1.p3.2.m2.1.1.2"></times><ci id="S5.SS1.p3.2.m2.1.1.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3">𝜌</ci><apply id="S5.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1.1.1"><plus id="S5.SS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1.1.1.1.1"></plus><ci id="S5.SS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S5.SS1.p3.2.m2.1.1.1.1.1.2">𝑚</ci><cn id="S5.SS1.p3.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.2.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">\rho(m+1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.2.m2.1d">italic_ρ ( italic_m + 1 )</annotation></semantics></math> parameters, and the corresponding pruned model is left with the largest magnitude <math alttext="\rho(m+1)" class="ltx_Math" display="inline" id="S5.SS1.p3.3.m3.1"><semantics id="S5.SS1.p3.3.m3.1a"><mrow id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml"><mi id="S5.SS1.p3.3.m3.1.1.3" xref="S5.SS1.p3.3.m3.1.1.3.cmml">ρ</mi><mo id="S5.SS1.p3.3.m3.1.1.2" xref="S5.SS1.p3.3.m3.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.p3.3.m3.1.1.1.1" xref="S5.SS1.p3.3.m3.1.1.1.1.1.cmml"><mo id="S5.SS1.p3.3.m3.1.1.1.1.2" stretchy="false" xref="S5.SS1.p3.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p3.3.m3.1.1.1.1.1" xref="S5.SS1.p3.3.m3.1.1.1.1.1.cmml"><mi id="S5.SS1.p3.3.m3.1.1.1.1.1.2" xref="S5.SS1.p3.3.m3.1.1.1.1.1.2.cmml">m</mi><mo id="S5.SS1.p3.3.m3.1.1.1.1.1.1" xref="S5.SS1.p3.3.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S5.SS1.p3.3.m3.1.1.1.1.1.3" xref="S5.SS1.p3.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS1.p3.3.m3.1.1.1.1.3" stretchy="false" xref="S5.SS1.p3.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><apply id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1"><times id="S5.SS1.p3.3.m3.1.1.2.cmml" xref="S5.SS1.p3.3.m3.1.1.2"></times><ci id="S5.SS1.p3.3.m3.1.1.3.cmml" xref="S5.SS1.p3.3.m3.1.1.3">𝜌</ci><apply id="S5.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1.1.1"><plus id="S5.SS1.p3.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1.1.1.1.1"></plus><ci id="S5.SS1.p3.3.m3.1.1.1.1.1.2.cmml" xref="S5.SS1.p3.3.m3.1.1.1.1.1.2">𝑚</ci><cn id="S5.SS1.p3.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">\rho(m+1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.3.m3.1d">italic_ρ ( italic_m + 1 )</annotation></semantics></math> field interaction coefficients. Equivalently, we keep <math alttext="100\times\frac{2\rho(m+1)}{m(m-1)}" class="ltx_Math" display="inline" id="S5.SS1.p3.4.m4.2"><semantics id="S5.SS1.p3.4.m4.2a"><mrow id="S5.SS1.p3.4.m4.2.3" xref="S5.SS1.p3.4.m4.2.3.cmml"><mn id="S5.SS1.p3.4.m4.2.3.2" xref="S5.SS1.p3.4.m4.2.3.2.cmml">100</mn><mo id="S5.SS1.p3.4.m4.2.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p3.4.m4.2.3.1.cmml">×</mo><mfrac id="S5.SS1.p3.4.m4.2.2" xref="S5.SS1.p3.4.m4.2.2.cmml"><mrow id="S5.SS1.p3.4.m4.1.1.1" xref="S5.SS1.p3.4.m4.1.1.1.cmml"><mn id="S5.SS1.p3.4.m4.1.1.1.3" xref="S5.SS1.p3.4.m4.1.1.1.3.cmml">2</mn><mo id="S5.SS1.p3.4.m4.1.1.1.2" xref="S5.SS1.p3.4.m4.1.1.1.2.cmml">⁢</mo><mi id="S5.SS1.p3.4.m4.1.1.1.4" xref="S5.SS1.p3.4.m4.1.1.1.4.cmml">ρ</mi><mo id="S5.SS1.p3.4.m4.1.1.1.2a" xref="S5.SS1.p3.4.m4.1.1.1.2.cmml">⁢</mo><mrow id="S5.SS1.p3.4.m4.1.1.1.1.1" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.cmml"><mo id="S5.SS1.p3.4.m4.1.1.1.1.1.2" stretchy="false" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.p3.4.m4.1.1.1.1.1.1" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.cmml"><mi id="S5.SS1.p3.4.m4.1.1.1.1.1.1.2" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.2.cmml">m</mi><mo id="S5.SS1.p3.4.m4.1.1.1.1.1.1.1" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.1.cmml">+</mo><mn id="S5.SS1.p3.4.m4.1.1.1.1.1.1.3" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS1.p3.4.m4.1.1.1.1.1.3" stretchy="false" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S5.SS1.p3.4.m4.2.2.2" xref="S5.SS1.p3.4.m4.2.2.2.cmml"><mi id="S5.SS1.p3.4.m4.2.2.2.3" xref="S5.SS1.p3.4.m4.2.2.2.3.cmml">m</mi><mo id="S5.SS1.p3.4.m4.2.2.2.2" xref="S5.SS1.p3.4.m4.2.2.2.2.cmml">⁢</mo><mrow id="S5.SS1.p3.4.m4.2.2.2.1.1" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.cmml"><mo id="S5.SS1.p3.4.m4.2.2.2.1.1.2" stretchy="false" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS1.p3.4.m4.2.2.2.1.1.1" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.cmml"><mi id="S5.SS1.p3.4.m4.2.2.2.1.1.1.2" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.2.cmml">m</mi><mo id="S5.SS1.p3.4.m4.2.2.2.1.1.1.1" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.1.cmml">−</mo><mn id="S5.SS1.p3.4.m4.2.2.2.1.1.1.3" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS1.p3.4.m4.2.2.2.1.1.3" stretchy="false" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.4.m4.2b"><apply id="S5.SS1.p3.4.m4.2.3.cmml" xref="S5.SS1.p3.4.m4.2.3"><times id="S5.SS1.p3.4.m4.2.3.1.cmml" xref="S5.SS1.p3.4.m4.2.3.1"></times><cn id="S5.SS1.p3.4.m4.2.3.2.cmml" type="integer" xref="S5.SS1.p3.4.m4.2.3.2">100</cn><apply id="S5.SS1.p3.4.m4.2.2.cmml" xref="S5.SS1.p3.4.m4.2.2"><divide id="S5.SS1.p3.4.m4.2.2.3.cmml" xref="S5.SS1.p3.4.m4.2.2"></divide><apply id="S5.SS1.p3.4.m4.1.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1.1"><times id="S5.SS1.p3.4.m4.1.1.1.2.cmml" xref="S5.SS1.p3.4.m4.1.1.1.2"></times><cn id="S5.SS1.p3.4.m4.1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.4.m4.1.1.1.3">2</cn><ci id="S5.SS1.p3.4.m4.1.1.1.4.cmml" xref="S5.SS1.p3.4.m4.1.1.1.4">𝜌</ci><apply id="S5.SS1.p3.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1.1.1.1"><plus id="S5.SS1.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.1"></plus><ci id="S5.SS1.p3.4.m4.1.1.1.1.1.1.2.cmml" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.2">𝑚</ci><cn id="S5.SS1.p3.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.4.m4.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S5.SS1.p3.4.m4.2.2.2.cmml" xref="S5.SS1.p3.4.m4.2.2.2"><times id="S5.SS1.p3.4.m4.2.2.2.2.cmml" xref="S5.SS1.p3.4.m4.2.2.2.2"></times><ci id="S5.SS1.p3.4.m4.2.2.2.3.cmml" xref="S5.SS1.p3.4.m4.2.2.2.3">𝑚</ci><apply id="S5.SS1.p3.4.m4.2.2.2.1.1.1.cmml" xref="S5.SS1.p3.4.m4.2.2.2.1.1"><minus id="S5.SS1.p3.4.m4.2.2.2.1.1.1.1.cmml" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.1"></minus><ci id="S5.SS1.p3.4.m4.2.2.2.1.1.1.2.cmml" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.2">𝑚</ci><cn id="S5.SS1.p3.4.m4.2.2.2.1.1.1.3.cmml" type="integer" xref="S5.SS1.p3.4.m4.2.2.2.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.4.m4.2c">100\times\frac{2\rho(m+1)}{m(m-1)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p3.4.m4.2d">100 × divide start_ARG 2 italic_ρ ( italic_m + 1 ) end_ARG start_ARG italic_m ( italic_m - 1 ) end_ARG</annotation></semantics></math> percent of the field interactions.</p>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">The results are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.T1" title="Table 1 ‣ 4.2.2. Fast inference for item ranking ‣ 4.2. The modified model and fast inference algorithm ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. We see that for aggressive pruning, retaining less than 20% of the interactions, the DPLR models out-perform, or perform on par, compared the pruned models. For MovieLens, due to a low number of fields, a DPLR model is equivalent to mild pruning, and still outperforms a pruned model.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Synthetic latency measurements</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.3">We use a simulation to compare inference time for a large batch of items for various amounts of context fields. We use the Criteo dataset as our example for the number of fields, and simulate vectors from 40 fields. We designate <math alttext="k\in\{10,15,20,25,30\}" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.5"><semantics id="S5.SS2.p1.1.m1.5a"><mrow id="S5.SS2.p1.1.m1.5.6" xref="S5.SS2.p1.1.m1.5.6.cmml"><mi id="S5.SS2.p1.1.m1.5.6.2" xref="S5.SS2.p1.1.m1.5.6.2.cmml">k</mi><mo id="S5.SS2.p1.1.m1.5.6.1" xref="S5.SS2.p1.1.m1.5.6.1.cmml">∈</mo><mrow id="S5.SS2.p1.1.m1.5.6.3.2" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml"><mo id="S5.SS2.p1.1.m1.5.6.3.2.1" stretchy="false" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">10</mn><mo id="S5.SS2.p1.1.m1.5.6.3.2.2" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.2.2" xref="S5.SS2.p1.1.m1.2.2.cmml">15</mn><mo id="S5.SS2.p1.1.m1.5.6.3.2.3" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.3.3" xref="S5.SS2.p1.1.m1.3.3.cmml">20</mn><mo id="S5.SS2.p1.1.m1.5.6.3.2.4" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.4.4" xref="S5.SS2.p1.1.m1.4.4.cmml">25</mn><mo id="S5.SS2.p1.1.m1.5.6.3.2.5" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.5.5" xref="S5.SS2.p1.1.m1.5.5.cmml">30</mn><mo id="S5.SS2.p1.1.m1.5.6.3.2.6" stretchy="false" xref="S5.SS2.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.5b"><apply id="S5.SS2.p1.1.m1.5.6.cmml" xref="S5.SS2.p1.1.m1.5.6"><in id="S5.SS2.p1.1.m1.5.6.1.cmml" xref="S5.SS2.p1.1.m1.5.6.1"></in><ci id="S5.SS2.p1.1.m1.5.6.2.cmml" xref="S5.SS2.p1.1.m1.5.6.2">𝑘</ci><set id="S5.SS2.p1.1.m1.5.6.3.1.cmml" xref="S5.SS2.p1.1.m1.5.6.3.2"><cn id="S5.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1">10</cn><cn id="S5.SS2.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS2.p1.1.m1.2.2">15</cn><cn id="S5.SS2.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.3.3">20</cn><cn id="S5.SS2.p1.1.m1.4.4.cmml" type="integer" xref="S5.SS2.p1.1.m1.4.4">25</cn><cn id="S5.SS2.p1.1.m1.5.5.cmml" type="integer" xref="S5.SS2.p1.1.m1.5.5">30</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.5c">k\in\{10,15,20,25,30\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.5d">italic_k ∈ { 10 , 15 , 20 , 25 , 30 }</annotation></semantics></math> of them as “context” fields, whereas the rest are item fields. Note, that since Criteo is anonymized, we have no way of knowing which fields are contextual. We measure the scoring time for DPLR models of ranks <math alttext="\rho\in\{1,2,3\}" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.3"><semantics id="S5.SS2.p1.2.m2.3a"><mrow id="S5.SS2.p1.2.m2.3.4" xref="S5.SS2.p1.2.m2.3.4.cmml"><mi id="S5.SS2.p1.2.m2.3.4.2" xref="S5.SS2.p1.2.m2.3.4.2.cmml">ρ</mi><mo id="S5.SS2.p1.2.m2.3.4.1" xref="S5.SS2.p1.2.m2.3.4.1.cmml">∈</mo><mrow id="S5.SS2.p1.2.m2.3.4.3.2" xref="S5.SS2.p1.2.m2.3.4.3.1.cmml"><mo id="S5.SS2.p1.2.m2.3.4.3.2.1" stretchy="false" xref="S5.SS2.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">1</mn><mo id="S5.SS2.p1.2.m2.3.4.3.2.2" xref="S5.SS2.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p1.2.m2.2.2" xref="S5.SS2.p1.2.m2.2.2.cmml">2</mn><mo id="S5.SS2.p1.2.m2.3.4.3.2.3" xref="S5.SS2.p1.2.m2.3.4.3.1.cmml">,</mo><mn id="S5.SS2.p1.2.m2.3.3" xref="S5.SS2.p1.2.m2.3.3.cmml">3</mn><mo id="S5.SS2.p1.2.m2.3.4.3.2.4" stretchy="false" xref="S5.SS2.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.3b"><apply id="S5.SS2.p1.2.m2.3.4.cmml" xref="S5.SS2.p1.2.m2.3.4"><in id="S5.SS2.p1.2.m2.3.4.1.cmml" xref="S5.SS2.p1.2.m2.3.4.1"></in><ci id="S5.SS2.p1.2.m2.3.4.2.cmml" xref="S5.SS2.p1.2.m2.3.4.2">𝜌</ci><set id="S5.SS2.p1.2.m2.3.4.3.1.cmml" xref="S5.SS2.p1.2.m2.3.4.3.2"><cn id="S5.SS2.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1">1</cn><cn id="S5.SS2.p1.2.m2.2.2.cmml" type="integer" xref="S5.SS2.p1.2.m2.2.2">2</cn><cn id="S5.SS2.p1.2.m2.3.3.cmml" type="integer" xref="S5.SS2.p1.2.m2.3.3">3</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.3c">\rho\in\{1,2,3\}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.3d">italic_ρ ∈ { 1 , 2 , 3 }</annotation></semantics></math>, and equivalently pruned models that have identical number of parameters by retaining <math alttext="\rho(m+1)" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml">ρ</mi><mo id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S5.SS2.p1.3.m3.1.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.1.1.cmml"><mo id="S5.SS2.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S5.SS2.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.p1.3.m3.1.1.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S5.SS2.p1.3.m3.1.1.1.1.1.2" xref="S5.SS2.p1.3.m3.1.1.1.1.1.2.cmml">m</mi><mo id="S5.SS2.p1.3.m3.1.1.1.1.1.1" xref="S5.SS2.p1.3.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S5.SS2.p1.3.m3.1.1.1.1.1.3" xref="S5.SS2.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S5.SS2.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S5.SS2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><times id="S5.SS2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.2"></times><ci id="S5.SS2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.p1.3.m3.1.1.3">𝜌</ci><apply id="S5.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1.1"><plus id="S5.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1.1.1.1"></plus><ci id="S5.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.3.m3.1.1.1.1.1.2">𝑚</ci><cn id="S5.SS2.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\rho(m+1)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_ρ ( italic_m + 1 )</annotation></semantics></math> field interactions. The experimental code is implemented in Python, with the score computation parts implemented in Cython to eliminate Python runtime overhead. Moreover, to ensure CPU cache-friendliness of scoring using a pruned model, we fit the 3D array of latent vectors of an entire auction in an appropriate memory format.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">The scoring times for various auction (batch) sizes are reported in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.F1" title="Figure 1 ‣ 5.2. Synthetic latency measurements ‣ 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, together with scoring times using a regular FwFM. To measure standard error, the average time per auction for each configuration is measured by repeating every scoring experiment 50 times. To ensure precise measurement of each experiment due to timer resolution, each experiment comprises of 10 scored auctions. The experiments are conducted on a 2019 MacBook Pro laptop with a 2.4 GHz 8-Core Intel Core i9 CPU.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">While there are caveats in synthetic timing benchmarks that stem from the implementation and the hardware used, the results allow appreciating the potential of our approach: indeed, scoring using a DPLR model is significantly faster than scoring by a pruned model. Since we made the code available, readers can also appreciate the implementation simplicity of the DPLR scoring algorithm - it relies on batched matrix-matrix products, whose efficient implementations are provided in a variety of numerical computing packages.</p>
</div>
<figure class="ltx_figure" id="S5.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="281" id="S5.F1.g1" src="extracted/5747578/timing.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S5.F1.3.2" style="font-size:90%;">Synthetic timing measurement of a single auction for various auction sizes, DPLR model ranks, and amounts of context fields. Standard error is plotted as a narrow band around each line.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Proprietary online advertising system</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We validate our approach on an online advertising system of a large commercial company, by comparing the trained model’s accuracy, and the ad ranking latency. We perform our tests on FwFM models for <em class="ltx_emph ltx_font_italic" id="S5.SS3.p1.1.1">click-through rate</em> (CTR) prediction having 82 fields. To conform to the strict latency requirements, the FwFM’s field interaction matrix is pruned to retain only 10% of the largest magnitude entries.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.1. </span>Accuracy experiment</h4>
<div class="ltx_para" id="S5.SS3.SSS1.p1">
<p class="ltx_p" id="S5.SS3.SSS1.p1.3">The model trains periodically in a “sliding window” mode, meaning that in each period associated with time <math alttext="T" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p1.1.m1.1"><semantics id="S5.SS3.SSS1.p1.1.m1.1a"><mi id="S5.SS3.SSS1.p1.1.m1.1.1" xref="S5.SS3.SSS1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p1.1.m1.1b"><ci id="S5.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p1.1.m1.1d">italic_T</annotation></semantics></math>, the model is trained on logged data from the month before <math alttext="T" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p1.2.m2.1"><semantics id="S5.SS3.SSS1.p1.2.m2.1a"><mi id="S5.SS3.SSS1.p1.2.m2.1.1" xref="S5.SS3.SSS1.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p1.2.m2.1b"><ci id="S5.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S5.SS3.SSS1.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p1.2.m2.1d">italic_T</annotation></semantics></math>, and is evaluated on logged data from the day before <math alttext="T" class="ltx_Math" display="inline" id="S5.SS3.SSS1.p1.3.m3.1"><semantics id="S5.SS3.SSS1.p1.3.m3.1a"><mi id="S5.SS3.SSS1.p1.3.m3.1.1" xref="S5.SS3.SSS1.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS1.p1.3.m3.1b"><ci id="S5.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S5.SS3.SSS1.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS1.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS1.p1.3.m3.1d">italic_T</annotation></semantics></math>. After sub-sampling to allow training within a reasonable amount of time, the training set comprises tens of millions logged user-ad interactions. We train and evaluate the model on 7 consecutive intervals using the LogLoss and AUC metrics, and average the results by weighting them according to the number of evaluation samples. The trained DPLR model is compared to an FwFM pruned to 10% of the entries, due to various restrictions of the production code-base. The performance of the models, and the improvement of DPLR over pruned models, are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.T2" title="Table 2 ‣ 5.3.1. Accuracy experiment ‣ 5.3. Proprietary online advertising system ‣ 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a> Surprisingly, the DPLR models perform <em class="ltx_emph ltx_font_italic" id="S5.SS3.SSS1.p1.3.1">better</em> on the evaluation set than a regular FwFM models. We believe it means that a low-rank field interaction matrix is a good regularization prior for this specific domain. Nevertheless, as our results on public data-sets show, this is not the case in general.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.2.1.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S5.T2.3.2" style="font-size:90%;">AUC and LogLoss improvements versus an FwFM on proprietary data. Higher is better.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T2.4.1.1.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6" id="S5.T2.4.1.1.2">Rank</th>
</tr>
<tr class="ltx_tr" id="S5.T2.4.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T2.4.2.2.1"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.2">1</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.3">2</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.4">3</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.5">4</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.6">5</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S5.T2.4.2.2.7">6</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.4.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.4.3.1.1">LogLoss lift</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.4.3.1.2">-0.48%</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.4.3.1.3">0.23%</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.4.3.1.4">0.36%</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.4.3.1.5">0.41%</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.4.3.1.6">0.44%</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.4.3.1.7">0.404%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.4.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.4.4.2.1">AUC lift</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.4.4.2.2">-0.13%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.4.4.2.3">0.07%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.4.4.2.4">0.10%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.4.4.2.5">0.11%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.4.4.2.6">0.12%</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.4.4.2.7">0.115%</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.2. </span>Latency experiment</h4>
<div class="ltx_para" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.1">We deploy the model with rank 3 to a test environment that serves a small portion of the traffic, a few thousand ad ranking queries per minute. The rank was chosen to correspond to the pruning of 90% of the field interaction entries in terms of the number of parameters. Out of the model’s 63 fields, 38 are item fields, and therefore we can theoretically expect approximately <math alttext="40\%" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p1.1.m1.1"><semantics id="S5.SS3.SSS2.p1.1.m1.1a"><mrow id="S5.SS3.SSS2.p1.1.m1.1.1" xref="S5.SS3.SSS2.p1.1.m1.1.1.cmml"><mn id="S5.SS3.SSS2.p1.1.m1.1.1.2" xref="S5.SS3.SSS2.p1.1.m1.1.1.2.cmml">40</mn><mo id="S5.SS3.SSS2.p1.1.m1.1.1.1" xref="S5.SS3.SSS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p1.1.m1.1b"><apply id="S5.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS3.SSS2.p1.1.m1.1.1.1">percent</csymbol><cn id="S5.SS3.SSS2.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS3.SSS2.p1.1.m1.1.1.2">40</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p1.1.m1.1c">40\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p1.1.m1.1d">40 %</annotation></semantics></math> latency inference speed improvement in the best case.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p2">
<p class="ltx_p" id="S5.SS3.SSS2.p2.2">We measure the latency incurred by the inference for ad CTR prediction, and the total latency incurred by ranking all eligible ads for a given query. Table <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.T3" title="Table 3 ‣ 5.3.2. Latency experiment ‣ 5.3. Proprietary online advertising system ‣ 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> summarizes the results, and appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#A1" title="Appendix A Latency charts ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">A</span></a> presents full time-series plots. Evidently, the inference latency is improved by <math alttext="20\%-30\%" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p2.1.m1.1"><semantics id="S5.SS3.SSS2.p2.1.m1.1a"><mrow id="S5.SS3.SSS2.p2.1.m1.1.1" xref="S5.SS3.SSS2.p2.1.m1.1.1.cmml"><mrow id="S5.SS3.SSS2.p2.1.m1.1.1.2" xref="S5.SS3.SSS2.p2.1.m1.1.1.2.cmml"><mn id="S5.SS3.SSS2.p2.1.m1.1.1.2.2" xref="S5.SS3.SSS2.p2.1.m1.1.1.2.2.cmml">20</mn><mo id="S5.SS3.SSS2.p2.1.m1.1.1.2.1" xref="S5.SS3.SSS2.p2.1.m1.1.1.2.1.cmml">%</mo></mrow><mo id="S5.SS3.SSS2.p2.1.m1.1.1.1" xref="S5.SS3.SSS2.p2.1.m1.1.1.1.cmml">−</mo><mrow id="S5.SS3.SSS2.p2.1.m1.1.1.3" xref="S5.SS3.SSS2.p2.1.m1.1.1.3.cmml"><mn id="S5.SS3.SSS2.p2.1.m1.1.1.3.2" xref="S5.SS3.SSS2.p2.1.m1.1.1.3.2.cmml">30</mn><mo id="S5.SS3.SSS2.p2.1.m1.1.1.3.1" xref="S5.SS3.SSS2.p2.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p2.1.m1.1b"><apply id="S5.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1"><minus id="S5.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.1"></minus><apply id="S5.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.2"><csymbol cd="latexml" id="S5.SS3.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.2.1">percent</csymbol><cn id="S5.SS3.SSS2.p2.1.m1.1.1.2.2.cmml" type="integer" xref="S5.SS3.SSS2.p2.1.m1.1.1.2.2">20</cn></apply><apply id="S5.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.3"><csymbol cd="latexml" id="S5.SS3.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S5.SS3.SSS2.p2.1.m1.1.1.3.1">percent</csymbol><cn id="S5.SS3.SSS2.p2.1.m1.1.1.3.2.cmml" type="integer" xref="S5.SS3.SSS2.p2.1.m1.1.1.3.2">30</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p2.1.m1.1c">20\%-30\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p2.1.m1.1d">20 % - 30 %</annotation></semantics></math>, whereas the query latency by <math alttext="5\%" class="ltx_Math" display="inline" id="S5.SS3.SSS2.p2.2.m2.1"><semantics id="S5.SS3.SSS2.p2.2.m2.1a"><mrow id="S5.SS3.SSS2.p2.2.m2.1.1" xref="S5.SS3.SSS2.p2.2.m2.1.1.cmml"><mn id="S5.SS3.SSS2.p2.2.m2.1.1.2" xref="S5.SS3.SSS2.p2.2.m2.1.1.2.cmml">5</mn><mo id="S5.SS3.SSS2.p2.2.m2.1.1.1" xref="S5.SS3.SSS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS2.p2.2.m2.1b"><apply id="S5.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S5.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S5.SS3.SSS2.p2.2.m2.1.1.1">percent</csymbol><cn id="S5.SS3.SSS2.p2.2.m2.1.1.2.cmml" type="integer" xref="S5.SS3.SSS2.p2.2.m2.1.1.2">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS2.p2.2.m2.1c">5\%</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.SSS2.p2.2.m2.1d">5 %</annotation></semantics></math>, as CTR prediction is only one component of the ad query serving algorithm.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.2.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S5.T3.3.2" style="font-size:90%;">Average and high percentile latency of a single inference or ranking operation in our production system. In each minute, the average, 95th percentile, and the 99th percentile latency for inference, and the 95th percentile latency for ranking. The measurements were averaged over a 10 hour period. The lifts represent improvements - higher is better.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.4.1.1">
<td class="ltx_td ltx_border_tt" id="S5.T3.4.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T3.4.1.1.2">Inference per ad</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S5.T3.4.1.1.3">Ranking</th>
</tr>
<tr class="ltx_tr" id="S5.T3.4.2.2">
<td class="ltx_td" id="S5.T3.4.2.2.1"></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.4.2.2.2">Average</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.4.2.2.3">P95</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.4.2.2.4">P99</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T3.4.2.2.5">P95</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.3.3">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S5.T3.4.3.3.1">Lift (%)</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S5.T3.4.3.3.2">34.27%</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S5.T3.4.3.3.3">29.11%</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S5.T3.4.3.3.4">25.57%</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S5.T3.4.3.3.5">5.45%</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Post-hoc factorization of the field interaction matrix</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">An alternative approach to training a DPLR representation of the field interaction matrix can be training a regular FwFM model, and computing the best DPLR representation we can afterwards. We call this the “post-hoc” approach.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.7">Unfortunately, this may not be a good idea. Suppose we obtained an approximation <math alttext="\tilde{{\bm{R}}}" class="ltx_Math" display="inline" id="S5.SS4.p2.1.m1.1"><semantics id="S5.SS4.p2.1.m1.1a"><mover accent="true" id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml"><mi id="S5.SS4.p2.1.m1.1.1.2" xref="S5.SS4.p2.1.m1.1.1.2.cmml">𝑹</mi><mo id="S5.SS4.p2.1.m1.1.1.1" xref="S5.SS4.p2.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><apply id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1"><ci id="S5.SS4.p2.1.m1.1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1.1">~</ci><ci id="S5.SS4.p2.1.m1.1.1.2.cmml" xref="S5.SS4.p2.1.m1.1.1.2">𝑹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">\tilde{{\bm{R}}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.1.m1.1d">over~ start_ARG bold_italic_R end_ARG</annotation></semantics></math> of the model’s field interaction matrix <math alttext="{\bm{R}}" class="ltx_Math" display="inline" id="S5.SS4.p2.2.m2.1"><semantics id="S5.SS4.p2.2.m2.1a"><mi id="S5.SS4.p2.2.m2.1.1" xref="S5.SS4.p2.2.m2.1.1.cmml">𝑹</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><ci id="S5.SS4.p2.2.m2.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1">𝑹</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.2.m2.1c">{\bm{R}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.2.m2.1d">bold_italic_R</annotation></semantics></math>. Let <math alttext="\tilde{{\bm{R}}}={\bm{R}}+{\bm{E}}" class="ltx_Math" display="inline" id="S5.SS4.p2.3.m3.1"><semantics id="S5.SS4.p2.3.m3.1a"><mrow id="S5.SS4.p2.3.m3.1.1" xref="S5.SS4.p2.3.m3.1.1.cmml"><mover accent="true" id="S5.SS4.p2.3.m3.1.1.2" xref="S5.SS4.p2.3.m3.1.1.2.cmml"><mi id="S5.SS4.p2.3.m3.1.1.2.2" xref="S5.SS4.p2.3.m3.1.1.2.2.cmml">𝑹</mi><mo id="S5.SS4.p2.3.m3.1.1.2.1" xref="S5.SS4.p2.3.m3.1.1.2.1.cmml">~</mo></mover><mo id="S5.SS4.p2.3.m3.1.1.1" xref="S5.SS4.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S5.SS4.p2.3.m3.1.1.3" xref="S5.SS4.p2.3.m3.1.1.3.cmml"><mi id="S5.SS4.p2.3.m3.1.1.3.2" xref="S5.SS4.p2.3.m3.1.1.3.2.cmml">𝑹</mi><mo id="S5.SS4.p2.3.m3.1.1.3.1" xref="S5.SS4.p2.3.m3.1.1.3.1.cmml">+</mo><mi id="S5.SS4.p2.3.m3.1.1.3.3" xref="S5.SS4.p2.3.m3.1.1.3.3.cmml">𝑬</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.3.m3.1b"><apply id="S5.SS4.p2.3.m3.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1"><eq id="S5.SS4.p2.3.m3.1.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1.1"></eq><apply id="S5.SS4.p2.3.m3.1.1.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2"><ci id="S5.SS4.p2.3.m3.1.1.2.1.cmml" xref="S5.SS4.p2.3.m3.1.1.2.1">~</ci><ci id="S5.SS4.p2.3.m3.1.1.2.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2.2">𝑹</ci></apply><apply id="S5.SS4.p2.3.m3.1.1.3.cmml" xref="S5.SS4.p2.3.m3.1.1.3"><plus id="S5.SS4.p2.3.m3.1.1.3.1.cmml" xref="S5.SS4.p2.3.m3.1.1.3.1"></plus><ci id="S5.SS4.p2.3.m3.1.1.3.2.cmml" xref="S5.SS4.p2.3.m3.1.1.3.2">𝑹</ci><ci id="S5.SS4.p2.3.m3.1.1.3.3.cmml" xref="S5.SS4.p2.3.m3.1.1.3.3">𝑬</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.3.m3.1c">\tilde{{\bm{R}}}={\bm{R}}+{\bm{E}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.3.m3.1d">over~ start_ARG bold_italic_R end_ARG = bold_italic_R + bold_italic_E</annotation></semantics></math>, where <math alttext="{\bm{E}}" class="ltx_Math" display="inline" id="S5.SS4.p2.4.m4.1"><semantics id="S5.SS4.p2.4.m4.1a"><mi id="S5.SS4.p2.4.m4.1.1" xref="S5.SS4.p2.4.m4.1.1.cmml">𝑬</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.4.m4.1b"><ci id="S5.SS4.p2.4.m4.1.1.cmml" xref="S5.SS4.p2.4.m4.1.1">𝑬</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.4.m4.1c">{\bm{E}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.4.m4.1d">bold_italic_E</annotation></semantics></math> is the approximation error. Denote by <math alttext="\lambda_{i}(\cdot)" class="ltx_Math" display="inline" id="S5.SS4.p2.5.m5.1"><semantics id="S5.SS4.p2.5.m5.1a"><mrow id="S5.SS4.p2.5.m5.1.2" xref="S5.SS4.p2.5.m5.1.2.cmml"><msub id="S5.SS4.p2.5.m5.1.2.2" xref="S5.SS4.p2.5.m5.1.2.2.cmml"><mi id="S5.SS4.p2.5.m5.1.2.2.2" xref="S5.SS4.p2.5.m5.1.2.2.2.cmml">λ</mi><mi id="S5.SS4.p2.5.m5.1.2.2.3" xref="S5.SS4.p2.5.m5.1.2.2.3.cmml">i</mi></msub><mo id="S5.SS4.p2.5.m5.1.2.1" xref="S5.SS4.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S5.SS4.p2.5.m5.1.2.3.2" xref="S5.SS4.p2.5.m5.1.2.cmml"><mo id="S5.SS4.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S5.SS4.p2.5.m5.1.2.cmml">(</mo><mo id="S5.SS4.p2.5.m5.1.1" lspace="0em" rspace="0em" xref="S5.SS4.p2.5.m5.1.1.cmml">⋅</mo><mo id="S5.SS4.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S5.SS4.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.5.m5.1b"><apply id="S5.SS4.p2.5.m5.1.2.cmml" xref="S5.SS4.p2.5.m5.1.2"><times id="S5.SS4.p2.5.m5.1.2.1.cmml" xref="S5.SS4.p2.5.m5.1.2.1"></times><apply id="S5.SS4.p2.5.m5.1.2.2.cmml" xref="S5.SS4.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S5.SS4.p2.5.m5.1.2.2.1.cmml" xref="S5.SS4.p2.5.m5.1.2.2">subscript</csymbol><ci id="S5.SS4.p2.5.m5.1.2.2.2.cmml" xref="S5.SS4.p2.5.m5.1.2.2.2">𝜆</ci><ci id="S5.SS4.p2.5.m5.1.2.2.3.cmml" xref="S5.SS4.p2.5.m5.1.2.2.3">𝑖</ci></apply><ci id="S5.SS4.p2.5.m5.1.1.cmml" xref="S5.SS4.p2.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.5.m5.1c">\lambda_{i}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.5.m5.1d">italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> and <math alttext="\sigma_{i}(\cdot)" class="ltx_Math" display="inline" id="S5.SS4.p2.6.m6.1"><semantics id="S5.SS4.p2.6.m6.1a"><mrow id="S5.SS4.p2.6.m6.1.2" xref="S5.SS4.p2.6.m6.1.2.cmml"><msub id="S5.SS4.p2.6.m6.1.2.2" xref="S5.SS4.p2.6.m6.1.2.2.cmml"><mi id="S5.SS4.p2.6.m6.1.2.2.2" xref="S5.SS4.p2.6.m6.1.2.2.2.cmml">σ</mi><mi id="S5.SS4.p2.6.m6.1.2.2.3" xref="S5.SS4.p2.6.m6.1.2.2.3.cmml">i</mi></msub><mo id="S5.SS4.p2.6.m6.1.2.1" xref="S5.SS4.p2.6.m6.1.2.1.cmml">⁢</mo><mrow id="S5.SS4.p2.6.m6.1.2.3.2" xref="S5.SS4.p2.6.m6.1.2.cmml"><mo id="S5.SS4.p2.6.m6.1.2.3.2.1" stretchy="false" xref="S5.SS4.p2.6.m6.1.2.cmml">(</mo><mo id="S5.SS4.p2.6.m6.1.1" lspace="0em" rspace="0em" xref="S5.SS4.p2.6.m6.1.1.cmml">⋅</mo><mo id="S5.SS4.p2.6.m6.1.2.3.2.2" stretchy="false" xref="S5.SS4.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.6.m6.1b"><apply id="S5.SS4.p2.6.m6.1.2.cmml" xref="S5.SS4.p2.6.m6.1.2"><times id="S5.SS4.p2.6.m6.1.2.1.cmml" xref="S5.SS4.p2.6.m6.1.2.1"></times><apply id="S5.SS4.p2.6.m6.1.2.2.cmml" xref="S5.SS4.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S5.SS4.p2.6.m6.1.2.2.1.cmml" xref="S5.SS4.p2.6.m6.1.2.2">subscript</csymbol><ci id="S5.SS4.p2.6.m6.1.2.2.2.cmml" xref="S5.SS4.p2.6.m6.1.2.2.2">𝜎</ci><ci id="S5.SS4.p2.6.m6.1.2.2.3.cmml" xref="S5.SS4.p2.6.m6.1.2.2.3">𝑖</ci></apply><ci id="S5.SS4.p2.6.m6.1.1.cmml" xref="S5.SS4.p2.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.6.m6.1c">\sigma_{i}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.6.m6.1d">italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> the <math alttext="i^{\text{th}}" class="ltx_Math" display="inline" id="S5.SS4.p2.7.m7.1"><semantics id="S5.SS4.p2.7.m7.1a"><msup id="S5.SS4.p2.7.m7.1.1" xref="S5.SS4.p2.7.m7.1.1.cmml"><mi id="S5.SS4.p2.7.m7.1.1.2" xref="S5.SS4.p2.7.m7.1.1.2.cmml">i</mi><mtext id="S5.SS4.p2.7.m7.1.1.3" xref="S5.SS4.p2.7.m7.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.7.m7.1b"><apply id="S5.SS4.p2.7.m7.1.1.cmml" xref="S5.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.7.m7.1.1.1.cmml" xref="S5.SS4.p2.7.m7.1.1">superscript</csymbol><ci id="S5.SS4.p2.7.m7.1.1.2.cmml" xref="S5.SS4.p2.7.m7.1.1.2">𝑖</ci><ci id="S5.SS4.p2.7.m7.1.1.3a.cmml" xref="S5.SS4.p2.7.m7.1.1.3"><mtext id="S5.SS4.p2.7.m7.1.1.3.cmml" mathsize="70%" xref="S5.SS4.p2.7.m7.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.7.m7.1c">i^{\text{th}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.p2.7.m7.1d">italic_i start_POSTSUPERSCRIPT th end_POSTSUPERSCRIPT</annotation></semantics></math> largest eigenvalue and singular value of a given matrix, respectively. By Identity <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#Thmidentity1" title="Identity 1. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a> we obtain</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S5.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}%
\rangle\tilde{{R}}_{i,j}" class="ltx_Math" display="inline" id="S5.Ex15.m1.4"><semantics id="S5.Ex15.m1.4a"><mrow id="S5.Ex15.m1.4.4" xref="S5.Ex15.m1.4.4.cmml"><mstyle displaystyle="true" id="S5.Ex15.m1.4.4.3" xref="S5.Ex15.m1.4.4.3.cmml"><munderover id="S5.Ex15.m1.4.4.3a" xref="S5.Ex15.m1.4.4.3.cmml"><mo id="S5.Ex15.m1.4.4.3.2.2" movablelimits="false" xref="S5.Ex15.m1.4.4.3.2.2.cmml">∑</mo><mrow id="S5.Ex15.m1.4.4.3.2.3" xref="S5.Ex15.m1.4.4.3.2.3.cmml"><mi id="S5.Ex15.m1.4.4.3.2.3.2" xref="S5.Ex15.m1.4.4.3.2.3.2.cmml">i</mi><mo id="S5.Ex15.m1.4.4.3.2.3.1" xref="S5.Ex15.m1.4.4.3.2.3.1.cmml">=</mo><mn id="S5.Ex15.m1.4.4.3.2.3.3" xref="S5.Ex15.m1.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex15.m1.4.4.3.3" xref="S5.Ex15.m1.4.4.3.3.cmml">m</mi></munderover></mstyle><mrow id="S5.Ex15.m1.4.4.2" xref="S5.Ex15.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S5.Ex15.m1.4.4.2.3" xref="S5.Ex15.m1.4.4.2.3.cmml"><munderover id="S5.Ex15.m1.4.4.2.3a" xref="S5.Ex15.m1.4.4.2.3.cmml"><mo id="S5.Ex15.m1.4.4.2.3.2.2" movablelimits="false" xref="S5.Ex15.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S5.Ex15.m1.4.4.2.3.2.3" xref="S5.Ex15.m1.4.4.2.3.2.3.cmml"><mi id="S5.Ex15.m1.4.4.2.3.2.3.2" xref="S5.Ex15.m1.4.4.2.3.2.3.2.cmml">j</mi><mo id="S5.Ex15.m1.4.4.2.3.2.3.1" xref="S5.Ex15.m1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S5.Ex15.m1.4.4.2.3.2.3.3" xref="S5.Ex15.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex15.m1.4.4.2.3.3" xref="S5.Ex15.m1.4.4.2.3.3.cmml">m</mi></munderover></mstyle><mrow id="S5.Ex15.m1.4.4.2.2" xref="S5.Ex15.m1.4.4.2.2.cmml"><mrow id="S5.Ex15.m1.4.4.2.2.2.2" xref="S5.Ex15.m1.4.4.2.2.2.3.cmml"><mo id="S5.Ex15.m1.4.4.2.2.2.2.3" stretchy="false" xref="S5.Ex15.m1.4.4.2.2.2.3.cmml">⟨</mo><msub id="S5.Ex15.m1.3.3.1.1.1.1.1" xref="S5.Ex15.m1.3.3.1.1.1.1.1.cmml"><mi id="S5.Ex15.m1.3.3.1.1.1.1.1.2" xref="S5.Ex15.m1.3.3.1.1.1.1.1.2.cmml">𝒗</mi><mi id="S5.Ex15.m1.3.3.1.1.1.1.1.3" xref="S5.Ex15.m1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S5.Ex15.m1.4.4.2.2.2.2.4" xref="S5.Ex15.m1.4.4.2.2.2.3.cmml">,</mo><msub id="S5.Ex15.m1.4.4.2.2.2.2.2" xref="S5.Ex15.m1.4.4.2.2.2.2.2.cmml"><mi id="S5.Ex15.m1.4.4.2.2.2.2.2.2" xref="S5.Ex15.m1.4.4.2.2.2.2.2.2.cmml">𝒗</mi><mi id="S5.Ex15.m1.4.4.2.2.2.2.2.3" xref="S5.Ex15.m1.4.4.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S5.Ex15.m1.4.4.2.2.2.2.5" stretchy="false" xref="S5.Ex15.m1.4.4.2.2.2.3.cmml">⟩</mo></mrow><mo id="S5.Ex15.m1.4.4.2.2.3" xref="S5.Ex15.m1.4.4.2.2.3.cmml">⁢</mo><msub id="S5.Ex15.m1.4.4.2.2.4" xref="S5.Ex15.m1.4.4.2.2.4.cmml"><mover accent="true" id="S5.Ex15.m1.4.4.2.2.4.2" xref="S5.Ex15.m1.4.4.2.2.4.2.cmml"><mi id="S5.Ex15.m1.4.4.2.2.4.2.2" xref="S5.Ex15.m1.4.4.2.2.4.2.2.cmml">R</mi><mo id="S5.Ex15.m1.4.4.2.2.4.2.1" xref="S5.Ex15.m1.4.4.2.2.4.2.1.cmml">~</mo></mover><mrow id="S5.Ex15.m1.2.2.2.4" xref="S5.Ex15.m1.2.2.2.3.cmml"><mi id="S5.Ex15.m1.1.1.1.1" xref="S5.Ex15.m1.1.1.1.1.cmml">i</mi><mo id="S5.Ex15.m1.2.2.2.4.1" xref="S5.Ex15.m1.2.2.2.3.cmml">,</mo><mi id="S5.Ex15.m1.2.2.2.2" xref="S5.Ex15.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex15.m1.4b"><apply id="S5.Ex15.m1.4.4.cmml" xref="S5.Ex15.m1.4.4"><apply id="S5.Ex15.m1.4.4.3.cmml" xref="S5.Ex15.m1.4.4.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.4.4.3.1.cmml" xref="S5.Ex15.m1.4.4.3">superscript</csymbol><apply id="S5.Ex15.m1.4.4.3.2.cmml" xref="S5.Ex15.m1.4.4.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.4.4.3.2.1.cmml" xref="S5.Ex15.m1.4.4.3">subscript</csymbol><sum id="S5.Ex15.m1.4.4.3.2.2.cmml" xref="S5.Ex15.m1.4.4.3.2.2"></sum><apply id="S5.Ex15.m1.4.4.3.2.3.cmml" xref="S5.Ex15.m1.4.4.3.2.3"><eq id="S5.Ex15.m1.4.4.3.2.3.1.cmml" xref="S5.Ex15.m1.4.4.3.2.3.1"></eq><ci id="S5.Ex15.m1.4.4.3.2.3.2.cmml" xref="S5.Ex15.m1.4.4.3.2.3.2">𝑖</ci><cn id="S5.Ex15.m1.4.4.3.2.3.3.cmml" type="integer" xref="S5.Ex15.m1.4.4.3.2.3.3">1</cn></apply></apply><ci id="S5.Ex15.m1.4.4.3.3.cmml" xref="S5.Ex15.m1.4.4.3.3">𝑚</ci></apply><apply id="S5.Ex15.m1.4.4.2.cmml" xref="S5.Ex15.m1.4.4.2"><apply id="S5.Ex15.m1.4.4.2.3.cmml" xref="S5.Ex15.m1.4.4.2.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.4.4.2.3.1.cmml" xref="S5.Ex15.m1.4.4.2.3">superscript</csymbol><apply id="S5.Ex15.m1.4.4.2.3.2.cmml" xref="S5.Ex15.m1.4.4.2.3"><csymbol cd="ambiguous" id="S5.Ex15.m1.4.4.2.3.2.1.cmml" xref="S5.Ex15.m1.4.4.2.3">subscript</csymbol><sum id="S5.Ex15.m1.4.4.2.3.2.2.cmml" xref="S5.Ex15.m1.4.4.2.3.2.2"></sum><apply id="S5.Ex15.m1.4.4.2.3.2.3.cmml" xref="S5.Ex15.m1.4.4.2.3.2.3"><eq id="S5.Ex15.m1.4.4.2.3.2.3.1.cmml" xref="S5.Ex15.m1.4.4.2.3.2.3.1"></eq><ci id="S5.Ex15.m1.4.4.2.3.2.3.2.cmml" xref="S5.Ex15.m1.4.4.2.3.2.3.2">𝑗</ci><cn id="S5.Ex15.m1.4.4.2.3.2.3.3.cmml" type="integer" xref="S5.Ex15.m1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S5.Ex15.m1.4.4.2.3.3.cmml" xref="S5.Ex15.m1.4.4.2.3.3">𝑚</ci></apply><apply id="S5.Ex15.m1.4.4.2.2.cmml" xref="S5.Ex15.m1.4.4.2.2"><times id="S5.Ex15.m1.4.4.2.2.3.cmml" xref="S5.Ex15.m1.4.4.2.2.3"></times><list id="S5.Ex15.m1.4.4.2.2.2.3.cmml" xref="S5.Ex15.m1.4.4.2.2.2.2"><apply id="S5.Ex15.m1.3.3.1.1.1.1.1.cmml" xref="S5.Ex15.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.Ex15.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.Ex15.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S5.Ex15.m1.3.3.1.1.1.1.1.2.cmml" xref="S5.Ex15.m1.3.3.1.1.1.1.1.2">𝒗</ci><ci id="S5.Ex15.m1.3.3.1.1.1.1.1.3.cmml" xref="S5.Ex15.m1.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S5.Ex15.m1.4.4.2.2.2.2.2.cmml" xref="S5.Ex15.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S5.Ex15.m1.4.4.2.2.2.2.2.1.cmml" xref="S5.Ex15.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S5.Ex15.m1.4.4.2.2.2.2.2.2.cmml" xref="S5.Ex15.m1.4.4.2.2.2.2.2.2">𝒗</ci><ci id="S5.Ex15.m1.4.4.2.2.2.2.2.3.cmml" xref="S5.Ex15.m1.4.4.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S5.Ex15.m1.4.4.2.2.4.cmml" xref="S5.Ex15.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S5.Ex15.m1.4.4.2.2.4.1.cmml" xref="S5.Ex15.m1.4.4.2.2.4">subscript</csymbol><apply id="S5.Ex15.m1.4.4.2.2.4.2.cmml" xref="S5.Ex15.m1.4.4.2.2.4.2"><ci id="S5.Ex15.m1.4.4.2.2.4.2.1.cmml" xref="S5.Ex15.m1.4.4.2.2.4.2.1">~</ci><ci id="S5.Ex15.m1.4.4.2.2.4.2.2.cmml" xref="S5.Ex15.m1.4.4.2.2.4.2.2">𝑅</ci></apply><list id="S5.Ex15.m1.2.2.2.3.cmml" xref="S5.Ex15.m1.2.2.2.4"><ci id="S5.Ex15.m1.1.1.1.1.cmml" xref="S5.Ex15.m1.1.1.1.1">𝑖</ci><ci id="S5.Ex15.m1.2.2.2.2.cmml" xref="S5.Ex15.m1.2.2.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex15.m1.4c">\displaystyle\sum_{i=1}^{m}\sum_{j=1}^{m}\langle{\bm{v}}_{i},{\bm{v}}_{j}%
\rangle\tilde{{R}}_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S5.Ex15.m1.4d">∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT ⟨ bold_italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ⟩ over~ start_ARG italic_R end_ARG start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tr}({\bm{V}}^{T}\tilde{{\bm{R}}}{\bm{V}})" class="ltx_Math" display="inline" id="S5.Ex15.m2.2"><semantics id="S5.Ex15.m2.2a"><mrow id="S5.Ex15.m2.2.2" xref="S5.Ex15.m2.2.2.cmml"><mi id="S5.Ex15.m2.2.2.3" xref="S5.Ex15.m2.2.2.3.cmml"></mi><mo id="S5.Ex15.m2.2.2.2" xref="S5.Ex15.m2.2.2.2.cmml">=</mo><mrow id="S5.Ex15.m2.2.2.1.1" xref="S5.Ex15.m2.2.2.1.2.cmml"><mi id="S5.Ex15.m2.1.1" xref="S5.Ex15.m2.1.1.cmml">Tr</mi><mo id="S5.Ex15.m2.2.2.1.1a" xref="S5.Ex15.m2.2.2.1.2.cmml">⁡</mo><mrow id="S5.Ex15.m2.2.2.1.1.1" xref="S5.Ex15.m2.2.2.1.2.cmml"><mo id="S5.Ex15.m2.2.2.1.1.1.2" stretchy="false" xref="S5.Ex15.m2.2.2.1.2.cmml">(</mo><mrow id="S5.Ex15.m2.2.2.1.1.1.1" xref="S5.Ex15.m2.2.2.1.1.1.1.cmml"><msup id="S5.Ex15.m2.2.2.1.1.1.1.2" xref="S5.Ex15.m2.2.2.1.1.1.1.2.cmml"><mi id="S5.Ex15.m2.2.2.1.1.1.1.2.2" xref="S5.Ex15.m2.2.2.1.1.1.1.2.2.cmml">𝑽</mi><mi id="S5.Ex15.m2.2.2.1.1.1.1.2.3" xref="S5.Ex15.m2.2.2.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S5.Ex15.m2.2.2.1.1.1.1.1" xref="S5.Ex15.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mover accent="true" id="S5.Ex15.m2.2.2.1.1.1.1.3" xref="S5.Ex15.m2.2.2.1.1.1.1.3.cmml"><mi id="S5.Ex15.m2.2.2.1.1.1.1.3.2" xref="S5.Ex15.m2.2.2.1.1.1.1.3.2.cmml">𝑹</mi><mo id="S5.Ex15.m2.2.2.1.1.1.1.3.1" xref="S5.Ex15.m2.2.2.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S5.Ex15.m2.2.2.1.1.1.1.1a" xref="S5.Ex15.m2.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex15.m2.2.2.1.1.1.1.4" xref="S5.Ex15.m2.2.2.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S5.Ex15.m2.2.2.1.1.1.3" stretchy="false" xref="S5.Ex15.m2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex15.m2.2b"><apply id="S5.Ex15.m2.2.2.cmml" xref="S5.Ex15.m2.2.2"><eq id="S5.Ex15.m2.2.2.2.cmml" xref="S5.Ex15.m2.2.2.2"></eq><csymbol cd="latexml" id="S5.Ex15.m2.2.2.3.cmml" xref="S5.Ex15.m2.2.2.3">absent</csymbol><apply id="S5.Ex15.m2.2.2.1.2.cmml" xref="S5.Ex15.m2.2.2.1.1"><ci id="S5.Ex15.m2.1.1.cmml" xref="S5.Ex15.m2.1.1">Tr</ci><apply id="S5.Ex15.m2.2.2.1.1.1.1.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1"><times id="S5.Ex15.m2.2.2.1.1.1.1.1.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.1"></times><apply id="S5.Ex15.m2.2.2.1.1.1.1.2.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex15.m2.2.2.1.1.1.1.2.1.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.2">superscript</csymbol><ci id="S5.Ex15.m2.2.2.1.1.1.1.2.2.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.2.2">𝑽</ci><ci id="S5.Ex15.m2.2.2.1.1.1.1.2.3.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="S5.Ex15.m2.2.2.1.1.1.1.3.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.3"><ci id="S5.Ex15.m2.2.2.1.1.1.1.3.1.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.3.1">~</ci><ci id="S5.Ex15.m2.2.2.1.1.1.1.3.2.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.3.2">𝑹</ci></apply><ci id="S5.Ex15.m2.2.2.1.1.1.1.4.cmml" xref="S5.Ex15.m2.2.2.1.1.1.1.4">𝑽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex15.m2.2c">\displaystyle=\operatorname{Tr}({\bm{V}}^{T}\tilde{{\bm{R}}}{\bm{V}})</annotation><annotation encoding="application/x-llamapun" id="S5.Ex15.m2.2d">= roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT over~ start_ARG bold_italic_R end_ARG bold_italic_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Tr}({\bm{V}}^{T}{\bm{R}}{\bm{V}})+\operatorname{Tr%
}({\bm{V}}^{T}{\bm{E}}{\bm{V}})" class="ltx_Math" display="inline" id="S5.Ex16.m1.4"><semantics id="S5.Ex16.m1.4a"><mrow id="S5.Ex16.m1.4.4" xref="S5.Ex16.m1.4.4.cmml"><mi id="S5.Ex16.m1.4.4.4" xref="S5.Ex16.m1.4.4.4.cmml"></mi><mo id="S5.Ex16.m1.4.4.3" xref="S5.Ex16.m1.4.4.3.cmml">=</mo><mrow id="S5.Ex16.m1.4.4.2" xref="S5.Ex16.m1.4.4.2.cmml"><mrow id="S5.Ex16.m1.3.3.1.1.1" xref="S5.Ex16.m1.3.3.1.1.2.cmml"><mi id="S5.Ex16.m1.1.1" xref="S5.Ex16.m1.1.1.cmml">Tr</mi><mo id="S5.Ex16.m1.3.3.1.1.1a" xref="S5.Ex16.m1.3.3.1.1.2.cmml">⁡</mo><mrow id="S5.Ex16.m1.3.3.1.1.1.1" xref="S5.Ex16.m1.3.3.1.1.2.cmml"><mo id="S5.Ex16.m1.3.3.1.1.1.1.2" stretchy="false" xref="S5.Ex16.m1.3.3.1.1.2.cmml">(</mo><mrow id="S5.Ex16.m1.3.3.1.1.1.1.1" xref="S5.Ex16.m1.3.3.1.1.1.1.1.cmml"><msup id="S5.Ex16.m1.3.3.1.1.1.1.1.2" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S5.Ex16.m1.3.3.1.1.1.1.1.2.2" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2.2.cmml">𝑽</mi><mi id="S5.Ex16.m1.3.3.1.1.1.1.1.2.3" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S5.Ex16.m1.3.3.1.1.1.1.1.1" xref="S5.Ex16.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex16.m1.3.3.1.1.1.1.1.3" xref="S5.Ex16.m1.3.3.1.1.1.1.1.3.cmml">𝑹</mi><mo id="S5.Ex16.m1.3.3.1.1.1.1.1.1a" xref="S5.Ex16.m1.3.3.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex16.m1.3.3.1.1.1.1.1.4" xref="S5.Ex16.m1.3.3.1.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S5.Ex16.m1.3.3.1.1.1.1.3" stretchy="false" xref="S5.Ex16.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.Ex16.m1.4.4.2.3" xref="S5.Ex16.m1.4.4.2.3.cmml">+</mo><mrow id="S5.Ex16.m1.4.4.2.2.1" xref="S5.Ex16.m1.4.4.2.2.2.cmml"><mi id="S5.Ex16.m1.2.2" xref="S5.Ex16.m1.2.2.cmml">Tr</mi><mo id="S5.Ex16.m1.4.4.2.2.1a" xref="S5.Ex16.m1.4.4.2.2.2.cmml">⁡</mo><mrow id="S5.Ex16.m1.4.4.2.2.1.1" xref="S5.Ex16.m1.4.4.2.2.2.cmml"><mo id="S5.Ex16.m1.4.4.2.2.1.1.2" stretchy="false" xref="S5.Ex16.m1.4.4.2.2.2.cmml">(</mo><mrow id="S5.Ex16.m1.4.4.2.2.1.1.1" xref="S5.Ex16.m1.4.4.2.2.1.1.1.cmml"><msup id="S5.Ex16.m1.4.4.2.2.1.1.1.2" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2.cmml"><mi id="S5.Ex16.m1.4.4.2.2.1.1.1.2.2" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2.2.cmml">𝑽</mi><mi id="S5.Ex16.m1.4.4.2.2.1.1.1.2.3" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2.3.cmml">T</mi></msup><mo id="S5.Ex16.m1.4.4.2.2.1.1.1.1" xref="S5.Ex16.m1.4.4.2.2.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex16.m1.4.4.2.2.1.1.1.3" xref="S5.Ex16.m1.4.4.2.2.1.1.1.3.cmml">𝑬</mi><mo id="S5.Ex16.m1.4.4.2.2.1.1.1.1a" xref="S5.Ex16.m1.4.4.2.2.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex16.m1.4.4.2.2.1.1.1.4" xref="S5.Ex16.m1.4.4.2.2.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S5.Ex16.m1.4.4.2.2.1.1.3" stretchy="false" xref="S5.Ex16.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex16.m1.4b"><apply id="S5.Ex16.m1.4.4.cmml" xref="S5.Ex16.m1.4.4"><eq id="S5.Ex16.m1.4.4.3.cmml" xref="S5.Ex16.m1.4.4.3"></eq><csymbol cd="latexml" id="S5.Ex16.m1.4.4.4.cmml" xref="S5.Ex16.m1.4.4.4">absent</csymbol><apply id="S5.Ex16.m1.4.4.2.cmml" xref="S5.Ex16.m1.4.4.2"><plus id="S5.Ex16.m1.4.4.2.3.cmml" xref="S5.Ex16.m1.4.4.2.3"></plus><apply id="S5.Ex16.m1.3.3.1.1.2.cmml" xref="S5.Ex16.m1.3.3.1.1.1"><ci id="S5.Ex16.m1.1.1.cmml" xref="S5.Ex16.m1.1.1">Tr</ci><apply id="S5.Ex16.m1.3.3.1.1.1.1.1.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1"><times id="S5.Ex16.m1.3.3.1.1.1.1.1.1.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.1"></times><apply id="S5.Ex16.m1.3.3.1.1.1.1.1.2.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex16.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2">superscript</csymbol><ci id="S5.Ex16.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2.2">𝑽</ci><ci id="S5.Ex16.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S5.Ex16.m1.3.3.1.1.1.1.1.3.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.3">𝑹</ci><ci id="S5.Ex16.m1.3.3.1.1.1.1.1.4.cmml" xref="S5.Ex16.m1.3.3.1.1.1.1.1.4">𝑽</ci></apply></apply><apply id="S5.Ex16.m1.4.4.2.2.2.cmml" xref="S5.Ex16.m1.4.4.2.2.1"><ci id="S5.Ex16.m1.2.2.cmml" xref="S5.Ex16.m1.2.2">Tr</ci><apply id="S5.Ex16.m1.4.4.2.2.1.1.1.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1"><times id="S5.Ex16.m1.4.4.2.2.1.1.1.1.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.1"></times><apply id="S5.Ex16.m1.4.4.2.2.1.1.1.2.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex16.m1.4.4.2.2.1.1.1.2.1.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2">superscript</csymbol><ci id="S5.Ex16.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2.2">𝑽</ci><ci id="S5.Ex16.m1.4.4.2.2.1.1.1.2.3.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.2.3">𝑇</ci></apply><ci id="S5.Ex16.m1.4.4.2.2.1.1.1.3.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.3">𝑬</ci><ci id="S5.Ex16.m1.4.4.2.2.1.1.1.4.cmml" xref="S5.Ex16.m1.4.4.2.2.1.1.1.4">𝑽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex16.m1.4c">\displaystyle=\operatorname{Tr}({\bm{V}}^{T}{\bm{R}}{\bm{V}})+\operatorname{Tr%
}({\bm{V}}^{T}{\bm{E}}{\bm{V}})</annotation><annotation encoding="application/x-llamapun" id="S5.Ex16.m1.4d">= roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_R bold_italic_V ) + roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_E bold_italic_V )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S5.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\leq\operatorname{Tr}({\bm{V}}^{T}{\bm{R}}{\bm{V}})+\sum_{i=1}^{m%
}\lambda_{i}({\bm{V}}{\bm{V}}^{T})\sigma_{i}({\bm{E}})," class="ltx_Math" display="inline" id="S5.Ex17.m1.3"><semantics id="S5.Ex17.m1.3a"><mrow id="S5.Ex17.m1.3.3.1" xref="S5.Ex17.m1.3.3.1.1.cmml"><mrow id="S5.Ex17.m1.3.3.1.1" xref="S5.Ex17.m1.3.3.1.1.cmml"><mi id="S5.Ex17.m1.3.3.1.1.4" xref="S5.Ex17.m1.3.3.1.1.4.cmml"></mi><mo id="S5.Ex17.m1.3.3.1.1.3" xref="S5.Ex17.m1.3.3.1.1.3.cmml">≤</mo><mrow id="S5.Ex17.m1.3.3.1.1.2" xref="S5.Ex17.m1.3.3.1.1.2.cmml"><mrow id="S5.Ex17.m1.3.3.1.1.1.1.1" xref="S5.Ex17.m1.3.3.1.1.1.1.2.cmml"><mi id="S5.Ex17.m1.1.1" xref="S5.Ex17.m1.1.1.cmml">Tr</mi><mo id="S5.Ex17.m1.3.3.1.1.1.1.1a" xref="S5.Ex17.m1.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="S5.Ex17.m1.3.3.1.1.1.1.1.1" xref="S5.Ex17.m1.3.3.1.1.1.1.2.cmml"><mo id="S5.Ex17.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S5.Ex17.m1.3.3.1.1.1.1.2.cmml">(</mo><mrow id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.cmml"><msup id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">𝑽</mi><mi id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.1" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.3" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.3.cmml">𝑹</mi><mo id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.1a" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.4" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.4.cmml">𝑽</mi></mrow><mo id="S5.Ex17.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S5.Ex17.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.Ex17.m1.3.3.1.1.2.3" xref="S5.Ex17.m1.3.3.1.1.2.3.cmml">+</mo><mrow id="S5.Ex17.m1.3.3.1.1.2.2" xref="S5.Ex17.m1.3.3.1.1.2.2.cmml"><mstyle displaystyle="true" id="S5.Ex17.m1.3.3.1.1.2.2.2" xref="S5.Ex17.m1.3.3.1.1.2.2.2.cmml"><munderover id="S5.Ex17.m1.3.3.1.1.2.2.2a" xref="S5.Ex17.m1.3.3.1.1.2.2.2.cmml"><mo id="S5.Ex17.m1.3.3.1.1.2.2.2.2.2" movablelimits="false" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.2.cmml">∑</mo><mrow id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.cmml"><mi id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.2" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.2.cmml">i</mi><mo id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.1" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.1.cmml">=</mo><mn id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.3" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S5.Ex17.m1.3.3.1.1.2.2.2.3" xref="S5.Ex17.m1.3.3.1.1.2.2.2.3.cmml">m</mi></munderover></mstyle><mrow id="S5.Ex17.m1.3.3.1.1.2.2.1" xref="S5.Ex17.m1.3.3.1.1.2.2.1.cmml"><msub id="S5.Ex17.m1.3.3.1.1.2.2.1.3" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3.cmml"><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.3.2" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3.2.cmml">λ</mi><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.3.3" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3.3.cmml">i</mi></msub><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.2" xref="S5.Ex17.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.2" stretchy="false" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.cmml"><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.2" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.2.cmml">𝑽</mi><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">⁢</mo><msup id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.cmml"><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.2" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.2.cmml">𝑽</mi><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.3" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.3.cmml">T</mi></msup></mrow><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.3" stretchy="false" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.2a" xref="S5.Ex17.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><msub id="S5.Ex17.m1.3.3.1.1.2.2.1.4" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4.cmml"><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.4.2" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4.2.cmml">σ</mi><mi id="S5.Ex17.m1.3.3.1.1.2.2.1.4.3" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4.3.cmml">i</mi></msub><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.2b" xref="S5.Ex17.m1.3.3.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S5.Ex17.m1.3.3.1.1.2.2.1.5.2" xref="S5.Ex17.m1.3.3.1.1.2.2.1.cmml"><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.5.2.1" stretchy="false" xref="S5.Ex17.m1.3.3.1.1.2.2.1.cmml">(</mo><mi id="S5.Ex17.m1.2.2" xref="S5.Ex17.m1.2.2.cmml">𝑬</mi><mo id="S5.Ex17.m1.3.3.1.1.2.2.1.5.2.2" stretchy="false" xref="S5.Ex17.m1.3.3.1.1.2.2.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S5.Ex17.m1.3.3.1.2" xref="S5.Ex17.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.Ex17.m1.3b"><apply id="S5.Ex17.m1.3.3.1.1.cmml" xref="S5.Ex17.m1.3.3.1"><leq id="S5.Ex17.m1.3.3.1.1.3.cmml" xref="S5.Ex17.m1.3.3.1.1.3"></leq><csymbol cd="latexml" id="S5.Ex17.m1.3.3.1.1.4.cmml" xref="S5.Ex17.m1.3.3.1.1.4">absent</csymbol><apply id="S5.Ex17.m1.3.3.1.1.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2"><plus id="S5.Ex17.m1.3.3.1.1.2.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.3"></plus><apply id="S5.Ex17.m1.3.3.1.1.1.1.2.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1"><ci id="S5.Ex17.m1.1.1.cmml" xref="S5.Ex17.m1.1.1">Tr</ci><apply id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1"><times id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.1"></times><apply id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.2">𝑽</ci><ci id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.3">𝑹</ci><ci id="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S5.Ex17.m1.3.3.1.1.1.1.1.1.1.4">𝑽</ci></apply></apply><apply id="S5.Ex17.m1.3.3.1.1.2.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2"><apply id="S5.Ex17.m1.3.3.1.1.2.2.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.3.3.1.1.2.2.2.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="S5.Ex17.m1.3.3.1.1.2.2.2.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.Ex17.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2">subscript</csymbol><sum id="S5.Ex17.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.2"></sum><apply id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3"><eq id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.1"></eq><ci id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.2">𝑖</ci><cn id="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S5.Ex17.m1.3.3.1.1.2.2.2.2.3.3">1</cn></apply></apply><ci id="S5.Ex17.m1.3.3.1.1.2.2.2.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.2.3">𝑚</ci></apply><apply id="S5.Ex17.m1.3.3.1.1.2.2.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1"><times id="S5.Ex17.m1.3.3.1.1.2.2.1.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.2"></times><apply id="S5.Ex17.m1.3.3.1.1.2.2.1.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S5.Ex17.m1.3.3.1.1.2.2.1.3.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3">subscript</csymbol><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.3.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3.2">𝜆</ci><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.3.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.3.3">𝑖</ci></apply><apply id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1"><times id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.1"></times><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.2">𝑽</ci><apply id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3">superscript</csymbol><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.2">𝑽</ci><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.1.1.1.3.3">𝑇</ci></apply></apply><apply id="S5.Ex17.m1.3.3.1.1.2.2.1.4.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4"><csymbol cd="ambiguous" id="S5.Ex17.m1.3.3.1.1.2.2.1.4.1.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4">subscript</csymbol><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.4.2.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4.2">𝜎</ci><ci id="S5.Ex17.m1.3.3.1.1.2.2.1.4.3.cmml" xref="S5.Ex17.m1.3.3.1.1.2.2.1.4.3">𝑖</ci></apply><ci id="S5.Ex17.m1.2.2.cmml" xref="S5.Ex17.m1.2.2">𝑬</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.Ex17.m1.3c">\displaystyle\leq\operatorname{Tr}({\bm{V}}^{T}{\bm{R}}{\bm{V}})+\sum_{i=1}^{m%
}\lambda_{i}({\bm{V}}{\bm{V}}^{T})\sigma_{i}({\bm{E}}),</annotation><annotation encoding="application/x-llamapun" id="S5.Ex17.m1.3d">≤ roman_Tr ( bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_R bold_italic_V ) + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_V bold_italic_V start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ) italic_σ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( bold_italic_E ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S5.SS4.p2.8">where the last inequality stems from the Von Neumann trace inequality. Thus, the approximation error boils down to the singular value spectrum of the error matrix. We took the field interaction weights obtained from an FwFM trained on the Criteo data-set, and computed the singular value spectrum of the approximation errors obtained from two approximations: (a) a DPLR approximation of rank 5, computed by minimizing the nuclear norm of the error, and (b) a pruned field interaction matrix where the top 200 entries (same number of parameters as the rank-5 DPLR approximation) were left. The error singular-value spectrum of both approximations is plotted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S5.F2" title="Figure 2 ‣ 5.4. Post-hoc factorization of the field interaction matrix ‣ 5. Experiments ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. We observe that the large eigenvalues of the post-hoc DPLR approximation error are <em class="ltx_emph ltx_font_italic" id="S5.SS4.p2.8.1">much</em> larger than the ones of the pruned approximation error. Of course, an upper bound cannot replace a true experimental result on the given dataset, but it gives a rough idea of weather this direction is worth pursuing.</p>
</div>
<figure class="ltx_figure" id="S5.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="286" id="S5.F2.g1" src="extracted/5747578/error_spectrum.png" width="449"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S5.F2.3.2" style="font-size:90%;">Singular value spectrum of two approximations of the true field interaction matrix. The singular value index is in the horizontal axis, whereas its value is in the verical axis.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusions and future work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work we proposed learning a diagonal plus low-rank decomposition of the field interaction matrix of FwFM models as an alternative to the commonly used pruning heuristic in large scale low-latency recommendation systems. We demonstrated that our approach has the potential to outperform pruned models in in terms of both item recommendation speed and model accuracy.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.3">Looking at Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#S4.E9" title="In Proposition 0. ‣ 4.1. Mathematical foundation ‣ 4. Low-rank field-weighted factorization machines ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>), we observe that the columns of <math alttext="{\bm{U}}" class="ltx_Math" display="inline" id="S6.p2.1.m1.1"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">𝑼</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">𝑼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">{\bm{U}}</annotation><annotation encoding="application/x-llamapun" id="S6.p2.1.m1.1d">bold_italic_U</annotation></semantics></math> have a notion of “field importance” - if all the entries of <math alttext="{\bm{U}}_{:,i}" class="ltx_Math" display="inline" id="S6.p2.2.m2.2"><semantics id="S6.p2.2.m2.2a"><msub id="S6.p2.2.m2.2.3" xref="S6.p2.2.m2.2.3.cmml"><mi id="S6.p2.2.m2.2.3.2" xref="S6.p2.2.m2.2.3.2.cmml">𝑼</mi><mrow id="S6.p2.2.m2.2.2.2.4" xref="S6.p2.2.m2.2.2.2.3.cmml"><mo id="S6.p2.2.m2.1.1.1.1" rspace="0em" xref="S6.p2.2.m2.1.1.1.1.cmml">:</mo><mo id="S6.p2.2.m2.2.2.2.4.1" xref="S6.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S6.p2.2.m2.2.2.2.2" xref="S6.p2.2.m2.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.p2.2.m2.2b"><apply id="S6.p2.2.m2.2.3.cmml" xref="S6.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S6.p2.2.m2.2.3.1.cmml" xref="S6.p2.2.m2.2.3">subscript</csymbol><ci id="S6.p2.2.m2.2.3.2.cmml" xref="S6.p2.2.m2.2.3.2">𝑼</ci><list id="S6.p2.2.m2.2.2.2.3.cmml" xref="S6.p2.2.m2.2.2.2.4"><ci id="S6.p2.2.m2.1.1.1.1.cmml" xref="S6.p2.2.m2.1.1.1.1">:</ci><ci id="S6.p2.2.m2.2.2.2.2.cmml" xref="S6.p2.2.m2.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.2.m2.2c">{\bm{U}}_{:,i}</annotation><annotation encoding="application/x-llamapun" id="S6.p2.2.m2.2d">bold_italic_U start_POSTSUBSCRIPT : , italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are negligible, the effect of the <math alttext="i" class="ltx_Math" display="inline" id="S6.p2.3.m3.1"><semantics id="S6.p2.3.m3.1a"><mi id="S6.p2.3.m3.1.1" xref="S6.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S6.p2.3.m3.1b"><ci id="S6.p2.3.m3.1.1.cmml" xref="S6.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S6.p2.3.m3.1d">italic_i</annotation></semantics></math>-th field is negligible, and it can be discarded. Hence, another future direction is mathematically or experimentally quantifying this notion of field importance, as an alternative to the approach in <cite class="ltx_cite ltx_citemacro_citep">(Kaplan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#bib.bib18" title="">2021</a>)</cite>. This is especially important for real-time systems, where just reducing the number of fields may have a tremendous effect on latency and recommendation costs.</p>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">cri (2014)</span>
<span class="ltx_bibblock">
2014.

</span>
<span class="ltx_bibblock">3 Idiots’ Approach for Display Advertising Challenge.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ycjuan/kaggle-2014-criteo.git" title="">https://github.com/ycjuan/kaggle-2014-criteo.git</a>.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">Accessed: 2024-04-01.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aharon et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Michal Aharon, Natalie Aizenberg, Edward Bortnikov, Ronny Lempel, Roi Adadi, Tomer Benyamini, Liron Levin, Ran Roth, and Ohad Serfaty. 2013.

</span>
<span class="ltx_bibblock">OFF-set: one-pass factorization of feature sets for online recommendation in persistent cold start settings. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">RecSys’2013</em>. 375–378.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aizenberg et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
Natalie Aizenberg, Yehuda Koren, and Oren Somekh. 2012.

</span>
<span class="ltx_bibblock">Build your own music recommender by modeling internet radio streams. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 21st international conference on World Wide Web</em>. ACM, 1–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akiba et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Takuya Akiba, Shotaro Sano, Toshihiko Yanase, Takeru Ohta, and Masanori Koyama. 2019.

</span>
<span class="ltx_bibblock">Optuna: A Next-generation Hyperparameter Optimization Framework. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Almagor and Hoshen (2022)</span>
<span class="ltx_bibblock">
Chen Almagor and Yedid Hoshen. 2022.

</span>
<span class="ltx_bibblock">You Say Factorization Machine, I Say Neural Network-It’s All in the Activation. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 389–398.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bell and Koren (2007)</span>
<span class="ltx_bibblock">
Robert M Bell and Yehuda Koren. 2007.

</span>
<span class="ltx_bibblock">Lessons from the Netflix prize challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Acm Sigkdd Explorations Newsletter</em> 9, 2 (2007), 75–79.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bingham et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Eli Bingham, Jonathan P. Chen, Martin Jankowiak, Fritz Obermeyer, Neeraj Pradhan, Theofanis Karaletsos, Rohit Singh, Paul A. Szerlip, Paul Horsfall, and Noah D. Goodman. 2019.

</span>
<span class="ltx_bibblock">Pyro: Deep Universal Probabilistic Programming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">J. Mach. Learn. Res.</em> 20 (2019), 28:1–28:6.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v20/18-403.html" title="">http://jmlr.org/papers/v20/18-403.html</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blei et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2003)</span>
<span class="ltx_bibblock">
David M Blei, Andrew Y Ng, and Michael I Jordan. 2003.

</span>
<span class="ltx_bibblock">Latent dirichlet allocation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Journal of machine Learning research</em> 3, Jan (2003), 993–1022.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, et al<span class="ltx_text" id="bib.bib10.3.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Wide &amp; deep learning for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.4.1">Proceedings of the 1st workshop on deep learning for recommender systems</em>. 7–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wei Deng, Junwei Pan, Tian Zhou, Deguang Kong, Aaron Flores, and Guang Lin. 2021.

</span>
<span class="ltx_bibblock">Deeplight: Deep lightweight feature interactions for accelerating ctr predictions in ad serving. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 14th ACM international conference on Web search and data mining</em>. 922–930.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goldberg et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (1992)</span>
<span class="ltx_bibblock">
David Goldberg, David Nichols, Brian M Oki, and Douglas Terry. 1992.

</span>
<span class="ltx_bibblock">Using collaborative filtering to weave an information tapestry.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Commun. ACM</em> 35, 12 (1992), 61–70.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">DeepFM: a factorization-machine based neural network for CTR prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:1703.04247</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
F Maxwell Harper and Joseph A Konstan. 2015.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Acm transactions on interactive intelligent systems (tiis)</em> 5, 4 (2015), 1–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2021.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">arXiv preprint arXiv:2106.09685</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Juan et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2016a)</span>
<span class="ltx_bibblock">
Yuchin Juan, Yong Zhuang, Wei-Sheng Chin, and Chih-Jen Lin. 2016a.

</span>
<span class="ltx_bibblock">Field-Aware Factorization Machines for CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 10th ACM Conference on Recommender Systems</em> (Boston, Massachusetts, USA) <em class="ltx_emph ltx_font_italic" id="bib.bib16.4.2">(RecSys ’16)</em>. Association for Computing Machinery, New York, NY, USA, 43–50.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2959100.2959134" title="">https://doi.org/10.1145/2959100.2959134</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Juan et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2016b)</span>
<span class="ltx_bibblock">
Yuchin Juan, Yong Zhuang, Wei-Sheng Chin, and Chih-Jen Lin. 2016b.

</span>
<span class="ltx_bibblock">Field-aware factorization machines for CTR prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 10th ACM conference on recommender systems</em>. 43–50.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaplan et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yohay Kaplan, Yair Koren, Rina Leibovits, and Oren Somekh. 2021.

</span>
<span class="ltx_bibblock">Dynamic length factorization machines for CTR prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">2021 IEEE International Conference on Big Data (Big Data)</em>. IEEE, 1950–1959.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Koren et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Yehuda Koren, Robert Bell, and Chris Volinsky. 2009.

</span>
<span class="ltx_bibblock">Matrix factorization techniques for recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Computer</em> 42, 8 (2009), 30–37.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lian et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jianxun Lian, Xiaohuan Zhou, Fuzheng Zhang, Zhongxia Chen, Xing Xie, and Guangzhong Sun. 2018.

</span>
<span class="ltx_bibblock">xdeepfm: Combining explicit and implicit feature interactions for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1754–1763.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Xiao Lin, Wenpeng Zhang, Min Zhang, Wenwu Zhu, Jian Pei, Peilin Zhao, and Junzhou Huang. 2018.

</span>
<span class="ltx_bibblock">Online Compact Convexified Factorization Machine. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 2018 World Wide Web Conference</em> (Lyon, France) <em class="ltx_emph ltx_font_italic" id="bib.bib21.4.2">(WWW ’18)</em>. International World Wide Web Conferences Steering Committee, Republic and Canton of Geneva, CHE, 1633–1642.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3178876.3186075" title="">https://doi.org/10.1145/3178876.3186075</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liutkus and Yoshii (2017)</span>
<span class="ltx_bibblock">
Antoine Liutkus and Kazuyoshi Yoshii. 2017.

</span>
<span class="ltx_bibblock">A diagonal plus low-rank covariance model for computationally efficient source separation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">2017 IEEE 27th International Workshop on Machine Learning for Signal Processing (MLSP)</em>. IEEE, 1–6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lommatzsch et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Andreas Lommatzsch, Benjamin Kille, and Sahin Albayrak. 2017.

</span>
<span class="ltx_bibblock">Incorporating context and trends in news recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the international conference on web intelligence</em>. 1062–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mishkin et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Aaron Mishkin, Frederik Kunstner, Didrik Nielsen, Mark Schmidt, and Mohammad Emtiyaz Khan. 2018.

</span>
<span class="ltx_bibblock">Slang: Fast structured covariance approximations for bayesian deep learning with natural gradient.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Advances in Neural Information Processing Systems</em> 31 (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ong et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Victor M-H Ong, David J Nott, and Michael S Smith. 2018.

</span>
<span class="ltx_bibblock">Gaussian variational approximation with a factor covariance structure.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Journal of Computational and Graphical Statistics</em> 27, 3 (2018), 465–478.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2018a)</span>
<span class="ltx_bibblock">
Junwei Pan, Jian Xu, Alfonso Lobos Ruiz, Wenliang Zhao, Shengjun Pan, Yu Sun, and Quan Lu. 2018a.

</span>
<span class="ltx_bibblock">Field-Weighted Factorization Machines for Click-Through Rate Prediction in Display Advertising. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 2018 World Wide Web Conference</em> (Lyon, France) <em class="ltx_emph ltx_font_italic" id="bib.bib26.4.2">(WWW ’18)</em>. Association for Computing Machinery, New York, NY, USA, 1349–1357.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3178876.3186040" title="">https://doi.org/10.1145/3178876.3186040</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2018b)</span>
<span class="ltx_bibblock">
Junwei Pan, Jian Xu, Alfonso Lobos Ruiz, Wenliang Zhao, Shengjun Pan, Yu Sun, and Quan Lu. 2018b.

</span>
<span class="ltx_bibblock">Field-weighted factorization machines for click-through rate prediction in display advertising. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the 2018 World Wide Web Conference</em>. 1349–1357.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pande (2021)</span>
<span class="ltx_bibblock">
Harshit Pande. 2021.

</span>
<span class="ltx_bibblock">Field-Embedded Factorization Machines for Click-through rate prediction.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2009.09931 [cs.IR]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petersen and Pedersen (2012)</span>
<span class="ltx_bibblock">
Kaare Brandt Petersen and Michael Syskind Pedersen. 2012.

</span>
<span class="ltx_bibblock">The Matrix Cookbook.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010a)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010a.

</span>
<span class="ltx_bibblock">Factorization Machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">2010 IEEE International Conference on Data Mining</em>. 995–1000.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1109/ICDM.2010.127" title="">https://doi.org/10.1109/ICDM.2010.127</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010b)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010b.

</span>
<span class="ltx_bibblock">Factorization machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">2010 IEEE International conference on data mining</em>. IEEE, 995–1000.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saunderson et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2012)</span>
<span class="ltx_bibblock">
James Saunderson, Venkat Chandrasekaran, Pablo A Parrilo, and Alan S Willsky. 2012.

</span>
<span class="ltx_bibblock">Diagonal and low-rank matrix decompositions, correlation matrices, and ellipsoid fitting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">SIAM J. Matrix Anal. Appl.</em> 33, 4 (2012), 1395–1416.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sculley et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
David Sculley, Gary Holt, Daniel Golovin, Eugene Davydov, Todd Phillips, Dietmar Ebner, Vinay Chaudhary, Michael Young, Jean-Francois Crespo, and Dan Dennison. 2015.

</span>
<span class="ltx_bibblock">Hidden technical debt in machine learning systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Advances in neural information processing systems</em> 28 (2015), 2503–2511.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Weiping Song, Chence Shi, Zhiping Xiao, Zhijian Duan, Yewen Xu, Ming Zhang, and Jian Tang. 2019.

</span>
<span class="ltx_bibblock">Autoint: Automatic feature interaction learning via self-attentive neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1161–1170.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2021a)</span>
<span class="ltx_bibblock">
Yang Sun, Junwei Pan, Alex Zhang, and Aaron Flores. 2021a.

</span>
<span class="ltx_bibblock">FM2: Field-Matrixed Factorization Machines for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of the Web Conference 2021</em> (Ljubljana, Slovenia) <em class="ltx_emph ltx_font_italic" id="bib.bib35.4.2">(WWW ’21)</em>. Association for Computing Machinery, New York, NY, USA, 2828–2837.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3442381.3449930" title="">https://doi.org/10.1145/3442381.3449930</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2021b)</span>
<span class="ltx_bibblock">
Yang Sun, Junwei Pan, Alex Zhang, and Aaron Flores. 2021b.

</span>
<span class="ltx_bibblock">FM2: Field-matrixed factorization machines for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the Web Conference 2021</em>. 2828–2837.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tomczak et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Marcin Tomczak, Siddharth Swaroop, and Richard Turner. 2020.

</span>
<span class="ltx_bibblock">Efficient low rank gaussian variational inference for neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Advances in Neural Information Processing Systems</em> 33 (2020), 4610–4622.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; cross network for ad click predictions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the ADKDD’17</em>. 1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yang Zhang, Fuli Feng, Chenxu Wang, Xiangnan He, Meng Wang, Yan Li, and Yongdong Zhang. 2020.

</span>
<span class="ltx_bibblock">How to retrain recommender system? A sequential meta-learning method. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 1479–1488.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yong Zhao, Jinyu Li, and Yifan Gong. 2016.

</span>
<span class="ltx_bibblock">Low-rank plus diagonal adaptation for deep neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">2016 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>. IEEE, 5005–5009.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Latency charts</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.00801v1#A1.F3" title="Figure 3 ‣ Appendix A Latency charts ‣ Low Rank Field-Weighted Factorization Machines for Low Latency Item Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a> we observe that the improvement in the latency of the low-rank solution is consistent over time.</p>
</div>
<figure class="ltx_figure" id="A1.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="443" id="A1.F3.sf1.g1" src="extracted/5747578/scoring_latency.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="443" id="A1.F3.sf2.g1" src="extracted/5747578/scoring_latency_95_pct.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A1.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="443" id="A1.F3.sf3.g1" src="extracted/5747578/ranking_latency.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F3.sf3.2.1.1" style="font-size:90%;">(c)</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="A1.F3.3.2" style="font-size:90%;">Latency graphs over a 10 hour period.</span></figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Jul 22 13:56:56 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
