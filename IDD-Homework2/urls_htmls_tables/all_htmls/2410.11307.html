<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection</title>
<!--Generated on Tue Oct 15 06:09:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.11307v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S1" title="In CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S2" title="In CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Previous Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S2.SS1" title="In 2 Previous Work ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Reconstruction-Based Method</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S2.SS2" title="In 2 Previous Work ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Downstream-Based methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3" title="In CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.SS1" title="In 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.SS2" title="In 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Adversarial Image Pair Synthesise</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.SS3" title="In 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Context-Aware Contrastive Learning for MRI Anomaly Detection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.SS4" title="In 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Self-Supervised Feature Adversarial Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.SS5" title="In 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Anomaly Detection Head</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4" title="In CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS1" title="In 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS2" title="In 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3" title="In 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3.SSS1" title="In 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Evaluation of CONSULT for Domain Adaptation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3.SSS2" title="In 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Evaluation of Loss Function</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3.SSS3" title="In 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Evaluation of Feature Extractor</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S5" title="In CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\addbibresource</span>
<p class="ltx_p" id="p1.2">neurips_2024.bib
<span class="ltx_ERROR undefined" id="p1.2.1">\useunder</span><span class="ltx_text ltx_ulem_uline" id="p1.2.2"></span><span class="ltx_ERROR undefined" id="p1.2.3">\ul</span>
</p>
</div>
<h1 class="ltx_title ltx_title_document">CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Sin Chee Chin 
<br class="ltx_break"/>Shenzhen International Graduate School
<br class="ltx_break"/>Tsinghua University 
<br class="ltx_break"/>ShenZhen, China 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">chenxz22@mails.tsinghua.edu.cn</span>
<br class="ltx_break"/>&amp;Xuan Zhang 
<br class="ltx_break"/>Shenzhen International Graduate School
<br class="ltx_break"/>Tsinghua University
<br class="ltx_break"/>ShenZhen, China 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">zhangxua22@mails.tsinghua.edu.cn</span>
<br class="ltx_break"/>&amp;Lee Yeong Khang 
<br class="ltx_break"/>ViTrox Technologies Sdn. Bhd.
<br class="ltx_break"/>Penang, Malaysia 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.3.id3">yeong-khang.lee@vitrox.com</span>
<br class="ltx_break"/>&amp;Wenming Yang 
<br class="ltx_break"/>Shenzhen International Graduate School
<br class="ltx_break"/>Tsinghua University 
<br class="ltx_break"/>ShenZhen, China 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id4.4.id4">yang.wenming@sz.tsinghua.edu.cn</span>
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Correspondance Author</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">Artificial intelligence aids in brain tumor detection via MRI scans, enhancing the accuracy and reducing the workload of medical professionals. However, in scenarios with extremely limited medical images, traditional deep learning approaches tend to fail due to the absence of anomalous images.
Anomaly detection also suffers from ineffective feature extraction due to vague training process.
Our work introduces a novel two-stage anomaly detection algorithm called CONSULT (CONtrastive Self-sUpervised Learning for few-shot Tumor detection).
The first stage of CONSULT fine-tunes a pre-trained feature extractor specifically for MRI brain images, using a synthetic data generation pipeline to create tumor-like data.
This process overcomes the lack of anomaly samples and enables the integration of attention mechanisms to focus on anomalous image segments.
The first stage is to overcome the shortcomings of current anomaly detection in extracting features in high-variation data by incorporating Context-Aware Contrastive Learning and Self-supervised Feature Adversarial Learning.
The second stage of CONSULT uses PatchCore for conventional feature extraction via the fine-tuned weights from the first stage.
To summarize, we propose a self-supervised training scheme for anomaly detection, enhancing model performance and data reliability.
Furthermore, our proposed contrastive loss, Tritanh Loss, stabilizes learning by offering a unique solution all while enhancing gradient flow.
Finally, CONSULT achieves superior performance in few-shot brain tumor detection, demonstrating significant improvements over PatchCore by 9.4%, 12.9%, 10.2%, and 6.0% for 2, 4, 6, and 8 shots, respectively, while training exclusively on healthy images.
</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.1.g1" src="extracted/5924471/Latex/introduction/resized_y62.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.2.g1" src="extracted/5924471/Latex/introduction/resized_y246.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.3.g1" src="extracted/5924471/Latex/introduction/resized_y796.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.4"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.4.g1" src="extracted/5924471/Latex/introduction/resized_y798.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.5"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.5.g1" src="extracted/5924471/Latex/introduction/y62_pc.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.6"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.6.g1" src="extracted/5924471/Latex/introduction/y246_pc.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.7"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.7.g1" src="extracted/5924471/Latex/introduction/y796_pc.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.8"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.8.g1" src="extracted/5924471/Latex/introduction/y798_pc.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.9"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.9.g1" src="extracted/5924471/Latex/introduction/resized_y62_mask.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.10"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.10.g1" src="extracted/5924471/Latex/introduction/resized_y246_mask.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.11"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.11.g1" src="extracted/5924471/Latex/introduction/resized_y796_mask.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.12"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="598" id="S1.F1.12.g1" src="extracted/5924471/Latex/introduction/resized_y798_mask.png" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.14.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.15.2" style="font-size:90%;">Heatmap Comparison of Unhealthy Images. Different columns show unhealthy MRI images of different positions, sizes, and textures. The first row is the raw image. The second row is the heatmap predicted with PatchCore. The third raw is the heatmap predicted with the proposed method.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Brain tumors are one of the most deadly cancers in modern medicine <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sung2021global</span>]</cite>. Identifying brain tumors at an early stage enables medical professionals to implement prompt interventions and explore treatment methods that are less invasive, significantly improving patient survival rates and reducing negative health impacts.
In contemporary medical diagnostics, Magnetic Resonance Imaging (MRI) has emerged as a cornerstone for the non-invasive detection of brain tumors, leveraging its unparalleled capacity to provide detailed soft tissue contrast <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">gawande2017brain</span>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Nevertheless, the expense of MRI procedures is high, which is largely attributed to their operational and maintenance expenses. Interpreting MRI images requires the involvement of highly trained and skilled medical professionals, whose salaries further boost the cost <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">goel2021economic</span>]</cite>.
Moreover, the interpretation of MRIs remains a time-consuming task, posing a challenge for both the energy and expertise of the radiologists.
Those obstacles have spurred interest in applying deep learning techniques to assist tumor recognition. <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2020unet</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">cao2021swinunet</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">yan2022after</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">litjens2017survey</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">hosny2018artificial</span>]</cite>
Data scarcity is an unavoidable curse in the field of medical imaging.
This is because collecting medical data for commercial use is faced with challenges and restrictions such as privacy and safety concerns.
Unfortunately, deep learning models need a lot of training data to make an accurate prediction.
</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address the aforementioned problems, we argue that anomaly detection is a more suitable task for MRI tumor recognition, which offers both convenience and an explainable recognition method for AI-assisted medical treatment.
This approach requires only normal data for the <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">training</span> phase, removing the need for tumorous data for training.
Instead of learning the anomalous regions (brain tumors), anomaly detection pivots the model to learn the normality of the training dataset.
Implementing anomaly detection in brain tumor detection can accurately identify anomalies that was unseen in the <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">training</span> phase.
Therefore, the advantages of implementing anomaly detection into MRI recognition are clear:
Firstly, obtaining a comprehensive collection of anomalous data is nearly impossible, whereas acquiring healthy training images is considerably easier.
Secondly, by exclusively utilizing healthy data for training, the necessity for expert annotations is eliminated, thereby significantly reducing costs.
Lastly, the predictions made by anomaly detection are traceable back to the training samples, making anomaly detection highly trustworthy.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Although anomaly detection presents a promising approach for analyzing brain MRI images, it is still faced with the final challenge of high variability within brain MRI images.
The heterogeneity of human anatomy poses difficulties in attaining consistent effectiveness across different individuals, both pathological and healthy.
The classical method to address this issue is to increase the training samples. However, this is not a scalable and feasible solution for MRI images.
Furthermore, current anomaly detection methods struggle to adapt to the medical imaging domain because of the lack of rigid objective function to fine-tune downstream anomaly detection algorithms.
The objective function for downstream anomaly detection algorithm is extremely hard to define due to the lack of training target and expected outcome.
</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In response to these problems faced by anomaly detection in MRI images, we propose CONSULT, a two-stage anomaly detection algorithm for few-shot MRI image recognition.
CONSULT fine-tunes the feature extractor to adapt to the MRI image domain with self-supervised learning.
The fine-tuned feature extractor is able to differentiate normal features from abnormal ones by focusing on the latter, and it also learns the normality features of healthy samples, reducing the number of training samples needed.
The first stage of CONSULT fine-tune feature extractor with healthy images only.
We deploy self-supervised contrastive learning and self-supervised feature adversarial learning for feature extractor fine-tuning.
Furthermore, we incorporate a lightweight attention module into the feature extractor to help the model focus on anomalous patches iteratively.
Incorporating context-aware attention module was previously impossible to be applied in downstream anomaly detection because downstream anomaly detection does not undergo any training process.
The second stage is a standard downstream anomaly detection training with the fine-tuned backbone from the first stage.
We choose PatchCore as the main anomaly detection algorithm to benchmark the effectiveness of CONSULT <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">roth2022towards</span>]</cite>. This is because PatchCore exhibits strong feature sampling and robustness.
Besides making accurate predictions with only two training samples, the proposed self-supervised fine-tuning stage outperforms traditional supervised fine-tuning techniques, such as transfer learning.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our contributions are threefold:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a self-supervised training scheme for few-shot MRI anomaly detection that does not require tumorous data. Specifically, we introduce context-aware contrastive learning to distinguish healthy features from unhealthy features, and a self-supervised feature adversarial learning to understand the normality of healthy features, thus reducing the need for large training samples.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We develop a novel contrastive loss function, Tritanh loss, which provides stability and robust gradient flow. Unlike anchor loss, which has multiple solutions and a constant gradient, Tritanh loss offers a unique solution and an adaptive gradient flow as the loss approaches optimal.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Through extensive experiments, we show that CONSULT achieves superior performance in few-shot brain tumor detection, significantly improving over PatchCore by 9.4%, 12.9%, 10.2%, and 6.0% for 2, 4, 6, and 8 shots.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">The rest of this paper is organized as follows: In Section II,
we introduce the work related to anomaly detection, medical
image segmentation, and unsupervised domain adaptation.
In Section III, we present the methodology of CONSULT. In Section IV, extensive
experiments on the proposed method are conducted to validate
the effectiveness of our method. We conclude our work in
Section V.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Previous Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In recent times, the field of anomaly detection has garnered significant attention from both industrial and academic communities. Owing to its ability to deliver precise results through unsupervised learning, anomaly detection eliminates the necessity for labeled datasets in the development of dependable models. Moreover, anomaly detection are highly reliable and logical coherent, as the outcomes they produce are explainable through a detailed examination of the model’s outputs.
Anomaly detection is generally classified into two taxonomy: reconstruction-based approach and downstream-based approach. Both methods have their pros and cons when performing anomaly detection training and detection.
</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Reconstruction-Based Method</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Early works of reconstruction-based anomaly detection involve the use of a simple autoencoder to reconstruct the input image <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wei2021real</span>]</cite>. During the training phase, the model is exclusively fed normal images, enabling it to learn how to reconstruct these inputs accurately. Therefore, it is expected to only proficiently reconstruct normal images while struggling with anomalous ones. Consequently, the discrepancy between the input image and its reconstruction can serve as an indicator of anomaly, assessed via a distance function. A predefined threshold is then applied to identify the type and location of anomalies.
GANomaly is the first to introduce GAN architecture into anomaly detection. The loss function for GANomaly is modified with an adversarial loss <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">akcay2019ganomaly</span>]</cite>. Following their previous work, Skip-GANomaly introduces skip connection in the autoencoder for better feature learning <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">akccay2019skip</span>]</cite>. f-AnoGAN is then proposed to perform anomaly detection on medical images <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">schlegl2019f</span>]</cite>. VT-ADL replaces the encoder with a transformer encoder to harness the ability of the transformer to extract more representative features <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">mishra2021vt</span>]</cite>. AnoViT uses a vision transformer as a feature extractor to extract features and directly pass these features into a custom decoder block to reconstruct the input image <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">lee2022anovit</span>]</cite>. RIAD and InTra inpaint the input image during training to force the model to learn the missing features from the neighbors <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zavrtanik2021reconstruction</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">pirnay2022inpainting</span>]</cite>. This method effectively solves the problem of overfitting with U-net architecture. MSTUnet uses the same inpainting method to train a Swin Transformer for image reconstruction <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">jiang2022masked</span>]</cite>. Recent work includes using diffusion models to reconstruct the input image <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">wolleb2022diffusion</span>]</cite>. Diffusion models prove to be better generators compared to their counterparts due to their ability to generate realistic, high-resolution images. By visualizing the output of the reconstruction model, the defect-free image can be estimated from the query images. The detection head is tasked to measure the dissimilarity between the query image and the reconstructed image.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Downstream-Based methods</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Unlike methods focused on reconstruction, downstream approaches are more straightforward. These methods utilize a feature extractor to capture normal feature representations, which are then preserved in an auxiliary memory bank. During the inference phase, the same feature extractor is employed to obtain features from the query image and conduct comparisons with the features stored in the memory bank.
FastFlow attempts to move the latent features to a standard normal distribution using normalizing flow <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yu2021fastflow</span>]</cite>, where any anomalies are considered as out-of-distribution data. BGAD improved upon FastFlow’s work by introducing a contrastive learning approach to train the detection head <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">yao2023explicit</span>]</cite>.
PaDIM extract feature representations from the intermediate layers and model them using a Mixture of Gaussian (MoG), the distance function is calculated using the Mahalanobis distance <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">defard2021padim</span>]</cite>. RegAD builds upon PaDIM’s work and introduced spatial transformer network (STN) into the CNN models and retrained the STN to learn how to spatially transform the intermediate features <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2022registration</span>]</cite>.
PatchCore used coreset sampling algorithm to sample the most representative features from the training image <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">roth2022towards</span>]</cite>. This simple approach effectively preserves the original representation of the normal feature, enabling traceability while reducing the memory requirement.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">However, as the normal representation becomes more complex and diverse, the memory bank size increases, and this will result in memory overloading.
Therefore, Reverse Distillation propose a teacher (encoder) and student (decoder) network to perform anomaly detection. The student decoder is trained to reconstruct good features from the teacher encoder network during the training phase and regions that cannot be reconstructed efficiently are considered anomalies <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">deng2022anomaly</span>]</cite>. Reverse Distillation++ introduced simplex noise in the training process as pseudo-bad images and trained the model to suppress such noise <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">li2023rethinking</span>]</cite>. SimpleNet also introduced pseudo-bad features by injecting Gaussian noise into the features extracted from the feature extractor <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2023simplenet</span>]</cite>. EfficientAD combines both reconstruction and knowledge distillation methods, achieving SOTA results and millisecond prediction using lightweight models. EfficientAD used two lightweight models as the teacher and student models and a vanilla autoencoder. The teacher model is distilled from a huge backbone, eliminating the need for a huge feature extractor for anomaly detection. Both the student and autoencoder learn to reconstruct the features extracted from the teacher model <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">batzner2024efficientad</span>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Reconstruction approaches are limited by the bandwidth of the reconstruction network. Furthermore, a large amount of images are needed to train a robust reconstruction-based anomaly detection model.
On the other hand, the downstream approach does not need a lot of training data to detect anomalies as it only needs representative features to exist in the training set.
Yet, they are weak in detecting anomalies for high data variation because the feature extractor lacks robustness in extracting expressive embeddings.
Given the intricate nature of medical diagnostics, which demands a focus on fine-grained details, the feature extractor for medical imagery must discern subtler nuances.
The ImageNet pre-trained backbone commonly used by the downstream approach fails to extract meaningful features in medical images.
The downstream approach is compelled to use ImageNet pre-trained weights as the feature extractor because they lack a clear objective function to retrain the neural network.
Drawing inspiration from recent advancements in downstream-based anomaly detection that generate pseudo-anomalous images for training, we introduce a novel approach that utilizes rigid contrastive learning for the detection of anomalies in MRI images.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We introduce CONtrastive Self-sUpervised Learning for few-shot Tumor detection (CONSULT), a 2-stage downstream anomaly detection methodology that achieves extreme-few-shot anomaly detection with high precision. A comprehensive overview of CONSULT is in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.F2" title="Figure 2 ‣ 3.1 Overview ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">In the first stage, CONSULT adapts the feature extractor to brain MRI imagery, which enables the extraction of more significant features from healthy brain MRI images.
To facilitate contrastive learning, we generate a pseudo dataset comprising both tumor-free and synthetic tumorous MRI images.
For non-tumorous images, we apply image augmentation techniques, such as elastic distortion and random translation to enrich the limited semantic information.
For the simulation of tumorous images, we employ the Bezier Curve technique to ensure that the artificial defects bear a semantic resemblance to actual brain tumors.
The goal is to refine the representation of nominal features within the feature space while emphasizing the distinctions between tumorous and non-tumorous features.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">To further enhance the efficacy of the feature extractor, we incorporate attention mechanism into our framework.
Concretely, we deploy an attention module in each layer of the network based on <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">woo2018cbam</span>]</cite>. The attention module prioritizes salient features within the feature map that contribute to minimizing the objective function, making the attention module aware of anomalous features. Previous downstream methods are unable to incorporate context-aware attention modules into anomaly detection because they do not undergo training.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">In the second stage, we replace the feature extractor of PatchCore with the finetuned feature extractor from the first stage <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">roth2022towards</span>]</cite>. The memory bank is built by using coreset sampling algorithm to sample the most representative features from the training samples.
Our proposed method has a direct improvement on PatchCore and enables PatchCore to make an accurate prediction in low shot scenarios.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.4">PatchCore compares the Euclidian distance between each extracted feature with the sampled points in the memory bank. If the distance is greater than the given threshold, <math alttext="\tau" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">italic_τ</annotation></semantics></math>, the sample is considered an anomaly. Therefore, we can formulate whether anomaly exists, <math alttext="A" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><mi id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><ci id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">italic_A</annotation></semantics></math> in a query image, <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_x</annotation></semantics></math>, when compared with a memory bank, <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><ci id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">caligraphic_M</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="A=\\
\left\{\begin{array}[]{ll}0&amp;\quad max(\lvert x(i,j)-\mathcal{M}\rvert^{2})\leq%
\tau\\
1&amp;\quad max(\lvert x(i,j)-\mathcal{M}\rvert^{2})&gt;\tau\end{array}\right." class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.7" xref="S3.E1.m1.6.7.cmml"><mi id="S3.E1.m1.6.7.2" xref="S3.E1.m1.6.7.2.cmml">A</mi><mo id="S3.E1.m1.6.7.1" xref="S3.E1.m1.6.7.1.cmml">=</mo><mrow id="S3.E1.m1.6.7.3.2" xref="S3.E1.m1.6.7.3.1.cmml"><mo id="S3.E1.m1.6.7.3.2.1" xref="S3.E1.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E1.m1.6.6" rowspacing="0pt" xref="S3.E1.m1.6.6.cmml"><mtr id="S3.E1.m1.6.6a" xref="S3.E1.m1.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.6.6b" xref="S3.E1.m1.6.6.cmml"><mn id="S3.E1.m1.3.3.3.4.1" xref="S3.E1.m1.3.3.3.4.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.6.6c" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.cmml"><mrow id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.3.cmml">m</mi><mo id="S3.E1.m1.3.3.3.3.3.3.2" xref="S3.E1.m1.3.3.3.3.3.3.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.3.3.3.3.4" xref="S3.E1.m1.3.3.3.3.3.3.4.cmml">a</mi><mo id="S3.E1.m1.3.3.3.3.3.3.2a" xref="S3.E1.m1.3.3.3.3.3.3.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.3.3.3.3.5" xref="S3.E1.m1.3.3.3.3.3.3.5.cmml">x</mi><mo id="S3.E1.m1.3.3.3.3.3.3.2b" xref="S3.E1.m1.3.3.3.3.3.3.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.cmml"><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.cmml">(</mo><msup id="S3.E1.m1.3.3.3.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.2.2" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml">j</mi><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml">−</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml">ℳ</mi></mrow><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E1.m1.3.3.3.3.3.3.1.1.1.3" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.3.cmml">2</mn></msup><mo id="S3.E1.m1.3.3.3.3.3.3.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.3.3.3.4" xref="S3.E1.m1.3.3.3.3.3.4.cmml">≤</mo><mi id="S3.E1.m1.3.3.3.3.3.5" xref="S3.E1.m1.3.3.3.3.3.5.cmml">τ</mi></mrow></mtd></mtr><mtr id="S3.E1.m1.6.6d" xref="S3.E1.m1.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.6.6e" xref="S3.E1.m1.6.6.cmml"><mn id="S3.E1.m1.6.6.6.4.1" xref="S3.E1.m1.6.6.6.4.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.6.6f" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.6.6.6.3.3" xref="S3.E1.m1.6.6.6.3.3.cmml"><mrow id="S3.E1.m1.6.6.6.3.3.3" xref="S3.E1.m1.6.6.6.3.3.3.cmml"><mi id="S3.E1.m1.6.6.6.3.3.3.3" xref="S3.E1.m1.6.6.6.3.3.3.3.cmml">m</mi><mo id="S3.E1.m1.6.6.6.3.3.3.2" xref="S3.E1.m1.6.6.6.3.3.3.2.cmml">⁢</mo><mi id="S3.E1.m1.6.6.6.3.3.3.4" xref="S3.E1.m1.6.6.6.3.3.3.4.cmml">a</mi><mo id="S3.E1.m1.6.6.6.3.3.3.2a" xref="S3.E1.m1.6.6.6.3.3.3.2.cmml">⁢</mo><mi id="S3.E1.m1.6.6.6.3.3.3.5" xref="S3.E1.m1.6.6.6.3.3.3.5.cmml">x</mi><mo id="S3.E1.m1.6.6.6.3.3.3.2b" xref="S3.E1.m1.6.6.6.3.3.3.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.6.3.3.3.1.1" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.cmml"><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.2" stretchy="false" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.cmml">(</mo><msup id="S3.E1.m1.6.6.6.3.3.3.1.1.1" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.2" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.1" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E1.m1.4.4.4.1.1.1" xref="S3.E1.m1.4.4.4.1.1.1.cmml">i</mi><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.2.2" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E1.m1.5.5.5.2.2.2" xref="S3.E1.m1.5.5.5.2.2.2.cmml">j</mi><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.1.cmml">−</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.3.cmml">ℳ</mi></mrow><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E1.m1.6.6.6.3.3.3.1.1.1.3" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.3.cmml">2</mn></msup><mo id="S3.E1.m1.6.6.6.3.3.3.1.1.3" stretchy="false" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.3.3.4" xref="S3.E1.m1.6.6.6.3.3.4.cmml">&gt;</mo><mi id="S3.E1.m1.6.6.6.3.3.5" xref="S3.E1.m1.6.6.6.3.3.5.cmml">τ</mi></mrow></mtd></mtr></mtable><mi id="S3.E1.m1.6.7.3.2.2" xref="S3.E1.m1.6.7.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.7.cmml" xref="S3.E1.m1.6.7"><eq id="S3.E1.m1.6.7.1.cmml" xref="S3.E1.m1.6.7.1"></eq><ci id="S3.E1.m1.6.7.2.cmml" xref="S3.E1.m1.6.7.2">𝐴</ci><apply id="S3.E1.m1.6.7.3.1.cmml" xref="S3.E1.m1.6.7.3.2"><csymbol cd="latexml" id="S3.E1.m1.6.7.3.1.1.cmml" xref="S3.E1.m1.6.7.3.2.1">cases</csymbol><matrix id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><matrixrow id="S3.E1.m1.6.6a.cmml" xref="S3.E1.m1.6.6"><cn id="S3.E1.m1.3.3.3.4.1.cmml" type="integer" xref="S3.E1.m1.3.3.3.4.1">0</cn><apply id="S3.E1.m1.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3"><leq id="S3.E1.m1.3.3.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.3.3.4"></leq><apply id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3"><times id="S3.E1.m1.3.3.3.3.3.3.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.2"></times><ci id="S3.E1.m1.3.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.3">𝑚</ci><ci id="S3.E1.m1.3.3.3.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.3.3.3.4">𝑎</ci><ci id="S3.E1.m1.3.3.3.3.3.3.5.cmml" xref="S3.E1.m1.3.3.3.3.3.3.5">𝑥</ci><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1"><abs id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.2"></abs><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1"><minus id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2"><times id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.1"></times><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.2">𝑥</ci><interval closure="open" id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.3.2"><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝑖</ci><ci id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2">𝑗</ci></interval></apply><ci id="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.1.1.1.3">ℳ</ci></apply></apply><cn id="S3.E1.m1.3.3.3.3.3.3.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.3.3.3.3.3.3.1.1.1.3">2</cn></apply></apply><ci id="S3.E1.m1.3.3.3.3.3.5.cmml" xref="S3.E1.m1.3.3.3.3.3.5">𝜏</ci></apply></matrixrow><matrixrow id="S3.E1.m1.6.6b.cmml" xref="S3.E1.m1.6.6"><cn id="S3.E1.m1.6.6.6.4.1.cmml" type="integer" xref="S3.E1.m1.6.6.6.4.1">1</cn><apply id="S3.E1.m1.6.6.6.3.3.cmml" xref="S3.E1.m1.6.6.6.3.3"><gt id="S3.E1.m1.6.6.6.3.3.4.cmml" xref="S3.E1.m1.6.6.6.3.3.4"></gt><apply id="S3.E1.m1.6.6.6.3.3.3.cmml" xref="S3.E1.m1.6.6.6.3.3.3"><times id="S3.E1.m1.6.6.6.3.3.3.2.cmml" xref="S3.E1.m1.6.6.6.3.3.3.2"></times><ci id="S3.E1.m1.6.6.6.3.3.3.3.cmml" xref="S3.E1.m1.6.6.6.3.3.3.3">𝑚</ci><ci id="S3.E1.m1.6.6.6.3.3.3.4.cmml" xref="S3.E1.m1.6.6.6.3.3.3.4">𝑎</ci><ci id="S3.E1.m1.6.6.6.3.3.3.5.cmml" xref="S3.E1.m1.6.6.6.3.3.3.5">𝑥</ci><apply id="S3.E1.m1.6.6.6.3.3.3.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.3.3.3.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1">superscript</csymbol><apply id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1"><abs id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.2"></abs><apply id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1"><minus id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2"><times id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.1"></times><ci id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.2">𝑥</ci><interval closure="open" id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.3.2"><ci id="S3.E1.m1.4.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.4.1.1.1">𝑖</ci><ci id="S3.E1.m1.5.5.5.2.2.2.cmml" xref="S3.E1.m1.5.5.5.2.2.2">𝑗</ci></interval></apply><ci id="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.1.1.1.3">ℳ</ci></apply></apply><cn id="S3.E1.m1.6.6.6.3.3.3.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.6.6.6.3.3.3.1.1.1.3">2</cn></apply></apply><ci id="S3.E1.m1.6.6.6.3.3.5.cmml" xref="S3.E1.m1.6.6.6.3.3.5">𝜏</ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">A=\\
\left\{\begin{array}[]{ll}0&amp;\quad max(\lvert x(i,j)-\mathcal{M}\rvert^{2})\leq%
\tau\\
1&amp;\quad max(\lvert x(i,j)-\mathcal{M}\rvert^{2})&gt;\tau\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">italic_A = { start_ARRAY start_ROW start_CELL 0 end_CELL start_CELL italic_m italic_a italic_x ( | italic_x ( italic_i , italic_j ) - caligraphic_M | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ≤ italic_τ end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL italic_m italic_a italic_x ( | italic_x ( italic_i , italic_j ) - caligraphic_M | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) &gt; italic_τ end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p7">
<p class="ltx_p" id="S3.SS1.p7.1">It is worth noting that previous studies typically employ over 15 samples for training. In contrast, CONSULT only leverages 2 to 8 shots, the experimental results are detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS1" title="4.1 Results ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="425" id="S3.F2.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.4.2.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.2.1" style="font-size:90%;">Overall Algorithm for Training Stage. CONSULT takes in <math alttext="K" class="ltx_Math" display="inline" id="S3.F2.2.1.m1.1"><semantics id="S3.F2.2.1.m1.1b"><mi id="S3.F2.2.1.m1.1.1" xref="S3.F2.2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F2.2.1.m1.1c"><ci id="S3.F2.2.1.m1.1.1.cmml" xref="S3.F2.2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.2.1.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S3.F2.2.1.m1.1e">italic_K</annotation></semantics></math> training images and passes them into an augmentation pipeline to generate different representations of healthy and pseudo-unhealthy images.
Next, CONSULT trains the backbone through context-aware contrastive learning and self-supervised feature adversarial learning. We use the features extracted from the first, second, and third layers for training. The contrastive learning pipeline helps the model focus on abnormal features by pushing away from the normal features. Furthermore, the normal features are pulled towards each other.
The self-supervised feature adversarial learning maximizes the self-similarity of the anchor feature by pulling them closer to each other. We also employ a modified KoLeo Loss to prevent catastrophic collapse to ensure the healthy representation is well spread.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Adversarial Image Pair Synthesise</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Since anomaly detection models are trained exclusively on normal data, establishing a clear and rigid objective function presents a significant challenge.
This causes downstream anomaly detection to rely on employing the pre-trained model without any knowledge of the target domain.
This often leads to suboptimal performance and data hunger, especially with complex images with high variability such as brain MRIs.
Hence, it is imperative to fine-tune the feature extractor using data from the target domain.
Consequently, the current downstream anomaly detection algorithm requires a substantial amount of healthy images to train a robust anomaly detection model.
Additionally, it is impractical to amass a comprehensive collection of all possible variations of brain MRI images.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.10">To address these issues, we propose adversarial image pair synthesize, which generates both normal (healthy) and abnormal (tumor-like) images in the first stage of CONSULT. These pairs, denoted as <math alttext="\mathcal{D}_{train}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">r</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1a" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.4" xref="S3.SS2.p2.1.m1.1.1.3.4.cmml">a</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1b" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.5" xref="S3.SS2.p2.1.m1.1.1.3.5.cmml">i</mi><mo id="S3.SS2.p2.1.m1.1.1.3.1c" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.1.m1.1.1.3.6" xref="S3.SS2.p2.1.m1.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝒟</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑟</ci><ci id="S3.SS2.p2.1.m1.1.1.3.4.cmml" xref="S3.SS2.p2.1.m1.1.1.3.4">𝑎</ci><ci id="S3.SS2.p2.1.m1.1.1.3.5.cmml" xref="S3.SS2.p2.1.m1.1.1.3.5">𝑖</ci><ci id="S3.SS2.p2.1.m1.1.1.3.6.cmml" xref="S3.SS2.p2.1.m1.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{D}_{train}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_t italic_r italic_a italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, are derived from a limited dataset, <math alttext="\mathcal{D}_{few}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">f</mi><mo id="S3.SS2.p2.2.m2.1.1.3.1" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p2.2.m2.1.1.3.1a" xref="S3.SS2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.2.m2.1.1.3.4" xref="S3.SS2.p2.2.m2.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝒟</ci><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><times id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3.1"></times><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝑒</ci><ci id="S3.SS2.p2.2.m2.1.1.3.4.cmml" xref="S3.SS2.p2.2.m2.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\mathcal{D}_{few}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_f italic_e italic_w end_POSTSUBSCRIPT</annotation></semantics></math>, which comprises solely of normal images. The <math alttext="\mathcal{D}_{few}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">f</mi><mo id="S3.SS2.p2.3.m3.1.1.3.1" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p2.3.m3.1.1.3.1a" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.3.m3.1.1.3.4" xref="S3.SS2.p2.3.m3.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝒟</ci><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><times id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝑒</ci><ci id="S3.SS2.p2.3.m3.1.1.3.4.cmml" xref="S3.SS2.p2.3.m3.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\mathcal{D}_{few}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">caligraphic_D start_POSTSUBSCRIPT italic_f italic_e italic_w end_POSTSUBSCRIPT</annotation></semantics></math> dataset is utilized in stage 2 to construct the memory bank for anomaly detection, rather than employing <math alttext="\mathcal{D}_{train}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p2.4.m4.1.1.3.1" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.cmml">r</mi><mo id="S3.SS2.p2.4.m4.1.1.3.1a" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.3.4" xref="S3.SS2.p2.4.m4.1.1.3.4.cmml">a</mi><mo id="S3.SS2.p2.4.m4.1.1.3.1b" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.3.5" xref="S3.SS2.p2.4.m4.1.1.3.5.cmml">i</mi><mo id="S3.SS2.p2.4.m4.1.1.3.1c" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.4.m4.1.1.3.6" xref="S3.SS2.p2.4.m4.1.1.3.6.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝒟</ci><apply id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><times id="S3.SS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.1"></times><ci id="S3.SS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3">𝑟</ci><ci id="S3.SS2.p2.4.m4.1.1.3.4.cmml" xref="S3.SS2.p2.4.m4.1.1.3.4">𝑎</ci><ci id="S3.SS2.p2.4.m4.1.1.3.5.cmml" xref="S3.SS2.p2.4.m4.1.1.3.5">𝑖</ci><ci id="S3.SS2.p2.4.m4.1.1.3.6.cmml" xref="S3.SS2.p2.4.m4.1.1.3.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\mathcal{D}_{train}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">caligraphic_D start_POSTSUBSCRIPT italic_t italic_r italic_a italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math>.
To preserve the natural attributes of the brain image, we employ a series of data augmentation techniques on <math alttext="\mathcal{D}_{few}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.3.2" xref="S3.SS2.p2.5.m5.1.1.3.2.cmml">f</mi><mo id="S3.SS2.p2.5.m5.1.1.3.1" xref="S3.SS2.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.5.m5.1.1.3.3" xref="S3.SS2.p2.5.m5.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p2.5.m5.1.1.3.1a" xref="S3.SS2.p2.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.5.m5.1.1.3.4" xref="S3.SS2.p2.5.m5.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝒟</ci><apply id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3"><times id="S3.SS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3.1"></times><ci id="S3.SS2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.5.m5.1.1.3.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3.3">𝑒</ci><ci id="S3.SS2.p2.5.m5.1.1.3.4.cmml" xref="S3.SS2.p2.5.m5.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\mathcal{D}_{few}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT italic_f italic_e italic_w end_POSTSUBSCRIPT</annotation></semantics></math> to create a set of pseudo-normal images, <math alttext="\hat{\mathcal{D}_{G}}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mover accent="true" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><msub id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.6.m6.1.1.2.2" xref="S3.SS2.p2.6.m6.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p2.6.m6.1.1.2.3" xref="S3.SS2.p2.6.m6.1.1.2.3.cmml">G</mi></msub><mo id="S3.SS2.p2.6.m6.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><ci id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1">^</ci><apply id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.2.1.cmml" xref="S3.SS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2.2">𝒟</ci><ci id="S3.SS2.p2.6.m6.1.1.2.3.cmml" xref="S3.SS2.p2.6.m6.1.1.2.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\hat{\mathcal{D}_{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">over^ start_ARG caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. These images are generated using elastic and grid distortion to simulate the brain’s internal movement <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2023carvemix</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">garcea2023data</span>]</cite>. We also perform a horizontal flip on these pseudo-normal images to reflect the inherent symmetry of the human brain. Finally, we use random contrast adjustment to simulate different levels of contrast and brightness. Consequently, the comprehensive set of normal training images, <math alttext="\mathcal{D}_{G}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><msub id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝒟</ci><ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\mathcal{D}_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>, includes both the augmented images <math alttext="\hat{\mathcal{D}_{G}}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mover accent="true" id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><msub id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.8.m8.1.1.2.2" xref="S3.SS2.p2.8.m8.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p2.8.m8.1.1.2.3" xref="S3.SS2.p2.8.m8.1.1.2.3.cmml">G</mi></msub><mo id="S3.SS2.p2.8.m8.1.1.1" xref="S3.SS2.p2.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><ci id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1.1">^</ci><apply id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.2.1.cmml" xref="S3.SS2.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2.2">𝒟</ci><ci id="S3.SS2.p2.8.m8.1.1.2.3.cmml" xref="S3.SS2.p2.8.m8.1.1.2.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">\hat{\mathcal{D}_{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">over^ start_ARG caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> and the original non-tumorous images from <math alttext="\mathcal{D}_{few}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m9.1"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">𝒟</mi><mrow id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml"><mi id="S3.SS2.p2.9.m9.1.1.3.2" xref="S3.SS2.p2.9.m9.1.1.3.2.cmml">f</mi><mo id="S3.SS2.p2.9.m9.1.1.3.1" xref="S3.SS2.p2.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.9.m9.1.1.3.3" xref="S3.SS2.p2.9.m9.1.1.3.3.cmml">e</mi><mo id="S3.SS2.p2.9.m9.1.1.3.1a" xref="S3.SS2.p2.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p2.9.m9.1.1.3.4" xref="S3.SS2.p2.9.m9.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝒟</ci><apply id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3"><times id="S3.SS2.p2.9.m9.1.1.3.1.cmml" xref="S3.SS2.p2.9.m9.1.1.3.1"></times><ci id="S3.SS2.p2.9.m9.1.1.3.2.cmml" xref="S3.SS2.p2.9.m9.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.9.m9.1.1.3.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3.3">𝑒</ci><ci id="S3.SS2.p2.9.m9.1.1.3.4.cmml" xref="S3.SS2.p2.9.m9.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">\mathcal{D}_{few}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m9.1d">caligraphic_D start_POSTSUBSCRIPT italic_f italic_e italic_w end_POSTSUBSCRIPT</annotation></semantics></math> (initially referred to as <math alttext="\tilde{\mathcal{D}_{G}}" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m10.1"><semantics id="S3.SS2.p2.10.m10.1a"><mover accent="true" id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml"><msub id="S3.SS2.p2.10.m10.1.1.2" xref="S3.SS2.p2.10.m10.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.10.m10.1.1.2.2" xref="S3.SS2.p2.10.m10.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS2.p2.10.m10.1.1.2.3" xref="S3.SS2.p2.10.m10.1.1.2.3.cmml">G</mi></msub><mo id="S3.SS2.p2.10.m10.1.1.1" xref="S3.SS2.p2.10.m10.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><apply id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1"><ci id="S3.SS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1.1">~</ci><apply id="S3.SS2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.1.1.2.1.cmml" xref="S3.SS2.p2.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.10.m10.1.1.2.2.cmml" xref="S3.SS2.p2.10.m10.1.1.2.2">𝒟</ci><ci id="S3.SS2.p2.10.m10.1.1.2.3.cmml" xref="S3.SS2.p2.10.m10.1.1.2.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">\tilde{\mathcal{D}_{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m10.1d">over~ start_ARG caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> to avoid confusion).</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.6">Because most brain tumors are convex, circular, and irregularly shaped, it is essential to consider all of these three criteria when attempting to simulate pseudo-defective images. Therefore, we randomly select an image from <math alttext="\mathcal{D}_{G}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝒟</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathcal{D}_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> to generate the pseudo-defective images by inpainting an elliptic discrepancy in the brain image. We denote the pseudo anomalous images set as <math alttext="\mathcal{D}_{B}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝒟</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\mathcal{D}_{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>. Inspired by the Bezier Curve properties, we use the Bezier Curve formula to generate these random elliptic defects. First, the rough location of the brain is located by using simple image morphology and thresholding. This is to refine the position of the elliptic defects such that it is not generated outside the brain. Next, we randomly pick several points within the brain and used them as the fixed points in the Bezier Curve. These fixed points are certain to be convex within the convex hull. Finally, we just fill in the convex hull with random Gaussian Noise and inpaint it into the normal image. Our algorithm allows the generation of elliptic defects with different shapes and complexity. By increasing the number of fixed points <math alttext="N_{C}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">N</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑁</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">N_{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_N start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT</annotation></semantics></math> in the Bezier Curve, we increase the complexity of the generated spot. To introduce some degree of randomness in the Bezier Curve, we can adjust the smoothness of the curve about the fixed points with <math alttext="E" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_E</annotation></semantics></math>. In this paper, we set <math alttext="N_{C}=5" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><msub id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2.2" xref="S3.SS2.p3.5.m5.1.1.2.2.cmml">N</mi><mi id="S3.SS2.p3.5.m5.1.1.2.3" xref="S3.SS2.p3.5.m5.1.1.2.3.cmml">C</mi></msub><mo id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><eq id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1"></eq><apply id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2.2">𝑁</ci><ci id="S3.SS2.p3.5.m5.1.1.2.3.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3">𝐶</ci></apply><cn id="S3.SS2.p3.5.m5.1.1.3.cmml" type="integer" xref="S3.SS2.p3.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">N_{C}=5</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_N start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT = 5</annotation></semantics></math> and <math alttext="E=0.05" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mrow id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">E</mi><mo id="S3.SS2.p3.6.m6.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><eq id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1"></eq><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝐸</ci><cn id="S3.SS2.p3.6.m6.1.1.3.cmml" type="float" xref="S3.SS2.p3.6.m6.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">E=0.05</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_E = 0.05</annotation></semantics></math>. Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#alg1" title="Algorithm 1 ‣ 3.2 Adversarial Image Pair Synthesise ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">1</span></a> shows the algorithm to generate these random spots.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Algorithm to Generate Elliptic Defects</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> <math alttext="shape" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">s</mi><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">h</mi><mo id="alg1.l1.m1.1.1.1a" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.4" xref="alg1.l1.m1.1.1.4.cmml">a</mi><mo id="alg1.l1.m1.1.1.1b" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.5" xref="alg1.l1.m1.1.1.5.cmml">p</mi><mo id="alg1.l1.m1.1.1.1c" xref="alg1.l1.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.6" xref="alg1.l1.m1.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><times id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></times><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝑠</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">ℎ</ci><ci id="alg1.l1.m1.1.1.4.cmml" xref="alg1.l1.m1.1.1.4">𝑎</ci><ci id="alg1.l1.m1.1.1.5.cmml" xref="alg1.l1.m1.1.1.5">𝑝</ci><ci id="alg1.l1.m1.1.1.6.cmml" xref="alg1.l1.m1.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">shape</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_s italic_h italic_a italic_p italic_e</annotation></semantics></math>, <math alttext="N\_C" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">N</mi><mo id="alg1.l1.m2.1.1.1" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.3" mathvariant="normal" xref="alg1.l1.m2.1.1.3.cmml">_</mi><mo id="alg1.l1.m2.1.1.1a" xref="alg1.l1.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m2.1.1.4" xref="alg1.l1.m2.1.1.4.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><times id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1.1"></times><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝑁</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">_</ci><ci id="alg1.l1.m2.1.1.4.cmml" xref="alg1.l1.m2.1.1.4">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">N\_C</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_N _ italic_C</annotation></semantics></math>, <math alttext="E" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_E</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2">Output:</span> Defect image <math alttext="img" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">m</mi><mo id="alg1.l2.m1.1.1.1a" xref="alg1.l2.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.4" xref="alg1.l2.m1.1.1.4.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><times id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></times><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑖</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑚</ci><ci id="alg1.l2.m1.1.1.4.cmml" xref="alg1.l2.m1.1.1.4">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">img</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_i italic_m italic_g</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><math alttext="\mu\leftarrow\text{randint}(0,255)" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mi id="alg1.l3.m1.2.3.2" xref="alg1.l3.m1.2.3.2.cmml">μ</mi><mo id="alg1.l3.m1.2.3.1" stretchy="false" xref="alg1.l3.m1.2.3.1.cmml">←</mo><mrow id="alg1.l3.m1.2.3.3" xref="alg1.l3.m1.2.3.3.cmml"><mtext id="alg1.l3.m1.2.3.3.2" xref="alg1.l3.m1.2.3.3.2a.cmml">randint</mtext><mo id="alg1.l3.m1.2.3.3.1" xref="alg1.l3.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l3.m1.2.3.3.3.2" xref="alg1.l3.m1.2.3.3.3.1.cmml"><mo id="alg1.l3.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l3.m1.2.3.3.3.1.cmml">(</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">0</mn><mo id="alg1.l3.m1.2.3.3.3.2.2" xref="alg1.l3.m1.2.3.3.3.1.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">255</mn><mo id="alg1.l3.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l3.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><ci id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1">←</ci><ci id="alg1.l3.m1.2.3.2.cmml" xref="alg1.l3.m1.2.3.2">𝜇</ci><apply id="alg1.l3.m1.2.3.3.cmml" xref="alg1.l3.m1.2.3.3"><times id="alg1.l3.m1.2.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.1"></times><ci id="alg1.l3.m1.2.3.3.2a.cmml" xref="alg1.l3.m1.2.3.3.2"><mtext id="alg1.l3.m1.2.3.3.2.cmml" xref="alg1.l3.m1.2.3.3.2">randint</mtext></ci><interval closure="open" id="alg1.l3.m1.2.3.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.3.2"><cn id="alg1.l3.m1.1.1.cmml" type="integer" xref="alg1.l3.m1.1.1">0</cn><cn id="alg1.l3.m1.2.2.cmml" type="integer" xref="alg1.l3.m1.2.2">255</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">\mu\leftarrow\text{randint}(0,255)</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">italic_μ ← randint ( 0 , 255 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span><math alttext="\sigma\leftarrow\text{uniform}(10,20)" class="ltx_Math" display="inline" id="alg1.l4.m1.2"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.3" xref="alg1.l4.m1.2.3.cmml"><mi id="alg1.l4.m1.2.3.2" xref="alg1.l4.m1.2.3.2.cmml">σ</mi><mo id="alg1.l4.m1.2.3.1" stretchy="false" xref="alg1.l4.m1.2.3.1.cmml">←</mo><mrow id="alg1.l4.m1.2.3.3" xref="alg1.l4.m1.2.3.3.cmml"><mtext id="alg1.l4.m1.2.3.3.2" xref="alg1.l4.m1.2.3.3.2a.cmml">uniform</mtext><mo id="alg1.l4.m1.2.3.3.1" xref="alg1.l4.m1.2.3.3.1.cmml">⁢</mo><mrow id="alg1.l4.m1.2.3.3.3.2" xref="alg1.l4.m1.2.3.3.3.1.cmml"><mo id="alg1.l4.m1.2.3.3.3.2.1" stretchy="false" xref="alg1.l4.m1.2.3.3.3.1.cmml">(</mo><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">10</mn><mo id="alg1.l4.m1.2.3.3.3.2.2" xref="alg1.l4.m1.2.3.3.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">20</mn><mo id="alg1.l4.m1.2.3.3.3.2.3" stretchy="false" xref="alg1.l4.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.3.cmml" xref="alg1.l4.m1.2.3"><ci id="alg1.l4.m1.2.3.1.cmml" xref="alg1.l4.m1.2.3.1">←</ci><ci id="alg1.l4.m1.2.3.2.cmml" xref="alg1.l4.m1.2.3.2">𝜎</ci><apply id="alg1.l4.m1.2.3.3.cmml" xref="alg1.l4.m1.2.3.3"><times id="alg1.l4.m1.2.3.3.1.cmml" xref="alg1.l4.m1.2.3.3.1"></times><ci id="alg1.l4.m1.2.3.3.2a.cmml" xref="alg1.l4.m1.2.3.3.2"><mtext id="alg1.l4.m1.2.3.3.2.cmml" xref="alg1.l4.m1.2.3.3.2">uniform</mtext></ci><interval closure="open" id="alg1.l4.m1.2.3.3.3.1.cmml" xref="alg1.l4.m1.2.3.3.3.2"><cn id="alg1.l4.m1.1.1.cmml" type="integer" xref="alg1.l4.m1.1.1">10</cn><cn id="alg1.l4.m1.2.2.cmml" type="integer" xref="alg1.l4.m1.2.2">20</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">\sigma\leftarrow\text{uniform}(10,20)</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.2d">italic_σ ← uniform ( 10 , 20 )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><math alttext="points\leftarrow\text{GetRandomPoints}(N\_C)" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mrow id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml">p</mi><mo id="alg1.l5.m1.1.1.3.1" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">o</mi><mo id="alg1.l5.m1.1.1.3.1a" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.4" xref="alg1.l5.m1.1.1.3.4.cmml">i</mi><mo id="alg1.l5.m1.1.1.3.1b" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.5" xref="alg1.l5.m1.1.1.3.5.cmml">n</mi><mo id="alg1.l5.m1.1.1.3.1c" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.6" xref="alg1.l5.m1.1.1.3.6.cmml">t</mi><mo id="alg1.l5.m1.1.1.3.1d" xref="alg1.l5.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.3.7" xref="alg1.l5.m1.1.1.3.7.cmml">s</mi></mrow><mo id="alg1.l5.m1.1.1.2" stretchy="false" xref="alg1.l5.m1.1.1.2.cmml">←</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mtext id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3a.cmml">GetRandomPoints</mtext><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">N</mi><mo id="alg1.l5.m1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.1.1.3" mathvariant="normal" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">_</mi><mo id="alg1.l5.m1.1.1.1.1.1.1.1a" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.1.1.1.4" xref="alg1.l5.m1.1.1.1.1.1.1.4.cmml">C</mi></mrow><mo id="alg1.l5.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">←</ci><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><times id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.1"></times><ci id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2">𝑝</ci><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑜</ci><ci id="alg1.l5.m1.1.1.3.4.cmml" xref="alg1.l5.m1.1.1.3.4">𝑖</ci><ci id="alg1.l5.m1.1.1.3.5.cmml" xref="alg1.l5.m1.1.1.3.5">𝑛</ci><ci id="alg1.l5.m1.1.1.3.6.cmml" xref="alg1.l5.m1.1.1.3.6">𝑡</ci><ci id="alg1.l5.m1.1.1.3.7.cmml" xref="alg1.l5.m1.1.1.3.7">𝑠</ci></apply><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3a.cmml" xref="alg1.l5.m1.1.1.1.3"><mtext id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">GetRandomPoints</mtext></ci><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><times id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">𝑁</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">_</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">points\leftarrow\text{GetRandomPoints}(N\_C)</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_p italic_o italic_i italic_n italic_t italic_s ← GetRandomPoints ( italic_N _ italic_C )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span><math alttext="spot\leftarrow\text{GetBezierCurve}(points,E)" class="ltx_Math" display="inline" id="alg1.l6.m1.2"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><mrow id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.3.2" xref="alg1.l6.m1.2.2.3.2.cmml">s</mi><mo id="alg1.l6.m1.2.2.3.1" xref="alg1.l6.m1.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.3.3" xref="alg1.l6.m1.2.2.3.3.cmml">p</mi><mo id="alg1.l6.m1.2.2.3.1a" xref="alg1.l6.m1.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.3.4" xref="alg1.l6.m1.2.2.3.4.cmml">o</mi><mo id="alg1.l6.m1.2.2.3.1b" xref="alg1.l6.m1.2.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.3.5" xref="alg1.l6.m1.2.2.3.5.cmml">t</mi></mrow><mo id="alg1.l6.m1.2.2.2" stretchy="false" xref="alg1.l6.m1.2.2.2.cmml">←</mo><mrow id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.1.cmml"><mtext id="alg1.l6.m1.2.2.1.3" xref="alg1.l6.m1.2.2.1.3a.cmml">GetBezierCurve</mtext><mo id="alg1.l6.m1.2.2.1.2" xref="alg1.l6.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.2.cmml"><mo id="alg1.l6.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l6.m1.2.2.1.1.2.cmml">(</mo><mrow id="alg1.l6.m1.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.2.cmml">p</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.3.cmml">o</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.1a" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.1.1.1.4" xref="alg1.l6.m1.2.2.1.1.1.1.4.cmml">i</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.1b" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.1.1.1.5" xref="alg1.l6.m1.2.2.1.1.1.1.5.cmml">n</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.1c" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.1.1.1.6" xref="alg1.l6.m1.2.2.1.1.1.1.6.cmml">t</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.1d" xref="alg1.l6.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l6.m1.2.2.1.1.1.1.7" xref="alg1.l6.m1.2.2.1.1.1.1.7.cmml">s</mi></mrow><mo id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.2.cmml">,</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">E</mi><mo id="alg1.l6.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2">←</ci><apply id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"><times id="alg1.l6.m1.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.3.1"></times><ci id="alg1.l6.m1.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.3.2">𝑠</ci><ci id="alg1.l6.m1.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.3.3">𝑝</ci><ci id="alg1.l6.m1.2.2.3.4.cmml" xref="alg1.l6.m1.2.2.3.4">𝑜</ci><ci id="alg1.l6.m1.2.2.3.5.cmml" xref="alg1.l6.m1.2.2.3.5">𝑡</ci></apply><apply id="alg1.l6.m1.2.2.1.cmml" xref="alg1.l6.m1.2.2.1"><times id="alg1.l6.m1.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.1.2"></times><ci id="alg1.l6.m1.2.2.1.3a.cmml" xref="alg1.l6.m1.2.2.1.3"><mtext id="alg1.l6.m1.2.2.1.3.cmml" xref="alg1.l6.m1.2.2.1.3">GetBezierCurve</mtext></ci><interval closure="open" id="alg1.l6.m1.2.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1"><apply id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1"><times id="alg1.l6.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.1"></times><ci id="alg1.l6.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2">𝑝</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3">𝑜</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.4.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.4">𝑖</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.5.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.5">𝑛</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.6.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.6">𝑡</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.7.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.7">𝑠</ci></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝐸</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">spot\leftarrow\text{GetBezierCurve}(points,E)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.2d">italic_s italic_p italic_o italic_t ← GetBezierCurve ( italic_p italic_o italic_i italic_n italic_t italic_s , italic_E )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><math alttext="label\leftarrow" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mrow id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">l</mi><mo id="alg1.l7.m1.1.1.2.1" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">a</mi><mo id="alg1.l7.m1.1.1.2.1a" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.4" xref="alg1.l7.m1.1.1.2.4.cmml">b</mi><mo id="alg1.l7.m1.1.1.2.1b" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.5" xref="alg1.l7.m1.1.1.2.5.cmml">e</mi><mo id="alg1.l7.m1.1.1.2.1c" xref="alg1.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l7.m1.1.1.2.6" xref="alg1.l7.m1.1.1.2.6.cmml">l</mi></mrow><mo id="alg1.l7.m1.1.1.1" stretchy="false" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><times id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2.1"></times><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑙</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑎</ci><ci id="alg1.l7.m1.1.1.2.4.cmml" xref="alg1.l7.m1.1.1.2.4">𝑏</ci><ci id="alg1.l7.m1.1.1.2.5.cmml" xref="alg1.l7.m1.1.1.2.5">𝑒</ci><ci id="alg1.l7.m1.1.1.2.6.cmml" xref="alg1.l7.m1.1.1.2.6">𝑙</ci></apply><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">label\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_l italic_a italic_b italic_e italic_l ←</annotation></semantics></math> zero array with dimensions of <math alttext="shape" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml">s</mi><mo id="alg1.l7.m2.1.1.1" xref="alg1.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">h</mi><mo id="alg1.l7.m2.1.1.1a" xref="alg1.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l7.m2.1.1.4" xref="alg1.l7.m2.1.1.4.cmml">a</mi><mo id="alg1.l7.m2.1.1.1b" xref="alg1.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l7.m2.1.1.5" xref="alg1.l7.m2.1.1.5.cmml">p</mi><mo id="alg1.l7.m2.1.1.1c" xref="alg1.l7.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l7.m2.1.1.6" xref="alg1.l7.m2.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><times id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1.1"></times><ci id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2">𝑠</ci><ci id="alg1.l7.m2.1.1.3.cmml" xref="alg1.l7.m2.1.1.3">ℎ</ci><ci id="alg1.l7.m2.1.1.4.cmml" xref="alg1.l7.m2.1.1.4">𝑎</ci><ci id="alg1.l7.m2.1.1.5.cmml" xref="alg1.l7.m2.1.1.5">𝑝</ci><ci id="alg1.l7.m2.1.1.6.cmml" xref="alg1.l7.m2.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">shape</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_s italic_h italic_a italic_p italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><math alttext="img\leftarrow" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mrow id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">i</mi><mo id="alg1.l8.m1.1.1.2.1" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">m</mi><mo id="alg1.l8.m1.1.1.2.1a" xref="alg1.l8.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.4" xref="alg1.l8.m1.1.1.2.4.cmml">g</mi></mrow><mo id="alg1.l8.m1.1.1.1" stretchy="false" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><times id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2.1"></times><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑖</ci><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑚</ci><ci id="alg1.l8.m1.1.1.2.4.cmml" xref="alg1.l8.m1.1.1.2.4">𝑔</ci></apply><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">img\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_i italic_m italic_g ←</annotation></semantics></math> zero array with dimensions of <math alttext="shape" class="ltx_Math" display="inline" id="alg1.l8.m2.1"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">s</mi><mo id="alg1.l8.m2.1.1.1" xref="alg1.l8.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">h</mi><mo id="alg1.l8.m2.1.1.1a" xref="alg1.l8.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.4" xref="alg1.l8.m2.1.1.4.cmml">a</mi><mo id="alg1.l8.m2.1.1.1b" xref="alg1.l8.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.5" xref="alg1.l8.m2.1.1.5.cmml">p</mi><mo id="alg1.l8.m2.1.1.1c" xref="alg1.l8.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l8.m2.1.1.6" xref="alg1.l8.m2.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><times id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1.1"></times><ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">𝑠</ci><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">ℎ</ci><ci id="alg1.l8.m2.1.1.4.cmml" xref="alg1.l8.m2.1.1.4">𝑎</ci><ci id="alg1.l8.m2.1.1.5.cmml" xref="alg1.l8.m2.1.1.5">𝑝</ci><ci id="alg1.l8.m2.1.1.6.cmml" xref="alg1.l8.m2.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">shape</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m2.1d">italic_s italic_h italic_a italic_p italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>FillPoly(<math alttext="label" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">l</mi><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">a</mi><mo id="alg1.l9.m1.1.1.1a" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.4" xref="alg1.l9.m1.1.1.4.cmml">b</mi><mo id="alg1.l9.m1.1.1.1b" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.5" xref="alg1.l9.m1.1.1.5.cmml">e</mi><mo id="alg1.l9.m1.1.1.1c" xref="alg1.l9.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.6" xref="alg1.l9.m1.1.1.6.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><times id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></times><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑙</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑎</ci><ci id="alg1.l9.m1.1.1.4.cmml" xref="alg1.l9.m1.1.1.4">𝑏</ci><ci id="alg1.l9.m1.1.1.5.cmml" xref="alg1.l9.m1.1.1.5">𝑒</ci><ci id="alg1.l9.m1.1.1.6.cmml" xref="alg1.l9.m1.1.1.6">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">label</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_l italic_a italic_b italic_e italic_l</annotation></semantics></math>, <math alttext="spot" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">s</mi><mo id="alg1.l9.m2.1.1.1" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">p</mi><mo id="alg1.l9.m2.1.1.1a" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.4" xref="alg1.l9.m2.1.1.4.cmml">o</mi><mo id="alg1.l9.m2.1.1.1b" xref="alg1.l9.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.5" xref="alg1.l9.m2.1.1.5.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><times id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1"></times><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑠</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑝</ci><ci id="alg1.l9.m2.1.1.4.cmml" xref="alg1.l9.m2.1.1.4">𝑜</ci><ci id="alg1.l9.m2.1.1.5.cmml" xref="alg1.l9.m2.1.1.5">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">spot</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_s italic_p italic_o italic_t</annotation></semantics></math>, <math alttext="1" class="ltx_Math" display="inline" id="alg1.l9.m3.1"><semantics id="alg1.l9.m3.1a"><mn id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><cn id="alg1.l9.m3.1.1.cmml" type="integer" xref="alg1.l9.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m3.1d">1</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span><math alttext="noise\leftarrow\mathcal{N}(\mu=128,\sigma=128,shape=(15,15))" class="ltx_Math" display="inline" id="alg1.l10.m1.3"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml"><mrow id="alg1.l10.m1.3.3.3" xref="alg1.l10.m1.3.3.3.cmml"><mi id="alg1.l10.m1.3.3.3.2" xref="alg1.l10.m1.3.3.3.2.cmml">n</mi><mo id="alg1.l10.m1.3.3.3.1" xref="alg1.l10.m1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.3" xref="alg1.l10.m1.3.3.3.3.cmml">o</mi><mo id="alg1.l10.m1.3.3.3.1a" xref="alg1.l10.m1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.4" xref="alg1.l10.m1.3.3.3.4.cmml">i</mi><mo id="alg1.l10.m1.3.3.3.1b" xref="alg1.l10.m1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.5" xref="alg1.l10.m1.3.3.3.5.cmml">s</mi><mo id="alg1.l10.m1.3.3.3.1c" xref="alg1.l10.m1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.3.6" xref="alg1.l10.m1.3.3.3.6.cmml">e</mi></mrow><mo id="alg1.l10.m1.3.3.2" stretchy="false" xref="alg1.l10.m1.3.3.2.cmml">←</mo><mrow id="alg1.l10.m1.3.3.1" xref="alg1.l10.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.3.3.1.3" xref="alg1.l10.m1.3.3.1.3.cmml">𝒩</mi><mo id="alg1.l10.m1.3.3.1.2" xref="alg1.l10.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l10.m1.3.3.1.1.1" xref="alg1.l10.m1.3.3.1.cmml"><mo id="alg1.l10.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l10.m1.3.3.1.cmml">(</mo><mrow id="alg1.l10.m1.3.3.1.1.1.1.2" xref="alg1.l10.m1.3.3.1.1.1.1.3.cmml"><mrow id="alg1.l10.m1.3.3.1.1.1.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.3.3.1.1.1.1.1.1.2" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.2.cmml">μ</mi><mo id="alg1.l10.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.1.cmml">=</mo><mn id="alg1.l10.m1.3.3.1.1.1.1.1.1.3" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.3.cmml">128</mn></mrow><mo id="alg1.l10.m1.3.3.1.1.1.1.2.3" xref="alg1.l10.m1.3.3.1.1.1.1.3a.cmml">,</mo><mrow id="alg1.l10.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.3.cmml"><mrow id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.cmml"><mi id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.2.cmml">σ</mi><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.1.cmml">=</mo><mn id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.3" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.3.cmml">128</mn></mrow><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.3" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.cmml"><mrow id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml">s</mi><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.3" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.3.cmml">h</mi><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1a" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.4" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.4.cmml">a</mi><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1b" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.5" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.5.cmml">p</mi><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1c" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.6" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.6.cmml">e</mi></mrow><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.1" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.1.cmml">=</mo><mrow id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml"><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.2.1" stretchy="false" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml">(</mo><mn id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">15</mn><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.2.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml">,</mo><mn id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">15</mn><mo id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.2.3" stretchy="false" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="alg1.l10.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.l10.m1.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3"><ci id="alg1.l10.m1.3.3.2.cmml" xref="alg1.l10.m1.3.3.2">←</ci><apply id="alg1.l10.m1.3.3.3.cmml" xref="alg1.l10.m1.3.3.3"><times id="alg1.l10.m1.3.3.3.1.cmml" xref="alg1.l10.m1.3.3.3.1"></times><ci id="alg1.l10.m1.3.3.3.2.cmml" xref="alg1.l10.m1.3.3.3.2">𝑛</ci><ci id="alg1.l10.m1.3.3.3.3.cmml" xref="alg1.l10.m1.3.3.3.3">𝑜</ci><ci id="alg1.l10.m1.3.3.3.4.cmml" xref="alg1.l10.m1.3.3.3.4">𝑖</ci><ci id="alg1.l10.m1.3.3.3.5.cmml" xref="alg1.l10.m1.3.3.3.5">𝑠</ci><ci id="alg1.l10.m1.3.3.3.6.cmml" xref="alg1.l10.m1.3.3.3.6">𝑒</ci></apply><apply id="alg1.l10.m1.3.3.1.cmml" xref="alg1.l10.m1.3.3.1"><times id="alg1.l10.m1.3.3.1.2.cmml" xref="alg1.l10.m1.3.3.1.2"></times><ci id="alg1.l10.m1.3.3.1.3.cmml" xref="alg1.l10.m1.3.3.1.3">𝒩</ci><apply id="alg1.l10.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.1.1.1.1.3a.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="alg1.l10.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.1.1"><eq id="alg1.l10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.1"></eq><ci id="alg1.l10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.2">𝜇</ci><cn id="alg1.l10.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l10.m1.3.3.1.1.1.1.1.1.3">128</cn></apply><apply id="alg1.l10.m1.3.3.1.1.1.1.2.2.3.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.3.3.1.1.1.1.2.2.3a.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1"><eq id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.1"></eq><ci id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.2">𝜎</ci><cn id="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.3.cmml" type="integer" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.1.1.3">128</cn></apply><apply id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2"><eq id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.1"></eq><apply id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2"><times id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.1"></times><ci id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.2">𝑠</ci><ci id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.3">ℎ</ci><ci id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.4.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.4">𝑎</ci><ci id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.5.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.5">𝑝</ci><ci id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.6.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.2.6">𝑒</ci></apply><interval closure="open" id="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2.2.2.2.3.2"><cn id="alg1.l10.m1.1.1.cmml" type="integer" xref="alg1.l10.m1.1.1">15</cn><cn id="alg1.l10.m1.2.2.cmml" type="integer" xref="alg1.l10.m1.2.2">15</cn></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">noise\leftarrow\mathcal{N}(\mu=128,\sigma=128,shape=(15,15))</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.3d">italic_n italic_o italic_i italic_s italic_e ← caligraphic_N ( italic_μ = 128 , italic_σ = 128 , italic_s italic_h italic_a italic_p italic_e = ( 15 , 15 ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span><math alttext="noise\leftarrow" class="ltx_Math" display="inline" id="alg1.l11.m1.1"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mrow id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml"><mi id="alg1.l11.m1.1.1.2.2" xref="alg1.l11.m1.1.1.2.2.cmml">n</mi><mo id="alg1.l11.m1.1.1.2.1" xref="alg1.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.2.3" xref="alg1.l11.m1.1.1.2.3.cmml">o</mi><mo id="alg1.l11.m1.1.1.2.1a" xref="alg1.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.2.4" xref="alg1.l11.m1.1.1.2.4.cmml">i</mi><mo id="alg1.l11.m1.1.1.2.1b" xref="alg1.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.2.5" xref="alg1.l11.m1.1.1.2.5.cmml">s</mi><mo id="alg1.l11.m1.1.1.2.1c" xref="alg1.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l11.m1.1.1.2.6" xref="alg1.l11.m1.1.1.2.6.cmml">e</mi></mrow><mo id="alg1.l11.m1.1.1.1" stretchy="false" xref="alg1.l11.m1.1.1.1.cmml">←</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><ci id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">←</ci><apply id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2"><times id="alg1.l11.m1.1.1.2.1.cmml" xref="alg1.l11.m1.1.1.2.1"></times><ci id="alg1.l11.m1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.2.2">𝑛</ci><ci id="alg1.l11.m1.1.1.2.3.cmml" xref="alg1.l11.m1.1.1.2.3">𝑜</ci><ci id="alg1.l11.m1.1.1.2.4.cmml" xref="alg1.l11.m1.1.1.2.4">𝑖</ci><ci id="alg1.l11.m1.1.1.2.5.cmml" xref="alg1.l11.m1.1.1.2.5">𝑠</ci><ci id="alg1.l11.m1.1.1.2.6.cmml" xref="alg1.l11.m1.1.1.2.6">𝑒</ci></apply><csymbol cd="latexml" id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">noise\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.1d">italic_n italic_o italic_i italic_s italic_e ←</annotation></semantics></math> Resize(<math alttext="noise" class="ltx_Math" display="inline" id="alg1.l11.m2.1"><semantics id="alg1.l11.m2.1a"><mrow id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">n</mi><mo id="alg1.l11.m2.1.1.1" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">o</mi><mo id="alg1.l11.m2.1.1.1a" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.4" xref="alg1.l11.m2.1.1.4.cmml">i</mi><mo id="alg1.l11.m2.1.1.1b" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.5" xref="alg1.l11.m2.1.1.5.cmml">s</mi><mo id="alg1.l11.m2.1.1.1c" xref="alg1.l11.m2.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m2.1.1.6" xref="alg1.l11.m2.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><times id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1.1"></times><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑛</ci><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑜</ci><ci id="alg1.l11.m2.1.1.4.cmml" xref="alg1.l11.m2.1.1.4">𝑖</ci><ci id="alg1.l11.m2.1.1.5.cmml" xref="alg1.l11.m2.1.1.5">𝑠</ci><ci id="alg1.l11.m2.1.1.6.cmml" xref="alg1.l11.m2.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">noise</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m2.1d">italic_n italic_o italic_i italic_s italic_e</annotation></semantics></math>, <math alttext="shape" class="ltx_Math" display="inline" id="alg1.l11.m3.1"><semantics id="alg1.l11.m3.1a"><mrow id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi id="alg1.l11.m3.1.1.2" xref="alg1.l11.m3.1.1.2.cmml">s</mi><mo id="alg1.l11.m3.1.1.1" xref="alg1.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">h</mi><mo id="alg1.l11.m3.1.1.1a" xref="alg1.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m3.1.1.4" xref="alg1.l11.m3.1.1.4.cmml">a</mi><mo id="alg1.l11.m3.1.1.1b" xref="alg1.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m3.1.1.5" xref="alg1.l11.m3.1.1.5.cmml">p</mi><mo id="alg1.l11.m3.1.1.1c" xref="alg1.l11.m3.1.1.1.cmml">⁢</mo><mi id="alg1.l11.m3.1.1.6" xref="alg1.l11.m3.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><times id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1.1"></times><ci id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1.2">𝑠</ci><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">ℎ</ci><ci id="alg1.l11.m3.1.1.4.cmml" xref="alg1.l11.m3.1.1.4">𝑎</ci><ci id="alg1.l11.m3.1.1.5.cmml" xref="alg1.l11.m3.1.1.5">𝑝</ci><ci id="alg1.l11.m3.1.1.6.cmml" xref="alg1.l11.m3.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">shape</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m3.1d">italic_s italic_h italic_a italic_p italic_e</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span><math alttext="img\{label=1\}\leftarrow noise\{label=1\}" class="ltx_Math" display="inline" id="alg1.l12.m1.2"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml"><mrow id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.3" xref="alg1.l12.m1.1.1.1.3.cmml">i</mi><mo id="alg1.l12.m1.1.1.1.2" xref="alg1.l12.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.4" xref="alg1.l12.m1.1.1.1.4.cmml">m</mi><mo id="alg1.l12.m1.1.1.1.2a" xref="alg1.l12.m1.1.1.1.2.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.5" xref="alg1.l12.m1.1.1.1.5.cmml">g</mi><mo id="alg1.l12.m1.1.1.1.2b" xref="alg1.l12.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l12.m1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.2.cmml"><mo id="alg1.l12.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l12.m1.1.1.1.1.2.cmml">{</mo><mrow id="alg1.l12.m1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.cmml"><mrow id="alg1.l12.m1.1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.1.2.2" xref="alg1.l12.m1.1.1.1.1.1.1.2.2.cmml">l</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.2.1" xref="alg1.l12.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.2.3" xref="alg1.l12.m1.1.1.1.1.1.1.2.3.cmml">a</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.2.1a" xref="alg1.l12.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.2.4" xref="alg1.l12.m1.1.1.1.1.1.1.2.4.cmml">b</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.2.1b" xref="alg1.l12.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.2.5" xref="alg1.l12.m1.1.1.1.1.1.1.2.5.cmml">e</mi><mo id="alg1.l12.m1.1.1.1.1.1.1.2.1c" xref="alg1.l12.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.1.1.1.1.1.1.2.6" xref="alg1.l12.m1.1.1.1.1.1.1.2.6.cmml">l</mi></mrow><mo id="alg1.l12.m1.1.1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.1.1.cmml">=</mo><mn id="alg1.l12.m1.1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l12.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l12.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="alg1.l12.m1.2.2.3" stretchy="false" xref="alg1.l12.m1.2.2.3.cmml">←</mo><mrow id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.2.cmml"><mi id="alg1.l12.m1.2.2.2.3" xref="alg1.l12.m1.2.2.2.3.cmml">n</mi><mo id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.4" xref="alg1.l12.m1.2.2.2.4.cmml">o</mi><mo id="alg1.l12.m1.2.2.2.2a" xref="alg1.l12.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.5" xref="alg1.l12.m1.2.2.2.5.cmml">i</mi><mo id="alg1.l12.m1.2.2.2.2b" xref="alg1.l12.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.6" xref="alg1.l12.m1.2.2.2.6.cmml">s</mi><mo id="alg1.l12.m1.2.2.2.2c" xref="alg1.l12.m1.2.2.2.2.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.7" xref="alg1.l12.m1.2.2.2.7.cmml">e</mi><mo id="alg1.l12.m1.2.2.2.2d" xref="alg1.l12.m1.2.2.2.2.cmml">⁢</mo><mrow id="alg1.l12.m1.2.2.2.1.1" xref="alg1.l12.m1.2.2.2.1.2.cmml"><mo id="alg1.l12.m1.2.2.2.1.1.2" stretchy="false" xref="alg1.l12.m1.2.2.2.1.2.cmml">{</mo><mrow id="alg1.l12.m1.2.2.2.1.1.1" xref="alg1.l12.m1.2.2.2.1.1.1.cmml"><mrow id="alg1.l12.m1.2.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.2.1.1.1.2.cmml"><mi id="alg1.l12.m1.2.2.2.1.1.1.2.2" xref="alg1.l12.m1.2.2.2.1.1.1.2.2.cmml">l</mi><mo id="alg1.l12.m1.2.2.2.1.1.1.2.1" xref="alg1.l12.m1.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.1.1.1.2.3" xref="alg1.l12.m1.2.2.2.1.1.1.2.3.cmml">a</mi><mo id="alg1.l12.m1.2.2.2.1.1.1.2.1a" xref="alg1.l12.m1.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.1.1.1.2.4" xref="alg1.l12.m1.2.2.2.1.1.1.2.4.cmml">b</mi><mo id="alg1.l12.m1.2.2.2.1.1.1.2.1b" xref="alg1.l12.m1.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.1.1.1.2.5" xref="alg1.l12.m1.2.2.2.1.1.1.2.5.cmml">e</mi><mo id="alg1.l12.m1.2.2.2.1.1.1.2.1c" xref="alg1.l12.m1.2.2.2.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l12.m1.2.2.2.1.1.1.2.6" xref="alg1.l12.m1.2.2.2.1.1.1.2.6.cmml">l</mi></mrow><mo id="alg1.l12.m1.2.2.2.1.1.1.1" xref="alg1.l12.m1.2.2.2.1.1.1.1.cmml">=</mo><mn id="alg1.l12.m1.2.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="alg1.l12.m1.2.2.2.1.1.3" stretchy="false" xref="alg1.l12.m1.2.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2"><ci id="alg1.l12.m1.2.2.3.cmml" xref="alg1.l12.m1.2.2.3">←</ci><apply id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"><times id="alg1.l12.m1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.2"></times><ci id="alg1.l12.m1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.3">𝑖</ci><ci id="alg1.l12.m1.1.1.1.4.cmml" xref="alg1.l12.m1.1.1.1.4">𝑚</ci><ci id="alg1.l12.m1.1.1.1.5.cmml" xref="alg1.l12.m1.1.1.1.5">𝑔</ci><set id="alg1.l12.m1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1"><apply id="alg1.l12.m1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1"><eq id="alg1.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.1"></eq><apply id="alg1.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2"><times id="alg1.l12.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.1"></times><ci id="alg1.l12.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.2">𝑙</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.3">𝑎</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.2.4.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.4">𝑏</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.2.5.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.5">𝑒</ci><ci id="alg1.l12.m1.1.1.1.1.1.1.2.6.cmml" xref="alg1.l12.m1.1.1.1.1.1.1.2.6">𝑙</ci></apply><cn id="alg1.l12.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.1.1.1.1.1.1.3">1</cn></apply></set></apply><apply id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.2"><times id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2"></times><ci id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.3">𝑛</ci><ci id="alg1.l12.m1.2.2.2.4.cmml" xref="alg1.l12.m1.2.2.2.4">𝑜</ci><ci id="alg1.l12.m1.2.2.2.5.cmml" xref="alg1.l12.m1.2.2.2.5">𝑖</ci><ci id="alg1.l12.m1.2.2.2.6.cmml" xref="alg1.l12.m1.2.2.2.6">𝑠</ci><ci id="alg1.l12.m1.2.2.2.7.cmml" xref="alg1.l12.m1.2.2.2.7">𝑒</ci><set id="alg1.l12.m1.2.2.2.1.2.cmml" xref="alg1.l12.m1.2.2.2.1.1"><apply id="alg1.l12.m1.2.2.2.1.1.1.cmml" xref="alg1.l12.m1.2.2.2.1.1.1"><eq id="alg1.l12.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.1"></eq><apply id="alg1.l12.m1.2.2.2.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2"><times id="alg1.l12.m1.2.2.2.1.1.1.2.1.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2.1"></times><ci id="alg1.l12.m1.2.2.2.1.1.1.2.2.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2.2">𝑙</ci><ci id="alg1.l12.m1.2.2.2.1.1.1.2.3.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2.3">𝑎</ci><ci id="alg1.l12.m1.2.2.2.1.1.1.2.4.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2.4">𝑏</ci><ci id="alg1.l12.m1.2.2.2.1.1.1.2.5.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2.5">𝑒</ci><ci id="alg1.l12.m1.2.2.2.1.1.1.2.6.cmml" xref="alg1.l12.m1.2.2.2.1.1.1.2.6">𝑙</ci></apply><cn id="alg1.l12.m1.2.2.2.1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.2.2.2.1.1.1.3">1</cn></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">img\{label=1\}\leftarrow noise\{label=1\}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.2d">italic_i italic_m italic_g { italic_l italic_a italic_b italic_e italic_l = 1 } ← italic_n italic_o italic_i italic_s italic_e { italic_l italic_a italic_b italic_e italic_l = 1 }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l13.2">return</span> <math alttext="img" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">m</mi><mo id="alg1.l13.m1.1.1.1a" xref="alg1.l13.m1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.4" xref="alg1.l13.m1.1.1.4.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><times id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></times><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">𝑖</ci><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑚</ci><ci id="alg1.l13.m1.1.1.4.cmml" xref="alg1.l13.m1.1.1.4">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">img</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_i italic_m italic_g</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Context-Aware Contrastive Learning for MRI Anomaly Detection</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The image pair synthesis pipeline creates a set of training image pairs consisting of healthy and pseudo-unhealthy images. With these synthesized image pairs, we fine-tune the feature extractor to enable the model to better discriminate between good and bad images.
We propose context-aware contrastive learning by incorporating a lightweight attention module into the feature extractor, focusing on the anomalous region.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.5">Contrastive learning is to maximize the similarity of the normal features and better discriminate anomalous features from normal features. Concretely, it maximizes <math alttext="\lvert x(i,j)-\mathcal{M}\rvert^{2}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.3"><semantics id="S3.SS3.p2.1.m1.3a"><msup id="S3.SS3.p2.1.m1.3.3" xref="S3.SS3.p2.1.m1.3.3.cmml"><mrow id="S3.SS3.p2.1.m1.3.3.1.1" xref="S3.SS3.p2.1.m1.3.3.1.2.cmml"><mo id="S3.SS3.p2.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS3.p2.1.m1.3.3.1.2.1.cmml">|</mo><mrow id="S3.SS3.p2.1.m1.3.3.1.1.1" xref="S3.SS3.p2.1.m1.3.3.1.1.1.cmml"><mrow id="S3.SS3.p2.1.m1.3.3.1.1.1.2" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.cmml"><mi id="S3.SS3.p2.1.m1.3.3.1.1.1.2.2" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.2.cmml">x</mi><mo id="S3.SS3.p2.1.m1.3.3.1.1.1.2.1" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.2" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.1.cmml"><mo id="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.1.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">i</mi><mo id="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.2.2" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.1.cmml">,</mo><mi id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">j</mi><mo id="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.2.3" stretchy="false" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.1.m1.3.3.1.1.1.1" xref="S3.SS3.p2.1.m1.3.3.1.1.1.1.cmml">−</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.3.3.1.1.1.3" xref="S3.SS3.p2.1.m1.3.3.1.1.1.3.cmml">ℳ</mi></mrow><mo id="S3.SS3.p2.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS3.p2.1.m1.3.3.1.2.1.cmml">|</mo></mrow><mn id="S3.SS3.p2.1.m1.3.3.3" xref="S3.SS3.p2.1.m1.3.3.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.3b"><apply id="S3.SS3.p2.1.m1.3.3.cmml" xref="S3.SS3.p2.1.m1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.3.3.2.cmml" xref="S3.SS3.p2.1.m1.3.3">superscript</csymbol><apply id="S3.SS3.p2.1.m1.3.3.1.2.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1"><abs id="S3.SS3.p2.1.m1.3.3.1.2.1.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.2"></abs><apply id="S3.SS3.p2.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1"><minus id="S3.SS3.p2.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1.1"></minus><apply id="S3.SS3.p2.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2"><times id="S3.SS3.p2.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.1"></times><ci id="S3.SS3.p2.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.2">𝑥</ci><interval closure="open" id="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1.2.3.2"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑖</ci><ci id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">𝑗</ci></interval></apply><ci id="S3.SS3.p2.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.3.3.1.1.1.3">ℳ</ci></apply></apply><cn id="S3.SS3.p2.1.m1.3.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.3.3.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.3c">\lvert x(i,j)-\mathcal{M}\rvert^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.3d">| italic_x ( italic_i , italic_j ) - caligraphic_M | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> in the anomalous region and vice versa, where <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">caligraphic_M</annotation></semantics></math> is the normal features. First, we select an image from <math alttext="\tilde{\mathcal{D}_{G}}" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mover accent="true" id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><msub id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.p2.3.m3.1.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.3.cmml">G</mi></msub><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><ci id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1">~</ci><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">𝒟</ci><ci id="S3.SS3.p2.3.m3.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\tilde{\mathcal{D}_{G}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">over~ start_ARG caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> as the anchor image. We pull <math alttext="\mathcal{D}_{G}" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝒟</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\mathcal{D}_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">caligraphic_D start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> (excluding the anchor image) closer to the anchor image and push <math alttext="\mathcal{D}_{B}" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">𝒟</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝒟</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\mathcal{D}_{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> away from the anchor image.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">Next, the attention module learns to pay more attention to anomalous regions and facilitates normal feature generalizability through contrastive learning. Our first approach uses anchor loss, a popular contrastive loss. Anchor loss perfectly fits with anomaly detection problems by minimizing the distance between normal features and maximizing interclass distance. Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.E2" title="In 3.3 Context-Aware Contrastive Learning for MRI Anomaly Detection ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">2</span></a> shows the formula for anchor loss.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="445" id="S3.F3.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Architecture of the CONSULT Model.
CONSULT uses a ResNet backbone as the feature extractor.
We incorporate context-aware attention modules after each ResBlocks and replace the activation function with Leaky ReLU.
We choose the first, second, and third feature maps to perform context-aware contrastive learning. Each layer feature is aggregated through resize and concatenation.
The context-aware contrastive learning trains the attention module to focus on anomalous regions iteratively, enhancing the robustness of feature extraction. An illustrative attention mechanism visualization is provided, showcasing the model’s focus on real anomalous regions within MRI images, derived by averaging the first dimension of the attention maps.
On the other hand, the features of the anchor image are passed to the self-supervised feature adversarial learning to maximize the similarity between the normal features while maintaining representative features.
</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{anchor}=\max(0,\alpha_{0}\cdot d_{\text{pull}}-\alpha_{1}\cdot d_{\text{%
push}}+m)" class="ltx_Math" display="block" id="S3.E2.m1.3"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><msub id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.2" xref="S3.E2.m1.3.3.3.2.cmml">L</mi><mrow id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.3.2" xref="S3.E2.m1.3.3.3.3.2.cmml">a</mi><mo id="S3.E2.m1.3.3.3.3.1" xref="S3.E2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.3.3" xref="S3.E2.m1.3.3.3.3.3.cmml">n</mi><mo id="S3.E2.m1.3.3.3.3.1a" xref="S3.E2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.3.4" xref="S3.E2.m1.3.3.3.3.4.cmml">c</mi><mo id="S3.E2.m1.3.3.3.3.1b" xref="S3.E2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.3.5" xref="S3.E2.m1.3.3.3.3.5.cmml">h</mi><mo id="S3.E2.m1.3.3.3.3.1c" xref="S3.E2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.3.6" xref="S3.E2.m1.3.3.3.3.6.cmml">o</mi><mo id="S3.E2.m1.3.3.3.3.1d" xref="S3.E2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.3.3.7" xref="S3.E2.m1.3.3.3.3.7.cmml">r</mi></mrow></msub><mo id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.2.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">max</mi><mo id="S3.E2.m1.3.3.1.1a" xref="S3.E2.m1.3.3.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.2.cmml"><mo id="S3.E2.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.2.cmml">(</mo><mn id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">0</mn><mo id="S3.E2.m1.3.3.1.1.1.3" xref="S3.E2.m1.3.3.1.2.cmml">,</mo><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.3.3.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.cmml"><msub id="S3.E2.m1.3.3.1.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.2.cmml">α</mi><mn id="S3.E2.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.3.cmml">0</mn></msub><mo id="S3.E2.m1.3.3.1.1.1.1.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.3.3.1.1.1.1.2.2.1.cmml">⋅</mo><msub id="S3.E2.m1.3.3.1.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.2.cmml">d</mi><mtext id="S3.E2.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.3a.cmml">pull</mtext></msub></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.2.1" xref="S3.E2.m1.3.3.1.1.1.1.2.1.cmml">−</mo><mrow id="S3.E2.m1.3.3.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.cmml"><msub id="S3.E2.m1.3.3.1.1.1.1.2.3.2" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.3.2.2" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2.2.cmml">α</mi><mn id="S3.E2.m1.3.3.1.1.1.1.2.3.2.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.3.3.1.1.1.1.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.3.3.1.1.1.1.2.3.1.cmml">⋅</mo><msub id="S3.E2.m1.3.3.1.1.1.1.2.3.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2.3.3.2" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.2.cmml">d</mi><mtext id="S3.E2.m1.3.3.1.1.1.1.2.3.3.3" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.3a.cmml">push</mtext></msub></mrow></mrow><mo id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml">+</mo><mi id="S3.E2.m1.3.3.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.3.cmml">m</mi></mrow><mo id="S3.E2.m1.3.3.1.1.1.4" stretchy="false" xref="S3.E2.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><eq id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"></eq><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.2">𝐿</ci><apply id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3"><times id="S3.E2.m1.3.3.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.1"></times><ci id="S3.E2.m1.3.3.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.2">𝑎</ci><ci id="S3.E2.m1.3.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3">𝑛</ci><ci id="S3.E2.m1.3.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.3.4">𝑐</ci><ci id="S3.E2.m1.3.3.3.3.5.cmml" xref="S3.E2.m1.3.3.3.3.5">ℎ</ci><ci id="S3.E2.m1.3.3.3.3.6.cmml" xref="S3.E2.m1.3.3.3.3.6">𝑜</ci><ci id="S3.E2.m1.3.3.3.3.7.cmml" xref="S3.E2.m1.3.3.3.3.7">𝑟</ci></apply></apply><apply id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.1"><max id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"></max><cn id="S3.E2.m1.2.2.cmml" type="integer" xref="S3.E2.m1.2.2">0</cn><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><plus id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"></plus><apply id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2"><minus id="S3.E2.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.1"></minus><apply id="S3.E2.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2"><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.1">⋅</ci><apply id="S3.E2.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.2">𝛼</ci><cn id="S3.E2.m1.3.3.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.1.1.2.2.2.3">0</cn></apply><apply id="S3.E2.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.2">𝑑</ci><ci id="S3.E2.m1.3.3.1.1.1.1.2.2.3.3a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.3"><mtext id="S3.E2.m1.3.3.1.1.1.1.2.2.3.3.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.1.1.1.2.2.3.3">pull</mtext></ci></apply></apply><apply id="S3.E2.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3"><ci id="S3.E2.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.1">⋅</ci><apply id="S3.E2.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.3.2.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.2.3.2.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2.2">𝛼</ci><cn id="S3.E2.m1.3.3.1.1.1.1.2.3.2.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.1.1.2.3.2.3">1</cn></apply><apply id="S3.E2.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.2.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.2.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.2">𝑑</ci><ci id="S3.E2.m1.3.3.1.1.1.1.2.3.3.3a.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.3"><mtext id="S3.E2.m1.3.3.1.1.1.1.2.3.3.3.cmml" mathsize="70%" xref="S3.E2.m1.3.3.1.1.1.1.2.3.3.3">push</mtext></ci></apply></apply></apply><ci id="S3.E2.m1.3.3.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">L_{anchor}=\max(0,\alpha_{0}\cdot d_{\text{pull}}-\alpha_{1}\cdot d_{\text{%
push}}+m)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.3d">italic_L start_POSTSUBSCRIPT italic_a italic_n italic_c italic_h italic_o italic_r end_POSTSUBSCRIPT = roman_max ( 0 , italic_α start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT pull end_POSTSUBSCRIPT - italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT push end_POSTSUBSCRIPT + italic_m )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.2">However, anchor loss suffers from slow convergence and has multiple solutions, destabilizing training. Inspired by the hyperbolic tangent function, we propose a novel loss function, termed <span class="ltx_text ltx_markedasmath" id="S3.SS3.p5.2.1">Tritanh</span> loss, that is more stable and has a more robust gradient flow. Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.E3" title="In 3.3 Context-Aware Contrastive Learning for MRI Anomaly Detection ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">3</span></a> show the proposed <span class="ltx_text ltx_markedasmath" id="S3.SS3.p5.2.2">Tritanh</span> loss.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{Tritanh}=\dfrac{e^{\lambda_{0}\cdot d_{\text{pull}}}-e^{\lambda_{1}\cdot d_%
{\text{push}}}+m_{0}}{e^{\lambda_{0}\cdot d_{\text{pull}}}+e^{\lambda_{1}\cdot
d%
_{\text{push}}}+m_{1}}" class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">L</mi><mrow id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1.2.3.2" xref="S3.E3.m1.1.1.2.3.2.cmml">T</mi><mo id="S3.E3.m1.1.1.2.3.1" xref="S3.E3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.3" xref="S3.E3.m1.1.1.2.3.3.cmml">r</mi><mo id="S3.E3.m1.1.1.2.3.1a" xref="S3.E3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.4" xref="S3.E3.m1.1.1.2.3.4.cmml">i</mi><mo id="S3.E3.m1.1.1.2.3.1b" xref="S3.E3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.5" xref="S3.E3.m1.1.1.2.3.5.cmml">t</mi><mo id="S3.E3.m1.1.1.2.3.1c" xref="S3.E3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.6" xref="S3.E3.m1.1.1.2.3.6.cmml">a</mi><mo id="S3.E3.m1.1.1.2.3.1d" xref="S3.E3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.7" xref="S3.E3.m1.1.1.2.3.7.cmml">n</mi><mo id="S3.E3.m1.1.1.2.3.1e" xref="S3.E3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.2.3.8" xref="S3.E3.m1.1.1.2.3.8.cmml">h</mi></mrow></msub><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mfrac id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mrow id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mrow id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml"><msup id="S3.E3.m1.1.1.3.2.2.2" xref="S3.E3.m1.1.1.3.2.2.2.cmml"><mi id="S3.E3.m1.1.1.3.2.2.2.2" xref="S3.E3.m1.1.1.3.2.2.2.2.cmml">e</mi><mrow id="S3.E3.m1.1.1.3.2.2.2.3" xref="S3.E3.m1.1.1.3.2.2.2.3.cmml"><msub id="S3.E3.m1.1.1.3.2.2.2.3.2" xref="S3.E3.m1.1.1.3.2.2.2.3.2.cmml"><mi id="S3.E3.m1.1.1.3.2.2.2.3.2.2" xref="S3.E3.m1.1.1.3.2.2.2.3.2.2.cmml">λ</mi><mn id="S3.E3.m1.1.1.3.2.2.2.3.2.3" xref="S3.E3.m1.1.1.3.2.2.2.3.2.3.cmml">0</mn></msub><mo id="S3.E3.m1.1.1.3.2.2.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.1.1.3.2.2.2.3.1.cmml">⋅</mo><msub id="S3.E3.m1.1.1.3.2.2.2.3.3" xref="S3.E3.m1.1.1.3.2.2.2.3.3.cmml"><mi id="S3.E3.m1.1.1.3.2.2.2.3.3.2" xref="S3.E3.m1.1.1.3.2.2.2.3.3.2.cmml">d</mi><mtext id="S3.E3.m1.1.1.3.2.2.2.3.3.3" xref="S3.E3.m1.1.1.3.2.2.2.3.3.3a.cmml">pull</mtext></msub></mrow></msup><mo id="S3.E3.m1.1.1.3.2.2.1" xref="S3.E3.m1.1.1.3.2.2.1.cmml">−</mo><msup id="S3.E3.m1.1.1.3.2.2.3" xref="S3.E3.m1.1.1.3.2.2.3.cmml"><mi id="S3.E3.m1.1.1.3.2.2.3.2" xref="S3.E3.m1.1.1.3.2.2.3.2.cmml">e</mi><mrow id="S3.E3.m1.1.1.3.2.2.3.3" xref="S3.E3.m1.1.1.3.2.2.3.3.cmml"><msub id="S3.E3.m1.1.1.3.2.2.3.3.2" xref="S3.E3.m1.1.1.3.2.2.3.3.2.cmml"><mi id="S3.E3.m1.1.1.3.2.2.3.3.2.2" xref="S3.E3.m1.1.1.3.2.2.3.3.2.2.cmml">λ</mi><mn id="S3.E3.m1.1.1.3.2.2.3.3.2.3" xref="S3.E3.m1.1.1.3.2.2.3.3.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.1.1.3.2.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.1.1.3.2.2.3.3.1.cmml">⋅</mo><msub id="S3.E3.m1.1.1.3.2.2.3.3.3" xref="S3.E3.m1.1.1.3.2.2.3.3.3.cmml"><mi id="S3.E3.m1.1.1.3.2.2.3.3.3.2" xref="S3.E3.m1.1.1.3.2.2.3.3.3.2.cmml">d</mi><mtext id="S3.E3.m1.1.1.3.2.2.3.3.3.3" xref="S3.E3.m1.1.1.3.2.2.3.3.3.3a.cmml">push</mtext></msub></mrow></msup></mrow><mo id="S3.E3.m1.1.1.3.2.1" xref="S3.E3.m1.1.1.3.2.1.cmml">+</mo><msub id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.2.3.2" xref="S3.E3.m1.1.1.3.2.3.2.cmml">m</mi><mn id="S3.E3.m1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.3.2.3.3.cmml">0</mn></msub></mrow><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><msup id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml"><mi id="S3.E3.m1.1.1.3.3.2.2" xref="S3.E3.m1.1.1.3.3.2.2.cmml">e</mi><mrow id="S3.E3.m1.1.1.3.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.cmml"><msub id="S3.E3.m1.1.1.3.3.2.3.2" xref="S3.E3.m1.1.1.3.3.2.3.2.cmml"><mi id="S3.E3.m1.1.1.3.3.2.3.2.2" xref="S3.E3.m1.1.1.3.3.2.3.2.2.cmml">λ</mi><mn id="S3.E3.m1.1.1.3.3.2.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.2.3.cmml">0</mn></msub><mo id="S3.E3.m1.1.1.3.3.2.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.1.1.3.3.2.3.1.cmml">⋅</mo><msub id="S3.E3.m1.1.1.3.3.2.3.3" xref="S3.E3.m1.1.1.3.3.2.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2.3.3.2" xref="S3.E3.m1.1.1.3.3.2.3.3.2.cmml">d</mi><mtext id="S3.E3.m1.1.1.3.3.2.3.3.3" xref="S3.E3.m1.1.1.3.3.2.3.3.3a.cmml">pull</mtext></msub></mrow></msup><mo id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml">+</mo><msup id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.2.cmml">e</mi><mrow id="S3.E3.m1.1.1.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.cmml"><msub id="S3.E3.m1.1.1.3.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.3.2.cmml"><mi id="S3.E3.m1.1.1.3.3.3.3.2.2" xref="S3.E3.m1.1.1.3.3.3.3.2.2.cmml">λ</mi><mn id="S3.E3.m1.1.1.3.3.3.3.2.3" xref="S3.E3.m1.1.1.3.3.3.3.2.3.cmml">1</mn></msub><mo id="S3.E3.m1.1.1.3.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.1.1.3.3.3.3.1.cmml">⋅</mo><msub id="S3.E3.m1.1.1.3.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.3.3.2.cmml">d</mi><mtext id="S3.E3.m1.1.1.3.3.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.3.3a.cmml">push</mtext></msub></mrow></msup><mo id="S3.E3.m1.1.1.3.3.1a" xref="S3.E3.m1.1.1.3.3.1.cmml">+</mo><msub id="S3.E3.m1.1.1.3.3.4" xref="S3.E3.m1.1.1.3.3.4.cmml"><mi id="S3.E3.m1.1.1.3.3.4.2" xref="S3.E3.m1.1.1.3.3.4.2.cmml">m</mi><mn id="S3.E3.m1.1.1.3.3.4.3" xref="S3.E3.m1.1.1.3.3.4.3.cmml">1</mn></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">𝐿</ci><apply id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3"><times id="S3.E3.m1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.2.3.1"></times><ci id="S3.E3.m1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.2.3.2">𝑇</ci><ci id="S3.E3.m1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.2.3.3">𝑟</ci><ci id="S3.E3.m1.1.1.2.3.4.cmml" xref="S3.E3.m1.1.1.2.3.4">𝑖</ci><ci id="S3.E3.m1.1.1.2.3.5.cmml" xref="S3.E3.m1.1.1.2.3.5">𝑡</ci><ci id="S3.E3.m1.1.1.2.3.6.cmml" xref="S3.E3.m1.1.1.2.3.6">𝑎</ci><ci id="S3.E3.m1.1.1.2.3.7.cmml" xref="S3.E3.m1.1.1.2.3.7">𝑛</ci><ci id="S3.E3.m1.1.1.2.3.8.cmml" xref="S3.E3.m1.1.1.2.3.8">ℎ</ci></apply></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><divide id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3"></divide><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><plus id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2.1"></plus><apply id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2"><minus id="S3.E3.m1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.3.2.2.1"></minus><apply id="S3.E3.m1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.3.2.2.2">superscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2.2.2">𝑒</ci><apply id="S3.E3.m1.1.1.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3"><ci id="S3.E3.m1.1.1.3.2.2.2.3.1.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.1">⋅</ci><apply id="S3.E3.m1.1.1.3.2.2.2.3.2.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.2.2">𝜆</ci><cn id="S3.E3.m1.1.1.3.2.2.2.3.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.3.2.2.2.3.2.3">0</cn></apply><apply id="S3.E3.m1.1.1.3.2.2.2.3.3.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.2.2.3.3.1.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.2.3.3.2.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.3.2.2.2.3.3.3a.cmml" xref="S3.E3.m1.1.1.3.2.2.2.3.3.3"><mtext id="S3.E3.m1.1.1.3.2.2.2.3.3.3.cmml" mathsize="50%" xref="S3.E3.m1.1.1.3.2.2.2.3.3.3">pull</mtext></ci></apply></apply></apply><apply id="S3.E3.m1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.2.3.1.cmml" xref="S3.E3.m1.1.1.3.2.2.3">superscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.3.2.cmml" xref="S3.E3.m1.1.1.3.2.2.3.2">𝑒</ci><apply id="S3.E3.m1.1.1.3.2.2.3.3.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3"><ci id="S3.E3.m1.1.1.3.2.2.3.3.1.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.1">⋅</ci><apply id="S3.E3.m1.1.1.3.2.2.3.3.2.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.2.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.2.2">𝜆</ci><cn id="S3.E3.m1.1.1.3.2.2.3.3.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.3.2.2.3.3.2.3">1</cn></apply><apply id="S3.E3.m1.1.1.3.2.2.3.3.3.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.2.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.2.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.3.2.2.3.3.3.3a.cmml" xref="S3.E3.m1.1.1.3.2.2.3.3.3.3"><mtext id="S3.E3.m1.1.1.3.2.2.3.3.3.3.cmml" mathsize="50%" xref="S3.E3.m1.1.1.3.2.2.3.3.3.3">push</mtext></ci></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.2.3.2">𝑚</ci><cn id="S3.E3.m1.1.1.3.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.3.2.3.3">0</cn></apply></apply><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><plus id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"></plus><apply id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2">superscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.2">𝑒</ci><apply id="S3.E3.m1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3"><ci id="S3.E3.m1.1.1.3.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3.1">⋅</ci><apply id="S3.E3.m1.1.1.3.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2.2">𝜆</ci><cn id="S3.E3.m1.1.1.3.3.2.3.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.3.3.2.3.2.3">0</cn></apply><apply id="S3.E3.m1.1.1.3.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.3.3.2.3.3.3a.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3.3"><mtext id="S3.E3.m1.1.1.3.3.2.3.3.3.cmml" mathsize="50%" xref="S3.E3.m1.1.1.3.3.2.3.3.3">pull</mtext></ci></apply></apply></apply><apply id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3">superscript</csymbol><ci id="S3.E3.m1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.2">𝑒</ci><apply id="S3.E3.m1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3.3"><ci id="S3.E3.m1.1.1.3.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3.3.1">⋅</ci><apply id="S3.E3.m1.1.1.3.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.3.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.3.3.2.2">𝜆</ci><cn id="S3.E3.m1.1.1.3.3.3.3.2.3.cmml" type="integer" xref="S3.E3.m1.1.1.3.3.3.3.2.3">1</cn></apply><apply id="S3.E3.m1.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.3.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.3.3.3.3.3.3a.cmml" xref="S3.E3.m1.1.1.3.3.3.3.3.3"><mtext id="S3.E3.m1.1.1.3.3.3.3.3.3.cmml" mathsize="50%" xref="S3.E3.m1.1.1.3.3.3.3.3.3">push</mtext></ci></apply></apply></apply><apply id="S3.E3.m1.1.1.3.3.4.cmml" xref="S3.E3.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.4.1.cmml" xref="S3.E3.m1.1.1.3.3.4">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.4.2.cmml" xref="S3.E3.m1.1.1.3.3.4.2">𝑚</ci><cn id="S3.E3.m1.1.1.3.3.4.3.cmml" type="integer" xref="S3.E3.m1.1.1.3.3.4.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">L_{Tritanh}=\dfrac{e^{\lambda_{0}\cdot d_{\text{pull}}}-e^{\lambda_{1}\cdot d_%
{\text{push}}}+m_{0}}{e^{\lambda_{0}\cdot d_{\text{pull}}}+e^{\lambda_{1}\cdot
d%
_{\text{push}}}+m_{1}}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_L start_POSTSUBSCRIPT italic_T italic_r italic_i italic_t italic_a italic_n italic_h end_POSTSUBSCRIPT = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT pull end_POSTSUBSCRIPT end_POSTSUPERSCRIPT - italic_e start_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT push end_POSTSUBSCRIPT end_POSTSUPERSCRIPT + italic_m start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT pull end_POSTSUBSCRIPT end_POSTSUPERSCRIPT + italic_e start_POSTSUPERSCRIPT italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT push end_POSTSUBSCRIPT end_POSTSUPERSCRIPT + italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.12"><span class="ltx_text ltx_markedasmath" id="S3.SS3.p7.12.1">Tritanh</span> loss only has a unique solution where the pulling force, <math alttext="d_{\text{pull}}" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><msub id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml"><mi id="S3.SS3.p7.2.m2.1.1.2" xref="S3.SS3.p7.2.m2.1.1.2.cmml">d</mi><mtext id="S3.SS3.p7.2.m2.1.1.3" xref="S3.SS3.p7.2.m2.1.1.3a.cmml">pull</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><apply id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.2.cmml" xref="S3.SS3.p7.2.m2.1.1.2">𝑑</ci><ci id="S3.SS3.p7.2.m2.1.1.3a.cmml" xref="S3.SS3.p7.2.m2.1.1.3"><mtext id="S3.SS3.p7.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.2.m2.1.1.3">pull</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">d_{\text{pull}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">italic_d start_POSTSUBSCRIPT pull end_POSTSUBSCRIPT</annotation></semantics></math> approaches zero, and the pushing force, <math alttext="d_{\text{push}}" class="ltx_Math" display="inline" id="S3.SS3.p7.3.m3.1"><semantics id="S3.SS3.p7.3.m3.1a"><msub id="S3.SS3.p7.3.m3.1.1" xref="S3.SS3.p7.3.m3.1.1.cmml"><mi id="S3.SS3.p7.3.m3.1.1.2" xref="S3.SS3.p7.3.m3.1.1.2.cmml">d</mi><mtext id="S3.SS3.p7.3.m3.1.1.3" xref="S3.SS3.p7.3.m3.1.1.3a.cmml">push</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.3.m3.1b"><apply id="S3.SS3.p7.3.m3.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.3.m3.1.1.1.cmml" xref="S3.SS3.p7.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p7.3.m3.1.1.2.cmml" xref="S3.SS3.p7.3.m3.1.1.2">𝑑</ci><ci id="S3.SS3.p7.3.m3.1.1.3a.cmml" xref="S3.SS3.p7.3.m3.1.1.3"><mtext id="S3.SS3.p7.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.3.m3.1.1.3">push</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.3.m3.1c">d_{\text{push}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.3.m3.1d">italic_d start_POSTSUBSCRIPT push end_POSTSUBSCRIPT</annotation></semantics></math> approaches infinity.
Furthermore, we can adjust the gradient of the loss function by changing the scaling factors, <math alttext="\lambda_{0}" class="ltx_Math" display="inline" id="S3.SS3.p7.4.m4.1"><semantics id="S3.SS3.p7.4.m4.1a"><msub id="S3.SS3.p7.4.m4.1.1" xref="S3.SS3.p7.4.m4.1.1.cmml"><mi id="S3.SS3.p7.4.m4.1.1.2" xref="S3.SS3.p7.4.m4.1.1.2.cmml">λ</mi><mn id="S3.SS3.p7.4.m4.1.1.3" xref="S3.SS3.p7.4.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.4.m4.1b"><apply id="S3.SS3.p7.4.m4.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.4.m4.1.1.1.cmml" xref="S3.SS3.p7.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p7.4.m4.1.1.2.cmml" xref="S3.SS3.p7.4.m4.1.1.2">𝜆</ci><cn id="S3.SS3.p7.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.p7.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.4.m4.1c">\lambda_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.4.m4.1d">italic_λ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\lambda_{1}" class="ltx_Math" display="inline" id="S3.SS3.p7.5.m5.1"><semantics id="S3.SS3.p7.5.m5.1a"><msub id="S3.SS3.p7.5.m5.1.1" xref="S3.SS3.p7.5.m5.1.1.cmml"><mi id="S3.SS3.p7.5.m5.1.1.2" xref="S3.SS3.p7.5.m5.1.1.2.cmml">λ</mi><mn id="S3.SS3.p7.5.m5.1.1.3" xref="S3.SS3.p7.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.5.m5.1b"><apply id="S3.SS3.p7.5.m5.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.5.m5.1.1.1.cmml" xref="S3.SS3.p7.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p7.5.m5.1.1.2.cmml" xref="S3.SS3.p7.5.m5.1.1.2">𝜆</ci><cn id="S3.SS3.p7.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p7.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.5.m5.1c">\lambda_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.5.m5.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="d_{\text{pull}}" class="ltx_Math" display="inline" id="S3.SS3.p7.6.m6.1"><semantics id="S3.SS3.p7.6.m6.1a"><msub id="S3.SS3.p7.6.m6.1.1" xref="S3.SS3.p7.6.m6.1.1.cmml"><mi id="S3.SS3.p7.6.m6.1.1.2" xref="S3.SS3.p7.6.m6.1.1.2.cmml">d</mi><mtext id="S3.SS3.p7.6.m6.1.1.3" xref="S3.SS3.p7.6.m6.1.1.3a.cmml">pull</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.6.m6.1b"><apply id="S3.SS3.p7.6.m6.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.6.m6.1.1.1.cmml" xref="S3.SS3.p7.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p7.6.m6.1.1.2.cmml" xref="S3.SS3.p7.6.m6.1.1.2">𝑑</ci><ci id="S3.SS3.p7.6.m6.1.1.3a.cmml" xref="S3.SS3.p7.6.m6.1.1.3"><mtext id="S3.SS3.p7.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.6.m6.1.1.3">pull</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.6.m6.1c">d_{\text{pull}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.6.m6.1d">italic_d start_POSTSUBSCRIPT pull end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{\text{push}}" class="ltx_Math" display="inline" id="S3.SS3.p7.7.m7.1"><semantics id="S3.SS3.p7.7.m7.1a"><msub id="S3.SS3.p7.7.m7.1.1" xref="S3.SS3.p7.7.m7.1.1.cmml"><mi id="S3.SS3.p7.7.m7.1.1.2" xref="S3.SS3.p7.7.m7.1.1.2.cmml">d</mi><mtext id="S3.SS3.p7.7.m7.1.1.3" xref="S3.SS3.p7.7.m7.1.1.3a.cmml">push</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.7.m7.1b"><apply id="S3.SS3.p7.7.m7.1.1.cmml" xref="S3.SS3.p7.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.7.m7.1.1.1.cmml" xref="S3.SS3.p7.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p7.7.m7.1.1.2.cmml" xref="S3.SS3.p7.7.m7.1.1.2">𝑑</ci><ci id="S3.SS3.p7.7.m7.1.1.3a.cmml" xref="S3.SS3.p7.7.m7.1.1.3"><mtext id="S3.SS3.p7.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p7.7.m7.1.1.3">push</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.7.m7.1c">d_{\text{push}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.7.m7.1d">italic_d start_POSTSUBSCRIPT push end_POSTSUBSCRIPT</annotation></semantics></math> respectively.
As <math alttext="\lambda_{0}&gt;\lambda_{1}" class="ltx_Math" display="inline" id="S3.SS3.p7.8.m8.1"><semantics id="S3.SS3.p7.8.m8.1a"><mrow id="S3.SS3.p7.8.m8.1.1" xref="S3.SS3.p7.8.m8.1.1.cmml"><msub id="S3.SS3.p7.8.m8.1.1.2" xref="S3.SS3.p7.8.m8.1.1.2.cmml"><mi id="S3.SS3.p7.8.m8.1.1.2.2" xref="S3.SS3.p7.8.m8.1.1.2.2.cmml">λ</mi><mn id="S3.SS3.p7.8.m8.1.1.2.3" xref="S3.SS3.p7.8.m8.1.1.2.3.cmml">0</mn></msub><mo id="S3.SS3.p7.8.m8.1.1.1" xref="S3.SS3.p7.8.m8.1.1.1.cmml">&gt;</mo><msub id="S3.SS3.p7.8.m8.1.1.3" xref="S3.SS3.p7.8.m8.1.1.3.cmml"><mi id="S3.SS3.p7.8.m8.1.1.3.2" xref="S3.SS3.p7.8.m8.1.1.3.2.cmml">λ</mi><mn id="S3.SS3.p7.8.m8.1.1.3.3" xref="S3.SS3.p7.8.m8.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.8.m8.1b"><apply id="S3.SS3.p7.8.m8.1.1.cmml" xref="S3.SS3.p7.8.m8.1.1"><gt id="S3.SS3.p7.8.m8.1.1.1.cmml" xref="S3.SS3.p7.8.m8.1.1.1"></gt><apply id="S3.SS3.p7.8.m8.1.1.2.cmml" xref="S3.SS3.p7.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.8.m8.1.1.2.1.cmml" xref="S3.SS3.p7.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS3.p7.8.m8.1.1.2.2.cmml" xref="S3.SS3.p7.8.m8.1.1.2.2">𝜆</ci><cn id="S3.SS3.p7.8.m8.1.1.2.3.cmml" type="integer" xref="S3.SS3.p7.8.m8.1.1.2.3">0</cn></apply><apply id="S3.SS3.p7.8.m8.1.1.3.cmml" xref="S3.SS3.p7.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p7.8.m8.1.1.3.1.cmml" xref="S3.SS3.p7.8.m8.1.1.3">subscript</csymbol><ci id="S3.SS3.p7.8.m8.1.1.3.2.cmml" xref="S3.SS3.p7.8.m8.1.1.3.2">𝜆</ci><cn id="S3.SS3.p7.8.m8.1.1.3.3.cmml" type="integer" xref="S3.SS3.p7.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.8.m8.1c">\lambda_{0}&gt;\lambda_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.8.m8.1d">italic_λ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT &gt; italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <span class="ltx_text ltx_markedasmath" id="S3.SS3.p7.12.2">Tritanh</span> loss prioritizes the pulling force more than the pushing force. We also add two margins, <math alttext="m_{0}" class="ltx_Math" display="inline" id="S3.SS3.p7.10.m10.1"><semantics id="S3.SS3.p7.10.m10.1a"><msub id="S3.SS3.p7.10.m10.1.1" xref="S3.SS3.p7.10.m10.1.1.cmml"><mi id="S3.SS3.p7.10.m10.1.1.2" xref="S3.SS3.p7.10.m10.1.1.2.cmml">m</mi><mn id="S3.SS3.p7.10.m10.1.1.3" xref="S3.SS3.p7.10.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.10.m10.1b"><apply id="S3.SS3.p7.10.m10.1.1.cmml" xref="S3.SS3.p7.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.10.m10.1.1.1.cmml" xref="S3.SS3.p7.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p7.10.m10.1.1.2.cmml" xref="S3.SS3.p7.10.m10.1.1.2">𝑚</ci><cn id="S3.SS3.p7.10.m10.1.1.3.cmml" type="integer" xref="S3.SS3.p7.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.10.m10.1c">m_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.10.m10.1d">italic_m start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="m_{1}" class="ltx_Math" display="inline" id="S3.SS3.p7.11.m11.1"><semantics id="S3.SS3.p7.11.m11.1a"><msub id="S3.SS3.p7.11.m11.1.1" xref="S3.SS3.p7.11.m11.1.1.cmml"><mi id="S3.SS3.p7.11.m11.1.1.2" xref="S3.SS3.p7.11.m11.1.1.2.cmml">m</mi><mn id="S3.SS3.p7.11.m11.1.1.3" xref="S3.SS3.p7.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.11.m11.1b"><apply id="S3.SS3.p7.11.m11.1.1.cmml" xref="S3.SS3.p7.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.11.m11.1.1.1.cmml" xref="S3.SS3.p7.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p7.11.m11.1.1.2.cmml" xref="S3.SS3.p7.11.m11.1.1.2">𝑚</ci><cn id="S3.SS3.p7.11.m11.1.1.3.cmml" type="integer" xref="S3.SS3.p7.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.11.m11.1c">m_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.11.m11.1d">italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> to regularize the <span class="ltx_text ltx_markedasmath" id="S3.SS3.p7.12.3">Tritanh</span> loss.
By changing these two margins, the gradient of the loss function can be scaled more robustly while being bounded within a controlled value.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.F4" title="Figure 4 ‣ 3.3 Context-Aware Contrastive Learning for MRI Anomaly Detection ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">4</span></a> compares different contrastive loss functions and the proposed contrastive loss function.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="299" id="S3.F4.g1" src="extracted/5924471/Latex/experiment/anchor_tanh.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Comparison between Anchor Loss and Tritanh Loss</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.1">As the contrastive loss function minimizes, the attention module iteratively highlights the anomalous regions.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.F3" title="Figure 3 ‣ 3.3 Context-Aware Contrastive Learning for MRI Anomaly Detection ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">3</span></a> shows the feature maps generated in different layers of the feature extractor.
We also change the default activation function from ReLU to Leaky ReLU.
This is because Leaky ReLu allows small negative value, rather than zero gradient flow when a negative value is computed.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Self-Supervised Feature Adversarial Learning</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Contrastive loss alone significantly improves the feature extractor’s capability to differentiate unhealthy features from healthy features.
However, it falls short of addressing the problem of high data variation. We propose a self-supervised feature adversarial learning to maximize the intraclass similarity while preventing catastrophic collapse.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">We use self-similarity loss to maximize the similarity between healthy image features to further enhance the model generalizability on normal features. We compute the self-similarity loss from the anchor image alone using a simple <math alttext="L2" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">⁢</mo><mn id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><times id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"></times><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝐿</ci><cn id="S3.SS4.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.p2.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">L2</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_L 2</annotation></semantics></math> loss.
Self-similarity loss will make the convex hull of the healthy image features to be more compact. The proposed self-similarity loss is shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.E4" title="In 3.4 Self-Supervised Feature Adversarial Learning ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{SSL}=\dfrac{1}{N(N-1)}\sum_{i=0}^{N-1}\sum_{j=0}^{N-1}\mathop{\mathbb{I}}(i%
\neq j)d(P_{i},P_{j})" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><msub id="S3.E4.m1.4.4.5" xref="S3.E4.m1.4.4.5.cmml"><mi id="S3.E4.m1.4.4.5.2" xref="S3.E4.m1.4.4.5.2.cmml">L</mi><mrow id="S3.E4.m1.4.4.5.3" xref="S3.E4.m1.4.4.5.3.cmml"><mi id="S3.E4.m1.4.4.5.3.2" xref="S3.E4.m1.4.4.5.3.2.cmml">S</mi><mo id="S3.E4.m1.4.4.5.3.1" xref="S3.E4.m1.4.4.5.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.5.3.3" xref="S3.E4.m1.4.4.5.3.3.cmml">S</mi><mo id="S3.E4.m1.4.4.5.3.1a" xref="S3.E4.m1.4.4.5.3.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.5.3.4" xref="S3.E4.m1.4.4.5.3.4.cmml">L</mi></mrow></msub><mo id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml">=</mo><mrow id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml">N</mi><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">N</mi><mo id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E4.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E4.m1.4.4.3.4" xref="S3.E4.m1.4.4.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3.cmml"><munderover id="S3.E4.m1.4.4.3.3.4" xref="S3.E4.m1.4.4.3.3.4.cmml"><mo id="S3.E4.m1.4.4.3.3.4.2.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.4.4.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.3.3.4.2.3" xref="S3.E4.m1.4.4.3.3.4.2.3.cmml"><mi id="S3.E4.m1.4.4.3.3.4.2.3.2" xref="S3.E4.m1.4.4.3.3.4.2.3.2.cmml">i</mi><mo id="S3.E4.m1.4.4.3.3.4.2.3.1" xref="S3.E4.m1.4.4.3.3.4.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.3.3.4.2.3.3" xref="S3.E4.m1.4.4.3.3.4.2.3.3.cmml">0</mn></mrow><mrow id="S3.E4.m1.4.4.3.3.4.3" xref="S3.E4.m1.4.4.3.3.4.3.cmml"><mi id="S3.E4.m1.4.4.3.3.4.3.2" xref="S3.E4.m1.4.4.3.3.4.3.2.cmml">N</mi><mo id="S3.E4.m1.4.4.3.3.4.3.1" xref="S3.E4.m1.4.4.3.3.4.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.3.3.4.3.3" xref="S3.E4.m1.4.4.3.3.4.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E4.m1.4.4.3.3.3" xref="S3.E4.m1.4.4.3.3.3.cmml"><munderover id="S3.E4.m1.4.4.3.3.3.4" xref="S3.E4.m1.4.4.3.3.3.4.cmml"><mo id="S3.E4.m1.4.4.3.3.3.4.2.2" movablelimits="false" xref="S3.E4.m1.4.4.3.3.3.4.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.3.3.3.4.2.3" xref="S3.E4.m1.4.4.3.3.3.4.2.3.cmml"><mi id="S3.E4.m1.4.4.3.3.3.4.2.3.2" xref="S3.E4.m1.4.4.3.3.3.4.2.3.2.cmml">j</mi><mo id="S3.E4.m1.4.4.3.3.3.4.2.3.1" xref="S3.E4.m1.4.4.3.3.3.4.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.3.3.3.4.2.3.3" xref="S3.E4.m1.4.4.3.3.3.4.2.3.3.cmml">0</mn></mrow><mrow id="S3.E4.m1.4.4.3.3.3.4.3" xref="S3.E4.m1.4.4.3.3.3.4.3.cmml"><mi id="S3.E4.m1.4.4.3.3.3.4.3.2" xref="S3.E4.m1.4.4.3.3.3.4.3.2.cmml">N</mi><mo id="S3.E4.m1.4.4.3.3.3.4.3.1" xref="S3.E4.m1.4.4.3.3.3.4.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.3.3.3.4.3.3" xref="S3.E4.m1.4.4.3.3.3.4.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E4.m1.4.4.3.3.3.3" xref="S3.E4.m1.4.4.3.3.3.3.cmml"><mo id="S3.E4.m1.4.4.3.3.3.3.4" lspace="0em" movablelimits="false" rspace="0em" xref="S3.E4.m1.4.4.3.3.3.3.4.cmml">𝕀</mo><mrow id="S3.E4.m1.4.4.3.3.3.3.3" xref="S3.E4.m1.4.4.3.3.3.3.3.cmml"><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">≠</mo><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">j</mi></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E4.m1.4.4.3.3.3.3.3.4" xref="S3.E4.m1.4.4.3.3.3.3.3.4.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.3.3.3.3.5" xref="S3.E4.m1.4.4.3.3.3.3.3.5.cmml">d</mi><mo id="S3.E4.m1.4.4.3.3.3.3.3.4a" xref="S3.E4.m1.4.4.3.3.3.3.3.4.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.3.3.3.3.3.3.2" xref="S3.E4.m1.4.4.3.3.3.3.3.3.3.cmml"><mo id="S3.E4.m1.4.4.3.3.3.3.3.3.2.3" stretchy="false" xref="S3.E4.m1.4.4.3.3.3.3.3.3.3.cmml">(</mo><msub id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.2" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.2.cmml">P</mi><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.3" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.3.3.3.3.3.3.2.4" xref="S3.E4.m1.4.4.3.3.3.3.3.3.3.cmml">,</mo><msub id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.cmml"><mi id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.2" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.2.cmml">P</mi><mi id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.3" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.3.cmml">j</mi></msub><mo id="S3.E4.m1.4.4.3.3.3.3.3.3.2.5" stretchy="false" xref="S3.E4.m1.4.4.3.3.3.3.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"></eq><apply id="S3.E4.m1.4.4.5.cmml" xref="S3.E4.m1.4.4.5"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.5.1.cmml" xref="S3.E4.m1.4.4.5">subscript</csymbol><ci id="S3.E4.m1.4.4.5.2.cmml" xref="S3.E4.m1.4.4.5.2">𝐿</ci><apply id="S3.E4.m1.4.4.5.3.cmml" xref="S3.E4.m1.4.4.5.3"><times id="S3.E4.m1.4.4.5.3.1.cmml" xref="S3.E4.m1.4.4.5.3.1"></times><ci id="S3.E4.m1.4.4.5.3.2.cmml" xref="S3.E4.m1.4.4.5.3.2">𝑆</ci><ci id="S3.E4.m1.4.4.5.3.3.cmml" xref="S3.E4.m1.4.4.5.3.3">𝑆</ci><ci id="S3.E4.m1.4.4.5.3.4.cmml" xref="S3.E4.m1.4.4.5.3.4">𝐿</ci></apply></apply><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><times id="S3.E4.m1.4.4.3.4.cmml" xref="S3.E4.m1.4.4.3.4"></times><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn id="S3.E4.m1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><times id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3">𝑁</ci><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1"></minus><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝑁</ci><cn id="S3.E4.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3"><apply id="S3.E4.m1.4.4.3.3.4.cmml" xref="S3.E4.m1.4.4.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.4.1.cmml" xref="S3.E4.m1.4.4.3.3.4">superscript</csymbol><apply id="S3.E4.m1.4.4.3.3.4.2.cmml" xref="S3.E4.m1.4.4.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.4.2.1.cmml" xref="S3.E4.m1.4.4.3.3.4">subscript</csymbol><sum id="S3.E4.m1.4.4.3.3.4.2.2.cmml" xref="S3.E4.m1.4.4.3.3.4.2.2"></sum><apply id="S3.E4.m1.4.4.3.3.4.2.3.cmml" xref="S3.E4.m1.4.4.3.3.4.2.3"><eq id="S3.E4.m1.4.4.3.3.4.2.3.1.cmml" xref="S3.E4.m1.4.4.3.3.4.2.3.1"></eq><ci id="S3.E4.m1.4.4.3.3.4.2.3.2.cmml" xref="S3.E4.m1.4.4.3.3.4.2.3.2">𝑖</ci><cn id="S3.E4.m1.4.4.3.3.4.2.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.3.3.4.2.3.3">0</cn></apply></apply><apply id="S3.E4.m1.4.4.3.3.4.3.cmml" xref="S3.E4.m1.4.4.3.3.4.3"><minus id="S3.E4.m1.4.4.3.3.4.3.1.cmml" xref="S3.E4.m1.4.4.3.3.4.3.1"></minus><ci id="S3.E4.m1.4.4.3.3.4.3.2.cmml" xref="S3.E4.m1.4.4.3.3.4.3.2">𝑁</ci><cn id="S3.E4.m1.4.4.3.3.4.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.3.3.4.3.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.3.3.3.cmml" xref="S3.E4.m1.4.4.3.3.3"><apply id="S3.E4.m1.4.4.3.3.3.4.cmml" xref="S3.E4.m1.4.4.3.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.3.4.1.cmml" xref="S3.E4.m1.4.4.3.3.3.4">superscript</csymbol><apply id="S3.E4.m1.4.4.3.3.3.4.2.cmml" xref="S3.E4.m1.4.4.3.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.3.4.2.1.cmml" xref="S3.E4.m1.4.4.3.3.3.4">subscript</csymbol><sum id="S3.E4.m1.4.4.3.3.3.4.2.2.cmml" xref="S3.E4.m1.4.4.3.3.3.4.2.2"></sum><apply id="S3.E4.m1.4.4.3.3.3.4.2.3.cmml" xref="S3.E4.m1.4.4.3.3.3.4.2.3"><eq id="S3.E4.m1.4.4.3.3.3.4.2.3.1.cmml" xref="S3.E4.m1.4.4.3.3.3.4.2.3.1"></eq><ci id="S3.E4.m1.4.4.3.3.3.4.2.3.2.cmml" xref="S3.E4.m1.4.4.3.3.3.4.2.3.2">𝑗</ci><cn id="S3.E4.m1.4.4.3.3.3.4.2.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.3.3.3.4.2.3.3">0</cn></apply></apply><apply id="S3.E4.m1.4.4.3.3.3.4.3.cmml" xref="S3.E4.m1.4.4.3.3.3.4.3"><minus id="S3.E4.m1.4.4.3.3.3.4.3.1.cmml" xref="S3.E4.m1.4.4.3.3.3.4.3.1"></minus><ci id="S3.E4.m1.4.4.3.3.3.4.3.2.cmml" xref="S3.E4.m1.4.4.3.3.3.4.3.2">𝑁</ci><cn id="S3.E4.m1.4.4.3.3.3.4.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.3.3.3.4.3.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.3.3.3.3.cmml" xref="S3.E4.m1.4.4.3.3.3.3"><ci id="S3.E4.m1.4.4.3.3.3.3.4.cmml" xref="S3.E4.m1.4.4.3.3.3.3.4">𝕀</ci><apply id="S3.E4.m1.4.4.3.3.3.3.3.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3"><times id="S3.E4.m1.4.4.3.3.3.3.3.4.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.4"></times><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"><neq id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.1"></neq><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E4.m1.4.4.3.3.3.3.3.5.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.5">𝑑</ci><interval closure="open" id="S3.E4.m1.4.4.3.3.3.3.3.3.3.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2"><apply id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.2">𝑃</ci><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.1.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.2.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.2">𝑃</ci><ci id="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.3.cmml" xref="S3.E4.m1.4.4.3.3.3.3.3.3.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">L_{SSL}=\dfrac{1}{N(N-1)}\sum_{i=0}^{N-1}\sum_{j=0}^{N-1}\mathop{\mathbb{I}}(i%
\neq j)d(P_{i},P_{j})</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">italic_L start_POSTSUBSCRIPT italic_S italic_S italic_L end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N ( italic_N - 1 ) end_ARG ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N - 1 end_POSTSUPERSCRIPT blackboard_I ( italic_i ≠ italic_j ) italic_d ( italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.2">For every image patch, <math alttext="P_{k}" class="ltx_Math" display="inline" id="S3.SS4.p4.1.m1.1"><semantics id="S3.SS4.p4.1.m1.1a"><msub id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml"><mi id="S3.SS4.p4.1.m1.1.1.2" xref="S3.SS4.p4.1.m1.1.1.2.cmml">P</mi><mi id="S3.SS4.p4.1.m1.1.1.3" xref="S3.SS4.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.1b"><apply id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.1.m1.1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p4.1.m1.1.1.2.cmml" xref="S3.SS4.p4.1.m1.1.1.2">𝑃</ci><ci id="S3.SS4.p4.1.m1.1.1.3.cmml" xref="S3.SS4.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.1c">P_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, we compute the mean of the distance measurement, <math alttext="d(\dot{,}\dot{)}" class="ltx_math_unparsed" display="inline" id="S3.SS4.p4.2.m2.1"><semantics id="S3.SS4.p4.2.m2.1a"><mrow id="S3.SS4.p4.2.m2.1b"><mi id="S3.SS4.p4.2.m2.1.1">d</mi><mrow id="S3.SS4.p4.2.m2.1.2"><mo id="S3.SS4.p4.2.m2.1.2.1" stretchy="false">(</mo><mover accent="true" id="S3.SS4.p4.2.m2.1.2.2"><mo id="S3.SS4.p4.2.m2.1.2.2.2">,</mo><mo id="S3.SS4.p4.2.m2.1.2.2.1">˙</mo></mover><mover accent="true" id="S3.SS4.p4.2.m2.1.2.3"><mo id="S3.SS4.p4.2.m2.1.2.3.2" stretchy="false">)</mo><mo id="S3.SS4.p4.2.m2.1.2.3.1">˙</mo></mover></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">d(\dot{,}\dot{)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p4.2.m2.1d">italic_d ( over˙ start_ARG , end_ARG over˙ start_ARG ) end_ARG</annotation></semantics></math>.
However, self-similarity loss may cause the feature representation of the anchor image to collapse to a singular point and the extracted features become moot.</p>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.1">To counter the aforementioned issue, we introduce a regularizer to combat self-similarity loss.
KoLeo loss preserves the boundaries of the representation while increasing the coverage of respective classes, thus is capable of preventing catastrophic collapse caused by self-similarity loss <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">sablayrolles2018spreading</span>]</cite>.
The modified KoLeo loss is shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.E5" title="In 3.4 Self-Supervised Feature Adversarial Learning ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{KoLeo}=\sum_{x_{i}\in\mathcal{D}_{train}}-\dfrac{1}{n}\sum_{i=0}^{n-1}\log{%
|f_{\theta}(x_{i})|}" class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msub id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">L</mi><mrow id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2.cmml">K</mi><mo id="S3.E5.m1.1.1.3.3.1" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml">o</mi><mo id="S3.E5.m1.1.1.3.3.1a" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3.4" xref="S3.E5.m1.1.1.3.3.4.cmml">L</mi><mo id="S3.E5.m1.1.1.3.3.1b" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3.5" xref="S3.E5.m1.1.1.3.3.5.cmml">e</mi><mo id="S3.E5.m1.1.1.3.3.1c" xref="S3.E5.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.3.3.6" xref="S3.E5.m1.1.1.3.3.6.cmml">o</mi></mrow></msub><mo id="S3.E5.m1.1.1.2" rspace="0.111em" xref="S3.E5.m1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><munder id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml"><mo id="S3.E5.m1.1.1.1.3.2" movablelimits="false" rspace="0em" xref="S3.E5.m1.1.1.1.3.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.3.3.cmml"><msub id="S3.E5.m1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.1.3.3.2.2.cmml">x</mi><mi id="S3.E5.m1.1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.1.3.3.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.1.1.1.3.3.1" xref="S3.E5.m1.1.1.1.3.3.1.cmml">∈</mo><msub id="S3.E5.m1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.1.3.3.3.2.cmml">𝒟</mi><mrow id="S3.E5.m1.1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.1.3.3.3.3.cmml"><mi id="S3.E5.m1.1.1.1.3.3.3.3.2" xref="S3.E5.m1.1.1.1.3.3.3.3.2.cmml">t</mi><mo id="S3.E5.m1.1.1.1.3.3.3.3.1" xref="S3.E5.m1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.3.3.3.3.3" xref="S3.E5.m1.1.1.1.3.3.3.3.3.cmml">r</mi><mo id="S3.E5.m1.1.1.1.3.3.3.3.1a" xref="S3.E5.m1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.3.3.3.3.4" xref="S3.E5.m1.1.1.1.3.3.3.3.4.cmml">a</mi><mo id="S3.E5.m1.1.1.1.3.3.3.3.1b" xref="S3.E5.m1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.3.3.3.3.5" xref="S3.E5.m1.1.1.1.3.3.3.3.5.cmml">i</mi><mo id="S3.E5.m1.1.1.1.3.3.3.3.1c" xref="S3.E5.m1.1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.3.3.3.3.6" xref="S3.E5.m1.1.1.1.3.3.3.3.6.cmml">n</mi></mrow></msub></mrow></munder><mo id="S3.E5.m1.1.1.1.2" lspace="0em" xref="S3.E5.m1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mfrac id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mn id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><munderover id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E5.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2.2.3.2" xref="S3.E5.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E5.m1.1.1.1.1.1.2.2.3.1" xref="S3.E5.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.1.2.2.3.3" xref="S3.E5.m1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S3.E5.m1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.1.1.1.1.1.2.3.2.cmml">n</mi><mo id="S3.E5.m1.1.1.1.1.1.2.3.1" xref="S3.E5.m1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E5.m1.1.1.1.1.1.2.3.3" xref="S3.E5.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">log</mi><mo id="S3.E5.m1.1.1.1.1.1.1a" xref="S3.E5.m1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></eq><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝐿</ci><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><times id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.1"></times><ci id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2">𝐾</ci><ci id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">𝑜</ci><ci id="S3.E5.m1.1.1.3.3.4.cmml" xref="S3.E5.m1.1.1.3.3.4">𝐿</ci><ci id="S3.E5.m1.1.1.3.3.5.cmml" xref="S3.E5.m1.1.1.3.3.5">𝑒</ci><ci id="S3.E5.m1.1.1.3.3.6.cmml" xref="S3.E5.m1.1.1.3.3.6">𝑜</ci></apply></apply><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><minus id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></minus><apply id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.3">subscript</csymbol><sum id="S3.E5.m1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.3.2"></sum><apply id="S3.E5.m1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3"><in id="S3.E5.m1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.3.3.1"></in><apply id="S3.E5.m1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.1.3.3.2.2">𝑥</ci><ci id="S3.E5.m1.1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.E5.m1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.3.3.3.2">𝒟</ci><apply id="S3.E5.m1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3"><times id="S3.E5.m1.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3.1"></times><ci id="S3.E5.m1.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3.2">𝑡</ci><ci id="S3.E5.m1.1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3.3">𝑟</ci><ci id="S3.E5.m1.1.1.1.3.3.3.3.4.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3.4">𝑎</ci><ci id="S3.E5.m1.1.1.1.3.3.3.3.5.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3.5">𝑖</ci><ci id="S3.E5.m1.1.1.1.3.3.3.3.6.cmml" xref="S3.E5.m1.1.1.1.3.3.3.3.6">𝑛</ci></apply></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><divide id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3"></divide><cn id="S3.E5.m1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.3.2">1</cn><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><apply id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E5.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3"><eq id="S3.E5.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E5.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.3"><minus id="S3.E5.m1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2.3.1"></minus><ci id="S3.E5.m1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.3.2">𝑛</ci><cn id="S3.E5.m1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><log id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"></log><apply id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><abs id="S3.E5.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">L_{KoLeo}=\sum_{x_{i}\in\mathcal{D}_{train}}-\dfrac{1}{n}\sum_{i=0}^{n-1}\log{%
|f_{\theta}(x_{i})|}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">italic_L start_POSTSUBSCRIPT italic_K italic_o italic_L italic_e italic_o end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_D start_POSTSUBSCRIPT italic_t italic_r italic_a italic_i italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT - divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n - 1 end_POSTSUPERSCRIPT roman_log | italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p7">
<p class="ltx_p" id="S3.SS4.p7.1">Integrating self-similarity loss with KoLeo loss, we have the Feature Adversarial Loss:</p>
</div>
<div class="ltx_para" id="S3.SS4.p8">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{SFA}=\gamma_{1}L_{SSL}+\gamma_{2}L_{KoLeo}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">L</mi><mrow id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.2.3.2" xref="S3.E6.m1.1.1.2.3.2.cmml">S</mi><mo id="S3.E6.m1.1.1.2.3.1" xref="S3.E6.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.3.3" xref="S3.E6.m1.1.1.2.3.3.cmml">F</mi><mo id="S3.E6.m1.1.1.2.3.1a" xref="S3.E6.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.2.3.4" xref="S3.E6.m1.1.1.2.3.4.cmml">A</mi></mrow></msub><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mrow id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><msub id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2.2" xref="S3.E6.m1.1.1.3.2.2.2.cmml">γ</mi><mn id="S3.E6.m1.1.1.3.2.2.3" xref="S3.E6.m1.1.1.3.2.2.3.cmml">1</mn></msub><mo id="S3.E6.m1.1.1.3.2.1" xref="S3.E6.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.3.2.3.2.cmml">L</mi><mrow id="S3.E6.m1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.3.2.3.3.cmml"><mi id="S3.E6.m1.1.1.3.2.3.3.2" xref="S3.E6.m1.1.1.3.2.3.3.2.cmml">S</mi><mo id="S3.E6.m1.1.1.3.2.3.3.1" xref="S3.E6.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.2.3.3.3" xref="S3.E6.m1.1.1.3.2.3.3.3.cmml">S</mi><mo id="S3.E6.m1.1.1.3.2.3.3.1a" xref="S3.E6.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.2.3.3.4" xref="S3.E6.m1.1.1.3.2.3.3.4.cmml">L</mi></mrow></msub></mrow><mo id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml">+</mo><mrow id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml"><msub id="S3.E6.m1.1.1.3.3.2" xref="S3.E6.m1.1.1.3.3.2.cmml"><mi id="S3.E6.m1.1.1.3.3.2.2" xref="S3.E6.m1.1.1.3.3.2.2.cmml">γ</mi><mn id="S3.E6.m1.1.1.3.3.2.3" xref="S3.E6.m1.1.1.3.3.2.3.cmml">2</mn></msub><mo id="S3.E6.m1.1.1.3.3.1" xref="S3.E6.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S3.E6.m1.1.1.3.3.3" xref="S3.E6.m1.1.1.3.3.3.cmml"><mi id="S3.E6.m1.1.1.3.3.3.2" xref="S3.E6.m1.1.1.3.3.3.2.cmml">L</mi><mrow id="S3.E6.m1.1.1.3.3.3.3" xref="S3.E6.m1.1.1.3.3.3.3.cmml"><mi id="S3.E6.m1.1.1.3.3.3.3.2" xref="S3.E6.m1.1.1.3.3.3.3.2.cmml">K</mi><mo id="S3.E6.m1.1.1.3.3.3.3.1" xref="S3.E6.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.3.3.3.3" xref="S3.E6.m1.1.1.3.3.3.3.3.cmml">o</mi><mo id="S3.E6.m1.1.1.3.3.3.3.1a" xref="S3.E6.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.3.3.3.4" xref="S3.E6.m1.1.1.3.3.3.3.4.cmml">L</mi><mo id="S3.E6.m1.1.1.3.3.3.3.1b" xref="S3.E6.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.3.3.3.5" xref="S3.E6.m1.1.1.3.3.3.3.5.cmml">e</mi><mo id="S3.E6.m1.1.1.3.3.3.3.1c" xref="S3.E6.m1.1.1.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.3.3.3.3.6" xref="S3.E6.m1.1.1.3.3.3.3.6.cmml">o</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">𝐿</ci><apply id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3"><times id="S3.E6.m1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.2.3.1"></times><ci id="S3.E6.m1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.2.3.2">𝑆</ci><ci id="S3.E6.m1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.2.3.3">𝐹</ci><ci id="S3.E6.m1.1.1.2.3.4.cmml" xref="S3.E6.m1.1.1.2.3.4">𝐴</ci></apply></apply><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><plus id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"></plus><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><times id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2.1"></times><apply id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.2.1.cmml" xref="S3.E6.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2.2">𝛾</ci><cn id="S3.E6.m1.1.1.3.2.2.3.cmml" type="integer" xref="S3.E6.m1.1.1.3.2.2.3">1</cn></apply><apply id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.3.2.3.2">𝐿</ci><apply id="S3.E6.m1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.3.2.3.3"><times id="S3.E6.m1.1.1.3.2.3.3.1.cmml" xref="S3.E6.m1.1.1.3.2.3.3.1"></times><ci id="S3.E6.m1.1.1.3.2.3.3.2.cmml" xref="S3.E6.m1.1.1.3.2.3.3.2">𝑆</ci><ci id="S3.E6.m1.1.1.3.2.3.3.3.cmml" xref="S3.E6.m1.1.1.3.2.3.3.3">𝑆</ci><ci id="S3.E6.m1.1.1.3.2.3.3.4.cmml" xref="S3.E6.m1.1.1.3.2.3.3.4">𝐿</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3"><times id="S3.E6.m1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.1"></times><apply id="S3.E6.m1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.2.1.cmml" xref="S3.E6.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.3.3.2.2.cmml" xref="S3.E6.m1.1.1.3.3.2.2">𝛾</ci><cn id="S3.E6.m1.1.1.3.3.2.3.cmml" type="integer" xref="S3.E6.m1.1.1.3.3.2.3">2</cn></apply><apply id="S3.E6.m1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.3.2">𝐿</ci><apply id="S3.E6.m1.1.1.3.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3.3"><times id="S3.E6.m1.1.1.3.3.3.3.1.cmml" xref="S3.E6.m1.1.1.3.3.3.3.1"></times><ci id="S3.E6.m1.1.1.3.3.3.3.2.cmml" xref="S3.E6.m1.1.1.3.3.3.3.2">𝐾</ci><ci id="S3.E6.m1.1.1.3.3.3.3.3.cmml" xref="S3.E6.m1.1.1.3.3.3.3.3">𝑜</ci><ci id="S3.E6.m1.1.1.3.3.3.3.4.cmml" xref="S3.E6.m1.1.1.3.3.3.3.4">𝐿</ci><ci id="S3.E6.m1.1.1.3.3.3.3.5.cmml" xref="S3.E6.m1.1.1.3.3.3.3.5">𝑒</ci><ci id="S3.E6.m1.1.1.3.3.3.3.6.cmml" xref="S3.E6.m1.1.1.3.3.3.3.6">𝑜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">L_{SFA}=\gamma_{1}L_{SSL}+\gamma_{2}L_{KoLeo}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_L start_POSTSUBSCRIPT italic_S italic_F italic_A end_POSTSUBSCRIPT = italic_γ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_S italic_S italic_L end_POSTSUBSCRIPT + italic_γ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_K italic_o italic_L italic_e italic_o end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS4.p9">
<p class="ltx_p" id="S3.SS4.p9.2">The <math alttext="\gamma_{1}" class="ltx_Math" display="inline" id="S3.SS4.p9.1.m1.1"><semantics id="S3.SS4.p9.1.m1.1a"><msub id="S3.SS4.p9.1.m1.1.1" xref="S3.SS4.p9.1.m1.1.1.cmml"><mi id="S3.SS4.p9.1.m1.1.1.2" xref="S3.SS4.p9.1.m1.1.1.2.cmml">γ</mi><mn id="S3.SS4.p9.1.m1.1.1.3" xref="S3.SS4.p9.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p9.1.m1.1b"><apply id="S3.SS4.p9.1.m1.1.1.cmml" xref="S3.SS4.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p9.1.m1.1.1.1.cmml" xref="S3.SS4.p9.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p9.1.m1.1.1.2.cmml" xref="S3.SS4.p9.1.m1.1.1.2">𝛾</ci><cn id="S3.SS4.p9.1.m1.1.1.3.cmml" type="integer" xref="S3.SS4.p9.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p9.1.m1.1c">\gamma_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p9.1.m1.1d">italic_γ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\gamma_{2}" class="ltx_Math" display="inline" id="S3.SS4.p9.2.m2.1"><semantics id="S3.SS4.p9.2.m2.1a"><msub id="S3.SS4.p9.2.m2.1.1" xref="S3.SS4.p9.2.m2.1.1.cmml"><mi id="S3.SS4.p9.2.m2.1.1.2" xref="S3.SS4.p9.2.m2.1.1.2.cmml">γ</mi><mn id="S3.SS4.p9.2.m2.1.1.3" xref="S3.SS4.p9.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p9.2.m2.1b"><apply id="S3.SS4.p9.2.m2.1.1.cmml" xref="S3.SS4.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p9.2.m2.1.1.1.cmml" xref="S3.SS4.p9.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p9.2.m2.1.1.2.cmml" xref="S3.SS4.p9.2.m2.1.1.2">𝛾</ci><cn id="S3.SS4.p9.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.p9.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p9.2.m2.1c">\gamma_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p9.2.m2.1d">italic_γ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are hyperparameters that are empirically set to 0.01. The reduction of self-similarity loss decreases the distance among feature points, consequently diminishing the requisite number of points for representation during coreset sampling. Conversely, KoLeo loss increases the entropy, which serves dual purposes within the feature adversarial learning: firstly, to mitigate the effects of self-similarity loss, thereby averting catastrophic collapse; and secondly, to ensure a more uniform distribution of feature representation.</p>
</div>
<div class="ltx_para" id="S3.SS4.p10">
<p class="ltx_p" id="S3.SS4.p10.1">Therefore, the final loss function for the proposed method is shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.E7" title="In 3.4 Self-Supervised Feature Adversarial Learning ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p11">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L=L_{Tritanh}+L_{SFA}" class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mi id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">L</mi><mo id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.3.2.2" xref="S3.E7.m1.1.1.3.2.2.cmml">L</mi><mrow id="S3.E7.m1.1.1.3.2.3" xref="S3.E7.m1.1.1.3.2.3.cmml"><mi id="S3.E7.m1.1.1.3.2.3.2" xref="S3.E7.m1.1.1.3.2.3.2.cmml">T</mi><mo id="S3.E7.m1.1.1.3.2.3.1" xref="S3.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.2.3.3" xref="S3.E7.m1.1.1.3.2.3.3.cmml">r</mi><mo id="S3.E7.m1.1.1.3.2.3.1a" xref="S3.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.2.3.4" xref="S3.E7.m1.1.1.3.2.3.4.cmml">i</mi><mo id="S3.E7.m1.1.1.3.2.3.1b" xref="S3.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.2.3.5" xref="S3.E7.m1.1.1.3.2.3.5.cmml">t</mi><mo id="S3.E7.m1.1.1.3.2.3.1c" xref="S3.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.2.3.6" xref="S3.E7.m1.1.1.3.2.3.6.cmml">a</mi><mo id="S3.E7.m1.1.1.3.2.3.1d" xref="S3.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.2.3.7" xref="S3.E7.m1.1.1.3.2.3.7.cmml">n</mi><mo id="S3.E7.m1.1.1.3.2.3.1e" xref="S3.E7.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.2.3.8" xref="S3.E7.m1.1.1.3.2.3.8.cmml">h</mi></mrow></msub><mo id="S3.E7.m1.1.1.3.1" xref="S3.E7.m1.1.1.3.1.cmml">+</mo><msub id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.2" xref="S3.E7.m1.1.1.3.3.2.cmml">L</mi><mrow id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.3.2" xref="S3.E7.m1.1.1.3.3.3.2.cmml">S</mi><mo id="S3.E7.m1.1.1.3.3.3.1" xref="S3.E7.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.3.3.3" xref="S3.E7.m1.1.1.3.3.3.3.cmml">F</mi><mo id="S3.E7.m1.1.1.3.3.3.1a" xref="S3.E7.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.3.3.3.4" xref="S3.E7.m1.1.1.3.3.3.4.cmml">A</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"></eq><ci id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">𝐿</ci><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><plus id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.3.2.2">𝐿</ci><apply id="S3.E7.m1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.3.2.3"><times id="S3.E7.m1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.1.1.3.2.3.1"></times><ci id="S3.E7.m1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.1.1.3.2.3.2">𝑇</ci><ci id="S3.E7.m1.1.1.3.2.3.3.cmml" xref="S3.E7.m1.1.1.3.2.3.3">𝑟</ci><ci id="S3.E7.m1.1.1.3.2.3.4.cmml" xref="S3.E7.m1.1.1.3.2.3.4">𝑖</ci><ci id="S3.E7.m1.1.1.3.2.3.5.cmml" xref="S3.E7.m1.1.1.3.2.3.5">𝑡</ci><ci id="S3.E7.m1.1.1.3.2.3.6.cmml" xref="S3.E7.m1.1.1.3.2.3.6">𝑎</ci><ci id="S3.E7.m1.1.1.3.2.3.7.cmml" xref="S3.E7.m1.1.1.3.2.3.7">𝑛</ci><ci id="S3.E7.m1.1.1.3.2.3.8.cmml" xref="S3.E7.m1.1.1.3.2.3.8">ℎ</ci></apply></apply><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2">𝐿</ci><apply id="S3.E7.m1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3"><times id="S3.E7.m1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3.3.1"></times><ci id="S3.E7.m1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.3.2">𝑆</ci><ci id="S3.E7.m1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3.3">𝐹</ci><ci id="S3.E7.m1.1.1.3.3.3.4.cmml" xref="S3.E7.m1.1.1.3.3.3.4">𝐴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">L=L_{Tritanh}+L_{SFA}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_L = italic_L start_POSTSUBSCRIPT italic_T italic_r italic_i italic_t italic_a italic_n italic_h end_POSTSUBSCRIPT + italic_L start_POSTSUBSCRIPT italic_S italic_F italic_A end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Anomaly Detection Head</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.6">Instead of using a pretrained ImageNet feature extractor to obtain the healthy image feature <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS5.p1.1.m1.1"><semantics id="S3.SS5.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.1.m1.1.1" xref="S3.SS5.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.1.m1.1b"><ci id="S3.SS5.p1.1.m1.1.1.cmml" xref="S3.SS5.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.1.m1.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.1.m1.1d">caligraphic_M</annotation></semantics></math>, we use the fine tuned feature extractor from the first training stage to acquire more representative features. To maintain fairness comparison, build <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS5.p1.2.m2.1"><semantics id="S3.SS5.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.2.m2.1.1" xref="S3.SS5.p1.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m2.1b"><ci id="S3.SS5.p1.2.m2.1.1.cmml" xref="S3.SS5.p1.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m2.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.2.m2.1d">caligraphic_M</annotation></semantics></math> only by using <math alttext="\mathcal{D}_{few}" class="ltx_Math" display="inline" id="S3.SS5.p1.3.m3.1"><semantics id="S3.SS5.p1.3.m3.1a"><msub id="S3.SS5.p1.3.m3.1.1" xref="S3.SS5.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.3.m3.1.1.2" xref="S3.SS5.p1.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S3.SS5.p1.3.m3.1.1.3" xref="S3.SS5.p1.3.m3.1.1.3.cmml"><mi id="S3.SS5.p1.3.m3.1.1.3.2" xref="S3.SS5.p1.3.m3.1.1.3.2.cmml">f</mi><mo id="S3.SS5.p1.3.m3.1.1.3.1" xref="S3.SS5.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p1.3.m3.1.1.3.3" xref="S3.SS5.p1.3.m3.1.1.3.3.cmml">e</mi><mo id="S3.SS5.p1.3.m3.1.1.3.1a" xref="S3.SS5.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p1.3.m3.1.1.3.4" xref="S3.SS5.p1.3.m3.1.1.3.4.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m3.1b"><apply id="S3.SS5.p1.3.m3.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m3.1.1.1.cmml" xref="S3.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m3.1.1.2.cmml" xref="S3.SS5.p1.3.m3.1.1.2">𝒟</ci><apply id="S3.SS5.p1.3.m3.1.1.3.cmml" xref="S3.SS5.p1.3.m3.1.1.3"><times id="S3.SS5.p1.3.m3.1.1.3.1.cmml" xref="S3.SS5.p1.3.m3.1.1.3.1"></times><ci id="S3.SS5.p1.3.m3.1.1.3.2.cmml" xref="S3.SS5.p1.3.m3.1.1.3.2">𝑓</ci><ci id="S3.SS5.p1.3.m3.1.1.3.3.cmml" xref="S3.SS5.p1.3.m3.1.1.3.3">𝑒</ci><ci id="S3.SS5.p1.3.m3.1.1.3.4.cmml" xref="S3.SS5.p1.3.m3.1.1.3.4">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m3.1c">\mathcal{D}_{few}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.3.m3.1d">caligraphic_D start_POSTSUBSCRIPT italic_f italic_e italic_w end_POSTSUBSCRIPT</annotation></semantics></math>. Next, we use the coreset sampling method to sample the most representative feature points from <math alttext="\mathcal{M}" class="ltx_Math" display="inline" id="S3.SS5.p1.4.m4.1"><semantics id="S3.SS5.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.4.m4.1.1" xref="S3.SS5.p1.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m4.1b"><ci id="S3.SS5.p1.4.m4.1.1.cmml" xref="S3.SS5.p1.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m4.1c">\mathcal{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.4.m4.1d">caligraphic_M</annotation></semantics></math> to create PatchCore memory bank, <math alttext="\mathcal{M}_{C}^{*}" class="ltx_Math" display="inline" id="S3.SS5.p1.5.m5.1"><semantics id="S3.SS5.p1.5.m5.1a"><msubsup id="S3.SS5.p1.5.m5.1.1" xref="S3.SS5.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.5.m5.1.1.2.2" xref="S3.SS5.p1.5.m5.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS5.p1.5.m5.1.1.2.3" xref="S3.SS5.p1.5.m5.1.1.2.3.cmml">C</mi><mo id="S3.SS5.p1.5.m5.1.1.3" xref="S3.SS5.p1.5.m5.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m5.1b"><apply id="S3.SS5.p1.5.m5.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.1.1.1.cmml" xref="S3.SS5.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS5.p1.5.m5.1.1.2.cmml" xref="S3.SS5.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m5.1.1.2.1.cmml" xref="S3.SS5.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS5.p1.5.m5.1.1.2.2.cmml" xref="S3.SS5.p1.5.m5.1.1.2.2">ℳ</ci><ci id="S3.SS5.p1.5.m5.1.1.2.3.cmml" xref="S3.SS5.p1.5.m5.1.1.2.3">𝐶</ci></apply><times id="S3.SS5.p1.5.m5.1.1.3.cmml" xref="S3.SS5.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m5.1c">\mathcal{M}_{C}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.5.m5.1d">caligraphic_M start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. To obtain <math alttext="\mathcal{M}_{C}^{*}" class="ltx_Math" display="inline" id="S3.SS5.p1.6.m6.1"><semantics id="S3.SS5.p1.6.m6.1a"><msubsup id="S3.SS5.p1.6.m6.1.1" xref="S3.SS5.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p1.6.m6.1.1.2.2" xref="S3.SS5.p1.6.m6.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS5.p1.6.m6.1.1.2.3" xref="S3.SS5.p1.6.m6.1.1.2.3.cmml">C</mi><mo id="S3.SS5.p1.6.m6.1.1.3" xref="S3.SS5.p1.6.m6.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m6.1b"><apply id="S3.SS5.p1.6.m6.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m6.1.1.1.cmml" xref="S3.SS5.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS5.p1.6.m6.1.1.2.cmml" xref="S3.SS5.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m6.1.1.2.1.cmml" xref="S3.SS5.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS5.p1.6.m6.1.1.2.2.cmml" xref="S3.SS5.p1.6.m6.1.1.2.2">ℳ</ci><ci id="S3.SS5.p1.6.m6.1.1.2.3.cmml" xref="S3.SS5.p1.6.m6.1.1.2.3">𝐶</ci></apply><times id="S3.SS5.p1.6.m6.1.1.3.cmml" xref="S3.SS5.p1.6.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m6.1c">\mathcal{M}_{C}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p1.6.m6.1d">caligraphic_M start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>, we would need to solve the following minimax problem.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{M}_{C}^{*}=\operatorname*{arg\,min}_{\mathcal{M}_{C}\subset\mathcal{M%
}}\max_{m\in\mathcal{M}}\max_{n\in\mathcal{M}_{C}}|m-n|_{2}" class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msubsup id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.3.2.2" xref="S3.E8.m1.1.1.3.2.2.cmml">ℳ</mi><mi id="S3.E8.m1.1.1.3.2.3" xref="S3.E8.m1.1.1.3.2.3.cmml">C</mi><mo id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml">∗</mo></msubsup><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.2.cmml"><munder id="S3.E8.m1.1.1.1.2.1" xref="S3.E8.m1.1.1.1.2.1.cmml"><mrow id="S3.E8.m1.1.1.1.2.1.2" xref="S3.E8.m1.1.1.1.2.1.2.cmml"><mi id="S3.E8.m1.1.1.1.2.1.2.2" xref="S3.E8.m1.1.1.1.2.1.2.2.cmml">arg</mi><mo id="S3.E8.m1.1.1.1.2.1.2.1" lspace="0.170em" xref="S3.E8.m1.1.1.1.2.1.2.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.2.1.2.3" xref="S3.E8.m1.1.1.1.2.1.2.3.cmml">min</mi></mrow><mrow id="S3.E8.m1.1.1.1.2.1.3" xref="S3.E8.m1.1.1.1.2.1.3.cmml"><msub id="S3.E8.m1.1.1.1.2.1.3.2" xref="S3.E8.m1.1.1.1.2.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.2.1.3.2.2" xref="S3.E8.m1.1.1.1.2.1.3.2.2.cmml">ℳ</mi><mi id="S3.E8.m1.1.1.1.2.1.3.2.3" xref="S3.E8.m1.1.1.1.2.1.3.2.3.cmml">C</mi></msub><mo id="S3.E8.m1.1.1.1.2.1.3.1" xref="S3.E8.m1.1.1.1.2.1.3.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.2.1.3.3" xref="S3.E8.m1.1.1.1.2.1.3.3.cmml">ℳ</mi></mrow></munder><mo id="S3.E8.m1.1.1.1.2a" lspace="0.167em" xref="S3.E8.m1.1.1.1.2.cmml">⁡</mo><munder id="S3.E8.m1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.2.2.2.cmml">max</mi><mrow id="S3.E8.m1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.2.2.3.2" xref="S3.E8.m1.1.1.1.2.2.3.2.cmml">m</mi><mo id="S3.E8.m1.1.1.1.2.2.3.1" xref="S3.E8.m1.1.1.1.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.2.2.3.3" xref="S3.E8.m1.1.1.1.2.2.3.3.cmml">ℳ</mi></mrow></munder></mrow><mo id="S3.E8.m1.1.1.1a" lspace="0.167em" xref="S3.E8.m1.1.1.1.cmml">⁡</mo><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><munder id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.1.1.2.2" xref="S3.E8.m1.1.1.1.1.2.2.cmml">max</mi><mrow id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.2.3.2" xref="S3.E8.m1.1.1.1.1.2.3.2.cmml">n</mi><mo id="S3.E8.m1.1.1.1.1.2.3.1" xref="S3.E8.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E8.m1.1.1.1.1.2.3.3" xref="S3.E8.m1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.2.3.3.2" xref="S3.E8.m1.1.1.1.1.2.3.3.2.cmml">ℳ</mi><mi id="S3.E8.m1.1.1.1.1.2.3.3.3" xref="S3.E8.m1.1.1.1.1.2.3.3.3.cmml">C</mi></msub></mrow></munder><mo id="S3.E8.m1.1.1.1.1a" xref="S3.E8.m1.1.1.1.1.cmml">⁡</mo><msub id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.E8.m1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml">n</mi></mrow><mo id="S3.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mn id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></eq><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3">superscript</csymbol><apply id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2">ℳ</ci><ci id="S3.E8.m1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.3.2.3">𝐶</ci></apply><times id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3"></times></apply><apply id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><apply id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.2"><apply id="S3.E8.m1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.2.1.1.cmml" xref="S3.E8.m1.1.1.1.2.1">subscript</csymbol><apply id="S3.E8.m1.1.1.1.2.1.2.cmml" xref="S3.E8.m1.1.1.1.2.1.2"><times id="S3.E8.m1.1.1.1.2.1.2.1.cmml" xref="S3.E8.m1.1.1.1.2.1.2.1"></times><ci id="S3.E8.m1.1.1.1.2.1.2.2.cmml" xref="S3.E8.m1.1.1.1.2.1.2.2">arg</ci><ci id="S3.E8.m1.1.1.1.2.1.2.3.cmml" xref="S3.E8.m1.1.1.1.2.1.2.3">min</ci></apply><apply id="S3.E8.m1.1.1.1.2.1.3.cmml" xref="S3.E8.m1.1.1.1.2.1.3"><subset id="S3.E8.m1.1.1.1.2.1.3.1.cmml" xref="S3.E8.m1.1.1.1.2.1.3.1"></subset><apply id="S3.E8.m1.1.1.1.2.1.3.2.cmml" xref="S3.E8.m1.1.1.1.2.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.2.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.2.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.2.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.2.1.3.2.2">ℳ</ci><ci id="S3.E8.m1.1.1.1.2.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.2.1.3.2.3">𝐶</ci></apply><ci id="S3.E8.m1.1.1.1.2.1.3.3.cmml" xref="S3.E8.m1.1.1.1.2.1.3.3">ℳ</ci></apply></apply><apply id="S3.E8.m1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.1.2.2">subscript</csymbol><max id="S3.E8.m1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.2.2.2"></max><apply id="S3.E8.m1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.2.2.3"><in id="S3.E8.m1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.1.1.1.2.2.3.1"></in><ci id="S3.E8.m1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.1.1.1.2.2.3.2">𝑚</ci><ci id="S3.E8.m1.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.1.1.1.2.2.3.3">ℳ</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><max id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2"></max><apply id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3"><in id="S3.E8.m1.1.1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.3.1"></in><ci id="S3.E8.m1.1.1.1.1.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.3.2">𝑛</ci><apply id="S3.E8.m1.1.1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.2.3.3.2">ℳ</ci><ci id="S3.E8.m1.1.1.1.1.2.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3.3.3">𝐶</ci></apply></apply></apply><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><abs id="S3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2"></abs><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1"><minus id="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2">𝑚</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3">𝑛</ci></apply></apply><cn id="S3.E8.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathcal{M}_{C}^{*}=\operatorname*{arg\,min}_{\mathcal{M}_{C}\subset\mathcal{M%
}}\max_{m\in\mathcal{M}}\max_{n\in\mathcal{M}_{C}}|m-n|_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">caligraphic_M start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_min end_OPERATOR start_POSTSUBSCRIPT caligraphic_M start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT ⊂ caligraphic_M end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT italic_m ∈ caligraphic_M end_POSTSUBSCRIPT roman_max start_POSTSUBSCRIPT italic_n ∈ caligraphic_M start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT end_POSTSUBSCRIPT | italic_m - italic_n | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.2">During inference, we compare the <math alttext="L2" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.1"><semantics id="S3.SS5.p3.1.m1.1a"><mrow id="S3.SS5.p3.1.m1.1.1" xref="S3.SS5.p3.1.m1.1.1.cmml"><mi id="S3.SS5.p3.1.m1.1.1.2" xref="S3.SS5.p3.1.m1.1.1.2.cmml">L</mi><mo id="S3.SS5.p3.1.m1.1.1.1" xref="S3.SS5.p3.1.m1.1.1.1.cmml">⁢</mo><mn id="S3.SS5.p3.1.m1.1.1.3" xref="S3.SS5.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.1b"><apply id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1"><times id="S3.SS5.p3.1.m1.1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1.1"></times><ci id="S3.SS5.p3.1.m1.1.1.2.cmml" xref="S3.SS5.p3.1.m1.1.1.2">𝐿</ci><cn id="S3.SS5.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS5.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.1c">L2</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.1d">italic_L 2</annotation></semantics></math> distance between each feature extracted from the query image and the memory bank, <math alttext="\mathcal{M}_{C}^{*}" class="ltx_Math" display="inline" id="S3.SS5.p3.2.m2.1"><semantics id="S3.SS5.p3.2.m2.1a"><msubsup id="S3.SS5.p3.2.m2.1.1" xref="S3.SS5.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS5.p3.2.m2.1.1.2.2" xref="S3.SS5.p3.2.m2.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS5.p3.2.m2.1.1.2.3" xref="S3.SS5.p3.2.m2.1.1.2.3.cmml">C</mi><mo id="S3.SS5.p3.2.m2.1.1.3" xref="S3.SS5.p3.2.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.1b"><apply id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1">superscript</csymbol><apply id="S3.SS5.p3.2.m2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.2.1.cmml" xref="S3.SS5.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS5.p3.2.m2.1.1.2.2.cmml" xref="S3.SS5.p3.2.m2.1.1.2.2">ℳ</ci><ci id="S3.SS5.p3.2.m2.1.1.2.3.cmml" xref="S3.SS5.p3.2.m2.1.1.2.3">𝐶</ci></apply><times id="S3.SS5.p3.2.m2.1.1.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.1c">\mathcal{M}_{C}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>. Anomalous image patches are unseen in the memory bank, hence have a greater distance compared to normal features. To increase the robustness of anomaly score, a scaling factor is introduced to reweight the anomaly score by taking in account the nearest neighbours of the closest features in the memory bank.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Results</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.7">We choose a public brain MRI images to benchmark CONSULT with previous anomaly detection algorithms <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">braindataset_chakrabarty</span>]</cite>. We only use healthy image for training and move all tumorous images to the validation dataset. Next, we sample 2 (<math alttext="K2" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">K</mi><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><times id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></times><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝐾</ci><cn id="S4.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">K2</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_K 2</annotation></semantics></math>) to 8 shots (<math alttext="K8" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">K</mi><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">⁢</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐾</ci><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">K8</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_K 8</annotation></semantics></math>) of training data from the healthy training set for training CONSULT and discard the rest. All image size are resized to 256 <math alttext="\times" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mo id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><times id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">×</annotation></semantics></math> 256 pixels. CONSULT is trained with 50 epochs in the first training stage. The learning rate is set to <math alttext="1e-4" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml"><mn id="S4.SS1.p1.4.m4.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.2.2.cmml">1</mn><mo id="S4.SS1.p1.4.m4.1.1.2.1" xref="S4.SS1.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S4.SS1.p1.4.m4.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.2.3.cmml">e</mi></mrow><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><minus id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></minus><apply id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2"><times id="S4.SS1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2.1"></times><cn id="S4.SS1.p1.4.m4.1.1.2.2.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.2.2">1</cn><ci id="S4.SS1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3">𝑒</ci></apply><cn id="S4.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">1e-4</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">1 italic_e - 4</annotation></semantics></math> and we use adam optimizer.
In the second stage, the coreset sampling ratio is <math alttext="10\%" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mn id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">10</mn><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="latexml" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1">percent</csymbol><cn id="S4.SS1.p1.5.m5.1.1.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">10 %</annotation></semantics></math> and <math alttext="K" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_K</annotation></semantics></math> nearest neighbor is <math alttext="9" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><mn id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><cn id="S4.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">9</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">9</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">CONSULT is able to outperform current state-of-the-art anomaly detection algorithms in a low shot scenario. CONSULT shows consistent improvement when more training images are used. PaDIM and PatchCore are two most common downstream anomaly detection algorithms. We also compare CONSULT with reconstruction based anomaly detection such as f-AnoGAN, GANormaly, and EfficientAD. To train a robust model for f-AnoGAN and GANormaly, we increase the training epoch to <math alttext="100" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mn id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><cn id="S4.SS1.p2.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">100</annotation></semantics></math>. The settings for PaDIM and EfficientAD follow the original implementation <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">defard2021padim</span>, <span class="ltx_ref ltx_missing_citation ltx_ref_self">batzner2024efficientad</span>]</cite>. The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.T1" title="Table 1 ‣ 4.1 Results ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.3.2" style="font-size:90%;">Image AUROC for Few Shot Brain Tumor Detection</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S4.T1.4.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.1.1">Method</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T1.4.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.2.1">K2</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T1.4.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.3.1">K4</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T1.4.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.4.1">K6</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T1.4.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.1.5.1">K8</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.4.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.4.2.1.1">f-AnoGAN</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.2">0.7291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.3">0.8119</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.4">0.8251</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.2.1.5">0.7751</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.3.2.1">GANormaly</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.2">0.8051</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.3">0.7669</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.4">0.7727</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.3.2.5">0.7817</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.4.3.1">PaDIM</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.2">0.6151</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.3">0.7650</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.4">0.7732</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3.5">0.7710</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.5.4.1">EfficientAD</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.5.4.2">0.7171</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.5.4.3">0.7554</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.5.4.4">0.7683</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.5.4.5">0.7438</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.6.5.1">PatchCore</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.6.5.2">0.7727</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.6.5.3">0.7554</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.6.5.4">0.7742</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.6.5.5">0.8138</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.4.7.6.1">Ours</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.6.2"><span class="ltx_text ltx_font_bold" id="S4.T1.4.7.6.2.1">0.8663</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.6.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.7.6.3.1">0.8841</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.6.4"><span class="ltx_text ltx_font_bold" id="S4.T1.4.7.6.4.1">0.8758</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.7.6.5"><span class="ltx_text ltx_font_bold" id="S4.T1.4.7.6.5.1">0.8738</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">CONSULT is directly comparable to PatchCore as it uses the anomaly detection head from PatchCore without any changes. This outcome underscores the efficiency of CONSULT in leveraging minimal data for effective learning.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Discussion</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The reconstruction-based anomaly detection trains the model to reconstruct the semantic information of healthy samples. However, it need to have high training epoch and a plethora of training samples. It is also worth noting that reconstruction-based anomaly detection offer robustness, but they tend to be less stable and reliable compared to downstream approaches. As the number of training samples increases, we report a lower AUROC for reconstruction approaches. A deeper examination of the reconstructed pictures reveals that, in comparison to the 2 shot experiment, the reconstructed image quality for the 8 shot experiment is poorer. This is because the model is confused due to the increased number of good representations. Downstream approaches lack the robustness inherent in reconstruction-based approaches. This is because the weights used in the downstream approaches are not fine-tuned to the target domain dataset.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">This discrepancy between downstream-based anomaly detection and reconstruction-based approaches catalyzes the development of CONSULT. CONSULT aims to amalgamate the strengths of both downstream and reconstruction approaches. By leveraging unsupervised contrastive learning for backbone fine-tuning, we have demonstrated significant improvements in PatchCore. Specifically, 9.4%, 12.9%, 10.2%, and 6.0% for 2, 4, 6, and 8 shots respectively. The improvement for our solution primarily comes from the pretraining stage. The objective of the pretraining stage respect the way anomaly detection is being done. Therefore, it can extract more compact features compared to ImageNet, improving the robustness of the feature extractor. In section <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3.SSS1" title="4.3.1 Evaluation of CONSULT for Domain Adaptation ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">4.3.1</span></a>, we show our pretraining stage proves to be more effective in extracting features for anomaly detection compared to a supervised training method such as classification and segmentation.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.4">Traditional anchor loss, a typical loss function for contrastive learning is unbounded and can result in multiple solutions. Furthermore, choosing the optimal parameters for anchor loss is extremely hard as it will directly affect the training objective. We proposed a novel loss function that is bounded and more robust compared to anchor loss. <span class="ltx_text ltx_markedasmath" id="S4.SS2.p3.4.1">Tritanh</span> loss only has a single solution, and the parameters for <span class="ltx_text ltx_markedasmath" id="S4.SS2.p3.4.2">Tritanh</span> loss have less effect on the training objectives. Besides, the gradient for <span class="ltx_text ltx_markedasmath" id="S4.SS2.p3.4.3">Tritanh</span> loss is steeper compared to anchor loss. The implementation of <span class="ltx_text ltx_markedasmath" id="S4.SS2.p3.4.4">Tritanh</span> loss significantly improves upon anchor loss both in robustness and training stability. Next, we introduce other loss functions and regularizers to aid and stabilize the training process. Self-similarity loss maximizes the similarity of healthy features, effectively reducing the need for large training data. It is also coherent with the way PatchCore evaluates anomalies. However, self-similarity loss is very unstable and will result in catastrophic collapse to a singular point as the training epoch progresses. To counter this problem, we introduce a KoLeo Loss as a regularizer for self-similarity loss. We modify the input for KoLeo Loss to be the final feature output from the backbone. Doing so allows the final feature to be more well spread, opposing the self-similarity loss. In section <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3.SSS2" title="4.3.2 Evaluation of Loss Function ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">4.3.2</span></a>, we compare the effectiveness of the proposed loss functions on CONSULT.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">The attention module iteratively helps the model "focus" on regions that are considered anomalous. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S3.F3" title="Figure 3 ‣ 3.3 Context-Aware Contrastive Learning for MRI Anomaly Detection ‣ 3 Methodology ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">3</span></a>, the feature maps predicted from each layer focus on the brain tumor region of the query image. Next, we change the activation function of the feature extractor from ReLu to Leaky ReLu for better gradient flow. These improvements help the model to extract a more robust feature compared to a standard ResNet backbone. In section <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.SS3.SSS3" title="4.3.3 Evaluation of Feature Extractor ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">4.3.3</span></a>, we compare different feature extractors and the modifications we did to them.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Evaluation of CONSULT for Domain Adaptation</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">To empirically demonstrate the effectiveness of CONSULT in backbone fine-tuning, we conducted a comprehensive benchmarking experiment by comparing the performance of CONSULT against conventional fine-tuning methods derived from classification and segmentation tasks. The aim is to provide a clear and objective assessment of how CONSULT enhances the backbone’s adaptability and accuracy in anomaly detection within medical imaging. Additionally, to ensure fairness and relevance in our comparisons, the fine-tuned backbone from these experiments was integrated into PatchCore. This integration allowed us to assess how effectively the CONSULT-enhanced backbone performs in real-world anomaly detection scenarios.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<p class="ltx_p" id="S4.SS3.SSS1.p2.1">The dataset used for training the classification and segmentation model is the testing dataset used for benchmarking the anomaly detection algorithm. In other words, the backbone is fully aware of the defects’ semantic information, making this comparison significantly unfair to CONSULT. We use ResNet18 as the backbone for the classification model and a head with an output size of 2. For the segmentation model, we use U-Net++ architecture and ResNet18 as its encoder backbone. The classification model achieved a validation accuracy score of 1.0 while the segmentation model achieved a validation IoU of 0.99. Although this benchmarking is unfair to us, CONSULT proved to be an effective unsupervised learning method to fine-tune a backbone for better feature extraction compared to the conventional fully supervised method.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.2.1.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S4.T2.3.2" style="font-size:90%;">Ablation Study: Domain Adaptation</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.4.1.1.2">Anno.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.3">K2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.4">K4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.5">K6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.1.1.6">K8</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.4.2.1.1">CLS</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.4.2.1.2">✓</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.2.1.3">0.7376</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.2.1.4">0.7074</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.2.1.5">0.7739</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.2.1.6">0.7411</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.3.2.1">SEG</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T2.4.3.2.2">✓</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.3">0.8273</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.4">0.6904</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.5">0.6887</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.3.2.6">0.6173</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.1">Our</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T2.4.4.3.2">✗</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.3"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.3.1">0.8663</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.4.1">0.8841</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.5"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.5.1">0.8758</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3.6"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.6.1">0.8686</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Evaluation of Loss Function</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">We improve upon anchor loss by addressing several pain points: 1) boundlessness, 2) multiple solutions, and 3) weak gradient flow. The proposed contrastive loss function, inspired by the Euler form of the hyperbolic tangent function, is termed <span class="ltx_text ltx_markedasmath" id="S4.SS3.SSS2.p1.1.1">Tritanh</span> loss.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.8"><span class="ltx_text ltx_markedasmath" id="S4.SS3.SSS2.p2.8.1">Tritanh</span> loss is bounded from -1 to 2 with optimal solution reached will reach when <math alttext="d_{pull}\longrightarrow 0" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.2.m2.1"><semantics id="S4.SS3.SSS2.p2.2.m2.1a"><mrow id="S4.SS3.SSS2.p2.2.m2.1.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.cmml"><msub id="S4.SS3.SSS2.p2.2.m2.1.1.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml"><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.2.cmml">d</mi><mrow id="S4.SS3.SSS2.p2.2.m2.1.1.2.3" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.2" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.3" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.3.cmml">u</mi><mo id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1a" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.4" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.4.cmml">l</mi><mo id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1b" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.5" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.5.cmml">l</mi></mrow></msub><mo id="S4.SS3.SSS2.p2.2.m2.1.1.1" stretchy="false" xref="S4.SS3.SSS2.p2.2.m2.1.1.1.cmml">⟶</mo><mn id="S4.SS3.SSS2.p2.2.m2.1.1.3" xref="S4.SS3.SSS2.p2.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.2.m2.1b"><apply id="S4.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1"><ci id="S4.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.1">⟶</ci><apply id="S4.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.2">𝑑</ci><apply id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3"><times id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.3">𝑢</ci><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.4.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.4">𝑙</ci><ci id="S4.SS3.SSS2.p2.2.m2.1.1.2.3.5.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1.2.3.5">𝑙</ci></apply></apply><cn id="S4.SS3.SSS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S4.SS3.SSS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.2.m2.1c">d_{pull}\longrightarrow 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_p italic_u italic_l italic_l end_POSTSUBSCRIPT ⟶ 0</annotation></semantics></math> and <math alttext="d_{push}\longrightarrow\infty" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.3.m3.1"><semantics id="S4.SS3.SSS2.p2.3.m3.1a"><mrow id="S4.SS3.SSS2.p2.3.m3.1.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.cmml"><msub id="S4.SS3.SSS2.p2.3.m3.1.1.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml"><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.2.cmml">d</mi><mrow id="S4.SS3.SSS2.p2.3.m3.1.1.2.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3.cmml">u</mi><mo id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1a" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.4" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.4.cmml">s</mi><mo id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1b" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.5" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.5.cmml">h</mi></mrow></msub><mo id="S4.SS3.SSS2.p2.3.m3.1.1.1" stretchy="false" xref="S4.SS3.SSS2.p2.3.m3.1.1.1.cmml">⟶</mo><mi id="S4.SS3.SSS2.p2.3.m3.1.1.3" mathvariant="normal" xref="S4.SS3.SSS2.p2.3.m3.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.3.m3.1b"><apply id="S4.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1"><ci id="S4.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.1">⟶</ci><apply id="S4.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.2">𝑑</ci><apply id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3"><times id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.3">𝑢</ci><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.4.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.4">𝑠</ci><ci id="S4.SS3.SSS2.p2.3.m3.1.1.2.3.5.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.2.3.5">ℎ</ci></apply></apply><infinity id="S4.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.3.m3.1c">d_{push}\longrightarrow\infty</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_p italic_u italic_s italic_h end_POSTSUBSCRIPT ⟶ ∞</annotation></semantics></math>. This ensures that the computed loss does not destabilize the training process.
In contrast to anchor loss which will result in multiple solutions as long as the pushing force is greater than the pulling force by a margin, <span class="ltx_text ltx_markedasmath" id="S4.SS3.SSS2.p2.8.2">Tritanh</span> loss only has a single unique solution. Multiple minima can make the training process more challenging because the optimization algorithm may get stuck in local minima rather than finding the global minimum.
Additionally, due to the exponential gradient flow, <span class="ltx_text ltx_markedasmath" id="S4.SS3.SSS2.p2.8.3">Tritanh</span> loss gradually slows down as it approaches the minimum, making a near-optimal solution (<math alttext="d_{pull}\approx 0" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.6.m6.1"><semantics id="S4.SS3.SSS2.p2.6.m6.1a"><mrow id="S4.SS3.SSS2.p2.6.m6.1.1" xref="S4.SS3.SSS2.p2.6.m6.1.1.cmml"><msub id="S4.SS3.SSS2.p2.6.m6.1.1.2" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.cmml"><mi id="S4.SS3.SSS2.p2.6.m6.1.1.2.2" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.2.cmml">d</mi><mrow id="S4.SS3.SSS2.p2.6.m6.1.1.2.3" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.2" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.3" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.3.cmml">u</mi><mo id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1a" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.4" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.4.cmml">l</mi><mo id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1b" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.5" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.5.cmml">l</mi></mrow></msub><mo id="S4.SS3.SSS2.p2.6.m6.1.1.1" xref="S4.SS3.SSS2.p2.6.m6.1.1.1.cmml">≈</mo><mn id="S4.SS3.SSS2.p2.6.m6.1.1.3" xref="S4.SS3.SSS2.p2.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.6.m6.1b"><apply id="S4.SS3.SSS2.p2.6.m6.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1"><approx id="S4.SS3.SSS2.p2.6.m6.1.1.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.1"></approx><apply id="S4.SS3.SSS2.p2.6.m6.1.1.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.6.m6.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS2.p2.6.m6.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.2">𝑑</ci><apply id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3"><times id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.3">𝑢</ci><ci id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.4.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.4">𝑙</ci><ci id="S4.SS3.SSS2.p2.6.m6.1.1.2.3.5.cmml" xref="S4.SS3.SSS2.p2.6.m6.1.1.2.3.5">𝑙</ci></apply></apply><cn id="S4.SS3.SSS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S4.SS3.SSS2.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.6.m6.1c">d_{pull}\approx 0</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.6.m6.1d">italic_d start_POSTSUBSCRIPT italic_p italic_u italic_l italic_l end_POSTSUBSCRIPT ≈ 0</annotation></semantics></math> and <math alttext="d_{push}\approx\infty" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.7.m7.1"><semantics id="S4.SS3.SSS2.p2.7.m7.1a"><mrow id="S4.SS3.SSS2.p2.7.m7.1.1" xref="S4.SS3.SSS2.p2.7.m7.1.1.cmml"><msub id="S4.SS3.SSS2.p2.7.m7.1.1.2" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.cmml"><mi id="S4.SS3.SSS2.p2.7.m7.1.1.2.2" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.2.cmml">d</mi><mrow id="S4.SS3.SSS2.p2.7.m7.1.1.2.3" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.2" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.3" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.3.cmml">u</mi><mo id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1a" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.4" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.4.cmml">s</mi><mo id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1b" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.5" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.5.cmml">h</mi></mrow></msub><mo id="S4.SS3.SSS2.p2.7.m7.1.1.1" xref="S4.SS3.SSS2.p2.7.m7.1.1.1.cmml">≈</mo><mi id="S4.SS3.SSS2.p2.7.m7.1.1.3" mathvariant="normal" xref="S4.SS3.SSS2.p2.7.m7.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.7.m7.1b"><apply id="S4.SS3.SSS2.p2.7.m7.1.1.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1"><approx id="S4.SS3.SSS2.p2.7.m7.1.1.1.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.1"></approx><apply id="S4.SS3.SSS2.p2.7.m7.1.1.2.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.7.m7.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS2.p2.7.m7.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.2">𝑑</ci><apply id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3"><times id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.3">𝑢</ci><ci id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.4.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.4">𝑠</ci><ci id="S4.SS3.SSS2.p2.7.m7.1.1.2.3.5.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.2.3.5">ℎ</ci></apply></apply><infinity id="S4.SS3.SSS2.p2.7.m7.1.1.3.cmml" xref="S4.SS3.SSS2.p2.7.m7.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.7.m7.1c">d_{push}\approx\infty</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.7.m7.1d">italic_d start_POSTSUBSCRIPT italic_p italic_u italic_s italic_h end_POSTSUBSCRIPT ≈ ∞</annotation></semantics></math>) almost equal to the true optimal solution. In practice, achieving the true optimal solution is not necessary; an approximation of it is sufficient for effective performance.
Furthermore, the gradient flow when <math alttext="d_{pull}\approx d_{push}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.8.m8.1"><semantics id="S4.SS3.SSS2.p2.8.m8.1a"><mrow id="S4.SS3.SSS2.p2.8.m8.1.1" xref="S4.SS3.SSS2.p2.8.m8.1.1.cmml"><msub id="S4.SS3.SSS2.p2.8.m8.1.1.2" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.cmml"><mi id="S4.SS3.SSS2.p2.8.m8.1.1.2.2" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.2.cmml">d</mi><mrow id="S4.SS3.SSS2.p2.8.m8.1.1.2.3" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.cmml"><mi id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.2" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.3" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.3.cmml">u</mi><mo id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1a" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.4" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.4.cmml">l</mi><mo id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1b" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.5" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.5.cmml">l</mi></mrow></msub><mo id="S4.SS3.SSS2.p2.8.m8.1.1.1" xref="S4.SS3.SSS2.p2.8.m8.1.1.1.cmml">≈</mo><msub id="S4.SS3.SSS2.p2.8.m8.1.1.3" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.cmml"><mi id="S4.SS3.SSS2.p2.8.m8.1.1.3.2" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.2.cmml">d</mi><mrow id="S4.SS3.SSS2.p2.8.m8.1.1.3.3" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.cmml"><mi id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.2" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.2.cmml">p</mi><mo id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.3" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.3.cmml">u</mi><mo id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1a" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.4" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.4.cmml">s</mi><mo id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1b" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.5" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.5.cmml">h</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.8.m8.1b"><apply id="S4.SS3.SSS2.p2.8.m8.1.1.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1"><approx id="S4.SS3.SSS2.p2.8.m8.1.1.1.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.1"></approx><apply id="S4.SS3.SSS2.p2.8.m8.1.1.2.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.8.m8.1.1.2.1.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS2.p2.8.m8.1.1.2.2.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.2">𝑑</ci><apply id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3"><times id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.1"></times><ci id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.2.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.3.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.3">𝑢</ci><ci id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.4.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.4">𝑙</ci><ci id="S4.SS3.SSS2.p2.8.m8.1.1.2.3.5.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.2.3.5">𝑙</ci></apply></apply><apply id="S4.SS3.SSS2.p2.8.m8.1.1.3.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p2.8.m8.1.1.3.1.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS2.p2.8.m8.1.1.3.2.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.2">𝑑</ci><apply id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3"><times id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.1"></times><ci id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.2.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.2">𝑝</ci><ci id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.3.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.3">𝑢</ci><ci id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.4.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.4">𝑠</ci><ci id="S4.SS3.SSS2.p2.8.m8.1.1.3.3.5.cmml" xref="S4.SS3.SSS2.p2.8.m8.1.1.3.3.5">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.8.m8.1c">d_{pull}\approx d_{push}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS2.p2.8.m8.1d">italic_d start_POSTSUBSCRIPT italic_p italic_u italic_l italic_l end_POSTSUBSCRIPT ≈ italic_d start_POSTSUBSCRIPT italic_p italic_u italic_s italic_h end_POSTSUBSCRIPT</annotation></semantics></math> is stepper compared to anchor loss, which only has a constant gradient flow helping the model to converge faster.
Table <a class="ltx_ref" href="https://arxiv.org/html/2410.11307v1#S4.T3" title="Table 3 ‣ 4.3.2 Evaluation of Loss Function ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ CONSULT: Contrastive Self-Supervised Learning for Few-shot Tumor Detection"><span class="ltx_text ltx_ref_tag">3</span></a> compares the result obtained from different loss functions.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.2.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="S4.T3.3.2" style="font-size:90%;">Ablation Study: Loss Function</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.4.1.1.1">Loss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.4.1.1.2">+ SSL</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.4.1.1.3">+ KoLeo</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.4">K2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.5">K4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.6">K6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.7">K8</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T3.4.2.1.1">Anchor</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T3.4.2.1.2">✗</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T3.4.2.1.3">✗</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.2.1.4">0.7457</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.2.1.5">0.7527</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.2.1.6">0.6833</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.2.1.7">0.6912</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.3.2.1">Tritanh</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.3.2.2">✗</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.3.2.3">✗</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.3.2.4">0.791</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.3.2.5">0.8314</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.3.2.6">0.8415</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.3.2.7">0.8305</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.4.3.1">Tritanh</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.4.3.2">✗</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.4.3.3">✓</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.3.4">0.7820</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.3.5">0.8313</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.3.6">0.8486</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.4.3.7">0.8254</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.5.4.1">Tritanh</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T3.4.5.4.2">✓</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T3.4.5.4.3">✗</th>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.4.4">0.8508</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.4.5">0.8531</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.4.6">0.8558</td>
<td class="ltx_td ltx_align_center" id="S4.T3.4.5.4.7">0.8451</td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T3.4.6.5.1">Tritanh</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T3.4.6.5.2">✓</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T3.4.6.5.3">✓</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.6.5.4"><span class="ltx_text ltx_font_bold" id="S4.T3.4.6.5.4.1">0.8663</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.6.5.5"><span class="ltx_text ltx_font_bold" id="S4.T3.4.6.5.5.1">0.8841</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.6.5.6"><span class="ltx_text ltx_font_bold" id="S4.T3.4.6.5.6.1">0.8758</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.6.5.7"><span class="ltx_text ltx_font_bold" id="S4.T3.4.6.5.7.1">0.8738</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Evaluation of Feature Extractor</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.1">In this section, we compare the modification we have done on the feature extractor. We compare two backbones, ResNet18 and ResNet50. There are two modifications to the traditional backbone that enable us to obtain a richer feature from the query images. The first is the introduction of attention modules after the ResBlocks. The attention modules will help to focus on the defective areas of the query images and it can be seen highlighting defective regions when performing inference. Next, we change the activation function from ReLu to Leaky ReLu to enable negative values in the extracted features, further enriching the feature extraction process.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.2.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S4.T4.3.2" style="font-size:90%;">Ablation Study: Model Selection</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.4.1.1.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T4.4.1.1.2">Attn.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.4.1.1.3">Act.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.4">K2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.5">K4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.6">K6</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.4.1.1.7">K8</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.4.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T4.4.2.1.1">ResNet18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T4.4.2.1.2">None</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.4.2.1.3">ReLu</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.4.2.1.4">0.8296</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.4.2.1.5">0.8502</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.4.2.1.6">0.8538</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.4.2.1.7">0.8512</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.3.2.1">ResNet18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.3.2.2">Attention</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.3.2.3">ReLu</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.4">0.8559</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.5">0.8572</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.6">0.8444</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.3.2.7">0.8591</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.4.3.1">ResNet18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.4.3.2">None</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.4.3.3">Leaky</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.3.4">0.8587</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.3.5">0.8541</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.3.6">0.8450</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.4.3.7">0.8588</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.5.4.1">ResNet18</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.5.4.2">Attention</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.5.4.3">Leaky</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.5.4.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.5.4.4.1">0.8663</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.5.4.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.5.4.5.1">0.8841</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.5.4.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.5.4.6.1">0.8758</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.5.4.7"><span class="ltx_text ltx_font_bold" id="S4.T4.4.5.4.7.1">0.8686</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.6.5.1">ResNet50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.6.5.2">None</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.6.5.3">ReLu</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.6.5.4">0.8063</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.6.5.5">0.8477</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.6.5.6">0.8518</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.6.5.7">0.8539</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.7.6.1">ResNet50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.7.6.2">Attention</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.7.6.3">ReLu</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.7.6.4">0.7885</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.7.6.5">0.8507</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.7.6.6">0.8566</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.7.6.7"><span class="ltx_text ltx_font_bold" id="S4.T4.4.7.6.7.1">0.8636</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.8.7.1">ResNet50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T4.4.8.7.2">None</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T4.4.8.7.3">Leaky</th>
<td class="ltx_td ltx_align_center" id="S4.T4.4.8.7.4"><span class="ltx_text ltx_font_bold" id="S4.T4.4.8.7.4.1">0.8557</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.8.7.5">0.8531</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.8.7.6">0.8569</td>
<td class="ltx_td ltx_align_center" id="S4.T4.4.8.7.7">0.8558</td>
</tr>
<tr class="ltx_tr" id="S4.T4.4.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T4.4.9.8.1">ResNet50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T4.4.9.8.2">Attention</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T4.4.9.8.3">Leaky</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.9.8.4">0.8500</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.9.8.5"><span class="ltx_text ltx_font_bold" id="S4.T4.4.9.8.5.1">0.8558</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.9.8.6"><span class="ltx_text ltx_font_bold" id="S4.T4.4.9.8.6.1">0.8631</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.4.9.8.7">0.8408</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS3.SSS3.p2">
<p class="ltx_p" id="S4.SS3.SSS3.p2.1">For both ResNet18 and ResNet50, the modifications to the feature extractor show improvement in extracting more robust features by introducing attention modules and increasing the feature activation function.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we proposed CONSULT for few-shot anomaly detection in MRI images. Anomaly detection is effective for medical images because it relies solely on healthy images for training, eliminating the need for labeled data. CONSULT addresses this by combining the strengths of downstream and reconstruction-based anomaly detection algorithms. We introduced a stringent objective function to fine-tune the feature extractor, enhancing robustness while reducing the need for an abundance of training data. Our results show that CONSULT significantly improves PatchCore in MRI disease recognition and outperforms other reconstruction methods. Future work will extend CONSULT to various datasets, including other medical images, traffic anomalies, and industrial datasets.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgment</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This paper is completed during the industrial attachment with ViTrox Corporation Sdn. Bhd.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<span class="ltx_ERROR undefined" id="Sx1.p2.1">\printbibliography</span>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct 15 06:09:50 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
