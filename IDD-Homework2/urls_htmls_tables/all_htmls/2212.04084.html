<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2212.04084] Federated Learning for Inference at Anytime and Anywhere</title><meta property="og:description" content="Federated learning has been predominantly concerned with collaborative training of deep networks from scratch, and especially the many challenges that arise, such as communication cost, robustness to heterogeneous data…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning for Inference at Anytime and Anywhere">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning for Inference at Anytime and Anywhere">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2212.04084">

<!--Generated on Fri Mar  1 08:54:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning for Inference at Anytime and Anywhere</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zicheng Liu<sup id="id4.4.id1" class="ltx_sup">∗</sup>  
<br class="ltx_break">School of Information Science 
<br class="ltx_break">&amp; Electronic Engineering 
<br class="ltx_break">Zhejiang University
<br class="ltx_break">Hangzhou, China 
<br class="ltx_break"><span id="id5.5.id2" class="ltx_text ltx_font_typewriter">liuzicheng@westlake.edu.cn</span> 
<br class="ltx_break">&amp;Da Li  
<br class="ltx_break">Machine Learning &amp; Data Intelligence 
<br class="ltx_break">Samsung AI Center 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break"><span id="id6.6.id3" class="ltx_text ltx_font_typewriter">dali.academic@gmail.com</span>
&amp;Javier Fernandez-Marques 
<br class="ltx_break">Automated AI 
<br class="ltx_break">Samsung AI Center 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break"><span id="id7.7.id4" class="ltx_text ltx_font_typewriter">j1.fernandez@samsung.com</span>
&amp;Stefanos Laskaridis 
<br class="ltx_break">Distributed AI             
<br class="ltx_break">Samsung AI Center 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break"><span id="id8.8.id5" class="ltx_text ltx_font_typewriter">mail@stefanos.cc</span>
&amp;Yan Gao 
<br class="ltx_break">Department of Computer Science and Technology 
<br class="ltx_break">The University of Cambridge 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break"><span id="id9.9.id6" class="ltx_text ltx_font_typewriter">y.gaogy@gmail.com</span>
&amp;Łukasz Dudziak 
<br class="ltx_break">Automated AI              
<br class="ltx_break">Samsung AI Center 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break"><span id="id10.10.id7" class="ltx_text ltx_font_typewriter">l.dudziak@samsung.com</span>
&amp;Stan Z. Li  
<br class="ltx_break">School of Engineering
<br class="ltx_break">Westlake University
<br class="ltx_break">Hangzhou, China 
<br class="ltx_break"><span id="id11.11.id8" class="ltx_text ltx_font_typewriter">Stan.ZQ.Li@westlake.edu.cn</span>
&amp;Shell Xu Hu<sup id="id12.12.id9" class="ltx_sup">†</sup> 
<br class="ltx_break">Machine Learning &amp; Data Intelligence   
<br class="ltx_break">Samsung AI Center 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break"><span id="id13.13.id10" class="ltx_text ltx_font_typewriter">shell.hu@samsung.com</span>
&amp;Timothy Hospedales<sup id="id14.14.id11" class="ltx_sup">†</sup> 
<br class="ltx_break">Machine Learning &amp; Data Intelligence 
<br class="ltx_break">Samsung AI Center 
<br class="ltx_break">Cambridge, UK 
<br class="ltx_break">&amp;
School of Informatics 
<br class="ltx_break">The University of Edinburgh 
<br class="ltx_break">Edinburgh, UK 
<br class="ltx_break"><span id="id15.15.id12" class="ltx_text ltx_font_typewriter">t.hospedales@samsung.com</span>
</span><span class="ltx_author_notes">indicates equal contribution.indicates joint corresponding authors.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id16.id1" class="ltx_p">Federated learning has been predominantly concerned with collaborative training of deep networks from scratch, and especially the many challenges that arise, such as communication cost, robustness to heterogeneous data, and support for diverse device capabilities. However, there is no unified framework that addresses all these problems together.
This paper studies the challenges and opportunities of exploiting pre-trained Transformer models in FL. In particular, we propose to efficiently adapt such pre-trained models by injecting a novel attention-based adapter module at each transformer block that both modulates the forward pass and makes an early prediction. Training only the lightweight adapter by FL leads to fast and communication-efficient learning even in the presence of heterogeneous data and devices. Extensive experiments on standard FL benchmarks, including CIFAR-100, FEMNIST and SpeechCommandsv2 demonstrate that this simple framework provides fast and accurate FL while supporting heterogenous device capabilities, efficient personalization, and scalable-cost anytime inference.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) was proposed by <cite class="ltx_cite ltx_citemacro_cite">McMahan et al., (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> as a new paradigm for distributed learning in which user data privacy is protected. Following the introduction of the FL setting, subsequent work focused on addressing the emerging challenges that arise due to FL constraints,
such as communication cost <cite class="ltx_cite ltx_citemacro_cite">Mishchenko et al., (<a href="#bib.bib25" title="" class="ltx_ref">2022</a>)</cite>, data heterogeneity <cite class="ltx_cite ltx_citemacro_cite">Li et al., (<a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite> and supporting diverse device hardware <cite class="ltx_cite ltx_citemacro_cite">Horvath et al., (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>); Rapp et al., (<a href="#bib.bib28" title="" class="ltx_ref">2022</a>)</cite>. For example, to reduce the communication cost, ideas borrowed from model compression, such as quantization <cite class="ltx_cite ltx_citemacro_cite">Alistarh et al., (<a href="#bib.bib1" title="" class="ltx_ref">2017</a>); Fu et al., (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>, sparsification <cite class="ltx_cite ltx_citemacro_cite">Stich et al., (<a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> and pruning <cite class="ltx_cite ltx_citemacro_cite">Yu et al., (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>); Jiang et al., (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> have been successfully applied; to mitigate the non-IID issue of data heterogeneity, different model training recipes for optimization <cite class="ltx_cite ltx_citemacro_cite">Li et al., (<a href="#bib.bib21" title="" class="ltx_ref">2020</a>); <a href="#bib.bib36" title="" class="ltx_ref">Wang et al., 2020b </a></cite>, model initialization <cite class="ltx_cite ltx_citemacro_cite">Nguyen et al., (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite> and architecture design <cite class="ltx_cite ltx_citemacro_cite">Qu et al., (<a href="#bib.bib27" title="" class="ltx_ref">2022</a>)</cite> have also been proposed.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">A new question has now emerged for FL community: Can we benefit from the recent success of large-scale centralized pre-training of foundation models <cite class="ltx_cite ltx_citemacro_cite">Bommasani et al., (<a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>?
Although contemporary federated learning has predominantly been concerned with collaborative training of deep models from scratch <cite class="ltx_cite ltx_citemacro_cite">McMahan et al., (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>); Li et al., (<a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite>, neglecting publicly available pre-trained models, it has been observed by  <cite class="ltx_cite ltx_citemacro_cite">Qu et al., (<a href="#bib.bib27" title="" class="ltx_ref">2022</a>)</cite> that fine-tuning pretrained vision transformers (ViT) significantly improves FL performance for various image recognition tasks and enables great robustness to the data heterogeneity among clients.
Despite being an important step forward, fine-tuning the whole pre-trained ViT can be problematic due to the heavy communication cost of exchanging large numbers of model parameters and the weak capabilities of on-device training for many client devices. In this paper, we address this problem by reframing FL as a parameter-efficient (PE) downstream learning task. This is in line with the recent PE-based adaptation developments in centralized vision and natural language processing methods.
This line of parameter-efficient adaptation research includes adapters <cite class="ltx_cite ltx_citemacro_cite">Rebuffi et al., (<a href="#bib.bib29" title="" class="ltx_ref">2017</a>); Houlsby et al., (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>); Tomanek et al., (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>, prompt tuning <cite class="ltx_cite ltx_citemacro_cite">Li and Liang, (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>); Lester et al., (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>, bias-only fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Zaken et al., (<a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> and so on.
We contribute a new adaptor suited for FL under the foundation model regime, which is designed for the requirements of adaptation to fit client devices at <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">anytime</em> (under different compute and memory budgets) and <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">anywhere</em> (under severe data heterogeneity).</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Given a pre-trained Transformer model, e.g. ViT <cite class="ltx_cite ltx_citemacro_cite">Dosovitskiy et al., (<a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>, DeiT <cite class="ltx_cite ltx_citemacro_cite">Touvron et al., (<a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> and AST <cite class="ltx_cite ltx_citemacro_cite">Gong et al., (<a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>, we re-wire its feature extraction pathway to tackle the anytime and anywhere challenges. Specifically, we keep track of the <span id="S1.p3.1.1" class="ltx_text ltx_font_typewriter">CLS</span> tokens after each self-attention transformation and make use of the history of previous <span id="S1.p3.1.2" class="ltx_text ltx_font_typewriter">CLS</span> tokens to revise the current <span id="S1.p3.1.3" class="ltx_text ltx_font_typewriter">CLS</span> token by a lightweight Transformer, which is termed <em id="S1.p3.1.4" class="ltx_emph ltx_font_italic">Accumulator</em>.
Our Accumulator has an order of magnitude fewer parameters than a pre-trained Transformer model and is the only module trainable during the local forward and backward propagations; therefore, the training and communication efficiencies can be both significantly improved. To show this, we make a comparison between Accumulator and a standard early-exit <cite class="ltx_cite ltx_citemacro_citep">(Laskaridis et al.,, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite> model (<em id="S1.p3.1.5" class="ltx_emph ltx_font_italic">Layer-wise MLP</em>, by inserting for each self-attention block a MLP classification head) and the full-model fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Qu et al.,, <a href="#bib.bib27" title="" class="ltx_ref">2022</a>; Nguyen et al.,, <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite>. The comparisons for non-IID, and IID cases are presented in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, which clearly show that our method is more efficient in reaching a certain target performance in both cases. In addition, due to the efficient optimization enabled by our Accumulator, user personalization for a particular client can be conducted efficiently with even better performance than fine-tuning the whole model.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.04084/assets/figs/teaser_alpha01.png" id="S1.F1.sf1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="548" height="443" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Non-IID case: <math id="S1.F1.sf1.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S1.F1.sf1.2.m1.1b"><mrow id="S1.F1.sf1.2.m1.1.1" xref="S1.F1.sf1.2.m1.1.1.cmml"><mi id="S1.F1.sf1.2.m1.1.1.2" xref="S1.F1.sf1.2.m1.1.1.2.cmml">α</mi><mo id="S1.F1.sf1.2.m1.1.1.1" xref="S1.F1.sf1.2.m1.1.1.1.cmml">=</mo><mn id="S1.F1.sf1.2.m1.1.1.3" xref="S1.F1.sf1.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.sf1.2.m1.1c"><apply id="S1.F1.sf1.2.m1.1.1.cmml" xref="S1.F1.sf1.2.m1.1.1"><eq id="S1.F1.sf1.2.m1.1.1.1.cmml" xref="S1.F1.sf1.2.m1.1.1.1"></eq><ci id="S1.F1.sf1.2.m1.1.1.2.cmml" xref="S1.F1.sf1.2.m1.1.1.2">𝛼</ci><cn type="float" id="S1.F1.sf1.2.m1.1.1.3.cmml" xref="S1.F1.sf1.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.sf1.2.m1.1d">\alpha=0.1</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2212.04084/assets/figs/teaser_alpha1000.png" id="S1.F1.sf2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="548" height="444" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Near-IID case: <math id="S1.F1.sf2.2.m1.1" class="ltx_Math" alttext="\alpha=1000" display="inline"><semantics id="S1.F1.sf2.2.m1.1b"><mrow id="S1.F1.sf2.2.m1.1.1" xref="S1.F1.sf2.2.m1.1.1.cmml"><mi id="S1.F1.sf2.2.m1.1.1.2" xref="S1.F1.sf2.2.m1.1.1.2.cmml">α</mi><mo id="S1.F1.sf2.2.m1.1.1.1" xref="S1.F1.sf2.2.m1.1.1.1.cmml">=</mo><mn id="S1.F1.sf2.2.m1.1.1.3" xref="S1.F1.sf2.2.m1.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.sf2.2.m1.1c"><apply id="S1.F1.sf2.2.m1.1.1.cmml" xref="S1.F1.sf2.2.m1.1.1"><eq id="S1.F1.sf2.2.m1.1.1.1.cmml" xref="S1.F1.sf2.2.m1.1.1.1"></eq><ci id="S1.F1.sf2.2.m1.1.1.2.cmml" xref="S1.F1.sf2.2.m1.1.1.2">𝛼</ci><cn type="integer" id="S1.F1.sf2.2.m1.1.1.3.cmml" xref="S1.F1.sf2.2.m1.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.sf2.2.m1.1d">\alpha=1000</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The effectiveness of Accumulator-based federated FM adaptation under anytime and anywhere setting in terms of communication cost and classification performance. The experiments are conducted on CIFAR-100. Full details can be found in Section <a href="#S5" title="5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Each point corresponds to an evaluation during FL, where the cumulative communication cost measures the communication of gradients w.r.t. model parameters between clients and the server. We would like to emphasize that our Accumulator a) converges faster (less communication cost) than the baselines regardless of the data heterogenity condition and b) performs as well as the upper bound – full-model fine-tuning.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">The contributions of our work are the follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We take a different perspective to the existing FL literature and propose a parameter-efficient learning method to adapt the pre-trained Transformer FMs in FL scenarios.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a novel parameter-efficient adapter, which modulates all layers of a pre-trained Transformer FM and allows flexible early predictions (anytime inference).</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i3.p1.1" class="ltx_p">Extensive experiments on standard FL benchmarks, including CIFAR-100, FEMNIST and SpeechCommandsv2, show our method can improve global accuracy, personalization and communication efficiency with excellent robustness to data and compute heterogeneities.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Though federated learning is still an emerging topic, there are already many works published in the literature. There exist two general FL settings, <em id="S2.SS1.p1.1.1" class="ltx_emph ltx_font_italic">cross-device</em> <cite class="ltx_cite ltx_citemacro_cite">McMahan et al., (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> and <em id="S2.SS1.p1.1.2" class="ltx_emph ltx_font_italic">cross-silo</em> <cite class="ltx_cite ltx_citemacro_cite">Heikkilä et al., (<a href="#bib.bib10" title="" class="ltx_ref">2020</a>)</cite> FL.
In this paper, we focus on the former. The main research focuses in this setting are designing systems to solve communication efficiency, data and system heterogeneity
problems. Researchers have proposed different techniques to improve communication efficiency. E.g. <cite class="ltx_cite ltx_citemacro_cite">Alistarh et al., (<a href="#bib.bib1" title="" class="ltx_ref">2017</a>); Fu et al., (<a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> proposed to use the quantized model parameters or gradients during the FL communication. Similarly, <cite class="ltx_cite ltx_citemacro_cite">Stich et al., (<a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> sparsified, and <cite class="ltx_cite ltx_citemacro_cite">Yu et al., (<a href="#bib.bib38" title="" class="ltx_ref">2021</a>); Jiang et al., (<a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> pruned the training model into smaller cardinality to reduce communication cost.
And some researchers tried to address this by progressive model training <cite class="ltx_cite ltx_citemacro_cite">Wang et al., (<a href="#bib.bib35" title="" class="ltx_ref">2022</a>)</cite>. Another main focus is on data heterogeneity. In contrast to centralized training where the learner has access to the whole distribution, each worker having access to a biased distribution in non-i.i.d. FL negatively affects convergence and final model accuracy. In attempts to alleviate this, people proposed to add proximal regularization in the local training termed FedProx <cite class="ltx_cite ltx_citemacro_cite">Li et al., (<a href="#bib.bib21" title="" class="ltx_ref">2020</a>)</cite>. Alternatively, some normalized averaging technique to mitigate the inconsistency between different clients is proposed in <cite class="ltx_cite ltx_citemacro_cite"><a href="#bib.bib36" title="" class="ltx_ref">Wang et al., 2020b </a></cite>. Interestingly, more recently, researchers found that model initialization (pre-trained v.s. random) plays an important role in reducing the detrimental impact of heterogenienty <cite class="ltx_cite ltx_citemacro_cite">Nguyen et al., (<a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite>, and so does model architecture (Transfomer v.s. CNN) <cite class="ltx_cite ltx_citemacro_cite">Qu et al., (<a href="#bib.bib27" title="" class="ltx_ref">2022</a>)</cite>. System heterogeneity is also a concern in cross-device FL, where different participants may have different hardware resources and thus be unable to perform the same amount of learning. Some researchers used nested-dropout <cite class="ltx_cite ltx_citemacro_cite">Rippel et al., (<a href="#bib.bib30" title="" class="ltx_ref">2014</a>)</cite> as a nicely fit method to address the varied of computational constraints between different clients <cite class="ltx_cite ltx_citemacro_cite">Horvath et al., (<a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>, as a different dimension from considering early-exit networks <cite class="ltx_cite ltx_citemacro_cite">Laskaridis et al., (<a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">Our work differs from the existing literature. Rather than training from scratch, we focus on the challenges and opportunities of adapting a pre-trained Transfomer FM by FL. While this might seem to exacerbate communication bottlenecks and system heterogeneity issues above, we show that with our novel adapter module we can simultaneously ameliorate all the above challenges of communication cost, heterogeneous device capabilities, and difficulty of federated learning on non-i.i.d. data. Our work goes substantially beyond <cite class="ltx_cite ltx_citemacro_cite">Qu et al., (<a href="#bib.bib27" title="" class="ltx_ref">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al.,, <a href="#bib.bib26" title="" class="ltx_ref">2022</a>)</cite>, who just focus on conventional federated fine-tuning (which we treat as a baseline), to support communication efficient federated fine-tuning with support for heterogeneous device capabilities – thanks to our novel adaptation module.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Parameter-Efficient Learning</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">The idea of parameter-efficient learning of adapters was first proposed in <cite class="ltx_cite ltx_citemacro_cite">Rebuffi et al., (<a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite> for adapting a single model into multiple datasets. It has since been extended into various problems, including few-shot learning <cite class="ltx_cite ltx_citemacro_cite">Li et al., (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite> and ASR <cite class="ltx_cite ltx_citemacro_cite">Tomanek et al., (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>)</cite>. Especially
as the pre-trained large-scale FMs’ model sizes are soaring significantly, parameter-efficient (transfer) learning has become important in NLP. Instead of fine-tuning the full pre-trained model, people lean toward designing different small set modules for adapting the pre-trained FMs into downstream tasks <cite class="ltx_cite ltx_citemacro_cite">Li and Liang, (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>); Lester et al., (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>); Houlsby et al., (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite>. <cite class="ltx_cite ltx_citemacro_cite">Li and Liang, (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> found that tuning the prompt input of the pre-trained language model enables excellent performance on downstream tasks. While <cite class="ltx_cite ltx_citemacro_cite">Houlsby et al., (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>)</cite> found that fine-tuning some injected adapters can be more effective than fine-tuning the top layers of a pre-trained NLP model. In this work, we make the first attempt at parameter-efficient adaptation in an FL context, developing a novel transformer-based adaptation module specifically customized for this task.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated Learning</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.7" class="ltx_p">Let us consider a typical setting of FL with <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> devices,
where a local device <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">i</annotation></semantics></math> has <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑁</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">N_{i}</annotation></semantics></math> private training examples denoted by <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\{(\mathbf{x}_{j},y_{j})\}_{j=1}^{N_{i}}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msubsup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mrow id="S3.SS1.p1.4.m4.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.4" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.5" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.4.m4.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.1.3.2.cmml">j</mi><mo id="S3.SS1.p1.4.m4.1.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.4.m4.1.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">N</mi><mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><set id="S3.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1"><interval closure="open" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2"><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="S3.SS1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3"><eq id="S3.SS1.p1.4.m4.1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.1"></eq><ci id="S3.SS1.p1.4.m4.1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p1.4.m4.1.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">𝑁</ci><ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\{(\mathbf{x}_{j},y_{j})\}_{j=1}^{N_{i}}</annotation></semantics></math> with <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{x}_{j}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐱</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathbf{x}_{j}</annotation></semantics></math> the input image and <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="y_{j}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑦</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">y_{j}</annotation></semantics></math> the target label. The learning objective following <cite class="ltx_cite ltx_citemacro_cite">McMahan et al., (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> aims at finding a model parameter <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">w</annotation></semantics></math> that minimizes the weighted average loss over all local devices:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="w=\underset{w}{\arg\min}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(w),\quad\mathcal{L}_{i}(w)=\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(F_{w}(\mathbf{x}_{j}),y_{j})," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1"><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">w</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><munder accentunder="true" id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.3.3.1.1.1.1.3.2.2a" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml">⁡</mo><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.cmml">min</mi></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml">𝑤</mo></munder><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.cmml"><munderover id="S3.E1.m1.3.3.1.1.1.1.3.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.1" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.3.3.1.1.1.1.3.3.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.3.cmml">K</mi></munderover><mrow id="S3.E1.m1.3.3.1.1.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.2.cmml">α</mi><mi id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.1.cmml">​</mo><msub id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.1a" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.3.3.2.4.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.4.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.4.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.3.3.1.1.2.3" xref="S3.E1.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.4.cmml"><msub id="S3.E1.m1.3.3.1.1.2.2.4.2" xref="S3.E1.m1.3.3.1.1.2.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.2.2.4.2.2" xref="S3.E1.m1.3.3.1.1.2.2.4.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.3.3.1.1.2.2.4.2.3" xref="S3.E1.m1.3.3.1.1.2.2.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.4.1" xref="S3.E1.m1.3.3.1.1.2.2.4.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.4.3.2" xref="S3.E1.m1.3.3.1.1.2.2.4.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.4.3.2.1" xref="S3.E1.m1.3.3.1.1.2.2.4.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.4.3.2.2" xref="S3.E1.m1.3.3.1.1.2.2.4.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><mfrac id="S3.E1.m1.3.3.1.1.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.4.cmml"><mn id="S3.E1.m1.3.3.1.1.2.2.2.4.2" xref="S3.E1.m1.3.3.1.1.2.2.2.4.2.cmml">1</mn><msub id="S3.E1.m1.3.3.1.1.2.2.2.4.3" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.4.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.2.cmml">N</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.4.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml"><munderover id="S3.E1.m1.3.3.1.1.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.1" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.2.cmml">N</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.2.cmml">F</mi><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.5" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3a.cmml" xref="S3.E1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"></eq><ci id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">𝑤</ci><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><times id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.1"></times><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2"><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.1">𝑤</ci><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2"><arg id="S3.E1.m1.3.3.1.1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.1"></arg><min id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2"></min></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3"><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3"><eq id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.1.3">𝐾</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2"><times id="S3.E1.m1.3.3.1.1.1.1.3.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.1"></times><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.2">𝛼</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3.2.3.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑤</ci></apply></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><eq id="S3.E1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"></eq><apply id="S3.E1.m1.3.3.1.1.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4"><times id="S3.E1.m1.3.3.1.1.2.2.4.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4.1"></times><apply id="S3.E1.m1.3.3.1.1.2.2.4.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.4.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.4.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4.2.2">ℒ</ci><ci id="S3.E1.m1.3.3.1.1.2.2.4.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑤</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.3"></times><apply id="S3.E1.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4"><divide id="S3.E1.m1.3.3.1.1.2.2.2.4.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4"></divide><cn type="integer" id="S3.E1.m1.3.3.1.1.2.2.2.4.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.2">1</cn><apply id="S3.E1.m1.3.3.1.1.2.2.2.4.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.4.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.2">𝑁</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.4.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2"><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3"><eq id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.2">𝑁</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2"><times id="S3.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.3"></times><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.4">ℓ</ci><interval closure="open" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2"><apply id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.3">𝑤</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">w=\underset{w}{\arg\min}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(w),\quad\mathcal{L}_{i}(w)=\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(F_{w}(\mathbf{x}_{j}),y_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.12" class="ltx_p">where <math id="S3.SS1.p1.8.m1.1" class="ltx_Math" alttext="\alpha_{i}=N_{i}/\sum_{i=1}^{K}N_{i}" display="inline"><semantics id="S3.SS1.p1.8.m1.1a"><mrow id="S3.SS1.p1.8.m1.1.1" xref="S3.SS1.p1.8.m1.1.1.cmml"><msub id="S3.SS1.p1.8.m1.1.1.2" xref="S3.SS1.p1.8.m1.1.1.2.cmml"><mi id="S3.SS1.p1.8.m1.1.1.2.2" xref="S3.SS1.p1.8.m1.1.1.2.2.cmml">α</mi><mi id="S3.SS1.p1.8.m1.1.1.2.3" xref="S3.SS1.p1.8.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.8.m1.1.1.1" xref="S3.SS1.p1.8.m1.1.1.1.cmml">=</mo><mrow id="S3.SS1.p1.8.m1.1.1.3" xref="S3.SS1.p1.8.m1.1.1.3.cmml"><msub id="S3.SS1.p1.8.m1.1.1.3.2" xref="S3.SS1.p1.8.m1.1.1.3.2.cmml"><mi id="S3.SS1.p1.8.m1.1.1.3.2.2" xref="S3.SS1.p1.8.m1.1.1.3.2.2.cmml">N</mi><mi id="S3.SS1.p1.8.m1.1.1.3.2.3" xref="S3.SS1.p1.8.m1.1.1.3.2.3.cmml">i</mi></msub><mo rspace="0.055em" id="S3.SS1.p1.8.m1.1.1.3.1" xref="S3.SS1.p1.8.m1.1.1.3.1.cmml">/</mo><mrow id="S3.SS1.p1.8.m1.1.1.3.3" xref="S3.SS1.p1.8.m1.1.1.3.3.cmml"><msubsup id="S3.SS1.p1.8.m1.1.1.3.3.1" xref="S3.SS1.p1.8.m1.1.1.3.3.1.cmml"><mo id="S3.SS1.p1.8.m1.1.1.3.3.1.2.2" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.cmml"><mi id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.2" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.1" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.3" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.8.m1.1.1.3.3.1.3" xref="S3.SS1.p1.8.m1.1.1.3.3.1.3.cmml">K</mi></msubsup><msub id="S3.SS1.p1.8.m1.1.1.3.3.2" xref="S3.SS1.p1.8.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.p1.8.m1.1.1.3.3.2.2" xref="S3.SS1.p1.8.m1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p1.8.m1.1.1.3.3.2.3" xref="S3.SS1.p1.8.m1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m1.1b"><apply id="S3.SS1.p1.8.m1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1"><eq id="S3.SS1.p1.8.m1.1.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1.1"></eq><apply id="S3.SS1.p1.8.m1.1.1.2.cmml" xref="S3.SS1.p1.8.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m1.1.1.2.1.cmml" xref="S3.SS1.p1.8.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.8.m1.1.1.2.2.cmml" xref="S3.SS1.p1.8.m1.1.1.2.2">𝛼</ci><ci id="S3.SS1.p1.8.m1.1.1.2.3.cmml" xref="S3.SS1.p1.8.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.8.m1.1.1.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3"><divide id="S3.SS1.p1.8.m1.1.1.3.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.1"></divide><apply id="S3.SS1.p1.8.m1.1.1.3.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m1.1.1.3.2.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.8.m1.1.1.3.2.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.2.2">𝑁</ci><ci id="S3.SS1.p1.8.m1.1.1.3.2.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.8.m1.1.1.3.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3"><apply id="S3.SS1.p1.8.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m1.1.1.3.3.1.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1">superscript</csymbol><apply id="S3.SS1.p1.8.m1.1.1.3.3.1.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m1.1.1.3.3.1.2.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.SS1.p1.8.m1.1.1.3.3.1.2.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.2"></sum><apply id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3"><eq id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.1"></eq><ci id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.8.m1.1.1.3.3.1.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p1.8.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.8.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p1.8.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.8.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m1.1c">\alpha_{i}=N_{i}/\sum_{i=1}^{K}N_{i}</annotation></semantics></math>, <math id="S3.SS1.p1.9.m2.2" class="ltx_Math" alttext="\ell(F_{w}(\mathbf{x}_{j}),y_{j})" display="inline"><semantics id="S3.SS1.p1.9.m2.2a"><mrow id="S3.SS1.p1.9.m2.2.2" xref="S3.SS1.p1.9.m2.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.9.m2.2.2.4" xref="S3.SS1.p1.9.m2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m2.2.2.3" xref="S3.SS1.p1.9.m2.2.2.3.cmml">​</mo><mrow id="S3.SS1.p1.9.m2.2.2.2.2" xref="S3.SS1.p1.9.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m2.2.2.2.2.3" xref="S3.SS1.p1.9.m2.2.2.2.3.cmml">(</mo><mrow id="S3.SS1.p1.9.m2.1.1.1.1.1" xref="S3.SS1.p1.9.m2.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.9.m2.1.1.1.1.1.3" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.9.m2.1.1.1.1.1.3.2" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3.2.cmml">F</mi><mi id="S3.SS1.p1.9.m2.1.1.1.1.1.3.3" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m2.1.1.1.1.1.2" xref="S3.SS1.p1.9.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.9.m2.2.2.2.2.4" xref="S3.SS1.p1.9.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.9.m2.2.2.2.2.2" xref="S3.SS1.p1.9.m2.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.9.m2.2.2.2.2.2.2" xref="S3.SS1.p1.9.m2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.9.m2.2.2.2.2.2.3" xref="S3.SS1.p1.9.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS1.p1.9.m2.2.2.2.2.5" xref="S3.SS1.p1.9.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m2.2b"><apply id="S3.SS1.p1.9.m2.2.2.cmml" xref="S3.SS1.p1.9.m2.2.2"><times id="S3.SS1.p1.9.m2.2.2.3.cmml" xref="S3.SS1.p1.9.m2.2.2.3"></times><ci id="S3.SS1.p1.9.m2.2.2.4.cmml" xref="S3.SS1.p1.9.m2.2.2.4">ℓ</ci><interval closure="open" id="S3.SS1.p1.9.m2.2.2.2.3.cmml" xref="S3.SS1.p1.9.m2.2.2.2.2"><apply id="S3.SS1.p1.9.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1"><times id="S3.SS1.p1.9.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.2"></times><apply id="S3.SS1.p1.9.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.9.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3.2">𝐹</ci><ci id="S3.SS1.p1.9.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.3.3">𝑤</ci></apply><apply id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m2.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.SS1.p1.9.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.9.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.9.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.9.m2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.9.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.9.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m2.2c">\ell(F_{w}(\mathbf{x}_{j}),y_{j})</annotation></semantics></math> is the task-specific loss function and <math id="S3.SS1.p1.10.m3.1" class="ltx_Math" alttext="F_{w}()" display="inline"><semantics id="S3.SS1.p1.10.m3.1a"><mrow id="S3.SS1.p1.10.m3.1.1" xref="S3.SS1.p1.10.m3.1.1.cmml"><msub id="S3.SS1.p1.10.m3.1.1.2" xref="S3.SS1.p1.10.m3.1.1.2.cmml"><mi id="S3.SS1.p1.10.m3.1.1.2.2" xref="S3.SS1.p1.10.m3.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p1.10.m3.1.1.2.3" xref="S3.SS1.p1.10.m3.1.1.2.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m3.1.1.1" xref="S3.SS1.p1.10.m3.1.1.1.cmml">​</mo><mrow id="S3.SS1.p1.10.m3.1.1.3.2" xref="S3.SS1.p1.10.m3.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m3.1.1.3.2.1" xref="S3.SS1.p1.10.m3.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S3.SS1.p1.10.m3.1.1.3.2.2" xref="S3.SS1.p1.10.m3.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m3.1b"><apply id="S3.SS1.p1.10.m3.1.1.cmml" xref="S3.SS1.p1.10.m3.1.1"><times id="S3.SS1.p1.10.m3.1.1.1.cmml" xref="S3.SS1.p1.10.m3.1.1.1"></times><apply id="S3.SS1.p1.10.m3.1.1.2.cmml" xref="S3.SS1.p1.10.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m3.1.1.2.1.cmml" xref="S3.SS1.p1.10.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.10.m3.1.1.2.2.cmml" xref="S3.SS1.p1.10.m3.1.1.2.2">𝐹</ci><ci id="S3.SS1.p1.10.m3.1.1.2.3.cmml" xref="S3.SS1.p1.10.m3.1.1.2.3">𝑤</ci></apply><list id="S3.SS1.p1.10.m3.1.1.3.1.cmml" xref="S3.SS1.p1.10.m3.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m3.1c">F_{w}()</annotation></semantics></math> is the formed model. The main difference that renders the problem difficult is we can only compute <math id="S3.SS1.p1.11.m4.1" class="ltx_Math" alttext="\mathcal{L}_{i}(w)" display="inline"><semantics id="S3.SS1.p1.11.m4.1a"><mrow id="S3.SS1.p1.11.m4.1.2" xref="S3.SS1.p1.11.m4.1.2.cmml"><msub id="S3.SS1.p1.11.m4.1.2.2" xref="S3.SS1.p1.11.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.11.m4.1.2.2.2" xref="S3.SS1.p1.11.m4.1.2.2.2.cmml">ℒ</mi><mi id="S3.SS1.p1.11.m4.1.2.2.3" xref="S3.SS1.p1.11.m4.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m4.1.2.1" xref="S3.SS1.p1.11.m4.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.11.m4.1.2.3.2" xref="S3.SS1.p1.11.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m4.1.2.3.2.1" xref="S3.SS1.p1.11.m4.1.2.cmml">(</mo><mi id="S3.SS1.p1.11.m4.1.1" xref="S3.SS1.p1.11.m4.1.1.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.11.m4.1.2.3.2.2" xref="S3.SS1.p1.11.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m4.1b"><apply id="S3.SS1.p1.11.m4.1.2.cmml" xref="S3.SS1.p1.11.m4.1.2"><times id="S3.SS1.p1.11.m4.1.2.1.cmml" xref="S3.SS1.p1.11.m4.1.2.1"></times><apply id="S3.SS1.p1.11.m4.1.2.2.cmml" xref="S3.SS1.p1.11.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m4.1.2.2.1.cmml" xref="S3.SS1.p1.11.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m4.1.2.2.2.cmml" xref="S3.SS1.p1.11.m4.1.2.2.2">ℒ</ci><ci id="S3.SS1.p1.11.m4.1.2.2.3.cmml" xref="S3.SS1.p1.11.m4.1.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.11.m4.1.1.cmml" xref="S3.SS1.p1.11.m4.1.1">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m4.1c">\mathcal{L}_{i}(w)</annotation></semantics></math> on device <math id="S3.SS1.p1.12.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.12.m5.1a"><mi id="S3.SS1.p1.12.m5.1.1" xref="S3.SS1.p1.12.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m5.1b"><ci id="S3.SS1.p1.12.m5.1.1.cmml" xref="S3.SS1.p1.12.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m5.1c">i</annotation></semantics></math> to protect the privacy for the user. The common setup (see more details in <cite class="ltx_cite ltx_citemacro_cite">Beutel et al., (<a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>) introduces a server to receive gradients sent from each client device, and therefore brings two major challenges: communication cost and data heterogeneity.</p>
</div>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Personalization.</h4>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.SSS0.Px1.p1.4" class="ltx_p"><span id="S3.SS1.SSS0.Px1.p1.4.4" class="ltx_text" style="color:#000000;">Minimizing Eq. <a href="#S3.E1" title="In 3.1 Federated Learning ‣ 3 Preliminaries ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> explicitly optimizes the generalization of the shared global model <math id="S3.SS1.SSS0.Px1.p1.1.1.m1.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.1.1.m1.1a"><msup id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.2.cmml">w</mi><mo mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.2">𝑤</ci><times id="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.1.m1.1c">w^{*}</annotation></semantics></math> across all clients. However, the model performance on individual clients might still be sub-optimal, especially under client data heterogeneity.
Clients often care more about personalized performance (i.e., overfitting to client data). Therefore, given the outcome of global federated model learning in Eq. <a href="#S3.E1" title="In 3.1 Federated Learning ‣ 3 Preliminaries ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> denoted by <math id="S3.SS1.SSS0.Px1.p1.2.2.m2.1" class="ltx_Math" alttext="w^{*}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.2.2.m2.1a"><msup id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.2.cmml">w</mi><mo mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.2">𝑤</ci><times id="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.2.m2.1c">w^{*}</annotation></semantics></math>, each client <math id="S3.SS1.SSS0.Px1.p1.3.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.3.3.m3.1a"><mi mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.3.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.3.m3.1b"><ci id="S3.SS1.SSS0.Px1.p1.3.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.3.m3.1c">i</annotation></semantics></math> can then further fine-tune the parameters locally to obtain personalized parameter <math id="S3.SS1.SSS0.Px1.p1.4.4.m4.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.4.4.m4.1a"><msub id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.cmml"><mi mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.2" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.2.cmml">w</mi><mi mathcolor="#000000" id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.2">𝑤</ci><ci id="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.4.m4.1c">w_{i}</annotation></semantics></math></span></p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="w_{i}=\underset{w^{*}}{\arg\min}\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(F_{w^{*}}(\mathbf{x}_{j}),y_{j})," display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.4.2.cmml">w</mi><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo mathcolor="#000000" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><munder accentunder="true" id="S3.E2.m1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.2.4.cmml"><mrow id="S3.E2.m1.1.1.1.1.2.4.2" xref="S3.E2.m1.1.1.1.1.2.4.2.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.4.2.1" xref="S3.E2.m1.1.1.1.1.2.4.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E2.m1.1.1.1.1.2.4.2a" xref="S3.E2.m1.1.1.1.1.2.4.2.cmml">⁡</mo><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.4.2.2" xref="S3.E2.m1.1.1.1.1.2.4.2.2.cmml">min</mi></mrow><msup id="S3.E2.m1.1.1.1.1.2.4.1" xref="S3.E2.m1.1.1.1.1.2.4.1.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.4.1.2" xref="S3.E2.m1.1.1.1.1.2.4.1.2.cmml">w</mi><mo mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.4.1.3" xref="S3.E2.m1.1.1.1.1.2.4.1.3.cmml">∗</mo></msup></munder><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml">​</mo><mfrac mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.5" xref="S3.E2.m1.1.1.1.1.2.5.cmml"><mn mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.5.2" xref="S3.E2.m1.1.1.1.1.2.5.2.cmml">1</mn><msub id="S3.E2.m1.1.1.1.1.2.5.3" xref="S3.E2.m1.1.1.1.1.2.5.3.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.5.3.2" xref="S3.E2.m1.1.1.1.1.2.5.3.2.cmml">N</mi><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.5.3.3" xref="S3.E2.m1.1.1.1.1.2.5.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3a" xref="S3.E2.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.2.2.cmml"><munderover id="S3.E2.m1.1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml"><mo mathcolor="#000000" movablelimits="false" id="S3.E2.m1.1.1.1.1.2.2.3.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.3.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.2" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.2.cmml">j</mi><mo mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.1" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.3" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E2.m1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.1.2.2.3.3.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.3.3.2" xref="S3.E2.m1.1.1.1.1.2.2.3.3.2.cmml">N</mi><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.3.3.3" xref="S3.E2.m1.1.1.1.1.2.2.3.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E2.m1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.cmml"><mi mathcolor="#000000" mathvariant="normal" id="S3.E2.m1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">F</mi><msup id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">w</mi><mo mathcolor="#000000" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">∗</mo></msup></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi mathcolor="#000000" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo mathcolor="#000000" stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.5" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo mathcolor="#000000" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"></eq><apply id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2">𝑤</ci><ci id="S3.E2.m1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3"></times><apply id="S3.E2.m1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.4"><apply id="S3.E2.m1.1.1.1.1.2.4.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.4.1.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.4.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.1.2">𝑤</ci><times id="S3.E2.m1.1.1.1.1.2.4.1.3.cmml" xref="S3.E2.m1.1.1.1.1.2.4.1.3"></times></apply><apply id="S3.E2.m1.1.1.1.1.2.4.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.2"><arg id="S3.E2.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.4.2.1"></arg><min id="S3.E2.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.4.2.2"></min></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.5.cmml" xref="S3.E2.m1.1.1.1.1.2.5"><divide id="S3.E2.m1.1.1.1.1.2.5.1.cmml" xref="S3.E2.m1.1.1.1.1.2.5"></divide><cn type="integer" id="S3.E2.m1.1.1.1.1.2.5.2.cmml" xref="S3.E2.m1.1.1.1.1.2.5.2">1</cn><apply id="S3.E2.m1.1.1.1.1.2.5.3.cmml" xref="S3.E2.m1.1.1.1.1.2.5.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.5.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.5.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.5.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.5.3.2">𝑁</ci><ci id="S3.E2.m1.1.1.1.1.2.5.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.5.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2"><apply id="S3.E2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E2.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3"><eq id="S3.E2.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.3.2">𝑁</ci><ci id="S3.E2.m1.1.1.1.1.2.2.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2"><times id="S3.E2.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.3"></times><ci id="S3.E2.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.4">ℓ</ci><interval closure="open" id="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐹</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑤</ci><times id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.3"></times></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">w_{i}=\underset{w^{*}}{\arg\min}\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(F_{w^{*}}(\mathbf{x}_{j}),y_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Parameter-Efficient Learning</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.5" class="ltx_p">Parameter-efficient learning is a typical strategy for adapting pre-trained FMs to downstream tasks. The full model size of an FM is often much larger than the size of downstream task data making the fine-tuning prone to overfitting. Not mentioning the back-propagation over the full FM is extremely expensive.
To this end, multiple PE learning methods <cite class="ltx_cite ltx_citemacro_cite">Houlsby et al., (<a href="#bib.bib13" title="" class="ltx_ref">2019</a>); Rebuffi et al., (<a href="#bib.bib29" title="" class="ltx_ref">2017</a>); Tomanek et al., (<a href="#bib.bib32" title="" class="ltx_ref">2021</a>); Li and Liang, (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>); Lester et al., (<a href="#bib.bib20" title="" class="ltx_ref">2021</a>); Zaken et al., (<a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> have been proposed for fast adaptation of FMs, in which the learning objective is typically formulated as</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="w_{\text{PE}}=\underset{w_{\text{PE}}}{\arg\min}~{}\frac{1}{M}\sum_{j=1}^{M}\ell(F_{w_{\text{FM}},w_{\text{PE}}}(\mathbf{x}_{j}),y_{j})," display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.4" xref="S3.E3.m1.3.3.1.1.4.cmml"><mi id="S3.E3.m1.3.3.1.1.4.2" xref="S3.E3.m1.3.3.1.1.4.2.cmml">w</mi><mtext id="S3.E3.m1.3.3.1.1.4.3" xref="S3.E3.m1.3.3.1.1.4.3a.cmml">PE</mtext></msub><mo id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><munder accentunder="true" id="S3.E3.m1.3.3.1.1.2.4" xref="S3.E3.m1.3.3.1.1.2.4.cmml"><mrow id="S3.E3.m1.3.3.1.1.2.4.2" xref="S3.E3.m1.3.3.1.1.2.4.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.4.2.1" xref="S3.E3.m1.3.3.1.1.2.4.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E3.m1.3.3.1.1.2.4.2a" xref="S3.E3.m1.3.3.1.1.2.4.2.cmml">⁡</mo><mi id="S3.E3.m1.3.3.1.1.2.4.2.2" xref="S3.E3.m1.3.3.1.1.2.4.2.2.cmml">min</mi></mrow><msub id="S3.E3.m1.3.3.1.1.2.4.1" xref="S3.E3.m1.3.3.1.1.2.4.1.cmml"><mi id="S3.E3.m1.3.3.1.1.2.4.1.2" xref="S3.E3.m1.3.3.1.1.2.4.1.2.cmml">w</mi><mtext id="S3.E3.m1.3.3.1.1.2.4.1.3" xref="S3.E3.m1.3.3.1.1.2.4.1.3a.cmml">PE</mtext></msub></munder><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.3.3.1.1.2.3" xref="S3.E3.m1.3.3.1.1.2.3.cmml">​</mo><mfrac id="S3.E3.m1.3.3.1.1.2.5" xref="S3.E3.m1.3.3.1.1.2.5.cmml"><mn id="S3.E3.m1.3.3.1.1.2.5.2" xref="S3.E3.m1.3.3.1.1.2.5.2.cmml">1</mn><mi id="S3.E3.m1.3.3.1.1.2.5.3" xref="S3.E3.m1.3.3.1.1.2.5.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.2.3a" xref="S3.E3.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.2.2" xref="S3.E3.m1.3.3.1.1.2.2.cmml"><munderover id="S3.E3.m1.3.3.1.1.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E3.m1.3.3.1.1.2.2.3.2.2" xref="S3.E3.m1.3.3.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.1.1.2.2.3.2.3" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2.3.2.3.2" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.2.cmml">j</mi><mo id="S3.E3.m1.3.3.1.1.2.2.3.2.3.1" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.3.3.1.1.2.2.3.2.3.3" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.3.3.1.1.2.2.3.3" xref="S3.E3.m1.3.3.1.1.2.2.3.3.cmml">M</mi></munderover><mrow id="S3.E3.m1.3.3.1.1.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.3.3.1.1.2.2.2.4" xref="S3.E3.m1.3.3.1.1.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.2.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">F</mi><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.3.cmml"><msub id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">w</mi><mtext id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3a.cmml">FM</mtext></msub><mo id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml">w</mi><mtext id="S3.E3.m1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.3a.cmml">PE</mtext></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.1.1.2.2.2.2.2.4" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.2" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.3" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E3.m1.3.3.1.1.2.2.2.2.2.5" xref="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"></eq><apply id="S3.E3.m1.3.3.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.1.cmml" xref="S3.E3.m1.3.3.1.1.4">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.4.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2">𝑤</ci><ci id="S3.E3.m1.3.3.1.1.4.3a.cmml" xref="S3.E3.m1.3.3.1.1.4.3"><mtext mathsize="70%" id="S3.E3.m1.3.3.1.1.4.3.cmml" xref="S3.E3.m1.3.3.1.1.4.3">PE</mtext></ci></apply><apply id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><times id="S3.E3.m1.3.3.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.3"></times><apply id="S3.E3.m1.3.3.1.1.2.4.cmml" xref="S3.E3.m1.3.3.1.1.2.4"><apply id="S3.E3.m1.3.3.1.1.2.4.1.cmml" xref="S3.E3.m1.3.3.1.1.2.4.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.4.1.1.cmml" xref="S3.E3.m1.3.3.1.1.2.4.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.4.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2.4.1.2">𝑤</ci><ci id="S3.E3.m1.3.3.1.1.2.4.1.3a.cmml" xref="S3.E3.m1.3.3.1.1.2.4.1.3"><mtext mathsize="70%" id="S3.E3.m1.3.3.1.1.2.4.1.3.cmml" xref="S3.E3.m1.3.3.1.1.2.4.1.3">PE</mtext></ci></apply><apply id="S3.E3.m1.3.3.1.1.2.4.2.cmml" xref="S3.E3.m1.3.3.1.1.2.4.2"><arg id="S3.E3.m1.3.3.1.1.2.4.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.4.2.1"></arg><min id="S3.E3.m1.3.3.1.1.2.4.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.4.2.2"></min></apply></apply><apply id="S3.E3.m1.3.3.1.1.2.5.cmml" xref="S3.E3.m1.3.3.1.1.2.5"><divide id="S3.E3.m1.3.3.1.1.2.5.1.cmml" xref="S3.E3.m1.3.3.1.1.2.5"></divide><cn type="integer" id="S3.E3.m1.3.3.1.1.2.5.2.cmml" xref="S3.E3.m1.3.3.1.1.2.5.2">1</cn><ci id="S3.E3.m1.3.3.1.1.2.5.3.cmml" xref="S3.E3.m1.3.3.1.1.2.5.3">𝑀</ci></apply><apply id="S3.E3.m1.3.3.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2"><apply id="S3.E3.m1.3.3.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3">subscript</csymbol><sum id="S3.E3.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3.2.2"></sum><apply id="S3.E3.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3"><eq id="S3.E3.m1.3.3.1.1.2.2.3.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.3.3.1.1.2.2.3.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m1.3.3.1.1.2.2.3.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.3.3">𝑀</ci></apply><apply id="S3.E3.m1.3.3.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2"><times id="S3.E3.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.3"></times><ci id="S3.E3.m1.3.3.1.1.2.2.2.4.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.4">ℓ</ci><interval closure="open" id="S3.E3.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝐹</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E3.m1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.3"><mtext mathsize="50%" id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">FM</mtext></ci></apply><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2">𝑤</ci><ci id="S3.E3.m1.2.2.2.2.2.3a.cmml" xref="S3.E3.m1.2.2.2.2.2.3"><mtext mathsize="50%" id="S3.E3.m1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.3">PE</mtext></ci></apply></list></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">w_{\text{PE}}=\underset{w_{\text{PE}}}{\arg\min}~{}\frac{1}{M}\sum_{j=1}^{M}\ell(F_{w_{\text{FM}},w_{\text{PE}}}(\mathbf{x}_{j}),y_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.4" class="ltx_p">where <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="w_{\text{FM}}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">w</mi><mtext id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3a.cmml">FM</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑤</ci><ci id="S3.SS2.p1.1.m1.1.1.3a.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">FM</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">w_{\text{FM}}</annotation></semantics></math> corresponds to the frozen pre-trained foundation model, <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="w_{\text{PE}}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">w</mi><mtext id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3a.cmml">PE</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑤</ci><ci id="S3.SS2.p1.2.m2.1.1.3a.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">PE</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">w_{\text{PE}}</annotation></semantics></math> is the weight associated to the introduced
parameter-efficient module and <math id="S3.SS2.p1.3.m3.3" class="ltx_Math" alttext="\{(\mathbf{x},y)\}^{M}" display="inline"><semantics id="S3.SS2.p1.3.m3.3a"><msup id="S3.SS2.p1.3.m3.3.3" xref="S3.SS2.p1.3.m3.3.3.cmml"><mrow id="S3.SS2.p1.3.m3.3.3.1.1" xref="S3.SS2.p1.3.m3.3.3.1.2.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS2.p1.3.m3.3.3.1.1.2" xref="S3.SS2.p1.3.m3.3.3.1.2.cmml">{</mo><mrow id="S3.SS2.p1.3.m3.3.3.1.1.1.2" xref="S3.SS2.p1.3.m3.3.3.1.1.1.1.cmml"><mo mathcolor="#000000" stretchy="false" id="S3.SS2.p1.3.m3.3.3.1.1.1.2.1" xref="S3.SS2.p1.3.m3.3.3.1.1.1.1.cmml">(</mo><mi mathcolor="#000000" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">𝐱</mi><mo mathcolor="#000000" id="S3.SS2.p1.3.m3.3.3.1.1.1.2.2" xref="S3.SS2.p1.3.m3.3.3.1.1.1.1.cmml">,</mo><mi mathcolor="#000000" id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml">y</mi><mo mathcolor="#000000" stretchy="false" id="S3.SS2.p1.3.m3.3.3.1.1.1.2.3" xref="S3.SS2.p1.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow><mo mathcolor="#000000" stretchy="false" id="S3.SS2.p1.3.m3.3.3.1.1.3" xref="S3.SS2.p1.3.m3.3.3.1.2.cmml">}</mo></mrow><mi mathcolor="#000000" id="S3.SS2.p1.3.m3.3.3.3" xref="S3.SS2.p1.3.m3.3.3.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.3b"><apply id="S3.SS2.p1.3.m3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.cmml" xref="S3.SS2.p1.3.m3.3.3">superscript</csymbol><set id="S3.SS2.p1.3.m3.3.3.1.2.cmml" xref="S3.SS2.p1.3.m3.3.3.1.1"><interval closure="open" id="S3.SS2.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.3.3.1.1.1.2"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐱</ci><ci id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2">𝑦</ci></interval></set><ci id="S3.SS2.p1.3.m3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.3c">\{(\mathbf{x},y)\}^{M}</annotation></semantics></math><span id="S3.SS2.p1.4.1" class="ltx_text" style="color:#000000;"> are the <math id="S3.SS2.p1.4.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.4.1.m1.1a"><mi mathcolor="#000000" id="S3.SS2.p1.4.1.m1.1.1" xref="S3.SS2.p1.4.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.1.m1.1b"><ci id="S3.SS2.p1.4.1.m1.1.1.cmml" xref="S3.SS2.p1.4.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.1.m1.1c">M</annotation></semantics></math> data pairs from the downstream task of interest.</span>
Our goal in this paper is to design such a lightweight module for Transformer-based FMs in the context of FL.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Adapting Transformer FMs into Federated Learning</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">The motivation of our work is to treat federated learning as a downstream task for adapting a pre-trained Transformer FM. In the following sections, we will introduce the two main modules, including a pre-trained Transformer and our attention-based adapter Accumulator, and how Accumulator modulates the outputs of a Transformer to support the early predictions. The overview of our model architecture is depicted in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1 Transformer model ‣ 4 Adapting Transformer FMs into Federated Learning ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Transformer model</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.3" class="ltx_p">A Transformer model typically consists of a sequence of residual blocks of multi-head self-attention (MSA), each followed by a residual block of feed-forward multilayer perceptron (MLP) with LayerNorm (LN) applied to both MSA and MLP blocks.
Denote by <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\mathbf{x}</annotation></semantics></math> the input, <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathbf{p}</annotation></semantics></math> the positional encoding, and <math id="S4.SS1.p1.3.m3.4" class="ltx_Math" alttext="\mathbf{z}^{l}:=[z_{\text{cls}}^{l},z_{1}^{l},\ldots,z_{N}^{l}]" display="inline"><semantics id="S4.SS1.p1.3.m3.4a"><mrow id="S4.SS1.p1.3.m3.4.4" xref="S4.SS1.p1.3.m3.4.4.cmml"><msup id="S4.SS1.p1.3.m3.4.4.5" xref="S4.SS1.p1.3.m3.4.4.5.cmml"><mi id="S4.SS1.p1.3.m3.4.4.5.2" xref="S4.SS1.p1.3.m3.4.4.5.2.cmml">𝐳</mi><mi id="S4.SS1.p1.3.m3.4.4.5.3" xref="S4.SS1.p1.3.m3.4.4.5.3.cmml">l</mi></msup><mo lspace="0.278em" rspace="0.278em" id="S4.SS1.p1.3.m3.4.4.4" xref="S4.SS1.p1.3.m3.4.4.4.cmml">:=</mo><mrow id="S4.SS1.p1.3.m3.4.4.3.3" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.4.4.3.3.4" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">[</mo><msubsup id="S4.SS1.p1.3.m3.2.2.1.1.1" xref="S4.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.2.2.1.1.1.2.2" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.2.cmml">z</mi><mtext id="S4.SS1.p1.3.m3.2.2.1.1.1.2.3" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.3a.cmml">cls</mtext><mi id="S4.SS1.p1.3.m3.2.2.1.1.1.3" xref="S4.SS1.p1.3.m3.2.2.1.1.1.3.cmml">l</mi></msubsup><mo id="S4.SS1.p1.3.m3.4.4.3.3.5" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msubsup id="S4.SS1.p1.3.m3.3.3.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.3.3.2.2.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2.2.cmml">z</mi><mn id="S4.SS1.p1.3.m3.3.3.2.2.2.2.3" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2.3.cmml">1</mn><mi id="S4.SS1.p1.3.m3.3.3.2.2.2.3" xref="S4.SS1.p1.3.m3.3.3.2.2.2.3.cmml">l</mi></msubsup><mo id="S4.SS1.p1.3.m3.4.4.3.3.6" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S4.SS1.p1.3.m3.4.4.3.3.7" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msubsup id="S4.SS1.p1.3.m3.4.4.3.3.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.3.m3.4.4.3.3.3.2.2" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2.2.cmml">z</mi><mi id="S4.SS1.p1.3.m3.4.4.3.3.3.2.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2.3.cmml">N</mi><mi id="S4.SS1.p1.3.m3.4.4.3.3.3.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.3.cmml">l</mi></msubsup><mo stretchy="false" id="S4.SS1.p1.3.m3.4.4.3.3.8" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.4b"><apply id="S4.SS1.p1.3.m3.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4"><csymbol cd="latexml" id="S4.SS1.p1.3.m3.4.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4.4">assign</csymbol><apply id="S4.SS1.p1.3.m3.4.4.5.cmml" xref="S4.SS1.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.5.1.cmml" xref="S4.SS1.p1.3.m3.4.4.5">superscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.5.2.cmml" xref="S4.SS1.p1.3.m3.4.4.5.2">𝐳</ci><ci id="S4.SS1.p1.3.m3.4.4.5.3.cmml" xref="S4.SS1.p1.3.m3.4.4.5.3">𝑙</ci></apply><list id="S4.SS1.p1.3.m3.4.4.3.4.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3"><apply id="S4.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.2">𝑧</ci><ci id="S4.SS1.p1.3.m3.2.2.1.1.1.2.3a.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.3"><mtext mathsize="70%" id="S4.SS1.p1.3.m3.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.3">cls</mtext></ci></apply><ci id="S4.SS1.p1.3.m3.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1.3">𝑙</ci></apply><apply id="S4.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2.2">𝑧</ci><cn type="integer" id="S4.SS1.p1.3.m3.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2.3">1</cn></apply><ci id="S4.SS1.p1.3.m3.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2.3">𝑙</ci></apply><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">…</ci><apply id="S4.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3">superscript</csymbol><apply id="S4.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.3.3.3.2.1.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.3.3.3.2.2.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2.2">𝑧</ci><ci id="S4.SS1.p1.3.m3.4.4.3.3.3.2.3.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2.3">𝑁</ci></apply><ci id="S4.SS1.p1.3.m3.4.4.3.3.3.3.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3.3">𝑙</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.4c">\mathbf{z}^{l}:=[z_{\text{cls}}^{l},z_{1}^{l},\ldots,z_{N}^{l}]</annotation></semantics></math> the intermediate tokens,
the feed-forward pass of a Transformer can be formalized as</p>
<table id="A2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z}^{0}" display="inline"><semantics id="S4.E4.m1.1a"><msup id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mi id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">𝐳</mi><mn id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1">superscript</csymbol><ci id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2">𝐳</ci><cn type="integer" id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle\mathbf{z}^{0}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m2.2" class="ltx_Math" alttext="\displaystyle=\text{Tokenizer}(\mathbf{x})+\mathbf{p}," display="inline"><semantics id="S4.E4.m2.2a"><mrow id="S4.E4.m2.2.2.1" xref="S4.E4.m2.2.2.1.1.cmml"><mrow id="S4.E4.m2.2.2.1.1" xref="S4.E4.m2.2.2.1.1.cmml"><mi id="S4.E4.m2.2.2.1.1.2" xref="S4.E4.m2.2.2.1.1.2.cmml"></mi><mo id="S4.E4.m2.2.2.1.1.1" xref="S4.E4.m2.2.2.1.1.1.cmml">=</mo><mrow id="S4.E4.m2.2.2.1.1.3" xref="S4.E4.m2.2.2.1.1.3.cmml"><mrow id="S4.E4.m2.2.2.1.1.3.2" xref="S4.E4.m2.2.2.1.1.3.2.cmml"><mtext id="S4.E4.m2.2.2.1.1.3.2.2" xref="S4.E4.m2.2.2.1.1.3.2.2a.cmml">Tokenizer</mtext><mo lspace="0em" rspace="0em" id="S4.E4.m2.2.2.1.1.3.2.1" xref="S4.E4.m2.2.2.1.1.3.2.1.cmml">​</mo><mrow id="S4.E4.m2.2.2.1.1.3.2.3.2" xref="S4.E4.m2.2.2.1.1.3.2.cmml"><mo stretchy="false" id="S4.E4.m2.2.2.1.1.3.2.3.2.1" xref="S4.E4.m2.2.2.1.1.3.2.cmml">(</mo><mi id="S4.E4.m2.1.1" xref="S4.E4.m2.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E4.m2.2.2.1.1.3.2.3.2.2" xref="S4.E4.m2.2.2.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m2.2.2.1.1.3.1" xref="S4.E4.m2.2.2.1.1.3.1.cmml">+</mo><mi id="S4.E4.m2.2.2.1.1.3.3" xref="S4.E4.m2.2.2.1.1.3.3.cmml">𝐩</mi></mrow></mrow><mo id="S4.E4.m2.2.2.1.2" xref="S4.E4.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m2.2b"><apply id="S4.E4.m2.2.2.1.1.cmml" xref="S4.E4.m2.2.2.1"><eq id="S4.E4.m2.2.2.1.1.1.cmml" xref="S4.E4.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S4.E4.m2.2.2.1.1.2.cmml" xref="S4.E4.m2.2.2.1.1.2">absent</csymbol><apply id="S4.E4.m2.2.2.1.1.3.cmml" xref="S4.E4.m2.2.2.1.1.3"><plus id="S4.E4.m2.2.2.1.1.3.1.cmml" xref="S4.E4.m2.2.2.1.1.3.1"></plus><apply id="S4.E4.m2.2.2.1.1.3.2.cmml" xref="S4.E4.m2.2.2.1.1.3.2"><times id="S4.E4.m2.2.2.1.1.3.2.1.cmml" xref="S4.E4.m2.2.2.1.1.3.2.1"></times><ci id="S4.E4.m2.2.2.1.1.3.2.2a.cmml" xref="S4.E4.m2.2.2.1.1.3.2.2"><mtext id="S4.E4.m2.2.2.1.1.3.2.2.cmml" xref="S4.E4.m2.2.2.1.1.3.2.2">Tokenizer</mtext></ci><ci id="S4.E4.m2.1.1.cmml" xref="S4.E4.m2.1.1">𝐱</ci></apply><ci id="S4.E4.m2.2.2.1.1.3.3.cmml" xref="S4.E4.m2.2.2.1.1.3.3">𝐩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.2c">\displaystyle=\text{Tokenizer}(\mathbf{x})+\mathbf{p},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z}^{l}" display="inline"><semantics id="S4.E5.m1.1a"><msup id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mi id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml">𝐳</mi><mi id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1">superscript</csymbol><ci id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2">𝐳</ci><ci id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle\mathbf{z}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5.m2.1" class="ltx_Math" alttext="\displaystyle=\text{MSA}(\text{LN}(\mathbf{z}^{l-1}))+\mathbf{z}^{l-1},\quad l=1\cdots L," display="inline"><semantics id="S4.E5.m2.1a"><mrow id="S4.E5.m2.1.1.1"><mrow id="S4.E5.m2.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.3.cmml"><mrow id="S4.E5.m2.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.3.cmml"></mi><mo id="S4.E5.m2.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E5.m2.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m2.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E5.m2.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.3a.cmml">MSA</mtext><mo lspace="0em" rspace="0em" id="S4.E5.m2.1.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m2.1.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.1.2.cmml">+</mo><msup id="S4.E5.m2.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.1.3.2" xref="S4.E5.m2.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mrow id="S4.E5.m2.1.1.1.1.1.1.1.3.3" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.1.3.3.2" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.2.cmml">l</mi><mo id="S4.E5.m2.1.1.1.1.1.1.1.3.3.1" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E5.m2.1.1.1.1.1.1.1.3.3.3" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><mo rspace="1.167em" id="S4.E5.m2.1.1.1.1.2.3" xref="S4.E5.m2.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E5.m2.1.1.1.1.2.2" xref="S4.E5.m2.1.1.1.1.2.2.cmml"><mi id="S4.E5.m2.1.1.1.1.2.2.2" xref="S4.E5.m2.1.1.1.1.2.2.2.cmml">l</mi><mo id="S4.E5.m2.1.1.1.1.2.2.1" xref="S4.E5.m2.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S4.E5.m2.1.1.1.1.2.2.3" xref="S4.E5.m2.1.1.1.1.2.2.3.cmml"><mn id="S4.E5.m2.1.1.1.1.2.2.3.2" xref="S4.E5.m2.1.1.1.1.2.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.E5.m2.1.1.1.1.2.2.3.1" xref="S4.E5.m2.1.1.1.1.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.E5.m2.1.1.1.1.2.2.3.3" xref="S4.E5.m2.1.1.1.1.2.2.3.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S4.E5.m2.1.1.1.1.2.2.3.1a" xref="S4.E5.m2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E5.m2.1.1.1.1.2.2.3.4" xref="S4.E5.m2.1.1.1.1.2.2.3.4.cmml">L</mi></mrow></mrow></mrow><mo id="S4.E5.m2.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m2.1b"><apply id="S4.E5.m2.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.3a.cmml" xref="S4.E5.m2.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E5.m2.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1"><eq id="S4.E5.m2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E5.m2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.3">absent</csymbol><apply id="S4.E5.m2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1"><plus id="S4.E5.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.2"></plus><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1"><times id="S4.E5.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.3"><mtext id="S4.E5.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.3">MSA</mtext></ci><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1"><times id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply><apply id="S4.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E5.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3.2">𝐳</ci><apply id="S4.E5.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3"><minus id="S4.E5.m2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.E5.m2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S4.E5.m2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S4.E5.m2.1.1.1.1.2.2.cmml" xref="S4.E5.m2.1.1.1.1.2.2"><eq id="S4.E5.m2.1.1.1.1.2.2.1.cmml" xref="S4.E5.m2.1.1.1.1.2.2.1"></eq><ci id="S4.E5.m2.1.1.1.1.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.2.2.2">𝑙</ci><apply id="S4.E5.m2.1.1.1.1.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.2.2.3"><times id="S4.E5.m2.1.1.1.1.2.2.3.1.cmml" xref="S4.E5.m2.1.1.1.1.2.2.3.1"></times><cn type="integer" id="S4.E5.m2.1.1.1.1.2.2.3.2.cmml" xref="S4.E5.m2.1.1.1.1.2.2.3.2">1</cn><ci id="S4.E5.m2.1.1.1.1.2.2.3.3.cmml" xref="S4.E5.m2.1.1.1.1.2.2.3.3">⋯</ci><ci id="S4.E5.m2.1.1.1.1.2.2.3.4.cmml" xref="S4.E5.m2.1.1.1.1.2.2.3.4">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m2.1c">\displaystyle=\text{MSA}(\text{LN}(\mathbf{z}^{l-1}))+\mathbf{z}^{l-1},\quad l=1\cdots L,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z}^{l}" display="inline"><semantics id="S4.E6.m1.1a"><msup id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml"><mi id="S4.E6.m1.1.1.2" xref="S4.E6.m1.1.1.2.cmml">𝐳</mi><mi id="S4.E6.m1.1.1.3" xref="S4.E6.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1">superscript</csymbol><ci id="S4.E6.m1.1.1.2.cmml" xref="S4.E6.m1.1.1.2">𝐳</ci><ci id="S4.E6.m1.1.1.3.cmml" xref="S4.E6.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\mathbf{z}^{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6.m2.1" class="ltx_Math" alttext="\displaystyle=\text{MLP}(\text{LN}(\mathbf{z}^{l}))+\mathbf{z}^{l},\quad l=1\cdots L." display="inline"><semantics id="S4.E6.m2.1a"><mrow id="S4.E6.m2.1.1.1"><mrow id="S4.E6.m2.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.3.cmml"><mrow id="S4.E6.m2.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.cmml"><mi id="S4.E6.m2.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.3.cmml"></mi><mo id="S4.E6.m2.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E6.m2.1.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m2.1.1.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E6.m2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.1.1.3a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m2.1.1.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">LN</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m2.1.1.1.1.1.1.1.2" xref="S4.E6.m2.1.1.1.1.1.1.1.2.cmml">+</mo><msup id="S4.E6.m2.1.1.1.1.1.1.1.3" xref="S4.E6.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m2.1.1.1.1.1.1.1.3.2" xref="S4.E6.m2.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S4.E6.m2.1.1.1.1.1.1.1.3.3" xref="S4.E6.m2.1.1.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow></mrow><mo rspace="1.167em" id="S4.E6.m2.1.1.1.1.2.3" xref="S4.E6.m2.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E6.m2.1.1.1.1.2.2" xref="S4.E6.m2.1.1.1.1.2.2.cmml"><mi id="S4.E6.m2.1.1.1.1.2.2.2" xref="S4.E6.m2.1.1.1.1.2.2.2.cmml">l</mi><mo id="S4.E6.m2.1.1.1.1.2.2.1" xref="S4.E6.m2.1.1.1.1.2.2.1.cmml">=</mo><mrow id="S4.E6.m2.1.1.1.1.2.2.3" xref="S4.E6.m2.1.1.1.1.2.2.3.cmml"><mn id="S4.E6.m2.1.1.1.1.2.2.3.2" xref="S4.E6.m2.1.1.1.1.2.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.E6.m2.1.1.1.1.2.2.3.1" xref="S4.E6.m2.1.1.1.1.2.2.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.E6.m2.1.1.1.1.2.2.3.3" xref="S4.E6.m2.1.1.1.1.2.2.3.3.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S4.E6.m2.1.1.1.1.2.2.3.1a" xref="S4.E6.m2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E6.m2.1.1.1.1.2.2.3.4" xref="S4.E6.m2.1.1.1.1.2.2.3.4.cmml">L</mi></mrow></mrow></mrow><mo lspace="0em" id="S4.E6.m2.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m2.1b"><apply id="S4.E6.m2.1.1.1.1.3.cmml" xref="S4.E6.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m2.1.1.1.1.3a.cmml" xref="S4.E6.m2.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E6.m2.1.1.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1"><eq id="S4.E6.m2.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.1.1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E6.m2.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.1.1.1.1.1.1.3">absent</csymbol><apply id="S4.E6.m2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1"><plus id="S4.E6.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.2"></plus><apply id="S4.E6.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1"><times id="S4.E6.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E6.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.3"><mtext id="S4.E6.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.3">MLP</mtext></ci><apply id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1"><times id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.3">LN</mtext></ci><apply id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S4.E6.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E6.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S4.E6.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m2.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply><apply id="S4.E6.m2.1.1.1.1.2.2.cmml" xref="S4.E6.m2.1.1.1.1.2.2"><eq id="S4.E6.m2.1.1.1.1.2.2.1.cmml" xref="S4.E6.m2.1.1.1.1.2.2.1"></eq><ci id="S4.E6.m2.1.1.1.1.2.2.2.cmml" xref="S4.E6.m2.1.1.1.1.2.2.2">𝑙</ci><apply id="S4.E6.m2.1.1.1.1.2.2.3.cmml" xref="S4.E6.m2.1.1.1.1.2.2.3"><times id="S4.E6.m2.1.1.1.1.2.2.3.1.cmml" xref="S4.E6.m2.1.1.1.1.2.2.3.1"></times><cn type="integer" id="S4.E6.m2.1.1.1.1.2.2.3.2.cmml" xref="S4.E6.m2.1.1.1.1.2.2.3.2">1</cn><ci id="S4.E6.m2.1.1.1.1.2.2.3.3.cmml" xref="S4.E6.m2.1.1.1.1.2.2.3.3">⋯</ci><ci id="S4.E6.m2.1.1.1.1.2.2.3.4.cmml" xref="S4.E6.m2.1.1.1.1.2.2.3.4">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m2.1c">\displaystyle=\text{MLP}(\text{LN}(\mathbf{z}^{l}))+\mathbf{z}^{l},\quad l=1\cdots L.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2212.04084/assets/figs/AFFL_fig1_DLv3.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="269" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.6.1" class="ltx_text" style="color:#000000;">Model architecture of the proposed Accumulator</span>. Given a frozen Transformer FM (in grey), the Accumulator aggregates the information from the history of the <span id="S4.F2.7.2" class="ltx_text ltx_font_typewriter">CLS</span> tokens through the transformation, which yields a better feature representation for early exits at different layers. The early exit slots are numbered (there are three exits in this example), and the corresponding pathways are denoted by different line types (e.g., dotted for exit 0 and dashed for exit 1). A residual connection is introduced to each early exit between the <span id="S4.F2.8.3" class="ltx_text ltx_font_typewriter">CLS</span> token at the exit and the output of the Accumulator. A special <span id="S4.F2.9.4" class="ltx_text ltx_font_typewriter">CLS</span> token (or referred to as <span id="S4.F2.10.5" class="ltx_text ltx_font_typewriter">Client</span> token) is introduced to be the first token of the Accumulator, which can be tuned for personalization while freezing the other parts.
</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Accumulator</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">To adapt a pre-trained Transformer model,
we inject our Accumulator into each<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Note that there is only one Accumulator that handles the outputs from all layers.</span></span></span> self-attention block followed by a shared MLP head to enable early predictions. Formally, by collecting the history of <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_typewriter">CLS</span> tokens, we replace <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="z_{\text{cls}}^{l}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msubsup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">z</mi><mtext id="S4.SS2.p1.1.m1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.2.3a.cmml">cls</mtext><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2">𝑧</ci><ci id="S4.SS2.p1.1.m1.1.1.2.3a.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.2.3">cls</mtext></ci></apply><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">z_{\text{cls}}^{l}</annotation></semantics></math> by</p>
<table id="A2.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7.m1.3" class="ltx_Math" alttext="\displaystyle z_{\text{cls}}^{l}\leftarrow h^{l}_{l+1}\quad\text{with}\quad h^{l}=\text{Accumulator{}}_{\phi}([z_{\text{client}},z_{\text{cls}}^{0}+p^{\prime}_{0},\ldots,z_{\text{cls}}^{l}+p^{\prime}_{l}])," display="inline"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1"><mrow id="S4.E7.m1.3.3.1.1.2" xref="S4.E7.m1.3.3.1.1.3.cmml"><mrow id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.cmml"><msubsup id="S4.E7.m1.3.3.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.3.2.2" xref="S4.E7.m1.3.3.1.1.1.1.3.2.2.cmml">z</mi><mtext id="S4.E7.m1.3.3.1.1.1.1.3.2.3" xref="S4.E7.m1.3.3.1.1.1.1.3.2.3a.cmml">cls</mtext><mi id="S4.E7.m1.3.3.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.3.3.cmml">l</mi></msubsup><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.2.cmml">←</mo><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.2.cmml"><msubsup id="S4.E7.m1.3.3.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mspace width="1em" id="S4.E7.m1.3.3.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.2.cmml"></mspace><mtext id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2a.cmml">with</mtext></mrow></mrow><mspace width="1em" id="S4.E7.m1.3.3.1.1.2.3" xref="S4.E7.m1.3.3.1.1.3a.cmml"></mspace><mrow id="S4.E7.m1.3.3.1.1.2.2" xref="S4.E7.m1.3.3.1.1.2.2.cmml"><msup id="S4.E7.m1.3.3.1.1.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.3.2" xref="S4.E7.m1.3.3.1.1.2.2.3.2.cmml">h</mi><mi id="S4.E7.m1.3.3.1.1.2.2.3.3" xref="S4.E7.m1.3.3.1.1.2.2.3.3.cmml">l</mi></msup><mo id="S4.E7.m1.3.3.1.1.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.2.cmml">=</mo><mrow id="S4.E7.m1.3.3.1.1.2.2.1" xref="S4.E7.m1.3.3.1.1.2.2.1.cmml"><msub id="S4.E7.m1.3.3.1.1.2.2.1.3" xref="S4.E7.m1.3.3.1.1.2.2.1.3.cmml"><mtext id="S4.E7.m1.3.3.1.1.2.2.1.3.2" xref="S4.E7.m1.3.3.1.1.2.2.1.3.2a.cmml">Accumulator</mtext><mi id="S4.E7.m1.3.3.1.1.2.2.1.3.3" xref="S4.E7.m1.3.3.1.1.2.2.1.3.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.2.2.1.2" xref="S4.E7.m1.3.3.1.1.2.2.1.2.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.2.2.1.1.1" xref="S4.E7.m1.3.3.1.1.2.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.2" xref="S4.E7.m1.3.3.1.1.2.2.1.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.4" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml">[</mo><msub id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml">z</mi><mtext id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.3a.cmml">client</mtext></msub><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.5" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml">,</mo><mrow id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.cmml"><msubsup id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.2.cmml">z</mi><mtext id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.3a.cmml">cls</mtext><mn id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.3.cmml">0</mn></msubsup><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.1" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.1.cmml">+</mo><msubsup id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.2.cmml">p</mi><mn id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.3.cmml">0</mn><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.6" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml">,</mo><mi mathvariant="normal" id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">…</mi><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.7" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml">,</mo><mrow id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.cmml"><msubsup id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.2.cmml">z</mi><mtext id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.3a.cmml">cls</mtext><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.3.cmml">l</mi></msubsup><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.1" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.1.cmml">+</mo><msubsup id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.2" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.2.cmml">p</mi><mi id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.3.cmml">l</mi><mo id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.3" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.3.cmml">′</mo></msubsup></mrow><mo stretchy="false" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.8" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml">]</mo></mrow><mo stretchy="false" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.3" xref="S4.E7.m1.3.3.1.1.2.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3a.cmml" xref="S4.E7.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1"><ci id="S4.E7.m1.3.3.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2">←</ci><apply id="S4.E7.m1.3.3.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3.2.2">𝑧</ci><ci id="S4.E7.m1.3.3.1.1.1.1.3.2.3a.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S4.E7.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3.2.3">cls</mtext></ci></apply><ci id="S4.E7.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3.3">𝑙</ci></apply><list id="S4.E7.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1"><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3"><plus id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.1"></plus><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E7.m1.2.2a.cmml" xref="S4.E7.m1.2.2"><mtext id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">with</mtext></ci></list></apply><apply id="S4.E7.m1.3.3.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2"><eq id="S4.E7.m1.3.3.1.1.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2"></eq><apply id="S4.E7.m1.3.3.1.1.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.3.2">ℎ</ci><ci id="S4.E7.m1.3.3.1.1.2.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.3.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1"><times id="S4.E7.m1.3.3.1.1.2.2.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.2"></times><apply id="S4.E7.m1.3.3.1.1.2.2.1.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.1.3.2a.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.3.2"><mtext id="S4.E7.m1.3.3.1.1.2.2.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.3.2">Accumulator</mtext></ci><ci id="S4.E7.m1.3.3.1.1.2.2.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.3.3">italic-ϕ</ci></apply><list id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.4.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3"><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.3a.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.3"><mtext mathsize="70%" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.1.1.3">client</mtext></ci></apply><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2"><plus id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.1"></plus><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.3a.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.3"><mtext mathsize="70%" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.2.3">cls</mtext></ci></apply><cn type="integer" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.2.3">0</cn></apply><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.2">𝑝</ci><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.2.3">′</ci></apply><cn type="integer" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.2.2.3.3">0</cn></apply></apply><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">…</ci><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3"><plus id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.1"></plus><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.2">𝑧</ci><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.3a.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.3"><mtext mathsize="70%" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.2.3">cls</mtext></ci></apply><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.2.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3">subscript</csymbol><apply id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.2">𝑝</ci><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.2.3">′</ci></apply><ci id="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.1.1.1.1.3.3.3.3">𝑙</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\displaystyle z_{\text{cls}}^{l}\leftarrow h^{l}_{l+1}\quad\text{with}\quad h^{l}=\text{Accumulator{}}_{\phi}([z_{\text{client}},z_{\text{cls}}^{0}+p^{\prime}_{0},\ldots,z_{\text{cls}}^{l}+p^{\prime}_{l}]),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.8" class="ltx_p">where the Accumulator parameterized by <math id="S4.SS2.p1.2.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.SS2.p1.2.m1.1a"><mi id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><ci id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">\phi</annotation></semantics></math> is another Transformer (randomly initialized) with a single<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>We find in Table <a href="#S5.T5" title="Table 5 ‣ Personalization. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> that increases from a single block to 3 blocks yields little improvement in accuracy but a significantly heavier communication burden.</span></span></span> self-attention block as defined by Eq. <a href="#S4.E5" title="In 4.1 Transformer model ‣ 4 Adapting Transformer FMs into Federated Learning ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> and  <a href="#S4.E6" title="In 4.1 Transformer model ‣ 4 Adapting Transformer FMs into Federated Learning ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. <math id="S4.SS2.p1.3.m2.1" class="ltx_Math" alttext="h^{l}_{l+1}" display="inline"><semantics id="S4.SS2.p1.3.m2.1a"><msubsup id="S4.SS2.p1.3.m2.1.1" xref="S4.SS2.p1.3.m2.1.1.cmml"><mi id="S4.SS2.p1.3.m2.1.1.2.2" xref="S4.SS2.p1.3.m2.1.1.2.2.cmml">h</mi><mrow id="S4.SS2.p1.3.m2.1.1.3" xref="S4.SS2.p1.3.m2.1.1.3.cmml"><mi id="S4.SS2.p1.3.m2.1.1.3.2" xref="S4.SS2.p1.3.m2.1.1.3.2.cmml">l</mi><mo id="S4.SS2.p1.3.m2.1.1.3.1" xref="S4.SS2.p1.3.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p1.3.m2.1.1.3.3" xref="S4.SS2.p1.3.m2.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p1.3.m2.1.1.2.3" xref="S4.SS2.p1.3.m2.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.1b"><apply id="S4.SS2.p1.3.m2.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1">subscript</csymbol><apply id="S4.SS2.p1.3.m2.1.1.2.cmml" xref="S4.SS2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.1.1.2.1.cmml" xref="S4.SS2.p1.3.m2.1.1">superscript</csymbol><ci id="S4.SS2.p1.3.m2.1.1.2.2.cmml" xref="S4.SS2.p1.3.m2.1.1.2.2">ℎ</ci><ci id="S4.SS2.p1.3.m2.1.1.2.3.cmml" xref="S4.SS2.p1.3.m2.1.1.2.3">𝑙</ci></apply><apply id="S4.SS2.p1.3.m2.1.1.3.cmml" xref="S4.SS2.p1.3.m2.1.1.3"><plus id="S4.SS2.p1.3.m2.1.1.3.1.cmml" xref="S4.SS2.p1.3.m2.1.1.3.1"></plus><ci id="S4.SS2.p1.3.m2.1.1.3.2.cmml" xref="S4.SS2.p1.3.m2.1.1.3.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.3.m2.1.1.3.3.cmml" xref="S4.SS2.p1.3.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.1c">h^{l}_{l+1}</annotation></semantics></math> means the <math id="S4.SS2.p1.4.m3.1" class="ltx_Math" alttext="l+1" display="inline"><semantics id="S4.SS2.p1.4.m3.1a"><mrow id="S4.SS2.p1.4.m3.1.1" xref="S4.SS2.p1.4.m3.1.1.cmml"><mi id="S4.SS2.p1.4.m3.1.1.2" xref="S4.SS2.p1.4.m3.1.1.2.cmml">l</mi><mo id="S4.SS2.p1.4.m3.1.1.1" xref="S4.SS2.p1.4.m3.1.1.1.cmml">+</mo><mn id="S4.SS2.p1.4.m3.1.1.3" xref="S4.SS2.p1.4.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m3.1b"><apply id="S4.SS2.p1.4.m3.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1"><plus id="S4.SS2.p1.4.m3.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1"></plus><ci id="S4.SS2.p1.4.m3.1.1.2.cmml" xref="S4.SS2.p1.4.m3.1.1.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.4.m3.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m3.1c">l+1</annotation></semantics></math> element in <math id="S4.SS2.p1.5.m4.1" class="ltx_Math" alttext="h^{l}" display="inline"><semantics id="S4.SS2.p1.5.m4.1a"><msup id="S4.SS2.p1.5.m4.1.1" xref="S4.SS2.p1.5.m4.1.1.cmml"><mi id="S4.SS2.p1.5.m4.1.1.2" xref="S4.SS2.p1.5.m4.1.1.2.cmml">h</mi><mi id="S4.SS2.p1.5.m4.1.1.3" xref="S4.SS2.p1.5.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m4.1b"><apply id="S4.SS2.p1.5.m4.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.1.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1">superscript</csymbol><ci id="S4.SS2.p1.5.m4.1.1.2.cmml" xref="S4.SS2.p1.5.m4.1.1.2">ℎ</ci><ci id="S4.SS2.p1.5.m4.1.1.3.cmml" xref="S4.SS2.p1.5.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m4.1c">h^{l}</annotation></semantics></math>. In our Accumulator, the positional embedding <math id="S4.SS2.p1.6.m5.3" class="ltx_Math" alttext="\mathbf{p}^{\prime}:=[p^{\prime}_{0},\ldots,p^{\prime}_{L}]" display="inline"><semantics id="S4.SS2.p1.6.m5.3a"><mrow id="S4.SS2.p1.6.m5.3.3" xref="S4.SS2.p1.6.m5.3.3.cmml"><msup id="S4.SS2.p1.6.m5.3.3.4" xref="S4.SS2.p1.6.m5.3.3.4.cmml"><mi id="S4.SS2.p1.6.m5.3.3.4.2" xref="S4.SS2.p1.6.m5.3.3.4.2.cmml">𝐩</mi><mo id="S4.SS2.p1.6.m5.3.3.4.3" xref="S4.SS2.p1.6.m5.3.3.4.3.cmml">′</mo></msup><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.6.m5.3.3.3" xref="S4.SS2.p1.6.m5.3.3.3.cmml">:=</mo><mrow id="S4.SS2.p1.6.m5.3.3.2.2" xref="S4.SS2.p1.6.m5.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.6.m5.3.3.2.2.3" xref="S4.SS2.p1.6.m5.3.3.2.3.cmml">[</mo><msubsup id="S4.SS2.p1.6.m5.2.2.1.1.1" xref="S4.SS2.p1.6.m5.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.6.m5.2.2.1.1.1.2.2" xref="S4.SS2.p1.6.m5.2.2.1.1.1.2.2.cmml">p</mi><mn id="S4.SS2.p1.6.m5.2.2.1.1.1.3" xref="S4.SS2.p1.6.m5.2.2.1.1.1.3.cmml">0</mn><mo id="S4.SS2.p1.6.m5.2.2.1.1.1.2.3" xref="S4.SS2.p1.6.m5.2.2.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S4.SS2.p1.6.m5.3.3.2.2.4" xref="S4.SS2.p1.6.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p1.6.m5.1.1" xref="S4.SS2.p1.6.m5.1.1.cmml">…</mi><mo id="S4.SS2.p1.6.m5.3.3.2.2.5" xref="S4.SS2.p1.6.m5.3.3.2.3.cmml">,</mo><msubsup id="S4.SS2.p1.6.m5.3.3.2.2.2" xref="S4.SS2.p1.6.m5.3.3.2.2.2.cmml"><mi id="S4.SS2.p1.6.m5.3.3.2.2.2.2.2" xref="S4.SS2.p1.6.m5.3.3.2.2.2.2.2.cmml">p</mi><mi id="S4.SS2.p1.6.m5.3.3.2.2.2.3" xref="S4.SS2.p1.6.m5.3.3.2.2.2.3.cmml">L</mi><mo id="S4.SS2.p1.6.m5.3.3.2.2.2.2.3" xref="S4.SS2.p1.6.m5.3.3.2.2.2.2.3.cmml">′</mo></msubsup><mo stretchy="false" id="S4.SS2.p1.6.m5.3.3.2.2.6" xref="S4.SS2.p1.6.m5.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m5.3b"><apply id="S4.SS2.p1.6.m5.3.3.cmml" xref="S4.SS2.p1.6.m5.3.3"><csymbol cd="latexml" id="S4.SS2.p1.6.m5.3.3.3.cmml" xref="S4.SS2.p1.6.m5.3.3.3">assign</csymbol><apply id="S4.SS2.p1.6.m5.3.3.4.cmml" xref="S4.SS2.p1.6.m5.3.3.4"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.3.3.4.1.cmml" xref="S4.SS2.p1.6.m5.3.3.4">superscript</csymbol><ci id="S4.SS2.p1.6.m5.3.3.4.2.cmml" xref="S4.SS2.p1.6.m5.3.3.4.2">𝐩</ci><ci id="S4.SS2.p1.6.m5.3.3.4.3.cmml" xref="S4.SS2.p1.6.m5.3.3.4.3">′</ci></apply><list id="S4.SS2.p1.6.m5.3.3.2.3.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2"><apply id="S4.SS2.p1.6.m5.2.2.1.1.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1">subscript</csymbol><apply id="S4.SS2.p1.6.m5.2.2.1.1.1.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.2.2.1.1.1.2.1.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.6.m5.2.2.1.1.1.2.2.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.2.2">𝑝</ci><ci id="S4.SS2.p1.6.m5.2.2.1.1.1.2.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.2.3">′</ci></apply><cn type="integer" id="S4.SS2.p1.6.m5.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.6.m5.2.2.1.1.1.3">0</cn></apply><ci id="S4.SS2.p1.6.m5.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1">…</ci><apply id="S4.SS2.p1.6.m5.3.3.2.2.2.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.3.3.2.2.2.1.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2">subscript</csymbol><apply id="S4.SS2.p1.6.m5.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.3.3.2.2.2.2.1.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2">superscript</csymbol><ci id="S4.SS2.p1.6.m5.3.3.2.2.2.2.2.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2.2.2">𝑝</ci><ci id="S4.SS2.p1.6.m5.3.3.2.2.2.2.3.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2.2.3">′</ci></apply><ci id="S4.SS2.p1.6.m5.3.3.2.2.2.3.cmml" xref="S4.SS2.p1.6.m5.3.3.2.2.2.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m5.3c">\mathbf{p}^{\prime}:=[p^{\prime}_{0},\ldots,p^{\prime}_{L}]</annotation></semantics></math> embeds the layer information from a pretrained Transformer. Note that the modified <math id="S4.SS2.p1.7.m6.1" class="ltx_Math" alttext="z_{\text{cls}}^{l}" display="inline"><semantics id="S4.SS2.p1.7.m6.1a"><msubsup id="S4.SS2.p1.7.m6.1.1" xref="S4.SS2.p1.7.m6.1.1.cmml"><mi id="S4.SS2.p1.7.m6.1.1.2.2" xref="S4.SS2.p1.7.m6.1.1.2.2.cmml">z</mi><mtext id="S4.SS2.p1.7.m6.1.1.2.3" xref="S4.SS2.p1.7.m6.1.1.2.3a.cmml">cls</mtext><mi id="S4.SS2.p1.7.m6.1.1.3" xref="S4.SS2.p1.7.m6.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m6.1b"><apply id="S4.SS2.p1.7.m6.1.1.cmml" xref="S4.SS2.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m6.1.1.1.cmml" xref="S4.SS2.p1.7.m6.1.1">superscript</csymbol><apply id="S4.SS2.p1.7.m6.1.1.2.cmml" xref="S4.SS2.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.7.m6.1.1.2.1.cmml" xref="S4.SS2.p1.7.m6.1.1">subscript</csymbol><ci id="S4.SS2.p1.7.m6.1.1.2.2.cmml" xref="S4.SS2.p1.7.m6.1.1.2.2">𝑧</ci><ci id="S4.SS2.p1.7.m6.1.1.2.3a.cmml" xref="S4.SS2.p1.7.m6.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.p1.7.m6.1.1.2.3.cmml" xref="S4.SS2.p1.7.m6.1.1.2.3">cls</mtext></ci></apply><ci id="S4.SS2.p1.7.m6.1.1.3.cmml" xref="S4.SS2.p1.7.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m6.1c">z_{\text{cls}}^{l}</annotation></semantics></math> will be again used by the pre-trained Transformer, specifically, the next self-attention block, to produce <math id="S4.SS2.p1.8.m7.1" class="ltx_Math" alttext="\mathbf{z}^{l+1}" display="inline"><semantics id="S4.SS2.p1.8.m7.1a"><msup id="S4.SS2.p1.8.m7.1.1" xref="S4.SS2.p1.8.m7.1.1.cmml"><mi id="S4.SS2.p1.8.m7.1.1.2" xref="S4.SS2.p1.8.m7.1.1.2.cmml">𝐳</mi><mrow id="S4.SS2.p1.8.m7.1.1.3" xref="S4.SS2.p1.8.m7.1.1.3.cmml"><mi id="S4.SS2.p1.8.m7.1.1.3.2" xref="S4.SS2.p1.8.m7.1.1.3.2.cmml">l</mi><mo id="S4.SS2.p1.8.m7.1.1.3.1" xref="S4.SS2.p1.8.m7.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p1.8.m7.1.1.3.3" xref="S4.SS2.p1.8.m7.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m7.1b"><apply id="S4.SS2.p1.8.m7.1.1.cmml" xref="S4.SS2.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m7.1.1.1.cmml" xref="S4.SS2.p1.8.m7.1.1">superscript</csymbol><ci id="S4.SS2.p1.8.m7.1.1.2.cmml" xref="S4.SS2.p1.8.m7.1.1.2">𝐳</ci><apply id="S4.SS2.p1.8.m7.1.1.3.cmml" xref="S4.SS2.p1.8.m7.1.1.3"><plus id="S4.SS2.p1.8.m7.1.1.3.1.cmml" xref="S4.SS2.p1.8.m7.1.1.3.1"></plus><ci id="S4.SS2.p1.8.m7.1.1.3.2.cmml" xref="S4.SS2.p1.8.m7.1.1.3.2">𝑙</ci><cn type="integer" id="S4.SS2.p1.8.m7.1.1.3.3.cmml" xref="S4.SS2.p1.8.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m7.1c">\mathbf{z}^{l+1}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.3" class="ltx_p">For early predictions, instead of taking the modified <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="z_{\text{cls}}^{l}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msubsup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml">z</mi><mtext id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3a.cmml">cls</mtext><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">𝑧</ci><ci id="S4.SS2.p2.1.m1.1.1.2.3a.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3">cls</mtext></ci></apply><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">z_{\text{cls}}^{l}</annotation></semantics></math>, we find it is better to make use of the client token and the original <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="z_{\text{cls}}^{l}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msubsup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">z</mi><mtext id="S4.SS2.p2.2.m2.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.2.3a.cmml">cls</mtext><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝑧</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3a.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3"><mtext mathsize="70%" id="S4.SS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3">cls</mtext></ci></apply><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">z_{\text{cls}}^{l}</annotation></semantics></math>, specifically, the task-specific prediction at exit <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">l</annotation></semantics></math> is given by</p>
<table id="A2.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\displaystyle\hat{y}^{l}=\text{MLP-head}_{\psi}(h^{l}_{0}+z_{\text{cls}}^{l})," display="inline"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><msup id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S4.E8.m1.1.1.1.1.3.2.1" xref="S4.E8.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E8.m1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.3.3.cmml">l</mi></msup><mo id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml"><mtext id="S4.E8.m1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.3.2a.cmml">MLP-head</mtext><mi id="S4.E8.m1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.3.3.cmml">ψ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">h</mi><mn id="S4.E8.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">l</mi></msubsup><mo id="S4.E8.m1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S4.E8.m1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">z</mi><mtext id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml">cls</mtext><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"></eq><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2"><ci id="S4.E8.m1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.3.2.1">^</ci><ci id="S4.E8.m1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S4.E8.m1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.3.2a.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2"><mtext id="S4.E8.m1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.3.2">MLP-head</mtext></ci><ci id="S4.E8.m1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3.3">𝜓</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1"><plus id="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.2">ℎ</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><cn type="integer" id="S4.E8.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3a.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3"><mtext mathsize="70%" id="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.2.3">cls</mtext></ci></apply><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle\hat{y}^{l}=\text{MLP-head}_{\psi}(h^{l}_{0}+z_{\text{cls}}^{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.4" class="ltx_p">where MLP-head parameterized by <math id="S4.SS2.p2.4.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS2.p2.4.m1.1a"><mi id="S4.SS2.p2.4.m1.1.1" xref="S4.SS2.p2.4.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m1.1b"><ci id="S4.SS2.p2.4.m1.1.1.cmml" xref="S4.SS2.p2.4.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m1.1c">\psi</annotation></semantics></math> is the early exits shared across all layers.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Federated learning of Accumulator</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">Following the PE optimization in Eq <a href="#S3.E3" title="In 3.2 Parameter-Efficient Learning ‣ 3 Preliminaries ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the learnable parameters <math id="S4.SS3.p1.1.m1.2" class="ltx_Math" alttext="w_{\text{PE}}=(\phi,\psi)" display="inline"><semantics id="S4.SS3.p1.1.m1.2a"><mrow id="S4.SS3.p1.1.m1.2.3" xref="S4.SS3.p1.1.m1.2.3.cmml"><msub id="S4.SS3.p1.1.m1.2.3.2" xref="S4.SS3.p1.1.m1.2.3.2.cmml"><mi id="S4.SS3.p1.1.m1.2.3.2.2" xref="S4.SS3.p1.1.m1.2.3.2.2.cmml">w</mi><mtext id="S4.SS3.p1.1.m1.2.3.2.3" xref="S4.SS3.p1.1.m1.2.3.2.3a.cmml">PE</mtext></msub><mo id="S4.SS3.p1.1.m1.2.3.1" xref="S4.SS3.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS3.p1.1.m1.2.3.3.2" xref="S4.SS3.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.2.3.3.2.1" xref="S4.SS3.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">ϕ</mi><mo id="S4.SS3.p1.1.m1.2.3.3.2.2" xref="S4.SS3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS3.p1.1.m1.2.2" xref="S4.SS3.p1.1.m1.2.2.cmml">ψ</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.2.3.3.2.3" xref="S4.SS3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.2b"><apply id="S4.SS3.p1.1.m1.2.3.cmml" xref="S4.SS3.p1.1.m1.2.3"><eq id="S4.SS3.p1.1.m1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3.1"></eq><apply id="S4.SS3.p1.1.m1.2.3.2.cmml" xref="S4.SS3.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.2.3.2.1.cmml" xref="S4.SS3.p1.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.1.m1.2.3.2.2.cmml" xref="S4.SS3.p1.1.m1.2.3.2.2">𝑤</ci><ci id="S4.SS3.p1.1.m1.2.3.2.3a.cmml" xref="S4.SS3.p1.1.m1.2.3.2.3"><mtext mathsize="70%" id="S4.SS3.p1.1.m1.2.3.2.3.cmml" xref="S4.SS3.p1.1.m1.2.3.2.3">PE</mtext></ci></apply><interval closure="open" id="S4.SS3.p1.1.m1.2.3.3.1.cmml" xref="S4.SS3.p1.1.m1.2.3.3.2"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">italic-ϕ</ci><ci id="S4.SS3.p1.1.m1.2.2.cmml" xref="S4.SS3.p1.1.m1.2.2">𝜓</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.2c">w_{\text{PE}}=(\phi,\psi)</annotation></semantics></math> reduces to the weights of the Accumulator and the MLP head.</p>
</div>
<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Learning.</h4>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS0.Px1.p1.10" class="ltx_p">Now the learning problem in Eq. <a href="#S3.E3" title="In 3.2 Parameter-Efficient Learning ‣ 3 Preliminaries ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> becomes</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\underset{w_{\text{PE}}}{\arg\min}\sum_{i=1}^{K}\frac{\alpha_{i}}{M}\sum_{j=1}^{M}\ell(\hat{y}^{l_{i}}_{j},y_{j})," display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><munder accentunder="true" id="S4.E9.m1.1.1.1.1.4" xref="S4.E9.m1.1.1.1.1.4.cmml"><mrow id="S4.E9.m1.1.1.1.1.4.2" xref="S4.E9.m1.1.1.1.1.4.2.cmml"><mi id="S4.E9.m1.1.1.1.1.4.2.1" xref="S4.E9.m1.1.1.1.1.4.2.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E9.m1.1.1.1.1.4.2a" xref="S4.E9.m1.1.1.1.1.4.2.cmml">⁡</mo><mi id="S4.E9.m1.1.1.1.1.4.2.2" xref="S4.E9.m1.1.1.1.1.4.2.2.cmml">min</mi></mrow><msub id="S4.E9.m1.1.1.1.1.4.1" xref="S4.E9.m1.1.1.1.1.4.1.cmml"><mi id="S4.E9.m1.1.1.1.1.4.1.2" xref="S4.E9.m1.1.1.1.1.4.1.2.cmml">w</mi><mtext id="S4.E9.m1.1.1.1.1.4.1.3" xref="S4.E9.m1.1.1.1.1.4.1.3a.cmml">PE</mtext></msub></munder><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml"><munderover id="S4.E9.m1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="S4.E9.m1.1.1.1.1.2.3.2.2" xref="S4.E9.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.1.1.2.3.2.3" xref="S4.E9.m1.1.1.1.1.2.3.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.2.3.2.3.2" xref="S4.E9.m1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S4.E9.m1.1.1.1.1.2.3.2.3.1" xref="S4.E9.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S4.E9.m1.1.1.1.1.2.3.2.3.3" xref="S4.E9.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.1.1.1.1.2.3.3" xref="S4.E9.m1.1.1.1.1.2.3.3.cmml">K</mi></munderover><mrow id="S4.E9.m1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.2.2.cmml"><mfrac id="S4.E9.m1.1.1.1.1.2.2.4" xref="S4.E9.m1.1.1.1.1.2.2.4.cmml"><msub id="S4.E9.m1.1.1.1.1.2.2.4.2" xref="S4.E9.m1.1.1.1.1.2.2.4.2.cmml"><mi id="S4.E9.m1.1.1.1.1.2.2.4.2.2" xref="S4.E9.m1.1.1.1.1.2.2.4.2.2.cmml">α</mi><mi id="S4.E9.m1.1.1.1.1.2.2.4.2.3" xref="S4.E9.m1.1.1.1.1.2.2.4.2.3.cmml">i</mi></msub><mi id="S4.E9.m1.1.1.1.1.2.2.4.3" xref="S4.E9.m1.1.1.1.1.2.2.4.3.cmml">M</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S4.E9.m1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.cmml"><munderover id="S4.E9.m1.1.1.1.1.2.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E9.m1.1.1.1.1.2.2.2.3.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.2" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.1" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.3" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.1.1.1.1.2.2.2.3.3" xref="S4.E9.m1.1.1.1.1.2.2.2.3.3.cmml">M</mi></munderover><mrow id="S4.E9.m1.1.1.1.1.2.2.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.E9.m1.1.1.1.1.2.2.2.2.4" xref="S4.E9.m1.1.1.1.1.2.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.2.2.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">l</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></msubsup><mo id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.3" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.5" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><times id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"></times><apply id="S4.E9.m1.1.1.1.1.4.cmml" xref="S4.E9.m1.1.1.1.1.4"><apply id="S4.E9.m1.1.1.1.1.4.1.cmml" xref="S4.E9.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.4.1.1.cmml" xref="S4.E9.m1.1.1.1.1.4.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.4.1.2.cmml" xref="S4.E9.m1.1.1.1.1.4.1.2">𝑤</ci><ci id="S4.E9.m1.1.1.1.1.4.1.3a.cmml" xref="S4.E9.m1.1.1.1.1.4.1.3"><mtext mathsize="70%" id="S4.E9.m1.1.1.1.1.4.1.3.cmml" xref="S4.E9.m1.1.1.1.1.4.1.3">PE</mtext></ci></apply><apply id="S4.E9.m1.1.1.1.1.4.2.cmml" xref="S4.E9.m1.1.1.1.1.4.2"><arg id="S4.E9.m1.1.1.1.1.4.2.1.cmml" xref="S4.E9.m1.1.1.1.1.4.2.1"></arg><min id="S4.E9.m1.1.1.1.1.4.2.2.cmml" xref="S4.E9.m1.1.1.1.1.4.2.2"></min></apply></apply><apply id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"><apply id="S4.E9.m1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S4.E9.m1.1.1.1.1.2.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2.2"></sum><apply id="S4.E9.m1.1.1.1.1.2.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2.3"><eq id="S4.E9.m1.1.1.1.1.2.3.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="S4.E9.m1.1.1.1.1.2.3.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.2.3.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.3.3">𝐾</ci></apply><apply id="S4.E9.m1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2"><times id="S4.E9.m1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.3"></times><apply id="S4.E9.m1.1.1.1.1.2.2.4.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4"><divide id="S4.E9.m1.1.1.1.1.2.2.4.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4"></divide><apply id="S4.E9.m1.1.1.1.1.2.2.4.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.4.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.2.2.4.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4.2.2">𝛼</ci><ci id="S4.E9.m1.1.1.1.1.2.2.4.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4.2.3">𝑖</ci></apply><ci id="S4.E9.m1.1.1.1.1.2.2.4.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.4.3">𝑀</ci></apply><apply id="S4.E9.m1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2"><apply id="S4.E9.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="S4.E9.m1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.2"></sum><apply id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3"><eq id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.1"></eq><ci id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.3.3">𝑀</ci></apply><apply id="S4.E9.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2"><times id="S4.E9.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.3"></times><ci id="S4.E9.m1.1.1.1.1.2.2.2.2.4.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.4">ℓ</ci><interval closure="open" id="S4.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2"><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑦</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑙</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\underset{w_{\text{PE}}}{\arg\min}\sum_{i=1}^{K}\frac{\alpha_{i}}{M}\sum_{j=1}^{M}\ell(\hat{y}^{l_{i}}_{j},y_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.SSS0.Px1.p1.9" class="ltx_p">where <math id="S4.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.1.m1.1a"><msub id="S4.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝑙</ci><ci id="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.1.m1.1c">l_{i}</annotation></semantics></math> is the layer of an early exit for client <math id="S4.SS3.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.2.m2.1a"><mi id="S4.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.2.m2.1b"><ci id="S4.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.2.m2.1c">i</annotation></semantics></math>, which
is set for each inference in client <math id="S4.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.3.m3.1a"><mi id="S4.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.3.m3.1b"><ci id="S4.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.3.m3.1c">i</annotation></semantics></math>. Assuming the client <math id="S4.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.4.m4.1a"><mi id="S4.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.4.m4.1b"><ci id="S4.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.4.m4.1c">i</annotation></semantics></math> has the budget using up to <math id="S4.SS3.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.5.m5.1a"><msub id="S4.SS3.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.5.m5.1b"><apply id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.2">𝐿</ci><ci id="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.5.m5.1c">L_{i}</annotation></semantics></math> layers, there are two schemes for choosing the value of <math id="S4.SS3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.6.m6.1a"><msub id="S4.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.2">𝑙</ci><ci id="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.6.m6.1c">l_{i}</annotation></semantics></math>: a) <math id="S4.SS3.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="l_{i}=L_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.7.m7.1a"><mrow id="S4.SS3.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.cmml"><msub id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.2" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.3" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.1" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml">=</mo><msub id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.2" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.3" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.7.m7.1b"><apply id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1"><eq id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.1"></eq><apply id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.2">𝑙</ci><ci id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.2">𝐿</ci><ci id="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px1.p1.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.7.m7.1c">l_{i}=L_{i}</annotation></semantics></math> and b) <math id="S4.SS3.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.8.m8.1a"><msub id="S4.SS3.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.8.m8.1b"><apply id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.2">𝑙</ci><ci id="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.8.m8.1c">l_{i}</annotation></semantics></math> is taken uniformly at random from the range <math id="S4.SS3.SSS0.Px1.p1.9.m9.3" class="ltx_Math" alttext="\{1,\ldots,L_{i}\}" display="inline"><semantics id="S4.SS3.SSS0.Px1.p1.9.m9.3a"><mrow id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.2.cmml"><mo stretchy="false" id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.2" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.2.cmml">{</mo><mn id="S4.SS3.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS3.SSS0.Px1.p1.9.m9.1.1.cmml">1</mn><mo id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.3" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.2.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.SSS0.Px1.p1.9.m9.2.2" xref="S4.SS3.SSS0.Px1.p1.9.m9.2.2.cmml">…</mi><mo id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.4" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.2.cmml">,</mo><msub id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.cmml"><mi id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.2" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.3" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.5" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px1.p1.9.m9.3b"><set id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.2.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1"><cn type="integer" id="S4.SS3.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.1.1">1</cn><ci id="S4.SS3.SSS0.Px1.p1.9.m9.2.2.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.2.2">…</ci><apply id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.1.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.2.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.2">𝐿</ci><ci id="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.3.cmml" xref="S4.SS3.SSS0.Px1.p1.9.m9.3.3.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px1.p1.9.m9.3c">\{1,\ldots,L_{i}\}</annotation></semantics></math>.
We attribute this property of our formulation as <em id="S4.SS3.SSS0.Px1.p1.9.1" class="ltx_emph ltx_font_italic">anytime</em> to accommodate clients with different computing and memory capacities.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Personalization.</h4>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS0.Px2.p1.2" class="ltx_p">There are two choices: fine-tuning the whole Accumulator <math id="S4.SS3.SSS0.Px2.p1.1.m1.2" class="ltx_Math" alttext="(\phi,\psi)" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.2a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.2.3.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S4.SS3.SSS0.Px2.p1.1.m1.2.3.2.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.3.1.cmml">(</mo><mi id="S4.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">ϕ</mi><mo id="S4.SS3.SSS0.Px2.p1.1.m1.2.3.2.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS3.SSS0.Px2.p1.1.m1.2.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.2.cmml">ψ</mi><mo stretchy="false" id="S4.SS3.SSS0.Px2.p1.1.m1.2.3.2.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.2b"><interval closure="open" id="S4.SS3.SSS0.Px2.p1.1.m1.2.3.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.3.2"><ci id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1">italic-ϕ</ci><ci id="S4.SS3.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.2.2">𝜓</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.2c">(\phi,\psi)</annotation></semantics></math> or the <span id="S4.SS3.SSS0.Px2.p1.2.1" class="ltx_text ltx_font_typewriter">Client</span> token <math id="S4.SS3.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="z_{\text{client}}" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.2.m2.1a"><msub id="S4.SS3.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml">z</mi><mtext id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3a.cmml">client</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.2">𝑧</ci><ci id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3a.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3"><mtext mathsize="70%" id="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.2.m2.1.1.3">client</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.2.m2.1c">z_{\text{client}}</annotation></semantics></math> only. Given that they are both lightweight, the personalization is less likely to overfit even under an extremely low data regime.</p>
</div>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Inference.</h4>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.SSS0.Px3.p1.7" class="ltx_p">Given an FL trained model in client <math id="S4.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.1a"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.1b"><ci id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.1c">i</annotation></semantics></math>, it can infer labels <math id="S4.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="\hat{y}^{L_{i}}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.2.m2.1a"><msup id="S4.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><msub id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.3.cmml">i</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.2.m2.1b"><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2"><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.1">^</ci><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.2.2">𝑦</ci></apply><apply id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.2">𝐿</ci><ci id="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.2.m2.1c">\hat{y}^{L_{i}}</annotation></semantics></math> not only from block <math id="S4.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.3.m3.1a"><msub id="S4.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.2">𝐿</ci><ci id="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.3.m3.1c">L_{i}</annotation></semantics></math> according to its capability but also labels <math id="S4.SS3.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="\hat{y}^{l_{i}}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.4.m4.1a"><msup id="S4.SS3.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml"><mover accent="true" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.2.cmml">y</mi><mo id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.1" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.1.cmml">^</mo></mover><msub id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3.cmml">i</mi></msub></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.4.m4.1b"><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1">superscript</csymbol><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2"><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.1">^</ci><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.2.2">𝑦</ci></apply><apply id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.2">𝑙</ci><ci id="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.4.m4.1c">\hat{y}^{l_{i}}</annotation></semantics></math> as long as <math id="S4.SS3.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.5.m5.1a"><msub id="S4.SS3.SSS0.Px3.p1.5.m5.1.1" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.2" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.3" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.5.m5.1b"><apply id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1.2">𝑙</ci><ci id="S4.SS3.SSS0.Px3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.5.m5.1c">l_{i}</annotation></semantics></math> is smaller than the budget constraint <math id="S4.SS3.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.6.m6.1a"><msub id="S4.SS3.SSS0.Px3.p1.6.m6.1.1" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.2" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.3" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.6.m6.1b"><apply id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1.2">𝐿</ci><ci id="S4.SS3.SSS0.Px3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.6.m6.1c">L_{i}</annotation></semantics></math>. This property can be very useful in the case when a cellphone suffers from low battery, which enables the user to set a small budget <math id="S4.SS3.SSS0.Px3.p1.7.m7.1" class="ltx_Math" alttext="l_{i}&lt;L_{i}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.7.m7.1a"><mrow id="S4.SS3.SSS0.Px3.p1.7.m7.1.1" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.cmml"><msub id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.cmml"><mi id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.2" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.2.cmml">l</mi><mi id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.3" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.1" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.1.cmml">&lt;</mo><msub id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.cmml"><mi id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.2" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.2.cmml">L</mi><mi id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.3" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.7.m7.1b"><apply id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1"><lt id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.1"></lt><apply id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.2">𝑙</ci><ci id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.3.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.2">𝐿</ci><ci id="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.7.m7.1c">l_{i}&lt;L_{i}</annotation></semantics></math> to allow energy-efficient inference.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Dataset Settings and Implementation.</h4>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p1.2" class="ltx_p">To verify the efficacy of our proposed FL framework, we conduct experiments on the standard FL benchmarks with Flower codebase <cite class="ltx_cite ltx_citemacro_cite">Beutel et al., (<a href="#bib.bib2" title="" class="ltx_ref">2020</a>)</cite>, including CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">Krizhevsky et al., (<a href="#bib.bib16" title="" class="ltx_ref">2009</a>)</cite>, FEMNIST <cite class="ltx_cite ltx_citemacro_cite">Cohen et al., (<a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite> and SpeechCommandV2 <cite class="ltx_cite ltx_citemacro_cite">Warden, (<a href="#bib.bib37" title="" class="ltx_ref">2018</a>)</cite>, as downstream tasks of pretrained DeiT <cite class="ltx_cite ltx_citemacro_cite">Touvron et al., (<a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> and AST <cite class="ltx_cite ltx_citemacro_cite">Gong et al., (<a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>.
We use the original test set in CIFAR-100 as the global test dataset and split 10,000 images from the original training set as the personal validation set for each client when conducting the personalization experiments on CIFAR-100-C.
We simulate three different data partitions for CIFAR-100, including one IID-data partition (<math id="S5.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\alpha=1000.0" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S5.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">1000.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1"><eq id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3">1000.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.1.m1.1c">\alpha=1000.0</annotation></semantics></math>), and two non-IID data partitions(<math id="S5.SS1.SSS0.Px1.p1.2.m2.2" class="ltx_Math" alttext="\alpha=1.0,0.1" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.2.m2.2a"><mrow id="S5.SS1.SSS0.Px1.p1.2.m2.2.3" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.cmml"><mi id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.2" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.2.cmml">α</mi><mo id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.3.2" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.3.1.cmml"><mn id="S5.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml">1.0</mn><mo id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.3.2.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S5.SS1.SSS0.Px1.p1.2.m2.2.2" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.2.cmml">0.1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p1.2.m2.2b"><apply id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3"><eq id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.1"></eq><ci id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.2.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.2">𝛼</ci><list id="S5.SS1.SSS0.Px1.p1.2.m2.2.3.3.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.3.3.2"><cn type="float" id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1">1.0</cn><cn type="float" id="S5.SS1.SSS0.Px1.p1.2.m2.2.2.cmml" xref="S5.SS1.SSS0.Px1.p1.2.m2.2.2">0.1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p1.2.m2.2c">\alpha=1.0,0.1</annotation></semantics></math>) by LDA partitioning following prior works <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al., (<a href="#bib.bib15" title="" class="ltx_ref">2020</a>); <a href="#bib.bib34" title="" class="ltx_ref">Wang et al., 2020a </a></cite> with 100 clients. FEMNIST has a total of 80,000 images (grayscale) of 62 different character classes (10 numeric, 26 lowercase, and 26 uppercase).
For FEMNIST, we partition the training data in two ways, one IID and one non-IID, as in <cite class="ltx_cite ltx_citemacro_cite">Cohen et al., (<a href="#bib.bib4" title="" class="ltx_ref">2017</a>)</cite> with 381 clients. The Speech Commands v2 dataset consists of 105,829, 16KHz 1-second long audio clips of a spoken word. And we conduct our experiment with the 12-classes version, with 10 classes as ”yes”, ”no”,
”up”, ”down”, ”left”, ”right”, ”on”, ”off”, ”stop”, ”go” and one class ”unknown” and a class ”silence” which has no spoken word in the clip. The dataset has
three disjoint sets of speakers: 2112 for training, 256 for validation and 250 for the test.</p>
</div>
<div id="S5.SS1.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p2.3" class="ltx_p">For each round in FL, we sample <math id="S5.SS1.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S5.SS1.SSS0.Px1.p2.1.m1.1a"><mrow id="S5.SS1.SSS0.Px1.p2.1.m1.1.1" xref="S5.SS1.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="S5.SS1.SSS0.Px1.p2.1.m1.1.1.2" xref="S5.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml">10</mn><mo id="S5.SS1.SSS0.Px1.p2.1.m1.1.1.1" xref="S5.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p2.1.m1.1b"><apply id="S5.SS1.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p2.1.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p2.1.m1.1c">10\%</annotation></semantics></math> of clients for training on CIFAR100 and FEMNIST, and <math id="S5.SS1.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S5.SS1.SSS0.Px1.p2.2.m2.1a"><mrow id="S5.SS1.SSS0.Px1.p2.2.m2.1.1" xref="S5.SS1.SSS0.Px1.p2.2.m2.1.1.cmml"><mn id="S5.SS1.SSS0.Px1.p2.2.m2.1.1.2" xref="S5.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml">1</mn><mo id="S5.SS1.SSS0.Px1.p2.2.m2.1.1.1" xref="S5.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p2.2.m2.1b"><apply id="S5.SS1.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S5.SS1.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p2.2.m2.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p2.2.m2.1c">1\%</annotation></semantics></math> on SpeechCmdv2.
We use a pretrained DEiT-small <cite class="ltx_cite ltx_citemacro_cite">Touvron et al., (<a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite> model with <math id="S5.SS1.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="16\times 16" display="inline"><semantics id="S5.SS1.SSS0.Px1.p2.3.m3.1a"><mrow id="S5.SS1.SSS0.Px1.p2.3.m3.1.1" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.cmml"><mn id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.2" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml">16</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.1" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.3" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS0.Px1.p2.3.m3.1b"><apply id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1"><times id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.1"></times><cn type="integer" id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.2">16</cn><cn type="integer" id="S5.SS1.SSS0.Px1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.SSS0.Px1.p2.3.m3.1.1.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS0.Px1.p2.3.m3.1c">16\times 16</annotation></semantics></math> patches on ILSVRC-2012 <cite class="ltx_cite ltx_citemacro_cite">Fei-Fei et al., (<a href="#bib.bib6" title="" class="ltx_ref">2010</a>)</cite> as the foundation model, which can be used for both image and speech recognition – i.e. the backbone of AST <cite class="ltx_cite ltx_citemacro_cite">Gong et al., (<a href="#bib.bib8" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S5.SS1.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p3.1" class="ltx_p">All experiments are conducted with Pytorch on a single Nvidia Tesla V100 GPU with results repeated three times and reporting the mean and std.
All models are trained using an SGD optimizer with a cosine annealing learning rate schedule. The detailed recipe can be found in the Appendix <a href="#A1" title="Appendix A Implementation Details ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Early Exits.</h4>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px2.p1.1" class="ltx_p">Each client has its own computing capability. According to their capability, they can support a certain amount of FLOPs for one inference, or one FL round. For example, given a pretrained Transformer, some clients may be able to pass the input data through all layers of the Transformer to train a classifier. Some could only pass through half of them to the same end.
Specifically, how many layers of a pre-trained transformer can be passed through during the local model training for a client depends on the client’s computing capability. One can train a classifier head to make predictions for each layer to support the different compute capabilities among clients. These layer-wise classifier heads are often called early exits <cite class="ltx_cite ltx_citemacro_cite">Laskaridis et al., (<a href="#bib.bib17" title="" class="ltx_ref">2021</a>); Leontiadis et al., (<a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite>. For example, we can straightforwardly train 12 early exit classifiers for a given pretrained DeiT-small, which has 12 layers. And then, those exits can be used for different clients accordingly. Briefly, we can treat 12 exits corresponding to 12-tiers of client compute capability – namely, the different levels of computing budgets in terms of anytime inference.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Conventional FL performance.</figcaption>
<div id="S5.T1.38" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:386.9pt;height:130.4pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.4pt,16.2pt) scale(0.8,0.8) ;">
<table id="S5.T1.38.38" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.38.38.39.1" class="ltx_tr">
<td id="S5.T1.38.38.39.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2">
<span id="S5.T1.38.38.39.1.1.1" class="ltx_text">Method</span><span class="ltx_rule" style="width:0.0pt;height:5.2pt;background:black;display:inline-block;"></span>
</td>
<td id="S5.T1.38.38.39.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3">CIFAR-100</td>
<td id="S5.T1.38.38.39.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2">FEMNIST</td>
<td id="S5.T1.38.38.39.1.4" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T1.38.38.39.1.4.1" class="ltx_text">SpeechCmdV2</span></td>
</tr>
<tr id="S5.T1.3.3.3" class="ltx_tr">
<td id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">IID (<math id="S5.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="1000.0" display="inline"><semantics id="S5.T1.1.1.1.1.m1.1a"><mn id="S5.T1.1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.1.m1.1.1.cmml">1000.0</mn><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.m1.1b"><cn type="float" id="S5.T1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.m1.1.1">1000.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.m1.1c">1000.0</annotation></semantics></math>)</td>
<td id="S5.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Non-IID (<math id="S5.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.T1.2.2.2.2.m1.1a"><mn id="S5.T1.2.2.2.2.m1.1.1" xref="S5.T1.2.2.2.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.2.m1.1b"><cn type="float" id="S5.T1.2.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.2.m1.1c">1.0</annotation></semantics></math>)</td>
<td id="S5.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID (<math id="S5.T1.3.3.3.3.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.T1.3.3.3.3.m1.1a"><mn id="S5.T1.3.3.3.3.m1.1.1" xref="S5.T1.3.3.3.3.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.3.m1.1b"><cn type="float" id="S5.T1.3.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.3.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.3.m1.1c">0.1</annotation></semantics></math>)</td>
<td id="S5.T1.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S5.T1.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
</tr>
<tr id="S5.T1.8.8.8" class="ltx_tr">
<td id="S5.T1.8.8.8.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Fine-tuning</td>
<td id="S5.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.4.4.4.1.1" class="ltx_text" style="color:#808080;">85.05<math id="S5.T1.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.4.4.4.1.1.m1.1a"><mo mathcolor="#808080" id="S5.T1.4.4.4.1.1.m1.1.1" xref="S5.T1.4.4.4.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.4.4.4.1.1.m1.1.1.cmml" xref="S5.T1.4.4.4.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.1.1.m1.1c">\pm</annotation></semantics></math>0.55</span></td>
<td id="S5.T1.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.5.5.5.2.1" class="ltx_text" style="color:#808080;">84.91<math id="S5.T1.5.5.5.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.5.5.5.2.1.m1.1a"><mo mathcolor="#808080" id="S5.T1.5.5.5.2.1.m1.1.1" xref="S5.T1.5.5.5.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.5.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.5.5.5.2.1.m1.1.1.cmml" xref="S5.T1.5.5.5.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.5.2.1.m1.1c">\pm</annotation></semantics></math>0.98</span></td>
<td id="S5.T1.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.6.6.6.3.1" class="ltx_text" style="color:#808080;">84.25<math id="S5.T1.6.6.6.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.6.6.6.3.1.m1.1a"><mo mathcolor="#808080" id="S5.T1.6.6.6.3.1.m1.1.1" xref="S5.T1.6.6.6.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.6.3.1.m1.1b"><csymbol cd="latexml" id="S5.T1.6.6.6.3.1.m1.1.1.cmml" xref="S5.T1.6.6.6.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.6.3.1.m1.1c">\pm</annotation></semantics></math>1.14</span></td>
<td id="S5.T1.7.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.7.7.7.4.1" class="ltx_text" style="color:#808080;">86.87<math id="S5.T1.7.7.7.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.7.7.7.4.1.m1.1a"><mo mathcolor="#808080" id="S5.T1.7.7.7.4.1.m1.1.1" xref="S5.T1.7.7.7.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.7.4.1.m1.1b"><csymbol cd="latexml" id="S5.T1.7.7.7.4.1.m1.1.1.cmml" xref="S5.T1.7.7.7.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.7.4.1.m1.1c">\pm</annotation></semantics></math>0.74</span></td>
<td id="S5.T1.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.8.8.8.5.1" class="ltx_text" style="color:#808080;">85.28<math id="S5.T1.8.8.8.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.8.8.8.5.1.m1.1a"><mo mathcolor="#808080" id="S5.T1.8.8.8.5.1.m1.1.1" xref="S5.T1.8.8.8.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.8.5.1.m1.1b"><csymbol cd="latexml" id="S5.T1.8.8.8.5.1.m1.1.1.cmml" xref="S5.T1.8.8.8.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.8.5.1.m1.1c">\pm</annotation></semantics></math>1.45</span></td>
<td id="S5.T1.8.8.8.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.8.8.8.7.1" class="ltx_text" style="color:#808080;">98.22</span></td>
</tr>
<tr id="S5.T1.13.13.13" class="ltx_tr">
<td id="S5.T1.13.13.13.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Linear head</td>
<td id="S5.T1.9.9.9.1" class="ltx_td ltx_align_center ltx_border_t">74.37<math id="S5.T1.9.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.9.9.9.1.m1.1a"><mo id="S5.T1.9.9.9.1.m1.1.1" xref="S5.T1.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T1.9.9.9.1.m1.1.1.cmml" xref="S5.T1.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.9.1.m1.1c">\pm</annotation></semantics></math>0.42</td>
<td id="S5.T1.10.10.10.2" class="ltx_td ltx_align_center ltx_border_t">73.85<math id="S5.T1.10.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.10.10.10.2.m1.1a"><mo id="S5.T1.10.10.10.2.m1.1.1" xref="S5.T1.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.10.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T1.10.10.10.2.m1.1.1.cmml" xref="S5.T1.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.10.10.2.m1.1c">\pm</annotation></semantics></math>0.74</td>
<td id="S5.T1.11.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.79<math id="S5.T1.11.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.11.11.11.3.m1.1a"><mo id="S5.T1.11.11.11.3.m1.1.1" xref="S5.T1.11.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.11.11.11.3.m1.1b"><csymbol cd="latexml" id="S5.T1.11.11.11.3.m1.1.1.cmml" xref="S5.T1.11.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.11.11.3.m1.1c">\pm</annotation></semantics></math>0.83</td>
<td id="S5.T1.12.12.12.4" class="ltx_td ltx_align_center ltx_border_t">74.02<math id="S5.T1.12.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.12.12.12.4.m1.1a"><mo id="S5.T1.12.12.12.4.m1.1.1" xref="S5.T1.12.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.12.12.12.4.m1.1b"><csymbol cd="latexml" id="S5.T1.12.12.12.4.m1.1.1.cmml" xref="S5.T1.12.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.12.12.4.m1.1c">\pm</annotation></semantics></math>1.33</td>
<td id="S5.T1.13.13.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.35<math id="S5.T1.13.13.13.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.13.13.13.5.m1.1a"><mo id="S5.T1.13.13.13.5.m1.1.1" xref="S5.T1.13.13.13.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.13.13.13.5.m1.1b"><csymbol cd="latexml" id="S5.T1.13.13.13.5.m1.1.1.cmml" xref="S5.T1.13.13.13.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.13.13.5.m1.1c">\pm</annotation></semantics></math>0.52</td>
<td id="S5.T1.13.13.13.7" class="ltx_td ltx_align_center ltx_border_t">69.47</td>
</tr>
<tr id="S5.T1.18.18.18" class="ltx_tr">
<td id="S5.T1.18.18.18.6" class="ltx_td ltx_align_left ltx_border_r">+ PA</td>
<td id="S5.T1.14.14.14.1" class="ltx_td ltx_align_center">83.28<math id="S5.T1.14.14.14.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.14.14.14.1.m1.1a"><mo id="S5.T1.14.14.14.1.m1.1.1" xref="S5.T1.14.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.14.14.1.m1.1b"><csymbol cd="latexml" id="S5.T1.14.14.14.1.m1.1.1.cmml" xref="S5.T1.14.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.14.14.1.m1.1c">\pm</annotation></semantics></math>0.67</td>
<td id="S5.T1.15.15.15.2" class="ltx_td ltx_align_center">82.57<math id="S5.T1.15.15.15.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.15.15.15.2.m1.1a"><mo id="S5.T1.15.15.15.2.m1.1.1" xref="S5.T1.15.15.15.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.15.15.15.2.m1.1b"><csymbol cd="latexml" id="S5.T1.15.15.15.2.m1.1.1.cmml" xref="S5.T1.15.15.15.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.15.15.2.m1.1c">\pm</annotation></semantics></math>1.12</td>
<td id="S5.T1.16.16.16.3" class="ltx_td ltx_align_center ltx_border_r">81.41<math id="S5.T1.16.16.16.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.16.16.16.3.m1.1a"><mo id="S5.T1.16.16.16.3.m1.1.1" xref="S5.T1.16.16.16.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.16.16.16.3.m1.1b"><csymbol cd="latexml" id="S5.T1.16.16.16.3.m1.1.1.cmml" xref="S5.T1.16.16.16.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.16.16.3.m1.1c">\pm</annotation></semantics></math>1.28</td>
<td id="S5.T1.17.17.17.4" class="ltx_td ltx_align_center">82.34<math id="S5.T1.17.17.17.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.17.17.17.4.m1.1a"><mo id="S5.T1.17.17.17.4.m1.1.1" xref="S5.T1.17.17.17.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.17.17.17.4.m1.1b"><csymbol cd="latexml" id="S5.T1.17.17.17.4.m1.1.1.cmml" xref="S5.T1.17.17.17.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.17.17.4.m1.1c">\pm</annotation></semantics></math>1.56</td>
<td id="S5.T1.18.18.18.5" class="ltx_td ltx_align_center ltx_border_r">81.60<math id="S5.T1.18.18.18.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.18.18.18.5.m1.1a"><mo id="S5.T1.18.18.18.5.m1.1.1" xref="S5.T1.18.18.18.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.18.18.18.5.m1.1b"><csymbol cd="latexml" id="S5.T1.18.18.18.5.m1.1.1.cmml" xref="S5.T1.18.18.18.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.18.18.5.m1.1c">\pm</annotation></semantics></math>0.66</td>
<td id="S5.T1.18.18.18.7" class="ltx_td ltx_align_center">94.74</td>
</tr>
<tr id="S5.T1.23.23.23" class="ltx_tr">
<td id="S5.T1.23.23.23.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">MLP head</td>
<td id="S5.T1.19.19.19.1" class="ltx_td ltx_align_center ltx_border_t">76.49<math id="S5.T1.19.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.19.19.19.1.m1.1a"><mo id="S5.T1.19.19.19.1.m1.1.1" xref="S5.T1.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T1.19.19.19.1.m1.1.1.cmml" xref="S5.T1.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.19.19.19.1.m1.1c">\pm</annotation></semantics></math>0.43</td>
<td id="S5.T1.20.20.20.2" class="ltx_td ltx_align_center ltx_border_t">75.69<math id="S5.T1.20.20.20.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.20.20.20.2.m1.1a"><mo id="S5.T1.20.20.20.2.m1.1.1" xref="S5.T1.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T1.20.20.20.2.m1.1.1.cmml" xref="S5.T1.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.20.20.20.2.m1.1c">\pm</annotation></semantics></math>0.81</td>
<td id="S5.T1.21.21.21.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">74.44<math id="S5.T1.21.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.21.21.21.3.m1.1a"><mo id="S5.T1.21.21.21.3.m1.1.1" xref="S5.T1.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T1.21.21.21.3.m1.1.1.cmml" xref="S5.T1.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.21.21.21.3.m1.1c">\pm</annotation></semantics></math>0.95</td>
<td id="S5.T1.22.22.22.4" class="ltx_td ltx_align_center ltx_border_t">74.26<math id="S5.T1.22.22.22.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.22.22.22.4.m1.1a"><mo id="S5.T1.22.22.22.4.m1.1.1" xref="S5.T1.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T1.22.22.22.4.m1.1.1.cmml" xref="S5.T1.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.22.22.22.4.m1.1c">\pm</annotation></semantics></math>1.69</td>
<td id="S5.T1.23.23.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">72.87<math id="S5.T1.23.23.23.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.23.23.23.5.m1.1a"><mo id="S5.T1.23.23.23.5.m1.1.1" xref="S5.T1.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S5.T1.23.23.23.5.m1.1.1.cmml" xref="S5.T1.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.23.23.23.5.m1.1c">\pm</annotation></semantics></math>0.69</td>
<td id="S5.T1.23.23.23.7" class="ltx_td ltx_align_center ltx_border_t">74.33</td>
</tr>
<tr id="S5.T1.28.28.28" class="ltx_tr">
<td id="S5.T1.28.28.28.6" class="ltx_td ltx_align_left ltx_border_r">+ PA</td>
<td id="S5.T1.24.24.24.1" class="ltx_td ltx_align_center">84.55<math id="S5.T1.24.24.24.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.24.24.24.1.m1.1a"><mo id="S5.T1.24.24.24.1.m1.1.1" xref="S5.T1.24.24.24.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.24.24.24.1.m1.1b"><csymbol cd="latexml" id="S5.T1.24.24.24.1.m1.1.1.cmml" xref="S5.T1.24.24.24.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.24.24.24.1.m1.1c">\pm</annotation></semantics></math>0.69</td>
<td id="S5.T1.25.25.25.2" class="ltx_td ltx_align_center">83.87<math id="S5.T1.25.25.25.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.25.25.25.2.m1.1a"><mo id="S5.T1.25.25.25.2.m1.1.1" xref="S5.T1.25.25.25.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.25.25.25.2.m1.1b"><csymbol cd="latexml" id="S5.T1.25.25.25.2.m1.1.1.cmml" xref="S5.T1.25.25.25.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.25.25.25.2.m1.1c">\pm</annotation></semantics></math>1.25</td>
<td id="S5.T1.26.26.26.3" class="ltx_td ltx_align_center ltx_border_r">82.33<math id="S5.T1.26.26.26.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.26.26.26.3.m1.1a"><mo id="S5.T1.26.26.26.3.m1.1.1" xref="S5.T1.26.26.26.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.26.26.26.3.m1.1b"><csymbol cd="latexml" id="S5.T1.26.26.26.3.m1.1.1.cmml" xref="S5.T1.26.26.26.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.26.26.26.3.m1.1c">\pm</annotation></semantics></math>1.24</td>
<td id="S5.T1.27.27.27.4" class="ltx_td ltx_align_center">82.49<math id="S5.T1.27.27.27.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.27.27.27.4.m1.1a"><mo id="S5.T1.27.27.27.4.m1.1.1" xref="S5.T1.27.27.27.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.27.27.27.4.m1.1b"><csymbol cd="latexml" id="S5.T1.27.27.27.4.m1.1.1.cmml" xref="S5.T1.27.27.27.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.27.27.27.4.m1.1c">\pm</annotation></semantics></math>1.88</td>
<td id="S5.T1.28.28.28.5" class="ltx_td ltx_align_center ltx_border_r">81.54<math id="S5.T1.28.28.28.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.28.28.28.5.m1.1a"><mo id="S5.T1.28.28.28.5.m1.1.1" xref="S5.T1.28.28.28.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.28.28.28.5.m1.1b"><csymbol cd="latexml" id="S5.T1.28.28.28.5.m1.1.1.cmml" xref="S5.T1.28.28.28.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.28.28.28.5.m1.1c">\pm</annotation></semantics></math>0.78</td>
<td id="S5.T1.28.28.28.7" class="ltx_td ltx_align_center"><span id="S5.T1.28.28.28.7.1" class="ltx_text ltx_font_bold">95.63</span></td>
</tr>
<tr id="S5.T1.33.33.33" class="ltx_tr">
<td id="S5.T1.33.33.33.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Accumulator</td>
<td id="S5.T1.29.29.29.1" class="ltx_td ltx_align_center ltx_border_t">84.90<math id="S5.T1.29.29.29.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.29.29.29.1.m1.1a"><mo id="S5.T1.29.29.29.1.m1.1.1" xref="S5.T1.29.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.29.29.29.1.m1.1b"><csymbol cd="latexml" id="S5.T1.29.29.29.1.m1.1.1.cmml" xref="S5.T1.29.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.29.29.29.1.m1.1c">\pm</annotation></semantics></math>0.75</td>
<td id="S5.T1.30.30.30.2" class="ltx_td ltx_align_center ltx_border_t">84.34<math id="S5.T1.30.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.30.30.30.2.m1.1a"><mo id="S5.T1.30.30.30.2.m1.1.1" xref="S5.T1.30.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.30.30.30.2.m1.1b"><csymbol cd="latexml" id="S5.T1.30.30.30.2.m1.1.1.cmml" xref="S5.T1.30.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.30.30.30.2.m1.1c">\pm</annotation></semantics></math>1.33</td>
<td id="S5.T1.31.31.31.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">83.31<math id="S5.T1.31.31.31.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.31.31.31.3.m1.1a"><mo id="S5.T1.31.31.31.3.m1.1.1" xref="S5.T1.31.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.31.31.31.3.m1.1b"><csymbol cd="latexml" id="S5.T1.31.31.31.3.m1.1.1.cmml" xref="S5.T1.31.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.31.31.31.3.m1.1c">\pm</annotation></semantics></math>1.54</td>
<td id="S5.T1.32.32.32.4" class="ltx_td ltx_align_center ltx_border_t">79.12<math id="S5.T1.32.32.32.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.32.32.32.4.m1.1a"><mo id="S5.T1.32.32.32.4.m1.1.1" xref="S5.T1.32.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.32.32.32.4.m1.1b"><csymbol cd="latexml" id="S5.T1.32.32.32.4.m1.1.1.cmml" xref="S5.T1.32.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.32.32.32.4.m1.1c">\pm</annotation></semantics></math>1.64</td>
<td id="S5.T1.33.33.33.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">78.05<math id="S5.T1.33.33.33.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.33.33.33.5.m1.1a"><mo id="S5.T1.33.33.33.5.m1.1.1" xref="S5.T1.33.33.33.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.33.33.33.5.m1.1b"><csymbol cd="latexml" id="S5.T1.33.33.33.5.m1.1.1.cmml" xref="S5.T1.33.33.33.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.33.33.33.5.m1.1c">\pm</annotation></semantics></math>0.75</td>
<td id="S5.T1.33.33.33.7" class="ltx_td ltx_align_center ltx_border_t">93.24</td>
</tr>
<tr id="S5.T1.38.38.38" class="ltx_tr">
<td id="S5.T1.38.38.38.6" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">+ PA</td>
<td id="S5.T1.34.34.34.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.34.34.34.1.1" class="ltx_text ltx_font_bold">85.35<math id="S5.T1.34.34.34.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.34.34.34.1.1.m1.1a"><mo id="S5.T1.34.34.34.1.1.m1.1.1" xref="S5.T1.34.34.34.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.34.34.34.1.1.m1.1b"><csymbol cd="latexml" id="S5.T1.34.34.34.1.1.m1.1.1.cmml" xref="S5.T1.34.34.34.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.34.34.34.1.1.m1.1c">\pm</annotation></semantics></math></span>0.49</td>
<td id="S5.T1.35.35.35.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.35.35.35.2.1" class="ltx_text ltx_font_bold">85.11<math id="S5.T1.35.35.35.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.35.35.35.2.1.m1.1a"><mo id="S5.T1.35.35.35.2.1.m1.1.1" xref="S5.T1.35.35.35.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.35.35.35.2.1.m1.1b"><csymbol cd="latexml" id="S5.T1.35.35.35.2.1.m1.1.1.cmml" xref="S5.T1.35.35.35.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.35.35.35.2.1.m1.1c">\pm</annotation></semantics></math></span>1.28</td>
<td id="S5.T1.36.36.36.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T1.36.36.36.3.1" class="ltx_text ltx_font_bold">84.02<math id="S5.T1.36.36.36.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.36.36.36.3.1.m1.1a"><mo id="S5.T1.36.36.36.3.1.m1.1.1" xref="S5.T1.36.36.36.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.36.36.36.3.1.m1.1b"><csymbol cd="latexml" id="S5.T1.36.36.36.3.1.m1.1.1.cmml" xref="S5.T1.36.36.36.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.36.36.36.3.1.m1.1c">\pm</annotation></semantics></math></span>1.32</td>
<td id="S5.T1.37.37.37.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T1.37.37.37.4.1" class="ltx_text ltx_font_bold">83.68<math id="S5.T1.37.37.37.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.37.37.37.4.1.m1.1a"><mo id="S5.T1.37.37.37.4.1.m1.1.1" xref="S5.T1.37.37.37.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.37.37.37.4.1.m1.1b"><csymbol cd="latexml" id="S5.T1.37.37.37.4.1.m1.1.1.cmml" xref="S5.T1.37.37.37.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.37.37.37.4.1.m1.1c">\pm</annotation></semantics></math></span>1.75</td>
<td id="S5.T1.38.38.38.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T1.38.38.38.5.1" class="ltx_text ltx_font_bold">82.24<math id="S5.T1.38.38.38.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T1.38.38.38.5.1.m1.1a"><mo id="S5.T1.38.38.38.5.1.m1.1.1" xref="S5.T1.38.38.38.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T1.38.38.38.5.1.m1.1b"><csymbol cd="latexml" id="S5.T1.38.38.38.5.1.m1.1.1.cmml" xref="S5.T1.38.38.38.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.38.38.38.5.1.m1.1c">\pm</annotation></semantics></math></span>0.84</td>
<td id="S5.T1.38.38.38.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.38.38.38.7.1" class="ltx_text ltx_font_bold">95.27</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Anytime FL performance.
</figcaption>
<div id="S5.T2.38" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:386.9pt;height:130.4pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.4pt,16.2pt) scale(0.8,0.8) ;">
<table id="S5.T2.38.38" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.38.38.39.1" class="ltx_tr">
<td id="S5.T2.38.38.39.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2">
<span id="S5.T2.38.38.39.1.1.1" class="ltx_text">Method</span><span class="ltx_rule" style="width:0.0pt;height:5.2pt;background:black;display:inline-block;"></span>
</td>
<td id="S5.T2.38.38.39.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3">CIFAR100</td>
<td id="S5.T2.38.38.39.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2">FEMNIST</td>
<td id="S5.T2.38.38.39.1.4" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T2.38.38.39.1.4.1" class="ltx_text">SpeechCmdV2</span></td>
</tr>
<tr id="S5.T2.3.3.3" class="ltx_tr">
<td id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">IID (<math id="S5.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="1000.0" display="inline"><semantics id="S5.T2.1.1.1.1.m1.1a"><mn id="S5.T2.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.m1.1.1.cmml">1000.0</mn><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.m1.1b"><cn type="float" id="S5.T2.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.m1.1.1">1000.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.m1.1c">1000.0</annotation></semantics></math>)</td>
<td id="S5.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Non-IID (<math id="S5.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.T2.2.2.2.2.m1.1a"><mn id="S5.T2.2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.m1.1b"><cn type="float" id="S5.T2.2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.m1.1c">1.0</annotation></semantics></math>)</td>
<td id="S5.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID (<math id="S5.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.T2.3.3.3.3.m1.1a"><mn id="S5.T2.3.3.3.3.m1.1.1" xref="S5.T2.3.3.3.3.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.m1.1b"><cn type="float" id="S5.T2.3.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.3.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.m1.1c">0.1</annotation></semantics></math>)</td>
<td id="S5.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S5.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
</tr>
<tr id="S5.T2.8.8.8" class="ltx_tr">
<td id="S5.T2.8.8.8.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Fine-tuning</td>
<td id="S5.T2.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.4.4.4.1.1" class="ltx_text" style="color:#808080;">67.24<math id="S5.T2.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.4.4.4.1.1.m1.1a"><mo mathcolor="#808080" id="S5.T2.4.4.4.1.1.m1.1.1" xref="S5.T2.4.4.4.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.1.1.m1.1.1.cmml" xref="S5.T2.4.4.4.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.1.1.m1.1c">\pm</annotation></semantics></math>1.13</span></td>
<td id="S5.T2.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.5.5.5.2.1" class="ltx_text" style="color:#808080;">66.95<math id="S5.T2.5.5.5.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.5.5.5.2.1.m1.1a"><mo mathcolor="#808080" id="S5.T2.5.5.5.2.1.m1.1.1" xref="S5.T2.5.5.5.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.5.2.1.m1.1.1.cmml" xref="S5.T2.5.5.5.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.2.1.m1.1c">\pm</annotation></semantics></math>1.93</span></td>
<td id="S5.T2.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.6.6.6.3.1" class="ltx_text" style="color:#808080;">60.05<math id="S5.T2.6.6.6.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.6.6.6.3.1.m1.1a"><mo mathcolor="#808080" id="S5.T2.6.6.6.3.1.m1.1.1" xref="S5.T2.6.6.6.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.3.1.m1.1b"><csymbol cd="latexml" id="S5.T2.6.6.6.3.1.m1.1.1.cmml" xref="S5.T2.6.6.6.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.3.1.m1.1c">\pm</annotation></semantics></math>2.51</span></td>
<td id="S5.T2.7.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.7.7.7.4.1" class="ltx_text" style="color:#808080;">76.43<math id="S5.T2.7.7.7.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.7.7.7.4.1.m1.1a"><mo mathcolor="#808080" id="S5.T2.7.7.7.4.1.m1.1.1" xref="S5.T2.7.7.7.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.4.1.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.7.4.1.m1.1.1.cmml" xref="S5.T2.7.7.7.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.4.1.m1.1c">\pm</annotation></semantics></math>1.45</span></td>
<td id="S5.T2.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.8.8.8.5.1" class="ltx_text" style="color:#808080;">75.82<math id="S5.T2.8.8.8.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.8.8.8.5.1.m1.1a"><mo mathcolor="#808080" id="S5.T2.8.8.8.5.1.m1.1.1" xref="S5.T2.8.8.8.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.8.8.8.5.1.m1.1.1.cmml" xref="S5.T2.8.8.8.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.5.1.m1.1c">\pm</annotation></semantics></math>2.42</span></td>
<td id="S5.T2.8.8.8.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.8.8.8.7.1" class="ltx_text" style="color:#808080;">93.71</span></td>
</tr>
<tr id="S5.T2.13.13.13" class="ltx_tr">
<td id="S5.T2.13.13.13.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">L.W. Linear</td>
<td id="S5.T2.9.9.9.1" class="ltx_td ltx_align_center ltx_border_t">36.42<math id="S5.T2.9.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.9.9.1.m1.1a"><mo id="S5.T2.9.9.9.1.m1.1.1" xref="S5.T2.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.9.1.m1.1c">\pm</annotation></semantics></math>0.80</td>
<td id="S5.T2.10.10.10.2" class="ltx_td ltx_align_center ltx_border_t">36.06<math id="S5.T2.10.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.10.10.10.2.m1.1a"><mo id="S5.T2.10.10.10.2.m1.1.1" xref="S5.T2.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T2.10.10.10.2.m1.1.1.cmml" xref="S5.T2.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.10.2.m1.1c">\pm</annotation></semantics></math>1.35</td>
<td id="S5.T2.11.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">34.00<math id="S5.T2.11.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.11.11.11.3.m1.1a"><mo id="S5.T2.11.11.11.3.m1.1.1" xref="S5.T2.11.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.11.3.m1.1b"><csymbol cd="latexml" id="S5.T2.11.11.11.3.m1.1.1.cmml" xref="S5.T2.11.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.11.3.m1.1c">\pm</annotation></semantics></math>1.77</td>
<td id="S5.T2.12.12.12.4" class="ltx_td ltx_align_center ltx_border_t">35.92<math id="S5.T2.12.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.12.12.12.4.m1.1a"><mo id="S5.T2.12.12.12.4.m1.1.1" xref="S5.T2.12.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.12.4.m1.1b"><csymbol cd="latexml" id="S5.T2.12.12.12.4.m1.1.1.cmml" xref="S5.T2.12.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.12.4.m1.1c">\pm</annotation></semantics></math>1.23</td>
<td id="S5.T2.13.13.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.49<math id="S5.T2.13.13.13.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.13.13.13.5.m1.1a"><mo id="S5.T2.13.13.13.5.m1.1.1" xref="S5.T2.13.13.13.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.13.5.m1.1b"><csymbol cd="latexml" id="S5.T2.13.13.13.5.m1.1.1.cmml" xref="S5.T2.13.13.13.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.13.5.m1.1c">\pm</annotation></semantics></math>1.74</td>
<td id="S5.T2.13.13.13.7" class="ltx_td ltx_align_center ltx_border_t">65.10</td>
</tr>
<tr id="S5.T2.18.18.18" class="ltx_tr">
<td id="S5.T2.18.18.18.6" class="ltx_td ltx_align_left ltx_border_r">+ PA</td>
<td id="S5.T2.14.14.14.1" class="ltx_td ltx_align_center">47.33<math id="S5.T2.14.14.14.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.14.14.14.1.m1.1a"><mo id="S5.T2.14.14.14.1.m1.1.1" xref="S5.T2.14.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.14.1.m1.1b"><csymbol cd="latexml" id="S5.T2.14.14.14.1.m1.1.1.cmml" xref="S5.T2.14.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.14.1.m1.1c">\pm</annotation></semantics></math>0.95</td>
<td id="S5.T2.15.15.15.2" class="ltx_td ltx_align_center">47.94<math id="S5.T2.15.15.15.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.15.15.15.2.m1.1a"><mo id="S5.T2.15.15.15.2.m1.1.1" xref="S5.T2.15.15.15.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.15.2.m1.1b"><csymbol cd="latexml" id="S5.T2.15.15.15.2.m1.1.1.cmml" xref="S5.T2.15.15.15.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.15.2.m1.1c">\pm</annotation></semantics></math>1.53</td>
<td id="S5.T2.16.16.16.3" class="ltx_td ltx_align_center ltx_border_r">47.11<math id="S5.T2.16.16.16.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.16.16.16.3.m1.1a"><mo id="S5.T2.16.16.16.3.m1.1.1" xref="S5.T2.16.16.16.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.3.m1.1b"><csymbol cd="latexml" id="S5.T2.16.16.16.3.m1.1.1.cmml" xref="S5.T2.16.16.16.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.16.3.m1.1c">\pm</annotation></semantics></math>1.92</td>
<td id="S5.T2.17.17.17.4" class="ltx_td ltx_align_center">57.36<math id="S5.T2.17.17.17.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.17.17.17.4.m1.1a"><mo id="S5.T2.17.17.17.4.m1.1.1" xref="S5.T2.17.17.17.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.4.m1.1b"><csymbol cd="latexml" id="S5.T2.17.17.17.4.m1.1.1.cmml" xref="S5.T2.17.17.17.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.17.4.m1.1c">\pm</annotation></semantics></math>1.45</td>
<td id="S5.T2.18.18.18.5" class="ltx_td ltx_align_center ltx_border_r">56.78<math id="S5.T2.18.18.18.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.18.18.18.5.m1.1a"><mo id="S5.T2.18.18.18.5.m1.1.1" xref="S5.T2.18.18.18.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.18.5.m1.1b"><csymbol cd="latexml" id="S5.T2.18.18.18.5.m1.1.1.cmml" xref="S5.T2.18.18.18.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.18.5.m1.1c">\pm</annotation></semantics></math>1.89</td>
<td id="S5.T2.18.18.18.7" class="ltx_td ltx_align_center">84.16</td>
</tr>
<tr id="S5.T2.23.23.23" class="ltx_tr">
<td id="S5.T2.23.23.23.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">L.W. MLP</td>
<td id="S5.T2.19.19.19.1" class="ltx_td ltx_align_center ltx_border_t">37.62<math id="S5.T2.19.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.19.19.19.1.m1.1a"><mo id="S5.T2.19.19.19.1.m1.1.1" xref="S5.T2.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T2.19.19.19.1.m1.1.1.cmml" xref="S5.T2.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.19.19.1.m1.1c">\pm</annotation></semantics></math>0.76</td>
<td id="S5.T2.20.20.20.2" class="ltx_td ltx_align_center ltx_border_t">37.84<math id="S5.T2.20.20.20.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.20.20.20.2.m1.1a"><mo id="S5.T2.20.20.20.2.m1.1.1" xref="S5.T2.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T2.20.20.20.2.m1.1.1.cmml" xref="S5.T2.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.20.20.2.m1.1c">\pm</annotation></semantics></math>0.98</td>
<td id="S5.T2.21.21.21.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.22<math id="S5.T2.21.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.21.21.21.3.m1.1a"><mo id="S5.T2.21.21.21.3.m1.1.1" xref="S5.T2.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T2.21.21.21.3.m1.1.1.cmml" xref="S5.T2.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.21.21.3.m1.1c">\pm</annotation></semantics></math>1.34</td>
<td id="S5.T2.22.22.22.4" class="ltx_td ltx_align_center ltx_border_t">35.27<math id="S5.T2.22.22.22.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.22.22.22.4.m1.1a"><mo id="S5.T2.22.22.22.4.m1.1.1" xref="S5.T2.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T2.22.22.22.4.m1.1.1.cmml" xref="S5.T2.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.22.22.4.m1.1c">\pm</annotation></semantics></math>1.29</td>
<td id="S5.T2.23.23.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">34.54<math id="S5.T2.23.23.23.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.23.23.23.5.m1.1a"><mo id="S5.T2.23.23.23.5.m1.1.1" xref="S5.T2.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S5.T2.23.23.23.5.m1.1.1.cmml" xref="S5.T2.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.23.23.5.m1.1c">\pm</annotation></semantics></math>1.78</td>
<td id="S5.T2.23.23.23.7" class="ltx_td ltx_align_center ltx_border_t">64.57</td>
</tr>
<tr id="S5.T2.28.28.28" class="ltx_tr">
<td id="S5.T2.28.28.28.6" class="ltx_td ltx_align_left ltx_border_r">+ PA</td>
<td id="S5.T2.24.24.24.1" class="ltx_td ltx_align_center">48.65<math id="S5.T2.24.24.24.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.24.24.24.1.m1.1a"><mo id="S5.T2.24.24.24.1.m1.1.1" xref="S5.T2.24.24.24.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.24.24.24.1.m1.1b"><csymbol cd="latexml" id="S5.T2.24.24.24.1.m1.1.1.cmml" xref="S5.T2.24.24.24.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.24.24.1.m1.1c">\pm</annotation></semantics></math>0.89</td>
<td id="S5.T2.25.25.25.2" class="ltx_td ltx_align_center">48.39<math id="S5.T2.25.25.25.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.25.25.25.2.m1.1a"><mo id="S5.T2.25.25.25.2.m1.1.1" xref="S5.T2.25.25.25.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.25.25.25.2.m1.1b"><csymbol cd="latexml" id="S5.T2.25.25.25.2.m1.1.1.cmml" xref="S5.T2.25.25.25.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.25.25.25.2.m1.1c">\pm</annotation></semantics></math>1.02</td>
<td id="S5.T2.26.26.26.3" class="ltx_td ltx_align_center ltx_border_r">47.94<math id="S5.T2.26.26.26.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.26.26.26.3.m1.1a"><mo id="S5.T2.26.26.26.3.m1.1.1" xref="S5.T2.26.26.26.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.26.26.26.3.m1.1b"><csymbol cd="latexml" id="S5.T2.26.26.26.3.m1.1.1.cmml" xref="S5.T2.26.26.26.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.26.26.26.3.m1.1c">\pm</annotation></semantics></math>1.21</td>
<td id="S5.T2.27.27.27.4" class="ltx_td ltx_align_center">55.21<math id="S5.T2.27.27.27.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.27.27.27.4.m1.1a"><mo id="S5.T2.27.27.27.4.m1.1.1" xref="S5.T2.27.27.27.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.27.27.27.4.m1.1b"><csymbol cd="latexml" id="S5.T2.27.27.27.4.m1.1.1.cmml" xref="S5.T2.27.27.27.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.27.27.27.4.m1.1c">\pm</annotation></semantics></math>1.48</td>
<td id="S5.T2.28.28.28.5" class="ltx_td ltx_align_center ltx_border_r">54.42<math id="S5.T2.28.28.28.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.28.28.28.5.m1.1a"><mo id="S5.T2.28.28.28.5.m1.1.1" xref="S5.T2.28.28.28.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.28.28.28.5.m1.1b"><csymbol cd="latexml" id="S5.T2.28.28.28.5.m1.1.1.cmml" xref="S5.T2.28.28.28.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.28.28.28.5.m1.1c">\pm</annotation></semantics></math>2.01</td>
<td id="S5.T2.28.28.28.7" class="ltx_td ltx_align_center">83.19</td>
</tr>
<tr id="S5.T2.33.33.33" class="ltx_tr">
<td id="S5.T2.33.33.33.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Accumulator</td>
<td id="S5.T2.29.29.29.1" class="ltx_td ltx_align_center ltx_border_t">64.28<math id="S5.T2.29.29.29.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.29.29.29.1.m1.1a"><mo id="S5.T2.29.29.29.1.m1.1.1" xref="S5.T2.29.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.29.29.29.1.m1.1b"><csymbol cd="latexml" id="S5.T2.29.29.29.1.m1.1.1.cmml" xref="S5.T2.29.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.29.29.29.1.m1.1c">\pm</annotation></semantics></math>1.01</td>
<td id="S5.T2.30.30.30.2" class="ltx_td ltx_align_center ltx_border_t">63.02<math id="S5.T2.30.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.30.30.30.2.m1.1a"><mo id="S5.T2.30.30.30.2.m1.1.1" xref="S5.T2.30.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.30.30.30.2.m1.1b"><csymbol cd="latexml" id="S5.T2.30.30.30.2.m1.1.1.cmml" xref="S5.T2.30.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.30.30.30.2.m1.1c">\pm</annotation></semantics></math>1.79</td>
<td id="S5.T2.31.31.31.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">57.34<math id="S5.T2.31.31.31.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.31.31.31.3.m1.1a"><mo id="S5.T2.31.31.31.3.m1.1.1" xref="S5.T2.31.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.31.31.31.3.m1.1b"><csymbol cd="latexml" id="S5.T2.31.31.31.3.m1.1.1.cmml" xref="S5.T2.31.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.31.31.31.3.m1.1c">\pm</annotation></semantics></math>2.23</td>
<td id="S5.T2.32.32.32.4" class="ltx_td ltx_align_center ltx_border_t">75.47<math id="S5.T2.32.32.32.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.32.32.32.4.m1.1a"><mo id="S5.T2.32.32.32.4.m1.1.1" xref="S5.T2.32.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.32.32.32.4.m1.1b"><csymbol cd="latexml" id="S5.T2.32.32.32.4.m1.1.1.cmml" xref="S5.T2.32.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.32.32.32.4.m1.1c">\pm</annotation></semantics></math>1.41</td>
<td id="S5.T2.33.33.33.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">75.12<math id="S5.T2.33.33.33.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.33.33.33.5.m1.1a"><mo id="S5.T2.33.33.33.5.m1.1.1" xref="S5.T2.33.33.33.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.33.33.33.5.m1.1b"><csymbol cd="latexml" id="S5.T2.33.33.33.5.m1.1.1.cmml" xref="S5.T2.33.33.33.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.33.33.33.5.m1.1c">\pm</annotation></semantics></math>1.86</td>
<td id="S5.T2.33.33.33.7" class="ltx_td ltx_align_center ltx_border_t">84.66</td>
</tr>
<tr id="S5.T2.38.38.38" class="ltx_tr">
<td id="S5.T2.38.38.38.6" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">+ PA</td>
<td id="S5.T2.34.34.34.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.34.34.34.1.1" class="ltx_text ltx_font_bold">65.23<math id="S5.T2.34.34.34.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.34.34.34.1.1.m1.1a"><mo id="S5.T2.34.34.34.1.1.m1.1.1" xref="S5.T2.34.34.34.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.34.34.34.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.34.34.34.1.1.m1.1.1.cmml" xref="S5.T2.34.34.34.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.34.34.34.1.1.m1.1c">\pm</annotation></semantics></math></span>1.26</td>
<td id="S5.T2.35.35.35.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.35.35.35.2.1" class="ltx_text ltx_font_bold">64.28<math id="S5.T2.35.35.35.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.35.35.35.2.1.m1.1a"><mo id="S5.T2.35.35.35.2.1.m1.1.1" xref="S5.T2.35.35.35.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.35.35.35.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.35.35.35.2.1.m1.1.1.cmml" xref="S5.T2.35.35.35.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.35.35.35.2.1.m1.1c">\pm</annotation></semantics></math></span>1.84</td>
<td id="S5.T2.36.36.36.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T2.36.36.36.3.1" class="ltx_text ltx_font_bold">58.40<math id="S5.T2.36.36.36.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.36.36.36.3.1.m1.1a"><mo id="S5.T2.36.36.36.3.1.m1.1.1" xref="S5.T2.36.36.36.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.36.36.36.3.1.m1.1b"><csymbol cd="latexml" id="S5.T2.36.36.36.3.1.m1.1.1.cmml" xref="S5.T2.36.36.36.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.36.36.36.3.1.m1.1c">\pm</annotation></semantics></math></span>1.67</td>
<td id="S5.T2.37.37.37.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.37.37.37.4.1" class="ltx_text ltx_font_bold">76.55<math id="S5.T2.37.37.37.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.37.37.37.4.1.m1.1a"><mo id="S5.T2.37.37.37.4.1.m1.1.1" xref="S5.T2.37.37.37.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.37.37.37.4.1.m1.1b"><csymbol cd="latexml" id="S5.T2.37.37.37.4.1.m1.1.1.cmml" xref="S5.T2.37.37.37.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.37.37.37.4.1.m1.1c">\pm</annotation></semantics></math></span>1.63</td>
<td id="S5.T2.38.38.38.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T2.38.38.38.5.1" class="ltx_text ltx_font_bold">76.03<math id="S5.T2.38.38.38.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.38.38.38.5.1.m1.1a"><mo id="S5.T2.38.38.38.5.1.m1.1.1" xref="S5.T2.38.38.38.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.38.38.38.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.38.38.38.5.1.m1.1.1.cmml" xref="S5.T2.38.38.38.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.38.38.38.5.1.m1.1c">\pm</annotation></semantics></math></span>2.13</td>
<td id="S5.T2.38.38.38.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.38.38.38.7.1" class="ltx_text ltx_font_bold">88.30</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>

<div id="S5.SS1.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px3.p1.1" class="ltx_p">We run all our FL experiments with the FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al., (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> strategy. We compare with all the baselines, namely,
<span id="S5.SS1.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_italic">i</span>) <span id="S5.SS1.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_italic">Fine-tuning</span> <cite class="ltx_cite ltx_citemacro_cite">Qu et al., (<a href="#bib.bib27" title="" class="ltx_ref">2022</a>)</cite>, where the whole pretrained vision transformer is finetuned end-to-end in FL;
<span id="S5.SS1.SSS0.Px3.p1.1.3" class="ltx_text ltx_font_italic">ii</span>) <span id="S5.SS1.SSS0.Px3.p1.1.4" class="ltx_text ltx_font_italic">Layer-wise Linear</span> (L.W. Linear), where we append a learnable linear head after each transformer block<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We also tried with shared linear head among layers, but it achieved worse results.</span></span></span> to be learned by FL, while keeping the rest frozen;
<span id="S5.SS1.SSS0.Px3.p1.1.5" class="ltx_text ltx_font_italic">iii</span>) <span id="S5.SS1.SSS0.Px3.p1.1.6" class="ltx_text ltx_font_italic">Layer-wise MLP</span> (L.W. MLP), where we append a two-layer MLP with GELU and Random Dropout after each transformer block, with the rest frozen.
<span id="S5.SS1.SSS0.Px3.p1.1.7" class="ltx_text ltx_font_italic">iv</span>) Our <span id="S5.SS1.SSS0.Px3.p1.1.8" class="ltx_text ltx_font_italic">Accumulator</span>, where we append one shared Accumulator and one shared MLP into each transformer block, with the rest frozen.
We also compare the variants of L.W. Linear, MLP, and Accumulator with Parallel Adapters (PA), as proposed in <cite class="ltx_cite ltx_citemacro_cite">He et al., (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>, injected into the feed-forward MLP networks of the pretrained Transformer as their efficient and effective adaptation <cite class="ltx_cite ltx_citemacro_cite">He et al., (<a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
</section>
<section id="S5.SS1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluation Settings.</h4>

<div id="S5.SS1.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px4.p1.1" class="ltx_p">We evaluate all the methods in four different settings, including (1) <em id="S5.SS1.SSS0.Px4.p1.1.1" class="ltx_emph ltx_font_italic">Conventional FL</em> – Clients train the local models by using only the final exit of a pretrained transformer, and the trained global model will be evaluated at a test set using only the final exit.
(2) <em id="S5.SS1.SSS0.Px4.p1.1.2" class="ltx_emph ltx_font_italic">Anytime FL</em> – Clients train the local models by using a random exit at each iteration, and the trained global model will be tested at each exit.
(3) <em id="S5.SS1.SSS0.Px4.p1.1.3" class="ltx_emph ltx_font_italic">multi-tier FL</em> – Clients train the local models by using a specific early exit determined by the tier of each client. The trained global model will be tested at each exit,
and (4) Personalization, where the FL-trained model from setting (3) will be further finetuned using the local data in each client.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Experimental Results</h3>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Conventional Federated Learning.</h4>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p1.1" class="ltx_p">Results in Table <a href="#S5.T1" title="Table 1 ‣ Early Exits. ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> show the comparison between all competitors. The results show that fine-tuning works the best among all methods. This is unsurprising, as it has access to the large combined dataset of all clients and can use this to tune the whole model, but it incurs the most local training and communication costs. Among the other competitors, we can see that our Accumulator achieves the best results already when used alone. Parallel adapters are quite effective in enabling federated adaptation of the pretrained Transfomer, boosting the performance of base methods L.W. Linear and MLP significantly in all settings, especially on SpeechCmdv2. Nevertheless, our Accumulator is complementary with parallel adapters, achieving the best result in all cases, with some results even surpassing the Fine-tuning method, such as on CIFAR-100 with IID and Non-IID (1.0). The results demonstrate the efficacy of our proposed Accumulator to adapt a pretrained Transformer model into FL at anywhere under any type of data heterogeneity.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Anytime Federated Learning.</h4>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p1.1" class="ltx_p">In this setting, we will consider the early exit situations. For each layer of a pretrained DeiT, we train an early exit, such as a linear head, an MLP head and our Accumulator. At each local training iteration, an exit layer index <math id="S5.SS2.SSS0.Px2.p1.1.m1.3" class="ltx_Math" alttext="l\in[0,\cdots,11]" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.3a"><mrow id="S5.SS2.SSS0.Px2.p1.1.m1.3.4" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.cmml"><mi id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.2.cmml">l</mi><mo id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">[</mo><mn id="S5.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">0</mn><mo id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S5.SS2.SSS0.Px2.p1.1.m1.2.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.2.2.cmml">⋯</mi><mo id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.3" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S5.SS2.SSS0.Px2.p1.1.m1.3.3" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.3.cmml">11</mn><mo stretchy="false" id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.2.4" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.1.m1.3b"><apply id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4"><in id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.1"></in><ci id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.2">𝑙</ci><list id="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.4.3.2"><cn type="integer" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1">0</cn><ci id="S5.SS2.SSS0.Px2.p1.1.m1.2.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.2.2">⋯</ci><cn type="integer" id="S5.SS2.SSS0.Px2.p1.1.m1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.3.3">11</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.3c">l\in[0,\cdots,11]</annotation></semantics></math> will be sampled randomly, and only that exit (and accumulator where relevant) will be trained. For fine-tuning, we append the layer-wise MLP heads and train all parameters during the FL training. After training, the global model will be evaluated on the test set at all exits. The results in Table <a href="#S5.T2" title="Table 2 ‣ Early Exits. ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Figure <a href="#S5.F3" title="Figure 3 ‣ Multi-tier based Federated Learning. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> <span id="S5.SS2.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">top</span> show the average and budget-wise performance over all exits. Without surprise, we can see that global fine-tuning achieves the best at substantial comms cost. Among the more efficient competitors, we can see that our Accumulator outperforms L.W. Linear and MLP significantly when no extra adapters are used. With parallel adapters, all methods enjoy a performance boost, leading our Accumulator to the best performance in all cases, outperforming fine-tuning in a few situations.</p>
</div>
</section>
<section id="S5.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Multi-tier based Federated Learning.</h4>

<div id="S5.SS2.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px3.p1.1" class="ltx_p">More realistically, there is a certain level of system heterogeneity among client devices. Individual devices in FL training have a certain level of computing capability and their associated early exit should be persistently fixed in both training and testing. Results in the setting are evaluated and reported in Table <a href="#S5.T3" title="Table 3 ‣ Multi-tier based Federated Learning. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, where we can see that most results dropped to some extent compared with Table <a href="#S5.T2" title="Table 2 ‣ Early Exits. ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. This is expected due to the existence of system heterogeneity among clients. And most observations in Table <a href="#S5.T3" title="Table 3 ‣ Multi-tier based Federated Learning. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> are similar to the previous tables. One interesting observation is that in this harder scenario, our Accumulator outperforms the fine-tuning baseline consistently in all situations in CIFAR-100. Figure <a href="#S5.F3" title="Figure 3 ‣ Multi-tier based Federated Learning. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> <span id="S5.SS2.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_italic">bottom</span> shows the corresponding results for clients of different tiers on CIFAR-100 after training by different algorithms. The accumulator+adapter architecture performs most favourably. This again shows our Accumulator works for anytime inference in a harder and more practical scenario. We also provide communication efficency in Appendix <a href="#A2" title="Appendix B Additional Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2212.04084/assets/figs/LW_acc.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="286" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
Test accuracy of each exit trained on CIFAR-100 with anytime federated learning (Top) and multi-tier constraint (Bottom).
The memory and FLOPs cost of each exit is given in Table <a href="#A2.T7" title="Table 7 ‣ Communication Cost of Different Methods. ‣ Appendix B Additional Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.
</figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Multi-tier based FL performance.</figcaption>
<div id="S5.T3.38" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:386.9pt;height:130.4pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-48.4pt,16.2pt) scale(0.8,0.8) ;">
<table id="S5.T3.38.38" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.38.38.39.1" class="ltx_tr">
<td id="S5.T3.38.38.39.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" rowspan="2">
<span id="S5.T3.38.38.39.1.1.1" class="ltx_text">Method</span><span class="ltx_rule" style="width:0.0pt;height:5.2pt;background:black;display:inline-block;"></span>
</td>
<td id="S5.T3.38.38.39.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">CIFAR100</td>
<td id="S5.T3.38.38.39.1.3" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" colspan="2">FEMNIST</td>
<td id="S5.T3.38.38.39.1.4" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S5.T3.38.38.39.1.4.1" class="ltx_text">SpeechCmdV2</span></td>
</tr>
<tr id="S5.T3.3.3.3" class="ltx_tr">
<td id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">IID (<math id="S5.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="1000.0" display="inline"><semantics id="S5.T3.1.1.1.1.m1.1a"><mn id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml">1000.0</mn><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><cn type="float" id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">1000.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">1000.0</annotation></semantics></math>)</td>
<td id="S5.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Non-IID (<math id="S5.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.T3.2.2.2.2.m1.1a"><mn id="S5.T3.2.2.2.2.m1.1.1" xref="S5.T3.2.2.2.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.2.m1.1b"><cn type="float" id="S5.T3.2.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.2.m1.1c">1.0</annotation></semantics></math>)</td>
<td id="S5.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID (<math id="S5.T3.3.3.3.3.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.T3.3.3.3.3.m1.1a"><mn id="S5.T3.3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.3.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.3.m1.1b"><cn type="float" id="S5.T3.3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.3.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.3.m1.1c">0.1</annotation></semantics></math>)</td>
<td id="S5.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">IID</td>
<td id="S5.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID</td>
</tr>
<tr id="S5.T3.8.8.8" class="ltx_tr">
<td id="S5.T3.8.8.8.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Fine-tuning</td>
<td id="S5.T3.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.4.4.4.1.1" class="ltx_text" style="color:#808080;">58.17<math id="S5.T3.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.4.4.4.1.1.m1.1a"><mo mathcolor="#808080" id="S5.T3.4.4.4.1.1.m1.1.1" xref="S5.T3.4.4.4.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S5.T3.4.4.4.1.1.m1.1.1.cmml" xref="S5.T3.4.4.4.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.1.1.m1.1c">\pm</annotation></semantics></math>0.52</span></td>
<td id="S5.T3.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.5.5.5.2.1" class="ltx_text" style="color:#808080;">56.70<math id="S5.T3.5.5.5.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.5.5.5.2.1.m1.1a"><mo mathcolor="#808080" id="S5.T3.5.5.5.2.1.m1.1.1" xref="S5.T3.5.5.5.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.2.1.m1.1b"><csymbol cd="latexml" id="S5.T3.5.5.5.2.1.m1.1.1.cmml" xref="S5.T3.5.5.5.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.2.1.m1.1c">\pm</annotation></semantics></math>0.83</span></td>
<td id="S5.T3.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.6.6.6.3.1" class="ltx_text" style="color:#808080;">42.47<math id="S5.T3.6.6.6.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.6.6.6.3.1.m1.1a"><mo mathcolor="#808080" id="S5.T3.6.6.6.3.1.m1.1.1" xref="S5.T3.6.6.6.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.3.1.m1.1b"><csymbol cd="latexml" id="S5.T3.6.6.6.3.1.m1.1.1.cmml" xref="S5.T3.6.6.6.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.6.3.1.m1.1c">\pm</annotation></semantics></math>1.41</span></td>
<td id="S5.T3.7.7.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.7.7.7.4.1" class="ltx_text" style="color:#808080;">74.79<math id="S5.T3.7.7.7.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.7.7.7.4.1.m1.1a"><mo mathcolor="#808080" id="S5.T3.7.7.7.4.1.m1.1.1" xref="S5.T3.7.7.7.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.4.1.m1.1b"><csymbol cd="latexml" id="S5.T3.7.7.7.4.1.m1.1.1.cmml" xref="S5.T3.7.7.7.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.7.4.1.m1.1c">\pm</annotation></semantics></math>0.75</span></td>
<td id="S5.T3.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.8.8.8.5.1" class="ltx_text" style="color:#808080;">74.36<math id="S5.T3.8.8.8.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.8.8.8.5.1.m1.1a"><mo mathcolor="#808080" id="S5.T3.8.8.8.5.1.m1.1.1" xref="S5.T3.8.8.8.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.5.1.m1.1b"><csymbol cd="latexml" id="S5.T3.8.8.8.5.1.m1.1.1.cmml" xref="S5.T3.8.8.8.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.8.5.1.m1.1c">\pm</annotation></semantics></math>1.36</span></td>
<td id="S5.T3.8.8.8.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.8.8.8.7.1" class="ltx_text" style="color:#808080;">93.03</span></td>
</tr>
<tr id="S5.T3.13.13.13" class="ltx_tr">
<td id="S5.T3.13.13.13.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">L.W. Linear</td>
<td id="S5.T3.9.9.9.1" class="ltx_td ltx_align_center ltx_border_t">32.43<math id="S5.T3.9.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.9.9.9.1.m1.1a"><mo id="S5.T3.9.9.9.1.m1.1.1" xref="S5.T3.9.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.9.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T3.9.9.9.1.m1.1.1.cmml" xref="S5.T3.9.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.9.9.1.m1.1c">\pm</annotation></semantics></math>0.34</td>
<td id="S5.T3.10.10.10.2" class="ltx_td ltx_align_center ltx_border_t">30.98<math id="S5.T3.10.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.10.10.10.2.m1.1a"><mo id="S5.T3.10.10.10.2.m1.1.1" xref="S5.T3.10.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.10.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T3.10.10.10.2.m1.1.1.cmml" xref="S5.T3.10.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.10.10.2.m1.1c">\pm</annotation></semantics></math>0.60</td>
<td id="S5.T3.11.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21.33<math id="S5.T3.11.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.11.11.11.3.m1.1a"><mo id="S5.T3.11.11.11.3.m1.1.1" xref="S5.T3.11.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.11.11.11.3.m1.1b"><csymbol cd="latexml" id="S5.T3.11.11.11.3.m1.1.1.cmml" xref="S5.T3.11.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.11.11.3.m1.1c">\pm</annotation></semantics></math>0.97</td>
<td id="S5.T3.12.12.12.4" class="ltx_td ltx_align_center ltx_border_t">35.68<math id="S5.T3.12.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.12.12.12.4.m1.1a"><mo id="S5.T3.12.12.12.4.m1.1.1" xref="S5.T3.12.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.12.12.12.4.m1.1b"><csymbol cd="latexml" id="S5.T3.12.12.12.4.m1.1.1.cmml" xref="S5.T3.12.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.12.12.4.m1.1c">\pm</annotation></semantics></math>0.54</td>
<td id="S5.T3.13.13.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.17<math id="S5.T3.13.13.13.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.13.13.13.5.m1.1a"><mo id="S5.T3.13.13.13.5.m1.1.1" xref="S5.T3.13.13.13.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.13.13.13.5.m1.1b"><csymbol cd="latexml" id="S5.T3.13.13.13.5.m1.1.1.cmml" xref="S5.T3.13.13.13.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.13.13.13.5.m1.1c">\pm</annotation></semantics></math>1.01</td>
<td id="S5.T3.13.13.13.7" class="ltx_td ltx_align_center ltx_border_t">65.14</td>
</tr>
<tr id="S5.T3.18.18.18" class="ltx_tr">
<td id="S5.T3.18.18.18.6" class="ltx_td ltx_align_left ltx_border_r">+ PA</td>
<td id="S5.T3.14.14.14.1" class="ltx_td ltx_align_center">46.96<math id="S5.T3.14.14.14.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.14.14.14.1.m1.1a"><mo id="S5.T3.14.14.14.1.m1.1.1" xref="S5.T3.14.14.14.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.14.14.14.1.m1.1b"><csymbol cd="latexml" id="S5.T3.14.14.14.1.m1.1.1.cmml" xref="S5.T3.14.14.14.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.14.14.14.1.m1.1c">\pm</annotation></semantics></math>0.41</td>
<td id="S5.T3.15.15.15.2" class="ltx_td ltx_align_center">45.14<math id="S5.T3.15.15.15.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.15.15.15.2.m1.1a"><mo id="S5.T3.15.15.15.2.m1.1.1" xref="S5.T3.15.15.15.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.15.15.15.2.m1.1b"><csymbol cd="latexml" id="S5.T3.15.15.15.2.m1.1.1.cmml" xref="S5.T3.15.15.15.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.15.15.15.2.m1.1c">\pm</annotation></semantics></math>0.68</td>
<td id="S5.T3.16.16.16.3" class="ltx_td ltx_align_center ltx_border_r">33.94<math id="S5.T3.16.16.16.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.16.16.16.3.m1.1a"><mo id="S5.T3.16.16.16.3.m1.1.1" xref="S5.T3.16.16.16.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.16.16.16.3.m1.1b"><csymbol cd="latexml" id="S5.T3.16.16.16.3.m1.1.1.cmml" xref="S5.T3.16.16.16.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.16.16.16.3.m1.1c">\pm</annotation></semantics></math>1.03</td>
<td id="S5.T3.17.17.17.4" class="ltx_td ltx_align_center">57.06<math id="S5.T3.17.17.17.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.17.17.17.4.m1.1a"><mo id="S5.T3.17.17.17.4.m1.1.1" xref="S5.T3.17.17.17.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.17.17.17.4.m1.1b"><csymbol cd="latexml" id="S5.T3.17.17.17.4.m1.1.1.cmml" xref="S5.T3.17.17.17.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.17.17.17.4.m1.1c">\pm</annotation></semantics></math>0.60</td>
<td id="S5.T3.18.18.18.5" class="ltx_td ltx_align_center ltx_border_r">54.67<math id="S5.T3.18.18.18.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.18.18.18.5.m1.1a"><mo id="S5.T3.18.18.18.5.m1.1.1" xref="S5.T3.18.18.18.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.18.18.18.5.m1.1b"><csymbol cd="latexml" id="S5.T3.18.18.18.5.m1.1.1.cmml" xref="S5.T3.18.18.18.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.18.18.18.5.m1.1c">\pm</annotation></semantics></math>1.15</td>
<td id="S5.T3.18.18.18.7" class="ltx_td ltx_align_center">83.23</td>
</tr>
<tr id="S5.T3.23.23.23" class="ltx_tr">
<td id="S5.T3.23.23.23.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">L.W. MLP</td>
<td id="S5.T3.19.19.19.1" class="ltx_td ltx_align_center ltx_border_t">36.57<math id="S5.T3.19.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.19.19.19.1.m1.1a"><mo id="S5.T3.19.19.19.1.m1.1.1" xref="S5.T3.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T3.19.19.19.1.m1.1.1.cmml" xref="S5.T3.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.19.19.19.1.m1.1c">\pm</annotation></semantics></math>0.32</td>
<td id="S5.T3.20.20.20.2" class="ltx_td ltx_align_center ltx_border_t">34.38<math id="S5.T3.20.20.20.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.20.20.20.2.m1.1a"><mo id="S5.T3.20.20.20.2.m1.1.1" xref="S5.T3.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T3.20.20.20.2.m1.1.1.cmml" xref="S5.T3.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.20.20.20.2.m1.1c">\pm</annotation></semantics></math>0.58</td>
<td id="S5.T3.21.21.21.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">24.37<math id="S5.T3.21.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.21.21.21.3.m1.1a"><mo id="S5.T3.21.21.21.3.m1.1.1" xref="S5.T3.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T3.21.21.21.3.m1.1.1.cmml" xref="S5.T3.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.21.21.21.3.m1.1c">\pm</annotation></semantics></math>0.93</td>
<td id="S5.T3.22.22.22.4" class="ltx_td ltx_align_center ltx_border_t">33.12<math id="S5.T3.22.22.22.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.22.22.22.4.m1.1a"><mo id="S5.T3.22.22.22.4.m1.1.1" xref="S5.T3.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S5.T3.22.22.22.4.m1.1.1.cmml" xref="S5.T3.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.22.22.22.4.m1.1c">\pm</annotation></semantics></math>0.59</td>
<td id="S5.T3.23.23.23.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">32.88<math id="S5.T3.23.23.23.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.23.23.23.5.m1.1a"><mo id="S5.T3.23.23.23.5.m1.1.1" xref="S5.T3.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S5.T3.23.23.23.5.m1.1.1.cmml" xref="S5.T3.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.23.23.23.5.m1.1c">\pm</annotation></semantics></math>1.13</td>
<td id="S5.T3.23.23.23.7" class="ltx_td ltx_align_center ltx_border_t">64.84</td>
</tr>
<tr id="S5.T3.28.28.28" class="ltx_tr">
<td id="S5.T3.28.28.28.6" class="ltx_td ltx_align_left ltx_border_r">+ PA</td>
<td id="S5.T3.24.24.24.1" class="ltx_td ltx_align_center">51.33<math id="S5.T3.24.24.24.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.24.24.24.1.m1.1a"><mo id="S5.T3.24.24.24.1.m1.1.1" xref="S5.T3.24.24.24.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.24.24.24.1.m1.1b"><csymbol cd="latexml" id="S5.T3.24.24.24.1.m1.1.1.cmml" xref="S5.T3.24.24.24.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.24.24.24.1.m1.1c">\pm</annotation></semantics></math>0.47</td>
<td id="S5.T3.25.25.25.2" class="ltx_td ltx_align_center">49.29<math id="S5.T3.25.25.25.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.25.25.25.2.m1.1a"><mo id="S5.T3.25.25.25.2.m1.1.1" xref="S5.T3.25.25.25.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.25.25.25.2.m1.1b"><csymbol cd="latexml" id="S5.T3.25.25.25.2.m1.1.1.cmml" xref="S5.T3.25.25.25.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.25.25.25.2.m1.1c">\pm</annotation></semantics></math>0.66</td>
<td id="S5.T3.26.26.26.3" class="ltx_td ltx_align_center ltx_border_r">36.29<math id="S5.T3.26.26.26.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.26.26.26.3.m1.1a"><mo id="S5.T3.26.26.26.3.m1.1.1" xref="S5.T3.26.26.26.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.26.26.26.3.m1.1b"><csymbol cd="latexml" id="S5.T3.26.26.26.3.m1.1.1.cmml" xref="S5.T3.26.26.26.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.26.26.26.3.m1.1c">\pm</annotation></semantics></math>1.07</td>
<td id="S5.T3.27.27.27.4" class="ltx_td ltx_align_center">51.88<math id="S5.T3.27.27.27.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.27.27.27.4.m1.1a"><mo id="S5.T3.27.27.27.4.m1.1.1" xref="S5.T3.27.27.27.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.27.27.27.4.m1.1b"><csymbol cd="latexml" id="S5.T3.27.27.27.4.m1.1.1.cmml" xref="S5.T3.27.27.27.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.27.27.27.4.m1.1c">\pm</annotation></semantics></math>0.67</td>
<td id="S5.T3.28.28.28.5" class="ltx_td ltx_align_center ltx_border_r">51.39<math id="S5.T3.28.28.28.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.28.28.28.5.m1.1a"><mo id="S5.T3.28.28.28.5.m1.1.1" xref="S5.T3.28.28.28.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.28.28.28.5.m1.1b"><csymbol cd="latexml" id="S5.T3.28.28.28.5.m1.1.1.cmml" xref="S5.T3.28.28.28.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.28.28.28.5.m1.1c">\pm</annotation></semantics></math>1.27</td>
<td id="S5.T3.28.28.28.7" class="ltx_td ltx_align_center">82.28</td>
</tr>
<tr id="S5.T3.33.33.33" class="ltx_tr">
<td id="S5.T3.33.33.33.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Accumulator</td>
<td id="S5.T3.29.29.29.1" class="ltx_td ltx_align_center ltx_border_t">58.27<math id="S5.T3.29.29.29.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.29.29.29.1.m1.1a"><mo id="S5.T3.29.29.29.1.m1.1.1" xref="S5.T3.29.29.29.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.29.29.29.1.m1.1b"><csymbol cd="latexml" id="S5.T3.29.29.29.1.m1.1.1.cmml" xref="S5.T3.29.29.29.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.29.29.29.1.m1.1c">\pm</annotation></semantics></math>0.56</td>
<td id="S5.T3.30.30.30.2" class="ltx_td ltx_align_center ltx_border_t">57.32<math id="S5.T3.30.30.30.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.30.30.30.2.m1.1a"><mo id="S5.T3.30.30.30.2.m1.1.1" xref="S5.T3.30.30.30.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.30.30.30.2.m1.1b"><csymbol cd="latexml" id="S5.T3.30.30.30.2.m1.1.1.cmml" xref="S5.T3.30.30.30.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.30.30.30.2.m1.1c">\pm</annotation></semantics></math>0.88</td>
<td id="S5.T3.31.31.31.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47.26<math id="S5.T3.31.31.31.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.31.31.31.3.m1.1a"><mo id="S5.T3.31.31.31.3.m1.1.1" xref="S5.T3.31.31.31.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.31.31.31.3.m1.1b"><csymbol cd="latexml" id="S5.T3.31.31.31.3.m1.1.1.cmml" xref="S5.T3.31.31.31.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.31.31.31.3.m1.1c">\pm</annotation></semantics></math>1.18</td>
<td id="S5.T3.32.32.32.4" class="ltx_td ltx_align_center ltx_border_t">72.14<math id="S5.T3.32.32.32.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.32.32.32.4.m1.1a"><mo id="S5.T3.32.32.32.4.m1.1.1" xref="S5.T3.32.32.32.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.32.32.32.4.m1.1b"><csymbol cd="latexml" id="S5.T3.32.32.32.4.m1.1.1.cmml" xref="S5.T3.32.32.32.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.32.32.32.4.m1.1c">\pm</annotation></semantics></math>0.72</td>
<td id="S5.T3.33.33.33.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">71.33<math id="S5.T3.33.33.33.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.33.33.33.5.m1.1a"><mo id="S5.T3.33.33.33.5.m1.1.1" xref="S5.T3.33.33.33.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.33.33.33.5.m1.1b"><csymbol cd="latexml" id="S5.T3.33.33.33.5.m1.1.1.cmml" xref="S5.T3.33.33.33.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.33.33.33.5.m1.1c">\pm</annotation></semantics></math>1.39</td>
<td id="S5.T3.33.33.33.7" class="ltx_td ltx_align_center ltx_border_t">85.21</td>
</tr>
<tr id="S5.T3.38.38.38" class="ltx_tr">
<td id="S5.T3.38.38.38.6" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r">+ PA</td>
<td id="S5.T3.34.34.34.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.34.34.34.1.1" class="ltx_text ltx_font_bold">59.33<math id="S5.T3.34.34.34.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.34.34.34.1.1.m1.1a"><mo id="S5.T3.34.34.34.1.1.m1.1.1" xref="S5.T3.34.34.34.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.34.34.34.1.1.m1.1b"><csymbol cd="latexml" id="S5.T3.34.34.34.1.1.m1.1.1.cmml" xref="S5.T3.34.34.34.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.34.34.34.1.1.m1.1c">\pm</annotation></semantics></math></span>0.72</td>
<td id="S5.T3.35.35.35.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.35.35.35.2.1" class="ltx_text ltx_font_bold">58.48<math id="S5.T3.35.35.35.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.35.35.35.2.1.m1.1a"><mo id="S5.T3.35.35.35.2.1.m1.1.1" xref="S5.T3.35.35.35.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.35.35.35.2.1.m1.1b"><csymbol cd="latexml" id="S5.T3.35.35.35.2.1.m1.1.1.cmml" xref="S5.T3.35.35.35.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.35.35.35.2.1.m1.1c">\pm</annotation></semantics></math></span>0.96</td>
<td id="S5.T3.36.36.36.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T3.36.36.36.3.1" class="ltx_text ltx_font_bold">48.55<math id="S5.T3.36.36.36.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.36.36.36.3.1.m1.1a"><mo id="S5.T3.36.36.36.3.1.m1.1.1" xref="S5.T3.36.36.36.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.36.36.36.3.1.m1.1b"><csymbol cd="latexml" id="S5.T3.36.36.36.3.1.m1.1.1.cmml" xref="S5.T3.36.36.36.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.36.36.36.3.1.m1.1c">\pm</annotation></semantics></math></span>1.30</td>
<td id="S5.T3.37.37.37.4" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T3.37.37.37.4.1" class="ltx_text ltx_font_bold">72.67<math id="S5.T3.37.37.37.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.37.37.37.4.1.m1.1a"><mo id="S5.T3.37.37.37.4.1.m1.1.1" xref="S5.T3.37.37.37.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.37.37.37.4.1.m1.1b"><csymbol cd="latexml" id="S5.T3.37.37.37.4.1.m1.1.1.cmml" xref="S5.T3.37.37.37.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.37.37.37.4.1.m1.1c">\pm</annotation></semantics></math></span>0.81</td>
<td id="S5.T3.38.38.38.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T3.38.38.38.5.1" class="ltx_text ltx_font_bold">72.05<math id="S5.T3.38.38.38.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T3.38.38.38.5.1.m1.1a"><mo id="S5.T3.38.38.38.5.1.m1.1.1" xref="S5.T3.38.38.38.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T3.38.38.38.5.1.m1.1b"><csymbol cd="latexml" id="S5.T3.38.38.38.5.1.m1.1.1.cmml" xref="S5.T3.38.38.38.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.38.38.38.5.1.m1.1c">\pm</annotation></semantics></math></span>1.57</td>
<td id="S5.T3.38.38.38.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T3.38.38.38.7.1" class="ltx_text ltx_font_bold">87.42</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Personalized performance on CIFAR-100-C and corrupted SpeechCmdv2 with multi-tier constraints after FL training on clean data (figures in bracket show relative improvement to performance before personalization).</figcaption>
<div id="S5.T4.27" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:357.7pt;height:134.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-62.0pt,23.2pt) scale(0.742570293208801,0.742570293208801) ;">
<table id="S5.T4.27.27" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.27.27.28.1" class="ltx_tr">
<th id="S5.T4.27.27.28.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt">Update part for<span class="ltx_rule" style="width:0.0pt;height:5.2pt;background:black;display:inline-block;"></span>
</th>
<td id="S5.T4.27.27.28.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3">CIFAR-100-C</td>
<td id="S5.T4.27.27.28.1.3" class="ltx_td ltx_align_center ltx_border_tt">SpeechCmdV2</td>
</tr>
<tr id="S5.T4.3.3.3" class="ltx_tr">
<th id="S5.T4.3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">personalization</th>
<td id="S5.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">IID (<math id="S5.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="1000.0" display="inline"><semantics id="S5.T4.1.1.1.1.m1.1a"><mn id="S5.T4.1.1.1.1.m1.1.1" xref="S5.T4.1.1.1.1.m1.1.1.cmml">1000.0</mn><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.1.m1.1b"><cn type="float" id="S5.T4.1.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.1.m1.1.1">1000.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.1.m1.1c">1000.0</annotation></semantics></math>)</td>
<td id="S5.T4.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t">Non-IID (<math id="S5.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S5.T4.2.2.2.2.m1.1a"><mn id="S5.T4.2.2.2.2.m1.1.1" xref="S5.T4.2.2.2.2.m1.1.1.cmml">1.0</mn><annotation-xml encoding="MathML-Content" id="S5.T4.2.2.2.2.m1.1b"><cn type="float" id="S5.T4.2.2.2.2.m1.1.1.cmml" xref="S5.T4.2.2.2.2.m1.1.1">1.0</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.2.2.2.m1.1c">1.0</annotation></semantics></math>)</td>
<td id="S5.T4.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Non-IID (<math id="S5.T4.3.3.3.3.m1.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S5.T4.3.3.3.3.m1.1a"><mn id="S5.T4.3.3.3.3.m1.1.1" xref="S5.T4.3.3.3.3.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S5.T4.3.3.3.3.m1.1b"><cn type="float" id="S5.T4.3.3.3.3.m1.1.1.cmml" xref="S5.T4.3.3.3.3.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.3.3.3.3.m1.1c">0.1</annotation></semantics></math>)</td>
<td id="S5.T4.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">Bkg. Noise (0.6)</td>
</tr>
<tr id="S5.T4.6.6.6" class="ltx_tr">
<th id="S5.T4.6.6.6.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Full Model</th>
<td id="S5.T4.4.4.4.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.4.4.4.1.1" class="ltx_text" style="color:#808080;">34.30<math id="S5.T4.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.4.4.4.1.1.m1.1a"><mo mathcolor="#808080" id="S5.T4.4.4.4.1.1.m1.1.1" xref="S5.T4.4.4.4.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.4.4.4.1.1.m1.1b"><csymbol cd="latexml" id="S5.T4.4.4.4.1.1.m1.1.1.cmml" xref="S5.T4.4.4.4.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.4.4.4.1.1.m1.1c">\pm</annotation></semantics></math>1.85(+32.19)</span></td>
<td id="S5.T4.5.5.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.5.5.5.2.1" class="ltx_text" style="color:#808080;">37.75<math id="S5.T4.5.5.5.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.5.5.5.2.1.m1.1a"><mo mathcolor="#808080" id="S5.T4.5.5.5.2.1.m1.1.1" xref="S5.T4.5.5.5.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.5.5.5.2.1.m1.1b"><csymbol cd="latexml" id="S5.T4.5.5.5.2.1.m1.1.1.cmml" xref="S5.T4.5.5.5.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.5.5.5.2.1.m1.1c">\pm</annotation></semantics></math>2.21(+36.36)</span></td>
<td id="S5.T4.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.6.6.6.3.1" class="ltx_text" style="color:#808080;">26.94<math id="S5.T4.6.6.6.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.6.6.6.3.1.m1.1a"><mo mathcolor="#808080" id="S5.T4.6.6.6.3.1.m1.1.1" xref="S5.T4.6.6.6.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.6.6.6.3.1.m1.1b"><csymbol cd="latexml" id="S5.T4.6.6.6.3.1.m1.1.1.cmml" xref="S5.T4.6.6.6.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.6.6.6.3.1.m1.1c">\pm</annotation></semantics></math>3.14(+25.85)</span></td>
<td id="S5.T4.6.6.6.5" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T4.6.6.6.5.1" class="ltx_text" style="color:#808080;">90.21</span>(+8.59)</td>
</tr>
<tr id="S5.T4.9.9.9" class="ltx_tr">
<th id="S5.T4.9.9.9.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">L.W. Linear +PA</th>
<td id="S5.T4.7.7.7.1" class="ltx_td ltx_align_center ltx_border_t">34.67<math id="S5.T4.7.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.7.7.7.1.m1.1a"><mo id="S5.T4.7.7.7.1.m1.1.1" xref="S5.T4.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S5.T4.7.7.7.1.m1.1.1.cmml" xref="S5.T4.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.7.7.7.1.m1.1c">\pm</annotation></semantics></math>1.21(+32.10)</td>
<td id="S5.T4.8.8.8.2" class="ltx_td ltx_align_center ltx_border_t">37.55<math id="S5.T4.8.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.8.8.8.2.m1.1a"><mo id="S5.T4.8.8.8.2.m1.1.1" xref="S5.T4.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S5.T4.8.8.8.2.m1.1.1.cmml" xref="S5.T4.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.8.8.8.2.m1.1c">\pm</annotation></semantics></math>1.79(+35.21)</td>
<td id="S5.T4.9.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">26.63<math id="S5.T4.9.9.9.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.9.9.9.3.m1.1a"><mo id="S5.T4.9.9.9.3.m1.1.1" xref="S5.T4.9.9.9.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.9.9.9.3.m1.1b"><csymbol cd="latexml" id="S5.T4.9.9.9.3.m1.1.1.cmml" xref="S5.T4.9.9.9.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.9.9.9.3.m1.1c">\pm</annotation></semantics></math>2.21(+24.46)</td>
<td id="S5.T4.9.9.9.5" class="ltx_td ltx_align_center ltx_border_t">80.82(+6.40)</td>
</tr>
<tr id="S5.T4.12.12.12" class="ltx_tr">
<th id="S5.T4.12.12.12.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PA Only</th>
<td id="S5.T4.10.10.10.1" class="ltx_td ltx_align_center">34.06<math id="S5.T4.10.10.10.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.10.10.10.1.m1.1a"><mo id="S5.T4.10.10.10.1.m1.1.1" xref="S5.T4.10.10.10.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.10.10.10.1.m1.1b"><csymbol cd="latexml" id="S5.T4.10.10.10.1.m1.1.1.cmml" xref="S5.T4.10.10.10.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.10.10.10.1.m1.1c">\pm</annotation></semantics></math>1.01(+31.49)</td>
<td id="S5.T4.11.11.11.2" class="ltx_td ltx_align_center">37.02<math id="S5.T4.11.11.11.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.11.11.11.2.m1.1a"><mo id="S5.T4.11.11.11.2.m1.1.1" xref="S5.T4.11.11.11.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.11.11.11.2.m1.1b"><csymbol cd="latexml" id="S5.T4.11.11.11.2.m1.1.1.cmml" xref="S5.T4.11.11.11.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.11.11.11.2.m1.1c">\pm</annotation></semantics></math>1.27(+34.68)</td>
<td id="S5.T4.12.12.12.3" class="ltx_td ltx_align_center ltx_border_r">25.96<math id="S5.T4.12.12.12.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.12.12.12.3.m1.1a"><mo id="S5.T4.12.12.12.3.m1.1.1" xref="S5.T4.12.12.12.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.12.12.12.3.m1.1b"><csymbol cd="latexml" id="S5.T4.12.12.12.3.m1.1.1.cmml" xref="S5.T4.12.12.12.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.12.12.12.3.m1.1c">\pm</annotation></semantics></math>1.58(+23.79)</td>
<td id="S5.T4.12.12.12.5" class="ltx_td ltx_align_center">81.40(+6.98)</td>
</tr>
<tr id="S5.T4.15.15.15" class="ltx_tr">
<th id="S5.T4.15.15.15.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">L.W. MLP + PA</th>
<td id="S5.T4.13.13.13.1" class="ltx_td ltx_align_center ltx_border_t">31.69<math id="S5.T4.13.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.13.13.13.1.m1.1a"><mo id="S5.T4.13.13.13.1.m1.1.1" xref="S5.T4.13.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.13.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T4.13.13.13.1.m1.1.1.cmml" xref="S5.T4.13.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.13.13.13.1.m1.1c">\pm</annotation></semantics></math>1.42(+29.46)</td>
<td id="S5.T4.14.14.14.2" class="ltx_td ltx_align_center ltx_border_t">36.95<math id="S5.T4.14.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.14.14.14.2.m1.1a"><mo id="S5.T4.14.14.14.2.m1.1.1" xref="S5.T4.14.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.14.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T4.14.14.14.2.m1.1.1.cmml" xref="S5.T4.14.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.14.14.14.2.m1.1c">\pm</annotation></semantics></math>2.05(+34.80)</td>
<td id="S5.T4.15.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">22.30<math id="S5.T4.15.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.15.15.15.3.m1.1a"><mo id="S5.T4.15.15.15.3.m1.1.1" xref="S5.T4.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T4.15.15.15.3.m1.1.1.cmml" xref="S5.T4.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.15.15.15.3.m1.1c">\pm</annotation></semantics></math>2.96(+20.26)</td>
<td id="S5.T4.15.15.15.5" class="ltx_td ltx_align_center ltx_border_t">80.59(+6.42)</td>
</tr>
<tr id="S5.T4.18.18.18" class="ltx_tr">
<th id="S5.T4.18.18.18.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PA Only</th>
<td id="S5.T4.16.16.16.1" class="ltx_td ltx_align_center">33.01<math id="S5.T4.16.16.16.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.16.16.16.1.m1.1a"><mo id="S5.T4.16.16.16.1.m1.1.1" xref="S5.T4.16.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.16.16.16.1.m1.1b"><csymbol cd="latexml" id="S5.T4.16.16.16.1.m1.1.1.cmml" xref="S5.T4.16.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.16.16.16.1.m1.1c">\pm</annotation></semantics></math>1.18(+31.73)</td>
<td id="S5.T4.17.17.17.2" class="ltx_td ltx_align_center">37.38<math id="S5.T4.17.17.17.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.17.17.17.2.m1.1a"><mo id="S5.T4.17.17.17.2.m1.1.1" xref="S5.T4.17.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.17.17.17.2.m1.1b"><csymbol cd="latexml" id="S5.T4.17.17.17.2.m1.1.1.cmml" xref="S5.T4.17.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.17.17.17.2.m1.1c">\pm</annotation></semantics></math>1.34(+35.23)</td>
<td id="S5.T4.18.18.18.3" class="ltx_td ltx_align_center ltx_border_r">26.59<math id="S5.T4.18.18.18.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.18.18.18.3.m1.1a"><mo id="S5.T4.18.18.18.3.m1.1.1" xref="S5.T4.18.18.18.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.18.18.18.3.m1.1b"><csymbol cd="latexml" id="S5.T4.18.18.18.3.m1.1.1.cmml" xref="S5.T4.18.18.18.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.18.18.18.3.m1.1c">\pm</annotation></semantics></math>1.62(+24.55)</td>
<td id="S5.T4.18.18.18.5" class="ltx_td ltx_align_center">80.82(+6.65)</td>
</tr>
<tr id="S5.T4.21.21.21" class="ltx_tr">
<th id="S5.T4.21.21.21.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Accumulator + PA</th>
<td id="S5.T4.19.19.19.1" class="ltx_td ltx_align_center ltx_border_t">38.23<math id="S5.T4.19.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.19.19.19.1.m1.1a"><mo id="S5.T4.19.19.19.1.m1.1.1" xref="S5.T4.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S5.T4.19.19.19.1.m1.1.1.cmml" xref="S5.T4.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.19.19.19.1.m1.1c">\pm</annotation></semantics></math>1.72(+34.78)</td>
<td id="S5.T4.20.20.20.2" class="ltx_td ltx_align_center ltx_border_t">40.05<math id="S5.T4.20.20.20.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.20.20.20.2.m1.1a"><mo id="S5.T4.20.20.20.2.m1.1.1" xref="S5.T4.20.20.20.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.20.20.20.2.m1.1b"><csymbol cd="latexml" id="S5.T4.20.20.20.2.m1.1.1.cmml" xref="S5.T4.20.20.20.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.20.20.20.2.m1.1c">\pm</annotation></semantics></math>2.34(+36.90)</td>
<td id="S5.T4.21.21.21.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">31.26<math id="S5.T4.21.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.21.21.21.3.m1.1a"><mo id="S5.T4.21.21.21.3.m1.1.1" xref="S5.T4.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S5.T4.21.21.21.3.m1.1.1.cmml" xref="S5.T4.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.21.21.21.3.m1.1c">\pm</annotation></semantics></math>2.98(+28.30)</td>
<td id="S5.T4.21.21.21.5" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T4.21.21.21.5.1" class="ltx_text ltx_font_bold">85.46</span>(+6.47)</td>
</tr>
<tr id="S5.T4.24.24.24" class="ltx_tr">
<th id="S5.T4.24.24.24.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">PA Only</th>
<td id="S5.T4.22.22.22.1" class="ltx_td ltx_align_center">37.33<math id="S5.T4.22.22.22.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.22.22.22.1.m1.1a"><mo id="S5.T4.22.22.22.1.m1.1.1" xref="S5.T4.22.22.22.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.22.22.22.1.m1.1b"><csymbol cd="latexml" id="S5.T4.22.22.22.1.m1.1.1.cmml" xref="S5.T4.22.22.22.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.22.22.22.1.m1.1c">\pm</annotation></semantics></math>1.37(+33.88)</td>
<td id="S5.T4.23.23.23.2" class="ltx_td ltx_align_center">39.45<math id="S5.T4.23.23.23.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.23.23.23.2.m1.1a"><mo id="S5.T4.23.23.23.2.m1.1.1" xref="S5.T4.23.23.23.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.23.23.23.2.m1.1b"><csymbol cd="latexml" id="S5.T4.23.23.23.2.m1.1.1.cmml" xref="S5.T4.23.23.23.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.23.23.23.2.m1.1c">\pm</annotation></semantics></math>1.48(+36.30)</td>
<td id="S5.T4.24.24.24.3" class="ltx_td ltx_align_center ltx_border_r">30.24<math id="S5.T4.24.24.24.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.24.24.24.3.m1.1a"><mo id="S5.T4.24.24.24.3.m1.1.1" xref="S5.T4.24.24.24.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.24.24.24.3.m1.1b"><csymbol cd="latexml" id="S5.T4.24.24.24.3.m1.1.1.cmml" xref="S5.T4.24.24.24.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.24.24.24.3.m1.1c">\pm</annotation></semantics></math>1.69(+28.20)</td>
<td id="S5.T4.24.24.24.5" class="ltx_td ltx_align_center">85.40(+6.41)</td>
</tr>
<tr id="S5.T4.27.27.27" class="ltx_tr">
<th id="S5.T4.27.27.27.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">
<span id="S5.T4.27.27.27.4.1" class="ltx_text ltx_font_typewriter">Client</span> Token Only</th>
<td id="S5.T4.25.25.25.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T4.25.25.25.1.1" class="ltx_text ltx_font_bold">45.38<math id="S5.T4.25.25.25.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.25.25.25.1.1.m1.1a"><mo id="S5.T4.25.25.25.1.1.m1.1.1" xref="S5.T4.25.25.25.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.25.25.25.1.1.m1.1b"><csymbol cd="latexml" id="S5.T4.25.25.25.1.1.m1.1.1.cmml" xref="S5.T4.25.25.25.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.25.25.25.1.1.m1.1c">\pm</annotation></semantics></math></span>0.96(+41.93)</td>
<td id="S5.T4.26.26.26.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T4.26.26.26.2.1" class="ltx_text ltx_font_bold">47.02<math id="S5.T4.26.26.26.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.26.26.26.2.1.m1.1a"><mo id="S5.T4.26.26.26.2.1.m1.1.1" xref="S5.T4.26.26.26.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.26.26.26.2.1.m1.1b"><csymbol cd="latexml" id="S5.T4.26.26.26.2.1.m1.1.1.cmml" xref="S5.T4.26.26.26.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.26.26.26.2.1.m1.1c">\pm</annotation></semantics></math></span>1.13(+43.87)</td>
<td id="S5.T4.27.27.27.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T4.27.27.27.3.1" class="ltx_text ltx_font_bold">38.25<math id="S5.T4.27.27.27.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T4.27.27.27.3.1.m1.1a"><mo id="S5.T4.27.27.27.3.1.m1.1.1" xref="S5.T4.27.27.27.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T4.27.27.27.3.1.m1.1b"><csymbol cd="latexml" id="S5.T4.27.27.27.3.1.m1.1.1.cmml" xref="S5.T4.27.27.27.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.27.27.27.3.1.m1.1c">\pm</annotation></semantics></math></span>1.30(+35.29)</td>
<td id="S5.T4.27.27.27.5" class="ltx_td ltx_align_center ltx_border_bb">85.24(+6.25)</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S5.SS2.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Personalization.</h4>

<div id="S5.SS2.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px4.p1.1" class="ltx_p">Since clients’ class and data distributions are typically different and diverse, adapting the globally trained model through per-client personalization is an interesting task for FL.
Based on the pertained model of multi-tier federated learning as the most practical scenario, we can adapt the model to the local data of each client efficiently.
Specifically, the multi-tier FL pretrained model is fine-tuned for ten epochs for each client. We use noisy data for personalization and the final test to simulate personal data distributions. For the corrupted CIFAR-100, we simply use CIFAR-C <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Dietterich,, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>. To corrupt SpeechCmdv2 dataset, we add <math id="S5.SS2.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="60\%" display="inline"><semantics id="S5.SS2.SSS0.Px4.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.cmml"><mn id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml">60</mn><mo id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px4.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px4.p1.1.m1.1.1.2">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px4.p1.1.m1.1c">60\%</annotation></semantics></math> background noise into each validation speaker and split them into two sets for personalization and the final test. From the results in Table <a href="#S5.T4" title="Table 4 ‣ Multi-tier based Federated Learning. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we can see that when tested on the corrupted data, the performances of all methods degraded. Now, our Accumulator shows outstanding performance among all competitors, including updating the full model during personalization. More interestingly, updating the <span id="S5.SS2.SSS0.Px4.p1.1.1" class="ltx_text ltx_font_typewriter">Client</span> token, which has an extremely small set of parameters, i.e. 0.38K parameters according to Table <a href="#S5.T5" title="Table 5 ‣ Personalization. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (Left), in our Accumulator, works overall the best among all situations. And also, when comparing the test accuracy gains after personalization, we can see our Accumulator produces the most, especially when the <span id="S5.SS2.SSS0.Px4.p1.1.2" class="ltx_text ltx_font_typewriter">Client</span> token is solely used for personalization fine-tuning.</p>
</div>
<figure id="S5.T5" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Left: parameter number of different methods. Right: Ablation study of Accumulator.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<table id="S5.T5.1" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<th id="S5.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt">
<span id="S5.T5.1.1.1.1.1" class="ltx_text">Method</span><span class="ltx_rule" style="width:0.0pt;height:5.2pt;background:black;display:inline-block;"></span>
</th>
<td id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Parameter Num</td>
</tr>
<tr id="S5.T5.1.2.2" class="ltx_tr">
<th id="S5.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Full Fine-tuning</th>
<td id="S5.T5.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">30.62M</td>
</tr>
<tr id="S5.T5.1.3.3" class="ltx_tr">
<th id="S5.T5.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Parallel Adapter</th>
<td id="S5.T5.1.3.3.2" class="ltx_td ltx_align_center ltx_border_t">0.60M</td>
</tr>
<tr id="S5.T5.1.4.4" class="ltx_tr">
<th id="S5.T5.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Layer-wise Linear</th>
<td id="S5.T5.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t">0.46M</td>
</tr>
<tr id="S5.T5.1.5.5" class="ltx_tr">
<th id="S5.T5.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Layer-wise MLP</th>
<td id="S5.T5.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">8.95M</td>
</tr>
<tr id="S5.T5.1.6.6" class="ltx_tr">
<th id="S5.T5.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Accumulator</th>
<td id="S5.T5.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">3.17M</td>
</tr>
<tr id="S5.T5.1.7.7" class="ltx_tr">
<th id="S5.T5.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">
<span id="S5.T5.1.7.7.1.1" class="ltx_text ltx_font_typewriter">Client</span> Token</th>
<td id="S5.T5.1.7.7.2" class="ltx_td ltx_align_center ltx_border_bb">0.38K</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<table id="S5.T5.2" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T5.2.1.1" class="ltx_tr">
<th id="S5.T5.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">
<span id="S5.T5.2.1.1.1.1" class="ltx_text"></span><span class="ltx_rule" style="width:0.0pt;height:5.2pt;background:black;display:inline-block;"></span>
</th>
<th id="S5.T5.2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mean performance</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T5.2.2.1" class="ltx_tr">
<th id="S5.T5.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Full Accumulator</th>
<td id="S5.T5.2.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.2.2.1.2.1" class="ltx_text">48.55</span></td>
</tr>
<tr id="S5.T5.2.3.2" class="ltx_tr">
<th id="S5.T5.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"># self-attn blocks=3</th>
<td id="S5.T5.2.3.2.2" class="ltx_td ltx_align_center ltx_border_t">48.86 (+0.31)</td>
</tr>
<tr id="S5.T5.2.4.3" class="ltx_tr">
<th id="S5.T5.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">No Replace</th>
<td id="S5.T5.2.4.3.2" class="ltx_td ltx_align_center ltx_border_t">45.81 (-2.74)</td>
</tr>
<tr id="S5.T5.2.5.4" class="ltx_tr">
<th id="S5.T5.2.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">No Residual</th>
<td id="S5.T5.2.5.4.2" class="ltx_td ltx_align_center ltx_border_t">43.34 (-5.21)</td>
</tr>
<tr id="S5.T5.2.6.5" class="ltx_tr">
<th id="S5.T5.2.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">No Parallel Adapter</th>
<td id="S5.T5.2.6.5.2" class="ltx_td ltx_align_center ltx_border_t">47.93 (-0.62)</td>
</tr>
<tr id="S5.T5.2.7.6" class="ltx_tr">
<th id="S5.T5.2.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">Linear Head</th>
<td id="S5.T5.2.7.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">44.6 (-3.95)</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</section>
<section id="S5.SS2.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Ablation Study.</h4>

<div id="S5.SS2.SSS0.Px5.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px5.p1.1" class="ltx_p">In order to verify the contributions of different components proposed in our Accumulator, ablation studies were conducted based on the multi-tier based FL setup on CIFAR-100 (<math id="S5.SS2.SSS0.Px5.p1.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS2.SSS0.Px5.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px5.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px5.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1"><eq id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.1"></eq><ci id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS0.Px5.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px5.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px5.p1.1.m1.1c">\alpha=0.1</annotation></semantics></math>), the hardest scenario.
In Table <a href="#S5.T5" title="Table 5 ‣ Personalization. ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (right), the full accumulator indicates a transformer with depth=1, class token parallel connection, token replace mechanism, parallel adapter, and an MLP classification head.
Among them, we find that parallel connection influences performance the most.
This is mainly because DeiT’s original class tokens are well learned on ImageNet, which are directly beneficial for model predictions in the downstream tasks. Removing token replacing reduces the effect of modulating the extracted features from DeiT. Thus the performance drops noticeably. And we also tried larger depth, i.e. 3, in the Accumulator, but it seemed not to produce much performance gain. Our Accumulator works complementarily with parallel adapters used but apparently does not rely on them to have excellent performance.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">We explored the challenges and opportunities of leveraging pre-trained models for downstream federated learning tasks. While this might appear to raise communication costs and preclude diverse device capabilities from participating, we show that after introducing a novel parameter-efficient adapter module we can simultaneously capture the benefits of communication efficient adaptation, non-IID robustness, support for diverse device capabilities, and robust personalization.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alistarh et al.,  (2017)</span>
<span class="ltx_bibblock">
Alistarh, D., Grubic, D., Li, J., Tomioka, R., and Vojnovic, M. (2017).

</span>
<span class="ltx_bibblock">Qsgd: Communication-efficient sgd via gradient quantization and
encoding.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beutel et al.,  (2020)</span>
<span class="ltx_bibblock">
Beutel, D. J., Topal, T., Mathur, A., Qiu, X., Parcollet, T., and Lane, N. D.
(2020).

</span>
<span class="ltx_bibblock">Flower: A friendly federated learning research framework.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.14390</span>.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bommasani et al.,  (2021)</span>
<span class="ltx_bibblock">
Bommasani, R., Hudson, D. A., Adeli, E., Altman, R., Arora, S., von Arx, S.,
Bernstein, M. S., Bohg, J., Bosselut, A., Brunskill, E., et al. (2021).

</span>
<span class="ltx_bibblock">On the opportunities and risks of foundation models.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2108.07258</span>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et al.,  (2017)</span>
<span class="ltx_bibblock">
Cohen, G., Afshar, S., Tapson, J., and Van Schaik, A. (2017).

</span>
<span class="ltx_bibblock">Emnist: Extending mnist to handwritten letters.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">2017 International Joint Conference on Neural Networks
(IJCNN)</span>, pages 2921–2926. IEEE.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al.,  (2020)</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X.,
Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et al.
(2020).

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.11929</span>.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fei-Fei et al.,  (2010)</span>
<span class="ltx_bibblock">
Fei-Fei, L., Deng, J., and Li, K. (2010).

</span>
<span class="ltx_bibblock">ImageNet: Constructing a large-scale image database.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Journal of Vision</span>, 9(8):1037–1037.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al.,  (2020)</span>
<span class="ltx_bibblock">
Fu, F., Hu, Y., He, Y., Jiang, J., Shao, Y., Zhang, C., and Cui, B. (2020).

</span>
<span class="ltx_bibblock">Don’t waste your bits! squeeze activations and gradients for deep
neural networks via tinyscript.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
3304–3314. PMLR.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al.,  (2021)</span>
<span class="ltx_bibblock">
Gong, Y., Chung, Y.-A., and Glass, J. (2021).

</span>
<span class="ltx_bibblock">AST: Audio Spectrogram Transformer.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Proc. Interspeech 2021</span>, pages 571–575.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al.,  (2021)</span>
<span class="ltx_bibblock">
He, J., Zhou, C., Ma, X., Berg-Kirkpatrick, T., and Neubig, G. (2021).

</span>
<span class="ltx_bibblock">Towards a unified view of parameter-efficient transfer learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.04366</span>.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heikkilä et al.,  (2020)</span>
<span class="ltx_bibblock">
Heikkilä, M. A., Koskela, A., Shimizu, K., Kaski, S., and Honkela, A.
(2020).

</span>
<span class="ltx_bibblock">Differentially private cross-silo federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2007.05553</span>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Dietterich,  (2019)</span>
<span class="ltx_bibblock">
Hendrycks, D. and Dietterich, T. (2019).

</span>
<span class="ltx_bibblock">Benchmarking neural network robustness to common corruptions and
perturbations.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1903.12261</span>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Horvath et al.,  (2021)</span>
<span class="ltx_bibblock">
Horvath, S., Laskaridis, S., Almeida, M., Leontiadis, I., Venieris, S., and
Lane, N. (2021).

</span>
<span class="ltx_bibblock">Fjord: Fair and accurate federated learning under heterogeneous
targets with ordered dropout.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
34:12876–12889.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al.,  (2019)</span>
<span class="ltx_bibblock">
Houlsby, N., Giurgiu, A., Jastrzebski, S., Morrone, B., De Laroussilhe, Q.,
Gesmundo, A., Attariyan, M., and Gelly, S. (2019).

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for nlp.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
2790–2799. PMLR.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al.,  (2022)</span>
<span class="ltx_bibblock">
Jiang, Y., Wang, S., Valls, V., Ko, B. J., Lee, W.-H., Leung, K. K., and
Tassiulas, L. (2022).

</span>
<span class="ltx_bibblock">Model pruning enables efficient federated learning on edge devices.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al.,  (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S., Mohri, M., Reddi, S., Stich, S., and Suresh,
A. T. (2020).

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
5132–5143. PMLR.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al.,  (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al. (2009).

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laskaridis et al.,  (2021)</span>
<span class="ltx_bibblock">
Laskaridis, S., Kouris, A., and Lane, N. D. (2021).

</span>
<span class="ltx_bibblock">Adaptive inference through early-exit networks: Design, challenges
and directions.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proceedings of the 5th International Workshop on Embedded and
Mobile Deep Learning</span>, pages 1–6.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laskaridis et al.,  (2020)</span>
<span class="ltx_bibblock">
Laskaridis, S., Venieris, S. I., Kim, H., and Lane, N. D. (2020).

</span>
<span class="ltx_bibblock">Hapi: Hardware-aware progressive inference.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">2020 IEEE/ACM International Conference On Computer Aided
Design (ICCAD)</span>, pages 1–9. IEEE.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leontiadis et al.,  (2021)</span>
<span class="ltx_bibblock">
Leontiadis, I., Laskaridis, S., Venieris, S. I., and Lane, N. D. (2021).

</span>
<span class="ltx_bibblock">It’s always personal: Using early exits for efficient on-device cnn
personalisation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the 22nd International Workshop on Mobile
Computing Systems and Applications</span>, pages 15–21.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et al.,  (2021)</span>
<span class="ltx_bibblock">
Lester, B., Al-Rfou, R., and Constant, N. (2021).

</span>
<span class="ltx_bibblock">The power of scale for parameter-efficient prompt tuning.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2104.08691</span>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al.,  (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.
(2020).

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, 2:429–450.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al.,  (2022)</span>
<span class="ltx_bibblock">
Li, W.-H., Liu, X., and Bilen, H. (2022).

</span>
<span class="ltx_bibblock">Cross-domain few-shot learning with task-specific adapters.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 7161–7170.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang,  (2021)</span>
<span class="ltx_bibblock">
Li, X. L. and Liang, P. (2021).

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2101.00190</span>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al.,  (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A. (2017).

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mishchenko et al.,  (2022)</span>
<span class="ltx_bibblock">
Mishchenko, K., Malinovsky, G., Stich, S., and Richtárik, P. (2022).

</span>
<span class="ltx_bibblock">Proxskip: Yes! local gradient steps provably lead to communication
acceleration! finally!

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2202.09357</span>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al.,  (2022)</span>
<span class="ltx_bibblock">
Nguyen, J., Malik, K., Sanjabi, M., and Rabbat, M. (2022).

</span>
<span class="ltx_bibblock">Where to begin? exploring the impact of pre-training and
initialization in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2206.15387</span>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al.,  (2022)</span>
<span class="ltx_bibblock">
Qu, L., Zhou, Y., Liang, P. P., Xia, Y., Wang, F., Adeli, E., Fei-Fei, L., and
Rubin, D. (2022).

</span>
<span class="ltx_bibblock">Rethinking architecture design for tackling data heterogeneity in
federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, pages 10061–10071.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rapp et al.,  (2022)</span>
<span class="ltx_bibblock">
Rapp, M., Khalili, R., Pfeiffer, K., and Henkel, J. (2022).

</span>
<span class="ltx_bibblock">Distreal: Distributed resource-aware learning in heterogeneous
systems.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 36, pages 8062–8071.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rebuffi et al.,  (2017)</span>
<span class="ltx_bibblock">
Rebuffi, S.-A., Bilen, H., and Vedaldi, A. (2017).

</span>
<span class="ltx_bibblock">Learning multiple visual domains with residual adapters.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 30.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rippel et al.,  (2014)</span>
<span class="ltx_bibblock">
Rippel, O., Gelbart, M., and Adams, R. (2014).

</span>
<span class="ltx_bibblock">Learning ordered representations with nested dropout.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
1746–1754. PMLR.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stich et al.,  (2018)</span>
<span class="ltx_bibblock">
Stich, S. U., Cordonnier, J.-B., and Jaggi, M. (2018).

</span>
<span class="ltx_bibblock">Sparsified sgd with memory.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 31.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tomanek et al.,  (2021)</span>
<span class="ltx_bibblock">
Tomanek, K., Zayats, V., Padfield, D., Vaillancourt, K., and Biadsy, F. (2021).

</span>
<span class="ltx_bibblock">Residual adapters for parameter-efficient asr adaptation to atypical
and accented speech.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2109.06952</span>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al.,  (2021)</span>
<span class="ltx_bibblock">
Touvron, H., Cord, M., Douze, M., Massa, F., Sablayrolles, A., and Jegou, H.
(2021).

</span>
<span class="ltx_bibblock">Training data-efficient image transformers &amp; distillation through
attention.

</span>
<span class="ltx_bibblock">In Meila, M. and Zhang, T., editors, <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning</span>, volume 139 of <span id="bib.bib33.2.2" class="ltx_text ltx_font_italic">Proceedings
of Machine Learning Research</span>, pages 10347–10357. PMLR.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(34)</span>
<span class="ltx_bibblock">
Wang, H., Yurochkin, M., Sun, Y., Papailiopoulos, D., and Khazaeni, Y. (2020a).

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2002.06440</span>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al.,  (2022)</span>
<span class="ltx_bibblock">
Wang, H.-P., Stich, S., He, Y., and Fritz, M. (2022).

</span>
<span class="ltx_bibblock">Progfed: effective, communication, and computation efficient
federated learning by progressive training.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
23034–23054. PMLR.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(36)</span>
<span class="ltx_bibblock">
Wang, J., Liu, Q., Liang, H., Joshi, G., and Poor, H. V. (2020b).

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
33:7611–7623.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warden,  (2018)</span>
<span class="ltx_bibblock">
Warden, P. (2018).

</span>
<span class="ltx_bibblock">Speech commands: A dataset for limited-vocabulary speech recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1804.03209</span>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al.,  (2021)</span>
<span class="ltx_bibblock">
Yu, S., Nguyen, P., Anwar, A., and Jannesari, A. (2021).

</span>
<span class="ltx_bibblock">Adaptive dynamic pruning for non-iid federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2106.06921</span>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zaken et al.,  (2021)</span>
<span class="ltx_bibblock">
Zaken, E. B., Ravfogel, S., and Goldberg, Y. (2021).

</span>
<span class="ltx_bibblock">Bitfit: Simple parameter-efficient fine-tuning for transformer-based
masked language-models.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2106.10199</span>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation Details</h2>

<section id="A1.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Hyperparameter Settings</h4>

<div id="A1.SS0.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="A1.SS0.SSS0.Px1.p1.1" class="ltx_p">The base setup is the same for all experiments, and we basically did not include any extra training tricks to be able to demonstrate that our proposed framework can be successfully adapted with <span id="A1.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_bold">Anytime</span> and <span id="A1.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_bold">Anywhere</span>. For all datasets, the initial learning rate for the SGD optimizer is set to 5e-3, and the batch size and training epoch on the client is set to 10 and 1, respectively. The <span id="A1.SS0.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_typewriter">RandomResizedCrop</span> with scale=(0.05, 1.0) is used in training. The FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al., (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> is the default aggregation algorithm.</p>
</div>
</section>
<section id="A1.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Conventional Federated Learning</h4>

<div id="A1.SS0.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="A1.SS0.SSS0.Px2.p1.1" class="ltx_p">In this setting, the last layer of the foundation model is set as the only exit.
The full foundation model can be used for training the additional parameters, <span id="A1.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">e.g.,</span> L.W. MLP, and Accumulator, <span id="A1.SS0.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_italic">etc</span>.
The baseline Fine-tuning indicates all parameters of the foundation model with an extra MLP head are free for tuning.
The total training round is set to 500.</p>
</div>
</section>
<section id="A1.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Anytime Federated Learning</h4>

<div id="A1.SS0.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="A1.SS0.SSS0.Px3.p1.1" class="ltx_p">The major difference from the conventional FL is that the exit layer <math id="A1.SS0.SSS0.Px3.p1.1.m1.2" class="ltx_Math" alttext="l\in[1,12]" display="inline"><semantics id="A1.SS0.SSS0.Px3.p1.1.m1.2a"><mrow id="A1.SS0.SSS0.Px3.p1.1.m1.2.3" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.cmml"><mi id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.cmml">l</mi><mo id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="A1.SS0.SSS0.Px3.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml">1</mn><mo id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px3.p1.1.m1.2.2" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.2.cmml">12</mn><mo stretchy="false" id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2.3" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px3.p1.1.m1.2b"><apply id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3"><in id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.1"></in><ci id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.2">𝑙</ci><interval closure="closed" id="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.3.3.2"><cn type="integer" id="A1.SS0.SSS0.Px3.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.1.1">1</cn><cn type="integer" id="A1.SS0.SSS0.Px3.p1.1.m1.2.2.cmml" xref="A1.SS0.SSS0.Px3.p1.1.m1.2.2">12</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px3.p1.1.m1.2c">l\in[1,12]</annotation></semantics></math> for each client is randomly sampled from a uniform distribution for each training iteration.
The total training round is set to 1500.</p>
</div>
</section>
<section id="A1.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Multi-tier based Federated Learning</h4>

<div id="A1.SS0.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="A1.SS0.SSS0.Px4.p1.2" class="ltx_p">Exit layer is no longer produced by random sampling, but a fixed value that represents the current computing power of the client.
In other words, each client will be assigned a permanent <math id="A1.SS0.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A1.SS0.SSS0.Px4.p1.1.m1.1a"><mi id="A1.SS0.SSS0.Px4.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px4.p1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.1.m1.1b"><ci id="A1.SS0.SSS0.Px4.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px4.p1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.1.m1.1c">l</annotation></semantics></math> during the anytime FL.
The distribution of clients’ exit layer <math id="A1.SS0.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="A1.SS0.SSS0.Px4.p1.2.m2.1a"><mi id="A1.SS0.SSS0.Px4.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px4.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px4.p1.2.m2.1b"><ci id="A1.SS0.SSS0.Px4.p1.2.m2.1.1.cmml" xref="A1.SS0.SSS0.Px4.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px4.p1.2.m2.1c">l</annotation></semantics></math> is balanced.
The total training round is set to 1500.</p>
</div>
</section>
<section id="A1.SS0.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Personalization</h4>

<div id="A1.SS0.SSS0.Px5.p1" class="ltx_para ltx_noindent">
<p id="A1.SS0.SSS0.Px5.p1.1" class="ltx_p">Following the data corruption methods in  <cite class="ltx_cite ltx_citemacro_cite">Hendrycks and Dietterich, (<a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>, we apply a corruption policy with different severity <math id="A1.SS0.SSS0.Px5.p1.1.m1.2" class="ltx_Math" alttext="s\in[0,5]" display="inline"><semantics id="A1.SS0.SSS0.Px5.p1.1.m1.2a"><mrow id="A1.SS0.SSS0.Px5.p1.1.m1.2.3" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.cmml"><mi id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.2" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.2.cmml">s</mi><mo id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.1" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.2" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.2.1" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.1.cmml">[</mo><mn id="A1.SS0.SSS0.Px5.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px5.p1.1.m1.1.1.cmml">0</mn><mo id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.2.2" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="A1.SS0.SSS0.Px5.p1.1.m1.2.2" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.2.cmml">5</mn><mo stretchy="false" id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.2.3" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS0.SSS0.Px5.p1.1.m1.2b"><apply id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.cmml" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3"><in id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.1.cmml" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.1"></in><ci id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.2.cmml" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.2">𝑠</ci><interval closure="closed" id="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.1.cmml" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.3.3.2"><cn type="integer" id="A1.SS0.SSS0.Px5.p1.1.m1.1.1.cmml" xref="A1.SS0.SSS0.Px5.p1.1.m1.1.1">0</cn><cn type="integer" id="A1.SS0.SSS0.Px5.p1.1.m1.2.2.cmml" xref="A1.SS0.SSS0.Px5.p1.1.m1.2.2">5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS0.SSS0.Px5.p1.1.m1.2c">s\in[0,5]</annotation></semantics></math> as unique style for each client’s local data.
Then, we fine-tune the pre-trained multi-tier model with a predefined exit layer on these data for 10 local epochs.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experiments</h2>

<section id="A2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Communication Cost of Different Methods.</h4>

<div id="A2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="A2.SS0.SSS0.Px1.p1.3" class="ltx_p">Table <a href="#A2.T6" title="Table 6 ‣ Communication Cost of Different Methods. ‣ Appendix B Additional Experiments ‣ Federated Learning for Inference at Anytime and Anywhere" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the communication cost of different methods to reach a target test accuracy, which is set as the best performance of the L.W. Linear head here. We can see from the results that our Accumulator as such achieves the lowest cost to reach the target by only cost <math id="A2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="40*3.17" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="A2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">40</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">∗</mo><mn id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">3.17</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1"><times id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.1"></times><cn type="integer" id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2">40</cn><cn type="float" id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3">3.17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p1.1.m1.1c">40*3.17</annotation></semantics></math> and <math id="A2.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="40*2.99" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">40</mn><mo lspace="0.222em" rspace="0.222em" id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml">∗</mo><mn id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml">2.99</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p1.2.m2.1b"><apply id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1"><times id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.1"></times><cn type="integer" id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.2">40</cn><cn type="float" id="A2.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.3">2.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p1.2.m2.1c">40*2.99</annotation></semantics></math> message size for CIFAR-100 (<math id="A2.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.3.m3.1a"><mrow id="A2.SS0.SSS0.Px1.p1.3.m3.1.1" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.2" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml">α</mi><mo id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.1" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.3" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS0.SSS0.Px1.p1.3.m3.1b"><apply id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1"><eq id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.1"></eq><ci id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.2">𝛼</ci><cn type="float" id="A2.SS0.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="A2.SS0.SSS0.Px1.p1.3.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS0.SSS0.Px1.p1.3.m3.1c">\alpha=0.1</annotation></semantics></math>) and FEMNIST(Non-IID).</p>
</div>
<figure id="A2.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Transmitted message size (# communication round<math id="A2.T6.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.2.m1.1b"><mo id="A2.T6.2.m1.1.1" xref="A2.T6.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.2.m1.1c"><times id="A2.T6.2.m1.1.1.cmml" xref="A2.T6.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.2.m1.1d">\times</annotation></semantics></math># model parameters (M)) required to reach a target performance with multi-tier FL on CIFAR-100 and FEMNIST (<span id="A2.T6.19.1" class="ltx_text" style="color:#FF0000;">best</span> and <span id="A2.T6.20.2" class="ltx_text" style="color:#0000FF;">second best</span>).</figcaption>
<div id="A2.T6.16" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:411.2pt;height:58.4pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-51.4pt,7.2pt) scale(0.8,0.8) ;">
<table id="A2.T6.16.14" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T6.16.14.15.1" class="ltx_tr">
<td id="A2.T6.16.14.15.1.1" class="ltx_td ltx_border_r ltx_border_tt"></td>
<td id="A2.T6.16.14.15.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="A2.T6.16.14.15.1.2.1" class="ltx_text">Fine-tuning</span></td>
<td id="A2.T6.16.14.15.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="A2.T6.16.14.15.1.3.1" class="ltx_text">L.W. Linear</span></td>
<td id="A2.T6.16.14.15.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">L.W. Linear</td>
<td id="A2.T6.16.14.15.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="A2.T6.16.14.15.1.5.1" class="ltx_text">L.W. MLP</span></td>
<td id="A2.T6.16.14.15.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">L.W. MLP</td>
<td id="A2.T6.16.14.15.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="2"><span id="A2.T6.16.14.15.1.7.1" class="ltx_text">Accumulator</span></td>
<td id="A2.T6.16.14.15.1.8" class="ltx_td ltx_align_center ltx_border_tt">Accumulator</td>
</tr>
<tr id="A2.T6.16.14.16.2" class="ltx_tr">
<td id="A2.T6.16.14.16.2.1" class="ltx_td ltx_border_r"></td>
<td id="A2.T6.16.14.16.2.2" class="ltx_td ltx_align_center ltx_border_r">+Adapter</td>
<td id="A2.T6.16.14.16.2.3" class="ltx_td ltx_align_center ltx_border_r">+Adapter</td>
<td id="A2.T6.16.14.16.2.4" class="ltx_td ltx_align_center">+Adapter</td>
</tr>
<tr id="A2.T6.9.7.7" class="ltx_tr">
<td id="A2.T6.9.7.7.8" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">CIFAR-100</td>
<td id="A2.T6.3.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">90<math id="A2.T6.3.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.3.1.1.1.m1.1a"><mo id="A2.T6.3.1.1.1.m1.1.1" xref="A2.T6.3.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.3.1.1.1.m1.1b"><times id="A2.T6.3.1.1.1.m1.1.1.cmml" xref="A2.T6.3.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.3.1.1.1.m1.1c">\times</annotation></semantics></math>30.62</td>
<td id="A2.T6.4.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1500<math id="A2.T6.4.2.2.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.4.2.2.2.m1.1a"><mo id="A2.T6.4.2.2.2.m1.1.1" xref="A2.T6.4.2.2.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.4.2.2.2.m1.1b"><times id="A2.T6.4.2.2.2.m1.1.1.cmml" xref="A2.T6.4.2.2.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.4.2.2.2.m1.1c">\times</annotation></semantics></math>0.46</td>
<td id="A2.T6.5.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140<math id="A2.T6.5.3.3.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.5.3.3.3.m1.1a"><mo id="A2.T6.5.3.3.3.m1.1.1" xref="A2.T6.5.3.3.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.5.3.3.3.m1.1b"><times id="A2.T6.5.3.3.3.m1.1.1.cmml" xref="A2.T6.5.3.3.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.5.3.3.3.m1.1c">\times</annotation></semantics></math>1.06</td>
<td id="A2.T6.6.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">610<math id="A2.T6.6.4.4.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.6.4.4.4.m1.1a"><mo id="A2.T6.6.4.4.4.m1.1.1" xref="A2.T6.6.4.4.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.6.4.4.4.m1.1b"><times id="A2.T6.6.4.4.4.m1.1.1.cmml" xref="A2.T6.6.4.4.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.6.4.4.4.m1.1c">\times</annotation></semantics></math>8.95</td>
<td id="A2.T6.7.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">165<math id="A2.T6.7.5.5.5.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.7.5.5.5.m1.1a"><mo id="A2.T6.7.5.5.5.m1.1.1" xref="A2.T6.7.5.5.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.7.5.5.5.m1.1b"><times id="A2.T6.7.5.5.5.m1.1.1.cmml" xref="A2.T6.7.5.5.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.7.5.5.5.m1.1c">\times</annotation></semantics></math>9.55</td>
<td id="A2.T6.8.6.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A2.T6.8.6.6.6.1" class="ltx_text" style="color:#FF0000;">40<math id="A2.T6.8.6.6.6.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.8.6.6.6.1.m1.1a"><mo mathcolor="#FF0000" id="A2.T6.8.6.6.6.1.m1.1.1" xref="A2.T6.8.6.6.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.8.6.6.6.1.m1.1b"><times id="A2.T6.8.6.6.6.1.m1.1.1.cmml" xref="A2.T6.8.6.6.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.8.6.6.6.1.m1.1c">\times</annotation></semantics></math>3.17</span></td>
<td id="A2.T6.9.7.7.7" class="ltx_td ltx_align_center ltx_border_t"><span id="A2.T6.9.7.7.7.1" class="ltx_text" style="color:#0000FF;">100<math id="A2.T6.9.7.7.7.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.9.7.7.7.1.m1.1a"><mo mathcolor="#0000FF" id="A2.T6.9.7.7.7.1.m1.1.1" xref="A2.T6.9.7.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.9.7.7.7.1.m1.1b"><times id="A2.T6.9.7.7.7.1.m1.1.1.cmml" xref="A2.T6.9.7.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.9.7.7.7.1.m1.1c">\times</annotation></semantics></math>3.77</span></td>
</tr>
<tr id="A2.T6.16.14.14" class="ltx_tr">
<td id="A2.T6.16.14.14.8" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t">FEMNIST</td>
<td id="A2.T6.10.8.8.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">60<math id="A2.T6.10.8.8.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.10.8.8.1.m1.1a"><mo id="A2.T6.10.8.8.1.m1.1.1" xref="A2.T6.10.8.8.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.10.8.8.1.m1.1b"><times id="A2.T6.10.8.8.1.m1.1.1.cmml" xref="A2.T6.10.8.8.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.10.8.8.1.m1.1c">\times</annotation></semantics></math>30.44</td>
<td id="A2.T6.11.9.9.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">1500<math id="A2.T6.11.9.9.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.11.9.9.2.m1.1a"><mo id="A2.T6.11.9.9.2.m1.1.1" xref="A2.T6.11.9.9.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.11.9.9.2.m1.1b"><times id="A2.T6.11.9.9.2.m1.1.1.cmml" xref="A2.T6.11.9.9.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.11.9.9.2.m1.1c">\times</annotation></semantics></math>0.28</td>
<td id="A2.T6.12.10.10.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="A2.T6.12.10.10.3.1" class="ltx_text" style="color:#0000FF;">160<math id="A2.T6.12.10.10.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.12.10.10.3.1.m1.1a"><mo mathcolor="#0000FF" id="A2.T6.12.10.10.3.1.m1.1.1" xref="A2.T6.12.10.10.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.12.10.10.3.1.m1.1b"><times id="A2.T6.12.10.10.3.1.m1.1.1.cmml" xref="A2.T6.12.10.10.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.12.10.10.3.1.m1.1c">\times</annotation></semantics></math>0.88</span></td>
<td id="A2.T6.13.11.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">1500<math id="A2.T6.13.11.11.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.13.11.11.4.m1.1a"><mo id="A2.T6.13.11.11.4.m1.1.1" xref="A2.T6.13.11.11.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.13.11.11.4.m1.1b"><times id="A2.T6.13.11.11.4.m1.1.1.cmml" xref="A2.T6.13.11.11.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.13.11.11.4.m1.1c">\times</annotation></semantics></math>8.77</td>
<td id="A2.T6.14.12.12.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">240<math id="A2.T6.14.12.12.5.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.14.12.12.5.m1.1a"><mo id="A2.T6.14.12.12.5.m1.1.1" xref="A2.T6.14.12.12.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.14.12.12.5.m1.1b"><times id="A2.T6.14.12.12.5.m1.1.1.cmml" xref="A2.T6.14.12.12.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.14.12.12.5.m1.1c">\times</annotation></semantics></math>9.37</td>
<td id="A2.T6.15.13.13.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="A2.T6.15.13.13.6.1" class="ltx_text" style="color:#FF0000;">40<math id="A2.T6.15.13.13.6.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.15.13.13.6.1.m1.1a"><mo mathcolor="#FF0000" id="A2.T6.15.13.13.6.1.m1.1.1" xref="A2.T6.15.13.13.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.15.13.13.6.1.m1.1b"><times id="A2.T6.15.13.13.6.1.m1.1.1.cmml" xref="A2.T6.15.13.13.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.15.13.13.6.1.m1.1c">\times</annotation></semantics></math>2.99</span></td>
<td id="A2.T6.16.14.14.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">80<math id="A2.T6.16.14.14.7.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A2.T6.16.14.14.7.m1.1a"><mo id="A2.T6.16.14.14.7.m1.1.1" xref="A2.T6.16.14.14.7.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A2.T6.16.14.14.7.m1.1b"><times id="A2.T6.16.14.14.7.m1.1.1.cmml" xref="A2.T6.16.14.14.7.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.16.14.14.7.m1.1c">\times</annotation></semantics></math>3.59</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A2.T7" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>The computational and memory budgets across all exit layers with Deit-S as the foundation model. The memory and compute footprint increases linearly with the layer at which the early exit is triggered. During training, the memory peak can be largely reduced if the base model is kept frozen, allowing in this way the participation of more constrained devices.</figcaption>
<div id="A2.T7.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:396.9pt;height:72.8pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-49.6pt,9.0pt) scale(0.8,0.8) ;">
<table id="A2.T7.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T7.1.1.2.1" class="ltx_tr">
<td id="A2.T7.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Early Exit Layer</td>
<td id="A2.T7.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0</td>
<td id="A2.T7.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">1</td>
<td id="A2.T7.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">2</td>
<td id="A2.T7.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">3</td>
<td id="A2.T7.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">4</td>
<td id="A2.T7.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">5</td>
<td id="A2.T7.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">6</td>
<td id="A2.T7.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">7</td>
<td id="A2.T7.1.1.2.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">8</td>
<td id="A2.T7.1.1.2.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">9</td>
<td id="A2.T7.1.1.2.1.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">10</td>
<td id="A2.T7.1.1.2.1.13" class="ltx_td ltx_align_center ltx_border_tt">11</td>
</tr>
<tr id="A2.T7.1.1.3.2" class="ltx_tr">
<td id="A2.T7.1.1.3.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FLOPs(GB)</td>
<td id="A2.T7.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.21</td>
<td id="A2.T7.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.40</td>
<td id="A2.T7.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.57</td>
<td id="A2.T7.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.67</td>
<td id="A2.T7.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.95</td>
<td id="A2.T7.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.13</td>
<td id="A2.T7.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.31</td>
<td id="A2.T7.1.1.3.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.50</td>
<td id="A2.T7.1.1.3.2.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.69</td>
<td id="A2.T7.1.1.3.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.88</td>
<td id="A2.T7.1.1.3.2.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.07</td>
<td id="A2.T7.1.1.3.2.13" class="ltx_td ltx_align_center ltx_border_t">2.67</td>
</tr>
<tr id="A2.T7.1.1.4.3" class="ltx_tr">
<td id="A2.T7.1.1.4.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Params(MB)</td>
<td id="A2.T7.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.54</td>
<td id="A2.T7.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">4.34</td>
<td id="A2.T7.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.15</td>
<td id="A2.T7.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.96</td>
<td id="A2.T7.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.77</td>
<td id="A2.T7.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.57</td>
<td id="A2.T7.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">13.38</td>
<td id="A2.T7.1.1.4.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15.19</td>
<td id="A2.T7.1.1.4.3.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16.99</td>
<td id="A2.T7.1.1.4.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">18.80</td>
<td id="A2.T7.1.1.4.3.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">20.60</td>
<td id="A2.T7.1.1.4.3.13" class="ltx_td ltx_align_center ltx_border_t">22.41</td>
</tr>
<tr id="A2.T7.1.1.5.4" class="ltx_tr">
<td id="A2.T7.1.1.5.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mem. Peak(MB)</td>
<td id="A2.T7.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">67</td>
<td id="A2.T7.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">123</td>
<td id="A2.T7.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">179</td>
<td id="A2.T7.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">236</td>
<td id="A2.T7.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">293</td>
<td id="A2.T7.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">350</td>
<td id="A2.T7.1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">407</td>
<td id="A2.T7.1.1.5.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">464</td>
<td id="A2.T7.1.1.5.4.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">522</td>
<td id="A2.T7.1.1.5.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">580</td>
<td id="A2.T7.1.1.5.4.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">638</td>
<td id="A2.T7.1.1.5.4.13" class="ltx_td ltx_align_center ltx_border_t">670</td>
</tr>
<tr id="A2.T7.1.1.1" class="ltx_tr">
<td id="A2.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">Mem. Peak(MB)<math id="A2.T7.1.1.1.1.m1.1" class="ltx_Math" alttext="{}_{\text{frozen}}" display="inline"><semantics id="A2.T7.1.1.1.1.m1.1a"><msub id="A2.T7.1.1.1.1.m1.1.1" xref="A2.T7.1.1.1.1.m1.1.1.cmml"><mi id="A2.T7.1.1.1.1.m1.1.1a" xref="A2.T7.1.1.1.1.m1.1.1.cmml"></mi><mtext id="A2.T7.1.1.1.1.m1.1.1.1" xref="A2.T7.1.1.1.1.m1.1.1.1a.cmml">frozen</mtext></msub><annotation-xml encoding="MathML-Content" id="A2.T7.1.1.1.1.m1.1b"><apply id="A2.T7.1.1.1.1.m1.1.1.cmml" xref="A2.T7.1.1.1.1.m1.1.1"><ci id="A2.T7.1.1.1.1.m1.1.1.1a.cmml" xref="A2.T7.1.1.1.1.m1.1.1.1"><mtext mathsize="70%" id="A2.T7.1.1.1.1.m1.1.1.1.cmml" xref="A2.T7.1.1.1.1.m1.1.1.1">frozen</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T7.1.1.1.1.m1.1c">{}_{\text{frozen}}</annotation></semantics></math>
</td>
<td id="A2.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">47</td>
<td id="A2.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">62</td>
<td id="A2.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">98</td>
<td id="A2.T7.1.1.1.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">134</td>
<td id="A2.T7.1.1.1.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">170</td>
<td id="A2.T7.1.1.1.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">206</td>
<td id="A2.T7.1.1.1.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">242</td>
<td id="A2.T7.1.1.1.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">279</td>
<td id="A2.T7.1.1.1.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">315</td>
<td id="A2.T7.1.1.1.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">352</td>
<td id="A2.T7.1.1.1.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">389</td>
<td id="A2.T7.1.1.1.13" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">426</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2212.04083" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2212.04084" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2212.04084">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2212.04084" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2212.04085" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 08:54:42 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
