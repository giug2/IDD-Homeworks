<article class="ltx_document ltx_authors_1line ltx_leqno">
 <h1 class="ltx_title ltx_title_document">
  Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Zheng Wang
    <sup class="ltx_sup" id="id5.5.id1">
     <span class="ltx_text ltx_font_italic" id="id5.5.id1.1">
      1
     </span>
    </sup>
    , Bingzheng Gan
    <sup class="ltx_sup" id="id6.6.id2">
     <span class="ltx_text ltx_font_italic" id="id6.6.id2.1">
      1
     </span>
    </sup>
    , Wei Shi
    <sup class="ltx_sup" id="id7.7.id3">
     <span class="ltx_text ltx_font_italic" id="id7.7.id3.1">
      1
     </span>
    </sup>
   </span>
   <span class="ltx_author_notes">
    <span class="ltx_contact ltx_role_affiliation">
     <span class="ltx_text ltx_affiliation_institution" id="id4.4.1">
      <sup class="ltx_sup" id="id4.4.1.1">
       1
      </sup>
      Huawei Singapore Research Center
      <span class="ltx_text ltx_affiliation_country" id="id4.4.1.2">
       Singapore
      </span>
     </span>
    </span>
    <span class="ltx_contact ltx_role_email">
     <a href="mailto:wangzheng155,%20gan.bingzheng,%20w.shi@huawei.com">
      wangzheng155, gan.bingzheng, w.shi@huawei.com
     </a>
    </span>
   </span>
  </span>
 </div>
 <div class="ltx_dates">
  (2024)
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract.
  </h6>
  <p class="ltx_p" id="id8.id1">
   In the rapidly evolving landscape of information retrieval, search engines strive to provide more personalized and relevant results to users. Query suggestion systems play a crucial role in achieving this goal by assisting users in formulating effective queries. However, existing query suggestion systems mainly rely on textual inputs, potentially limiting user search experiences for querying images. In this paper, we introduce a novel Multimodal Query Suggestion (MMQS) task, which aims to generate query suggestions based on user query images to improve the intentionality and diversity of search results. We present the
   <span class="ltx_text ltx_font_typewriter" id="id8.id1.1">
    RL4Sugg
   </span>
   framework, leveraging the power of Large Language Models (LLMs) with Multi-Agent Reinforcement Learning from Human Feedback to optimize the generation process. Through comprehensive experiments, we validate the effectiveness of
   <span class="ltx_text ltx_font_typewriter" id="id8.id1.2">
    RL4Sugg
   </span>
   , demonstrating a 18% improvement compared to the best existing approach. Moreover, the MMQS has been transferred into real-world search engine products, which yield enhanced user engagement. Our research advances query suggestion systems and provides a new perspective on multimodal information retrieval.
  </p>
 </div>
 <div class="ltx_keywords">
  multimodal query suggestion, multi-agent reinforcement learning from human feedback, vision-language pre-training
 </div>
 <span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     journalyear:
    </span>
    2024
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     copyright:
    </span>
    acmlicensed
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     conference:
    </span>
    Proceedings of the ACM Web Conference 2024; May 13–17, 2024; Singapore
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     booktitle:
    </span>
    Proceedings of the ACM Web Conference 2024 (WWW’24), May 13–17, 2024, Singapore
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_price" id="id5">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     price:
    </span>
    15.00
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     doi:
    </span>
    10.1145/3543507.3583304
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id7">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     isbn:
    </span>
    978-1-4503-9416-1/23/04
   </span>
  </span>
 </span>
 <span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8">
  <sup class="ltx_note_mark">
   †
  </sup>
  <span class="ltx_note_outer">
   <span class="ltx_note_content">
    <sup class="ltx_note_mark">
     †
    </sup>
    <span class="ltx_note_type">
     ccs:
    </span>
    Information systems Query suggestion
   </span>
  </span>
 </span>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1.
   </span>
   INTRODUCTION
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Search engines have become an indispensable tool for information retrieval, aiding users in finding relevant content in vast online repositories. Traditional keyword-based search methods
    <cite class="ltx_cite ltx_citemacro_citep">
     (Xu and Croft,
     <a class="ltx_ref" href="#bib.bib47" title="">
      2017
     </a>
     ; Lam-Adesina and Jones,
     <a class="ltx_ref" href="#bib.bib24" title="">
      2001
     </a>
     )
    </cite>
    , while effective, often require users to precisely articulate their information needs, leading to potential challenges in formulating accurate queries. To enhance the search experience and provide more user-friendly alternatives, query suggestion systems have gained prominence. These systems aim to generate relevant and contextually appropriate suggestions based on users’ current query input, reducing the cognitive burden on users and increasing the efficiency of information discovery.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="280" id="S1.F1.g1" src="/html/2402.04867/assets/x1.png" width="438"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1.
    </span>
    Illustration of MMQS problem.
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    There are two well-established query suggestion systems that have been extensively studied: Textual Query Suggestion (TQS)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shokouhi,
     <a class="ltx_ref" href="#bib.bib40" title="">
      2013
     </a>
     ; Bar-Yossef and Kraus,
     <a class="ltx_ref" href="#bib.bib3" title="">
      2011
     </a>
     ; Hagen et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib18" title="">
      2017
     </a>
     ; Carpineto and Romano,
     <a class="ltx_ref" href="#bib.bib6" title="">
      2012
     </a>
     ; Gottlob et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib16" title="">
      2014
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib15" title="">
      2011
     </a>
     )
    </cite>
    and Visual Query Suggestion (VQS)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zha et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib51" title="">
      2009
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib52" title="">
      2010
     </a>
     ; Zeng et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib50" title="">
      2017
     </a>
     ; Li and Li,
     <a class="ltx_ref" href="#bib.bib29" title="">
      2011
     </a>
     )
    </cite>
    . In TQS, it is capable to automatically suggest a list of keywords based on users’ current queries, a feature that many existing search engines have already implemented. Its primary purpose is to assist users in formulating their search intents clearly and conveniently (as illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1. INTRODUCTION ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    (a)). In VQS, the suggestions generated by TQS might be inadequate for users who lack familiarity with the suggested terms. To address this issue, incorporating visual examples along with the suggestions can greatly improve the user experience and help users better understand the context (as illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1. INTRODUCTION ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    (b)). The limitation of these systems is that they mainly rely on users’ text inputs to generate potential suggestions. However, images contain rich information that can be quickly perceived. There are some situations where users can imagine what they desire but find it challenging to express it concisely in words. For example, imagine a scenario where a user’s bicycle breaks down while riding on the street. In such a case, the intuitive search for the user would be to quickly take a photo of the bicycle to query for a solution rather than relying on TQS or VQS to describe the current issue in text. If the user types “bicycle” in a search box, the suggestions provided may be “bicycle poker”, “bicycle shop”, and “bicycle pump”, which are all irrelevant in expressing the user’s intent. In addition, to further enhance the query suggestions, it is desirable for the system to not only provide guidance on fixing a broken bicycle but also offer other useful information, such as nearby bicycle repair stalls and possible reasons why his/her bicycle frequently breaks. These diverse choices allow users to explore the information they may need effectively (as illustrated in Figure
    <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1. INTRODUCTION ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    (c)).
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    Motivated by practical scenarios, we introduce a novel query formulation, called Multimodal Query Suggestion (MMQS). It takes a user query image as input and generates query suggestions to response to the user’s search intent. Given that the query suggestions are intended to assist users in activating search engines, the design of MMQS focuses on two essential properties:
   </p>
   <ul class="ltx_itemize" id="S1.I1">
    <li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i1.p1">
      <p class="ltx_p" id="S1.I1.i1.p1.1">
       Intentionality: The primary goal of MMQS is to capture the user’s search intent effectively. Visual data presents an opportunity to infer implicit information needs that might be challenging to articulate in words. By incorporating visual cues from user query images, MMQS aims to provide query suggestions that accurately reflect the user’s underlying intent and support more focused and relevant searches.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I1.i2.p1">
      <p class="ltx_p" id="S1.I1.i2.p1.1">
       Diversity: MMQS generates query suggestions that encompass different aspects of the query image, thereby expanding the search space. This empowers users to explore multiple aspects of information discovery, enhancing the overall search experience.
      </p>
     </div>
    </li>
   </ul>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">
     Challenges and a New Solution.
    </span>
    The formulation of the MMQS problem introduces several challenges that need innovative solutions. Data Collection (
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">
     C1
    </span>
    ): Integrating multimodal data comprising both textual and visual information poses unique data preparation challenges. Specifically, it involves generating image-suggestion pairs, a property not presents in many publicly available image-text datasets (e.g., COCO Captions
    <cite class="ltx_cite ltx_citemacro_citep">
     (Lin et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib30" title="">
      2014
     </a>
     )
    </cite>
    or Flickr30k Entities
    <cite class="ltx_cite ltx_citemacro_citep">
     (Plummer et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib35" title="">
      2015
     </a>
     )
    </cite>
    ). Moreover, annotating user intent can be time-consuming and lacks clear guidelines. Therefore, developing efficient and effective strategies for data collection, automated pairing, and reliable annotation becomes crucial for the success of MMQS.
Capturing Intentionality and Diversity (
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">
     C2
    </span>
    ): Inferring user intent from a query image and generating diverse suggestions is a complex task. It requires understanding the visual context and associations between images and textual suggestions. Achieving both intentionality and diversity meanwhile in the generated suggestions necessitates carefully designed techniques to align with user intent and avoid redundancy.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    To address the aforementioned challenges, we propose a novel
    <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.1">
     RL4Sugg
    </span>
    framework, leveraging the capabilities of Large Language Models (LLMs) with Multi-Agent Reinforcement Learning to generate query suggestions based on input images.
To tackle
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.2">
     C1
    </span>
    , we leverage the current GPT language generation capabilities to automate the collection of image-suggestion pairs and user intent annotations based on potential clicks. We employ a threshold-based mechanism that selectively involves manual effort for suggestions with lower confidence scores, ensuring high-quality annotations while striking a balance between automation and human input in the data labeling process.
To tackle
    <span class="ltx_text ltx_font_bold" id="S1.p5.1.3">
     C2
    </span>
    , we study a novel solution based on multi-agent reinforcement learning, where we employ two distinct agents within the framework: Agent-I, responsible for intentionality, and Agent-D, responsible for diversity. Specifically, the Agent-I first generates a set of intentional candidate suggestions, which incorporates a RewardNet and a PolicyNet tailored for this task. The RewardNet utilizes multi-task learning to align image-suggestion pairs and assigns rewards to these pairs. Following this, the PolicyNet is trained through Reinforcement Learning from Human Feedback (RLHF) to enhance the intentionality of the suggestions. Further, the Agent-D selects diverse suggestions from the candidate pool, which is designed to cooperate with the Agent-I to ensure that both intentionality and diversity are optimized explicitly in an end-to-end training.
   </p>
  </div>
  <div class="ltx_para" id="S1.p6">
   <p class="ltx_p" id="S1.p6.1">
    Our contributions can be summarized as follows:
   </p>
   <ul class="ltx_itemize" id="S1.I2">
    <li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i1.p1">
      <p class="ltx_p" id="S1.I2.i1.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i1.p1.1.1">
        The MMQS Task:
       </span>
       We introduce a novel query formulation, called Multimodal Query Suggestion (MMQS), which addresses the gap between multimodal data and query suggestions in search engines. Our objective is to improve the user search experience by providing intentional and diverse query suggestions generated from user query images. To the best of our knowledge, this work presents the first attempt in its kind.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i2.p1">
      <p class="ltx_p" id="S1.I2.i2.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i2.p1.1.1">
        The
        <span class="ltx_text ltx_font_typewriter" id="S1.I2.i2.p1.1.1.1">
         RL4Sugg
        </span>
        Framework:
       </span>
       We present a novel framework called
       <span class="ltx_text ltx_font_typewriter" id="S1.I2.i2.p1.1.2">
        RL4Sugg
       </span>
       , which is designed to generate query suggestions using user input images. By leveraging the capabilities of LLMs and multi-agent reinforcement learning,
       <span class="ltx_text ltx_font_typewriter" id="S1.I2.i2.p1.1.3">
        RL4Sugg
       </span>
       optimizes the intentionality and diversity of the generated suggestions through an end-to-end training.
      </p>
     </div>
    </li>
    <li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
     <span class="ltx_tag ltx_tag_item">
      •
     </span>
     <div class="ltx_para" id="S1.I2.i3.p1">
      <p class="ltx_p" id="S1.I2.i3.p1.1">
       <span class="ltx_text ltx_font_bold" id="S1.I2.i3.p1.1.1">
        Comprehensive Experiments:
       </span>
       We conduct extensive experiments on two real-world datasets and achieve promising results than various baselines. Our experiments demonstrate the effectiveness of our proposed framework in generating intentional and diverse query suggestions (e.g., it demonstrates 18% improvement compared to the best baseline method). In addition, the proposed MMQS has been transferred into products, and the results show that the deployed system effectively enhances user engagement of search engines.
      </p>
     </div>
    </li>
   </ul>
  </div>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2.
   </span>
   RELATED WORK
  </h2>
  <div class="ltx_para ltx_noindent" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    <span class="ltx_text ltx_font_bold" id="S2.p1.1.1">
     Query Suggestion.
    </span>
    Query suggestion is a feature of search engines that provides users with a list of possible queries based on their current query inputs. We review the literature in terms of Textual Query Suggestion (TQS) and Visual Query Suggestion (VQS). For TQS, it relies on the text of the user’s query to generate a list of possible textual queries. There are a number of different methods for generating the query suggestions, including (i) query auto completion
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shokouhi,
     <a class="ltx_ref" href="#bib.bib40" title="">
      2013
     </a>
     ; Bar-Yossef and Kraus,
     <a class="ltx_ref" href="#bib.bib3" title="">
      2011
     </a>
     )
    </cite>
    , (ii) query spelling correction
    <cite class="ltx_cite ltx_citemacro_citep">
     (Hagen et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib18" title="">
      2017
     </a>
     )
    </cite>
    , (iii) query expansion
    <cite class="ltx_cite ltx_citemacro_citep">
     (Carpineto and Romano,
     <a class="ltx_ref" href="#bib.bib6" title="">
      2012
     </a>
     )
    </cite>
    , and (iv) query rewriting
    <cite class="ltx_cite ltx_citemacro_citep">
     (Gottlob et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib16" title="">
      2014
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib15" title="">
      2011
     </a>
     )
    </cite>
    .
Overall, TQS does not use any visual information, such as images, to generate suggestions.
   </p>
  </div>
  <div class="ltx_para" id="S2.p2">
   <p class="ltx_p" id="S2.p2.1">
    For VQS, it is introduced by Zha et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zha et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib51" title="">
      2009
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib52" title="">
      2010
     </a>
     )
    </cite>
    , which offers users both textual and visual suggestions based on their query text. This enables users to conveniently specify their search intentions. When a user selects a text-image pair from the suggestion list, the VQS system performs an image search using the provided text and employs the selected image to filter initial search results by leveraging its visual content. Subsequently, many techniques are proposed for the VQS. For example,
Zeng et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zeng et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib50" title="">
      2017
     </a>
     )
    </cite>
    develop a new client-side photo search system, which uses VQS and joint text-image hashing to improve the search accuracy and efficiency.
Li et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     (Li and Li,
     <a class="ltx_ref" href="#bib.bib29" title="">
      2011
     </a>
     )
    </cite>
    study video search, and a multimodal method is developed to process the joint text and images suggestions produced by VQS.
Overall, our MMQS problem differs from VQS mainly in that the user’s query input is different. In MMQS, the input is images, while in VQS, it is text. Additionally, Bian et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     (Bian et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib4" title="">
      2012
     </a>
     )
    </cite>
    study a new setting of VQS called Visual Query Attributes Suggestion (VQAS), where an image is inputted and VQAS suggests informative attributes (e.g., color, texture, shape) extracted from the query image via some SVM classifiers. These attributes allow users to select and express more precise search intents. Our work differs from VQAS in two aspects. First, MMQS outputs query suggestions instead of those image attributes, where the suggestions need satisfying the intentionality and diversity properties. Second, we propose a multi-agent reinforcement learning based framework to generate the suggestions from large language models instead of choosing those pre-defined attributes using the classifiers.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p3">
   <p class="ltx_p" id="S2.p3.1">
    <span class="ltx_text ltx_font_bold" id="S2.p3.1.1">
     Vision-Language Pre-training.
    </span>
    Our work is related to Vision-Language Pre-training (VLP) in techniques. VLP aims to train a multimodal foundation model to align the relationships between images and text, and then the model is used to support various downstream vision-and-language tasks (e.g., image captioning or visual question answering). The literature on VLP training strategies can be categorized into three main approaches: end-to-end pre-training
    <cite class="ltx_cite ltx_citemacro_citep">
     (Li et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2023
     </a>
     ; Radford et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib36" title="">
      2021
     </a>
     ; Jia et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib22" title="">
      2021
     </a>
     ; Li et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib28" title="">
      2021
     </a>
     ; Cho et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib8" title="">
      2021
     </a>
     ; Wang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib43" title="">
      2021
     </a>
     ; Li et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib27" title="">
      2022
     </a>
     ; Wang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib42" title="">
      2023
     </a>
     ; Huang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib19" title="">
      2023
     </a>
     )
    </cite>
    , modular pre-training
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zhai et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib53" title="">
      2022
     </a>
     ; Zhang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib54" title="">
      2021
     </a>
     ; Driess et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib13" title="">
      2023
     </a>
     ; Guo et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib17" title="">
      2022
     </a>
     ; Chen et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2022
     </a>
     ; Li et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2023
     </a>
     ; Alayrac et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2022
     </a>
     ; Liu et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2023
     </a>
     )
    </cite>
    , and zero-shot
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wu et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib45" title="">
      2023
     </a>
     ; Shen et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2023
     </a>
     ; Yang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib48" title="">
      2023
     </a>
     )
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S2.p4">
   <p class="ltx_p" id="S2.p4.1">
    Our work falls into the modular pre-training, where it makes use of off-the-shelf pre-trained models, keeping them frozen during the pre-training. Existing studies can be categorized according to different frozen components, including the approaches that freeze image encoders
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zhai et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib53" title="">
      2022
     </a>
     ; Zhang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib54" title="">
      2021
     </a>
     )
    </cite>
    , language models
    <cite class="ltx_cite ltx_citemacro_citep">
     (Driess et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib13" title="">
      2023
     </a>
     ; Guo et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib17" title="">
      2022
     </a>
     ; Chen et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib7" title="">
      2022
     </a>
     )
    </cite>
    , and both
    <cite class="ltx_cite ltx_citemacro_citep">
     (Li et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2023
     </a>
     ; Alayrac et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2022
     </a>
     ; Liu et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2023
     </a>
     )
    </cite>
    . Specifically,
Zhai et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zhai et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib53" title="">
      2022
     </a>
     )
    </cite>
    study Locked-image Tuning (LiT), where it fine-tunes language models via contrastive learning to extract useful representations from locked pre-trained image models for new vision tasks.
Driess et al.
    <cite class="ltx_cite ltx_citemacro_citep">
     (Driess et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib13" title="">
      2023
     </a>
     )
    </cite>
    propose embodied language models, which integrate visual information through a projector into language models. It freezes the language model, and just trains the image encoder with the projector for robotics tasks.
Flamingo
    <cite class="ltx_cite ltx_citemacro_citep">
     (Alayrac et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2022
     </a>
     )
    </cite>
    freezes both image encoders and language models, and introduces cross-attention layers into the language model to incorporate visual features during the fine-tuning.
Similarly, BLIP-2
    <cite class="ltx_cite ltx_citemacro_citep">
     (Li et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2023
     </a>
     )
    </cite>
    introduces an adapter called Q-Former, which injects visual features into the language model. Our
    <span class="ltx_text ltx_font_typewriter" id="S2.p4.1.1">
     RL4Sugg
    </span>
    freezes both image encoders and language models, where we introduce two lightweight agents for fine-tuning, which align the input image to generate query suggestions with RLHF.
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S2.p5">
   <p class="ltx_p" id="S2.p5.1">
    <span class="ltx_text ltx_font_bold" id="S2.p5.1.1">
     Reinforcement Learning from Human Feedback.
    </span>
    Reinforcement Learning from Human Feedback (RLHF) is an active research area that focuses on training RL agents using human-generated feedback, which is originally developed for training simple robots to interact with real-world environments for complex tasks such as Atari games
    <cite class="ltx_cite ltx_citemacro_citep">
     (Christiano et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib10" title="">
      2017
     </a>
     )
    </cite>
    .
Recently, RLHF has been applied to fine-tune various language tasks including text summarization
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wu et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib46" title="">
      2021
     </a>
     )
    </cite>
    , dialogue systems
    <cite class="ltx_cite ltx_citemacro_citep">
     (Jaques et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib20" title="">
      2019
     </a>
     ; Yi et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib49" title="">
      2019
     </a>
     )
    </cite>
    , machine translation
    <cite class="ltx_cite ltx_citemacro_citep">
     (Kreutzer et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib23" title="">
      2018
     </a>
     )
    </cite>
    , semantic parsing
    <cite class="ltx_cite ltx_citemacro_citep">
     (Lawrence and Riezler,
     <a class="ltx_ref" href="#bib.bib25" title="">
      2018
     </a>
     )
    </cite>
    , and review generation
    <cite class="ltx_cite ltx_citemacro_citep">
     (Cho et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib9" title="">
      2018
     </a>
     )
    </cite>
    . For example, InstructGPT
    <cite class="ltx_cite ltx_citemacro_citep">
     (Ouyang et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib34" title="">
      2022
     </a>
     )
    </cite>
    collects a dataset of model desired outputs written by human labelers, and it then adopts RLHF to fine-tune GPT-3
    <cite class="ltx_cite ltx_citemacro_citep">
     (Brown et al
     <span class="ltx_text">
      .
     </span>
     ,
     <a class="ltx_ref" href="#bib.bib5" title="">
      2020
     </a>
     )
    </cite>
    .
In this paper, we propose a novel multi-agent reinforcement learning framework, which incorporates RLHF to generate human intentional query suggestions. To our best knowledge, this is the first of its kind.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3.
   </span>
   PROBLEM STATEMENT
  </h2>
  <figure class="ltx_table" id="S3.T1">
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_table">
     Table 1.
    </span>
    An example of data collection. Step 1: GPT-4 generates candidate suggestions for an image. Step 2: The model assigns a label (1 or 0) to each suggestion, indicating user click intent, along with a confidence (0 to 1). Step 3: Suggestions with low confidence are filtered out by a confidence threshold (e.g., 0.5) and then undergo human annotation to produce the final labels.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.6">
    <thead class="ltx_thead">
     <tr class="ltx_tr" id="S3.T1.6.7.1">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S3.T1.6.7.1.1">
       Step 1
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S3.T1.6.7.1.2">
       Step 2
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S3.T1.6.7.1.3">
       Step 3
      </th>
     </tr>
     <tr class="ltx_tr" id="S3.T1.6.8.2">
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.6.8.2.1">
       Query Image
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.6.8.2.2">
       Suggestions (generated by GPT)
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.6.8.2.3">
       GPT Labels
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.6.8.2.4">
       Conf
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.6.8.2.5">
       Thres (0.5)
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.6.8.2.6">
       Human Labels
      </th>
      <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.6.8.2.7">
       Final Labels
      </th>
     </tr>
    </thead>
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="S3.T1.2.2">
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="S3.T1.1.1.1" rowspan="5">
       <span class="ltx_text" id="S3.T1.1.1.1.1">
        <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S3.T1.1.1.1.1.1" style="width:130.1pt;">
         <span class="ltx_p" id="S3.T1.1.1.1.1.1.1">
          <span class="ltx_text" id="S3.T1.1.1.1.1.1.1.1" style="position:relative; bottom:-0.5pt;">
           <img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_landscape" height="370" id="S3.T1.1.1.1.1.1.1.1.g1" src="/html/2402.04867/assets/x2.jpg" width="664"/>
          </span>
         </span>
        </span>
       </span>
      </td>
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.2.2.3">
       How to fix a broken bicycle chain
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.2.4">
       1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.2.5">
       0.7
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.2.2">
       <math alttext="\surd" class="ltx_Math" display="inline" id="S3.T1.2.2.2.m1.1">
        <semantics id="S3.T1.2.2.2.m1.1a">
         <mo id="S3.T1.2.2.2.m1.1.1" mathcolor="#00FF00" xref="S3.T1.2.2.2.m1.1.1.cmml">
          √
         </mo>
         <annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b">
          <csymbol cd="latexml" id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">
           square-root
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">
          \surd
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.2.6">
       -
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.2.7">
       1
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T1.3.3">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.3.3.2">
       Bicycle chain cleaning
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.3.3.3">
       1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.3.3.4">
       0.3
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.3.3.1">
       <math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.3.3.1.m1.1">
        <semantics id="S3.T1.3.3.1.m1.1a">
         <mo id="S3.T1.3.3.1.m1.1.1" mathcolor="#FF0000" xref="S3.T1.3.3.1.m1.1.1.cmml">
          ×
         </mo>
         <annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b">
          <times id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">
          </times>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">
          \times
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.3.3.5">
       0
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.3.3.6">
       0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T1.4.4">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.4.4.2">
       Bicycle brand rankings
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.4.4.3">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.4.4.4">
       0.6
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.4.4.1">
       <math alttext="\surd" class="ltx_Math" display="inline" id="S3.T1.4.4.1.m1.1">
        <semantics id="S3.T1.4.4.1.m1.1a">
         <mo id="S3.T1.4.4.1.m1.1.1" mathcolor="#00FF00" xref="S3.T1.4.4.1.m1.1.1.cmml">
          √
         </mo>
         <annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b">
          <csymbol cd="latexml" id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">
           square-root
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">
          \surd
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.4.4.5">
       -
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.4.4.6">
       0
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T1.5.5">
      <td class="ltx_td ltx_align_left ltx_border_r" id="S3.T1.5.5.2">
       Nearby bicycle repair stalls
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.5.5.3">
       1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.5.5.4">
       0.8
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.5.5.1">
       <math alttext="\surd" class="ltx_Math" display="inline" id="S3.T1.5.5.1.m1.1">
        <semantics id="S3.T1.5.5.1.m1.1a">
         <mo id="S3.T1.5.5.1.m1.1.1" mathcolor="#00FF00" xref="S3.T1.5.5.1.m1.1.1.cmml">
          √
         </mo>
         <annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b">
          <csymbol cd="latexml" id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">
           square-root
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">
          \surd
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.5.5.5">
       -
      </td>
      <td class="ltx_td ltx_align_center" id="S3.T1.5.5.6">
       1
      </td>
     </tr>
     <tr class="ltx_tr" id="S3.T1.6.6">
      <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S3.T1.6.6.2">
       Mountain bike prices
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.6.6.3">
       1
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.6.6.4">
       0.4
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.6.6.1">
       <math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.6.6.1.m1.1">
        <semantics id="S3.T1.6.6.1.m1.1a">
         <mo id="S3.T1.6.6.1.m1.1.1" mathcolor="#FF0000" xref="S3.T1.6.6.1.m1.1.1.cmml">
          ×
         </mo>
         <annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b">
          <times id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1">
          </times>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">
          \times
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.6.6.5">
       0
      </td>
      <td class="ltx_td ltx_align_center ltx_border_b" id="S3.T1.6.6.6">
       0
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <div class="ltx_para" id="S3.p1">
   <p class="ltx_p" id="S3.p1.1">
    We study the problem of Multimodal Query Suggestion (MMQS), which is formulated below.
   </p>
  </div>
  <div class="ltx_theorem ltx_theorem_problem" id="Thmproblem1">
   <h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">
    Problem 1 (MMQS).
   </h6>
   <div class="ltx_para" id="Thmproblem1.p1">
    <p class="ltx_p" id="Thmproblem1.p1.2">
     <span class="ltx_text ltx_font_italic" id="Thmproblem1.p1.2.2">
      Given a user query image, denoted as
      <math alttext="I" class="ltx_Math" display="inline" id="Thmproblem1.p1.1.1.m1.1">
       <semantics id="Thmproblem1.p1.1.1.m1.1a">
        <mi id="Thmproblem1.p1.1.1.m1.1.1" xref="Thmproblem1.p1.1.1.m1.1.1.cmml">
         I
        </mi>
        <annotation-xml encoding="MathML-Content" id="Thmproblem1.p1.1.1.m1.1b">
         <ci id="Thmproblem1.p1.1.1.m1.1.1.cmml" xref="Thmproblem1.p1.1.1.m1.1.1">
          𝐼
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="Thmproblem1.p1.1.1.m1.1c">
         I
        </annotation>
       </semantics>
      </math>
      , MMQS aims to recommend textual suggestions, denoted as
      <math alttext="\mathcal{S}=&lt;S_{1},S_{2},...,S_{K}&gt;" class="ltx_math_unparsed" display="inline" id="Thmproblem1.p1.2.2.m2.1">
       <semantics id="Thmproblem1.p1.2.2.m2.1a">
        <mrow id="Thmproblem1.p1.2.2.m2.1b">
         <mi class="ltx_font_mathcaligraphic" id="Thmproblem1.p1.2.2.m2.1.2">
          𝒮
         </mi>
         <mo id="Thmproblem1.p1.2.2.m2.1.3" rspace="0em">
          =
         </mo>
         <mo id="Thmproblem1.p1.2.2.m2.1.4" lspace="0em">
          &lt;
         </mo>
         <msub id="Thmproblem1.p1.2.2.m2.1.5">
          <mi id="Thmproblem1.p1.2.2.m2.1.5.2">
           S
          </mi>
          <mn id="Thmproblem1.p1.2.2.m2.1.5.3">
           1
          </mn>
         </msub>
         <mo id="Thmproblem1.p1.2.2.m2.1.6">
          ,
         </mo>
         <msub id="Thmproblem1.p1.2.2.m2.1.7">
          <mi id="Thmproblem1.p1.2.2.m2.1.7.2">
           S
          </mi>
          <mn id="Thmproblem1.p1.2.2.m2.1.7.3">
           2
          </mn>
         </msub>
         <mo id="Thmproblem1.p1.2.2.m2.1.8">
          ,
         </mo>
         <mi id="Thmproblem1.p1.2.2.m2.1.1" mathvariant="normal">
          …
         </mi>
         <mo id="Thmproblem1.p1.2.2.m2.1.9">
          ,
         </mo>
         <msub id="Thmproblem1.p1.2.2.m2.1.10">
          <mi id="Thmproblem1.p1.2.2.m2.1.10.2">
           S
          </mi>
          <mi id="Thmproblem1.p1.2.2.m2.1.10.3">
           K
          </mi>
         </msub>
         <mo id="Thmproblem1.p1.2.2.m2.1.11">
          &gt;
         </mo>
        </mrow>
        <annotation encoding="application/x-tex" id="Thmproblem1.p1.2.2.m2.1c">
         \mathcal{S}=&lt;S_{1},S_{2},...,S_{K}&gt;
        </annotation>
       </semantics>
      </math>
      . The suggestions are used to help users activate search engines, and thus they need to meet the following two properties:
     </span>
    </p>
    <ul class="ltx_itemize" id="S3.I1">
     <li class="ltx_item" id="S3.I1.ix1" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       -
      </span>
      <div class="ltx_para" id="S3.I1.ix1.p1">
       <p class="ltx_p" id="S3.I1.ix1.p1.1">
        <span class="ltx_text ltx_font_italic" id="S3.I1.ix1.p1.1.1">
         Intentionality: the suggested queries should align with the content depicted in the query image, and effectively capture the user’s intent to offer meaningful options for initiating the search.
        </span>
       </p>
      </div>
     </li>
     <li class="ltx_item" id="S3.I1.ix2" style="list-style-type:none;">
      <span class="ltx_tag ltx_tag_item">
       -
      </span>
      <div class="ltx_para" id="S3.I1.ix2.p1">
       <p class="ltx_p" id="S3.I1.ix2.p1.1">
        <span class="ltx_text ltx_font_italic" id="S3.I1.ix2.p1.1.1">
         Diversity: the suggested queries should reflect different aspects of the query image, offering users a diverse set of choices and avoiding redundancy among them.
        </span>
       </p>
      </div>
     </li>
    </ul>
   </div>
  </div>
  <div class="ltx_para" id="S3.p2">
   <p class="ltx_p" id="S3.p2.1">
    By fulfilling these properties, MMQS aims to enrich the user experience by offering intentional and diverse query suggestions derived from the input query image. MMQS provides a foundational feature for supporting two types of search engines: generation-based and retrieval-based (to be introduced in Section
    <a class="ltx_ref" href="#S4.SS5" title="4.5. Discussion on Applications and Cold-start ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
     <span class="ltx_text ltx_ref_tag">
      4.5
     </span>
    </a>
    ).
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4.
   </span>
   METHODOLOGY
  </h2>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1.
    </span>
    Overview of
    <span class="ltx_text ltx_font_typewriter" id="S4.SS1.1.1">
     RL4Sugg
    </span>
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.1">
     The proposed solution
     <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.1.1">
      RL4Sugg
     </span>
     addresses the problem of Multimodal Query Suggestion (MMQS) by generating intentional and diverse query suggestions based on user query images. It consists of several key components, including data collection (Section
     <a class="ltx_ref" href="#S4.SS2" title="4.2. Data Collection ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4.2
      </span>
     </a>
     ), Agent-I training (Section
     <a class="ltx_ref" href="#S4.SS3" title="4.3. Agent-I: Generating Intentional Candidate Suggestions ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4.3
      </span>
     </a>
     ), and Agent-D training (Section
     <a class="ltx_ref" href="#S4.SS4" title="4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4.4
      </span>
     </a>
     ). The overall framework is shown in Figure
     <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4.2. Data Collection ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.1">
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS1.p2.1.1">
      In data collection
     </span>
     , the language generation capabilities of LLMs are utilized to automate the collection of image-suggestion pairs and the annotation of user intents. This approach combines the efficiency of LLM automation and the reliability of human annotation together to ensure data quality for training.
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS1.p2.1.2">
      In Agent-I
     </span>
     , it generates candidate suggestions by combining a RewardNet and a PolicyNet to capture intentionality. The RewardNet is trained using annotated image-suggestion pairs to assign scores (rewards) indicating the user interest in clicking suggestions. This involves a multi-task learning approach optimizing three pre-training tasks to generate informative rewards. The PolicyNet adopts a two-tower structure to capture visual and textual features and incorporates a Language Model (LLM) to enhance understanding and generation capabilities. It formulates the Markov Decision Process (MDP) for generation, refined through Reinforcement Learning from Human Feedback (RLHF) to ensure alignment with user intents.
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS1.p2.1.3">
      In Agent-D
     </span>
     , it leverages lightweight neural networks to select diverse suggestions from the candidate pool provided by Agent-I, whose MDP is designed so that the two agents cooperatively optimize the both intentionality and diversity of the output suggestions in an end-to-end manner.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p3">
    <p class="ltx_p" id="S4.SS1.p3.1">
     We explain some insights behind the
     <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p3.1.1">
      RL4Sugg
     </span>
     design as follows. (1)
     <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p3.1.2">
      RL4Sugg
     </span>
     is built based on the combination of LLM automation and human annotation for preparing the training data. It simplifies the data collection process, and reduces the reliance on human annotators for RLHF.
(2) The multi-task learning in the RewardNet and RLHF in the PolicyNet enable the Agent-I to learn from various tasks and user feedback, leading to improved performance in generating user intentional suggestions.
(3) The Agent-D is trained to minimize the similarity between output suggestions, which ensures that the output suggestions are informative and provide various search aspects for users. Further, Agent-D and Agent-I are trained cooperatively to ensure that the output maintains both intentionality and diversity. This is achieved by optimizing both intentionality and diversity explicitly with multi-agent reinforcement
learning.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2.
    </span>
    Data Collection
   </h3>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     This process involves collecting image-suggestion pairs and annotating user intents regarding their likelihood to click on the suggestions or not. However, relying solely on human crowd-sourcing for data collection can be time-consuming and lack clear guidelines. To address this, inspired by language generation capabilities from recent GPT models
     <cite class="ltx_cite ltx_citemacro_citep">
      (Gilardi et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib14" title="">
       2023
      </a>
      ; Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib31" title="">
       2023
      </a>
      ; OpenAI,
      <a class="ltx_ref" href="#bib.bib33" title="">
       2023
      </a>
      )
     </cite>
     , we propose a novel approach using GPT-4 to automate image-suggestion pair collection and user intent annotation based on potential clicks. This approach provides a balance between automation (by GPT-4) and manual effort (by human annotators) through a threshold-based mechanism. To better illustrate the labeling process, we present a running example in Table
     <a class="ltx_ref" href="#S3.T1" title="Table 1 ‣ 3. PROBLEM STATEMENT ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , which involves three key steps, and the detailed descriptions are included in Appendix Section
     <a class="ltx_ref" href="#A1.SS1" title="A.1. Data Collection Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       A.1
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS2.p2">
    <p class="ltx_p" id="S4.SS2.p2.1">
     We note that the proposed labeling approach offers several novel aspects in the field of text annotation tasks
     <cite class="ltx_cite ltx_citemacro_citep">
      (Gilardi et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib14" title="">
       2023
      </a>
      ; Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib31" title="">
       2023
      </a>
      ; OpenAI,
      <a class="ltx_ref" href="#bib.bib33" title="">
       2023
      </a>
      )
     </cite>
     . First, by utilizing GPT-4’s language generation capabilities, we can generate a wide range of candidate suggestions based on image content, providing a comprehensive set of options for users. Second, the labeling and confidence estimation step enhance the reliability of the generated suggestions by quantifying the model’s confidence. Third, the threshold-based mechanism introduces a customizable parameter, which facilitates the workload adjustment between automation and human effort according to specific requirements.
    </p>
   </div>
   <figure class="ltx_figure" id="S4.F2">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="159" id="S4.F2.g1" src="/html/2402.04867/assets/x3.png" width="438"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 2.
     </span>
     Training overview of Agent-I and Agent-D. Agent-I trains the RewardNet on three tasks (ISA, ISG, ISM) using learnable query embeddings, while the PolicyNet is trained with RLHF to generate candidate suggestions
     <math alttext="S^{\prime}_{1},S^{\prime}_{2},...,S^{\prime}_{N}" class="ltx_Math" display="inline" id="S4.F2.3.m1.4">
      <semantics id="S4.F2.3.m1.4b">
       <mrow id="S4.F2.3.m1.4.4.3" xref="S4.F2.3.m1.4.4.4.cmml">
        <msubsup id="S4.F2.3.m1.2.2.1.1" xref="S4.F2.3.m1.2.2.1.1.cmml">
         <mi id="S4.F2.3.m1.2.2.1.1.2.2" xref="S4.F2.3.m1.2.2.1.1.2.2.cmml">
          S
         </mi>
         <mn id="S4.F2.3.m1.2.2.1.1.3" xref="S4.F2.3.m1.2.2.1.1.3.cmml">
          1
         </mn>
         <mo id="S4.F2.3.m1.2.2.1.1.2.3" xref="S4.F2.3.m1.2.2.1.1.2.3.cmml">
          ′
         </mo>
        </msubsup>
        <mo id="S4.F2.3.m1.4.4.3.4" xref="S4.F2.3.m1.4.4.4.cmml">
         ,
        </mo>
        <msubsup id="S4.F2.3.m1.3.3.2.2" xref="S4.F2.3.m1.3.3.2.2.cmml">
         <mi id="S4.F2.3.m1.3.3.2.2.2.2" xref="S4.F2.3.m1.3.3.2.2.2.2.cmml">
          S
         </mi>
         <mn id="S4.F2.3.m1.3.3.2.2.3" xref="S4.F2.3.m1.3.3.2.2.3.cmml">
          2
         </mn>
         <mo id="S4.F2.3.m1.3.3.2.2.2.3" xref="S4.F2.3.m1.3.3.2.2.2.3.cmml">
          ′
         </mo>
        </msubsup>
        <mo id="S4.F2.3.m1.4.4.3.5" xref="S4.F2.3.m1.4.4.4.cmml">
         ,
        </mo>
        <mi id="S4.F2.3.m1.1.1" mathvariant="normal" xref="S4.F2.3.m1.1.1.cmml">
         …
        </mi>
        <mo id="S4.F2.3.m1.4.4.3.6" xref="S4.F2.3.m1.4.4.4.cmml">
         ,
        </mo>
        <msubsup id="S4.F2.3.m1.4.4.3.3" xref="S4.F2.3.m1.4.4.3.3.cmml">
         <mi id="S4.F2.3.m1.4.4.3.3.2.2" xref="S4.F2.3.m1.4.4.3.3.2.2.cmml">
          S
         </mi>
         <mi id="S4.F2.3.m1.4.4.3.3.3" xref="S4.F2.3.m1.4.4.3.3.3.cmml">
          N
         </mi>
         <mo id="S4.F2.3.m1.4.4.3.3.2.3" xref="S4.F2.3.m1.4.4.3.3.2.3.cmml">
          ′
         </mo>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.F2.3.m1.4c">
        <list id="S4.F2.3.m1.4.4.4.cmml" xref="S4.F2.3.m1.4.4.3">
         <apply id="S4.F2.3.m1.2.2.1.1.cmml" xref="S4.F2.3.m1.2.2.1.1">
          <csymbol cd="ambiguous" id="S4.F2.3.m1.2.2.1.1.1.cmml" xref="S4.F2.3.m1.2.2.1.1">
           subscript
          </csymbol>
          <apply id="S4.F2.3.m1.2.2.1.1.2.cmml" xref="S4.F2.3.m1.2.2.1.1">
           <csymbol cd="ambiguous" id="S4.F2.3.m1.2.2.1.1.2.1.cmml" xref="S4.F2.3.m1.2.2.1.1">
            superscript
           </csymbol>
           <ci id="S4.F2.3.m1.2.2.1.1.2.2.cmml" xref="S4.F2.3.m1.2.2.1.1.2.2">
            𝑆
           </ci>
           <ci id="S4.F2.3.m1.2.2.1.1.2.3.cmml" xref="S4.F2.3.m1.2.2.1.1.2.3">
            ′
           </ci>
          </apply>
          <cn id="S4.F2.3.m1.2.2.1.1.3.cmml" type="integer" xref="S4.F2.3.m1.2.2.1.1.3">
           1
          </cn>
         </apply>
         <apply id="S4.F2.3.m1.3.3.2.2.cmml" xref="S4.F2.3.m1.3.3.2.2">
          <csymbol cd="ambiguous" id="S4.F2.3.m1.3.3.2.2.1.cmml" xref="S4.F2.3.m1.3.3.2.2">
           subscript
          </csymbol>
          <apply id="S4.F2.3.m1.3.3.2.2.2.cmml" xref="S4.F2.3.m1.3.3.2.2">
           <csymbol cd="ambiguous" id="S4.F2.3.m1.3.3.2.2.2.1.cmml" xref="S4.F2.3.m1.3.3.2.2">
            superscript
           </csymbol>
           <ci id="S4.F2.3.m1.3.3.2.2.2.2.cmml" xref="S4.F2.3.m1.3.3.2.2.2.2">
            𝑆
           </ci>
           <ci id="S4.F2.3.m1.3.3.2.2.2.3.cmml" xref="S4.F2.3.m1.3.3.2.2.2.3">
            ′
           </ci>
          </apply>
          <cn id="S4.F2.3.m1.3.3.2.2.3.cmml" type="integer" xref="S4.F2.3.m1.3.3.2.2.3">
           2
          </cn>
         </apply>
         <ci id="S4.F2.3.m1.1.1.cmml" xref="S4.F2.3.m1.1.1">
          …
         </ci>
         <apply id="S4.F2.3.m1.4.4.3.3.cmml" xref="S4.F2.3.m1.4.4.3.3">
          <csymbol cd="ambiguous" id="S4.F2.3.m1.4.4.3.3.1.cmml" xref="S4.F2.3.m1.4.4.3.3">
           subscript
          </csymbol>
          <apply id="S4.F2.3.m1.4.4.3.3.2.cmml" xref="S4.F2.3.m1.4.4.3.3">
           <csymbol cd="ambiguous" id="S4.F2.3.m1.4.4.3.3.2.1.cmml" xref="S4.F2.3.m1.4.4.3.3">
            superscript
           </csymbol>
           <ci id="S4.F2.3.m1.4.4.3.3.2.2.cmml" xref="S4.F2.3.m1.4.4.3.3.2.2">
            𝑆
           </ci>
           <ci id="S4.F2.3.m1.4.4.3.3.2.3.cmml" xref="S4.F2.3.m1.4.4.3.3.2.3">
            ′
           </ci>
          </apply>
          <ci id="S4.F2.3.m1.4.4.3.3.3.cmml" xref="S4.F2.3.m1.4.4.3.3.3">
           𝑁
          </ci>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.F2.3.m1.4d">
        S^{\prime}_{1},S^{\prime}_{2},...,S^{\prime}_{N}
       </annotation>
      </semantics>
     </math>
     for intentionality. Agent-D learns to select diverse suggestions from the candidates via policy gradient and outputs the final
     <math alttext="K" class="ltx_Math" display="inline" id="S4.F2.4.m2.1">
      <semantics id="S4.F2.4.m2.1b">
       <mi id="S4.F2.4.m2.1.1" xref="S4.F2.4.m2.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.F2.4.m2.1c">
        <ci id="S4.F2.4.m2.1.1.cmml" xref="S4.F2.4.m2.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.F2.4.m2.1d">
        K
       </annotation>
      </semantics>
     </math>
     suggestions.
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3.
    </span>
    Agent-I: Generating Intentional Candidate Suggestions
   </h3>
   <section class="ltx_subsubsection" id="S4.SS3.SSS1">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      4.3.1.
     </span>
     <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.1.1">
      RewardNet
     </span>
    </h4>
    <div class="ltx_para" id="S4.SS3.SSS1.p1">
     <p class="ltx_p" id="S4.SS3.SSS1.p1.1">
      In this section, we introduce the training process of the RewardNet, utilizing the annotated image-suggestion pair data. The RewardNet provides rewards (e.g., a value ranging between 0 and 1) for each image-suggestion pair, indicating the likelihood of user interest in clicking the suggestion for a given query image. Below, we present the model architecture and training details for the RewardNet.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p2">
     <p class="ltx_p" id="S4.SS3.SSS1.p2.1">
      <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p2.1.1">
       Model Architecture.
      </span>
      As shown in Figure
      <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4.2. Data Collection ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
       <span class="ltx_text ltx_ref_tag">
        2
       </span>
      </a>
      , our RewardNet employs a Q-Former structure
      <cite class="ltx_cite ltx_citemacro_citep">
       (Li et al
       <span class="ltx_text">
        .
       </span>
       ,
       <a class="ltx_ref" href="#bib.bib26" title="">
        2023
       </a>
       )
      </cite>
      , which incorporates an Image-Tower and a Text-Tower, both utilizing transformer-based modules with shared self-attention layers to capture visual and textual features. In the Image-Tower, it incorporates a pre-trained frozen image encoder to extract visual features. To achieve this, we introduce learnable query embeddings as inputs, enabling interactions between queries via self-attention layers and with frozen image features through cross-attention layers. In the Text-Tower, textual suggestions interact with learnable query embeddings through shared self-attention layers.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS1.p3">
     <p class="ltx_p" id="S4.SS3.SSS1.p3.1">
      <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.p3.1.1">
       Training Paradigm.
      </span>
      We adopt multi-task learning for the RewardNet, optimizing three pre-training tasks: Image-Suggestion Alignment (ISA), Image-Suggestion Generation (ISG), and Image-Suggestion Matching (ISM). The rationale behind the approach is to enhance the RewardNet’s training process, facilitating the generation of informative rewards guided by these typical tasks.
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p4">
     <p class="ltx_p" id="S4.SS3.SSS1.p4.8">
      In ISA, the goal is to align image and suggestion representations to bring similar pairs closer and push dissimilar ones apart. This is achieved through a contrastive approach. We sample a batch of image-suggestion pairs, each with a label of 1. (2) For each pair
      <math alttext="&lt;I_{i},S_{i}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS1.p4.1.m1.1">
       <semantics id="S4.SS3.SSS1.p4.1.m1.1a">
        <mrow id="S4.SS3.SSS1.p4.1.m1.1b">
         <mo id="S4.SS3.SSS1.p4.1.m1.1.1">
          &lt;
         </mo>
         <msub id="S4.SS3.SSS1.p4.1.m1.1.2">
          <mi id="S4.SS3.SSS1.p4.1.m1.1.2.2">
           I
          </mi>
          <mi id="S4.SS3.SSS1.p4.1.m1.1.2.3">
           i
          </mi>
         </msub>
         <mo id="S4.SS3.SSS1.p4.1.m1.1.3">
          ,
         </mo>
         <msub id="S4.SS3.SSS1.p4.1.m1.1.4">
          <mi id="S4.SS3.SSS1.p4.1.m1.1.4.2">
           S
          </mi>
          <mi id="S4.SS3.SSS1.p4.1.m1.1.4.3">
           i
          </mi>
         </msub>
         <mo id="S4.SS3.SSS1.p4.1.m1.1.5">
          &gt;
         </mo>
        </mrow>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.1.m1.1c">
         &lt;I_{i},S_{i}&gt;
        </annotation>
       </semantics>
      </math>
      , we represent them as vectors
      <math alttext="\mathbf{v}_{i}^{I}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.2.m2.1">
       <semantics id="S4.SS3.SSS1.p4.2.m2.1a">
        <msubsup id="S4.SS3.SSS1.p4.2.m2.1.1" xref="S4.SS3.SSS1.p4.2.m2.1.1.cmml">
         <mi id="S4.SS3.SSS1.p4.2.m2.1.1.2.2" xref="S4.SS3.SSS1.p4.2.m2.1.1.2.2.cmml">
          𝐯
         </mi>
         <mi id="S4.SS3.SSS1.p4.2.m2.1.1.2.3" xref="S4.SS3.SSS1.p4.2.m2.1.1.2.3.cmml">
          i
         </mi>
         <mi id="S4.SS3.SSS1.p4.2.m2.1.1.3" xref="S4.SS3.SSS1.p4.2.m2.1.1.3.cmml">
          I
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.2.m2.1b">
         <apply id="S4.SS3.SSS1.p4.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS3.SSS1.p4.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p4.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1.2.2">
            𝐯
           </ci>
           <ci id="S4.SS3.SSS1.p4.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS3.SSS1.p4.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p4.2.m2.1.1.3">
           𝐼
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.2.m2.1c">
         \mathbf{v}_{i}^{I}
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="\mathbf{v}_{i}^{S}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.3.m3.1">
       <semantics id="S4.SS3.SSS1.p4.3.m3.1a">
        <msubsup id="S4.SS3.SSS1.p4.3.m3.1.1" xref="S4.SS3.SSS1.p4.3.m3.1.1.cmml">
         <mi id="S4.SS3.SSS1.p4.3.m3.1.1.2.2" xref="S4.SS3.SSS1.p4.3.m3.1.1.2.2.cmml">
          𝐯
         </mi>
         <mi id="S4.SS3.SSS1.p4.3.m3.1.1.2.3" xref="S4.SS3.SSS1.p4.3.m3.1.1.2.3.cmml">
          i
         </mi>
         <mi id="S4.SS3.SSS1.p4.3.m3.1.1.3" xref="S4.SS3.SSS1.p4.3.m3.1.1.3.cmml">
          S
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.3.m3.1b">
         <apply id="S4.SS3.SSS1.p4.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS3.SSS1.p4.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p4.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1.2.2">
            𝐯
           </ci>
           <ci id="S4.SS3.SSS1.p4.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS3.SSS1.p4.3.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p4.3.m3.1.1.3">
           𝑆
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.3.m3.1c">
         \mathbf{v}_{i}^{S}
        </annotation>
       </semantics>
      </math>
      via two towers. We treat
      <math alttext="\mathbf{v}_{i}^{S}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.4.m4.1">
       <semantics id="S4.SS3.SSS1.p4.4.m4.1a">
        <msubsup id="S4.SS3.SSS1.p4.4.m4.1.1" xref="S4.SS3.SSS1.p4.4.m4.1.1.cmml">
         <mi id="S4.SS3.SSS1.p4.4.m4.1.1.2.2" xref="S4.SS3.SSS1.p4.4.m4.1.1.2.2.cmml">
          𝐯
         </mi>
         <mi id="S4.SS3.SSS1.p4.4.m4.1.1.2.3" xref="S4.SS3.SSS1.p4.4.m4.1.1.2.3.cmml">
          i
         </mi>
         <mi id="S4.SS3.SSS1.p4.4.m4.1.1.3" xref="S4.SS3.SSS1.p4.4.m4.1.1.3.cmml">
          S
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.4.m4.1b">
         <apply id="S4.SS3.SSS1.p4.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.4.m4.1.1.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS3.SSS1.p4.4.m4.1.1.2.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.4.m4.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p4.4.m4.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.2.2">
            𝐯
           </ci>
           <ci id="S4.SS3.SSS1.p4.4.m4.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS3.SSS1.p4.4.m4.1.1.3.cmml" xref="S4.SS3.SSS1.p4.4.m4.1.1.3">
           𝑆
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.4.m4.1c">
         \mathbf{v}_{i}^{S}
        </annotation>
       </semantics>
      </math>
      as the positive of
      <math alttext="\mathbf{v}_{i}^{I}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.5.m5.1">
       <semantics id="S4.SS3.SSS1.p4.5.m5.1a">
        <msubsup id="S4.SS3.SSS1.p4.5.m5.1.1" xref="S4.SS3.SSS1.p4.5.m5.1.1.cmml">
         <mi id="S4.SS3.SSS1.p4.5.m5.1.1.2.2" xref="S4.SS3.SSS1.p4.5.m5.1.1.2.2.cmml">
          𝐯
         </mi>
         <mi id="S4.SS3.SSS1.p4.5.m5.1.1.2.3" xref="S4.SS3.SSS1.p4.5.m5.1.1.2.3.cmml">
          i
         </mi>
         <mi id="S4.SS3.SSS1.p4.5.m5.1.1.3" xref="S4.SS3.SSS1.p4.5.m5.1.1.3.cmml">
          I
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.5.m5.1b">
         <apply id="S4.SS3.SSS1.p4.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.5.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS3.SSS1.p4.5.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.5.m5.1.1.2.1.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p4.5.m5.1.1.2.2.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1.2.2">
            𝐯
           </ci>
           <ci id="S4.SS3.SSS1.p4.5.m5.1.1.2.3.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS3.SSS1.p4.5.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p4.5.m5.1.1.3">
           𝐼
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.5.m5.1c">
         \mathbf{v}_{i}^{I}
        </annotation>
       </semantics>
      </math>
      (the anchor), because
      <math alttext="I_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.6.m6.1">
       <semantics id="S4.SS3.SSS1.p4.6.m6.1a">
        <msub id="S4.SS3.SSS1.p4.6.m6.1.1" xref="S4.SS3.SSS1.p4.6.m6.1.1.cmml">
         <mi id="S4.SS3.SSS1.p4.6.m6.1.1.2" xref="S4.SS3.SSS1.p4.6.m6.1.1.2.cmml">
          I
         </mi>
         <mi id="S4.SS3.SSS1.p4.6.m6.1.1.3" xref="S4.SS3.SSS1.p4.6.m6.1.1.3.cmml">
          i
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.6.m6.1b">
         <apply id="S4.SS3.SSS1.p4.6.m6.1.1.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.6.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS3.SSS1.p4.6.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1.2">
           𝐼
          </ci>
          <ci id="S4.SS3.SSS1.p4.6.m6.1.1.3.cmml" xref="S4.SS3.SSS1.p4.6.m6.1.1.3">
           𝑖
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.6.m6.1c">
         I_{i}
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="S_{i}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.7.m7.1">
       <semantics id="S4.SS3.SSS1.p4.7.m7.1a">
        <msub id="S4.SS3.SSS1.p4.7.m7.1.1" xref="S4.SS3.SSS1.p4.7.m7.1.1.cmml">
         <mi id="S4.SS3.SSS1.p4.7.m7.1.1.2" xref="S4.SS3.SSS1.p4.7.m7.1.1.2.cmml">
          S
         </mi>
         <mi id="S4.SS3.SSS1.p4.7.m7.1.1.3" xref="S4.SS3.SSS1.p4.7.m7.1.1.3.cmml">
          i
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.7.m7.1b">
         <apply id="S4.SS3.SSS1.p4.7.m7.1.1.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.7.m7.1.1.1.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS3.SSS1.p4.7.m7.1.1.2.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1.2">
           𝑆
          </ci>
          <ci id="S4.SS3.SSS1.p4.7.m7.1.1.3.cmml" xref="S4.SS3.SSS1.p4.7.m7.1.1.3">
           𝑖
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.7.m7.1c">
         S_{i}
        </annotation>
       </semantics>
      </math>
      have a label of 1, and other suggestions in the batch are considered as the negatives. Then, let
      <math alttext="\mathcal{L}_{I,S}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.8.m8.2">
       <semantics id="S4.SS3.SSS1.p4.8.m8.2a">
        <msub id="S4.SS3.SSS1.p4.8.m8.2.3" xref="S4.SS3.SSS1.p4.8.m8.2.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p4.8.m8.2.3.2" xref="S4.SS3.SSS1.p4.8.m8.2.3.2.cmml">
          ℒ
         </mi>
         <mrow id="S4.SS3.SSS1.p4.8.m8.2.2.2.4" xref="S4.SS3.SSS1.p4.8.m8.2.2.2.3.cmml">
          <mi id="S4.SS3.SSS1.p4.8.m8.1.1.1.1" xref="S4.SS3.SSS1.p4.8.m8.1.1.1.1.cmml">
           I
          </mi>
          <mo id="S4.SS3.SSS1.p4.8.m8.2.2.2.4.1" xref="S4.SS3.SSS1.p4.8.m8.2.2.2.3.cmml">
           ,
          </mo>
          <mi id="S4.SS3.SSS1.p4.8.m8.2.2.2.2" xref="S4.SS3.SSS1.p4.8.m8.2.2.2.2.cmml">
           S
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p4.8.m8.2b">
         <apply id="S4.SS3.SSS1.p4.8.m8.2.3.cmml" xref="S4.SS3.SSS1.p4.8.m8.2.3">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p4.8.m8.2.3.1.cmml" xref="S4.SS3.SSS1.p4.8.m8.2.3">
           subscript
          </csymbol>
          <ci id="S4.SS3.SSS1.p4.8.m8.2.3.2.cmml" xref="S4.SS3.SSS1.p4.8.m8.2.3.2">
           ℒ
          </ci>
          <list id="S4.SS3.SSS1.p4.8.m8.2.2.2.3.cmml" xref="S4.SS3.SSS1.p4.8.m8.2.2.2.4">
           <ci id="S4.SS3.SSS1.p4.8.m8.1.1.1.1.cmml" xref="S4.SS3.SSS1.p4.8.m8.1.1.1.1">
            𝐼
           </ci>
           <ci id="S4.SS3.SSS1.p4.8.m8.2.2.2.2.cmml" xref="S4.SS3.SSS1.p4.8.m8.2.2.2.2">
            𝑆
           </ci>
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p4.8.m8.2c">
         \mathcal{L}_{I,S}
        </annotation>
       </semantics>
      </math>
      denote a contrast, which encourages the suggestions to align with the anchor image by comparing their positive and negative pairs, that is,
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p5">
     <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
      <tbody id="S4.E1">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_left">
          (1)
         </span>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathcal{L}_{I,S}=\sum\limits_{&lt;I_{i},S_{i}&gt;\in\mathcal{V}}-\log\frac{\exp\Bigm{(}{\max\limits_{\mathbf{v}_{i}^{I}\in\mathbf{V}_{i}^{I}}\mathbf{v}_{i}^{I}\cdot\mathbf{v}_{i}^{S}/\tau}\Bigm{)}}{\sum\limits_{&lt;I_{j},S_{j}&gt;\in\mathcal{V},j\neq i}\exp\Bigm{(}{\max\limits_{\mathbf{v}_{i}^{I}\in\mathbf{V}_{i}^{I}}\mathbf{v}_{i}^{I}\cdot\mathbf{v}_{j}^{S}/\tau}\Bigm{)}}," class="ltx_math_unparsed" display="inline" id="S4.E1.m1.12">
          <semantics id="S4.E1.m1.12a">
           <mrow id="S4.E1.m1.12.12.1">
            <mrow id="S4.E1.m1.12.12.1.1">
             <msub id="S4.E1.m1.12.12.1.1.2">
              <mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.12.12.1.1.2.2">
               ℒ
              </mi>
              <mrow id="S4.E1.m1.2.2.2.4">
               <mi id="S4.E1.m1.1.1.1.1">
                I
               </mi>
               <mo id="S4.E1.m1.2.2.2.4.1">
                ,
               </mo>
               <mi id="S4.E1.m1.2.2.2.2">
                S
               </mi>
              </mrow>
             </msub>
             <mo id="S4.E1.m1.12.12.1.1.1">
              =
             </mo>
             <mrow id="S4.E1.m1.12.12.1.1.3">
              <mstyle displaystyle="true" id="S4.E1.m1.12.12.1.1.3.2">
               <munder id="S4.E1.m1.12.12.1.1.3.2a">
                <mo id="S4.E1.m1.12.12.1.1.3.2.2" movablelimits="false">
                 ∑
                </mo>
                <mrow id="S4.E1.m1.6.6.4.4">
                 <mrow id="S4.E1.m1.4.4.2.2.1">
                  <mi id="S4.E1.m1.4.4.2.2.1.2">
                  </mi>
                  <mo id="S4.E1.m1.4.4.2.2.1.1">
                   &lt;
                  </mo>
                  <msub id="S4.E1.m1.4.4.2.2.1.3">
                   <mi id="S4.E1.m1.4.4.2.2.1.3.2">
                    I
                   </mi>
                   <mi id="S4.E1.m1.4.4.2.2.1.3.3">
                    i
                   </mi>
                  </msub>
                 </mrow>
                 <mo id="S4.E1.m1.6.6.4.4.4">
                  ,
                 </mo>
                 <msub id="S4.E1.m1.5.5.3.3.2">
                  <mi id="S4.E1.m1.5.5.3.3.2.2">
                   S
                  </mi>
                  <mi id="S4.E1.m1.5.5.3.3.2.3">
                   i
                  </mi>
                 </msub>
                 <mo id="S4.E1.m1.6.6.4.4.5">
                  ⁣
                 </mo>
                 <mo id="S4.E1.m1.3.3.1.1">
                  &gt;
                 </mo>
                 <mo id="S4.E1.m1.6.6.4.4.6">
                  ⁣
                 </mo>
                 <mrow id="S4.E1.m1.6.6.4.4.3">
                  <mi id="S4.E1.m1.6.6.4.4.3.2">
                  </mi>
                  <mo id="S4.E1.m1.6.6.4.4.3.1">
                   ∈
                  </mo>
                  <mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.6.6.4.4.3.3">
                   𝒱
                  </mi>
                 </mrow>
                </mrow>
               </munder>
              </mstyle>
              <mo id="S4.E1.m1.12.12.1.1.3.1">
               −
              </mo>
              <mrow id="S4.E1.m1.12.12.1.1.3.3">
               <mi id="S4.E1.m1.12.12.1.1.3.3.1">
                log
               </mi>
               <mo id="S4.E1.m1.12.12.1.1.3.3a" lspace="0.167em">
                ⁡
               </mo>
               <mstyle displaystyle="true" id="S4.E1.m1.11.11">
                <mfrac id="S4.E1.m1.11.11a">
                 <mrow id="S4.E1.m1.11.11.7">
                  <mi id="S4.E1.m1.11.11.7.1">
                   exp
                  </mi>
                  <mo id="S4.E1.m1.11.11.7.2" lspace="0.167em" mathsize="160%" rspace="0.167em">
                   (
                  </mo>
                  <munder id="S4.E1.m1.11.11.7.3">
                   <mi id="S4.E1.m1.11.11.7.3.2">
                    max
                   </mi>
                   <mrow id="S4.E1.m1.11.11.7.3.3">
                    <msubsup id="S4.E1.m1.11.11.7.3.3.2">
                     <mi id="S4.E1.m1.11.11.7.3.3.2.2.2">
                      𝐯
                     </mi>
                     <mi id="S4.E1.m1.11.11.7.3.3.2.2.3">
                      i
                     </mi>
                     <mi id="S4.E1.m1.11.11.7.3.3.2.3">
                      I
                     </mi>
                    </msubsup>
                    <mo id="S4.E1.m1.11.11.7.3.3.1">
                     ∈
                    </mo>
                    <msubsup id="S4.E1.m1.11.11.7.3.3.3">
                     <mi id="S4.E1.m1.11.11.7.3.3.3.2.2">
                      𝐕
                     </mi>
                     <mi id="S4.E1.m1.11.11.7.3.3.3.2.3">
                      i
                     </mi>
                     <mi id="S4.E1.m1.11.11.7.3.3.3.3">
                      I
                     </mi>
                    </msubsup>
                   </mrow>
                  </munder>
                  <msubsup id="S4.E1.m1.11.11.7.4">
                   <mi id="S4.E1.m1.11.11.7.4.2.2">
                    𝐯
                   </mi>
                   <mi id="S4.E1.m1.11.11.7.4.2.3">
                    i
                   </mi>
                   <mi id="S4.E1.m1.11.11.7.4.3">
                    I
                   </mi>
                  </msubsup>
                  <mo id="S4.E1.m1.11.11.7.5" lspace="0.222em" rspace="0.222em">
                   ⋅
                  </mo>
                  <msubsup id="S4.E1.m1.11.11.7.6">
                   <mi id="S4.E1.m1.11.11.7.6.2.2">
                    𝐯
                   </mi>
                   <mi id="S4.E1.m1.11.11.7.6.2.3">
                    i
                   </mi>
                   <mi id="S4.E1.m1.11.11.7.6.3">
                    S
                   </mi>
                  </msubsup>
                  <mo id="S4.E1.m1.11.11.7.7">
                   /
                  </mo>
                  <mi id="S4.E1.m1.11.11.7.8">
                   τ
                  </mi>
                  <mo id="S4.E1.m1.11.11.7.9" lspace="0em" mathsize="160%">
                   )
                  </mo>
                 </mrow>
                 <mrow id="S4.E1.m1.11.11.5">
                  <munder id="S4.E1.m1.11.11.5.6">
                   <mo id="S4.E1.m1.11.11.5.6.2" movablelimits="false">
                    ∑
                   </mo>
                   <mrow id="S4.E1.m1.11.11.5.5.5.5">
                    <mrow id="S4.E1.m1.8.8.2.2.2.2.1">
                     <mi id="S4.E1.m1.8.8.2.2.2.2.1.2">
                     </mi>
                     <mo id="S4.E1.m1.8.8.2.2.2.2.1.1">
                      &lt;
                     </mo>
                     <msub id="S4.E1.m1.8.8.2.2.2.2.1.3">
                      <mi id="S4.E1.m1.8.8.2.2.2.2.1.3.2">
                       I
                      </mi>
                      <mi id="S4.E1.m1.8.8.2.2.2.2.1.3.3">
                       j
                      </mi>
                     </msub>
                    </mrow>
                    <mo id="S4.E1.m1.11.11.5.5.5.5.5">
                     ,
                    </mo>
                    <msub id="S4.E1.m1.9.9.3.3.3.3.2">
                     <mi id="S4.E1.m1.9.9.3.3.3.3.2.2">
                      S
                     </mi>
                     <mi id="S4.E1.m1.9.9.3.3.3.3.2.3">
                      j
                     </mi>
                    </msub>
                    <mo id="S4.E1.m1.11.11.5.5.5.5.6">
                     ⁣
                    </mo>
                    <mo id="S4.E1.m1.7.7.1.1.1.1">
                     &gt;
                    </mo>
                    <mo id="S4.E1.m1.11.11.5.5.5.5.7">
                     ⁣
                    </mo>
                    <mrow id="S4.E1.m1.10.10.4.4.4.4.3">
                     <mi id="S4.E1.m1.10.10.4.4.4.4.3.2">
                     </mi>
                     <mo id="S4.E1.m1.10.10.4.4.4.4.3.1">
                      ∈
                     </mo>
                     <mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.10.10.4.4.4.4.3.3">
                      𝒱
                     </mi>
                    </mrow>
                    <mo id="S4.E1.m1.11.11.5.5.5.5.8">
                     ,
                    </mo>
                    <mrow id="S4.E1.m1.11.11.5.5.5.5.4">
                     <mi id="S4.E1.m1.11.11.5.5.5.5.4.2">
                      j
                     </mi>
                     <mo id="S4.E1.m1.11.11.5.5.5.5.4.1">
                      ≠
                     </mo>
                     <mi id="S4.E1.m1.11.11.5.5.5.5.4.3">
                      i
                     </mi>
                    </mrow>
                   </mrow>
                  </munder>
                  <mi id="S4.E1.m1.11.11.5.7">
                   exp
                  </mi>
                  <mo id="S4.E1.m1.11.11.5.8" lspace="0.167em" mathsize="160%" rspace="0.167em">
                   (
                  </mo>
                  <munder id="S4.E1.m1.11.11.5.9">
                   <mi id="S4.E1.m1.11.11.5.9.2">
                    max
                   </mi>
                   <mrow id="S4.E1.m1.11.11.5.9.3">
                    <msubsup id="S4.E1.m1.11.11.5.9.3.2">
                     <mi id="S4.E1.m1.11.11.5.9.3.2.2.2">
                      𝐯
                     </mi>
                     <mi id="S4.E1.m1.11.11.5.9.3.2.2.3">
                      i
                     </mi>
                     <mi id="S4.E1.m1.11.11.5.9.3.2.3">
                      I
                     </mi>
                    </msubsup>
                    <mo id="S4.E1.m1.11.11.5.9.3.1">
                     ∈
                    </mo>
                    <msubsup id="S4.E1.m1.11.11.5.9.3.3">
                     <mi id="S4.E1.m1.11.11.5.9.3.3.2.2">
                      𝐕
                     </mi>
                     <mi id="S4.E1.m1.11.11.5.9.3.3.2.3">
                      i
                     </mi>
                     <mi id="S4.E1.m1.11.11.5.9.3.3.3">
                      I
                     </mi>
                    </msubsup>
                   </mrow>
                  </munder>
                  <msubsup id="S4.E1.m1.11.11.5.10">
                   <mi id="S4.E1.m1.11.11.5.10.2.2">
                    𝐯
                   </mi>
                   <mi id="S4.E1.m1.11.11.5.10.2.3">
                    i
                   </mi>
                   <mi id="S4.E1.m1.11.11.5.10.3">
                    I
                   </mi>
                  </msubsup>
                  <mo id="S4.E1.m1.11.11.5.11" lspace="0.222em" rspace="0.222em">
                   ⋅
                  </mo>
                  <msubsup id="S4.E1.m1.11.11.5.12">
                   <mi id="S4.E1.m1.11.11.5.12.2.2">
                    𝐯
                   </mi>
                   <mi id="S4.E1.m1.11.11.5.12.2.3">
                    j
                   </mi>
                   <mi id="S4.E1.m1.11.11.5.12.3">
                    S
                   </mi>
                  </msubsup>
                  <mo id="S4.E1.m1.11.11.5.13">
                   /
                  </mo>
                  <mi id="S4.E1.m1.11.11.5.14">
                   τ
                  </mi>
                  <mo id="S4.E1.m1.11.11.5.15" lspace="0em" mathsize="160%">
                   )
                  </mo>
                 </mrow>
                </mfrac>
               </mstyle>
              </mrow>
             </mrow>
            </mrow>
            <mo id="S4.E1.m1.12.12.1.2">
             ,
            </mo>
           </mrow>
           <annotation encoding="application/x-tex" id="S4.E1.m1.12b">
            \displaystyle\mathcal{L}_{I,S}=\sum\limits_{&lt;I_{i},S_{i}&gt;\in\mathcal{V}}-\log\frac{\exp\Bigm{(}{\max\limits_{\mathbf{v}_{i}^{I}\in\mathbf{V}_{i}^{I}}\mathbf{v}_{i}^{I}\cdot\mathbf{v}_{i}^{S}/\tau}\Bigm{)}}{\sum\limits_{&lt;I_{j},S_{j}&gt;\in\mathcal{V},j\neq i}\exp\Bigm{(}{\max\limits_{\mathbf{v}_{i}^{I}\in\mathbf{V}_{i}^{I}}\mathbf{v}_{i}^{I}\cdot\mathbf{v}_{j}^{S}/\tau}\Bigm{)}},
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S4.SS3.SSS1.p5.6">
      where
      <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.1.m1.1">
       <semantics id="S4.SS3.SSS1.p5.1.m1.1a">
        <mi id="S4.SS3.SSS1.p5.1.m1.1.1" xref="S4.SS3.SSS1.p5.1.m1.1.1.cmml">
         τ
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.1.m1.1b">
         <ci id="S4.SS3.SSS1.p5.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p5.1.m1.1.1">
          𝜏
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.1.m1.1c">
         \tau
        </annotation>
       </semantics>
      </math>
      represents a temperature parameter. To determine the image-text similarity, we compute the pairwise similarity between each query embedding
      <math alttext="\mathbf{v}_{i}^{I}\in\mathbf{V}_{i}^{I}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.2.m2.1">
       <semantics id="S4.SS3.SSS1.p5.2.m2.1a">
        <mrow id="S4.SS3.SSS1.p5.2.m2.1.1" xref="S4.SS3.SSS1.p5.2.m2.1.1.cmml">
         <msubsup id="S4.SS3.SSS1.p5.2.m2.1.1.2" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.cmml">
          <mi id="S4.SS3.SSS1.p5.2.m2.1.1.2.2.2" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.2.2.cmml">
           𝐯
          </mi>
          <mi id="S4.SS3.SSS1.p5.2.m2.1.1.2.2.3" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.2.3.cmml">
           i
          </mi>
          <mi id="S4.SS3.SSS1.p5.2.m2.1.1.2.3" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.3.cmml">
           I
          </mi>
         </msubsup>
         <mo id="S4.SS3.SSS1.p5.2.m2.1.1.1" xref="S4.SS3.SSS1.p5.2.m2.1.1.1.cmml">
          ∈
         </mo>
         <msubsup id="S4.SS3.SSS1.p5.2.m2.1.1.3" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.cmml">
          <mi id="S4.SS3.SSS1.p5.2.m2.1.1.3.2.2" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.2.2.cmml">
           𝐕
          </mi>
          <mi id="S4.SS3.SSS1.p5.2.m2.1.1.3.2.3" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.2.3.cmml">
           i
          </mi>
          <mi id="S4.SS3.SSS1.p5.2.m2.1.1.3.3" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.3.cmml">
           I
          </mi>
         </msubsup>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.2.m2.1b">
         <apply id="S4.SS3.SSS1.p5.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1">
          <in id="S4.SS3.SSS1.p5.2.m2.1.1.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.1">
          </in>
          <apply id="S4.SS3.SSS1.p5.2.m2.1.1.2.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.2.m2.1.1.2.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2">
            superscript
           </csymbol>
           <apply id="S4.SS3.SSS1.p5.2.m2.1.1.2.2.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2">
            <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.2.m2.1.1.2.2.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2">
             subscript
            </csymbol>
            <ci id="S4.SS3.SSS1.p5.2.m2.1.1.2.2.2.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.2.2">
             𝐯
            </ci>
            <ci id="S4.SS3.SSS1.p5.2.m2.1.1.2.2.3.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="S4.SS3.SSS1.p5.2.m2.1.1.2.3.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.2.3">
            𝐼
           </ci>
          </apply>
          <apply id="S4.SS3.SSS1.p5.2.m2.1.1.3.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.2.m2.1.1.3.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3">
            superscript
           </csymbol>
           <apply id="S4.SS3.SSS1.p5.2.m2.1.1.3.2.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3">
            <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.2.m2.1.1.3.2.1.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3">
             subscript
            </csymbol>
            <ci id="S4.SS3.SSS1.p5.2.m2.1.1.3.2.2.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.2.2">
             𝐕
            </ci>
            <ci id="S4.SS3.SSS1.p5.2.m2.1.1.3.2.3.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="S4.SS3.SSS1.p5.2.m2.1.1.3.3.cmml" xref="S4.SS3.SSS1.p5.2.m2.1.1.3.3">
            𝐼
           </ci>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.2.m2.1c">
         \mathbf{v}_{i}^{I}\in\mathbf{V}_{i}^{I}
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="\mathbf{v}_{i}^{S}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.3.m3.1">
       <semantics id="S4.SS3.SSS1.p5.3.m3.1a">
        <msubsup id="S4.SS3.SSS1.p5.3.m3.1.1" xref="S4.SS3.SSS1.p5.3.m3.1.1.cmml">
         <mi id="S4.SS3.SSS1.p5.3.m3.1.1.2.2" xref="S4.SS3.SSS1.p5.3.m3.1.1.2.2.cmml">
          𝐯
         </mi>
         <mi id="S4.SS3.SSS1.p5.3.m3.1.1.2.3" xref="S4.SS3.SSS1.p5.3.m3.1.1.2.3.cmml">
          i
         </mi>
         <mi id="S4.SS3.SSS1.p5.3.m3.1.1.3" xref="S4.SS3.SSS1.p5.3.m3.1.1.3.cmml">
          S
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.3.m3.1b">
         <apply id="S4.SS3.SSS1.p5.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.3.m3.1.1.1.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS3.SSS1.p5.3.m3.1.1.2.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.3.m3.1.1.2.1.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p5.3.m3.1.1.2.2.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1.2.2">
            𝐯
           </ci>
           <ci id="S4.SS3.SSS1.p5.3.m3.1.1.2.3.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS3.SSS1.p5.3.m3.1.1.3.cmml" xref="S4.SS3.SSS1.p5.3.m3.1.1.3">
           𝑆
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.3.m3.1c">
         \mathbf{v}_{i}^{S}
        </annotation>
       </semantics>
      </math>
      , and select the highest similarity value. Symmetrically, we can define
      <math alttext="\mathcal{L}_{S,I}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.4.m4.2">
       <semantics id="S4.SS3.SSS1.p5.4.m4.2a">
        <msub id="S4.SS3.SSS1.p5.4.m4.2.3" xref="S4.SS3.SSS1.p5.4.m4.2.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p5.4.m4.2.3.2" xref="S4.SS3.SSS1.p5.4.m4.2.3.2.cmml">
          ℒ
         </mi>
         <mrow id="S4.SS3.SSS1.p5.4.m4.2.2.2.4" xref="S4.SS3.SSS1.p5.4.m4.2.2.2.3.cmml">
          <mi id="S4.SS3.SSS1.p5.4.m4.1.1.1.1" xref="S4.SS3.SSS1.p5.4.m4.1.1.1.1.cmml">
           S
          </mi>
          <mo id="S4.SS3.SSS1.p5.4.m4.2.2.2.4.1" xref="S4.SS3.SSS1.p5.4.m4.2.2.2.3.cmml">
           ,
          </mo>
          <mi id="S4.SS3.SSS1.p5.4.m4.2.2.2.2" xref="S4.SS3.SSS1.p5.4.m4.2.2.2.2.cmml">
           I
          </mi>
         </mrow>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.4.m4.2b">
         <apply id="S4.SS3.SSS1.p5.4.m4.2.3.cmml" xref="S4.SS3.SSS1.p5.4.m4.2.3">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.4.m4.2.3.1.cmml" xref="S4.SS3.SSS1.p5.4.m4.2.3">
           subscript
          </csymbol>
          <ci id="S4.SS3.SSS1.p5.4.m4.2.3.2.cmml" xref="S4.SS3.SSS1.p5.4.m4.2.3.2">
           ℒ
          </ci>
          <list id="S4.SS3.SSS1.p5.4.m4.2.2.2.3.cmml" xref="S4.SS3.SSS1.p5.4.m4.2.2.2.4">
           <ci id="S4.SS3.SSS1.p5.4.m4.1.1.1.1.cmml" xref="S4.SS3.SSS1.p5.4.m4.1.1.1.1">
            𝑆
           </ci>
           <ci id="S4.SS3.SSS1.p5.4.m4.2.2.2.2.cmml" xref="S4.SS3.SSS1.p5.4.m4.2.2.2.2">
            𝐼
           </ci>
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.4.m4.2c">
         \mathcal{L}_{S,I}
        </annotation>
       </semantics>
      </math>
      by anchoring at
      <math alttext="\mathbf{v}_{i}^{S}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.5.m5.1">
       <semantics id="S4.SS3.SSS1.p5.5.m5.1a">
        <msubsup id="S4.SS3.SSS1.p5.5.m5.1.1" xref="S4.SS3.SSS1.p5.5.m5.1.1.cmml">
         <mi id="S4.SS3.SSS1.p5.5.m5.1.1.2.2" xref="S4.SS3.SSS1.p5.5.m5.1.1.2.2.cmml">
          𝐯
         </mi>
         <mi id="S4.SS3.SSS1.p5.5.m5.1.1.2.3" xref="S4.SS3.SSS1.p5.5.m5.1.1.2.3.cmml">
          i
         </mi>
         <mi id="S4.SS3.SSS1.p5.5.m5.1.1.3" xref="S4.SS3.SSS1.p5.5.m5.1.1.3.cmml">
          S
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.5.m5.1b">
         <apply id="S4.SS3.SSS1.p5.5.m5.1.1.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.5.m5.1.1.1.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS3.SSS1.p5.5.m5.1.1.2.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.5.m5.1.1.2.1.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p5.5.m5.1.1.2.2.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1.2.2">
            𝐯
           </ci>
           <ci id="S4.SS3.SSS1.p5.5.m5.1.1.2.3.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="S4.SS3.SSS1.p5.5.m5.1.1.3.cmml" xref="S4.SS3.SSS1.p5.5.m5.1.1.3">
           𝑆
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.5.m5.1c">
         \mathbf{v}_{i}^{S}
        </annotation>
       </semantics>
      </math>
      , then the loss
      <math alttext="\mathcal{L}_{\text{ISA}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p5.6.m6.1">
       <semantics id="S4.SS3.SSS1.p5.6.m6.1a">
        <msub id="S4.SS3.SSS1.p5.6.m6.1.1" xref="S4.SS3.SSS1.p5.6.m6.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p5.6.m6.1.1.2" xref="S4.SS3.SSS1.p5.6.m6.1.1.2.cmml">
          ℒ
         </mi>
         <mtext id="S4.SS3.SSS1.p5.6.m6.1.1.3" xref="S4.SS3.SSS1.p5.6.m6.1.1.3a.cmml">
          ISA
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p5.6.m6.1b">
         <apply id="S4.SS3.SSS1.p5.6.m6.1.1.cmml" xref="S4.SS3.SSS1.p5.6.m6.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p5.6.m6.1.1.1.cmml" xref="S4.SS3.SSS1.p5.6.m6.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS3.SSS1.p5.6.m6.1.1.2.cmml" xref="S4.SS3.SSS1.p5.6.m6.1.1.2">
           ℒ
          </ci>
          <ci id="S4.SS3.SSS1.p5.6.m6.1.1.3a.cmml" xref="S4.SS3.SSS1.p5.6.m6.1.1.3">
           <mtext id="S4.SS3.SSS1.p5.6.m6.1.1.3.cmml" mathsize="70%" xref="S4.SS3.SSS1.p5.6.m6.1.1.3">
            ISA
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p5.6.m6.1c">
         \mathcal{L}_{\text{ISA}}
        </annotation>
       </semantics>
      </math>
      is defined as
     </p>
     <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
      <tbody id="S4.E2">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_left">
          (2)
         </span>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathcal{L}_{\text{ISA}}=(\mathcal{L}_{I,S}+\mathcal{L}_{S,I})/2." class="ltx_Math" display="inline" id="S4.E2.m1.5">
          <semantics id="S4.E2.m1.5a">
           <mrow id="S4.E2.m1.5.5.1" xref="S4.E2.m1.5.5.1.1.cmml">
            <mrow id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml">
             <msub id="S4.E2.m1.5.5.1.1.3" xref="S4.E2.m1.5.5.1.1.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.5.5.1.1.3.2" xref="S4.E2.m1.5.5.1.1.3.2.cmml">
               ℒ
              </mi>
              <mtext id="S4.E2.m1.5.5.1.1.3.3" xref="S4.E2.m1.5.5.1.1.3.3a.cmml">
               ISA
              </mtext>
             </msub>
             <mo id="S4.E2.m1.5.5.1.1.2" xref="S4.E2.m1.5.5.1.1.2.cmml">
              =
             </mo>
             <mrow id="S4.E2.m1.5.5.1.1.1" xref="S4.E2.m1.5.5.1.1.1.cmml">
              <mrow id="S4.E2.m1.5.5.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.cmml">
               <mo id="S4.E2.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.5.5.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S4.E2.m1.5.5.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.cmml">
                <msub id="S4.E2.m1.5.5.1.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml">
                  ℒ
                 </mi>
                 <mrow id="S4.E2.m1.2.2.2.4" xref="S4.E2.m1.2.2.2.3.cmml">
                  <mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">
                   I
                  </mi>
                  <mo id="S4.E2.m1.2.2.2.4.1" xref="S4.E2.m1.2.2.2.3.cmml">
                   ,
                  </mo>
                  <mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">
                   S
                  </mi>
                 </mrow>
                </msub>
                <mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.cmml">
                 +
                </mo>
                <msub id="S4.E2.m1.5.5.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.5.5.1.1.1.1.1.1.3.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml">
                  ℒ
                 </mi>
                 <mrow id="S4.E2.m1.4.4.2.4" xref="S4.E2.m1.4.4.2.3.cmml">
                  <mi id="S4.E2.m1.3.3.1.1" xref="S4.E2.m1.3.3.1.1.cmml">
                   S
                  </mi>
                  <mo id="S4.E2.m1.4.4.2.4.1" xref="S4.E2.m1.4.4.2.3.cmml">
                   ,
                  </mo>
                  <mi id="S4.E2.m1.4.4.2.2" xref="S4.E2.m1.4.4.2.2.cmml">
                   I
                  </mi>
                 </mrow>
                </msub>
               </mrow>
               <mo id="S4.E2.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.5.5.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
              <mo id="S4.E2.m1.5.5.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.2.cmml">
               /
              </mo>
              <mn id="S4.E2.m1.5.5.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.3.cmml">
               2
              </mn>
             </mrow>
            </mrow>
            <mo id="S4.E2.m1.5.5.1.2" lspace="0em" xref="S4.E2.m1.5.5.1.1.cmml">
             .
            </mo>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S4.E2.m1.5b">
            <apply id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1">
             <eq id="S4.E2.m1.5.5.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.2">
             </eq>
             <apply id="S4.E2.m1.5.5.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.3">
              <csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E2.m1.5.5.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.3.2">
               ℒ
              </ci>
              <ci id="S4.E2.m1.5.5.1.1.3.3a.cmml" xref="S4.E2.m1.5.5.1.1.3.3">
               <mtext id="S4.E2.m1.5.5.1.1.3.3.cmml" mathsize="70%" xref="S4.E2.m1.5.5.1.1.3.3">
                ISA
               </mtext>
              </ci>
             </apply>
             <apply id="S4.E2.m1.5.5.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1">
              <divide id="S4.E2.m1.5.5.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.2">
              </divide>
              <apply id="S4.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1">
               <plus id="S4.E2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1">
               </plus>
               <apply id="S4.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2">
                <csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2">
                 subscript
                </csymbol>
                <ci id="S4.E2.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.2.2">
                 ℒ
                </ci>
                <list id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.4">
                 <ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">
                  𝐼
                 </ci>
                 <ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">
                  𝑆
                 </ci>
                </list>
               </apply>
               <apply id="S4.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="S4.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.3.2">
                 ℒ
                </ci>
                <list id="S4.E2.m1.4.4.2.3.cmml" xref="S4.E2.m1.4.4.2.4">
                 <ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">
                  𝑆
                 </ci>
                 <ci id="S4.E2.m1.4.4.2.2.cmml" xref="S4.E2.m1.4.4.2.2">
                  𝐼
                 </ci>
                </list>
               </apply>
              </apply>
              <cn id="S4.E2.m1.5.5.1.1.1.3.cmml" type="integer" xref="S4.E2.m1.5.5.1.1.1.3">
               2
              </cn>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S4.E2.m1.5c">
            \displaystyle\mathcal{L}_{\text{ISA}}=(\mathcal{L}_{I,S}+\mathcal{L}_{S,I})/2.
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p6">
     <p class="ltx_p" id="S4.SS3.SSS1.p6.4">
      In ISG, the goal is to generate suggestions based on the underlying image content, thereby enhancing the RewardNet’s ability to accurately assign scores to image-suggestion pairs. This is achieved by ensuring that the generated suggestions are semantically consistent with the visual context of the grounded image. Specifically, given an image-suggestion
      <math alttext="&lt;I,S&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS1.p6.1.m1.2">
       <semantics id="S4.SS3.SSS1.p6.1.m1.2a">
        <mrow id="S4.SS3.SSS1.p6.1.m1.2b">
         <mo id="S4.SS3.SSS1.p6.1.m1.2.3">
          &lt;
         </mo>
         <mi id="S4.SS3.SSS1.p6.1.m1.1.1">
          I
         </mi>
         <mo id="S4.SS3.SSS1.p6.1.m1.2.4">
          ,
         </mo>
         <mi id="S4.SS3.SSS1.p6.1.m1.2.2">
          S
         </mi>
         <mo id="S4.SS3.SSS1.p6.1.m1.2.5">
          &gt;
         </mo>
        </mrow>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p6.1.m1.2c">
         &lt;I,S&gt;
        </annotation>
       </semantics>
      </math>
      pair, where the suggestion
      <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p6.2.m2.1">
       <semantics id="S4.SS3.SSS1.p6.2.m2.1a">
        <mi id="S4.SS3.SSS1.p6.2.m2.1.1" xref="S4.SS3.SSS1.p6.2.m2.1.1.cmml">
         S
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p6.2.m2.1b">
         <ci id="S4.SS3.SSS1.p6.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p6.2.m2.1.1">
          𝑆
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p6.2.m2.1c">
         S
        </annotation>
       </semantics>
      </math>
      corresponds to a sequence of word tokens
      <math alttext="S=&lt;\mathbf{w}_{1},...,\mathbf{w}_{m}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS1.p6.3.m3.1">
       <semantics id="S4.SS3.SSS1.p6.3.m3.1a">
        <mrow id="S4.SS3.SSS1.p6.3.m3.1b">
         <mi id="S4.SS3.SSS1.p6.3.m3.1.2">
          S
         </mi>
         <mo id="S4.SS3.SSS1.p6.3.m3.1.3" rspace="0em">
          =
         </mo>
         <mo id="S4.SS3.SSS1.p6.3.m3.1.4" lspace="0em">
          &lt;
         </mo>
         <msub id="S4.SS3.SSS1.p6.3.m3.1.5">
          <mi id="S4.SS3.SSS1.p6.3.m3.1.5.2">
           𝐰
          </mi>
          <mn id="S4.SS3.SSS1.p6.3.m3.1.5.3">
           1
          </mn>
         </msub>
         <mo id="S4.SS3.SSS1.p6.3.m3.1.6">
          ,
         </mo>
         <mi id="S4.SS3.SSS1.p6.3.m3.1.1" mathvariant="normal">
          …
         </mi>
         <mo id="S4.SS3.SSS1.p6.3.m3.1.7">
          ,
         </mo>
         <msub id="S4.SS3.SSS1.p6.3.m3.1.8">
          <mi id="S4.SS3.SSS1.p6.3.m3.1.8.2">
           𝐰
          </mi>
          <mi id="S4.SS3.SSS1.p6.3.m3.1.8.3">
           m
          </mi>
         </msub>
         <mo id="S4.SS3.SSS1.p6.3.m3.1.9">
          &gt;
         </mo>
        </mrow>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p6.3.m3.1c">
         S=&lt;\mathbf{w}_{1},...,\mathbf{w}_{m}&gt;
        </annotation>
       </semantics>
      </math>
      , we employ a language generation loss to maximize the conditional probability
      <math alttext="P" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p6.4.m4.1">
       <semantics id="S4.SS3.SSS1.p6.4.m4.1a">
        <mi id="S4.SS3.SSS1.p6.4.m4.1.1" xref="S4.SS3.SSS1.p6.4.m4.1.1.cmml">
         P
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p6.4.m4.1b">
         <ci id="S4.SS3.SSS1.p6.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p6.4.m4.1.1">
          𝑃
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p6.4.m4.1c">
         P
        </annotation>
       </semantics>
      </math>
      as
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p7">
     <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
      <tbody id="S4.E3">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_left">
          (3)
         </span>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathcal{L}_{\text{ISG}}=\sum\limits_{i}-\log P(\mathbf{w}_{i}|\mathbf{w}_{1:i-1},I)." class="ltx_Math" display="inline" id="S4.E3.m1.2">
          <semantics id="S4.E3.m1.2a">
           <mrow id="S4.E3.m1.2.2.1" xref="S4.E3.m1.2.2.1.1.cmml">
            <mrow id="S4.E3.m1.2.2.1.1" xref="S4.E3.m1.2.2.1.1.cmml">
             <msub id="S4.E3.m1.2.2.1.1.3" xref="S4.E3.m1.2.2.1.1.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.2.2.1.1.3.2" xref="S4.E3.m1.2.2.1.1.3.2.cmml">
               ℒ
              </mi>
              <mtext id="S4.E3.m1.2.2.1.1.3.3" xref="S4.E3.m1.2.2.1.1.3.3a.cmml">
               ISG
              </mtext>
             </msub>
             <mo id="S4.E3.m1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.cmml">
              =
             </mo>
             <mrow id="S4.E3.m1.2.2.1.1.1" xref="S4.E3.m1.2.2.1.1.1.cmml">
              <mstyle displaystyle="true" id="S4.E3.m1.2.2.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.3.cmml">
               <munder id="S4.E3.m1.2.2.1.1.1.3a" xref="S4.E3.m1.2.2.1.1.1.3.cmml">
                <mo id="S4.E3.m1.2.2.1.1.1.3.2" movablelimits="false" xref="S4.E3.m1.2.2.1.1.1.3.2.cmml">
                 ∑
                </mo>
                <mi id="S4.E3.m1.2.2.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.1.3.3.cmml">
                 i
                </mi>
               </munder>
              </mstyle>
              <mo id="S4.E3.m1.2.2.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.2.cmml">
               −
              </mo>
              <mrow id="S4.E3.m1.2.2.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.cmml">
               <mrow id="S4.E3.m1.2.2.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.3.cmml">
                <mi id="S4.E3.m1.2.2.1.1.1.1.3.1" xref="S4.E3.m1.2.2.1.1.1.1.3.1.cmml">
                 log
                </mi>
                <mo id="S4.E3.m1.2.2.1.1.1.1.3a" lspace="0.167em" xref="S4.E3.m1.2.2.1.1.1.1.3.cmml">
                 ⁡
                </mo>
                <mi id="S4.E3.m1.2.2.1.1.1.1.3.2" xref="S4.E3.m1.2.2.1.1.1.1.3.2.cmml">
                 P
                </mi>
               </mrow>
               <mo id="S4.E3.m1.2.2.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E3.m1.2.2.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S4.E3.m1.2.2.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml">
                <mo id="S4.E3.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="S4.E3.m1.2.2.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml">
                 <msub id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml">
                  <mi id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">
                   𝐰
                  </mi>
                  <mi id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">
                   i
                  </mi>
                 </msub>
                 <mo fence="false" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml">
                  |
                 </mo>
                 <mrow id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">
                  <msub id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    𝐰
                   </mi>
                   <mrow id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    <mn id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                     1
                    </mn>
                    <mo id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">
                     :
                    </mo>
                    <mrow id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                     <mi id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">
                      i
                     </mi>
                     <mo id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                      −
                     </mo>
                     <mn id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                      1
                     </mn>
                    </mrow>
                   </mrow>
                  </msub>
                  <mo id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">
                   ,
                  </mo>
                  <mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">
                   I
                  </mi>
                 </mrow>
                </mrow>
                <mo id="S4.E3.m1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
            <mo id="S4.E3.m1.2.2.1.2" lspace="0em" xref="S4.E3.m1.2.2.1.1.cmml">
             .
            </mo>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b">
            <apply id="S4.E3.m1.2.2.1.1.cmml" xref="S4.E3.m1.2.2.1">
             <eq id="S4.E3.m1.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2">
             </eq>
             <apply id="S4.E3.m1.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.3">
              <csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.3">
               subscript
              </csymbol>
              <ci id="S4.E3.m1.2.2.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.3.2">
               ℒ
              </ci>
              <ci id="S4.E3.m1.2.2.1.1.3.3a.cmml" xref="S4.E3.m1.2.2.1.1.3.3">
               <mtext id="S4.E3.m1.2.2.1.1.3.3.cmml" mathsize="70%" xref="S4.E3.m1.2.2.1.1.3.3">
                ISG
               </mtext>
              </ci>
             </apply>
             <apply id="S4.E3.m1.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1">
              <minus id="S4.E3.m1.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.2">
              </minus>
              <apply id="S4.E3.m1.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.3">
               <csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.3">
                subscript
               </csymbol>
               <sum id="S4.E3.m1.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.1.3.2">
               </sum>
               <ci id="S4.E3.m1.2.2.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.1.3.3">
                𝑖
               </ci>
              </apply>
              <apply id="S4.E3.m1.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1">
               <times id="S4.E3.m1.2.2.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.2">
               </times>
               <apply id="S4.E3.m1.2.2.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3">
                <log id="S4.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.1">
                </log>
                <ci id="S4.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.2">
                 𝑃
                </ci>
               </apply>
               <apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1">
                <csymbol cd="latexml" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.2">
                 conditional
                </csymbol>
                <apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.2">
                  𝐰
                 </ci>
                 <ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.3.3">
                  𝑖
                 </ci>
                </apply>
                <list id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1">
                 <apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">
                   𝐰
                  </ci>
                  <apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">
                   <ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1">
                    :
                   </ci>
                   <cn id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">
                    1
                   </cn>
                   <apply id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">
                    <minus id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1">
                    </minus>
                    <ci id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2">
                     𝑖
                    </ci>
                    <cn id="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3">
                     1
                    </cn>
                   </apply>
                  </apply>
                 </apply>
                 <ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">
                  𝐼
                 </ci>
                </list>
               </apply>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S4.E3.m1.2c">
            \displaystyle\mathcal{L}_{\text{ISG}}=\sum\limits_{i}-\log P(\mathbf{w}_{i}|\mathbf{w}_{1:i-1},I).
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p8">
     <p class="ltx_p" id="S4.SS3.SSS1.p8.3">
      In ISM, the goal is to establish a precise alignment between image and suggestion representations through fine-grained learning. This involves a binary classification task in which the model is to predict whether an image-suggestion pair is positive (matched) or negative (unmatched). To achieve this, we use a hard negative mining strategy, where hard negative samples are image-related suggestions labeled as 0. The rationale is that while some suggestions are related to the query image, they fail to capture the user’s search intent. By optimizing with these hard samples, the RewardNet is encouraged to assign high scores to the pairs exhibiting a strong intention. Then, the objective is trained using a binary cross-entropy loss, formulated as
     </p>
     <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
      <tbody id="S4.E4">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_left">
          (4)
         </span>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathcal{L}_{\text{ISM}}=-y*\log(P)+(y-1)*\log(1-P)," class="ltx_Math" display="inline" id="S4.E4.m1.4">
          <semantics id="S4.E4.m1.4a">
           <mrow id="S4.E4.m1.4.4.1" xref="S4.E4.m1.4.4.1.1.cmml">
            <mrow id="S4.E4.m1.4.4.1.1" xref="S4.E4.m1.4.4.1.1.cmml">
             <msub id="S4.E4.m1.4.4.1.1.4" xref="S4.E4.m1.4.4.1.1.4.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.4.2" xref="S4.E4.m1.4.4.1.1.4.2.cmml">
               ℒ
              </mi>
              <mtext id="S4.E4.m1.4.4.1.1.4.3" xref="S4.E4.m1.4.4.1.1.4.3a.cmml">
               ISM
              </mtext>
             </msub>
             <mo id="S4.E4.m1.4.4.1.1.3" xref="S4.E4.m1.4.4.1.1.3.cmml">
              =
             </mo>
             <mrow id="S4.E4.m1.4.4.1.1.2" xref="S4.E4.m1.4.4.1.1.2.cmml">
              <mrow id="S4.E4.m1.4.4.1.1.2.4" xref="S4.E4.m1.4.4.1.1.2.4.cmml">
               <mo id="S4.E4.m1.4.4.1.1.2.4a" xref="S4.E4.m1.4.4.1.1.2.4.cmml">
                −
               </mo>
               <mrow id="S4.E4.m1.4.4.1.1.2.4.2" xref="S4.E4.m1.4.4.1.1.2.4.2.cmml">
                <mi id="S4.E4.m1.4.4.1.1.2.4.2.2" xref="S4.E4.m1.4.4.1.1.2.4.2.2.cmml">
                 y
                </mi>
                <mo id="S4.E4.m1.4.4.1.1.2.4.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E4.m1.4.4.1.1.2.4.2.1.cmml">
                 ∗
                </mo>
                <mrow id="S4.E4.m1.4.4.1.1.2.4.2.3.2" xref="S4.E4.m1.4.4.1.1.2.4.2.3.1.cmml">
                 <mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">
                  log
                 </mi>
                 <mo id="S4.E4.m1.4.4.1.1.2.4.2.3.2a" xref="S4.E4.m1.4.4.1.1.2.4.2.3.1.cmml">
                  ⁡
                 </mo>
                 <mrow id="S4.E4.m1.4.4.1.1.2.4.2.3.2.1" xref="S4.E4.m1.4.4.1.1.2.4.2.3.1.cmml">
                  <mo id="S4.E4.m1.4.4.1.1.2.4.2.3.2.1.1" stretchy="false" xref="S4.E4.m1.4.4.1.1.2.4.2.3.1.cmml">
                   (
                  </mo>
                  <mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">
                   P
                  </mi>
                  <mo id="S4.E4.m1.4.4.1.1.2.4.2.3.2.1.2" stretchy="false" xref="S4.E4.m1.4.4.1.1.2.4.2.3.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </mrow>
              <mo id="S4.E4.m1.4.4.1.1.2.3" xref="S4.E4.m1.4.4.1.1.2.3.cmml">
               +
              </mo>
              <mrow id="S4.E4.m1.4.4.1.1.2.2" xref="S4.E4.m1.4.4.1.1.2.2.cmml">
               <mrow id="S4.E4.m1.4.4.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml">
                <mo id="S4.E4.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml">
                 <mi id="S4.E4.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml">
                  y
                 </mi>
                 <mo id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml">
                  −
                 </mo>
                 <mn id="S4.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml">
                  1
                 </mn>
                </mrow>
                <mo id="S4.E4.m1.4.4.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
               <mo id="S4.E4.m1.4.4.1.1.2.2.3" rspace="0.222em" xref="S4.E4.m1.4.4.1.1.2.2.3.cmml">
                ∗
               </mo>
               <mrow id="S4.E4.m1.4.4.1.1.2.2.2.1" xref="S4.E4.m1.4.4.1.1.2.2.2.2.cmml">
                <mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">
                 log
                </mi>
                <mo id="S4.E4.m1.4.4.1.1.2.2.2.1a" xref="S4.E4.m1.4.4.1.1.2.2.2.2.cmml">
                 ⁡
                </mo>
                <mrow id="S4.E4.m1.4.4.1.1.2.2.2.1.1" xref="S4.E4.m1.4.4.1.1.2.2.2.2.cmml">
                 <mo id="S4.E4.m1.4.4.1.1.2.2.2.1.1.2" stretchy="false" xref="S4.E4.m1.4.4.1.1.2.2.2.2.cmml">
                  (
                 </mo>
                 <mrow id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.cmml">
                  <mn id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.2" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.2.cmml">
                   1
                  </mn>
                  <mo id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.1" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.1.cmml">
                   −
                  </mo>
                  <mi id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.3" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.3.cmml">
                   P
                  </mi>
                 </mrow>
                 <mo id="S4.E4.m1.4.4.1.1.2.2.2.1.1.3" stretchy="false" xref="S4.E4.m1.4.4.1.1.2.2.2.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
            <mo id="S4.E4.m1.4.4.1.2" xref="S4.E4.m1.4.4.1.1.cmml">
             ,
            </mo>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S4.E4.m1.4b">
            <apply id="S4.E4.m1.4.4.1.1.cmml" xref="S4.E4.m1.4.4.1">
             <eq id="S4.E4.m1.4.4.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.3">
             </eq>
             <apply id="S4.E4.m1.4.4.1.1.4.cmml" xref="S4.E4.m1.4.4.1.1.4">
              <csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.4.1.cmml" xref="S4.E4.m1.4.4.1.1.4">
               subscript
              </csymbol>
              <ci id="S4.E4.m1.4.4.1.1.4.2.cmml" xref="S4.E4.m1.4.4.1.1.4.2">
               ℒ
              </ci>
              <ci id="S4.E4.m1.4.4.1.1.4.3a.cmml" xref="S4.E4.m1.4.4.1.1.4.3">
               <mtext id="S4.E4.m1.4.4.1.1.4.3.cmml" mathsize="70%" xref="S4.E4.m1.4.4.1.1.4.3">
                ISM
               </mtext>
              </ci>
             </apply>
             <apply id="S4.E4.m1.4.4.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.2">
              <plus id="S4.E4.m1.4.4.1.1.2.3.cmml" xref="S4.E4.m1.4.4.1.1.2.3">
              </plus>
              <apply id="S4.E4.m1.4.4.1.1.2.4.cmml" xref="S4.E4.m1.4.4.1.1.2.4">
               <minus id="S4.E4.m1.4.4.1.1.2.4.1.cmml" xref="S4.E4.m1.4.4.1.1.2.4">
               </minus>
               <apply id="S4.E4.m1.4.4.1.1.2.4.2.cmml" xref="S4.E4.m1.4.4.1.1.2.4.2">
                <times id="S4.E4.m1.4.4.1.1.2.4.2.1.cmml" xref="S4.E4.m1.4.4.1.1.2.4.2.1">
                </times>
                <ci id="S4.E4.m1.4.4.1.1.2.4.2.2.cmml" xref="S4.E4.m1.4.4.1.1.2.4.2.2">
                 𝑦
                </ci>
                <apply id="S4.E4.m1.4.4.1.1.2.4.2.3.1.cmml" xref="S4.E4.m1.4.4.1.1.2.4.2.3.2">
                 <log id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">
                 </log>
                 <ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">
                  𝑃
                 </ci>
                </apply>
               </apply>
              </apply>
              <apply id="S4.E4.m1.4.4.1.1.2.2.cmml" xref="S4.E4.m1.4.4.1.1.2.2">
               <times id="S4.E4.m1.4.4.1.1.2.2.3.cmml" xref="S4.E4.m1.4.4.1.1.2.2.3">
               </times>
               <apply id="S4.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1">
                <minus id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1">
                </minus>
                <ci id="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.2">
                 𝑦
                </ci>
                <cn id="S4.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.3">
                 1
                </cn>
               </apply>
               <apply id="S4.E4.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.1">
                <log id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">
                </log>
                <apply id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1">
                 <minus id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.1">
                 </minus>
                 <cn id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.2.cmml" type="integer" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.2">
                  1
                 </cn>
                 <ci id="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.2.2.2.1.1.1.3">
                  𝑃
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S4.E4.m1.4c">
            \displaystyle\mathcal{L}_{\text{ISM}}=-y*\log(P)+(y-1)*\log(1-P),
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S4.SS3.SSS1.p8.2">
      where
      <math alttext="y" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p8.1.m1.1">
       <semantics id="S4.SS3.SSS1.p8.1.m1.1a">
        <mi id="S4.SS3.SSS1.p8.1.m1.1.1" xref="S4.SS3.SSS1.p8.1.m1.1.1.cmml">
         y
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p8.1.m1.1b">
         <ci id="S4.SS3.SSS1.p8.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p8.1.m1.1.1">
          𝑦
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p8.1.m1.1c">
         y
        </annotation>
       </semantics>
      </math>
      denotes the true label (either 0 or 1), and
      <math alttext="P" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p8.2.m2.1">
       <semantics id="S4.SS3.SSS1.p8.2.m2.1a">
        <mi id="S4.SS3.SSS1.p8.2.m2.1.1" xref="S4.SS3.SSS1.p8.2.m2.1.1.cmml">
         P
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p8.2.m2.1b">
         <ci id="S4.SS3.SSS1.p8.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p8.2.m2.1.1">
          𝑃
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p8.2.m2.1c">
         P
        </annotation>
       </semantics>
      </math>
      is the predicted probability of the positive class.
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p9">
     <p class="ltx_p" id="S4.SS3.SSS1.p9.1">
      Finally, the RewardNet is trained using a multi-task learning approach, where the loss function
      <math alttext="\mathcal{L}_{\text{RN}}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p9.1.m1.1">
       <semantics id="S4.SS3.SSS1.p9.1.m1.1a">
        <msub id="S4.SS3.SSS1.p9.1.m1.1.1" xref="S4.SS3.SSS1.p9.1.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS1.p9.1.m1.1.1.2" xref="S4.SS3.SSS1.p9.1.m1.1.1.2.cmml">
          ℒ
         </mi>
         <mtext id="S4.SS3.SSS1.p9.1.m1.1.1.3" xref="S4.SS3.SSS1.p9.1.m1.1.1.3a.cmml">
          RN
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p9.1.m1.1b">
         <apply id="S4.SS3.SSS1.p9.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p9.1.m1.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS1.p9.1.m1.1.1.1.cmml" xref="S4.SS3.SSS1.p9.1.m1.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS3.SSS1.p9.1.m1.1.1.2.cmml" xref="S4.SS3.SSS1.p9.1.m1.1.1.2">
           ℒ
          </ci>
          <ci id="S4.SS3.SSS1.p9.1.m1.1.1.3a.cmml" xref="S4.SS3.SSS1.p9.1.m1.1.1.3">
           <mtext id="S4.SS3.SSS1.p9.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.SS3.SSS1.p9.1.m1.1.1.3">
            RN
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p9.1.m1.1c">
         \mathcal{L}_{\text{RN}}
        </annotation>
       </semantics>
      </math>
      is defined as
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p10">
     <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx5">
      <tbody id="S4.E5">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_left">
          (5)
         </span>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\mathcal{L}_{\text{RN}}=\mathcal{L}_{\text{ISA}}+\mathcal{L}_{\text{ISG}}+\mathcal{L}_{\text{ISM}}." class="ltx_Math" display="inline" id="S4.E5.m1.1">
          <semantics id="S4.E5.m1.1a">
           <mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">
            <mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">
             <msub id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml">
              <mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.2.2.cmml">
               ℒ
              </mi>
              <mtext id="S4.E5.m1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.2.3a.cmml">
               RN
              </mtext>
             </msub>
             <mo id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml">
              =
             </mo>
             <mrow id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml">
              <msub id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.3.2.2" xref="S4.E5.m1.1.1.1.1.3.2.2.cmml">
                ℒ
               </mi>
               <mtext id="S4.E5.m1.1.1.1.1.3.2.3" xref="S4.E5.m1.1.1.1.1.3.2.3a.cmml">
                ISA
               </mtext>
              </msub>
              <mo id="S4.E5.m1.1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.1.3.1.cmml">
               +
              </mo>
              <msub id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.3.3.2" xref="S4.E5.m1.1.1.1.1.3.3.2.cmml">
                ℒ
               </mi>
               <mtext id="S4.E5.m1.1.1.1.1.3.3.3" xref="S4.E5.m1.1.1.1.1.3.3.3a.cmml">
                ISG
               </mtext>
              </msub>
              <mo id="S4.E5.m1.1.1.1.1.3.1a" xref="S4.E5.m1.1.1.1.1.3.1.cmml">
               +
              </mo>
              <msub id="S4.E5.m1.1.1.1.1.3.4" xref="S4.E5.m1.1.1.1.1.3.4.cmml">
               <mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.1.1.1.1.3.4.2" xref="S4.E5.m1.1.1.1.1.3.4.2.cmml">
                ℒ
               </mi>
               <mtext id="S4.E5.m1.1.1.1.1.3.4.3" xref="S4.E5.m1.1.1.1.1.3.4.3a.cmml">
                ISM
               </mtext>
              </msub>
             </mrow>
            </mrow>
            <mo id="S4.E5.m1.1.1.1.2" lspace="0em" xref="S4.E5.m1.1.1.1.1.cmml">
             .
            </mo>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b">
            <apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1">
             <eq id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1">
             </eq>
             <apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2">
              <csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.2">
               subscript
              </csymbol>
              <ci id="S4.E5.m1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.2.2">
               ℒ
              </ci>
              <ci id="S4.E5.m1.1.1.1.1.2.3a.cmml" xref="S4.E5.m1.1.1.1.1.2.3">
               <mtext id="S4.E5.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S4.E5.m1.1.1.1.1.2.3">
                RN
               </mtext>
              </ci>
             </apply>
             <apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3">
              <plus id="S4.E5.m1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.1">
              </plus>
              <apply id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2">
               <csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.2">
                subscript
               </csymbol>
               <ci id="S4.E5.m1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2.2">
                ℒ
               </ci>
               <ci id="S4.E5.m1.1.1.1.1.3.2.3a.cmml" xref="S4.E5.m1.1.1.1.1.3.2.3">
                <mtext id="S4.E5.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S4.E5.m1.1.1.1.1.3.2.3">
                 ISA
                </mtext>
               </ci>
              </apply>
              <apply id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3">
               <csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.3">
                subscript
               </csymbol>
               <ci id="S4.E5.m1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.3.2">
                ℒ
               </ci>
               <ci id="S4.E5.m1.1.1.1.1.3.3.3a.cmml" xref="S4.E5.m1.1.1.1.1.3.3.3">
                <mtext id="S4.E5.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S4.E5.m1.1.1.1.1.3.3.3">
                 ISG
                </mtext>
               </ci>
              </apply>
              <apply id="S4.E5.m1.1.1.1.1.3.4.cmml" xref="S4.E5.m1.1.1.1.1.3.4">
               <csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.4.1.cmml" xref="S4.E5.m1.1.1.1.1.3.4">
                subscript
               </csymbol>
               <ci id="S4.E5.m1.1.1.1.1.3.4.2.cmml" xref="S4.E5.m1.1.1.1.1.3.4.2">
                ℒ
               </ci>
               <ci id="S4.E5.m1.1.1.1.1.3.4.3a.cmml" xref="S4.E5.m1.1.1.1.1.3.4.3">
                <mtext id="S4.E5.m1.1.1.1.1.3.4.3.cmml" mathsize="70%" xref="S4.E5.m1.1.1.1.1.3.4.3">
                 ISM
                </mtext>
               </ci>
              </apply>
             </apply>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S4.E5.m1.1c">
            \displaystyle\mathcal{L}_{\text{RN}}=\mathcal{L}_{\text{ISA}}+\mathcal{L}_{\text{ISG}}+\mathcal{L}_{\text{ISM}}.
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S4.SS3.SSS1.p10.1">
      Note that the reward is then obtained as the predicted probability
      <math alttext="P" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p10.1.m1.1">
       <semantics id="S4.SS3.SSS1.p10.1.m1.1a">
        <mi id="S4.SS3.SSS1.p10.1.m1.1.1" xref="S4.SS3.SSS1.p10.1.m1.1.1.cmml">
         P
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p10.1.m1.1b">
         <ci id="S4.SS3.SSS1.p10.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p10.1.m1.1.1">
          𝑃
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p10.1.m1.1c">
         P
        </annotation>
       </semantics>
      </math>
      in the ISM task, where it scores a normalized value ranging from 0 to 1, which avoids potential data scale issues that may arise during the training process, that is
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS1.p11">
     <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx6">
      <tbody id="S4.E6">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_left">
          (6)
         </span>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle r_{\theta}(I,S)=P," class="ltx_Math" display="inline" id="S4.E6.m1.3">
          <semantics id="S4.E6.m1.3a">
           <mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml">
            <mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">
             <mrow id="S4.E6.m1.3.3.1.1.2" xref="S4.E6.m1.3.3.1.1.2.cmml">
              <msub id="S4.E6.m1.3.3.1.1.2.2" xref="S4.E6.m1.3.3.1.1.2.2.cmml">
               <mi id="S4.E6.m1.3.3.1.1.2.2.2" xref="S4.E6.m1.3.3.1.1.2.2.2.cmml">
                r
               </mi>
               <mi id="S4.E6.m1.3.3.1.1.2.2.3" xref="S4.E6.m1.3.3.1.1.2.2.3.cmml">
                θ
               </mi>
              </msub>
              <mo id="S4.E6.m1.3.3.1.1.2.1" lspace="0em" rspace="0em" xref="S4.E6.m1.3.3.1.1.2.1.cmml">
               ​
              </mo>
              <mrow id="S4.E6.m1.3.3.1.1.2.3.2" xref="S4.E6.m1.3.3.1.1.2.3.1.cmml">
               <mo id="S4.E6.m1.3.3.1.1.2.3.2.1" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.3.1.cmml">
                (
               </mo>
               <mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">
                I
               </mi>
               <mo id="S4.E6.m1.3.3.1.1.2.3.2.2" xref="S4.E6.m1.3.3.1.1.2.3.1.cmml">
                ,
               </mo>
               <mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">
                S
               </mi>
               <mo id="S4.E6.m1.3.3.1.1.2.3.2.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.2.3.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml">
              =
             </mo>
             <mi id="S4.E6.m1.3.3.1.1.3" xref="S4.E6.m1.3.3.1.1.3.cmml">
              P
             </mi>
            </mrow>
            <mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">
             ,
            </mo>
           </mrow>
           <annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b">
            <apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1">
             <eq id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1">
             </eq>
             <apply id="S4.E6.m1.3.3.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.2">
              <times id="S4.E6.m1.3.3.1.1.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.1">
              </times>
              <apply id="S4.E6.m1.3.3.1.1.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2">
               <csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.2.2.1.cmml" xref="S4.E6.m1.3.3.1.1.2.2">
                subscript
               </csymbol>
               <ci id="S4.E6.m1.3.3.1.1.2.2.2.cmml" xref="S4.E6.m1.3.3.1.1.2.2.2">
                𝑟
               </ci>
               <ci id="S4.E6.m1.3.3.1.1.2.2.3.cmml" xref="S4.E6.m1.3.3.1.1.2.2.3">
                𝜃
               </ci>
              </apply>
              <interval closure="open" id="S4.E6.m1.3.3.1.1.2.3.1.cmml" xref="S4.E6.m1.3.3.1.1.2.3.2">
               <ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">
                𝐼
               </ci>
               <ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">
                𝑆
               </ci>
              </interval>
             </apply>
             <ci id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3">
              𝑃
             </ci>
            </apply>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S4.E6.m1.3c">
            \displaystyle r_{\theta}(I,S)=P,
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
       </tr>
      </tbody>
     </table>
     <p class="ltx_p" id="S4.SS3.SSS1.p11.4">
      where
      <math alttext="r_{\theta}(I,S)" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p11.1.m1.2">
       <semantics id="S4.SS3.SSS1.p11.1.m1.2a">
        <mrow id="S4.SS3.SSS1.p11.1.m1.2.3" xref="S4.SS3.SSS1.p11.1.m1.2.3.cmml">
         <msub id="S4.SS3.SSS1.p11.1.m1.2.3.2" xref="S4.SS3.SSS1.p11.1.m1.2.3.2.cmml">
          <mi id="S4.SS3.SSS1.p11.1.m1.2.3.2.2" xref="S4.SS3.SSS1.p11.1.m1.2.3.2.2.cmml">
           r
          </mi>
          <mi id="S4.SS3.SSS1.p11.1.m1.2.3.2.3" xref="S4.SS3.SSS1.p11.1.m1.2.3.2.3.cmml">
           θ
          </mi>
         </msub>
         <mo id="S4.SS3.SSS1.p11.1.m1.2.3.1" lspace="0em" rspace="0em" xref="S4.SS3.SSS1.p11.1.m1.2.3.1.cmml">
          ​
         </mo>
         <mrow id="S4.SS3.SSS1.p11.1.m1.2.3.3.2" xref="S4.SS3.SSS1.p11.1.m1.2.3.3.1.cmml">
          <mo id="S4.SS3.SSS1.p11.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS3.SSS1.p11.1.m1.2.3.3.1.cmml">
           (
          </mo>
          <mi id="S4.SS3.SSS1.p11.1.m1.1.1" xref="S4.SS3.SSS1.p11.1.m1.1.1.cmml">
           I
          </mi>
          <mo id="S4.SS3.SSS1.p11.1.m1.2.3.3.2.2" xref="S4.SS3.SSS1.p11.1.m1.2.3.3.1.cmml">
           ,
          </mo>
          <mi id="S4.SS3.SSS1.p11.1.m1.2.2" xref="S4.SS3.SSS1.p11.1.m1.2.2.cmml">
           S
          </mi>
          <mo id="S4.SS3.SSS1.p11.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS3.SSS1.p11.1.m1.2.3.3.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p11.1.m1.2b">
         <apply id="S4.SS3.SSS1.p11.1.m1.2.3.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3">
          <times id="S4.SS3.SSS1.p11.1.m1.2.3.1.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3.1">
          </times>
          <apply id="S4.SS3.SSS1.p11.1.m1.2.3.2.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3.2">
           <csymbol cd="ambiguous" id="S4.SS3.SSS1.p11.1.m1.2.3.2.1.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3.2">
            subscript
           </csymbol>
           <ci id="S4.SS3.SSS1.p11.1.m1.2.3.2.2.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3.2.2">
            𝑟
           </ci>
           <ci id="S4.SS3.SSS1.p11.1.m1.2.3.2.3.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3.2.3">
            𝜃
           </ci>
          </apply>
          <interval closure="open" id="S4.SS3.SSS1.p11.1.m1.2.3.3.1.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.3.3.2">
           <ci id="S4.SS3.SSS1.p11.1.m1.1.1.cmml" xref="S4.SS3.SSS1.p11.1.m1.1.1">
            𝐼
           </ci>
           <ci id="S4.SS3.SSS1.p11.1.m1.2.2.cmml" xref="S4.SS3.SSS1.p11.1.m1.2.2">
            𝑆
           </ci>
          </interval>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p11.1.m1.2c">
         r_{\theta}(I,S)
        </annotation>
       </semantics>
      </math>
      denotes the reward for a given query image
      <math alttext="I" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p11.2.m2.1">
       <semantics id="S4.SS3.SSS1.p11.2.m2.1a">
        <mi id="S4.SS3.SSS1.p11.2.m2.1.1" xref="S4.SS3.SSS1.p11.2.m2.1.1.cmml">
         I
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p11.2.m2.1b">
         <ci id="S4.SS3.SSS1.p11.2.m2.1.1.cmml" xref="S4.SS3.SSS1.p11.2.m2.1.1">
          𝐼
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p11.2.m2.1c">
         I
        </annotation>
       </semantics>
      </math>
      and its associated suggestion
      <math alttext="S" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p11.3.m3.1">
       <semantics id="S4.SS3.SSS1.p11.3.m3.1a">
        <mi id="S4.SS3.SSS1.p11.3.m3.1.1" xref="S4.SS3.SSS1.p11.3.m3.1.1.cmml">
         S
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p11.3.m3.1b">
         <ci id="S4.SS3.SSS1.p11.3.m3.1.1.cmml" xref="S4.SS3.SSS1.p11.3.m3.1.1">
          𝑆
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p11.3.m3.1c">
         S
        </annotation>
       </semantics>
      </math>
      , and
      <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p11.4.m4.1">
       <semantics id="S4.SS3.SSS1.p11.4.m4.1a">
        <mi id="S4.SS3.SSS1.p11.4.m4.1.1" xref="S4.SS3.SSS1.p11.4.m4.1.1.cmml">
         θ
        </mi>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS1.p11.4.m4.1b">
         <ci id="S4.SS3.SSS1.p11.4.m4.1.1.cmml" xref="S4.SS3.SSS1.p11.4.m4.1.1">
          𝜃
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS1.p11.4.m4.1c">
         \theta
        </annotation>
       </semantics>
      </math>
      denotes the RewardNet parameters.
     </p>
    </div>
   </section>
   <section class="ltx_subsubsection" id="S4.SS3.SSS2">
    <h4 class="ltx_title ltx_title_subsubsection">
     <span class="ltx_tag ltx_tag_subsubsection">
      4.3.2.
     </span>
     <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.1.1">
      PolicyNet
     </span>
    </h4>
    <div class="ltx_para" id="S4.SS3.SSS2.p1">
     <p class="ltx_p" id="S4.SS3.SSS2.p1.1">
      The objective of MMQS is to generate query suggestions that align with users’ intended search queries, specifically those that are more likely to be clicked. This motivates us to explore the application of Reinforcement Learning from Human Feedback (RLHF) technique in training the PolicyNet. Below, we present the model architecture, and MDPs in the PolicyNet.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p2">
     <p class="ltx_p" id="S4.SS3.SSS2.p2.1">
      <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p2.1.1">
       Model Architecture.
      </span>
      In PolicyNet, we adopt a similar two-tower structure as presented in the RewardNet, to capture both visual and textual features. Additionally, we aim to leverage the language generation capability of a LLM by establishing a connection between the Image-Tower and the LLM. As shown in Figure
      <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4.2. Data Collection ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
       <span class="ltx_text ltx_ref_tag">
        2
       </span>
      </a>
      , the connection is implemented using a fully-connected (FC) layer. The FC layer projects the output query embeddings to align with the dimensionality of the LLM’s text embedding, and then these projected query embeddings are concatenated at the beginning of the input text embeddings of the LLM. This integration serves the visual information as soft prompts, conditioning the LLM on the visual representations to generate language. Notably, the LLM is kept frozen during training to facilitate the process.
     </p>
    </div>
    <div class="ltx_para ltx_noindent" id="S4.SS3.SSS2.p3">
     <p class="ltx_p" id="S4.SS3.SSS2.p3.1">
      <span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.p3.1.1">
       MDP for Generating Suggestions.
      </span>
      To enhance the intentionality of the generated suggestions, we model the process with RLHF, involving states, actions, and rewards.
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS2.p4">
     <p class="ltx_p" id="S4.SS3.SSS2.p4.1">
      <em class="ltx_emph ltx_font_italic" id="S4.SS3.SSS2.p4.1.1">
       States
      </em>
      : The state
      <math alttext="\mathbf{s}^{I}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p4.1.m1.1">
       <semantics id="S4.SS3.SSS2.p4.1.m1.1a">
        <msup id="S4.SS3.SSS2.p4.1.m1.1.1" xref="S4.SS3.SSS2.p4.1.m1.1.1.cmml">
         <mi id="S4.SS3.SSS2.p4.1.m1.1.1.2" xref="S4.SS3.SSS2.p4.1.m1.1.1.2.cmml">
          𝐬
         </mi>
         <mi id="S4.SS3.SSS2.p4.1.m1.1.1.3" xref="S4.SS3.SSS2.p4.1.m1.1.1.3.cmml">
          I
         </mi>
        </msup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p4.1.m1.1b">
         <apply id="S4.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p4.1.m1.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS2.p4.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p4.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS3.SSS2.p4.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p4.1.m1.1.1.2">
           𝐬
          </ci>
          <ci id="S4.SS3.SSS2.p4.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p4.1.m1.1.1.3">
           𝐼
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS2.p4.1.m1.1c">
         \mathbf{s}^{I}
        </annotation>
       </semantics>
      </math>
      is defined by the learned query embeddings of an input query image, which undergoes a process to extract the representation. Specifically, the image is first encoded using a frozen Vision Transformer (ViT)
      <cite class="ltx_cite ltx_citemacro_citep">
       (Radford et al
       <span class="ltx_text">
        .
       </span>
       ,
       <a class="ltx_ref" href="#bib.bib36" title="">
        2021
       </a>
       )
      </cite>
      , which produces a fixed-length representation of the image that captures its visual features. Then, some learnable query embeddings are generated as the design in RewardNet, these embeddings represent the different aspects of the query image that the model should attend to, and the query embeddings are then passed through cross-attention layers, which allow them to interact with the frozen visual features. By leveraging this approach, we can effectively incorporate the contextual relationships between the queries and the image features, and forming a comprehensive representation of the state.
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS2.p5">
     <p class="ltx_p" id="S4.SS3.SSS2.p5.1">
      <em class="ltx_emph ltx_font_italic" id="S4.SS3.SSS2.p5.1.1">
       Actions
      </em>
      : The action
      <math alttext="a^{I}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p5.1.m1.1">
       <semantics id="S4.SS3.SSS2.p5.1.m1.1a">
        <msup id="S4.SS3.SSS2.p5.1.m1.1.1" xref="S4.SS3.SSS2.p5.1.m1.1.1.cmml">
         <mi id="S4.SS3.SSS2.p5.1.m1.1.1.2" xref="S4.SS3.SSS2.p5.1.m1.1.1.2.cmml">
          a
         </mi>
         <mi id="S4.SS3.SSS2.p5.1.m1.1.1.3" xref="S4.SS3.SSS2.p5.1.m1.1.1.3.cmml">
          I
         </mi>
        </msup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p5.1.m1.1b">
         <apply id="S4.SS3.SSS2.p5.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p5.1.m1.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS2.p5.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p5.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS3.SSS2.p5.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p5.1.m1.1.1.2">
           𝑎
          </ci>
          <ci id="S4.SS3.SSS2.p5.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p5.1.m1.1.1.3">
           𝐼
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS2.p5.1.m1.1c">
         a^{I}
        </annotation>
       </semantics>
      </math>
      is defined by the generated suggestions via a LLM, which conditions on the state representation to generate language. Here, We employ a decoder-only language model (e.g., OPT
      <cite class="ltx_cite ltx_citemacro_citep">
       (Zhang et al
       <span class="ltx_text">
        .
       </span>
       ,
       <a class="ltx_ref" href="#bib.bib55" title="">
        2022
       </a>
       )
      </cite>
      ) for its simplicity and efficiency, as it does not require encoding input information, and only to generate suggestions that are relevant to the image. This enables our training more efficiently and reduces GPU requirements.
     </p>
    </div>
    <div class="ltx_para" id="S4.SS3.SSS2.p6">
     <p class="ltx_p" id="S4.SS3.SSS2.p6.1">
      <em class="ltx_emph ltx_font_italic" id="S4.SS3.SSS2.p6.1.1">
       Rewards
      </em>
      : The reward
      <math alttext="r^{I}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p6.1.m1.1">
       <semantics id="S4.SS3.SSS2.p6.1.m1.1a">
        <msup id="S4.SS3.SSS2.p6.1.m1.1.1" xref="S4.SS3.SSS2.p6.1.m1.1.1.cmml">
         <mi id="S4.SS3.SSS2.p6.1.m1.1.1.2" xref="S4.SS3.SSS2.p6.1.m1.1.1.2.cmml">
          r
         </mi>
         <mi id="S4.SS3.SSS2.p6.1.m1.1.1.3" xref="S4.SS3.SSS2.p6.1.m1.1.1.3.cmml">
          I
         </mi>
        </msup>
        <annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p6.1.m1.1b">
         <apply id="S4.SS3.SSS2.p6.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1">
          <csymbol cd="ambiguous" id="S4.SS3.SSS2.p6.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS3.SSS2.p6.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1.2">
           𝑟
          </ci>
          <ci id="S4.SS3.SSS2.p6.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p6.1.m1.1.1.3">
           𝐼
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S4.SS3.SSS2.p6.1.m1.1c">
         r^{I}
        </annotation>
       </semantics>
      </math>
      is obtained from the RewardNet according to Equation
      <a class="ltx_ref" href="#S4.E6" title="In 4.3.1. RewardNet ‣ 4.3. Agent-I: Generating Intentional Candidate Suggestions ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
       <span class="ltx_text ltx_ref_tag">
        6
       </span>
      </a>
      . The purpose of training the reward model is to accurately predict the quality of a generated suggestion, as assessed by human judgment. It is important to note that Agent-I’s action involves exploring candidate suggestions, and the reward cannot be immediately observed because the final suggestions have not yet been generated.
When the action is to provide the candidates for Agent-D to choose final suggestions within this candidate pool, some reward signal can be acquired (e.g., measuring the intentionality of suggestions). Subsequently, the PolicyNet would be updated accordingly through RLHF (more training details are presented in Section
      <a class="ltx_ref" href="#S4.SS4" title="4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
       <span class="ltx_text ltx_ref_tag">
        4.4
       </span>
      </a>
      ). This approach facilitates the cooperation between Agent-I and Agent-D, guiding them towards the joint goal of producing intentional and diverse suggestions in the final output.
     </p>
    </div>
   </section>
  </section>
  <section class="ltx_subsection" id="S4.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.4.
    </span>
    Agent-D: Choosing Diverse Suggestions from the Candidates
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS4.p1">
    <p class="ltx_p" id="S4.SS4.p1.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">
      MDP for Choosing Suggestions.
     </span>
     We further introduce an Agent-D to enhance the overall diversity of suggestions and provide users with a more comprehensive selection. We discuss the rationale behind the introduction of this agent. One straightforward method to increase diversity is to employ post-processing techniques like clustering. This technique groups similar candidate suggestions into clusters and selects the cluster centers as output to reduce redundancy. However, such post-processing faces two challenges: (1) the model cannot directly generate both intentional and diverse suggestions, which makes further optimization difficult; (2) the clustered suggestions prioritize diversity but may sacrifice intentionality in the output. To tackle the challenges, we consider the diversity as one of the training objectives managed by Agent-D, where it calculates semantic similarity between suggestions, and cooperative training with Agent-I during the policy training process. This end-to-end optimization empowers the language model to generate suggestions that exhibit both intentionality and diversity.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p2">
    <p class="ltx_p" id="S4.SS4.p2.8">
     To accomplish this task, we use a sliding window algorithm with a window size denoted as
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1">
      <semantics id="S4.SS4.p2.1.m1.1a">
       <mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b">
        <ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     . The candidate suggestions provided by Agent-I are represented as
     <math alttext="&lt;S^{\prime}_{1},S^{\prime}_{2},...,S^{\prime}_{N}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS4.p2.2.m2.1">
      <semantics id="S4.SS4.p2.2.m2.1a">
       <mrow id="S4.SS4.p2.2.m2.1b">
        <mo id="S4.SS4.p2.2.m2.1.2">
         &lt;
        </mo>
        <msubsup id="S4.SS4.p2.2.m2.1.3">
         <mi id="S4.SS4.p2.2.m2.1.3.2.2">
          S
         </mi>
         <mn id="S4.SS4.p2.2.m2.1.3.3">
          1
         </mn>
         <mo id="S4.SS4.p2.2.m2.1.3.2.3">
          ′
         </mo>
        </msubsup>
        <mo id="S4.SS4.p2.2.m2.1.4">
         ,
        </mo>
        <msubsup id="S4.SS4.p2.2.m2.1.5">
         <mi id="S4.SS4.p2.2.m2.1.5.2.2">
          S
         </mi>
         <mn id="S4.SS4.p2.2.m2.1.5.3">
          2
         </mn>
         <mo id="S4.SS4.p2.2.m2.1.5.2.3">
          ′
         </mo>
        </msubsup>
        <mo id="S4.SS4.p2.2.m2.1.6">
         ,
        </mo>
        <mi id="S4.SS4.p2.2.m2.1.1" mathvariant="normal">
         …
        </mi>
        <mo id="S4.SS4.p2.2.m2.1.7">
         ,
        </mo>
        <msubsup id="S4.SS4.p2.2.m2.1.8">
         <mi id="S4.SS4.p2.2.m2.1.8.2.2">
          S
         </mi>
         <mi id="S4.SS4.p2.2.m2.1.8.3">
          N
         </mi>
         <mo id="S4.SS4.p2.2.m2.1.8.2.3">
          ′
         </mo>
        </msubsup>
        <mo id="S4.SS4.p2.2.m2.1.9">
         &gt;
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">
        &lt;S^{\prime}_{1},S^{\prime}_{2},...,S^{\prime}_{N}&gt;
       </annotation>
      </semantics>
     </math>
     , and Agent-D’s objective is to select the
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1">
      <semantics id="S4.SS4.p2.3.m3.1a">
       <mi id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b">
        <ci id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">
        K
       </annotation>
      </semantics>
     </math>
     diverse suggestions from this set (where
     <math alttext="K&lt;N" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m4.1">
      <semantics id="S4.SS4.p2.4.m4.1a">
       <mrow id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">
        <mi id="S4.SS4.p2.4.m4.1.1.2" xref="S4.SS4.p2.4.m4.1.1.2.cmml">
         K
        </mi>
        <mo id="S4.SS4.p2.4.m4.1.1.1" xref="S4.SS4.p2.4.m4.1.1.1.cmml">
         &lt;
        </mo>
        <mi id="S4.SS4.p2.4.m4.1.1.3" xref="S4.SS4.p2.4.m4.1.1.3.cmml">
         N
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b">
        <apply id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">
         <lt id="S4.SS4.p2.4.m4.1.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1.1">
         </lt>
         <ci id="S4.SS4.p2.4.m4.1.1.2.cmml" xref="S4.SS4.p2.4.m4.1.1.2">
          𝐾
         </ci>
         <ci id="S4.SS4.p2.4.m4.1.1.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3">
          𝑁
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">
        K&lt;N
       </annotation>
      </semantics>
     </math>
     ). Here is how the sliding window algorithm operates: (1) The algorithm begins by scanning the first
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m5.1">
      <semantics id="S4.SS4.p2.5.m5.1a">
       <mi id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b">
        <ci id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">
        K
       </annotation>
      </semantics>
     </math>
     suggestions and deciding which one within the window should be omitted. (2) It then inserts the next suggestion into the window and repeats the decision-making process. (3) This scanning and decision-making continue until all suggestions have been processed. (4) Finally, the algorithm maintains and outputs the best
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p2.6.m6.1">
      <semantics id="S4.SS4.p2.6.m6.1a">
       <mi id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b">
        <ci id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">
        K
       </annotation>
      </semantics>
     </math>
     suggestions during the scanning, which correspond to the highest diversity. Diversity is measured by computing pairwise semantic similarities among the
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p2.7.m7.1">
      <semantics id="S4.SS4.p2.7.m7.1a">
       <mi id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b">
        <ci id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">
        K
       </annotation>
      </semantics>
     </math>
     suggestions
     <math alttext="&lt;S_{1},S_{2},...,S_{K}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS4.p2.8.m8.1">
      <semantics id="S4.SS4.p2.8.m8.1a">
       <mrow id="S4.SS4.p2.8.m8.1b">
        <mo id="S4.SS4.p2.8.m8.1.2">
         &lt;
        </mo>
        <msub id="S4.SS4.p2.8.m8.1.3">
         <mi id="S4.SS4.p2.8.m8.1.3.2">
          S
         </mi>
         <mn id="S4.SS4.p2.8.m8.1.3.3">
          1
         </mn>
        </msub>
        <mo id="S4.SS4.p2.8.m8.1.4">
         ,
        </mo>
        <msub id="S4.SS4.p2.8.m8.1.5">
         <mi id="S4.SS4.p2.8.m8.1.5.2">
          S
         </mi>
         <mn id="S4.SS4.p2.8.m8.1.5.3">
          2
         </mn>
        </msub>
        <mo id="S4.SS4.p2.8.m8.1.6">
         ,
        </mo>
        <mi id="S4.SS4.p2.8.m8.1.1" mathvariant="normal">
         …
        </mi>
        <mo id="S4.SS4.p2.8.m8.1.7">
         ,
        </mo>
        <msub id="S4.SS4.p2.8.m8.1.8">
         <mi id="S4.SS4.p2.8.m8.1.8.2">
          S
         </mi>
         <mi id="S4.SS4.p2.8.m8.1.8.3">
          K
         </mi>
        </msub>
        <mo id="S4.SS4.p2.8.m8.1.9">
         &gt;
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">
        &lt;S_{1},S_{2},...,S_{K}&gt;
       </annotation>
      </semantics>
     </math>
     , typically involving a subtraction operation (where a larger diversity implies smaller similarity), i.e.,
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx7">
     <tbody id="S4.E7">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (7)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle DIV=\frac{1}{2}-\frac{\sum_{1\leq i&lt;j\leq K}\sigma(S_{i},S_{j})}{K*(K-1)}," class="ltx_Math" display="inline" id="S4.E7.m1.4">
         <semantics id="S4.E7.m1.4a">
          <mrow id="S4.E7.m1.4.4.1" xref="S4.E7.m1.4.4.1.1.cmml">
           <mrow id="S4.E7.m1.4.4.1.1" xref="S4.E7.m1.4.4.1.1.cmml">
            <mrow id="S4.E7.m1.4.4.1.1.2" xref="S4.E7.m1.4.4.1.1.2.cmml">
             <mi id="S4.E7.m1.4.4.1.1.2.2" xref="S4.E7.m1.4.4.1.1.2.2.cmml">
              D
             </mi>
             <mo id="S4.E7.m1.4.4.1.1.2.1" lspace="0em" rspace="0em" xref="S4.E7.m1.4.4.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="S4.E7.m1.4.4.1.1.2.3" xref="S4.E7.m1.4.4.1.1.2.3.cmml">
              I
             </mi>
             <mo id="S4.E7.m1.4.4.1.1.2.1a" lspace="0em" rspace="0em" xref="S4.E7.m1.4.4.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="S4.E7.m1.4.4.1.1.2.4" xref="S4.E7.m1.4.4.1.1.2.4.cmml">
              V
             </mi>
            </mrow>
            <mo id="S4.E7.m1.4.4.1.1.1" xref="S4.E7.m1.4.4.1.1.1.cmml">
             =
            </mo>
            <mrow id="S4.E7.m1.4.4.1.1.3" xref="S4.E7.m1.4.4.1.1.3.cmml">
             <mstyle displaystyle="true" id="S4.E7.m1.4.4.1.1.3.2" xref="S4.E7.m1.4.4.1.1.3.2.cmml">
              <mfrac id="S4.E7.m1.4.4.1.1.3.2a" xref="S4.E7.m1.4.4.1.1.3.2.cmml">
               <mn id="S4.E7.m1.4.4.1.1.3.2.2" xref="S4.E7.m1.4.4.1.1.3.2.2.cmml">
                1
               </mn>
               <mn id="S4.E7.m1.4.4.1.1.3.2.3" xref="S4.E7.m1.4.4.1.1.3.2.3.cmml">
                2
               </mn>
              </mfrac>
             </mstyle>
             <mo id="S4.E7.m1.4.4.1.1.3.1" xref="S4.E7.m1.4.4.1.1.3.1.cmml">
              −
             </mo>
             <mstyle displaystyle="true" id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">
              <mfrac id="S4.E7.m1.3.3a" xref="S4.E7.m1.3.3.cmml">
               <mrow id="S4.E7.m1.2.2.2" xref="S4.E7.m1.2.2.2.cmml">
                <msub id="S4.E7.m1.2.2.2.3" xref="S4.E7.m1.2.2.2.3.cmml">
                 <mo id="S4.E7.m1.2.2.2.3.2" xref="S4.E7.m1.2.2.2.3.2.cmml">
                  ∑
                 </mo>
                 <mrow id="S4.E7.m1.2.2.2.3.3" xref="S4.E7.m1.2.2.2.3.3.cmml">
                  <mn id="S4.E7.m1.2.2.2.3.3.2" xref="S4.E7.m1.2.2.2.3.3.2.cmml">
                   1
                  </mn>
                  <mo id="S4.E7.m1.2.2.2.3.3.3" xref="S4.E7.m1.2.2.2.3.3.3.cmml">
                   ≤
                  </mo>
                  <mi id="S4.E7.m1.2.2.2.3.3.4" xref="S4.E7.m1.2.2.2.3.3.4.cmml">
                   i
                  </mi>
                  <mo id="S4.E7.m1.2.2.2.3.3.5" xref="S4.E7.m1.2.2.2.3.3.5.cmml">
                   &lt;
                  </mo>
                  <mi id="S4.E7.m1.2.2.2.3.3.6" xref="S4.E7.m1.2.2.2.3.3.6.cmml">
                   j
                  </mi>
                  <mo id="S4.E7.m1.2.2.2.3.3.7" xref="S4.E7.m1.2.2.2.3.3.7.cmml">
                   ≤
                  </mo>
                  <mi id="S4.E7.m1.2.2.2.3.3.8" xref="S4.E7.m1.2.2.2.3.3.8.cmml">
                   K
                  </mi>
                 </mrow>
                </msub>
                <mrow id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">
                 <mi id="S4.E7.m1.2.2.2.2.4" xref="S4.E7.m1.2.2.2.2.4.cmml">
                  σ
                 </mi>
                 <mo id="S4.E7.m1.2.2.2.2.3" lspace="0em" rspace="0em" xref="S4.E7.m1.2.2.2.2.3.cmml">
                  ​
                 </mo>
                 <mrow id="S4.E7.m1.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.3.cmml">
                  <mo id="S4.E7.m1.2.2.2.2.2.2.3" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.3.cmml">
                   (
                  </mo>
                  <msub id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">
                   <mi id="S4.E7.m1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.2.cmml">
                    S
                   </mi>
                   <mi id="S4.E7.m1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.3.cmml">
                    i
                   </mi>
                  </msub>
                  <mo id="S4.E7.m1.2.2.2.2.2.2.4" xref="S4.E7.m1.2.2.2.2.2.3.cmml">
                   ,
                  </mo>
                  <msub id="S4.E7.m1.2.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.2.2.cmml">
                   <mi id="S4.E7.m1.2.2.2.2.2.2.2.2" xref="S4.E7.m1.2.2.2.2.2.2.2.2.cmml">
                    S
                   </mi>
                   <mi id="S4.E7.m1.2.2.2.2.2.2.2.3" xref="S4.E7.m1.2.2.2.2.2.2.2.3.cmml">
                    j
                   </mi>
                  </msub>
                  <mo id="S4.E7.m1.2.2.2.2.2.2.5" stretchy="false" xref="S4.E7.m1.2.2.2.2.2.3.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
               <mrow id="S4.E7.m1.3.3.3" xref="S4.E7.m1.3.3.3.cmml">
                <mi id="S4.E7.m1.3.3.3.3" xref="S4.E7.m1.3.3.3.3.cmml">
                 K
                </mi>
                <mo id="S4.E7.m1.3.3.3.2" lspace="0.222em" rspace="0.222em" xref="S4.E7.m1.3.3.3.2.cmml">
                 ∗
                </mo>
                <mrow id="S4.E7.m1.3.3.3.1.1" xref="S4.E7.m1.3.3.3.1.1.1.cmml">
                 <mo id="S4.E7.m1.3.3.3.1.1.2" stretchy="false" xref="S4.E7.m1.3.3.3.1.1.1.cmml">
                  (
                 </mo>
                 <mrow id="S4.E7.m1.3.3.3.1.1.1" xref="S4.E7.m1.3.3.3.1.1.1.cmml">
                  <mi id="S4.E7.m1.3.3.3.1.1.1.2" xref="S4.E7.m1.3.3.3.1.1.1.2.cmml">
                   K
                  </mi>
                  <mo id="S4.E7.m1.3.3.3.1.1.1.1" xref="S4.E7.m1.3.3.3.1.1.1.1.cmml">
                   −
                  </mo>
                  <mn id="S4.E7.m1.3.3.3.1.1.1.3" xref="S4.E7.m1.3.3.3.1.1.1.3.cmml">
                   1
                  </mn>
                 </mrow>
                 <mo id="S4.E7.m1.3.3.3.1.1.3" stretchy="false" xref="S4.E7.m1.3.3.3.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo id="S4.E7.m1.4.4.1.2" xref="S4.E7.m1.4.4.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b">
           <apply id="S4.E7.m1.4.4.1.1.cmml" xref="S4.E7.m1.4.4.1">
            <eq id="S4.E7.m1.4.4.1.1.1.cmml" xref="S4.E7.m1.4.4.1.1.1">
            </eq>
            <apply id="S4.E7.m1.4.4.1.1.2.cmml" xref="S4.E7.m1.4.4.1.1.2">
             <times id="S4.E7.m1.4.4.1.1.2.1.cmml" xref="S4.E7.m1.4.4.1.1.2.1">
             </times>
             <ci id="S4.E7.m1.4.4.1.1.2.2.cmml" xref="S4.E7.m1.4.4.1.1.2.2">
              𝐷
             </ci>
             <ci id="S4.E7.m1.4.4.1.1.2.3.cmml" xref="S4.E7.m1.4.4.1.1.2.3">
              𝐼
             </ci>
             <ci id="S4.E7.m1.4.4.1.1.2.4.cmml" xref="S4.E7.m1.4.4.1.1.2.4">
              𝑉
             </ci>
            </apply>
            <apply id="S4.E7.m1.4.4.1.1.3.cmml" xref="S4.E7.m1.4.4.1.1.3">
             <minus id="S4.E7.m1.4.4.1.1.3.1.cmml" xref="S4.E7.m1.4.4.1.1.3.1">
             </minus>
             <apply id="S4.E7.m1.4.4.1.1.3.2.cmml" xref="S4.E7.m1.4.4.1.1.3.2">
              <divide id="S4.E7.m1.4.4.1.1.3.2.1.cmml" xref="S4.E7.m1.4.4.1.1.3.2">
              </divide>
              <cn id="S4.E7.m1.4.4.1.1.3.2.2.cmml" type="integer" xref="S4.E7.m1.4.4.1.1.3.2.2">
               1
              </cn>
              <cn id="S4.E7.m1.4.4.1.1.3.2.3.cmml" type="integer" xref="S4.E7.m1.4.4.1.1.3.2.3">
               2
              </cn>
             </apply>
             <apply id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3">
              <divide id="S4.E7.m1.3.3.4.cmml" xref="S4.E7.m1.3.3">
              </divide>
              <apply id="S4.E7.m1.2.2.2.cmml" xref="S4.E7.m1.2.2.2">
               <apply id="S4.E7.m1.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.3">
                <csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.3.1.cmml" xref="S4.E7.m1.2.2.2.3">
                 subscript
                </csymbol>
                <sum id="S4.E7.m1.2.2.2.3.2.cmml" xref="S4.E7.m1.2.2.2.3.2">
                </sum>
                <apply id="S4.E7.m1.2.2.2.3.3.cmml" xref="S4.E7.m1.2.2.2.3.3">
                 <and id="S4.E7.m1.2.2.2.3.3a.cmml" xref="S4.E7.m1.2.2.2.3.3">
                 </and>
                 <apply id="S4.E7.m1.2.2.2.3.3b.cmml" xref="S4.E7.m1.2.2.2.3.3">
                  <leq id="S4.E7.m1.2.2.2.3.3.3.cmml" xref="S4.E7.m1.2.2.2.3.3.3">
                  </leq>
                  <cn id="S4.E7.m1.2.2.2.3.3.2.cmml" type="integer" xref="S4.E7.m1.2.2.2.3.3.2">
                   1
                  </cn>
                  <ci id="S4.E7.m1.2.2.2.3.3.4.cmml" xref="S4.E7.m1.2.2.2.3.3.4">
                   𝑖
                  </ci>
                 </apply>
                 <apply id="S4.E7.m1.2.2.2.3.3c.cmml" xref="S4.E7.m1.2.2.2.3.3">
                  <lt id="S4.E7.m1.2.2.2.3.3.5.cmml" xref="S4.E7.m1.2.2.2.3.3.5">
                  </lt>
                  <share href="#S4.E7.m1.2.2.2.3.3.4.cmml" id="S4.E7.m1.2.2.2.3.3d.cmml" xref="S4.E7.m1.2.2.2.3.3">
                  </share>
                  <ci id="S4.E7.m1.2.2.2.3.3.6.cmml" xref="S4.E7.m1.2.2.2.3.3.6">
                   𝑗
                  </ci>
                 </apply>
                 <apply id="S4.E7.m1.2.2.2.3.3e.cmml" xref="S4.E7.m1.2.2.2.3.3">
                  <leq id="S4.E7.m1.2.2.2.3.3.7.cmml" xref="S4.E7.m1.2.2.2.3.3.7">
                  </leq>
                  <share href="#S4.E7.m1.2.2.2.3.3.6.cmml" id="S4.E7.m1.2.2.2.3.3f.cmml" xref="S4.E7.m1.2.2.2.3.3">
                  </share>
                  <ci id="S4.E7.m1.2.2.2.3.3.8.cmml" xref="S4.E7.m1.2.2.2.3.3.8">
                   𝐾
                  </ci>
                 </apply>
                </apply>
               </apply>
               <apply id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">
                <times id="S4.E7.m1.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.3">
                </times>
                <ci id="S4.E7.m1.2.2.2.2.4.cmml" xref="S4.E7.m1.2.2.2.2.4">
                 𝜎
                </ci>
                <interval closure="open" id="S4.E7.m1.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2">
                 <apply id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S4.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2">
                   𝑆
                  </ci>
                  <ci id="S4.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3">
                   𝑖
                  </ci>
                 </apply>
                 <apply id="S4.E7.m1.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.2">
                  <csymbol cd="ambiguous" id="S4.E7.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E7.m1.2.2.2.2.2.2.2">
                   subscript
                  </csymbol>
                  <ci id="S4.E7.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2.2.2.2.2">
                   𝑆
                  </ci>
                  <ci id="S4.E7.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E7.m1.2.2.2.2.2.2.2.3">
                   𝑗
                  </ci>
                 </apply>
                </interval>
               </apply>
              </apply>
              <apply id="S4.E7.m1.3.3.3.cmml" xref="S4.E7.m1.3.3.3">
               <times id="S4.E7.m1.3.3.3.2.cmml" xref="S4.E7.m1.3.3.3.2">
               </times>
               <ci id="S4.E7.m1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3">
                𝐾
               </ci>
               <apply id="S4.E7.m1.3.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.3.1.1">
                <minus id="S4.E7.m1.3.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.3.1.1.1.1">
                </minus>
                <ci id="S4.E7.m1.3.3.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.3.1.1.1.2">
                 𝐾
                </ci>
                <cn id="S4.E7.m1.3.3.3.1.1.1.3.cmml" type="integer" xref="S4.E7.m1.3.3.3.1.1.1.3">
                 1
                </cn>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E7.m1.4c">
           \displaystyle DIV=\frac{1}{2}-\frac{\sum_{1\leq i&lt;j\leq K}\sigma(S_{i},S_{j})}{K*(K-1)},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS4.p2.9">
     where
     <math alttext="\sigma(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS4.p2.9.m1.2">
      <semantics id="S4.SS4.p2.9.m1.2a">
       <mrow id="S4.SS4.p2.9.m1.2.3" xref="S4.SS4.p2.9.m1.2.3.cmml">
        <mi id="S4.SS4.p2.9.m1.2.3.2" xref="S4.SS4.p2.9.m1.2.3.2.cmml">
         σ
        </mi>
        <mo id="S4.SS4.p2.9.m1.2.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p2.9.m1.2.3.1.cmml">
         ​
        </mo>
        <mrow id="S4.SS4.p2.9.m1.2.3.3.2" xref="S4.SS4.p2.9.m1.2.3.3.1.cmml">
         <mo id="S4.SS4.p2.9.m1.2.3.3.2.1" stretchy="false" xref="S4.SS4.p2.9.m1.2.3.3.1.cmml">
          (
         </mo>
         <mo id="S4.SS4.p2.9.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS4.p2.9.m1.1.1.cmml">
          ⋅
         </mo>
         <mo id="S4.SS4.p2.9.m1.2.3.3.2.2" rspace="0em" xref="S4.SS4.p2.9.m1.2.3.3.1.cmml">
          ,
         </mo>
         <mo id="S4.SS4.p2.9.m1.2.2" lspace="0em" rspace="0em" xref="S4.SS4.p2.9.m1.2.2.cmml">
          ⋅
         </mo>
         <mo id="S4.SS4.p2.9.m1.2.3.3.2.3" stretchy="false" xref="S4.SS4.p2.9.m1.2.3.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p2.9.m1.2b">
        <apply id="S4.SS4.p2.9.m1.2.3.cmml" xref="S4.SS4.p2.9.m1.2.3">
         <times id="S4.SS4.p2.9.m1.2.3.1.cmml" xref="S4.SS4.p2.9.m1.2.3.1">
         </times>
         <ci id="S4.SS4.p2.9.m1.2.3.2.cmml" xref="S4.SS4.p2.9.m1.2.3.2">
          𝜎
         </ci>
         <interval closure="open" id="S4.SS4.p2.9.m1.2.3.3.1.cmml" xref="S4.SS4.p2.9.m1.2.3.3.2">
          <ci id="S4.SS4.p2.9.m1.1.1.cmml" xref="S4.SS4.p2.9.m1.1.1">
           ⋅
          </ci>
          <ci id="S4.SS4.p2.9.m1.2.2.cmml" xref="S4.SS4.p2.9.m1.2.2">
           ⋅
          </ci>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p2.9.m1.2c">
        \sigma(\cdot,\cdot)
       </annotation>
      </semantics>
     </math>
     represents a similarity measurement between two suggestions, typically calculated using methods like cosine similarity with S-BERT
     <cite class="ltx_cite ltx_citemacro_citep">
      (Reimers and Gurevych,
      <a class="ltx_ref" href="#bib.bib37" title="">
       2019
      </a>
      )
     </cite>
     . This similarity score is then normalized to a value between 0 and 1 for clarity. Below, we introduce the MDP of Agent-D, which decides the process of selecting which suggestions to drop from the window. This decision-making process is guided by lightweight fully-connected (FC) neural networks trained through the policy gradient method
     <cite class="ltx_cite ltx_citemacro_citep">
      (Silver et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib41" title="">
       2014
      </a>
      ; Williams,
      <a class="ltx_ref" href="#bib.bib44" title="">
       1992
      </a>
      )
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p3">
    <p class="ltx_p" id="S4.SS4.p3.7">
     <em class="ltx_emph ltx_font_italic" id="S4.SS4.p3.7.1">
      States:
     </em>
     In the context where we have
     <math alttext="N" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1">
      <semantics id="S4.SS4.p3.1.m1.1a">
       <mi id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b">
        <ci id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">
        N
       </annotation>
      </semantics>
     </math>
     candidate suggestions denoted as
     <math alttext="&lt;S^{\prime}_{1},S^{\prime}_{2},...,S^{\prime}_{N}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS4.p3.2.m2.1">
      <semantics id="S4.SS4.p3.2.m2.1a">
       <mrow id="S4.SS4.p3.2.m2.1b">
        <mo id="S4.SS4.p3.2.m2.1.2">
         &lt;
        </mo>
        <msubsup id="S4.SS4.p3.2.m2.1.3">
         <mi id="S4.SS4.p3.2.m2.1.3.2.2">
          S
         </mi>
         <mn id="S4.SS4.p3.2.m2.1.3.3">
          1
         </mn>
         <mo id="S4.SS4.p3.2.m2.1.3.2.3">
          ′
         </mo>
        </msubsup>
        <mo id="S4.SS4.p3.2.m2.1.4">
         ,
        </mo>
        <msubsup id="S4.SS4.p3.2.m2.1.5">
         <mi id="S4.SS4.p3.2.m2.1.5.2.2">
          S
         </mi>
         <mn id="S4.SS4.p3.2.m2.1.5.3">
          2
         </mn>
         <mo id="S4.SS4.p3.2.m2.1.5.2.3">
          ′
         </mo>
        </msubsup>
        <mo id="S4.SS4.p3.2.m2.1.6">
         ,
        </mo>
        <mi id="S4.SS4.p3.2.m2.1.1" mathvariant="normal">
         …
        </mi>
        <mo id="S4.SS4.p3.2.m2.1.7">
         ,
        </mo>
        <msubsup id="S4.SS4.p3.2.m2.1.8">
         <mi id="S4.SS4.p3.2.m2.1.8.2.2">
          S
         </mi>
         <mi id="S4.SS4.p3.2.m2.1.8.3">
          N
         </mi>
         <mo id="S4.SS4.p3.2.m2.1.8.2.3">
          ′
         </mo>
        </msubsup>
        <mo id="S4.SS4.p3.2.m2.1.9">
         &gt;
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">
        &lt;S^{\prime}_{1},S^{\prime}_{2},...,S^{\prime}_{N}&gt;
       </annotation>
      </semantics>
     </math>
     , we utilize S-BERT embeddings
     <cite class="ltx_cite ltx_citemacro_citep">
      (Reimers and Gurevych,
      <a class="ltx_ref" href="#bib.bib37" title="">
       2019
      </a>
      )
     </cite>
     to capture their semantic features, which are represented as
     <math alttext="\mathbf{b}_{i}^{S}" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1">
      <semantics id="S4.SS4.p3.3.m3.1a">
       <msubsup id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml">
        <mi id="S4.SS4.p3.3.m3.1.1.2.2" xref="S4.SS4.p3.3.m3.1.1.2.2.cmml">
         𝐛
        </mi>
        <mi id="S4.SS4.p3.3.m3.1.1.2.3" xref="S4.SS4.p3.3.m3.1.1.2.3.cmml">
         i
        </mi>
        <mi id="S4.SS4.p3.3.m3.1.1.3" xref="S4.SS4.p3.3.m3.1.1.3.cmml">
         S
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b">
        <apply id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS4.p3.3.m3.1.1.2.cmml" xref="S4.SS4.p3.3.m3.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.1.1.2.1.cmml" xref="S4.SS4.p3.3.m3.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS4.p3.3.m3.1.1.2.2.cmml" xref="S4.SS4.p3.3.m3.1.1.2.2">
           𝐛
          </ci>
          <ci id="S4.SS4.p3.3.m3.1.1.2.3.cmml" xref="S4.SS4.p3.3.m3.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <ci id="S4.SS4.p3.3.m3.1.1.3.cmml" xref="S4.SS4.p3.3.m3.1.1.3">
          𝑆
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">
        \mathbf{b}_{i}^{S}
       </annotation>
      </semantics>
     </math>
     for each suggestion (
     <math alttext="1\leq i\leq N" class="ltx_Math" display="inline" id="S4.SS4.p3.4.m4.1">
      <semantics id="S4.SS4.p3.4.m4.1a">
       <mrow id="S4.SS4.p3.4.m4.1.1" xref="S4.SS4.p3.4.m4.1.1.cmml">
        <mn id="S4.SS4.p3.4.m4.1.1.2" xref="S4.SS4.p3.4.m4.1.1.2.cmml">
         1
        </mn>
        <mo id="S4.SS4.p3.4.m4.1.1.3" xref="S4.SS4.p3.4.m4.1.1.3.cmml">
         ≤
        </mo>
        <mi id="S4.SS4.p3.4.m4.1.1.4" xref="S4.SS4.p3.4.m4.1.1.4.cmml">
         i
        </mi>
        <mo id="S4.SS4.p3.4.m4.1.1.5" xref="S4.SS4.p3.4.m4.1.1.5.cmml">
         ≤
        </mo>
        <mi id="S4.SS4.p3.4.m4.1.1.6" xref="S4.SS4.p3.4.m4.1.1.6.cmml">
         N
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p3.4.m4.1b">
        <apply id="S4.SS4.p3.4.m4.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1">
         <and id="S4.SS4.p3.4.m4.1.1a.cmml" xref="S4.SS4.p3.4.m4.1.1">
         </and>
         <apply id="S4.SS4.p3.4.m4.1.1b.cmml" xref="S4.SS4.p3.4.m4.1.1">
          <leq id="S4.SS4.p3.4.m4.1.1.3.cmml" xref="S4.SS4.p3.4.m4.1.1.3">
          </leq>
          <cn id="S4.SS4.p3.4.m4.1.1.2.cmml" type="integer" xref="S4.SS4.p3.4.m4.1.1.2">
           1
          </cn>
          <ci id="S4.SS4.p3.4.m4.1.1.4.cmml" xref="S4.SS4.p3.4.m4.1.1.4">
           𝑖
          </ci>
         </apply>
         <apply id="S4.SS4.p3.4.m4.1.1c.cmml" xref="S4.SS4.p3.4.m4.1.1">
          <leq id="S4.SS4.p3.4.m4.1.1.5.cmml" xref="S4.SS4.p3.4.m4.1.1.5">
          </leq>
          <share href="#S4.SS4.p3.4.m4.1.1.4.cmml" id="S4.SS4.p3.4.m4.1.1d.cmml" xref="S4.SS4.p3.4.m4.1.1">
          </share>
          <ci id="S4.SS4.p3.4.m4.1.1.6.cmml" xref="S4.SS4.p3.4.m4.1.1.6">
           𝑁
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.4.m4.1c">
        1\leq i\leq N
       </annotation>
      </semantics>
     </math>
     ). The state
     <math alttext="\mathbf{s}^{D}" class="ltx_Math" display="inline" id="S4.SS4.p3.5.m5.1">
      <semantics id="S4.SS4.p3.5.m5.1a">
       <msup id="S4.SS4.p3.5.m5.1.1" xref="S4.SS4.p3.5.m5.1.1.cmml">
        <mi id="S4.SS4.p3.5.m5.1.1.2" xref="S4.SS4.p3.5.m5.1.1.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p3.5.m5.1.1.3" xref="S4.SS4.p3.5.m5.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p3.5.m5.1b">
        <apply id="S4.SS4.p3.5.m5.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p3.5.m5.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1.2">
          𝐬
         </ci>
         <ci id="S4.SS4.p3.5.m5.1.1.3.cmml" xref="S4.SS4.p3.5.m5.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.5.m5.1c">
        \mathbf{s}^{D}
       </annotation>
      </semantics>
     </math>
     is defined by concatenating these
     <math alttext="N" class="ltx_Math" display="inline" id="S4.SS4.p3.6.m6.1">
      <semantics id="S4.SS4.p3.6.m6.1a">
       <mi id="S4.SS4.p3.6.m6.1.1" xref="S4.SS4.p3.6.m6.1.1.cmml">
        N
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p3.6.m6.1b">
        <ci id="S4.SS4.p3.6.m6.1.1.cmml" xref="S4.SS4.p3.6.m6.1.1">
         𝑁
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.6.m6.1c">
        N
       </annotation>
      </semantics>
     </math>
     embeddings, i.e.,
     <math alttext="\mathbf{s}^{D}=\{\mathbf{b}_{1}^{S},\mathbf{b}_{2}^{S},...,\mathbf{b}_{N}^{S}\}" class="ltx_Math" display="inline" id="S4.SS4.p3.7.m7.4">
      <semantics id="S4.SS4.p3.7.m7.4a">
       <mrow id="S4.SS4.p3.7.m7.4.4" xref="S4.SS4.p3.7.m7.4.4.cmml">
        <msup id="S4.SS4.p3.7.m7.4.4.5" xref="S4.SS4.p3.7.m7.4.4.5.cmml">
         <mi id="S4.SS4.p3.7.m7.4.4.5.2" xref="S4.SS4.p3.7.m7.4.4.5.2.cmml">
          𝐬
         </mi>
         <mi id="S4.SS4.p3.7.m7.4.4.5.3" xref="S4.SS4.p3.7.m7.4.4.5.3.cmml">
          D
         </mi>
        </msup>
        <mo id="S4.SS4.p3.7.m7.4.4.4" xref="S4.SS4.p3.7.m7.4.4.4.cmml">
         =
        </mo>
        <mrow id="S4.SS4.p3.7.m7.4.4.3.3" xref="S4.SS4.p3.7.m7.4.4.3.4.cmml">
         <mo id="S4.SS4.p3.7.m7.4.4.3.3.4" stretchy="false" xref="S4.SS4.p3.7.m7.4.4.3.4.cmml">
          {
         </mo>
         <msubsup id="S4.SS4.p3.7.m7.2.2.1.1.1" xref="S4.SS4.p3.7.m7.2.2.1.1.1.cmml">
          <mi id="S4.SS4.p3.7.m7.2.2.1.1.1.2.2" xref="S4.SS4.p3.7.m7.2.2.1.1.1.2.2.cmml">
           𝐛
          </mi>
          <mn id="S4.SS4.p3.7.m7.2.2.1.1.1.2.3" xref="S4.SS4.p3.7.m7.2.2.1.1.1.2.3.cmml">
           1
          </mn>
          <mi id="S4.SS4.p3.7.m7.2.2.1.1.1.3" xref="S4.SS4.p3.7.m7.2.2.1.1.1.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p3.7.m7.4.4.3.3.5" xref="S4.SS4.p3.7.m7.4.4.3.4.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p3.7.m7.3.3.2.2.2" xref="S4.SS4.p3.7.m7.3.3.2.2.2.cmml">
          <mi id="S4.SS4.p3.7.m7.3.3.2.2.2.2.2" xref="S4.SS4.p3.7.m7.3.3.2.2.2.2.2.cmml">
           𝐛
          </mi>
          <mn id="S4.SS4.p3.7.m7.3.3.2.2.2.2.3" xref="S4.SS4.p3.7.m7.3.3.2.2.2.2.3.cmml">
           2
          </mn>
          <mi id="S4.SS4.p3.7.m7.3.3.2.2.2.3" xref="S4.SS4.p3.7.m7.3.3.2.2.2.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p3.7.m7.4.4.3.3.6" xref="S4.SS4.p3.7.m7.4.4.3.4.cmml">
          ,
         </mo>
         <mi id="S4.SS4.p3.7.m7.1.1" mathvariant="normal" xref="S4.SS4.p3.7.m7.1.1.cmml">
          …
         </mi>
         <mo id="S4.SS4.p3.7.m7.4.4.3.3.7" xref="S4.SS4.p3.7.m7.4.4.3.4.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p3.7.m7.4.4.3.3.3" xref="S4.SS4.p3.7.m7.4.4.3.3.3.cmml">
          <mi id="S4.SS4.p3.7.m7.4.4.3.3.3.2.2" xref="S4.SS4.p3.7.m7.4.4.3.3.3.2.2.cmml">
           𝐛
          </mi>
          <mi id="S4.SS4.p3.7.m7.4.4.3.3.3.2.3" xref="S4.SS4.p3.7.m7.4.4.3.3.3.2.3.cmml">
           N
          </mi>
          <mi id="S4.SS4.p3.7.m7.4.4.3.3.3.3" xref="S4.SS4.p3.7.m7.4.4.3.3.3.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p3.7.m7.4.4.3.3.8" stretchy="false" xref="S4.SS4.p3.7.m7.4.4.3.4.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p3.7.m7.4b">
        <apply id="S4.SS4.p3.7.m7.4.4.cmml" xref="S4.SS4.p3.7.m7.4.4">
         <eq id="S4.SS4.p3.7.m7.4.4.4.cmml" xref="S4.SS4.p3.7.m7.4.4.4">
         </eq>
         <apply id="S4.SS4.p3.7.m7.4.4.5.cmml" xref="S4.SS4.p3.7.m7.4.4.5">
          <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.4.4.5.1.cmml" xref="S4.SS4.p3.7.m7.4.4.5">
           superscript
          </csymbol>
          <ci id="S4.SS4.p3.7.m7.4.4.5.2.cmml" xref="S4.SS4.p3.7.m7.4.4.5.2">
           𝐬
          </ci>
          <ci id="S4.SS4.p3.7.m7.4.4.5.3.cmml" xref="S4.SS4.p3.7.m7.4.4.5.3">
           𝐷
          </ci>
         </apply>
         <set id="S4.SS4.p3.7.m7.4.4.3.4.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3">
          <apply id="S4.SS4.p3.7.m7.2.2.1.1.1.cmml" xref="S4.SS4.p3.7.m7.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.2.2.1.1.1.1.cmml" xref="S4.SS4.p3.7.m7.2.2.1.1.1">
            superscript
           </csymbol>
           <apply id="S4.SS4.p3.7.m7.2.2.1.1.1.2.cmml" xref="S4.SS4.p3.7.m7.2.2.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.2.2.1.1.1.2.1.cmml" xref="S4.SS4.p3.7.m7.2.2.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS4.p3.7.m7.2.2.1.1.1.2.2.cmml" xref="S4.SS4.p3.7.m7.2.2.1.1.1.2.2">
             𝐛
            </ci>
            <cn id="S4.SS4.p3.7.m7.2.2.1.1.1.2.3.cmml" type="integer" xref="S4.SS4.p3.7.m7.2.2.1.1.1.2.3">
             1
            </cn>
           </apply>
           <ci id="S4.SS4.p3.7.m7.2.2.1.1.1.3.cmml" xref="S4.SS4.p3.7.m7.2.2.1.1.1.3">
            𝑆
           </ci>
          </apply>
          <apply id="S4.SS4.p3.7.m7.3.3.2.2.2.cmml" xref="S4.SS4.p3.7.m7.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.3.3.2.2.2.1.cmml" xref="S4.SS4.p3.7.m7.3.3.2.2.2">
            superscript
           </csymbol>
           <apply id="S4.SS4.p3.7.m7.3.3.2.2.2.2.cmml" xref="S4.SS4.p3.7.m7.3.3.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.3.3.2.2.2.2.1.cmml" xref="S4.SS4.p3.7.m7.3.3.2.2.2">
             subscript
            </csymbol>
            <ci id="S4.SS4.p3.7.m7.3.3.2.2.2.2.2.cmml" xref="S4.SS4.p3.7.m7.3.3.2.2.2.2.2">
             𝐛
            </ci>
            <cn id="S4.SS4.p3.7.m7.3.3.2.2.2.2.3.cmml" type="integer" xref="S4.SS4.p3.7.m7.3.3.2.2.2.2.3">
             2
            </cn>
           </apply>
           <ci id="S4.SS4.p3.7.m7.3.3.2.2.2.3.cmml" xref="S4.SS4.p3.7.m7.3.3.2.2.2.3">
            𝑆
           </ci>
          </apply>
          <ci id="S4.SS4.p3.7.m7.1.1.cmml" xref="S4.SS4.p3.7.m7.1.1">
           …
          </ci>
          <apply id="S4.SS4.p3.7.m7.4.4.3.3.3.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3">
           <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.4.4.3.3.3.1.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3">
            superscript
           </csymbol>
           <apply id="S4.SS4.p3.7.m7.4.4.3.3.3.2.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3">
            <csymbol cd="ambiguous" id="S4.SS4.p3.7.m7.4.4.3.3.3.2.1.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3">
             subscript
            </csymbol>
            <ci id="S4.SS4.p3.7.m7.4.4.3.3.3.2.2.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3.2.2">
             𝐛
            </ci>
            <ci id="S4.SS4.p3.7.m7.4.4.3.3.3.2.3.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3.2.3">
             𝑁
            </ci>
           </apply>
           <ci id="S4.SS4.p3.7.m7.4.4.3.3.3.3.cmml" xref="S4.SS4.p3.7.m7.4.4.3.3.3.3">
            𝑆
           </ci>
          </apply>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p3.7.m7.4c">
        \mathbf{s}^{D}=\{\mathbf{b}_{1}^{S},\mathbf{b}_{2}^{S},...,\mathbf{b}_{N}^{S}\}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p4">
    <p class="ltx_p" id="S4.SS4.p4.11">
     <em class="ltx_emph ltx_font_italic" id="S4.SS4.p4.11.1">
      Actions:
     </em>
     We denote an action of Agent-D as
     <math alttext="a^{D}" class="ltx_Math" display="inline" id="S4.SS4.p4.1.m1.1">
      <semantics id="S4.SS4.p4.1.m1.1a">
       <msup id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml">
        <mi id="S4.SS4.p4.1.m1.1.1.2" xref="S4.SS4.p4.1.m1.1.1.2.cmml">
         a
        </mi>
        <mi id="S4.SS4.p4.1.m1.1.1.3" xref="S4.SS4.p4.1.m1.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b">
        <apply id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p4.1.m1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.1.1.2">
          𝑎
         </ci>
         <ci id="S4.SS4.p4.1.m1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">
        a^{D}
       </annotation>
      </semantics>
     </math>
     , and the design of these actions is based on the previous discussion, which involves dropping one of the
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p4.2.m2.1">
      <semantics id="S4.SS4.p4.2.m2.1a">
       <mi id="S4.SS4.p4.2.m2.1.1" xref="S4.SS4.p4.2.m2.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.2.m2.1b">
        <ci id="S4.SS4.p4.2.m2.1.1.cmml" xref="S4.SS4.p4.2.m2.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.2.m2.1c">
        K
       </annotation>
      </semantics>
     </math>
     suggestions in the sliding window and inserting the next suggestion into the window. Formally, the actions are defined as
     <math alttext="a^{D}=k" class="ltx_Math" display="inline" id="S4.SS4.p4.3.m3.1">
      <semantics id="S4.SS4.p4.3.m3.1a">
       <mrow id="S4.SS4.p4.3.m3.1.1" xref="S4.SS4.p4.3.m3.1.1.cmml">
        <msup id="S4.SS4.p4.3.m3.1.1.2" xref="S4.SS4.p4.3.m3.1.1.2.cmml">
         <mi id="S4.SS4.p4.3.m3.1.1.2.2" xref="S4.SS4.p4.3.m3.1.1.2.2.cmml">
          a
         </mi>
         <mi id="S4.SS4.p4.3.m3.1.1.2.3" xref="S4.SS4.p4.3.m3.1.1.2.3.cmml">
          D
         </mi>
        </msup>
        <mo id="S4.SS4.p4.3.m3.1.1.1" xref="S4.SS4.p4.3.m3.1.1.1.cmml">
         =
        </mo>
        <mi id="S4.SS4.p4.3.m3.1.1.3" xref="S4.SS4.p4.3.m3.1.1.3.cmml">
         k
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.3.m3.1b">
        <apply id="S4.SS4.p4.3.m3.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1">
         <eq id="S4.SS4.p4.3.m3.1.1.1.cmml" xref="S4.SS4.p4.3.m3.1.1.1">
         </eq>
         <apply id="S4.SS4.p4.3.m3.1.1.2.cmml" xref="S4.SS4.p4.3.m3.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS4.p4.3.m3.1.1.2.1.cmml" xref="S4.SS4.p4.3.m3.1.1.2">
           superscript
          </csymbol>
          <ci id="S4.SS4.p4.3.m3.1.1.2.2.cmml" xref="S4.SS4.p4.3.m3.1.1.2.2">
           𝑎
          </ci>
          <ci id="S4.SS4.p4.3.m3.1.1.2.3.cmml" xref="S4.SS4.p4.3.m3.1.1.2.3">
           𝐷
          </ci>
         </apply>
         <ci id="S4.SS4.p4.3.m3.1.1.3.cmml" xref="S4.SS4.p4.3.m3.1.1.3">
          𝑘
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.3.m3.1c">
        a^{D}=k
       </annotation>
      </semantics>
     </math>
     where
     <math alttext="1\leq k\leq K" class="ltx_Math" display="inline" id="S4.SS4.p4.4.m4.1">
      <semantics id="S4.SS4.p4.4.m4.1a">
       <mrow id="S4.SS4.p4.4.m4.1.1" xref="S4.SS4.p4.4.m4.1.1.cmml">
        <mn id="S4.SS4.p4.4.m4.1.1.2" xref="S4.SS4.p4.4.m4.1.1.2.cmml">
         1
        </mn>
        <mo id="S4.SS4.p4.4.m4.1.1.3" xref="S4.SS4.p4.4.m4.1.1.3.cmml">
         ≤
        </mo>
        <mi id="S4.SS4.p4.4.m4.1.1.4" xref="S4.SS4.p4.4.m4.1.1.4.cmml">
         k
        </mi>
        <mo id="S4.SS4.p4.4.m4.1.1.5" xref="S4.SS4.p4.4.m4.1.1.5.cmml">
         ≤
        </mo>
        <mi id="S4.SS4.p4.4.m4.1.1.6" xref="S4.SS4.p4.4.m4.1.1.6.cmml">
         K
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.4.m4.1b">
        <apply id="S4.SS4.p4.4.m4.1.1.cmml" xref="S4.SS4.p4.4.m4.1.1">
         <and id="S4.SS4.p4.4.m4.1.1a.cmml" xref="S4.SS4.p4.4.m4.1.1">
         </and>
         <apply id="S4.SS4.p4.4.m4.1.1b.cmml" xref="S4.SS4.p4.4.m4.1.1">
          <leq id="S4.SS4.p4.4.m4.1.1.3.cmml" xref="S4.SS4.p4.4.m4.1.1.3">
          </leq>
          <cn id="S4.SS4.p4.4.m4.1.1.2.cmml" type="integer" xref="S4.SS4.p4.4.m4.1.1.2">
           1
          </cn>
          <ci id="S4.SS4.p4.4.m4.1.1.4.cmml" xref="S4.SS4.p4.4.m4.1.1.4">
           𝑘
          </ci>
         </apply>
         <apply id="S4.SS4.p4.4.m4.1.1c.cmml" xref="S4.SS4.p4.4.m4.1.1">
          <leq id="S4.SS4.p4.4.m4.1.1.5.cmml" xref="S4.SS4.p4.4.m4.1.1.5">
          </leq>
          <share href="#S4.SS4.p4.4.m4.1.1.4.cmml" id="S4.SS4.p4.4.m4.1.1d.cmml" xref="S4.SS4.p4.4.m4.1.1">
          </share>
          <ci id="S4.SS4.p4.4.m4.1.1.6.cmml" xref="S4.SS4.p4.4.m4.1.1.6">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.4.m4.1c">
        1\leq k\leq K
       </annotation>
      </semantics>
     </math>
     . In this notation, when action
     <math alttext="a^{D}=k" class="ltx_Math" display="inline" id="S4.SS4.p4.5.m5.1">
      <semantics id="S4.SS4.p4.5.m5.1a">
       <mrow id="S4.SS4.p4.5.m5.1.1" xref="S4.SS4.p4.5.m5.1.1.cmml">
        <msup id="S4.SS4.p4.5.m5.1.1.2" xref="S4.SS4.p4.5.m5.1.1.2.cmml">
         <mi id="S4.SS4.p4.5.m5.1.1.2.2" xref="S4.SS4.p4.5.m5.1.1.2.2.cmml">
          a
         </mi>
         <mi id="S4.SS4.p4.5.m5.1.1.2.3" xref="S4.SS4.p4.5.m5.1.1.2.3.cmml">
          D
         </mi>
        </msup>
        <mo id="S4.SS4.p4.5.m5.1.1.1" xref="S4.SS4.p4.5.m5.1.1.1.cmml">
         =
        </mo>
        <mi id="S4.SS4.p4.5.m5.1.1.3" xref="S4.SS4.p4.5.m5.1.1.3.cmml">
         k
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.5.m5.1b">
        <apply id="S4.SS4.p4.5.m5.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1">
         <eq id="S4.SS4.p4.5.m5.1.1.1.cmml" xref="S4.SS4.p4.5.m5.1.1.1">
         </eq>
         <apply id="S4.SS4.p4.5.m5.1.1.2.cmml" xref="S4.SS4.p4.5.m5.1.1.2">
          <csymbol cd="ambiguous" id="S4.SS4.p4.5.m5.1.1.2.1.cmml" xref="S4.SS4.p4.5.m5.1.1.2">
           superscript
          </csymbol>
          <ci id="S4.SS4.p4.5.m5.1.1.2.2.cmml" xref="S4.SS4.p4.5.m5.1.1.2.2">
           𝑎
          </ci>
          <ci id="S4.SS4.p4.5.m5.1.1.2.3.cmml" xref="S4.SS4.p4.5.m5.1.1.2.3">
           𝐷
          </ci>
         </apply>
         <ci id="S4.SS4.p4.5.m5.1.1.3.cmml" xref="S4.SS4.p4.5.m5.1.1.3">
          𝑘
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.5.m5.1c">
        a^{D}=k
       </annotation>
      </semantics>
     </math>
     , it means that the
     <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p4.6.m6.1">
      <semantics id="S4.SS4.p4.6.m6.1a">
       <mi id="S4.SS4.p4.6.m6.1.1" xref="S4.SS4.p4.6.m6.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.6.m6.1b">
        <ci id="S4.SS4.p4.6.m6.1.1.cmml" xref="S4.SS4.p4.6.m6.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.6.m6.1c">
        k
       </annotation>
      </semantics>
     </math>
     -th suggestion should be dropped, and the
     <math alttext="K+1" class="ltx_Math" display="inline" id="S4.SS4.p4.7.m7.1">
      <semantics id="S4.SS4.p4.7.m7.1a">
       <mrow id="S4.SS4.p4.7.m7.1.1" xref="S4.SS4.p4.7.m7.1.1.cmml">
        <mi id="S4.SS4.p4.7.m7.1.1.2" xref="S4.SS4.p4.7.m7.1.1.2.cmml">
         K
        </mi>
        <mo id="S4.SS4.p4.7.m7.1.1.1" xref="S4.SS4.p4.7.m7.1.1.1.cmml">
         +
        </mo>
        <mn id="S4.SS4.p4.7.m7.1.1.3" xref="S4.SS4.p4.7.m7.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.7.m7.1b">
        <apply id="S4.SS4.p4.7.m7.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1">
         <plus id="S4.SS4.p4.7.m7.1.1.1.cmml" xref="S4.SS4.p4.7.m7.1.1.1">
         </plus>
         <ci id="S4.SS4.p4.7.m7.1.1.2.cmml" xref="S4.SS4.p4.7.m7.1.1.2">
          𝐾
         </ci>
         <cn id="S4.SS4.p4.7.m7.1.1.3.cmml" type="integer" xref="S4.SS4.p4.7.m7.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.7.m7.1c">
        K+1
       </annotation>
      </semantics>
     </math>
     -th suggestion should be inserted into the window. Consider the consequence of dropping the
     <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p4.8.m8.1">
      <semantics id="S4.SS4.p4.8.m8.1a">
       <mi id="S4.SS4.p4.8.m8.1.1" xref="S4.SS4.p4.8.m8.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.8.m8.1b">
        <ci id="S4.SS4.p4.8.m8.1.1.cmml" xref="S4.SS4.p4.8.m8.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.8.m8.1c">
        k
       </annotation>
      </semantics>
     </math>
     -th suggestion, this action transitions the environment to the next state as
     <math alttext="\mathbf{s}^{\prime D}=\{\mathbf{b}_{1}^{S},...,\mathbf{b}_{k-1}^{S},\mathbf{b}_{k+1}^{S},...,\mathbf{b}_{K}^{S},\mathbf{b}_{K+1}^{S},...,\mathbf{b}_{N}^{S},\mathbf{O}\}" class="ltx_Math" display="inline" id="S4.SS4.p4.9.m9.12">
      <semantics id="S4.SS4.p4.9.m9.12a">
       <mrow id="S4.SS4.p4.9.m9.12.12" xref="S4.SS4.p4.9.m9.12.12.cmml">
        <msup id="S4.SS4.p4.9.m9.12.12.8" xref="S4.SS4.p4.9.m9.12.12.8.cmml">
         <mi id="S4.SS4.p4.9.m9.12.12.8.2" xref="S4.SS4.p4.9.m9.12.12.8.2.cmml">
          𝐬
         </mi>
         <mrow id="S4.SS4.p4.9.m9.2.2.2.2" xref="S4.SS4.p4.9.m9.2.2.2.3.cmml">
          <mo id="S4.SS4.p4.9.m9.2.2.2.2.1" mathsize="142%" xref="S4.SS4.p4.9.m9.2.2.2.2.1.cmml">
           ′
          </mo>
          <mo id="S4.SS4.p4.9.m9.2.2.2.2.2" lspace="0em" xref="S4.SS4.p4.9.m9.2.2.2.3.cmml">
           ⁣
          </mo>
          <mi id="S4.SS4.p4.9.m9.1.1.1.1" xref="S4.SS4.p4.9.m9.1.1.1.1.cmml">
           D
          </mi>
         </mrow>
        </msup>
        <mo id="S4.SS4.p4.9.m9.12.12.7" xref="S4.SS4.p4.9.m9.12.12.7.cmml">
         =
        </mo>
        <mrow id="S4.SS4.p4.9.m9.12.12.6.6" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.7" stretchy="false" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          {
         </mo>
         <msubsup id="S4.SS4.p4.9.m9.7.7.1.1.1" xref="S4.SS4.p4.9.m9.7.7.1.1.1.cmml">
          <mi id="S4.SS4.p4.9.m9.7.7.1.1.1.2.2" xref="S4.SS4.p4.9.m9.7.7.1.1.1.2.2.cmml">
           𝐛
          </mi>
          <mn id="S4.SS4.p4.9.m9.7.7.1.1.1.2.3" xref="S4.SS4.p4.9.m9.7.7.1.1.1.2.3.cmml">
           1
          </mn>
          <mi id="S4.SS4.p4.9.m9.7.7.1.1.1.3" xref="S4.SS4.p4.9.m9.7.7.1.1.1.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.8" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <mi id="S4.SS4.p4.9.m9.3.3" mathvariant="normal" xref="S4.SS4.p4.9.m9.3.3.cmml">
          …
         </mi>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.9" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p4.9.m9.8.8.2.2.2" xref="S4.SS4.p4.9.m9.8.8.2.2.2.cmml">
          <mi id="S4.SS4.p4.9.m9.8.8.2.2.2.2.2" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.2.cmml">
           𝐛
          </mi>
          <mrow id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.cmml">
           <mi id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.2" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.2.cmml">
            k
           </mi>
           <mo id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.1" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.1.cmml">
            −
           </mo>
           <mn id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.3" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.3.cmml">
            1
           </mn>
          </mrow>
          <mi id="S4.SS4.p4.9.m9.8.8.2.2.2.3" xref="S4.SS4.p4.9.m9.8.8.2.2.2.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.10" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p4.9.m9.9.9.3.3.3" xref="S4.SS4.p4.9.m9.9.9.3.3.3.cmml">
          <mi id="S4.SS4.p4.9.m9.9.9.3.3.3.2.2" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.2.cmml">
           𝐛
          </mi>
          <mrow id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.cmml">
           <mi id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.2" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.2.cmml">
            k
           </mi>
           <mo id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.1" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.1.cmml">
            +
           </mo>
           <mn id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.3" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.3.cmml">
            1
           </mn>
          </mrow>
          <mi id="S4.SS4.p4.9.m9.9.9.3.3.3.3" xref="S4.SS4.p4.9.m9.9.9.3.3.3.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.11" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <mi id="S4.SS4.p4.9.m9.4.4" mathvariant="normal" xref="S4.SS4.p4.9.m9.4.4.cmml">
          …
         </mi>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.12" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p4.9.m9.10.10.4.4.4" xref="S4.SS4.p4.9.m9.10.10.4.4.4.cmml">
          <mi id="S4.SS4.p4.9.m9.10.10.4.4.4.2.2" xref="S4.SS4.p4.9.m9.10.10.4.4.4.2.2.cmml">
           𝐛
          </mi>
          <mi id="S4.SS4.p4.9.m9.10.10.4.4.4.2.3" xref="S4.SS4.p4.9.m9.10.10.4.4.4.2.3.cmml">
           K
          </mi>
          <mi id="S4.SS4.p4.9.m9.10.10.4.4.4.3" xref="S4.SS4.p4.9.m9.10.10.4.4.4.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.13" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p4.9.m9.11.11.5.5.5" xref="S4.SS4.p4.9.m9.11.11.5.5.5.cmml">
          <mi id="S4.SS4.p4.9.m9.11.11.5.5.5.2.2" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.2.cmml">
           𝐛
          </mi>
          <mrow id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.cmml">
           <mi id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.2" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.2.cmml">
            K
           </mi>
           <mo id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.1" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.1.cmml">
            +
           </mo>
           <mn id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.3" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.3.cmml">
            1
           </mn>
          </mrow>
          <mi id="S4.SS4.p4.9.m9.11.11.5.5.5.3" xref="S4.SS4.p4.9.m9.11.11.5.5.5.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.14" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <mi id="S4.SS4.p4.9.m9.5.5" mathvariant="normal" xref="S4.SS4.p4.9.m9.5.5.cmml">
          …
         </mi>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.15" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <msubsup id="S4.SS4.p4.9.m9.12.12.6.6.6" xref="S4.SS4.p4.9.m9.12.12.6.6.6.cmml">
          <mi id="S4.SS4.p4.9.m9.12.12.6.6.6.2.2" xref="S4.SS4.p4.9.m9.12.12.6.6.6.2.2.cmml">
           𝐛
          </mi>
          <mi id="S4.SS4.p4.9.m9.12.12.6.6.6.2.3" xref="S4.SS4.p4.9.m9.12.12.6.6.6.2.3.cmml">
           N
          </mi>
          <mi id="S4.SS4.p4.9.m9.12.12.6.6.6.3" xref="S4.SS4.p4.9.m9.12.12.6.6.6.3.cmml">
           S
          </mi>
         </msubsup>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.16" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          ,
         </mo>
         <mi id="S4.SS4.p4.9.m9.6.6" xref="S4.SS4.p4.9.m9.6.6.cmml">
          𝐎
         </mi>
         <mo id="S4.SS4.p4.9.m9.12.12.6.6.17" stretchy="false" xref="S4.SS4.p4.9.m9.12.12.6.7.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.9.m9.12b">
        <apply id="S4.SS4.p4.9.m9.12.12.cmml" xref="S4.SS4.p4.9.m9.12.12">
         <eq id="S4.SS4.p4.9.m9.12.12.7.cmml" xref="S4.SS4.p4.9.m9.12.12.7">
         </eq>
         <apply id="S4.SS4.p4.9.m9.12.12.8.cmml" xref="S4.SS4.p4.9.m9.12.12.8">
          <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.12.12.8.1.cmml" xref="S4.SS4.p4.9.m9.12.12.8">
           superscript
          </csymbol>
          <ci id="S4.SS4.p4.9.m9.12.12.8.2.cmml" xref="S4.SS4.p4.9.m9.12.12.8.2">
           𝐬
          </ci>
          <list id="S4.SS4.p4.9.m9.2.2.2.3.cmml" xref="S4.SS4.p4.9.m9.2.2.2.2">
           <ci id="S4.SS4.p4.9.m9.2.2.2.2.1.cmml" xref="S4.SS4.p4.9.m9.2.2.2.2.1">
            ′
           </ci>
           <ci id="S4.SS4.p4.9.m9.1.1.1.1.cmml" xref="S4.SS4.p4.9.m9.1.1.1.1">
            𝐷
           </ci>
          </list>
         </apply>
         <set id="S4.SS4.p4.9.m9.12.12.6.7.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6">
          <apply id="S4.SS4.p4.9.m9.7.7.1.1.1.cmml" xref="S4.SS4.p4.9.m9.7.7.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.7.7.1.1.1.1.cmml" xref="S4.SS4.p4.9.m9.7.7.1.1.1">
            superscript
           </csymbol>
           <apply id="S4.SS4.p4.9.m9.7.7.1.1.1.2.cmml" xref="S4.SS4.p4.9.m9.7.7.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.7.7.1.1.1.2.1.cmml" xref="S4.SS4.p4.9.m9.7.7.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS4.p4.9.m9.7.7.1.1.1.2.2.cmml" xref="S4.SS4.p4.9.m9.7.7.1.1.1.2.2">
             𝐛
            </ci>
            <cn id="S4.SS4.p4.9.m9.7.7.1.1.1.2.3.cmml" type="integer" xref="S4.SS4.p4.9.m9.7.7.1.1.1.2.3">
             1
            </cn>
           </apply>
           <ci id="S4.SS4.p4.9.m9.7.7.1.1.1.3.cmml" xref="S4.SS4.p4.9.m9.7.7.1.1.1.3">
            𝑆
           </ci>
          </apply>
          <ci id="S4.SS4.p4.9.m9.3.3.cmml" xref="S4.SS4.p4.9.m9.3.3">
           …
          </ci>
          <apply id="S4.SS4.p4.9.m9.8.8.2.2.2.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.8.8.2.2.2.1.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2">
            superscript
           </csymbol>
           <apply id="S4.SS4.p4.9.m9.8.8.2.2.2.2.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.8.8.2.2.2.2.1.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2">
             subscript
            </csymbol>
            <ci id="S4.SS4.p4.9.m9.8.8.2.2.2.2.2.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.2">
             𝐛
            </ci>
            <apply id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3">
             <minus id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.1.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.1">
             </minus>
             <ci id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.2.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.2">
              𝑘
             </ci>
             <cn id="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.3.cmml" type="integer" xref="S4.SS4.p4.9.m9.8.8.2.2.2.2.3.3">
              1
             </cn>
            </apply>
           </apply>
           <ci id="S4.SS4.p4.9.m9.8.8.2.2.2.3.cmml" xref="S4.SS4.p4.9.m9.8.8.2.2.2.3">
            𝑆
           </ci>
          </apply>
          <apply id="S4.SS4.p4.9.m9.9.9.3.3.3.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3">
           <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.9.9.3.3.3.1.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3">
            superscript
           </csymbol>
           <apply id="S4.SS4.p4.9.m9.9.9.3.3.3.2.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3">
            <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.9.9.3.3.3.2.1.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3">
             subscript
            </csymbol>
            <ci id="S4.SS4.p4.9.m9.9.9.3.3.3.2.2.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.2">
             𝐛
            </ci>
            <apply id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3">
             <plus id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.1.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.1">
             </plus>
             <ci id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.2.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.2">
              𝑘
             </ci>
             <cn id="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.3.cmml" type="integer" xref="S4.SS4.p4.9.m9.9.9.3.3.3.2.3.3">
              1
             </cn>
            </apply>
           </apply>
           <ci id="S4.SS4.p4.9.m9.9.9.3.3.3.3.cmml" xref="S4.SS4.p4.9.m9.9.9.3.3.3.3">
            𝑆
           </ci>
          </apply>
          <ci id="S4.SS4.p4.9.m9.4.4.cmml" xref="S4.SS4.p4.9.m9.4.4">
           …
          </ci>
          <apply id="S4.SS4.p4.9.m9.10.10.4.4.4.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4">
           <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.10.10.4.4.4.1.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4">
            superscript
           </csymbol>
           <apply id="S4.SS4.p4.9.m9.10.10.4.4.4.2.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4">
            <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.10.10.4.4.4.2.1.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4">
             subscript
            </csymbol>
            <ci id="S4.SS4.p4.9.m9.10.10.4.4.4.2.2.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4.2.2">
             𝐛
            </ci>
            <ci id="S4.SS4.p4.9.m9.10.10.4.4.4.2.3.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4.2.3">
             𝐾
            </ci>
           </apply>
           <ci id="S4.SS4.p4.9.m9.10.10.4.4.4.3.cmml" xref="S4.SS4.p4.9.m9.10.10.4.4.4.3">
            𝑆
           </ci>
          </apply>
          <apply id="S4.SS4.p4.9.m9.11.11.5.5.5.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5">
           <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.11.11.5.5.5.1.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5">
            superscript
           </csymbol>
           <apply id="S4.SS4.p4.9.m9.11.11.5.5.5.2.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5">
            <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.11.11.5.5.5.2.1.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5">
             subscript
            </csymbol>
            <ci id="S4.SS4.p4.9.m9.11.11.5.5.5.2.2.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.2">
             𝐛
            </ci>
            <apply id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3">
             <plus id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.1.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.1">
             </plus>
             <ci id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.2.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.2">
              𝐾
             </ci>
             <cn id="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.3.cmml" type="integer" xref="S4.SS4.p4.9.m9.11.11.5.5.5.2.3.3">
              1
             </cn>
            </apply>
           </apply>
           <ci id="S4.SS4.p4.9.m9.11.11.5.5.5.3.cmml" xref="S4.SS4.p4.9.m9.11.11.5.5.5.3">
            𝑆
           </ci>
          </apply>
          <ci id="S4.SS4.p4.9.m9.5.5.cmml" xref="S4.SS4.p4.9.m9.5.5">
           …
          </ci>
          <apply id="S4.SS4.p4.9.m9.12.12.6.6.6.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6">
           <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.12.12.6.6.6.1.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6">
            superscript
           </csymbol>
           <apply id="S4.SS4.p4.9.m9.12.12.6.6.6.2.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6">
            <csymbol cd="ambiguous" id="S4.SS4.p4.9.m9.12.12.6.6.6.2.1.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6">
             subscript
            </csymbol>
            <ci id="S4.SS4.p4.9.m9.12.12.6.6.6.2.2.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6.2.2">
             𝐛
            </ci>
            <ci id="S4.SS4.p4.9.m9.12.12.6.6.6.2.3.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6.2.3">
             𝑁
            </ci>
           </apply>
           <ci id="S4.SS4.p4.9.m9.12.12.6.6.6.3.cmml" xref="S4.SS4.p4.9.m9.12.12.6.6.6.3">
            𝑆
           </ci>
          </apply>
          <ci id="S4.SS4.p4.9.m9.6.6.cmml" xref="S4.SS4.p4.9.m9.6.6">
           𝐎
          </ci>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.9.m9.12c">
        \mathbf{s}^{\prime D}=\{\mathbf{b}_{1}^{S},...,\mathbf{b}_{k-1}^{S},\mathbf{b}_{k+1}^{S},...,\mathbf{b}_{K}^{S},\mathbf{b}_{K+1}^{S},...,\mathbf{b}_{N}^{S},\mathbf{O}\}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\mathbf{O}" class="ltx_Math" display="inline" id="S4.SS4.p4.10.m10.1">
      <semantics id="S4.SS4.p4.10.m10.1a">
       <mi id="S4.SS4.p4.10.m10.1.1" xref="S4.SS4.p4.10.m10.1.1.cmml">
        𝐎
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.10.m10.1b">
        <ci id="S4.SS4.p4.10.m10.1.1.cmml" xref="S4.SS4.p4.10.m10.1.1">
         𝐎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.10.m10.1c">
        \mathbf{O}
       </annotation>
      </semantics>
     </math>
     represents a zero vector, which is used to pad the state
     <math alttext="\mathbf{s}^{\prime D}" class="ltx_Math" display="inline" id="S4.SS4.p4.11.m11.2">
      <semantics id="S4.SS4.p4.11.m11.2a">
       <msup id="S4.SS4.p4.11.m11.2.3" xref="S4.SS4.p4.11.m11.2.3.cmml">
        <mi id="S4.SS4.p4.11.m11.2.3.2" xref="S4.SS4.p4.11.m11.2.3.2.cmml">
         𝐬
        </mi>
        <mrow id="S4.SS4.p4.11.m11.2.2.2.2" xref="S4.SS4.p4.11.m11.2.2.2.3.cmml">
         <mo id="S4.SS4.p4.11.m11.2.2.2.2.1" mathsize="142%" xref="S4.SS4.p4.11.m11.2.2.2.2.1.cmml">
          ′
         </mo>
         <mo id="S4.SS4.p4.11.m11.2.2.2.2.2" lspace="0em" xref="S4.SS4.p4.11.m11.2.2.2.3.cmml">
          ⁣
         </mo>
         <mi id="S4.SS4.p4.11.m11.1.1.1.1" xref="S4.SS4.p4.11.m11.1.1.1.1.cmml">
          D
         </mi>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p4.11.m11.2b">
        <apply id="S4.SS4.p4.11.m11.2.3.cmml" xref="S4.SS4.p4.11.m11.2.3">
         <csymbol cd="ambiguous" id="S4.SS4.p4.11.m11.2.3.1.cmml" xref="S4.SS4.p4.11.m11.2.3">
          superscript
         </csymbol>
         <ci id="S4.SS4.p4.11.m11.2.3.2.cmml" xref="S4.SS4.p4.11.m11.2.3.2">
          𝐬
         </ci>
         <list id="S4.SS4.p4.11.m11.2.2.2.3.cmml" xref="S4.SS4.p4.11.m11.2.2.2.2">
          <ci id="S4.SS4.p4.11.m11.2.2.2.2.1.cmml" xref="S4.SS4.p4.11.m11.2.2.2.2.1">
           ′
          </ci>
          <ci id="S4.SS4.p4.11.m11.1.1.1.1.cmml" xref="S4.SS4.p4.11.m11.1.1.1.1">
           𝐷
          </ci>
         </list>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p4.11.m11.2c">
        \mathbf{s}^{\prime D}
       </annotation>
      </semantics>
     </math>
     into a fixed-length vector. This fixed-length vector is then fed into the fully-connected (FC) policy network.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p5">
    <p class="ltx_p" id="S4.SS4.p5.11">
     <em class="ltx_emph ltx_font_italic" id="S4.SS4.p5.11.1">
      Rewards:
     </em>
     We denote the reward as
     <math alttext="r^{D}" class="ltx_Math" display="inline" id="S4.SS4.p5.1.m1.1">
      <semantics id="S4.SS4.p5.1.m1.1a">
       <msup id="S4.SS4.p5.1.m1.1.1" xref="S4.SS4.p5.1.m1.1.1.cmml">
        <mi id="S4.SS4.p5.1.m1.1.1.2" xref="S4.SS4.p5.1.m1.1.1.2.cmml">
         r
        </mi>
        <mi id="S4.SS4.p5.1.m1.1.1.3" xref="S4.SS4.p5.1.m1.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.1.m1.1b">
        <apply id="S4.SS4.p5.1.m1.1.1.cmml" xref="S4.SS4.p5.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p5.1.m1.1.1.1.cmml" xref="S4.SS4.p5.1.m1.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p5.1.m1.1.1.2.cmml" xref="S4.SS4.p5.1.m1.1.1.2">
          𝑟
         </ci>
         <ci id="S4.SS4.p5.1.m1.1.1.3.cmml" xref="S4.SS4.p5.1.m1.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.1.m1.1c">
        r^{D}
       </annotation>
      </semantics>
     </math>
     . The reward associated with the transition from state
     <math alttext="\mathbf{s}^{D}" class="ltx_Math" display="inline" id="S4.SS4.p5.2.m2.1">
      <semantics id="S4.SS4.p5.2.m2.1a">
       <msup id="S4.SS4.p5.2.m2.1.1" xref="S4.SS4.p5.2.m2.1.1.cmml">
        <mi id="S4.SS4.p5.2.m2.1.1.2" xref="S4.SS4.p5.2.m2.1.1.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p5.2.m2.1.1.3" xref="S4.SS4.p5.2.m2.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.2.m2.1b">
        <apply id="S4.SS4.p5.2.m2.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.1.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p5.2.m2.1.1.2.cmml" xref="S4.SS4.p5.2.m2.1.1.2">
          𝐬
         </ci>
         <ci id="S4.SS4.p5.2.m2.1.1.3.cmml" xref="S4.SS4.p5.2.m2.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.2.m2.1c">
        \mathbf{s}^{D}
       </annotation>
      </semantics>
     </math>
     to state
     <math alttext="\mathbf{s}^{\prime D}" class="ltx_Math" display="inline" id="S4.SS4.p5.3.m3.2">
      <semantics id="S4.SS4.p5.3.m3.2a">
       <msup id="S4.SS4.p5.3.m3.2.3" xref="S4.SS4.p5.3.m3.2.3.cmml">
        <mi id="S4.SS4.p5.3.m3.2.3.2" xref="S4.SS4.p5.3.m3.2.3.2.cmml">
         𝐬
        </mi>
        <mrow id="S4.SS4.p5.3.m3.2.2.2.2" xref="S4.SS4.p5.3.m3.2.2.2.3.cmml">
         <mo id="S4.SS4.p5.3.m3.2.2.2.2.1" mathsize="142%" xref="S4.SS4.p5.3.m3.2.2.2.2.1.cmml">
          ′
         </mo>
         <mo id="S4.SS4.p5.3.m3.2.2.2.2.2" lspace="0em" xref="S4.SS4.p5.3.m3.2.2.2.3.cmml">
          ⁣
         </mo>
         <mi id="S4.SS4.p5.3.m3.1.1.1.1" xref="S4.SS4.p5.3.m3.1.1.1.1.cmml">
          D
         </mi>
        </mrow>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.3.m3.2b">
        <apply id="S4.SS4.p5.3.m3.2.3.cmml" xref="S4.SS4.p5.3.m3.2.3">
         <csymbol cd="ambiguous" id="S4.SS4.p5.3.m3.2.3.1.cmml" xref="S4.SS4.p5.3.m3.2.3">
          superscript
         </csymbol>
         <ci id="S4.SS4.p5.3.m3.2.3.2.cmml" xref="S4.SS4.p5.3.m3.2.3.2">
          𝐬
         </ci>
         <list id="S4.SS4.p5.3.m3.2.2.2.3.cmml" xref="S4.SS4.p5.3.m3.2.2.2.2">
          <ci id="S4.SS4.p5.3.m3.2.2.2.2.1.cmml" xref="S4.SS4.p5.3.m3.2.2.2.2.1">
           ′
          </ci>
          <ci id="S4.SS4.p5.3.m3.1.1.1.1.cmml" xref="S4.SS4.p5.3.m3.1.1.1.1">
           𝐷
          </ci>
         </list>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.3.m3.2c">
        \mathbf{s}^{\prime D}
       </annotation>
      </semantics>
     </math>
     after taking action
     <math alttext="a^{D}" class="ltx_Math" display="inline" id="S4.SS4.p5.4.m4.1">
      <semantics id="S4.SS4.p5.4.m4.1a">
       <msup id="S4.SS4.p5.4.m4.1.1" xref="S4.SS4.p5.4.m4.1.1.cmml">
        <mi id="S4.SS4.p5.4.m4.1.1.2" xref="S4.SS4.p5.4.m4.1.1.2.cmml">
         a
        </mi>
        <mi id="S4.SS4.p5.4.m4.1.1.3" xref="S4.SS4.p5.4.m4.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.4.m4.1b">
        <apply id="S4.SS4.p5.4.m4.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p5.4.m4.1.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p5.4.m4.1.1.2.cmml" xref="S4.SS4.p5.4.m4.1.1.2">
          𝑎
         </ci>
         <ci id="S4.SS4.p5.4.m4.1.1.3.cmml" xref="S4.SS4.p5.4.m4.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.4.m4.1c">
        a^{D}
       </annotation>
      </semantics>
     </math>
     is defined as:
     <math alttext="r^{D}=\mathbf{s}^{\prime D}.{{DIV}_{best}}-\mathbf{s}^{D}.{{DIV}_{best}}" class="ltx_Math" display="inline" id="S4.SS4.p5.5.m5.5">
      <semantics id="S4.SS4.p5.5.m5.5a">
       <mrow id="S4.SS4.p5.5.m5.5.5.3" xref="S4.SS4.p5.5.m5.5.5.4.cmml">
        <mrow id="S4.SS4.p5.5.m5.3.3.1.1" xref="S4.SS4.p5.5.m5.3.3.1.1.cmml">
         <msup id="S4.SS4.p5.5.m5.3.3.1.1.2" xref="S4.SS4.p5.5.m5.3.3.1.1.2.cmml">
          <mi id="S4.SS4.p5.5.m5.3.3.1.1.2.2" xref="S4.SS4.p5.5.m5.3.3.1.1.2.2.cmml">
           r
          </mi>
          <mi id="S4.SS4.p5.5.m5.3.3.1.1.2.3" xref="S4.SS4.p5.5.m5.3.3.1.1.2.3.cmml">
           D
          </mi>
         </msup>
         <mo id="S4.SS4.p5.5.m5.3.3.1.1.1" xref="S4.SS4.p5.5.m5.3.3.1.1.1.cmml">
          =
         </mo>
         <msup id="S4.SS4.p5.5.m5.3.3.1.1.3" xref="S4.SS4.p5.5.m5.3.3.1.1.3.cmml">
          <mi id="S4.SS4.p5.5.m5.3.3.1.1.3.2" xref="S4.SS4.p5.5.m5.3.3.1.1.3.2.cmml">
           𝐬
          </mi>
          <mrow id="S4.SS4.p5.5.m5.2.2.2.2" xref="S4.SS4.p5.5.m5.2.2.2.3.cmml">
           <mo id="S4.SS4.p5.5.m5.2.2.2.2.1" mathsize="142%" xref="S4.SS4.p5.5.m5.2.2.2.2.1.cmml">
            ′
           </mo>
           <mo id="S4.SS4.p5.5.m5.2.2.2.2.2" lspace="0em" xref="S4.SS4.p5.5.m5.2.2.2.3.cmml">
            ⁣
           </mo>
           <mi id="S4.SS4.p5.5.m5.1.1.1.1" xref="S4.SS4.p5.5.m5.1.1.1.1.cmml">
            D
           </mi>
          </mrow>
         </msup>
        </mrow>
        <mo id="S4.SS4.p5.5.m5.5.5.3.4" lspace="0em" rspace="0.167em" xref="S4.SS4.p5.5.m5.5.5.4a.cmml">
         .
        </mo>
        <mrow id="S4.SS4.p5.5.m5.4.4.2.2" xref="S4.SS4.p5.5.m5.4.4.2.2.cmml">
         <mrow id="S4.SS4.p5.5.m5.4.4.2.2.2" xref="S4.SS4.p5.5.m5.4.4.2.2.2.cmml">
          <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.2" xref="S4.SS4.p5.5.m5.4.4.2.2.2.2.cmml">
           D
          </mi>
          <mo id="S4.SS4.p5.5.m5.4.4.2.2.2.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.4.4.2.2.2.1.cmml">
           ​
          </mo>
          <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.3" xref="S4.SS4.p5.5.m5.4.4.2.2.2.3.cmml">
           I
          </mi>
          <mo id="S4.SS4.p5.5.m5.4.4.2.2.2.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.4.4.2.2.2.1.cmml">
           ​
          </mo>
          <msub id="S4.SS4.p5.5.m5.4.4.2.2.2.4" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.cmml">
           <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.4.2" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.2.cmml">
            V
           </mi>
           <mrow id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.cmml">
            <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.2" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.2.cmml">
             b
            </mi>
            <mo id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.3" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.3.cmml">
             e
            </mi>
            <mo id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.4" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.4.cmml">
             s
            </mi>
            <mo id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1b" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1.cmml">
             ​
            </mo>
            <mi id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.5" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.5.cmml">
             t
            </mi>
           </mrow>
          </msub>
         </mrow>
         <mo id="S4.SS4.p5.5.m5.4.4.2.2.1" xref="S4.SS4.p5.5.m5.4.4.2.2.1.cmml">
          −
         </mo>
         <msup id="S4.SS4.p5.5.m5.4.4.2.2.3" xref="S4.SS4.p5.5.m5.4.4.2.2.3.cmml">
          <mi id="S4.SS4.p5.5.m5.4.4.2.2.3.2" xref="S4.SS4.p5.5.m5.4.4.2.2.3.2.cmml">
           𝐬
          </mi>
          <mi id="S4.SS4.p5.5.m5.4.4.2.2.3.3" xref="S4.SS4.p5.5.m5.4.4.2.2.3.3.cmml">
           D
          </mi>
         </msup>
        </mrow>
        <mo id="S4.SS4.p5.5.m5.5.5.3.5" lspace="0em" rspace="0.167em" xref="S4.SS4.p5.5.m5.5.5.4a.cmml">
         .
        </mo>
        <mrow id="S4.SS4.p5.5.m5.5.5.3.3" xref="S4.SS4.p5.5.m5.5.5.3.3.cmml">
         <mi id="S4.SS4.p5.5.m5.5.5.3.3.2" xref="S4.SS4.p5.5.m5.5.5.3.3.2.cmml">
          D
         </mi>
         <mo id="S4.SS4.p5.5.m5.5.5.3.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.5.5.3.3.1.cmml">
          ​
         </mo>
         <mi id="S4.SS4.p5.5.m5.5.5.3.3.3" xref="S4.SS4.p5.5.m5.5.5.3.3.3.cmml">
          I
         </mi>
         <mo id="S4.SS4.p5.5.m5.5.5.3.3.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.5.5.3.3.1.cmml">
          ​
         </mo>
         <msub id="S4.SS4.p5.5.m5.5.5.3.3.4" xref="S4.SS4.p5.5.m5.5.5.3.3.4.cmml">
          <mi id="S4.SS4.p5.5.m5.5.5.3.3.4.2" xref="S4.SS4.p5.5.m5.5.5.3.3.4.2.cmml">
           V
          </mi>
          <mrow id="S4.SS4.p5.5.m5.5.5.3.3.4.3" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.cmml">
           <mi id="S4.SS4.p5.5.m5.5.5.3.3.4.3.2" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.2.cmml">
            b
           </mi>
           <mo id="S4.SS4.p5.5.m5.5.5.3.3.4.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.5.m5.5.5.3.3.4.3.3" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.3.cmml">
            e
           </mi>
           <mo id="S4.SS4.p5.5.m5.5.5.3.3.4.3.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.5.m5.5.5.3.3.4.3.4" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.4.cmml">
            s
           </mi>
           <mo id="S4.SS4.p5.5.m5.5.5.3.3.4.3.1b" lspace="0em" rspace="0em" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.5.m5.5.5.3.3.4.3.5" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.5.cmml">
            t
           </mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.5.m5.5b">
        <apply id="S4.SS4.p5.5.m5.5.5.4.cmml" xref="S4.SS4.p5.5.m5.5.5.3">
         <csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.5.5.4a.cmml" xref="S4.SS4.p5.5.m5.5.5.3.4">
          formulae-sequence
         </csymbol>
         <apply id="S4.SS4.p5.5.m5.3.3.1.1.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1">
          <eq id="S4.SS4.p5.5.m5.3.3.1.1.1.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.1">
          </eq>
          <apply id="S4.SS4.p5.5.m5.3.3.1.1.2.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.2">
           <csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.3.3.1.1.2.1.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.2">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.5.m5.3.3.1.1.2.2.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.2.2">
            𝑟
           </ci>
           <ci id="S4.SS4.p5.5.m5.3.3.1.1.2.3.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.2.3">
            𝐷
           </ci>
          </apply>
          <apply id="S4.SS4.p5.5.m5.3.3.1.1.3.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.3">
           <csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.3.3.1.1.3.1.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.3">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.5.m5.3.3.1.1.3.2.cmml" xref="S4.SS4.p5.5.m5.3.3.1.1.3.2">
            𝐬
           </ci>
           <list id="S4.SS4.p5.5.m5.2.2.2.3.cmml" xref="S4.SS4.p5.5.m5.2.2.2.2">
            <ci id="S4.SS4.p5.5.m5.2.2.2.2.1.cmml" xref="S4.SS4.p5.5.m5.2.2.2.2.1">
             ′
            </ci>
            <ci id="S4.SS4.p5.5.m5.1.1.1.1.cmml" xref="S4.SS4.p5.5.m5.1.1.1.1">
             𝐷
            </ci>
           </list>
          </apply>
         </apply>
         <apply id="S4.SS4.p5.5.m5.4.4.2.2.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2">
          <minus id="S4.SS4.p5.5.m5.4.4.2.2.1.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.1">
          </minus>
          <apply id="S4.SS4.p5.5.m5.4.4.2.2.2.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2">
           <times id="S4.SS4.p5.5.m5.4.4.2.2.2.1.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.1">
           </times>
           <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.2.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.2">
            𝐷
           </ci>
           <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.3.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.3">
            𝐼
           </ci>
           <apply id="S4.SS4.p5.5.m5.4.4.2.2.2.4.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4">
            <csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.4.4.2.2.2.4.1.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4">
             subscript
            </csymbol>
            <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.4.2.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.2">
             𝑉
            </ci>
            <apply id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3">
             <times id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.1">
             </times>
             <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.2.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.2">
              𝑏
             </ci>
             <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.3.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.3">
              𝑒
             </ci>
             <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.4.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.4">
              𝑠
             </ci>
             <ci id="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.5.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.2.4.3.5">
              𝑡
             </ci>
            </apply>
           </apply>
          </apply>
          <apply id="S4.SS4.p5.5.m5.4.4.2.2.3.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.3">
           <csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.4.4.2.2.3.1.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.3">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.5.m5.4.4.2.2.3.2.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.3.2">
            𝐬
           </ci>
           <ci id="S4.SS4.p5.5.m5.4.4.2.2.3.3.cmml" xref="S4.SS4.p5.5.m5.4.4.2.2.3.3">
            𝐷
           </ci>
          </apply>
         </apply>
         <apply id="S4.SS4.p5.5.m5.5.5.3.3.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3">
          <times id="S4.SS4.p5.5.m5.5.5.3.3.1.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.1">
          </times>
          <ci id="S4.SS4.p5.5.m5.5.5.3.3.2.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.2">
           𝐷
          </ci>
          <ci id="S4.SS4.p5.5.m5.5.5.3.3.3.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.3">
           𝐼
          </ci>
          <apply id="S4.SS4.p5.5.m5.5.5.3.3.4.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4">
           <csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.5.5.3.3.4.1.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4">
            subscript
           </csymbol>
           <ci id="S4.SS4.p5.5.m5.5.5.3.3.4.2.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.2">
            𝑉
           </ci>
           <apply id="S4.SS4.p5.5.m5.5.5.3.3.4.3.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3">
            <times id="S4.SS4.p5.5.m5.5.5.3.3.4.3.1.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.1">
            </times>
            <ci id="S4.SS4.p5.5.m5.5.5.3.3.4.3.2.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.2">
             𝑏
            </ci>
            <ci id="S4.SS4.p5.5.m5.5.5.3.3.4.3.3.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.3">
             𝑒
            </ci>
            <ci id="S4.SS4.p5.5.m5.5.5.3.3.4.3.4.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.4">
             𝑠
            </ci>
            <ci id="S4.SS4.p5.5.m5.5.5.3.3.4.3.5.cmml" xref="S4.SS4.p5.5.m5.5.5.3.3.4.3.5">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.5.m5.5c">
        r^{D}=\mathbf{s}^{\prime D}.{{DIV}_{best}}-\mathbf{s}^{D}.{{DIV}_{best}}
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="\mathbf{s}^{D}.{{DIV}_{best}}" class="ltx_Math" display="inline" id="S4.SS4.p5.6.m6.2">
      <semantics id="S4.SS4.p5.6.m6.2a">
       <mrow id="S4.SS4.p5.6.m6.2.2.2" xref="S4.SS4.p5.6.m6.2.2.3.cmml">
        <msup id="S4.SS4.p5.6.m6.1.1.1.1" xref="S4.SS4.p5.6.m6.1.1.1.1.cmml">
         <mi id="S4.SS4.p5.6.m6.1.1.1.1.2" xref="S4.SS4.p5.6.m6.1.1.1.1.2.cmml">
          𝐬
         </mi>
         <mi id="S4.SS4.p5.6.m6.1.1.1.1.3" xref="S4.SS4.p5.6.m6.1.1.1.1.3.cmml">
          D
         </mi>
        </msup>
        <mo id="S4.SS4.p5.6.m6.2.2.2.3" lspace="0em" rspace="0.167em" xref="S4.SS4.p5.6.m6.2.2.3a.cmml">
         .
        </mo>
        <mrow id="S4.SS4.p5.6.m6.2.2.2.2" xref="S4.SS4.p5.6.m6.2.2.2.2.cmml">
         <mi id="S4.SS4.p5.6.m6.2.2.2.2.2" xref="S4.SS4.p5.6.m6.2.2.2.2.2.cmml">
          D
         </mi>
         <mo id="S4.SS4.p5.6.m6.2.2.2.2.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.6.m6.2.2.2.2.1.cmml">
          ​
         </mo>
         <mi id="S4.SS4.p5.6.m6.2.2.2.2.3" xref="S4.SS4.p5.6.m6.2.2.2.2.3.cmml">
          I
         </mi>
         <mo id="S4.SS4.p5.6.m6.2.2.2.2.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.6.m6.2.2.2.2.1.cmml">
          ​
         </mo>
         <msub id="S4.SS4.p5.6.m6.2.2.2.2.4" xref="S4.SS4.p5.6.m6.2.2.2.2.4.cmml">
          <mi id="S4.SS4.p5.6.m6.2.2.2.2.4.2" xref="S4.SS4.p5.6.m6.2.2.2.2.4.2.cmml">
           V
          </mi>
          <mrow id="S4.SS4.p5.6.m6.2.2.2.2.4.3" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.cmml">
           <mi id="S4.SS4.p5.6.m6.2.2.2.2.4.3.2" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.2.cmml">
            b
           </mi>
           <mo id="S4.SS4.p5.6.m6.2.2.2.2.4.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.6.m6.2.2.2.2.4.3.3" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.3.cmml">
            e
           </mi>
           <mo id="S4.SS4.p5.6.m6.2.2.2.2.4.3.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.6.m6.2.2.2.2.4.3.4" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.4.cmml">
            s
           </mi>
           <mo id="S4.SS4.p5.6.m6.2.2.2.2.4.3.1b" lspace="0em" rspace="0em" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.6.m6.2.2.2.2.4.3.5" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.5.cmml">
            t
           </mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.6.m6.2b">
        <apply id="S4.SS4.p5.6.m6.2.2.3.cmml" xref="S4.SS4.p5.6.m6.2.2.2">
         <csymbol cd="ambiguous" id="S4.SS4.p5.6.m6.2.2.3a.cmml" xref="S4.SS4.p5.6.m6.2.2.2.3">
          formulae-sequence
         </csymbol>
         <apply id="S4.SS4.p5.6.m6.1.1.1.1.cmml" xref="S4.SS4.p5.6.m6.1.1.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.6.m6.1.1.1.1.1.cmml" xref="S4.SS4.p5.6.m6.1.1.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS4.p5.6.m6.1.1.1.1.2.cmml" xref="S4.SS4.p5.6.m6.1.1.1.1.2">
           𝐬
          </ci>
          <ci id="S4.SS4.p5.6.m6.1.1.1.1.3.cmml" xref="S4.SS4.p5.6.m6.1.1.1.1.3">
           𝐷
          </ci>
         </apply>
         <apply id="S4.SS4.p5.6.m6.2.2.2.2.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2">
          <times id="S4.SS4.p5.6.m6.2.2.2.2.1.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.1">
          </times>
          <ci id="S4.SS4.p5.6.m6.2.2.2.2.2.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.2">
           𝐷
          </ci>
          <ci id="S4.SS4.p5.6.m6.2.2.2.2.3.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.3">
           𝐼
          </ci>
          <apply id="S4.SS4.p5.6.m6.2.2.2.2.4.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4">
           <csymbol cd="ambiguous" id="S4.SS4.p5.6.m6.2.2.2.2.4.1.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4">
            subscript
           </csymbol>
           <ci id="S4.SS4.p5.6.m6.2.2.2.2.4.2.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.2">
            𝑉
           </ci>
           <apply id="S4.SS4.p5.6.m6.2.2.2.2.4.3.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3">
            <times id="S4.SS4.p5.6.m6.2.2.2.2.4.3.1.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.1">
            </times>
            <ci id="S4.SS4.p5.6.m6.2.2.2.2.4.3.2.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.2">
             𝑏
            </ci>
            <ci id="S4.SS4.p5.6.m6.2.2.2.2.4.3.3.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.3">
             𝑒
            </ci>
            <ci id="S4.SS4.p5.6.m6.2.2.2.2.4.3.4.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.4">
             𝑠
            </ci>
            <ci id="S4.SS4.p5.6.m6.2.2.2.2.4.3.5.cmml" xref="S4.SS4.p5.6.m6.2.2.2.2.4.3.5">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.6.m6.2c">
        \mathbf{s}^{D}.{{DIV}_{best}}
       </annotation>
      </semantics>
     </math>
     represents the maintained best diversity value found at state
     <math alttext="\mathbf{s}^{D}" class="ltx_Math" display="inline" id="S4.SS4.p5.7.m7.1">
      <semantics id="S4.SS4.p5.7.m7.1a">
       <msup id="S4.SS4.p5.7.m7.1.1" xref="S4.SS4.p5.7.m7.1.1.cmml">
        <mi id="S4.SS4.p5.7.m7.1.1.2" xref="S4.SS4.p5.7.m7.1.1.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p5.7.m7.1.1.3" xref="S4.SS4.p5.7.m7.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.7.m7.1b">
        <apply id="S4.SS4.p5.7.m7.1.1.cmml" xref="S4.SS4.p5.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p5.7.m7.1.1.1.cmml" xref="S4.SS4.p5.7.m7.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p5.7.m7.1.1.2.cmml" xref="S4.SS4.p5.7.m7.1.1.2">
          𝐬
         </ci>
         <ci id="S4.SS4.p5.7.m7.1.1.3.cmml" xref="S4.SS4.p5.7.m7.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.7.m7.1c">
        \mathbf{s}^{D}
       </annotation>
      </semantics>
     </math>
     during the scanning according to Equation
     <a class="ltx_ref" href="#S4.E7" title="In 4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     . With this reward definition, the objective of the MDP, which is to maximize the cumulative rewards, aligns with the goal of discovering the greatest diversity among the suggestions.
To illustrate this alignment, consider the process as it moves through a sequence of states:
     <math alttext="\mathbf{s}^{D}_{1},\mathbf{s}^{D}_{2},...,\mathbf{s}^{D}_{N}" class="ltx_Math" display="inline" id="S4.SS4.p5.8.m8.4">
      <semantics id="S4.SS4.p5.8.m8.4a">
       <mrow id="S4.SS4.p5.8.m8.4.4.3" xref="S4.SS4.p5.8.m8.4.4.4.cmml">
        <msubsup id="S4.SS4.p5.8.m8.2.2.1.1" xref="S4.SS4.p5.8.m8.2.2.1.1.cmml">
         <mi id="S4.SS4.p5.8.m8.2.2.1.1.2.2" xref="S4.SS4.p5.8.m8.2.2.1.1.2.2.cmml">
          𝐬
         </mi>
         <mn id="S4.SS4.p5.8.m8.2.2.1.1.3" xref="S4.SS4.p5.8.m8.2.2.1.1.3.cmml">
          1
         </mn>
         <mi id="S4.SS4.p5.8.m8.2.2.1.1.2.3" xref="S4.SS4.p5.8.m8.2.2.1.1.2.3.cmml">
          D
         </mi>
        </msubsup>
        <mo id="S4.SS4.p5.8.m8.4.4.3.4" xref="S4.SS4.p5.8.m8.4.4.4.cmml">
         ,
        </mo>
        <msubsup id="S4.SS4.p5.8.m8.3.3.2.2" xref="S4.SS4.p5.8.m8.3.3.2.2.cmml">
         <mi id="S4.SS4.p5.8.m8.3.3.2.2.2.2" xref="S4.SS4.p5.8.m8.3.3.2.2.2.2.cmml">
          𝐬
         </mi>
         <mn id="S4.SS4.p5.8.m8.3.3.2.2.3" xref="S4.SS4.p5.8.m8.3.3.2.2.3.cmml">
          2
         </mn>
         <mi id="S4.SS4.p5.8.m8.3.3.2.2.2.3" xref="S4.SS4.p5.8.m8.3.3.2.2.2.3.cmml">
          D
         </mi>
        </msubsup>
        <mo id="S4.SS4.p5.8.m8.4.4.3.5" xref="S4.SS4.p5.8.m8.4.4.4.cmml">
         ,
        </mo>
        <mi id="S4.SS4.p5.8.m8.1.1" mathvariant="normal" xref="S4.SS4.p5.8.m8.1.1.cmml">
         …
        </mi>
        <mo id="S4.SS4.p5.8.m8.4.4.3.6" xref="S4.SS4.p5.8.m8.4.4.4.cmml">
         ,
        </mo>
        <msubsup id="S4.SS4.p5.8.m8.4.4.3.3" xref="S4.SS4.p5.8.m8.4.4.3.3.cmml">
         <mi id="S4.SS4.p5.8.m8.4.4.3.3.2.2" xref="S4.SS4.p5.8.m8.4.4.3.3.2.2.cmml">
          𝐬
         </mi>
         <mi id="S4.SS4.p5.8.m8.4.4.3.3.3" xref="S4.SS4.p5.8.m8.4.4.3.3.3.cmml">
          N
         </mi>
         <mi id="S4.SS4.p5.8.m8.4.4.3.3.2.3" xref="S4.SS4.p5.8.m8.4.4.3.3.2.3.cmml">
          D
         </mi>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.8.m8.4b">
        <list id="S4.SS4.p5.8.m8.4.4.4.cmml" xref="S4.SS4.p5.8.m8.4.4.3">
         <apply id="S4.SS4.p5.8.m8.2.2.1.1.cmml" xref="S4.SS4.p5.8.m8.2.2.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.8.m8.2.2.1.1.1.cmml" xref="S4.SS4.p5.8.m8.2.2.1.1">
           subscript
          </csymbol>
          <apply id="S4.SS4.p5.8.m8.2.2.1.1.2.cmml" xref="S4.SS4.p5.8.m8.2.2.1.1">
           <csymbol cd="ambiguous" id="S4.SS4.p5.8.m8.2.2.1.1.2.1.cmml" xref="S4.SS4.p5.8.m8.2.2.1.1">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.8.m8.2.2.1.1.2.2.cmml" xref="S4.SS4.p5.8.m8.2.2.1.1.2.2">
            𝐬
           </ci>
           <ci id="S4.SS4.p5.8.m8.2.2.1.1.2.3.cmml" xref="S4.SS4.p5.8.m8.2.2.1.1.2.3">
            𝐷
           </ci>
          </apply>
          <cn id="S4.SS4.p5.8.m8.2.2.1.1.3.cmml" type="integer" xref="S4.SS4.p5.8.m8.2.2.1.1.3">
           1
          </cn>
         </apply>
         <apply id="S4.SS4.p5.8.m8.3.3.2.2.cmml" xref="S4.SS4.p5.8.m8.3.3.2.2">
          <csymbol cd="ambiguous" id="S4.SS4.p5.8.m8.3.3.2.2.1.cmml" xref="S4.SS4.p5.8.m8.3.3.2.2">
           subscript
          </csymbol>
          <apply id="S4.SS4.p5.8.m8.3.3.2.2.2.cmml" xref="S4.SS4.p5.8.m8.3.3.2.2">
           <csymbol cd="ambiguous" id="S4.SS4.p5.8.m8.3.3.2.2.2.1.cmml" xref="S4.SS4.p5.8.m8.3.3.2.2">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.8.m8.3.3.2.2.2.2.cmml" xref="S4.SS4.p5.8.m8.3.3.2.2.2.2">
            𝐬
           </ci>
           <ci id="S4.SS4.p5.8.m8.3.3.2.2.2.3.cmml" xref="S4.SS4.p5.8.m8.3.3.2.2.2.3">
            𝐷
           </ci>
          </apply>
          <cn id="S4.SS4.p5.8.m8.3.3.2.2.3.cmml" type="integer" xref="S4.SS4.p5.8.m8.3.3.2.2.3">
           2
          </cn>
         </apply>
         <ci id="S4.SS4.p5.8.m8.1.1.cmml" xref="S4.SS4.p5.8.m8.1.1">
          …
         </ci>
         <apply id="S4.SS4.p5.8.m8.4.4.3.3.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3">
          <csymbol cd="ambiguous" id="S4.SS4.p5.8.m8.4.4.3.3.1.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3">
           subscript
          </csymbol>
          <apply id="S4.SS4.p5.8.m8.4.4.3.3.2.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3">
           <csymbol cd="ambiguous" id="S4.SS4.p5.8.m8.4.4.3.3.2.1.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.8.m8.4.4.3.3.2.2.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3.2.2">
            𝐬
           </ci>
           <ci id="S4.SS4.p5.8.m8.4.4.3.3.2.3.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3.2.3">
            𝐷
           </ci>
          </apply>
          <ci id="S4.SS4.p5.8.m8.4.4.3.3.3.cmml" xref="S4.SS4.p5.8.m8.4.4.3.3.3">
           𝑁
          </ci>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.8.m8.4c">
        \mathbf{s}^{D}_{1},\mathbf{s}^{D}_{2},...,\mathbf{s}^{D}_{N}
       </annotation>
      </semantics>
     </math>
     , ending at
     <math alttext="\mathbf{s}^{D}_{N}" class="ltx_Math" display="inline" id="S4.SS4.p5.9.m9.1">
      <semantics id="S4.SS4.p5.9.m9.1a">
       <msubsup id="S4.SS4.p5.9.m9.1.1" xref="S4.SS4.p5.9.m9.1.1.cmml">
        <mi id="S4.SS4.p5.9.m9.1.1.2.2" xref="S4.SS4.p5.9.m9.1.1.2.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p5.9.m9.1.1.3" xref="S4.SS4.p5.9.m9.1.1.3.cmml">
         N
        </mi>
        <mi id="S4.SS4.p5.9.m9.1.1.2.3" xref="S4.SS4.p5.9.m9.1.1.2.3.cmml">
         D
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.9.m9.1b">
        <apply id="S4.SS4.p5.9.m9.1.1.cmml" xref="S4.SS4.p5.9.m9.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p5.9.m9.1.1.1.cmml" xref="S4.SS4.p5.9.m9.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS4.p5.9.m9.1.1.2.cmml" xref="S4.SS4.p5.9.m9.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.9.m9.1.1.2.1.cmml" xref="S4.SS4.p5.9.m9.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS4.p5.9.m9.1.1.2.2.cmml" xref="S4.SS4.p5.9.m9.1.1.2.2">
           𝐬
          </ci>
          <ci id="S4.SS4.p5.9.m9.1.1.2.3.cmml" xref="S4.SS4.p5.9.m9.1.1.2.3">
           𝐷
          </ci>
         </apply>
         <ci id="S4.SS4.p5.9.m9.1.1.3.cmml" xref="S4.SS4.p5.9.m9.1.1.3">
          𝑁
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.9.m9.1c">
        \mathbf{s}^{D}_{N}
       </annotation>
      </semantics>
     </math>
     . We can denote the rewards received at these states, except for the termination state
     <math alttext="\mathbf{s}^{D}_{N}" class="ltx_Math" display="inline" id="S4.SS4.p5.10.m10.1">
      <semantics id="S4.SS4.p5.10.m10.1a">
       <msubsup id="S4.SS4.p5.10.m10.1.1" xref="S4.SS4.p5.10.m10.1.1.cmml">
        <mi id="S4.SS4.p5.10.m10.1.1.2.2" xref="S4.SS4.p5.10.m10.1.1.2.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p5.10.m10.1.1.3" xref="S4.SS4.p5.10.m10.1.1.3.cmml">
         N
        </mi>
        <mi id="S4.SS4.p5.10.m10.1.1.2.3" xref="S4.SS4.p5.10.m10.1.1.2.3.cmml">
         D
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.10.m10.1b">
        <apply id="S4.SS4.p5.10.m10.1.1.cmml" xref="S4.SS4.p5.10.m10.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p5.10.m10.1.1.1.cmml" xref="S4.SS4.p5.10.m10.1.1">
          subscript
         </csymbol>
         <apply id="S4.SS4.p5.10.m10.1.1.2.cmml" xref="S4.SS4.p5.10.m10.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.10.m10.1.1.2.1.cmml" xref="S4.SS4.p5.10.m10.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS4.p5.10.m10.1.1.2.2.cmml" xref="S4.SS4.p5.10.m10.1.1.2.2">
           𝐬
          </ci>
          <ci id="S4.SS4.p5.10.m10.1.1.2.3.cmml" xref="S4.SS4.p5.10.m10.1.1.2.3">
           𝐷
          </ci>
         </apply>
         <ci id="S4.SS4.p5.10.m10.1.1.3.cmml" xref="S4.SS4.p5.10.m10.1.1.3">
          𝑁
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.10.m10.1c">
        \mathbf{s}^{D}_{N}
       </annotation>
      </semantics>
     </math>
     , as
     <math alttext="r^{D}_{1},r^{D}_{2},...,r^{D}_{N-1}" class="ltx_Math" display="inline" id="S4.SS4.p5.11.m11.4">
      <semantics id="S4.SS4.p5.11.m11.4a">
       <mrow id="S4.SS4.p5.11.m11.4.4.3" xref="S4.SS4.p5.11.m11.4.4.4.cmml">
        <msubsup id="S4.SS4.p5.11.m11.2.2.1.1" xref="S4.SS4.p5.11.m11.2.2.1.1.cmml">
         <mi id="S4.SS4.p5.11.m11.2.2.1.1.2.2" xref="S4.SS4.p5.11.m11.2.2.1.1.2.2.cmml">
          r
         </mi>
         <mn id="S4.SS4.p5.11.m11.2.2.1.1.3" xref="S4.SS4.p5.11.m11.2.2.1.1.3.cmml">
          1
         </mn>
         <mi id="S4.SS4.p5.11.m11.2.2.1.1.2.3" xref="S4.SS4.p5.11.m11.2.2.1.1.2.3.cmml">
          D
         </mi>
        </msubsup>
        <mo id="S4.SS4.p5.11.m11.4.4.3.4" xref="S4.SS4.p5.11.m11.4.4.4.cmml">
         ,
        </mo>
        <msubsup id="S4.SS4.p5.11.m11.3.3.2.2" xref="S4.SS4.p5.11.m11.3.3.2.2.cmml">
         <mi id="S4.SS4.p5.11.m11.3.3.2.2.2.2" xref="S4.SS4.p5.11.m11.3.3.2.2.2.2.cmml">
          r
         </mi>
         <mn id="S4.SS4.p5.11.m11.3.3.2.2.3" xref="S4.SS4.p5.11.m11.3.3.2.2.3.cmml">
          2
         </mn>
         <mi id="S4.SS4.p5.11.m11.3.3.2.2.2.3" xref="S4.SS4.p5.11.m11.3.3.2.2.2.3.cmml">
          D
         </mi>
        </msubsup>
        <mo id="S4.SS4.p5.11.m11.4.4.3.5" xref="S4.SS4.p5.11.m11.4.4.4.cmml">
         ,
        </mo>
        <mi id="S4.SS4.p5.11.m11.1.1" mathvariant="normal" xref="S4.SS4.p5.11.m11.1.1.cmml">
         …
        </mi>
        <mo id="S4.SS4.p5.11.m11.4.4.3.6" xref="S4.SS4.p5.11.m11.4.4.4.cmml">
         ,
        </mo>
        <msubsup id="S4.SS4.p5.11.m11.4.4.3.3" xref="S4.SS4.p5.11.m11.4.4.3.3.cmml">
         <mi id="S4.SS4.p5.11.m11.4.4.3.3.2.2" xref="S4.SS4.p5.11.m11.4.4.3.3.2.2.cmml">
          r
         </mi>
         <mrow id="S4.SS4.p5.11.m11.4.4.3.3.3" xref="S4.SS4.p5.11.m11.4.4.3.3.3.cmml">
          <mi id="S4.SS4.p5.11.m11.4.4.3.3.3.2" xref="S4.SS4.p5.11.m11.4.4.3.3.3.2.cmml">
           N
          </mi>
          <mo id="S4.SS4.p5.11.m11.4.4.3.3.3.1" xref="S4.SS4.p5.11.m11.4.4.3.3.3.1.cmml">
           −
          </mo>
          <mn id="S4.SS4.p5.11.m11.4.4.3.3.3.3" xref="S4.SS4.p5.11.m11.4.4.3.3.3.3.cmml">
           1
          </mn>
         </mrow>
         <mi id="S4.SS4.p5.11.m11.4.4.3.3.2.3" xref="S4.SS4.p5.11.m11.4.4.3.3.2.3.cmml">
          D
         </mi>
        </msubsup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.11.m11.4b">
        <list id="S4.SS4.p5.11.m11.4.4.4.cmml" xref="S4.SS4.p5.11.m11.4.4.3">
         <apply id="S4.SS4.p5.11.m11.2.2.1.1.cmml" xref="S4.SS4.p5.11.m11.2.2.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.11.m11.2.2.1.1.1.cmml" xref="S4.SS4.p5.11.m11.2.2.1.1">
           subscript
          </csymbol>
          <apply id="S4.SS4.p5.11.m11.2.2.1.1.2.cmml" xref="S4.SS4.p5.11.m11.2.2.1.1">
           <csymbol cd="ambiguous" id="S4.SS4.p5.11.m11.2.2.1.1.2.1.cmml" xref="S4.SS4.p5.11.m11.2.2.1.1">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.11.m11.2.2.1.1.2.2.cmml" xref="S4.SS4.p5.11.m11.2.2.1.1.2.2">
            𝑟
           </ci>
           <ci id="S4.SS4.p5.11.m11.2.2.1.1.2.3.cmml" xref="S4.SS4.p5.11.m11.2.2.1.1.2.3">
            𝐷
           </ci>
          </apply>
          <cn id="S4.SS4.p5.11.m11.2.2.1.1.3.cmml" type="integer" xref="S4.SS4.p5.11.m11.2.2.1.1.3">
           1
          </cn>
         </apply>
         <apply id="S4.SS4.p5.11.m11.3.3.2.2.cmml" xref="S4.SS4.p5.11.m11.3.3.2.2">
          <csymbol cd="ambiguous" id="S4.SS4.p5.11.m11.3.3.2.2.1.cmml" xref="S4.SS4.p5.11.m11.3.3.2.2">
           subscript
          </csymbol>
          <apply id="S4.SS4.p5.11.m11.3.3.2.2.2.cmml" xref="S4.SS4.p5.11.m11.3.3.2.2">
           <csymbol cd="ambiguous" id="S4.SS4.p5.11.m11.3.3.2.2.2.1.cmml" xref="S4.SS4.p5.11.m11.3.3.2.2">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.11.m11.3.3.2.2.2.2.cmml" xref="S4.SS4.p5.11.m11.3.3.2.2.2.2">
            𝑟
           </ci>
           <ci id="S4.SS4.p5.11.m11.3.3.2.2.2.3.cmml" xref="S4.SS4.p5.11.m11.3.3.2.2.2.3">
            𝐷
           </ci>
          </apply>
          <cn id="S4.SS4.p5.11.m11.3.3.2.2.3.cmml" type="integer" xref="S4.SS4.p5.11.m11.3.3.2.2.3">
           2
          </cn>
         </apply>
         <ci id="S4.SS4.p5.11.m11.1.1.cmml" xref="S4.SS4.p5.11.m11.1.1">
          …
         </ci>
         <apply id="S4.SS4.p5.11.m11.4.4.3.3.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3">
          <csymbol cd="ambiguous" id="S4.SS4.p5.11.m11.4.4.3.3.1.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3">
           subscript
          </csymbol>
          <apply id="S4.SS4.p5.11.m11.4.4.3.3.2.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3">
           <csymbol cd="ambiguous" id="S4.SS4.p5.11.m11.4.4.3.3.2.1.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3">
            superscript
           </csymbol>
           <ci id="S4.SS4.p5.11.m11.4.4.3.3.2.2.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3.2.2">
            𝑟
           </ci>
           <ci id="S4.SS4.p5.11.m11.4.4.3.3.2.3.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3.2.3">
            𝐷
           </ci>
          </apply>
          <apply id="S4.SS4.p5.11.m11.4.4.3.3.3.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3.3">
           <minus id="S4.SS4.p5.11.m11.4.4.3.3.3.1.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3.3.1">
           </minus>
           <ci id="S4.SS4.p5.11.m11.4.4.3.3.3.2.cmml" xref="S4.SS4.p5.11.m11.4.4.3.3.3.2">
            𝑁
           </ci>
           <cn id="S4.SS4.p5.11.m11.4.4.3.3.3.3.cmml" type="integer" xref="S4.SS4.p5.11.m11.4.4.3.3.3.3">
            1
           </cn>
          </apply>
         </apply>
        </list>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.11.m11.4c">
        r^{D}_{1},r^{D}_{2},...,r^{D}_{N-1}
       </annotation>
      </semantics>
     </math>
     . When future rewards are not discounted, we have:
    </p>
    <table class="ltx_equationgroup ltx_eqn_table" id="S4.E8">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8X">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2">
        <span class="ltx_tag ltx_tag_equationgroup ltx_align_left">
         (8)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\sum_{t=2}^{N}r^{D}_{t-1}" class="ltx_Math" display="inline" id="S4.E8X.2.1.1.m1.1">
         <semantics id="S4.E8X.2.1.1.m1.1a">
          <mrow id="S4.E8X.2.1.1.m1.1.1" xref="S4.E8X.2.1.1.m1.1.1.cmml">
           <mstyle displaystyle="true" id="S4.E8X.2.1.1.m1.1.1.1" xref="S4.E8X.2.1.1.m1.1.1.1.cmml">
            <munderover id="S4.E8X.2.1.1.m1.1.1.1a" xref="S4.E8X.2.1.1.m1.1.1.1.cmml">
             <mo id="S4.E8X.2.1.1.m1.1.1.1.2.2" movablelimits="false" xref="S4.E8X.2.1.1.m1.1.1.1.2.2.cmml">
              ∑
             </mo>
             <mrow id="S4.E8X.2.1.1.m1.1.1.1.2.3" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.cmml">
              <mi id="S4.E8X.2.1.1.m1.1.1.1.2.3.2" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.2.cmml">
               t
              </mi>
              <mo id="S4.E8X.2.1.1.m1.1.1.1.2.3.1" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.1.cmml">
               =
              </mo>
              <mn id="S4.E8X.2.1.1.m1.1.1.1.2.3.3" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.3.cmml">
               2
              </mn>
             </mrow>
             <mi id="S4.E8X.2.1.1.m1.1.1.1.3" xref="S4.E8X.2.1.1.m1.1.1.1.3.cmml">
              N
             </mi>
            </munderover>
           </mstyle>
           <msubsup id="S4.E8X.2.1.1.m1.1.1.2" xref="S4.E8X.2.1.1.m1.1.1.2.cmml">
            <mi id="S4.E8X.2.1.1.m1.1.1.2.2.2" xref="S4.E8X.2.1.1.m1.1.1.2.2.2.cmml">
             r
            </mi>
            <mrow id="S4.E8X.2.1.1.m1.1.1.2.3" xref="S4.E8X.2.1.1.m1.1.1.2.3.cmml">
             <mi id="S4.E8X.2.1.1.m1.1.1.2.3.2" xref="S4.E8X.2.1.1.m1.1.1.2.3.2.cmml">
              t
             </mi>
             <mo id="S4.E8X.2.1.1.m1.1.1.2.3.1" xref="S4.E8X.2.1.1.m1.1.1.2.3.1.cmml">
              −
             </mo>
             <mn id="S4.E8X.2.1.1.m1.1.1.2.3.3" xref="S4.E8X.2.1.1.m1.1.1.2.3.3.cmml">
              1
             </mn>
            </mrow>
            <mi id="S4.E8X.2.1.1.m1.1.1.2.2.3" xref="S4.E8X.2.1.1.m1.1.1.2.2.3.cmml">
             D
            </mi>
           </msubsup>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E8X.2.1.1.m1.1b">
           <apply id="S4.E8X.2.1.1.m1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1">
            <apply id="S4.E8X.2.1.1.m1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1">
             <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1">
              superscript
             </csymbol>
             <apply id="S4.E8X.2.1.1.m1.1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1">
              <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.1.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1">
               subscript
              </csymbol>
              <sum id="S4.E8X.2.1.1.m1.1.1.1.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.2.2">
              </sum>
              <apply id="S4.E8X.2.1.1.m1.1.1.1.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.2.3">
               <eq id="S4.E8X.2.1.1.m1.1.1.1.2.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.1">
               </eq>
               <ci id="S4.E8X.2.1.1.m1.1.1.1.2.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.2">
                𝑡
               </ci>
               <cn id="S4.E8X.2.1.1.m1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E8X.2.1.1.m1.1.1.1.2.3.3">
                2
               </cn>
              </apply>
             </apply>
             <ci id="S4.E8X.2.1.1.m1.1.1.1.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.1.3">
              𝑁
             </ci>
            </apply>
            <apply id="S4.E8X.2.1.1.m1.1.1.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.2">
             <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.2">
              subscript
             </csymbol>
             <apply id="S4.E8X.2.1.1.m1.1.1.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.2">
              <csymbol cd="ambiguous" id="S4.E8X.2.1.1.m1.1.1.2.2.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.2">
               superscript
              </csymbol>
              <ci id="S4.E8X.2.1.1.m1.1.1.2.2.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.2.2.2">
               𝑟
              </ci>
              <ci id="S4.E8X.2.1.1.m1.1.1.2.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.2.2.3">
               𝐷
              </ci>
             </apply>
             <apply id="S4.E8X.2.1.1.m1.1.1.2.3.cmml" xref="S4.E8X.2.1.1.m1.1.1.2.3">
              <minus id="S4.E8X.2.1.1.m1.1.1.2.3.1.cmml" xref="S4.E8X.2.1.1.m1.1.1.2.3.1">
              </minus>
              <ci id="S4.E8X.2.1.1.m1.1.1.2.3.2.cmml" xref="S4.E8X.2.1.1.m1.1.1.2.3.2">
               𝑡
              </ci>
              <cn id="S4.E8X.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S4.E8X.2.1.1.m1.1.1.2.3.3">
               1
              </cn>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E8X.2.1.1.m1.1c">
           \displaystyle\sum_{t=2}^{N}r^{D}_{t-1}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\sum_{t=2}^{N}(\mathbf{s}_{t}^{D}.{{DIV}_{best}}-\mathbf{s}_{t-1}^{D}.{{DIV}_{best}})" class="ltx_math_unparsed" display="inline" id="S4.E8X.3.2.2.m1.1">
         <semantics id="S4.E8X.3.2.2.m1.1a">
          <mrow id="S4.E8X.3.2.2.m1.1b">
           <mo id="S4.E8X.3.2.2.m1.1.1">
            =
           </mo>
           <mstyle displaystyle="true" id="S4.E8X.3.2.2.m1.1.2">
            <munderover id="S4.E8X.3.2.2.m1.1.2a">
             <mo id="S4.E8X.3.2.2.m1.1.2.2.2" movablelimits="false">
              ∑
             </mo>
             <mrow id="S4.E8X.3.2.2.m1.1.2.2.3">
              <mi id="S4.E8X.3.2.2.m1.1.2.2.3.2">
               t
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.2.2.3.1">
               =
              </mo>
              <mn id="S4.E8X.3.2.2.m1.1.2.2.3.3">
               2
              </mn>
             </mrow>
             <mi id="S4.E8X.3.2.2.m1.1.2.3">
              N
             </mi>
            </munderover>
           </mstyle>
           <mrow id="S4.E8X.3.2.2.m1.1.3">
            <mo id="S4.E8X.3.2.2.m1.1.3.1" stretchy="false">
             (
            </mo>
            <msubsup id="S4.E8X.3.2.2.m1.1.3.2">
             <mi id="S4.E8X.3.2.2.m1.1.3.2.2.2">
              𝐬
             </mi>
             <mi id="S4.E8X.3.2.2.m1.1.3.2.2.3">
              t
             </mi>
             <mi id="S4.E8X.3.2.2.m1.1.3.2.3">
              D
             </mi>
            </msubsup>
            <mo id="S4.E8X.3.2.2.m1.1.3.3" lspace="0em" rspace="0.167em">
             .
            </mo>
            <mi id="S4.E8X.3.2.2.m1.1.3.4">
             D
            </mi>
            <mi id="S4.E8X.3.2.2.m1.1.3.5">
             I
            </mi>
            <msub id="S4.E8X.3.2.2.m1.1.3.6">
             <mi id="S4.E8X.3.2.2.m1.1.3.6.2">
              V
             </mi>
             <mrow id="S4.E8X.3.2.2.m1.1.3.6.3">
              <mi id="S4.E8X.3.2.2.m1.1.3.6.3.2">
               b
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.6.3.1" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E8X.3.2.2.m1.1.3.6.3.3">
               e
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.6.3.1a" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E8X.3.2.2.m1.1.3.6.3.4">
               s
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.6.3.1b" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E8X.3.2.2.m1.1.3.6.3.5">
               t
              </mi>
             </mrow>
            </msub>
            <mo id="S4.E8X.3.2.2.m1.1.3.7">
             −
            </mo>
            <msubsup id="S4.E8X.3.2.2.m1.1.3.8">
             <mi id="S4.E8X.3.2.2.m1.1.3.8.2.2">
              𝐬
             </mi>
             <mrow id="S4.E8X.3.2.2.m1.1.3.8.2.3">
              <mi id="S4.E8X.3.2.2.m1.1.3.8.2.3.2">
               t
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.8.2.3.1">
               −
              </mo>
              <mn id="S4.E8X.3.2.2.m1.1.3.8.2.3.3">
               1
              </mn>
             </mrow>
             <mi id="S4.E8X.3.2.2.m1.1.3.8.3">
              D
             </mi>
            </msubsup>
            <mo id="S4.E8X.3.2.2.m1.1.3.9" lspace="0em" rspace="0.167em">
             .
            </mo>
            <mi id="S4.E8X.3.2.2.m1.1.3.10">
             D
            </mi>
            <mi id="S4.E8X.3.2.2.m1.1.3.11">
             I
            </mi>
            <msub id="S4.E8X.3.2.2.m1.1.3.12">
             <mi id="S4.E8X.3.2.2.m1.1.3.12.2">
              V
             </mi>
             <mrow id="S4.E8X.3.2.2.m1.1.3.12.3">
              <mi id="S4.E8X.3.2.2.m1.1.3.12.3.2">
               b
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.12.3.1" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E8X.3.2.2.m1.1.3.12.3.3">
               e
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.12.3.1a" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E8X.3.2.2.m1.1.3.12.3.4">
               s
              </mi>
              <mo id="S4.E8X.3.2.2.m1.1.3.12.3.1b" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E8X.3.2.2.m1.1.3.12.3.5">
               t
              </mi>
             </mrow>
            </msub>
            <mo id="S4.E8X.3.2.2.m1.1.3.13" stretchy="false">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex" id="S4.E8X.3.2.2.m1.1c">
           \displaystyle=\sum_{t=2}^{N}(\mathbf{s}_{t}^{D}.{{DIV}_{best}}-\mathbf{s}_{t-1}^{D}.{{DIV}_{best}})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E8Xa">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\mathbf{s}_{N}^{D}.{{DIV}_{best}}-\mathbf{s}_{1}^{D}.{{DIV}_{best}}," class="ltx_Math" display="inline" id="S4.E8Xa.2.1.1.m1.1">
         <semantics id="S4.E8Xa.2.1.1.m1.1a">
          <mrow id="S4.E8Xa.2.1.1.m1.1.1.1">
           <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.4.cmml">
            <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml">
             <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">
             </mi>
             <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml">
              =
             </mo>
             <msubsup id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml">
               𝐬
              </mi>
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.3.cmml">
               N
              </mi>
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml">
               D
              </mi>
             </msubsup>
            </mrow>
            <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.4" lspace="0em" rspace="0.167em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.4a.cmml">
             .
            </mo>
            <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.cmml">
             <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml">
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml">
               D
              </mi>
              <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.1" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml">
               ​
              </mo>
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml">
               I
              </mi>
              <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.1a" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml">
               ​
              </mo>
              <msub id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.cmml">
               <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.2.cmml">
                V
               </mi>
               <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.cmml">
                <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.2.cmml">
                 b
                </mi>
                <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1.cmml">
                 ​
                </mo>
                <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.3.cmml">
                 e
                </mi>
                <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1a" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1.cmml">
                 ​
                </mo>
                <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.4" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.4.cmml">
                 s
                </mi>
                <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1b" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1.cmml">
                 ​
                </mo>
                <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.5" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.5.cmml">
                 t
                </mi>
               </mrow>
              </msub>
             </mrow>
             <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.1" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml">
              −
             </mo>
             <msubsup id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml">
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml">
               𝐬
              </mi>
              <mn id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.cmml">
               1
              </mn>
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.3.cmml">
               D
              </mi>
             </msubsup>
            </mrow>
            <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.5" lspace="0em" rspace="0.167em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.4a.cmml">
             .
            </mo>
            <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.cmml">
             <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml">
              D
             </mi>
             <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.1" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml">
              ​
             </mo>
             <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml">
              I
             </mi>
             <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.1a" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml">
              ​
             </mo>
             <msub id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml">
              <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.2.cmml">
               V
              </mi>
              <mrow id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.cmml">
               <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.2" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.2.cmml">
                b
               </mi>
               <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.3" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.3.cmml">
                e
               </mi>
               <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1a" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.4" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.4.cmml">
                s
               </mi>
               <mo id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1b" lspace="0em" rspace="0em" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1.cmml">
                ​
               </mo>
               <mi id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.5" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.5.cmml">
                t
               </mi>
              </mrow>
             </msub>
            </mrow>
           </mrow>
           <mo id="S4.E8Xa.2.1.1.m1.1.1.1.2">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E8Xa.2.1.1.m1.1b">
           <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.4.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3">
            <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.4a.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.4">
             formulae-sequence
            </csymbol>
            <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1">
             <eq id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.1">
             </eq>
             <csymbol cd="latexml" id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.2">
              absent
             </csymbol>
             <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3">
               superscript
              </csymbol>
              <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.2">
                𝐬
               </ci>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.2.3">
                𝑁
               </ci>
              </apply>
              <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.1.1.3.3">
               𝐷
              </ci>
             </apply>
            </apply>
            <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2">
             <minus id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.1">
             </minus>
             <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2">
              <times id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.1">
              </times>
              <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.2">
               𝐷
              </ci>
              <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.3">
               𝐼
              </ci>
              <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4">
               <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4">
                subscript
               </csymbol>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.2">
                𝑉
               </ci>
               <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3">
                <times id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.1">
                </times>
                <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.2">
                 𝑏
                </ci>
                <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.3">
                 𝑒
                </ci>
                <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.4.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.4">
                 𝑠
                </ci>
                <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.5.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.2.4.3.5">
                 𝑡
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3">
              <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3">
               superscript
              </csymbol>
              <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3">
               <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3">
                subscript
               </csymbol>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.2">
                𝐬
               </ci>
               <cn id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3.cmml" type="integer" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.2.3">
                1
               </cn>
              </apply>
              <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.2.2.3.3">
               𝐷
              </ci>
             </apply>
            </apply>
            <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3">
             <times id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.1">
             </times>
             <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.2">
              𝐷
             </ci>
             <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.3">
              𝐼
             </ci>
             <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4">
              <csymbol cd="ambiguous" id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4">
               subscript
              </csymbol>
              <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.2">
               𝑉
              </ci>
              <apply id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3">
               <times id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.1">
               </times>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.2.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.2">
                𝑏
               </ci>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.3.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.3">
                𝑒
               </ci>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.4.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.4">
                𝑠
               </ci>
               <ci id="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.5.cmml" xref="S4.E8Xa.2.1.1.m1.1.1.1.1.3.3.4.3.5">
                𝑡
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E8Xa.2.1.1.m1.1c">
           \displaystyle=\mathbf{s}_{N}^{D}.{{DIV}_{best}}-\mathbf{s}_{1}^{D}.{{DIV}_{best}},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS4.p5.13">
     where
     <math alttext="\mathbf{s}_{N}^{D}.{{DIV}_{best}}" class="ltx_Math" display="inline" id="S4.SS4.p5.12.m1.2">
      <semantics id="S4.SS4.p5.12.m1.2a">
       <mrow id="S4.SS4.p5.12.m1.2.2.2" xref="S4.SS4.p5.12.m1.2.2.3.cmml">
        <msubsup id="S4.SS4.p5.12.m1.1.1.1.1" xref="S4.SS4.p5.12.m1.1.1.1.1.cmml">
         <mi id="S4.SS4.p5.12.m1.1.1.1.1.2.2" xref="S4.SS4.p5.12.m1.1.1.1.1.2.2.cmml">
          𝐬
         </mi>
         <mi id="S4.SS4.p5.12.m1.1.1.1.1.2.3" xref="S4.SS4.p5.12.m1.1.1.1.1.2.3.cmml">
          N
         </mi>
         <mi id="S4.SS4.p5.12.m1.1.1.1.1.3" xref="S4.SS4.p5.12.m1.1.1.1.1.3.cmml">
          D
         </mi>
        </msubsup>
        <mo id="S4.SS4.p5.12.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="S4.SS4.p5.12.m1.2.2.3a.cmml">
         .
        </mo>
        <mrow id="S4.SS4.p5.12.m1.2.2.2.2" xref="S4.SS4.p5.12.m1.2.2.2.2.cmml">
         <mi id="S4.SS4.p5.12.m1.2.2.2.2.2" xref="S4.SS4.p5.12.m1.2.2.2.2.2.cmml">
          D
         </mi>
         <mo id="S4.SS4.p5.12.m1.2.2.2.2.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.12.m1.2.2.2.2.1.cmml">
          ​
         </mo>
         <mi id="S4.SS4.p5.12.m1.2.2.2.2.3" xref="S4.SS4.p5.12.m1.2.2.2.2.3.cmml">
          I
         </mi>
         <mo id="S4.SS4.p5.12.m1.2.2.2.2.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.12.m1.2.2.2.2.1.cmml">
          ​
         </mo>
         <msub id="S4.SS4.p5.12.m1.2.2.2.2.4" xref="S4.SS4.p5.12.m1.2.2.2.2.4.cmml">
          <mi id="S4.SS4.p5.12.m1.2.2.2.2.4.2" xref="S4.SS4.p5.12.m1.2.2.2.2.4.2.cmml">
           V
          </mi>
          <mrow id="S4.SS4.p5.12.m1.2.2.2.2.4.3" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.cmml">
           <mi id="S4.SS4.p5.12.m1.2.2.2.2.4.3.2" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.2.cmml">
            b
           </mi>
           <mo id="S4.SS4.p5.12.m1.2.2.2.2.4.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.12.m1.2.2.2.2.4.3.3" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.3.cmml">
            e
           </mi>
           <mo id="S4.SS4.p5.12.m1.2.2.2.2.4.3.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.12.m1.2.2.2.2.4.3.4" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.4.cmml">
            s
           </mi>
           <mo id="S4.SS4.p5.12.m1.2.2.2.2.4.3.1b" lspace="0em" rspace="0em" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.12.m1.2.2.2.2.4.3.5" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.5.cmml">
            t
           </mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.12.m1.2b">
        <apply id="S4.SS4.p5.12.m1.2.2.3.cmml" xref="S4.SS4.p5.12.m1.2.2.2">
         <csymbol cd="ambiguous" id="S4.SS4.p5.12.m1.2.2.3a.cmml" xref="S4.SS4.p5.12.m1.2.2.2.3">
          formulae-sequence
         </csymbol>
         <apply id="S4.SS4.p5.12.m1.1.1.1.1.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.12.m1.1.1.1.1.1.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS4.p5.12.m1.1.1.1.1.2.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS4.p5.12.m1.1.1.1.1.2.1.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS4.p5.12.m1.1.1.1.1.2.2.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1.2.2">
            𝐬
           </ci>
           <ci id="S4.SS4.p5.12.m1.1.1.1.1.2.3.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1.2.3">
            𝑁
           </ci>
          </apply>
          <ci id="S4.SS4.p5.12.m1.1.1.1.1.3.cmml" xref="S4.SS4.p5.12.m1.1.1.1.1.3">
           𝐷
          </ci>
         </apply>
         <apply id="S4.SS4.p5.12.m1.2.2.2.2.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2">
          <times id="S4.SS4.p5.12.m1.2.2.2.2.1.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.1">
          </times>
          <ci id="S4.SS4.p5.12.m1.2.2.2.2.2.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.2">
           𝐷
          </ci>
          <ci id="S4.SS4.p5.12.m1.2.2.2.2.3.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.3">
           𝐼
          </ci>
          <apply id="S4.SS4.p5.12.m1.2.2.2.2.4.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4">
           <csymbol cd="ambiguous" id="S4.SS4.p5.12.m1.2.2.2.2.4.1.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4">
            subscript
           </csymbol>
           <ci id="S4.SS4.p5.12.m1.2.2.2.2.4.2.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.2">
            𝑉
           </ci>
           <apply id="S4.SS4.p5.12.m1.2.2.2.2.4.3.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3">
            <times id="S4.SS4.p5.12.m1.2.2.2.2.4.3.1.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.1">
            </times>
            <ci id="S4.SS4.p5.12.m1.2.2.2.2.4.3.2.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.2">
             𝑏
            </ci>
            <ci id="S4.SS4.p5.12.m1.2.2.2.2.4.3.3.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.3">
             𝑒
            </ci>
            <ci id="S4.SS4.p5.12.m1.2.2.2.2.4.3.4.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.4">
             𝑠
            </ci>
            <ci id="S4.SS4.p5.12.m1.2.2.2.2.4.3.5.cmml" xref="S4.SS4.p5.12.m1.2.2.2.2.4.3.5">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.12.m1.2c">
        \mathbf{s}_{N}^{D}.{{DIV}_{best}}
       </annotation>
      </semantics>
     </math>
     corresponds to the highest diversity value found during the scanning process, and
     <math alttext="\mathbf{s}_{1}^{D}.{{DIV}_{best}}" class="ltx_Math" display="inline" id="S4.SS4.p5.13.m2.2">
      <semantics id="S4.SS4.p5.13.m2.2a">
       <mrow id="S4.SS4.p5.13.m2.2.2.2" xref="S4.SS4.p5.13.m2.2.2.3.cmml">
        <msubsup id="S4.SS4.p5.13.m2.1.1.1.1" xref="S4.SS4.p5.13.m2.1.1.1.1.cmml">
         <mi id="S4.SS4.p5.13.m2.1.1.1.1.2.2" xref="S4.SS4.p5.13.m2.1.1.1.1.2.2.cmml">
          𝐬
         </mi>
         <mn id="S4.SS4.p5.13.m2.1.1.1.1.2.3" xref="S4.SS4.p5.13.m2.1.1.1.1.2.3.cmml">
          1
         </mn>
         <mi id="S4.SS4.p5.13.m2.1.1.1.1.3" xref="S4.SS4.p5.13.m2.1.1.1.1.3.cmml">
          D
         </mi>
        </msubsup>
        <mo id="S4.SS4.p5.13.m2.2.2.2.3" lspace="0em" rspace="0.167em" xref="S4.SS4.p5.13.m2.2.2.3a.cmml">
         .
        </mo>
        <mrow id="S4.SS4.p5.13.m2.2.2.2.2" xref="S4.SS4.p5.13.m2.2.2.2.2.cmml">
         <mi id="S4.SS4.p5.13.m2.2.2.2.2.2" xref="S4.SS4.p5.13.m2.2.2.2.2.2.cmml">
          D
         </mi>
         <mo id="S4.SS4.p5.13.m2.2.2.2.2.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.13.m2.2.2.2.2.1.cmml">
          ​
         </mo>
         <mi id="S4.SS4.p5.13.m2.2.2.2.2.3" xref="S4.SS4.p5.13.m2.2.2.2.2.3.cmml">
          I
         </mi>
         <mo id="S4.SS4.p5.13.m2.2.2.2.2.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.13.m2.2.2.2.2.1.cmml">
          ​
         </mo>
         <msub id="S4.SS4.p5.13.m2.2.2.2.2.4" xref="S4.SS4.p5.13.m2.2.2.2.2.4.cmml">
          <mi id="S4.SS4.p5.13.m2.2.2.2.2.4.2" xref="S4.SS4.p5.13.m2.2.2.2.2.4.2.cmml">
           V
          </mi>
          <mrow id="S4.SS4.p5.13.m2.2.2.2.2.4.3" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.cmml">
           <mi id="S4.SS4.p5.13.m2.2.2.2.2.4.3.2" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.2.cmml">
            b
           </mi>
           <mo id="S4.SS4.p5.13.m2.2.2.2.2.4.3.1" lspace="0em" rspace="0em" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.13.m2.2.2.2.2.4.3.3" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.3.cmml">
            e
           </mi>
           <mo id="S4.SS4.p5.13.m2.2.2.2.2.4.3.1a" lspace="0em" rspace="0em" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.13.m2.2.2.2.2.4.3.4" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.4.cmml">
            s
           </mi>
           <mo id="S4.SS4.p5.13.m2.2.2.2.2.4.3.1b" lspace="0em" rspace="0em" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="S4.SS4.p5.13.m2.2.2.2.2.4.3.5" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.5.cmml">
            t
           </mi>
          </mrow>
         </msub>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p5.13.m2.2b">
        <apply id="S4.SS4.p5.13.m2.2.2.3.cmml" xref="S4.SS4.p5.13.m2.2.2.2">
         <csymbol cd="ambiguous" id="S4.SS4.p5.13.m2.2.2.3a.cmml" xref="S4.SS4.p5.13.m2.2.2.2.3">
          formulae-sequence
         </csymbol>
         <apply id="S4.SS4.p5.13.m2.1.1.1.1.cmml" xref="S4.SS4.p5.13.m2.1.1.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p5.13.m2.1.1.1.1.1.cmml" xref="S4.SS4.p5.13.m2.1.1.1.1">
           superscript
          </csymbol>
          <apply id="S4.SS4.p5.13.m2.1.1.1.1.2.cmml" xref="S4.SS4.p5.13.m2.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS4.p5.13.m2.1.1.1.1.2.1.cmml" xref="S4.SS4.p5.13.m2.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS4.p5.13.m2.1.1.1.1.2.2.cmml" xref="S4.SS4.p5.13.m2.1.1.1.1.2.2">
            𝐬
           </ci>
           <cn id="S4.SS4.p5.13.m2.1.1.1.1.2.3.cmml" type="integer" xref="S4.SS4.p5.13.m2.1.1.1.1.2.3">
            1
           </cn>
          </apply>
          <ci id="S4.SS4.p5.13.m2.1.1.1.1.3.cmml" xref="S4.SS4.p5.13.m2.1.1.1.1.3">
           𝐷
          </ci>
         </apply>
         <apply id="S4.SS4.p5.13.m2.2.2.2.2.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2">
          <times id="S4.SS4.p5.13.m2.2.2.2.2.1.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.1">
          </times>
          <ci id="S4.SS4.p5.13.m2.2.2.2.2.2.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.2">
           𝐷
          </ci>
          <ci id="S4.SS4.p5.13.m2.2.2.2.2.3.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.3">
           𝐼
          </ci>
          <apply id="S4.SS4.p5.13.m2.2.2.2.2.4.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4">
           <csymbol cd="ambiguous" id="S4.SS4.p5.13.m2.2.2.2.2.4.1.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4">
            subscript
           </csymbol>
           <ci id="S4.SS4.p5.13.m2.2.2.2.2.4.2.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.2">
            𝑉
           </ci>
           <apply id="S4.SS4.p5.13.m2.2.2.2.2.4.3.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3">
            <times id="S4.SS4.p5.13.m2.2.2.2.2.4.3.1.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.1">
            </times>
            <ci id="S4.SS4.p5.13.m2.2.2.2.2.4.3.2.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.2">
             𝑏
            </ci>
            <ci id="S4.SS4.p5.13.m2.2.2.2.2.4.3.3.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.3">
             𝑒
            </ci>
            <ci id="S4.SS4.p5.13.m2.2.2.2.2.4.3.4.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.4">
             𝑠
            </ci>
            <ci id="S4.SS4.p5.13.m2.2.2.2.2.4.3.5.cmml" xref="S4.SS4.p5.13.m2.2.2.2.2.4.3.5">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p5.13.m2.2c">
        \mathbf{s}_{1}^{D}.{{DIV}_{best}}
       </annotation>
      </semantics>
     </math>
     represents the initial diversity value, which remains constant. Consequently, maximizing the cumulative rewards is equivalent to maximizing the diversity that can be discovered.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS4.p6">
    <p class="ltx_p" id="S4.SS4.p6.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS4.p6.1.1">
      Learning Policies of Agent-I and Agent-D.
     </span>
     We discuss the learning process of the two agents.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p7">
    <p class="ltx_p" id="S4.SS4.p7.5">
     For Agent-I, to train the PolicyNet, which involves two stages: (1) warm-start stage and (2) training stage. In (1), we study the Supervised Fine-Tuning (SFT), which equips the LLM with the basic abilities to generate suggestions, where the two towers of the PolicyNet are trained using a multi-task learning approach (ISA, ISG, and ISM) according to Equation
     <a class="ltx_ref" href="#S4.E4" title="In 4.3.1. RewardNet ‣ 4.3. Agent-I: Generating Intentional Candidate Suggestions ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , which allows them to learn from different related tasks simultaneously. In (2), we utilize the PPO algorithm
     <cite class="ltx_cite ltx_citemacro_citep">
      (Schulman et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib38" title="">
       2017
      </a>
      )
     </cite>
     to fine-tune the SFT model for achieving the intentionality, where the environment is modeled as a bandit setting, i.e., when a random query image is presented, the model generates a suggestion in response to the image, and ends the episode. The loss contains the following components: i) Following the output suggestions (denoted by
     <math alttext="&lt;S_{1},S_{2},...,S_{K}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS4.p7.1.m1.1">
      <semantics id="S4.SS4.p7.1.m1.1a">
       <mrow id="S4.SS4.p7.1.m1.1b">
        <mo id="S4.SS4.p7.1.m1.1.2">
         &lt;
        </mo>
        <msub id="S4.SS4.p7.1.m1.1.3">
         <mi id="S4.SS4.p7.1.m1.1.3.2">
          S
         </mi>
         <mn id="S4.SS4.p7.1.m1.1.3.3">
          1
         </mn>
        </msub>
        <mo id="S4.SS4.p7.1.m1.1.4">
         ,
        </mo>
        <msub id="S4.SS4.p7.1.m1.1.5">
         <mi id="S4.SS4.p7.1.m1.1.5.2">
          S
         </mi>
         <mn id="S4.SS4.p7.1.m1.1.5.3">
          2
         </mn>
        </msub>
        <mo id="S4.SS4.p7.1.m1.1.6">
         ,
        </mo>
        <mi id="S4.SS4.p7.1.m1.1.1" mathvariant="normal">
         …
        </mi>
        <mo id="S4.SS4.p7.1.m1.1.7">
         ,
        </mo>
        <msub id="S4.SS4.p7.1.m1.1.8">
         <mi id="S4.SS4.p7.1.m1.1.8.2">
          S
         </mi>
         <mi id="S4.SS4.p7.1.m1.1.8.3">
          K
         </mi>
        </msub>
        <mo id="S4.SS4.p7.1.m1.1.9">
         &gt;
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.1.m1.1c">
        &lt;S_{1},S_{2},...,S_{K}&gt;
       </annotation>
      </semantics>
     </math>
     ) by Agent-D, the environment calculates a reward
     <math alttext="r^{I}" class="ltx_Math" display="inline" id="S4.SS4.p7.2.m2.1">
      <semantics id="S4.SS4.p7.2.m2.1a">
       <msup id="S4.SS4.p7.2.m2.1.1" xref="S4.SS4.p7.2.m2.1.1.cmml">
        <mi id="S4.SS4.p7.2.m2.1.1.2" xref="S4.SS4.p7.2.m2.1.1.2.cmml">
         r
        </mi>
        <mi id="S4.SS4.p7.2.m2.1.1.3" xref="S4.SS4.p7.2.m2.1.1.3.cmml">
         I
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.2.m2.1b">
        <apply id="S4.SS4.p7.2.m2.1.1.cmml" xref="S4.SS4.p7.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p7.2.m2.1.1.1.cmml" xref="S4.SS4.p7.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p7.2.m2.1.1.2.cmml" xref="S4.SS4.p7.2.m2.1.1.2">
          𝑟
         </ci>
         <ci id="S4.SS4.p7.2.m2.1.1.3.cmml" xref="S4.SS4.p7.2.m2.1.1.3">
          𝐼
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.2.m2.1c">
        r^{I}
       </annotation>
      </semantics>
     </math>
     via the RewardNet according to Equation
     <a class="ltx_ref" href="#S4.E6" title="In 4.3.1. RewardNet ‣ 4.3. Agent-I: Generating Intentional Candidate Suggestions ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     . ii) In addition, we fine-tune the connection (i.e., the FC layer) between the LLM and the two-tower using a language generation loss on the output suggestions according to Equation
     <a class="ltx_ref" href="#S4.E3" title="In 4.3.1. RewardNet ‣ 4.3. Agent-I: Generating Intentional Candidate Suggestions ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     . By conditioning the LLM on the output from the two-tower to generate language, it can capture the visual cues presented in the input image. iii) To prevent over-optimization of the RewardNet, we further incorporate a penalty for the KL divergence
     <cite class="ltx_cite ltx_citemacro_citep">
      (Jaques et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib20" title="">
       2019
      </a>
      )
     </cite>
     between the learned RL policy, denoted as
     <math alttext="\pi_{\phi}^{\text{RL}}" class="ltx_Math" display="inline" id="S4.SS4.p7.3.m3.1">
      <semantics id="S4.SS4.p7.3.m3.1a">
       <msubsup id="S4.SS4.p7.3.m3.1.1" xref="S4.SS4.p7.3.m3.1.1.cmml">
        <mi id="S4.SS4.p7.3.m3.1.1.2.2" xref="S4.SS4.p7.3.m3.1.1.2.2.cmml">
         π
        </mi>
        <mi id="S4.SS4.p7.3.m3.1.1.2.3" xref="S4.SS4.p7.3.m3.1.1.2.3.cmml">
         ϕ
        </mi>
        <mtext id="S4.SS4.p7.3.m3.1.1.3" xref="S4.SS4.p7.3.m3.1.1.3a.cmml">
         RL
        </mtext>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.3.m3.1b">
        <apply id="S4.SS4.p7.3.m3.1.1.cmml" xref="S4.SS4.p7.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p7.3.m3.1.1.1.cmml" xref="S4.SS4.p7.3.m3.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS4.p7.3.m3.1.1.2.cmml" xref="S4.SS4.p7.3.m3.1.1">
          <csymbol cd="ambiguous" id="S4.SS4.p7.3.m3.1.1.2.1.cmml" xref="S4.SS4.p7.3.m3.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS4.p7.3.m3.1.1.2.2.cmml" xref="S4.SS4.p7.3.m3.1.1.2.2">
           𝜋
          </ci>
          <ci id="S4.SS4.p7.3.m3.1.1.2.3.cmml" xref="S4.SS4.p7.3.m3.1.1.2.3">
           italic-ϕ
          </ci>
         </apply>
         <ci id="S4.SS4.p7.3.m3.1.1.3a.cmml" xref="S4.SS4.p7.3.m3.1.1.3">
          <mtext id="S4.SS4.p7.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p7.3.m3.1.1.3">
           RL
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.3.m3.1c">
        \pi_{\phi}^{\text{RL}}
       </annotation>
      </semantics>
     </math>
     with parameters
     <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS4.p7.4.m4.1">
      <semantics id="S4.SS4.p7.4.m4.1a">
       <mi id="S4.SS4.p7.4.m4.1.1" xref="S4.SS4.p7.4.m4.1.1.cmml">
        ϕ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.4.m4.1b">
        <ci id="S4.SS4.p7.4.m4.1.1.cmml" xref="S4.SS4.p7.4.m4.1.1">
         italic-ϕ
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.4.m4.1c">
        \phi
       </annotation>
      </semantics>
     </math>
     , and its original SFT policy, denoted as
     <math alttext="\pi^{\text{SFT}}" class="ltx_Math" display="inline" id="S4.SS4.p7.5.m5.1">
      <semantics id="S4.SS4.p7.5.m5.1a">
       <msup id="S4.SS4.p7.5.m5.1.1" xref="S4.SS4.p7.5.m5.1.1.cmml">
        <mi id="S4.SS4.p7.5.m5.1.1.2" xref="S4.SS4.p7.5.m5.1.1.2.cmml">
         π
        </mi>
        <mtext id="S4.SS4.p7.5.m5.1.1.3" xref="S4.SS4.p7.5.m5.1.1.3a.cmml">
         SFT
        </mtext>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.5.m5.1b">
        <apply id="S4.SS4.p7.5.m5.1.1.cmml" xref="S4.SS4.p7.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p7.5.m5.1.1.1.cmml" xref="S4.SS4.p7.5.m5.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p7.5.m5.1.1.2.cmml" xref="S4.SS4.p7.5.m5.1.1.2">
          𝜋
         </ci>
         <ci id="S4.SS4.p7.5.m5.1.1.3a.cmml" xref="S4.SS4.p7.5.m5.1.1.3">
          <mtext id="S4.SS4.p7.5.m5.1.1.3.cmml" mathsize="70%" xref="S4.SS4.p7.5.m5.1.1.3">
           SFT
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.5.m5.1c">
        \pi^{\text{SFT}}
       </annotation>
      </semantics>
     </math>
     . Formally, the loss of Agent-I is presented as
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx8">
     <tbody id="S4.E9">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (9)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\text{I}}=-r^{I}+\beta\log(\pi_{\phi}^{\text{RL}}(a^{I}|\mathbf{s}^{I})/\pi^{\text{SFT}}(a^{I}|\mathbf{s}^{I}))-\gamma\sum\limits_{i}\log P(\mathbf{w}_{i}|\mathbf{w}_{1:i-1},I)," class="ltx_Math" display="inline" id="S4.E9.m1.3">
         <semantics id="S4.E9.m1.3a">
          <mrow id="S4.E9.m1.3.3.1" xref="S4.E9.m1.3.3.1.1.cmml">
           <mrow id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml">
            <msub id="S4.E9.m1.3.3.1.1.4" xref="S4.E9.m1.3.3.1.1.4.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.3.3.1.1.4.2" xref="S4.E9.m1.3.3.1.1.4.2.cmml">
              ℒ
             </mi>
             <mtext id="S4.E9.m1.3.3.1.1.4.3" xref="S4.E9.m1.3.3.1.1.4.3a.cmml">
              I
             </mtext>
            </msub>
            <mo id="S4.E9.m1.3.3.1.1.3" xref="S4.E9.m1.3.3.1.1.3.cmml">
             =
            </mo>
            <mrow id="S4.E9.m1.3.3.1.1.2" xref="S4.E9.m1.3.3.1.1.2.cmml">
             <mrow id="S4.E9.m1.3.3.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.cmml">
              <mrow id="S4.E9.m1.3.3.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.3.cmml">
               <mo id="S4.E9.m1.3.3.1.1.1.1.3a" xref="S4.E9.m1.3.3.1.1.1.1.3.cmml">
                −
               </mo>
               <msup id="S4.E9.m1.3.3.1.1.1.1.3.2" xref="S4.E9.m1.3.3.1.1.1.1.3.2.cmml">
                <mi id="S4.E9.m1.3.3.1.1.1.1.3.2.2" xref="S4.E9.m1.3.3.1.1.1.1.3.2.2.cmml">
                 r
                </mi>
                <mi id="S4.E9.m1.3.3.1.1.1.1.3.2.3" xref="S4.E9.m1.3.3.1.1.1.1.3.2.3.cmml">
                 I
                </mi>
               </msup>
              </mrow>
              <mo id="S4.E9.m1.3.3.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.2.cmml">
               +
              </mo>
              <mrow id="S4.E9.m1.3.3.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.cmml">
               <mi id="S4.E9.m1.3.3.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.3.cmml">
                β
               </mi>
               <mo id="S4.E9.m1.3.3.1.1.1.1.1.2" lspace="0.167em" rspace="0em" xref="S4.E9.m1.3.3.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">
                <mi id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml">
                 log
                </mi>
                <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1a" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">
                 ⁡
                </mo>
                <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">
                 <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">
                  (
                 </mo>
                 <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">
                  <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">
                    <msubsup id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                     <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">
                      π
                     </mi>
                     <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">
                      ϕ
                     </mi>
                     <mtext id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">
                      RL
                     </mtext>
                    </msubsup>
                    <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                     ​
                    </mo>
                    <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                     <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                      (
                     </mo>
                     <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                      <msup id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                       <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                        a
                       </mi>
                       <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                        I
                       </mi>
                      </msup>
                      <mo fence="false" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                       |
                      </mo>
                      <msup id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                       <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                        𝐬
                       </mi>
                       <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                        I
                       </mi>
                      </msup>
                     </mrow>
                     <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                      )
                     </mo>
                    </mrow>
                   </mrow>
                   <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    /
                   </mo>
                   <msup id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                     π
                    </mi>
                    <mtext id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3a.cmml">
                     SFT
                    </mtext>
                   </msup>
                  </mrow>
                  <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">
                   ​
                  </mo>
                  <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.cmml">
                   <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.2" stretchy="false" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.cmml">
                    (
                   </mo>
                   <mrow id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.cmml">
                    <msup id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml">
                     <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml">
                      a
                     </mi>
                     <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml">
                      I
                     </mi>
                    </msup>
                    <mo fence="false" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">
                     |
                    </mo>
                    <msup id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml">
                     <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml">
                      𝐬
                     </mi>
                     <mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml">
                      I
                     </mi>
                    </msup>
                   </mrow>
                   <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.3" stretchy="false" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
             <mo id="S4.E9.m1.3.3.1.1.2.3" xref="S4.E9.m1.3.3.1.1.2.3.cmml">
              −
             </mo>
             <mrow id="S4.E9.m1.3.3.1.1.2.2" xref="S4.E9.m1.3.3.1.1.2.2.cmml">
              <mi id="S4.E9.m1.3.3.1.1.2.2.3" xref="S4.E9.m1.3.3.1.1.2.2.3.cmml">
               γ
              </mi>
              <mo id="S4.E9.m1.3.3.1.1.2.2.2" lspace="0em" rspace="0em" xref="S4.E9.m1.3.3.1.1.2.2.2.cmml">
               ​
              </mo>
              <mrow id="S4.E9.m1.3.3.1.1.2.2.1" xref="S4.E9.m1.3.3.1.1.2.2.1.cmml">
               <mstyle displaystyle="true" id="S4.E9.m1.3.3.1.1.2.2.1.2" xref="S4.E9.m1.3.3.1.1.2.2.1.2.cmml">
                <munder id="S4.E9.m1.3.3.1.1.2.2.1.2a" xref="S4.E9.m1.3.3.1.1.2.2.1.2.cmml">
                 <mo id="S4.E9.m1.3.3.1.1.2.2.1.2.2" movablelimits="false" xref="S4.E9.m1.3.3.1.1.2.2.1.2.2.cmml">
                  ∑
                 </mo>
                 <mi id="S4.E9.m1.3.3.1.1.2.2.1.2.3" xref="S4.E9.m1.3.3.1.1.2.2.1.2.3.cmml">
                  i
                 </mi>
                </munder>
               </mstyle>
               <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.cmml">
                <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1.3" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3.cmml">
                 <mi id="S4.E9.m1.3.3.1.1.2.2.1.1.3.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3.1.cmml">
                  log
                 </mi>
                 <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.3a" lspace="0.167em" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3.cmml">
                  ⁡
                 </mo>
                 <mi id="S4.E9.m1.3.3.1.1.2.2.1.1.3.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3.2.cmml">
                  P
                 </mi>
                </mrow>
                <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.2" lspace="0em" rspace="0em" xref="S4.E9.m1.3.3.1.1.2.2.1.1.2.cmml">
                 ​
                </mo>
                <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">
                 <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">
                  (
                 </mo>
                 <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">
                  <msub id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml">
                   <mi id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.cmml">
                    𝐰
                   </mi>
                   <mi id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.3" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.3.cmml">
                    i
                   </mi>
                  </msub>
                  <mo fence="false" id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml">
                   |
                  </mo>
                  <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml">
                   <msub id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml">
                    <mi id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml">
                     𝐰
                    </mi>
                    <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml">
                     <mn id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">
                      1
                     </mn>
                     <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.1.cmml">
                      :
                     </mo>
                     <mrow id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">
                      <mi id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">
                       i
                      </mi>
                      <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.1" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">
                       −
                      </mo>
                      <mn id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">
                       1
                      </mn>
                     </mrow>
                    </mrow>
                   </msub>
                   <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml">
                    ,
                   </mo>
                   <mi id="S4.E9.m1.2.2" xref="S4.E9.m1.2.2.cmml">
                    I
                   </mi>
                  </mrow>
                 </mrow>
                 <mo id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E9.m1.3.3.1.2" xref="S4.E9.m1.3.3.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E9.m1.3b">
           <apply id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1">
            <eq id="S4.E9.m1.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.3">
            </eq>
            <apply id="S4.E9.m1.3.3.1.1.4.cmml" xref="S4.E9.m1.3.3.1.1.4">
             <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.4.1.cmml" xref="S4.E9.m1.3.3.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.E9.m1.3.3.1.1.4.2.cmml" xref="S4.E9.m1.3.3.1.1.4.2">
              ℒ
             </ci>
             <ci id="S4.E9.m1.3.3.1.1.4.3a.cmml" xref="S4.E9.m1.3.3.1.1.4.3">
              <mtext id="S4.E9.m1.3.3.1.1.4.3.cmml" mathsize="70%" xref="S4.E9.m1.3.3.1.1.4.3">
               I
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E9.m1.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2">
             <minus id="S4.E9.m1.3.3.1.1.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.3">
             </minus>
             <apply id="S4.E9.m1.3.3.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1">
              <plus id="S4.E9.m1.3.3.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.2">
              </plus>
              <apply id="S4.E9.m1.3.3.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.3">
               <minus id="S4.E9.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.3">
               </minus>
               <apply id="S4.E9.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.3.2">
                <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.3.2">
                 superscript
                </csymbol>
                <ci id="S4.E9.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.3.2.2">
                 𝑟
                </ci>
                <ci id="S4.E9.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.3.2.3">
                 𝐼
                </ci>
               </apply>
              </apply>
              <apply id="S4.E9.m1.3.3.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1">
               <times id="S4.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.2">
               </times>
               <ci id="S4.E9.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.3">
                𝛽
               </ci>
               <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1">
                <log id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1">
                </log>
                <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1">
                 <times id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.3">
                 </times>
                 <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1">
                  <divide id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">
                  </divide>
                  <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">
                   <times id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">
                   </times>
                   <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">
                    <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">
                     superscript
                    </csymbol>
                    <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">
                     <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">
                      subscript
                     </csymbol>
                     <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.2">
                      𝜋
                     </ci>
                     <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.3">
                      italic-ϕ
                     </ci>
                    </apply>
                    <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">
                     <mtext id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">
                      RL
                     </mtext>
                    </ci>
                   </apply>
                   <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">
                    <csymbol cd="latexml" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     conditional
                    </csymbol>
                    <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                     <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                      superscript
                     </csymbol>
                     <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">
                      𝑎
                     </ci>
                     <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">
                      𝐼
                     </ci>
                    </apply>
                    <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                     <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                      superscript
                     </csymbol>
                     <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">
                      𝐬
                     </ci>
                     <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">
                      𝐼
                     </ci>
                    </apply>
                   </apply>
                  </apply>
                  <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">
                    superscript
                   </csymbol>
                   <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">
                    𝜋
                   </ci>
                   <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3a.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">
                    <mtext id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">
                     SFT
                    </mtext>
                   </ci>
                  </apply>
                 </apply>
                 <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1">
                  <csymbol cd="latexml" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.1">
                   conditional
                  </csymbol>
                  <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2">
                   <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2">
                    superscript
                   </csymbol>
                   <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.2">
                    𝑎
                   </ci>
                   <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.2.3">
                    𝐼
                   </ci>
                  </apply>
                  <apply id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3">
                   <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3">
                    superscript
                   </csymbol>
                   <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.2">
                    𝐬
                   </ci>
                   <ci id="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.1.3.3">
                    𝐼
                   </ci>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="S4.E9.m1.3.3.1.1.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2">
              <times id="S4.E9.m1.3.3.1.1.2.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.2">
              </times>
              <ci id="S4.E9.m1.3.3.1.1.2.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.3">
               𝛾
              </ci>
              <apply id="S4.E9.m1.3.3.1.1.2.2.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1">
               <apply id="S4.E9.m1.3.3.1.1.2.2.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.2">
                <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.2.2.1.2.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.2">
                 subscript
                </csymbol>
                <sum id="S4.E9.m1.3.3.1.1.2.2.1.2.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.2.2">
                </sum>
                <ci id="S4.E9.m1.3.3.1.1.2.2.1.2.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.2.3">
                 𝑖
                </ci>
               </apply>
               <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1">
                <times id="S4.E9.m1.3.3.1.1.2.2.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.2">
                </times>
                <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3">
                 <log id="S4.E9.m1.3.3.1.1.2.2.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3.1">
                 </log>
                 <ci id="S4.E9.m1.3.3.1.1.2.2.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.3.2">
                  𝑃
                 </ci>
                </apply>
                <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1">
                 <csymbol cd="latexml" id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.2">
                  conditional
                 </csymbol>
                 <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3">
                   subscript
                  </csymbol>
                  <ci id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.2">
                   𝐰
                  </ci>
                  <ci id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.3.3">
                   𝑖
                  </ci>
                 </apply>
                 <list id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1">
                  <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.2">
                    𝐰
                   </ci>
                   <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3">
                    <ci id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.1">
                     :
                    </ci>
                    <cn id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.2">
                     1
                    </cn>
                    <apply id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3">
                     <minus id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.1">
                     </minus>
                     <ci id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.2">
                      𝑖
                     </ci>
                     <cn id="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E9.m1.3.3.1.1.2.2.1.1.1.1.1.1.1.1.3.3.3">
                      1
                     </cn>
                    </apply>
                   </apply>
                  </apply>
                  <ci id="S4.E9.m1.2.2.cmml" xref="S4.E9.m1.2.2">
                   𝐼
                  </ci>
                 </list>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E9.m1.3c">
           \displaystyle\mathcal{L}_{\text{I}}=-r^{I}+\beta\log(\pi_{\phi}^{\text{RL}}(a^{I}|\mathbf{s}^{I})/\pi^{\text{SFT}}(a^{I}|\mathbf{s}^{I}))-\gamma\sum\limits_{i}\log P(\mathbf{w}_{i}|\mathbf{w}_{1:i-1},I),
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS4.p7.10">
     where
     <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS4.p7.6.m1.1">
      <semantics id="S4.SS4.p7.6.m1.1a">
       <mi id="S4.SS4.p7.6.m1.1.1" xref="S4.SS4.p7.6.m1.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.6.m1.1b">
        <ci id="S4.SS4.p7.6.m1.1.1.cmml" xref="S4.SS4.p7.6.m1.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.6.m1.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\gamma" class="ltx_Math" display="inline" id="S4.SS4.p7.7.m2.1">
      <semantics id="S4.SS4.p7.7.m2.1a">
       <mi id="S4.SS4.p7.7.m2.1.1" xref="S4.SS4.p7.7.m2.1.1.cmml">
        γ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.7.m2.1b">
        <ci id="S4.SS4.p7.7.m2.1.1.cmml" xref="S4.SS4.p7.7.m2.1.1">
         𝛾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.7.m2.1c">
        \gamma
       </annotation>
      </semantics>
     </math>
     are two coefficients to control the strength of the KL penalty and language loss. For each output suggestion
     <math alttext="S_{i}" class="ltx_Math" display="inline" id="S4.SS4.p7.8.m3.1">
      <semantics id="S4.SS4.p7.8.m3.1a">
       <msub id="S4.SS4.p7.8.m3.1.1" xref="S4.SS4.p7.8.m3.1.1.cmml">
        <mi id="S4.SS4.p7.8.m3.1.1.2" xref="S4.SS4.p7.8.m3.1.1.2.cmml">
         S
        </mi>
        <mi id="S4.SS4.p7.8.m3.1.1.3" xref="S4.SS4.p7.8.m3.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.8.m3.1b">
        <apply id="S4.SS4.p7.8.m3.1.1.cmml" xref="S4.SS4.p7.8.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p7.8.m3.1.1.1.cmml" xref="S4.SS4.p7.8.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS4.p7.8.m3.1.1.2.cmml" xref="S4.SS4.p7.8.m3.1.1.2">
          𝑆
         </ci>
         <ci id="S4.SS4.p7.8.m3.1.1.3.cmml" xref="S4.SS4.p7.8.m3.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.8.m3.1c">
        S_{i}
       </annotation>
      </semantics>
     </math>
     (
     <math alttext="1\leq i\leq K" class="ltx_Math" display="inline" id="S4.SS4.p7.9.m4.1">
      <semantics id="S4.SS4.p7.9.m4.1a">
       <mrow id="S4.SS4.p7.9.m4.1.1" xref="S4.SS4.p7.9.m4.1.1.cmml">
        <mn id="S4.SS4.p7.9.m4.1.1.2" xref="S4.SS4.p7.9.m4.1.1.2.cmml">
         1
        </mn>
        <mo id="S4.SS4.p7.9.m4.1.1.3" xref="S4.SS4.p7.9.m4.1.1.3.cmml">
         ≤
        </mo>
        <mi id="S4.SS4.p7.9.m4.1.1.4" xref="S4.SS4.p7.9.m4.1.1.4.cmml">
         i
        </mi>
        <mo id="S4.SS4.p7.9.m4.1.1.5" xref="S4.SS4.p7.9.m4.1.1.5.cmml">
         ≤
        </mo>
        <mi id="S4.SS4.p7.9.m4.1.1.6" xref="S4.SS4.p7.9.m4.1.1.6.cmml">
         K
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p7.9.m4.1b">
        <apply id="S4.SS4.p7.9.m4.1.1.cmml" xref="S4.SS4.p7.9.m4.1.1">
         <and id="S4.SS4.p7.9.m4.1.1a.cmml" xref="S4.SS4.p7.9.m4.1.1">
         </and>
         <apply id="S4.SS4.p7.9.m4.1.1b.cmml" xref="S4.SS4.p7.9.m4.1.1">
          <leq id="S4.SS4.p7.9.m4.1.1.3.cmml" xref="S4.SS4.p7.9.m4.1.1.3">
          </leq>
          <cn id="S4.SS4.p7.9.m4.1.1.2.cmml" type="integer" xref="S4.SS4.p7.9.m4.1.1.2">
           1
          </cn>
          <ci id="S4.SS4.p7.9.m4.1.1.4.cmml" xref="S4.SS4.p7.9.m4.1.1.4">
           𝑖
          </ci>
         </apply>
         <apply id="S4.SS4.p7.9.m4.1.1c.cmml" xref="S4.SS4.p7.9.m4.1.1">
          <leq id="S4.SS4.p7.9.m4.1.1.5.cmml" xref="S4.SS4.p7.9.m4.1.1.5">
          </leq>
          <share href="#S4.SS4.p7.9.m4.1.1.4.cmml" id="S4.SS4.p7.9.m4.1.1d.cmml" xref="S4.SS4.p7.9.m4.1.1">
          </share>
          <ci id="S4.SS4.p7.9.m4.1.1.6.cmml" xref="S4.SS4.p7.9.m4.1.1.6">
           𝐾
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.9.m4.1c">
        1\leq i\leq K
       </annotation>
      </semantics>
     </math>
     ), it corresponds to a sequence of word tokens
     <math alttext="S_{i}=&lt;\mathbf{w}_{1},...,\mathbf{w}_{m}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS4.p7.10.m5.1">
      <semantics id="S4.SS4.p7.10.m5.1a">
       <mrow id="S4.SS4.p7.10.m5.1b">
        <msub id="S4.SS4.p7.10.m5.1.2">
         <mi id="S4.SS4.p7.10.m5.1.2.2">
          S
         </mi>
         <mi id="S4.SS4.p7.10.m5.1.2.3">
          i
         </mi>
        </msub>
        <mo id="S4.SS4.p7.10.m5.1.3" rspace="0em">
         =
        </mo>
        <mo id="S4.SS4.p7.10.m5.1.4" lspace="0em">
         &lt;
        </mo>
        <msub id="S4.SS4.p7.10.m5.1.5">
         <mi id="S4.SS4.p7.10.m5.1.5.2">
          𝐰
         </mi>
         <mn id="S4.SS4.p7.10.m5.1.5.3">
          1
         </mn>
        </msub>
        <mo id="S4.SS4.p7.10.m5.1.6">
         ,
        </mo>
        <mi id="S4.SS4.p7.10.m5.1.1" mathvariant="normal">
         …
        </mi>
        <mo id="S4.SS4.p7.10.m5.1.7">
         ,
        </mo>
        <msub id="S4.SS4.p7.10.m5.1.8">
         <mi id="S4.SS4.p7.10.m5.1.8.2">
          𝐰
         </mi>
         <mi id="S4.SS4.p7.10.m5.1.8.3">
          m
         </mi>
        </msub>
        <mo id="S4.SS4.p7.10.m5.1.9">
         &gt;
        </mo>
       </mrow>
       <annotation encoding="application/x-tex" id="S4.SS4.p7.10.m5.1c">
        S_{i}=&lt;\mathbf{w}_{1},...,\mathbf{w}_{m}&gt;
       </annotation>
      </semantics>
     </math>
     for the language generation.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p8">
    <p class="ltx_p" id="S4.SS4.p8.7">
     For Agent-D, the core problem of its MDP is to acquire a policy that guides the agent in selecting actions denoted as
     <math alttext="a^{D}" class="ltx_Math" display="inline" id="S4.SS4.p8.1.m1.1">
      <semantics id="S4.SS4.p8.1.m1.1a">
       <msup id="S4.SS4.p8.1.m1.1.1" xref="S4.SS4.p8.1.m1.1.1.cmml">
        <mi id="S4.SS4.p8.1.m1.1.1.2" xref="S4.SS4.p8.1.m1.1.1.2.cmml">
         a
        </mi>
        <mi id="S4.SS4.p8.1.m1.1.1.3" xref="S4.SS4.p8.1.m1.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.1.m1.1b">
        <apply id="S4.SS4.p8.1.m1.1.1.cmml" xref="S4.SS4.p8.1.m1.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p8.1.m1.1.1.1.cmml" xref="S4.SS4.p8.1.m1.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p8.1.m1.1.1.2.cmml" xref="S4.SS4.p8.1.m1.1.1.2">
          𝑎
         </ci>
         <ci id="S4.SS4.p8.1.m1.1.1.3.cmml" xref="S4.SS4.p8.1.m1.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.1.m1.1c">
        a^{D}
       </annotation>
      </semantics>
     </math>
     . These actions are determined based on the constructed states
     <math alttext="\mathbf{s}^{D}" class="ltx_Math" display="inline" id="S4.SS4.p8.2.m2.1">
      <semantics id="S4.SS4.p8.2.m2.1a">
       <msup id="S4.SS4.p8.2.m2.1.1" xref="S4.SS4.p8.2.m2.1.1.cmml">
        <mi id="S4.SS4.p8.2.m2.1.1.2" xref="S4.SS4.p8.2.m2.1.1.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p8.2.m2.1.1.3" xref="S4.SS4.p8.2.m2.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.2.m2.1b">
        <apply id="S4.SS4.p8.2.m2.1.1.cmml" xref="S4.SS4.p8.2.m2.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p8.2.m2.1.1.1.cmml" xref="S4.SS4.p8.2.m2.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p8.2.m2.1.1.2.cmml" xref="S4.SS4.p8.2.m2.1.1.2">
          𝐬
         </ci>
         <ci id="S4.SS4.p8.2.m2.1.1.3.cmml" xref="S4.SS4.p8.2.m2.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.2.m2.1c">
        \mathbf{s}^{D}
       </annotation>
      </semantics>
     </math>
     with the objective of maximizing the cumulative reward, denoted as
     <math alttext="R_{N}" class="ltx_Math" display="inline" id="S4.SS4.p8.3.m3.1">
      <semantics id="S4.SS4.p8.3.m3.1a">
       <msub id="S4.SS4.p8.3.m3.1.1" xref="S4.SS4.p8.3.m3.1.1.cmml">
        <mi id="S4.SS4.p8.3.m3.1.1.2" xref="S4.SS4.p8.3.m3.1.1.2.cmml">
         R
        </mi>
        <mi id="S4.SS4.p8.3.m3.1.1.3" xref="S4.SS4.p8.3.m3.1.1.3.cmml">
         N
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.3.m3.1b">
        <apply id="S4.SS4.p8.3.m3.1.1.cmml" xref="S4.SS4.p8.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p8.3.m3.1.1.1.cmml" xref="S4.SS4.p8.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS4.p8.3.m3.1.1.2.cmml" xref="S4.SS4.p8.3.m3.1.1.2">
          𝑅
         </ci>
         <ci id="S4.SS4.p8.3.m3.1.1.3.cmml" xref="S4.SS4.p8.3.m3.1.1.3">
          𝑁
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.3.m3.1c">
        R_{N}
       </annotation>
      </semantics>
     </math>
     . We employ a policy gradient method for learning this policy, called the REINFORCE algorithm
     <cite class="ltx_cite ltx_citemacro_citep">
      (Williams,
      <a class="ltx_ref" href="#bib.bib44" title="">
       1992
      </a>
      ; Silver et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib41" title="">
       2014
      </a>
      )
     </cite>
     . To elaborate, we introduce a stochastic policy denoted as
     <math alttext="\pi_{\theta}(a^{D}|\mathbf{s}^{D})" class="ltx_Math" display="inline" id="S4.SS4.p8.4.m4.1">
      <semantics id="S4.SS4.p8.4.m4.1a">
       <mrow id="S4.SS4.p8.4.m4.1.1" xref="S4.SS4.p8.4.m4.1.1.cmml">
        <msub id="S4.SS4.p8.4.m4.1.1.3" xref="S4.SS4.p8.4.m4.1.1.3.cmml">
         <mi id="S4.SS4.p8.4.m4.1.1.3.2" xref="S4.SS4.p8.4.m4.1.1.3.2.cmml">
          π
         </mi>
         <mi id="S4.SS4.p8.4.m4.1.1.3.3" xref="S4.SS4.p8.4.m4.1.1.3.3.cmml">
          θ
         </mi>
        </msub>
        <mo id="S4.SS4.p8.4.m4.1.1.2" lspace="0em" rspace="0em" xref="S4.SS4.p8.4.m4.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS4.p8.4.m4.1.1.1.1" xref="S4.SS4.p8.4.m4.1.1.1.1.1.cmml">
         <mo id="S4.SS4.p8.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS4.p8.4.m4.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S4.SS4.p8.4.m4.1.1.1.1.1" xref="S4.SS4.p8.4.m4.1.1.1.1.1.cmml">
          <msup id="S4.SS4.p8.4.m4.1.1.1.1.1.2" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2.cmml">
           <mi id="S4.SS4.p8.4.m4.1.1.1.1.1.2.2" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2.2.cmml">
            a
           </mi>
           <mi id="S4.SS4.p8.4.m4.1.1.1.1.1.2.3" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2.3.cmml">
            D
           </mi>
          </msup>
          <mo fence="false" id="S4.SS4.p8.4.m4.1.1.1.1.1.1" xref="S4.SS4.p8.4.m4.1.1.1.1.1.1.cmml">
           |
          </mo>
          <msup id="S4.SS4.p8.4.m4.1.1.1.1.1.3" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3.cmml">
           <mi id="S4.SS4.p8.4.m4.1.1.1.1.1.3.2" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3.2.cmml">
            𝐬
           </mi>
           <mi id="S4.SS4.p8.4.m4.1.1.1.1.1.3.3" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3.3.cmml">
            D
           </mi>
          </msup>
         </mrow>
         <mo id="S4.SS4.p8.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS4.p8.4.m4.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.4.m4.1b">
        <apply id="S4.SS4.p8.4.m4.1.1.cmml" xref="S4.SS4.p8.4.m4.1.1">
         <times id="S4.SS4.p8.4.m4.1.1.2.cmml" xref="S4.SS4.p8.4.m4.1.1.2">
         </times>
         <apply id="S4.SS4.p8.4.m4.1.1.3.cmml" xref="S4.SS4.p8.4.m4.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS4.p8.4.m4.1.1.3.1.cmml" xref="S4.SS4.p8.4.m4.1.1.3">
           subscript
          </csymbol>
          <ci id="S4.SS4.p8.4.m4.1.1.3.2.cmml" xref="S4.SS4.p8.4.m4.1.1.3.2">
           𝜋
          </ci>
          <ci id="S4.SS4.p8.4.m4.1.1.3.3.cmml" xref="S4.SS4.p8.4.m4.1.1.3.3">
           𝜃
          </ci>
         </apply>
         <apply id="S4.SS4.p8.4.m4.1.1.1.1.1.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1">
          <csymbol cd="latexml" id="S4.SS4.p8.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.1">
           conditional
          </csymbol>
          <apply id="S4.SS4.p8.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2">
           <csymbol cd="ambiguous" id="S4.SS4.p8.4.m4.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2">
            superscript
           </csymbol>
           <ci id="S4.SS4.p8.4.m4.1.1.1.1.1.2.2.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2.2">
            𝑎
           </ci>
           <ci id="S4.SS4.p8.4.m4.1.1.1.1.1.2.3.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.2.3">
            𝐷
           </ci>
          </apply>
          <apply id="S4.SS4.p8.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3">
           <csymbol cd="ambiguous" id="S4.SS4.p8.4.m4.1.1.1.1.1.3.1.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3">
            superscript
           </csymbol>
           <ci id="S4.SS4.p8.4.m4.1.1.1.1.1.3.2.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3.2">
            𝐬
           </ci>
           <ci id="S4.SS4.p8.4.m4.1.1.1.1.1.3.3.cmml" xref="S4.SS4.p8.4.m4.1.1.1.1.1.3.3">
            𝐷
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.4.m4.1c">
        \pi_{\theta}(a^{D}|\mathbf{s}^{D})
       </annotation>
      </semantics>
     </math>
     . This policy is responsible for probabilistically sampling an action
     <math alttext="a^{D}" class="ltx_Math" display="inline" id="S4.SS4.p8.5.m5.1">
      <semantics id="S4.SS4.p8.5.m5.1a">
       <msup id="S4.SS4.p8.5.m5.1.1" xref="S4.SS4.p8.5.m5.1.1.cmml">
        <mi id="S4.SS4.p8.5.m5.1.1.2" xref="S4.SS4.p8.5.m5.1.1.2.cmml">
         a
        </mi>
        <mi id="S4.SS4.p8.5.m5.1.1.3" xref="S4.SS4.p8.5.m5.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.5.m5.1b">
        <apply id="S4.SS4.p8.5.m5.1.1.cmml" xref="S4.SS4.p8.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p8.5.m5.1.1.1.cmml" xref="S4.SS4.p8.5.m5.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p8.5.m5.1.1.2.cmml" xref="S4.SS4.p8.5.m5.1.1.2">
          𝑎
         </ci>
         <ci id="S4.SS4.p8.5.m5.1.1.3.cmml" xref="S4.SS4.p8.5.m5.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.5.m5.1c">
        a^{D}
       </annotation>
      </semantics>
     </math>
     for a given state
     <math alttext="\mathbf{s}^{D}" class="ltx_Math" display="inline" id="S4.SS4.p8.6.m6.1">
      <semantics id="S4.SS4.p8.6.m6.1a">
       <msup id="S4.SS4.p8.6.m6.1.1" xref="S4.SS4.p8.6.m6.1.1.cmml">
        <mi id="S4.SS4.p8.6.m6.1.1.2" xref="S4.SS4.p8.6.m6.1.1.2.cmml">
         𝐬
        </mi>
        <mi id="S4.SS4.p8.6.m6.1.1.3" xref="S4.SS4.p8.6.m6.1.1.3.cmml">
         D
        </mi>
       </msup>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.6.m6.1b">
        <apply id="S4.SS4.p8.6.m6.1.1.cmml" xref="S4.SS4.p8.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS4.p8.6.m6.1.1.1.cmml" xref="S4.SS4.p8.6.m6.1.1">
          superscript
         </csymbol>
         <ci id="S4.SS4.p8.6.m6.1.1.2.cmml" xref="S4.SS4.p8.6.m6.1.1.2">
          𝐬
         </ci>
         <ci id="S4.SS4.p8.6.m6.1.1.3.cmml" xref="S4.SS4.p8.6.m6.1.1.3">
          𝐷
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.6.m6.1c">
        \mathbf{s}^{D}
       </annotation>
      </semantics>
     </math>
     using a neural network, where the network’s parameters are represented as
     <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS4.p8.7.m7.1">
      <semantics id="S4.SS4.p8.7.m7.1a">
       <mi id="S4.SS4.p8.7.m7.1.1" xref="S4.SS4.p8.7.m7.1.1.cmml">
        θ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS4.p8.7.m7.1b">
        <ci id="S4.SS4.p8.7.m7.1.1.cmml" xref="S4.SS4.p8.7.m7.1.1">
         𝜃
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS4.p8.7.m7.1c">
        \theta
       </annotation>
      </semantics>
     </math>
     . The loss function for Agent-D is then formulated as follows:
    </p>
   </div>
   <div class="ltx_para" id="S4.SS4.p9">
    <table class="ltx_equation ltx_eqn_table" id="S4.E10">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (10)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\mathcal{L}_{\text{D}}=-R_{N}\ln\pi_{\theta}(a^{D}|\mathbf{s}^{D})." class="ltx_Math" display="block" id="S4.E10.m1.1">
         <semantics id="S4.E10.m1.1a">
          <mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">
           <mrow id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">
            <msub id="S4.E10.m1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.3.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.3.2.cmml">
              ℒ
             </mi>
             <mtext id="S4.E10.m1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.3.3a.cmml">
              D
             </mtext>
            </msub>
            <mo id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.2.cmml">
             =
            </mo>
            <mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.cmml">
             <mo id="S4.E10.m1.1.1.1.1.1a" xref="S4.E10.m1.1.1.1.1.1.cmml">
              −
             </mo>
             <mrow id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml">
              <msub id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml">
               <mi id="S4.E10.m1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.cmml">
                R
               </mi>
               <mi id="S4.E10.m1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.3.3.cmml">
                N
               </mi>
              </msub>
              <mo id="S4.E10.m1.1.1.1.1.1.1.2" lspace="0.167em" rspace="0em" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S4.E10.m1.1.1.1.1.1.1.4" xref="S4.E10.m1.1.1.1.1.1.1.4.cmml">
               <mi id="S4.E10.m1.1.1.1.1.1.1.4.1" xref="S4.E10.m1.1.1.1.1.1.1.4.1.cmml">
                ln
               </mi>
               <mo id="S4.E10.m1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S4.E10.m1.1.1.1.1.1.1.4.cmml">
                ⁡
               </mo>
               <msub id="S4.E10.m1.1.1.1.1.1.1.4.2" xref="S4.E10.m1.1.1.1.1.1.1.4.2.cmml">
                <mi id="S4.E10.m1.1.1.1.1.1.1.4.2.2" xref="S4.E10.m1.1.1.1.1.1.1.4.2.2.cmml">
                 π
                </mi>
                <mi id="S4.E10.m1.1.1.1.1.1.1.4.2.3" xref="S4.E10.m1.1.1.1.1.1.1.4.2.3.cmml">
                 θ
                </mi>
               </msub>
              </mrow>
              <mo id="S4.E10.m1.1.1.1.1.1.1.2a" lspace="0em" rspace="0em" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S4.E10.m1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml">
               <mo id="S4.E10.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml">
                <msup id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml">
                 <mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">
                  a
                 </mi>
                 <mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                  D
                 </mi>
                </msup>
                <mo fence="false" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml">
                 |
                </mo>
                <msup id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml">
                 <mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                  𝐬
                 </mi>
                 <mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                  D
                 </mi>
                </msup>
               </mrow>
               <mo id="S4.E10.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S4.E10.m1.1.1.1.2" lspace="0em" xref="S4.E10.m1.1.1.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b">
           <apply id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1">
            <eq id="S4.E10.m1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.2">
            </eq>
            <apply id="S4.E10.m1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="S4.E10.m1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2">
              ℒ
             </ci>
             <ci id="S4.E10.m1.1.1.1.1.3.3a.cmml" xref="S4.E10.m1.1.1.1.1.3.3">
              <mtext id="S4.E10.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E10.m1.1.1.1.1.3.3">
               D
              </mtext>
             </ci>
            </apply>
            <apply id="S4.E10.m1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1">
             <minus id="S4.E10.m1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1">
             </minus>
             <apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1">
              <times id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2">
              </times>
              <apply id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="S4.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2">
                𝑅
               </ci>
               <ci id="S4.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.3">
                𝑁
               </ci>
              </apply>
              <apply id="S4.E10.m1.1.1.1.1.1.1.4.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4">
               <ln id="S4.E10.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.1">
               </ln>
               <apply id="S4.E10.m1.1.1.1.1.1.1.4.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.2">
                <csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.2">
                 subscript
                </csymbol>
                <ci id="S4.E10.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.2.2">
                 𝜋
                </ci>
                <ci id="S4.E10.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.2.3">
                 𝜃
                </ci>
               </apply>
              </apply>
              <apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1">
                conditional
               </csymbol>
               <apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2">
                <csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2">
                 superscript
                </csymbol>
                <ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.2">
                 𝑎
                </ci>
                <ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.3">
                 𝐷
                </ci>
               </apply>
               <apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3">
                 superscript
                </csymbol>
                <ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2">
                 𝐬
                </ci>
                <ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3">
                 𝐷
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E10.m1.1c">
           \mathcal{L}_{\text{D}}=-R_{N}\ln\pi_{\theta}(a^{D}|\mathbf{s}^{D}).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.5.
    </span>
    Discussion on Applications and Cold-start
   </h3>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p1">
    <p class="ltx_p" id="S4.SS5.p1.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS5.p1.1.1">
      Supporting Generation-based and Retrieval-based Applications.
     </span>
     We explore
     <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p1.1.2">
      RL4Sugg
     </span>
     capabilities in two search engine scenarios: (1) generation-based and (2) retrieval-based. In (1),
     <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p1.1.3">
      RL4Sugg
     </span>
     can naturally generate query suggestions using its language generation capability from LLMs in response to users’ image queries across diverse domains. In (2),
     <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p1.1.4">
      RL4Sugg
     </span>
     specializes in providing query suggestions for specific domains with narrower focuses, like E-commerce shopping websites, where the query suggestions are limited to their commodities, and can be prepared in advance. It leverages its ability to represent images and language in PolicyNet’s two-tower. Query suggestions are stored as vector representations in a database, and vector-based retrieval, such as HNSW, enhances search efficiency. During inference,
     <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p1.1.5">
      RL4Sugg
     </span>
     extracts the user’s image representation and retrieves Top-
     <math alttext="K" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1">
      <semantics id="S4.SS5.p1.1.m1.1a">
       <mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b">
        <ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     query suggestions with high similarity. Notably, this approach offers several advantages, including efficient query response, and by precomputing and storing the query suggestions in a database, the quality of these suggestions can be guaranteed in advance.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S4.SS5.p2">
    <p class="ltx_p" id="S4.SS5.p2.1">
     <span class="ltx_text ltx_font_bold" id="S4.SS5.p2.1.1">
      Handling the Cold-start Problem.
     </span>
     Since
     <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p2.1.2">
      RL4Sugg
     </span>
     relies on annotator feedback to understand search intentionality,
     <span class="ltx_text ltx_font_typewriter" id="S4.SS5.p2.1.3">
      RL4Sugg
     </span>
     faces a potential cold-start issue for recommending suggestions when the learned knowledge is insufficient for online user queries. To tackle this issue, we employ online learning to continuously fine-tunes both agents by Equation
     <a class="ltx_ref" href="#S4.E9" title="In 4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     and
     <a class="ltx_ref" href="#S4.E10" title="In 4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       10
      </span>
     </a>
     , using newly recorded query images and user-clicked suggestions (i.e., labeling as 1), ensuring the model’s policy remains up-to-date for online use. In Section
     <a class="ltx_ref" href="#S5.SS2" title="5.2. Experimental Results ‣ 5. EXPERIMENTS ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       5.2
      </span>
     </a>
     , we validate this approach, and the results show significant improvements by 8.3% in user experience, which indicates the positive impact of this strategy in practice.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5.
   </span>
   EXPERIMENTS
  </h2>
  <section class="ltx_subsection" id="S5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.1.
    </span>
    Experimental Setup
   </h3>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p1">
    <p class="ltx_p" id="S5.SS1.p1.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">
      Datasets and Ground Truth.
     </span>
     We conduct experiments on two real-world datasets: Business and ImageNet
     <cite class="ltx_cite ltx_citemacro_citep">
      (Deng et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2009
      </a>
      )
     </cite>
     . The Business dataset contains around 50,000 user query images collected from a real image search engine between January 2022 and January 2023. We randomly sample 80% of these images for training, and the remaining for testing. For each image, we collect 5 suggestions following the data collection process described in Section
     <a class="ltx_ref" href="#S4.SS2" title="4.2. Data Collection ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4.2
      </span>
     </a>
     , where 46.9% suggestions are labeled by the GPT model, and the remaining suggestions are labeled by 20 human labelers. Among them, 75.8% image-suggestion pairs are with the label 1. Similarly, we collect 1,000 image-suggestion pairs with labels from the ImageNet, which are used to test the transferability of the model fine-tuned on the Business and to perform zero-shot evaluations on the ImageNet.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS1.p2">
    <p class="ltx_p" id="S5.SS1.p2.3">
     By following
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ouyang et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib34" title="">
       2022
      </a>
      )
     </cite>
     , we then discuss the ground truth for evaluation, considering both the retrieval and generation tasks. For the
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.SS1.p2.3.1">
      retrieval task
     </span>
     , we establish the ground truth of each query image by considering its suggestions with a label of 1. For quality control, we randomly pick 10% labeled image-suggestion pairs, ask 5 other checkers to label these suggestions independently. We employ majority voting to aggregate the labels, and compute the accuracy (denoted by
     <math alttext="\delta" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1">
      <semantics id="S5.SS1.p2.1.m1.1a">
       <mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">
        δ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b">
        <ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">
         𝛿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">
        \delta
       </annotation>
      </semantics>
     </math>
     ) of the labels by the labelers against the aggregated ones by the checkers. The
     <math alttext="\delta" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1">
      <semantics id="S5.SS1.p2.2.m2.1a">
       <mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">
        δ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b">
        <ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">
         𝛿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">
        \delta
       </annotation>
      </semantics>
     </math>
     is 76.7% for the Business and 78.3% for the ImageNet, which demonstrate the high accuracy of our evaluations.
For the
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.SS1.p2.3.2">
      generation task
     </span>
     , we let the human labelers to assess the suggestions generated by various baseline methods and
     <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p2.3.3">
      RL4Sugg
     </span>
     . These labeled suggestions are then reviewed by 5 other checkers. Similarly, we report the
     <math alttext="\delta" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.1">
      <semantics id="S5.SS1.p2.3.m3.1a">
       <mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">
        δ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b">
        <ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">
         𝛿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">
        \delta
       </annotation>
      </semantics>
     </math>
     values as a measure of quality verification.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p3">
    <p class="ltx_p" id="S5.SS1.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">
      Baseline.
     </span>
     We carefully examine existing vision-language models, and identify the following baseline methods: Flamingo, BLIP-2, LLaVA for the generation task, and CLIP, BLIP-2 for the retrieval task. These methods have comparable parameter sizes of LLM backbones as our
     <math alttext="\text{OPT}_{\text{2.7B}}" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1">
      <semantics id="S5.SS1.p3.1.m1.1a">
       <msub id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">
        <mtext id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2a.cmml">
         OPT
        </mtext>
        <mtext id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3a.cmml">
         2.7B
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b">
        <apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">
         <csymbol cd="ambiguous" id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S5.SS1.p3.1.m1.1.1.2a.cmml" xref="S5.SS1.p3.1.m1.1.1.2">
          <mtext id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2">
           OPT
          </mtext>
         </ci>
         <ci id="S5.SS1.p3.1.m1.1.1.3a.cmml" xref="S5.SS1.p3.1.m1.1.1.3">
          <mtext id="S5.SS1.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S5.SS1.p3.1.m1.1.1.3">
           2.7B
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">
        \text{OPT}_{\text{2.7B}}
       </annotation>
      </semantics>
     </math>
     for addressing the MMQS problem. Notably, these models are open-sourced, and we fine-tune them using our collected image-suggestion pairs for fair comparisons. The details are introduced in Appendix Section
     <a class="ltx_ref" href="#A1.SS2" title="A.2. Baseline Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       A.2
      </span>
     </a>
     due to the page limit.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p4">
    <p class="ltx_p" id="S5.SS1.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p4.1.1">
      Implementation Details.
     </span>
     The implementation details of
     <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p4.1.2">
      RL4Sugg
     </span>
     and training process can be
found in Appendix Section
     <a class="ltx_ref" href="#A1.SS3" title="A.3. Implementation Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       A.3
      </span>
     </a>
     due to the page limit.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS1.p5">
    <p class="ltx_p" id="S5.SS1.p5.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">
      Evaluation Metrics.
     </span>
     We evaluate the
     <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p5.1.2">
      RL4Sugg
     </span>
     in terms of the generation task and the retrieval task. For the
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.SS1.p5.1.3">
      generation task
     </span>
     , We report Discounted Cumulative Gain (DCG) and Good vs. Same vs. Bad (GSB) by following
     <cite class="ltx_cite ltx_citemacro_citep">
      (Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2021
      </a>
      ; Chuklin et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2015
      </a>
      )
     </cite>
     . For the
     <span class="ltx_text ltx_framed ltx_framed_underline" id="S5.SS1.p5.1.4">
      retrieval task
     </span>
     , we report positive-negative ratio (PNR) and Recall@K by following
     <cite class="ltx_cite ltx_citemacro_citep">
      (Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2021
      </a>
      ; Jarvelin,
      <a class="ltx_ref" href="#bib.bib21" title="">
       2000
      </a>
      )
     </cite>
     . In addition, We report the DIV according to Equation
     <a class="ltx_ref" href="#S4.E7" title="In 4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     for measuring the diversity within a set of output query suggestions. Overall, superior results are indicated by higher values of DCG, GSB, PNR, Recall@
     <math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.p5.1.m1.1">
      <semantics id="S5.SS1.p5.1.m1.1a">
       <mi id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b">
        <ci id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     , and DIV. The detailed description is included in Appendix Section
     <a class="ltx_ref" href="#A1.SS4" title="A.4. Evaluation Metrics ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       A.4
      </span>
     </a>
     due to the page limit.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.2.
    </span>
    Experimental Results
   </h3>
   <figure class="ltx_table" id="S5.T2">
    <figcaption class="ltx_caption" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 2.
     </span>
     Effectiveness of generation-based applications, fine-tuned on Business and zero-shot transferred to ImageNet, where
     <math alttext="\delta" class="ltx_Math" display="inline" id="S5.T2.2.m1.1">
      <semantics id="S5.T2.2.m1.1b">
       <mi id="S5.T2.2.m1.1.1" xref="S5.T2.2.m1.1.1.cmml">
        δ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.T2.2.m1.1c">
        <ci id="S5.T2.2.m1.1.1.cmml" xref="S5.T2.2.m1.1.1">
         𝛿
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.T2.2.m1.1d">
        \delta
       </annotation>
      </semantics>
     </math>
     indicates the accuracy of labeling the generated suggestions as introduced in Section
     <a class="ltx_ref" href="#S5.SS1" title="5.1. Experimental Setup ‣ 5. EXPERIMENTS ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       5.1
      </span>
     </a>
     .
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.4">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S5.T2.4.3.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T2.4.3.1.1" rowspan="2">
        <span class="ltx_text" id="S5.T2.4.3.1.1.1" style="font-size:90%;">
         Models
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.4.3.1.2" rowspan="2">
        <span class="ltx_text" id="S5.T2.4.3.1.2.1" style="font-size:90%;">
         <span class="ltx_tabular ltx_align_middle" id="S5.T2.4.3.1.2.1.1">
          <span class="ltx_tr" id="S5.T2.4.3.1.2.1.1.1">
           <span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.4.3.1.2.1.1.1.1">
            #Train/#Total
           </span>
          </span>
          <span class="ltx_tr" id="S5.T2.4.3.1.2.1.1.2">
           <span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.4.3.1.2.1.1.2.1">
            Params
           </span>
          </span>
         </span>
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S5.T2.4.3.1.3">
        <span class="ltx_text" id="S5.T2.4.3.1.3.1" style="font-size:90%;">
         Business Fine-tuned
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S5.T2.4.3.1.4">
        <span class="ltx_text" id="S5.T2.4.3.1.4.1" style="font-size:90%;">
         ImageNet 0-Shot
        </span>
       </th>
      </tr>
      <tr class="ltx_tr" id="S5.T2.4.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.4.2.3">
        <span class="ltx_text" id="S5.T2.4.2.3.1" style="font-size:90%;">
         DCG
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.4.2.4">
        <span class="ltx_text" id="S5.T2.4.2.4.1" style="font-size:90%;">
         DIV
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.3.1.1">
        <math alttext="\delta" class="ltx_Math" display="inline" id="S5.T2.3.1.1.m1.1">
         <semantics id="S5.T2.3.1.1.m1.1a">
          <mi id="S5.T2.3.1.1.m1.1.1" mathsize="90%" xref="S5.T2.3.1.1.m1.1.1.cmml">
           δ
          </mi>
          <annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.m1.1b">
           <ci id="S5.T2.3.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.m1.1.1">
            𝛿
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.3.1.1.m1.1c">
           \delta
          </annotation>
         </semantics>
        </math>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.4.2.5">
        <span class="ltx_text" id="S5.T2.4.2.5.1" style="font-size:90%;">
         DCG
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.4.2.6">
        <span class="ltx_text" id="S5.T2.4.2.6.1" style="font-size:90%;">
         DIV
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.4.2.2">
        <math alttext="\delta" class="ltx_Math" display="inline" id="S5.T2.4.2.2.m1.1">
         <semantics id="S5.T2.4.2.2.m1.1a">
          <mi id="S5.T2.4.2.2.m1.1.1" mathsize="90%" xref="S5.T2.4.2.2.m1.1.1.cmml">
           δ
          </mi>
          <annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.m1.1b">
           <ci id="S5.T2.4.2.2.m1.1.1.cmml" xref="S5.T2.4.2.2.m1.1.1">
            𝛿
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.4.2.2.m1.1c">
           \delta
          </annotation>
         </semantics>
        </math>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T2.4.4.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T2.4.4.1.1">
        <span class="ltx_text" id="S5.T2.4.4.1.1.1" style="font-size:90%;">
         Flamingo
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.4.4.1.2">
        <span class="ltx_text" id="S5.T2.4.4.1.2.1" style="font-size:90%;">
         1.4B/3.4B
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.4.4.1.3">
        <span class="ltx_text" id="S5.T2.4.4.1.3.1" style="font-size:90%;">
         0.73
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.4.4.1.4">
        <span class="ltx_text" id="S5.T2.4.4.1.4.1" style="font-size:90%;">
         0.25
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.4.4.1.5">
        <span class="ltx_text" id="S5.T2.4.4.1.5.1" style="font-size:90%;">
         81.7%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.4.4.1.6">
        <span class="ltx_text" id="S5.T2.4.4.1.6.1" style="font-size:90%;">
         0.67
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.4.4.1.7">
        <span class="ltx_text" id="S5.T2.4.4.1.7.1" style="font-size:90%;">
         0.23
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.4.4.1.8">
        <span class="ltx_text" id="S5.T2.4.4.1.8.1" style="font-size:90%;">
         80.6%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.4.5.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.4.5.2.1">
        <span class="ltx_text" id="S5.T2.4.5.2.1.1" style="font-size:90%;">
         BLIP-2
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.4.5.2.2">
        <span class="ltx_text" id="S5.T2.4.5.2.2.1" style="font-size:90%;">
         104M/3.1B
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.5.2.3">
        <span class="ltx_text" id="S5.T2.4.5.2.3.1" style="font-size:90%;">
         0.59
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.5.2.4">
        <span class="ltx_text" id="S5.T2.4.5.2.4.1" style="font-size:90%;">
         0.17
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.5.2.5">
        <span class="ltx_text" id="S5.T2.4.5.2.5.1" style="font-size:90%;">
         68.3%
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.5.2.6">
        <span class="ltx_text" id="S5.T2.4.5.2.6.1" style="font-size:90%;">
         0.47
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.5.2.7">
        <span class="ltx_text" id="S5.T2.4.5.2.7.1" style="font-size:90%;">
         0.18
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.5.2.8">
        <span class="ltx_text" id="S5.T2.4.5.2.8.1" style="font-size:90%;">
         69.2%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.4.6.3">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T2.4.6.3.1">
        <span class="ltx_text" id="S5.T2.4.6.3.1.1" style="font-size:90%;">
         LLaVA
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.4.6.3.2">
        <span class="ltx_text" id="S5.T2.4.6.3.2.1" style="font-size:90%;">
         14M/13B
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.6.3.3">
        <span class="ltx_text" id="S5.T2.4.6.3.3.1" style="font-size:90%;">
         0.60
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.6.3.4">
        <span class="ltx_text" id="S5.T2.4.6.3.4.1" style="font-size:90%;">
         0.25
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.4.6.3.5">
        <span class="ltx_text" id="S5.T2.4.6.3.5.1" style="font-size:90%;">
         73.3%
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.6.3.6">
        <span class="ltx_text" id="S5.T2.4.6.3.6.1" style="font-size:90%;">
         0.47
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.6.3.7">
        <span class="ltx_text" id="S5.T2.4.6.3.7.1" style="font-size:90%;">
         0.24
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.4.6.3.8">
        <span class="ltx_text" id="S5.T2.4.6.3.8.1" style="font-size:90%;">
         76.5%
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.4.7.4">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S5.T2.4.7.4.1">
        <span class="ltx_text ltx_font_typewriter" id="S5.T2.4.7.4.1.1" style="font-size:90%;">
         RL4Sugg
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T2.4.7.4.2">
        <span class="ltx_text" id="S5.T2.4.7.4.2.1" style="font-size:90%;">
         208M/3.1B
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.7.4.3">
        <span class="ltx_text ltx_font_bold" id="S5.T2.4.7.4.3.1" style="font-size:90%;">
         0.89
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.7.4.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.4.7.4.4.1" style="font-size:90%;">
         0.25
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.4.7.4.5">
        <span class="ltx_text ltx_font_bold" id="S5.T2.4.7.4.5.1" style="font-size:90%;">
         83.3%
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.7.4.6">
        <span class="ltx_text ltx_font_bold" id="S5.T2.4.7.4.6.1" style="font-size:90%;">
         0.87
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.7.4.7">
        <span class="ltx_text ltx_font_bold" id="S5.T2.4.7.4.7.1" style="font-size:90%;">
         0.24
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.4.7.4.8">
        <span class="ltx_text ltx_font_bold" id="S5.T2.4.7.4.8.1" style="font-size:90%;">
         86.9%
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="S5.T3">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 3.
     </span>
     Effectiveness of retrieval-based applications, fine-tuned on Business and zero-shot transferred to ImageNet.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S5.T3.1.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T3.1.1.1.1" rowspan="2">
        <span class="ltx_text" id="S5.T3.1.1.1.1.1" style="font-size:90%;">
         Models
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.1.1.2" rowspan="2">
        <span class="ltx_text" id="S5.T3.1.1.1.2.1" style="font-size:90%;">
         <span class="ltx_tabular ltx_align_middle" id="S5.T3.1.1.1.2.1.1">
          <span class="ltx_tr" id="S5.T3.1.1.1.2.1.1.1">
           <span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.1.1.2.1.1.1.1">
            #Train/#Total
           </span>
          </span>
          <span class="ltx_tr" id="S5.T3.1.1.1.2.1.1.2">
           <span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.1.1.2.1.1.2.1">
            Params
           </span>
          </span>
         </span>
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S5.T3.1.1.1.3">
        <span class="ltx_text" id="S5.T3.1.1.1.3.1" style="font-size:90%;">
         Business Fine-tuned
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S5.T3.1.1.1.4">
        <span class="ltx_text" id="S5.T3.1.1.1.4.1" style="font-size:90%;">
         ImageNet 0-shot
        </span>
       </th>
      </tr>
      <tr class="ltx_tr" id="S5.T3.1.2.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T3.1.2.2.1">
        <span class="ltx_text" id="S5.T3.1.2.2.1.1" style="font-size:90%;">
         PNR
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T3.1.2.2.2">
        <span class="ltx_text" id="S5.T3.1.2.2.2.1" style="font-size:90%;">
         R@1
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.2.2.3">
        <span class="ltx_text" id="S5.T3.1.2.2.3.1" style="font-size:90%;">
         R@3
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T3.1.2.2.4">
        <span class="ltx_text" id="S5.T3.1.2.2.4.1" style="font-size:90%;">
         PNR
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T3.1.2.2.5">
        <span class="ltx_text" id="S5.T3.1.2.2.5.1" style="font-size:90%;">
         R@1
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T3.1.2.2.6">
        <span class="ltx_text" id="S5.T3.1.2.2.6.1" style="font-size:90%;">
         R@3
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T3.1.3.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.3.1.1">
        <span class="ltx_text" id="S5.T3.1.3.1.1.1" style="font-size:90%;">
         CLIP
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.3.1.2">
        <span class="ltx_text" id="S5.T3.1.3.1.2.1" style="font-size:90%;">
         300M/300M
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.3">
        <span class="ltx_text" id="S5.T3.1.3.1.3.1" style="font-size:90%;">
         1.30
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.4">
        <span class="ltx_text" id="S5.T3.1.3.1.4.1" style="font-size:90%;">
         0.23
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.1.5">
        <span class="ltx_text" id="S5.T3.1.3.1.5.1" style="font-size:90%;">
         0.33
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.6">
        <span class="ltx_text" id="S5.T3.1.3.1.6.1" style="font-size:90%;">
         0.90
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.7">
        <span class="ltx_text" id="S5.T3.1.3.1.7.1" style="font-size:90%;">
         0.21
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.8">
        <span class="ltx_text" id="S5.T3.1.3.1.8.1" style="font-size:90%;">
         0.32
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T3.1.4.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.4.2.1">
        <span class="ltx_text" id="S5.T3.1.4.2.1.1" style="font-size:90%;">
         BLIP-2
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.1.4.2.2">
        <span class="ltx_text" id="S5.T3.1.4.2.2.1" style="font-size:90%;">
         104M/3.1B
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.3">
        <span class="ltx_text" id="S5.T3.1.4.2.3.1" style="font-size:90%;">
         1.05
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.4">
        <span class="ltx_text" id="S5.T3.1.4.2.4.1" style="font-size:90%;">
         0.27
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.1.4.2.5">
        <span class="ltx_text" id="S5.T3.1.4.2.5.1" style="font-size:90%;">
         0.60
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.6">
        <span class="ltx_text" id="S5.T3.1.4.2.6.1" style="font-size:90%;">
         0.73
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.7">
        <span class="ltx_text" id="S5.T3.1.4.2.7.1" style="font-size:90%;">
         0.26
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.8">
        <span class="ltx_text" id="S5.T3.1.4.2.8.1" style="font-size:90%;">
         0.58
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T3.1.5.3">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="S5.T3.1.5.3.1">
        <span class="ltx_text ltx_font_typewriter" id="S5.T3.1.5.3.1.1" style="font-size:90%;">
         RL4Sugg
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T3.1.5.3.2">
        <span class="ltx_text" id="S5.T3.1.5.3.2.1" style="font-size:90%;">
         208M/3.1B
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.5.3.3">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.3.1" style="font-size:90%;">
         2.80
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.5.3.4">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.4.1" style="font-size:90%;">
         0.63
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.1.5.3.5">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.5.1" style="font-size:90%;">
         0.83
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.5.3.6">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.6.1" style="font-size:90%;">
         2.17
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.5.3.7">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.7.1" style="font-size:90%;">
         0.58
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.1.5.3.8">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.5.3.8.1" style="font-size:90%;">
         0.74
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p1">
    <p class="ltx_p" id="S5.SS2.p1.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">
      (1) Effectiveness evaluation (comparison with baseline methods).
     </span>
     We conduct experiments to evaluate the effectiveness of both the generation and retrieval tasks. The model is fine-tuned on Business (with reported trainable parameters) and directly tested on ImageNet for transferability. For the generation task, we query 300 images on both Business and ImageNet datasets, where
     <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.2">
      RL4Sugg
     </span>
     outperforms all baseline models in terms of DCG, demonstrating strong transferability. The best baseline model, Flamingo, achieves a DCG of 0.73 (18% lower than
     <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.3">
      RL4Sugg
     </span>
     ). All models exhibit similar diversity, except BLIP-2, which occasionally generates synonymous query suggestions, and LLaVA, which tends to produce longer suggestions. Since query suggestions are based on query images containing necessary entities and common grammar structures, overall diversity values for all models are not very high.
For the retrieval task, as shown in Table
     <a class="ltx_ref" href="#S5.T3" title="Table 3 ‣ 5.2. Experimental Results ‣ 5. EXPERIMENTS ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     ,
     <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.4">
      RL4Sugg
     </span>
     shows better PNR and Recall compared with the other two baseline models on both datasets.
    </p>
   </div>
   <figure class="ltx_table" id="S5.T4">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 4.
     </span>
     Ablation study (Business).
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="S5.T4.1.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.1">
        Components
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.2">
        DCG
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.3">
        DIV
       </th>
      </tr>
      <tr class="ltx_tr" id="S5.T4.1.2.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.1">
        <span class="ltx_text ltx_font_typewriter" id="S5.T4.1.2.2.1.1">
         RL4Sugg
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.2">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.2.2.2.1">
         0.89
        </span>
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.3">
        <span class="ltx_text ltx_font_bold" id="S5.T4.1.2.2.3.1">
         0.25
        </span>
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T4.1.3.1">
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.1">
        w/o RLHF (SFT)
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.2">
        0.78
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.3">
        0.24
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T4.1.4.2">
       <td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.1">
        w/o Agent-D (Agent-I only)
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.2">
        0.89
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.3">
        0.19
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T4.1.5.3">
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.1">
        w/o Agent-D (greedy)
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.2">
        0.82
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.3">
        0.23
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="S5.T5">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 5.
     </span>
     Online A/B Test (Business).
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T5.1.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.1.1.1" rowspan="2" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text" id="S5.T5.1.1.1.1.1">
         Metric
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T5.1.1.1.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        Cold-start
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.2.2">
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.2.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        A (old
        <span class="ltx_text ltx_font_typewriter" id="S5.T5.1.2.2.1.1">
         RL4Sugg
        </span>
        )
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.2.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        B (new
        <span class="ltx_text ltx_font_typewriter" id="S5.T5.1.2.2.2.1">
         RL4Sugg
        </span>
        )
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.2.3" style="padding-left:4.5pt;padding-right:4.5pt;">
        Impr
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.3.3">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.3.3.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        # Click behaviors
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T5.1.3.3.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text ltx_font_bold" id="S5.T5.1.3.3.2.1">
         0.46%
        </span>
        (vs. old
        <span class="ltx_text ltx_font_typewriter" id="S5.T5.1.3.3.2.2">
         RL4Sugg
        </span>
        )
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.4.4">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.4.4.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        DCG
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.4.4.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        0.83
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.4.4.3" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text ltx_font_bold" id="S5.T5.1.4.4.3.1">
         0.89
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.4.4.4" style="padding-left:4.5pt;padding-right:4.5pt;">
        6.7%
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.5.5">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.1.5.5.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        GSB
       </th>
       <td class="ltx_td ltx_align_center" colspan="3" id="S5.T5.1.5.5.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text ltx_font_bold" id="S5.T5.1.5.5.2.1">
         8.3%
        </span>
        (vs. old
        <span class="ltx_text ltx_font_typewriter" id="S5.T5.1.5.5.2.2">
         RL4Sugg
        </span>
        )
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.6.6">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.1.6.6.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        PNR
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.6.6.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        2.61
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.6.6.3" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text ltx_font_bold" id="S5.T5.1.6.6.3.1">
         2.80
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.6.6.4" style="padding-left:4.5pt;padding-right:4.5pt;">
        6.8%
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.7.7">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T5.1.7.7.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        R@1
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T5.1.7.7.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        0.57
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T5.1.7.7.3" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text ltx_font_bold" id="S5.T5.1.7.7.3.1">
         0.63
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T5.1.7.7.4" style="padding-left:4.5pt;padding-right:4.5pt;">
        9.5%
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T5.1.8.8">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T5.1.8.8.1" style="padding-left:4.5pt;padding-right:4.5pt;">
        R@3
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.1.8.8.2" style="padding-left:4.5pt;padding-right:4.5pt;">
        0.75
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.1.8.8.3" style="padding-left:4.5pt;padding-right:4.5pt;">
        <span class="ltx_text ltx_font_bold" id="S5.T5.1.8.8.3.1">
         0.83
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.1.8.8.4" style="padding-left:4.5pt;padding-right:4.5pt;">
        9.6%
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p2">
    <p class="ltx_p" id="S5.SS2.p2.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">
      (2) Ablation study.
     </span>
     To evaluate the effectiveness of the two agents in
     <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.2">
      RL4Sugg
     </span>
     , we conduct an ablation study. We replace the RLHF in Agent-I and use the SFT model only; we remove the Agent-D, or replace it with a pre-defined rule of dropping the most similar suggestion within the window. We present the results in Table
     <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5.2. Experimental Results ‣ 5. EXPERIMENTS ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , which demonstrate that both agents contribute to improving the performance. Specifically, removing RLHF training from Agent-I results in a dramatic drop in DCG from 0.89 to 0.78, highlighting RLHF’s ability to capture human intentionality. Removing Agent-D leads to a substantial decrease in diversity from 0.25 to 0.19. Alternatively, using a rule to greedily drop suggestions also reduces diversity and DCG from 0.89 to 0.82, as it lacks consideration for intentionality. The inclusion of Agent-D, which interacts with Agent-I during training, enhances the generation of diversified query suggestions while preserving intentionality.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p3">
    <p class="ltx_p" id="S5.SS2.p3.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">
      (3) Parameter study (varying confidence threshold in data collection).
     </span>
     We investigate the effect of varying confidence threshold in data collection on the generation task and the retrieval task. The results and
detailed analysis are included in Appendix Section
     <a class="ltx_ref" href="#A1.SS6" title="A.6. Parameter Study of Confidence Threshold ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       A.6
      </span>
     </a>
     due to the page limit. Overall, we observe that a moderate threshold can produce good results and save human efforts.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p4">
    <p class="ltx_p" id="S5.SS2.p4.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">
      (4) Online A/B Test.
     </span>
     We conduct an online A/B test to compare the new system (after online learning for the cold-start problem) with the old system for one month. The results as shown in Table
     <a class="ltx_ref" href="#S5.T5" title="Table 5 ‣ 5.2. Experimental Results ‣ 5. EXPERIMENTS ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     demonstrate that the fine-tuned model via online learning can largely improve the overall user experience, e.g., it increases the number of click behaviors by 0.46%. In addition, we collect online cases, and compare the two systems with the real user-generated queries via manual evaluation. We observe that the new system can largely outperform the base system.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S5.SS2.p5">
    <p class="ltx_p" id="S5.SS2.p5.1">
     <span class="ltx_text ltx_font_bold" id="S5.SS2.p5.1.1">
      (5) Qualitative results.
     </span>
     We qualitatively evaluate the generated query suggestions. The detailed visualization results and analysis are in Appendix Section
     <a class="ltx_ref" href="#A1.SS7" title="A.7. Qualitative results ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       A.7
      </span>
     </a>
     due to the page limit. Overall, we observe that the suggestions align well with user search intents.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6.
   </span>
   CONCLUSION
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    In this paper, we introduce a novel Multimodal Query Suggestion (MMQS) framework that addresses the limitations of existing query suggestion systems by incorporating user query images. Through the MMQS approach, we significantly enhance the intentionality and diversity of query suggestions, resulting in a more user-centric and effective search experience. Extensive experiments conducted on two real-world datasets demonstrate a remarkable 18% improvement over the best existing approach. Moreover, our successful deployment of MMQS into real-world products showcases its practicality and potential for providing valuable insights in search engines. As a future direction, we plan to extend MMQS to accommodate other modalities, such as audio or video, to enhance its applicability in diverse real-world scenarios.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     (1)
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Alayrac et al
     <span class="ltx_text" id="bib.bib2.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Jean-Baptiste Alayrac,
Jeff Donahue, Pauline Luc,
Antoine Miech, Iain Barr,
Yana Hasson, Karel Lenc,
Arthur Mensch, Katherine Millican,
Malcolm Reynolds, et al
     <span class="ltx_text" id="bib.bib2.3.1">
      .
     </span>
     2022.
    </span>
    <span class="ltx_bibblock">
     Flamingo: a visual language model for few-shot
learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.4.1">
      NIPS
     </em>
     (2022),
23716–23736.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bar-Yossef and Kraus (2011)
    </span>
    <span class="ltx_bibblock">
     Ziv Bar-Yossef and Naama
Kraus. 2011.
    </span>
    <span class="ltx_bibblock">
     Context-sensitive query auto-completion. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      WWW
     </em>
     . 107–116.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bian et al
     <span class="ltx_text" id="bib.bib4.2.2.1">
      .
     </span>
     (2012)
    </span>
    <span class="ltx_bibblock">
     Jingwen Bian, Zheng-Jun
Zha, Hanwang Zhang, Qi Tian, and
Tat-Seng Chua. 2012.
    </span>
    <span class="ltx_bibblock">
     Visual query attributes suggestion. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">
      MM
     </em>
     . 869–872.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Brown et al
     <span class="ltx_text" id="bib.bib5.2.2.1">
      .
     </span>
     (2020)
    </span>
    <span class="ltx_bibblock">
     Tom Brown, Benjamin Mann,
Nick Ryder, Melanie Subbiah,
Jared D Kaplan, Prafulla Dhariwal,
Arvind Neelakantan, Pranav Shyam,
Girish Sastry, Amanda Askell,
et al
     <span class="ltx_text" id="bib.bib5.3.1">
      .
     </span>
     2020.
    </span>
    <span class="ltx_bibblock">
     Language models are few-shot learners.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.4.1">
      NIPS
     </em>
     33
(2020), 1877–1901.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Carpineto and Romano (2012)
    </span>
    <span class="ltx_bibblock">
     Claudio Carpineto and
Giovanni Romano. 2012.
    </span>
    <span class="ltx_bibblock">
     A survey of automatic query expansion in
information retrieval.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      CSUR
     </em>
     44,
1 (2012), 1–50.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al
     <span class="ltx_text" id="bib.bib7.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Jun Chen, Han Guo,
Kai Yi, Boyang Li, and
Mohamed Elhoseiny. 2022.
    </span>
    <span class="ltx_bibblock">
     Visualgpt: Data-efficient adaptation of pretrained
language models for image captioning. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">
      CVPR
     </em>
     .
18030–18040.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cho et al
     <span class="ltx_text" id="bib.bib8.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Jaemin Cho, Jie Lei,
Hao Tan, and Mohit Bansal.
2021.
    </span>
    <span class="ltx_bibblock">
     Unifying vision-and-language tasks via text
generation. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">
      ICML
     </em>
     . PMLR,
1931–1942.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Cho et al
     <span class="ltx_text" id="bib.bib9.2.2.1">
      .
     </span>
     (2018)
    </span>
    <span class="ltx_bibblock">
     Woon Sang Cho, Pengchuan
Zhang, Yizhe Zhang, Xiujun Li,
Michel Galley, Chris Brockett,
Mengdi Wang, and Jianfeng Gao.
2018.
    </span>
    <span class="ltx_bibblock">
     Towards coherent and cohesive long-form text
generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">
      arXiv preprint
     </em>
     (2018).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Christiano et al
     <span class="ltx_text" id="bib.bib10.2.2.1">
      .
     </span>
     (2017)
    </span>
    <span class="ltx_bibblock">
     Paul F Christiano, Jan
Leike, Tom Brown, Miljan Martic,
Shane Legg, and Dario Amodei.
2017.
    </span>
    <span class="ltx_bibblock">
     Deep reinforcement learning from human
preferences.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">
      NIPS
     </em>
     (2017).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chuklin et al
     <span class="ltx_text" id="bib.bib11.2.2.1">
      .
     </span>
     (2015)
    </span>
    <span class="ltx_bibblock">
     Aleksandr Chuklin, Anne
Schuth, Ke Zhou, and Maarten De
Rijke. 2015.
    </span>
    <span class="ltx_bibblock">
     A comparative analysis of interleaving methods for
aggregated search.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">
      TOIS
     </em>
     33,
2 (2015), 1–38.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Deng et al
     <span class="ltx_text" id="bib.bib12.2.2.1">
      .
     </span>
     (2009)
    </span>
    <span class="ltx_bibblock">
     Jia Deng, Wei Dong,
Richard Socher, Li-Jia Li,
Kai Li, and Li Fei-Fei.
2009.
    </span>
    <span class="ltx_bibblock">
     Imagenet: A large-scale hierarchical image
database. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">
      CVPR
     </em>
     . Ieee,
248–255.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Driess et al
     <span class="ltx_text" id="bib.bib13.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Danny Driess, Fei Xia,
Mehdi SM Sajjadi, Corey Lynch,
Aakanksha Chowdhery, Brian Ichter,
Ayzaan Wahid, Jonathan Tompson,
Quan Vuong, Tianhe Yu, et al
     <span class="ltx_text" id="bib.bib13.3.1">
      .
     </span>
     2023.
    </span>
    <span class="ltx_bibblock">
     Palm-e: An embodied multimodal language model.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.4.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gilardi et al
     <span class="ltx_text" id="bib.bib14.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Fabrizio Gilardi, Meysam
Alizadeh, and Maël Kubli.
2023.
    </span>
    <span class="ltx_bibblock">
     Chatgpt outperforms crowd-workers for
text-annotation tasks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gottlob et al
     <span class="ltx_text" id="bib.bib15.2.2.1">
      .
     </span>
     (2011)
    </span>
    <span class="ltx_bibblock">
     Georg Gottlob, Giorgio
Orsi, and Andreas Pieris.
2011.
    </span>
    <span class="ltx_bibblock">
     Ontological queries: Rewriting and optimization.
In
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">
      ICDE
     </em>
     . IEEE, 2–13.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Gottlob et al
     <span class="ltx_text" id="bib.bib16.2.2.1">
      .
     </span>
     (2014)
    </span>
    <span class="ltx_bibblock">
     Georg Gottlob, Giorgio
Orsi, and Andreas Pieris.
2014.
    </span>
    <span class="ltx_bibblock">
     Query rewriting and optimization for ontological
databases.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">
      TODS
     </em>
     39,
3 (2014), 1–46.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Guo et al
     <span class="ltx_text" id="bib.bib17.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Jiaxian Guo, Junnan Li,
Dongxu Li, Anthony Meng Huat Tiong,
Boyang Li, Dacheng Tao, and
Steven CH Hoi. 2022.
    </span>
    <span class="ltx_bibblock">
     From Images to Textual Prompts: Zero-shot VQA with
Frozen Large Language Models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">
      arXiv preprint
     </em>
     (2022).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hagen et al
     <span class="ltx_text" id="bib.bib18.2.2.1">
      .
     </span>
     (2017)
    </span>
    <span class="ltx_bibblock">
     Matthias Hagen, Martin
Potthast, Marcel Gohsen, Anja Rathgeber,
and Benno Stein. 2017.
    </span>
    <span class="ltx_bibblock">
     A large-scale query spelling correction corpus. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">
      SIGIR
     </em>
     . 1261–1264.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Huang et al
     <span class="ltx_text" id="bib.bib19.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Shaohan Huang, Li Dong,
Wenhui Wang, Yaru Hao,
Saksham Singhal, Shuming Ma,
Tengchao Lv, Lei Cui,
Owais Khan Mohammed, Qiang Liu,
et al
     <span class="ltx_text" id="bib.bib19.3.1">
      .
     </span>
     2023.
    </span>
    <span class="ltx_bibblock">
     Language is not all you need: Aligning perception
with language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.4.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jaques et al
     <span class="ltx_text" id="bib.bib20.2.2.1">
      .
     </span>
     (2019)
    </span>
    <span class="ltx_bibblock">
     Natasha Jaques, Asma
Ghandeharioun, Judy Hanwen Shen, Craig
Ferguson, Agata Lapedriza, Noah Jones,
Shixiang Gu, and Rosalind Picard.
2019.
    </span>
    <span class="ltx_bibblock">
     Way off-policy batch deep reinforcement learning of
implicit human preferences in dialog.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">
      arXiv preprint
     </em>
     (2019).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jarvelin (2000)
    </span>
    <span class="ltx_bibblock">
     Kalervo Jarvelin.
2000.
    </span>
    <span class="ltx_bibblock">
     IR evaluation methods for retrieving highly
relevant documents. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      SIGIR
     </em>
     .
41–48.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Jia et al
     <span class="ltx_text" id="bib.bib22.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Chao Jia, Yinfei Yang,
Ye Xia, Yi-Ting Chen,
Zarana Parekh, Hieu Pham,
Quoc Le, Yun-Hsuan Sung,
Zhen Li, and Tom Duerig.
2021.
    </span>
    <span class="ltx_bibblock">
     Scaling up visual and vision-language
representation learning with noisy text supervision. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">
      ICML
     </em>
     . PMLR, 4904–4916.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kreutzer et al
     <span class="ltx_text" id="bib.bib23.2.2.1">
      .
     </span>
     (2018)
    </span>
    <span class="ltx_bibblock">
     Julia Kreutzer, Shahram
Khadivi, Evgeny Matusov, and Stefan
Riezler. 2018.
    </span>
    <span class="ltx_bibblock">
     Can neural machine translation be improved with
user feedback?
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">
      arXiv preprint
     </em>
     (2018).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lam-Adesina and Jones (2001)
    </span>
    <span class="ltx_bibblock">
     Adenike M Lam-Adesina and
Gareth JF Jones. 2001.
    </span>
    <span class="ltx_bibblock">
     Applying summarization techniques for term
selection in relevance feedback. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      SIGIR
     </em>
     .
1–9.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lawrence and Riezler (2018)
    </span>
    <span class="ltx_bibblock">
     Carolin Lawrence and
Stefan Riezler. 2018.
    </span>
    <span class="ltx_bibblock">
     Improving a neural semantic parser by
counterfactual learning from human bandit feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      arXiv preprint
     </em>
     (2018).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al
     <span class="ltx_text" id="bib.bib26.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Junnan Li, Dongxu Li,
Silvio Savarese, and Steven Hoi.
2023.
    </span>
    <span class="ltx_bibblock">
     Blip-2: Bootstrapping language-image pre-training
with frozen image encoders and large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al
     <span class="ltx_text" id="bib.bib27.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Junnan Li, Dongxu Li,
Caiming Xiong, and Steven Hoi.
2022.
    </span>
    <span class="ltx_bibblock">
     Blip: Bootstrapping language-image pre-training for
unified vision-language understanding and generation. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">
      ICML
     </em>
     . PMLR, 12888–12900.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al
     <span class="ltx_text" id="bib.bib28.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Junnan Li, Ramprasaath
Selvaraju, Akhilesh Gotmare, Shafiq
Joty, Caiming Xiong, and Steven
Chu Hong Hoi. 2021.
    </span>
    <span class="ltx_bibblock">
     Align before fuse: Vision and language
representation learning with momentum distillation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">
      NIPS
     </em>
     34
(2021), 9694–9705.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li and Li (2011)
    </span>
    <span class="ltx_bibblock">
     Lusong Li and Jing Li.
2011.
    </span>
    <span class="ltx_bibblock">
     MQSS: multimodal query suggestion and searching for
video search.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      Multimedia Tools and Applications
     </em>
     54 (2011), 55–68.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lin et al
     <span class="ltx_text" id="bib.bib30.2.2.1">
      .
     </span>
     (2014)
    </span>
    <span class="ltx_bibblock">
     Tsung-Yi Lin, Michael
Maire, Serge Belongie, James Hays,
Pietro Perona, Deva Ramanan,
Piotr Dollár, and C Lawrence
Zitnick. 2014.
    </span>
    <span class="ltx_bibblock">
     Microsoft coco: Common objects in context. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">
      ECCV
     </em>
     . Springer, 740–755.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al
     <span class="ltx_text" id="bib.bib31.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Haotian Liu, Chunyuan Li,
Qingyang Wu, and Yong Jae Lee.
2023.
    </span>
    <span class="ltx_bibblock">
     Visual instruction tuning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Liu et al
     <span class="ltx_text" id="bib.bib32.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Yiding Liu, Weixue Lu,
Suqi Cheng, Daiting Shi,
Shuaiqiang Wang, Zhicong Cheng, and
Dawei Yin. 2021.
    </span>
    <span class="ltx_bibblock">
     Pre-trained language model for web-scale retrieval
in baidu search. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">
      SIGKDD
     </em>
     .
3365–3375.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     OpenAI (2023)
    </span>
    <span class="ltx_bibblock">
     OpenAI. 2023.
    </span>
    <span class="ltx_bibblock">
     GPT-4 Technical Report.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al
     <span class="ltx_text" id="bib.bib34.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Long Ouyang, Jeffrey Wu,
Xu Jiang, Diogo Almeida,
Carroll Wainwright, Pamela Mishkin,
Chong Zhang, Sandhini Agarwal,
Katarina Slama, Alex Ray,
et al
     <span class="ltx_text" id="bib.bib34.3.1">
      .
     </span>
     2022.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions
with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.4.1">
      NIPS
     </em>
     35
(2022), 27730–27744.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Plummer et al
     <span class="ltx_text" id="bib.bib35.2.2.1">
      .
     </span>
     (2015)
    </span>
    <span class="ltx_bibblock">
     Bryan A Plummer, Liwei
Wang, Chris M Cervantes, Juan C Caicedo,
Julia Hockenmaier, and Svetlana
Lazebnik. 2015.
    </span>
    <span class="ltx_bibblock">
     Flickr30k entities: Collecting region-to-phrase
correspondences for richer image-to-sentence models. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">
      ICCV
     </em>
     . 2641–2649.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Radford et al
     <span class="ltx_text" id="bib.bib36.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Alec Radford, Jong Wook
Kim, Chris Hallacy, Aditya Ramesh,
Gabriel Goh, Sandhini Agarwal,
Girish Sastry, Amanda Askell,
Pamela Mishkin, Jack Clark,
et al
     <span class="ltx_text" id="bib.bib36.3.1">
      .
     </span>
     2021.
    </span>
    <span class="ltx_bibblock">
     Learning transferable visual models from natural
language supervision. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.4.1">
      ICML
     </em>
     . PMLR,
8748–8763.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Reimers and Gurevych (2019)
    </span>
    <span class="ltx_bibblock">
     Nils Reimers and Iryna
Gurevych. 2019.
    </span>
    <span class="ltx_bibblock">
     Sentence-bert: Sentence embeddings using siamese
bert-networks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      EMNLP
     </em>
     (2019).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al
     <span class="ltx_text" id="bib.bib38.2.2.1">
      .
     </span>
     (2017)
    </span>
    <span class="ltx_bibblock">
     John Schulman, Filip
Wolski, Prafulla Dhariwal, Alec Radford,
and Oleg Klimov. 2017.
    </span>
    <span class="ltx_bibblock">
     Proximal policy optimization algorithms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">
      arXiv preprint
     </em>
     (2017).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shen et al
     <span class="ltx_text" id="bib.bib39.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Yongliang Shen, Kaitao
Song, Xu Tan, Dongsheng Li,
Weiming Lu, and Yueting Zhuang.
2023.
    </span>
    <span class="ltx_bibblock">
     Hugginggpt: Solving ai tasks with chatgpt and its
friends in huggingface.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shokouhi (2013)
    </span>
    <span class="ltx_bibblock">
     Milad Shokouhi.
2013.
    </span>
    <span class="ltx_bibblock">
     Learning to personalize query auto-completion. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      SIGIR
     </em>
     . 103–112.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Silver et al
     <span class="ltx_text" id="bib.bib41.2.2.1">
      .
     </span>
     (2014)
    </span>
    <span class="ltx_bibblock">
     David Silver, Guy Lever,
Nicolas Heess, Thomas Degris,
Daan Wierstra, and Martin Riedmiller.
2014.
    </span>
    <span class="ltx_bibblock">
     Deterministic policy gradient algorithms. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">
      ICML
     </em>
     . PMLR, 387–395.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al
     <span class="ltx_text" id="bib.bib42.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Wenhui Wang, Hangbo Bao,
Li Dong, Johan Bjorck,
Zhiliang Peng, Qiang Liu,
Kriti Aggarwal, Owais Khan Mohammed,
Saksham Singhal, Subhojit Som,
et al
     <span class="ltx_text" id="bib.bib42.3.1">
      .
     </span>
     2023.
    </span>
    <span class="ltx_bibblock">
     Image as a Foreign Language: BEiT Pretraining for
Vision and Vision-Language Tasks. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.4.1">
      CVPR
     </em>
     .
19175–19186.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wang et al
     <span class="ltx_text" id="bib.bib43.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Zirui Wang, Jiahui Yu,
Adams Wei Yu, Zihang Dai,
Yulia Tsvetkov, and Yuan Cao.
2021.
    </span>
    <span class="ltx_bibblock">
     Simvlm: Simple visual language model pretraining
with weak supervision.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">
      arXiv preprint
     </em>
     (2021).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Williams (1992)
    </span>
    <span class="ltx_bibblock">
     Ronald J Williams.
1992.
    </span>
    <span class="ltx_bibblock">
     Simple statistical gradient-following algorithms
for connectionist reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">
      Machine learning
     </em>
     8,
3 (1992), 229–256.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al
     <span class="ltx_text" id="bib.bib45.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Chenfei Wu, Shengming
Yin, Weizhen Qi, Xiaodong Wang,
Zecheng Tang, and Nan Duan.
2023.
    </span>
    <span class="ltx_bibblock">
     Visual chatgpt: Talking, drawing and editing with
visual foundation models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al
     <span class="ltx_text" id="bib.bib46.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Jeff Wu, Long Ouyang,
Daniel M Ziegler, Nisan Stiennon,
Ryan Lowe, Jan Leike, and
Paul Christiano. 2021.
    </span>
    <span class="ltx_bibblock">
     Recursively summarizing books with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">
      arXiv preprint
     </em>
     (2021).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Xu and Croft (2017)
    </span>
    <span class="ltx_bibblock">
     Jinxi Xu and W Bruce
Croft. 2017.
    </span>
    <span class="ltx_bibblock">
     Quary expansion using local and global document
analysis. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      Acm sigir forum
     </em>
     ,
Vol. 51. ACM New York, NY, USA, 168–175.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yang et al
     <span class="ltx_text" id="bib.bib48.2.2.1">
      .
     </span>
     (2023)
    </span>
    <span class="ltx_bibblock">
     Zhengyuan Yang, Linjie
Li, Jianfeng Wang, Kevin Lin,
Ehsan Azarnasab, Faisal Ahmed,
Zicheng Liu, Ce Liu,
Michael Zeng, and Lijuan Wang.
2023.
    </span>
    <span class="ltx_bibblock">
     Mm-react: Prompting chatgpt for multimodal
reasoning and action.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">
      arXiv preprint
     </em>
     (2023).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yi et al
     <span class="ltx_text" id="bib.bib49.2.2.1">
      .
     </span>
     (2019)
    </span>
    <span class="ltx_bibblock">
     Sanghyun Yi, Rahul Goel,
Chandra Khatri, Alessandra Cervone,
Tagyoung Chung, Behnam Hedayatnia,
Anu Venkatesh, Raefer Gabriel, and
Dilek Hakkani-Tur. 2019.
    </span>
    <span class="ltx_bibblock">
     Towards coherent and engaging spoken dialog
response generation using automatic conversation evaluators.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">
      arXiv preprint
     </em>
     (2019).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zeng et al
     <span class="ltx_text" id="bib.bib50.2.2.1">
      .
     </span>
     (2017)
    </span>
    <span class="ltx_bibblock">
     Zhaoyang Zeng, Jianlong
Fu, Hongyang Chao, and Tao Mei.
2017.
    </span>
    <span class="ltx_bibblock">
     Searching personal photos on the phone with instant
visual query suggestion and joint text-image hashing. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">
      MM
     </em>
     . 118–126.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zha et al
     <span class="ltx_text" id="bib.bib51.2.2.1">
      .
     </span>
     (2009)
    </span>
    <span class="ltx_bibblock">
     Zheng-Jun Zha, Linjun
Yang, Tao Mei, Meng Wang, and
Zengfu Wang. 2009.
    </span>
    <span class="ltx_bibblock">
     Visual query suggestion. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">
      MM
     </em>
     . 15–24.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zha et al
     <span class="ltx_text" id="bib.bib52.2.2.1">
      .
     </span>
     (2010)
    </span>
    <span class="ltx_bibblock">
     Zheng-Jun Zha, Linjun
Yang, Tao Mei, Meng Wang,
Zengfu Wang, Tat-Seng Chua, and
Xian-Sheng Hua. 2010.
    </span>
    <span class="ltx_bibblock">
     Visual query suggestion: Towards capturing user
intent in internet image search.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">
      TOMM
     </em>
     6,
3 (2010), 1–19.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhai et al
     <span class="ltx_text" id="bib.bib53.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Xiaohua Zhai, Xiao Wang,
Basil Mustafa, Andreas Steiner,
Daniel Keysers, Alexander Kolesnikov,
and Lucas Beyer. 2022.
    </span>
    <span class="ltx_bibblock">
     Lit: Zero-shot transfer with locked-image text
tuning. In
     <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">
      CVPR
     </em>
     . 18123–18133.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al
     <span class="ltx_text" id="bib.bib54.2.2.1">
      .
     </span>
     (2021)
    </span>
    <span class="ltx_bibblock">
     Pengchuan Zhang, Xiujun
Li, Xiaowei Hu, Jianwei Yang,
Lei Zhang, Lijuan Wang,
Yejin Choi, and Jianfeng Gao.
2021.
    </span>
    <span class="ltx_bibblock">
     Vinvl: Making visual representations matter in
vision-language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">
      arXiv preprint
     </em>
     1,
6 (2021), 8.
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al
     <span class="ltx_text" id="bib.bib55.2.2.1">
      .
     </span>
     (2022)
    </span>
    <span class="ltx_bibblock">
     Susan Zhang, Stephen
Roller, Naman Goyal, Mikel Artetxe,
Moya Chen, Shuohui Chen,
Christopher Dewan, Mona Diab,
Xian Li, Xi Victoria Lin,
et al
     <span class="ltx_text" id="bib.bib55.3.1">
      .
     </span>
     2022.
    </span>
    <span class="ltx_bibblock">
     Opt: Open pre-trained transformer language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib55.4.1">
      arXiv preprint
     </em>
     (2022).
    </span>
    <span class="ltx_bibblock">
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Appendix
  </h2>
  <section class="ltx_subsection" id="A1.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.1.
    </span>
    Data Collection Details
   </h3>
   <div class="ltx_para" id="A1.SS1.p1">
    <p class="ltx_p" id="A1.SS1.p1.1">
     The data collection process involves three key steps, which are presented below:
    </p>
   </div>
   <div class="ltx_para" id="A1.SS1.p2">
    <p class="ltx_p" id="A1.SS1.p2.1">
     <em class="ltx_emph ltx_font_italic" id="A1.SS1.p2.1.1">
      Step 1: Candidate Suggestion Generation
     </em>
     .
Leveraging extracted information (e.g., captions) from an image, GPT-4 initially employs its language generation capabilities to generate multiple candidate suggestions. These suggestions are designed to capture various aspects of the image, providing a wide range of options that may align with their interests.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS1.p3">
    <p class="ltx_p" id="A1.SS1.p3.1">
     <em class="ltx_emph ltx_font_italic" id="A1.SS1.p3.1.1">
      Step 2: Labeling and Confidence Estimation
     </em>
     .
Once the candidate suggestions are generated, GPT-4 further proceeds to label each suggestion based on its relevance to the image and potential user intent. The process enables GPT-4 to assign a binary label (i.e., 1 or 0) to each suggestion, indicating the user interest in clicking the suggestion for a given query image or not. In addition, GPT-4 provides a confidence score (ranging from 0 to 1) associated with each label, which serves as an indicator of the model’s certainty in its own labels.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS1.p4">
    <p class="ltx_p" id="A1.SS1.p4.1">
     <em class="ltx_emph ltx_font_italic" id="A1.SS1.p4.1.1">
      Step 3: Threshold-based Annotation
     </em>
     .
To mitigate the reliance on manual annotation while maintaining annotation quality, we introduce a threshold-based mechanism. The confidence scores generated by GPT-4 are used to indicate the quality of the suggested annotations. By setting a threshold value, suggestions with low confidence scores are identified for further manual annotation. This approach reduces the burden of extensive manual annotation while ensuring that suggestions with lower confidence are subject to human review.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.2.
    </span>
    Baseline Details
   </h3>
   <div class="ltx_para" id="A1.SS2.p1">
    <p class="ltx_p" id="A1.SS2.p1.1">
     We compare
     <span class="ltx_text ltx_font_typewriter" id="A1.SS2.p1.1.1">
      RL4Sugg
     </span>
     with the following baseline methods, and the details are presented below:
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p2">
    <p class="ltx_p" id="A1.SS2.p2.1">
     <math alttext="\bullet" class="ltx_Math" display="inline" id="A1.SS2.p2.1.m1.1">
      <semantics id="A1.SS2.p2.1.m1.1a">
       <mo id="A1.SS2.p2.1.m1.1.1" xref="A1.SS2.p2.1.m1.1.1.cmml">
        ∙
       </mo>
       <annotation-xml encoding="MathML-Content" id="A1.SS2.p2.1.m1.1b">
        <ci id="A1.SS2.p2.1.m1.1.1.cmml" xref="A1.SS2.p2.1.m1.1.1">
         ∙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS2.p2.1.m1.1c">
        \bullet
       </annotation>
      </semantics>
     </math>
     Flamingo
     <cite class="ltx_cite ltx_citemacro_citep">
      (Alayrac et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib2" title="">
       2022
      </a>
      )
     </cite>
     : it freezes the image encoders and language models during the fine-tuning process, and the language model learns to use visual features by adding cross-attention layers.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p3">
    <p class="ltx_p" id="A1.SS2.p3.1">
     <math alttext="\bullet" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1">
      <semantics id="A1.SS2.p3.1.m1.1a">
       <mo id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml">
        ∙
       </mo>
       <annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b">
        <ci id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">
         ∙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">
        \bullet
       </annotation>
      </semantics>
     </math>
     BLIP-2
     <cite class="ltx_cite ltx_citemacro_citep">
      (Li et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib26" title="">
       2023
      </a>
      )
     </cite>
     : it bridges the modality gap between image and language with a lightweight Transformer adapter, which trains following a two-stage strategy, i.e., vision-and-language representation learning, then vision-to-language generative learning.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p4">
    <p class="ltx_p" id="A1.SS2.p4.1">
     <math alttext="\bullet" class="ltx_Math" display="inline" id="A1.SS2.p4.1.m1.1">
      <semantics id="A1.SS2.p4.1.m1.1a">
       <mo id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml">
        ∙
       </mo>
       <annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b">
        <ci id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">
         ∙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">
        \bullet
       </annotation>
      </semantics>
     </math>
     LLaVA
     <cite class="ltx_cite ltx_citemacro_citep">
      (Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib31" title="">
       2023
      </a>
      )
     </cite>
     : it studies an automatic strategy for generating language-image instruction-following dataset, and a multimodal model connecting the image encoder and the language model is trained end-to-end based on the dataset.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS2.p5">
    <p class="ltx_p" id="A1.SS2.p5.1">
     <math alttext="\bullet" class="ltx_Math" display="inline" id="A1.SS2.p5.1.m1.1">
      <semantics id="A1.SS2.p5.1.m1.1a">
       <mo id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml">
        ∙
       </mo>
       <annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b">
        <ci id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">
         ∙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">
        \bullet
       </annotation>
      </semantics>
     </math>
     CLIP
     <cite class="ltx_cite ltx_citemacro_citep">
      (Radford et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib36" title="">
       2021
      </a>
      )
     </cite>
     : it leverages contrastive language-image pre-training to produce highly effective image and text representations, which can transfer well to different tasks.
    </p>
   </div>
   <figure class="ltx_table" id="A1.T6">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 6.
     </span>
     Hyperparameters for training SFT.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T6.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A1.T6.1.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.1.1.1.1">
        Stages
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.1.1.1.2">
        Stage 1
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.1.1.1.3">
        Stage 2
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.2.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T6.1.2.2.1">
        Pretrained model
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.1.2.2.2">
        blip2-pretrain
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T6.1.2.2.3">
        blip2-sft_stage1
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.3.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.3.3.1">
        Epochs
       </th>
       <td class="ltx_td ltx_align_center" colspan="2" id="A1.T6.1.3.3.2">
        10
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.4.4.1">
        Learning rate schedule
       </th>
       <td class="ltx_td ltx_align_center" colspan="2" id="A1.T6.1.4.4.2">
        linear_warmup_cosine_lr
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.5.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.5.5.1">
        Warmup learning rate
       </th>
       <td class="ltx_td ltx_align_center" colspan="2" id="A1.T6.1.5.5.2">
        1e-6
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.6.6">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.6.6.1">
        Initial learning rate
       </th>
       <td class="ltx_td ltx_align_center" colspan="2" id="A1.T6.1.6.6.2">
        1e-4
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.7.7">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.7.7.1">
        Minimum learning rate
       </th>
       <td class="ltx_td ltx_align_center" colspan="2" id="A1.T6.1.7.7.2">
        1e-5
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.8.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.8.8.1">
        Warmup steps
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T6.1.8.8.2">
        5000
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T6.1.8.8.3">
        2000
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.9.9">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.9.9.1">
        Weight decay
       </th>
       <td class="ltx_td ltx_align_center" colspan="2" id="A1.T6.1.9.9.2">
        0.05
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.10.10">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T6.1.10.10.1">
        Batch size
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T6.1.10.10.2">
        64
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T6.1.10.10.3">
        16
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T6.1.11.11">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T6.1.11.11.1">
        Image resolution
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" colspan="2" id="A1.T6.1.11.11.2">
        224
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="A1.T7">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 7.
     </span>
     Hyperparameters for training RewardNet.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T7.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A1.T7.1.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.1.1.1">
        Stages
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.1.1.2">
        Stage 1
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.2.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T7.1.2.2.1">
        Pretrained model
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T7.1.2.2.2">
        blip2-sft_stage1
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.3.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.3.3.1">
        Epochs
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.3.3.2">
        10
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.4.4.1">
        Learning rate schedule
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.4.4.2">
        linear_warmup_cosine_lr
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.5.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.5.5.1">
        Warmup learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.5.5.2">
        1e-6
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.6.6">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.6.6.1">
        Initial learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.6.6.2">
        1e-4
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.7.7">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.7.7.1">
        Minimum learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.7.7.2">
        1e-5
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.8.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.8.8.1">
        Warmup steps
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.8.8.2">
        5000
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.9.9">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.9.9.1">
        Weight decay
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.9.9.2">
        0.05
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.10.10">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T7.1.10.10.1">
        Batch size
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T7.1.10.10.2">
        64
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T7.1.11.11">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T7.1.11.11.1">
        Image resolution
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T7.1.11.11.2">
        224
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="A1.T8">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 8.
     </span>
     Hyperparameters for training PolicyNet.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T8.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A1.T8.1.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T8.1.1.1.1">
        Stages
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.1.1.1.2">
        Stage 2
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.2.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T8.1.2.2.1">
        Pretrained model
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T8.1.2.2.2">
        blip2-sft_stage2
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.3.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.3.3.1">
        Epochs
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.3.3.2">
        10
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.4.4.1">
        Learning rate schedule
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.4.4.2">
        linear_warmup_cosine_lr
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.5.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.5.5.1">
        Warmup learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.5.5.2">
        1e-6
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.6.6">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.6.6.1">
        Initial learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.6.6.2">
        1e-4
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.7.7">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.7.7.1">
        Minimum learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.7.7.2">
        1e-5
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.8.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.8.8.1">
        Warmup steps
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.8.8.2">
        2000
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.9.9">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.9.9.1">
        Weight decay
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.9.9.2">
        0.05
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.10.10">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T8.1.10.10.1">
        Batch size
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T8.1.10.10.2">
        50
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T8.1.11.11">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T8.1.11.11.1">
        Image resolution
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T8.1.11.11.2">
        224
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="A1.T9">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 9.
     </span>
     Hyperparameters for training Agent-D.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T9.1">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="A1.T9.1.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A1.T9.1.1.1.1">
        Approach
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T9.1.1.1.2">
        Policy gradient
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A1.T9.1.2.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T9.1.2.1.1">
        Optimizer
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T9.1.2.1.2">
        Adam
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T9.1.3.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A1.T9.1.3.2.1">
        Learning rate
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T9.1.3.2.2">
        1e-3
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T9.1.4.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="A1.T9.1.4.3.1">
        Discount factor
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b" id="A1.T9.1.4.3.2">
        0.99
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
  </section>
  <section class="ltx_subsection" id="A1.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.3.
    </span>
    Implementation Details
   </h3>
   <div class="ltx_para ltx_noindent" id="A1.SS3.p1">
    <p class="ltx_p" id="A1.SS3.p1.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS3.p1.1.1">
      Agent-I Training.
     </span>
     Our
     <span class="ltx_text ltx_font_typewriter" id="A1.SS3.p1.1.2">
      RL4sugg
     </span>
     model is composed of two agents: Agent-I and Agent-D. Agent-I has two modules: RewardNet and PolicyNet. Before training these modules, we fine-tune the BLIP-2 model for its two stages to obtain an SFT model on the COCO dataset. Since the COCO dataset has image captions instead of query suggestions, we input these captions to the GPT model as context prompts and ask it to output query suggestions. We then pair up the image and query suggestions and use these image-suggestion pairs to fine-tune the BLIP-2 model.
During the two stages of training, we use the checkpoint of stage 1 (resp. stage 2) to initialize the RewardNet (resp. PolicyNet). After initialization, we train RewardNet (resp. PolicyNet) on the Business (resp. Flickr30k) dataset. The Business dataset is constructed in the form of image-suggestion pairs, so it can be used for this training directly. Additionally, we only use images in Flickr30k for this training. Specifically, these images are fed into PolicyNet, which generates 20 query suggestions. These image-suggestion pairs are then sent to RewardNet to get rewards, which are further used for training PolicyNet.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS3.p2">
    <p class="ltx_p" id="A1.SS3.p2.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS3.p2.1.1">
      Agent-D Training.
     </span>
     Agent-D is a network that consists of three fully-connected layers. The number of neurons in each layer is 512, 128, and 3, respectively.
The dropout rate for hidden layers is 0.5, and the activation function is ReLU. It is pre-trained before being integrated into the
     <span class="ltx_text ltx_font_typewriter" id="A1.SS3.p2.1.2">
      RL4Sugg
     </span>
     model. Specifically, Agent-D first learns to select some diversified suggestions from many candidate suggestions during pre-training. Then, it trains with Agent-I to optimize both intentionality and diversity. During pre-training, we sample 100 sets of candidate suggestions from the training dataset. For each set, we generate 200 episodes for policy gradient. Each episode involves around 20 steps, resulting in approximately 4 million transition steps during the learning process. At each step, we sample an action using the probability outputted by the softmax function at the current state.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="A1.SS3.p3">
    <p class="ltx_p" id="A1.SS3.p3.1">
     <span class="ltx_text ltx_font_bold" id="A1.SS3.p3.1.1">
      Training time.
     </span>
     Using a machine with 8 Nvidia RTX 3090 (24GB memory), it takes 6 hours to fine-tune the BLIP-2 model to obtain the SFT model and 2 hours for pre-training Agent-D. In Agent-I, RewardNet takes 1.5 hours while PolicyNet requires 4.5 hours for training.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS3.p4">
    <p class="ltx_p" id="A1.SS3.p4.1">
     We summarize the hyperparameter settings for training the SFT model, RewardNet, PolicyNet and Agent-D in Table
     <a class="ltx_ref" href="#A1.T6" title="Table 6 ‣ A.2. Baseline Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     , Table
     <a class="ltx_ref" href="#A1.T7" title="Table 7 ‣ A.2. Baseline Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     , Table
     <a class="ltx_ref" href="#A1.T8" title="Table 8 ‣ A.2. Baseline Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     and Table
     <a class="ltx_ref" href="#A1.T9" title="Table 9 ‣ A.2. Baseline Details ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     , respectively.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.4.
    </span>
    Evaluation Metrics
   </h3>
   <div class="ltx_para" id="A1.SS4.p1">
    <p class="ltx_p" id="A1.SS4.p1.9">
     For the generation task, we report Discounted Cumulative Gain (DCG) and Good vs. Same vs. Bad (GSB) by following
     <cite class="ltx_cite ltx_citemacro_citep">
      (Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2021
      </a>
      ; Chuklin et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2015
      </a>
      )
     </cite>
     . For DCG, it is to evaluate the effectiveness of a list of suggestions produced by a system. The DCG is defined as follows:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx9">
     <tbody id="A1.E11">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (11)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle DCG=\sum_{i=1}^{K}\frac{rel_{i}}{\log_{2}(i+1)}," class="ltx_Math" display="inline" id="A1.E11.m1.3">
         <semantics id="A1.E11.m1.3a">
          <mrow id="A1.E11.m1.3.3.1" xref="A1.E11.m1.3.3.1.1.cmml">
           <mrow id="A1.E11.m1.3.3.1.1" xref="A1.E11.m1.3.3.1.1.cmml">
            <mrow id="A1.E11.m1.3.3.1.1.2" xref="A1.E11.m1.3.3.1.1.2.cmml">
             <mi id="A1.E11.m1.3.3.1.1.2.2" xref="A1.E11.m1.3.3.1.1.2.2.cmml">
              D
             </mi>
             <mo id="A1.E11.m1.3.3.1.1.2.1" lspace="0em" rspace="0em" xref="A1.E11.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E11.m1.3.3.1.1.2.3" xref="A1.E11.m1.3.3.1.1.2.3.cmml">
              C
             </mi>
             <mo id="A1.E11.m1.3.3.1.1.2.1a" lspace="0em" rspace="0em" xref="A1.E11.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E11.m1.3.3.1.1.2.4" xref="A1.E11.m1.3.3.1.1.2.4.cmml">
              G
             </mi>
            </mrow>
            <mo id="A1.E11.m1.3.3.1.1.1" xref="A1.E11.m1.3.3.1.1.1.cmml">
             =
            </mo>
            <mrow id="A1.E11.m1.3.3.1.1.3" xref="A1.E11.m1.3.3.1.1.3.cmml">
             <mstyle displaystyle="true" id="A1.E11.m1.3.3.1.1.3.1" xref="A1.E11.m1.3.3.1.1.3.1.cmml">
              <munderover id="A1.E11.m1.3.3.1.1.3.1a" xref="A1.E11.m1.3.3.1.1.3.1.cmml">
               <mo id="A1.E11.m1.3.3.1.1.3.1.2.2" movablelimits="false" xref="A1.E11.m1.3.3.1.1.3.1.2.2.cmml">
                ∑
               </mo>
               <mrow id="A1.E11.m1.3.3.1.1.3.1.2.3" xref="A1.E11.m1.3.3.1.1.3.1.2.3.cmml">
                <mi id="A1.E11.m1.3.3.1.1.3.1.2.3.2" xref="A1.E11.m1.3.3.1.1.3.1.2.3.2.cmml">
                 i
                </mi>
                <mo id="A1.E11.m1.3.3.1.1.3.1.2.3.1" xref="A1.E11.m1.3.3.1.1.3.1.2.3.1.cmml">
                 =
                </mo>
                <mn id="A1.E11.m1.3.3.1.1.3.1.2.3.3" xref="A1.E11.m1.3.3.1.1.3.1.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="A1.E11.m1.3.3.1.1.3.1.3" xref="A1.E11.m1.3.3.1.1.3.1.3.cmml">
                K
               </mi>
              </munderover>
             </mstyle>
             <mstyle displaystyle="true" id="A1.E11.m1.2.2" xref="A1.E11.m1.2.2.cmml">
              <mfrac id="A1.E11.m1.2.2a" xref="A1.E11.m1.2.2.cmml">
               <mrow id="A1.E11.m1.2.2.4" xref="A1.E11.m1.2.2.4.cmml">
                <mi id="A1.E11.m1.2.2.4.2" xref="A1.E11.m1.2.2.4.2.cmml">
                 r
                </mi>
                <mo id="A1.E11.m1.2.2.4.1" lspace="0em" rspace="0em" xref="A1.E11.m1.2.2.4.1.cmml">
                 ​
                </mo>
                <mi id="A1.E11.m1.2.2.4.3" xref="A1.E11.m1.2.2.4.3.cmml">
                 e
                </mi>
                <mo id="A1.E11.m1.2.2.4.1a" lspace="0em" rspace="0em" xref="A1.E11.m1.2.2.4.1.cmml">
                 ​
                </mo>
                <msub id="A1.E11.m1.2.2.4.4" xref="A1.E11.m1.2.2.4.4.cmml">
                 <mi id="A1.E11.m1.2.2.4.4.2" xref="A1.E11.m1.2.2.4.4.2.cmml">
                  l
                 </mi>
                 <mi id="A1.E11.m1.2.2.4.4.3" xref="A1.E11.m1.2.2.4.4.3.cmml">
                  i
                 </mi>
                </msub>
               </mrow>
               <mrow id="A1.E11.m1.2.2.2.2" xref="A1.E11.m1.2.2.2.3.cmml">
                <msub id="A1.E11.m1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.cmml">
                 <mi id="A1.E11.m1.1.1.1.1.1.2" xref="A1.E11.m1.1.1.1.1.1.2.cmml">
                  log
                 </mi>
                 <mn id="A1.E11.m1.1.1.1.1.1.3" xref="A1.E11.m1.1.1.1.1.1.3.cmml">
                  2
                 </mn>
                </msub>
                <mo id="A1.E11.m1.2.2.2.2a" xref="A1.E11.m1.2.2.2.3.cmml">
                 ⁡
                </mo>
                <mrow id="A1.E11.m1.2.2.2.2.2" xref="A1.E11.m1.2.2.2.3.cmml">
                 <mo id="A1.E11.m1.2.2.2.2.2.2" stretchy="false" xref="A1.E11.m1.2.2.2.3.cmml">
                  (
                 </mo>
                 <mrow id="A1.E11.m1.2.2.2.2.2.1" xref="A1.E11.m1.2.2.2.2.2.1.cmml">
                  <mi id="A1.E11.m1.2.2.2.2.2.1.2" xref="A1.E11.m1.2.2.2.2.2.1.2.cmml">
                   i
                  </mi>
                  <mo id="A1.E11.m1.2.2.2.2.2.1.1" xref="A1.E11.m1.2.2.2.2.2.1.1.cmml">
                   +
                  </mo>
                  <mn id="A1.E11.m1.2.2.2.2.2.1.3" xref="A1.E11.m1.2.2.2.2.2.1.3.cmml">
                   1
                  </mn>
                 </mrow>
                 <mo id="A1.E11.m1.2.2.2.2.2.3" stretchy="false" xref="A1.E11.m1.2.2.2.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mfrac>
             </mstyle>
            </mrow>
           </mrow>
           <mo id="A1.E11.m1.3.3.1.2" xref="A1.E11.m1.3.3.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.E11.m1.3b">
           <apply id="A1.E11.m1.3.3.1.1.cmml" xref="A1.E11.m1.3.3.1">
            <eq id="A1.E11.m1.3.3.1.1.1.cmml" xref="A1.E11.m1.3.3.1.1.1">
            </eq>
            <apply id="A1.E11.m1.3.3.1.1.2.cmml" xref="A1.E11.m1.3.3.1.1.2">
             <times id="A1.E11.m1.3.3.1.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.2.1">
             </times>
             <ci id="A1.E11.m1.3.3.1.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.2.2">
              𝐷
             </ci>
             <ci id="A1.E11.m1.3.3.1.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.2.3">
              𝐶
             </ci>
             <ci id="A1.E11.m1.3.3.1.1.2.4.cmml" xref="A1.E11.m1.3.3.1.1.2.4">
              𝐺
             </ci>
            </apply>
            <apply id="A1.E11.m1.3.3.1.1.3.cmml" xref="A1.E11.m1.3.3.1.1.3">
             <apply id="A1.E11.m1.3.3.1.1.3.1.cmml" xref="A1.E11.m1.3.3.1.1.3.1">
              <csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.3.1.1.cmml" xref="A1.E11.m1.3.3.1.1.3.1">
               superscript
              </csymbol>
              <apply id="A1.E11.m1.3.3.1.1.3.1.2.cmml" xref="A1.E11.m1.3.3.1.1.3.1">
               <csymbol cd="ambiguous" id="A1.E11.m1.3.3.1.1.3.1.2.1.cmml" xref="A1.E11.m1.3.3.1.1.3.1">
                subscript
               </csymbol>
               <sum id="A1.E11.m1.3.3.1.1.3.1.2.2.cmml" xref="A1.E11.m1.3.3.1.1.3.1.2.2">
               </sum>
               <apply id="A1.E11.m1.3.3.1.1.3.1.2.3.cmml" xref="A1.E11.m1.3.3.1.1.3.1.2.3">
                <eq id="A1.E11.m1.3.3.1.1.3.1.2.3.1.cmml" xref="A1.E11.m1.3.3.1.1.3.1.2.3.1">
                </eq>
                <ci id="A1.E11.m1.3.3.1.1.3.1.2.3.2.cmml" xref="A1.E11.m1.3.3.1.1.3.1.2.3.2">
                 𝑖
                </ci>
                <cn id="A1.E11.m1.3.3.1.1.3.1.2.3.3.cmml" type="integer" xref="A1.E11.m1.3.3.1.1.3.1.2.3.3">
                 1
                </cn>
               </apply>
              </apply>
              <ci id="A1.E11.m1.3.3.1.1.3.1.3.cmml" xref="A1.E11.m1.3.3.1.1.3.1.3">
               𝐾
              </ci>
             </apply>
             <apply id="A1.E11.m1.2.2.cmml" xref="A1.E11.m1.2.2">
              <divide id="A1.E11.m1.2.2.3.cmml" xref="A1.E11.m1.2.2">
              </divide>
              <apply id="A1.E11.m1.2.2.4.cmml" xref="A1.E11.m1.2.2.4">
               <times id="A1.E11.m1.2.2.4.1.cmml" xref="A1.E11.m1.2.2.4.1">
               </times>
               <ci id="A1.E11.m1.2.2.4.2.cmml" xref="A1.E11.m1.2.2.4.2">
                𝑟
               </ci>
               <ci id="A1.E11.m1.2.2.4.3.cmml" xref="A1.E11.m1.2.2.4.3">
                𝑒
               </ci>
               <apply id="A1.E11.m1.2.2.4.4.cmml" xref="A1.E11.m1.2.2.4.4">
                <csymbol cd="ambiguous" id="A1.E11.m1.2.2.4.4.1.cmml" xref="A1.E11.m1.2.2.4.4">
                 subscript
                </csymbol>
                <ci id="A1.E11.m1.2.2.4.4.2.cmml" xref="A1.E11.m1.2.2.4.4.2">
                 𝑙
                </ci>
                <ci id="A1.E11.m1.2.2.4.4.3.cmml" xref="A1.E11.m1.2.2.4.4.3">
                 𝑖
                </ci>
               </apply>
              </apply>
              <apply id="A1.E11.m1.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.2">
               <apply id="A1.E11.m1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="A1.E11.m1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1.1">
                 subscript
                </csymbol>
                <log id="A1.E11.m1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.1.1.2">
                </log>
                <cn id="A1.E11.m1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E11.m1.1.1.1.1.1.3">
                 2
                </cn>
               </apply>
               <apply id="A1.E11.m1.2.2.2.2.2.1.cmml" xref="A1.E11.m1.2.2.2.2.2.1">
                <plus id="A1.E11.m1.2.2.2.2.2.1.1.cmml" xref="A1.E11.m1.2.2.2.2.2.1.1">
                </plus>
                <ci id="A1.E11.m1.2.2.2.2.2.1.2.cmml" xref="A1.E11.m1.2.2.2.2.2.1.2">
                 𝑖
                </ci>
                <cn id="A1.E11.m1.2.2.2.2.2.1.3.cmml" type="integer" xref="A1.E11.m1.2.2.2.2.2.1.3">
                 1
                </cn>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.E11.m1.3c">
           \displaystyle DCG=\sum_{i=1}^{K}\frac{rel_{i}}{\log_{2}(i+1)},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A1.SS4.p1.5">
     where
     <math alttext="rel_{i}" class="ltx_Math" display="inline" id="A1.SS4.p1.1.m1.1">
      <semantics id="A1.SS4.p1.1.m1.1a">
       <mrow id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml">
        <mi id="A1.SS4.p1.1.m1.1.1.2" xref="A1.SS4.p1.1.m1.1.1.2.cmml">
         r
        </mi>
        <mo id="A1.SS4.p1.1.m1.1.1.1" lspace="0em" rspace="0em" xref="A1.SS4.p1.1.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.1.m1.1.1.3" xref="A1.SS4.p1.1.m1.1.1.3.cmml">
         e
        </mi>
        <mo id="A1.SS4.p1.1.m1.1.1.1a" lspace="0em" rspace="0em" xref="A1.SS4.p1.1.m1.1.1.1.cmml">
         ​
        </mo>
        <msub id="A1.SS4.p1.1.m1.1.1.4" xref="A1.SS4.p1.1.m1.1.1.4.cmml">
         <mi id="A1.SS4.p1.1.m1.1.1.4.2" xref="A1.SS4.p1.1.m1.1.1.4.2.cmml">
          l
         </mi>
         <mi id="A1.SS4.p1.1.m1.1.1.4.3" xref="A1.SS4.p1.1.m1.1.1.4.3.cmml">
          i
         </mi>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.1b">
        <apply id="A1.SS4.p1.1.m1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1">
         <times id="A1.SS4.p1.1.m1.1.1.1.cmml" xref="A1.SS4.p1.1.m1.1.1.1">
         </times>
         <ci id="A1.SS4.p1.1.m1.1.1.2.cmml" xref="A1.SS4.p1.1.m1.1.1.2">
          𝑟
         </ci>
         <ci id="A1.SS4.p1.1.m1.1.1.3.cmml" xref="A1.SS4.p1.1.m1.1.1.3">
          𝑒
         </ci>
         <apply id="A1.SS4.p1.1.m1.1.1.4.cmml" xref="A1.SS4.p1.1.m1.1.1.4">
          <csymbol cd="ambiguous" id="A1.SS4.p1.1.m1.1.1.4.1.cmml" xref="A1.SS4.p1.1.m1.1.1.4">
           subscript
          </csymbol>
          <ci id="A1.SS4.p1.1.m1.1.1.4.2.cmml" xref="A1.SS4.p1.1.m1.1.1.4.2">
           𝑙
          </ci>
          <ci id="A1.SS4.p1.1.m1.1.1.4.3.cmml" xref="A1.SS4.p1.1.m1.1.1.4.3">
           𝑖
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.1c">
        rel_{i}
       </annotation>
      </semantics>
     </math>
     represents the intentionality of the suggestion (e.g., whether it is clicked or not) at position
     <math alttext="i" class="ltx_Math" display="inline" id="A1.SS4.p1.2.m2.1">
      <semantics id="A1.SS4.p1.2.m2.1a">
       <mi id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml">
        i
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b">
        <ci id="A1.SS4.p1.2.m2.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">
         𝑖
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">
        i
       </annotation>
      </semantics>
     </math>
     (
     <math alttext="rel_{i}\in\{0,1\}" class="ltx_Math" display="inline" id="A1.SS4.p1.3.m3.2">
      <semantics id="A1.SS4.p1.3.m3.2a">
       <mrow id="A1.SS4.p1.3.m3.2.3" xref="A1.SS4.p1.3.m3.2.3.cmml">
        <mrow id="A1.SS4.p1.3.m3.2.3.2" xref="A1.SS4.p1.3.m3.2.3.2.cmml">
         <mi id="A1.SS4.p1.3.m3.2.3.2.2" xref="A1.SS4.p1.3.m3.2.3.2.2.cmml">
          r
         </mi>
         <mo id="A1.SS4.p1.3.m3.2.3.2.1" lspace="0em" rspace="0em" xref="A1.SS4.p1.3.m3.2.3.2.1.cmml">
          ​
         </mo>
         <mi id="A1.SS4.p1.3.m3.2.3.2.3" xref="A1.SS4.p1.3.m3.2.3.2.3.cmml">
          e
         </mi>
         <mo id="A1.SS4.p1.3.m3.2.3.2.1a" lspace="0em" rspace="0em" xref="A1.SS4.p1.3.m3.2.3.2.1.cmml">
          ​
         </mo>
         <msub id="A1.SS4.p1.3.m3.2.3.2.4" xref="A1.SS4.p1.3.m3.2.3.2.4.cmml">
          <mi id="A1.SS4.p1.3.m3.2.3.2.4.2" xref="A1.SS4.p1.3.m3.2.3.2.4.2.cmml">
           l
          </mi>
          <mi id="A1.SS4.p1.3.m3.2.3.2.4.3" xref="A1.SS4.p1.3.m3.2.3.2.4.3.cmml">
           i
          </mi>
         </msub>
        </mrow>
        <mo id="A1.SS4.p1.3.m3.2.3.1" xref="A1.SS4.p1.3.m3.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="A1.SS4.p1.3.m3.2.3.3.2" xref="A1.SS4.p1.3.m3.2.3.3.1.cmml">
         <mo id="A1.SS4.p1.3.m3.2.3.3.2.1" stretchy="false" xref="A1.SS4.p1.3.m3.2.3.3.1.cmml">
          {
         </mo>
         <mn id="A1.SS4.p1.3.m3.1.1" xref="A1.SS4.p1.3.m3.1.1.cmml">
          0
         </mn>
         <mo id="A1.SS4.p1.3.m3.2.3.3.2.2" xref="A1.SS4.p1.3.m3.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="A1.SS4.p1.3.m3.2.2" xref="A1.SS4.p1.3.m3.2.2.cmml">
          1
         </mn>
         <mo id="A1.SS4.p1.3.m3.2.3.3.2.3" stretchy="false" xref="A1.SS4.p1.3.m3.2.3.3.1.cmml">
          }
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.3.m3.2b">
        <apply id="A1.SS4.p1.3.m3.2.3.cmml" xref="A1.SS4.p1.3.m3.2.3">
         <in id="A1.SS4.p1.3.m3.2.3.1.cmml" xref="A1.SS4.p1.3.m3.2.3.1">
         </in>
         <apply id="A1.SS4.p1.3.m3.2.3.2.cmml" xref="A1.SS4.p1.3.m3.2.3.2">
          <times id="A1.SS4.p1.3.m3.2.3.2.1.cmml" xref="A1.SS4.p1.3.m3.2.3.2.1">
          </times>
          <ci id="A1.SS4.p1.3.m3.2.3.2.2.cmml" xref="A1.SS4.p1.3.m3.2.3.2.2">
           𝑟
          </ci>
          <ci id="A1.SS4.p1.3.m3.2.3.2.3.cmml" xref="A1.SS4.p1.3.m3.2.3.2.3">
           𝑒
          </ci>
          <apply id="A1.SS4.p1.3.m3.2.3.2.4.cmml" xref="A1.SS4.p1.3.m3.2.3.2.4">
           <csymbol cd="ambiguous" id="A1.SS4.p1.3.m3.2.3.2.4.1.cmml" xref="A1.SS4.p1.3.m3.2.3.2.4">
            subscript
           </csymbol>
           <ci id="A1.SS4.p1.3.m3.2.3.2.4.2.cmml" xref="A1.SS4.p1.3.m3.2.3.2.4.2">
            𝑙
           </ci>
           <ci id="A1.SS4.p1.3.m3.2.3.2.4.3.cmml" xref="A1.SS4.p1.3.m3.2.3.2.4.3">
            𝑖
           </ci>
          </apply>
         </apply>
         <set id="A1.SS4.p1.3.m3.2.3.3.1.cmml" xref="A1.SS4.p1.3.m3.2.3.3.2">
          <cn id="A1.SS4.p1.3.m3.1.1.cmml" type="integer" xref="A1.SS4.p1.3.m3.1.1">
           0
          </cn>
          <cn id="A1.SS4.p1.3.m3.2.2.cmml" type="integer" xref="A1.SS4.p1.3.m3.2.2">
           1
          </cn>
         </set>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.3.m3.2c">
        rel_{i}\in\{0,1\}
       </annotation>
      </semantics>
     </math>
     ), and
     <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p1.4.m4.1">
      <semantics id="A1.SS4.p1.4.m4.1a">
       <mi id="A1.SS4.p1.4.m4.1.1" xref="A1.SS4.p1.4.m4.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.4.m4.1b">
        <ci id="A1.SS4.p1.4.m4.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.4.m4.1c">
        K
       </annotation>
      </semantics>
     </math>
     denotes the returned
     <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p1.5.m5.1">
      <semantics id="A1.SS4.p1.5.m5.1a">
       <mi id="A1.SS4.p1.5.m5.1.1" xref="A1.SS4.p1.5.m5.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.5.m5.1b">
        <ci id="A1.SS4.p1.5.m5.1.1.cmml" xref="A1.SS4.p1.5.m5.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.5.m5.1c">
        K
       </annotation>
      </semantics>
     </math>
     query suggestions.
For GSB, it involves human experts to determine whether the new system or the base system provides superior final results, where the relative gain is measured using the Good vs. Same vs. Bad (GSB), that is
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx10">
     <tbody id="A1.E12">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (12)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle GSB=\frac{\#Good-\#Bad}{\#Good+\#Same+\#Bad}," class="ltx_Math" display="inline" id="A1.E12.m1.1">
         <semantics id="A1.E12.m1.1a">
          <mrow id="A1.E12.m1.1.1.1" xref="A1.E12.m1.1.1.1.1.cmml">
           <mrow id="A1.E12.m1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.cmml">
            <mrow id="A1.E12.m1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.2.cmml">
             <mi id="A1.E12.m1.1.1.1.1.2.2" xref="A1.E12.m1.1.1.1.1.2.2.cmml">
              G
             </mi>
             <mo id="A1.E12.m1.1.1.1.1.2.1" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E12.m1.1.1.1.1.2.3" xref="A1.E12.m1.1.1.1.1.2.3.cmml">
              S
             </mi>
             <mo id="A1.E12.m1.1.1.1.1.2.1a" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E12.m1.1.1.1.1.2.4" xref="A1.E12.m1.1.1.1.1.2.4.cmml">
              B
             </mi>
            </mrow>
            <mo id="A1.E12.m1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.cmml">
             =
            </mo>
            <mstyle displaystyle="true" id="A1.E12.m1.1.1.1.1.3" xref="A1.E12.m1.1.1.1.1.3.cmml">
             <mfrac id="A1.E12.m1.1.1.1.1.3a" xref="A1.E12.m1.1.1.1.1.3.cmml">
              <mrow id="A1.E12.m1.1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.1.3.2.cmml">
               <mrow id="A1.E12.m1.1.1.1.1.3.2.2" xref="A1.E12.m1.1.1.1.1.3.2.2.cmml">
                <mi id="A1.E12.m1.1.1.1.1.3.2.2.2" mathvariant="normal" xref="A1.E12.m1.1.1.1.1.3.2.2.2.cmml">
                 #
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.2.1" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.2.3" xref="A1.E12.m1.1.1.1.1.3.2.2.3.cmml">
                 G
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.2.1a" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.2.4" xref="A1.E12.m1.1.1.1.1.3.2.2.4.cmml">
                 o
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.2.1b" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.2.5" xref="A1.E12.m1.1.1.1.1.3.2.2.5.cmml">
                 o
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.2.1c" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.2.6" xref="A1.E12.m1.1.1.1.1.3.2.2.6.cmml">
                 d
                </mi>
               </mrow>
               <mo id="A1.E12.m1.1.1.1.1.3.2.1" xref="A1.E12.m1.1.1.1.1.3.2.1.cmml">
                −
               </mo>
               <mrow id="A1.E12.m1.1.1.1.1.3.2.3" xref="A1.E12.m1.1.1.1.1.3.2.3.cmml">
                <mi id="A1.E12.m1.1.1.1.1.3.2.3.2" mathvariant="normal" xref="A1.E12.m1.1.1.1.1.3.2.3.2.cmml">
                 #
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.3.1" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.3.3" xref="A1.E12.m1.1.1.1.1.3.2.3.3.cmml">
                 B
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.3.1a" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.3.4" xref="A1.E12.m1.1.1.1.1.3.2.3.4.cmml">
                 a
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.2.3.1b" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.2.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.2.3.5" xref="A1.E12.m1.1.1.1.1.3.2.3.5.cmml">
                 d
                </mi>
               </mrow>
              </mrow>
              <mrow id="A1.E12.m1.1.1.1.1.3.3" xref="A1.E12.m1.1.1.1.1.3.3.cmml">
               <mrow id="A1.E12.m1.1.1.1.1.3.3.2" xref="A1.E12.m1.1.1.1.1.3.3.2.cmml">
                <mi id="A1.E12.m1.1.1.1.1.3.3.2.2" mathvariant="normal" xref="A1.E12.m1.1.1.1.1.3.3.2.2.cmml">
                 #
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.2.1" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.2.3" xref="A1.E12.m1.1.1.1.1.3.3.2.3.cmml">
                 G
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.2.1a" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.2.4" xref="A1.E12.m1.1.1.1.1.3.3.2.4.cmml">
                 o
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.2.1b" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.2.5" xref="A1.E12.m1.1.1.1.1.3.3.2.5.cmml">
                 o
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.2.1c" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.2.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.2.6" xref="A1.E12.m1.1.1.1.1.3.3.2.6.cmml">
                 d
                </mi>
               </mrow>
               <mo id="A1.E12.m1.1.1.1.1.3.3.1" xref="A1.E12.m1.1.1.1.1.3.3.1.cmml">
                +
               </mo>
               <mrow id="A1.E12.m1.1.1.1.1.3.3.3" xref="A1.E12.m1.1.1.1.1.3.3.3.cmml">
                <mi id="A1.E12.m1.1.1.1.1.3.3.3.2" mathvariant="normal" xref="A1.E12.m1.1.1.1.1.3.3.3.2.cmml">
                 #
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.3.1" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.3.3" xref="A1.E12.m1.1.1.1.1.3.3.3.3.cmml">
                 S
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.3.1a" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.3.4" xref="A1.E12.m1.1.1.1.1.3.3.3.4.cmml">
                 a
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.3.1b" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.3.5" xref="A1.E12.m1.1.1.1.1.3.3.3.5.cmml">
                 m
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.3.1c" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.3.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.3.6" xref="A1.E12.m1.1.1.1.1.3.3.3.6.cmml">
                 e
                </mi>
               </mrow>
               <mo id="A1.E12.m1.1.1.1.1.3.3.1a" xref="A1.E12.m1.1.1.1.1.3.3.1.cmml">
                +
               </mo>
               <mrow id="A1.E12.m1.1.1.1.1.3.3.4" xref="A1.E12.m1.1.1.1.1.3.3.4.cmml">
                <mi id="A1.E12.m1.1.1.1.1.3.3.4.2" mathvariant="normal" xref="A1.E12.m1.1.1.1.1.3.3.4.2.cmml">
                 #
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.4.1" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.4.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.4.3" xref="A1.E12.m1.1.1.1.1.3.3.4.3.cmml">
                 B
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.4.1a" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.4.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.4.4" xref="A1.E12.m1.1.1.1.1.3.3.4.4.cmml">
                 a
                </mi>
                <mo id="A1.E12.m1.1.1.1.1.3.3.4.1b" lspace="0em" rspace="0em" xref="A1.E12.m1.1.1.1.1.3.3.4.1.cmml">
                 ​
                </mo>
                <mi id="A1.E12.m1.1.1.1.1.3.3.4.5" xref="A1.E12.m1.1.1.1.1.3.3.4.5.cmml">
                 d
                </mi>
               </mrow>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo id="A1.E12.m1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.E12.m1.1b">
           <apply id="A1.E12.m1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1">
            <eq id="A1.E12.m1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1">
            </eq>
            <apply id="A1.E12.m1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.2">
             <times id="A1.E12.m1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.1.1.1.1.2.1">
             </times>
             <ci id="A1.E12.m1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.1.1.1.1.2.2">
              𝐺
             </ci>
             <ci id="A1.E12.m1.1.1.1.1.2.3.cmml" xref="A1.E12.m1.1.1.1.1.2.3">
              𝑆
             </ci>
             <ci id="A1.E12.m1.1.1.1.1.2.4.cmml" xref="A1.E12.m1.1.1.1.1.2.4">
              𝐵
             </ci>
            </apply>
            <apply id="A1.E12.m1.1.1.1.1.3.cmml" xref="A1.E12.m1.1.1.1.1.3">
             <divide id="A1.E12.m1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.1.3">
             </divide>
             <apply id="A1.E12.m1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.1.1.1.1.3.2">
              <minus id="A1.E12.m1.1.1.1.1.3.2.1.cmml" xref="A1.E12.m1.1.1.1.1.3.2.1">
              </minus>
              <apply id="A1.E12.m1.1.1.1.1.3.2.2.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2">
               <times id="A1.E12.m1.1.1.1.1.3.2.2.1.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2.1">
               </times>
               <ci id="A1.E12.m1.1.1.1.1.3.2.2.2.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2.2">
                #
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.2.3.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2.3">
                𝐺
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.2.4.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2.4">
                𝑜
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.2.5.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2.5">
                𝑜
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.2.6.cmml" xref="A1.E12.m1.1.1.1.1.3.2.2.6">
                𝑑
               </ci>
              </apply>
              <apply id="A1.E12.m1.1.1.1.1.3.2.3.cmml" xref="A1.E12.m1.1.1.1.1.3.2.3">
               <times id="A1.E12.m1.1.1.1.1.3.2.3.1.cmml" xref="A1.E12.m1.1.1.1.1.3.2.3.1">
               </times>
               <ci id="A1.E12.m1.1.1.1.1.3.2.3.2.cmml" xref="A1.E12.m1.1.1.1.1.3.2.3.2">
                #
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.3.3.cmml" xref="A1.E12.m1.1.1.1.1.3.2.3.3">
                𝐵
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.3.4.cmml" xref="A1.E12.m1.1.1.1.1.3.2.3.4">
                𝑎
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.2.3.5.cmml" xref="A1.E12.m1.1.1.1.1.3.2.3.5">
                𝑑
               </ci>
              </apply>
             </apply>
             <apply id="A1.E12.m1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.1.1.1.1.3.3">
              <plus id="A1.E12.m1.1.1.1.1.3.3.1.cmml" xref="A1.E12.m1.1.1.1.1.3.3.1">
              </plus>
              <apply id="A1.E12.m1.1.1.1.1.3.3.2.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2">
               <times id="A1.E12.m1.1.1.1.1.3.3.2.1.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2.1">
               </times>
               <ci id="A1.E12.m1.1.1.1.1.3.3.2.2.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2.2">
                #
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.2.3.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2.3">
                𝐺
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.2.4.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2.4">
                𝑜
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.2.5.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2.5">
                𝑜
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.2.6.cmml" xref="A1.E12.m1.1.1.1.1.3.3.2.6">
                𝑑
               </ci>
              </apply>
              <apply id="A1.E12.m1.1.1.1.1.3.3.3.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3">
               <times id="A1.E12.m1.1.1.1.1.3.3.3.1.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3.1">
               </times>
               <ci id="A1.E12.m1.1.1.1.1.3.3.3.2.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3.2">
                #
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.3.3.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3.3">
                𝑆
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.3.4.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3.4">
                𝑎
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.3.5.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3.5">
                𝑚
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.3.6.cmml" xref="A1.E12.m1.1.1.1.1.3.3.3.6">
                𝑒
               </ci>
              </apply>
              <apply id="A1.E12.m1.1.1.1.1.3.3.4.cmml" xref="A1.E12.m1.1.1.1.1.3.3.4">
               <times id="A1.E12.m1.1.1.1.1.3.3.4.1.cmml" xref="A1.E12.m1.1.1.1.1.3.3.4.1">
               </times>
               <ci id="A1.E12.m1.1.1.1.1.3.3.4.2.cmml" xref="A1.E12.m1.1.1.1.1.3.3.4.2">
                #
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.4.3.cmml" xref="A1.E12.m1.1.1.1.1.3.3.4.3">
                𝐵
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.4.4.cmml" xref="A1.E12.m1.1.1.1.1.3.3.4.4">
                𝑎
               </ci>
               <ci id="A1.E12.m1.1.1.1.1.3.3.4.5.cmml" xref="A1.E12.m1.1.1.1.1.3.3.4.5">
                𝑑
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.E12.m1.1c">
           \displaystyle GSB=\frac{\#Good-\#Bad}{\#Good+\#Same+\#Bad},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A1.SS4.p1.8">
     where
     <math alttext="\#Good" class="ltx_Math" display="inline" id="A1.SS4.p1.6.m1.1">
      <semantics id="A1.SS4.p1.6.m1.1a">
       <mrow id="A1.SS4.p1.6.m1.1.1" xref="A1.SS4.p1.6.m1.1.1.cmml">
        <mi id="A1.SS4.p1.6.m1.1.1.2" mathvariant="normal" xref="A1.SS4.p1.6.m1.1.1.2.cmml">
         #
        </mi>
        <mo id="A1.SS4.p1.6.m1.1.1.1" lspace="0em" rspace="0em" xref="A1.SS4.p1.6.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.6.m1.1.1.3" xref="A1.SS4.p1.6.m1.1.1.3.cmml">
         G
        </mi>
        <mo id="A1.SS4.p1.6.m1.1.1.1a" lspace="0em" rspace="0em" xref="A1.SS4.p1.6.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.6.m1.1.1.4" xref="A1.SS4.p1.6.m1.1.1.4.cmml">
         o
        </mi>
        <mo id="A1.SS4.p1.6.m1.1.1.1b" lspace="0em" rspace="0em" xref="A1.SS4.p1.6.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.6.m1.1.1.5" xref="A1.SS4.p1.6.m1.1.1.5.cmml">
         o
        </mi>
        <mo id="A1.SS4.p1.6.m1.1.1.1c" lspace="0em" rspace="0em" xref="A1.SS4.p1.6.m1.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.6.m1.1.1.6" xref="A1.SS4.p1.6.m1.1.1.6.cmml">
         d
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.6.m1.1b">
        <apply id="A1.SS4.p1.6.m1.1.1.cmml" xref="A1.SS4.p1.6.m1.1.1">
         <times id="A1.SS4.p1.6.m1.1.1.1.cmml" xref="A1.SS4.p1.6.m1.1.1.1">
         </times>
         <ci id="A1.SS4.p1.6.m1.1.1.2.cmml" xref="A1.SS4.p1.6.m1.1.1.2">
          #
         </ci>
         <ci id="A1.SS4.p1.6.m1.1.1.3.cmml" xref="A1.SS4.p1.6.m1.1.1.3">
          𝐺
         </ci>
         <ci id="A1.SS4.p1.6.m1.1.1.4.cmml" xref="A1.SS4.p1.6.m1.1.1.4">
          𝑜
         </ci>
         <ci id="A1.SS4.p1.6.m1.1.1.5.cmml" xref="A1.SS4.p1.6.m1.1.1.5">
          𝑜
         </ci>
         <ci id="A1.SS4.p1.6.m1.1.1.6.cmml" xref="A1.SS4.p1.6.m1.1.1.6">
          𝑑
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.6.m1.1c">
        \#Good
       </annotation>
      </semantics>
     </math>
     (resp.
     <math alttext="\#Bad" class="ltx_Math" display="inline" id="A1.SS4.p1.7.m2.1">
      <semantics id="A1.SS4.p1.7.m2.1a">
       <mrow id="A1.SS4.p1.7.m2.1.1" xref="A1.SS4.p1.7.m2.1.1.cmml">
        <mi id="A1.SS4.p1.7.m2.1.1.2" mathvariant="normal" xref="A1.SS4.p1.7.m2.1.1.2.cmml">
         #
        </mi>
        <mo id="A1.SS4.p1.7.m2.1.1.1" lspace="0em" rspace="0em" xref="A1.SS4.p1.7.m2.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.7.m2.1.1.3" xref="A1.SS4.p1.7.m2.1.1.3.cmml">
         B
        </mi>
        <mo id="A1.SS4.p1.7.m2.1.1.1a" lspace="0em" rspace="0em" xref="A1.SS4.p1.7.m2.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.7.m2.1.1.4" xref="A1.SS4.p1.7.m2.1.1.4.cmml">
         a
        </mi>
        <mo id="A1.SS4.p1.7.m2.1.1.1b" lspace="0em" rspace="0em" xref="A1.SS4.p1.7.m2.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.7.m2.1.1.5" xref="A1.SS4.p1.7.m2.1.1.5.cmml">
         d
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.7.m2.1b">
        <apply id="A1.SS4.p1.7.m2.1.1.cmml" xref="A1.SS4.p1.7.m2.1.1">
         <times id="A1.SS4.p1.7.m2.1.1.1.cmml" xref="A1.SS4.p1.7.m2.1.1.1">
         </times>
         <ci id="A1.SS4.p1.7.m2.1.1.2.cmml" xref="A1.SS4.p1.7.m2.1.1.2">
          #
         </ci>
         <ci id="A1.SS4.p1.7.m2.1.1.3.cmml" xref="A1.SS4.p1.7.m2.1.1.3">
          𝐵
         </ci>
         <ci id="A1.SS4.p1.7.m2.1.1.4.cmml" xref="A1.SS4.p1.7.m2.1.1.4">
          𝑎
         </ci>
         <ci id="A1.SS4.p1.7.m2.1.1.5.cmml" xref="A1.SS4.p1.7.m2.1.1.5">
          𝑑
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.7.m2.1c">
        \#Bad
       </annotation>
      </semantics>
     </math>
     ) is a counter that increments by 1 if the new system delivers better (resp. worse) results compared to the base system, and
     <math alttext="\#Same" class="ltx_Math" display="inline" id="A1.SS4.p1.8.m3.1">
      <semantics id="A1.SS4.p1.8.m3.1a">
       <mrow id="A1.SS4.p1.8.m3.1.1" xref="A1.SS4.p1.8.m3.1.1.cmml">
        <mi id="A1.SS4.p1.8.m3.1.1.2" mathvariant="normal" xref="A1.SS4.p1.8.m3.1.1.2.cmml">
         #
        </mi>
        <mo id="A1.SS4.p1.8.m3.1.1.1" lspace="0em" rspace="0em" xref="A1.SS4.p1.8.m3.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.8.m3.1.1.3" xref="A1.SS4.p1.8.m3.1.1.3.cmml">
         S
        </mi>
        <mo id="A1.SS4.p1.8.m3.1.1.1a" lspace="0em" rspace="0em" xref="A1.SS4.p1.8.m3.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.8.m3.1.1.4" xref="A1.SS4.p1.8.m3.1.1.4.cmml">
         a
        </mi>
        <mo id="A1.SS4.p1.8.m3.1.1.1b" lspace="0em" rspace="0em" xref="A1.SS4.p1.8.m3.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.8.m3.1.1.5" xref="A1.SS4.p1.8.m3.1.1.5.cmml">
         m
        </mi>
        <mo id="A1.SS4.p1.8.m3.1.1.1c" lspace="0em" rspace="0em" xref="A1.SS4.p1.8.m3.1.1.1.cmml">
         ​
        </mo>
        <mi id="A1.SS4.p1.8.m3.1.1.6" xref="A1.SS4.p1.8.m3.1.1.6.cmml">
         e
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p1.8.m3.1b">
        <apply id="A1.SS4.p1.8.m3.1.1.cmml" xref="A1.SS4.p1.8.m3.1.1">
         <times id="A1.SS4.p1.8.m3.1.1.1.cmml" xref="A1.SS4.p1.8.m3.1.1.1">
         </times>
         <ci id="A1.SS4.p1.8.m3.1.1.2.cmml" xref="A1.SS4.p1.8.m3.1.1.2">
          #
         </ci>
         <ci id="A1.SS4.p1.8.m3.1.1.3.cmml" xref="A1.SS4.p1.8.m3.1.1.3">
          𝑆
         </ci>
         <ci id="A1.SS4.p1.8.m3.1.1.4.cmml" xref="A1.SS4.p1.8.m3.1.1.4">
          𝑎
         </ci>
         <ci id="A1.SS4.p1.8.m3.1.1.5.cmml" xref="A1.SS4.p1.8.m3.1.1.5">
          𝑚
         </ci>
         <ci id="A1.SS4.p1.8.m3.1.1.6.cmml" xref="A1.SS4.p1.8.m3.1.1.6">
          𝑒
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p1.8.m3.1c">
        \#Same
       </annotation>
      </semantics>
     </math>
     increments by 1 otherwise.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS4.p2">
    <p class="ltx_p" id="A1.SS4.p2.2">
     For the retrieval task, we report positive-negative ratio (PNR) and Recall@K by following
     <cite class="ltx_cite ltx_citemacro_citep">
      (Liu et al
      <span class="ltx_text">
       .
      </span>
      ,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2021
      </a>
      ; Jarvelin,
      <a class="ltx_ref" href="#bib.bib21" title="">
       2000
      </a>
      )
     </cite>
     . For PNR, it is defined as the ratio of positive instances over negative instances for a given query image
     <math alttext="I" class="ltx_Math" display="inline" id="A1.SS4.p2.1.m1.1">
      <semantics id="A1.SS4.p2.1.m1.1a">
       <mi id="A1.SS4.p2.1.m1.1.1" xref="A1.SS4.p2.1.m1.1.1.cmml">
        I
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.1.m1.1b">
        <ci id="A1.SS4.p2.1.m1.1.1.cmml" xref="A1.SS4.p2.1.m1.1.1">
         𝐼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.1.m1.1c">
        I
       </annotation>
      </semantics>
     </math>
     and its suggestions
     <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="A1.SS4.p2.2.m2.1">
      <semantics id="A1.SS4.p2.2.m2.1a">
       <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p2.2.m2.1.1" xref="A1.SS4.p2.2.m2.1.1.cmml">
        𝒮
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.2.m2.1b">
        <ci id="A1.SS4.p2.2.m2.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1">
         𝒮
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.2.m2.1c">
        \mathcal{S}
       </annotation>
      </semantics>
     </math>
     , that is
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx11">
     <tbody id="A1.E13">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (13)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle PNR=\frac{\sum_{S_{i},S_{j}\in\mathcal{S}}\mathbbm{1}(y_{i}&gt;y_{j})\cdot\mathbbm{1}(f(I,S_{i})&gt;f(I,S_{j}))}{\sum_{S_{i}^{\prime},S_{j}^{\prime}\in\mathcal{S}}\mathbbm{1}(y_{i}^{\prime}&gt;y_{j}^{\prime})\cdot\mathbbm{1}(f(I,S_{i}^{\prime})&lt;f(I,S_{j}^{\prime}))}," class="ltx_Math" display="inline" id="A1.E13.m1.13">
         <semantics id="A1.E13.m1.13a">
          <mrow id="A1.E13.m1.13.13.1" xref="A1.E13.m1.13.13.1.1.cmml">
           <mrow id="A1.E13.m1.13.13.1.1" xref="A1.E13.m1.13.13.1.1.cmml">
            <mrow id="A1.E13.m1.13.13.1.1.2" xref="A1.E13.m1.13.13.1.1.2.cmml">
             <mi id="A1.E13.m1.13.13.1.1.2.2" xref="A1.E13.m1.13.13.1.1.2.2.cmml">
              P
             </mi>
             <mo id="A1.E13.m1.13.13.1.1.2.1" lspace="0em" rspace="0em" xref="A1.E13.m1.13.13.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E13.m1.13.13.1.1.2.3" xref="A1.E13.m1.13.13.1.1.2.3.cmml">
              N
             </mi>
             <mo id="A1.E13.m1.13.13.1.1.2.1a" lspace="0em" rspace="0em" xref="A1.E13.m1.13.13.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E13.m1.13.13.1.1.2.4" xref="A1.E13.m1.13.13.1.1.2.4.cmml">
              R
             </mi>
            </mrow>
            <mo id="A1.E13.m1.13.13.1.1.1" xref="A1.E13.m1.13.13.1.1.1.cmml">
             =
            </mo>
            <mstyle displaystyle="true" id="A1.E13.m1.12.12" xref="A1.E13.m1.12.12.cmml">
             <mfrac id="A1.E13.m1.12.12a" xref="A1.E13.m1.12.12.cmml">
              <mrow id="A1.E13.m1.6.6.6" xref="A1.E13.m1.6.6.6.cmml">
               <msub id="A1.E13.m1.6.6.6.7" xref="A1.E13.m1.6.6.6.7.cmml">
                <mo id="A1.E13.m1.6.6.6.7.2" xref="A1.E13.m1.6.6.6.7.2.cmml">
                 ∑
                </mo>
                <mrow id="A1.E13.m1.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.2.cmml">
                 <mrow id="A1.E13.m1.2.2.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.2.2.3.cmml">
                  <msub id="A1.E13.m1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="A1.E13.m1.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.1.1.1.1.2.cmml">
                    S
                   </mi>
                   <mi id="A1.E13.m1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.1.1.1.1.3.cmml">
                    i
                   </mi>
                  </msub>
                  <mo id="A1.E13.m1.2.2.2.2.2.2.2.3" xref="A1.E13.m1.2.2.2.2.2.2.3.cmml">
                   ,
                  </mo>
                  <msub id="A1.E13.m1.2.2.2.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.2.2.2.2.cmml">
                   <mi id="A1.E13.m1.2.2.2.2.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.2.2.2.2.2.cmml">
                    S
                   </mi>
                   <mi id="A1.E13.m1.2.2.2.2.2.2.2.2.3" xref="A1.E13.m1.2.2.2.2.2.2.2.2.3.cmml">
                    j
                   </mi>
                  </msub>
                 </mrow>
                 <mo id="A1.E13.m1.2.2.2.2.2.3" xref="A1.E13.m1.2.2.2.2.2.3.cmml">
                  ∈
                 </mo>
                 <mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.2.2.2.2.2.4" xref="A1.E13.m1.2.2.2.2.2.4.cmml">
                  𝒮
                 </mi>
                </mrow>
               </msub>
               <mrow id="A1.E13.m1.6.6.6.6" xref="A1.E13.m1.6.6.6.6.cmml">
                <mrow id="A1.E13.m1.5.5.5.5.1" xref="A1.E13.m1.5.5.5.5.1.cmml">
                 <mrow id="A1.E13.m1.5.5.5.5.1.1" xref="A1.E13.m1.5.5.5.5.1.1.cmml">
                  <mn id="A1.E13.m1.5.5.5.5.1.1.3" xref="A1.E13.m1.5.5.5.5.1.1.3.cmml">
                   𝟙
                  </mn>
                  <mo id="A1.E13.m1.5.5.5.5.1.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.5.5.5.5.1.1.2.cmml">
                   ​
                  </mo>
                  <mrow id="A1.E13.m1.5.5.5.5.1.1.1.1" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.cmml">
                   <mo id="A1.E13.m1.5.5.5.5.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.cmml">
                    (
                   </mo>
                   <mrow id="A1.E13.m1.5.5.5.5.1.1.1.1.1" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.cmml">
                    <msub id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.cmml">
                     <mi id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.2" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.2.cmml">
                      y
                     </mi>
                     <mi id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.3" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.3.cmml">
                      i
                     </mi>
                    </msub>
                    <mo id="A1.E13.m1.5.5.5.5.1.1.1.1.1.1" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.1.cmml">
                     &gt;
                    </mo>
                    <msub id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.cmml">
                     <mi id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.2" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.2.cmml">
                      y
                     </mi>
                     <mi id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.3" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.3.cmml">
                      j
                     </mi>
                    </msub>
                   </mrow>
                   <mo id="A1.E13.m1.5.5.5.5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="A1.E13.m1.5.5.5.5.1.2" rspace="0.222em" xref="A1.E13.m1.5.5.5.5.1.2.cmml">
                  ⋅
                 </mo>
                 <mn id="A1.E13.m1.5.5.5.5.1.3" xref="A1.E13.m1.5.5.5.5.1.3.cmml">
                  𝟙
                 </mn>
                </mrow>
                <mo id="A1.E13.m1.6.6.6.6.3" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.6.6.3.cmml">
                 ​
                </mo>
                <mrow id="A1.E13.m1.6.6.6.6.2.1" xref="A1.E13.m1.6.6.6.6.2.1.1.cmml">
                 <mo id="A1.E13.m1.6.6.6.6.2.1.2" stretchy="false" xref="A1.E13.m1.6.6.6.6.2.1.1.cmml">
                  (
                 </mo>
                 <mrow id="A1.E13.m1.6.6.6.6.2.1.1" xref="A1.E13.m1.6.6.6.6.2.1.1.cmml">
                  <mrow id="A1.E13.m1.6.6.6.6.2.1.1.1" xref="A1.E13.m1.6.6.6.6.2.1.1.1.cmml">
                   <mi id="A1.E13.m1.6.6.6.6.2.1.1.1.3" xref="A1.E13.m1.6.6.6.6.2.1.1.1.3.cmml">
                    f
                   </mi>
                   <mo id="A1.E13.m1.6.6.6.6.2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.6.6.2.1.1.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.2.cmml">
                    <mo id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.2.cmml">
                     (
                    </mo>
                    <mi id="A1.E13.m1.3.3.3.3" xref="A1.E13.m1.3.3.3.3.cmml">
                     I
                    </mi>
                    <mo id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.3" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.2.cmml">
                     ,
                    </mo>
                    <msub id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.cmml">
                     <mi id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.2" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.2.cmml">
                      S
                     </mi>
                     <mi id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml">
                      i
                     </mi>
                    </msub>
                    <mo id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.4" stretchy="false" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.2.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="A1.E13.m1.6.6.6.6.2.1.1.3" xref="A1.E13.m1.6.6.6.6.2.1.1.3.cmml">
                   &gt;
                  </mo>
                  <mrow id="A1.E13.m1.6.6.6.6.2.1.1.2" xref="A1.E13.m1.6.6.6.6.2.1.1.2.cmml">
                   <mi id="A1.E13.m1.6.6.6.6.2.1.1.2.3" xref="A1.E13.m1.6.6.6.6.2.1.1.2.3.cmml">
                    f
                   </mi>
                   <mo id="A1.E13.m1.6.6.6.6.2.1.1.2.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.6.6.2.1.1.2.2.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.2.cmml">
                    <mo id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.2.cmml">
                     (
                    </mo>
                    <mi id="A1.E13.m1.4.4.4.4" xref="A1.E13.m1.4.4.4.4.cmml">
                     I
                    </mi>
                    <mo id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.3" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.2.cmml">
                     ,
                    </mo>
                    <msub id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.cmml">
                     <mi id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.2" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.2.cmml">
                      S
                     </mi>
                     <mi id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.3" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.3.cmml">
                      j
                     </mi>
                    </msub>
                    <mo id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.4" stretchy="false" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.2.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo id="A1.E13.m1.6.6.6.6.2.1.3" stretchy="false" xref="A1.E13.m1.6.6.6.6.2.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
              <mrow id="A1.E13.m1.12.12.12" xref="A1.E13.m1.12.12.12.cmml">
               <msub id="A1.E13.m1.12.12.12.7" xref="A1.E13.m1.12.12.12.7.cmml">
                <mo id="A1.E13.m1.12.12.12.7.2" xref="A1.E13.m1.12.12.12.7.2.cmml">
                 ∑
                </mo>
                <mrow id="A1.E13.m1.8.8.8.2.2" xref="A1.E13.m1.8.8.8.2.2.cmml">
                 <mrow id="A1.E13.m1.8.8.8.2.2.2.2" xref="A1.E13.m1.8.8.8.2.2.2.3.cmml">
                  <msubsup id="A1.E13.m1.7.7.7.1.1.1.1.1" xref="A1.E13.m1.7.7.7.1.1.1.1.1.cmml">
                   <mi id="A1.E13.m1.7.7.7.1.1.1.1.1.2.2" xref="A1.E13.m1.7.7.7.1.1.1.1.1.2.2.cmml">
                    S
                   </mi>
                   <mi id="A1.E13.m1.7.7.7.1.1.1.1.1.2.3" xref="A1.E13.m1.7.7.7.1.1.1.1.1.2.3.cmml">
                    i
                   </mi>
                   <mo id="A1.E13.m1.7.7.7.1.1.1.1.1.3" xref="A1.E13.m1.7.7.7.1.1.1.1.1.3.cmml">
                    ′
                   </mo>
                  </msubsup>
                  <mo id="A1.E13.m1.8.8.8.2.2.2.2.3" xref="A1.E13.m1.8.8.8.2.2.2.3.cmml">
                   ,
                  </mo>
                  <msubsup id="A1.E13.m1.8.8.8.2.2.2.2.2" xref="A1.E13.m1.8.8.8.2.2.2.2.2.cmml">
                   <mi id="A1.E13.m1.8.8.8.2.2.2.2.2.2.2" xref="A1.E13.m1.8.8.8.2.2.2.2.2.2.2.cmml">
                    S
                   </mi>
                   <mi id="A1.E13.m1.8.8.8.2.2.2.2.2.2.3" xref="A1.E13.m1.8.8.8.2.2.2.2.2.2.3.cmml">
                    j
                   </mi>
                   <mo id="A1.E13.m1.8.8.8.2.2.2.2.2.3" xref="A1.E13.m1.8.8.8.2.2.2.2.2.3.cmml">
                    ′
                   </mo>
                  </msubsup>
                 </mrow>
                 <mo id="A1.E13.m1.8.8.8.2.2.3" xref="A1.E13.m1.8.8.8.2.2.3.cmml">
                  ∈
                 </mo>
                 <mi class="ltx_font_mathcaligraphic" id="A1.E13.m1.8.8.8.2.2.4" xref="A1.E13.m1.8.8.8.2.2.4.cmml">
                  𝒮
                 </mi>
                </mrow>
               </msub>
               <mrow id="A1.E13.m1.12.12.12.6" xref="A1.E13.m1.12.12.12.6.cmml">
                <mrow id="A1.E13.m1.11.11.11.5.1" xref="A1.E13.m1.11.11.11.5.1.cmml">
                 <mrow id="A1.E13.m1.11.11.11.5.1.1" xref="A1.E13.m1.11.11.11.5.1.1.cmml">
                  <mn id="A1.E13.m1.11.11.11.5.1.1.3" xref="A1.E13.m1.11.11.11.5.1.1.3.cmml">
                   𝟙
                  </mn>
                  <mo id="A1.E13.m1.11.11.11.5.1.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.11.11.11.5.1.1.2.cmml">
                   ​
                  </mo>
                  <mrow id="A1.E13.m1.11.11.11.5.1.1.1.1" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.cmml">
                   <mo id="A1.E13.m1.11.11.11.5.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.cmml">
                    (
                   </mo>
                   <mrow id="A1.E13.m1.11.11.11.5.1.1.1.1.1" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.cmml">
                    <msubsup id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.cmml">
                     <mi id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.2" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.2.cmml">
                      y
                     </mi>
                     <mi id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.3" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.3.cmml">
                      i
                     </mi>
                     <mo id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.3" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.3.cmml">
                      ′
                     </mo>
                    </msubsup>
                    <mo id="A1.E13.m1.11.11.11.5.1.1.1.1.1.1" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.1.cmml">
                     &gt;
                    </mo>
                    <msubsup id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.cmml">
                     <mi id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.2" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.2.cmml">
                      y
                     </mi>
                     <mi id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.3" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.3.cmml">
                      j
                     </mi>
                     <mo id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.3" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.3.cmml">
                      ′
                     </mo>
                    </msubsup>
                   </mrow>
                   <mo id="A1.E13.m1.11.11.11.5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="A1.E13.m1.11.11.11.5.1.2" rspace="0.222em" xref="A1.E13.m1.11.11.11.5.1.2.cmml">
                  ⋅
                 </mo>
                 <mn id="A1.E13.m1.11.11.11.5.1.3" xref="A1.E13.m1.11.11.11.5.1.3.cmml">
                  𝟙
                 </mn>
                </mrow>
                <mo id="A1.E13.m1.12.12.12.6.3" lspace="0em" rspace="0em" xref="A1.E13.m1.12.12.12.6.3.cmml">
                 ​
                </mo>
                <mrow id="A1.E13.m1.12.12.12.6.2.1" xref="A1.E13.m1.12.12.12.6.2.1.1.cmml">
                 <mo id="A1.E13.m1.12.12.12.6.2.1.2" stretchy="false" xref="A1.E13.m1.12.12.12.6.2.1.1.cmml">
                  (
                 </mo>
                 <mrow id="A1.E13.m1.12.12.12.6.2.1.1" xref="A1.E13.m1.12.12.12.6.2.1.1.cmml">
                  <mrow id="A1.E13.m1.12.12.12.6.2.1.1.1" xref="A1.E13.m1.12.12.12.6.2.1.1.1.cmml">
                   <mi id="A1.E13.m1.12.12.12.6.2.1.1.1.3" xref="A1.E13.m1.12.12.12.6.2.1.1.1.3.cmml">
                    f
                   </mi>
                   <mo id="A1.E13.m1.12.12.12.6.2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.12.12.12.6.2.1.1.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.2.cmml">
                    <mo id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.2.cmml">
                     (
                    </mo>
                    <mi id="A1.E13.m1.9.9.9.3" xref="A1.E13.m1.9.9.9.3.cmml">
                     I
                    </mi>
                    <mo id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.3" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.2.cmml">
                     ,
                    </mo>
                    <msubsup id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.cmml">
                     <mi id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.2" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.2.cmml">
                      S
                     </mi>
                     <mi id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.3" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.3.cmml">
                      i
                     </mi>
                     <mo id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.3" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.3.cmml">
                      ′
                     </mo>
                    </msubsup>
                    <mo id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.4" stretchy="false" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.2.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="A1.E13.m1.12.12.12.6.2.1.1.3" xref="A1.E13.m1.12.12.12.6.2.1.1.3.cmml">
                   &lt;
                  </mo>
                  <mrow id="A1.E13.m1.12.12.12.6.2.1.1.2" xref="A1.E13.m1.12.12.12.6.2.1.1.2.cmml">
                   <mi id="A1.E13.m1.12.12.12.6.2.1.1.2.3" xref="A1.E13.m1.12.12.12.6.2.1.1.2.3.cmml">
                    f
                   </mi>
                   <mo id="A1.E13.m1.12.12.12.6.2.1.1.2.2" lspace="0em" rspace="0em" xref="A1.E13.m1.12.12.12.6.2.1.1.2.2.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.2.cmml">
                    <mo id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.2" stretchy="false" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.2.cmml">
                     (
                    </mo>
                    <mi id="A1.E13.m1.10.10.10.4" xref="A1.E13.m1.10.10.10.4.cmml">
                     I
                    </mi>
                    <mo id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.3" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.2.cmml">
                     ,
                    </mo>
                    <msubsup id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.cmml">
                     <mi id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.2" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.2.cmml">
                      S
                     </mi>
                     <mi id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.3" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.3.cmml">
                      j
                     </mi>
                     <mo id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.3" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.3.cmml">
                      ′
                     </mo>
                    </msubsup>
                    <mo id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.4" stretchy="false" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.2.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo id="A1.E13.m1.12.12.12.6.2.1.3" stretchy="false" xref="A1.E13.m1.12.12.12.6.2.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo id="A1.E13.m1.13.13.1.2" xref="A1.E13.m1.13.13.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.E13.m1.13b">
           <apply id="A1.E13.m1.13.13.1.1.cmml" xref="A1.E13.m1.13.13.1">
            <eq id="A1.E13.m1.13.13.1.1.1.cmml" xref="A1.E13.m1.13.13.1.1.1">
            </eq>
            <apply id="A1.E13.m1.13.13.1.1.2.cmml" xref="A1.E13.m1.13.13.1.1.2">
             <times id="A1.E13.m1.13.13.1.1.2.1.cmml" xref="A1.E13.m1.13.13.1.1.2.1">
             </times>
             <ci id="A1.E13.m1.13.13.1.1.2.2.cmml" xref="A1.E13.m1.13.13.1.1.2.2">
              𝑃
             </ci>
             <ci id="A1.E13.m1.13.13.1.1.2.3.cmml" xref="A1.E13.m1.13.13.1.1.2.3">
              𝑁
             </ci>
             <ci id="A1.E13.m1.13.13.1.1.2.4.cmml" xref="A1.E13.m1.13.13.1.1.2.4">
              𝑅
             </ci>
            </apply>
            <apply id="A1.E13.m1.12.12.cmml" xref="A1.E13.m1.12.12">
             <divide id="A1.E13.m1.12.12.13.cmml" xref="A1.E13.m1.12.12">
             </divide>
             <apply id="A1.E13.m1.6.6.6.cmml" xref="A1.E13.m1.6.6.6">
              <apply id="A1.E13.m1.6.6.6.7.cmml" xref="A1.E13.m1.6.6.6.7">
               <csymbol cd="ambiguous" id="A1.E13.m1.6.6.6.7.1.cmml" xref="A1.E13.m1.6.6.6.7">
                subscript
               </csymbol>
               <sum id="A1.E13.m1.6.6.6.7.2.cmml" xref="A1.E13.m1.6.6.6.7.2">
               </sum>
               <apply id="A1.E13.m1.2.2.2.2.2.cmml" xref="A1.E13.m1.2.2.2.2.2">
                <in id="A1.E13.m1.2.2.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.2.2.3">
                </in>
                <list id="A1.E13.m1.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.2.2.2.2">
                 <apply id="A1.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A1.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1.2">
                   𝑆
                  </ci>
                  <ci id="A1.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.1.1.1.1.3">
                   𝑖
                  </ci>
                 </apply>
                 <apply id="A1.E13.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.2.2.2.2.2.2.2.2">
                  <csymbol cd="ambiguous" id="A1.E13.m1.2.2.2.2.2.2.2.2.1.cmml" xref="A1.E13.m1.2.2.2.2.2.2.2.2">
                   subscript
                  </csymbol>
                  <ci id="A1.E13.m1.2.2.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.2.2.2.2.2.2.2.2.2">
                   𝑆
                  </ci>
                  <ci id="A1.E13.m1.2.2.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.2.2.2.2.2.3">
                   𝑗
                  </ci>
                 </apply>
                </list>
                <ci id="A1.E13.m1.2.2.2.2.2.4.cmml" xref="A1.E13.m1.2.2.2.2.2.4">
                 𝒮
                </ci>
               </apply>
              </apply>
              <apply id="A1.E13.m1.6.6.6.6.cmml" xref="A1.E13.m1.6.6.6.6">
               <times id="A1.E13.m1.6.6.6.6.3.cmml" xref="A1.E13.m1.6.6.6.6.3">
               </times>
               <apply id="A1.E13.m1.5.5.5.5.1.cmml" xref="A1.E13.m1.5.5.5.5.1">
                <ci id="A1.E13.m1.5.5.5.5.1.2.cmml" xref="A1.E13.m1.5.5.5.5.1.2">
                 ⋅
                </ci>
                <apply id="A1.E13.m1.5.5.5.5.1.1.cmml" xref="A1.E13.m1.5.5.5.5.1.1">
                 <times id="A1.E13.m1.5.5.5.5.1.1.2.cmml" xref="A1.E13.m1.5.5.5.5.1.1.2">
                 </times>
                 <cn id="A1.E13.m1.5.5.5.5.1.1.3.cmml" type="integer" xref="A1.E13.m1.5.5.5.5.1.1.3">
                  1
                 </cn>
                 <apply id="A1.E13.m1.5.5.5.5.1.1.1.1.1.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1">
                  <gt id="A1.E13.m1.5.5.5.5.1.1.1.1.1.1.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.1">
                  </gt>
                  <apply id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2">
                   <csymbol cd="ambiguous" id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2">
                    subscript
                   </csymbol>
                   <ci id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.2">
                    𝑦
                   </ci>
                   <ci id="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.2.3">
                    𝑖
                   </ci>
                  </apply>
                  <apply id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3">
                    subscript
                   </csymbol>
                   <ci id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.2">
                    𝑦
                   </ci>
                   <ci id="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.3.cmml" xref="A1.E13.m1.5.5.5.5.1.1.1.1.1.3.3">
                    𝑗
                   </ci>
                  </apply>
                 </apply>
                </apply>
                <cn id="A1.E13.m1.5.5.5.5.1.3.cmml" type="integer" xref="A1.E13.m1.5.5.5.5.1.3">
                 1
                </cn>
               </apply>
               <apply id="A1.E13.m1.6.6.6.6.2.1.1.cmml" xref="A1.E13.m1.6.6.6.6.2.1">
                <gt id="A1.E13.m1.6.6.6.6.2.1.1.3.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.3">
                </gt>
                <apply id="A1.E13.m1.6.6.6.6.2.1.1.1.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1">
                 <times id="A1.E13.m1.6.6.6.6.2.1.1.1.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.2">
                 </times>
                 <ci id="A1.E13.m1.6.6.6.6.2.1.1.1.3.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.3">
                  𝑓
                 </ci>
                 <interval closure="open" id="A1.E13.m1.6.6.6.6.2.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1">
                  <ci id="A1.E13.m1.3.3.3.3.cmml" xref="A1.E13.m1.3.3.3.3">
                   𝐼
                  </ci>
                  <apply id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.2">
                    𝑆
                   </ci>
                   <ci id="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.1.1.1.1.3">
                    𝑖
                   </ci>
                  </apply>
                 </interval>
                </apply>
                <apply id="A1.E13.m1.6.6.6.6.2.1.1.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2">
                 <times id="A1.E13.m1.6.6.6.6.2.1.1.2.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.2">
                 </times>
                 <ci id="A1.E13.m1.6.6.6.6.2.1.1.2.3.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.3">
                  𝑓
                 </ci>
                 <interval closure="open" id="A1.E13.m1.6.6.6.6.2.1.1.2.1.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1">
                  <ci id="A1.E13.m1.4.4.4.4.cmml" xref="A1.E13.m1.4.4.4.4">
                   𝐼
                  </ci>
                  <apply id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1">
                   <csymbol cd="ambiguous" id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.1.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.2.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.2">
                    𝑆
                   </ci>
                   <ci id="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.3.cmml" xref="A1.E13.m1.6.6.6.6.2.1.1.2.1.1.1.3">
                    𝑗
                   </ci>
                  </apply>
                 </interval>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E13.m1.12.12.12.cmml" xref="A1.E13.m1.12.12.12">
              <apply id="A1.E13.m1.12.12.12.7.cmml" xref="A1.E13.m1.12.12.12.7">
               <csymbol cd="ambiguous" id="A1.E13.m1.12.12.12.7.1.cmml" xref="A1.E13.m1.12.12.12.7">
                subscript
               </csymbol>
               <sum id="A1.E13.m1.12.12.12.7.2.cmml" xref="A1.E13.m1.12.12.12.7.2">
               </sum>
               <apply id="A1.E13.m1.8.8.8.2.2.cmml" xref="A1.E13.m1.8.8.8.2.2">
                <in id="A1.E13.m1.8.8.8.2.2.3.cmml" xref="A1.E13.m1.8.8.8.2.2.3">
                </in>
                <list id="A1.E13.m1.8.8.8.2.2.2.3.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2">
                 <apply id="A1.E13.m1.7.7.7.1.1.1.1.1.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.E13.m1.7.7.7.1.1.1.1.1.1.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1">
                   superscript
                  </csymbol>
                  <apply id="A1.E13.m1.7.7.7.1.1.1.1.1.2.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A1.E13.m1.7.7.7.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A1.E13.m1.7.7.7.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1.2.2">
                    𝑆
                   </ci>
                   <ci id="A1.E13.m1.7.7.7.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1.2.3">
                    𝑖
                   </ci>
                  </apply>
                  <ci id="A1.E13.m1.7.7.7.1.1.1.1.1.3.cmml" xref="A1.E13.m1.7.7.7.1.1.1.1.1.3">
                   ′
                  </ci>
                 </apply>
                 <apply id="A1.E13.m1.8.8.8.2.2.2.2.2.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2">
                  <csymbol cd="ambiguous" id="A1.E13.m1.8.8.8.2.2.2.2.2.1.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2">
                   superscript
                  </csymbol>
                  <apply id="A1.E13.m1.8.8.8.2.2.2.2.2.2.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2">
                   <csymbol cd="ambiguous" id="A1.E13.m1.8.8.8.2.2.2.2.2.2.1.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2">
                    subscript
                   </csymbol>
                   <ci id="A1.E13.m1.8.8.8.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2.2.2">
                    𝑆
                   </ci>
                   <ci id="A1.E13.m1.8.8.8.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2.2.3">
                    𝑗
                   </ci>
                  </apply>
                  <ci id="A1.E13.m1.8.8.8.2.2.2.2.2.3.cmml" xref="A1.E13.m1.8.8.8.2.2.2.2.2.3">
                   ′
                  </ci>
                 </apply>
                </list>
                <ci id="A1.E13.m1.8.8.8.2.2.4.cmml" xref="A1.E13.m1.8.8.8.2.2.4">
                 𝒮
                </ci>
               </apply>
              </apply>
              <apply id="A1.E13.m1.12.12.12.6.cmml" xref="A1.E13.m1.12.12.12.6">
               <times id="A1.E13.m1.12.12.12.6.3.cmml" xref="A1.E13.m1.12.12.12.6.3">
               </times>
               <apply id="A1.E13.m1.11.11.11.5.1.cmml" xref="A1.E13.m1.11.11.11.5.1">
                <ci id="A1.E13.m1.11.11.11.5.1.2.cmml" xref="A1.E13.m1.11.11.11.5.1.2">
                 ⋅
                </ci>
                <apply id="A1.E13.m1.11.11.11.5.1.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1">
                 <times id="A1.E13.m1.11.11.11.5.1.1.2.cmml" xref="A1.E13.m1.11.11.11.5.1.1.2">
                 </times>
                 <cn id="A1.E13.m1.11.11.11.5.1.1.3.cmml" type="integer" xref="A1.E13.m1.11.11.11.5.1.1.3">
                  1
                 </cn>
                 <apply id="A1.E13.m1.11.11.11.5.1.1.1.1.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1">
                  <gt id="A1.E13.m1.11.11.11.5.1.1.1.1.1.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.1">
                  </gt>
                  <apply id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2">
                   <csymbol cd="ambiguous" id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2">
                    superscript
                   </csymbol>
                   <apply id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2">
                    <csymbol cd="ambiguous" id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2">
                     subscript
                    </csymbol>
                    <ci id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.2.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.2">
                     𝑦
                    </ci>
                    <ci id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.3.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.2.3">
                     𝑖
                    </ci>
                   </apply>
                   <ci id="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.2.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3">
                    superscript
                   </csymbol>
                   <apply id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3">
                    <csymbol cd="ambiguous" id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.1.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.2.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.2">
                     𝑦
                    </ci>
                    <ci id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.3.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.2.3">
                     𝑗
                    </ci>
                   </apply>
                   <ci id="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.3.cmml" xref="A1.E13.m1.11.11.11.5.1.1.1.1.1.3.3">
                    ′
                   </ci>
                  </apply>
                 </apply>
                </apply>
                <cn id="A1.E13.m1.11.11.11.5.1.3.cmml" type="integer" xref="A1.E13.m1.11.11.11.5.1.3">
                 1
                </cn>
               </apply>
               <apply id="A1.E13.m1.12.12.12.6.2.1.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1">
                <lt id="A1.E13.m1.12.12.12.6.2.1.1.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.3">
                </lt>
                <apply id="A1.E13.m1.12.12.12.6.2.1.1.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1">
                 <times id="A1.E13.m1.12.12.12.6.2.1.1.1.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.2">
                 </times>
                 <ci id="A1.E13.m1.12.12.12.6.2.1.1.1.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.3">
                  𝑓
                 </ci>
                 <interval closure="open" id="A1.E13.m1.12.12.12.6.2.1.1.1.1.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1">
                  <ci id="A1.E13.m1.9.9.9.3.cmml" xref="A1.E13.m1.9.9.9.3">
                   𝐼
                  </ci>
                  <apply id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1">
                    superscript
                   </csymbol>
                   <apply id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1">
                     subscript
                    </csymbol>
                    <ci id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.2">
                     𝑆
                    </ci>
                    <ci id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.2.3">
                     𝑖
                    </ci>
                   </apply>
                   <ci id="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.1.1.1.1.3">
                    ′
                   </ci>
                  </apply>
                 </interval>
                </apply>
                <apply id="A1.E13.m1.12.12.12.6.2.1.1.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2">
                 <times id="A1.E13.m1.12.12.12.6.2.1.1.2.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.2">
                 </times>
                 <ci id="A1.E13.m1.12.12.12.6.2.1.1.2.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.3">
                  𝑓
                 </ci>
                 <interval closure="open" id="A1.E13.m1.12.12.12.6.2.1.1.2.1.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1">
                  <ci id="A1.E13.m1.10.10.10.4.cmml" xref="A1.E13.m1.10.10.10.4">
                   𝐼
                  </ci>
                  <apply id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1">
                   <csymbol cd="ambiguous" id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1">
                    superscript
                   </csymbol>
                   <apply id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1">
                    <csymbol cd="ambiguous" id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.1.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1">
                     subscript
                    </csymbol>
                    <ci id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.2.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.2">
                     𝑆
                    </ci>
                    <ci id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.2.3">
                     𝑗
                    </ci>
                   </apply>
                   <ci id="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.3.cmml" xref="A1.E13.m1.12.12.12.6.2.1.1.2.1.1.1.3">
                    ′
                   </ci>
                  </apply>
                 </interval>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.E13.m1.13c">
           \displaystyle PNR=\frac{\sum_{S_{i},S_{j}\in\mathcal{S}}\mathbbm{1}(y_{i}&gt;y_{j})\cdot\mathbbm{1}(f(I,S_{i})&gt;f(I,S_{j}))}{\sum_{S_{i}^{\prime},S_{j}^{\prime}\in\mathcal{S}}\mathbbm{1}(y_{i}^{\prime}&gt;y_{j}^{\prime})\cdot\mathbbm{1}(f(I,S_{i}^{\prime})&lt;f(I,S_{j}^{\prime}))},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A1.SS4.p2.11">
     where
     <math alttext="y_{i}" class="ltx_Math" display="inline" id="A1.SS4.p2.3.m1.1">
      <semantics id="A1.SS4.p2.3.m1.1a">
       <msub id="A1.SS4.p2.3.m1.1.1" xref="A1.SS4.p2.3.m1.1.1.cmml">
        <mi id="A1.SS4.p2.3.m1.1.1.2" xref="A1.SS4.p2.3.m1.1.1.2.cmml">
         y
        </mi>
        <mi id="A1.SS4.p2.3.m1.1.1.3" xref="A1.SS4.p2.3.m1.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.3.m1.1b">
        <apply id="A1.SS4.p2.3.m1.1.1.cmml" xref="A1.SS4.p2.3.m1.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p2.3.m1.1.1.1.cmml" xref="A1.SS4.p2.3.m1.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p2.3.m1.1.1.2.cmml" xref="A1.SS4.p2.3.m1.1.1.2">
          𝑦
         </ci>
         <ci id="A1.SS4.p2.3.m1.1.1.3.cmml" xref="A1.SS4.p2.3.m1.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.3.m1.1c">
        y_{i}
       </annotation>
      </semantics>
     </math>
     denotes the manual label (i.e., click or not by users) of the suggestion
     <math alttext="S_{i}" class="ltx_Math" display="inline" id="A1.SS4.p2.4.m2.1">
      <semantics id="A1.SS4.p2.4.m2.1a">
       <msub id="A1.SS4.p2.4.m2.1.1" xref="A1.SS4.p2.4.m2.1.1.cmml">
        <mi id="A1.SS4.p2.4.m2.1.1.2" xref="A1.SS4.p2.4.m2.1.1.2.cmml">
         S
        </mi>
        <mi id="A1.SS4.p2.4.m2.1.1.3" xref="A1.SS4.p2.4.m2.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.4.m2.1b">
        <apply id="A1.SS4.p2.4.m2.1.1.cmml" xref="A1.SS4.p2.4.m2.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p2.4.m2.1.1.1.cmml" xref="A1.SS4.p2.4.m2.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p2.4.m2.1.1.2.cmml" xref="A1.SS4.p2.4.m2.1.1.2">
          𝑆
         </ci>
         <ci id="A1.SS4.p2.4.m2.1.1.3.cmml" xref="A1.SS4.p2.4.m2.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.4.m2.1c">
        S_{i}
       </annotation>
      </semantics>
     </math>
     , and
     <math alttext="f(I,S_{i})" class="ltx_Math" display="inline" id="A1.SS4.p2.5.m3.2">
      <semantics id="A1.SS4.p2.5.m3.2a">
       <mrow id="A1.SS4.p2.5.m3.2.2" xref="A1.SS4.p2.5.m3.2.2.cmml">
        <mi id="A1.SS4.p2.5.m3.2.2.3" xref="A1.SS4.p2.5.m3.2.2.3.cmml">
         f
        </mi>
        <mo id="A1.SS4.p2.5.m3.2.2.2" lspace="0em" rspace="0em" xref="A1.SS4.p2.5.m3.2.2.2.cmml">
         ​
        </mo>
        <mrow id="A1.SS4.p2.5.m3.2.2.1.1" xref="A1.SS4.p2.5.m3.2.2.1.2.cmml">
         <mo id="A1.SS4.p2.5.m3.2.2.1.1.2" stretchy="false" xref="A1.SS4.p2.5.m3.2.2.1.2.cmml">
          (
         </mo>
         <mi id="A1.SS4.p2.5.m3.1.1" xref="A1.SS4.p2.5.m3.1.1.cmml">
          I
         </mi>
         <mo id="A1.SS4.p2.5.m3.2.2.1.1.3" xref="A1.SS4.p2.5.m3.2.2.1.2.cmml">
          ,
         </mo>
         <msub id="A1.SS4.p2.5.m3.2.2.1.1.1" xref="A1.SS4.p2.5.m3.2.2.1.1.1.cmml">
          <mi id="A1.SS4.p2.5.m3.2.2.1.1.1.2" xref="A1.SS4.p2.5.m3.2.2.1.1.1.2.cmml">
           S
          </mi>
          <mi id="A1.SS4.p2.5.m3.2.2.1.1.1.3" xref="A1.SS4.p2.5.m3.2.2.1.1.1.3.cmml">
           i
          </mi>
         </msub>
         <mo id="A1.SS4.p2.5.m3.2.2.1.1.4" stretchy="false" xref="A1.SS4.p2.5.m3.2.2.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.5.m3.2b">
        <apply id="A1.SS4.p2.5.m3.2.2.cmml" xref="A1.SS4.p2.5.m3.2.2">
         <times id="A1.SS4.p2.5.m3.2.2.2.cmml" xref="A1.SS4.p2.5.m3.2.2.2">
         </times>
         <ci id="A1.SS4.p2.5.m3.2.2.3.cmml" xref="A1.SS4.p2.5.m3.2.2.3">
          𝑓
         </ci>
         <interval closure="open" id="A1.SS4.p2.5.m3.2.2.1.2.cmml" xref="A1.SS4.p2.5.m3.2.2.1.1">
          <ci id="A1.SS4.p2.5.m3.1.1.cmml" xref="A1.SS4.p2.5.m3.1.1">
           𝐼
          </ci>
          <apply id="A1.SS4.p2.5.m3.2.2.1.1.1.cmml" xref="A1.SS4.p2.5.m3.2.2.1.1.1">
           <csymbol cd="ambiguous" id="A1.SS4.p2.5.m3.2.2.1.1.1.1.cmml" xref="A1.SS4.p2.5.m3.2.2.1.1.1">
            subscript
           </csymbol>
           <ci id="A1.SS4.p2.5.m3.2.2.1.1.1.2.cmml" xref="A1.SS4.p2.5.m3.2.2.1.1.1.2">
            𝑆
           </ci>
           <ci id="A1.SS4.p2.5.m3.2.2.1.1.1.3.cmml" xref="A1.SS4.p2.5.m3.2.2.1.1.1.3">
            𝑖
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.5.m3.2c">
        f(I,S_{i})
       </annotation>
      </semantics>
     </math>
     denotes the cosine similarity based on the representations of query image
     <math alttext="I" class="ltx_Math" display="inline" id="A1.SS4.p2.6.m4.1">
      <semantics id="A1.SS4.p2.6.m4.1a">
       <mi id="A1.SS4.p2.6.m4.1.1" xref="A1.SS4.p2.6.m4.1.1.cmml">
        I
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.6.m4.1b">
        <ci id="A1.SS4.p2.6.m4.1.1.cmml" xref="A1.SS4.p2.6.m4.1.1">
         𝐼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.6.m4.1c">
        I
       </annotation>
      </semantics>
     </math>
     and suggestion
     <math alttext="S_{i}" class="ltx_Math" display="inline" id="A1.SS4.p2.7.m5.1">
      <semantics id="A1.SS4.p2.7.m5.1a">
       <msub id="A1.SS4.p2.7.m5.1.1" xref="A1.SS4.p2.7.m5.1.1.cmml">
        <mi id="A1.SS4.p2.7.m5.1.1.2" xref="A1.SS4.p2.7.m5.1.1.2.cmml">
         S
        </mi>
        <mi id="A1.SS4.p2.7.m5.1.1.3" xref="A1.SS4.p2.7.m5.1.1.3.cmml">
         i
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.7.m5.1b">
        <apply id="A1.SS4.p2.7.m5.1.1.cmml" xref="A1.SS4.p2.7.m5.1.1">
         <csymbol cd="ambiguous" id="A1.SS4.p2.7.m5.1.1.1.cmml" xref="A1.SS4.p2.7.m5.1.1">
          subscript
         </csymbol>
         <ci id="A1.SS4.p2.7.m5.1.1.2.cmml" xref="A1.SS4.p2.7.m5.1.1.2">
          𝑆
         </ci>
         <ci id="A1.SS4.p2.7.m5.1.1.3.cmml" xref="A1.SS4.p2.7.m5.1.1.3">
          𝑖
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.7.m5.1c">
        S_{i}
       </annotation>
      </semantics>
     </math>
     . The indicator function
     <math alttext="\mathbbm{1}(\cdot)" class="ltx_Math" display="inline" id="A1.SS4.p2.8.m6.1">
      <semantics id="A1.SS4.p2.8.m6.1a">
       <mrow id="A1.SS4.p2.8.m6.1.2" xref="A1.SS4.p2.8.m6.1.2.cmml">
        <mn id="A1.SS4.p2.8.m6.1.2.2" xref="A1.SS4.p2.8.m6.1.2.2.cmml">
         𝟙
        </mn>
        <mo id="A1.SS4.p2.8.m6.1.2.1" lspace="0em" rspace="0em" xref="A1.SS4.p2.8.m6.1.2.1.cmml">
         ​
        </mo>
        <mrow id="A1.SS4.p2.8.m6.1.2.3.2" xref="A1.SS4.p2.8.m6.1.2.cmml">
         <mo id="A1.SS4.p2.8.m6.1.2.3.2.1" stretchy="false" xref="A1.SS4.p2.8.m6.1.2.cmml">
          (
         </mo>
         <mo id="A1.SS4.p2.8.m6.1.1" lspace="0em" rspace="0em" xref="A1.SS4.p2.8.m6.1.1.cmml">
          ⋅
         </mo>
         <mo id="A1.SS4.p2.8.m6.1.2.3.2.2" stretchy="false" xref="A1.SS4.p2.8.m6.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.8.m6.1b">
        <apply id="A1.SS4.p2.8.m6.1.2.cmml" xref="A1.SS4.p2.8.m6.1.2">
         <times id="A1.SS4.p2.8.m6.1.2.1.cmml" xref="A1.SS4.p2.8.m6.1.2.1">
         </times>
         <cn id="A1.SS4.p2.8.m6.1.2.2.cmml" type="integer" xref="A1.SS4.p2.8.m6.1.2.2">
          1
         </cn>
         <ci id="A1.SS4.p2.8.m6.1.1.cmml" xref="A1.SS4.p2.8.m6.1.1">
          ⋅
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.8.m6.1c">
        \mathbbm{1}(\cdot)
       </annotation>
      </semantics>
     </math>
     is used to represent whether a certain condition is true or false, e.g.,
     <math alttext="\mathbbm{1}(y_{i}&gt;y_{j})=1" class="ltx_Math" display="inline" id="A1.SS4.p2.9.m7.1">
      <semantics id="A1.SS4.p2.9.m7.1a">
       <mrow id="A1.SS4.p2.9.m7.1.1" xref="A1.SS4.p2.9.m7.1.1.cmml">
        <mrow id="A1.SS4.p2.9.m7.1.1.1" xref="A1.SS4.p2.9.m7.1.1.1.cmml">
         <mn id="A1.SS4.p2.9.m7.1.1.1.3" xref="A1.SS4.p2.9.m7.1.1.1.3.cmml">
          𝟙
         </mn>
         <mo id="A1.SS4.p2.9.m7.1.1.1.2" lspace="0em" rspace="0em" xref="A1.SS4.p2.9.m7.1.1.1.2.cmml">
          ​
         </mo>
         <mrow id="A1.SS4.p2.9.m7.1.1.1.1.1" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.cmml">
          <mo id="A1.SS4.p2.9.m7.1.1.1.1.1.2" stretchy="false" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="A1.SS4.p2.9.m7.1.1.1.1.1.1" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.cmml">
           <msub id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.cmml">
            <mi id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.2" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.2.cmml">
             y
            </mi>
            <mi id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.3" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.3.cmml">
             i
            </mi>
           </msub>
           <mo id="A1.SS4.p2.9.m7.1.1.1.1.1.1.1" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.1.cmml">
            &gt;
           </mo>
           <msub id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.cmml">
            <mi id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.2" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.2.cmml">
             y
            </mi>
            <mi id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.3" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.3.cmml">
             j
            </mi>
           </msub>
          </mrow>
          <mo id="A1.SS4.p2.9.m7.1.1.1.1.1.3" stretchy="false" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="A1.SS4.p2.9.m7.1.1.2" xref="A1.SS4.p2.9.m7.1.1.2.cmml">
         =
        </mo>
        <mn id="A1.SS4.p2.9.m7.1.1.3" xref="A1.SS4.p2.9.m7.1.1.3.cmml">
         1
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.9.m7.1b">
        <apply id="A1.SS4.p2.9.m7.1.1.cmml" xref="A1.SS4.p2.9.m7.1.1">
         <eq id="A1.SS4.p2.9.m7.1.1.2.cmml" xref="A1.SS4.p2.9.m7.1.1.2">
         </eq>
         <apply id="A1.SS4.p2.9.m7.1.1.1.cmml" xref="A1.SS4.p2.9.m7.1.1.1">
          <times id="A1.SS4.p2.9.m7.1.1.1.2.cmml" xref="A1.SS4.p2.9.m7.1.1.1.2">
          </times>
          <cn id="A1.SS4.p2.9.m7.1.1.1.3.cmml" type="integer" xref="A1.SS4.p2.9.m7.1.1.1.3">
           1
          </cn>
          <apply id="A1.SS4.p2.9.m7.1.1.1.1.1.1.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1">
           <gt id="A1.SS4.p2.9.m7.1.1.1.1.1.1.1.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.1">
           </gt>
           <apply id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2">
            <csymbol cd="ambiguous" id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.1.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2">
             subscript
            </csymbol>
            <ci id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.2.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.2">
             𝑦
            </ci>
            <ci id="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.3.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.2.3">
             𝑖
            </ci>
           </apply>
           <apply id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3">
            <csymbol cd="ambiguous" id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.1.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3">
             subscript
            </csymbol>
            <ci id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.2.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.2">
             𝑦
            </ci>
            <ci id="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.3.cmml" xref="A1.SS4.p2.9.m7.1.1.1.1.1.1.3.3">
             𝑗
            </ci>
           </apply>
          </apply>
         </apply>
         <cn id="A1.SS4.p2.9.m7.1.1.3.cmml" type="integer" xref="A1.SS4.p2.9.m7.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.9.m7.1c">
        \mathbbm{1}(y_{i}&gt;y_{j})=1
       </annotation>
      </semantics>
     </math>
     if
     <math alttext="y_{i}&gt;y_{j}" class="ltx_Math" display="inline" id="A1.SS4.p2.10.m8.1">
      <semantics id="A1.SS4.p2.10.m8.1a">
       <mrow id="A1.SS4.p2.10.m8.1.1" xref="A1.SS4.p2.10.m8.1.1.cmml">
        <msub id="A1.SS4.p2.10.m8.1.1.2" xref="A1.SS4.p2.10.m8.1.1.2.cmml">
         <mi id="A1.SS4.p2.10.m8.1.1.2.2" xref="A1.SS4.p2.10.m8.1.1.2.2.cmml">
          y
         </mi>
         <mi id="A1.SS4.p2.10.m8.1.1.2.3" xref="A1.SS4.p2.10.m8.1.1.2.3.cmml">
          i
         </mi>
        </msub>
        <mo id="A1.SS4.p2.10.m8.1.1.1" xref="A1.SS4.p2.10.m8.1.1.1.cmml">
         &gt;
        </mo>
        <msub id="A1.SS4.p2.10.m8.1.1.3" xref="A1.SS4.p2.10.m8.1.1.3.cmml">
         <mi id="A1.SS4.p2.10.m8.1.1.3.2" xref="A1.SS4.p2.10.m8.1.1.3.2.cmml">
          y
         </mi>
         <mi id="A1.SS4.p2.10.m8.1.1.3.3" xref="A1.SS4.p2.10.m8.1.1.3.3.cmml">
          j
         </mi>
        </msub>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.10.m8.1b">
        <apply id="A1.SS4.p2.10.m8.1.1.cmml" xref="A1.SS4.p2.10.m8.1.1">
         <gt id="A1.SS4.p2.10.m8.1.1.1.cmml" xref="A1.SS4.p2.10.m8.1.1.1">
         </gt>
         <apply id="A1.SS4.p2.10.m8.1.1.2.cmml" xref="A1.SS4.p2.10.m8.1.1.2">
          <csymbol cd="ambiguous" id="A1.SS4.p2.10.m8.1.1.2.1.cmml" xref="A1.SS4.p2.10.m8.1.1.2">
           subscript
          </csymbol>
          <ci id="A1.SS4.p2.10.m8.1.1.2.2.cmml" xref="A1.SS4.p2.10.m8.1.1.2.2">
           𝑦
          </ci>
          <ci id="A1.SS4.p2.10.m8.1.1.2.3.cmml" xref="A1.SS4.p2.10.m8.1.1.2.3">
           𝑖
          </ci>
         </apply>
         <apply id="A1.SS4.p2.10.m8.1.1.3.cmml" xref="A1.SS4.p2.10.m8.1.1.3">
          <csymbol cd="ambiguous" id="A1.SS4.p2.10.m8.1.1.3.1.cmml" xref="A1.SS4.p2.10.m8.1.1.3">
           subscript
          </csymbol>
          <ci id="A1.SS4.p2.10.m8.1.1.3.2.cmml" xref="A1.SS4.p2.10.m8.1.1.3.2">
           𝑦
          </ci>
          <ci id="A1.SS4.p2.10.m8.1.1.3.3.cmml" xref="A1.SS4.p2.10.m8.1.1.3.3">
           𝑗
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.10.m8.1c">
        y_{i}&gt;y_{j}
       </annotation>
      </semantics>
     </math>
     , and 0 otherwise. Intuitively, PNR quantifies the agreement between the manual labels and the model scores.
For Recall@
     <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p2.11.m9.1">
      <semantics id="A1.SS4.p2.11.m9.1a">
       <mi id="A1.SS4.p2.11.m9.1.1" xref="A1.SS4.p2.11.m9.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.11.m9.1b">
        <ci id="A1.SS4.p2.11.m9.1.1.cmml" xref="A1.SS4.p2.11.m9.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.11.m9.1c">
        K
       </annotation>
      </semantics>
     </math>
     , it is defined as
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx12">
     <tbody id="A1.E14">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_left">
         (14)
        </span>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle Recall@K=\frac{|\mathcal{S}|\cap|\hat{\mathcal{S}}|}{K}," class="ltx_Math" display="inline" id="A1.E14.m1.3">
         <semantics id="A1.E14.m1.3a">
          <mrow id="A1.E14.m1.3.3.1" xref="A1.E14.m1.3.3.1.1.cmml">
           <mrow id="A1.E14.m1.3.3.1.1" xref="A1.E14.m1.3.3.1.1.cmml">
            <mrow id="A1.E14.m1.3.3.1.1.2" xref="A1.E14.m1.3.3.1.1.2.cmml">
             <mi id="A1.E14.m1.3.3.1.1.2.2" xref="A1.E14.m1.3.3.1.1.2.2.cmml">
              R
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.3" xref="A1.E14.m1.3.3.1.1.2.3.cmml">
              e
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1a" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.4" xref="A1.E14.m1.3.3.1.1.2.4.cmml">
              c
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1b" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.5" xref="A1.E14.m1.3.3.1.1.2.5.cmml">
              a
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1c" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.6" xref="A1.E14.m1.3.3.1.1.2.6.cmml">
              l
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1d" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.7" xref="A1.E14.m1.3.3.1.1.2.7.cmml">
              l
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1e" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.8" mathvariant="normal" xref="A1.E14.m1.3.3.1.1.2.8.cmml">
              @
             </mi>
             <mo id="A1.E14.m1.3.3.1.1.2.1f" lspace="0em" rspace="0em" xref="A1.E14.m1.3.3.1.1.2.1.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.3.3.1.1.2.9" xref="A1.E14.m1.3.3.1.1.2.9.cmml">
              K
             </mi>
            </mrow>
            <mo id="A1.E14.m1.3.3.1.1.1" xref="A1.E14.m1.3.3.1.1.1.cmml">
             =
            </mo>
            <mstyle displaystyle="true" id="A1.E14.m1.2.2" xref="A1.E14.m1.2.2.cmml">
             <mfrac id="A1.E14.m1.2.2a" xref="A1.E14.m1.2.2.cmml">
              <mrow id="A1.E14.m1.2.2.2" xref="A1.E14.m1.2.2.2.cmml">
               <mrow id="A1.E14.m1.2.2.2.4.2" xref="A1.E14.m1.2.2.2.4.1.cmml">
                <mo id="A1.E14.m1.2.2.2.4.2.1" stretchy="false" xref="A1.E14.m1.2.2.2.4.1.1.cmml">
                 |
                </mo>
                <mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml">
                 𝒮
                </mi>
                <mo id="A1.E14.m1.2.2.2.4.2.2" stretchy="false" xref="A1.E14.m1.2.2.2.4.1.1.cmml">
                 |
                </mo>
               </mrow>
               <mo id="A1.E14.m1.2.2.2.3" xref="A1.E14.m1.2.2.2.3.cmml">
                ∩
               </mo>
               <mrow id="A1.E14.m1.2.2.2.5.2" xref="A1.E14.m1.2.2.2.5.1.cmml">
                <mo id="A1.E14.m1.2.2.2.5.2.1" stretchy="false" xref="A1.E14.m1.2.2.2.5.1.1.cmml">
                 |
                </mo>
                <mover accent="true" id="A1.E14.m1.2.2.2.2" xref="A1.E14.m1.2.2.2.2.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.2.2.2.2.2" xref="A1.E14.m1.2.2.2.2.2.cmml">
                  𝒮
                 </mi>
                 <mo id="A1.E14.m1.2.2.2.2.1" xref="A1.E14.m1.2.2.2.2.1.cmml">
                  ^
                 </mo>
                </mover>
                <mo id="A1.E14.m1.2.2.2.5.2.2" stretchy="false" xref="A1.E14.m1.2.2.2.5.1.1.cmml">
                 |
                </mo>
               </mrow>
              </mrow>
              <mi id="A1.E14.m1.2.2.4" xref="A1.E14.m1.2.2.4.cmml">
               K
              </mi>
             </mfrac>
            </mstyle>
           </mrow>
           <mo id="A1.E14.m1.3.3.1.2" xref="A1.E14.m1.3.3.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="A1.E14.m1.3b">
           <apply id="A1.E14.m1.3.3.1.1.cmml" xref="A1.E14.m1.3.3.1">
            <eq id="A1.E14.m1.3.3.1.1.1.cmml" xref="A1.E14.m1.3.3.1.1.1">
            </eq>
            <apply id="A1.E14.m1.3.3.1.1.2.cmml" xref="A1.E14.m1.3.3.1.1.2">
             <times id="A1.E14.m1.3.3.1.1.2.1.cmml" xref="A1.E14.m1.3.3.1.1.2.1">
             </times>
             <ci id="A1.E14.m1.3.3.1.1.2.2.cmml" xref="A1.E14.m1.3.3.1.1.2.2">
              𝑅
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.3.cmml" xref="A1.E14.m1.3.3.1.1.2.3">
              𝑒
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.4.cmml" xref="A1.E14.m1.3.3.1.1.2.4">
              𝑐
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.5.cmml" xref="A1.E14.m1.3.3.1.1.2.5">
              𝑎
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.6.cmml" xref="A1.E14.m1.3.3.1.1.2.6">
              𝑙
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.7.cmml" xref="A1.E14.m1.3.3.1.1.2.7">
              𝑙
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.8.cmml" xref="A1.E14.m1.3.3.1.1.2.8">
              @
             </ci>
             <ci id="A1.E14.m1.3.3.1.1.2.9.cmml" xref="A1.E14.m1.3.3.1.1.2.9">
              𝐾
             </ci>
            </apply>
            <apply id="A1.E14.m1.2.2.cmml" xref="A1.E14.m1.2.2">
             <divide id="A1.E14.m1.2.2.3.cmml" xref="A1.E14.m1.2.2">
             </divide>
             <apply id="A1.E14.m1.2.2.2.cmml" xref="A1.E14.m1.2.2.2">
              <intersect id="A1.E14.m1.2.2.2.3.cmml" xref="A1.E14.m1.2.2.2.3">
              </intersect>
              <apply id="A1.E14.m1.2.2.2.4.1.cmml" xref="A1.E14.m1.2.2.2.4.2">
               <abs id="A1.E14.m1.2.2.2.4.1.1.cmml" xref="A1.E14.m1.2.2.2.4.2.1">
               </abs>
               <ci id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1">
                𝒮
               </ci>
              </apply>
              <apply id="A1.E14.m1.2.2.2.5.1.cmml" xref="A1.E14.m1.2.2.2.5.2">
               <abs id="A1.E14.m1.2.2.2.5.1.1.cmml" xref="A1.E14.m1.2.2.2.5.2.1">
               </abs>
               <apply id="A1.E14.m1.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2">
                <ci id="A1.E14.m1.2.2.2.2.1.cmml" xref="A1.E14.m1.2.2.2.2.1">
                 ^
                </ci>
                <ci id="A1.E14.m1.2.2.2.2.2.cmml" xref="A1.E14.m1.2.2.2.2.2">
                 𝒮
                </ci>
               </apply>
              </apply>
             </apply>
             <ci id="A1.E14.m1.2.2.4.cmml" xref="A1.E14.m1.2.2.4">
              𝐾
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A1.E14.m1.3c">
           \displaystyle Recall@K=\frac{|\mathcal{S}|\cap|\hat{\mathcal{S}}|}{K},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="A1.SS4.p2.16">
     where
     <math alttext="\hat{\mathcal{S}}" class="ltx_Math" display="inline" id="A1.SS4.p2.12.m1.1">
      <semantics id="A1.SS4.p2.12.m1.1a">
       <mover accent="true" id="A1.SS4.p2.12.m1.1.1" xref="A1.SS4.p2.12.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p2.12.m1.1.1.2" xref="A1.SS4.p2.12.m1.1.1.2.cmml">
         𝒮
        </mi>
        <mo id="A1.SS4.p2.12.m1.1.1.1" xref="A1.SS4.p2.12.m1.1.1.1.cmml">
         ^
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.12.m1.1b">
        <apply id="A1.SS4.p2.12.m1.1.1.cmml" xref="A1.SS4.p2.12.m1.1.1">
         <ci id="A1.SS4.p2.12.m1.1.1.1.cmml" xref="A1.SS4.p2.12.m1.1.1.1">
          ^
         </ci>
         <ci id="A1.SS4.p2.12.m1.1.1.2.cmml" xref="A1.SS4.p2.12.m1.1.1.2">
          𝒮
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.12.m1.1c">
        \hat{\mathcal{S}}
       </annotation>
      </semantics>
     </math>
     denotes the suggestions for a query image
     <math alttext="I" class="ltx_Math" display="inline" id="A1.SS4.p2.13.m2.1">
      <semantics id="A1.SS4.p2.13.m2.1a">
       <mi id="A1.SS4.p2.13.m2.1.1" xref="A1.SS4.p2.13.m2.1.1.cmml">
        I
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.13.m2.1b">
        <ci id="A1.SS4.p2.13.m2.1.1.cmml" xref="A1.SS4.p2.13.m2.1.1">
         𝐼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.13.m2.1c">
        I
       </annotation>
      </semantics>
     </math>
     by a retrieval model, and
     <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="A1.SS4.p2.14.m3.1">
      <semantics id="A1.SS4.p2.14.m3.1a">
       <mi class="ltx_font_mathcaligraphic" id="A1.SS4.p2.14.m3.1.1" xref="A1.SS4.p2.14.m3.1.1.cmml">
        𝒮
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.14.m3.1b">
        <ci id="A1.SS4.p2.14.m3.1.1.cmml" xref="A1.SS4.p2.14.m3.1.1">
         𝒮
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.14.m3.1c">
        \mathcal{S}
       </annotation>
      </semantics>
     </math>
     denotes the set of ground truth suggestions (e.g., the suggestions that will be clicked by human labelers) for the
     <math alttext="I" class="ltx_Math" display="inline" id="A1.SS4.p2.15.m4.1">
      <semantics id="A1.SS4.p2.15.m4.1a">
       <mi id="A1.SS4.p2.15.m4.1.1" xref="A1.SS4.p2.15.m4.1.1.cmml">
        I
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.15.m4.1b">
        <ci id="A1.SS4.p2.15.m4.1.1.cmml" xref="A1.SS4.p2.15.m4.1.1">
         𝐼
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.15.m4.1c">
        I
       </annotation>
      </semantics>
     </math>
     . We report the average PNR and Recall@
     <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p2.16.m5.1">
      <semantics id="A1.SS4.p2.16.m5.1a">
       <mi id="A1.SS4.p2.16.m5.1.1" xref="A1.SS4.p2.16.m5.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p2.16.m5.1b">
        <ci id="A1.SS4.p2.16.m5.1.1.cmml" xref="A1.SS4.p2.16.m5.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p2.16.m5.1c">
        K
       </annotation>
      </semantics>
     </math>
     values across all queries in our experiments.
    </p>
   </div>
   <div class="ltx_para" id="A1.SS4.p3">
    <p class="ltx_p" id="A1.SS4.p3.1">
     In addition, to measure the diversity within a set of output query suggestions, we report the DIV according to Equation
     <a class="ltx_ref" href="#S4.E7" title="In 4.4. Agent-D: Choosing Diverse Suggestions from the Candidates ‣ 4. METHODOLOGY ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     . Overall, superior results are indicated by higher values of DCG, GSB, PNR, Recall@
     <math alttext="K" class="ltx_Math" display="inline" id="A1.SS4.p3.1.m1.1">
      <semantics id="A1.SS4.p3.1.m1.1a">
       <mi id="A1.SS4.p3.1.m1.1.1" xref="A1.SS4.p3.1.m1.1.1.cmml">
        K
       </mi>
       <annotation-xml encoding="MathML-Content" id="A1.SS4.p3.1.m1.1b">
        <ci id="A1.SS4.p3.1.m1.1.1.cmml" xref="A1.SS4.p3.1.m1.1.1">
         𝐾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="A1.SS4.p3.1.m1.1c">
        K
       </annotation>
      </semantics>
     </math>
     , and DIV.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.5.
    </span>
    Evaluation Platform
   </h3>
   <div class="ltx_para" id="A1.SS5.p1">
    <p class="ltx_p" id="A1.SS5.p1.1">
     We implement
     <span class="ltx_text ltx_font_typewriter" id="A1.SS5.p1.1.1">
      RL4Sugg
     </span>
     and other baselines in Python 3.7 and PyTorch 1.8.0. The experiments are conducted on a server with 32 cores of Intel(R) Xeon(R) Gold 6151 CPU @ 3.00GHz 512.0GB RAM and 8 Nvidia RTX3090 GPU (24GB memory).
    </p>
   </div>
   <figure class="ltx_table" id="A1.T10">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 10.
     </span>
     Parameter study (Business), 0 and 1 indicate all suggestions are labeled by GPT and human, respectively.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T10.1">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="A1.T10.1.1.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="A1.T10.1.1.1.1">
        Threshold
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T10.1.1.1.2">
        0
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T10.1.1.1.3">
        0.2
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T10.1.1.1.4">
        0.4
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T10.1.1.1.5">
        0.6
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T10.1.1.1.6">
        0.8
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T10.1.1.1.7">
        1
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A1.T10.1.2.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A1.T10.1.2.1.1">
        DCG
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T10.1.2.1.2">
        0.83
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T10.1.2.1.3">
        0.85
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T10.1.2.1.4">
        0.86
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T10.1.2.1.5">
        0.89
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T10.1.2.1.6">
        0.89
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="A1.T10.1.2.1.7">
        0.90
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T10.1.3.2">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T10.1.3.2.1">
        PNR
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.3.2.2">
        2.40
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.3.2.3">
        2.60
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.3.2.4">
        2.70
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.3.2.5">
        2.80
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.3.2.6">
        2.83
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.3.2.7">
        2.85
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T10.1.4.3">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="A1.T10.1.4.3.1">
        Recall@1
       </th>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.4.3.2">
        0.54
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.4.3.3">
        0.58
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.4.3.4">
        0.61
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.4.3.5">
        0.63
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.4.3.6">
        0.64
       </td>
       <td class="ltx_td ltx_align_center" id="A1.T10.1.4.3.7">
        0.64
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T10.1.5.4">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r ltx_border_t" id="A1.T10.1.5.4.1">
        <table class="ltx_tabular ltx_align_middle" id="A1.T10.1.5.4.1.1">
         <tr class="ltx_tr" id="A1.T10.1.5.4.1.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T10.1.5.4.1.1.1.1">
           #Suggs for
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T10.1.5.4.1.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T10.1.5.4.1.1.2.1">
           human labeling
          </td>
         </tr>
        </table>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T10.1.5.4.2">
        0
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T10.1.5.4.3">
        58K
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T10.1.5.4.4">
        96K
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T10.1.5.4.5">
        133K
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T10.1.5.4.6">
        202K
       </td>
       <td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="A1.T10.1.5.4.7">
        250K
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <figure class="ltx_table" id="A1.T11">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 11.
     </span>
     Examples of zero-shot image-to-suggestion generation using
     <span class="ltx_text ltx_font_typewriter" id="A1.T11.7.1">
      RL4Sugg
     </span>
     and Flamingo.
    </figcaption>
    <table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T11.5">
     <thead class="ltx_thead">
      <tr class="ltx_tr" id="A1.T11.5.6.1">
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T11.5.6.1.1">
        No.
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T11.5.6.1.2">
        Query Image
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T11.5.6.1.3">
        RL4Sugg
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T11.5.6.1.4">
        Flamingo
       </th>
       <th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A1.T11.5.6.1.5">
        GSB
       </th>
      </tr>
     </thead>
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="A1.T11.1.1">
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.1.1.2">
        1
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.1.1.1">
        <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.T11.1.1.1.1" style="width:130.1pt;">
         <span class="ltx_p" id="A1.T11.1.1.1.1.1">
          <span class="ltx_text" id="A1.T11.1.1.1.1.1.1" style="position:relative; bottom:-0.5pt;">
           <img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="603" id="A1.T11.1.1.1.1.1.1.g1" src="/html/2402.04867/assets/figures/fridge.jpg" width="598"/>
          </span>
         </span>
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.1.1.3">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.1.1.3.1">
         <tr class="ltx_tr" id="A1.T11.1.1.3.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.1.1.3.1.1.1">
           Tips for keeping a refrigerator clean
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.1.1.3.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.1.1.3.1.2.1">
           How to organize and clean a fridge
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.1.1.4">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.1.1.4.1">
         <tr class="ltx_tr" id="A1.T11.1.1.4.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.1.1.4.1.1.1">
           Desirable refrigerator brands
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.1.1.4.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.1.1.4.1.2.1">
           Where to buy shampoo
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T11.1.1.5">
        1.00
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T11.2.2">
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.2.2.2">
        2
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.2.2.1">
        <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.T11.2.2.1.1" style="width:130.1pt;">
         <span class="ltx_p" id="A1.T11.2.2.1.1.1">
          <span class="ltx_text" id="A1.T11.2.2.1.1.1.1" style="position:relative; bottom:-0.5pt;">
           <img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="591" id="A1.T11.2.2.1.1.1.1.g1" src="/html/2402.04867/assets/figures/dress.jpg" width="598"/>
          </span>
         </span>
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.2.2.3">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.2.2.3.1">
         <tr class="ltx_tr" id="A1.T11.2.2.3.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.2.2.3.1.1.1">
           How to choose the right dress for a outdoor photoshoot
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.2.2.3.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.2.2.3.1.2.1">
           Benefits of spending time in nature
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.2.2.4">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.2.2.4.1">
         <tr class="ltx_tr" id="A1.T11.2.2.4.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.2.2.4.1.1.1">
           Desirable wedding dresses
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.2.2.4.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.2.2.4.1.2.1">
           Where to buy wedding dresses
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T11.2.2.5">
        1.00
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T11.3.3">
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.3.3.2">
        3
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.3.3.1">
        <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.T11.3.3.1.1" style="width:130.1pt;">
         <span class="ltx_p" id="A1.T11.3.3.1.1.1">
          <span class="ltx_text" id="A1.T11.3.3.1.1.1.1" style="position:relative; bottom:-0.5pt;">
           <img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="615" id="A1.T11.3.3.1.1.1.1.g1" src="/html/2402.04867/assets/figures/phone.jpg" width="598"/>
          </span>
         </span>
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.3.3.3">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.3.3.3.1">
         <tr class="ltx_tr" id="A1.T11.3.3.3.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.3.3.3.1.1.1">
           How to fix a broken iPhone screen
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.3.3.3.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.3.3.3.1.2.1">
           How to clean a broken iPhone screen
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.3.3.4">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.3.3.4.1">
         <tr class="ltx_tr" id="A1.T11.3.3.4.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.3.3.4.1.1.1">
           Where to buy a new iPhone
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.3.3.4.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.3.3.4.1.2.1">
           Where to buy a new iPad
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T11.3.3.5">
        0.50
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T11.4.4">
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.4.4.2">
        4
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.4.4.1">
        <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.T11.4.4.1.1" style="width:130.1pt;">
         <span class="ltx_p" id="A1.T11.4.4.1.1.1">
          <span class="ltx_text" id="A1.T11.4.4.1.1.1.1" style="position:relative; bottom:-0.5pt;">
           <img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="577" id="A1.T11.4.4.1.1.1.1.g1" src="/html/2402.04867/assets/figures/croissant.jpg" width="598"/>
          </span>
         </span>
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.4.4.3">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.4.4.3.1">
         <tr class="ltx_tr" id="A1.T11.4.4.3.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.4.4.3.1.1.1">
           How to make fresh breads at home
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.4.4.3.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.4.4.3.1.2.1">
           Best places to buy fresh baked bread in the area
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T11.4.4.4">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.4.4.4.1">
         <tr class="ltx_tr" id="A1.T11.4.4.4.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.4.4.4.1.1.1">
           Where to buy breads
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.4.4.4.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.4.4.4.1.2.1">
           Where to buy breads
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_t" id="A1.T11.4.4.5">
        0.50
       </td>
      </tr>
      <tr class="ltx_tr" id="A1.T11.5.5">
       <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T11.5.5.2">
        5
       </td>
       <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T11.5.5.1">
        <span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A1.T11.5.5.1.1" style="width:130.1pt;">
         <span class="ltx_p" id="A1.T11.5.5.1.1.1">
          <span class="ltx_text" id="A1.T11.5.5.1.1.1.1" style="position:relative; bottom:-0.5pt;">
           <img alt="[Uncaptioned image]" class="ltx_graphics ltx_img_square" height="598" id="A1.T11.5.5.1.1.1.1.g1" src="/html/2402.04867/assets/figures/snowboarding.jpg" width="598"/>
          </span>
         </span>
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T11.5.5.3">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.5.5.3.1">
         <tr class="ltx_tr" id="A1.T11.5.5.3.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.5.5.3.1.1.1">
           Snowboarding safety tips and tricks
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.5.5.3.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.5.5.3.1.2.1">
           How to choose the right snowboarding gear
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T11.5.5.4">
        <table class="ltx_tabular ltx_align_middle" id="A1.T11.5.5.4.1">
         <tr class="ltx_tr" id="A1.T11.5.5.4.1.1">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.5.5.4.1.1.1">
           Desirable snowboard brands
          </td>
         </tr>
         <tr class="ltx_tr" id="A1.T11.5.5.4.1.2">
          <td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T11.5.5.4.1.2.1">
           Where to buy snowboard boots
          </td>
         </tr>
        </table>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="A1.T11.5.5.5">
        0.00
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
  </section>
  <section class="ltx_subsection" id="A1.SS6">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.6.
    </span>
    Parameter Study of Confidence Threshold
   </h3>
   <div class="ltx_para" id="A1.SS6.p1">
    <p class="ltx_p" id="A1.SS6.p1.1">
     Recall that during data collection, GPT model is used to reduce the workload of human labelers, where the suggestions with lower confidence than a threshold are subject to human labeling. We vary the threshold from 0 to 1, where 0 (resp. 1) indicates all suggestions are labeled by GPT (resp. human). Within the setting, we train 6 versions of
     <span class="ltx_text ltx_font_typewriter" id="A1.SS6.p1.1.1">
      RL4SUGG
     </span>
     models, and the effectiveness is reported in Table
     <a class="ltx_ref" href="#A1.T10" title="Table 10 ‣ A.5. Evaluation Platform ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       10
      </span>
     </a>
     . We choose the threshold of 0.6 as the default setting, since the effectiveness is near to the optimal, and it reduces a large amount of labeling effort for 46.9%.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS7">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.7.
    </span>
    Qualitative results
   </h3>
   <div class="ltx_para" id="A1.SS7.p1">
    <p class="ltx_p" id="A1.SS7.p1.1">
     Table
     <a class="ltx_ref" href="#A1.T11" title="Table 11 ‣ A.5. Evaluation Platform ‣ Appendix A Appendix ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       11
      </span>
     </a>
     demonstrates examples to show a wide range of zero-shot capabilities on image-to-suggestion generation. We choose Flamingo for comparison, since it shows the best effectiveness among baselines.
We observe that our query suggestions cover various intentions of the query image.
For Case-1, a potential intention could involve the task of cleaning or organizing a dirty fridge. Notably, we observe that
     <span class="ltx_text ltx_font_typewriter" id="A1.SS7.p1.1.1">
      RL4Sugg
     </span>
     effectively captures this intuitive intention, which demonstrates a commendable level of intentionality following RLHF training.
For Case-2,
     <span class="ltx_text ltx_font_typewriter" id="A1.SS7.p1.1.2">
      RL4Sugg
     </span>
     notices that the user might be interested in the dress for a photoshoot or the outdoor environment, and thus it recommends two suggestions accordingly instead of simply describing the content of the image. However, Flamingo wrongly recognizes “wedding dresses” in the image.
For Case-3,
     <span class="ltx_text ltx_font_typewriter" id="A1.SS7.p1.1.3">
      RL4Sugg
     </span>
     can accurately captures a high-intention query (“a broken iPhone”) similar to Case-1.
For Case-4,
     <span class="ltx_text ltx_font_typewriter" id="A1.SS7.p1.1.4">
      RL4Sugg
     </span>
     provides suggestions with good diversity with the aid of our Agent-D, e.g., it generates suggestions about how to make them or where to buy them; however, Flamingo generates duplicated suggestions (“Where to buy breads”) in this case.
For Case-5, we observe that Flamingo frequently uses a fixed pattern to process the image query, such as “Desirable something” or “Where to buy something” (as seen in Case-1, Case-2 and Case-5), where it succeeds in recognizing the correct object (“snowboard boots”) in the image. However, when users frequently notice the fixed pattern, they might become bored with the recommended suggestions.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="A1.SS8">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     A.8.
    </span>
    Further Discussion
   </h3>
   <div class="ltx_para" id="A1.SS8.p1">
    <p class="ltx_p" id="A1.SS8.p1.1">
     We further discuss why we use Agent-I and Agent-D for the MMQS task, instead of modifying Agent-I to handle both the intentionality and diversity.
In addressing the MMQS task examined within this study, it needs to satisfy two important properties: intentionality and diversity. Notably, these two properties exhibit some orthogonal relationships, posing a challenge in simultaneously incorporating them into a unified agent framework. This challenge is illuminated by our empirical findings, as depicted in Table
     <a class="ltx_ref" href="#S5.T4" title="Table 4 ‣ 5.2. Experimental Results ‣ 5. EXPERIMENTS ‣ Multimodal Query Suggestion with Multi-Agent Reinforcement Learning from Human Feedback">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     . When exclusively training Agent-I for this task, we observed a tendency for the agent to generate suggestions that were highly intentional yet repetitive. Consequently, this approach allowed the agent to obtain high scores from RewardNet by exploiting the repetitive shortcut, leading to a significant drop in diversity. To overcome this limitation, we employ two distinct agents to address the two distinct properties. Specifically, Agent-I is tasked with optimizing intentionality, while Agent-D is dedicated to enhancing diversity. This strategic division of labor allows us to optimize both intentionality and diversity explicitly through the application of multi-agent reinforcement learning, ensuring a more comprehensive solution to the MMQS task.
    </p>
   </div>
  </section>
 </section>
</article>
