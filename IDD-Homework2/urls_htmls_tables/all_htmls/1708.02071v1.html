<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1708.02071] Structured Attentions for Visual Question Answering</title><meta property="og:description" content="Visual attention, which assigns weights to image regions according to their relevance to a question, is considered as an indispensable part by most Visual Question Answering models. Although the questions may involve c…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Structured Attentions for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Structured Attentions for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1708.02071">

<!--Generated on Sun Mar  3 15:50:39 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">Structured Attentions for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chen Zhu, Yanpeng Zhao, Shuaiyi Huang, Kewei Tu, Yi Ma
<br class="ltx_break">ShanghaiTech University
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{zhuchen, zhaoyp1, huangsy, tukw, mayi}@shanghaitech.edu.cn</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p"><span id="id2.id1.1" class="ltx_text">Visual attention, which assigns weights to image regions according to their relevance to a question, is considered as an indispensable part by most Visual Question Answering models. Although the questions may involve complex relations among multiple regions, few attention models can effectively encode such cross-region relations. In this paper, we demonstrate the importance of encoding such relations by showing the limited effective receptive field of ResNet on two datasets, and propose to model the visual attention as a multivariate distribution over a grid-structured Conditional Random Field on image regions. We demonstrate how to convert the iterative inference algorithms, Mean Field and Loopy Belief Propagation, as recurrent layers of an end-to-end neural network. We empirically evaluated our model on 3 datasets, in which it surpasses the best baseline model of the newly released CLEVR dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> by 9.5%, and the best published model on the VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> by 1.25%. Source code is available at <a target="_blank" href="https://github.com/zhuchen03/vqa-sva" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/zhuchen03/vqa-sva</a>.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) is a comprehensive task inspecting intelligent systems’ ability to recognize images and natural languages together. Advances in this area not only benefit real-world applications which require the synergistic reasoning of vision and language, such as querying events in surveillance videos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and searching specific goods in images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, but also call for finer-grained understanding on the semantic structures of images.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1708.02071/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="415" height="350" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example of the proposed model on CLEVR, demonstrating it is capable of inferring spatial relations despite the limited effective receptive field of the CNN. Question: <em id="S1.F1.3.1" class="ltx_emph ltx_font_italic">What is the color of the sphere on the right of the metal sphere?</em> Our model overcomes the unstructured attention’s tendency to attend to isolated key words in the questions, attending to the right region and giving the correct answer <em id="S1.F1.4.2" class="ltx_emph ltx_font_italic">purple</em>. </figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Adoption of the visual attention mechanism like <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> is a major source to boost performance of VQA. Visual attentions impose regularization on the models to find the most relevant image regions to the question. Still, experiments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> point out that state-of-the-art models often fail to identify the related regions like humans do. We argue this problem comes from the fact that such attention models do not take into account the spatial relations between regions when predicting the attention. This is important because the effective receptive field (ERF) of deep CNNs only covers a small fraction of the image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Even with memory mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, it is difficult to infer the right attention corresponding to questions that involve the spatial relations between regions without overlapping ERFs.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a novel neural network to model the attention with a multivariate distribution which considers the arrangements of image regions. We adopt the most straightforward graph structure to model image region arrangements - a grid-structured Conditional Random Field (CRF) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. The framework of the proposed method is illustrated in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We show that attention can be formulated as the marginal distribution of each hidden variable in the CRF. Then, we implement the iterative approximate inference algorithms, Mean Field and Loopy Belief Propagation, as recurrent layers of neural networks, which iteratively refines the attention. An example of this process is shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. We evaluate the proposed model on three representative datasets, where our model is competitive with the rule-based model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> on the SHAPES dataset, and surpasses the best baseline model of CLEVR by more than 9.5% and best published method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> on the VQA dataset by 1.25%. We also demonstrate that the ERF on CLEVR and the VQA dataset is not large enough for previous methods to answer all questions involving object arrangements correctly.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our work has the following contributions. First, we propose to model structured attentions with a CRF over image regions for Visual Question Answering, to address the problem of limited effective receptive fields of CNNs. Second, we demonstrate how to unfold both Mean Field and Loopy Belief Propagation algorithms for CRF as recurrent layers of neural networks, and perform comprehensive evaluation of the two different networks on three challenging datasets. Third, we give empirical evaluations of ERFs on CLEVR and the MSCOCO dataset.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">There have been many different directions for improving VQA performance, including predicting answer types <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, utilizing task-specific submodules <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and better multimodal feature pooling methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Our focus is on structure-aware spatial attention applied on the visual feature. There are two major forms of spatial attention for VQA. One <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> is based on region proposals generated by Edge Box <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>, and the other <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> predicts attention on the individual feature vectors of convolutional feature maps. The most representative model SAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> adopted multiple attention layers to support multi-step reasoning. There are also methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> that adopted both image attention and question attention to refine the image and question representation simultaneously. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> proved its ability to recognize absolute and relative positions with two simple experiments, but the model itself does not consider the arrangement of regions and the success may be attributed to the power of CNNs.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Some of the methods considered the structures of images. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> adopted the Bayesian framework based on the logic forms of segmentation results. The method was surpassed by some simple baseline models due to its demand for better semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. The DMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> adopted a bidirectional GRU that traverses the convolutional feature map in a snake-like fashion to encode the dependency of regions, which might not be the optimal choice for the 2D structure of images. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> concatenated the 8D bounding box representation with the 4096D visual feature, in which the spatial information could be easily overweighed by the visual feature.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">There have been a number of approaches combining neural networks and CRF to predict structured outputs in both computer vision and natural language processing. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> utilized neural networks with sigmoid activation to predict the unary potential for sequential labeling. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> also used neural networks to predict the pairwise potential of labels. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> learned fixed pairwise potentials for word recognition and image classification. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> utilized CNNs to predict both the unary potentials and higher-order potentials for unconstrained word recognition. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> proposed to unfold the Mean Field algorithm as recurrent layers for semantic segmentation. It modeled the pairwise potential with Gaussian kernels, which encourages similar features to take the same label. Besides the supervised structure in the output layers, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> enforced the intermediate layers of neural networks to learn structured attentions for natural language tasks.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">To the best of our knowledge, structured attention has not been explored for the complex task of VQA. We give the first empirical evaluations on unfolding both Mean Field and Loopy Belief Propagation as intermediate recurrent layers on the task of VQA, which can be seen as a further exploration of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> in modeling 2D structures of visual data.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Attention Models and Methods</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1708.02071/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The whole picture of the proposed model. The inputs to the recurrent inference layers are the unary potential <math id="S3.F2.7.m1.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S3.F2.7.m1.1b"><mrow id="S3.F2.7.m1.1.1" xref="S3.F2.7.m1.1.1.cmml"><msub id="S3.F2.7.m1.1.1.3" xref="S3.F2.7.m1.1.1.3.cmml"><mi id="S3.F2.7.m1.1.1.3.2" xref="S3.F2.7.m1.1.1.3.2.cmml">ψ</mi><mi id="S3.F2.7.m1.1.1.3.3" xref="S3.F2.7.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.F2.7.m1.1.1.2" xref="S3.F2.7.m1.1.1.2.cmml">​</mo><mrow id="S3.F2.7.m1.1.1.1.1" xref="S3.F2.7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.F2.7.m1.1.1.1.1.2" xref="S3.F2.7.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.7.m1.1.1.1.1.1" xref="S3.F2.7.m1.1.1.1.1.1.cmml"><mi id="S3.F2.7.m1.1.1.1.1.1.2" xref="S3.F2.7.m1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.F2.7.m1.1.1.1.1.1.3" xref="S3.F2.7.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.F2.7.m1.1.1.1.1.3" xref="S3.F2.7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.7.m1.1c"><apply id="S3.F2.7.m1.1.1.cmml" xref="S3.F2.7.m1.1.1"><times id="S3.F2.7.m1.1.1.2.cmml" xref="S3.F2.7.m1.1.1.2"></times><apply id="S3.F2.7.m1.1.1.3.cmml" xref="S3.F2.7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F2.7.m1.1.1.3.1.cmml" xref="S3.F2.7.m1.1.1.3">subscript</csymbol><ci id="S3.F2.7.m1.1.1.3.2.cmml" xref="S3.F2.7.m1.1.1.3.2">𝜓</ci><ci id="S3.F2.7.m1.1.1.3.3.cmml" xref="S3.F2.7.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.F2.7.m1.1.1.1.1.1.cmml" xref="S3.F2.7.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.7.m1.1.1.1.1.1.1.cmml" xref="S3.F2.7.m1.1.1.1.1">subscript</csymbol><ci id="S3.F2.7.m1.1.1.1.1.1.2.cmml" xref="S3.F2.7.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.F2.7.m1.1.1.1.1.1.3.cmml" xref="S3.F2.7.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.m1.1d">\psi_{i}(z_{i})</annotation></semantics></math> and pairwise potential <math id="S3.F2.8.m2.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.F2.8.m2.2b"><mrow id="S3.F2.8.m2.2.2" xref="S3.F2.8.m2.2.2.cmml"><msub id="S3.F2.8.m2.2.2.4" xref="S3.F2.8.m2.2.2.4.cmml"><mi id="S3.F2.8.m2.2.2.4.2" xref="S3.F2.8.m2.2.2.4.2.cmml">ψ</mi><mrow id="S3.F2.8.m2.2.2.4.3" xref="S3.F2.8.m2.2.2.4.3.cmml"><mi id="S3.F2.8.m2.2.2.4.3.2" xref="S3.F2.8.m2.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.F2.8.m2.2.2.4.3.1" xref="S3.F2.8.m2.2.2.4.3.1.cmml">​</mo><mi id="S3.F2.8.m2.2.2.4.3.3" xref="S3.F2.8.m2.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.F2.8.m2.2.2.3" xref="S3.F2.8.m2.2.2.3.cmml">​</mo><mrow id="S3.F2.8.m2.2.2.2.2" xref="S3.F2.8.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.F2.8.m2.2.2.2.2.3" xref="S3.F2.8.m2.2.2.2.3.cmml">(</mo><msub id="S3.F2.8.m2.1.1.1.1.1" xref="S3.F2.8.m2.1.1.1.1.1.cmml"><mi id="S3.F2.8.m2.1.1.1.1.1.2" xref="S3.F2.8.m2.1.1.1.1.1.2.cmml">z</mi><mi id="S3.F2.8.m2.1.1.1.1.1.3" xref="S3.F2.8.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F2.8.m2.2.2.2.2.4" xref="S3.F2.8.m2.2.2.2.3.cmml">,</mo><msub id="S3.F2.8.m2.2.2.2.2.2" xref="S3.F2.8.m2.2.2.2.2.2.cmml"><mi id="S3.F2.8.m2.2.2.2.2.2.2" xref="S3.F2.8.m2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.F2.8.m2.2.2.2.2.2.3" xref="S3.F2.8.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.F2.8.m2.2.2.2.2.5" xref="S3.F2.8.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.8.m2.2c"><apply id="S3.F2.8.m2.2.2.cmml" xref="S3.F2.8.m2.2.2"><times id="S3.F2.8.m2.2.2.3.cmml" xref="S3.F2.8.m2.2.2.3"></times><apply id="S3.F2.8.m2.2.2.4.cmml" xref="S3.F2.8.m2.2.2.4"><csymbol cd="ambiguous" id="S3.F2.8.m2.2.2.4.1.cmml" xref="S3.F2.8.m2.2.2.4">subscript</csymbol><ci id="S3.F2.8.m2.2.2.4.2.cmml" xref="S3.F2.8.m2.2.2.4.2">𝜓</ci><apply id="S3.F2.8.m2.2.2.4.3.cmml" xref="S3.F2.8.m2.2.2.4.3"><times id="S3.F2.8.m2.2.2.4.3.1.cmml" xref="S3.F2.8.m2.2.2.4.3.1"></times><ci id="S3.F2.8.m2.2.2.4.3.2.cmml" xref="S3.F2.8.m2.2.2.4.3.2">𝑖</ci><ci id="S3.F2.8.m2.2.2.4.3.3.cmml" xref="S3.F2.8.m2.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.F2.8.m2.2.2.2.3.cmml" xref="S3.F2.8.m2.2.2.2.2"><apply id="S3.F2.8.m2.1.1.1.1.1.cmml" xref="S3.F2.8.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.8.m2.1.1.1.1.1.1.cmml" xref="S3.F2.8.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.F2.8.m2.1.1.1.1.1.2.cmml" xref="S3.F2.8.m2.1.1.1.1.1.2">𝑧</ci><ci id="S3.F2.8.m2.1.1.1.1.1.3.cmml" xref="S3.F2.8.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.F2.8.m2.2.2.2.2.2.cmml" xref="S3.F2.8.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.F2.8.m2.2.2.2.2.2.1.cmml" xref="S3.F2.8.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.F2.8.m2.2.2.2.2.2.2.cmml" xref="S3.F2.8.m2.2.2.2.2.2.2">𝑧</ci><ci id="S3.F2.8.m2.2.2.2.2.2.3.cmml" xref="S3.F2.8.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.8.m2.2d">\psi_{ij}(z_{i},z_{j})</annotation></semantics></math>, computed with Eq. <a href="#S3.E8" title="In 3.3.1 Potential Functions ‣ 3.3 Recurrent Inference Layers ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. <math id="S3.F2.9.m3.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S3.F2.9.m3.1b"><mrow id="S3.F2.9.m3.1.1" xref="S3.F2.9.m3.1.1.cmml"><msub id="S3.F2.9.m3.1.1.3" xref="S3.F2.9.m3.1.1.3.cmml"><mi id="S3.F2.9.m3.1.1.3.2" xref="S3.F2.9.m3.1.1.3.2.cmml">ψ</mi><mi id="S3.F2.9.m3.1.1.3.3" xref="S3.F2.9.m3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.F2.9.m3.1.1.2" xref="S3.F2.9.m3.1.1.2.cmml">​</mo><mrow id="S3.F2.9.m3.1.1.1.1" xref="S3.F2.9.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.F2.9.m3.1.1.1.1.2" xref="S3.F2.9.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.F2.9.m3.1.1.1.1.1" xref="S3.F2.9.m3.1.1.1.1.1.cmml"><mi id="S3.F2.9.m3.1.1.1.1.1.2" xref="S3.F2.9.m3.1.1.1.1.1.2.cmml">z</mi><mi id="S3.F2.9.m3.1.1.1.1.1.3" xref="S3.F2.9.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.F2.9.m3.1.1.1.1.3" xref="S3.F2.9.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.9.m3.1c"><apply id="S3.F2.9.m3.1.1.cmml" xref="S3.F2.9.m3.1.1"><times id="S3.F2.9.m3.1.1.2.cmml" xref="S3.F2.9.m3.1.1.2"></times><apply id="S3.F2.9.m3.1.1.3.cmml" xref="S3.F2.9.m3.1.1.3"><csymbol cd="ambiguous" id="S3.F2.9.m3.1.1.3.1.cmml" xref="S3.F2.9.m3.1.1.3">subscript</csymbol><ci id="S3.F2.9.m3.1.1.3.2.cmml" xref="S3.F2.9.m3.1.1.3.2">𝜓</ci><ci id="S3.F2.9.m3.1.1.3.3.cmml" xref="S3.F2.9.m3.1.1.3.3">𝑖</ci></apply><apply id="S3.F2.9.m3.1.1.1.1.1.cmml" xref="S3.F2.9.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.9.m3.1.1.1.1.1.1.cmml" xref="S3.F2.9.m3.1.1.1.1">subscript</csymbol><ci id="S3.F2.9.m3.1.1.1.1.1.2.cmml" xref="S3.F2.9.m3.1.1.1.1.1.2">𝑧</ci><ci id="S3.F2.9.m3.1.1.1.1.1.3.cmml" xref="S3.F2.9.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.9.m3.1d">\psi_{i}(z_{i})</annotation></semantics></math> can also be used as an additional glimpse, which usually detects the key nouns. In the inference layers, <math id="S3.F2.10.m4.1" class="ltx_Math" alttext="x^{i}" display="inline"><semantics id="S3.F2.10.m4.1b"><msup id="S3.F2.10.m4.1.1" xref="S3.F2.10.m4.1.1.cmml"><mi id="S3.F2.10.m4.1.1.2" xref="S3.F2.10.m4.1.1.2.cmml">x</mi><mi id="S3.F2.10.m4.1.1.3" xref="S3.F2.10.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.F2.10.m4.1c"><apply id="S3.F2.10.m4.1.1.cmml" xref="S3.F2.10.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.10.m4.1.1.1.cmml" xref="S3.F2.10.m4.1.1">superscript</csymbol><ci id="S3.F2.10.m4.1.1.2.cmml" xref="S3.F2.10.m4.1.1.2">𝑥</ci><ci id="S3.F2.10.m4.1.1.3.cmml" xref="S3.F2.10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.m4.1d">x^{i}</annotation></semantics></math> represents <math id="S3.F2.11.m5.1" class="ltx_Math" alttext="b^{(i)}" display="inline"><semantics id="S3.F2.11.m5.1b"><msup id="S3.F2.11.m5.1.2" xref="S3.F2.11.m5.1.2.cmml"><mi id="S3.F2.11.m5.1.2.2" xref="S3.F2.11.m5.1.2.2.cmml">b</mi><mrow id="S3.F2.11.m5.1.1.1.3" xref="S3.F2.11.m5.1.2.cmml"><mo stretchy="false" id="S3.F2.11.m5.1.1.1.3.1" xref="S3.F2.11.m5.1.2.cmml">(</mo><mi id="S3.F2.11.m5.1.1.1.1" xref="S3.F2.11.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.F2.11.m5.1.1.1.3.2" xref="S3.F2.11.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.F2.11.m5.1c"><apply id="S3.F2.11.m5.1.2.cmml" xref="S3.F2.11.m5.1.2"><csymbol cd="ambiguous" id="S3.F2.11.m5.1.2.1.cmml" xref="S3.F2.11.m5.1.2">superscript</csymbol><ci id="S3.F2.11.m5.1.2.2.cmml" xref="S3.F2.11.m5.1.2.2">𝑏</ci><ci id="S3.F2.11.m5.1.1.1.1.cmml" xref="S3.F2.11.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.11.m5.1d">b^{(i)}</annotation></semantics></math> for MF and <math id="S3.F2.12.m6.1" class="ltx_Math" alttext="m^{(i)}" display="inline"><semantics id="S3.F2.12.m6.1b"><msup id="S3.F2.12.m6.1.2" xref="S3.F2.12.m6.1.2.cmml"><mi id="S3.F2.12.m6.1.2.2" xref="S3.F2.12.m6.1.2.2.cmml">m</mi><mrow id="S3.F2.12.m6.1.1.1.3" xref="S3.F2.12.m6.1.2.cmml"><mo stretchy="false" id="S3.F2.12.m6.1.1.1.3.1" xref="S3.F2.12.m6.1.2.cmml">(</mo><mi id="S3.F2.12.m6.1.1.1.1" xref="S3.F2.12.m6.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S3.F2.12.m6.1.1.1.3.2" xref="S3.F2.12.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.F2.12.m6.1c"><apply id="S3.F2.12.m6.1.2.cmml" xref="S3.F2.12.m6.1.2"><csymbol cd="ambiguous" id="S3.F2.12.m6.1.2.1.cmml" xref="S3.F2.12.m6.1.2">superscript</csymbol><ci id="S3.F2.12.m6.1.2.2.cmml" xref="S3.F2.12.m6.1.2.2">𝑚</ci><ci id="S3.F2.12.m6.1.1.1.1.cmml" xref="S3.F2.12.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.m6.1d">m^{(i)}</annotation></semantics></math> for LBP. The recurrent inference layers generates a structured glimpse with MF or LBP. The 2 glimpses are used to weight-sum the visual feature vectors. The classifier use both of the attended visual features and the question feature to predict the answer. The demonstration is a real case. </figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.9" class="ltx_p">The general architecture of the proposed model is shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Here we define some notations used across the paper. We take the question feature <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{q}\in\mathbb{R}^{n_{Q}}" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">𝒒</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><msub id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml"><mi id="S3.p1.1.m1.1.1.3.3.2" xref="S3.p1.1.m1.1.1.3.3.2.cmml">n</mi><mi id="S3.p1.1.m1.1.1.3.3.3" xref="S3.p1.1.m1.1.1.3.3.3.cmml">Q</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><in id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></in><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝒒</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="S3.p1.1.m1.1.1.3.3.2.cmml" xref="S3.p1.1.m1.1.1.3.3.2">𝑛</ci><ci id="S3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\boldsymbol{q}\in\mathbb{R}^{n_{Q}}</annotation></semantics></math> from the last time step of a GRU such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, and the image feature map <math id="S3.p1.2.m2.3" class="ltx_Math" alttext="\boldsymbol{\mathrm{X}}=[\boldsymbol{\mathrm{x}}_{1},...,\boldsymbol{\mathrm{x}}_{M}]\in\mathbb{R}^{n_{I}\times M}" display="inline"><semantics id="S3.p1.2.m2.3a"><mrow id="S3.p1.2.m2.3.3" xref="S3.p1.2.m2.3.3.cmml"><mi id="S3.p1.2.m2.3.3.4" xref="S3.p1.2.m2.3.3.4.cmml">𝐗</mi><mo id="S3.p1.2.m2.3.3.5" xref="S3.p1.2.m2.3.3.5.cmml">=</mo><mrow id="S3.p1.2.m2.3.3.2.2" xref="S3.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.2.m2.3.3.2.2.3" xref="S3.p1.2.m2.3.3.2.3.cmml">[</mo><msub id="S3.p1.2.m2.2.2.1.1.1" xref="S3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.p1.2.m2.2.2.1.1.1.2" xref="S3.p1.2.m2.2.2.1.1.1.2.cmml">𝐱</mi><mn id="S3.p1.2.m2.2.2.1.1.1.3" xref="S3.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.2.m2.3.3.2.2.4" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">…</mi><mo id="S3.p1.2.m2.3.3.2.2.5" xref="S3.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.2.m2.3.3.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.p1.2.m2.3.3.2.2.2.2" xref="S3.p1.2.m2.3.3.2.2.2.2.cmml">𝐱</mi><mi id="S3.p1.2.m2.3.3.2.2.2.3" xref="S3.p1.2.m2.3.3.2.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.p1.2.m2.3.3.2.2.6" xref="S3.p1.2.m2.3.3.2.3.cmml">]</mo></mrow><mo id="S3.p1.2.m2.3.3.6" xref="S3.p1.2.m2.3.3.6.cmml">∈</mo><msup id="S3.p1.2.m2.3.3.7" xref="S3.p1.2.m2.3.3.7.cmml"><mi id="S3.p1.2.m2.3.3.7.2" xref="S3.p1.2.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S3.p1.2.m2.3.3.7.3" xref="S3.p1.2.m2.3.3.7.3.cmml"><msub id="S3.p1.2.m2.3.3.7.3.2" xref="S3.p1.2.m2.3.3.7.3.2.cmml"><mi id="S3.p1.2.m2.3.3.7.3.2.2" xref="S3.p1.2.m2.3.3.7.3.2.2.cmml">n</mi><mi id="S3.p1.2.m2.3.3.7.3.2.3" xref="S3.p1.2.m2.3.3.7.3.2.3.cmml">I</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.p1.2.m2.3.3.7.3.1" xref="S3.p1.2.m2.3.3.7.3.1.cmml">×</mo><mi id="S3.p1.2.m2.3.3.7.3.3" xref="S3.p1.2.m2.3.3.7.3.3.cmml">M</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.3b"><apply id="S3.p1.2.m2.3.3.cmml" xref="S3.p1.2.m2.3.3"><and id="S3.p1.2.m2.3.3a.cmml" xref="S3.p1.2.m2.3.3"></and><apply id="S3.p1.2.m2.3.3b.cmml" xref="S3.p1.2.m2.3.3"><eq id="S3.p1.2.m2.3.3.5.cmml" xref="S3.p1.2.m2.3.3.5"></eq><ci id="S3.p1.2.m2.3.3.4.cmml" xref="S3.p1.2.m2.3.3.4">𝐗</ci><list id="S3.p1.2.m2.3.3.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2"><apply id="S3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.p1.2.m2.2.2.1.1.1.2">𝐱</ci><cn type="integer" id="S3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">…</ci><apply id="S3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.p1.2.m2.3.3.2.2.2.2">𝐱</ci><ci id="S3.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.p1.2.m2.3.3.2.2.2.3">𝑀</ci></apply></list></apply><apply id="S3.p1.2.m2.3.3c.cmml" xref="S3.p1.2.m2.3.3"><in id="S3.p1.2.m2.3.3.6.cmml" xref="S3.p1.2.m2.3.3.6"></in><share href="#S3.p1.2.m2.3.3.2.cmml" id="S3.p1.2.m2.3.3d.cmml" xref="S3.p1.2.m2.3.3"></share><apply id="S3.p1.2.m2.3.3.7.cmml" xref="S3.p1.2.m2.3.3.7"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.7.1.cmml" xref="S3.p1.2.m2.3.3.7">superscript</csymbol><ci id="S3.p1.2.m2.3.3.7.2.cmml" xref="S3.p1.2.m2.3.3.7.2">ℝ</ci><apply id="S3.p1.2.m2.3.3.7.3.cmml" xref="S3.p1.2.m2.3.3.7.3"><times id="S3.p1.2.m2.3.3.7.3.1.cmml" xref="S3.p1.2.m2.3.3.7.3.1"></times><apply id="S3.p1.2.m2.3.3.7.3.2.cmml" xref="S3.p1.2.m2.3.3.7.3.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.3.3.7.3.2.1.cmml" xref="S3.p1.2.m2.3.3.7.3.2">subscript</csymbol><ci id="S3.p1.2.m2.3.3.7.3.2.2.cmml" xref="S3.p1.2.m2.3.3.7.3.2.2">𝑛</ci><ci id="S3.p1.2.m2.3.3.7.3.2.3.cmml" xref="S3.p1.2.m2.3.3.7.3.2.3">𝐼</ci></apply><ci id="S3.p1.2.m2.3.3.7.3.3.cmml" xref="S3.p1.2.m2.3.3.7.3.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.3c">\boldsymbol{\mathrm{X}}=[\boldsymbol{\mathrm{x}}_{1},...,\boldsymbol{\mathrm{x}}_{M}]\in\mathbb{R}^{n_{I}\times M}</annotation></semantics></math> from one of the convolution layers of a CNN such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Here <math id="S3.p1.3.m3.2" class="ltx_Math" alttext="n_{Q},n_{I}" display="inline"><semantics id="S3.p1.3.m3.2a"><mrow id="S3.p1.3.m3.2.2.2" xref="S3.p1.3.m3.2.2.3.cmml"><msub id="S3.p1.3.m3.1.1.1.1" xref="S3.p1.3.m3.1.1.1.1.cmml"><mi id="S3.p1.3.m3.1.1.1.1.2" xref="S3.p1.3.m3.1.1.1.1.2.cmml">n</mi><mi id="S3.p1.3.m3.1.1.1.1.3" xref="S3.p1.3.m3.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.p1.3.m3.2.2.2.3" xref="S3.p1.3.m3.2.2.3.cmml">,</mo><msub id="S3.p1.3.m3.2.2.2.2" xref="S3.p1.3.m3.2.2.2.2.cmml"><mi id="S3.p1.3.m3.2.2.2.2.2" xref="S3.p1.3.m3.2.2.2.2.2.cmml">n</mi><mi id="S3.p1.3.m3.2.2.2.2.3" xref="S3.p1.3.m3.2.2.2.2.3.cmml">I</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.2b"><list id="S3.p1.3.m3.2.2.3.cmml" xref="S3.p1.3.m3.2.2.2"><apply id="S3.p1.3.m3.1.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.p1.3.m3.1.1.1.1.2.cmml" xref="S3.p1.3.m3.1.1.1.1.2">𝑛</ci><ci id="S3.p1.3.m3.1.1.1.1.3.cmml" xref="S3.p1.3.m3.1.1.1.1.3">𝑄</ci></apply><apply id="S3.p1.3.m3.2.2.2.2.cmml" xref="S3.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.2.2.2.2.1.cmml" xref="S3.p1.3.m3.2.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.2.2.2.2.2.cmml" xref="S3.p1.3.m3.2.2.2.2.2">𝑛</ci><ci id="S3.p1.3.m3.2.2.2.2.3.cmml" xref="S3.p1.3.m3.2.2.2.2.3">𝐼</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.2c">n_{Q},n_{I}</annotation></semantics></math> are the dimensions of question and image feature vectors respectively, and <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">M</annotation></semantics></math> is the total number of image feature vectors which divides the image into <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">M</annotation></semantics></math> regions. We use <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\mathrm{softmax}(\cdot)" display="inline"><semantics id="S3.p1.6.m6.1a"><mrow id="S3.p1.6.m6.1.2" xref="S3.p1.6.m6.1.2.cmml"><mi id="S3.p1.6.m6.1.2.2" xref="S3.p1.6.m6.1.2.2.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.p1.6.m6.1.2.1" xref="S3.p1.6.m6.1.2.1.cmml">​</mo><mrow id="S3.p1.6.m6.1.2.3.2" xref="S3.p1.6.m6.1.2.cmml"><mo stretchy="false" id="S3.p1.6.m6.1.2.3.2.1" xref="S3.p1.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p1.6.m6.1.2.3.2.2" xref="S3.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.2.cmml" xref="S3.p1.6.m6.1.2"><times id="S3.p1.6.m6.1.2.1.cmml" xref="S3.p1.6.m6.1.2.1"></times><ci id="S3.p1.6.m6.1.2.2.cmml" xref="S3.p1.6.m6.1.2.2">softmax</ci><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathrm{softmax}(\cdot)</annotation></semantics></math> to denote the softmax activation function and <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.2" xref="S3.p1.7.m7.1.2.cmml"><mi id="S3.p1.7.m7.1.2.2" xref="S3.p1.7.m7.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.1.2.1" xref="S3.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S3.p1.7.m7.1.2.3.2" xref="S3.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S3.p1.7.m7.1.2.3.2.1" xref="S3.p1.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p1.7.m7.1.2.3.2.2" xref="S3.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.2.cmml" xref="S3.p1.7.m7.1.2"><times id="S3.p1.7.m7.1.2.1.cmml" xref="S3.p1.7.m7.1.2.1"></times><ci id="S3.p1.7.m7.1.2.2.cmml" xref="S3.p1.7.m7.1.2.2">𝜎</ci><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\sigma(\cdot)</annotation></semantics></math> to denote the sigmoid activation function. The attention mechanism in VQA aims to produce a <em id="S3.p1.9.1" class="ltx_emph ltx_font_italic">context</em> <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{c}}" display="inline"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\boldsymbol{\mathrm{c}}</annotation></semantics></math> from <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{X}}" display="inline"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\boldsymbol{\mathrm{X}}</annotation></semantics></math> which represents the visual feature related to the question.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Unstructured Categorical Attention</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.3" class="ltx_p">In previous methods for VQA, visual attention is usually modeled as a single or multi-step soft-selection from <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{X}}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\boldsymbol{\mathrm{X}}</annotation></semantics></math>. As shown in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, the soft-selection approach represents the selected region index by a categorical latent variable <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="z\in\{1,...,M\}" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.4" xref="S3.SS1.p1.2.m2.3.4.cmml"><mi id="S3.SS1.p1.2.m2.3.4.2" xref="S3.SS1.p1.2.m2.3.4.2.cmml">z</mi><mo id="S3.SS1.p1.2.m2.3.4.1" xref="S3.SS1.p1.2.m2.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p1.2.m2.3.4.3.2" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.3.4.3.2.1" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS1.p1.2.m2.3.4.3.2.2" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.4.3.2.3" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.2.m2.3.3" xref="S3.SS1.p1.2.m2.3.3.cmml">M</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.3.4.3.2.4" xref="S3.SS1.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><apply id="S3.SS1.p1.2.m2.3.4.cmml" xref="S3.SS1.p1.2.m2.3.4"><in id="S3.SS1.p1.2.m2.3.4.1.cmml" xref="S3.SS1.p1.2.m2.3.4.1"></in><ci id="S3.SS1.p1.2.m2.3.4.2.cmml" xref="S3.SS1.p1.2.m2.3.4.2">𝑧</ci><set id="S3.SS1.p1.2.m2.3.4.3.1.cmml" xref="S3.SS1.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">1</cn><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><ci id="S3.SS1.p1.2.m2.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">z\in\{1,...,M\}</annotation></semantics></math> and defines <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{c}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\boldsymbol{\mathrm{c}}</annotation></semantics></math> as an expectation of the selection:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\boldsymbol{\mathrm{c}}=\mathbb{E}\left[\sum_{i}\mathbbm{1}_{\{z=i\}}\cdot\boldsymbol{\mathrm{x}}_{i}\right]=\sum_{i}p(z=i|\boldsymbol{\mathrm{X}},\boldsymbol{q})\boldsymbol{\mathrm{x}}_{i}," display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.4" xref="S3.E1.m1.4.4.1.1.4.cmml">𝐜</mi><mo id="S3.E1.m1.4.4.1.1.5" xref="S3.E1.m1.4.4.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.2.cmml"><mo id="S3.E1.m1.4.4.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml"><munder id="S3.E1.m1.4.4.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml">∑</mo><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></munder><mrow id="S3.E1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mn id="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">𝟙</mn><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">{</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">z</mi><mo id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml">}</mo></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.4.4.1.1.1.1.1.1.2.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.2.cmml">𝐱</mi><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.4.4.1.1.6" xref="S3.E1.m1.4.4.1.1.6.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><munder id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml"><mo movablelimits="false" id="S3.E1.m1.4.4.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.cmml">∑</mo><mi id="S3.E1.m1.4.4.1.1.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.3.cmml">i</mi></munder><mrow id="S3.E1.m1.4.4.1.1.2.1" xref="S3.E1.m1.4.4.1.1.2.1.cmml"><mi id="S3.E1.m1.4.4.1.1.2.1.3" xref="S3.E1.m1.4.4.1.1.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.1.2" xref="S3.E1.m1.4.4.1.1.2.1.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.2.1.1.1" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.1.1.1.2" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.4.4.1.1.2.1.1.1.1" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.2.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.2.cmml">z</mi><mo id="S3.E1.m1.4.4.1.1.2.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.2" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.1" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.3.1.cmml"><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝐗</mi><mo id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.3.2.1" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.4.4.1.1.2.1.1.1.3" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.2.1.2a" xref="S3.E1.m1.4.4.1.1.2.1.2.cmml">​</mo><msub id="S3.E1.m1.4.4.1.1.2.1.4" xref="S3.E1.m1.4.4.1.1.2.1.4.cmml"><mi id="S3.E1.m1.4.4.1.1.2.1.4.2" xref="S3.E1.m1.4.4.1.1.2.1.4.2.cmml">𝐱</mi><mi id="S3.E1.m1.4.4.1.1.2.1.4.3" xref="S3.E1.m1.4.4.1.1.2.1.4.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><and id="S3.E1.m1.4.4.1.1a.cmml" xref="S3.E1.m1.4.4.1"></and><apply id="S3.E1.m1.4.4.1.1b.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.5.cmml" xref="S3.E1.m1.4.4.1.1.5"></eq><ci id="S3.E1.m1.4.4.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.4">𝐜</ci><apply id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"><times id="S3.E1.m1.4.4.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.2"></times><ci id="S3.E1.m1.4.4.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.3">𝔼</ci><apply id="S3.E1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1"><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><sum id="S3.E1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.2"></sum><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2"><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.1">⋅</ci><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><cn type="integer" id="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.2.2">1</cn><set id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></set></apply><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.2">𝐱</ci><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E1.m1.4.4.1.1c.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.6.cmml" xref="S3.E1.m1.4.4.1.1.6"></eq><share href="#S3.E1.m1.4.4.1.1.1.cmml" id="S3.E1.m1.4.4.1.1d.cmml" xref="S3.E1.m1.4.4.1"></share><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><apply id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2">subscript</csymbol><sum id="S3.E1.m1.4.4.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2"></sum><ci id="S3.E1.m1.4.4.1.1.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1"><times id="S3.E1.m1.4.4.1.1.2.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2.1.2"></times><ci id="S3.E1.m1.4.4.1.1.2.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2.1.3">𝑝</ci><apply id="S3.E1.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1"><eq id="S3.E1.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.1"></eq><ci id="S3.E1.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.2">𝑧</ci><apply id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.2">𝑖</ci><list id="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1.1.1.1.3.3.2"><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝐗</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝒒</ci></list></apply></apply><apply id="S3.E1.m1.4.4.1.1.2.1.4.cmml" xref="S3.E1.m1.4.4.1.1.2.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.1.4.1.cmml" xref="S3.E1.m1.4.4.1.1.2.1.4">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.1.4.2.cmml" xref="S3.E1.m1.4.4.1.1.2.1.4.2">𝐱</ci><ci id="S3.E1.m1.4.4.1.1.2.1.4.3.cmml" xref="S3.E1.m1.4.4.1.1.2.1.4.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\boldsymbol{\mathrm{c}}=\mathbb{E}\left[\sum_{i}\mathbbm{1}_{\{z=i\}}\cdot\boldsymbol{\mathrm{x}}_{i}\right]=\sum_{i}p(z=i|\boldsymbol{\mathrm{X}},\boldsymbol{q})\boldsymbol{\mathrm{x}}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.5" class="ltx_p">where <math id="S3.SS1.p1.4.m1.1" class="ltx_Math" alttext="\mathbbm{1}_{\{z=i\}}" display="inline"><semantics id="S3.SS1.p1.4.m1.1a"><msub id="S3.SS1.p1.4.m1.1.2" xref="S3.SS1.p1.4.m1.1.2.cmml"><mn id="S3.SS1.p1.4.m1.1.2.2" xref="S3.SS1.p1.4.m1.1.2.2.cmml">𝟙</mn><mrow id="S3.SS1.p1.4.m1.1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m1.1.1.1.1.2" xref="S3.SS1.p1.4.m1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p1.4.m1.1.1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m1.1.1.1.1.1.2.cmml">z</mi><mo id="S3.SS1.p1.4.m1.1.1.1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.SS1.p1.4.m1.1.1.1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.1.1.1.3.cmml">i</mi></mrow><mo stretchy="false" id="S3.SS1.p1.4.m1.1.1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.1.2.cmml">}</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.1b"><apply id="S3.SS1.p1.4.m1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.2.1.cmml" xref="S3.SS1.p1.4.m1.1.2">subscript</csymbol><cn type="integer" id="S3.SS1.p1.4.m1.1.2.2.cmml" xref="S3.SS1.p1.4.m1.1.2.2">1</cn><set id="S3.SS1.p1.4.m1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1"><apply id="S3.SS1.p1.4.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1.1"><eq id="S3.SS1.p1.4.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1.1.1"></eq><ci id="S3.SS1.p1.4.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS1.p1.4.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.1c">\mathbbm{1}_{\{z=i\}}</annotation></semantics></math> is an indicator function, and the distribution of <math id="S3.SS1.p1.5.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="S3.SS1.p1.5.m2.1a"><mi id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><ci id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">z</annotation></semantics></math> is parameterized by</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="p(z=i|\boldsymbol{\mathrm{X}},\boldsymbol{q})=\mathrm{softmax}(\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q}))," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml">z</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.3.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝐗</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.3.3.2.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml"><mi id="S3.E2.m1.4.4.1.1.2.3" xref="S3.E2.m1.4.4.1.1.2.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.2.2" xref="S3.E2.m1.4.4.1.1.2.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.2.1.1" xref="S3.E2.m1.4.4.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2.1.1.2" xref="S3.E2.m1.4.4.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.2.1.1.1" xref="S3.E2.m1.4.4.1.1.2.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.2.1.1.1.3" xref="S3.E2.m1.4.4.1.1.2.1.1.1.3.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.2.1.1.1.2" xref="S3.E2.m1.4.4.1.1.2.1.1.1.2.cmml">​</mo><mi id="S3.E2.m1.4.4.1.1.2.1.1.1.4" xref="S3.E2.m1.4.4.1.1.2.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.2.1.1.1.2a" xref="S3.E2.m1.4.4.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝒒</mi><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.4" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2.1.1.3" xref="S3.E2.m1.4.4.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><eq id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"></eq><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2"></times><ci id="S3.E2.m1.4.4.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.3">𝑝</ci><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"><eq id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1"></eq><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E2.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.2">𝑖</ci><list id="S3.E2.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.3.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝐗</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝒒</ci></list></apply></apply></apply><apply id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2"><times id="S3.E2.m1.4.4.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.2.2"></times><ci id="S3.E2.m1.4.4.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.2.3">softmax</ci><apply id="S3.E2.m1.4.4.1.1.2.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1"><times id="S3.E2.m1.4.4.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.2"></times><ci id="S3.E2.m1.4.4.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.3">𝐔</ci><ci id="S3.E2.m1.4.4.1.1.2.1.1.1.4.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.4">𝑔</ci><interval closure="open" id="S3.E2.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1"><apply id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝒒</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">p(z=i|\boldsymbol{\mathrm{X}},\boldsymbol{q})=\mathrm{softmax}(\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.8" class="ltx_p">where <math id="S3.SS1.p1.6.m1.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{U}}\in\mathbb{R}^{1\times n_{I}}" display="inline"><semantics id="S3.SS1.p1.6.m1.1a"><mrow id="S3.SS1.p1.6.m1.1.1" xref="S3.SS1.p1.6.m1.1.1.cmml"><mi id="S3.SS1.p1.6.m1.1.1.2" xref="S3.SS1.p1.6.m1.1.1.2.cmml">𝐔</mi><mo id="S3.SS1.p1.6.m1.1.1.1" xref="S3.SS1.p1.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.6.m1.1.1.3" xref="S3.SS1.p1.6.m1.1.1.3.cmml"><mi id="S3.SS1.p1.6.m1.1.1.3.2" xref="S3.SS1.p1.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.6.m1.1.1.3.3" xref="S3.SS1.p1.6.m1.1.1.3.3.cmml"><mn id="S3.SS1.p1.6.m1.1.1.3.3.2" xref="S3.SS1.p1.6.m1.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.6.m1.1.1.3.3.1" xref="S3.SS1.p1.6.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.6.m1.1.1.3.3.3" xref="S3.SS1.p1.6.m1.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.6.m1.1.1.3.3.3.2" xref="S3.SS1.p1.6.m1.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS1.p1.6.m1.1.1.3.3.3.3" xref="S3.SS1.p1.6.m1.1.1.3.3.3.3.cmml">I</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m1.1b"><apply id="S3.SS1.p1.6.m1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1"><in id="S3.SS1.p1.6.m1.1.1.1.cmml" xref="S3.SS1.p1.6.m1.1.1.1"></in><ci id="S3.SS1.p1.6.m1.1.1.2.cmml" xref="S3.SS1.p1.6.m1.1.1.2">𝐔</ci><apply id="S3.SS1.p1.6.m1.1.1.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m1.1.1.3.1.cmml" xref="S3.SS1.p1.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.6.m1.1.1.3.2.cmml" xref="S3.SS1.p1.6.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.6.m1.1.1.3.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3"><times id="S3.SS1.p1.6.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.1"></times><cn type="integer" id="S3.SS1.p1.6.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.2">1</cn><apply id="S3.SS1.p1.6.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.6.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS1.p1.6.m1.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.6.m1.1.1.3.3.3.3">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m1.1c">\boldsymbol{\mathrm{U}}\in\mathbb{R}^{1\times n_{I}}</annotation></semantics></math> and <math id="S3.SS1.p1.7.m2.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S3.SS1.p1.7.m2.1a"><mrow id="S3.SS1.p1.7.m2.1.2" xref="S3.SS1.p1.7.m2.1.2.cmml"><mi id="S3.SS1.p1.7.m2.1.2.2" xref="S3.SS1.p1.7.m2.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m2.1.2.1" xref="S3.SS1.p1.7.m2.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.7.m2.1.2.3.2" xref="S3.SS1.p1.7.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m2.1.2.3.2.1" xref="S3.SS1.p1.7.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m2.1.1" xref="S3.SS1.p1.7.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.7.m2.1.2.3.2.2" xref="S3.SS1.p1.7.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m2.1b"><apply id="S3.SS1.p1.7.m2.1.2.cmml" xref="S3.SS1.p1.7.m2.1.2"><times id="S3.SS1.p1.7.m2.1.2.1.cmml" xref="S3.SS1.p1.7.m2.1.2.1"></times><ci id="S3.SS1.p1.7.m2.1.2.2.cmml" xref="S3.SS1.p1.7.m2.1.2.2">𝑔</ci><ci id="S3.SS1.p1.7.m2.1.1.cmml" xref="S3.SS1.p1.7.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m2.1c">g(\cdot)</annotation></semantics></math> is some multimodal feature pooling function such as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Noticing this model ignores the spatial arrangement of the feature vectors in <math id="S3.SS1.p1.8.m3.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{X}}" display="inline"><semantics id="S3.SS1.p1.8.m3.1a"><mi id="S3.SS1.p1.8.m3.1.1" xref="S3.SS1.p1.8.m3.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m3.1b"><ci id="S3.SS1.p1.8.m3.1.1.cmml" xref="S3.SS1.p1.8.m3.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m3.1c">\boldsymbol{\mathrm{X}}</annotation></semantics></math> in each step, and the resulting hidden states in multi-step models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> are still unstructured, we have dropped the hidden states in the condition presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> for notational convenience.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Since categorical distribution only requires the probabilities to be positive and sum to 1, the following normalized sigmoid attention is still a valid categorical attention:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.7" class="ltx_Math" alttext="p(z=i|\boldsymbol{\mathrm{X}},\boldsymbol{q})=\frac{\sigma(\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q}))}{\sum_{j}\sigma(\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{j},\boldsymbol{q}))}." display="block"><semantics id="S3.E3.m1.7a"><mrow id="S3.E3.m1.7.7.1" xref="S3.E3.m1.7.7.1.1.cmml"><mrow id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml"><mrow id="S3.E3.m1.7.7.1.1.1" xref="S3.E3.m1.7.7.1.1.1.cmml"><mi id="S3.E3.m1.7.7.1.1.1.3" xref="S3.E3.m1.7.7.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.7.7.1.1.1.2" xref="S3.E3.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.7.7.1.1.1.1.1" xref="S3.E3.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.7.7.1.1.1.1.1.2" xref="S3.E3.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.7.7.1.1.1.1.1.1" xref="S3.E3.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.7.7.1.1.1.1.1.1.2" xref="S3.E3.m1.7.7.1.1.1.1.1.1.2.cmml">z</mi><mo id="S3.E3.m1.7.7.1.1.1.1.1.1.1" xref="S3.E3.m1.7.7.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.7.7.1.1.1.1.1.1.3" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.7.7.1.1.1.1.1.1.3.2" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.2.cmml">i</mi><mo fence="false" id="S3.E3.m1.7.7.1.1.1.1.1.1.3.1" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E3.m1.7.7.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝐗</mi><mo id="S3.E3.m1.7.7.1.1.1.1.1.1.3.3.2.1" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E3.m1.7.7.1.1.1.1.1.3" xref="S3.E3.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.7.7.1.1.2" xref="S3.E3.m1.7.7.1.1.2.cmml">=</mo><mfrac id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml"><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.3.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.2.cmml">​</mo><mi id="S3.E3.m1.2.2.2.2.1.1.4" xref="S3.E3.m1.2.2.2.2.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.1.1.2a" xref="S3.E3.m1.2.2.2.2.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.2.cmml">(</mo><msub id="S3.E3.m1.2.2.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E3.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3.m1.2.2.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.1.2.cmml">,</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">𝒒</mi><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.1.1.1.4" xref="S3.E3.m1.2.2.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.4.4.4" xref="S3.E3.m1.4.4.4.cmml"><msub id="S3.E3.m1.4.4.4.3" xref="S3.E3.m1.4.4.4.3.cmml"><mo id="S3.E3.m1.4.4.4.3.2" xref="S3.E3.m1.4.4.4.3.2.cmml">∑</mo><mi id="S3.E3.m1.4.4.4.3.3" xref="S3.E3.m1.4.4.4.3.3.cmml">j</mi></msub><mrow id="S3.E3.m1.4.4.4.2" xref="S3.E3.m1.4.4.4.2.cmml"><mi id="S3.E3.m1.4.4.4.2.3" xref="S3.E3.m1.4.4.4.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.4.2.2" xref="S3.E3.m1.4.4.4.2.2.cmml">​</mo><mrow id="S3.E3.m1.4.4.4.2.1.1" xref="S3.E3.m1.4.4.4.2.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.4.2.1.1.2" xref="S3.E3.m1.4.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.4.4.4.2.1.1.1" xref="S3.E3.m1.4.4.4.2.1.1.1.cmml"><mi id="S3.E3.m1.4.4.4.2.1.1.1.3" xref="S3.E3.m1.4.4.4.2.1.1.1.3.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.4.2.1.1.1.2" xref="S3.E3.m1.4.4.4.2.1.1.1.2.cmml">​</mo><mi id="S3.E3.m1.4.4.4.2.1.1.1.4" xref="S3.E3.m1.4.4.4.2.1.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.4.2.1.1.1.2a" xref="S3.E3.m1.4.4.4.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.4.4.4.2.1.1.1.1.1" xref="S3.E3.m1.4.4.4.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.4.2.1.1.1.1.1.2" xref="S3.E3.m1.4.4.4.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.2" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.3" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3.m1.4.4.4.2.1.1.1.1.1.3" xref="S3.E3.m1.4.4.4.2.1.1.1.1.2.cmml">,</mo><mi id="S3.E3.m1.3.3.3.1" xref="S3.E3.m1.3.3.3.1.cmml">𝒒</mi><mo stretchy="false" id="S3.E3.m1.4.4.4.2.1.1.1.1.1.4" xref="S3.E3.m1.4.4.4.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.4.4.4.2.1.1.3" xref="S3.E3.m1.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo lspace="0em" id="S3.E3.m1.7.7.1.2" xref="S3.E3.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.7b"><apply id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1"><eq id="S3.E3.m1.7.7.1.1.2.cmml" xref="S3.E3.m1.7.7.1.1.2"></eq><apply id="S3.E3.m1.7.7.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1"><times id="S3.E3.m1.7.7.1.1.1.2.cmml" xref="S3.E3.m1.7.7.1.1.1.2"></times><ci id="S3.E3.m1.7.7.1.1.1.3.cmml" xref="S3.E3.m1.7.7.1.1.1.3">𝑝</ci><apply id="S3.E3.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1"><eq id="S3.E3.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1.1"></eq><ci id="S3.E3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E3.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E3.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.2">𝑖</ci><list id="S3.E3.m1.7.7.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.7.7.1.1.1.1.1.1.3.3.2"><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝐗</ci><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝒒</ci></list></apply></apply></apply><apply id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4"><divide id="S3.E3.m1.4.4.5.cmml" xref="S3.E3.m1.4.4"></divide><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><ci id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4">𝜎</ci><apply id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1"><times id="S3.E3.m1.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.2"></times><ci id="S3.E3.m1.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3">𝐔</ci><ci id="S3.E3.m1.2.2.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.2.2.1.1.4">𝑔</ci><interval closure="open" id="S3.E3.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1"><apply id="S3.E3.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.2">𝐱</ci><ci id="S3.E3.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝒒</ci></interval></apply></apply><apply id="S3.E3.m1.4.4.4.cmml" xref="S3.E3.m1.4.4.4"><apply id="S3.E3.m1.4.4.4.3.cmml" xref="S3.E3.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.3.1.cmml" xref="S3.E3.m1.4.4.4.3">subscript</csymbol><sum id="S3.E3.m1.4.4.4.3.2.cmml" xref="S3.E3.m1.4.4.4.3.2"></sum><ci id="S3.E3.m1.4.4.4.3.3.cmml" xref="S3.E3.m1.4.4.4.3.3">𝑗</ci></apply><apply id="S3.E3.m1.4.4.4.2.cmml" xref="S3.E3.m1.4.4.4.2"><times id="S3.E3.m1.4.4.4.2.2.cmml" xref="S3.E3.m1.4.4.4.2.2"></times><ci id="S3.E3.m1.4.4.4.2.3.cmml" xref="S3.E3.m1.4.4.4.2.3">𝜎</ci><apply id="S3.E3.m1.4.4.4.2.1.1.1.cmml" xref="S3.E3.m1.4.4.4.2.1.1"><times id="S3.E3.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.2"></times><ci id="S3.E3.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.3">𝐔</ci><ci id="S3.E3.m1.4.4.4.2.1.1.1.4.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.4">𝑔</ci><interval closure="open" id="S3.E3.m1.4.4.4.2.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1"><apply id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.4.2.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E3.m1.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.1">𝒒</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.7c">p(z=i|\boldsymbol{\mathrm{X}},\boldsymbol{q})=\frac{\sigma(\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q}))}{\sum_{j}\sigma(\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{j},\boldsymbol{q}))}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.2" class="ltx_p">We can use such attention as a glimpse<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Glimpses refer to multiple attentions, same as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</span></span></span> of our model, which will be introduced in Section <a href="#S3.SS4" title="3.4 The overall structure ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Structured Multivariate Attention</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.8" class="ltx_p">To consider the arrangement of <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{X}}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\boldsymbol{\mathrm{X}}</annotation></semantics></math>, we adopt a structured multivariate attention model similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, in which we consider the distribution <math id="S3.SS2.p1.2.m2.3" class="ltx_Math" alttext="\boldsymbol{\mathrm{z}}\sim p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS2.p1.2.m2.3a"><mrow id="S3.SS2.p1.2.m2.3.3" xref="S3.SS2.p1.2.m2.3.3.cmml"><mi id="S3.SS2.p1.2.m2.3.3.3" xref="S3.SS2.p1.2.m2.3.3.3.cmml">𝐳</mi><mo id="S3.SS2.p1.2.m2.3.3.2" xref="S3.SS2.p1.2.m2.3.3.2.cmml">∼</mo><mrow id="S3.SS2.p1.2.m2.3.3.1" xref="S3.SS2.p1.2.m2.3.3.1.cmml"><mi id="S3.SS2.p1.2.m2.3.3.1.3" xref="S3.SS2.p1.2.m2.3.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.3.3.1.2" xref="S3.SS2.p1.2.m2.3.3.1.2.cmml">​</mo><mrow id="S3.SS2.p1.2.m2.3.3.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.3.3.1.1.1.2" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.3.3.1.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.3.3.1.1.1.1.2" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">𝐗</mi><mo id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2.1" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.2.m2.3.3.1.1.1.3" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.3b"><apply id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.3.3.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2">similar-to</csymbol><ci id="S3.SS2.p1.2.m2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.3">𝐳</ci><apply id="S3.SS2.p1.2.m2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1"><times id="S3.SS2.p1.2.m2.3.3.1.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.2"></times><ci id="S3.SS2.p1.2.m2.3.3.1.3.cmml" xref="S3.SS2.p1.2.m2.3.3.1.3">𝑝</ci><apply id="S3.SS2.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.2.m2.3.3.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.2">𝐳</ci><list id="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.3.3.1.1.1.1.3.2"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐗</ci><ci id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">𝒒</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.3c">\boldsymbol{\mathrm{z}}\sim p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math> as a vector of binary latent variables <math id="S3.SS2.p1.3.m3.3" class="ltx_Math" alttext="\boldsymbol{\mathrm{z}}=[z_{1},...,z_{M}]^{T}" display="inline"><semantics id="S3.SS2.p1.3.m3.3a"><mrow id="S3.SS2.p1.3.m3.3.3" xref="S3.SS2.p1.3.m3.3.3.cmml"><mi id="S3.SS2.p1.3.m3.3.3.4" xref="S3.SS2.p1.3.m3.3.3.4.cmml">𝐳</mi><mo id="S3.SS2.p1.3.m3.3.3.3" xref="S3.SS2.p1.3.m3.3.3.3.cmml">=</mo><msup id="S3.SS2.p1.3.m3.3.3.2" xref="S3.SS2.p1.3.m3.3.3.2.cmml"><mrow id="S3.SS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.3.3.2.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">[</mo><msub id="S3.SS2.p1.3.m3.2.2.1.1.1.1" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.2.2.1.1.1.1.2" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.2.cmml">z</mi><mn id="S3.SS2.p1.3.m3.2.2.1.1.1.1.3" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.3.m3.3.3.2.2.2.4" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS2.p1.3.m3.3.3.2.2.2.5" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.3.m3.3.3.2.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.cmml"><mi id="S3.SS2.p1.3.m3.3.3.2.2.2.2.2" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.2.cmml">z</mi><mi id="S3.SS2.p1.3.m3.3.3.2.2.2.2.3" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS2.p1.3.m3.3.3.2.2.2.6" xref="S3.SS2.p1.3.m3.3.3.2.2.3.cmml">]</mo></mrow><mi id="S3.SS2.p1.3.m3.3.3.2.4" xref="S3.SS2.p1.3.m3.3.3.2.4.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.3b"><apply id="S3.SS2.p1.3.m3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3"><eq id="S3.SS2.p1.3.m3.3.3.3.cmml" xref="S3.SS2.p1.3.m3.3.3.3"></eq><ci id="S3.SS2.p1.3.m3.3.3.4.cmml" xref="S3.SS2.p1.3.m3.3.3.4">𝐳</ci><apply id="S3.SS2.p1.3.m3.3.3.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2">superscript</csymbol><list id="S3.SS2.p1.3.m3.3.3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2"><apply id="S3.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.2">𝑧</ci><cn type="integer" id="S3.SS2.p1.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">…</ci><apply id="S3.SS2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.2">𝑧</ci><ci id="S3.SS2.p1.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.3.3.2.2.2.2.3">𝑀</ci></apply></list><ci id="S3.SS2.p1.3.m3.3.3.2.4.cmml" xref="S3.SS2.p1.3.m3.3.3.2.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.3c">\boldsymbol{\mathrm{z}}=[z_{1},...,z_{M}]^{T}</annotation></semantics></math> with <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="z_{i}=1" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><msub id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2.2" xref="S3.SS2.p1.4.m4.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.4.m4.1.1.2.3" xref="S3.SS2.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><eq id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></eq><apply id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.p1.4.m4.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">z_{i}=1</annotation></semantics></math> if <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}}_{i}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝐱</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\boldsymbol{\mathrm{x}}_{i}</annotation></semantics></math> is related to the question and <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="z_{i}=0" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><msub id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><eq id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1"></eq><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">z_{i}=0</annotation></semantics></math> otherwise. Multiple regions can now be selected at the same time. We define the context as the expectation of the sum over all related regions, which can be derived as a sum of <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}}_{i}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝐱</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝐱</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\boldsymbol{\mathrm{x}}_{i}</annotation></semantics></math> weighted by the marginal probability <math id="S3.SS2.p1.8.m8.3" class="ltx_Math" alttext="p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS2.p1.8.m8.3a"><mrow id="S3.SS2.p1.8.m8.3.3" xref="S3.SS2.p1.8.m8.3.3.cmml"><mi id="S3.SS2.p1.8.m8.3.3.3" xref="S3.SS2.p1.8.m8.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m8.3.3.2" xref="S3.SS2.p1.8.m8.3.3.2.cmml">​</mo><mrow id="S3.SS2.p1.8.m8.3.3.1.1" xref="S3.SS2.p1.8.m8.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.3.3.1.1.2" xref="S3.SS2.p1.8.m8.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.8.m8.3.3.1.1.1" xref="S3.SS2.p1.8.m8.3.3.1.1.1.cmml"><msub id="S3.SS2.p1.8.m8.3.3.1.1.1.2" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2.cmml"><mi id="S3.SS2.p1.8.m8.3.3.1.1.1.2.2" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.8.m8.3.3.1.1.1.2.3" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.8.m8.3.3.1.1.1.1" xref="S3.SS2.p1.8.m8.3.3.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.8.m8.3.3.1.1.1.3" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.cmml"><mn id="S3.SS2.p1.8.m8.3.3.1.1.1.3.2" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S3.SS2.p1.8.m8.3.3.1.1.1.3.1" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.1.cmml">|</mo><mrow id="S3.SS2.p1.8.m8.3.3.1.1.1.3.3.2" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.3.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">𝐗</mi><mo id="S3.SS2.p1.8.m8.3.3.1.1.1.3.3.2.1" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.8.m8.2.2" xref="S3.SS2.p1.8.m8.2.2.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.8.m8.3.3.1.1.3" xref="S3.SS2.p1.8.m8.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.3b"><apply id="S3.SS2.p1.8.m8.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3"><times id="S3.SS2.p1.8.m8.3.3.2.cmml" xref="S3.SS2.p1.8.m8.3.3.2"></times><ci id="S3.SS2.p1.8.m8.3.3.3.cmml" xref="S3.SS2.p1.8.m8.3.3.3">𝑝</ci><apply id="S3.SS2.p1.8.m8.3.3.1.1.1.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1"><eq id="S3.SS2.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.1"></eq><apply id="S3.SS2.p1.8.m8.3.3.1.1.1.2.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.3.3.1.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.8.m8.3.3.1.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.8.m8.3.3.1.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.8.m8.3.3.1.1.1.3.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.8.m8.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.SS2.p1.8.m8.3.3.1.1.1.3.2.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.2">1</cn><list id="S3.SS2.p1.8.m8.3.3.1.1.1.3.3.1.cmml" xref="S3.SS2.p1.8.m8.3.3.1.1.1.3.3.2"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝐗</ci><ci id="S3.SS2.p1.8.m8.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2">𝒒</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.3c">p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math>:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.7" class="ltx_Math" alttext="\mathbb{E}_{\boldsymbol{\mathrm{z}}\sim p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})}[\boldsymbol{\mathrm{X}}\boldsymbol{\mathrm{z}}]=\sum_{i}p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})\boldsymbol{\mathrm{x}}_{i}." display="block"><semantics id="S3.E4.m1.7a"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1" xref="S3.E4.m1.7.7.1.1.cmml"><mrow id="S3.E4.m1.7.7.1.1.3" xref="S3.E4.m1.7.7.1.1.3.cmml"><msub id="S3.E4.m1.7.7.1.1.3.2" xref="S3.E4.m1.7.7.1.1.3.2.cmml"><mi id="S3.E4.m1.7.7.1.1.3.2.2" xref="S3.E4.m1.7.7.1.1.3.2.2.cmml">𝔼</mi><mrow id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><mi id="S3.E4.m1.3.3.3.5" xref="S3.E4.m1.3.3.3.5.cmml">𝐳</mi><mo id="S3.E4.m1.3.3.3.4" xref="S3.E4.m1.3.3.3.4.cmml">∼</mo><mrow id="S3.E4.m1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.cmml"><mi id="S3.E4.m1.3.3.3.3.3" xref="S3.E4.m1.3.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.3.2" xref="S3.E4.m1.3.3.3.3.2.cmml">​</mo><mrow id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.3.3.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.E4.m1.3.3.3.3.1.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.E4.m1.3.3.3.3.1.1.1.3.2" xref="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">𝐗</mi><mo id="S3.E4.m1.3.3.3.3.1.1.1.3.2.1" xref="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.E4.m1.3.3.3.3.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.3.1" xref="S3.E4.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.7.7.1.1.3.3.2" xref="S3.E4.m1.7.7.1.1.3.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.3.3.2.1" xref="S3.E4.m1.7.7.1.1.3.3.1.1.cmml">[</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">𝐗𝐳</mi><mo stretchy="false" id="S3.E4.m1.7.7.1.1.3.3.2.2" xref="S3.E4.m1.7.7.1.1.3.3.1.1.cmml">]</mo></mrow></mrow><mo rspace="0.111em" id="S3.E4.m1.7.7.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.1.cmml"><munder id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.7.7.1.1.1.2.2" xref="S3.E4.m1.7.7.1.1.1.2.2.cmml">∑</mo><mi id="S3.E4.m1.7.7.1.1.1.2.3" xref="S3.E4.m1.7.7.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E4.m1.7.7.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml"><msub id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">𝐗</mi><mo id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.1.1.1.2a" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">​</mo><msub id="S3.E4.m1.7.7.1.1.1.1.4" xref="S3.E4.m1.7.7.1.1.1.1.4.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.4.2" xref="S3.E4.m1.7.7.1.1.1.1.4.2.cmml">𝐱</mi><mi id="S3.E4.m1.7.7.1.1.1.1.4.3" xref="S3.E4.m1.7.7.1.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.7b"><apply id="S3.E4.m1.7.7.1.1.cmml" xref="S3.E4.m1.7.7.1"><eq id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.2"></eq><apply id="S3.E4.m1.7.7.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.3"><times id="S3.E4.m1.7.7.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.1"></times><apply id="S3.E4.m1.7.7.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.3.2.1.cmml" xref="S3.E4.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.3.2.2.cmml" xref="S3.E4.m1.7.7.1.1.3.2.2">𝔼</ci><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><csymbol cd="latexml" id="S3.E4.m1.3.3.3.4.cmml" xref="S3.E4.m1.3.3.3.4">similar-to</csymbol><ci id="S3.E4.m1.3.3.3.5.cmml" xref="S3.E4.m1.3.3.3.5">𝐳</ci><apply id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3"><times id="S3.E4.m1.3.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.2"></times><ci id="S3.E4.m1.3.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.3">𝑝</ci><apply id="S3.E4.m1.3.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.2">𝐳</ci><list id="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝐗</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝒒</ci></list></apply></apply></apply></apply><apply id="S3.E4.m1.7.7.1.1.3.3.1.cmml" xref="S3.E4.m1.7.7.1.1.3.3.2"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.3.3.1.1.cmml" xref="S3.E4.m1.7.7.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝐗𝐳</ci></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1"><apply id="S3.E4.m1.7.7.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.7.7.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.2.2"></sum><ci id="S3.E4.m1.7.7.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1"><times id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2"></times><ci id="S3.E4.m1.7.7.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.3">𝑝</ci><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1"><eq id="S3.E4.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.1"></eq><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.2">1</cn><list id="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝐗</ci><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝒒</ci></list></apply></apply><apply id="S3.E4.m1.7.7.1.1.1.1.4.cmml" xref="S3.E4.m1.7.7.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.4.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.4.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.4.2">𝐱</ci><ci id="S3.E4.m1.7.7.1.1.1.1.4.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.4.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.7c">\mathbb{E}_{\boldsymbol{\mathrm{z}}\sim p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})}[\boldsymbol{\mathrm{X}}\boldsymbol{\mathrm{z}}]=\sum_{i}p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})\boldsymbol{\mathrm{x}}_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">Let <math id="S3.SS2.p1.9.m1.3" class="ltx_Math" alttext="S=\sum_{i}p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS2.p1.9.m1.3a"><mrow id="S3.SS2.p1.9.m1.3.3" xref="S3.SS2.p1.9.m1.3.3.cmml"><mi id="S3.SS2.p1.9.m1.3.3.3" xref="S3.SS2.p1.9.m1.3.3.3.cmml">S</mi><mo rspace="0.111em" id="S3.SS2.p1.9.m1.3.3.2" xref="S3.SS2.p1.9.m1.3.3.2.cmml">=</mo><mrow id="S3.SS2.p1.9.m1.3.3.1" xref="S3.SS2.p1.9.m1.3.3.1.cmml"><msub id="S3.SS2.p1.9.m1.3.3.1.2" xref="S3.SS2.p1.9.m1.3.3.1.2.cmml"><mo id="S3.SS2.p1.9.m1.3.3.1.2.2" xref="S3.SS2.p1.9.m1.3.3.1.2.2.cmml">∑</mo><mi id="S3.SS2.p1.9.m1.3.3.1.2.3" xref="S3.SS2.p1.9.m1.3.3.1.2.3.cmml">i</mi></msub><mrow id="S3.SS2.p1.9.m1.3.3.1.1" xref="S3.SS2.p1.9.m1.3.3.1.1.cmml"><mi id="S3.SS2.p1.9.m1.3.3.1.1.3" xref="S3.SS2.p1.9.m1.3.3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m1.3.3.1.1.2" xref="S3.SS2.p1.9.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.9.m1.3.3.1.1.1.1" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.9.m1.3.3.1.1.1.1.2" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.cmml"><msub id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.2" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.3" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.1" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.cmml"><mn id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.2" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.1" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.3.2" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.3.1.cmml"><mi id="S3.SS2.p1.9.m1.1.1" xref="S3.SS2.p1.9.m1.1.1.cmml">𝐗</mi><mo id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.3.2.1" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.9.m1.2.2" xref="S3.SS2.p1.9.m1.2.2.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.SS2.p1.9.m1.3.3.1.1.1.1.3" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m1.3b"><apply id="S3.SS2.p1.9.m1.3.3.cmml" xref="S3.SS2.p1.9.m1.3.3"><eq id="S3.SS2.p1.9.m1.3.3.2.cmml" xref="S3.SS2.p1.9.m1.3.3.2"></eq><ci id="S3.SS2.p1.9.m1.3.3.3.cmml" xref="S3.SS2.p1.9.m1.3.3.3">𝑆</ci><apply id="S3.SS2.p1.9.m1.3.3.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1"><apply id="S3.SS2.p1.9.m1.3.3.1.2.cmml" xref="S3.SS2.p1.9.m1.3.3.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m1.3.3.1.2.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.2">subscript</csymbol><sum id="S3.SS2.p1.9.m1.3.3.1.2.2.cmml" xref="S3.SS2.p1.9.m1.3.3.1.2.2"></sum><ci id="S3.SS2.p1.9.m1.3.3.1.2.3.cmml" xref="S3.SS2.p1.9.m1.3.3.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.9.m1.3.3.1.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1"><times id="S3.SS2.p1.9.m1.3.3.1.1.2.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.2"></times><ci id="S3.SS2.p1.9.m1.3.3.1.1.3.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.3">𝑝</ci><apply id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1"><eq id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.1"></eq><apply id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.2">1</cn><list id="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.3.1.cmml" xref="S3.SS2.p1.9.m1.3.3.1.1.1.1.1.3.3.2"><ci id="S3.SS2.p1.9.m1.1.1.cmml" xref="S3.SS2.p1.9.m1.1.1">𝐗</ci><ci id="S3.SS2.p1.9.m1.2.2.cmml" xref="S3.SS2.p1.9.m1.2.2">𝒒</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m1.3c">S=\sum_{i}p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math>. Since <math id="S3.SS2.p1.10.m2.1" class="ltx_Math" alttext="0\leq S\leq M" display="inline"><semantics id="S3.SS2.p1.10.m2.1a"><mrow id="S3.SS2.p1.10.m2.1.1" xref="S3.SS2.p1.10.m2.1.1.cmml"><mn id="S3.SS2.p1.10.m2.1.1.2" xref="S3.SS2.p1.10.m2.1.1.2.cmml">0</mn><mo id="S3.SS2.p1.10.m2.1.1.3" xref="S3.SS2.p1.10.m2.1.1.3.cmml">≤</mo><mi id="S3.SS2.p1.10.m2.1.1.4" xref="S3.SS2.p1.10.m2.1.1.4.cmml">S</mi><mo id="S3.SS2.p1.10.m2.1.1.5" xref="S3.SS2.p1.10.m2.1.1.5.cmml">≤</mo><mi id="S3.SS2.p1.10.m2.1.1.6" xref="S3.SS2.p1.10.m2.1.1.6.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m2.1b"><apply id="S3.SS2.p1.10.m2.1.1.cmml" xref="S3.SS2.p1.10.m2.1.1"><and id="S3.SS2.p1.10.m2.1.1a.cmml" xref="S3.SS2.p1.10.m2.1.1"></and><apply id="S3.SS2.p1.10.m2.1.1b.cmml" xref="S3.SS2.p1.10.m2.1.1"><leq id="S3.SS2.p1.10.m2.1.1.3.cmml" xref="S3.SS2.p1.10.m2.1.1.3"></leq><cn type="integer" id="S3.SS2.p1.10.m2.1.1.2.cmml" xref="S3.SS2.p1.10.m2.1.1.2">0</cn><ci id="S3.SS2.p1.10.m2.1.1.4.cmml" xref="S3.SS2.p1.10.m2.1.1.4">𝑆</ci></apply><apply id="S3.SS2.p1.10.m2.1.1c.cmml" xref="S3.SS2.p1.10.m2.1.1"><leq id="S3.SS2.p1.10.m2.1.1.5.cmml" xref="S3.SS2.p1.10.m2.1.1.5"></leq><share href="#S3.SS2.p1.10.m2.1.1.4.cmml" id="S3.SS2.p1.10.m2.1.1d.cmml" xref="S3.SS2.p1.10.m2.1.1"></share><ci id="S3.SS2.p1.10.m2.1.1.6.cmml" xref="S3.SS2.p1.10.m2.1.1.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m2.1c">0\leq S\leq M</annotation></semantics></math> and <math id="S3.SS2.p1.11.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.11.m3.1a"><mi id="S3.SS2.p1.11.m3.1.1" xref="S3.SS2.p1.11.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m3.1b"><ci id="S3.SS2.p1.11.m3.1.1.cmml" xref="S3.SS2.p1.11.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m3.1c">M</annotation></semantics></math> is relatively large, to reduce covariate shift, we normalize the expectation to get the context <math id="S3.SS2.p1.12.m4.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{c}}" display="inline"><semantics id="S3.SS2.p1.12.m4.1a"><mi id="S3.SS2.p1.12.m4.1.1" xref="S3.SS2.p1.12.m4.1.1.cmml">𝐜</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m4.1b"><ci id="S3.SS2.p1.12.m4.1.1.cmml" xref="S3.SS2.p1.12.m4.1.1">𝐜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m4.1c">\boldsymbol{\mathrm{c}}</annotation></semantics></math>:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\boldsymbol{\mathrm{c}}=\frac{1}{S}\sum_{i}p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})\boldsymbol{\mathrm{x}}_{i}," display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.1.cmml"><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.3" xref="S3.E5.m1.3.3.1.1.3.cmml">𝐜</mi><mo id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.1.cmml"><mfrac id="S3.E5.m1.3.3.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.3.cmml"><mn id="S3.E5.m1.3.3.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.3.2.cmml">1</mn><mi id="S3.E5.m1.3.3.1.1.1.3.3" xref="S3.E5.m1.3.3.1.1.1.3.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><munder id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E5.m1.3.3.1.1.1.1.2.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E5.m1.3.3.1.1.1.1.2.3" xref="S3.E5.m1.3.3.1.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml"><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝐗</mi><mo id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.1.1.1.1.1.2a" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E5.m1.3.3.1.1.1.1.1.4" xref="S3.E5.m1.3.3.1.1.1.1.1.4.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.4.2" xref="S3.E5.m1.3.3.1.1.1.1.1.4.2.cmml">𝐱</mi><mi id="S3.E5.m1.3.3.1.1.1.1.1.4.3" xref="S3.E5.m1.3.3.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1"><eq id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"></eq><ci id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.3">𝐜</ci><apply id="S3.E5.m1.3.3.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.2"></times><apply id="S3.E5.m1.3.3.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3"><divide id="S3.E5.m1.3.3.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.3"></divide><cn type="integer" id="S3.E5.m1.3.3.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.3.2">1</cn><ci id="S3.E5.m1.3.3.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.3.3">𝑆</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><apply id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2"></sum><ci id="S3.E5.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1"><times id="S3.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E5.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3">𝑝</ci><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1"><eq id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.2">1</cn><list id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝐗</ci><ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">𝒒</ci></list></apply></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.4.2">𝐱</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\boldsymbol{\mathrm{c}}=\frac{1}{S}\sum_{i}p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})\boldsymbol{\mathrm{x}}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.5" class="ltx_p">We model the distribution <math id="S3.SS2.p2.1.m1.3" class="ltx_Math" alttext="p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS2.p2.1.m1.3a"><mrow id="S3.SS2.p2.1.m1.3.3" xref="S3.SS2.p2.1.m1.3.3.cmml"><mi id="S3.SS2.p2.1.m1.3.3.3" xref="S3.SS2.p2.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.3.3.2" xref="S3.SS2.p2.1.m1.3.3.2.cmml">​</mo><mrow id="S3.SS2.p2.1.m1.3.3.1.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.1.1.2" xref="S3.SS2.p2.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.3.3.1.1.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.3.3.1.1.1.2" xref="S3.SS2.p2.1.m1.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.SS2.p2.1.m1.3.3.1.1.1.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.p2.1.m1.3.3.1.1.1.3.2" xref="S3.SS2.p2.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">𝐗</mi><mo id="S3.SS2.p2.1.m1.3.3.1.1.1.3.2.1" xref="S3.SS2.p2.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p2.1.m1.2.2" xref="S3.SS2.p2.1.m1.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.1.m1.3.3.1.1.3" xref="S3.SS2.p2.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.3b"><apply id="S3.SS2.p2.1.m1.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3"><times id="S3.SS2.p2.1.m1.3.3.2.cmml" xref="S3.SS2.p2.1.m1.3.3.2"></times><ci id="S3.SS2.p2.1.m1.3.3.3.cmml" xref="S3.SS2.p2.1.m1.3.3.3">𝑝</ci><apply id="S3.SS2.p2.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.2">𝐳</ci><list id="S3.SS2.p2.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.3.3.1.1.1.3.2"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐗</ci><ci id="S3.SS2.p2.1.m1.2.2.cmml" xref="S3.SS2.p2.1.m1.2.2">𝒒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.3c">p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math> in the most straightforward form, a grid-structured Conditional Random Field, which represents the joint probability <math id="S3.SS2.p2.2.m2.3" class="ltx_Math" alttext="p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS2.p2.2.m2.3a"><mrow id="S3.SS2.p2.2.m2.3.3" xref="S3.SS2.p2.2.m2.3.3.cmml"><mi id="S3.SS2.p2.2.m2.3.3.3" xref="S3.SS2.p2.2.m2.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.3.3.2" xref="S3.SS2.p2.2.m2.3.3.2.cmml">​</mo><mrow id="S3.SS2.p2.2.m2.3.3.1.1" xref="S3.SS2.p2.2.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.3.3.1.1.2" xref="S3.SS2.p2.2.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.2.m2.3.3.1.1.1" xref="S3.SS2.p2.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.3.3.1.1.1.2" xref="S3.SS2.p2.2.m2.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.SS2.p2.2.m2.3.3.1.1.1.1" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.p2.2.m2.3.3.1.1.1.3.2" xref="S3.SS2.p2.2.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">𝐗</mi><mo id="S3.SS2.p2.2.m2.3.3.1.1.1.3.2.1" xref="S3.SS2.p2.2.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.2.m2.3.3.1.1.3" xref="S3.SS2.p2.2.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.3b"><apply id="S3.SS2.p2.2.m2.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3"><times id="S3.SS2.p2.2.m2.3.3.2.cmml" xref="S3.SS2.p2.2.m2.3.3.2"></times><ci id="S3.SS2.p2.2.m2.3.3.3.cmml" xref="S3.SS2.p2.2.m2.3.3.3">𝑝</ci><apply id="S3.SS2.p2.2.m2.3.3.1.1.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.2">𝐳</ci><list id="S3.SS2.p2.2.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.3.3.1.1.1.3.2"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝐗</ci><ci id="S3.SS2.p2.2.m2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2">𝒒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.3c">p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math> with a grid-structured factor graph that considers the pairwise joint distribution of a region’s 4-neighbourhood, as shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Let <math id="S3.SS2.p2.3.m3.6" class="ltx_Math" alttext="\mathcal{N}=\{(i,j)|i&lt;j,j\in N_{i}\}" display="inline"><semantics id="S3.SS2.p2.3.m3.6a"><mrow id="S3.SS2.p2.3.m3.6.6" xref="S3.SS2.p2.3.m3.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.3.m3.6.6.4" xref="S3.SS2.p2.3.m3.6.6.4.cmml">𝒩</mi><mo id="S3.SS2.p2.3.m3.6.6.3" xref="S3.SS2.p2.3.m3.6.6.3.cmml">=</mo><mrow id="S3.SS2.p2.3.m3.6.6.2.2" xref="S3.SS2.p2.3.m3.6.6.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.6.6.2.2.3" xref="S3.SS2.p2.3.m3.6.6.2.3.1.cmml">{</mo><mrow id="S3.SS2.p2.3.m3.5.5.1.1.1.2" xref="S3.SS2.p2.3.m3.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m3.5.5.1.1.1.2.1" xref="S3.SS2.p2.3.m3.5.5.1.1.1.1.cmml">(</mo><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">i</mi><mo id="S3.SS2.p2.3.m3.5.5.1.1.1.2.2" xref="S3.SS2.p2.3.m3.5.5.1.1.1.1.cmml">,</mo><mi id="S3.SS2.p2.3.m3.2.2" xref="S3.SS2.p2.3.m3.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS2.p2.3.m3.5.5.1.1.1.2.3" xref="S3.SS2.p2.3.m3.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.6.6.2.2.4" xref="S3.SS2.p2.3.m3.6.6.2.3.1.cmml">|</mo><mrow id="S3.SS2.p2.3.m3.6.6.2.2.2.2" xref="S3.SS2.p2.3.m3.6.6.2.2.2.3.cmml"><mrow id="S3.SS2.p2.3.m3.6.6.2.2.2.1.1" xref="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.cmml"><mi id="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.2" xref="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.2.cmml">i</mi><mo id="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.1" xref="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.1.cmml">&lt;</mo><mi id="S3.SS2.p2.3.m3.3.3" xref="S3.SS2.p2.3.m3.3.3.cmml">j</mi></mrow><mo id="S3.SS2.p2.3.m3.6.6.2.2.2.2.3" xref="S3.SS2.p2.3.m3.6.6.2.2.2.3a.cmml">,</mo><mrow id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.3.m3.4.4" xref="S3.SS2.p2.3.m3.4.4.cmml">j</mi><mo id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.1" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.1.cmml">∈</mo><msub id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.2" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.2.cmml">N</mi><mi id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.3" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.3.m3.6.6.2.2.5" xref="S3.SS2.p2.3.m3.6.6.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.6b"><apply id="S3.SS2.p2.3.m3.6.6.cmml" xref="S3.SS2.p2.3.m3.6.6"><eq id="S3.SS2.p2.3.m3.6.6.3.cmml" xref="S3.SS2.p2.3.m3.6.6.3"></eq><ci id="S3.SS2.p2.3.m3.6.6.4.cmml" xref="S3.SS2.p2.3.m3.6.6.4">𝒩</ci><apply id="S3.SS2.p2.3.m3.6.6.2.3.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2"><csymbol cd="latexml" id="S3.SS2.p2.3.m3.6.6.2.3.1.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.SS2.p2.3.m3.5.5.1.1.1.1.cmml" xref="S3.SS2.p2.3.m3.5.5.1.1.1.2"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑖</ci><ci id="S3.SS2.p2.3.m3.2.2.cmml" xref="S3.SS2.p2.3.m3.2.2">𝑗</ci></interval><apply id="S3.SS2.p2.3.m3.6.6.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.6.6.2.2.2.3a.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.1.1"><lt id="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.1.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.1"></lt><ci id="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.2.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.1.1.2">𝑖</ci><ci id="S3.SS2.p2.3.m3.3.3.cmml" xref="S3.SS2.p2.3.m3.3.3">𝑗</ci></apply><apply id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2"><in id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.1"></in><ci id="S3.SS2.p2.3.m3.4.4.cmml" xref="S3.SS2.p2.3.m3.4.4">𝑗</ci><apply id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.2">𝑁</ci><ci id="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.3.m3.6.6.2.2.2.2.2.2.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.6c">\mathcal{N}=\{(i,j)|i&lt;j,j\in N_{i}\}</annotation></semantics></math>, where <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">N</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑁</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">N_{i}</annotation></semantics></math> is the set of <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">i</annotation></semantics></math>’s neighbors on the graph. The grid-structured CRF assumes</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.5" class="ltx_Math" alttext="p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})=\frac{1}{Z}\prod_{(i,j)\in\mathcal{N}}\psi_{ij}(z_{i},z_{j})\prod_{i}\psi_{i}(z_{i})," display="block"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.E6.m1.5.5.1.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">𝐗</mi><mo id="S3.E6.m1.5.5.1.1.1.1.1.1.3.2.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.E6.m1.5.5.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.1.1.5" xref="S3.E6.m1.5.5.1.1.5.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.4" xref="S3.E6.m1.5.5.1.1.4.cmml"><mfrac id="S3.E6.m1.5.5.1.1.4.5" xref="S3.E6.m1.5.5.1.1.4.5.cmml"><mn id="S3.E6.m1.5.5.1.1.4.5.2" xref="S3.E6.m1.5.5.1.1.4.5.2.cmml">1</mn><mi id="S3.E6.m1.5.5.1.1.4.5.3" xref="S3.E6.m1.5.5.1.1.4.5.3.cmml">Z</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.4.4" xref="S3.E6.m1.5.5.1.1.4.4.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.4.3" xref="S3.E6.m1.5.5.1.1.4.3.cmml"><munder id="S3.E6.m1.5.5.1.1.4.3.4" xref="S3.E6.m1.5.5.1.1.4.3.4.cmml"><mo movablelimits="false" id="S3.E6.m1.5.5.1.1.4.3.4.2" xref="S3.E6.m1.5.5.1.1.4.3.4.2.cmml">∏</mo><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mrow id="S3.E6.m1.2.2.2.4.2" xref="S3.E6.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.4.2.1" xref="S3.E6.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.2.2.2.4.2.2" xref="S3.E6.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">j</mi><mo stretchy="false" id="S3.E6.m1.2.2.2.4.2.3" xref="S3.E6.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.5" xref="S3.E6.m1.2.2.2.5.cmml">𝒩</mi></mrow></munder><mrow id="S3.E6.m1.5.5.1.1.4.3.3" xref="S3.E6.m1.5.5.1.1.4.3.3.cmml"><msub id="S3.E6.m1.5.5.1.1.4.3.3.5" xref="S3.E6.m1.5.5.1.1.4.3.3.5.cmml"><mi id="S3.E6.m1.5.5.1.1.4.3.3.5.2" xref="S3.E6.m1.5.5.1.1.4.3.3.5.2.cmml">ψ</mi><mrow id="S3.E6.m1.5.5.1.1.4.3.3.5.3" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.cmml"><mi id="S3.E6.m1.5.5.1.1.4.3.3.5.3.2" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.4.3.3.5.3.1" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.1.cmml">​</mo><mi id="S3.E6.m1.5.5.1.1.4.3.3.5.3.3" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.4.3.3.4" xref="S3.E6.m1.5.5.1.1.4.3.3.4.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.3.2.2.2.2" xref="S3.E6.m1.5.5.1.1.3.2.2.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.3.2.2.2.2.3" xref="S3.E6.m1.5.5.1.1.3.2.2.2.3.cmml">(</mo><msub id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.5.5.1.1.3.2.2.2.2.4" xref="S3.E6.m1.5.5.1.1.3.2.2.2.3.cmml">,</mo><msub id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.cmml"><mi id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.2" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.3" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E6.m1.5.5.1.1.3.2.2.2.2.5" xref="S3.E6.m1.5.5.1.1.3.2.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.4.3.3.4a" xref="S3.E6.m1.5.5.1.1.4.3.3.4.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.4.3.3.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.cmml"><munder id="S3.E6.m1.5.5.1.1.4.3.3.3.2" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2.cmml"><mo movablelimits="false" id="S3.E6.m1.5.5.1.1.4.3.3.3.2.2" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2.2.cmml">∏</mo><mi id="S3.E6.m1.5.5.1.1.4.3.3.3.2.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2.3.cmml">i</mi></munder><mrow id="S3.E6.m1.5.5.1.1.4.3.3.3.1" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.cmml"><msub id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.2" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.2.cmml">ψ</mi><mi id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.4.3.3.3.1.2" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.2.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.2" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.2.cmml">z</mi><mi id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.3" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1"><eq id="S3.E6.m1.5.5.1.1.5.cmml" xref="S3.E6.m1.5.5.1.1.5"></eq><apply id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"><times id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.2"></times><ci id="S3.E6.m1.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3">𝑝</ci><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2">𝐳</ci><list id="S3.E6.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝐗</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝒒</ci></list></apply></apply><apply id="S3.E6.m1.5.5.1.1.4.cmml" xref="S3.E6.m1.5.5.1.1.4"><times id="S3.E6.m1.5.5.1.1.4.4.cmml" xref="S3.E6.m1.5.5.1.1.4.4"></times><apply id="S3.E6.m1.5.5.1.1.4.5.cmml" xref="S3.E6.m1.5.5.1.1.4.5"><divide id="S3.E6.m1.5.5.1.1.4.5.1.cmml" xref="S3.E6.m1.5.5.1.1.4.5"></divide><cn type="integer" id="S3.E6.m1.5.5.1.1.4.5.2.cmml" xref="S3.E6.m1.5.5.1.1.4.5.2">1</cn><ci id="S3.E6.m1.5.5.1.1.4.5.3.cmml" xref="S3.E6.m1.5.5.1.1.4.5.3">𝑍</ci></apply><apply id="S3.E6.m1.5.5.1.1.4.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3"><apply id="S3.E6.m1.5.5.1.1.4.3.4.cmml" xref="S3.E6.m1.5.5.1.1.4.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.3.4.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.4">subscript</csymbol><csymbol cd="latexml" id="S3.E6.m1.5.5.1.1.4.3.4.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.4.2">product</csymbol><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><in id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></in><interval closure="open" id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4.2"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑗</ci></interval><ci id="S3.E6.m1.2.2.2.5.cmml" xref="S3.E6.m1.2.2.2.5">𝒩</ci></apply></apply><apply id="S3.E6.m1.5.5.1.1.4.3.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3"><times id="S3.E6.m1.5.5.1.1.4.3.3.4.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.4"></times><apply id="S3.E6.m1.5.5.1.1.4.3.3.5.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.3.3.5.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.4.3.3.5.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5.2">𝜓</ci><apply id="S3.E6.m1.5.5.1.1.4.3.3.5.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3"><times id="S3.E6.m1.5.5.1.1.4.3.3.5.3.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.1"></times><ci id="S3.E6.m1.5.5.1.1.4.3.3.5.3.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.2">𝑖</ci><ci id="S3.E6.m1.5.5.1.1.4.3.3.5.3.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.5.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.E6.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2"><apply id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.2">𝑧</ci><ci id="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.2">𝑧</ci><ci id="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.3.cmml" xref="S3.E6.m1.5.5.1.1.3.2.2.2.2.2.3">𝑗</ci></apply></interval><apply id="S3.E6.m1.5.5.1.1.4.3.3.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3"><apply id="S3.E6.m1.5.5.1.1.4.3.3.3.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.3.3.3.2.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2">subscript</csymbol><csymbol cd="latexml" id="S3.E6.m1.5.5.1.1.4.3.3.3.2.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2.2">product</csymbol><ci id="S3.E6.m1.5.5.1.1.4.3.3.3.2.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.2.3">𝑖</ci></apply><apply id="S3.E6.m1.5.5.1.1.4.3.3.3.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1"><times id="S3.E6.m1.5.5.1.1.4.3.3.3.1.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.2"></times><apply id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.2">𝜓</ci><ci id="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.2">𝑧</ci><ci id="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.4.3.3.3.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})=\frac{1}{Z}\prod_{(i,j)\in\mathcal{N}}\psi_{ij}(z_{i},z_{j})\prod_{i}\psi_{i}(z_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.11" class="ltx_p">where the unary potential <math id="S3.SS2.p2.6.m1.1" class="ltx_Math" alttext="\psi_{i}(z_{i})\geq 0" display="inline"><semantics id="S3.SS2.p2.6.m1.1a"><mrow id="S3.SS2.p2.6.m1.1.1" xref="S3.SS2.p2.6.m1.1.1.cmml"><mrow id="S3.SS2.p2.6.m1.1.1.1" xref="S3.SS2.p2.6.m1.1.1.1.cmml"><msub id="S3.SS2.p2.6.m1.1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.1.3.cmml"><mi id="S3.SS2.p2.6.m1.1.1.1.3.2" xref="S3.SS2.p2.6.m1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.SS2.p2.6.m1.1.1.1.3.3" xref="S3.SS2.p2.6.m1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.6.m1.1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.6.m1.1.1.1.1.1" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.6.m1.1.1.1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p2.6.m1.1.1.1.1.1.1" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.6.m1.1.1.1.1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p2.6.m1.1.1.1.1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p2.6.m1.1.1.1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.6.m1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.2.cmml">≥</mo><mn id="S3.SS2.p2.6.m1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m1.1b"><apply id="S3.SS2.p2.6.m1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1"><geq id="S3.SS2.p2.6.m1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2"></geq><apply id="S3.SS2.p2.6.m1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1"><times id="S3.SS2.p2.6.m1.1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.1.2"></times><apply id="S3.SS2.p2.6.m1.1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.1.3.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.1.3.2.cmml" xref="S3.SS2.p2.6.m1.1.1.1.3.2">𝜓</ci><ci id="S3.SS2.p2.6.m1.1.1.1.3.3.cmml" xref="S3.SS2.p2.6.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS2.p2.6.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.p2.6.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S3.SS2.p2.6.m1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m1.1c">\psi_{i}(z_{i})\geq 0</annotation></semantics></math> measures the likelihood of region <math id="S3.SS2.p2.7.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.7.m2.1a"><mi id="S3.SS2.p2.7.m2.1.1" xref="S3.SS2.p2.7.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m2.1b"><ci id="S3.SS2.p2.7.m2.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m2.1c">i</annotation></semantics></math> taking the value <math id="S3.SS2.p2.8.m3.2" class="ltx_Math" alttext="z_{i}\in\{0,1\}" display="inline"><semantics id="S3.SS2.p2.8.m3.2a"><mrow id="S3.SS2.p2.8.m3.2.3" xref="S3.SS2.p2.8.m3.2.3.cmml"><msub id="S3.SS2.p2.8.m3.2.3.2" xref="S3.SS2.p2.8.m3.2.3.2.cmml"><mi id="S3.SS2.p2.8.m3.2.3.2.2" xref="S3.SS2.p2.8.m3.2.3.2.2.cmml">z</mi><mi id="S3.SS2.p2.8.m3.2.3.2.3" xref="S3.SS2.p2.8.m3.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.8.m3.2.3.1" xref="S3.SS2.p2.8.m3.2.3.1.cmml">∈</mo><mrow id="S3.SS2.p2.8.m3.2.3.3.2" xref="S3.SS2.p2.8.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.8.m3.2.3.3.2.1" xref="S3.SS2.p2.8.m3.2.3.3.1.cmml">{</mo><mn id="S3.SS2.p2.8.m3.1.1" xref="S3.SS2.p2.8.m3.1.1.cmml">0</mn><mo id="S3.SS2.p2.8.m3.2.3.3.2.2" xref="S3.SS2.p2.8.m3.2.3.3.1.cmml">,</mo><mn id="S3.SS2.p2.8.m3.2.2" xref="S3.SS2.p2.8.m3.2.2.cmml">1</mn><mo stretchy="false" id="S3.SS2.p2.8.m3.2.3.3.2.3" xref="S3.SS2.p2.8.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m3.2b"><apply id="S3.SS2.p2.8.m3.2.3.cmml" xref="S3.SS2.p2.8.m3.2.3"><in id="S3.SS2.p2.8.m3.2.3.1.cmml" xref="S3.SS2.p2.8.m3.2.3.1"></in><apply id="S3.SS2.p2.8.m3.2.3.2.cmml" xref="S3.SS2.p2.8.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m3.2.3.2.1.cmml" xref="S3.SS2.p2.8.m3.2.3.2">subscript</csymbol><ci id="S3.SS2.p2.8.m3.2.3.2.2.cmml" xref="S3.SS2.p2.8.m3.2.3.2.2">𝑧</ci><ci id="S3.SS2.p2.8.m3.2.3.2.3.cmml" xref="S3.SS2.p2.8.m3.2.3.2.3">𝑖</ci></apply><set id="S3.SS2.p2.8.m3.2.3.3.1.cmml" xref="S3.SS2.p2.8.m3.2.3.3.2"><cn type="integer" id="S3.SS2.p2.8.m3.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1">0</cn><cn type="integer" id="S3.SS2.p2.8.m3.2.2.cmml" xref="S3.SS2.p2.8.m3.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m3.2c">z_{i}\in\{0,1\}</annotation></semantics></math>, and the pairwise potential <math id="S3.SS2.p2.9.m4.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})\geq 0" display="inline"><semantics id="S3.SS2.p2.9.m4.2a"><mrow id="S3.SS2.p2.9.m4.2.2" xref="S3.SS2.p2.9.m4.2.2.cmml"><mrow id="S3.SS2.p2.9.m4.2.2.2" xref="S3.SS2.p2.9.m4.2.2.2.cmml"><msub id="S3.SS2.p2.9.m4.2.2.2.4" xref="S3.SS2.p2.9.m4.2.2.2.4.cmml"><mi id="S3.SS2.p2.9.m4.2.2.2.4.2" xref="S3.SS2.p2.9.m4.2.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS2.p2.9.m4.2.2.2.4.3" xref="S3.SS2.p2.9.m4.2.2.2.4.3.cmml"><mi id="S3.SS2.p2.9.m4.2.2.2.4.3.2" xref="S3.SS2.p2.9.m4.2.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.9.m4.2.2.2.4.3.1" xref="S3.SS2.p2.9.m4.2.2.2.4.3.1.cmml">​</mo><mi id="S3.SS2.p2.9.m4.2.2.2.4.3.3" xref="S3.SS2.p2.9.m4.2.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.9.m4.2.2.2.3" xref="S3.SS2.p2.9.m4.2.2.2.3.cmml">​</mo><mrow id="S3.SS2.p2.9.m4.2.2.2.2.2" xref="S3.SS2.p2.9.m4.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.9.m4.2.2.2.2.2.3" xref="S3.SS2.p2.9.m4.2.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.9.m4.1.1.1.1.1.1" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.9.m4.1.1.1.1.1.1.2" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p2.9.m4.1.1.1.1.1.1.3" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.9.m4.2.2.2.2.2.4" xref="S3.SS2.p2.9.m4.2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.9.m4.2.2.2.2.2.2" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2.cmml"><mi id="S3.SS2.p2.9.m4.2.2.2.2.2.2.2" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS2.p2.9.m4.2.2.2.2.2.2.3" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p2.9.m4.2.2.2.2.2.5" xref="S3.SS2.p2.9.m4.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.9.m4.2.2.3" xref="S3.SS2.p2.9.m4.2.2.3.cmml">≥</mo><mn id="S3.SS2.p2.9.m4.2.2.4" xref="S3.SS2.p2.9.m4.2.2.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m4.2b"><apply id="S3.SS2.p2.9.m4.2.2.cmml" xref="S3.SS2.p2.9.m4.2.2"><geq id="S3.SS2.p2.9.m4.2.2.3.cmml" xref="S3.SS2.p2.9.m4.2.2.3"></geq><apply id="S3.SS2.p2.9.m4.2.2.2.cmml" xref="S3.SS2.p2.9.m4.2.2.2"><times id="S3.SS2.p2.9.m4.2.2.2.3.cmml" xref="S3.SS2.p2.9.m4.2.2.2.3"></times><apply id="S3.SS2.p2.9.m4.2.2.2.4.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m4.2.2.2.4.1.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4">subscript</csymbol><ci id="S3.SS2.p2.9.m4.2.2.2.4.2.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4.2">𝜓</ci><apply id="S3.SS2.p2.9.m4.2.2.2.4.3.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4.3"><times id="S3.SS2.p2.9.m4.2.2.2.4.3.1.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4.3.1"></times><ci id="S3.SS2.p2.9.m4.2.2.2.4.3.2.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4.3.2">𝑖</ci><ci id="S3.SS2.p2.9.m4.2.2.2.4.3.3.cmml" xref="S3.SS2.p2.9.m4.2.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS2.p2.9.m4.2.2.2.2.3.cmml" xref="S3.SS2.p2.9.m4.2.2.2.2.2"><apply id="S3.SS2.p2.9.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.p2.9.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.9.m4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p2.9.m4.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.9.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS2.p2.9.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS2.p2.9.m4.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply><cn type="integer" id="S3.SS2.p2.9.m4.2.2.4.cmml" xref="S3.SS2.p2.9.m4.2.2.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m4.2c">\psi_{ij}(z_{i},z_{j})\geq 0</annotation></semantics></math> measures the likelihood of regions <math id="S3.SS2.p2.10.m5.2" class="ltx_Math" alttext="(i,j)" display="inline"><semantics id="S3.SS2.p2.10.m5.2a"><mrow id="S3.SS2.p2.10.m5.2.3.2" xref="S3.SS2.p2.10.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p2.10.m5.2.3.2.1" xref="S3.SS2.p2.10.m5.2.3.1.cmml">(</mo><mi id="S3.SS2.p2.10.m5.1.1" xref="S3.SS2.p2.10.m5.1.1.cmml">i</mi><mo id="S3.SS2.p2.10.m5.2.3.2.2" xref="S3.SS2.p2.10.m5.2.3.1.cmml">,</mo><mi id="S3.SS2.p2.10.m5.2.2" xref="S3.SS2.p2.10.m5.2.2.cmml">j</mi><mo stretchy="false" id="S3.SS2.p2.10.m5.2.3.2.3" xref="S3.SS2.p2.10.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m5.2b"><interval closure="open" id="S3.SS2.p2.10.m5.2.3.1.cmml" xref="S3.SS2.p2.10.m5.2.3.2"><ci id="S3.SS2.p2.10.m5.1.1.cmml" xref="S3.SS2.p2.10.m5.1.1">𝑖</ci><ci id="S3.SS2.p2.10.m5.2.2.cmml" xref="S3.SS2.p2.10.m5.2.2">𝑗</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m5.2c">(i,j)</annotation></semantics></math> taking values <math id="S3.SS2.p2.11.m6.2" class="ltx_Math" alttext="z_{i},z_{j}" display="inline"><semantics id="S3.SS2.p2.11.m6.2a"><mrow id="S3.SS2.p2.11.m6.2.2.2" xref="S3.SS2.p2.11.m6.2.2.3.cmml"><msub id="S3.SS2.p2.11.m6.1.1.1.1" xref="S3.SS2.p2.11.m6.1.1.1.1.cmml"><mi id="S3.SS2.p2.11.m6.1.1.1.1.2" xref="S3.SS2.p2.11.m6.1.1.1.1.2.cmml">z</mi><mi id="S3.SS2.p2.11.m6.1.1.1.1.3" xref="S3.SS2.p2.11.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.p2.11.m6.2.2.2.3" xref="S3.SS2.p2.11.m6.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.11.m6.2.2.2.2" xref="S3.SS2.p2.11.m6.2.2.2.2.cmml"><mi id="S3.SS2.p2.11.m6.2.2.2.2.2" xref="S3.SS2.p2.11.m6.2.2.2.2.2.cmml">z</mi><mi id="S3.SS2.p2.11.m6.2.2.2.2.3" xref="S3.SS2.p2.11.m6.2.2.2.2.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m6.2b"><list id="S3.SS2.p2.11.m6.2.2.3.cmml" xref="S3.SS2.p2.11.m6.2.2.2"><apply id="S3.SS2.p2.11.m6.1.1.1.1.cmml" xref="S3.SS2.p2.11.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m6.1.1.1.1.1.cmml" xref="S3.SS2.p2.11.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.11.m6.1.1.1.1.2.cmml" xref="S3.SS2.p2.11.m6.1.1.1.1.2">𝑧</ci><ci id="S3.SS2.p2.11.m6.1.1.1.1.3.cmml" xref="S3.SS2.p2.11.m6.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p2.11.m6.2.2.2.2.cmml" xref="S3.SS2.p2.11.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m6.2.2.2.2.1.cmml" xref="S3.SS2.p2.11.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.11.m6.2.2.2.2.2.cmml" xref="S3.SS2.p2.11.m6.2.2.2.2.2">𝑧</ci><ci id="S3.SS2.p2.11.m6.2.2.2.2.3.cmml" xref="S3.SS2.p2.11.m6.2.2.2.2.3">𝑗</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m6.2c">z_{i},z_{j}</annotation></semantics></math> respectively.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Recurrent Inference Layers</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.7" class="ltx_p">The inference problem in such a gird-structured factor graph, which aims to calculate the marginal probability <math id="S3.SS3.p1.1.m1.4" class="ltx_Math" alttext="p(z_{i}|\boldsymbol{\mathrm{X}},\boldsymbol{q};\theta)" display="inline"><semantics id="S3.SS3.p1.1.m1.4a"><mrow id="S3.SS3.p1.1.m1.4.4" xref="S3.SS3.p1.1.m1.4.4.cmml"><mi id="S3.SS3.p1.1.m1.4.4.3" xref="S3.SS3.p1.1.m1.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.4.4.2" xref="S3.SS3.p1.1.m1.4.4.2.cmml">​</mo><mrow id="S3.SS3.p1.1.m1.4.4.1.1" xref="S3.SS3.p1.1.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.4.4.1.1.2" xref="S3.SS3.p1.1.m1.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.1.m1.4.4.1.1.1" xref="S3.SS3.p1.1.m1.4.4.1.1.1.cmml"><msub id="S3.SS3.p1.1.m1.4.4.1.1.1.2" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2.cmml"><mi id="S3.SS3.p1.1.m1.4.4.1.1.1.2.2" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2.2.cmml">z</mi><mi id="S3.SS3.p1.1.m1.4.4.1.1.1.2.3" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS3.p1.1.m1.4.4.1.1.1.1" xref="S3.SS3.p1.1.m1.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p1.1.m1.4.4.1.1.1.3.2" xref="S3.SS3.p1.1.m1.4.4.1.1.1.3.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">𝐗</mi><mo id="S3.SS3.p1.1.m1.4.4.1.1.1.3.2.1" xref="S3.SS3.p1.1.m1.4.4.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p1.1.m1.2.2" xref="S3.SS3.p1.1.m1.2.2.cmml">𝒒</mi><mo id="S3.SS3.p1.1.m1.4.4.1.1.1.3.2.2" xref="S3.SS3.p1.1.m1.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.SS3.p1.1.m1.3.3" xref="S3.SS3.p1.1.m1.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.p1.1.m1.4.4.1.1.3" xref="S3.SS3.p1.1.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.4b"><apply id="S3.SS3.p1.1.m1.4.4.cmml" xref="S3.SS3.p1.1.m1.4.4"><times id="S3.SS3.p1.1.m1.4.4.2.cmml" xref="S3.SS3.p1.1.m1.4.4.2"></times><ci id="S3.SS3.p1.1.m1.4.4.3.cmml" xref="S3.SS3.p1.1.m1.4.4.3">𝑝</ci><apply id="S3.SS3.p1.1.m1.4.4.1.1.1.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1"><csymbol cd="latexml" id="S3.SS3.p1.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p1.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.4.4.1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.4.4.1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2.2">𝑧</ci><ci id="S3.SS3.p1.1.m1.4.4.1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.2.3">𝑖</ci></apply><list id="S3.SS3.p1.1.m1.4.4.1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.4.4.1.1.1.3.2"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐗</ci><ci id="S3.SS3.p1.1.m1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2">𝒒</ci><ci id="S3.SS3.p1.1.m1.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.4c">p(z_{i}|\boldsymbol{\mathrm{X}},\boldsymbol{q};\theta)</annotation></semantics></math>, is known to be NP-hard <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. Still, there are approximate inference algorithms to solve the problem, such as Mean Field (MF) and Loopy Belief Propagation (LBP). These algorithms take potential functions <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><msub id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">ψ</mi><mi id="S3.SS3.p1.2.m2.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.2.m2.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"></times><apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">𝜓</ci><ci id="S3.SS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\psi_{i}(z_{i})</annotation></semantics></math> and <math id="S3.SS3.p1.3.m3.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS3.p1.3.m3.2a"><mrow id="S3.SS3.p1.3.m3.2.2" xref="S3.SS3.p1.3.m3.2.2.cmml"><msub id="S3.SS3.p1.3.m3.2.2.4" xref="S3.SS3.p1.3.m3.2.2.4.cmml"><mi id="S3.SS3.p1.3.m3.2.2.4.2" xref="S3.SS3.p1.3.m3.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS3.p1.3.m3.2.2.4.3" xref="S3.SS3.p1.3.m3.2.2.4.3.cmml"><mi id="S3.SS3.p1.3.m3.2.2.4.3.2" xref="S3.SS3.p1.3.m3.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.2.2.4.3.1" xref="S3.SS3.p1.3.m3.2.2.4.3.1.cmml">​</mo><mi id="S3.SS3.p1.3.m3.2.2.4.3.3" xref="S3.SS3.p1.3.m3.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.2.2.3" xref="S3.SS3.p1.3.m3.2.2.3.cmml">​</mo><mrow id="S3.SS3.p1.3.m3.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.2.2.2.2.3" xref="S3.SS3.p1.3.m3.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p1.3.m3.1.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p1.3.m3.1.1.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p1.3.m3.2.2.2.2.4" xref="S3.SS3.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p1.3.m3.2.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.3.m3.2.2.2.2.2.2" xref="S3.SS3.p1.3.m3.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.p1.3.m3.2.2.2.2.2.3" xref="S3.SS3.p1.3.m3.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.p1.3.m3.2.2.2.2.5" xref="S3.SS3.p1.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.2b"><apply id="S3.SS3.p1.3.m3.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2"><times id="S3.SS3.p1.3.m3.2.2.3.cmml" xref="S3.SS3.p1.3.m3.2.2.3"></times><apply id="S3.SS3.p1.3.m3.2.2.4.cmml" xref="S3.SS3.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.2.2.4.1.cmml" xref="S3.SS3.p1.3.m3.2.2.4">subscript</csymbol><ci id="S3.SS3.p1.3.m3.2.2.4.2.cmml" xref="S3.SS3.p1.3.m3.2.2.4.2">𝜓</ci><apply id="S3.SS3.p1.3.m3.2.2.4.3.cmml" xref="S3.SS3.p1.3.m3.2.2.4.3"><times id="S3.SS3.p1.3.m3.2.2.4.3.1.cmml" xref="S3.SS3.p1.3.m3.2.2.4.3.1"></times><ci id="S3.SS3.p1.3.m3.2.2.4.3.2.cmml" xref="S3.SS3.p1.3.m3.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.p1.3.m3.2.2.4.3.3.cmml" xref="S3.SS3.p1.3.m3.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS3.p1.3.m3.2.2.2.3.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2"><apply id="S3.SS3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.3.m3.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.2c">\psi_{ij}(z_{i},z_{j})</annotation></semantics></math> as inputs and update <math id="S3.SS3.p1.4.m4.4" class="ltx_Math" alttext="p(z_{i}|\boldsymbol{\mathrm{X}},\boldsymbol{q};\theta)" display="inline"><semantics id="S3.SS3.p1.4.m4.4a"><mrow id="S3.SS3.p1.4.m4.4.4" xref="S3.SS3.p1.4.m4.4.4.cmml"><mi id="S3.SS3.p1.4.m4.4.4.3" xref="S3.SS3.p1.4.m4.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.4.4.2" xref="S3.SS3.p1.4.m4.4.4.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m4.4.4.1.1" xref="S3.SS3.p1.4.m4.4.4.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m4.4.4.1.1.2" xref="S3.SS3.p1.4.m4.4.4.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.4.m4.4.4.1.1.1" xref="S3.SS3.p1.4.m4.4.4.1.1.1.cmml"><msub id="S3.SS3.p1.4.m4.4.4.1.1.1.2" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2.cmml"><mi id="S3.SS3.p1.4.m4.4.4.1.1.1.2.2" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2.2.cmml">z</mi><mi id="S3.SS3.p1.4.m4.4.4.1.1.1.2.3" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS3.p1.4.m4.4.4.1.1.1.1" xref="S3.SS3.p1.4.m4.4.4.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.p1.4.m4.4.4.1.1.1.3.2" xref="S3.SS3.p1.4.m4.4.4.1.1.1.3.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">𝐗</mi><mo id="S3.SS3.p1.4.m4.4.4.1.1.1.3.2.1" xref="S3.SS3.p1.4.m4.4.4.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.p1.4.m4.2.2" xref="S3.SS3.p1.4.m4.2.2.cmml">𝒒</mi><mo id="S3.SS3.p1.4.m4.4.4.1.1.1.3.2.2" xref="S3.SS3.p1.4.m4.4.4.1.1.1.3.1.cmml">;</mo><mi id="S3.SS3.p1.4.m4.3.3" xref="S3.SS3.p1.4.m4.3.3.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.p1.4.m4.4.4.1.1.3" xref="S3.SS3.p1.4.m4.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.4b"><apply id="S3.SS3.p1.4.m4.4.4.cmml" xref="S3.SS3.p1.4.m4.4.4"><times id="S3.SS3.p1.4.m4.4.4.2.cmml" xref="S3.SS3.p1.4.m4.4.4.2"></times><ci id="S3.SS3.p1.4.m4.4.4.3.cmml" xref="S3.SS3.p1.4.m4.4.4.3">𝑝</ci><apply id="S3.SS3.p1.4.m4.4.4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1"><csymbol cd="latexml" id="S3.SS3.p1.4.m4.4.4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1.1.1">conditional</csymbol><apply id="S3.SS3.p1.4.m4.4.4.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.4.4.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.4.m4.4.4.1.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2.2">𝑧</ci><ci id="S3.SS3.p1.4.m4.4.4.1.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1.1.2.3">𝑖</ci></apply><list id="S3.SS3.p1.4.m4.4.4.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.4.4.1.1.1.3.2"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝐗</ci><ci id="S3.SS3.p1.4.m4.2.2.cmml" xref="S3.SS3.p1.4.m4.2.2">𝒒</ci><ci id="S3.SS3.p1.4.m4.3.3.cmml" xref="S3.SS3.p1.4.m4.3.3">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.4c">p(z_{i}|\boldsymbol{\mathrm{X}},\boldsymbol{q};\theta)</annotation></semantics></math> iteratively through message passing. We train neural networks to predict optimal <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><msub id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.3.2" xref="S3.SS3.p1.5.m5.1.1.3.2.cmml">ψ</mi><mi id="S3.SS3.p1.5.m5.1.1.3.3" xref="S3.SS3.p1.5.m5.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.1.1.1.1.2" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.5.m5.1.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.1.1.1.2" xref="S3.SS3.p1.5.m5.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p1.5.m5.1.1.1.1.1.3" xref="S3.SS3.p1.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p1.5.m5.1.1.1.1.3" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><times id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2"></times><apply id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.3.2">𝜓</ci><ci id="S3.SS3.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\psi_{i}(z_{i})</annotation></semantics></math> and <math id="S3.SS3.p1.6.m6.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS3.p1.6.m6.2a"><mrow id="S3.SS3.p1.6.m6.2.2" xref="S3.SS3.p1.6.m6.2.2.cmml"><msub id="S3.SS3.p1.6.m6.2.2.4" xref="S3.SS3.p1.6.m6.2.2.4.cmml"><mi id="S3.SS3.p1.6.m6.2.2.4.2" xref="S3.SS3.p1.6.m6.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS3.p1.6.m6.2.2.4.3" xref="S3.SS3.p1.6.m6.2.2.4.3.cmml"><mi id="S3.SS3.p1.6.m6.2.2.4.3.2" xref="S3.SS3.p1.6.m6.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m6.2.2.4.3.1" xref="S3.SS3.p1.6.m6.2.2.4.3.1.cmml">​</mo><mi id="S3.SS3.p1.6.m6.2.2.4.3.3" xref="S3.SS3.p1.6.m6.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m6.2.2.3" xref="S3.SS3.p1.6.m6.2.2.3.cmml">​</mo><mrow id="S3.SS3.p1.6.m6.2.2.2.2" xref="S3.SS3.p1.6.m6.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.2.2.2.2.3" xref="S3.SS3.p1.6.m6.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p1.6.m6.1.1.1.1.1" xref="S3.SS3.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.1.1.1.2" xref="S3.SS3.p1.6.m6.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.p1.6.m6.1.1.1.1.1.3" xref="S3.SS3.p1.6.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p1.6.m6.2.2.2.2.4" xref="S3.SS3.p1.6.m6.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p1.6.m6.2.2.2.2.2" xref="S3.SS3.p1.6.m6.2.2.2.2.2.cmml"><mi id="S3.SS3.p1.6.m6.2.2.2.2.2.2" xref="S3.SS3.p1.6.m6.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.p1.6.m6.2.2.2.2.2.3" xref="S3.SS3.p1.6.m6.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.p1.6.m6.2.2.2.2.5" xref="S3.SS3.p1.6.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.2b"><apply id="S3.SS3.p1.6.m6.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2"><times id="S3.SS3.p1.6.m6.2.2.3.cmml" xref="S3.SS3.p1.6.m6.2.2.3"></times><apply id="S3.SS3.p1.6.m6.2.2.4.cmml" xref="S3.SS3.p1.6.m6.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.2.2.4.1.cmml" xref="S3.SS3.p1.6.m6.2.2.4">subscript</csymbol><ci id="S3.SS3.p1.6.m6.2.2.4.2.cmml" xref="S3.SS3.p1.6.m6.2.2.4.2">𝜓</ci><apply id="S3.SS3.p1.6.m6.2.2.4.3.cmml" xref="S3.SS3.p1.6.m6.2.2.4.3"><times id="S3.SS3.p1.6.m6.2.2.4.3.1.cmml" xref="S3.SS3.p1.6.m6.2.2.4.3.1"></times><ci id="S3.SS3.p1.6.m6.2.2.4.3.2.cmml" xref="S3.SS3.p1.6.m6.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.p1.6.m6.2.2.4.3.3.cmml" xref="S3.SS3.p1.6.m6.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS3.p1.6.m6.2.2.2.3.cmml" xref="S3.SS3.p1.6.m6.2.2.2.2"><apply id="S3.SS3.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.6.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.p1.6.m6.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.6.m6.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.2c">\psi_{ij}(z_{i},z_{j})</annotation></semantics></math> and then run the algorithms for a fixed number of <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">T</annotation></semantics></math> steps. The iterative algorithms are implemented as recurrent inference layers in the neural network.</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Potential Functions</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">In VQA, the potential functions should depend on both the image and the question. We use low-rank bilinear pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, a parsimonious bilinear model, to capturing the interaction between 2 feature vectors <math id="S3.SS3.SSS1.p1.1.m1.2" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}},\boldsymbol{\mathrm{y}}" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.2a"><mrow id="S3.SS3.SSS1.p1.1.m1.2.3.2" xref="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml"><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S3.SS3.SSS1.p1.1.m1.2.3.2.1" xref="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.p1.1.m1.2.2" xref="S3.SS3.SSS1.p1.1.m1.2.2.cmml">𝐲</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.2b"><list id="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.2.3.2"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝐱</ci><ci id="S3.SS3.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.2.2">𝐲</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.2c">\boldsymbol{\mathrm{x}},\boldsymbol{\mathrm{y}}</annotation></semantics></math>:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="g(\boldsymbol{\mathrm{x}},\boldsymbol{\mathrm{y}};\boldsymbol{\mathrm{P}}_{x},\boldsymbol{\mathrm{P}}_{y})=\mathrm{tanh}(\boldsymbol{\mathrm{P}}_{x}\boldsymbol{\mathrm{x}})\odot\mathrm{tanh}(\boldsymbol{\mathrm{P}}_{y}\boldsymbol{\mathrm{y}})," display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.4" xref="S3.E7.m1.3.3.1.1.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.2.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">(</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">𝐱</mi><mo id="S3.E7.m1.3.3.1.1.2.2.2.4" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">,</mo><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">𝐲</mi><mo id="S3.E7.m1.3.3.1.1.2.2.2.5" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">;</mo><msub id="S3.E7.m1.3.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.cmml">𝐏</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.E7.m1.3.3.1.1.2.2.2.6" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E7.m1.3.3.1.1.2.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2.2.2.2" xref="S3.E7.m1.3.3.1.1.2.2.2.2.2.cmml">𝐏</mi><mi id="S3.E7.m1.3.3.1.1.2.2.2.2.3" xref="S3.E7.m1.3.3.1.1.2.2.2.2.3.cmml">y</mi></msub><mo stretchy="false" id="S3.E7.m1.3.3.1.1.2.2.2.7" xref="S3.E7.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.5" xref="S3.E7.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.4" xref="S3.E7.m1.3.3.1.1.4.cmml"><mrow id="S3.E7.m1.3.3.1.1.3.1" xref="S3.E7.m1.3.3.1.1.3.1.cmml"><mrow id="S3.E7.m1.3.3.1.1.3.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.3.cmml">tanh</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.3.1.1.2" xref="S3.E7.m1.3.3.1.1.3.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.2.cmml">𝐏</mi><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E7.m1.3.3.1.1.3.1.2" xref="S3.E7.m1.3.3.1.1.3.1.2.cmml">⊙</mo><mi id="S3.E7.m1.3.3.1.1.3.1.3" xref="S3.E7.m1.3.3.1.1.3.1.3.cmml">tanh</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.4.3" xref="S3.E7.m1.3.3.1.1.4.3.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.4.2.1" xref="S3.E7.m1.3.3.1.1.4.2.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.4.2.1.2" xref="S3.E7.m1.3.3.1.1.4.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.4.2.1.1" xref="S3.E7.m1.3.3.1.1.4.2.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.4.2.1.1.2" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.4.2.1.1.2.2" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2.2.cmml">𝐏</mi><mi id="S3.E7.m1.3.3.1.1.4.2.1.1.2.3" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2.3.cmml">y</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.4.2.1.1.1" xref="S3.E7.m1.3.3.1.1.4.2.1.1.1.cmml">​</mo><mi id="S3.E7.m1.3.3.1.1.4.2.1.1.3" xref="S3.E7.m1.3.3.1.1.4.2.1.1.3.cmml">𝐲</mi></mrow><mo stretchy="false" id="S3.E7.m1.3.3.1.1.4.2.1.3" xref="S3.E7.m1.3.3.1.1.4.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><eq id="S3.E7.m1.3.3.1.1.5.cmml" xref="S3.E7.m1.3.3.1.1.5"></eq><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><times id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3"></times><ci id="S3.E7.m1.3.3.1.1.2.4.cmml" xref="S3.E7.m1.3.3.1.1.2.4">𝑔</ci><vector id="S3.E7.m1.3.3.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2"><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝐱</ci><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">𝐲</ci><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2">𝐏</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.E7.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2.2">𝐏</ci><ci id="S3.E7.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.2.2.2.3">𝑦</ci></apply></vector></apply><apply id="S3.E7.m1.3.3.1.1.4.cmml" xref="S3.E7.m1.3.3.1.1.4"><times id="S3.E7.m1.3.3.1.1.4.3.cmml" xref="S3.E7.m1.3.3.1.1.4.3"></times><apply id="S3.E7.m1.3.3.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1"><csymbol cd="latexml" id="S3.E7.m1.3.3.1.1.3.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2">direct-product</csymbol><apply id="S3.E7.m1.3.3.1.1.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1"><times id="S3.E7.m1.3.3.1.1.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.2"></times><ci id="S3.E7.m1.3.3.1.1.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.3">tanh</ci><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.1"></times><apply id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.2">𝐏</ci><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.2.3">𝑥</ci></apply><ci id="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.1.1.1.1.3">𝐱</ci></apply></apply><ci id="S3.E7.m1.3.3.1.1.3.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.3">tanh</ci></apply><apply id="S3.E7.m1.3.3.1.1.4.2.1.1.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1"><times id="S3.E7.m1.3.3.1.1.4.2.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1.1.1"></times><apply id="S3.E7.m1.3.3.1.1.4.2.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.4.2.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.4.2.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2.2">𝐏</ci><ci id="S3.E7.m1.3.3.1.1.4.2.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1.1.2.3">𝑦</ci></apply><ci id="S3.E7.m1.3.3.1.1.4.2.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.4.2.1.1.3">𝐲</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">g(\boldsymbol{\mathrm{x}},\boldsymbol{\mathrm{y}};\boldsymbol{\mathrm{P}}_{x},\boldsymbol{\mathrm{P}}_{y})=\mathrm{tanh}(\boldsymbol{\mathrm{P}}_{x}\boldsymbol{\mathrm{x}})\odot\mathrm{tanh}(\boldsymbol{\mathrm{P}}_{y}\boldsymbol{\mathrm{y}}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p1.6" class="ltx_p">where <math id="S3.SS3.SSS1.p1.2.m1.2" class="ltx_Math" alttext="\boldsymbol{\mathrm{P}}_{x},\boldsymbol{\mathrm{P}}_{y}" display="inline"><semantics id="S3.SS3.SSS1.p1.2.m1.2a"><mrow id="S3.SS3.SSS1.p1.2.m1.2.2.2" xref="S3.SS3.SSS1.p1.2.m1.2.2.3.cmml"><msub id="S3.SS3.SSS1.p1.2.m1.1.1.1.1" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.2.m1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1.2.cmml">𝐏</mi><mi id="S3.SS3.SSS1.p1.2.m1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.SS3.SSS1.p1.2.m1.2.2.2.3" xref="S3.SS3.SSS1.p1.2.m1.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS1.p1.2.m1.2.2.2.2" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.2.m1.2.2.2.2.2" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2.2.cmml">𝐏</mi><mi id="S3.SS3.SSS1.p1.2.m1.2.2.2.2.3" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2.3.cmml">y</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.2.m1.2b"><list id="S3.SS3.SSS1.p1.2.m1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m1.2.2.2"><apply id="S3.SS3.SSS1.p1.2.m1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1.2">𝐏</ci><ci id="S3.SS3.SSS1.p1.2.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.2.m1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.SS3.SSS1.p1.2.m1.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.2.m1.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.2.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2.2">𝐏</ci><ci id="S3.SS3.SSS1.p1.2.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.2.m1.2.2.2.2.3">𝑦</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.2.m1.2c">\boldsymbol{\mathrm{P}}_{x},\boldsymbol{\mathrm{P}}_{y}</annotation></semantics></math> are learnt projection matrices projecting <math id="S3.SS3.SSS1.p1.3.m2.2" class="ltx_Math" alttext="\boldsymbol{\mathrm{x}},\boldsymbol{\mathrm{y}}" display="inline"><semantics id="S3.SS3.SSS1.p1.3.m2.2a"><mrow id="S3.SS3.SSS1.p1.3.m2.2.3.2" xref="S3.SS3.SSS1.p1.3.m2.2.3.1.cmml"><mi id="S3.SS3.SSS1.p1.3.m2.1.1" xref="S3.SS3.SSS1.p1.3.m2.1.1.cmml">𝐱</mi><mo id="S3.SS3.SSS1.p1.3.m2.2.3.2.1" xref="S3.SS3.SSS1.p1.3.m2.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.p1.3.m2.2.2" xref="S3.SS3.SSS1.p1.3.m2.2.2.cmml">𝐲</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.3.m2.2b"><list id="S3.SS3.SSS1.p1.3.m2.2.3.1.cmml" xref="S3.SS3.SSS1.p1.3.m2.2.3.2"><ci id="S3.SS3.SSS1.p1.3.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.3.m2.1.1">𝐱</ci><ci id="S3.SS3.SSS1.p1.3.m2.2.2.cmml" xref="S3.SS3.SSS1.p1.3.m2.2.2">𝐲</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.3.m2.2c">\boldsymbol{\mathrm{x}},\boldsymbol{\mathrm{y}}</annotation></semantics></math> to the same dimension, and <math id="S3.SS3.SSS1.p1.4.m3.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS3.SSS1.p1.4.m3.1a"><mo id="S3.SS3.SSS1.p1.4.m3.1.1" xref="S3.SS3.SSS1.p1.4.m3.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.4.m3.1b"><csymbol cd="latexml" id="S3.SS3.SSS1.p1.4.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.4.m3.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.4.m3.1c">\odot</annotation></semantics></math> represents Hadamard product.
Based on this, we model <math id="S3.SS3.SSS1.p1.5.m4.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S3.SS3.SSS1.p1.5.m4.1a"><mrow id="S3.SS3.SSS1.p1.5.m4.1.1" xref="S3.SS3.SSS1.p1.5.m4.1.1.cmml"><msub id="S3.SS3.SSS1.p1.5.m4.1.1.3" xref="S3.SS3.SSS1.p1.5.m4.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.5.m4.1.1.3.2" xref="S3.SS3.SSS1.p1.5.m4.1.1.3.2.cmml">ψ</mi><mi id="S3.SS3.SSS1.p1.5.m4.1.1.3.3" xref="S3.SS3.SSS1.p1.5.m4.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.5.m4.1.1.2" xref="S3.SS3.SSS1.p1.5.m4.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.5.m4.1.1.1.1" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.2" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.3" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.5.m4.1b"><apply id="S3.SS3.SSS1.p1.5.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1"><times id="S3.SS3.SSS1.p1.5.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.2"></times><apply id="S3.SS3.SSS1.p1.5.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m4.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.5.m4.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.3.2">𝜓</ci><ci id="S3.SS3.SSS1.p1.5.m4.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.5.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.5.m4.1c">\psi_{i}(z_{i})</annotation></semantics></math> and <math id="S3.SS3.SSS1.p1.6.m5.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS3.SSS1.p1.6.m5.2a"><mrow id="S3.SS3.SSS1.p1.6.m5.2.2" xref="S3.SS3.SSS1.p1.6.m5.2.2.cmml"><msub id="S3.SS3.SSS1.p1.6.m5.2.2.4" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.cmml"><mi id="S3.SS3.SSS1.p1.6.m5.2.2.4.2" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS3.SSS1.p1.6.m5.2.2.4.3" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.cmml"><mi id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.2" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.1" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.3" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.6.m5.2.2.3" xref="S3.SS3.SSS1.p1.6.m5.2.2.3.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.6.m5.2.2.2.2" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.3" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.4" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.5" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.6.m5.2b"><apply id="S3.SS3.SSS1.p1.6.m5.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2"><times id="S3.SS3.SSS1.p1.6.m5.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.3"></times><apply id="S3.SS3.SSS1.p1.6.m5.2.2.4.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m5.2.2.4.1.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m5.2.2.4.2.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.2">𝜓</ci><apply id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3"><times id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.1.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.1"></times><ci id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.2.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.6.m5.2.2.4.3.3.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS3.SSS1.p1.6.m5.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2"><apply id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.6.m5.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.6.m5.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.6.m5.2c">\psi_{ij}(z_{i},z_{j})</annotation></semantics></math> as following:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="\psi_{i}(z_{i}=1)=\sigma\left(\boldsymbol{\mathrm{U}}g\left(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q};\boldsymbol{\mathrm{U}}_{x},\boldsymbol{\mathrm{U}}_{q}\right)\right)," display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E8.m1.2.2.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml"><mi id="S3.E8.m1.2.2.1.1.2.3" xref="S3.E8.m1.2.2.1.1.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.2" xref="S3.E8.m1.2.2.1.1.2.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.2.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.cmml"><mo id="S3.E8.m1.2.2.1.1.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.5" xref="S3.E8.m1.2.2.1.1.2.1.1.1.5.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.1.1.4" xref="S3.E8.m1.2.2.1.1.2.1.1.1.4.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.6" xref="S3.E8.m1.2.2.1.1.2.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.2.1.1.1.4a" xref="S3.E8.m1.2.2.1.1.2.1.1.1.4.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml"><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.4" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.5" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml">,</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">𝒒</mi><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.6" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml">;</mo><msub id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.2.cmml">𝐔</mi><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.3.cmml">x</mi></msub><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.7" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml">,</mo><msub id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.cmml"><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.2" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.2.cmml">𝐔</mi><mi id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.3.cmml">q</mi></msub><mo id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.8" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.2.2.1.1.2.1.1.3" xref="S3.E8.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.2.2.1.2" xref="S3.E8.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1"><eq id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"></eq><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></times><apply id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.3.2">𝜓</ci><ci id="S3.E8.m1.2.2.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1"><eq id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1"></eq><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"><times id="S3.E8.m1.2.2.1.1.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.2"></times><ci id="S3.E8.m1.2.2.1.1.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.3">𝜎</ci><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1"><times id="S3.E8.m1.2.2.1.1.2.1.1.1.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.4"></times><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.5.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.5">𝐔</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.6.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.6">𝑔</ci><vector id="S3.E8.m1.2.2.1.1.2.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3"><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝒒</ci><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.2">𝐔</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.2.2.2.3">𝑥</ci></apply><apply id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.2">𝐔</ci><ci id="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.3.cmml" xref="S3.E8.m1.2.2.1.1.2.1.1.1.3.3.3.3">𝑞</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">\psi_{i}(z_{i}=1)=\sigma\left(\boldsymbol{\mathrm{U}}g\left(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q};\boldsymbol{\mathrm{U}}_{x},\boldsymbol{\mathrm{U}}_{q}\right)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\psi_{i}(z_{i}=0)=1-\psi_{i}(z_{i}=1)," display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.E9.m1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml"><mn id="S3.E9.m1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.2.3.cmml">1</mn><mo id="S3.E9.m1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.2.2.cmml">−</mo><mrow id="S3.E9.m1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.2.1.cmml"><msub id="S3.E9.m1.1.1.1.1.2.1.3" xref="S3.E9.m1.1.1.1.1.2.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.2.1.3.2" xref="S3.E9.m1.1.1.1.1.2.1.3.2.cmml">ψ</mi><mi id="S3.E9.m1.1.1.1.1.2.1.3.3" xref="S3.E9.m1.1.1.1.1.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.1.2" xref="S3.E9.m1.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.2.1.1.1" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.2.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.2.1.1.1.1" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E9.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.1.cmml">=</mo><mn id="S3.E9.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.2.1.1.1.3" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"></eq><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"></times><apply id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2">𝜓</ci><ci id="S3.E9.m1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"><minus id="S3.E9.m1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.2.2"></minus><cn type="integer" id="S3.E9.m1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3">1</cn><apply id="S3.E9.m1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2.1"><times id="S3.E9.m1.1.1.1.1.2.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2.1.2"></times><apply id="S3.E9.m1.1.1.1.1.2.1.3.cmml" xref="S3.E9.m1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.2.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.2.1.3.2">𝜓</ci><ci id="S3.E9.m1.1.1.1.1.2.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.2.1.3.3">𝑖</ci></apply><apply id="S3.E9.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1"><eq id="S3.E9.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.1"></eq><apply id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.2">𝑧</ci><ci id="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.E9.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.2.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\psi_{i}(z_{i}=0)=1-\psi_{i}(z_{i}=1),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})=h\left(\boldsymbol{\mathrm{v}}_{z_{i}z_{j}}g\left(\boldsymbol{\mathrm{y}}_{ij},\boldsymbol{q};\boldsymbol{\mathrm{V}}_{y},\boldsymbol{\mathrm{V}}_{q}\right)\right)," display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.2" xref="S3.E10.m1.2.2.1.1.2.cmml"><msub id="S3.E10.m1.2.2.1.1.2.4" xref="S3.E10.m1.2.2.1.1.2.4.cmml"><mi id="S3.E10.m1.2.2.1.1.2.4.2" xref="S3.E10.m1.2.2.1.1.2.4.2.cmml">ψ</mi><mrow id="S3.E10.m1.2.2.1.1.2.4.3" xref="S3.E10.m1.2.2.1.1.2.4.3.cmml"><mi id="S3.E10.m1.2.2.1.1.2.4.3.2" xref="S3.E10.m1.2.2.1.1.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.2.4.3.1" xref="S3.E10.m1.2.2.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.2.4.3.3" xref="S3.E10.m1.2.2.1.1.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.2.3" xref="S3.E10.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.2.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E10.m1.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.2.2.1.1.2.2.2.4" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.1.1.2.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.1.1.2.2.2.2.2" xref="S3.E10.m1.2.2.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E10.m1.2.2.1.1.2.2.2.2.3" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E10.m1.2.2.1.1.2.2.2.5" xref="S3.E10.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.4" xref="S3.E10.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E10.m1.2.2.1.1.3" xref="S3.E10.m1.2.2.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.3.3" xref="S3.E10.m1.2.2.1.1.3.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.3.2" xref="S3.E10.m1.2.2.1.1.3.2.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.3.1.1" xref="S3.E10.m1.2.2.1.1.3.1.1.1.cmml"><mo id="S3.E10.m1.2.2.1.1.3.1.1.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.3.1.1.1" xref="S3.E10.m1.2.2.1.1.3.1.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.3.1.1.1.5" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.5.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.2.cmml">𝐯</mi><mrow id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.cmml"><msub id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.2.cmml">z</mi><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.1" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.1.cmml">​</mo><msub id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.2.cmml">z</mi><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.3.cmml">j</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.3.1.1.1.4" xref="S3.E10.m1.2.2.1.1.3.1.1.1.4.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.6" xref="S3.E10.m1.2.2.1.1.3.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.3.1.1.1.4a" xref="S3.E10.m1.2.2.1.1.3.1.1.1.4.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml"><mo id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.4" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml">(</mo><msub id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.1" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.5" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml">,</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">𝒒</mi><mo id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.6" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml">;</mo><msub id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.2.cmml">𝐕</mi><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.3.cmml">y</mi></msub><mo id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.7" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml">,</mo><msub id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.cmml"><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.2" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.2.cmml">𝐕</mi><mi id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.3.cmml">q</mi></msub><mo id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.8" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.3.1.1.3" xref="S3.E10.m1.2.2.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.2.2.1.2" xref="S3.E10.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1"><eq id="S3.E10.m1.2.2.1.1.4.cmml" xref="S3.E10.m1.2.2.1.1.4"></eq><apply id="S3.E10.m1.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.2"><times id="S3.E10.m1.2.2.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.3"></times><apply id="S3.E10.m1.2.2.1.1.2.4.cmml" xref="S3.E10.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.4.1.cmml" xref="S3.E10.m1.2.2.1.1.2.4">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.4.2.cmml" xref="S3.E10.m1.2.2.1.1.2.4.2">𝜓</ci><apply id="S3.E10.m1.2.2.1.1.2.4.3.cmml" xref="S3.E10.m1.2.2.1.1.2.4.3"><times id="S3.E10.m1.2.2.1.1.2.4.3.1.cmml" xref="S3.E10.m1.2.2.1.1.2.4.3.1"></times><ci id="S3.E10.m1.2.2.1.1.2.4.3.2.cmml" xref="S3.E10.m1.2.2.1.1.2.4.3.2">𝑖</ci><ci id="S3.E10.m1.2.2.1.1.2.4.3.3.cmml" xref="S3.E10.m1.2.2.1.1.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.E10.m1.2.2.1.1.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2"><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E10.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E10.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E10.m1.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3"><times id="S3.E10.m1.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.2"></times><ci id="S3.E10.m1.2.2.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.3">ℎ</ci><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1"><times id="S3.E10.m1.2.2.1.1.3.1.1.1.4.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.4"></times><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.5.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.1.1.1.5.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.5.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.2">𝐯</ci><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3"><times id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.1"></times><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.2">𝑧</ci><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.2.3">𝑖</ci></apply><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.2">𝑧</ci><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.5.3.3.3">𝑗</ci></apply></apply></apply><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.6.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.6">𝑔</ci><vector id="S3.E10.m1.2.2.1.1.3.1.1.1.3.4.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3"><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.2">𝐲</ci><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3"><times id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.1"></times><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝒒</ci><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.2">𝐕</ci><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.2.2.2.3">𝑦</ci></apply><apply id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.1.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.2.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.2">𝐕</ci><ci id="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.3.1.1.1.3.3.3.3">𝑞</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\psi_{ij}(z_{i},z_{j})=h\left(\boldsymbol{\mathrm{v}}_{z_{i}z_{j}}g\left(\boldsymbol{\mathrm{y}}_{ij},\boldsymbol{q};\boldsymbol{\mathrm{V}}_{y},\boldsymbol{\mathrm{V}}_{q}\right)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS1.p1.14" class="ltx_p">where <math id="S3.SS3.SSS1.p1.7.m1.2" class="ltx_Math" alttext="\boldsymbol{\mathrm{U}}_{x}\in\mathbb{R}^{n_{c}\times n_{I}},\boldsymbol{\mathrm{U}}_{q}\in\mathbb{R}^{n_{c}\times n_{Q}},\leavevmode\nobreak\ \boldsymbol{\mathrm{U}}\in\mathbb{R}^{1\times n_{c}},\boldsymbol{\mathrm{V}}_{y}\in\mathbb{R}^{n_{c}\times 2n_{I}},\boldsymbol{\mathrm{V}}_{q}\in\mathbb{R}^{n_{c}\times n_{Q}}" display="inline"><semantics id="S3.SS3.SSS1.p1.7.m1.2a"><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.3.cmml"><mrow id="S3.SS3.SSS1.p1.7.m1.1.1.1.1" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.2.cmml">𝐔</mi><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.3.cmml">x</mi></msub><mo id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.2" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.2" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.3" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.1" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.3.cmml">I</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.3a.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.3.cmml"><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.2.cmml">𝐔</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.3.cmml">q</mi></msub><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.3.cmml">Q</mi></msub></mrow></msup></mrow><mo rspace="0.667em" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.3.cmml"><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.2.cmml">𝐔</mi><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.cmml"><mn id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.3.cmml"><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.2.cmml">𝐕</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.3.cmml">y</mi></msub><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml"><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.1.cmml">×</mo><mn id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.1.cmml">​</mo><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.3.cmml">I</mi></msub></mrow></msup></mrow><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.3.cmml">q</mi></msub><mo id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.cmml"><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.1" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.2" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.3" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.3.cmml">Q</mi></msub></mrow></msup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.7.m1.2b"><apply id="S3.SS3.SSS1.p1.7.m1.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.3a.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1"><in id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.1"></in><apply id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.2">𝐔</ci><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.2.3">𝑥</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3"><times id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.1"></times><apply id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.2.3">𝑐</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.1.1.1.1.3.3.3.3">𝐼</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.3a.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1"><in id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.1"></in><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.2">𝐔</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.2.3">𝑞</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3"><times id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.1"></times><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.2.3">𝑐</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.1.1.3.3.3.3">𝑄</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.3a.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1"><in id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.1"></in><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.2">𝐔</ci><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3"><times id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.1"></times><cn type="integer" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.2">1</cn><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.3a.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1"><in id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.1"></in><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.2">𝐕</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.2.3">𝑦</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3"><times id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.1"></times><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2"><times id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.1"></times><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.2.3">2</cn></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.1.1.3.3.3.3">𝐼</ci></apply></apply></apply></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2"><in id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.1"></in><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.2">𝐕</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.2.3">𝑞</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3"><times id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.1"></times><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.2.3">𝑐</ci></apply><apply id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.7.m1.2.2.2.2.2.2.2.2.2.2.3.3.3.3">𝑄</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.7.m1.2c">\boldsymbol{\mathrm{U}}_{x}\in\mathbb{R}^{n_{c}\times n_{I}},\boldsymbol{\mathrm{U}}_{q}\in\mathbb{R}^{n_{c}\times n_{Q}},\leavevmode\nobreak\ \boldsymbol{\mathrm{U}}\in\mathbb{R}^{1\times n_{c}},\boldsymbol{\mathrm{V}}_{y}\in\mathbb{R}^{n_{c}\times 2n_{I}},\boldsymbol{\mathrm{V}}_{q}\in\mathbb{R}^{n_{c}\times n_{Q}}</annotation></semantics></math> are learnt projection matrices, <math id="S3.SS3.SSS1.p1.8.m2.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{v}}_{z_{i}z_{j}}" display="inline"><semantics id="S3.SS3.SSS1.p1.8.m2.1a"><msub id="S3.SS3.SSS1.p1.8.m2.1.1" xref="S3.SS3.SSS1.p1.8.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p1.8.m2.1.1.2" xref="S3.SS3.SSS1.p1.8.m2.1.1.2.cmml">𝐯</mi><mrow id="S3.SS3.SSS1.p1.8.m2.1.1.3" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.cmml"><msub id="S3.SS3.SSS1.p1.8.m2.1.1.3.2" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2.cmml"><mi id="S3.SS3.SSS1.p1.8.m2.1.1.3.2.2" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.8.m2.1.1.3.2.3" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.8.m2.1.1.3.1" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.1.cmml">​</mo><msub id="S3.SS3.SSS1.p1.8.m2.1.1.3.3" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3.cmml"><mi id="S3.SS3.SSS1.p1.8.m2.1.1.3.3.2" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.8.m2.1.1.3.3.3" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3.3.cmml">j</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.8.m2.1b"><apply id="S3.SS3.SSS1.p1.8.m2.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.2">𝐯</ci><apply id="S3.SS3.SSS1.p1.8.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3"><times id="S3.SS3.SSS1.p1.8.m2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.1"></times><apply id="S3.SS3.SSS1.p1.8.m2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m2.1.1.3.2.1.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m2.1.1.3.2.2.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.8.m2.1.1.3.2.3.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.p1.8.m2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.8.m2.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.8.m2.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.8.m2.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.8.m2.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.8.m2.1c">\boldsymbol{\mathrm{v}}_{z_{i}z_{j}}</annotation></semantics></math> is a row vector of <math id="S3.SS3.SSS1.p1.9.m3.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{V}}\in\mathbb{R}^{4\times n_{c}}" display="inline"><semantics id="S3.SS3.SSS1.p1.9.m3.1a"><mrow id="S3.SS3.SSS1.p1.9.m3.1.1" xref="S3.SS3.SSS1.p1.9.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p1.9.m3.1.1.2" xref="S3.SS3.SSS1.p1.9.m3.1.1.2.cmml">𝐕</mi><mo id="S3.SS3.SSS1.p1.9.m3.1.1.1" xref="S3.SS3.SSS1.p1.9.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p1.9.m3.1.1.3" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m3.1.1.3.2" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.SSS1.p1.9.m3.1.1.3.3" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.cmml"><mn id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.2" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.1" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.2" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.3" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.9.m3.1b"><apply id="S3.SS3.SSS1.p1.9.m3.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1"><in id="S3.SS3.SSS1.p1.9.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.1"></in><ci id="S3.SS3.SSS1.p1.9.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.2">𝐕</ci><apply id="S3.SS3.SSS1.p1.9.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m3.1.1.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m3.1.1.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3"><times id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.1"></times><cn type="integer" id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.2">4</cn><apply id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS1.p1.9.m3.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.9.m3.1c">\boldsymbol{\mathrm{V}}\in\mathbb{R}^{4\times n_{c}}</annotation></semantics></math> indexed by <math id="S3.SS3.SSS1.p1.10.m4.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS3.SSS1.p1.10.m4.1a"><msub id="S3.SS3.SSS1.p1.10.m4.1.1" xref="S3.SS3.SSS1.p1.10.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p1.10.m4.1.1.2" xref="S3.SS3.SSS1.p1.10.m4.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.10.m4.1.1.3" xref="S3.SS3.SSS1.p1.10.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.10.m4.1b"><apply id="S3.SS3.SSS1.p1.10.m4.1.1.cmml" xref="S3.SS3.SSS1.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.10.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p1.10.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.10.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p1.10.m4.1.1.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.10.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p1.10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.10.m4.1c">z_{i}</annotation></semantics></math> and <math id="S3.SS3.SSS1.p1.11.m5.1" class="ltx_Math" alttext="z_{j}" display="inline"><semantics id="S3.SS3.SSS1.p1.11.m5.1a"><msub id="S3.SS3.SSS1.p1.11.m5.1.1" xref="S3.SS3.SSS1.p1.11.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p1.11.m5.1.1.2" xref="S3.SS3.SSS1.p1.11.m5.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS1.p1.11.m5.1.1.3" xref="S3.SS3.SSS1.p1.11.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.11.m5.1b"><apply id="S3.SS3.SSS1.p1.11.m5.1.1.cmml" xref="S3.SS3.SSS1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.11.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p1.11.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.11.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p1.11.m5.1.1.2">𝑧</ci><ci id="S3.SS3.SSS1.p1.11.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p1.11.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.11.m5.1c">z_{j}</annotation></semantics></math>, <math id="S3.SS3.SSS1.p1.12.m6.2" class="ltx_Math" alttext="\boldsymbol{\mathrm{y}}_{ij}=[\boldsymbol{\mathrm{x}}_{i}^{T},\boldsymbol{\mathrm{x}}_{j}^{T}]^{T}" display="inline"><semantics id="S3.SS3.SSS1.p1.12.m6.2a"><mrow id="S3.SS3.SSS1.p1.12.m6.2.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.cmml"><msub id="S3.SS3.SSS1.p1.12.m6.2.2.4" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.cmml"><mi id="S3.SS3.SSS1.p1.12.m6.2.2.4.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.2.cmml">𝐲</mi><mrow id="S3.SS3.SSS1.p1.12.m6.2.2.4.3" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.cmml"><mi id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.1" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.3" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.SSS1.p1.12.m6.2.2.3" xref="S3.SS3.SSS1.p1.12.m6.2.2.3.cmml">=</mo><msup id="S3.SS3.SSS1.p1.12.m6.2.2.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.cmml"><mrow id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.3.cmml">[</mo><msubsup id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.3" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.3.cmml">T</mi></msubsup><mo id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.4" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.3.cmml">,</mo><msubsup id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.2.cmml">𝐱</mi><mi id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.3.cmml">j</mi><mi id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.3" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.3.cmml">T</mi></msubsup><mo stretchy="false" id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.5" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.3.cmml">]</mo></mrow><mi id="S3.SS3.SSS1.p1.12.m6.2.2.2.4" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.4.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.12.m6.2b"><apply id="S3.SS3.SSS1.p1.12.m6.2.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2"><eq id="S3.SS3.SSS1.p1.12.m6.2.2.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.3"></eq><apply id="S3.SS3.SSS1.p1.12.m6.2.2.4.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m6.2.2.4.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS1.p1.12.m6.2.2.4.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.2">𝐲</ci><apply id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3"><times id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.1"></times><ci id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.SSS1.p1.12.m6.2.2.4.3.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.4.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.SSS1.p1.12.m6.2.2.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m6.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2">superscript</csymbol><interval closure="closed" id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2"><apply id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.2">𝐱</ci><ci id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.2.2.2.3">𝑇</ci></apply></interval><ci id="S3.SS3.SSS1.p1.12.m6.2.2.2.4.cmml" xref="S3.SS3.SSS1.p1.12.m6.2.2.2.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.12.m6.2c">\boldsymbol{\mathrm{y}}_{ij}=[\boldsymbol{\mathrm{x}}_{i}^{T},\boldsymbol{\mathrm{x}}_{j}^{T}]^{T}</annotation></semantics></math>, <math id="S3.SS3.SSS1.p1.13.m7.1" class="ltx_Math" alttext="n_{c}" display="inline"><semantics id="S3.SS3.SSS1.p1.13.m7.1a"><msub id="S3.SS3.SSS1.p1.13.m7.1.1" xref="S3.SS3.SSS1.p1.13.m7.1.1.cmml"><mi id="S3.SS3.SSS1.p1.13.m7.1.1.2" xref="S3.SS3.SSS1.p1.13.m7.1.1.2.cmml">n</mi><mi id="S3.SS3.SSS1.p1.13.m7.1.1.3" xref="S3.SS3.SSS1.p1.13.m7.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.13.m7.1b"><apply id="S3.SS3.SSS1.p1.13.m7.1.1.cmml" xref="S3.SS3.SSS1.p1.13.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p1.13.m7.1.1.1.cmml" xref="S3.SS3.SSS1.p1.13.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p1.13.m7.1.1.2.cmml" xref="S3.SS3.SSS1.p1.13.m7.1.1.2">𝑛</ci><ci id="S3.SS3.SSS1.p1.13.m7.1.1.3.cmml" xref="S3.SS3.SSS1.p1.13.m7.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.13.m7.1c">n_{c}</annotation></semantics></math> is the common projection dimension, <math id="S3.SS3.SSS1.p1.14.m8.1" class="ltx_Math" alttext="h(\cdot)" display="inline"><semantics id="S3.SS3.SSS1.p1.14.m8.1a"><mrow id="S3.SS3.SSS1.p1.14.m8.1.2" xref="S3.SS3.SSS1.p1.14.m8.1.2.cmml"><mi id="S3.SS3.SSS1.p1.14.m8.1.2.2" xref="S3.SS3.SSS1.p1.14.m8.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.14.m8.1.2.1" xref="S3.SS3.SSS1.p1.14.m8.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS1.p1.14.m8.1.2.3.2" xref="S3.SS3.SSS1.p1.14.m8.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.14.m8.1.2.3.2.1" xref="S3.SS3.SSS1.p1.14.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.SSS1.p1.14.m8.1.1" xref="S3.SS3.SSS1.p1.14.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.SSS1.p1.14.m8.1.2.3.2.2" xref="S3.SS3.SSS1.p1.14.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.14.m8.1b"><apply id="S3.SS3.SSS1.p1.14.m8.1.2.cmml" xref="S3.SS3.SSS1.p1.14.m8.1.2"><times id="S3.SS3.SSS1.p1.14.m8.1.2.1.cmml" xref="S3.SS3.SSS1.p1.14.m8.1.2.1"></times><ci id="S3.SS3.SSS1.p1.14.m8.1.2.2.cmml" xref="S3.SS3.SSS1.p1.14.m8.1.2.2">ℎ</ci><ci id="S3.SS3.SSS1.p1.14.m8.1.1.cmml" xref="S3.SS3.SSS1.p1.14.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.14.m8.1c">h(\cdot)</annotation></semantics></math> is a certain activation function which will differ in the 2 inference algorithms.</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Mean Field Layers</h4>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg1.6.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> MF Recurrent Layer in VQA</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.2" class="ltx_p ltx_figure_panel"><span id="alg1.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Input:<span id="alg1.2.2.2" class="ltx_text ltx_font_medium">
<math id="alg1.1.1.1.m1.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="alg1.1.1.1.m1.1a"><mrow id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml"><msub id="alg1.1.1.1.m1.1.1.3" xref="alg1.1.1.1.m1.1.1.3.cmml"><mi id="alg1.1.1.1.m1.1.1.3.2" xref="alg1.1.1.1.m1.1.1.3.2.cmml">ψ</mi><mi id="alg1.1.1.1.m1.1.1.3.3" xref="alg1.1.1.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.1.1.1.m1.1.1.2" xref="alg1.1.1.1.m1.1.1.2.cmml">​</mo><mrow id="alg1.1.1.1.m1.1.1.1.1" xref="alg1.1.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.1.1.1.m1.1.1.1.1.2" xref="alg1.1.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="alg1.1.1.1.m1.1.1.1.1.1" xref="alg1.1.1.1.m1.1.1.1.1.1.cmml"><mi id="alg1.1.1.1.m1.1.1.1.1.1.2" xref="alg1.1.1.1.m1.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.1.1.1.m1.1.1.1.1.1.3" xref="alg1.1.1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.1.1.1.m1.1.1.1.1.3" xref="alg1.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.1b"><apply id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1"><times id="alg1.1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.1.m1.1.1.2"></times><apply id="alg1.1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.1.1.3.1.cmml" xref="alg1.1.1.1.m1.1.1.3">subscript</csymbol><ci id="alg1.1.1.1.m1.1.1.3.2.cmml" xref="alg1.1.1.1.m1.1.1.3.2">𝜓</ci><ci id="alg1.1.1.1.m1.1.1.3.3.cmml" xref="alg1.1.1.1.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.1.1.1.m1.1.1.1.1.1.cmml" xref="alg1.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="alg1.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="alg1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="alg1.1.1.1.m1.1.1.1.1.1.2">𝑧</ci><ci id="alg1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="alg1.1.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.1c">\psi_{i}(z_{i})</annotation></semantics></math>, <math id="alg1.2.2.2.m2.2" class="ltx_Math" alttext="\ln\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="alg1.2.2.2.m2.2a"><mrow id="alg1.2.2.2.m2.2.2" xref="alg1.2.2.2.m2.2.2.cmml"><mrow id="alg1.2.2.2.m2.2.2.4" xref="alg1.2.2.2.m2.2.2.4.cmml"><mi id="alg1.2.2.2.m2.2.2.4.1" xref="alg1.2.2.2.m2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="alg1.2.2.2.m2.2.2.4a" xref="alg1.2.2.2.m2.2.2.4.cmml">⁡</mo><msub id="alg1.2.2.2.m2.2.2.4.2" xref="alg1.2.2.2.m2.2.2.4.2.cmml"><mi id="alg1.2.2.2.m2.2.2.4.2.2" xref="alg1.2.2.2.m2.2.2.4.2.2.cmml">ψ</mi><mrow id="alg1.2.2.2.m2.2.2.4.2.3" xref="alg1.2.2.2.m2.2.2.4.2.3.cmml"><mi id="alg1.2.2.2.m2.2.2.4.2.3.2" xref="alg1.2.2.2.m2.2.2.4.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.2.2.2.m2.2.2.4.2.3.1" xref="alg1.2.2.2.m2.2.2.4.2.3.1.cmml">​</mo><mi id="alg1.2.2.2.m2.2.2.4.2.3.3" xref="alg1.2.2.2.m2.2.2.4.2.3.3.cmml">j</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.2.2.2.m2.2.2.3" xref="alg1.2.2.2.m2.2.2.3.cmml">​</mo><mrow id="alg1.2.2.2.m2.2.2.2.2" xref="alg1.2.2.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.2.2.2.m2.2.2.2.2.3" xref="alg1.2.2.2.m2.2.2.2.3.cmml">(</mo><msub id="alg1.2.2.2.m2.1.1.1.1.1" xref="alg1.2.2.2.m2.1.1.1.1.1.cmml"><mi id="alg1.2.2.2.m2.1.1.1.1.1.2" xref="alg1.2.2.2.m2.1.1.1.1.1.2.cmml">z</mi><mi id="alg1.2.2.2.m2.1.1.1.1.1.3" xref="alg1.2.2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.2.2.2.m2.2.2.2.2.4" xref="alg1.2.2.2.m2.2.2.2.3.cmml">,</mo><msub id="alg1.2.2.2.m2.2.2.2.2.2" xref="alg1.2.2.2.m2.2.2.2.2.2.cmml"><mi id="alg1.2.2.2.m2.2.2.2.2.2.2" xref="alg1.2.2.2.m2.2.2.2.2.2.2.cmml">z</mi><mi id="alg1.2.2.2.m2.2.2.2.2.2.3" xref="alg1.2.2.2.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg1.2.2.2.m2.2.2.2.2.5" xref="alg1.2.2.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.m2.2b"><apply id="alg1.2.2.2.m2.2.2.cmml" xref="alg1.2.2.2.m2.2.2"><times id="alg1.2.2.2.m2.2.2.3.cmml" xref="alg1.2.2.2.m2.2.2.3"></times><apply id="alg1.2.2.2.m2.2.2.4.cmml" xref="alg1.2.2.2.m2.2.2.4"><ln id="alg1.2.2.2.m2.2.2.4.1.cmml" xref="alg1.2.2.2.m2.2.2.4.1"></ln><apply id="alg1.2.2.2.m2.2.2.4.2.cmml" xref="alg1.2.2.2.m2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.2.2.2.m2.2.2.4.2.1.cmml" xref="alg1.2.2.2.m2.2.2.4.2">subscript</csymbol><ci id="alg1.2.2.2.m2.2.2.4.2.2.cmml" xref="alg1.2.2.2.m2.2.2.4.2.2">𝜓</ci><apply id="alg1.2.2.2.m2.2.2.4.2.3.cmml" xref="alg1.2.2.2.m2.2.2.4.2.3"><times id="alg1.2.2.2.m2.2.2.4.2.3.1.cmml" xref="alg1.2.2.2.m2.2.2.4.2.3.1"></times><ci id="alg1.2.2.2.m2.2.2.4.2.3.2.cmml" xref="alg1.2.2.2.m2.2.2.4.2.3.2">𝑖</ci><ci id="alg1.2.2.2.m2.2.2.4.2.3.3.cmml" xref="alg1.2.2.2.m2.2.2.4.2.3.3">𝑗</ci></apply></apply></apply><interval closure="open" id="alg1.2.2.2.m2.2.2.2.3.cmml" xref="alg1.2.2.2.m2.2.2.2.2"><apply id="alg1.2.2.2.m2.1.1.1.1.1.cmml" xref="alg1.2.2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.2.2.2.m2.1.1.1.1.1.1.cmml" xref="alg1.2.2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.2.2.2.m2.1.1.1.1.1.2.cmml" xref="alg1.2.2.2.m2.1.1.1.1.1.2">𝑧</ci><ci id="alg1.2.2.2.m2.1.1.1.1.1.3.cmml" xref="alg1.2.2.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.2.2.2.m2.2.2.2.2.2.cmml" xref="alg1.2.2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.2.2.2.m2.2.2.2.2.2.1.cmml" xref="alg1.2.2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.2.2.2.m2.2.2.2.2.2.2.cmml" xref="alg1.2.2.2.m2.2.2.2.2.2.2">𝑧</ci><ci id="alg1.2.2.2.m2.2.2.2.2.2.3.cmml" xref="alg1.2.2.2.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.m2.2c">\ln\psi_{ij}(z_{i},z_{j})</annotation></semantics></math></span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.7" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text" style="font-size:90%;">initialize </span><math id="alg1.l1.m1.3" class="ltx_Math" alttext="b_{i}^{(0)}(z_{i})=\psi_{i}(z_{i})" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml"><mrow id="alg1.l1.m1.2.2.1" xref="alg1.l1.m1.2.2.1.cmml"><msubsup id="alg1.l1.m1.2.2.1.3" xref="alg1.l1.m1.2.2.1.3.cmml"><mi mathsize="90%" id="alg1.l1.m1.2.2.1.3.2.2" xref="alg1.l1.m1.2.2.1.3.2.2.cmml">b</mi><mi mathsize="90%" id="alg1.l1.m1.2.2.1.3.2.3" xref="alg1.l1.m1.2.2.1.3.2.3.cmml">i</mi><mrow id="alg1.l1.m1.1.1.1.3" xref="alg1.l1.m1.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.1.1.1.3.1" xref="alg1.l1.m1.2.2.1.3.cmml">(</mo><mn mathsize="90%" id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml">0</mn><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.1.1.1.3.2" xref="alg1.l1.m1.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l1.m1.2.2.1.2" xref="alg1.l1.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l1.m1.2.2.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.2.2.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.1.cmml">(</mo><msub id="alg1.l1.m1.2.2.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m1.2.2.1.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l1.m1.2.2.1.1.1.1.3" xref="alg1.l1.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.2.2.1.1.1.3" xref="alg1.l1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.3.cmml">=</mo><mrow id="alg1.l1.m1.3.3.2" xref="alg1.l1.m1.3.3.2.cmml"><msub id="alg1.l1.m1.3.3.2.3" xref="alg1.l1.m1.3.3.2.3.cmml"><mi mathsize="90%" id="alg1.l1.m1.3.3.2.3.2" xref="alg1.l1.m1.3.3.2.3.2.cmml">ψ</mi><mi mathsize="90%" id="alg1.l1.m1.3.3.2.3.3" xref="alg1.l1.m1.3.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l1.m1.3.3.2.2" xref="alg1.l1.m1.3.3.2.2.cmml">​</mo><mrow id="alg1.l1.m1.3.3.2.1.1" xref="alg1.l1.m1.3.3.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.3.3.2.1.1.2" xref="alg1.l1.m1.3.3.2.1.1.1.cmml">(</mo><msub id="alg1.l1.m1.3.3.2.1.1.1" xref="alg1.l1.m1.3.3.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.l1.m1.3.3.2.1.1.1.2" xref="alg1.l1.m1.3.3.2.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l1.m1.3.3.2.1.1.1.3" xref="alg1.l1.m1.3.3.2.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l1.m1.3.3.2.1.1.3" xref="alg1.l1.m1.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3"><eq id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.3"></eq><apply id="alg1.l1.m1.2.2.1.cmml" xref="alg1.l1.m1.2.2.1"><times id="alg1.l1.m1.2.2.1.2.cmml" xref="alg1.l1.m1.2.2.1.2"></times><apply id="alg1.l1.m1.2.2.1.3.cmml" xref="alg1.l1.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.3.1.cmml" xref="alg1.l1.m1.2.2.1.3">superscript</csymbol><apply id="alg1.l1.m1.2.2.1.3.2.cmml" xref="alg1.l1.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.3.2.1.cmml" xref="alg1.l1.m1.2.2.1.3">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.3.2.2.cmml" xref="alg1.l1.m1.2.2.1.3.2.2">𝑏</ci><ci id="alg1.l1.m1.2.2.1.3.2.3.cmml" xref="alg1.l1.m1.2.2.1.3.2.3">𝑖</ci></apply><cn type="integer" id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1">0</cn></apply><apply id="alg1.l1.m1.2.2.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.2">𝑧</ci><ci id="alg1.l1.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l1.m1.3.3.2.cmml" xref="alg1.l1.m1.3.3.2"><times id="alg1.l1.m1.3.3.2.2.cmml" xref="alg1.l1.m1.3.3.2.2"></times><apply id="alg1.l1.m1.3.3.2.3.cmml" xref="alg1.l1.m1.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.3.1.cmml" xref="alg1.l1.m1.3.3.2.3">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.3.2.cmml" xref="alg1.l1.m1.3.3.2.3.2">𝜓</ci><ci id="alg1.l1.m1.3.3.2.3.3.cmml" xref="alg1.l1.m1.3.3.2.3.3">𝑖</ci></apply><apply id="alg1.l1.m1.3.3.2.1.1.1.cmml" xref="alg1.l1.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.1.1.1.1.cmml" xref="alg1.l1.m1.3.3.2.1.1">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.1.1.1.2.cmml" xref="alg1.l1.m1.3.3.2.1.1.1.2">𝑧</ci><ci id="alg1.l1.m1.3.3.2.1.1.1.3.cmml" xref="alg1.l1.m1.3.3.2.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">b_{i}^{(0)}(z_{i})=\psi_{i}(z_{i})</annotation></semantics></math><span id="alg1.l1.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span id="alg1.l2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l2.2" class="ltx_text" style="font-size:90%;"> t=1:T </span><span id="alg1.l2.3" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l2.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span id="alg1.l3.1" class="ltx_text" style="font-size:90%;">   </span><span id="alg1.l3.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l3.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l3.m1.1" class="ltx_Math" alttext="i=1:M" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mrow id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi mathsize="90%" id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">i</mi><mo mathsize="90%" id="alg1.l3.m1.1.1.2.1" xref="alg1.l3.m1.1.1.2.1.cmml">=</mo><mn mathsize="90%" id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">:</mo><mi mathsize="90%" id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">:</ci><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><eq id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2.1"></eq><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝑖</ci><cn type="integer" id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">1</cn></apply><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">i=1:M</annotation></semantics></math><span id="alg1.l3.4" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.l3.m2.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="alg1.l3.m2.1a"><msub id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">𝑧</ci><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">z_{i}</annotation></semantics></math><span id="alg1.l3.5" class="ltx_text" style="font-size:90%;"> in </span><math id="alg1.l3.m3.2" class="ltx_Math" alttext="\{0,1\}" display="inline"><semantics id="alg1.l3.m3.2a"><mrow id="alg1.l3.m3.2.3.2" xref="alg1.l3.m3.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l3.m3.2.3.2.1" xref="alg1.l3.m3.2.3.1.cmml">{</mo><mn mathsize="90%" id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">0</mn><mo mathsize="90%" id="alg1.l3.m3.2.3.2.2" xref="alg1.l3.m3.2.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l3.m3.2.2" xref="alg1.l3.m3.2.2.cmml">1</mn><mo maxsize="90%" minsize="90%" id="alg1.l3.m3.2.3.2.3" xref="alg1.l3.m3.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.2b"><set id="alg1.l3.m3.2.3.1.cmml" xref="alg1.l3.m3.2.3.2"><cn type="integer" id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">0</cn><cn type="integer" id="alg1.l3.m3.2.2.cmml" xref="alg1.l3.m3.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.2c">\{0,1\}</annotation></semantics></math><span id="alg1.l3.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l3.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l3.8" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span id="alg1.l4.1" class="ltx_text" style="font-size:90%;">      s</span><math id="alg1.l4.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mo mathsize="90%" stretchy="false" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\leftarrow</annotation></semantics></math><span id="alg1.l4.2" class="ltx_text" style="font-size:90%;">0
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span id="alg1.l5.1" class="ltx_text" style="font-size:90%;">      </span><span id="alg1.l5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg1.l5.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l5.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l5.m1.1a"><mi mathsize="90%" id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">j</annotation></semantics></math><span id="alg1.l5.4" class="ltx_text" style="font-size:90%;"> in </span><math id="alg1.l5.m2.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi mathsize="90%" id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">N</mi><mi mathsize="90%" id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝑁</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">N_{i}</annotation></semantics></math><span id="alg1.l5.5" class="ltx_text" style="font-size:90%;">, </span><math id="alg1.l5.m3.1" class="ltx_Math" alttext="z_{j}" display="inline"><semantics id="alg1.l5.m3.1a"><msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><mi mathsize="90%" id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">𝑧</ci><ci id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">z_{j}</annotation></semantics></math><span id="alg1.l5.6" class="ltx_text" style="font-size:90%;"> in </span><math id="alg1.l5.m4.2" class="ltx_Math" alttext="\{0,1\}" display="inline"><semantics id="alg1.l5.m4.2a"><mrow id="alg1.l5.m4.2.3.2" xref="alg1.l5.m4.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l5.m4.2.3.2.1" xref="alg1.l5.m4.2.3.1.cmml">{</mo><mn mathsize="90%" id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml">0</mn><mo mathsize="90%" id="alg1.l5.m4.2.3.2.2" xref="alg1.l5.m4.2.3.1.cmml">,</mo><mn mathsize="90%" id="alg1.l5.m4.2.2" xref="alg1.l5.m4.2.2.cmml">1</mn><mo maxsize="90%" minsize="90%" id="alg1.l5.m4.2.3.2.3" xref="alg1.l5.m4.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.2b"><set id="alg1.l5.m4.2.3.1.cmml" xref="alg1.l5.m4.2.3.2"><cn type="integer" id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1">0</cn><cn type="integer" id="alg1.l5.m4.2.2.cmml" xref="alg1.l5.m4.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.2c">\{0,1\}</annotation></semantics></math><span id="alg1.l5.7" class="ltx_text" style="font-size:90%;"> </span><span id="alg1.l5.8" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg1.l5.9" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span id="alg1.l6.1" class="ltx_text" style="font-size:90%;">         s</span><math id="alg1.l6.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l6.m1.1a"><mo mathsize="90%" stretchy="false" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\leftarrow</annotation></semantics></math><span id="alg1.l6.2" class="ltx_text" style="font-size:90%;">s</span><math id="alg1.l6.m2.4" class="ltx_Math" alttext="+b_{j}^{(t-1)}(z_{j})\ln\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="alg1.l6.m2.4a"><mrow id="alg1.l6.m2.4.4" xref="alg1.l6.m2.4.4.cmml"><mo mathsize="90%" id="alg1.l6.m2.4.4a" xref="alg1.l6.m2.4.4.cmml">+</mo><mrow id="alg1.l6.m2.4.4.3" xref="alg1.l6.m2.4.4.3.cmml"><msubsup id="alg1.l6.m2.4.4.3.5" xref="alg1.l6.m2.4.4.3.5.cmml"><mi mathsize="90%" id="alg1.l6.m2.4.4.3.5.2.2" xref="alg1.l6.m2.4.4.3.5.2.2.cmml">b</mi><mi mathsize="90%" id="alg1.l6.m2.4.4.3.5.2.3" xref="alg1.l6.m2.4.4.3.5.2.3.cmml">j</mi><mrow id="alg1.l6.m2.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l6.m2.1.1.1.1.2" xref="alg1.l6.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m2.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m2.1.1.1.1.1.2" xref="alg1.l6.m2.1.1.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg1.l6.m2.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="alg1.l6.m2.1.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg1.l6.m2.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l6.m2.4.4.3.4" xref="alg1.l6.m2.4.4.3.4.cmml">​</mo><mrow id="alg1.l6.m2.2.2.1.1.1" xref="alg1.l6.m2.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l6.m2.2.2.1.1.1.2" xref="alg1.l6.m2.2.2.1.1.1.1.cmml">(</mo><msub id="alg1.l6.m2.2.2.1.1.1.1" xref="alg1.l6.m2.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m2.2.2.1.1.1.1.2" xref="alg1.l6.m2.2.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l6.m2.2.2.1.1.1.1.3" xref="alg1.l6.m2.2.2.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l6.m2.2.2.1.1.1.3" xref="alg1.l6.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="alg1.l6.m2.4.4.3.4a" xref="alg1.l6.m2.4.4.3.4.cmml">​</mo><mrow id="alg1.l6.m2.4.4.3.6" xref="alg1.l6.m2.4.4.3.6.cmml"><mi mathsize="90%" id="alg1.l6.m2.4.4.3.6.1" xref="alg1.l6.m2.4.4.3.6.1.cmml">ln</mi><mo lspace="0.167em" id="alg1.l6.m2.4.4.3.6a" xref="alg1.l6.m2.4.4.3.6.cmml">⁡</mo><msub id="alg1.l6.m2.4.4.3.6.2" xref="alg1.l6.m2.4.4.3.6.2.cmml"><mi mathsize="90%" id="alg1.l6.m2.4.4.3.6.2.2" xref="alg1.l6.m2.4.4.3.6.2.2.cmml">ψ</mi><mrow id="alg1.l6.m2.4.4.3.6.2.3" xref="alg1.l6.m2.4.4.3.6.2.3.cmml"><mi mathsize="90%" id="alg1.l6.m2.4.4.3.6.2.3.2" xref="alg1.l6.m2.4.4.3.6.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.4.4.3.6.2.3.1" xref="alg1.l6.m2.4.4.3.6.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg1.l6.m2.4.4.3.6.2.3.3" xref="alg1.l6.m2.4.4.3.6.2.3.3.cmml">j</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l6.m2.4.4.3.4b" xref="alg1.l6.m2.4.4.3.4.cmml">​</mo><mrow id="alg1.l6.m2.4.4.3.3.2" xref="alg1.l6.m2.4.4.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l6.m2.4.4.3.3.2.3" xref="alg1.l6.m2.4.4.3.3.3.cmml">(</mo><msub id="alg1.l6.m2.3.3.2.2.1.1" xref="alg1.l6.m2.3.3.2.2.1.1.cmml"><mi mathsize="90%" id="alg1.l6.m2.3.3.2.2.1.1.2" xref="alg1.l6.m2.3.3.2.2.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l6.m2.3.3.2.2.1.1.3" xref="alg1.l6.m2.3.3.2.2.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg1.l6.m2.4.4.3.3.2.4" xref="alg1.l6.m2.4.4.3.3.3.cmml">,</mo><msub id="alg1.l6.m2.4.4.3.3.2.2" xref="alg1.l6.m2.4.4.3.3.2.2.cmml"><mi mathsize="90%" id="alg1.l6.m2.4.4.3.3.2.2.2" xref="alg1.l6.m2.4.4.3.3.2.2.2.cmml">z</mi><mi mathsize="90%" id="alg1.l6.m2.4.4.3.3.2.2.3" xref="alg1.l6.m2.4.4.3.3.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l6.m2.4.4.3.3.2.5" xref="alg1.l6.m2.4.4.3.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.4b"><apply id="alg1.l6.m2.4.4.cmml" xref="alg1.l6.m2.4.4"><plus id="alg1.l6.m2.4.4.4.cmml" xref="alg1.l6.m2.4.4"></plus><apply id="alg1.l6.m2.4.4.3.cmml" xref="alg1.l6.m2.4.4.3"><times id="alg1.l6.m2.4.4.3.4.cmml" xref="alg1.l6.m2.4.4.3.4"></times><apply id="alg1.l6.m2.4.4.3.5.cmml" xref="alg1.l6.m2.4.4.3.5"><csymbol cd="ambiguous" id="alg1.l6.m2.4.4.3.5.1.cmml" xref="alg1.l6.m2.4.4.3.5">superscript</csymbol><apply id="alg1.l6.m2.4.4.3.5.2.cmml" xref="alg1.l6.m2.4.4.3.5"><csymbol cd="ambiguous" id="alg1.l6.m2.4.4.3.5.2.1.cmml" xref="alg1.l6.m2.4.4.3.5">subscript</csymbol><ci id="alg1.l6.m2.4.4.3.5.2.2.cmml" xref="alg1.l6.m2.4.4.3.5.2.2">𝑏</ci><ci id="alg1.l6.m2.4.4.3.5.2.3.cmml" xref="alg1.l6.m2.4.4.3.5.2.3">𝑗</ci></apply><apply id="alg1.l6.m2.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1"><minus id="alg1.l6.m2.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1"></minus><ci id="alg1.l6.m2.1.1.1.1.1.2.cmml" xref="alg1.l6.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l6.m2.1.1.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l6.m2.2.2.1.1.1.1.cmml" xref="alg1.l6.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m2.2.2.1.1.1.1.2.cmml" xref="alg1.l6.m2.2.2.1.1.1.1.2">𝑧</ci><ci id="alg1.l6.m2.2.2.1.1.1.1.3.cmml" xref="alg1.l6.m2.2.2.1.1.1.1.3">𝑗</ci></apply><apply id="alg1.l6.m2.4.4.3.6.cmml" xref="alg1.l6.m2.4.4.3.6"><ln id="alg1.l6.m2.4.4.3.6.1.cmml" xref="alg1.l6.m2.4.4.3.6.1"></ln><apply id="alg1.l6.m2.4.4.3.6.2.cmml" xref="alg1.l6.m2.4.4.3.6.2"><csymbol cd="ambiguous" id="alg1.l6.m2.4.4.3.6.2.1.cmml" xref="alg1.l6.m2.4.4.3.6.2">subscript</csymbol><ci id="alg1.l6.m2.4.4.3.6.2.2.cmml" xref="alg1.l6.m2.4.4.3.6.2.2">𝜓</ci><apply id="alg1.l6.m2.4.4.3.6.2.3.cmml" xref="alg1.l6.m2.4.4.3.6.2.3"><times id="alg1.l6.m2.4.4.3.6.2.3.1.cmml" xref="alg1.l6.m2.4.4.3.6.2.3.1"></times><ci id="alg1.l6.m2.4.4.3.6.2.3.2.cmml" xref="alg1.l6.m2.4.4.3.6.2.3.2">𝑖</ci><ci id="alg1.l6.m2.4.4.3.6.2.3.3.cmml" xref="alg1.l6.m2.4.4.3.6.2.3.3">𝑗</ci></apply></apply></apply><interval closure="open" id="alg1.l6.m2.4.4.3.3.3.cmml" xref="alg1.l6.m2.4.4.3.3.2"><apply id="alg1.l6.m2.3.3.2.2.1.1.cmml" xref="alg1.l6.m2.3.3.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.3.3.2.2.1.1.1.cmml" xref="alg1.l6.m2.3.3.2.2.1.1">subscript</csymbol><ci id="alg1.l6.m2.3.3.2.2.1.1.2.cmml" xref="alg1.l6.m2.3.3.2.2.1.1.2">𝑧</ci><ci id="alg1.l6.m2.3.3.2.2.1.1.3.cmml" xref="alg1.l6.m2.3.3.2.2.1.1.3">𝑖</ci></apply><apply id="alg1.l6.m2.4.4.3.3.2.2.cmml" xref="alg1.l6.m2.4.4.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m2.4.4.3.3.2.2.1.cmml" xref="alg1.l6.m2.4.4.3.3.2.2">subscript</csymbol><ci id="alg1.l6.m2.4.4.3.3.2.2.2.cmml" xref="alg1.l6.m2.4.4.3.3.2.2.2">𝑧</ci><ci id="alg1.l6.m2.4.4.3.3.2.2.3.cmml" xref="alg1.l6.m2.4.4.3.3.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.4c">+b_{j}^{(t-1)}(z_{j})\ln\psi_{ij}(z_{i},z_{j})</annotation></semantics></math><span id="alg1.l6.3" class="ltx_text" style="font-size:90%;">
      </span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span id="alg1.l7.1" class="ltx_text" style="font-size:90%;">      </span><math id="alg1.l7.m1.5" class="ltx_Math" alttext="b_{i}^{(t)}(z_{i})\leftarrow\psi_{i}(z_{i})\exp(s)" display="inline"><semantics id="alg1.l7.m1.5a"><mrow id="alg1.l7.m1.5.5" xref="alg1.l7.m1.5.5.cmml"><mrow id="alg1.l7.m1.4.4.1" xref="alg1.l7.m1.4.4.1.cmml"><msubsup id="alg1.l7.m1.4.4.1.3" xref="alg1.l7.m1.4.4.1.3.cmml"><mi mathsize="90%" id="alg1.l7.m1.4.4.1.3.2.2" xref="alg1.l7.m1.4.4.1.3.2.2.cmml">b</mi><mi mathsize="90%" id="alg1.l7.m1.4.4.1.3.2.3" xref="alg1.l7.m1.4.4.1.3.2.3.cmml">i</mi><mrow id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.4.4.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.1.1.1.3.1" xref="alg1.l7.m1.4.4.1.3.cmml">(</mo><mi mathsize="90%" id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.1.1.1.3.2" xref="alg1.l7.m1.4.4.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l7.m1.4.4.1.2" xref="alg1.l7.m1.4.4.1.2.cmml">​</mo><mrow id="alg1.l7.m1.4.4.1.1.1" xref="alg1.l7.m1.4.4.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.4.4.1.1.1.2" xref="alg1.l7.m1.4.4.1.1.1.1.cmml">(</mo><msub id="alg1.l7.m1.4.4.1.1.1.1" xref="alg1.l7.m1.4.4.1.1.1.1.cmml"><mi mathsize="90%" id="alg1.l7.m1.4.4.1.1.1.1.2" xref="alg1.l7.m1.4.4.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l7.m1.4.4.1.1.1.1.3" xref="alg1.l7.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.4.4.1.1.1.3" xref="alg1.l7.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" stretchy="false" id="alg1.l7.m1.5.5.3" xref="alg1.l7.m1.5.5.3.cmml">←</mo><mrow id="alg1.l7.m1.5.5.2" xref="alg1.l7.m1.5.5.2.cmml"><msub id="alg1.l7.m1.5.5.2.3" xref="alg1.l7.m1.5.5.2.3.cmml"><mi mathsize="90%" id="alg1.l7.m1.5.5.2.3.2" xref="alg1.l7.m1.5.5.2.3.2.cmml">ψ</mi><mi mathsize="90%" id="alg1.l7.m1.5.5.2.3.3" xref="alg1.l7.m1.5.5.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.5.5.2.2" xref="alg1.l7.m1.5.5.2.2.cmml">​</mo><mrow id="alg1.l7.m1.5.5.2.1.1" xref="alg1.l7.m1.5.5.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.5.5.2.1.1.2" xref="alg1.l7.m1.5.5.2.1.1.1.cmml">(</mo><msub id="alg1.l7.m1.5.5.2.1.1.1" xref="alg1.l7.m1.5.5.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.l7.m1.5.5.2.1.1.1.2" xref="alg1.l7.m1.5.5.2.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l7.m1.5.5.2.1.1.1.3" xref="alg1.l7.m1.5.5.2.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.5.5.2.1.1.3" xref="alg1.l7.m1.5.5.2.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="alg1.l7.m1.5.5.2.2a" xref="alg1.l7.m1.5.5.2.2.cmml">​</mo><mrow id="alg1.l7.m1.5.5.2.4.2" xref="alg1.l7.m1.5.5.2.4.1.cmml"><mi mathsize="90%" id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">exp</mi><mo id="alg1.l7.m1.5.5.2.4.2a" xref="alg1.l7.m1.5.5.2.4.1.cmml">⁡</mo><mrow id="alg1.l7.m1.5.5.2.4.2.1" xref="alg1.l7.m1.5.5.2.4.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.5.5.2.4.2.1.1" xref="alg1.l7.m1.5.5.2.4.1.cmml">(</mo><mi mathsize="90%" id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">s</mi><mo maxsize="90%" minsize="90%" id="alg1.l7.m1.5.5.2.4.2.1.2" xref="alg1.l7.m1.5.5.2.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.5b"><apply id="alg1.l7.m1.5.5.cmml" xref="alg1.l7.m1.5.5"><ci id="alg1.l7.m1.5.5.3.cmml" xref="alg1.l7.m1.5.5.3">←</ci><apply id="alg1.l7.m1.4.4.1.cmml" xref="alg1.l7.m1.4.4.1"><times id="alg1.l7.m1.4.4.1.2.cmml" xref="alg1.l7.m1.4.4.1.2"></times><apply id="alg1.l7.m1.4.4.1.3.cmml" xref="alg1.l7.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.1.3.1.cmml" xref="alg1.l7.m1.4.4.1.3">superscript</csymbol><apply id="alg1.l7.m1.4.4.1.3.2.cmml" xref="alg1.l7.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.1.3.2.1.cmml" xref="alg1.l7.m1.4.4.1.3">subscript</csymbol><ci id="alg1.l7.m1.4.4.1.3.2.2.cmml" xref="alg1.l7.m1.4.4.1.3.2.2">𝑏</ci><ci id="alg1.l7.m1.4.4.1.3.2.3.cmml" xref="alg1.l7.m1.4.4.1.3.2.3">𝑖</ci></apply><ci id="alg1.l7.m1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1">𝑡</ci></apply><apply id="alg1.l7.m1.4.4.1.1.1.1.cmml" xref="alg1.l7.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l7.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l7.m1.4.4.1.1.1.1.2">𝑧</ci><ci id="alg1.l7.m1.4.4.1.1.1.1.3.cmml" xref="alg1.l7.m1.4.4.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l7.m1.5.5.2.cmml" xref="alg1.l7.m1.5.5.2"><times id="alg1.l7.m1.5.5.2.2.cmml" xref="alg1.l7.m1.5.5.2.2"></times><apply id="alg1.l7.m1.5.5.2.3.cmml" xref="alg1.l7.m1.5.5.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.5.5.2.3.1.cmml" xref="alg1.l7.m1.5.5.2.3">subscript</csymbol><ci id="alg1.l7.m1.5.5.2.3.2.cmml" xref="alg1.l7.m1.5.5.2.3.2">𝜓</ci><ci id="alg1.l7.m1.5.5.2.3.3.cmml" xref="alg1.l7.m1.5.5.2.3.3">𝑖</ci></apply><apply id="alg1.l7.m1.5.5.2.1.1.1.cmml" xref="alg1.l7.m1.5.5.2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.5.5.2.1.1.1.1.cmml" xref="alg1.l7.m1.5.5.2.1.1">subscript</csymbol><ci id="alg1.l7.m1.5.5.2.1.1.1.2.cmml" xref="alg1.l7.m1.5.5.2.1.1.1.2">𝑧</ci><ci id="alg1.l7.m1.5.5.2.1.1.1.3.cmml" xref="alg1.l7.m1.5.5.2.1.1.1.3">𝑖</ci></apply><apply id="alg1.l7.m1.5.5.2.4.1.cmml" xref="alg1.l7.m1.5.5.2.4.2"><exp id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"></exp><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.5c">b_{i}^{(t)}(z_{i})\leftarrow\psi_{i}(z_{i})\exp(s)</annotation></semantics></math><span id="alg1.l7.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span id="alg1.l8.1" class="ltx_text" style="font-size:90%;">      normalize(</span><math id="alg1.l8.m1.1" class="ltx_Math" alttext="b_{i}^{(t)}" display="inline"><semantics id="alg1.l8.m1.1a"><msubsup id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><mi mathsize="90%" id="alg1.l8.m1.1.2.2.2" xref="alg1.l8.m1.1.2.2.2.cmml">b</mi><mi mathsize="90%" id="alg1.l8.m1.1.2.2.3" xref="alg1.l8.m1.1.2.2.3.cmml">i</mi><mrow id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.1.2.cmml">(</mo><mi mathsize="90%" id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2">superscript</csymbol><apply id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.2.1.cmml" xref="alg1.l8.m1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.2.2.2.cmml" xref="alg1.l8.m1.1.2.2.2">𝑏</ci><ci id="alg1.l8.m1.1.2.2.3.cmml" xref="alg1.l8.m1.1.2.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">b_{i}^{(t)}</annotation></semantics></math><span id="alg1.l8.2" class="ltx_text" style="font-size:90%;">)
   </span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span id="alg1.l9.1" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg1.l9.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg1.l9.m1.2" class="ltx_Math" alttext="b_{i}^{(T)}(z_{i})" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><msubsup id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml"><mi mathsize="90%" id="alg1.l9.m1.2.2.3.2.2" xref="alg1.l9.m1.2.2.3.2.2.cmml">b</mi><mi mathsize="90%" id="alg1.l9.m1.2.2.3.2.3" xref="alg1.l9.m1.2.2.3.2.3.cmml">i</mi><mrow id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.1.1.1.3.1" xref="alg1.l9.m1.2.2.3.cmml">(</mo><mi mathsize="90%" id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml">T</mi><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml">​</mo><mrow id="alg1.l9.m1.2.2.1.1" xref="alg1.l9.m1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.2.2.1.1.2" xref="alg1.l9.m1.2.2.1.1.1.cmml">(</mo><msub id="alg1.l9.m1.2.2.1.1.1" xref="alg1.l9.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg1.l9.m1.2.2.1.1.1.2" xref="alg1.l9.m1.2.2.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg1.l9.m1.2.2.1.1.1.3" xref="alg1.l9.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg1.l9.m1.2.2.1.1.3" xref="alg1.l9.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><times id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"></times><apply id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.3">superscript</csymbol><apply id="alg1.l9.m1.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3.2.1.cmml" xref="alg1.l9.m1.2.2.3">subscript</csymbol><ci id="alg1.l9.m1.2.2.3.2.2.cmml" xref="alg1.l9.m1.2.2.3.2.2">𝑏</ci><ci id="alg1.l9.m1.2.2.3.2.3.cmml" xref="alg1.l9.m1.2.2.3.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">𝑇</ci></apply><apply id="alg1.l9.m1.2.2.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l9.m1.2.2.1.1.1.2.cmml" xref="alg1.l9.m1.2.2.1.1.1.2">𝑧</ci><ci id="alg1.l9.m1.2.2.1.1.1.3.cmml" xref="alg1.l9.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">b_{i}^{(T)}(z_{i})</annotation></semantics></math><span id="alg1.l9.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</div>
</div>
</figure>
<div id="S3.SS3.SSS2.p1" class="ltx_para">
<p id="S3.SS3.SSS2.p1.2" class="ltx_p">The Mean Field algorithm approximates the distribution <math id="S3.SS3.SSS2.p1.1.m1.3" class="ltx_Math" alttext="p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS3.SSS2.p1.1.m1.3a"><mrow id="S3.SS3.SSS2.p1.1.m1.3.3" xref="S3.SS3.SSS2.p1.1.m1.3.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.3.3.3" xref="S3.SS3.SSS2.p1.1.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.1.m1.3.3.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.1.m1.3.3.1.1" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.3.2" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml">𝐗</mi><mo id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.3.2.1" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.SSS2.p1.1.m1.2.2" xref="S3.SS3.SSS2.p1.1.m1.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.3b"><apply id="S3.SS3.SSS2.p1.1.m1.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3"><times id="S3.SS3.SSS2.p1.1.m1.3.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.2"></times><ci id="S3.SS3.SSS2.p1.1.m1.3.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.3">𝑝</ci><apply id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.2">𝐳</ci><list id="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.3.3.1.1.1.3.2"><ci id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">𝐗</ci><ci id="S3.SS3.SSS2.p1.1.m1.2.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.2.2">𝒒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.3c">p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math> in Eq. <a href="#S3.E6" title="In 3.2 Structured Multivariate Attention ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> with a fully factorized distribution <math id="S3.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="q(\boldsymbol{\mathrm{z}})" display="inline"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><mrow id="S3.SS3.SSS2.p1.2.m2.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.cmml"><mi id="S3.SS3.SSS2.p1.2.m2.1.2.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.2.m2.1.2.1" xref="S3.SS3.SSS2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.2.m2.1.2.3.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.2.m2.1.2.3.2.1" xref="S3.SS3.SSS2.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml">𝐳</mi><mo stretchy="false" id="S3.SS3.SSS2.p1.2.m2.1.2.3.2.2" xref="S3.SS3.SSS2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2"><times id="S3.SS3.SSS2.p1.2.m2.1.2.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2.1"></times><ci id="S3.SS3.SSS2.p1.2.m2.1.2.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.2.2">𝑞</ci><ci id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">q(\boldsymbol{\mathrm{z}})</annotation></semantics></math>:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.2" class="ltx_Math" alttext="q(\boldsymbol{\mathrm{z}})=\prod_{i}b_{i}(z_{i})," display="block"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1.3" xref="S3.Ex1.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.1.1.3.1" xref="S3.Ex1.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.Ex1.m1.2.2.1.1.3.3.2" xref="S3.Ex1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.3.3.2.1" xref="S3.Ex1.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝐳</mi><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.3.3.2.2" xref="S3.Ex1.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.Ex1.m1.2.2.1.1.2" xref="S3.Ex1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.cmml"><munder id="S3.Ex1.m1.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m1.2.2.1.1.1.2.2" xref="S3.Ex1.m1.2.2.1.1.1.2.2.cmml">∏</mo><mi id="S3.Ex1.m1.2.2.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.2.3.cmml">i</mi></munder><mrow id="S3.Ex1.m1.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml"><msub id="S3.Ex1.m1.2.2.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.1.1.3.2.cmml">b</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.3.3" xref="S3.Ex1.m1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m1.2.2.1.2" xref="S3.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1"><eq id="S3.Ex1.m1.2.2.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.2"></eq><apply id="S3.Ex1.m1.2.2.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.3"><times id="S3.Ex1.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.3.1"></times><ci id="S3.Ex1.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.3.2">𝑞</ci><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐳</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><apply id="S3.Ex1.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex1.m1.2.2.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2">product</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1"><times id="S3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2"></times><apply id="S3.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3.2">𝑏</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">q(\boldsymbol{\mathrm{z}})=\prod_{i}b_{i}(z_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p1.4" class="ltx_p">where <math id="S3.SS3.SSS2.p1.3.m1.1" class="ltx_Math" alttext="b_{i}(z_{i})" display="inline"><semantics id="S3.SS3.SSS2.p1.3.m1.1a"><mrow id="S3.SS3.SSS2.p1.3.m1.1.1" xref="S3.SS3.SSS2.p1.3.m1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.3.m1.1.1.3" xref="S3.SS3.SSS2.p1.3.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.3.m1.1.1.3.2" xref="S3.SS3.SSS2.p1.3.m1.1.1.3.2.cmml">b</mi><mi id="S3.SS3.SSS2.p1.3.m1.1.1.3.3" xref="S3.SS3.SSS2.p1.3.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.3.m1.1.1.2" xref="S3.SS3.SSS2.p1.3.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.3.m1.1.1.1.1" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m1.1b"><apply id="S3.SS3.SSS2.p1.3.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1"><times id="S3.SS3.SSS2.p1.3.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.2"></times><apply id="S3.SS3.SSS2.p1.3.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.3.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.3.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS2.p1.3.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.3.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m1.1c">b_{i}(z_{i})</annotation></semantics></math> are variational parameters corresponding to the marginal probabilities <math id="S3.SS3.SSS2.p1.4.m2.3" class="ltx_Math" alttext="p(z_{i}|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS3.SSS2.p1.4.m2.3a"><mrow id="S3.SS3.SSS2.p1.4.m2.3.3" xref="S3.SS3.SSS2.p1.4.m2.3.3.cmml"><mi id="S3.SS3.SSS2.p1.4.m2.3.3.3" xref="S3.SS3.SSS2.p1.4.m2.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.4.m2.3.3.2" xref="S3.SS3.SSS2.p1.4.m2.3.3.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.4.m2.3.3.1.1" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.2" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.2" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.3" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.1" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.3.2" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.SSS2.p1.4.m2.1.1" xref="S3.SS3.SSS2.p1.4.m2.1.1.cmml">𝐗</mi><mo id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.3.2.1" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.SSS2.p1.4.m2.2.2" xref="S3.SS3.SSS2.p1.4.m2.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.3" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m2.3b"><apply id="S3.SS3.SSS2.p1.4.m2.3.3.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3"><times id="S3.SS3.SSS2.p1.4.m2.3.3.2.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.2"></times><ci id="S3.SS3.SSS2.p1.4.m2.3.3.3.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.3">𝑝</ci><apply id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.1">conditional</csymbol><apply id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.2.3">𝑖</ci></apply><list id="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.4.m2.3.3.1.1.1.3.2"><ci id="S3.SS3.SSS2.p1.4.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m2.1.1">𝐗</ci><ci id="S3.SS3.SSS2.p1.4.m2.2.2.cmml" xref="S3.SS3.SSS2.p1.4.m2.2.2">𝒒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m2.3c">p(z_{i}|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math>. The variational parameters are optimized by iteratively minimizing the mean-field free energy
<span id="S3.SS3.SSS2.p1.4.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.76" class="ltx_Math" alttext="\begin{split}F_{MF}({b_{i}})=&amp;-\sum_{(i,j)\in\mathcal{N}}\sum_{z_{i},z_{j}}b_{i}(z_{i})b_{j}(z_{j})\ln\psi_{ij}(z_{i},z_{j})\\
&amp;+\sum_{i}\sum_{z_{i}}b_{i}(z_{i})[\ln b_{i}(z_{i})-\ln\psi_{i}(z_{i})]\end{split}" display="block"><semantics id="S3.E11.m1.76a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E11.m1.76.76.14" xref="S3.E11.m1.69.69.7.cmml"><mtr id="S3.E11.m1.76.76.14a" xref="S3.E11.m1.69.69.7.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E11.m1.76.76.14b" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.70.70.8.63.35.8" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.70.70.8.63.35.8.8" xref="S3.E11.m1.69.69.7.cmml"><msub id="S3.E11.m1.70.70.8.63.35.8.8.3" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml">F</mi><mrow id="S3.E11.m1.2.2.2.2.2.2.1" xref="S3.E11.m1.2.2.2.2.2.2.1.cmml"><mi mathsize="90%" id="S3.E11.m1.2.2.2.2.2.2.1.2" xref="S3.E11.m1.2.2.2.2.2.2.1.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.2.2.2.2.1.1" xref="S3.E11.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi mathsize="90%" id="S3.E11.m1.2.2.2.2.2.2.1.3" xref="S3.E11.m1.2.2.2.2.2.2.1.3.cmml">F</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.70.70.8.63.35.8.8.2" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.70.70.8.63.35.8.8.1.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.3.3.3.3.3.3" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.70.70.8.63.35.8.8.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.4.4.4.4.4.4" xref="S3.E11.m1.4.4.4.4.4.4.cmml">b</mi><mi mathsize="90%" id="S3.E11.m1.5.5.5.5.5.5.1" xref="S3.E11.m1.5.5.5.5.5.5.1.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.6.6.6.6.6.6" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E11.m1.7.7.7.7.7.7" xref="S3.E11.m1.7.7.7.7.7.7.cmml">=</mo><mi id="S3.E11.m1.70.70.8.63.35.8.9" xref="S3.E11.m1.69.69.7.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.76.76.14c" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.74.74.12.67.39.31" xref="S3.E11.m1.69.69.7.cmml"><mo mathsize="90%" id="S3.E11.m1.74.74.12.67.39.31a" xref="S3.E11.m1.69.69.7.cmml">−</mo><mrow id="S3.E11.m1.74.74.12.67.39.31.31" xref="S3.E11.m1.69.69.7.cmml"><munder id="S3.E11.m1.74.74.12.67.39.31.31.5" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" id="S3.E11.m1.9.9.9.9.2.2" xref="S3.E11.m1.9.9.9.9.2.2.cmml">∑</mo><mrow id="S3.E11.m1.10.10.10.10.3.3.1" xref="S3.E11.m1.10.10.10.10.3.3.1.cmml"><mrow id="S3.E11.m1.10.10.10.10.3.3.1.4.2" xref="S3.E11.m1.10.10.10.10.3.3.1.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.4.2.1" xref="S3.E11.m1.10.10.10.10.3.3.1.4.1.cmml">(</mo><mi mathsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.1" xref="S3.E11.m1.10.10.10.10.3.3.1.1.cmml">i</mi><mo mathsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.4.2.2" xref="S3.E11.m1.10.10.10.10.3.3.1.4.1.cmml">,</mo><mi mathsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.2" xref="S3.E11.m1.10.10.10.10.3.3.1.2.cmml">j</mi><mo maxsize="90%" minsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.4.2.3" xref="S3.E11.m1.10.10.10.10.3.3.1.4.1.cmml">)</mo></mrow><mo mathsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.3" xref="S3.E11.m1.10.10.10.10.3.3.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E11.m1.10.10.10.10.3.3.1.5" xref="S3.E11.m1.10.10.10.10.3.3.1.5.cmml">𝒩</mi></mrow></munder><mrow id="S3.E11.m1.74.74.12.67.39.31.31.4" xref="S3.E11.m1.69.69.7.cmml"><munder id="S3.E11.m1.74.74.12.67.39.31.31.4.5" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E11.m1.11.11.11.11.4.4" xref="S3.E11.m1.11.11.11.11.4.4.cmml">∑</mo><mrow id="S3.E11.m1.12.12.12.12.5.5.1.2" xref="S3.E11.m1.12.12.12.12.5.5.1.3.cmml"><msub id="S3.E11.m1.12.12.12.12.5.5.1.1.1" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1.cmml"><mi mathsize="90%" id="S3.E11.m1.12.12.12.12.5.5.1.1.1.2" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.12.12.12.12.5.5.1.1.1.3" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E11.m1.12.12.12.12.5.5.1.2.3" xref="S3.E11.m1.12.12.12.12.5.5.1.3.cmml">,</mo><msub id="S3.E11.m1.12.12.12.12.5.5.1.2.2" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2.cmml"><mi mathsize="90%" id="S3.E11.m1.12.12.12.12.5.5.1.2.2.2" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2.2.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.12.12.12.12.5.5.1.2.2.3" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2.3.cmml">j</mi></msub></mrow></munder><mrow id="S3.E11.m1.74.74.12.67.39.31.31.4.4" xref="S3.E11.m1.69.69.7.cmml"><msub id="S3.E11.m1.74.74.12.67.39.31.31.4.4.6" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.13.13.13.13.6.6" xref="S3.E11.m1.13.13.13.13.6.6.cmml">b</mi><mi mathsize="90%" id="S3.E11.m1.14.14.14.14.7.7.1" xref="S3.E11.m1.14.14.14.14.7.7.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.74.74.12.67.39.31.31.4.4.5" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.71.71.9.64.36.28.28.1.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.15.15.15.15.8.8" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.71.71.9.64.36.28.28.1.1.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.16.16.16.16.9.9" xref="S3.E11.m1.16.16.16.16.9.9.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.17.17.17.17.10.10.1" xref="S3.E11.m1.17.17.17.17.10.10.1.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.18.18.18.18.11.11" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.74.74.12.67.39.31.31.4.4.5a" xref="S3.E11.m1.69.69.7.cmml">​</mo><msub id="S3.E11.m1.74.74.12.67.39.31.31.4.4.7" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.19.19.19.19.12.12" xref="S3.E11.m1.19.19.19.19.12.12.cmml">b</mi><mi mathsize="90%" id="S3.E11.m1.20.20.20.20.13.13.1" xref="S3.E11.m1.20.20.20.20.13.13.1.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.74.74.12.67.39.31.31.4.4.5b" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.72.72.10.65.37.29.29.2.2.2.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.21.21.21.21.14.14" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.72.72.10.65.37.29.29.2.2.2.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.22.22.22.22.15.15" xref="S3.E11.m1.22.22.22.22.15.15.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.23.23.23.23.16.16.1" xref="S3.E11.m1.23.23.23.23.16.16.1.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.24.24.24.24.17.17" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E11.m1.74.74.12.67.39.31.31.4.4.5c" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.74.74.12.67.39.31.31.4.4.8" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.25.25.25.25.18.18" xref="S3.E11.m1.25.25.25.25.18.18.cmml">ln</mi><mo lspace="0.167em" id="S3.E11.m1.74.74.12.67.39.31.31.4.4.8a" xref="S3.E11.m1.69.69.7.cmml">⁡</mo><msub id="S3.E11.m1.74.74.12.67.39.31.31.4.4.8.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.26.26.26.26.19.19" xref="S3.E11.m1.26.26.26.26.19.19.cmml">ψ</mi><mrow id="S3.E11.m1.27.27.27.27.20.20.1" xref="S3.E11.m1.27.27.27.27.20.20.1.cmml"><mi mathsize="90%" id="S3.E11.m1.27.27.27.27.20.20.1.2" xref="S3.E11.m1.27.27.27.27.20.20.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.27.27.27.27.20.20.1.1" xref="S3.E11.m1.27.27.27.27.20.20.1.1.cmml">​</mo><mi mathsize="90%" id="S3.E11.m1.27.27.27.27.20.20.1.3" xref="S3.E11.m1.27.27.27.27.20.20.1.3.cmml">j</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.74.74.12.67.39.31.31.4.4.5d" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.74.74.12.67.39.31.31.4.4.4.2" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.28.28.28.28.21.21" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.73.73.11.66.38.30.30.3.3.3.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.29.29.29.29.22.22" xref="S3.E11.m1.29.29.29.29.22.22.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.30.30.30.30.23.23.1" xref="S3.E11.m1.30.30.30.30.23.23.1.cmml">i</mi></msub><mo mathsize="90%" id="S3.E11.m1.31.31.31.31.24.24" xref="S3.E11.m1.69.69.7.cmml">,</mo><msub id="S3.E11.m1.74.74.12.67.39.31.31.4.4.4.2.2" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.32.32.32.32.25.25" xref="S3.E11.m1.32.32.32.32.25.25.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.33.33.33.33.26.26.1" xref="S3.E11.m1.33.33.33.33.26.26.1.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.34.34.34.34.27.27" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E11.m1.76.76.14d" xref="S3.E11.m1.69.69.7.cmml"><mtd id="S3.E11.m1.76.76.14e" xref="S3.E11.m1.69.69.7.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E11.m1.76.76.14f" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.76.76.14.69.30.30" xref="S3.E11.m1.69.69.7.cmml"><mo mathsize="90%" id="S3.E11.m1.76.76.14.69.30.30a" xref="S3.E11.m1.69.69.7.cmml">+</mo><mrow id="S3.E11.m1.76.76.14.69.30.30.30" xref="S3.E11.m1.69.69.7.cmml"><munder id="S3.E11.m1.76.76.14.69.30.30.30.3" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" id="S3.E11.m1.36.36.36.2.2.2" xref="S3.E11.m1.36.36.36.2.2.2.cmml">∑</mo><mi mathsize="90%" id="S3.E11.m1.37.37.37.3.3.3.1" xref="S3.E11.m1.37.37.37.3.3.3.1.cmml">i</mi></munder><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2" xref="S3.E11.m1.69.69.7.cmml"><munder id="S3.E11.m1.76.76.14.69.30.30.30.2.3" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E11.m1.38.38.38.4.4.4" xref="S3.E11.m1.38.38.38.4.4.4.cmml">∑</mo><msub id="S3.E11.m1.39.39.39.5.5.5.1" xref="S3.E11.m1.39.39.39.5.5.5.1.cmml"><mi mathsize="90%" id="S3.E11.m1.39.39.39.5.5.5.1.2" xref="S3.E11.m1.39.39.39.5.5.5.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.39.39.39.5.5.5.1.3" xref="S3.E11.m1.39.39.39.5.5.5.1.3.cmml">i</mi></msub></munder><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2" xref="S3.E11.m1.69.69.7.cmml"><msub id="S3.E11.m1.76.76.14.69.30.30.30.2.2.4" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.40.40.40.6.6.6" xref="S3.E11.m1.40.40.40.6.6.6.cmml">b</mi><mi mathsize="90%" id="S3.E11.m1.41.41.41.7.7.7.1" xref="S3.E11.m1.41.41.41.7.7.7.1.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.76.76.14.69.30.30.30.2.2.3" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.75.75.13.68.29.29.29.1.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.42.42.42.8.8.8" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.75.75.13.68.29.29.29.1.1.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.43.43.43.9.9.9" xref="S3.E11.m1.43.43.43.9.9.9.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.44.44.44.10.10.10.1" xref="S3.E11.m1.44.44.44.10.10.10.1.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.45.45.45.11.11.11" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.76.76.14.69.30.30.30.2.2.3a" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.46.46.46.12.12.12" xref="S3.E11.m1.69.69.7.cmml">[</mo><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1.3" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.47.47.47.13.13.13" xref="S3.E11.m1.47.47.47.13.13.13.cmml">ln</mi><mo lspace="0.167em" id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1.3a" xref="S3.E11.m1.69.69.7.cmml">⁡</mo><msub id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1.3.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.48.48.48.14.14.14" xref="S3.E11.m1.48.48.48.14.14.14.cmml">b</mi><mi mathsize="90%" id="S3.E11.m1.49.49.49.15.15.15.1" xref="S3.E11.m1.49.49.49.15.15.15.1.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1.2" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.50.50.50.16.16.16" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.1.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.51.51.51.17.17.17" xref="S3.E11.m1.51.51.51.17.17.17.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.52.52.52.18.18.18.1" xref="S3.E11.m1.52.52.52.18.18.18.1.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.53.53.53.19.19.19" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E11.m1.54.54.54.20.20.20" xref="S3.E11.m1.54.54.54.20.20.20.cmml">−</mo><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2" xref="S3.E11.m1.69.69.7.cmml"><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2.3" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.55.55.55.21.21.21" xref="S3.E11.m1.55.55.55.21.21.21.cmml">ln</mi><mo lspace="0.167em" id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2.3a" xref="S3.E11.m1.69.69.7.cmml">⁡</mo><msub id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2.3.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.56.56.56.22.22.22" xref="S3.E11.m1.56.56.56.22.22.22.cmml">ψ</mi><mi mathsize="90%" id="S3.E11.m1.57.57.57.23.23.23.1" xref="S3.E11.m1.57.57.57.23.23.23.1.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2.2" xref="S3.E11.m1.69.69.7.cmml">​</mo><mrow id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2.1.1" xref="S3.E11.m1.69.69.7.cmml"><mo maxsize="90%" minsize="90%" id="S3.E11.m1.58.58.58.24.24.24" xref="S3.E11.m1.69.69.7.cmml">(</mo><msub id="S3.E11.m1.76.76.14.69.30.30.30.2.2.2.1.1.2.1.1.1" xref="S3.E11.m1.69.69.7.cmml"><mi mathsize="90%" id="S3.E11.m1.59.59.59.25.25.25" xref="S3.E11.m1.59.59.59.25.25.25.cmml">z</mi><mi mathsize="90%" id="S3.E11.m1.60.60.60.26.26.26.1" xref="S3.E11.m1.60.60.60.26.26.26.1.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E11.m1.61.61.61.27.27.27" xref="S3.E11.m1.69.69.7.cmml">)</mo></mrow></mrow></mrow><mo maxsize="90%" minsize="90%" id="S3.E11.m1.62.62.62.28.28.28" xref="S3.E11.m1.69.69.7.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E11.m1.76b"><apply id="S3.E11.m1.69.69.7.cmml" xref="S3.E11.m1.76.76.14"><eq id="S3.E11.m1.7.7.7.7.7.7.cmml" xref="S3.E11.m1.7.7.7.7.7.7"></eq><apply id="S3.E11.m1.63.63.1.1.cmml" xref="S3.E11.m1.76.76.14"><times id="S3.E11.m1.63.63.1.1.2.cmml" xref="S3.E11.m1.76.76.14"></times><apply id="S3.E11.m1.63.63.1.1.3.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.63.63.1.1.3.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1">𝐹</ci><apply id="S3.E11.m1.2.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1"><times id="S3.E11.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E11.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1.2">𝑀</ci><ci id="S3.E11.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2.1.3">𝐹</ci></apply></apply><apply id="S3.E11.m1.63.63.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.63.63.1.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.4.4.4.4.4.4.cmml" xref="S3.E11.m1.4.4.4.4.4.4">𝑏</ci><ci id="S3.E11.m1.5.5.5.5.5.5.1.cmml" xref="S3.E11.m1.5.5.5.5.5.5.1">𝑖</ci></apply></apply><apply id="S3.E11.m1.69.69.7.7.cmml" xref="S3.E11.m1.76.76.14"><plus id="S3.E11.m1.35.35.35.1.1.1.cmml" xref="S3.E11.m1.76.76.14"></plus><apply id="S3.E11.m1.67.67.5.5.4.cmml" xref="S3.E11.m1.76.76.14"><minus id="S3.E11.m1.8.8.8.8.1.1.cmml" xref="S3.E11.m1.76.76.14"></minus><apply id="S3.E11.m1.67.67.5.5.4.4.cmml" xref="S3.E11.m1.76.76.14"><apply id="S3.E11.m1.67.67.5.5.4.4.5.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.67.67.5.5.4.4.5.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><sum id="S3.E11.m1.9.9.9.9.2.2.cmml" xref="S3.E11.m1.9.9.9.9.2.2"></sum><apply id="S3.E11.m1.10.10.10.10.3.3.1.cmml" xref="S3.E11.m1.10.10.10.10.3.3.1"><in id="S3.E11.m1.10.10.10.10.3.3.1.3.cmml" xref="S3.E11.m1.10.10.10.10.3.3.1.3"></in><interval closure="open" id="S3.E11.m1.10.10.10.10.3.3.1.4.1.cmml" xref="S3.E11.m1.10.10.10.10.3.3.1.4.2"><ci id="S3.E11.m1.10.10.10.10.3.3.1.1.cmml" xref="S3.E11.m1.10.10.10.10.3.3.1.1">𝑖</ci><ci id="S3.E11.m1.10.10.10.10.3.3.1.2.cmml" xref="S3.E11.m1.10.10.10.10.3.3.1.2">𝑗</ci></interval><ci id="S3.E11.m1.10.10.10.10.3.3.1.5.cmml" xref="S3.E11.m1.10.10.10.10.3.3.1.5">𝒩</ci></apply></apply><apply id="S3.E11.m1.67.67.5.5.4.4.4.cmml" xref="S3.E11.m1.76.76.14"><apply id="S3.E11.m1.67.67.5.5.4.4.4.5.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.67.67.5.5.4.4.4.5.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><sum id="S3.E11.m1.11.11.11.11.4.4.cmml" xref="S3.E11.m1.11.11.11.11.4.4"></sum><list id="S3.E11.m1.12.12.12.12.5.5.1.3.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.2"><apply id="S3.E11.m1.12.12.12.12.5.5.1.1.1.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.12.12.12.12.5.5.1.1.1.1.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1">subscript</csymbol><ci id="S3.E11.m1.12.12.12.12.5.5.1.1.1.2.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1.2">𝑧</ci><ci id="S3.E11.m1.12.12.12.12.5.5.1.1.1.3.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.1.1.3">𝑖</ci></apply><apply id="S3.E11.m1.12.12.12.12.5.5.1.2.2.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.12.12.12.12.5.5.1.2.2.1.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2">subscript</csymbol><ci id="S3.E11.m1.12.12.12.12.5.5.1.2.2.2.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2.2">𝑧</ci><ci id="S3.E11.m1.12.12.12.12.5.5.1.2.2.3.cmml" xref="S3.E11.m1.12.12.12.12.5.5.1.2.2.3">𝑗</ci></apply></list></apply><apply id="S3.E11.m1.67.67.5.5.4.4.4.4.cmml" xref="S3.E11.m1.76.76.14"><times id="S3.E11.m1.67.67.5.5.4.4.4.4.5.cmml" xref="S3.E11.m1.76.76.14"></times><apply id="S3.E11.m1.67.67.5.5.4.4.4.4.6.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.67.67.5.5.4.4.4.4.6.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.13.13.13.13.6.6.cmml" xref="S3.E11.m1.13.13.13.13.6.6">𝑏</ci><ci id="S3.E11.m1.14.14.14.14.7.7.1.cmml" xref="S3.E11.m1.14.14.14.14.7.7.1">𝑖</ci></apply><apply id="S3.E11.m1.64.64.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.64.64.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.16.16.16.16.9.9.cmml" xref="S3.E11.m1.16.16.16.16.9.9">𝑧</ci><ci id="S3.E11.m1.17.17.17.17.10.10.1.cmml" xref="S3.E11.m1.17.17.17.17.10.10.1">𝑖</ci></apply><apply id="S3.E11.m1.67.67.5.5.4.4.4.4.7.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.67.67.5.5.4.4.4.4.7.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.19.19.19.19.12.12.cmml" xref="S3.E11.m1.19.19.19.19.12.12">𝑏</ci><ci id="S3.E11.m1.20.20.20.20.13.13.1.cmml" xref="S3.E11.m1.20.20.20.20.13.13.1">𝑗</ci></apply><apply id="S3.E11.m1.65.65.3.3.2.2.2.2.2.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.65.65.3.3.2.2.2.2.2.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.22.22.22.22.15.15.cmml" xref="S3.E11.m1.22.22.22.22.15.15">𝑧</ci><ci id="S3.E11.m1.23.23.23.23.16.16.1.cmml" xref="S3.E11.m1.23.23.23.23.16.16.1">𝑗</ci></apply><apply id="S3.E11.m1.67.67.5.5.4.4.4.4.8.cmml" xref="S3.E11.m1.76.76.14"><ln id="S3.E11.m1.25.25.25.25.18.18.cmml" xref="S3.E11.m1.25.25.25.25.18.18"></ln><apply id="S3.E11.m1.67.67.5.5.4.4.4.4.8.2.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.67.67.5.5.4.4.4.4.8.2.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.26.26.26.26.19.19.cmml" xref="S3.E11.m1.26.26.26.26.19.19">𝜓</ci><apply id="S3.E11.m1.27.27.27.27.20.20.1.cmml" xref="S3.E11.m1.27.27.27.27.20.20.1"><times id="S3.E11.m1.27.27.27.27.20.20.1.1.cmml" xref="S3.E11.m1.27.27.27.27.20.20.1.1"></times><ci id="S3.E11.m1.27.27.27.27.20.20.1.2.cmml" xref="S3.E11.m1.27.27.27.27.20.20.1.2">𝑖</ci><ci id="S3.E11.m1.27.27.27.27.20.20.1.3.cmml" xref="S3.E11.m1.27.27.27.27.20.20.1.3">𝑗</ci></apply></apply></apply><interval closure="open" id="S3.E11.m1.67.67.5.5.4.4.4.4.4.3.cmml" xref="S3.E11.m1.76.76.14"><apply id="S3.E11.m1.66.66.4.4.3.3.3.3.3.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.66.66.4.4.3.3.3.3.3.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.29.29.29.29.22.22.cmml" xref="S3.E11.m1.29.29.29.29.22.22">𝑧</ci><ci id="S3.E11.m1.30.30.30.30.23.23.1.cmml" xref="S3.E11.m1.30.30.30.30.23.23.1">𝑖</ci></apply><apply id="S3.E11.m1.67.67.5.5.4.4.4.4.4.2.2.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.67.67.5.5.4.4.4.4.4.2.2.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.32.32.32.32.25.25.cmml" xref="S3.E11.m1.32.32.32.32.25.25">𝑧</ci><ci id="S3.E11.m1.33.33.33.33.26.26.1.cmml" xref="S3.E11.m1.33.33.33.33.26.26.1">𝑗</ci></apply></interval></apply></apply></apply></apply><apply id="S3.E11.m1.69.69.7.7.6.cmml" xref="S3.E11.m1.76.76.14"><apply id="S3.E11.m1.69.69.7.7.6.3.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.3.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><sum id="S3.E11.m1.36.36.36.2.2.2.cmml" xref="S3.E11.m1.36.36.36.2.2.2"></sum><ci id="S3.E11.m1.37.37.37.3.3.3.1.cmml" xref="S3.E11.m1.37.37.37.3.3.3.1">𝑖</ci></apply><apply id="S3.E11.m1.69.69.7.7.6.2.cmml" xref="S3.E11.m1.76.76.14"><apply id="S3.E11.m1.69.69.7.7.6.2.3.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.2.3.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><sum id="S3.E11.m1.38.38.38.4.4.4.cmml" xref="S3.E11.m1.38.38.38.4.4.4"></sum><apply id="S3.E11.m1.39.39.39.5.5.5.1.cmml" xref="S3.E11.m1.39.39.39.5.5.5.1"><csymbol cd="ambiguous" id="S3.E11.m1.39.39.39.5.5.5.1.1.cmml" xref="S3.E11.m1.39.39.39.5.5.5.1">subscript</csymbol><ci id="S3.E11.m1.39.39.39.5.5.5.1.2.cmml" xref="S3.E11.m1.39.39.39.5.5.5.1.2">𝑧</ci><ci id="S3.E11.m1.39.39.39.5.5.5.1.3.cmml" xref="S3.E11.m1.39.39.39.5.5.5.1.3">𝑖</ci></apply></apply><apply id="S3.E11.m1.69.69.7.7.6.2.2.cmml" xref="S3.E11.m1.76.76.14"><times id="S3.E11.m1.69.69.7.7.6.2.2.3.cmml" xref="S3.E11.m1.76.76.14"></times><apply id="S3.E11.m1.69.69.7.7.6.2.2.4.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.2.2.4.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.40.40.40.6.6.6.cmml" xref="S3.E11.m1.40.40.40.6.6.6">𝑏</ci><ci id="S3.E11.m1.41.41.41.7.7.7.1.cmml" xref="S3.E11.m1.41.41.41.7.7.7.1">𝑖</ci></apply><apply id="S3.E11.m1.68.68.6.6.5.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.68.68.6.6.5.1.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.43.43.43.9.9.9.cmml" xref="S3.E11.m1.43.43.43.9.9.9">𝑧</ci><ci id="S3.E11.m1.44.44.44.10.10.10.1.cmml" xref="S3.E11.m1.44.44.44.10.10.10.1">𝑖</ci></apply><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.2.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="latexml" id="S3.E11.m1.69.69.7.7.6.2.2.2.2.1.cmml" xref="S3.E11.m1.76.76.14">delimited-[]</csymbol><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.cmml" xref="S3.E11.m1.76.76.14"><minus id="S3.E11.m1.54.54.54.20.20.20.cmml" xref="S3.E11.m1.54.54.54.20.20.20"></minus><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.cmml" xref="S3.E11.m1.76.76.14"><times id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.2.cmml" xref="S3.E11.m1.76.76.14"></times><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.3.cmml" xref="S3.E11.m1.76.76.14"><ln id="S3.E11.m1.47.47.47.13.13.13.cmml" xref="S3.E11.m1.47.47.47.13.13.13"></ln><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.3.2.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.3.2.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.48.48.48.14.14.14.cmml" xref="S3.E11.m1.48.48.48.14.14.14">𝑏</ci><ci id="S3.E11.m1.49.49.49.15.15.15.1.cmml" xref="S3.E11.m1.49.49.49.15.15.15.1">𝑖</ci></apply></apply><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.51.51.51.17.17.17.cmml" xref="S3.E11.m1.51.51.51.17.17.17">𝑧</ci><ci id="S3.E11.m1.52.52.52.18.18.18.1.cmml" xref="S3.E11.m1.52.52.52.18.18.18.1">𝑖</ci></apply></apply><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.cmml" xref="S3.E11.m1.76.76.14"><times id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.2.cmml" xref="S3.E11.m1.76.76.14"></times><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.3.cmml" xref="S3.E11.m1.76.76.14"><ln id="S3.E11.m1.55.55.55.21.21.21.cmml" xref="S3.E11.m1.55.55.55.21.21.21"></ln><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.3.2.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.3.2.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.56.56.56.22.22.22.cmml" xref="S3.E11.m1.56.56.56.22.22.22">𝜓</ci><ci id="S3.E11.m1.57.57.57.23.23.23.1.cmml" xref="S3.E11.m1.57.57.57.23.23.23.1">𝑖</ci></apply></apply><apply id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.1.1.1.cmml" xref="S3.E11.m1.76.76.14"><csymbol cd="ambiguous" id="S3.E11.m1.69.69.7.7.6.2.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E11.m1.76.76.14">subscript</csymbol><ci id="S3.E11.m1.59.59.59.25.25.25.cmml" xref="S3.E11.m1.59.59.59.25.25.25">𝑧</ci><ci id="S3.E11.m1.60.60.60.26.26.26.1.cmml" xref="S3.E11.m1.60.60.60.26.26.26.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.76c">\begin{split}F_{MF}({b_{i}})=&amp;-\sum_{(i,j)\in\mathcal{N}}\sum_{z_{i},z_{j}}b_{i}(z_{i})b_{j}(z_{j})\ln\psi_{ij}(z_{i},z_{j})\\
&amp;+\sum_{i}\sum_{z_{i}}b_{i}(z_{i})[\ln b_{i}(z_{i})-\ln\psi_{i}(z_{i})]\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p1.9" class="ltx_p">subject to the constraint <math id="S3.SS3.SSS2.p1.5.m1.1" class="ltx_Math" alttext="\sum_{z_{i}}b_{i}(z_{i})=1" display="inline"><semantics id="S3.SS3.SSS2.p1.5.m1.1a"><mrow id="S3.SS3.SSS2.p1.5.m1.1.1" xref="S3.SS3.SSS2.p1.5.m1.1.1.cmml"><mrow id="S3.SS3.SSS2.p1.5.m1.1.1.1" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.5.m1.1.1.1.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.cmml"><mo id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.2.cmml">∑</mo><msub id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.cmml"><mi id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.3.cmml">i</mi></msub></msub><mrow id="S3.SS3.SSS2.p1.5.m1.1.1.1.1" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS3.SSS2.p1.5.m1.1.1.2" xref="S3.SS3.SSS2.p1.5.m1.1.1.2.cmml">=</mo><mn id="S3.SS3.SSS2.p1.5.m1.1.1.3" xref="S3.SS3.SSS2.p1.5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m1.1b"><apply id="S3.SS3.SSS2.p1.5.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1"><eq id="S3.SS3.SSS2.p1.5.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.2"></eq><apply id="S3.SS3.SSS2.p1.5.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1"><apply id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2">subscript</csymbol><sum id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.2"></sum><apply id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.3.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1"><times id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.2"></times><apply id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.SS3.SSS2.p1.5.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m1.1c">\sum_{z_{i}}b_{i}(z_{i})=1</annotation></semantics></math>, which is shown to be equivalent to minimizing the KL divergence between <math id="S3.SS3.SSS2.p1.6.m2.3" class="ltx_Math" alttext="p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})" display="inline"><semantics id="S3.SS3.SSS2.p1.6.m2.3a"><mrow id="S3.SS3.SSS2.p1.6.m2.3.3" xref="S3.SS3.SSS2.p1.6.m2.3.3.cmml"><mi id="S3.SS3.SSS2.p1.6.m2.3.3.3" xref="S3.SS3.SSS2.p1.6.m2.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.6.m2.3.3.2" xref="S3.SS3.SSS2.p1.6.m2.3.3.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.6.m2.3.3.1.1" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.2" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.2" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.2.cmml">𝐳</mi><mo fence="false" id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.1" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.3.2" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.SS3.SSS2.p1.6.m2.1.1" xref="S3.SS3.SSS2.p1.6.m2.1.1.cmml">𝐗</mi><mo id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.3.2.1" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS3.SSS2.p1.6.m2.2.2" xref="S3.SS3.SSS2.p1.6.m2.2.2.cmml">𝒒</mi></mrow></mrow><mo stretchy="false" id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.3" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.6.m2.3b"><apply id="S3.SS3.SSS2.p1.6.m2.3.3.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3"><times id="S3.SS3.SSS2.p1.6.m2.3.3.2.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3.2"></times><ci id="S3.SS3.SSS2.p1.6.m2.3.3.3.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3.3">𝑝</ci><apply id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.2">𝐳</ci><list id="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.6.m2.3.3.1.1.1.3.2"><ci id="S3.SS3.SSS2.p1.6.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m2.1.1">𝐗</ci><ci id="S3.SS3.SSS2.p1.6.m2.2.2.cmml" xref="S3.SS3.SSS2.p1.6.m2.2.2">𝒒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.6.m2.3c">p(\boldsymbol{\mathrm{z}}|\boldsymbol{\mathrm{X}},\boldsymbol{q})</annotation></semantics></math> and <math id="S3.SS3.SSS2.p1.7.m3.1" class="ltx_Math" alttext="q(\boldsymbol{\mathrm{z}})" display="inline"><semantics id="S3.SS3.SSS2.p1.7.m3.1a"><mrow id="S3.SS3.SSS2.p1.7.m3.1.2" xref="S3.SS3.SSS2.p1.7.m3.1.2.cmml"><mi id="S3.SS3.SSS2.p1.7.m3.1.2.2" xref="S3.SS3.SSS2.p1.7.m3.1.2.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.7.m3.1.2.1" xref="S3.SS3.SSS2.p1.7.m3.1.2.1.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.7.m3.1.2.3.2" xref="S3.SS3.SSS2.p1.7.m3.1.2.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.7.m3.1.2.3.2.1" xref="S3.SS3.SSS2.p1.7.m3.1.2.cmml">(</mo><mi id="S3.SS3.SSS2.p1.7.m3.1.1" xref="S3.SS3.SSS2.p1.7.m3.1.1.cmml">𝐳</mi><mo stretchy="false" id="S3.SS3.SSS2.p1.7.m3.1.2.3.2.2" xref="S3.SS3.SSS2.p1.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.7.m3.1b"><apply id="S3.SS3.SSS2.p1.7.m3.1.2.cmml" xref="S3.SS3.SSS2.p1.7.m3.1.2"><times id="S3.SS3.SSS2.p1.7.m3.1.2.1.cmml" xref="S3.SS3.SSS2.p1.7.m3.1.2.1"></times><ci id="S3.SS3.SSS2.p1.7.m3.1.2.2.cmml" xref="S3.SS3.SSS2.p1.7.m3.1.2.2">𝑞</ci><ci id="S3.SS3.SSS2.p1.7.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m3.1.1">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.7.m3.1c">q(\boldsymbol{\mathrm{z}})</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. Specifically, MF initializes <math id="S3.SS3.SSS2.p1.8.m4.3" class="ltx_Math" alttext="b^{(0)}_{i}(z_{i})=\psi_{i}(z_{i})" display="inline"><semantics id="S3.SS3.SSS2.p1.8.m4.3a"><mrow id="S3.SS3.SSS2.p1.8.m4.3.3" xref="S3.SS3.SSS2.p1.8.m4.3.3.cmml"><mrow id="S3.SS3.SSS2.p1.8.m4.2.2.1" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.cmml"><msubsup id="S3.SS3.SSS2.p1.8.m4.2.2.1.3" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.cmml"><mi id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.2.2" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.2.2.cmml">b</mi><mi id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.3" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p1.8.m4.1.1.1.3" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.8.m4.1.1.1.3.1" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.cmml">(</mo><mn id="S3.SS3.SSS2.p1.8.m4.1.1.1.1" xref="S3.SS3.SSS2.p1.8.m4.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS3.SSS2.p1.8.m4.1.1.1.3.2" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.8.m4.2.2.1.2" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.2" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.2" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.3" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.3" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS2.p1.8.m4.3.3.3" xref="S3.SS3.SSS2.p1.8.m4.3.3.3.cmml">=</mo><mrow id="S3.SS3.SSS2.p1.8.m4.3.3.2" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.cmml"><msub id="S3.SS3.SSS2.p1.8.m4.3.3.2.3" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3.cmml"><mi id="S3.SS3.SSS2.p1.8.m4.3.3.2.3.2" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3.2.cmml">ψ</mi><mi id="S3.SS3.SSS2.p1.8.m4.3.3.2.3.3" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.8.m4.3.3.2.2" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.2" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.2" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.3" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.3" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.8.m4.3b"><apply id="S3.SS3.SSS2.p1.8.m4.3.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3"><eq id="S3.SS3.SSS2.p1.8.m4.3.3.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.3"></eq><apply id="S3.SS3.SSS2.p1.8.m4.2.2.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1"><times id="S3.SS3.SSS2.p1.8.m4.2.2.1.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.2"></times><apply id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3">subscript</csymbol><apply id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.2.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.2.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.2.2">𝑏</ci><cn type="integer" id="S3.SS3.SSS2.p1.8.m4.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.1.1.1.1">0</cn></apply><ci id="S3.SS3.SSS2.p1.8.m4.2.2.1.3.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.SSS2.p1.8.m4.3.3.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2"><times id="S3.SS3.SSS2.p1.8.m4.3.3.2.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.2"></times><apply id="S3.SS3.SSS2.p1.8.m4.3.3.2.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m4.3.3.2.3.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m4.3.3.2.3.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3.2">𝜓</ci><ci id="S3.SS3.SSS2.p1.8.m4.3.3.2.3.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.8.m4.3.3.2.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.8.m4.3c">b^{(0)}_{i}(z_{i})=\psi_{i}(z_{i})</annotation></semantics></math> and updates <math id="S3.SS3.SSS2.p1.9.m5.2" class="ltx_Math" alttext="b_{i}^{(t)}(z_{i})" display="inline"><semantics id="S3.SS3.SSS2.p1.9.m5.2a"><mrow id="S3.SS3.SSS2.p1.9.m5.2.2" xref="S3.SS3.SSS2.p1.9.m5.2.2.cmml"><msubsup id="S3.SS3.SSS2.p1.9.m5.2.2.3" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.cmml"><mi id="S3.SS3.SSS2.p1.9.m5.2.2.3.2.2" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.2.2.cmml">b</mi><mi id="S3.SS3.SSS2.p1.9.m5.2.2.3.2.3" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.2.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p1.9.m5.1.1.1.3" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.9.m5.1.1.1.3.1" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.cmml">(</mo><mi id="S3.SS3.SSS2.p1.9.m5.1.1.1.1" xref="S3.SS3.SSS2.p1.9.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS3.SSS2.p1.9.m5.1.1.1.3.2" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.9.m5.2.2.2" xref="S3.SS3.SSS2.p1.9.m5.2.2.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.9.m5.2.2.1.1" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.2" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.2" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.3" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.3" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.9.m5.2b"><apply id="S3.SS3.SSS2.p1.9.m5.2.2.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2"><times id="S3.SS3.SSS2.p1.9.m5.2.2.2.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.2"></times><apply id="S3.SS3.SSS2.p1.9.m5.2.2.3.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.9.m5.2.2.3.1.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.3">superscript</csymbol><apply id="S3.SS3.SSS2.p1.9.m5.2.2.3.2.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.9.m5.2.2.3.2.1.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.9.m5.2.2.3.2.2.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.2.2">𝑏</ci><ci id="S3.SS3.SSS2.p1.9.m5.2.2.3.2.3.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.3.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS2.p1.9.m5.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.9.m5.1.1.1.1">𝑡</ci></apply><apply id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.9.m5.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.9.m5.2c">b_{i}^{(t)}(z_{i})</annotation></semantics></math> as:
<span id="S3.SS3.SSS2.p1.9.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.4" class="ltx_Math" alttext="b_{i}^{(t)}(z_{i})=\alpha\psi_{i}(z_{i})\cdot\exp\left(\sum_{j\in N_{i}}\sum_{z_{j}}b_{j}^{(t-1)}(z_{j})\ln\psi_{ij}(z_{i},z_{j})\right)," display="block"><semantics id="S3.E12.m1.4a"><mrow id="S3.E12.m1.4.4.1" xref="S3.E12.m1.4.4.1.1.cmml"><mrow id="S3.E12.m1.4.4.1.1" xref="S3.E12.m1.4.4.1.1.cmml"><mrow id="S3.E12.m1.4.4.1.1.1" xref="S3.E12.m1.4.4.1.1.1.cmml"><msubsup id="S3.E12.m1.4.4.1.1.1.3" xref="S3.E12.m1.4.4.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.1.3.2.2" xref="S3.E12.m1.4.4.1.1.1.3.2.2.cmml">b</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.1.3.2.3" xref="S3.E12.m1.4.4.1.1.1.3.2.3.cmml">i</mi><mrow id="S3.E12.m1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E12.m1.1.1.1.3.1" xref="S3.E12.m1.4.4.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="S3.E12.m1.1.1.1.3.2" xref="S3.E12.m1.4.4.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.4.4.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E12.m1.4.4.1.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E12.m1.4.4.1.1.4" xref="S3.E12.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E12.m1.4.4.1.1.3" xref="S3.E12.m1.4.4.1.1.3.cmml"><mrow id="S3.E12.m1.4.4.1.1.2.1" xref="S3.E12.m1.4.4.1.1.2.1.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.2.1.3" xref="S3.E12.m1.4.4.1.1.2.1.3.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.1.2.1.2" xref="S3.E12.m1.4.4.1.1.2.1.2.cmml">​</mo><msub id="S3.E12.m1.4.4.1.1.2.1.4" xref="S3.E12.m1.4.4.1.1.2.1.4.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.2.1.4.2" xref="S3.E12.m1.4.4.1.1.2.1.4.2.cmml">ψ</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.2.1.4.3" xref="S3.E12.m1.4.4.1.1.2.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.1.2.1.2a" xref="S3.E12.m1.4.4.1.1.2.1.2.cmml">​</mo><mrow id="S3.E12.m1.4.4.1.1.2.1.1.1" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.2.1.1.1.2" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><msub id="S3.E12.m1.4.4.1.1.2.1.1.1.1" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.2.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.2.1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.E12.m1.4.4.1.1.2.1.1.1.3" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="S3.E12.m1.4.4.1.1.3.3" xref="S3.E12.m1.4.4.1.1.3.3.cmml">⋅</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1" xref="S3.E12.m1.4.4.1.1.3.2.2.cmml"><mi mathsize="90%" id="S3.E12.m1.3.3" xref="S3.E12.m1.3.3.cmml">exp</mi><mo id="S3.E12.m1.4.4.1.1.3.2.1a" xref="S3.E12.m1.4.4.1.1.3.2.2.cmml">⁡</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1" xref="S3.E12.m1.4.4.1.1.3.2.2.cmml"><mo id="S3.E12.m1.4.4.1.1.3.2.1.1.2" xref="S3.E12.m1.4.4.1.1.3.2.2.cmml">(</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.cmml"><munder id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.cmml"><mo lspace="0em" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.2.cmml">∑</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.2.cmml">j</mi><mo mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.1.cmml">∈</mo><msub id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.2.cmml">N</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.cmml"><munder id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.2.cmml">∑</mo><msub id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.2.cmml">z</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.3.cmml">j</mi></msub></munder><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.cmml"><msubsup id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.2.cmml">b</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.3.cmml">j</mi><mrow id="S3.E12.m1.2.2.1.1" xref="S3.E12.m1.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E12.m1.2.2.1.1.2" xref="S3.E12.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.2.2.1.1.1" xref="S3.E12.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="S3.E12.m1.2.2.1.1.1.2" xref="S3.E12.m1.2.2.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="S3.E12.m1.2.2.1.1.1.1" xref="S3.E12.m1.2.2.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="S3.E12.m1.2.2.1.1.1.3" xref="S3.E12.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S3.E12.m1.2.2.1.1.3" xref="S3.E12.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4.cmml">​</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4a" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4.cmml">​</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.1.cmml">ln</mi><mo lspace="0.167em" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6a" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.cmml">⁡</mo><msub id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.2.cmml">ψ</mi><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.3.cmml">j</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4b" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4.cmml">​</mo><mrow id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.3.cmml">(</mo><msub id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.4" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.3.cmml">,</mo><msub id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.cmml"><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.2" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.2.cmml">z</mi><mi mathsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.3" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.5" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E12.m1.4.4.1.1.3.2.1.1.3" xref="S3.E12.m1.4.4.1.1.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S3.E12.m1.4.4.1.2" xref="S3.E12.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.4b"><apply id="S3.E12.m1.4.4.1.1.cmml" xref="S3.E12.m1.4.4.1"><eq id="S3.E12.m1.4.4.1.1.4.cmml" xref="S3.E12.m1.4.4.1.1.4"></eq><apply id="S3.E12.m1.4.4.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1"><times id="S3.E12.m1.4.4.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.1.2"></times><apply id="S3.E12.m1.4.4.1.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.1.3.1.cmml" xref="S3.E12.m1.4.4.1.1.1.3">superscript</csymbol><apply id="S3.E12.m1.4.4.1.1.1.3.2.cmml" xref="S3.E12.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.E12.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.1.3.2.2.cmml" xref="S3.E12.m1.4.4.1.1.1.3.2.2">𝑏</ci><ci id="S3.E12.m1.4.4.1.1.1.3.2.3.cmml" xref="S3.E12.m1.4.4.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E12.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E12.m1.4.4.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.3"><ci id="S3.E12.m1.4.4.1.1.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.3">⋅</ci><apply id="S3.E12.m1.4.4.1.1.2.1.cmml" xref="S3.E12.m1.4.4.1.1.2.1"><times id="S3.E12.m1.4.4.1.1.2.1.2.cmml" xref="S3.E12.m1.4.4.1.1.2.1.2"></times><ci id="S3.E12.m1.4.4.1.1.2.1.3.cmml" xref="S3.E12.m1.4.4.1.1.2.1.3">𝛼</ci><apply id="S3.E12.m1.4.4.1.1.2.1.4.cmml" xref="S3.E12.m1.4.4.1.1.2.1.4"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.2.1.4.1.cmml" xref="S3.E12.m1.4.4.1.1.2.1.4">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.2.1.4.2.cmml" xref="S3.E12.m1.4.4.1.1.2.1.4.2">𝜓</ci><ci id="S3.E12.m1.4.4.1.1.2.1.4.3.cmml" xref="S3.E12.m1.4.4.1.1.2.1.4.3">𝑖</ci></apply><apply id="S3.E12.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.4.4.1.1.2.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E12.m1.4.4.1.1.3.2.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1"><exp id="S3.E12.m1.3.3.cmml" xref="S3.E12.m1.3.3"></exp><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1"><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4">subscript</csymbol><sum id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.2"></sum><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3"><in id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.1"></in><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.2">𝑗</ci><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.2">𝑁</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.4.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3"><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4">subscript</csymbol><sum id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.2"></sum><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.2">𝑧</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.4.3.3">𝑗</ci></apply></apply><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3"><times id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.4"></times><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5">superscript</csymbol><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.2">𝑏</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.5.2.3">𝑗</ci></apply><apply id="S3.E12.m1.2.2.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1"><minus id="S3.E12.m1.2.2.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1"></minus><ci id="S3.E12.m1.2.2.1.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E12.m1.2.2.1.1.1.3.cmml" xref="S3.E12.m1.2.2.1.1.1.3">1</cn></apply></apply><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6"><ln id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.1"></ln><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.2">𝜓</ci><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3"><times id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.1"></times><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.2">𝑖</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.6.2.3.3">𝑗</ci></apply></apply></apply><interval closure="open" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2"><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.2">𝑧</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.2.2.2.1.1.3">𝑖</ci></apply><apply id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.1.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2">subscript</csymbol><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.2.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.2">𝑧</ci><ci id="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.3.cmml" xref="S3.E12.m1.4.4.1.1.3.2.1.1.1.3.3.3.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.4c">b_{i}^{(t)}(z_{i})=\alpha\psi_{i}(z_{i})\cdot\exp\left(\sum_{j\in N_{i}}\sum_{z_{j}}b_{j}^{(t-1)}(z_{j})\ln\psi_{ij}(z_{i},z_{j})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p1.11" class="ltx_p">where <math id="S3.SS3.SSS2.p1.10.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.SSS2.p1.10.m1.1a"><mi id="S3.SS3.SSS2.p1.10.m1.1.1" xref="S3.SS3.SSS2.p1.10.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.10.m1.1b"><ci id="S3.SS3.SSS2.p1.10.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.10.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.10.m1.1c">\alpha</annotation></semantics></math> is the normalizing constant. Since Eq. <a href="#S3.E12" title="In 3.3.2 Mean Field Layers ‣ 3.3 Recurrent Inference Layers ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> only involves <math id="S3.SS3.SSS2.p1.11.m2.2" class="ltx_Math" alttext="\ln\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS3.SSS2.p1.11.m2.2a"><mrow id="S3.SS3.SSS2.p1.11.m2.2.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.cmml"><mrow id="S3.SS3.SSS2.p1.11.m2.2.2.4" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.cmml"><mi id="S3.SS3.SSS2.p1.11.m2.2.2.4.1" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S3.SS3.SSS2.p1.11.m2.2.2.4a" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.cmml">⁡</mo><msub id="S3.SS3.SSS2.p1.11.m2.2.2.4.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.cmml"><mi id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.2.cmml">ψ</mi><mrow id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.cmml"><mi id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.1" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.3" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.3.cmml">j</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.11.m2.2.2.3" xref="S3.SS3.SSS2.p1.11.m2.2.2.3.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.11.m2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.4" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.5" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.11.m2.2b"><apply id="S3.SS3.SSS2.p1.11.m2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2"><times id="S3.SS3.SSS2.p1.11.m2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.3"></times><apply id="S3.SS3.SSS2.p1.11.m2.2.2.4.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4"><ln id="S3.SS3.SSS2.p1.11.m2.2.2.4.1.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.1"></ln><apply id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.1.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.2">𝜓</ci><apply id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3"><times id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.1.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.1"></times><ci id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.2">𝑖</ci><ci id="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.3.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.4.2.3.3">𝑗</ci></apply></apply></apply><interval closure="open" id="S3.SS3.SSS2.p1.11.m2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2"><apply id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.11.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.11.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.11.m2.2c">\ln\psi_{ij}(z_{i},z_{j})</annotation></semantics></math>, we adopt a log model for pairwise potential,</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.4" class="ltx_Math" alttext="\ln\psi_{ij}(z_{i},z_{j})=\mathrm{tanh}(\boldsymbol{\mathrm{v}}_{z_{i},z_{j}}g(\boldsymbol{\mathrm{y}}_{ij},\boldsymbol{q};\boldsymbol{\mathrm{V}}_{y},\boldsymbol{\mathrm{V}}_{q}))." display="block"><semantics id="S3.E13.m1.4a"><mrow id="S3.E13.m1.4.4.1" xref="S3.E13.m1.4.4.1.1.cmml"><mrow id="S3.E13.m1.4.4.1.1" xref="S3.E13.m1.4.4.1.1.cmml"><mrow id="S3.E13.m1.4.4.1.1.2" xref="S3.E13.m1.4.4.1.1.2.cmml"><mrow id="S3.E13.m1.4.4.1.1.2.4" xref="S3.E13.m1.4.4.1.1.2.4.cmml"><mi id="S3.E13.m1.4.4.1.1.2.4.1" xref="S3.E13.m1.4.4.1.1.2.4.1.cmml">ln</mi><mo lspace="0.167em" id="S3.E13.m1.4.4.1.1.2.4a" xref="S3.E13.m1.4.4.1.1.2.4.cmml">⁡</mo><msub id="S3.E13.m1.4.4.1.1.2.4.2" xref="S3.E13.m1.4.4.1.1.2.4.2.cmml"><mi id="S3.E13.m1.4.4.1.1.2.4.2.2" xref="S3.E13.m1.4.4.1.1.2.4.2.2.cmml">ψ</mi><mrow id="S3.E13.m1.4.4.1.1.2.4.2.3" xref="S3.E13.m1.4.4.1.1.2.4.2.3.cmml"><mi id="S3.E13.m1.4.4.1.1.2.4.2.3.2" xref="S3.E13.m1.4.4.1.1.2.4.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.2.4.2.3.1" xref="S3.E13.m1.4.4.1.1.2.4.2.3.1.cmml">​</mo><mi id="S3.E13.m1.4.4.1.1.2.4.2.3.3" xref="S3.E13.m1.4.4.1.1.2.4.2.3.3.cmml">j</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.2.3" xref="S3.E13.m1.4.4.1.1.2.3.cmml">​</mo><mrow id="S3.E13.m1.4.4.1.1.2.2.2" xref="S3.E13.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.2.2.2.3" xref="S3.E13.m1.4.4.1.1.2.2.3.cmml">(</mo><msub id="S3.E13.m1.4.4.1.1.1.1.1.1" xref="S3.E13.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.4.4.1.1.1.1.1.1.2" xref="S3.E13.m1.4.4.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E13.m1.4.4.1.1.1.1.1.1.3" xref="S3.E13.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E13.m1.4.4.1.1.2.2.2.4" xref="S3.E13.m1.4.4.1.1.2.2.3.cmml">,</mo><msub id="S3.E13.m1.4.4.1.1.2.2.2.2" xref="S3.E13.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E13.m1.4.4.1.1.2.2.2.2.2" xref="S3.E13.m1.4.4.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E13.m1.4.4.1.1.2.2.2.2.3" xref="S3.E13.m1.4.4.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.2.2.2.5" xref="S3.E13.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.4.4.1.1.4" xref="S3.E13.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E13.m1.4.4.1.1.3" xref="S3.E13.m1.4.4.1.1.3.cmml"><mi id="S3.E13.m1.4.4.1.1.3.3" xref="S3.E13.m1.4.4.1.1.3.3.cmml">tanh</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.3.2" xref="S3.E13.m1.4.4.1.1.3.2.cmml">​</mo><mrow id="S3.E13.m1.4.4.1.1.3.1.1" xref="S3.E13.m1.4.4.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.3.1.1.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.4.4.1.1.3.1.1.1" xref="S3.E13.m1.4.4.1.1.3.1.1.1.cmml"><msub id="S3.E13.m1.4.4.1.1.3.1.1.1.5" xref="S3.E13.m1.4.4.1.1.3.1.1.1.5.cmml"><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.5.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.5.2.cmml">𝐯</mi><mrow id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.3.cmml"><msub id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E13.m1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E13.m1.2.2.2.2.3" xref="S3.E13.m1.2.2.2.3.cmml">,</mo><msub id="S3.E13.m1.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.2.cmml"><mi id="S3.E13.m1.2.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E13.m1.2.2.2.2.2.3" xref="S3.E13.m1.2.2.2.2.2.3.cmml">j</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.3.1.1.1.4" xref="S3.E13.m1.4.4.1.1.3.1.1.1.4.cmml">​</mo><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.6" xref="S3.E13.m1.4.4.1.1.3.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.3.1.1.1.4a" xref="S3.E13.m1.4.4.1.1.3.1.1.1.4.cmml">​</mo><mrow id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml"><mo stretchy="false" id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.4" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml">(</mo><msub id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.1" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.5" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml">,</mo><mi id="S3.E13.m1.3.3" xref="S3.E13.m1.3.3.cmml">𝒒</mi><mo id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.6" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml">;</mo><msub id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.cmml"><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.2.cmml">𝐕</mi><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.3.cmml">y</mi></msub><mo id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.7" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml">,</mo><msub id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.cmml"><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.2" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.2.cmml">𝐕</mi><mi id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.3.cmml">q</mi></msub><mo stretchy="false" id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.8" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E13.m1.4.4.1.1.3.1.1.3" xref="S3.E13.m1.4.4.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E13.m1.4.4.1.2" xref="S3.E13.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.4b"><apply id="S3.E13.m1.4.4.1.1.cmml" xref="S3.E13.m1.4.4.1"><eq id="S3.E13.m1.4.4.1.1.4.cmml" xref="S3.E13.m1.4.4.1.1.4"></eq><apply id="S3.E13.m1.4.4.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.2"><times id="S3.E13.m1.4.4.1.1.2.3.cmml" xref="S3.E13.m1.4.4.1.1.2.3"></times><apply id="S3.E13.m1.4.4.1.1.2.4.cmml" xref="S3.E13.m1.4.4.1.1.2.4"><ln id="S3.E13.m1.4.4.1.1.2.4.1.cmml" xref="S3.E13.m1.4.4.1.1.2.4.1"></ln><apply id="S3.E13.m1.4.4.1.1.2.4.2.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.2.4.2.1.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.2.4.2.2.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2.2">𝜓</ci><apply id="S3.E13.m1.4.4.1.1.2.4.2.3.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2.3"><times id="S3.E13.m1.4.4.1.1.2.4.2.3.1.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2.3.1"></times><ci id="S3.E13.m1.4.4.1.1.2.4.2.3.2.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2.3.2">𝑖</ci><ci id="S3.E13.m1.4.4.1.1.2.4.2.3.3.cmml" xref="S3.E13.m1.4.4.1.1.2.4.2.3.3">𝑗</ci></apply></apply></apply><interval closure="open" id="S3.E13.m1.4.4.1.1.2.2.3.cmml" xref="S3.E13.m1.4.4.1.1.2.2.2"><apply id="S3.E13.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E13.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E13.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E13.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E13.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E13.m1.4.4.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E13.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E13.m1.4.4.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E13.m1.4.4.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.3"><times id="S3.E13.m1.4.4.1.1.3.2.cmml" xref="S3.E13.m1.4.4.1.1.3.2"></times><ci id="S3.E13.m1.4.4.1.1.3.3.cmml" xref="S3.E13.m1.4.4.1.1.3.3">tanh</ci><apply id="S3.E13.m1.4.4.1.1.3.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1"><times id="S3.E13.m1.4.4.1.1.3.1.1.1.4.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.4"></times><apply id="S3.E13.m1.4.4.1.1.3.1.1.1.5.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.5"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.3.1.1.1.5.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.5">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.5.2.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.5.2">𝐯</ci><list id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2"><apply id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E13.m1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E13.m1.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E13.m1.2.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E13.m1.2.2.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2.3">𝑗</ci></apply></list></apply><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.6.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.6">𝑔</ci><vector id="S3.E13.m1.4.4.1.1.3.1.1.1.3.4.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3"><apply id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.2">𝐲</ci><apply id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3"><times id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.1"></times><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.E13.m1.3.3.cmml" xref="S3.E13.m1.3.3">𝒒</ci><apply id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.2">𝐕</ci><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.2.2.2.3">𝑦</ci></apply><apply id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.2">𝐕</ci><ci id="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.4.4.1.1.3.1.1.1.3.3.3.3">𝑞</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.4c">\ln\psi_{ij}(z_{i},z_{j})=\mathrm{tanh}(\boldsymbol{\mathrm{v}}_{z_{i},z_{j}}g(\boldsymbol{\mathrm{y}}_{ij},\boldsymbol{q};\boldsymbol{\mathrm{V}}_{y},\boldsymbol{\mathrm{V}}_{q})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS2.p1.14" class="ltx_p">MF can be unfolded as a recurrent layer of neural networks without parameters, where in each step <math id="S3.SS3.SSS2.p1.12.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.SSS2.p1.12.m1.1a"><mi id="S3.SS3.SSS2.p1.12.m1.1.1" xref="S3.SS3.SSS2.p1.12.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.12.m1.1b"><ci id="S3.SS3.SSS2.p1.12.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.12.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.12.m1.1c">t</annotation></semantics></math> the inputs are <math id="S3.SS3.SSS2.p1.13.m2.2" class="ltx_Math" alttext="\psi_{i}(z_{i}),\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS3.SSS2.p1.13.m2.2a"><mrow id="S3.SS3.SSS2.p1.13.m2.2.2.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.3.cmml"><mrow id="S3.SS3.SSS2.p1.13.m2.1.1.1.1" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.2" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.3" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.2" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS2.p1.13.m2.2.2.2.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.3.cmml">,</mo><mrow id="S3.SS3.SSS2.p1.13.m2.2.2.2.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.cmml"><msub id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.cmml"><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.cmml"><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.1" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.3.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.4" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.5" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.13.m2.2b"><list id="S3.SS3.SSS2.p1.13.m2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2"><apply id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1"><times id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.2"></times><apply id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.2">𝜓</ci><ci id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2"><times id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.3"></times><apply id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.2">𝜓</ci><apply id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3"><times id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.1"></times><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2"><apply id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS2.p1.13.m2.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.13.m2.2c">\psi_{i}(z_{i}),\psi_{ij}(z_{i},z_{j})</annotation></semantics></math> and <math id="S3.SS3.SSS2.p1.14.m3.2" class="ltx_Math" alttext="b_{i}^{(t-1)}(z_{i})" display="inline"><semantics id="S3.SS3.SSS2.p1.14.m3.2a"><mrow id="S3.SS3.SSS2.p1.14.m3.2.2" xref="S3.SS3.SSS2.p1.14.m3.2.2.cmml"><msubsup id="S3.SS3.SSS2.p1.14.m3.2.2.3" xref="S3.SS3.SSS2.p1.14.m3.2.2.3.cmml"><mi id="S3.SS3.SSS2.p1.14.m3.2.2.3.2.2" xref="S3.SS3.SSS2.p1.14.m3.2.2.3.2.2.cmml">b</mi><mi id="S3.SS3.SSS2.p1.14.m3.2.2.3.2.3" xref="S3.SS3.SSS2.p1.14.m3.2.2.3.2.3.cmml">i</mi><mrow id="S3.SS3.SSS2.p1.14.m3.1.1.1.1" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.2" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.3" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSS2.p1.14.m3.2.2.2" xref="S3.SS3.SSS2.p1.14.m3.2.2.2.cmml">​</mo><mrow id="S3.SS3.SSS2.p1.14.m3.2.2.1.1" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.2" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.2" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.3" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.3" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.14.m3.2b"><apply id="S3.SS3.SSS2.p1.14.m3.2.2.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2"><times id="S3.SS3.SSS2.p1.14.m3.2.2.2.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.2"></times><apply id="S3.SS3.SSS2.p1.14.m3.2.2.3.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.14.m3.2.2.3.1.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.3">superscript</csymbol><apply id="S3.SS3.SSS2.p1.14.m3.2.2.3.2.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.14.m3.2.2.3.2.1.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS2.p1.14.m3.2.2.3.2.2.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.3.2.2">𝑏</ci><ci id="S3.SS3.SSS2.p1.14.m3.2.2.3.2.3.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.3.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1"><minus id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.1"></minus><ci id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.14.m3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.14.m3.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.14.m3.2c">b_{i}^{(t-1)}(z_{i})</annotation></semantics></math>, as demonstrated by Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.3.2 Mean Field Layers ‣ 3.3 Recurrent Inference Layers ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S3.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Loopy Belief Propagation Layers</h4>

<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="alg2.6.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> LBP Recurrent Layer in VQA</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.2" class="ltx_p ltx_figure_panel"><span id="alg2.2.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Input:<span id="alg2.2.2.2" class="ltx_text ltx_font_medium">
<math id="alg2.1.1.1.m1.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="alg2.1.1.1.m1.1a"><mrow id="alg2.1.1.1.m1.1.1" xref="alg2.1.1.1.m1.1.1.cmml"><msub id="alg2.1.1.1.m1.1.1.3" xref="alg2.1.1.1.m1.1.1.3.cmml"><mi id="alg2.1.1.1.m1.1.1.3.2" xref="alg2.1.1.1.m1.1.1.3.2.cmml">ψ</mi><mi id="alg2.1.1.1.m1.1.1.3.3" xref="alg2.1.1.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.1.1.1.m1.1.1.2" xref="alg2.1.1.1.m1.1.1.2.cmml">​</mo><mrow id="alg2.1.1.1.m1.1.1.1.1" xref="alg2.1.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.1.1.1.m1.1.1.1.1.2" xref="alg2.1.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="alg2.1.1.1.m1.1.1.1.1.1" xref="alg2.1.1.1.m1.1.1.1.1.1.cmml"><mi id="alg2.1.1.1.m1.1.1.1.1.1.2" xref="alg2.1.1.1.m1.1.1.1.1.1.2.cmml">z</mi><mi id="alg2.1.1.1.m1.1.1.1.1.1.3" xref="alg2.1.1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.1.1.1.m1.1.1.1.1.3" xref="alg2.1.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.1.1.m1.1b"><apply id="alg2.1.1.1.m1.1.1.cmml" xref="alg2.1.1.1.m1.1.1"><times id="alg2.1.1.1.m1.1.1.2.cmml" xref="alg2.1.1.1.m1.1.1.2"></times><apply id="alg2.1.1.1.m1.1.1.3.cmml" xref="alg2.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.1.1.1.m1.1.1.3.1.cmml" xref="alg2.1.1.1.m1.1.1.3">subscript</csymbol><ci id="alg2.1.1.1.m1.1.1.3.2.cmml" xref="alg2.1.1.1.m1.1.1.3.2">𝜓</ci><ci id="alg2.1.1.1.m1.1.1.3.3.cmml" xref="alg2.1.1.1.m1.1.1.3.3">𝑖</ci></apply><apply id="alg2.1.1.1.m1.1.1.1.1.1.cmml" xref="alg2.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.1.1.1.m1.1.1.1.1.1.1.cmml" xref="alg2.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="alg2.1.1.1.m1.1.1.1.1.1.2.cmml" xref="alg2.1.1.1.m1.1.1.1.1.1.2">𝑧</ci><ci id="alg2.1.1.1.m1.1.1.1.1.1.3.cmml" xref="alg2.1.1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.1.1.m1.1c">\psi_{i}(z_{i})</annotation></semantics></math>, <math id="alg2.2.2.2.m2.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="alg2.2.2.2.m2.2a"><mrow id="alg2.2.2.2.m2.2.2" xref="alg2.2.2.2.m2.2.2.cmml"><msub id="alg2.2.2.2.m2.2.2.4" xref="alg2.2.2.2.m2.2.2.4.cmml"><mi id="alg2.2.2.2.m2.2.2.4.2" xref="alg2.2.2.2.m2.2.2.4.2.cmml">ψ</mi><mrow id="alg2.2.2.2.m2.2.2.4.3" xref="alg2.2.2.2.m2.2.2.4.3.cmml"><mi id="alg2.2.2.2.m2.2.2.4.3.2" xref="alg2.2.2.2.m2.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.2.2.2.m2.2.2.4.3.1" xref="alg2.2.2.2.m2.2.2.4.3.1.cmml">​</mo><mi id="alg2.2.2.2.m2.2.2.4.3.3" xref="alg2.2.2.2.m2.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.2.2.2.m2.2.2.3" xref="alg2.2.2.2.m2.2.2.3.cmml">​</mo><mrow id="alg2.2.2.2.m2.2.2.2.2" xref="alg2.2.2.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.2.2.2.m2.2.2.2.2.3" xref="alg2.2.2.2.m2.2.2.2.3.cmml">(</mo><msub id="alg2.2.2.2.m2.1.1.1.1.1" xref="alg2.2.2.2.m2.1.1.1.1.1.cmml"><mi id="alg2.2.2.2.m2.1.1.1.1.1.2" xref="alg2.2.2.2.m2.1.1.1.1.1.2.cmml">z</mi><mi id="alg2.2.2.2.m2.1.1.1.1.1.3" xref="alg2.2.2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.2.2.2.m2.2.2.2.2.4" xref="alg2.2.2.2.m2.2.2.2.3.cmml">,</mo><msub id="alg2.2.2.2.m2.2.2.2.2.2" xref="alg2.2.2.2.m2.2.2.2.2.2.cmml"><mi id="alg2.2.2.2.m2.2.2.2.2.2.2" xref="alg2.2.2.2.m2.2.2.2.2.2.2.cmml">z</mi><mi id="alg2.2.2.2.m2.2.2.2.2.2.3" xref="alg2.2.2.2.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="alg2.2.2.2.m2.2.2.2.2.5" xref="alg2.2.2.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.2.2.2.m2.2b"><apply id="alg2.2.2.2.m2.2.2.cmml" xref="alg2.2.2.2.m2.2.2"><times id="alg2.2.2.2.m2.2.2.3.cmml" xref="alg2.2.2.2.m2.2.2.3"></times><apply id="alg2.2.2.2.m2.2.2.4.cmml" xref="alg2.2.2.2.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.2.2.2.m2.2.2.4.1.cmml" xref="alg2.2.2.2.m2.2.2.4">subscript</csymbol><ci id="alg2.2.2.2.m2.2.2.4.2.cmml" xref="alg2.2.2.2.m2.2.2.4.2">𝜓</ci><apply id="alg2.2.2.2.m2.2.2.4.3.cmml" xref="alg2.2.2.2.m2.2.2.4.3"><times id="alg2.2.2.2.m2.2.2.4.3.1.cmml" xref="alg2.2.2.2.m2.2.2.4.3.1"></times><ci id="alg2.2.2.2.m2.2.2.4.3.2.cmml" xref="alg2.2.2.2.m2.2.2.4.3.2">𝑖</ci><ci id="alg2.2.2.2.m2.2.2.4.3.3.cmml" xref="alg2.2.2.2.m2.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="alg2.2.2.2.m2.2.2.2.3.cmml" xref="alg2.2.2.2.m2.2.2.2.2"><apply id="alg2.2.2.2.m2.1.1.1.1.1.cmml" xref="alg2.2.2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.2.2.2.m2.1.1.1.1.1.1.cmml" xref="alg2.2.2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="alg2.2.2.2.m2.1.1.1.1.1.2.cmml" xref="alg2.2.2.2.m2.1.1.1.1.1.2">𝑧</ci><ci id="alg2.2.2.2.m2.1.1.1.1.1.3.cmml" xref="alg2.2.2.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.2.2.2.m2.2.2.2.2.2.cmml" xref="alg2.2.2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.2.2.2.m2.2.2.2.2.2.1.cmml" xref="alg2.2.2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="alg2.2.2.2.m2.2.2.2.2.2.2.cmml" xref="alg2.2.2.2.m2.2.2.2.2.2.2">𝑧</ci><ci id="alg2.2.2.2.m2.2.2.2.2.2.3.cmml" xref="alg2.2.2.2.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.2.2.m2.2c">\psi_{ij}(z_{i},z_{j})</annotation></semantics></math></span></span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.7" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span id="alg2.l1.1" class="ltx_text" style="font-size:90%;">initialize </span><math id="alg2.l1.m1.2" class="ltx_Math" alttext="m_{ij}^{(0)}(z_{j})=0.5" display="inline"><semantics id="alg2.l1.m1.2a"><mrow id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml"><mrow id="alg2.l1.m1.2.2.1" xref="alg2.l1.m1.2.2.1.cmml"><msubsup id="alg2.l1.m1.2.2.1.3" xref="alg2.l1.m1.2.2.1.3.cmml"><mi mathsize="90%" id="alg2.l1.m1.2.2.1.3.2.2" xref="alg2.l1.m1.2.2.1.3.2.2.cmml">m</mi><mrow id="alg2.l1.m1.2.2.1.3.2.3" xref="alg2.l1.m1.2.2.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l1.m1.2.2.1.3.2.3.2" xref="alg2.l1.m1.2.2.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.2.2.1.3.2.3.1" xref="alg2.l1.m1.2.2.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l1.m1.2.2.1.3.2.3.3" xref="alg2.l1.m1.2.2.1.3.2.3.3.cmml">j</mi></mrow><mrow id="alg2.l1.m1.1.1.1.3" xref="alg2.l1.m1.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.1.1.1.3.1" xref="alg2.l1.m1.2.2.1.3.cmml">(</mo><mn mathsize="90%" id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml">0</mn><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.1.1.1.3.2" xref="alg2.l1.m1.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l1.m1.2.2.1.2" xref="alg2.l1.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l1.m1.2.2.1.1.1" xref="alg2.l1.m1.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.2.2.1.1.1.2" xref="alg2.l1.m1.2.2.1.1.1.1.cmml">(</mo><msub id="alg2.l1.m1.2.2.1.1.1.1" xref="alg2.l1.m1.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l1.m1.2.2.1.1.1.1.2" xref="alg2.l1.m1.2.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l1.m1.2.2.1.1.1.1.3" xref="alg2.l1.m1.2.2.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l1.m1.2.2.1.1.1.3" xref="alg2.l1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="alg2.l1.m1.2.2.2" xref="alg2.l1.m1.2.2.2.cmml">=</mo><mn mathsize="90%" id="alg2.l1.m1.2.2.3" xref="alg2.l1.m1.2.2.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.2b"><apply id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2"><eq id="alg2.l1.m1.2.2.2.cmml" xref="alg2.l1.m1.2.2.2"></eq><apply id="alg2.l1.m1.2.2.1.cmml" xref="alg2.l1.m1.2.2.1"><times id="alg2.l1.m1.2.2.1.2.cmml" xref="alg2.l1.m1.2.2.1.2"></times><apply id="alg2.l1.m1.2.2.1.3.cmml" xref="alg2.l1.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.3.1.cmml" xref="alg2.l1.m1.2.2.1.3">superscript</csymbol><apply id="alg2.l1.m1.2.2.1.3.2.cmml" xref="alg2.l1.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.3.2.1.cmml" xref="alg2.l1.m1.2.2.1.3">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.3.2.2.cmml" xref="alg2.l1.m1.2.2.1.3.2.2">𝑚</ci><apply id="alg2.l1.m1.2.2.1.3.2.3.cmml" xref="alg2.l1.m1.2.2.1.3.2.3"><times id="alg2.l1.m1.2.2.1.3.2.3.1.cmml" xref="alg2.l1.m1.2.2.1.3.2.3.1"></times><ci id="alg2.l1.m1.2.2.1.3.2.3.2.cmml" xref="alg2.l1.m1.2.2.1.3.2.3.2">𝑖</ci><ci id="alg2.l1.m1.2.2.1.3.2.3.3.cmml" xref="alg2.l1.m1.2.2.1.3.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1">0</cn></apply><apply id="alg2.l1.m1.2.2.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l1.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.2">𝑧</ci><ci id="alg2.l1.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l1.m1.2.2.1.1.1.1.3">𝑗</ci></apply></apply><cn type="float" id="alg2.l1.m1.2.2.3.cmml" xref="alg2.l1.m1.2.2.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.2c">m_{ij}^{(0)}(z_{j})=0.5</annotation></semantics></math><span id="alg2.l1.2" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l1.m2.2" class="ltx_Math" alttext="m_{ij}^{(t)}(z_{j})=0" display="inline"><semantics id="alg2.l1.m2.2a"><mrow id="alg2.l1.m2.2.2" xref="alg2.l1.m2.2.2.cmml"><mrow id="alg2.l1.m2.2.2.1" xref="alg2.l1.m2.2.2.1.cmml"><msubsup id="alg2.l1.m2.2.2.1.3" xref="alg2.l1.m2.2.2.1.3.cmml"><mi mathsize="90%" id="alg2.l1.m2.2.2.1.3.2.2" xref="alg2.l1.m2.2.2.1.3.2.2.cmml">m</mi><mrow id="alg2.l1.m2.2.2.1.3.2.3" xref="alg2.l1.m2.2.2.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l1.m2.2.2.1.3.2.3.2" xref="alg2.l1.m2.2.2.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m2.2.2.1.3.2.3.1" xref="alg2.l1.m2.2.2.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l1.m2.2.2.1.3.2.3.3" xref="alg2.l1.m2.2.2.1.3.2.3.3.cmml">j</mi></mrow><mrow id="alg2.l1.m2.1.1.1.3" xref="alg2.l1.m2.2.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l1.m2.1.1.1.3.1" xref="alg2.l1.m2.2.2.1.3.cmml">(</mo><mi mathsize="90%" id="alg2.l1.m2.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg2.l1.m2.1.1.1.3.2" xref="alg2.l1.m2.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l1.m2.2.2.1.2" xref="alg2.l1.m2.2.2.1.2.cmml">​</mo><mrow id="alg2.l1.m2.2.2.1.1.1" xref="alg2.l1.m2.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l1.m2.2.2.1.1.1.2" xref="alg2.l1.m2.2.2.1.1.1.1.cmml">(</mo><msub id="alg2.l1.m2.2.2.1.1.1.1" xref="alg2.l1.m2.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l1.m2.2.2.1.1.1.1.2" xref="alg2.l1.m2.2.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l1.m2.2.2.1.1.1.1.3" xref="alg2.l1.m2.2.2.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l1.m2.2.2.1.1.1.3" xref="alg2.l1.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="alg2.l1.m2.2.2.2" xref="alg2.l1.m2.2.2.2.cmml">=</mo><mn mathsize="90%" id="alg2.l1.m2.2.2.3" xref="alg2.l1.m2.2.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.2b"><apply id="alg2.l1.m2.2.2.cmml" xref="alg2.l1.m2.2.2"><eq id="alg2.l1.m2.2.2.2.cmml" xref="alg2.l1.m2.2.2.2"></eq><apply id="alg2.l1.m2.2.2.1.cmml" xref="alg2.l1.m2.2.2.1"><times id="alg2.l1.m2.2.2.1.2.cmml" xref="alg2.l1.m2.2.2.1.2"></times><apply id="alg2.l1.m2.2.2.1.3.cmml" xref="alg2.l1.m2.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.3.1.cmml" xref="alg2.l1.m2.2.2.1.3">superscript</csymbol><apply id="alg2.l1.m2.2.2.1.3.2.cmml" xref="alg2.l1.m2.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.3.2.1.cmml" xref="alg2.l1.m2.2.2.1.3">subscript</csymbol><ci id="alg2.l1.m2.2.2.1.3.2.2.cmml" xref="alg2.l1.m2.2.2.1.3.2.2">𝑚</ci><apply id="alg2.l1.m2.2.2.1.3.2.3.cmml" xref="alg2.l1.m2.2.2.1.3.2.3"><times id="alg2.l1.m2.2.2.1.3.2.3.1.cmml" xref="alg2.l1.m2.2.2.1.3.2.3.1"></times><ci id="alg2.l1.m2.2.2.1.3.2.3.2.cmml" xref="alg2.l1.m2.2.2.1.3.2.3.2">𝑖</ci><ci id="alg2.l1.m2.2.2.1.3.2.3.3.cmml" xref="alg2.l1.m2.2.2.1.3.2.3.3">𝑗</ci></apply></apply><ci id="alg2.l1.m2.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1.1">𝑡</ci></apply><apply id="alg2.l1.m2.2.2.1.1.1.1.cmml" xref="alg2.l1.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.2.2.1.1.1.1.1.cmml" xref="alg2.l1.m2.2.2.1.1.1">subscript</csymbol><ci id="alg2.l1.m2.2.2.1.1.1.1.2.cmml" xref="alg2.l1.m2.2.2.1.1.1.1.2">𝑧</ci><ci id="alg2.l1.m2.2.2.1.1.1.1.3.cmml" xref="alg2.l1.m2.2.2.1.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="alg2.l1.m2.2.2.3.cmml" xref="alg2.l1.m2.2.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.2c">m_{ij}^{(t)}(z_{j})=0</annotation></semantics></math><span id="alg2.l1.3" class="ltx_text" style="font-size:90%;"> for </span><math id="alg2.l1.m3.1" class="ltx_Math" alttext="t&gt;0" display="inline"><semantics id="alg2.l1.m3.1a"><mrow id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><mi mathsize="90%" id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg2.l1.m3.1.1.1" xref="alg2.l1.m3.1.1.1.cmml">&gt;</mo><mn mathsize="90%" id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><gt id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1.1"></gt><ci id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2">𝑡</ci><cn type="integer" id="alg2.l1.m3.1.1.3.cmml" xref="alg2.l1.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">t&gt;0</annotation></semantics></math><span id="alg2.l1.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l2" class="ltx_listingline">
<span id="alg2.l2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l2.2" class="ltx_text" style="font-size:90%;"> t=1:T </span><span id="alg2.l2.3" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l2.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l3" class="ltx_listingline">
<span id="alg2.l3.1" class="ltx_text" style="font-size:90%;">   </span><span id="alg2.l3.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l3.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l3.m1.1" class="ltx_Math" alttext="j=1:M" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mrow id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">j</mi><mo mathsize="90%" id="alg2.l3.m1.1.1.2.1" xref="alg2.l3.m1.1.1.2.1.cmml">=</mo><mn mathsize="90%" id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">:</mo><mi mathsize="90%" id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><ci id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1">:</ci><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><eq id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2.1"></eq><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝑗</ci><cn type="integer" id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">1</cn></apply><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">j=1:M</annotation></semantics></math><span id="alg2.l3.4" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l3.m2.1a"><mi mathsize="90%" id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">i</annotation></semantics></math><span id="alg2.l3.5" class="ltx_text" style="font-size:90%;"> in </span><math id="alg2.l3.m3.1" class="ltx_Math" alttext="N_{j}" display="inline"><semantics id="alg2.l3.m3.1a"><msub id="alg2.l3.m3.1.1" xref="alg2.l3.m3.1.1.cmml"><mi mathsize="90%" id="alg2.l3.m3.1.1.2" xref="alg2.l3.m3.1.1.2.cmml">N</mi><mi mathsize="90%" id="alg2.l3.m3.1.1.3" xref="alg2.l3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m3.1b"><apply id="alg2.l3.m3.1.1.cmml" xref="alg2.l3.m3.1.1"><csymbol cd="ambiguous" id="alg2.l3.m3.1.1.1.cmml" xref="alg2.l3.m3.1.1">subscript</csymbol><ci id="alg2.l3.m3.1.1.2.cmml" xref="alg2.l3.m3.1.1.2">𝑁</ci><ci id="alg2.l3.m3.1.1.3.cmml" xref="alg2.l3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m3.1c">N_{j}</annotation></semantics></math><span id="alg2.l3.6" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l3.7" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l3.8" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l4" class="ltx_listingline">
<span id="alg2.l4.1" class="ltx_text" style="font-size:90%;">      </span><span id="alg2.l4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l4.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l4.m1.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="alg2.l4.m1.1a"><msub id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi mathsize="90%" id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑧</ci><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">z_{i}</annotation></semantics></math><span id="alg2.l4.4" class="ltx_text" style="font-size:90%;"> in </span><math id="alg2.l4.m2.2" class="ltx_Math" alttext="\{0,1\}" display="inline"><semantics id="alg2.l4.m2.2a"><mrow id="alg2.l4.m2.2.3.2" xref="alg2.l4.m2.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l4.m2.2.3.2.1" xref="alg2.l4.m2.2.3.1.cmml">{</mo><mn mathsize="90%" id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">0</mn><mo mathsize="90%" id="alg2.l4.m2.2.3.2.2" xref="alg2.l4.m2.2.3.1.cmml">,</mo><mn mathsize="90%" id="alg2.l4.m2.2.2" xref="alg2.l4.m2.2.2.cmml">1</mn><mo maxsize="90%" minsize="90%" id="alg2.l4.m2.2.3.2.3" xref="alg2.l4.m2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.2b"><set id="alg2.l4.m2.2.3.1.cmml" xref="alg2.l4.m2.2.3.2"><cn type="integer" id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1">0</cn><cn type="integer" id="alg2.l4.m2.2.2.cmml" xref="alg2.l4.m2.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.2c">\{0,1\}</annotation></semantics></math><span id="alg2.l4.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l4.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l4.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span id="alg2.l5.1" class="ltx_text" style="font-size:90%;">         s</span><math id="alg2.l5.m1.1" class="ltx_Math" alttext="(z_{i})\leftarrow" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l5.m1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">←</mo><mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">←</ci><apply id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.2">𝑧</ci><ci id="alg2.l5.m1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">(z_{i})\leftarrow</annotation></semantics></math><span id="alg2.l5.2" class="ltx_text" style="font-size:90%;">1
</span>
</div>
<div id="alg2.l6" class="ltx_listingline">
<span id="alg2.l6.1" class="ltx_text" style="font-size:90%;">         </span><span id="alg2.l6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l6.3" class="ltx_text" style="font-size:90%;">  </span><math id="alg2.l6.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg2.l6.m1.1a"><mi mathsize="90%" id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">k</annotation></semantics></math><span id="alg2.l6.4" class="ltx_text" style="font-size:90%;"> in </span><math id="alg2.l6.m2.1" class="ltx_Math" alttext="N_{i}\setminus\{j\}" display="inline"><semantics id="alg2.l6.m2.1a"><mrow id="alg2.l6.m2.1.2" xref="alg2.l6.m2.1.2.cmml"><msub id="alg2.l6.m2.1.2.2" xref="alg2.l6.m2.1.2.2.cmml"><mi mathsize="90%" id="alg2.l6.m2.1.2.2.2" xref="alg2.l6.m2.1.2.2.2.cmml">N</mi><mi mathsize="90%" id="alg2.l6.m2.1.2.2.3" xref="alg2.l6.m2.1.2.2.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l6.m2.1.2.1" xref="alg2.l6.m2.1.2.1.cmml">∖</mo><mrow id="alg2.l6.m2.1.2.3.2" xref="alg2.l6.m2.1.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l6.m2.1.2.3.2.1" xref="alg2.l6.m2.1.2.3.1.cmml">{</mo><mi mathsize="90%" id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">j</mi><mo maxsize="90%" minsize="90%" id="alg2.l6.m2.1.2.3.2.2" xref="alg2.l6.m2.1.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.2.cmml" xref="alg2.l6.m2.1.2"><setdiff id="alg2.l6.m2.1.2.1.cmml" xref="alg2.l6.m2.1.2.1"></setdiff><apply id="alg2.l6.m2.1.2.2.cmml" xref="alg2.l6.m2.1.2.2"><csymbol cd="ambiguous" id="alg2.l6.m2.1.2.2.1.cmml" xref="alg2.l6.m2.1.2.2">subscript</csymbol><ci id="alg2.l6.m2.1.2.2.2.cmml" xref="alg2.l6.m2.1.2.2.2">𝑁</ci><ci id="alg2.l6.m2.1.2.2.3.cmml" xref="alg2.l6.m2.1.2.2.3">𝑖</ci></apply><set id="alg2.l6.m2.1.2.3.1.cmml" xref="alg2.l6.m2.1.2.3.2"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">𝑗</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">N_{i}\setminus\{j\}</annotation></semantics></math><span id="alg2.l6.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l6.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l6.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span id="alg2.l7.1" class="ltx_text" style="font-size:90%;">           s</span><math id="alg2.l7.m1.1" class="ltx_Math" alttext="(z_{i})\leftarrow" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><mrow id="alg2.l7.m1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l7.m1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l7.m1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l7.m1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l7.m1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.cmml">)</mo></mrow><mo mathsize="90%" stretchy="false" id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">←</mo><mi id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">←</ci><apply id="alg2.l7.m1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.2">𝑧</ci><ci id="alg2.l7.m1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.3">𝑖</ci></apply><csymbol cd="latexml" id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">(z_{i})\leftarrow</annotation></semantics></math><span id="alg2.l7.2" class="ltx_text" style="font-size:90%;"> s</span><math id="alg2.l7.m2.3" class="ltx_Math" alttext="(z_{i})\cdot m_{ki}^{(t-1)}(z_{i})" display="inline"><semantics id="alg2.l7.m2.3a"><mrow id="alg2.l7.m2.3.3" xref="alg2.l7.m2.3.3.cmml"><mrow id="alg2.l7.m2.2.2.1" xref="alg2.l7.m2.2.2.1.cmml"><mrow id="alg2.l7.m2.2.2.1.1.1" xref="alg2.l7.m2.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l7.m2.2.2.1.1.1.2" xref="alg2.l7.m2.2.2.1.1.1.1.cmml">(</mo><msub id="alg2.l7.m2.2.2.1.1.1.1" xref="alg2.l7.m2.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l7.m2.2.2.1.1.1.1.2" xref="alg2.l7.m2.2.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l7.m2.2.2.1.1.1.1.3" xref="alg2.l7.m2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" rspace="0.055em" id="alg2.l7.m2.2.2.1.1.1.3" xref="alg2.l7.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mo mathsize="90%" rspace="0.222em" id="alg2.l7.m2.2.2.1.2" xref="alg2.l7.m2.2.2.1.2.cmml">⋅</mo><msubsup id="alg2.l7.m2.2.2.1.3" xref="alg2.l7.m2.2.2.1.3.cmml"><mi mathsize="90%" id="alg2.l7.m2.2.2.1.3.2.2" xref="alg2.l7.m2.2.2.1.3.2.2.cmml">m</mi><mrow id="alg2.l7.m2.2.2.1.3.2.3" xref="alg2.l7.m2.2.2.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l7.m2.2.2.1.3.2.3.2" xref="alg2.l7.m2.2.2.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m2.2.2.1.3.2.3.1" xref="alg2.l7.m2.2.2.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l7.m2.2.2.1.3.2.3.3" xref="alg2.l7.m2.2.2.1.3.2.3.3.cmml">i</mi></mrow><mrow id="alg2.l7.m2.1.1.1.1" xref="alg2.l7.m2.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l7.m2.1.1.1.1.2" xref="alg2.l7.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l7.m2.1.1.1.1.1" xref="alg2.l7.m2.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l7.m2.1.1.1.1.1.2" xref="alg2.l7.m2.1.1.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="alg2.l7.m2.1.1.1.1.1.1" xref="alg2.l7.m2.1.1.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="alg2.l7.m2.1.1.1.1.1.3" xref="alg2.l7.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="alg2.l7.m2.1.1.1.1.3" xref="alg2.l7.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="alg2.l7.m2.3.3.3" xref="alg2.l7.m2.3.3.3.cmml">​</mo><mrow id="alg2.l7.m2.3.3.2.1" xref="alg2.l7.m2.3.3.2.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l7.m2.3.3.2.1.2" xref="alg2.l7.m2.3.3.2.1.1.cmml">(</mo><msub id="alg2.l7.m2.3.3.2.1.1" xref="alg2.l7.m2.3.3.2.1.1.cmml"><mi mathsize="90%" id="alg2.l7.m2.3.3.2.1.1.2" xref="alg2.l7.m2.3.3.2.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l7.m2.3.3.2.1.1.3" xref="alg2.l7.m2.3.3.2.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l7.m2.3.3.2.1.3" xref="alg2.l7.m2.3.3.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.3b"><apply id="alg2.l7.m2.3.3.cmml" xref="alg2.l7.m2.3.3"><times id="alg2.l7.m2.3.3.3.cmml" xref="alg2.l7.m2.3.3.3"></times><apply id="alg2.l7.m2.2.2.1.cmml" xref="alg2.l7.m2.2.2.1"><ci id="alg2.l7.m2.2.2.1.2.cmml" xref="alg2.l7.m2.2.2.1.2">⋅</ci><apply id="alg2.l7.m2.2.2.1.1.1.1.cmml" xref="alg2.l7.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.1.1.1.1.1.cmml" xref="alg2.l7.m2.2.2.1.1.1">subscript</csymbol><ci id="alg2.l7.m2.2.2.1.1.1.1.2.cmml" xref="alg2.l7.m2.2.2.1.1.1.1.2">𝑧</ci><ci id="alg2.l7.m2.2.2.1.1.1.1.3.cmml" xref="alg2.l7.m2.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l7.m2.2.2.1.3.cmml" xref="alg2.l7.m2.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.1.3.1.cmml" xref="alg2.l7.m2.2.2.1.3">superscript</csymbol><apply id="alg2.l7.m2.2.2.1.3.2.cmml" xref="alg2.l7.m2.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.1.3.2.1.cmml" xref="alg2.l7.m2.2.2.1.3">subscript</csymbol><ci id="alg2.l7.m2.2.2.1.3.2.2.cmml" xref="alg2.l7.m2.2.2.1.3.2.2">𝑚</ci><apply id="alg2.l7.m2.2.2.1.3.2.3.cmml" xref="alg2.l7.m2.2.2.1.3.2.3"><times id="alg2.l7.m2.2.2.1.3.2.3.1.cmml" xref="alg2.l7.m2.2.2.1.3.2.3.1"></times><ci id="alg2.l7.m2.2.2.1.3.2.3.2.cmml" xref="alg2.l7.m2.2.2.1.3.2.3.2">𝑘</ci><ci id="alg2.l7.m2.2.2.1.3.2.3.3.cmml" xref="alg2.l7.m2.2.2.1.3.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l7.m2.1.1.1.1.1.cmml" xref="alg2.l7.m2.1.1.1.1"><minus id="alg2.l7.m2.1.1.1.1.1.1.cmml" xref="alg2.l7.m2.1.1.1.1.1.1"></minus><ci id="alg2.l7.m2.1.1.1.1.1.2.cmml" xref="alg2.l7.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l7.m2.1.1.1.1.1.3.cmml" xref="alg2.l7.m2.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="alg2.l7.m2.3.3.2.1.1.cmml" xref="alg2.l7.m2.3.3.2.1"><csymbol cd="ambiguous" id="alg2.l7.m2.3.3.2.1.1.1.cmml" xref="alg2.l7.m2.3.3.2.1">subscript</csymbol><ci id="alg2.l7.m2.3.3.2.1.1.2.cmml" xref="alg2.l7.m2.3.3.2.1.1.2">𝑧</ci><ci id="alg2.l7.m2.3.3.2.1.1.3.cmml" xref="alg2.l7.m2.3.3.2.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.3c">(z_{i})\cdot m_{ki}^{(t-1)}(z_{i})</annotation></semantics></math><span id="alg2.l7.3" class="ltx_text" style="font-size:90%;">
               </span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span id="alg2.l8.1" class="ltx_text" style="font-size:90%;">      </span><span id="alg2.l8.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l8.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l8.m1.2" class="ltx_Math" alttext="(z_{i},z_{j})" display="inline"><semantics id="alg2.l8.m1.2a"><mrow id="alg2.l8.m1.2.2.2" xref="alg2.l8.m1.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l8.m1.2.2.2.3" xref="alg2.l8.m1.2.2.3.cmml">(</mo><msub id="alg2.l8.m1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l8.m1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l8.m1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l8.m1.2.2.2.4" xref="alg2.l8.m1.2.2.3.cmml">,</mo><msub id="alg2.l8.m1.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.cmml"><mi mathsize="90%" id="alg2.l8.m1.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.cmml">z</mi><mi mathsize="90%" id="alg2.l8.m1.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l8.m1.2.2.2.5" xref="alg2.l8.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b"><interval closure="open" id="alg2.l8.m1.2.2.3.cmml" xref="alg2.l8.m1.2.2.2"><apply id="alg2.l8.m1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.1.2">𝑧</ci><ci id="alg2.l8.m1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l8.m1.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.2.2.1.cmml" xref="alg2.l8.m1.2.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.2.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.2">𝑧</ci><ci id="alg2.l8.m1.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.2c">(z_{i},z_{j})</annotation></semantics></math><span id="alg2.l8.4" class="ltx_text" style="font-size:90%;"> in </span><math id="alg2.l8.m2.4" class="ltx_Math" alttext="\{0,1\}\times\{0,1\}" display="inline"><semantics id="alg2.l8.m2.4a"><mrow id="alg2.l8.m2.4.5" xref="alg2.l8.m2.4.5.cmml"><mrow id="alg2.l8.m2.4.5.2.2" xref="alg2.l8.m2.4.5.2.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l8.m2.4.5.2.2.1" xref="alg2.l8.m2.4.5.2.1.cmml">{</mo><mn mathsize="90%" id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml">0</mn><mo mathsize="90%" id="alg2.l8.m2.4.5.2.2.2" xref="alg2.l8.m2.4.5.2.1.cmml">,</mo><mn mathsize="90%" id="alg2.l8.m2.2.2" xref="alg2.l8.m2.2.2.cmml">1</mn><mo maxsize="90%" minsize="90%" rspace="0.055em" id="alg2.l8.m2.4.5.2.2.3" xref="alg2.l8.m2.4.5.2.1.cmml">}</mo></mrow><mo mathsize="90%" rspace="0.222em" id="alg2.l8.m2.4.5.1" xref="alg2.l8.m2.4.5.1.cmml">×</mo><mrow id="alg2.l8.m2.4.5.3.2" xref="alg2.l8.m2.4.5.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l8.m2.4.5.3.2.1" xref="alg2.l8.m2.4.5.3.1.cmml">{</mo><mn mathsize="90%" id="alg2.l8.m2.3.3" xref="alg2.l8.m2.3.3.cmml">0</mn><mo mathsize="90%" id="alg2.l8.m2.4.5.3.2.2" xref="alg2.l8.m2.4.5.3.1.cmml">,</mo><mn mathsize="90%" id="alg2.l8.m2.4.4" xref="alg2.l8.m2.4.4.cmml">1</mn><mo maxsize="90%" minsize="90%" id="alg2.l8.m2.4.5.3.2.3" xref="alg2.l8.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.4b"><apply id="alg2.l8.m2.4.5.cmml" xref="alg2.l8.m2.4.5"><times id="alg2.l8.m2.4.5.1.cmml" xref="alg2.l8.m2.4.5.1"></times><set id="alg2.l8.m2.4.5.2.1.cmml" xref="alg2.l8.m2.4.5.2.2"><cn type="integer" id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1">0</cn><cn type="integer" id="alg2.l8.m2.2.2.cmml" xref="alg2.l8.m2.2.2">1</cn></set><set id="alg2.l8.m2.4.5.3.1.cmml" xref="alg2.l8.m2.4.5.3.2"><cn type="integer" id="alg2.l8.m2.3.3.cmml" xref="alg2.l8.m2.3.3">0</cn><cn type="integer" id="alg2.l8.m2.4.4.cmml" xref="alg2.l8.m2.4.4">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.4c">\{0,1\}\times\{0,1\}</annotation></semantics></math><span id="alg2.l8.5" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l8.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l8.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span id="alg2.l9.1" class="ltx_text" style="font-size:90%;">         </span><math id="alg2.l9.m1.8" class="ltx_Math" alttext="m_{ij}^{(t)}(z_{j})\leftarrow m_{ij}^{(t)}(z_{j})+\psi_{ij}(z_{i},z_{j})\psi_{i}(z_{i})s(z_{i})" display="inline"><semantics id="alg2.l9.m1.8a"><mrow id="alg2.l9.m1.8.8" xref="alg2.l9.m1.8.8.cmml"><mrow id="alg2.l9.m1.3.3.1" xref="alg2.l9.m1.3.3.1.cmml"><msubsup id="alg2.l9.m1.3.3.1.3" xref="alg2.l9.m1.3.3.1.3.cmml"><mi mathsize="90%" id="alg2.l9.m1.3.3.1.3.2.2" xref="alg2.l9.m1.3.3.1.3.2.2.cmml">m</mi><mrow id="alg2.l9.m1.3.3.1.3.2.3" xref="alg2.l9.m1.3.3.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l9.m1.3.3.1.3.2.3.2" xref="alg2.l9.m1.3.3.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.3.2.3.1" xref="alg2.l9.m1.3.3.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l9.m1.3.3.1.3.2.3.3" xref="alg2.l9.m1.3.3.1.3.2.3.3.cmml">j</mi></mrow><mrow id="alg2.l9.m1.1.1.1.3" xref="alg2.l9.m1.3.3.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.1.1.1.3.1" xref="alg2.l9.m1.3.3.1.3.cmml">(</mo><mi mathsize="90%" id="alg2.l9.m1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.1.1.1.3.2" xref="alg2.l9.m1.3.3.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.1.2" xref="alg2.l9.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l9.m1.3.3.1.1.1" xref="alg2.l9.m1.3.3.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.3.3.1.1.1.2" xref="alg2.l9.m1.3.3.1.1.1.1.cmml">(</mo><msub id="alg2.l9.m1.3.3.1.1.1.1" xref="alg2.l9.m1.3.3.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l9.m1.3.3.1.1.1.1.2" xref="alg2.l9.m1.3.3.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l9.m1.3.3.1.1.1.1.3" xref="alg2.l9.m1.3.3.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.3.3.1.1.1.3" xref="alg2.l9.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" stretchy="false" id="alg2.l9.m1.8.8.7" xref="alg2.l9.m1.8.8.7.cmml">←</mo><mrow id="alg2.l9.m1.8.8.6" xref="alg2.l9.m1.8.8.6.cmml"><mrow id="alg2.l9.m1.4.4.2.1" xref="alg2.l9.m1.4.4.2.1.cmml"><msubsup id="alg2.l9.m1.4.4.2.1.3" xref="alg2.l9.m1.4.4.2.1.3.cmml"><mi mathsize="90%" id="alg2.l9.m1.4.4.2.1.3.2.2" xref="alg2.l9.m1.4.4.2.1.3.2.2.cmml">m</mi><mrow id="alg2.l9.m1.4.4.2.1.3.2.3" xref="alg2.l9.m1.4.4.2.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l9.m1.4.4.2.1.3.2.3.2" xref="alg2.l9.m1.4.4.2.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.4.4.2.1.3.2.3.1" xref="alg2.l9.m1.4.4.2.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l9.m1.4.4.2.1.3.2.3.3" xref="alg2.l9.m1.4.4.2.1.3.2.3.3.cmml">j</mi></mrow><mrow id="alg2.l9.m1.2.2.1.3" xref="alg2.l9.m1.4.4.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.2.2.1.3.1" xref="alg2.l9.m1.4.4.2.1.3.cmml">(</mo><mi mathsize="90%" id="alg2.l9.m1.2.2.1.1" xref="alg2.l9.m1.2.2.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.2.2.1.3.2" xref="alg2.l9.m1.4.4.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg2.l9.m1.4.4.2.1.2" xref="alg2.l9.m1.4.4.2.1.2.cmml">​</mo><mrow id="alg2.l9.m1.4.4.2.1.1.1" xref="alg2.l9.m1.4.4.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.4.4.2.1.1.1.2" xref="alg2.l9.m1.4.4.2.1.1.1.1.cmml">(</mo><msub id="alg2.l9.m1.4.4.2.1.1.1.1" xref="alg2.l9.m1.4.4.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l9.m1.4.4.2.1.1.1.1.2" xref="alg2.l9.m1.4.4.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l9.m1.4.4.2.1.1.1.1.3" xref="alg2.l9.m1.4.4.2.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.4.4.2.1.1.1.3" xref="alg2.l9.m1.4.4.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="alg2.l9.m1.8.8.6.6" xref="alg2.l9.m1.8.8.6.6.cmml">+</mo><mrow id="alg2.l9.m1.8.8.6.5" xref="alg2.l9.m1.8.8.6.5.cmml"><msub id="alg2.l9.m1.8.8.6.5.6" xref="alg2.l9.m1.8.8.6.5.6.cmml"><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.6.2" xref="alg2.l9.m1.8.8.6.5.6.2.cmml">ψ</mi><mrow id="alg2.l9.m1.8.8.6.5.6.3" xref="alg2.l9.m1.8.8.6.5.6.3.cmml"><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.6.3.2" xref="alg2.l9.m1.8.8.6.5.6.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.8.8.6.5.6.3.1" xref="alg2.l9.m1.8.8.6.5.6.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.6.3.3" xref="alg2.l9.m1.8.8.6.5.6.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.l9.m1.8.8.6.5.5" xref="alg2.l9.m1.8.8.6.5.5.cmml">​</mo><mrow id="alg2.l9.m1.6.6.4.3.2.2" xref="alg2.l9.m1.6.6.4.3.2.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.6.6.4.3.2.2.3" xref="alg2.l9.m1.6.6.4.3.2.3.cmml">(</mo><msub id="alg2.l9.m1.5.5.3.2.1.1.1" xref="alg2.l9.m1.5.5.3.2.1.1.1.cmml"><mi mathsize="90%" id="alg2.l9.m1.5.5.3.2.1.1.1.2" xref="alg2.l9.m1.5.5.3.2.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l9.m1.5.5.3.2.1.1.1.3" xref="alg2.l9.m1.5.5.3.2.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="alg2.l9.m1.6.6.4.3.2.2.4" xref="alg2.l9.m1.6.6.4.3.2.3.cmml">,</mo><msub id="alg2.l9.m1.6.6.4.3.2.2.2" xref="alg2.l9.m1.6.6.4.3.2.2.2.cmml"><mi mathsize="90%" id="alg2.l9.m1.6.6.4.3.2.2.2.2" xref="alg2.l9.m1.6.6.4.3.2.2.2.2.cmml">z</mi><mi mathsize="90%" id="alg2.l9.m1.6.6.4.3.2.2.2.3" xref="alg2.l9.m1.6.6.4.3.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.6.6.4.3.2.2.5" xref="alg2.l9.m1.6.6.4.3.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg2.l9.m1.8.8.6.5.5a" xref="alg2.l9.m1.8.8.6.5.5.cmml">​</mo><msub id="alg2.l9.m1.8.8.6.5.7" xref="alg2.l9.m1.8.8.6.5.7.cmml"><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.7.2" xref="alg2.l9.m1.8.8.6.5.7.2.cmml">ψ</mi><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.7.3" xref="alg2.l9.m1.8.8.6.5.7.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l9.m1.8.8.6.5.5b" xref="alg2.l9.m1.8.8.6.5.5.cmml">​</mo><mrow id="alg2.l9.m1.7.7.5.4.3.1" xref="alg2.l9.m1.7.7.5.4.3.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.7.7.5.4.3.1.2" xref="alg2.l9.m1.7.7.5.4.3.1.1.cmml">(</mo><msub id="alg2.l9.m1.7.7.5.4.3.1.1" xref="alg2.l9.m1.7.7.5.4.3.1.1.cmml"><mi mathsize="90%" id="alg2.l9.m1.7.7.5.4.3.1.1.2" xref="alg2.l9.m1.7.7.5.4.3.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l9.m1.7.7.5.4.3.1.1.3" xref="alg2.l9.m1.7.7.5.4.3.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.7.7.5.4.3.1.3" xref="alg2.l9.m1.7.7.5.4.3.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg2.l9.m1.8.8.6.5.5c" xref="alg2.l9.m1.8.8.6.5.5.cmml">​</mo><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.8" xref="alg2.l9.m1.8.8.6.5.8.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.8.8.6.5.5d" xref="alg2.l9.m1.8.8.6.5.5.cmml">​</mo><mrow id="alg2.l9.m1.8.8.6.5.4.1" xref="alg2.l9.m1.8.8.6.5.4.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.8.8.6.5.4.1.2" xref="alg2.l9.m1.8.8.6.5.4.1.1.cmml">(</mo><msub id="alg2.l9.m1.8.8.6.5.4.1.1" xref="alg2.l9.m1.8.8.6.5.4.1.1.cmml"><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.4.1.1.2" xref="alg2.l9.m1.8.8.6.5.4.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l9.m1.8.8.6.5.4.1.1.3" xref="alg2.l9.m1.8.8.6.5.4.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l9.m1.8.8.6.5.4.1.3" xref="alg2.l9.m1.8.8.6.5.4.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.8b"><apply id="alg2.l9.m1.8.8.cmml" xref="alg2.l9.m1.8.8"><ci id="alg2.l9.m1.8.8.7.cmml" xref="alg2.l9.m1.8.8.7">←</ci><apply id="alg2.l9.m1.3.3.1.cmml" xref="alg2.l9.m1.3.3.1"><times id="alg2.l9.m1.3.3.1.2.cmml" xref="alg2.l9.m1.3.3.1.2"></times><apply id="alg2.l9.m1.3.3.1.3.cmml" xref="alg2.l9.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.1.3.1.cmml" xref="alg2.l9.m1.3.3.1.3">superscript</csymbol><apply id="alg2.l9.m1.3.3.1.3.2.cmml" xref="alg2.l9.m1.3.3.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.1.3.2.1.cmml" xref="alg2.l9.m1.3.3.1.3">subscript</csymbol><ci id="alg2.l9.m1.3.3.1.3.2.2.cmml" xref="alg2.l9.m1.3.3.1.3.2.2">𝑚</ci><apply id="alg2.l9.m1.3.3.1.3.2.3.cmml" xref="alg2.l9.m1.3.3.1.3.2.3"><times id="alg2.l9.m1.3.3.1.3.2.3.1.cmml" xref="alg2.l9.m1.3.3.1.3.2.3.1"></times><ci id="alg2.l9.m1.3.3.1.3.2.3.2.cmml" xref="alg2.l9.m1.3.3.1.3.2.3.2">𝑖</ci><ci id="alg2.l9.m1.3.3.1.3.2.3.3.cmml" xref="alg2.l9.m1.3.3.1.3.2.3.3">𝑗</ci></apply></apply><ci id="alg2.l9.m1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1">𝑡</ci></apply><apply id="alg2.l9.m1.3.3.1.1.1.1.cmml" xref="alg2.l9.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l9.m1.3.3.1.1.1">subscript</csymbol><ci id="alg2.l9.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.2">𝑧</ci><ci id="alg2.l9.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l9.m1.3.3.1.1.1.1.3">𝑗</ci></apply></apply><apply id="alg2.l9.m1.8.8.6.cmml" xref="alg2.l9.m1.8.8.6"><plus id="alg2.l9.m1.8.8.6.6.cmml" xref="alg2.l9.m1.8.8.6.6"></plus><apply id="alg2.l9.m1.4.4.2.1.cmml" xref="alg2.l9.m1.4.4.2.1"><times id="alg2.l9.m1.4.4.2.1.2.cmml" xref="alg2.l9.m1.4.4.2.1.2"></times><apply id="alg2.l9.m1.4.4.2.1.3.cmml" xref="alg2.l9.m1.4.4.2.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.4.4.2.1.3.1.cmml" xref="alg2.l9.m1.4.4.2.1.3">superscript</csymbol><apply id="alg2.l9.m1.4.4.2.1.3.2.cmml" xref="alg2.l9.m1.4.4.2.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.4.4.2.1.3.2.1.cmml" xref="alg2.l9.m1.4.4.2.1.3">subscript</csymbol><ci id="alg2.l9.m1.4.4.2.1.3.2.2.cmml" xref="alg2.l9.m1.4.4.2.1.3.2.2">𝑚</ci><apply id="alg2.l9.m1.4.4.2.1.3.2.3.cmml" xref="alg2.l9.m1.4.4.2.1.3.2.3"><times id="alg2.l9.m1.4.4.2.1.3.2.3.1.cmml" xref="alg2.l9.m1.4.4.2.1.3.2.3.1"></times><ci id="alg2.l9.m1.4.4.2.1.3.2.3.2.cmml" xref="alg2.l9.m1.4.4.2.1.3.2.3.2">𝑖</ci><ci id="alg2.l9.m1.4.4.2.1.3.2.3.3.cmml" xref="alg2.l9.m1.4.4.2.1.3.2.3.3">𝑗</ci></apply></apply><ci id="alg2.l9.m1.2.2.1.1.cmml" xref="alg2.l9.m1.2.2.1.1">𝑡</ci></apply><apply id="alg2.l9.m1.4.4.2.1.1.1.1.cmml" xref="alg2.l9.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.4.4.2.1.1.1.1.1.cmml" xref="alg2.l9.m1.4.4.2.1.1.1">subscript</csymbol><ci id="alg2.l9.m1.4.4.2.1.1.1.1.2.cmml" xref="alg2.l9.m1.4.4.2.1.1.1.1.2">𝑧</ci><ci id="alg2.l9.m1.4.4.2.1.1.1.1.3.cmml" xref="alg2.l9.m1.4.4.2.1.1.1.1.3">𝑗</ci></apply></apply><apply id="alg2.l9.m1.8.8.6.5.cmml" xref="alg2.l9.m1.8.8.6.5"><times id="alg2.l9.m1.8.8.6.5.5.cmml" xref="alg2.l9.m1.8.8.6.5.5"></times><apply id="alg2.l9.m1.8.8.6.5.6.cmml" xref="alg2.l9.m1.8.8.6.5.6"><csymbol cd="ambiguous" id="alg2.l9.m1.8.8.6.5.6.1.cmml" xref="alg2.l9.m1.8.8.6.5.6">subscript</csymbol><ci id="alg2.l9.m1.8.8.6.5.6.2.cmml" xref="alg2.l9.m1.8.8.6.5.6.2">𝜓</ci><apply id="alg2.l9.m1.8.8.6.5.6.3.cmml" xref="alg2.l9.m1.8.8.6.5.6.3"><times id="alg2.l9.m1.8.8.6.5.6.3.1.cmml" xref="alg2.l9.m1.8.8.6.5.6.3.1"></times><ci id="alg2.l9.m1.8.8.6.5.6.3.2.cmml" xref="alg2.l9.m1.8.8.6.5.6.3.2">𝑖</ci><ci id="alg2.l9.m1.8.8.6.5.6.3.3.cmml" xref="alg2.l9.m1.8.8.6.5.6.3.3">𝑗</ci></apply></apply><interval closure="open" id="alg2.l9.m1.6.6.4.3.2.3.cmml" xref="alg2.l9.m1.6.6.4.3.2.2"><apply id="alg2.l9.m1.5.5.3.2.1.1.1.cmml" xref="alg2.l9.m1.5.5.3.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.5.5.3.2.1.1.1.1.cmml" xref="alg2.l9.m1.5.5.3.2.1.1.1">subscript</csymbol><ci id="alg2.l9.m1.5.5.3.2.1.1.1.2.cmml" xref="alg2.l9.m1.5.5.3.2.1.1.1.2">𝑧</ci><ci id="alg2.l9.m1.5.5.3.2.1.1.1.3.cmml" xref="alg2.l9.m1.5.5.3.2.1.1.1.3">𝑖</ci></apply><apply id="alg2.l9.m1.6.6.4.3.2.2.2.cmml" xref="alg2.l9.m1.6.6.4.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.6.6.4.3.2.2.2.1.cmml" xref="alg2.l9.m1.6.6.4.3.2.2.2">subscript</csymbol><ci id="alg2.l9.m1.6.6.4.3.2.2.2.2.cmml" xref="alg2.l9.m1.6.6.4.3.2.2.2.2">𝑧</ci><ci id="alg2.l9.m1.6.6.4.3.2.2.2.3.cmml" xref="alg2.l9.m1.6.6.4.3.2.2.2.3">𝑗</ci></apply></interval><apply id="alg2.l9.m1.8.8.6.5.7.cmml" xref="alg2.l9.m1.8.8.6.5.7"><csymbol cd="ambiguous" id="alg2.l9.m1.8.8.6.5.7.1.cmml" xref="alg2.l9.m1.8.8.6.5.7">subscript</csymbol><ci id="alg2.l9.m1.8.8.6.5.7.2.cmml" xref="alg2.l9.m1.8.8.6.5.7.2">𝜓</ci><ci id="alg2.l9.m1.8.8.6.5.7.3.cmml" xref="alg2.l9.m1.8.8.6.5.7.3">𝑖</ci></apply><apply id="alg2.l9.m1.7.7.5.4.3.1.1.cmml" xref="alg2.l9.m1.7.7.5.4.3.1"><csymbol cd="ambiguous" id="alg2.l9.m1.7.7.5.4.3.1.1.1.cmml" xref="alg2.l9.m1.7.7.5.4.3.1">subscript</csymbol><ci id="alg2.l9.m1.7.7.5.4.3.1.1.2.cmml" xref="alg2.l9.m1.7.7.5.4.3.1.1.2">𝑧</ci><ci id="alg2.l9.m1.7.7.5.4.3.1.1.3.cmml" xref="alg2.l9.m1.7.7.5.4.3.1.1.3">𝑖</ci></apply><ci id="alg2.l9.m1.8.8.6.5.8.cmml" xref="alg2.l9.m1.8.8.6.5.8">𝑠</ci><apply id="alg2.l9.m1.8.8.6.5.4.1.1.cmml" xref="alg2.l9.m1.8.8.6.5.4.1"><csymbol cd="ambiguous" id="alg2.l9.m1.8.8.6.5.4.1.1.1.cmml" xref="alg2.l9.m1.8.8.6.5.4.1">subscript</csymbol><ci id="alg2.l9.m1.8.8.6.5.4.1.1.2.cmml" xref="alg2.l9.m1.8.8.6.5.4.1.1.2">𝑧</ci><ci id="alg2.l9.m1.8.8.6.5.4.1.1.3.cmml" xref="alg2.l9.m1.8.8.6.5.4.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.8c">m_{ij}^{(t)}(z_{j})\leftarrow m_{ij}^{(t)}(z_{j})+\psi_{ij}(z_{i},z_{j})\psi_{i}(z_{i})s(z_{i})</annotation></semantics></math><span id="alg2.l9.2" class="ltx_text" style="font-size:90%;">
      </span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span id="alg2.l10.1" class="ltx_text" style="font-size:90%;">      normalize(</span><math id="alg2.l10.m1.1" class="ltx_Math" alttext="m_{ij}^{(t)}" display="inline"><semantics id="alg2.l10.m1.1a"><msubsup id="alg2.l10.m1.1.2" xref="alg2.l10.m1.1.2.cmml"><mi mathsize="90%" id="alg2.l10.m1.1.2.2.2" xref="alg2.l10.m1.1.2.2.2.cmml">m</mi><mrow id="alg2.l10.m1.1.2.2.3" xref="alg2.l10.m1.1.2.2.3.cmml"><mi mathsize="90%" id="alg2.l10.m1.1.2.2.3.2" xref="alg2.l10.m1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.1.2.2.3.1" xref="alg2.l10.m1.1.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l10.m1.1.2.2.3.3" xref="alg2.l10.m1.1.2.2.3.3.cmml">j</mi></mrow><mrow id="alg2.l10.m1.1.1.1.3" xref="alg2.l10.m1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l10.m1.1.1.1.3.1" xref="alg2.l10.m1.1.2.cmml">(</mo><mi mathsize="90%" id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="alg2.l10.m1.1.1.1.3.2" xref="alg2.l10.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.2.cmml" xref="alg2.l10.m1.1.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.2.1.cmml" xref="alg2.l10.m1.1.2">superscript</csymbol><apply id="alg2.l10.m1.1.2.2.cmml" xref="alg2.l10.m1.1.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.2.2.1.cmml" xref="alg2.l10.m1.1.2">subscript</csymbol><ci id="alg2.l10.m1.1.2.2.2.cmml" xref="alg2.l10.m1.1.2.2.2">𝑚</ci><apply id="alg2.l10.m1.1.2.2.3.cmml" xref="alg2.l10.m1.1.2.2.3"><times id="alg2.l10.m1.1.2.2.3.1.cmml" xref="alg2.l10.m1.1.2.2.3.1"></times><ci id="alg2.l10.m1.1.2.2.3.2.cmml" xref="alg2.l10.m1.1.2.2.3.2">𝑖</ci><ci id="alg2.l10.m1.1.2.2.3.3.cmml" xref="alg2.l10.m1.1.2.2.3.3">𝑗</ci></apply></apply><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">m_{ij}^{(t)}</annotation></semantics></math><span id="alg2.l10.2" class="ltx_text" style="font-size:90%;">)
   </span>
</div>
<div id="alg2.l11" class="ltx_listingline">
<span id="alg2.l11.1" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l11.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l11.m1.1" class="ltx_Math" alttext="i=1:M" display="inline"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mrow id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml"><mi mathsize="90%" id="alg2.l11.m1.1.1.2.2" xref="alg2.l11.m1.1.1.2.2.cmml">i</mi><mo mathsize="90%" id="alg2.l11.m1.1.1.2.1" xref="alg2.l11.m1.1.1.2.1.cmml">=</mo><mn mathsize="90%" id="alg2.l11.m1.1.1.2.3" xref="alg2.l11.m1.1.1.2.3.cmml">1</mn></mrow><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml">:</mo><mi mathsize="90%" id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><ci id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1">:</ci><apply id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2"><eq id="alg2.l11.m1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1.2.1"></eq><ci id="alg2.l11.m1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.2.2">𝑖</ci><cn type="integer" id="alg2.l11.m1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.2.3">1</cn></apply><ci id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">i=1:M</annotation></semantics></math><span id="alg2.l11.3" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l11.4" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l11.5" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span id="alg2.l12.1" class="ltx_text" style="font-size:90%;">   </span><math id="alg2.l12.m1.2" class="ltx_Math" alttext="b_{i}(z_{i})\leftarrow\psi_{i}(z_{i})" display="inline"><semantics id="alg2.l12.m1.2a"><mrow id="alg2.l12.m1.2.2" xref="alg2.l12.m1.2.2.cmml"><mrow id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml"><msub id="alg2.l12.m1.1.1.1.3" xref="alg2.l12.m1.1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l12.m1.1.1.1.3.2" xref="alg2.l12.m1.1.1.1.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l12.m1.1.1.1.3.3" xref="alg2.l12.m1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1.2" xref="alg2.l12.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l12.m1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l12.m1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l12.m1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l12.m1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l12.m1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l12.m1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" stretchy="false" id="alg2.l12.m1.2.2.3" xref="alg2.l12.m1.2.2.3.cmml">←</mo><mrow id="alg2.l12.m1.2.2.2" xref="alg2.l12.m1.2.2.2.cmml"><msub id="alg2.l12.m1.2.2.2.3" xref="alg2.l12.m1.2.2.2.3.cmml"><mi mathsize="90%" id="alg2.l12.m1.2.2.2.3.2" xref="alg2.l12.m1.2.2.2.3.2.cmml">ψ</mi><mi mathsize="90%" id="alg2.l12.m1.2.2.2.3.3" xref="alg2.l12.m1.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l12.m1.2.2.2.2" xref="alg2.l12.m1.2.2.2.2.cmml">​</mo><mrow id="alg2.l12.m1.2.2.2.1.1" xref="alg2.l12.m1.2.2.2.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l12.m1.2.2.2.1.1.2" xref="alg2.l12.m1.2.2.2.1.1.1.cmml">(</mo><msub id="alg2.l12.m1.2.2.2.1.1.1" xref="alg2.l12.m1.2.2.2.1.1.1.cmml"><mi mathsize="90%" id="alg2.l12.m1.2.2.2.1.1.1.2" xref="alg2.l12.m1.2.2.2.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l12.m1.2.2.2.1.1.1.3" xref="alg2.l12.m1.2.2.2.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l12.m1.2.2.2.1.1.3" xref="alg2.l12.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.2b"><apply id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2"><ci id="alg2.l12.m1.2.2.3.cmml" xref="alg2.l12.m1.2.2.3">←</ci><apply id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"><times id="alg2.l12.m1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.2"></times><apply id="alg2.l12.m1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.3.1.cmml" xref="alg2.l12.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l12.m1.1.1.1.3.2.cmml" xref="alg2.l12.m1.1.1.1.3.2">𝑏</ci><ci id="alg2.l12.m1.1.1.1.3.3.cmml" xref="alg2.l12.m1.1.1.1.3.3">𝑖</ci></apply><apply id="alg2.l12.m1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.2">𝑧</ci><ci id="alg2.l12.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg2.l12.m1.2.2.2.cmml" xref="alg2.l12.m1.2.2.2"><times id="alg2.l12.m1.2.2.2.2.cmml" xref="alg2.l12.m1.2.2.2.2"></times><apply id="alg2.l12.m1.2.2.2.3.cmml" xref="alg2.l12.m1.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l12.m1.2.2.2.3.1.cmml" xref="alg2.l12.m1.2.2.2.3">subscript</csymbol><ci id="alg2.l12.m1.2.2.2.3.2.cmml" xref="alg2.l12.m1.2.2.2.3.2">𝜓</ci><ci id="alg2.l12.m1.2.2.2.3.3.cmml" xref="alg2.l12.m1.2.2.2.3.3">𝑖</ci></apply><apply id="alg2.l12.m1.2.2.2.1.1.1.cmml" xref="alg2.l12.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.2.2.2.1.1.1.1.cmml" xref="alg2.l12.m1.2.2.2.1.1">subscript</csymbol><ci id="alg2.l12.m1.2.2.2.1.1.1.2.cmml" xref="alg2.l12.m1.2.2.2.1.1.1.2">𝑧</ci><ci id="alg2.l12.m1.2.2.2.1.1.1.3.cmml" xref="alg2.l12.m1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.2c">b_{i}(z_{i})\leftarrow\psi_{i}(z_{i})</annotation></semantics></math><span id="alg2.l12.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span id="alg2.l13.1" class="ltx_text" style="font-size:90%;">   </span><span id="alg2.l13.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="alg2.l13.3" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l13.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg2.l13.m1.1a"><mi mathsize="90%" id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">k</annotation></semantics></math><span id="alg2.l13.4" class="ltx_text" style="font-size:90%;"> in </span><math id="alg2.l13.m2.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg2.l13.m2.1a"><msub id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml"><mi mathsize="90%" id="alg2.l13.m2.1.1.2" xref="alg2.l13.m2.1.1.2.cmml">N</mi><mi mathsize="90%" id="alg2.l13.m2.1.1.3" xref="alg2.l13.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><apply id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.cmml" xref="alg2.l13.m2.1.1">subscript</csymbol><ci id="alg2.l13.m2.1.1.2.cmml" xref="alg2.l13.m2.1.1.2">𝑁</ci><ci id="alg2.l13.m2.1.1.3.cmml" xref="alg2.l13.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">N_{i}</annotation></semantics></math><span id="alg2.l13.5" class="ltx_text" style="font-size:90%;">, </span><math id="alg2.l13.m3.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="alg2.l13.m3.1a"><msub id="alg2.l13.m3.1.1" xref="alg2.l13.m3.1.1.cmml"><mi mathsize="90%" id="alg2.l13.m3.1.1.2" xref="alg2.l13.m3.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l13.m3.1.1.3" xref="alg2.l13.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l13.m3.1b"><apply id="alg2.l13.m3.1.1.cmml" xref="alg2.l13.m3.1.1"><csymbol cd="ambiguous" id="alg2.l13.m3.1.1.1.cmml" xref="alg2.l13.m3.1.1">subscript</csymbol><ci id="alg2.l13.m3.1.1.2.cmml" xref="alg2.l13.m3.1.1.2">𝑧</ci><ci id="alg2.l13.m3.1.1.3.cmml" xref="alg2.l13.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m3.1c">z_{i}</annotation></semantics></math><span id="alg2.l13.6" class="ltx_text" style="font-size:90%;"> in </span><math id="alg2.l13.m4.2" class="ltx_Math" alttext="\{0,1\}" display="inline"><semantics id="alg2.l13.m4.2a"><mrow id="alg2.l13.m4.2.3.2" xref="alg2.l13.m4.2.3.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l13.m4.2.3.2.1" xref="alg2.l13.m4.2.3.1.cmml">{</mo><mn mathsize="90%" id="alg2.l13.m4.1.1" xref="alg2.l13.m4.1.1.cmml">0</mn><mo mathsize="90%" id="alg2.l13.m4.2.3.2.2" xref="alg2.l13.m4.2.3.1.cmml">,</mo><mn mathsize="90%" id="alg2.l13.m4.2.2" xref="alg2.l13.m4.2.2.cmml">1</mn><mo maxsize="90%" minsize="90%" id="alg2.l13.m4.2.3.2.3" xref="alg2.l13.m4.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m4.2b"><set id="alg2.l13.m4.2.3.1.cmml" xref="alg2.l13.m4.2.3.2"><cn type="integer" id="alg2.l13.m4.1.1.cmml" xref="alg2.l13.m4.1.1">0</cn><cn type="integer" id="alg2.l13.m4.2.2.cmml" xref="alg2.l13.m4.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m4.2c">\{0,1\}</annotation></semantics></math><span id="alg2.l13.7" class="ltx_text" style="font-size:90%;"> </span><span id="alg2.l13.8" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="alg2.l13.9" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="alg2.l14" class="ltx_listingline">
<span id="alg2.l14.1" class="ltx_text" style="font-size:90%;">      </span><math id="alg2.l14.m1.4" class="ltx_Math" alttext="b_{i}(z_{i})\leftarrow b_{i}(z_{i})\cdot m_{ki}^{(T)}(z_{i})" display="inline"><semantics id="alg2.l14.m1.4a"><mrow id="alg2.l14.m1.4.4" xref="alg2.l14.m1.4.4.cmml"><mrow id="alg2.l14.m1.2.2.1" xref="alg2.l14.m1.2.2.1.cmml"><msub id="alg2.l14.m1.2.2.1.3" xref="alg2.l14.m1.2.2.1.3.cmml"><mi mathsize="90%" id="alg2.l14.m1.2.2.1.3.2" xref="alg2.l14.m1.2.2.1.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l14.m1.2.2.1.3.3" xref="alg2.l14.m1.2.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l14.m1.2.2.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.2.2.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.cmml">(</mo><msub id="alg2.l14.m1.2.2.1.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l14.m1.2.2.1.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l14.m1.2.2.1.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.2.2.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" stretchy="false" id="alg2.l14.m1.4.4.4" xref="alg2.l14.m1.4.4.4.cmml">←</mo><mrow id="alg2.l14.m1.4.4.3" xref="alg2.l14.m1.4.4.3.cmml"><mrow id="alg2.l14.m1.3.3.2.1" xref="alg2.l14.m1.3.3.2.1.cmml"><mrow id="alg2.l14.m1.3.3.2.1.1" xref="alg2.l14.m1.3.3.2.1.1.cmml"><msub id="alg2.l14.m1.3.3.2.1.1.3" xref="alg2.l14.m1.3.3.2.1.1.3.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.1.3.2" xref="alg2.l14.m1.3.3.2.1.1.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.1.3.3" xref="alg2.l14.m1.3.3.2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l14.m1.3.3.2.1.1.2" xref="alg2.l14.m1.3.3.2.1.1.2.cmml">​</mo><mrow id="alg2.l14.m1.3.3.2.1.1.1.1" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.3.3.2.1.1.1.1.2" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.cmml">(</mo><msub id="alg2.l14.m1.3.3.2.1.1.1.1.1" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.1.1.1.1.2" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.1.1.1.1.3" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" rspace="0.055em" id="alg2.l14.m1.3.3.2.1.1.1.1.3" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.222em" id="alg2.l14.m1.3.3.2.1.2" xref="alg2.l14.m1.3.3.2.1.2.cmml">⋅</mo><msubsup id="alg2.l14.m1.3.3.2.1.3" xref="alg2.l14.m1.3.3.2.1.3.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.3.2.2" xref="alg2.l14.m1.3.3.2.1.3.2.2.cmml">m</mi><mrow id="alg2.l14.m1.3.3.2.1.3.2.3" xref="alg2.l14.m1.3.3.2.1.3.2.3.cmml"><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.3.2.3.2" xref="alg2.l14.m1.3.3.2.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.3.3.2.1.3.2.3.1" xref="alg2.l14.m1.3.3.2.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="alg2.l14.m1.3.3.2.1.3.2.3.3" xref="alg2.l14.m1.3.3.2.1.3.2.3.3.cmml">i</mi></mrow><mrow id="alg2.l14.m1.1.1.1.3" xref="alg2.l14.m1.3.3.2.1.3.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.1.1.1.3.1" xref="alg2.l14.m1.3.3.2.1.3.cmml">(</mo><mi mathsize="90%" id="alg2.l14.m1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.cmml">T</mi><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.1.1.1.3.2" xref="alg2.l14.m1.3.3.2.1.3.cmml">)</mo></mrow></msubsup></mrow><mo lspace="0em" rspace="0em" id="alg2.l14.m1.4.4.3.3" xref="alg2.l14.m1.4.4.3.3.cmml">​</mo><mrow id="alg2.l14.m1.4.4.3.2.1" xref="alg2.l14.m1.4.4.3.2.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.4.4.3.2.1.2" xref="alg2.l14.m1.4.4.3.2.1.1.cmml">(</mo><msub id="alg2.l14.m1.4.4.3.2.1.1" xref="alg2.l14.m1.4.4.3.2.1.1.cmml"><mi mathsize="90%" id="alg2.l14.m1.4.4.3.2.1.1.2" xref="alg2.l14.m1.4.4.3.2.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l14.m1.4.4.3.2.1.1.3" xref="alg2.l14.m1.4.4.3.2.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l14.m1.4.4.3.2.1.3" xref="alg2.l14.m1.4.4.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.4b"><apply id="alg2.l14.m1.4.4.cmml" xref="alg2.l14.m1.4.4"><ci id="alg2.l14.m1.4.4.4.cmml" xref="alg2.l14.m1.4.4.4">←</ci><apply id="alg2.l14.m1.2.2.1.cmml" xref="alg2.l14.m1.2.2.1"><times id="alg2.l14.m1.2.2.1.2.cmml" xref="alg2.l14.m1.2.2.1.2"></times><apply id="alg2.l14.m1.2.2.1.3.cmml" xref="alg2.l14.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.1.3.1.cmml" xref="alg2.l14.m1.2.2.1.3">subscript</csymbol><ci id="alg2.l14.m1.2.2.1.3.2.cmml" xref="alg2.l14.m1.2.2.1.3.2">𝑏</ci><ci id="alg2.l14.m1.2.2.1.3.3.cmml" xref="alg2.l14.m1.2.2.1.3.3">𝑖</ci></apply><apply id="alg2.l14.m1.2.2.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1">subscript</csymbol><ci id="alg2.l14.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.2">𝑧</ci><ci id="alg2.l14.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg2.l14.m1.4.4.3.cmml" xref="alg2.l14.m1.4.4.3"><times id="alg2.l14.m1.4.4.3.3.cmml" xref="alg2.l14.m1.4.4.3.3"></times><apply id="alg2.l14.m1.3.3.2.1.cmml" xref="alg2.l14.m1.3.3.2.1"><ci id="alg2.l14.m1.3.3.2.1.2.cmml" xref="alg2.l14.m1.3.3.2.1.2">⋅</ci><apply id="alg2.l14.m1.3.3.2.1.1.cmml" xref="alg2.l14.m1.3.3.2.1.1"><times id="alg2.l14.m1.3.3.2.1.1.2.cmml" xref="alg2.l14.m1.3.3.2.1.1.2"></times><apply id="alg2.l14.m1.3.3.2.1.1.3.cmml" xref="alg2.l14.m1.3.3.2.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.2.1.1.3.1.cmml" xref="alg2.l14.m1.3.3.2.1.1.3">subscript</csymbol><ci id="alg2.l14.m1.3.3.2.1.1.3.2.cmml" xref="alg2.l14.m1.3.3.2.1.1.3.2">𝑏</ci><ci id="alg2.l14.m1.3.3.2.1.1.3.3.cmml" xref="alg2.l14.m1.3.3.2.1.1.3.3">𝑖</ci></apply><apply id="alg2.l14.m1.3.3.2.1.1.1.1.1.cmml" xref="alg2.l14.m1.3.3.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.2.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.3.3.2.1.1.1.1">subscript</csymbol><ci id="alg2.l14.m1.3.3.2.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.2">𝑧</ci><ci id="alg2.l14.m1.3.3.2.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.3.3.2.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg2.l14.m1.3.3.2.1.3.cmml" xref="alg2.l14.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.2.1.3.1.cmml" xref="alg2.l14.m1.3.3.2.1.3">superscript</csymbol><apply id="alg2.l14.m1.3.3.2.1.3.2.cmml" xref="alg2.l14.m1.3.3.2.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.3.3.2.1.3.2.1.cmml" xref="alg2.l14.m1.3.3.2.1.3">subscript</csymbol><ci id="alg2.l14.m1.3.3.2.1.3.2.2.cmml" xref="alg2.l14.m1.3.3.2.1.3.2.2">𝑚</ci><apply id="alg2.l14.m1.3.3.2.1.3.2.3.cmml" xref="alg2.l14.m1.3.3.2.1.3.2.3"><times id="alg2.l14.m1.3.3.2.1.3.2.3.1.cmml" xref="alg2.l14.m1.3.3.2.1.3.2.3.1"></times><ci id="alg2.l14.m1.3.3.2.1.3.2.3.2.cmml" xref="alg2.l14.m1.3.3.2.1.3.2.3.2">𝑘</ci><ci id="alg2.l14.m1.3.3.2.1.3.2.3.3.cmml" xref="alg2.l14.m1.3.3.2.1.3.2.3.3">𝑖</ci></apply></apply><ci id="alg2.l14.m1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1">𝑇</ci></apply></apply><apply id="alg2.l14.m1.4.4.3.2.1.1.cmml" xref="alg2.l14.m1.4.4.3.2.1"><csymbol cd="ambiguous" id="alg2.l14.m1.4.4.3.2.1.1.1.cmml" xref="alg2.l14.m1.4.4.3.2.1">subscript</csymbol><ci id="alg2.l14.m1.4.4.3.2.1.1.2.cmml" xref="alg2.l14.m1.4.4.3.2.1.1.2">𝑧</ci><ci id="alg2.l14.m1.4.4.3.2.1.1.3.cmml" xref="alg2.l14.m1.4.4.3.2.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.4c">b_{i}(z_{i})\leftarrow b_{i}(z_{i})\cdot m_{ki}^{(T)}(z_{i})</annotation></semantics></math><span id="alg2.l14.2" class="ltx_text" style="font-size:90%;">
   </span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span id="alg2.l15.1" class="ltx_text" style="font-size:90%;">   normalize(</span><math id="alg2.l15.m1.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="alg2.l15.m1.1a"><msub id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi mathsize="90%" id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">b</mi><mi mathsize="90%" id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1">subscript</csymbol><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝑏</ci><ci id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">b_{i}</annotation></semantics></math><span id="alg2.l15.2" class="ltx_text" style="font-size:90%;">)
</span>
</div>
<div id="alg2.l16" class="ltx_listingline">
<span id="alg2.l16.1" class="ltx_text ltx_font_bold" style="font-size:90%;">return</span><span id="alg2.l16.2" class="ltx_text" style="font-size:90%;"> </span><math id="alg2.l16.m1.1" class="ltx_Math" alttext="b_{i}(z_{i})" display="inline"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><msub id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><mi mathsize="90%" id="alg2.l16.m1.1.1.3.2" xref="alg2.l16.m1.1.1.3.2.cmml">b</mi><mi mathsize="90%" id="alg2.l16.m1.1.1.3.3" xref="alg2.l16.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml">​</mo><mrow id="alg2.l16.m1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="alg2.l16.m1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l16.m1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.cmml"><mi mathsize="90%" id="alg2.l16.m1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="alg2.l16.m1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="alg2.l16.m1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><times id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"></times><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2">𝑏</ci><ci id="alg2.l16.m1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.3.3">𝑖</ci></apply><apply id="alg2.l16.m1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l16.m1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.2">𝑧</ci><ci id="alg2.l16.m1.1.1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">b_{i}(z_{i})</annotation></semantics></math><span id="alg2.l16.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
</div>
</div>
</div>
</figure>
<div id="S3.SS3.SSS3.p1" class="ltx_para">
<p id="S3.SS3.SSS3.p1.4" class="ltx_p">Loopy Belief Propagation can be applied similarly by initializing all messages to a fixed value and updating the messages iteratively in a fixed or random order <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. In our grid-structured graph, since each factor is connected to only 2 variables, the variable-to-factor and factor-to-variable messages can be merged as a single message <math id="S3.SS3.SSS3.p1.1.m1.1" class="ltx_Math" alttext="m_{ij}" display="inline"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msub id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml">m</mi><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p1.1.m1.1.1.3.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2">𝑚</ci><apply id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3"><times id="S3.SS3.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">m_{ij}</annotation></semantics></math>, representing the message from <math id="S3.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><msub id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p1.2.m2.1.1.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><apply id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">z_{i}</annotation></semantics></math> to <math id="S3.SS3.SSS3.p1.3.m3.1" class="ltx_Math" alttext="z_{j}" display="inline"><semantics id="S3.SS3.SSS3.p1.3.m3.1a"><msub id="S3.SS3.SSS3.p1.3.m3.1.1" xref="S3.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p1.3.m3.1.1.2" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p1.3.m3.1.1.3" xref="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m3.1b"><apply id="S3.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m3.1c">z_{j}</annotation></semantics></math>. We initialize <math id="S3.SS3.SSS3.p1.4.m4.2" class="ltx_Math" alttext="m_{ij}^{(0)}(z_{j})=0.5" display="inline"><semantics id="S3.SS3.SSS3.p1.4.m4.2a"><mrow id="S3.SS3.SSS3.p1.4.m4.2.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.cmml"><mrow id="S3.SS3.SSS3.p1.4.m4.2.2.1" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.cmml"><msubsup id="S3.SS3.SSS3.p1.4.m4.2.2.1.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.cmml"><mi id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.2.cmml">m</mi><mrow id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.cmml"><mi id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.1" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.1.cmml">​</mo><mi id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.3.cmml">j</mi></mrow><mrow id="S3.SS3.SSS3.p1.4.m4.1.1.1.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p1.4.m4.1.1.1.3.1" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.cmml">(</mo><mn id="S3.SS3.SSS3.p1.4.m4.1.1.1.1" xref="S3.SS3.SSS3.p1.4.m4.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S3.SS3.SSS3.p1.4.m4.1.1.1.3.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p1.4.m4.2.2.1.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p1.4.m4.2.2.2" xref="S3.SS3.SSS3.p1.4.m4.2.2.2.cmml">=</mo><mn id="S3.SS3.SSS3.p1.4.m4.2.2.3" xref="S3.SS3.SSS3.p1.4.m4.2.2.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.4.m4.2b"><apply id="S3.SS3.SSS3.p1.4.m4.2.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2"><eq id="S3.SS3.SSS3.p1.4.m4.2.2.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.2"></eq><apply id="S3.SS3.SSS3.p1.4.m4.2.2.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1"><times id="S3.SS3.SSS3.p1.4.m4.2.2.1.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.2"></times><apply id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3">superscript</csymbol><apply id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.2">𝑚</ci><apply id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3"><times id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.1"></times><ci id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.2">𝑖</ci><ci id="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.3.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.3.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.SS3.SSS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.1.1.1.1">0</cn></apply><apply id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.1.1.1.1.3">𝑗</ci></apply></apply><cn type="float" id="S3.SS3.SSS3.p1.4.m4.2.2.3.cmml" xref="S3.SS3.SSS3.p1.4.m4.2.2.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.4.m4.2c">m_{ij}^{(0)}(z_{j})=0.5</annotation></semantics></math>, and iteratively update the messages based on the formula
<span id="S3.SS3.SSS3.p1.4.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.4" class="ltx_Math" alttext="m_{ij}^{(t)}(z_{j})=\alpha\sum_{z_{i}}\psi_{ij}(z_{i},z_{j})\psi_{i}(z_{i})\cdot\prod_{k\in N_{i}\setminus\{j\}}m_{ki}^{(t-1)}(z_{i})," display="block"><semantics id="S3.E14.m1.4a"><mrow id="S3.E14.m1.4.4.1" xref="S3.E14.m1.4.4.1.1.cmml"><mrow id="S3.E14.m1.4.4.1.1" xref="S3.E14.m1.4.4.1.1.cmml"><mrow id="S3.E14.m1.4.4.1.1.1" xref="S3.E14.m1.4.4.1.1.1.cmml"><msubsup id="S3.E14.m1.4.4.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.3.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.1.3.2.2" xref="S3.E14.m1.4.4.1.1.1.3.2.2.cmml">m</mi><mrow id="S3.E14.m1.4.4.1.1.1.3.2.3" xref="S3.E14.m1.4.4.1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.1.3.2.3.2" xref="S3.E14.m1.4.4.1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.1.3.2.3.1" xref="S3.E14.m1.4.4.1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.1.3.2.3.3" xref="S3.E14.m1.4.4.1.1.1.3.2.3.3.cmml">j</mi></mrow><mrow id="S3.E14.m1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.1.1.1.3.1" xref="S3.E14.m1.4.4.1.1.1.3.cmml">(</mo><mi mathsize="90%" id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml">t</mi><mo maxsize="90%" minsize="90%" id="S3.E14.m1.1.1.1.3.2" xref="S3.E14.m1.4.4.1.1.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.4.4.1.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E14.m1.4.4.1.1.1.1.1.1" xref="S3.E14.m1.4.4.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.1.1.1.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E14.m1.4.4.1.1.6" xref="S3.E14.m1.4.4.1.1.6.cmml">=</mo><mrow id="S3.E14.m1.4.4.1.1.5" xref="S3.E14.m1.4.4.1.1.5.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.6" xref="S3.E14.m1.4.4.1.1.5.6.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.5.5" xref="S3.E14.m1.4.4.1.1.5.5.cmml">​</mo><mrow id="S3.E14.m1.4.4.1.1.5.4" xref="S3.E14.m1.4.4.1.1.5.4.cmml"><munder id="S3.E14.m1.4.4.1.1.5.4.5" xref="S3.E14.m1.4.4.1.1.5.4.5.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E14.m1.4.4.1.1.5.4.5.2" xref="S3.E14.m1.4.4.1.1.5.4.5.2.cmml">∑</mo><msub id="S3.E14.m1.4.4.1.1.5.4.5.3" xref="S3.E14.m1.4.4.1.1.5.4.5.3.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.5.3.2" xref="S3.E14.m1.4.4.1.1.5.4.5.3.2.cmml">z</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.5.3.3" xref="S3.E14.m1.4.4.1.1.5.4.5.3.3.cmml">i</mi></msub></munder><mrow id="S3.E14.m1.4.4.1.1.5.4.4" xref="S3.E14.m1.4.4.1.1.5.4.4.cmml"><mrow id="S3.E14.m1.4.4.1.1.4.3.3.3" xref="S3.E14.m1.4.4.1.1.4.3.3.3.cmml"><msub id="S3.E14.m1.4.4.1.1.4.3.3.3.5" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.5.2" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.2.cmml">ψ</mi><mrow id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.2" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.1" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.3" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.4.3.3.3.4" xref="S3.E14.m1.4.4.1.1.4.3.3.3.4.cmml">​</mo><mrow id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.3" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.3.cmml">(</mo><msub id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.4" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.3.cmml">,</mo><msub id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.2" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.2.cmml">z</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.3" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.3.cmml">j</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.5" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.4.3.3.3.4a" xref="S3.E14.m1.4.4.1.1.4.3.3.3.4.cmml">​</mo><msub id="S3.E14.m1.4.4.1.1.4.3.3.3.6" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.6.2" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6.2.cmml">ψ</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.6.3" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.4.3.3.3.4b" xref="S3.E14.m1.4.4.1.1.4.3.3.3.4.cmml">​</mo><mrow id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.2" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.cmml">(</mo><msub id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.2" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.3" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" rspace="0.055em" id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.3" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mo mathsize="90%" rspace="0.055em" id="S3.E14.m1.4.4.1.1.5.4.4.5" xref="S3.E14.m1.4.4.1.1.5.4.4.5.cmml">⋅</mo><mrow id="S3.E14.m1.4.4.1.1.5.4.4.4" xref="S3.E14.m1.4.4.1.1.5.4.4.4.cmml"><munder id="S3.E14.m1.4.4.1.1.5.4.4.4.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.2.cmml"><mo maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" id="S3.E14.m1.4.4.1.1.5.4.4.4.2.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.2.2.cmml">∏</mo><mrow id="S3.E14.m1.2.2.1" xref="S3.E14.m1.2.2.1.cmml"><mi mathsize="90%" id="S3.E14.m1.2.2.1.3" xref="S3.E14.m1.2.2.1.3.cmml">k</mi><mo mathsize="90%" id="S3.E14.m1.2.2.1.2" xref="S3.E14.m1.2.2.1.2.cmml">∈</mo><mrow id="S3.E14.m1.2.2.1.4" xref="S3.E14.m1.2.2.1.4.cmml"><msub id="S3.E14.m1.2.2.1.4.2" xref="S3.E14.m1.2.2.1.4.2.cmml"><mi mathsize="90%" id="S3.E14.m1.2.2.1.4.2.2" xref="S3.E14.m1.2.2.1.4.2.2.cmml">N</mi><mi mathsize="90%" id="S3.E14.m1.2.2.1.4.2.3" xref="S3.E14.m1.2.2.1.4.2.3.cmml">i</mi></msub><mo mathsize="90%" id="S3.E14.m1.2.2.1.4.1" xref="S3.E14.m1.2.2.1.4.1.cmml">∖</mo><mrow id="S3.E14.m1.2.2.1.4.3.2" xref="S3.E14.m1.2.2.1.4.3.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.2.2.1.4.3.2.1" xref="S3.E14.m1.2.2.1.4.3.1.cmml">{</mo><mi mathsize="90%" id="S3.E14.m1.2.2.1.1" xref="S3.E14.m1.2.2.1.1.cmml">j</mi><mo maxsize="90%" minsize="90%" id="S3.E14.m1.2.2.1.4.3.2.2" xref="S3.E14.m1.2.2.1.4.3.1.cmml">}</mo></mrow></mrow></mrow></munder><mrow id="S3.E14.m1.4.4.1.1.5.4.4.4.1" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.cmml"><msubsup id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.2.cmml">m</mi><mrow id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.1" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.3" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.3.cmml">i</mi></mrow><mrow id="S3.E14.m1.3.3.1.1" xref="S3.E14.m1.3.3.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.3.3.1.1.2" xref="S3.E14.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.3.3.1.1.1" xref="S3.E14.m1.3.3.1.1.1.cmml"><mi mathsize="90%" id="S3.E14.m1.3.3.1.1.1.2" xref="S3.E14.m1.3.3.1.1.1.2.cmml">t</mi><mo mathsize="90%" id="S3.E14.m1.3.3.1.1.1.1" xref="S3.E14.m1.3.3.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="S3.E14.m1.3.3.1.1.1.3" xref="S3.E14.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo maxsize="90%" minsize="90%" id="S3.E14.m1.3.3.1.1.3" xref="S3.E14.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.2.cmml">​</mo><mrow id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.cmml">(</mo><msub id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.cmml"><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.2" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.2.cmml">z</mi><mi mathsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.3" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="90%" minsize="90%" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.3" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo mathsize="90%" id="S3.E14.m1.4.4.1.2" xref="S3.E14.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.4b"><apply id="S3.E14.m1.4.4.1.1.cmml" xref="S3.E14.m1.4.4.1"><eq id="S3.E14.m1.4.4.1.1.6.cmml" xref="S3.E14.m1.4.4.1.1.6"></eq><apply id="S3.E14.m1.4.4.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1"><times id="S3.E14.m1.4.4.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.2"></times><apply id="S3.E14.m1.4.4.1.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.3.1.cmml" xref="S3.E14.m1.4.4.1.1.1.3">superscript</csymbol><apply id="S3.E14.m1.4.4.1.1.1.3.2.cmml" xref="S3.E14.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.3.2.1.cmml" xref="S3.E14.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.3.2.2.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.2">𝑚</ci><apply id="S3.E14.m1.4.4.1.1.1.3.2.3.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.3"><times id="S3.E14.m1.4.4.1.1.1.3.2.3.1.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.3.1"></times><ci id="S3.E14.m1.4.4.1.1.1.3.2.3.2.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.3.2">𝑖</ci><ci id="S3.E14.m1.4.4.1.1.1.3.2.3.3.cmml" xref="S3.E14.m1.4.4.1.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1">𝑡</ci></apply><apply id="S3.E14.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E14.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E14.m1.4.4.1.1.5.cmml" xref="S3.E14.m1.4.4.1.1.5"><times id="S3.E14.m1.4.4.1.1.5.5.cmml" xref="S3.E14.m1.4.4.1.1.5.5"></times><ci id="S3.E14.m1.4.4.1.1.5.6.cmml" xref="S3.E14.m1.4.4.1.1.5.6">𝛼</ci><apply id="S3.E14.m1.4.4.1.1.5.4.cmml" xref="S3.E14.m1.4.4.1.1.5.4"><apply id="S3.E14.m1.4.4.1.1.5.4.5.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.5.4.5.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5">subscript</csymbol><sum id="S3.E14.m1.4.4.1.1.5.4.5.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5.2"></sum><apply id="S3.E14.m1.4.4.1.1.5.4.5.3.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.5.4.5.3.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.5.4.5.3.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5.3.2">𝑧</ci><ci id="S3.E14.m1.4.4.1.1.5.4.5.3.3.cmml" xref="S3.E14.m1.4.4.1.1.5.4.5.3.3">𝑖</ci></apply></apply><apply id="S3.E14.m1.4.4.1.1.5.4.4.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4"><ci id="S3.E14.m1.4.4.1.1.5.4.4.5.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.5">⋅</ci><apply id="S3.E14.m1.4.4.1.1.4.3.3.3.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3"><times id="S3.E14.m1.4.4.1.1.4.3.3.3.4.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.4"></times><apply id="S3.E14.m1.4.4.1.1.4.3.3.3.5.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.4.3.3.3.5.1.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.5.2.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.2">𝜓</ci><apply id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3"><times id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.1.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.1"></times><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.2.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.2">𝑖</ci><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.3.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.5.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.3.cmml" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2"><apply id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.cmml" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.1.cmml" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.2.cmml" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.2">𝑧</ci><ci id="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.3.cmml" xref="S3.E14.m1.4.4.1.1.3.2.2.2.2.2.2.3">𝑗</ci></apply></interval><apply id="S3.E14.m1.4.4.1.1.4.3.3.3.6.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.4.3.3.3.6.1.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.6.2.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6.2">𝜓</ci><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.6.3.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.6.3">𝑖</ci></apply><apply id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.2">𝑧</ci><ci id="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.4.3.3.3.3.1.1.3">𝑖</ci></apply></apply><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4"><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.2"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.5.4.4.4.2.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.2">subscript</csymbol><csymbol cd="latexml" id="S3.E14.m1.4.4.1.1.5.4.4.4.2.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.2.2">product</csymbol><apply id="S3.E14.m1.2.2.1.cmml" xref="S3.E14.m1.2.2.1"><in id="S3.E14.m1.2.2.1.2.cmml" xref="S3.E14.m1.2.2.1.2"></in><ci id="S3.E14.m1.2.2.1.3.cmml" xref="S3.E14.m1.2.2.1.3">𝑘</ci><apply id="S3.E14.m1.2.2.1.4.cmml" xref="S3.E14.m1.2.2.1.4"><setdiff id="S3.E14.m1.2.2.1.4.1.cmml" xref="S3.E14.m1.2.2.1.4.1"></setdiff><apply id="S3.E14.m1.2.2.1.4.2.cmml" xref="S3.E14.m1.2.2.1.4.2"><csymbol cd="ambiguous" id="S3.E14.m1.2.2.1.4.2.1.cmml" xref="S3.E14.m1.2.2.1.4.2">subscript</csymbol><ci id="S3.E14.m1.2.2.1.4.2.2.cmml" xref="S3.E14.m1.2.2.1.4.2.2">𝑁</ci><ci id="S3.E14.m1.2.2.1.4.2.3.cmml" xref="S3.E14.m1.2.2.1.4.2.3">𝑖</ci></apply><set id="S3.E14.m1.2.2.1.4.3.1.cmml" xref="S3.E14.m1.2.2.1.4.3.2"><ci id="S3.E14.m1.2.2.1.1.cmml" xref="S3.E14.m1.2.2.1.1">𝑗</ci></set></apply></apply></apply><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1"><times id="S3.E14.m1.4.4.1.1.5.4.4.4.1.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.2"></times><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3">superscript</csymbol><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.2">𝑚</ci><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3"><times id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.1"></times><ci id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.2">𝑘</ci><ci id="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.3.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E14.m1.3.3.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1"><minus id="S3.E14.m1.3.3.1.1.1.1.cmml" xref="S3.E14.m1.3.3.1.1.1.1"></minus><ci id="S3.E14.m1.3.3.1.1.1.2.cmml" xref="S3.E14.m1.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E14.m1.3.3.1.1.1.3.cmml" xref="S3.E14.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.1.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1">subscript</csymbol><ci id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.2.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.2">𝑧</ci><ci id="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.3.cmml" xref="S3.E14.m1.4.4.1.1.5.4.4.4.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.4c">m_{ij}^{(t)}(z_{j})=\alpha\sum_{z_{i}}\psi_{ij}(z_{i},z_{j})\psi_{i}(z_{i})\cdot\prod_{k\in N_{i}\setminus\{j\}}m_{ki}^{(t-1)}(z_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS3.p1.7" class="ltx_p">where <math id="S3.SS3.SSS3.p1.5.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.SSS3.p1.5.m1.1a"><mi id="S3.SS3.SSS3.p1.5.m1.1.1" xref="S3.SS3.SSS3.p1.5.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.5.m1.1b"><ci id="S3.SS3.SSS3.p1.5.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.5.m1.1c">\alpha</annotation></semantics></math> is the normalizing constant as above.
After a fixed number of steps <math id="S3.SS3.SSS3.p1.6.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.SSS3.p1.6.m2.1a"><mi id="S3.SS3.SSS3.p1.6.m2.1.1" xref="S3.SS3.SSS3.p1.6.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.6.m2.1b"><ci id="S3.SS3.SSS3.p1.6.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.6.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.6.m2.1c">T</annotation></semantics></math>, the variable <math id="S3.SS3.SSS3.p1.7.m3.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS3.SSS3.p1.7.m3.1a"><msub id="S3.SS3.SSS3.p1.7.m3.1.1" xref="S3.SS3.SSS3.p1.7.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p1.7.m3.1.1.2" xref="S3.SS3.SSS3.p1.7.m3.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p1.7.m3.1.1.3" xref="S3.SS3.SSS3.p1.7.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.7.m3.1b"><apply id="S3.SS3.SSS3.p1.7.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.7.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p1.7.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.7.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p1.7.m3.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p1.7.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p1.7.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.7.m3.1c">z_{i}</annotation></semantics></math> gathers all the messages from its neighbourhood to get the marginal probability:</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.2" class="ltx_Math" alttext="b_{i}(z_{i})=\beta\psi_{i}(z_{i})\prod_{k\in N_{i}}m^{(T)}_{ki}(z_{i})," display="block"><semantics id="S3.E15.m1.2a"><mrow id="S3.E15.m1.2.2.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1" xref="S3.E15.m1.2.2.1.1.cmml"><mrow id="S3.E15.m1.2.2.1.1.1" xref="S3.E15.m1.2.2.1.1.1.cmml"><msub id="S3.E15.m1.2.2.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.3.cmml"><mi id="S3.E15.m1.2.2.1.1.1.3.2" xref="S3.E15.m1.2.2.1.1.1.3.2.cmml">b</mi><mi id="S3.E15.m1.2.2.1.1.1.3.3" xref="S3.E15.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E15.m1.2.2.1.1.1.1.1.1" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E15.m1.2.2.1.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E15.m1.2.2.1.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.2.2.1.1.4" xref="S3.E15.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E15.m1.2.2.1.1.3" xref="S3.E15.m1.2.2.1.1.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.4" xref="S3.E15.m1.2.2.1.1.3.4.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.3.3" xref="S3.E15.m1.2.2.1.1.3.3.cmml">​</mo><msub id="S3.E15.m1.2.2.1.1.3.5" xref="S3.E15.m1.2.2.1.1.3.5.cmml"><mi id="S3.E15.m1.2.2.1.1.3.5.2" xref="S3.E15.m1.2.2.1.1.3.5.2.cmml">ψ</mi><mi id="S3.E15.m1.2.2.1.1.3.5.3" xref="S3.E15.m1.2.2.1.1.3.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.3.3a" xref="S3.E15.m1.2.2.1.1.3.3.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.2.1.1" xref="S3.E15.m1.2.2.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.2.1.1.2" xref="S3.E15.m1.2.2.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E15.m1.2.2.1.1.2.1.1.1" xref="S3.E15.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.2.1.1.1.2" xref="S3.E15.m1.2.2.1.1.2.1.1.1.2.cmml">z</mi><mi id="S3.E15.m1.2.2.1.1.2.1.1.1.3" xref="S3.E15.m1.2.2.1.1.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E15.m1.2.2.1.1.2.1.1.3" xref="S3.E15.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.3.3b" xref="S3.E15.m1.2.2.1.1.3.3.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.3.2" xref="S3.E15.m1.2.2.1.1.3.2.cmml"><munder id="S3.E15.m1.2.2.1.1.3.2.2" xref="S3.E15.m1.2.2.1.1.3.2.2.cmml"><mo movablelimits="false" id="S3.E15.m1.2.2.1.1.3.2.2.2" xref="S3.E15.m1.2.2.1.1.3.2.2.2.cmml">∏</mo><mrow id="S3.E15.m1.2.2.1.1.3.2.2.3" xref="S3.E15.m1.2.2.1.1.3.2.2.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.2.2.3.2" xref="S3.E15.m1.2.2.1.1.3.2.2.3.2.cmml">k</mi><mo id="S3.E15.m1.2.2.1.1.3.2.2.3.1" xref="S3.E15.m1.2.2.1.1.3.2.2.3.1.cmml">∈</mo><msub id="S3.E15.m1.2.2.1.1.3.2.2.3.3" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.2.2.3.3.2" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3.2.cmml">N</mi><mi id="S3.E15.m1.2.2.1.1.3.2.2.3.3.3" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S3.E15.m1.2.2.1.1.3.2.1" xref="S3.E15.m1.2.2.1.1.3.2.1.cmml"><msubsup id="S3.E15.m1.2.2.1.1.3.2.1.3" xref="S3.E15.m1.2.2.1.1.3.2.1.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.2.1.3.2.2" xref="S3.E15.m1.2.2.1.1.3.2.1.3.2.2.cmml">m</mi><mrow id="S3.E15.m1.2.2.1.1.3.2.1.3.3" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.cmml"><mi id="S3.E15.m1.2.2.1.1.3.2.1.3.3.2" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.3.2.1.3.3.1" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.1.cmml">​</mo><mi id="S3.E15.m1.2.2.1.1.3.2.1.3.3.3" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.3.cmml">i</mi></mrow><mrow id="S3.E15.m1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.3.2.1.3.cmml"><mo stretchy="false" id="S3.E15.m1.1.1.1.3.1" xref="S3.E15.m1.2.2.1.1.3.2.1.3.cmml">(</mo><mi id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml">T</mi><mo stretchy="false" id="S3.E15.m1.1.1.1.3.2" xref="S3.E15.m1.2.2.1.1.3.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E15.m1.2.2.1.1.3.2.1.2" xref="S3.E15.m1.2.2.1.1.3.2.1.2.cmml">​</mo><mrow id="S3.E15.m1.2.2.1.1.3.2.1.1.1" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.2.2.1.1.3.2.1.1.1.2" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.cmml">(</mo><msub id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.cmml"><mi id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.2" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.2.cmml">z</mi><mi id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.3" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E15.m1.2.2.1.1.3.2.1.1.1.3" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E15.m1.2.2.1.2" xref="S3.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.2b"><apply id="S3.E15.m1.2.2.1.1.cmml" xref="S3.E15.m1.2.2.1"><eq id="S3.E15.m1.2.2.1.1.4.cmml" xref="S3.E15.m1.2.2.1.1.4"></eq><apply id="S3.E15.m1.2.2.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1"><times id="S3.E15.m1.2.2.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.2"></times><apply id="S3.E15.m1.2.2.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.1.3.2">𝑏</ci><ci id="S3.E15.m1.2.2.1.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E15.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E15.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E15.m1.2.2.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3"><times id="S3.E15.m1.2.2.1.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.3"></times><ci id="S3.E15.m1.2.2.1.1.3.4.cmml" xref="S3.E15.m1.2.2.1.1.3.4">𝛽</ci><apply id="S3.E15.m1.2.2.1.1.3.5.cmml" xref="S3.E15.m1.2.2.1.1.3.5"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.5.1.cmml" xref="S3.E15.m1.2.2.1.1.3.5">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.3.5.2.cmml" xref="S3.E15.m1.2.2.1.1.3.5.2">𝜓</ci><ci id="S3.E15.m1.2.2.1.1.3.5.3.cmml" xref="S3.E15.m1.2.2.1.1.3.5.3">𝑖</ci></apply><apply id="S3.E15.m1.2.2.1.1.2.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.2.1.1">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.2.1.1.1.2">𝑧</ci><ci id="S3.E15.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.2.1.1.1.3">𝑖</ci></apply><apply id="S3.E15.m1.2.2.1.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2"><apply id="S3.E15.m1.2.2.1.1.3.2.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.E15.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.2">product</csymbol><apply id="S3.E15.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3"><in id="S3.E15.m1.2.2.1.1.3.2.2.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3.1"></in><ci id="S3.E15.m1.2.2.1.1.3.2.2.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3.2">𝑘</ci><apply id="S3.E15.m1.2.2.1.1.3.2.2.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.2.2.3.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.3.2.2.3.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3.2">𝑁</ci><ci id="S3.E15.m1.2.2.1.1.3.2.2.3.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E15.m1.2.2.1.1.3.2.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1"><times id="S3.E15.m1.2.2.1.1.3.2.1.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.2"></times><apply id="S3.E15.m1.2.2.1.1.3.2.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.2.1.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3">subscript</csymbol><apply id="S3.E15.m1.2.2.1.1.3.2.1.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.2.1.3.2.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3">superscript</csymbol><ci id="S3.E15.m1.2.2.1.1.3.2.1.3.2.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3.2.2">𝑚</ci><ci id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1">𝑇</ci></apply><apply id="S3.E15.m1.2.2.1.1.3.2.1.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3"><times id="S3.E15.m1.2.2.1.1.3.2.1.3.3.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.1"></times><ci id="S3.E15.m1.2.2.1.1.3.2.1.3.3.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.2">𝑘</ci><ci id="S3.E15.m1.2.2.1.1.3.2.1.3.3.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.1.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1">subscript</csymbol><ci id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.2.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.2">𝑧</ci><ci id="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.3.cmml" xref="S3.E15.m1.2.2.1.1.3.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.2c">b_{i}(z_{i})=\beta\psi_{i}(z_{i})\prod_{k\in N_{i}}m^{(T)}_{ki}(z_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS3.p1.8" class="ltx_p">where <math id="S3.SS3.SSS3.p1.8.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS3.SSS3.p1.8.m1.1a"><mi id="S3.SS3.SSS3.p1.8.m1.1.1" xref="S3.SS3.SSS3.p1.8.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.8.m1.1b"><ci id="S3.SS3.SSS3.p1.8.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.8.m1.1c">\beta</annotation></semantics></math> is the normalizing constant.</p>
</div>
<div id="S3.SS3.SSS3.p2" class="ltx_para">
<p id="S3.SS3.SSS3.p2.6" class="ltx_p">Similar to MF, LBP can also be unfolded into parameterless recurrent layer, where at each time step <math id="S3.SS3.SSS3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.SSS3.p2.1.m1.1a"><mi id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.1b"><ci id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.1c">t</annotation></semantics></math> the input is <math id="S3.SS3.SSS3.p2.2.m2.2" class="ltx_Math" alttext="\psi_{i}(z_{i}),\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS3.SSS3.p2.2.m2.2a"><mrow id="S3.SS3.SSS3.p2.2.m2.2.2.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.3.cmml"><mrow id="S3.SS3.SSS3.p2.2.m2.1.1.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.cmml"><msub id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.2.cmml">ψ</mi><mi id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p2.2.m2.2.2.2.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.3.cmml">,</mo><mrow id="S3.SS3.SSS3.p2.2.m2.2.2.2.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.cmml"><msub id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.1" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.1.cmml">​</mo><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.3.cmml">​</mo><mrow id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.4" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.2" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.3" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.5" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.2b"><list id="S3.SS3.SSS3.p2.2.m2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2"><apply id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1"><times id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.2"></times><apply id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.2">𝜓</ci><ci id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2"><times id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.3"></times><apply id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.2">𝜓</ci><apply id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3"><times id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.1"></times><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.2">𝑖</ci><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2"><apply id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p2.2.m2.2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.2c">\psi_{i}(z_{i}),\psi_{ij}(z_{i},z_{j})</annotation></semantics></math> and <math id="S3.SS3.SSS3.p2.3.m3.2" class="ltx_Math" alttext="m^{(t-1)}_{ij}(z_{j})" display="inline"><semantics id="S3.SS3.SSS3.p2.3.m3.2a"><mrow id="S3.SS3.SSS3.p2.3.m3.2.2" xref="S3.SS3.SSS3.p2.3.m3.2.2.cmml"><msubsup id="S3.SS3.SSS3.p2.3.m3.2.2.3" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.2.2.3.2.2" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.2.2.cmml">m</mi><mrow id="S3.SS3.SSS3.p2.3.m3.2.2.3.3" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.2" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.1" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.1.cmml">​</mo><mi id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.3" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.3.cmml">j</mi></mrow><mrow id="S3.SS3.SSS3.p2.3.m3.1.1.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.3.m3.2.2.2" xref="S3.SS3.SSS3.p2.3.m3.2.2.2.cmml">​</mo><mrow id="S3.SS3.SSS3.p2.3.m3.2.2.1.1" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.2" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.2" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.2b"><apply id="S3.SS3.SSS3.p2.3.m3.2.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2"><times id="S3.SS3.SSS3.p2.3.m3.2.2.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.2"></times><apply id="S3.SS3.SSS3.p2.3.m3.2.2.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.2.2.3.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3">subscript</csymbol><apply id="S3.SS3.SSS3.p2.3.m3.2.2.3.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.2.2.3.2.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.2.2.3.2.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.2.2">𝑚</ci><apply id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1"><minus id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.1"></minus><ci id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3"><times id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.1"></times><ci id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.2">𝑖</ci><ci id="S3.SS3.SSS3.p2.3.m3.2.2.3.3.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.3.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.2.2.1.1.1.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.2c">m^{(t-1)}_{ij}(z_{j})</annotation></semantics></math>, and after <math id="S3.SS3.SSS3.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><mi id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><ci id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">T</annotation></semantics></math> steps <math id="S3.SS3.SSS3.p2.5.m5.2" class="ltx_Math" alttext="m^{(T)}(z_{i})" display="inline"><semantics id="S3.SS3.SSS3.p2.5.m5.2a"><mrow id="S3.SS3.SSS3.p2.5.m5.2.2" xref="S3.SS3.SSS3.p2.5.m5.2.2.cmml"><msup id="S3.SS3.SSS3.p2.5.m5.2.2.3" xref="S3.SS3.SSS3.p2.5.m5.2.2.3.cmml"><mi id="S3.SS3.SSS3.p2.5.m5.2.2.3.2" xref="S3.SS3.SSS3.p2.5.m5.2.2.3.2.cmml">m</mi><mrow id="S3.SS3.SSS3.p2.5.m5.1.1.1.3" xref="S3.SS3.SSS3.p2.5.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.5.m5.1.1.1.3.1" xref="S3.SS3.SSS3.p2.5.m5.2.2.3.cmml">(</mo><mi id="S3.SS3.SSS3.p2.5.m5.1.1.1.1" xref="S3.SS3.SSS3.p2.5.m5.1.1.1.1.cmml">T</mi><mo stretchy="false" id="S3.SS3.SSS3.p2.5.m5.1.1.1.3.2" xref="S3.SS3.SSS3.p2.5.m5.2.2.3.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.5.m5.2.2.2" xref="S3.SS3.SSS3.p2.5.m5.2.2.2.cmml">​</mo><mrow id="S3.SS3.SSS3.p2.5.m5.2.2.1.1" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.2" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.2" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.3" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.3" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.5.m5.2b"><apply id="S3.SS3.SSS3.p2.5.m5.2.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2"><times id="S3.SS3.SSS3.p2.5.m5.2.2.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.2"></times><apply id="S3.SS3.SSS3.p2.5.m5.2.2.3.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.5.m5.2.2.3.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.3">superscript</csymbol><ci id="S3.SS3.SSS3.p2.5.m5.2.2.3.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.3.2">𝑚</ci><ci id="S3.SS3.SSS3.p2.5.m5.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.1.1.1.1">𝑇</ci></apply><apply id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.5.m5.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.5.m5.2c">m^{(T)}(z_{i})</annotation></semantics></math> is used to compute marginal probability <math id="S3.SS3.SSS3.p2.6.m6.1" class="ltx_Math" alttext="b_{i}(z_{i})" display="inline"><semantics id="S3.SS3.SSS3.p2.6.m6.1a"><mrow id="S3.SS3.SSS3.p2.6.m6.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.cmml"><msub id="S3.SS3.SSS3.p2.6.m6.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS3.p2.6.m6.1.1.3.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.2.cmml">b</mi><mi id="S3.SS3.SSS3.p2.6.m6.1.1.3.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.SSS3.p2.6.m6.1.1.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml">​</mo><mrow id="S3.SS3.SSS3.p2.6.m6.1.1.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.2" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.3" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.6.m6.1b"><apply id="S3.SS3.SSS3.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1"><times id="S3.SS3.SSS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.2"></times><apply id="S3.SS3.SSS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p2.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.2">𝑏</ci><ci id="S3.SS3.SSS3.p2.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p2.6.m6.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.6.m6.1c">b_{i}(z_{i})</annotation></semantics></math>, as shown in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 3.3.3 Loopy Belief Propagation Layers ‣ 3.3 Recurrent Inference Layers ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>The overall structure</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.10" class="ltx_p">As shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the overall structure of the proposed model is an end-to-end classification neural network. Firstly, <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><msub id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">ψ</mi><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p1.1.m1.1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.1.m1.1.1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p1.1.m1.1.1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS4.p1.1.m1.1.1.1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS4.p1.1.m1.1.1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2"></times><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝜓</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS4.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\psi_{i}(z_{i})</annotation></semantics></math> and <math id="S3.SS4.p1.2.m2.2" class="ltx_Math" alttext="\psi_{ij}(z_{i},z_{j})" display="inline"><semantics id="S3.SS4.p1.2.m2.2a"><mrow id="S3.SS4.p1.2.m2.2.2" xref="S3.SS4.p1.2.m2.2.2.cmml"><msub id="S3.SS4.p1.2.m2.2.2.4" xref="S3.SS4.p1.2.m2.2.2.4.cmml"><mi id="S3.SS4.p1.2.m2.2.2.4.2" xref="S3.SS4.p1.2.m2.2.2.4.2.cmml">ψ</mi><mrow id="S3.SS4.p1.2.m2.2.2.4.3" xref="S3.SS4.p1.2.m2.2.2.4.3.cmml"><mi id="S3.SS4.p1.2.m2.2.2.4.3.2" xref="S3.SS4.p1.2.m2.2.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.2.2.4.3.1" xref="S3.SS4.p1.2.m2.2.2.4.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.2.2.4.3.3" xref="S3.SS4.p1.2.m2.2.2.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.2.2.3" xref="S3.SS4.p1.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS4.p1.2.m2.2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.2.m2.2.2.2.2.3" xref="S3.SS4.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p1.2.m2.1.1.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.1.1.1.2" xref="S3.SS4.p1.2.m2.1.1.1.1.1.2.cmml">z</mi><mi id="S3.SS4.p1.2.m2.1.1.1.1.1.3" xref="S3.SS4.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p1.2.m2.2.2.2.2.4" xref="S3.SS4.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.2.m2.2.2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS4.p1.2.m2.2.2.2.2.2.2" xref="S3.SS4.p1.2.m2.2.2.2.2.2.2.cmml">z</mi><mi id="S3.SS4.p1.2.m2.2.2.2.2.2.3" xref="S3.SS4.p1.2.m2.2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS4.p1.2.m2.2.2.2.2.5" xref="S3.SS4.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.2b"><apply id="S3.SS4.p1.2.m2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2"><times id="S3.SS4.p1.2.m2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.3"></times><apply id="S3.SS4.p1.2.m2.2.2.4.cmml" xref="S3.SS4.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.4.1.cmml" xref="S3.SS4.p1.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.4.2.cmml" xref="S3.SS4.p1.2.m2.2.2.4.2">𝜓</ci><apply id="S3.SS4.p1.2.m2.2.2.4.3.cmml" xref="S3.SS4.p1.2.m2.2.2.4.3"><times id="S3.SS4.p1.2.m2.2.2.4.3.1.cmml" xref="S3.SS4.p1.2.m2.2.2.4.3.1"></times><ci id="S3.SS4.p1.2.m2.2.2.4.3.2.cmml" xref="S3.SS4.p1.2.m2.2.2.4.3.2">𝑖</ci><ci id="S3.SS4.p1.2.m2.2.2.4.3.3.cmml" xref="S3.SS4.p1.2.m2.2.2.4.3.3">𝑗</ci></apply></apply><interval closure="open" id="S3.SS4.p1.2.m2.2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2"><apply id="S3.SS4.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.1.2">𝑧</ci><ci id="S3.SS4.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS4.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2.2.2">𝑧</ci><ci id="S3.SS4.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.2.m2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.2c">\psi_{ij}(z_{i},z_{j})</annotation></semantics></math> are computed using the extracted features <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{X}}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\boldsymbol{\mathrm{X}}</annotation></semantics></math> and <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\boldsymbol{q}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\boldsymbol{q}</annotation></semantics></math>. Then, the recurrent inference layers run for <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">T</annotation></semantics></math> steps to get the structured marginal probability <math id="S3.SS4.p1.6.m6.5" class="ltx_Math" alttext="p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})=b_{i}^{(T)}(z_{i}=1)" display="inline"><semantics id="S3.SS4.p1.6.m6.5a"><mrow id="S3.SS4.p1.6.m6.5.5" xref="S3.SS4.p1.6.m6.5.5.cmml"><mrow id="S3.SS4.p1.6.m6.4.4.1" xref="S3.SS4.p1.6.m6.4.4.1.cmml"><mi id="S3.SS4.p1.6.m6.4.4.1.3" xref="S3.SS4.p1.6.m6.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.4.4.1.2" xref="S3.SS4.p1.6.m6.4.4.1.2.cmml">​</mo><mrow id="S3.SS4.p1.6.m6.4.4.1.1.1" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.4.4.1.1.1.2" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.6.m6.4.4.1.1.1.1" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.cmml"><msub id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.cmml"><mi id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.2" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.2.cmml">z</mi><mi id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.3" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.6.m6.4.4.1.1.1.1.1" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.1.cmml">=</mo><mrow id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.cmml"><mn id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.2" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.2.cmml">1</mn><mo fence="false" id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.1" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.1.cmml">|</mo><mrow id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.3.2" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.3.1.cmml"><mi id="S3.SS4.p1.6.m6.2.2" xref="S3.SS4.p1.6.m6.2.2.cmml">𝐗</mi><mo id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.3.2.1" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.SS4.p1.6.m6.3.3" xref="S3.SS4.p1.6.m6.3.3.cmml">𝒒</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.SS4.p1.6.m6.4.4.1.1.1.3" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p1.6.m6.5.5.3" xref="S3.SS4.p1.6.m6.5.5.3.cmml">=</mo><mrow id="S3.SS4.p1.6.m6.5.5.2" xref="S3.SS4.p1.6.m6.5.5.2.cmml"><msubsup id="S3.SS4.p1.6.m6.5.5.2.3" xref="S3.SS4.p1.6.m6.5.5.2.3.cmml"><mi id="S3.SS4.p1.6.m6.5.5.2.3.2.2" xref="S3.SS4.p1.6.m6.5.5.2.3.2.2.cmml">b</mi><mi id="S3.SS4.p1.6.m6.5.5.2.3.2.3" xref="S3.SS4.p1.6.m6.5.5.2.3.2.3.cmml">i</mi><mrow id="S3.SS4.p1.6.m6.1.1.1.3" xref="S3.SS4.p1.6.m6.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.1.1.1.3.1" xref="S3.SS4.p1.6.m6.5.5.2.3.cmml">(</mo><mi id="S3.SS4.p1.6.m6.1.1.1.1" xref="S3.SS4.p1.6.m6.1.1.1.1.cmml">T</mi><mo stretchy="false" id="S3.SS4.p1.6.m6.1.1.1.3.2" xref="S3.SS4.p1.6.m6.5.5.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.SS4.p1.6.m6.5.5.2.2" xref="S3.SS4.p1.6.m6.5.5.2.2.cmml">​</mo><mrow id="S3.SS4.p1.6.m6.5.5.2.1.1" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.6.m6.5.5.2.1.1.2" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.6.m6.5.5.2.1.1.1" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.cmml"><msub id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.cmml"><mi id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.2" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.2.cmml">z</mi><mi id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.3" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.6.m6.5.5.2.1.1.1.1" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.6.m6.5.5.2.1.1.1.3" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS4.p1.6.m6.5.5.2.1.1.3" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.5b"><apply id="S3.SS4.p1.6.m6.5.5.cmml" xref="S3.SS4.p1.6.m6.5.5"><eq id="S3.SS4.p1.6.m6.5.5.3.cmml" xref="S3.SS4.p1.6.m6.5.5.3"></eq><apply id="S3.SS4.p1.6.m6.4.4.1.cmml" xref="S3.SS4.p1.6.m6.4.4.1"><times id="S3.SS4.p1.6.m6.4.4.1.2.cmml" xref="S3.SS4.p1.6.m6.4.4.1.2"></times><ci id="S3.SS4.p1.6.m6.4.4.1.3.cmml" xref="S3.SS4.p1.6.m6.4.4.1.3">𝑝</ci><apply id="S3.SS4.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1"><eq id="S3.SS4.p1.6.m6.4.4.1.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.1"></eq><apply id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.2">𝑧</ci><ci id="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.1.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.1">conditional</csymbol><cn type="integer" id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.2.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.2">1</cn><list id="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.3.1.cmml" xref="S3.SS4.p1.6.m6.4.4.1.1.1.1.3.3.2"><ci id="S3.SS4.p1.6.m6.2.2.cmml" xref="S3.SS4.p1.6.m6.2.2">𝐗</ci><ci id="S3.SS4.p1.6.m6.3.3.cmml" xref="S3.SS4.p1.6.m6.3.3">𝒒</ci></list></apply></apply></apply><apply id="S3.SS4.p1.6.m6.5.5.2.cmml" xref="S3.SS4.p1.6.m6.5.5.2"><times id="S3.SS4.p1.6.m6.5.5.2.2.cmml" xref="S3.SS4.p1.6.m6.5.5.2.2"></times><apply id="S3.SS4.p1.6.m6.5.5.2.3.cmml" xref="S3.SS4.p1.6.m6.5.5.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.5.5.2.3.1.cmml" xref="S3.SS4.p1.6.m6.5.5.2.3">superscript</csymbol><apply id="S3.SS4.p1.6.m6.5.5.2.3.2.cmml" xref="S3.SS4.p1.6.m6.5.5.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.5.5.2.3.2.1.cmml" xref="S3.SS4.p1.6.m6.5.5.2.3">subscript</csymbol><ci id="S3.SS4.p1.6.m6.5.5.2.3.2.2.cmml" xref="S3.SS4.p1.6.m6.5.5.2.3.2.2">𝑏</ci><ci id="S3.SS4.p1.6.m6.5.5.2.3.2.3.cmml" xref="S3.SS4.p1.6.m6.5.5.2.3.2.3">𝑖</ci></apply><ci id="S3.SS4.p1.6.m6.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1.1">𝑇</ci></apply><apply id="S3.SS4.p1.6.m6.5.5.2.1.1.1.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1"><eq id="S3.SS4.p1.6.m6.5.5.2.1.1.1.1.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.1"></eq><apply id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.1.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.2.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.2">𝑧</ci><ci id="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.3.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS4.p1.6.m6.5.5.2.1.1.1.3.cmml" xref="S3.SS4.p1.6.m6.5.5.2.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.5c">p(z_{i}=1|\boldsymbol{\mathrm{X}},\boldsymbol{q})=b_{i}^{(T)}(z_{i}=1)</annotation></semantics></math>, which is then used to compute the structured context <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="\hat{\boldsymbol{\mathrm{c}}}" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><mover accent="true" id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">𝐜</mi><mo id="S3.SS4.p1.7.m7.1.1.1" xref="S3.SS4.p1.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><ci id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1.1">^</ci><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">𝐜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">\hat{\boldsymbol{\mathrm{c}}}</annotation></semantics></math> with Eq. <a href="#S3.E5" title="In 3.2 Structured Multivariate Attention ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. We also compute a unstructured context <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="\tilde{\boldsymbol{\mathrm{c}}}" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><mover accent="true" id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml"><mi id="S3.SS4.p1.8.m8.1.1.2" xref="S3.SS4.p1.8.m8.1.1.2.cmml">𝐜</mi><mo id="S3.SS4.p1.8.m8.1.1.1" xref="S3.SS4.p1.8.m8.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1"><ci id="S3.SS4.p1.8.m8.1.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1.1">~</ci><ci id="S3.SS4.p1.8.m8.1.1.2.cmml" xref="S3.SS4.p1.8.m8.1.1.2">𝐜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">\tilde{\boldsymbol{\mathrm{c}}}</annotation></semantics></math> with Eq. <a href="#S3.E1" title="In 3.1 Unstructured Categorical Attention ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> by replacing <math id="S3.SS4.p1.9.m9.2" class="ltx_Math" alttext="\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q})" display="inline"><semantics id="S3.SS4.p1.9.m9.2a"><mrow id="S3.SS4.p1.9.m9.2.2" xref="S3.SS4.p1.9.m9.2.2.cmml"><mi id="S3.SS4.p1.9.m9.2.2.3" xref="S3.SS4.p1.9.m9.2.2.3.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m9.2.2.2" xref="S3.SS4.p1.9.m9.2.2.2.cmml">​</mo><mi id="S3.SS4.p1.9.m9.2.2.4" xref="S3.SS4.p1.9.m9.2.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.9.m9.2.2.2a" xref="S3.SS4.p1.9.m9.2.2.2.cmml">​</mo><mrow id="S3.SS4.p1.9.m9.2.2.1.1" xref="S3.SS4.p1.9.m9.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.9.m9.2.2.1.1.2" xref="S3.SS4.p1.9.m9.2.2.1.2.cmml">(</mo><msub id="S3.SS4.p1.9.m9.2.2.1.1.1" xref="S3.SS4.p1.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS4.p1.9.m9.2.2.1.1.1.2" xref="S3.SS4.p1.9.m9.2.2.1.1.1.2.cmml">𝐱</mi><mi id="S3.SS4.p1.9.m9.2.2.1.1.1.3" xref="S3.SS4.p1.9.m9.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p1.9.m9.2.2.1.1.3" xref="S3.SS4.p1.9.m9.2.2.1.2.cmml">,</mo><mi id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml">𝒒</mi><mo stretchy="false" id="S3.SS4.p1.9.m9.2.2.1.1.4" xref="S3.SS4.p1.9.m9.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.2b"><apply id="S3.SS4.p1.9.m9.2.2.cmml" xref="S3.SS4.p1.9.m9.2.2"><times id="S3.SS4.p1.9.m9.2.2.2.cmml" xref="S3.SS4.p1.9.m9.2.2.2"></times><ci id="S3.SS4.p1.9.m9.2.2.3.cmml" xref="S3.SS4.p1.9.m9.2.2.3">𝐔</ci><ci id="S3.SS4.p1.9.m9.2.2.4.cmml" xref="S3.SS4.p1.9.m9.2.2.4">𝑔</ci><interval closure="open" id="S3.SS4.p1.9.m9.2.2.1.2.cmml" xref="S3.SS4.p1.9.m9.2.2.1.1"><apply id="S3.SS4.p1.9.m9.2.2.1.1.1.cmml" xref="S3.SS4.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS4.p1.9.m9.2.2.1.1.1.2">𝐱</ci><ci id="S3.SS4.p1.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS4.p1.9.m9.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">𝒒</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.2c">\boldsymbol{\mathrm{U}}g(\boldsymbol{\mathrm{x}}_{i},\boldsymbol{q})</annotation></semantics></math> in Eq. <a href="#S3.E3" title="In 3.1 Unstructured Categorical Attention ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> with <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="\psi_{i}(z_{i}=1)" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mrow id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml"><msub id="S3.SS4.p1.10.m10.1.1.3" xref="S3.SS4.p1.10.m10.1.1.3.cmml"><mi id="S3.SS4.p1.10.m10.1.1.3.2" xref="S3.SS4.p1.10.m10.1.1.3.2.cmml">ψ</mi><mi id="S3.SS4.p1.10.m10.1.1.3.3" xref="S3.SS4.p1.10.m10.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.10.m10.1.1.2" xref="S3.SS4.p1.10.m10.1.1.2.cmml">​</mo><mrow id="S3.SS4.p1.10.m10.1.1.1.1" xref="S3.SS4.p1.10.m10.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.10.m10.1.1.1.1.2" xref="S3.SS4.p1.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.10.m10.1.1.1.1.1" xref="S3.SS4.p1.10.m10.1.1.1.1.1.cmml"><msub id="S3.SS4.p1.10.m10.1.1.1.1.1.2" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p1.10.m10.1.1.1.1.1.2.2" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.SS4.p1.10.m10.1.1.1.1.1.2.3" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.10.m10.1.1.1.1.1.1" xref="S3.SS4.p1.10.m10.1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS4.p1.10.m10.1.1.1.1.1.3" xref="S3.SS4.p1.10.m10.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS4.p1.10.m10.1.1.1.1.3" xref="S3.SS4.p1.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1"><times id="S3.SS4.p1.10.m10.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.2"></times><apply id="S3.SS4.p1.10.m10.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.3.1.cmml" xref="S3.SS4.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.3.2.cmml" xref="S3.SS4.p1.10.m10.1.1.3.2">𝜓</ci><ci id="S3.SS4.p1.10.m10.1.1.3.3.cmml" xref="S3.SS4.p1.10.m10.1.1.3.3">𝑖</ci></apply><apply id="S3.SS4.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1"><eq id="S3.SS4.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1.1.1"></eq><apply id="S3.SS4.p1.10.m10.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.SS4.p1.10.m10.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS4.p1.10.m10.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.10.m10.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">\psi_{i}(z_{i}=1)</annotation></semantics></math>. In the classifier, the contexts are both pooled with the question to get</p>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.3" class="ltx_Math" alttext="\hat{\boldsymbol{\mathrm{s}}}=g(\hat{\boldsymbol{\mathrm{c}}},\boldsymbol{q};\hat{\boldsymbol{\mathrm{W}}}_{c},\hat{\boldsymbol{\mathrm{W}}}_{q})," display="block"><semantics id="S3.E16.m1.3a"><mrow id="S3.E16.m1.3.3.1" xref="S3.E16.m1.3.3.1.1.cmml"><mrow id="S3.E16.m1.3.3.1.1" xref="S3.E16.m1.3.3.1.1.cmml"><mover accent="true" id="S3.E16.m1.3.3.1.1.4" xref="S3.E16.m1.3.3.1.1.4.cmml"><mi id="S3.E16.m1.3.3.1.1.4.2" xref="S3.E16.m1.3.3.1.1.4.2.cmml">𝐬</mi><mo id="S3.E16.m1.3.3.1.1.4.1" xref="S3.E16.m1.3.3.1.1.4.1.cmml">^</mo></mover><mo id="S3.E16.m1.3.3.1.1.3" xref="S3.E16.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E16.m1.3.3.1.1.2" xref="S3.E16.m1.3.3.1.1.2.cmml"><mi id="S3.E16.m1.3.3.1.1.2.4" xref="S3.E16.m1.3.3.1.1.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.3.3.1.1.2.3" xref="S3.E16.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E16.m1.3.3.1.1.2.2.2" xref="S3.E16.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E16.m1.3.3.1.1.2.2.2.3" xref="S3.E16.m1.3.3.1.1.2.2.3.cmml">(</mo><mover accent="true" id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><mi id="S3.E16.m1.1.1.2" xref="S3.E16.m1.1.1.2.cmml">𝐜</mi><mo id="S3.E16.m1.1.1.1" xref="S3.E16.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E16.m1.3.3.1.1.2.2.2.4" xref="S3.E16.m1.3.3.1.1.2.2.3.cmml">,</mo><mi id="S3.E16.m1.2.2" xref="S3.E16.m1.2.2.cmml">𝒒</mi><mo id="S3.E16.m1.3.3.1.1.2.2.2.5" xref="S3.E16.m1.3.3.1.1.2.2.3.cmml">;</mo><msub id="S3.E16.m1.3.3.1.1.1.1.1.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E16.m1.3.3.1.1.1.1.1.1.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E16.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mo id="S3.E16.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E16.m1.3.3.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E16.m1.3.3.1.1.1.1.1.1.3" xref="S3.E16.m1.3.3.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E16.m1.3.3.1.1.2.2.2.6" xref="S3.E16.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E16.m1.3.3.1.1.2.2.2.2" xref="S3.E16.m1.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E16.m1.3.3.1.1.2.2.2.2.2" xref="S3.E16.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E16.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E16.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝐖</mi><mo id="S3.E16.m1.3.3.1.1.2.2.2.2.2.1" xref="S3.E16.m1.3.3.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E16.m1.3.3.1.1.2.2.2.2.3" xref="S3.E16.m1.3.3.1.1.2.2.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S3.E16.m1.3.3.1.1.2.2.2.7" xref="S3.E16.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E16.m1.3.3.1.2" xref="S3.E16.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.3b"><apply id="S3.E16.m1.3.3.1.1.cmml" xref="S3.E16.m1.3.3.1"><eq id="S3.E16.m1.3.3.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.3"></eq><apply id="S3.E16.m1.3.3.1.1.4.cmml" xref="S3.E16.m1.3.3.1.1.4"><ci id="S3.E16.m1.3.3.1.1.4.1.cmml" xref="S3.E16.m1.3.3.1.1.4.1">^</ci><ci id="S3.E16.m1.3.3.1.1.4.2.cmml" xref="S3.E16.m1.3.3.1.1.4.2">𝐬</ci></apply><apply id="S3.E16.m1.3.3.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.2"><times id="S3.E16.m1.3.3.1.1.2.3.cmml" xref="S3.E16.m1.3.3.1.1.2.3"></times><ci id="S3.E16.m1.3.3.1.1.2.4.cmml" xref="S3.E16.m1.3.3.1.1.2.4">𝑔</ci><vector id="S3.E16.m1.3.3.1.1.2.2.3.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2"><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1"><ci id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.1.1.1">^</ci><ci id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1.2">𝐜</ci></apply><ci id="S3.E16.m1.2.2.cmml" xref="S3.E16.m1.2.2">𝒒</ci><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.2"><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.2.2">𝐖</ci></apply><ci id="S3.E16.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.3.3.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.E16.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E16.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2.2.2"><ci id="S3.E16.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2.2.2.1">^</ci><ci id="S3.E16.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2.2.2.2">𝐖</ci></apply><ci id="S3.E16.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E16.m1.3.3.1.1.2.2.2.2.3">𝑞</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.3c">\hat{\boldsymbol{\mathrm{s}}}=g(\hat{\boldsymbol{\mathrm{c}}},\boldsymbol{q};\hat{\boldsymbol{\mathrm{W}}}_{c},\hat{\boldsymbol{\mathrm{W}}}_{q}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E17.m1.3" class="ltx_Math" alttext="\tilde{\boldsymbol{\mathrm{s}}}=g(\tilde{\boldsymbol{\mathrm{c}}},\boldsymbol{q};\tilde{\boldsymbol{\mathrm{W}}}_{c},\tilde{\boldsymbol{\mathrm{W}}}_{q})," display="block"><semantics id="S3.E17.m1.3a"><mrow id="S3.E17.m1.3.3.1" xref="S3.E17.m1.3.3.1.1.cmml"><mrow id="S3.E17.m1.3.3.1.1" xref="S3.E17.m1.3.3.1.1.cmml"><mover accent="true" id="S3.E17.m1.3.3.1.1.4" xref="S3.E17.m1.3.3.1.1.4.cmml"><mi id="S3.E17.m1.3.3.1.1.4.2" xref="S3.E17.m1.3.3.1.1.4.2.cmml">𝐬</mi><mo id="S3.E17.m1.3.3.1.1.4.1" xref="S3.E17.m1.3.3.1.1.4.1.cmml">~</mo></mover><mo id="S3.E17.m1.3.3.1.1.3" xref="S3.E17.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E17.m1.3.3.1.1.2" xref="S3.E17.m1.3.3.1.1.2.cmml"><mi id="S3.E17.m1.3.3.1.1.2.4" xref="S3.E17.m1.3.3.1.1.2.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.3.3.1.1.2.3" xref="S3.E17.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E17.m1.3.3.1.1.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E17.m1.3.3.1.1.2.2.2.3" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml">(</mo><mover accent="true" id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml"><mi id="S3.E17.m1.1.1.2" xref="S3.E17.m1.1.1.2.cmml">𝐜</mi><mo id="S3.E17.m1.1.1.1" xref="S3.E17.m1.1.1.1.cmml">~</mo></mover><mo id="S3.E17.m1.3.3.1.1.2.2.2.4" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml">,</mo><mi id="S3.E17.m1.2.2" xref="S3.E17.m1.2.2.cmml">𝒒</mi><mo id="S3.E17.m1.3.3.1.1.2.2.2.5" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml">;</mo><msub id="S3.E17.m1.3.3.1.1.1.1.1.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E17.m1.3.3.1.1.1.1.1.1.2" xref="S3.E17.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.E17.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E17.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝐖</mi><mo id="S3.E17.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E17.m1.3.3.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E17.m1.3.3.1.1.1.1.1.1.3" xref="S3.E17.m1.3.3.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.E17.m1.3.3.1.1.2.2.2.6" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S3.E17.m1.3.3.1.1.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E17.m1.3.3.1.1.2.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝐖</mi><mo id="S3.E17.m1.3.3.1.1.2.2.2.2.2.1" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E17.m1.3.3.1.1.2.2.2.2.3" xref="S3.E17.m1.3.3.1.1.2.2.2.2.3.cmml">q</mi></msub><mo stretchy="false" id="S3.E17.m1.3.3.1.1.2.2.2.7" xref="S3.E17.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E17.m1.3.3.1.2" xref="S3.E17.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.3b"><apply id="S3.E17.m1.3.3.1.1.cmml" xref="S3.E17.m1.3.3.1"><eq id="S3.E17.m1.3.3.1.1.3.cmml" xref="S3.E17.m1.3.3.1.1.3"></eq><apply id="S3.E17.m1.3.3.1.1.4.cmml" xref="S3.E17.m1.3.3.1.1.4"><ci id="S3.E17.m1.3.3.1.1.4.1.cmml" xref="S3.E17.m1.3.3.1.1.4.1">~</ci><ci id="S3.E17.m1.3.3.1.1.4.2.cmml" xref="S3.E17.m1.3.3.1.1.4.2">𝐬</ci></apply><apply id="S3.E17.m1.3.3.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.2"><times id="S3.E17.m1.3.3.1.1.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.3"></times><ci id="S3.E17.m1.3.3.1.1.2.4.cmml" xref="S3.E17.m1.3.3.1.1.2.4">𝑔</ci><vector id="S3.E17.m1.3.3.1.1.2.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2"><apply id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1"><ci id="S3.E17.m1.1.1.1.cmml" xref="S3.E17.m1.1.1.1">~</ci><ci id="S3.E17.m1.1.1.2.cmml" xref="S3.E17.m1.1.1.2">𝐜</ci></apply><ci id="S3.E17.m1.2.2.cmml" xref="S3.E17.m1.2.2">𝒒</ci><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E17.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.2"><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.2.1">~</ci><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.2.2">𝐖</ci></apply><ci id="S3.E17.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.3.3.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.E17.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E17.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2"><ci id="S3.E17.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.1">~</ci><ci id="S3.E17.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.2.2">𝐖</ci></apply><ci id="S3.E17.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E17.m1.3.3.1.1.2.2.2.2.3">𝑞</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.3c">\tilde{\boldsymbol{\mathrm{s}}}=g(\tilde{\boldsymbol{\mathrm{c}}},\boldsymbol{q};\tilde{\boldsymbol{\mathrm{W}}}_{c},\tilde{\boldsymbol{\mathrm{W}}}_{q}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.12" class="ltx_p">where <math id="S3.SS4.p1.11.m1.2" class="ltx_Math" alttext="\hat{\boldsymbol{\mathrm{W}}}_{c},\tilde{\boldsymbol{\mathrm{W}}}_{c}\in\mathbb{R}^{n_{c}\times n_{I}}" display="inline"><semantics id="S3.SS4.p1.11.m1.2a"><mrow id="S3.SS4.p1.11.m1.2.2" xref="S3.SS4.p1.11.m1.2.2.cmml"><mrow id="S3.SS4.p1.11.m1.2.2.2.2" xref="S3.SS4.p1.11.m1.2.2.2.3.cmml"><msub id="S3.SS4.p1.11.m1.1.1.1.1.1" xref="S3.SS4.p1.11.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.11.m1.1.1.1.1.1.2" xref="S3.SS4.p1.11.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p1.11.m1.1.1.1.1.1.2.2" xref="S3.SS4.p1.11.m1.1.1.1.1.1.2.2.cmml">𝐖</mi><mo id="S3.SS4.p1.11.m1.1.1.1.1.1.2.1" xref="S3.SS4.p1.11.m1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.11.m1.1.1.1.1.1.3" xref="S3.SS4.p1.11.m1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S3.SS4.p1.11.m1.2.2.2.2.3" xref="S3.SS4.p1.11.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.11.m1.2.2.2.2.2" xref="S3.SS4.p1.11.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS4.p1.11.m1.2.2.2.2.2.2" xref="S3.SS4.p1.11.m1.2.2.2.2.2.2.cmml"><mi id="S3.SS4.p1.11.m1.2.2.2.2.2.2.2" xref="S3.SS4.p1.11.m1.2.2.2.2.2.2.2.cmml">𝐖</mi><mo id="S3.SS4.p1.11.m1.2.2.2.2.2.2.1" xref="S3.SS4.p1.11.m1.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS4.p1.11.m1.2.2.2.2.2.3" xref="S3.SS4.p1.11.m1.2.2.2.2.2.3.cmml">c</mi></msub></mrow><mo id="S3.SS4.p1.11.m1.2.2.3" xref="S3.SS4.p1.11.m1.2.2.3.cmml">∈</mo><msup id="S3.SS4.p1.11.m1.2.2.4" xref="S3.SS4.p1.11.m1.2.2.4.cmml"><mi id="S3.SS4.p1.11.m1.2.2.4.2" xref="S3.SS4.p1.11.m1.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.11.m1.2.2.4.3" xref="S3.SS4.p1.11.m1.2.2.4.3.cmml"><msub id="S3.SS4.p1.11.m1.2.2.4.3.2" xref="S3.SS4.p1.11.m1.2.2.4.3.2.cmml"><mi id="S3.SS4.p1.11.m1.2.2.4.3.2.2" xref="S3.SS4.p1.11.m1.2.2.4.3.2.2.cmml">n</mi><mi id="S3.SS4.p1.11.m1.2.2.4.3.2.3" xref="S3.SS4.p1.11.m1.2.2.4.3.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.11.m1.2.2.4.3.1" xref="S3.SS4.p1.11.m1.2.2.4.3.1.cmml">×</mo><msub id="S3.SS4.p1.11.m1.2.2.4.3.3" xref="S3.SS4.p1.11.m1.2.2.4.3.3.cmml"><mi id="S3.SS4.p1.11.m1.2.2.4.3.3.2" xref="S3.SS4.p1.11.m1.2.2.4.3.3.2.cmml">n</mi><mi id="S3.SS4.p1.11.m1.2.2.4.3.3.3" xref="S3.SS4.p1.11.m1.2.2.4.3.3.3.cmml">I</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m1.2b"><apply id="S3.SS4.p1.11.m1.2.2.cmml" xref="S3.SS4.p1.11.m1.2.2"><in id="S3.SS4.p1.11.m1.2.2.3.cmml" xref="S3.SS4.p1.11.m1.2.2.3"></in><list id="S3.SS4.p1.11.m1.2.2.2.3.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2"><apply id="S3.SS4.p1.11.m1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS4.p1.11.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.11.m1.1.1.1.1.1.2"><ci id="S3.SS4.p1.11.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.11.m1.1.1.1.1.1.2.1">^</ci><ci id="S3.SS4.p1.11.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.11.m1.1.1.1.1.1.2.2">𝐖</ci></apply><ci id="S3.SS4.p1.11.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.11.m1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S3.SS4.p1.11.m1.2.2.2.2.2.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m1.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.SS4.p1.11.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2.2.2"><ci id="S3.SS4.p1.11.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2.2.2.1">~</ci><ci id="S3.SS4.p1.11.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2.2.2.2">𝐖</ci></apply><ci id="S3.SS4.p1.11.m1.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.11.m1.2.2.2.2.2.3">𝑐</ci></apply></list><apply id="S3.SS4.p1.11.m1.2.2.4.cmml" xref="S3.SS4.p1.11.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m1.2.2.4.1.cmml" xref="S3.SS4.p1.11.m1.2.2.4">superscript</csymbol><ci id="S3.SS4.p1.11.m1.2.2.4.2.cmml" xref="S3.SS4.p1.11.m1.2.2.4.2">ℝ</ci><apply id="S3.SS4.p1.11.m1.2.2.4.3.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3"><times id="S3.SS4.p1.11.m1.2.2.4.3.1.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.1"></times><apply id="S3.SS4.p1.11.m1.2.2.4.3.2.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m1.2.2.4.3.2.1.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.2">subscript</csymbol><ci id="S3.SS4.p1.11.m1.2.2.4.3.2.2.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.2.2">𝑛</ci><ci id="S3.SS4.p1.11.m1.2.2.4.3.2.3.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.2.3">𝑐</ci></apply><apply id="S3.SS4.p1.11.m1.2.2.4.3.3.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m1.2.2.4.3.3.1.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.3">subscript</csymbol><ci id="S3.SS4.p1.11.m1.2.2.4.3.3.2.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.3.2">𝑛</ci><ci id="S3.SS4.p1.11.m1.2.2.4.3.3.3.cmml" xref="S3.SS4.p1.11.m1.2.2.4.3.3.3">𝐼</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m1.2c">\hat{\boldsymbol{\mathrm{W}}}_{c},\tilde{\boldsymbol{\mathrm{W}}}_{c}\in\mathbb{R}^{n_{c}\times n_{I}}</annotation></semantics></math>, <math id="S3.SS4.p1.12.m2.2" class="ltx_Math" alttext="\hat{\boldsymbol{\mathrm{W}}}_{q},\tilde{\boldsymbol{\mathrm{W}}}_{q}\in\mathbb{R}^{n_{c}\times n_{Q}}" display="inline"><semantics id="S3.SS4.p1.12.m2.2a"><mrow id="S3.SS4.p1.12.m2.2.2" xref="S3.SS4.p1.12.m2.2.2.cmml"><mrow id="S3.SS4.p1.12.m2.2.2.2.2" xref="S3.SS4.p1.12.m2.2.2.2.3.cmml"><msub id="S3.SS4.p1.12.m2.1.1.1.1.1" xref="S3.SS4.p1.12.m2.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS4.p1.12.m2.1.1.1.1.1.2" xref="S3.SS4.p1.12.m2.1.1.1.1.1.2.cmml"><mi id="S3.SS4.p1.12.m2.1.1.1.1.1.2.2" xref="S3.SS4.p1.12.m2.1.1.1.1.1.2.2.cmml">𝐖</mi><mo id="S3.SS4.p1.12.m2.1.1.1.1.1.2.1" xref="S3.SS4.p1.12.m2.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS4.p1.12.m2.1.1.1.1.1.3" xref="S3.SS4.p1.12.m2.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.SS4.p1.12.m2.2.2.2.2.3" xref="S3.SS4.p1.12.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p1.12.m2.2.2.2.2.2" xref="S3.SS4.p1.12.m2.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS4.p1.12.m2.2.2.2.2.2.2" xref="S3.SS4.p1.12.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS4.p1.12.m2.2.2.2.2.2.2.2" xref="S3.SS4.p1.12.m2.2.2.2.2.2.2.2.cmml">𝐖</mi><mo id="S3.SS4.p1.12.m2.2.2.2.2.2.2.1" xref="S3.SS4.p1.12.m2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.SS4.p1.12.m2.2.2.2.2.2.3" xref="S3.SS4.p1.12.m2.2.2.2.2.2.3.cmml">q</mi></msub></mrow><mo id="S3.SS4.p1.12.m2.2.2.3" xref="S3.SS4.p1.12.m2.2.2.3.cmml">∈</mo><msup id="S3.SS4.p1.12.m2.2.2.4" xref="S3.SS4.p1.12.m2.2.2.4.cmml"><mi id="S3.SS4.p1.12.m2.2.2.4.2" xref="S3.SS4.p1.12.m2.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.12.m2.2.2.4.3" xref="S3.SS4.p1.12.m2.2.2.4.3.cmml"><msub id="S3.SS4.p1.12.m2.2.2.4.3.2" xref="S3.SS4.p1.12.m2.2.2.4.3.2.cmml"><mi id="S3.SS4.p1.12.m2.2.2.4.3.2.2" xref="S3.SS4.p1.12.m2.2.2.4.3.2.2.cmml">n</mi><mi id="S3.SS4.p1.12.m2.2.2.4.3.2.3" xref="S3.SS4.p1.12.m2.2.2.4.3.2.3.cmml">c</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.12.m2.2.2.4.3.1" xref="S3.SS4.p1.12.m2.2.2.4.3.1.cmml">×</mo><msub id="S3.SS4.p1.12.m2.2.2.4.3.3" xref="S3.SS4.p1.12.m2.2.2.4.3.3.cmml"><mi id="S3.SS4.p1.12.m2.2.2.4.3.3.2" xref="S3.SS4.p1.12.m2.2.2.4.3.3.2.cmml">n</mi><mi id="S3.SS4.p1.12.m2.2.2.4.3.3.3" xref="S3.SS4.p1.12.m2.2.2.4.3.3.3.cmml">Q</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.12.m2.2b"><apply id="S3.SS4.p1.12.m2.2.2.cmml" xref="S3.SS4.p1.12.m2.2.2"><in id="S3.SS4.p1.12.m2.2.2.3.cmml" xref="S3.SS4.p1.12.m2.2.2.3"></in><list id="S3.SS4.p1.12.m2.2.2.2.3.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2"><apply id="S3.SS4.p1.12.m2.1.1.1.1.1.cmml" xref="S3.SS4.p1.12.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.12.m2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS4.p1.12.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.12.m2.1.1.1.1.1.2"><ci id="S3.SS4.p1.12.m2.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.12.m2.1.1.1.1.1.2.1">^</ci><ci id="S3.SS4.p1.12.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.12.m2.1.1.1.1.1.2.2">𝐖</ci></apply><ci id="S3.SS4.p1.12.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.12.m2.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS4.p1.12.m2.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS4.p1.12.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2.2.2"><ci id="S3.SS4.p1.12.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2.2.2.1">~</ci><ci id="S3.SS4.p1.12.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2.2.2.2">𝐖</ci></apply><ci id="S3.SS4.p1.12.m2.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.12.m2.2.2.2.2.2.3">𝑞</ci></apply></list><apply id="S3.SS4.p1.12.m2.2.2.4.cmml" xref="S3.SS4.p1.12.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.2.2.4.1.cmml" xref="S3.SS4.p1.12.m2.2.2.4">superscript</csymbol><ci id="S3.SS4.p1.12.m2.2.2.4.2.cmml" xref="S3.SS4.p1.12.m2.2.2.4.2">ℝ</ci><apply id="S3.SS4.p1.12.m2.2.2.4.3.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3"><times id="S3.SS4.p1.12.m2.2.2.4.3.1.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.1"></times><apply id="S3.SS4.p1.12.m2.2.2.4.3.2.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.2.2.4.3.2.1.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.2">subscript</csymbol><ci id="S3.SS4.p1.12.m2.2.2.4.3.2.2.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.2.2">𝑛</ci><ci id="S3.SS4.p1.12.m2.2.2.4.3.2.3.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.2.3">𝑐</ci></apply><apply id="S3.SS4.p1.12.m2.2.2.4.3.3.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.12.m2.2.2.4.3.3.1.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.3">subscript</csymbol><ci id="S3.SS4.p1.12.m2.2.2.4.3.3.2.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.3.2">𝑛</ci><ci id="S3.SS4.p1.12.m2.2.2.4.3.3.3.cmml" xref="S3.SS4.p1.12.m2.2.2.4.3.3.3">𝑄</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.12.m2.2c">\hat{\boldsymbol{\mathrm{W}}}_{q},\tilde{\boldsymbol{\mathrm{W}}}_{q}\in\mathbb{R}^{n_{c}\times n_{Q}}</annotation></semantics></math>. The answer is predicted with</p>
<table id="S3.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E18.m1.1" class="ltx_Math" alttext="a=\arg\max_{k\in\Omega_{K}}\mathrm{softmax}(\boldsymbol{\mathrm{w}}_{k}[\hat{\boldsymbol{\mathrm{s}}}^{T},\tilde{\boldsymbol{\mathrm{s}}}^{T}]^{T})," display="block"><semantics id="S3.E18.m1.1a"><mrow id="S3.E18.m1.1.1.1" xref="S3.E18.m1.1.1.1.1.cmml"><mrow id="S3.E18.m1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.cmml"><mi id="S3.E18.m1.1.1.1.1.3" xref="S3.E18.m1.1.1.1.1.3.cmml">a</mi><mo id="S3.E18.m1.1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E18.m1.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.cmml"><mrow id="S3.E18.m1.1.1.1.1.1.3" xref="S3.E18.m1.1.1.1.1.1.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.3.1" xref="S3.E18.m1.1.1.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E18.m1.1.1.1.1.1.3a" xref="S3.E18.m1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S3.E18.m1.1.1.1.1.1.3.2" xref="S3.E18.m1.1.1.1.1.1.3.2.cmml"><munder id="S3.E18.m1.1.1.1.1.1.3.2.1" xref="S3.E18.m1.1.1.1.1.1.3.2.1.cmml"><mi id="S3.E18.m1.1.1.1.1.1.3.2.1.2" xref="S3.E18.m1.1.1.1.1.1.3.2.1.2.cmml">max</mi><mrow id="S3.E18.m1.1.1.1.1.1.3.2.1.3" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.cmml"><mi id="S3.E18.m1.1.1.1.1.1.3.2.1.3.2" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.2.cmml">k</mi><mo id="S3.E18.m1.1.1.1.1.1.3.2.1.3.1" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.1.cmml">∈</mo><msub id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.cmml"><mi mathvariant="normal" id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.2" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.2.cmml">Ω</mi><mi id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.3" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.3.cmml">K</mi></msub></mrow></munder><mo lspace="0.167em" id="S3.E18.m1.1.1.1.1.1.3.2a" xref="S3.E18.m1.1.1.1.1.1.3.2.cmml">⁡</mo><mi id="S3.E18.m1.1.1.1.1.1.3.2.2" xref="S3.E18.m1.1.1.1.1.1.3.2.2.cmml">softmax</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E18.m1.1.1.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E18.m1.1.1.1.1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E18.m1.1.1.1.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E18.m1.1.1.1.1.1.1.1.1.4" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝐰</mi><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E18.m1.1.1.1.1.1.1.1.1.3" xref="S3.E18.m1.1.1.1.1.1.1.1.1.3.cmml">​</mo><msup id="S3.E18.m1.1.1.1.1.1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">[</mo><msup id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐬</mi><mo id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">𝐬</mi><mo id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.1" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">T</mi></msup><mo stretchy="false" id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.5" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">]</mo></mrow><mi id="S3.E18.m1.1.1.1.1.1.1.1.1.2.4" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.4.cmml">T</mi></msup></mrow><mo stretchy="false" id="S3.E18.m1.1.1.1.1.1.1.1.3" xref="S3.E18.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E18.m1.1.1.1.2" xref="S3.E18.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m1.1b"><apply id="S3.E18.m1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1"><eq id="S3.E18.m1.1.1.1.1.2.cmml" xref="S3.E18.m1.1.1.1.1.2"></eq><ci id="S3.E18.m1.1.1.1.1.3.cmml" xref="S3.E18.m1.1.1.1.1.3">𝑎</ci><apply id="S3.E18.m1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1"><times id="S3.E18.m1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.1.1.1.1.1.2"></times><apply id="S3.E18.m1.1.1.1.1.1.3.cmml" xref="S3.E18.m1.1.1.1.1.1.3"><arg id="S3.E18.m1.1.1.1.1.1.3.1.cmml" xref="S3.E18.m1.1.1.1.1.1.3.1"></arg><apply id="S3.E18.m1.1.1.1.1.1.3.2.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2"><apply id="S3.E18.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.3.2.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1">subscript</csymbol><max id="S3.E18.m1.1.1.1.1.1.3.2.1.2.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.2"></max><apply id="S3.E18.m1.1.1.1.1.1.3.2.1.3.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3"><in id="S3.E18.m1.1.1.1.1.1.3.2.1.3.1.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.1"></in><ci id="S3.E18.m1.1.1.1.1.1.3.2.1.3.2.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.2">𝑘</ci><apply id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.1.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3">subscript</csymbol><ci id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.2.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.2">Ω</ci><ci id="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.3.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.1.3.3.3">𝐾</ci></apply></apply></apply><ci id="S3.E18.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.3.2.2">softmax</ci></apply></apply><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1"><times id="S3.E18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4.2">𝐰</ci><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><interval closure="closed" id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2"><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐬</ci></apply><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2"><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.1">~</ci><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.2">𝐬</ci></apply><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑇</ci></apply></interval><ci id="S3.E18.m1.1.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E18.m1.1.1.1.1.1.1.1.1.2.4">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.1c">a=\arg\max_{k\in\Omega_{K}}\mathrm{softmax}(\boldsymbol{\mathrm{w}}_{k}[\hat{\boldsymbol{\mathrm{s}}}^{T},\tilde{\boldsymbol{\mathrm{s}}}^{T}]^{T}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.18" class="ltx_p">where <math id="S3.SS4.p1.13.m1.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{w}}_{k}" display="inline"><semantics id="S3.SS4.p1.13.m1.1a"><msub id="S3.SS4.p1.13.m1.1.1" xref="S3.SS4.p1.13.m1.1.1.cmml"><mi id="S3.SS4.p1.13.m1.1.1.2" xref="S3.SS4.p1.13.m1.1.1.2.cmml">𝐰</mi><mi id="S3.SS4.p1.13.m1.1.1.3" xref="S3.SS4.p1.13.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.13.m1.1b"><apply id="S3.SS4.p1.13.m1.1.1.cmml" xref="S3.SS4.p1.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.13.m1.1.1.1.cmml" xref="S3.SS4.p1.13.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.13.m1.1.1.2.cmml" xref="S3.SS4.p1.13.m1.1.1.2">𝐰</ci><ci id="S3.SS4.p1.13.m1.1.1.3.cmml" xref="S3.SS4.p1.13.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.13.m1.1c">\boldsymbol{\mathrm{w}}_{k}</annotation></semantics></math> is the <math id="S3.SS4.p1.14.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.14.m2.1a"><mi id="S3.SS4.p1.14.m2.1.1" xref="S3.SS4.p1.14.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.14.m2.1b"><ci id="S3.SS4.p1.14.m2.1.1.cmml" xref="S3.SS4.p1.14.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.14.m2.1c">k</annotation></semantics></math>-th row of <math id="S3.SS4.p1.15.m3.1" class="ltx_Math" alttext="\boldsymbol{\mathrm{W}}\in\mathbb{R}^{K\times 2n_{c}}" display="inline"><semantics id="S3.SS4.p1.15.m3.1a"><mrow id="S3.SS4.p1.15.m3.1.1" xref="S3.SS4.p1.15.m3.1.1.cmml"><mi id="S3.SS4.p1.15.m3.1.1.2" xref="S3.SS4.p1.15.m3.1.1.2.cmml">𝐖</mi><mo id="S3.SS4.p1.15.m3.1.1.1" xref="S3.SS4.p1.15.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.15.m3.1.1.3" xref="S3.SS4.p1.15.m3.1.1.3.cmml"><mi id="S3.SS4.p1.15.m3.1.1.3.2" xref="S3.SS4.p1.15.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.15.m3.1.1.3.3" xref="S3.SS4.p1.15.m3.1.1.3.3.cmml"><mrow id="S3.SS4.p1.15.m3.1.1.3.3.2" xref="S3.SS4.p1.15.m3.1.1.3.3.2.cmml"><mi id="S3.SS4.p1.15.m3.1.1.3.3.2.2" xref="S3.SS4.p1.15.m3.1.1.3.3.2.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.15.m3.1.1.3.3.2.1" xref="S3.SS4.p1.15.m3.1.1.3.3.2.1.cmml">×</mo><mn id="S3.SS4.p1.15.m3.1.1.3.3.2.3" xref="S3.SS4.p1.15.m3.1.1.3.3.2.3.cmml">2</mn></mrow><mo lspace="0em" rspace="0em" id="S3.SS4.p1.15.m3.1.1.3.3.1" xref="S3.SS4.p1.15.m3.1.1.3.3.1.cmml">​</mo><msub id="S3.SS4.p1.15.m3.1.1.3.3.3" xref="S3.SS4.p1.15.m3.1.1.3.3.3.cmml"><mi id="S3.SS4.p1.15.m3.1.1.3.3.3.2" xref="S3.SS4.p1.15.m3.1.1.3.3.3.2.cmml">n</mi><mi id="S3.SS4.p1.15.m3.1.1.3.3.3.3" xref="S3.SS4.p1.15.m3.1.1.3.3.3.3.cmml">c</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.15.m3.1b"><apply id="S3.SS4.p1.15.m3.1.1.cmml" xref="S3.SS4.p1.15.m3.1.1"><in id="S3.SS4.p1.15.m3.1.1.1.cmml" xref="S3.SS4.p1.15.m3.1.1.1"></in><ci id="S3.SS4.p1.15.m3.1.1.2.cmml" xref="S3.SS4.p1.15.m3.1.1.2">𝐖</ci><apply id="S3.SS4.p1.15.m3.1.1.3.cmml" xref="S3.SS4.p1.15.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m3.1.1.3.1.cmml" xref="S3.SS4.p1.15.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.15.m3.1.1.3.2.cmml" xref="S3.SS4.p1.15.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.15.m3.1.1.3.3.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3"><times id="S3.SS4.p1.15.m3.1.1.3.3.1.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.1"></times><apply id="S3.SS4.p1.15.m3.1.1.3.3.2.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.2"><times id="S3.SS4.p1.15.m3.1.1.3.3.2.1.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.2.1"></times><ci id="S3.SS4.p1.15.m3.1.1.3.3.2.2.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.2.2">𝐾</ci><cn type="integer" id="S3.SS4.p1.15.m3.1.1.3.3.2.3.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.2.3">2</cn></apply><apply id="S3.SS4.p1.15.m3.1.1.3.3.3.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.15.m3.1.1.3.3.3.1.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS4.p1.15.m3.1.1.3.3.3.2.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.3.2">𝑛</ci><ci id="S3.SS4.p1.15.m3.1.1.3.3.3.3.cmml" xref="S3.SS4.p1.15.m3.1.1.3.3.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.15.m3.1c">\boldsymbol{\mathrm{W}}\in\mathbb{R}^{K\times 2n_{c}}</annotation></semantics></math>, <math id="S3.SS4.p1.16.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS4.p1.16.m4.1a"><mi id="S3.SS4.p1.16.m4.1.1" xref="S3.SS4.p1.16.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.16.m4.1b"><ci id="S3.SS4.p1.16.m4.1.1.cmml" xref="S3.SS4.p1.16.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.16.m4.1c">K</annotation></semantics></math> is the number of answers, <math id="S3.SS4.p1.17.m5.1" class="ltx_Math" alttext="\Omega_{K}" display="inline"><semantics id="S3.SS4.p1.17.m5.1a"><msub id="S3.SS4.p1.17.m5.1.1" xref="S3.SS4.p1.17.m5.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.17.m5.1.1.2" xref="S3.SS4.p1.17.m5.1.1.2.cmml">Ω</mi><mi id="S3.SS4.p1.17.m5.1.1.3" xref="S3.SS4.p1.17.m5.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.17.m5.1b"><apply id="S3.SS4.p1.17.m5.1.1.cmml" xref="S3.SS4.p1.17.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.17.m5.1.1.1.cmml" xref="S3.SS4.p1.17.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.17.m5.1.1.2.cmml" xref="S3.SS4.p1.17.m5.1.1.2">Ω</ci><ci id="S3.SS4.p1.17.m5.1.1.3.cmml" xref="S3.SS4.p1.17.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.17.m5.1c">\Omega_{K}</annotation></semantics></math> is the answer space with up to <math id="S3.SS4.p1.18.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS4.p1.18.m6.1a"><mi id="S3.SS4.p1.18.m6.1.1" xref="S3.SS4.p1.18.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.18.m6.1b"><ci id="S3.SS4.p1.18.m6.1.1.cmml" xref="S3.SS4.p1.18.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.18.m6.1c">K</annotation></semantics></math> answers.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">The SHAPES dataset</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> is a synthetic dataset consisting of images containing 3 basic shapes in 3 different colors with a resolution of 30<math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mo id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><times id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\times</annotation></semantics></math>30, and queries about the arrangements of the basic shapes, as shown in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4.1 On SHAPES ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The answer is “yes” when the image satisfies the query, and “no” otherwise. There are 3 different lengths of queries. The original dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> has 14592 and 1024 image/question pairs for the training and test sets. All the queries in the test set do not appear in the training set.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">The CLEVR dataset</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> is a much more complex but unbiased synthetic dataset aiming at testing visual abilities such as counting, comparing and logical reasoning. It consists of 100,000 images of simple 3D objects with random shapes, sizes, materials, colors and positions with a resolution of 320<math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mo id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><times id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\times</annotation></semantics></math>480, and nearly a million natural language questions, 853,554 of which are unique. The questions can be categorized into 5 general types: <em id="S4.SS1.p2.1.2" class="ltx_emph ltx_font_italic">exist</em>, <em id="S4.SS1.p2.1.3" class="ltx_emph ltx_font_italic">count</em>, <em id="S4.SS1.p2.1.4" class="ltx_emph ltx_font_italic">compare integer</em>, <em id="S4.SS1.p2.1.5" class="ltx_emph ltx_font_italic">query attribute</em>, and <em id="S4.SS1.p2.1.6" class="ltx_emph ltx_font_italic">compare attribute</em>. There are 699,989 training questions, 149,991 validation questions and 149,988 test questions. The vocabulary sizes for the questions and answers are 82 and 28 respectively.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">The VQA real-image dataset</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> is a comprehensive dataset which requires knowledge beyond the dataset to answer all the questions correctly. It has about 204,721 images from MSCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> each with 3 natural language questions, and each question has 10 answers collected from online workers. It consists of 3 splits: <span id="S4.SS1.p3.1.2" class="ltx_text ltx_font_typewriter">train</span>, <span id="S4.SS1.p3.1.3" class="ltx_text ltx_font_typewriter">val</span> and <span id="S4.SS1.p3.1.4" class="ltx_text ltx_font_typewriter">test</span>, each of which has 248,349, 121,512 and 244,302 questions respectively. <span id="S4.SS1.p3.1.5" class="ltx_text ltx_font_typewriter">test-dev</span> is a subset of <span id="S4.SS1.p3.1.6" class="ltx_text ltx_font_typewriter">test</span>, which has 60,864 questions. We keep a collection of 2,000 most frequent answers from the union of <span id="S4.SS1.p3.1.7" class="ltx_text ltx_font_typewriter">train</span> and <span id="S4.SS1.p3.1.8" class="ltx_text ltx_font_typewriter">val</span>, and ignore questions with no answers from this collection, which leaves us 334,554 samples for training. With the same preprocessing procedure as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, we also get 837,298 training samples from Visual Genome <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> for augmentation.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Model Configuration and Training</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p">For extracting image features, we use a 2-layer LeNet trained with the whole network on SHAPES as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, and ImageNet-pretrained ResNets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> on CLEVR and the VQA dataset. For sentence embedding, we use single-layer GRU. On the SHAPES dataset, we set <math id="S4.SS2.p1.1.m1.2" class="ltx_Math" alttext="n_{c}=128,n_{Q}=128,n_{I}=50,M=9" display="inline"><semantics id="S4.SS2.p1.1.m1.2a"><mrow id="S4.SS2.p1.1.m1.2.2.2" xref="S4.SS2.p1.1.m1.2.2.3.cmml"><mrow id="S4.SS2.p1.1.m1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.cmml"><msub id="S4.SS2.p1.1.m1.1.1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.1.m1.1.1.1.1.2.3" xref="S4.SS2.p1.1.m1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p1.1.m1.1.1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.1.1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.1.1.3.cmml">128</mn></mrow><mo id="S4.SS2.p1.1.m1.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.3.cmml"><mrow id="S4.SS2.p1.1.m1.2.2.2.2.1.1" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.cmml"><msub id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.3.cmml">Q</mi></msub><mo id="S4.SS2.p1.1.m1.2.2.2.2.1.1.1" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.2.2.2.2.1.1.3" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml">128</mn></mrow><mo id="S4.SS2.p1.1.m1.2.2.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.3.cmml"><mrow id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.cmml"><msub id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.3.cmml">I</mi></msub><mo id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.cmml">50</mn></mrow><mo id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml">M</mi><mo id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1.cmml">=</mo><mn id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml">9</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.2b"><apply id="S4.SS2.p1.1.m1.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.3a.cmml" xref="S4.SS2.p1.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1"><eq id="S4.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.1.m1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.1.1.3">128</cn></apply><apply id="S4.SS2.p1.1.m1.2.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.2.3a.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1"><eq id="S4.SS2.p1.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.2.3">𝑄</ci></apply><cn type="integer" id="S4.SS2.p1.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.1.1.3">128</cn></apply><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.2.2.2.3a.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1"><eq id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.1"></eq><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.2.3">𝐼</ci></apply><cn type="integer" id="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.1.1.3">50</cn></apply><apply id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2"><eq id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.1"></eq><ci id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.1.m1.2.2.2.2.2.2.2.2.3">9</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.2c">n_{c}=128,n_{Q}=128,n_{I}=50,M=9</annotation></semantics></math>. On CLEVR, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, we resize the input images to <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><times id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">224</cn><cn type="integer" id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">224\times 224</annotation></semantics></math>, and use feature maps at the <span id="S4.SS2.p1.9.1" class="ltx_text ltx_font_typewriter">res4b22</span> layer of ResNet-101 (<math id="S4.SS2.p1.3.m3.2" class="ltx_Math" alttext="n_{I}=1024,M=196" display="inline"><semantics id="S4.SS2.p1.3.m3.2a"><mrow id="S4.SS2.p1.3.m3.2.2.2" xref="S4.SS2.p1.3.m3.2.2.3.cmml"><mrow id="S4.SS2.p1.3.m3.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.cmml"><msub id="S4.SS2.p1.3.m3.1.1.1.1.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.3.m3.1.1.1.1.2.3" xref="S4.SS2.p1.3.m3.1.1.1.1.2.3.cmml">I</mi></msub><mo id="S4.SS2.p1.3.m3.1.1.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.3.m3.1.1.1.1.3" xref="S4.SS2.p1.3.m3.1.1.1.1.3.cmml">1024</mn></mrow><mo id="S4.SS2.p1.3.m3.2.2.2.3" xref="S4.SS2.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.3.m3.2.2.2.2" xref="S4.SS2.p1.3.m3.2.2.2.2.cmml"><mi id="S4.SS2.p1.3.m3.2.2.2.2.2" xref="S4.SS2.p1.3.m3.2.2.2.2.2.cmml">M</mi><mo id="S4.SS2.p1.3.m3.2.2.2.2.1" xref="S4.SS2.p1.3.m3.2.2.2.2.1.cmml">=</mo><mn id="S4.SS2.p1.3.m3.2.2.2.2.3" xref="S4.SS2.p1.3.m3.2.2.2.2.3.cmml">196</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.2b"><apply id="S4.SS2.p1.3.m3.2.2.3.cmml" xref="S4.SS2.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.2.2.3a.cmml" xref="S4.SS2.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.3.m3.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1"><eq id="S4.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.1"></eq><apply id="S4.SS2.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.3.m3.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.2.3">𝐼</ci></apply><cn type="integer" id="S4.SS2.p1.3.m3.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.1.1.3">1024</cn></apply><apply id="S4.SS2.p1.3.m3.2.2.2.2.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2"><eq id="S4.SS2.p1.3.m3.2.2.2.2.1.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2.1"></eq><ci id="S4.SS2.p1.3.m3.2.2.2.2.2.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.SS2.p1.3.m3.2.2.2.2.3.cmml" xref="S4.SS2.p1.3.m3.2.2.2.2.3">196</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.2c">n_{I}=1024,M=196</annotation></semantics></math>) and the <span id="S4.SS2.p1.9.2" class="ltx_text ltx_font_typewriter">res5c</span> layer of ResNet-152 (<math id="S4.SS2.p1.4.m4.2" class="ltx_Math" alttext="n_{I}=2048,M=49" display="inline"><semantics id="S4.SS2.p1.4.m4.2a"><mrow id="S4.SS2.p1.4.m4.2.2.2" xref="S4.SS2.p1.4.m4.2.2.3.cmml"><mrow id="S4.SS2.p1.4.m4.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.cmml"><msub id="S4.SS2.p1.4.m4.1.1.1.1.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.1.1.1.2.2" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.4.m4.1.1.1.1.2.3" xref="S4.SS2.p1.4.m4.1.1.1.1.2.3.cmml">I</mi></msub><mo id="S4.SS2.p1.4.m4.1.1.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.1.1.3" xref="S4.SS2.p1.4.m4.1.1.1.1.3.cmml">2048</mn></mrow><mo id="S4.SS2.p1.4.m4.2.2.2.3" xref="S4.SS2.p1.4.m4.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.4.m4.2.2.2.2" xref="S4.SS2.p1.4.m4.2.2.2.2.cmml"><mi id="S4.SS2.p1.4.m4.2.2.2.2.2" xref="S4.SS2.p1.4.m4.2.2.2.2.2.cmml">M</mi><mo id="S4.SS2.p1.4.m4.2.2.2.2.1" xref="S4.SS2.p1.4.m4.2.2.2.2.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.2.2.2.2.3" xref="S4.SS2.p1.4.m4.2.2.2.2.3.cmml">49</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.2b"><apply id="S4.SS2.p1.4.m4.2.2.3.cmml" xref="S4.SS2.p1.4.m4.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.2.2.3a.cmml" xref="S4.SS2.p1.4.m4.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.4.m4.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.1"></eq><apply id="S4.SS2.p1.4.m4.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.4.m4.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.2.3">𝐼</ci></apply><cn type="integer" id="S4.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.1.1.3">2048</cn></apply><apply id="S4.SS2.p1.4.m4.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2.2"><eq id="S4.SS2.p1.4.m4.2.2.2.2.1.cmml" xref="S4.SS2.p1.4.m4.2.2.2.2.1"></eq><ci id="S4.SS2.p1.4.m4.2.2.2.2.2.cmml" xref="S4.SS2.p1.4.m4.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.SS2.p1.4.m4.2.2.2.2.3.cmml" xref="S4.SS2.p1.4.m4.2.2.2.2.3">49</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.2c">n_{I}=2048,M=49</annotation></semantics></math>) in different experiments. We also set <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="n_{Q}=2048" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><msub id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml"><mi id="S4.SS2.p1.5.m5.1.1.2.2" xref="S4.SS2.p1.5.m5.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.5.m5.1.1.2.3" xref="S4.SS2.p1.5.m5.1.1.2.3.cmml">Q</mi></msub><mo id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml">2048</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><eq id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"></eq><apply id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.5.m5.1.1.2.3.cmml" xref="S4.SS2.p1.5.m5.1.1.2.3">𝑄</ci></apply><cn type="integer" id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3">2048</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">n_{Q}=2048</annotation></semantics></math>, comparable to the 2-layer LSTM with 1024 units per layer used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. On the VQA dataset, we fix <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="n_{c}=1200" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mrow id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><msub id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2.2" xref="S4.SS2.p1.6.m6.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.6.m6.1.1.2.3" xref="S4.SS2.p1.6.m6.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS2.p1.6.m6.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">1200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><eq id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1"></eq><apply id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.2.1.cmml" xref="S4.SS2.p1.6.m6.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.6.m6.1.1.2.3.cmml" xref="S4.SS2.p1.6.m6.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">1200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">n_{c}=1200</annotation></semantics></math>. Images are resized to <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="448\times 448" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml"><mn id="S4.SS2.p1.7.m7.1.1.2" xref="S4.SS2.p1.7.m7.1.1.2.cmml">448</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.7.m7.1.1.3" xref="S4.SS2.p1.7.m7.1.1.3.cmml">448</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1"><times id="S4.SS2.p1.7.m7.1.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1.1"></times><cn type="integer" id="S4.SS2.p1.7.m7.1.1.2.cmml" xref="S4.SS2.p1.7.m7.1.1.2">448</cn><cn type="integer" id="S4.SS2.p1.7.m7.1.1.3.cmml" xref="S4.SS2.p1.7.m7.1.1.3">448</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">448\times 448</annotation></semantics></math> and we use the feature at the <span id="S4.SS2.p1.9.3" class="ltx_text ltx_font_typewriter">res5c</span> layer of ResNet-152 (<math id="S4.SS2.p1.8.m8.2" class="ltx_Math" alttext="n_{I}=2048,M=196" display="inline"><semantics id="S4.SS2.p1.8.m8.2a"><mrow id="S4.SS2.p1.8.m8.2.2.2" xref="S4.SS2.p1.8.m8.2.2.3.cmml"><mrow id="S4.SS2.p1.8.m8.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.cmml"><msub id="S4.SS2.p1.8.m8.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.2.cmml"><mi id="S4.SS2.p1.8.m8.1.1.1.1.2.2" xref="S4.SS2.p1.8.m8.1.1.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.8.m8.1.1.1.1.2.3" xref="S4.SS2.p1.8.m8.1.1.1.1.2.3.cmml">I</mi></msub><mo id="S4.SS2.p1.8.m8.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.8.m8.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.3.cmml">2048</mn></mrow><mo id="S4.SS2.p1.8.m8.2.2.2.3" xref="S4.SS2.p1.8.m8.2.2.3a.cmml">,</mo><mrow id="S4.SS2.p1.8.m8.2.2.2.2" xref="S4.SS2.p1.8.m8.2.2.2.2.cmml"><mi id="S4.SS2.p1.8.m8.2.2.2.2.2" xref="S4.SS2.p1.8.m8.2.2.2.2.2.cmml">M</mi><mo id="S4.SS2.p1.8.m8.2.2.2.2.1" xref="S4.SS2.p1.8.m8.2.2.2.2.1.cmml">=</mo><mn id="S4.SS2.p1.8.m8.2.2.2.2.3" xref="S4.SS2.p1.8.m8.2.2.2.2.3.cmml">196</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.2b"><apply id="S4.SS2.p1.8.m8.2.2.3.cmml" xref="S4.SS2.p1.8.m8.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.2.2.3a.cmml" xref="S4.SS2.p1.8.m8.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p1.8.m8.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1"><eq id="S4.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1"></eq><apply id="S4.SS2.p1.8.m8.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.8.m8.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.2.3">𝐼</ci></apply><cn type="integer" id="S4.SS2.p1.8.m8.1.1.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.3">2048</cn></apply><apply id="S4.SS2.p1.8.m8.2.2.2.2.cmml" xref="S4.SS2.p1.8.m8.2.2.2.2"><eq id="S4.SS2.p1.8.m8.2.2.2.2.1.cmml" xref="S4.SS2.p1.8.m8.2.2.2.2.1"></eq><ci id="S4.SS2.p1.8.m8.2.2.2.2.2.cmml" xref="S4.SS2.p1.8.m8.2.2.2.2.2">𝑀</ci><cn type="integer" id="S4.SS2.p1.8.m8.2.2.2.2.3.cmml" xref="S4.SS2.p1.8.m8.2.2.2.2.3">196</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.2c">n_{I}=2048,M=196</annotation></semantics></math> ), the same as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. We set <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="n_{Q}=2400" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mrow id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml"><msub id="S4.SS2.p1.9.m9.1.1.2" xref="S4.SS2.p1.9.m9.1.1.2.cmml"><mi id="S4.SS2.p1.9.m9.1.1.2.2" xref="S4.SS2.p1.9.m9.1.1.2.2.cmml">n</mi><mi id="S4.SS2.p1.9.m9.1.1.2.3" xref="S4.SS2.p1.9.m9.1.1.2.3.cmml">Q</mi></msub><mo id="S4.SS2.p1.9.m9.1.1.1" xref="S4.SS2.p1.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.9.m9.1.1.3" xref="S4.SS2.p1.9.m9.1.1.3.cmml">2400</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><apply id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1"><eq id="S4.SS2.p1.9.m9.1.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1.1"></eq><apply id="S4.SS2.p1.9.m9.1.1.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.9.m9.1.1.2.1.cmml" xref="S4.SS2.p1.9.m9.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.9.m9.1.1.2.2.cmml" xref="S4.SS2.p1.9.m9.1.1.2.2">𝑛</ci><ci id="S4.SS2.p1.9.m9.1.1.2.3.cmml" xref="S4.SS2.p1.9.m9.1.1.2.3">𝑄</ci></apply><cn type="integer" id="S4.SS2.p1.9.m9.1.1.3.cmml" xref="S4.SS2.p1.9.m9.1.1.3">2400</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">n_{Q}=2400</annotation></semantics></math> since we use the pre-trained skip-thought vector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> provided by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> as initialization.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">For training, we implement our network with MXNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. In all 3 tasks, we use the Adam optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> with the default setting except for the learning rate, which is picked using grid search. We adopt Bayesian dropout <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> for GRU’s as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and apply dropout <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> before every other fully connected layer. On SHAPES and CLEVR, we find setting both dropout probability to 0.2 to be optimal, while on the VQA dataset, setting a small Bayesian dropout 0.25 for the GRU and a large dropout of 0.5 for the other parts achieved the optimal results. In addition, we use answer sampling by default on the VQA dataset as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Visualization of ERF</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.14" class="ltx_p">To visualize the ERF, we need to compute the influence of a pixel <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="I_{ij}\in\mathbb{R}^{3}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><msub id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2.2" xref="S4.SS3.p1.1.m1.1.1.2.2.cmml">I</mi><mrow id="S4.SS3.p1.1.m1.1.1.2.3" xref="S4.SS3.p1.1.m1.1.1.2.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2.3.2" xref="S4.SS3.p1.1.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.1.m1.1.1.2.3.1" xref="S4.SS3.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.1.m1.1.1.2.3.3" xref="S4.SS3.p1.1.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS3.p1.1.m1.1.1.3.3" xref="S4.SS3.p1.1.m1.1.1.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><in id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></in><apply id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2.2">𝐼</ci><apply id="S4.SS3.p1.1.m1.1.1.2.3.cmml" xref="S4.SS3.p1.1.m1.1.1.2.3"><times id="S4.SS3.p1.1.m1.1.1.2.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.2.3.1"></times><ci id="S4.SS3.p1.1.m1.1.1.2.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2.3.2">𝑖</ci><ci id="S4.SS3.p1.1.m1.1.1.2.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS3.p1.1.m1.1.1.3.2">ℝ</ci><cn type="integer" id="S4.SS3.p1.1.m1.1.1.3.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">I_{ij}\in\mathbb{R}^{3}</annotation></semantics></math> on the entry <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="y_{rc}^{n}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msubsup id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">y</mi><mrow id="S4.SS3.p1.2.m2.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.2.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.3.2" xref="S4.SS3.p1.2.m2.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.2.3.1" xref="S4.SS3.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.2.m2.1.1.2.3.3" xref="S4.SS3.p1.2.m2.1.1.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">𝑦</ci><apply id="S4.SS3.p1.2.m2.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3"><times id="S4.SS3.p1.2.m2.1.1.2.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.2.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.2">𝑟</ci><ci id="S4.SS3.p1.2.m2.1.1.2.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">y_{rc}^{n}</annotation></semantics></math>, the feature at <math id="S4.SS3.p1.3.m3.2" class="ltx_Math" alttext="(r,c)" display="inline"><semantics id="S4.SS3.p1.3.m3.2a"><mrow id="S4.SS3.p1.3.m3.2.3.2" xref="S4.SS3.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.2.3.2.1" xref="S4.SS3.p1.3.m3.2.3.1.cmml">(</mo><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">r</mi><mo id="S4.SS3.p1.3.m3.2.3.2.2" xref="S4.SS3.p1.3.m3.2.3.1.cmml">,</mo><mi id="S4.SS3.p1.3.m3.2.2" xref="S4.SS3.p1.3.m3.2.2.cmml">c</mi><mo stretchy="false" id="S4.SS3.p1.3.m3.2.3.2.3" xref="S4.SS3.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.2b"><interval closure="open" id="S4.SS3.p1.3.m3.2.3.1.cmml" xref="S4.SS3.p1.3.m3.2.3.2"><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝑟</ci><ci id="S4.SS3.p1.3.m3.2.2.cmml" xref="S4.SS3.p1.3.m3.2.2">𝑐</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.2c">(r,c)</annotation></semantics></math> of the <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">n</annotation></semantics></math>-th channel in a certain conv layer, represented by <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="\|\partial y_{rc}^{n}/\partial I_{ij}\|" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.5.m5.1.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.1.cmml">‖</mo><mrow id="S4.SS3.p1.5.m5.1.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.1.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m5.1.1.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.1.1.cmml">∂</mo><mrow id="S4.SS3.p1.5.m5.1.1.1.1.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.cmml"><msubsup id="S4.SS3.p1.5.m5.1.1.1.1.2.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.cmml"><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.2.cmml">y</mi><mrow id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.cmml"><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.1" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.3" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.2.3" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.3.cmml">n</mi></msubsup><mo id="S4.SS3.p1.5.m5.1.1.1.1.2.1" xref="S4.SS3.p1.5.m5.1.1.1.1.2.1.cmml">/</mo><mrow id="S4.SS3.p1.5.m5.1.1.1.1.2.3" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m5.1.1.1.1.2.3.1" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.1.cmml">∂</mo><msub id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.cmml"><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.2.cmml">I</mi><mrow id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.cmml"><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.2" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.1" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.3" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo stretchy="false" id="S4.SS3.p1.5.m5.1.1.1.3" xref="S4.SS3.p1.5.m5.1.1.2.1.cmml">‖</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.5.m5.1.1.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.2">norm</csymbol><apply id="S4.SS3.p1.5.m5.1.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1"><partialdiff id="S4.SS3.p1.5.m5.1.1.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.1"></partialdiff><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2"><divide id="S4.SS3.p1.5.m5.1.1.1.1.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.1"></divide><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.1.2.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2">superscript</csymbol><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.2">𝑦</ci><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3"><times id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.1"></times><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.2.3">𝑛</ci></apply><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3"><partialdiff id="S4.SS3.p1.5.m5.1.1.1.1.2.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.1"></partialdiff><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.2">𝐼</ci><apply id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3"><times id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.1"></times><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.2">𝑖</ci><ci id="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\|\partial y_{rc}^{n}/\partial I_{ij}\|</annotation></semantics></math>. As in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, we assume a loss function <math id="S4.SS3.p1.6.m6.1" class="ltx_Math" alttext="l_{rc}^{n}" display="inline"><semantics id="S4.SS3.p1.6.m6.1a"><msubsup id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2.2" xref="S4.SS3.p1.6.m6.1.1.2.2.cmml">l</mi><mrow id="S4.SS3.p1.6.m6.1.1.2.3" xref="S4.SS3.p1.6.m6.1.1.2.3.cmml"><mi id="S4.SS3.p1.6.m6.1.1.2.3.2" xref="S4.SS3.p1.6.m6.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m6.1.1.2.3.1" xref="S4.SS3.p1.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.6.m6.1.1.2.3.3" xref="S4.SS3.p1.6.m6.1.1.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.2.1.cmml" xref="S4.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p1.6.m6.1.1.2.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2.2">𝑙</ci><apply id="S4.SS3.p1.6.m6.1.1.2.3.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3"><times id="S4.SS3.p1.6.m6.1.1.2.3.1.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3.1"></times><ci id="S4.SS3.p1.6.m6.1.1.2.3.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3.2">𝑟</ci><ci id="S4.SS3.p1.6.m6.1.1.2.3.3.cmml" xref="S4.SS3.p1.6.m6.1.1.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">l_{rc}^{n}</annotation></semantics></math> which is related only to channel <math id="S4.SS3.p1.7.m7.1" class="ltx_Math" alttext="y_{rc}^{n}" display="inline"><semantics id="S4.SS3.p1.7.m7.1a"><msubsup id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2.2" xref="S4.SS3.p1.7.m7.1.1.2.2.cmml">y</mi><mrow id="S4.SS3.p1.7.m7.1.1.2.3" xref="S4.SS3.p1.7.m7.1.1.2.3.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2.3.2" xref="S4.SS3.p1.7.m7.1.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.7.m7.1.1.2.3.1" xref="S4.SS3.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.7.m7.1.1.2.3.3" xref="S4.SS3.p1.7.m7.1.1.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">superscript</csymbol><apply id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.2.1.cmml" xref="S4.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p1.7.m7.1.1.2.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2.2">𝑦</ci><apply id="S4.SS3.p1.7.m7.1.1.2.3.cmml" xref="S4.SS3.p1.7.m7.1.1.2.3"><times id="S4.SS3.p1.7.m7.1.1.2.3.1.cmml" xref="S4.SS3.p1.7.m7.1.1.2.3.1"></times><ci id="S4.SS3.p1.7.m7.1.1.2.3.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2.3.2">𝑟</ci><ci id="S4.SS3.p1.7.m7.1.1.2.3.3.cmml" xref="S4.SS3.p1.7.m7.1.1.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">y_{rc}^{n}</annotation></semantics></math>, i.e., <math id="S4.SS3.p1.8.m8.1" class="ltx_Math" alttext="\partial l_{rc}^{n}/\partial y_{rc}^{n}=1" display="inline"><semantics id="S4.SS3.p1.8.m8.1a"><mrow id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml"><mrow id="S4.SS3.p1.8.m8.1.1.2" xref="S4.SS3.p1.8.m8.1.1.2.cmml"><mo rspace="0em" id="S4.SS3.p1.8.m8.1.1.2.1" xref="S4.SS3.p1.8.m8.1.1.2.1.cmml">∂</mo><mrow id="S4.SS3.p1.8.m8.1.1.2.2" xref="S4.SS3.p1.8.m8.1.1.2.2.cmml"><msubsup id="S4.SS3.p1.8.m8.1.1.2.2.2" xref="S4.SS3.p1.8.m8.1.1.2.2.2.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2.2.2.2.2" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.2.cmml">l</mi><mrow id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.2" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.1" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.3" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.8.m8.1.1.2.2.2.3" xref="S4.SS3.p1.8.m8.1.1.2.2.2.3.cmml">n</mi></msubsup><mo id="S4.SS3.p1.8.m8.1.1.2.2.1" xref="S4.SS3.p1.8.m8.1.1.2.2.1.cmml">/</mo><mrow id="S4.SS3.p1.8.m8.1.1.2.2.3" xref="S4.SS3.p1.8.m8.1.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.8.m8.1.1.2.2.3.1" xref="S4.SS3.p1.8.m8.1.1.2.2.3.1.cmml">∂</mo><msubsup id="S4.SS3.p1.8.m8.1.1.2.2.3.2" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.2" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.2.cmml">y</mi><mrow id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.cmml"><mi id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.2" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.1" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.3" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.8.m8.1.1.2.2.3.2.3" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.3.cmml">n</mi></msubsup></mrow></mrow></mrow><mo id="S4.SS3.p1.8.m8.1.1.1" xref="S4.SS3.p1.8.m8.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.8.m8.1.1.3" xref="S4.SS3.p1.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><apply id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1"><eq id="S4.SS3.p1.8.m8.1.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1.1"></eq><apply id="S4.SS3.p1.8.m8.1.1.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2"><partialdiff id="S4.SS3.p1.8.m8.1.1.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.1"></partialdiff><apply id="S4.SS3.p1.8.m8.1.1.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2"><divide id="S4.SS3.p1.8.m8.1.1.2.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.1"></divide><apply id="S4.SS3.p1.8.m8.1.1.2.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2">superscript</csymbol><apply id="S4.SS3.p1.8.m8.1.1.2.2.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.2.2.2.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.2.2.2.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.2">𝑙</ci><apply id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3"><times id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.1"></times><ci id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.8.m8.1.1.2.2.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.2.3">𝑛</ci></apply><apply id="S4.SS3.p1.8.m8.1.1.2.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3"><partialdiff id="S4.SS3.p1.8.m8.1.1.2.2.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.1"></partialdiff><apply id="S4.SS3.p1.8.m8.1.1.2.2.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.2.2.3.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2">superscript</csymbol><apply id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.2">𝑦</ci><apply id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3"><times id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.1.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.1"></times><ci id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.2.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.8.m8.1.1.2.2.3.2.3.cmml" xref="S4.SS3.p1.8.m8.1.1.2.2.3.2.3">𝑛</ci></apply></apply></apply></apply><cn type="integer" id="S4.SS3.p1.8.m8.1.1.3.cmml" xref="S4.SS3.p1.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">\partial l_{rc}^{n}/\partial y_{rc}^{n}=1</annotation></semantics></math> and <math id="S4.SS3.p1.9.m9.1" class="ltx_Math" alttext="\partial l_{rc}^{n}/\partial y_{ij}^{n}=0" display="inline"><semantics id="S4.SS3.p1.9.m9.1a"><mrow id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml"><mrow id="S4.SS3.p1.9.m9.1.1.2" xref="S4.SS3.p1.9.m9.1.1.2.cmml"><mo rspace="0em" id="S4.SS3.p1.9.m9.1.1.2.1" xref="S4.SS3.p1.9.m9.1.1.2.1.cmml">∂</mo><mrow id="S4.SS3.p1.9.m9.1.1.2.2" xref="S4.SS3.p1.9.m9.1.1.2.2.cmml"><msubsup id="S4.SS3.p1.9.m9.1.1.2.2.2" xref="S4.SS3.p1.9.m9.1.1.2.2.2.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.2.2.2.2" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.2.cmml">l</mi><mrow id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.2" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.1" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.3" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.9.m9.1.1.2.2.2.3" xref="S4.SS3.p1.9.m9.1.1.2.2.2.3.cmml">n</mi></msubsup><mo id="S4.SS3.p1.9.m9.1.1.2.2.1" xref="S4.SS3.p1.9.m9.1.1.2.2.1.cmml">/</mo><mrow id="S4.SS3.p1.9.m9.1.1.2.2.3" xref="S4.SS3.p1.9.m9.1.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.9.m9.1.1.2.2.3.1" xref="S4.SS3.p1.9.m9.1.1.2.2.3.1.cmml">∂</mo><msubsup id="S4.SS3.p1.9.m9.1.1.2.2.3.2" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.2" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.2.cmml">y</mi><mrow id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.cmml"><mi id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.2" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.1" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.3" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.3.cmml">j</mi></mrow><mi id="S4.SS3.p1.9.m9.1.1.2.2.3.2.3" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.3.cmml">n</mi></msubsup></mrow></mrow></mrow><mo id="S4.SS3.p1.9.m9.1.1.1" xref="S4.SS3.p1.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.9.m9.1.1.3" xref="S4.SS3.p1.9.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><apply id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1"><eq id="S4.SS3.p1.9.m9.1.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1.1"></eq><apply id="S4.SS3.p1.9.m9.1.1.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2"><partialdiff id="S4.SS3.p1.9.m9.1.1.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.1"></partialdiff><apply id="S4.SS3.p1.9.m9.1.1.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2"><divide id="S4.SS3.p1.9.m9.1.1.2.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.1"></divide><apply id="S4.SS3.p1.9.m9.1.1.2.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2">superscript</csymbol><apply id="S4.SS3.p1.9.m9.1.1.2.2.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.2.2.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.2.2.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.2">𝑙</ci><apply id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3"><times id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.1"></times><ci id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.9.m9.1.1.2.2.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.2.3">𝑛</ci></apply><apply id="S4.SS3.p1.9.m9.1.1.2.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3"><partialdiff id="S4.SS3.p1.9.m9.1.1.2.2.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.1"></partialdiff><apply id="S4.SS3.p1.9.m9.1.1.2.2.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.2.3.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2">superscript</csymbol><apply id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.2">𝑦</ci><apply id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3"><times id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.1.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.1"></times><ci id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.2.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.2">𝑖</ci><ci id="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.2.3.3">𝑗</ci></apply></apply><ci id="S4.SS3.p1.9.m9.1.1.2.2.3.2.3.cmml" xref="S4.SS3.p1.9.m9.1.1.2.2.3.2.3">𝑛</ci></apply></apply></apply></apply><cn type="integer" id="S4.SS3.p1.9.m9.1.1.3.cmml" xref="S4.SS3.p1.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">\partial l_{rc}^{n}/\partial y_{ij}^{n}=0</annotation></semantics></math> for <math id="S4.SS3.p1.10.m10.1" class="ltx_Math" alttext="i\neq r" display="inline"><semantics id="S4.SS3.p1.10.m10.1a"><mrow id="S4.SS3.p1.10.m10.1.1" xref="S4.SS3.p1.10.m10.1.1.cmml"><mi id="S4.SS3.p1.10.m10.1.1.2" xref="S4.SS3.p1.10.m10.1.1.2.cmml">i</mi><mo id="S4.SS3.p1.10.m10.1.1.1" xref="S4.SS3.p1.10.m10.1.1.1.cmml">≠</mo><mi id="S4.SS3.p1.10.m10.1.1.3" xref="S4.SS3.p1.10.m10.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.1b"><apply id="S4.SS3.p1.10.m10.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1"><neq id="S4.SS3.p1.10.m10.1.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1.1"></neq><ci id="S4.SS3.p1.10.m10.1.1.2.cmml" xref="S4.SS3.p1.10.m10.1.1.2">𝑖</ci><ci id="S4.SS3.p1.10.m10.1.1.3.cmml" xref="S4.SS3.p1.10.m10.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.1c">i\neq r</annotation></semantics></math> or <math id="S4.SS3.p1.11.m11.1" class="ltx_Math" alttext="c\neq j" display="inline"><semantics id="S4.SS3.p1.11.m11.1a"><mrow id="S4.SS3.p1.11.m11.1.1" xref="S4.SS3.p1.11.m11.1.1.cmml"><mi id="S4.SS3.p1.11.m11.1.1.2" xref="S4.SS3.p1.11.m11.1.1.2.cmml">c</mi><mo id="S4.SS3.p1.11.m11.1.1.1" xref="S4.SS3.p1.11.m11.1.1.1.cmml">≠</mo><mi id="S4.SS3.p1.11.m11.1.1.3" xref="S4.SS3.p1.11.m11.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><apply id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1"><neq id="S4.SS3.p1.11.m11.1.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1.1"></neq><ci id="S4.SS3.p1.11.m11.1.1.2.cmml" xref="S4.SS3.p1.11.m11.1.1.2">𝑐</ci><ci id="S4.SS3.p1.11.m11.1.1.3.cmml" xref="S4.SS3.p1.11.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">c\neq j</annotation></semantics></math>, so that <math id="S4.SS3.p1.12.m12.1" class="ltx_Math" alttext="\partial y_{rc}^{n}/\partial I_{ij}=\partial l_{rc}^{n}/\partial I_{ij}" display="inline"><semantics id="S4.SS3.p1.12.m12.1a"><mrow id="S4.SS3.p1.12.m12.1.1" xref="S4.SS3.p1.12.m12.1.1.cmml"><mrow id="S4.SS3.p1.12.m12.1.1.2" xref="S4.SS3.p1.12.m12.1.1.2.cmml"><mo rspace="0em" id="S4.SS3.p1.12.m12.1.1.2.1" xref="S4.SS3.p1.12.m12.1.1.2.1.cmml">∂</mo><mrow id="S4.SS3.p1.12.m12.1.1.2.2" xref="S4.SS3.p1.12.m12.1.1.2.2.cmml"><msubsup id="S4.SS3.p1.12.m12.1.1.2.2.2" xref="S4.SS3.p1.12.m12.1.1.2.2.2.cmml"><mi id="S4.SS3.p1.12.m12.1.1.2.2.2.2.2" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.2.cmml">y</mi><mrow id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.2" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.1" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.3" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.12.m12.1.1.2.2.2.3" xref="S4.SS3.p1.12.m12.1.1.2.2.2.3.cmml">n</mi></msubsup><mo id="S4.SS3.p1.12.m12.1.1.2.2.1" xref="S4.SS3.p1.12.m12.1.1.2.2.1.cmml">/</mo><mrow id="S4.SS3.p1.12.m12.1.1.2.2.3" xref="S4.SS3.p1.12.m12.1.1.2.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.2.2.3.1" xref="S4.SS3.p1.12.m12.1.1.2.2.3.1.cmml">∂</mo><msub id="S4.SS3.p1.12.m12.1.1.2.2.3.2" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.cmml"><mi id="S4.SS3.p1.12.m12.1.1.2.2.3.2.2" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.2.cmml">I</mi><mrow id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.2" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.1" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.3" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo rspace="0.1389em" id="S4.SS3.p1.12.m12.1.1.1" xref="S4.SS3.p1.12.m12.1.1.1.cmml">=</mo><mrow id="S4.SS3.p1.12.m12.1.1.3" xref="S4.SS3.p1.12.m12.1.1.3.cmml"><mo lspace="0.1389em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.3.1" xref="S4.SS3.p1.12.m12.1.1.3.1.cmml">∂</mo><mrow id="S4.SS3.p1.12.m12.1.1.3.2" xref="S4.SS3.p1.12.m12.1.1.3.2.cmml"><msubsup id="S4.SS3.p1.12.m12.1.1.3.2.2" xref="S4.SS3.p1.12.m12.1.1.3.2.2.cmml"><mi id="S4.SS3.p1.12.m12.1.1.3.2.2.2.2" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.2.cmml">l</mi><mrow id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.2" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.1" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.3" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.12.m12.1.1.3.2.2.3" xref="S4.SS3.p1.12.m12.1.1.3.2.2.3.cmml">n</mi></msubsup><mo id="S4.SS3.p1.12.m12.1.1.3.2.1" xref="S4.SS3.p1.12.m12.1.1.3.2.1.cmml">/</mo><mrow id="S4.SS3.p1.12.m12.1.1.3.2.3" xref="S4.SS3.p1.12.m12.1.1.3.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.3.2.3.1" xref="S4.SS3.p1.12.m12.1.1.3.2.3.1.cmml">∂</mo><msub id="S4.SS3.p1.12.m12.1.1.3.2.3.2" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.cmml"><mi id="S4.SS3.p1.12.m12.1.1.3.2.3.2.2" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.2.cmml">I</mi><mrow id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.cmml"><mi id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.2" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.1" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.3" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m12.1b"><apply id="S4.SS3.p1.12.m12.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1"><eq id="S4.SS3.p1.12.m12.1.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1.1"></eq><apply id="S4.SS3.p1.12.m12.1.1.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2"><partialdiff id="S4.SS3.p1.12.m12.1.1.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.1"></partialdiff><apply id="S4.SS3.p1.12.m12.1.1.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2"><divide id="S4.SS3.p1.12.m12.1.1.2.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.1"></divide><apply id="S4.SS3.p1.12.m12.1.1.2.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2">superscript</csymbol><apply id="S4.SS3.p1.12.m12.1.1.2.2.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.2.2.2.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.2.2.2.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.2">𝑦</ci><apply id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3"><times id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.1"></times><ci id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.12.m12.1.1.2.2.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.2.3">𝑛</ci></apply><apply id="S4.SS3.p1.12.m12.1.1.2.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3"><partialdiff id="S4.SS3.p1.12.m12.1.1.2.2.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.1"></partialdiff><apply id="S4.SS3.p1.12.m12.1.1.2.2.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.2.2.3.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.2.2.3.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.2">𝐼</ci><apply id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3"><times id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.1"></times><ci id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.2">𝑖</ci><ci id="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.2.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S4.SS3.p1.12.m12.1.1.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3"><partialdiff id="S4.SS3.p1.12.m12.1.1.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.1"></partialdiff><apply id="S4.SS3.p1.12.m12.1.1.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2"><divide id="S4.SS3.p1.12.m12.1.1.3.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.1"></divide><apply id="S4.SS3.p1.12.m12.1.1.3.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.3.2.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2">superscript</csymbol><apply id="S4.SS3.p1.12.m12.1.1.3.2.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.3.2.2.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.3.2.2.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.2">𝑙</ci><apply id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3"><times id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.1"></times><ci id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.12.m12.1.1.3.2.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.2.3">𝑛</ci></apply><apply id="S4.SS3.p1.12.m12.1.1.3.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3"><partialdiff id="S4.SS3.p1.12.m12.1.1.3.2.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.1"></partialdiff><apply id="S4.SS3.p1.12.m12.1.1.3.2.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.12.m12.1.1.3.2.3.2.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.12.m12.1.1.3.2.3.2.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.2">𝐼</ci><apply id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3"><times id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.1.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.1"></times><ci id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.2.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.2">𝑖</ci><ci id="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.3.cmml" xref="S4.SS3.p1.12.m12.1.1.3.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m12.1c">\partial y_{rc}^{n}/\partial I_{ij}=\partial l_{rc}^{n}/\partial I_{ij}</annotation></semantics></math>, since <math id="S4.SS3.p1.13.m13.1" class="ltx_Math" alttext="\partial l_{rc}^{n}/\partial I_{ij}" display="inline"><semantics id="S4.SS3.p1.13.m13.1a"><mrow id="S4.SS3.p1.13.m13.1.1" xref="S4.SS3.p1.13.m13.1.1.cmml"><mo rspace="0em" id="S4.SS3.p1.13.m13.1.1.1" xref="S4.SS3.p1.13.m13.1.1.1.cmml">∂</mo><mrow id="S4.SS3.p1.13.m13.1.1.2" xref="S4.SS3.p1.13.m13.1.1.2.cmml"><msubsup id="S4.SS3.p1.13.m13.1.1.2.2" xref="S4.SS3.p1.13.m13.1.1.2.2.cmml"><mi id="S4.SS3.p1.13.m13.1.1.2.2.2.2" xref="S4.SS3.p1.13.m13.1.1.2.2.2.2.cmml">l</mi><mrow id="S4.SS3.p1.13.m13.1.1.2.2.2.3" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.cmml"><mi id="S4.SS3.p1.13.m13.1.1.2.2.2.3.2" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.13.m13.1.1.2.2.2.3.1" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.13.m13.1.1.2.2.2.3.3" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.3.cmml">c</mi></mrow><mi id="S4.SS3.p1.13.m13.1.1.2.2.3" xref="S4.SS3.p1.13.m13.1.1.2.2.3.cmml">n</mi></msubsup><mo id="S4.SS3.p1.13.m13.1.1.2.1" xref="S4.SS3.p1.13.m13.1.1.2.1.cmml">/</mo><mrow id="S4.SS3.p1.13.m13.1.1.2.3" xref="S4.SS3.p1.13.m13.1.1.2.3.cmml"><mo lspace="0em" rspace="0em" id="S4.SS3.p1.13.m13.1.1.2.3.1" xref="S4.SS3.p1.13.m13.1.1.2.3.1.cmml">∂</mo><msub id="S4.SS3.p1.13.m13.1.1.2.3.2" xref="S4.SS3.p1.13.m13.1.1.2.3.2.cmml"><mi id="S4.SS3.p1.13.m13.1.1.2.3.2.2" xref="S4.SS3.p1.13.m13.1.1.2.3.2.2.cmml">I</mi><mrow id="S4.SS3.p1.13.m13.1.1.2.3.2.3" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.cmml"><mi id="S4.SS3.p1.13.m13.1.1.2.3.2.3.2" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.13.m13.1.1.2.3.2.3.1" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.1.cmml">​</mo><mi id="S4.SS3.p1.13.m13.1.1.2.3.2.3.3" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m13.1b"><apply id="S4.SS3.p1.13.m13.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1"><partialdiff id="S4.SS3.p1.13.m13.1.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1.1"></partialdiff><apply id="S4.SS3.p1.13.m13.1.1.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2"><divide id="S4.SS3.p1.13.m13.1.1.2.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.1"></divide><apply id="S4.SS3.p1.13.m13.1.1.2.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.1.2.2.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2">superscript</csymbol><apply id="S4.SS3.p1.13.m13.1.1.2.2.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.1.2.2.2.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2">subscript</csymbol><ci id="S4.SS3.p1.13.m13.1.1.2.2.2.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2.2.2">𝑙</ci><apply id="S4.SS3.p1.13.m13.1.1.2.2.2.3.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3"><times id="S4.SS3.p1.13.m13.1.1.2.2.2.3.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.1"></times><ci id="S4.SS3.p1.13.m13.1.1.2.2.2.3.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.2">𝑟</ci><ci id="S4.SS3.p1.13.m13.1.1.2.2.2.3.3.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.SS3.p1.13.m13.1.1.2.2.3.cmml" xref="S4.SS3.p1.13.m13.1.1.2.2.3">𝑛</ci></apply><apply id="S4.SS3.p1.13.m13.1.1.2.3.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3"><partialdiff id="S4.SS3.p1.13.m13.1.1.2.3.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.1"></partialdiff><apply id="S4.SS3.p1.13.m13.1.1.2.3.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.13.m13.1.1.2.3.2.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.13.m13.1.1.2.3.2.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2.2">𝐼</ci><apply id="S4.SS3.p1.13.m13.1.1.2.3.2.3.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3"><times id="S4.SS3.p1.13.m13.1.1.2.3.2.3.1.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.1"></times><ci id="S4.SS3.p1.13.m13.1.1.2.3.2.3.2.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.2">𝑖</ci><ci id="S4.SS3.p1.13.m13.1.1.2.3.2.3.3.cmml" xref="S4.SS3.p1.13.m13.1.1.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.m13.1c">\partial l_{rc}^{n}/\partial I_{ij}</annotation></semantics></math> can be computed efficiently by DL frameworks. Finally, we draw the heat map of the total effect of a subset <math id="S4.SS3.p1.14.m14.1" class="ltx_Math" alttext="\Omega_{C}" display="inline"><semantics id="S4.SS3.p1.14.m14.1a"><msub id="S4.SS3.p1.14.m14.1.1" xref="S4.SS3.p1.14.m14.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p1.14.m14.1.1.2" xref="S4.SS3.p1.14.m14.1.1.2.cmml">Ω</mi><mi id="S4.SS3.p1.14.m14.1.1.3" xref="S4.SS3.p1.14.m14.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.14.m14.1b"><apply id="S4.SS3.p1.14.m14.1.1.cmml" xref="S4.SS3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.14.m14.1.1.1.cmml" xref="S4.SS3.p1.14.m14.1.1">subscript</csymbol><ci id="S4.SS3.p1.14.m14.1.1.2.cmml" xref="S4.SS3.p1.14.m14.1.1.2">Ω</ci><ci id="S4.SS3.p1.14.m14.1.1.3.cmml" xref="S4.SS3.p1.14.m14.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.14.m14.1c">\Omega_{C}</annotation></semantics></math> of channels:
<span id="S4.SS3.p1.14.1" class="ltx_text" style="font-size:90%;"></span></p>
<table id="S4.E19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E19.m1.2" class="ltx_Math" alttext="E_{ij}=\left\|\sum_{n\in\Omega_{C}}\left(\frac{\partial l_{rc}^{n}}{\partial I_{ij}}\right)^{2}\right\|." display="block"><semantics id="S4.E19.m1.2a"><mrow id="S4.E19.m1.2.2.1" xref="S4.E19.m1.2.2.1.1.cmml"><mrow id="S4.E19.m1.2.2.1.1" xref="S4.E19.m1.2.2.1.1.cmml"><msub id="S4.E19.m1.2.2.1.1.3" xref="S4.E19.m1.2.2.1.1.3.cmml"><mi mathsize="90%" id="S4.E19.m1.2.2.1.1.3.2" xref="S4.E19.m1.2.2.1.1.3.2.cmml">E</mi><mrow id="S4.E19.m1.2.2.1.1.3.3" xref="S4.E19.m1.2.2.1.1.3.3.cmml"><mi mathsize="90%" id="S4.E19.m1.2.2.1.1.3.3.2" xref="S4.E19.m1.2.2.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E19.m1.2.2.1.1.3.3.1" xref="S4.E19.m1.2.2.1.1.3.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E19.m1.2.2.1.1.3.3.3" xref="S4.E19.m1.2.2.1.1.3.3.3.cmml">j</mi></mrow></msub><mo mathsize="90%" id="S4.E19.m1.2.2.1.1.2" xref="S4.E19.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E19.m1.2.2.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.2.cmml"><mo id="S4.E19.m1.2.2.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.cmml"><munder id="S4.E19.m1.2.2.1.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.cmml"><mo lspace="0em" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" id="S4.E19.m1.2.2.1.1.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S4.E19.m1.2.2.1.1.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S4.E19.m1.2.2.1.1.1.1.1.1.3.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.2.cmml">n</mi><mo mathsize="90%" id="S4.E19.m1.2.2.1.1.1.1.1.1.3.1" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi mathsize="90%" mathvariant="normal" id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">Ω</mi><mi mathsize="90%" id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.3" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.3.cmml">C</mi></msub></mrow></munder><msup id="S4.E19.m1.2.2.1.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.1.2.cmml"><mrow id="S4.E19.m1.2.2.1.1.1.1.1.2.2.2" xref="S4.E19.m1.1.1.cmml"><mo id="S4.E19.m1.2.2.1.1.1.1.1.2.2.2.1" xref="S4.E19.m1.1.1.cmml">(</mo><mfrac id="S4.E19.m1.1.1" xref="S4.E19.m1.1.1.cmml"><mrow id="S4.E19.m1.1.1.2" xref="S4.E19.m1.1.1.2.cmml"><mo mathsize="90%" rspace="0em" id="S4.E19.m1.1.1.2.1" xref="S4.E19.m1.1.1.2.1.cmml">∂</mo><msubsup id="S4.E19.m1.1.1.2.2" xref="S4.E19.m1.1.1.2.2.cmml"><mi mathsize="90%" id="S4.E19.m1.1.1.2.2.2.2" xref="S4.E19.m1.1.1.2.2.2.2.cmml">l</mi><mrow id="S4.E19.m1.1.1.2.2.2.3" xref="S4.E19.m1.1.1.2.2.2.3.cmml"><mi mathsize="90%" id="S4.E19.m1.1.1.2.2.2.3.2" xref="S4.E19.m1.1.1.2.2.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E19.m1.1.1.2.2.2.3.1" xref="S4.E19.m1.1.1.2.2.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E19.m1.1.1.2.2.2.3.3" xref="S4.E19.m1.1.1.2.2.2.3.3.cmml">c</mi></mrow><mi mathsize="90%" id="S4.E19.m1.1.1.2.2.3" xref="S4.E19.m1.1.1.2.2.3.cmml">n</mi></msubsup></mrow><mrow id="S4.E19.m1.1.1.3" xref="S4.E19.m1.1.1.3.cmml"><mo mathsize="90%" rspace="0em" id="S4.E19.m1.1.1.3.1" xref="S4.E19.m1.1.1.3.1.cmml">∂</mo><msub id="S4.E19.m1.1.1.3.2" xref="S4.E19.m1.1.1.3.2.cmml"><mi mathsize="90%" id="S4.E19.m1.1.1.3.2.2" xref="S4.E19.m1.1.1.3.2.2.cmml">I</mi><mrow id="S4.E19.m1.1.1.3.2.3" xref="S4.E19.m1.1.1.3.2.3.cmml"><mi mathsize="90%" id="S4.E19.m1.1.1.3.2.3.2" xref="S4.E19.m1.1.1.3.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E19.m1.1.1.3.2.3.1" xref="S4.E19.m1.1.1.3.2.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E19.m1.1.1.3.2.3.3" xref="S4.E19.m1.1.1.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mfrac><mo id="S4.E19.m1.2.2.1.1.1.1.1.2.2.2.2" xref="S4.E19.m1.1.1.cmml">)</mo></mrow><mn mathsize="90%" id="S4.E19.m1.2.2.1.1.1.1.1.2.3" xref="S4.E19.m1.2.2.1.1.1.1.1.2.3.cmml">2</mn></msup></mrow><mo id="S4.E19.m1.2.2.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow></mrow><mo lspace="0em" mathsize="90%" id="S4.E19.m1.2.2.1.2" xref="S4.E19.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m1.2b"><apply id="S4.E19.m1.2.2.1.1.cmml" xref="S4.E19.m1.2.2.1"><eq id="S4.E19.m1.2.2.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.2"></eq><apply id="S4.E19.m1.2.2.1.1.3.cmml" xref="S4.E19.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.1.1.3.1.cmml" xref="S4.E19.m1.2.2.1.1.3">subscript</csymbol><ci id="S4.E19.m1.2.2.1.1.3.2.cmml" xref="S4.E19.m1.2.2.1.1.3.2">𝐸</ci><apply id="S4.E19.m1.2.2.1.1.3.3.cmml" xref="S4.E19.m1.2.2.1.1.3.3"><times id="S4.E19.m1.2.2.1.1.3.3.1.cmml" xref="S4.E19.m1.2.2.1.1.3.3.1"></times><ci id="S4.E19.m1.2.2.1.1.3.3.2.cmml" xref="S4.E19.m1.2.2.1.1.3.3.2">𝑖</ci><ci id="S4.E19.m1.2.2.1.1.3.3.3.cmml" xref="S4.E19.m1.2.2.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S4.E19.m1.2.2.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S4.E19.m1.2.2.1.1.1.2.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="S4.E19.m1.2.2.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1"><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1">subscript</csymbol><sum id="S4.E19.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.2"></sum><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3"><in id="S4.E19.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.1"></in><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.2">𝑛</ci><apply id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.2">Ω</ci><ci id="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.1.3.3.3">𝐶</ci></apply></apply></apply><apply id="S4.E19.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E19.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E19.m1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.2.2.2"><divide id="S4.E19.m1.1.1.1.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.2.2.2"></divide><apply id="S4.E19.m1.1.1.2.cmml" xref="S4.E19.m1.1.1.2"><partialdiff id="S4.E19.m1.1.1.2.1.cmml" xref="S4.E19.m1.1.1.2.1"></partialdiff><apply id="S4.E19.m1.1.1.2.2.cmml" xref="S4.E19.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.2.2.1.cmml" xref="S4.E19.m1.1.1.2.2">superscript</csymbol><apply id="S4.E19.m1.1.1.2.2.2.cmml" xref="S4.E19.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.2.2.2.1.cmml" xref="S4.E19.m1.1.1.2.2">subscript</csymbol><ci id="S4.E19.m1.1.1.2.2.2.2.cmml" xref="S4.E19.m1.1.1.2.2.2.2">𝑙</ci><apply id="S4.E19.m1.1.1.2.2.2.3.cmml" xref="S4.E19.m1.1.1.2.2.2.3"><times id="S4.E19.m1.1.1.2.2.2.3.1.cmml" xref="S4.E19.m1.1.1.2.2.2.3.1"></times><ci id="S4.E19.m1.1.1.2.2.2.3.2.cmml" xref="S4.E19.m1.1.1.2.2.2.3.2">𝑟</ci><ci id="S4.E19.m1.1.1.2.2.2.3.3.cmml" xref="S4.E19.m1.1.1.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S4.E19.m1.1.1.2.2.3.cmml" xref="S4.E19.m1.1.1.2.2.3">𝑛</ci></apply></apply><apply id="S4.E19.m1.1.1.3.cmml" xref="S4.E19.m1.1.1.3"><partialdiff id="S4.E19.m1.1.1.3.1.cmml" xref="S4.E19.m1.1.1.3.1"></partialdiff><apply id="S4.E19.m1.1.1.3.2.cmml" xref="S4.E19.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E19.m1.1.1.3.2.1.cmml" xref="S4.E19.m1.1.1.3.2">subscript</csymbol><ci id="S4.E19.m1.1.1.3.2.2.cmml" xref="S4.E19.m1.1.1.3.2.2">𝐼</ci><apply id="S4.E19.m1.1.1.3.2.3.cmml" xref="S4.E19.m1.1.1.3.2.3"><times id="S4.E19.m1.1.1.3.2.3.1.cmml" xref="S4.E19.m1.1.1.3.2.3.1"></times><ci id="S4.E19.m1.1.1.3.2.3.2.cmml" xref="S4.E19.m1.1.1.3.2.3.2">𝑖</ci><ci id="S4.E19.m1.1.1.3.2.3.3.cmml" xref="S4.E19.m1.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply><cn type="integer" id="S4.E19.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E19.m1.2.2.1.1.1.1.1.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.2c">E_{ij}=\left\|\sum_{n\in\Omega_{C}}\left(\frac{\partial l_{rc}^{n}}{\partial I_{ij}}\right)^{2}\right\|.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results and Analysis</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We perform experiments on the 3 datasets, in which we fix the general structure except for the visual attention models, to quantify the role of structured attention in our model and the best configuration for it. We will use the following abbreviations to distinguish the models we implemented:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p">SM/SIG: 1-glimpse softmax or sigmoid attention.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;padding-top:1.0pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p">MF/LBP: 1-glimpse multivariate attention with a MF or LBP recurrent layer and a default <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="T=3" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mrow id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">T</mi><mo id="S4.I1.i2.p1.1.m1.1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><eq id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.1"></eq><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">T=3</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;padding-top:1.0pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><em id="S4.I1.i3.p1.1.1" class="ltx_emph ltx_font_italic">MODEL</em>-G2: 2-glimpses with a default <math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="T=3" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><mrow id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">T</mi><mo id="S4.I1.i3.p1.1.m1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><eq id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.1"></eq><ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">T=3</annotation></semantics></math>, where <em id="S4.I1.i3.p1.1.2" class="ltx_emph ltx_font_italic">MODEL</em>=SIG,MF or LBP is the attention model.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;padding-top:1.0pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p">MF-SIG/LBP-SIG: 2-glimpse model by concatenating a MF or LBP attention with a SIG attention, as mentioned in Section <a href="#S3.SS4" title="3.4 The overall structure ‣ 3 Attention Models and Methods ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;padding-top:1.0pt;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.2" class="ltx_p"><em id="S4.I1.i5.p1.2.1" class="ltx_emph ltx_font_italic">MODEL</em>-T<math id="S4.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.I1.i5.p1.1.m1.1a"><mi id="S4.I1.i5.p1.1.m1.1.1" xref="S4.I1.i5.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.1.m1.1b"><ci id="S4.I1.i5.p1.1.m1.1.1.cmml" xref="S4.I1.i5.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.1.m1.1c">n</annotation></semantics></math>: <em id="S4.I1.i5.p1.2.2" class="ltx_emph ltx_font_italic">MODEL</em> with <math id="S4.I1.i5.p1.2.m2.1" class="ltx_Math" alttext="T=n" display="inline"><semantics id="S4.I1.i5.p1.2.m2.1a"><mrow id="S4.I1.i5.p1.2.m2.1.1" xref="S4.I1.i5.p1.2.m2.1.1.cmml"><mi id="S4.I1.i5.p1.2.m2.1.1.2" xref="S4.I1.i5.p1.2.m2.1.1.2.cmml">T</mi><mo id="S4.I1.i5.p1.2.m2.1.1.1" xref="S4.I1.i5.p1.2.m2.1.1.1.cmml">=</mo><mi id="S4.I1.i5.p1.2.m2.1.1.3" xref="S4.I1.i5.p1.2.m2.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i5.p1.2.m2.1b"><apply id="S4.I1.i5.p1.2.m2.1.1.cmml" xref="S4.I1.i5.p1.2.m2.1.1"><eq id="S4.I1.i5.p1.2.m2.1.1.1.cmml" xref="S4.I1.i5.p1.2.m2.1.1.1"></eq><ci id="S4.I1.i5.p1.2.m2.1.1.2.cmml" xref="S4.I1.i5.p1.2.m2.1.1.2">𝑇</ci><ci id="S4.I1.i5.p1.2.m2.1.1.3.cmml" xref="S4.I1.i5.p1.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i5.p1.2.m2.1c">T=n</annotation></semantics></math> inference steps.</p>
</div>
</li>
</ul>
</div>
<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>On SHAPES</h4>

<figure id="S4.F3" class="ltx_figure"><img src="/html/1708.02071/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="369" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Visualization of MF-G2 and LBP-G2 on the test set of <span id="S4.F3.10.1" class="ltx_text ltx_font_typewriter">large</span>. <math id="S4.F3.5.m1.1" class="ltx_Math" alttext="b^{(0)}" display="inline"><semantics id="S4.F3.5.m1.1b"><msup id="S4.F3.5.m1.1.2" xref="S4.F3.5.m1.1.2.cmml"><mi id="S4.F3.5.m1.1.2.2" xref="S4.F3.5.m1.1.2.2.cmml">b</mi><mrow id="S4.F3.5.m1.1.1.1.3" xref="S4.F3.5.m1.1.2.cmml"><mo stretchy="false" id="S4.F3.5.m1.1.1.1.3.1" xref="S4.F3.5.m1.1.2.cmml">(</mo><mn id="S4.F3.5.m1.1.1.1.1" xref="S4.F3.5.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.F3.5.m1.1.1.1.3.2" xref="S4.F3.5.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.F3.5.m1.1c"><apply id="S4.F3.5.m1.1.2.cmml" xref="S4.F3.5.m1.1.2"><csymbol cd="ambiguous" id="S4.F3.5.m1.1.2.1.cmml" xref="S4.F3.5.m1.1.2">superscript</csymbol><ci id="S4.F3.5.m1.1.2.2.cmml" xref="S4.F3.5.m1.1.2.2">𝑏</ci><cn type="integer" id="S4.F3.5.m1.1.1.1.1.cmml" xref="S4.F3.5.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m1.1d">b^{(0)}</annotation></semantics></math> or <math id="S4.F3.6.m2.1" class="ltx_Math" alttext="\psi_{i}" display="inline"><semantics id="S4.F3.6.m2.1b"><msub id="S4.F3.6.m2.1.1" xref="S4.F3.6.m2.1.1.cmml"><mi id="S4.F3.6.m2.1.1.2" xref="S4.F3.6.m2.1.1.2.cmml">ψ</mi><mi id="S4.F3.6.m2.1.1.3" xref="S4.F3.6.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F3.6.m2.1c"><apply id="S4.F3.6.m2.1.1.cmml" xref="S4.F3.6.m2.1.1"><csymbol cd="ambiguous" id="S4.F3.6.m2.1.1.1.cmml" xref="S4.F3.6.m2.1.1">subscript</csymbol><ci id="S4.F3.6.m2.1.1.2.cmml" xref="S4.F3.6.m2.1.1.2">𝜓</ci><ci id="S4.F3.6.m2.1.1.3.cmml" xref="S4.F3.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.m2.1d">\psi_{i}</annotation></semantics></math> represents the initial attention, <math id="S4.F3.7.m3.1" class="ltx_Math" alttext="b^{(3)}" display="inline"><semantics id="S4.F3.7.m3.1b"><msup id="S4.F3.7.m3.1.2" xref="S4.F3.7.m3.1.2.cmml"><mi id="S4.F3.7.m3.1.2.2" xref="S4.F3.7.m3.1.2.2.cmml">b</mi><mrow id="S4.F3.7.m3.1.1.1.3" xref="S4.F3.7.m3.1.2.cmml"><mo stretchy="false" id="S4.F3.7.m3.1.1.1.3.1" xref="S4.F3.7.m3.1.2.cmml">(</mo><mn id="S4.F3.7.m3.1.1.1.1" xref="S4.F3.7.m3.1.1.1.1.cmml">3</mn><mo stretchy="false" id="S4.F3.7.m3.1.1.1.3.2" xref="S4.F3.7.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.F3.7.m3.1c"><apply id="S4.F3.7.m3.1.2.cmml" xref="S4.F3.7.m3.1.2"><csymbol cd="ambiguous" id="S4.F3.7.m3.1.2.1.cmml" xref="S4.F3.7.m3.1.2">superscript</csymbol><ci id="S4.F3.7.m3.1.2.2.cmml" xref="S4.F3.7.m3.1.2.2">𝑏</ci><cn type="integer" id="S4.F3.7.m3.1.1.1.1.cmml" xref="S4.F3.7.m3.1.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.m3.1d">b^{(3)}</annotation></semantics></math> or <math id="S4.F3.8.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.F3.8.m4.1b"><mi id="S4.F3.8.m4.1.1" xref="S4.F3.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.F3.8.m4.1c"><ci id="S4.F3.8.m4.1.1.cmml" xref="S4.F3.8.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.m4.1d">b</annotation></semantics></math> represents the refined attention after MF or LBP. The query looks for a green object under a circle.</figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<p id="S4.T1.1" class="ltx_p ltx_align_center"><span id="S4.T1.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S4.T1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:346.9pt;height:308pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(21.4pt,-19.0pt) scale(1.14089888688113,1.14089888688113) ;">
<span id="S4.T1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T1.1.1.1.1.1" class="ltx_tr">
<span id="S4.T1.1.1.1.1.1.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T1.1.1.1.1.1.2" class="ltx_td ltx_align_left">Query Length</span>
<span id="S4.T1.1.1.1.1.1.3" class="ltx_td ltx_align_center">3</span>
<span id="S4.T1.1.1.1.1.1.4" class="ltx_td ltx_align_center">4</span>
<span id="S4.T1.1.1.1.1.1.5" class="ltx_td ltx_align_center">5</span>
<span id="S4.T1.1.1.1.1.1.6" class="ltx_td ltx_align_center">All</span></span>
<span id="S4.T1.1.1.1.1.2" class="ltx_tr">
<span id="S4.T1.1.1.1.1.2.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.2.2" class="ltx_td ltx_align_left">% of test set</span>
<span id="S4.T1.1.1.1.1.2.3" class="ltx_td ltx_align_center">12.5</span>
<span id="S4.T1.1.1.1.1.2.4" class="ltx_td ltx_align_center">62.5</span>
<span id="S4.T1.1.1.1.1.2.5" class="ltx_td ltx_align_center">25</span>
<span id="S4.T1.1.1.1.1.2.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T1.1.1.1.1.3" class="ltx_tr">
<span id="S4.T1.1.1.1.1.3.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.1.3.1.1" class="ltx_text ltx_font_typewriter">small</span></span>
<span id="S4.T1.1.1.1.1.3.2" class="ltx_td ltx_align_left ltx_border_t">NMN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite></span>
<span id="S4.T1.1.1.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.3.3.1" class="ltx_text ltx_font_bold">91.4</span></span>
<span id="S4.T1.1.1.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.3.4.1" class="ltx_text ltx_font_bold">95.6</span></span>
<span id="S4.T1.1.1.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.3.5.1" class="ltx_text ltx_font_bold">92.6</span></span>
<span id="S4.T1.1.1.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.3.6.1" class="ltx_text ltx_font_bold">94.3</span></span></span>
<span id="S4.T1.1.1.1.1.4" class="ltx_tr">
<span id="S4.T1.1.1.1.1.4.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.4.2" class="ltx_td ltx_align_left">SIG-G2</span>
<span id="S4.T1.1.1.1.1.4.3" class="ltx_td ltx_align_center">57.0</span>
<span id="S4.T1.1.1.1.1.4.4" class="ltx_td ltx_align_center">70.5</span>
<span id="S4.T1.1.1.1.1.4.5" class="ltx_td ltx_align_center">66.8</span>
<span id="S4.T1.1.1.1.1.4.6" class="ltx_td ltx_align_center">67.9</span></span>
<span id="S4.T1.1.1.1.1.5" class="ltx_tr">
<span id="S4.T1.1.1.1.1.5.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.5.2" class="ltx_td ltx_align_left">MF-G2</span>
<span id="S4.T1.1.1.1.1.5.3" class="ltx_td ltx_align_center">53.1</span>
<span id="S4.T1.1.1.1.1.5.4" class="ltx_td ltx_align_center">71.4</span>
<span id="S4.T1.1.1.1.1.5.5" class="ltx_td ltx_align_center">66.0</span>
<span id="S4.T1.1.1.1.1.5.6" class="ltx_td ltx_align_center">67.8</span></span>
<span id="S4.T1.1.1.1.1.6" class="ltx_tr">
<span id="S4.T1.1.1.1.1.6.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.6.2" class="ltx_td ltx_align_left">LBP-G2</span>
<span id="S4.T1.1.1.1.1.6.3" class="ltx_td ltx_align_center">63.3</span>
<span id="S4.T1.1.1.1.1.6.4" class="ltx_td ltx_align_center">72.2</span>
<span id="S4.T1.1.1.1.1.6.5" class="ltx_td ltx_align_center">62.5</span>
<span id="S4.T1.1.1.1.1.6.6" class="ltx_td ltx_align_center">68.7</span></span>
<span id="S4.T1.1.1.1.1.7" class="ltx_tr">
<span id="S4.T1.1.1.1.1.7.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.1.7.1.1" class="ltx_text ltx_font_typewriter">medium</span></span>
<span id="S4.T1.1.1.1.1.7.2" class="ltx_td ltx_align_left ltx_border_t">NMN</span>
<span id="S4.T1.1.1.1.1.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.7.3.1" class="ltx_text ltx_font_bold">99.2</span></span>
<span id="S4.T1.1.1.1.1.7.4" class="ltx_td ltx_align_center ltx_border_t">92.1</span>
<span id="S4.T1.1.1.1.1.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.7.5.1" class="ltx_text ltx_font_bold">85.2</span></span>
<span id="S4.T1.1.1.1.1.7.6" class="ltx_td ltx_align_center ltx_border_t">91.3</span></span>
<span id="S4.T1.1.1.1.1.8" class="ltx_tr">
<span id="S4.T1.1.1.1.1.8.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.8.2" class="ltx_td ltx_align_left">SIG-G2</span>
<span id="S4.T1.1.1.1.1.8.3" class="ltx_td ltx_align_center">68.8</span>
<span id="S4.T1.1.1.1.1.8.4" class="ltx_td ltx_align_center">79.6</span>
<span id="S4.T1.1.1.1.1.8.5" class="ltx_td ltx_align_center">73.8</span>
<span id="S4.T1.1.1.1.1.8.6" class="ltx_td ltx_align_center">76.8</span></span>
<span id="S4.T1.1.1.1.1.9" class="ltx_tr">
<span id="S4.T1.1.1.1.1.9.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.9.2" class="ltx_td ltx_align_left">MF-G2</span>
<span id="S4.T1.1.1.1.1.9.3" class="ltx_td ltx_align_center">98.0</span>
<span id="S4.T1.1.1.1.1.9.4" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.1.1.9.4.1" class="ltx_text ltx_font_bold">99.6</span></span>
<span id="S4.T1.1.1.1.1.9.5" class="ltx_td ltx_align_center">71.5</span>
<span id="S4.T1.1.1.1.1.9.6" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.1.1.9.6.1" class="ltx_text ltx_font_bold">92.4</span></span></span>
<span id="S4.T1.1.1.1.1.10" class="ltx_tr">
<span id="S4.T1.1.1.1.1.10.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.10.2" class="ltx_td ltx_align_left">LBP-G2</span>
<span id="S4.T1.1.1.1.1.10.3" class="ltx_td ltx_align_center">87.1</span>
<span id="S4.T1.1.1.1.1.10.4" class="ltx_td ltx_align_center">99.5</span>
<span id="S4.T1.1.1.1.1.10.5" class="ltx_td ltx_align_center">71.9</span>
<span id="S4.T1.1.1.1.1.10.6" class="ltx_td ltx_align_center">91.0</span></span>
<span id="S4.T1.1.1.1.1.11" class="ltx_tr">
<span id="S4.T1.1.1.1.1.11.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.1.11.1.1" class="ltx_text ltx_font_typewriter">large</span></span>
<span id="S4.T1.1.1.1.1.11.2" class="ltx_td ltx_align_left ltx_border_t">NMN</span>
<span id="S4.T1.1.1.1.1.11.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.11.3.1" class="ltx_text ltx_font_bold">99.7</span></span>
<span id="S4.T1.1.1.1.1.11.4" class="ltx_td ltx_align_center ltx_border_t">94.2</span>
<span id="S4.T1.1.1.1.1.11.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1.11.5.1" class="ltx_text ltx_font_bold">91.2</span></span>
<span id="S4.T1.1.1.1.1.11.6" class="ltx_td ltx_align_center ltx_border_t">94.1</span></span>
<span id="S4.T1.1.1.1.1.12" class="ltx_tr">
<span id="S4.T1.1.1.1.1.12.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.12.2" class="ltx_td ltx_align_left">SIG-G2</span>
<span id="S4.T1.1.1.1.1.12.3" class="ltx_td ltx_align_center">93.2</span>
<span id="S4.T1.1.1.1.1.12.4" class="ltx_td ltx_align_center">95.6</span>
<span id="S4.T1.1.1.1.1.12.5" class="ltx_td ltx_align_center">72.5</span>
<span id="S4.T1.1.1.1.1.12.6" class="ltx_td ltx_align_center">89.5</span></span>
<span id="S4.T1.1.1.1.1.13" class="ltx_tr">
<span id="S4.T1.1.1.1.1.13.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.13.2" class="ltx_td ltx_align_left">MF-G2</span>
<span id="S4.T1.1.1.1.1.13.3" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.1.1.13.3.1" class="ltx_text ltx_font_bold">99.7</span></span>
<span id="S4.T1.1.1.1.1.13.4" class="ltx_td ltx_align_center">99.9</span>
<span id="S4.T1.1.1.1.1.13.5" class="ltx_td ltx_align_center">79.2</span>
<span id="S4.T1.1.1.1.1.13.6" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.1.1.13.6.1" class="ltx_text ltx_font_bold">94.7</span></span></span>
<span id="S4.T1.1.1.1.1.14" class="ltx_tr">
<span id="S4.T1.1.1.1.1.14.1" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.14.2" class="ltx_td ltx_align_left">LBP-G2</span>
<span id="S4.T1.1.1.1.1.14.3" class="ltx_td ltx_align_center">95.1</span>
<span id="S4.T1.1.1.1.1.14.4" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.1.1.14.4.1" class="ltx_text ltx_font_bold">100</span></span>
<span id="S4.T1.1.1.1.1.14.5" class="ltx_td ltx_align_center">78.9</span>
<span id="S4.T1.1.1.1.1.14.6" class="ltx_td ltx_align_center">94.1</span></span>
<span id="S4.T1.1.1.1.1.15" class="ltx_tr">
<span id="S4.T1.1.1.1.1.15.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T1.1.1.1.1.15.2" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.15.3" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.15.4" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.15.5" class="ltx_td"></span>
<span id="S4.T1.1.1.1.1.15.6" class="ltx_td"></span></span>
</span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy on SHAPES.</figcaption>
</figure>
<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.1" class="ltx_p">In this part, we will look into the influence of the volume of the data on our model’s generalization, and compare the performance of SIG-G2, MF-G2 and LBP-G2 models. We find it is difficult for all 3 models to generalize with the same amount of data as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. This may because <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> uses a parser to understand the queries with guaranteed correctness on this dataset, while we have to train the GRU to understand the queries from scratch. The parser-based method may not perform well in more general tasks such as the VQA dataset, since they found using fewer modules on the VQA dataset turned out to be better, but our RNN-based approach should generalize better with enough training data. So we generate more data with the same answer distributions for each query as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> to train and test our model, and re-trained their model using the released code. We name the original dataset <span id="S4.SS4.SSS1.p1.1.1" class="ltx_text ltx_font_typewriter">small</span>, and the newly generated datasets with 2 and 3 times as much data in both training and test sets as <span id="S4.SS4.SSS1.p1.1.2" class="ltx_text ltx_font_typewriter">medium</span> and <span id="S4.SS4.SSS1.p1.1.3" class="ltx_text ltx_font_typewriter">large</span> respectively. We find with more training data, our model becomes competitive with <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and the MF-G2 model surpasses it on both <span id="S4.SS4.SSS1.p1.1.4" class="ltx_text ltx_font_typewriter">medium</span> and <span id="S4.SS4.SSS1.p1.1.5" class="ltx_text ltx_font_typewriter">large</span>, as shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.4.1 On SHAPES ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Our models are extremely good at handling length-4 queries, which looks for object arrangements in 4-neighborhood, as demonstrated in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4.1 On SHAPES ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The high accuracy also implies the model is capable of set theory reasoning, since it achieved high test accuracy with length-3 queries which contain self-conflict queries such as <em id="S4.SS4.SSS1.p1.1.6" class="ltx_emph ltx_font_italic">is red green</em>, which aims to find an object that is both red and green. For complex queries, such as <em id="S4.SS4.SSS1.p1.1.7" class="ltx_emph ltx_font_italic">is red below below green</em>, which aims to find a red object below another object that is below a green object, it is not as competitive as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, probably because the GRU in our model has not generalized to higher order logic.</p>
</div>
</section>
<section id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>On CLEVR</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para">
<p id="S4.SS4.SSS2.p1.1" class="ltx_p">In this part, we study the role of different visual features and different kinds of attentions on the performance, and test our best models on the test set, as shown in Table <a href="#S4.T2" title="Table 2 ‣ 4.4.2 On CLEVR ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Our best model surpasses the best baseline model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> by more than 9.5% on the test set. Both MF and LBP outperform SM and SIG, demonstrating the effectiveness of our method. The maximum margin of MF/LBP vs. SIG on overall accuracy is 2.62% and 1.33% with the ResNet-152 and ResNet-101 features respectively. The most significant improvement of MF/LBP over other models is on Compare Attribute, which involves comparing specific attributes of objects specified by spatial relations with other objects. This also proves that our model alleviates the problem of previous methods of ignoring arrangements of regions. Further, we show the receptive fields of the 2 selected layers on the test set in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.4.2 On CLEVR ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. In each image, we choose the feature vector closest to the center, where there is a higher chance for objects to appear. Still, both of them only occupy a small portion of the image, indicating the importance of considering the structure of regions. Overall, the performance with <span id="S4.SS4.SSS2.p1.1.1" class="ltx_text ltx_font_typewriter">res4b22</span> features is better than that with <span id="S4.SS4.SSS2.p1.1.2" class="ltx_text ltx_font_typewriter">res5c</span> features. From the ERF point of view, the ERF of <span id="S4.SS4.SSS2.p1.1.3" class="ltx_text ltx_font_typewriter">res5c</span> has more than twice the area as the ERF of <span id="S4.SS4.SSS2.p1.1.4" class="ltx_text ltx_font_typewriter">res4b22</span>. As a result, the feature vector of <span id="S4.SS4.SSS2.p1.1.5" class="ltx_text ltx_font_typewriter">res5c</span> may require more than twice the number of parameters to represent same amount of information in this region as <span id="S4.SS4.SSS2.p1.1.6" class="ltx_text ltx_font_typewriter">res4b22</span>, but its has only twice.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:143.1pt;"><img src="/html/1708.02071/assets/clevrheat1.jpg" id="S4.F4.1.g1" class="ltx_graphics ltx_img_square" width="538" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering ltx_font_typewriter" style="font-size:90%;">res5c<span id="S4.F4.1.1.1" class="ltx_text ltx_font_serif"> on CLEVR</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:143.1pt;"><img src="/html/1708.02071/assets/clevrheat2.jpg" id="S4.F4.2.g1" class="ltx_graphics ltx_img_square" width="538" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span id="S4.F4.2.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">res5c<span id="S4.F4.2.1.1.1" class="ltx_text ltx_font_serif"> on CLEVR</span></span> </figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" style="width:143.1pt;"><img src="/html/1708.02071/assets/cocoheat.jpg" id="S4.F4.3.g1" class="ltx_graphics ltx_img_square" width="538" height="538" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span id="S4.F4.3.1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">res5c<span id="S4.F4.3.1.1.1" class="ltx_text ltx_font_serif"> on MSCOCO</span></span> </figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>The average ERF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> of 32 channels chosen at regular intervals, on 15000 images from the CLEVR test set and 52500 images from the MSCOCO test set with resolution of <math id="S4.F4.7.m1.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S4.F4.7.m1.1b"><mrow id="S4.F4.7.m1.1.1" xref="S4.F4.7.m1.1.1.cmml"><mn id="S4.F4.7.m1.1.1.2" xref="S4.F4.7.m1.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S4.F4.7.m1.1.1.1" xref="S4.F4.7.m1.1.1.1.cmml">×</mo><mn id="S4.F4.7.m1.1.1.3" xref="S4.F4.7.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.7.m1.1c"><apply id="S4.F4.7.m1.1.1.cmml" xref="S4.F4.7.m1.1.1"><times id="S4.F4.7.m1.1.1.1.cmml" xref="S4.F4.7.m1.1.1.1"></times><cn type="integer" id="S4.F4.7.m1.1.1.2.cmml" xref="S4.F4.7.m1.1.1.2">224</cn><cn type="integer" id="S4.F4.7.m1.1.1.3.cmml" xref="S4.F4.7.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.7.m1.1d">224\times 224</annotation></semantics></math> and <math id="S4.F4.8.m2.1" class="ltx_Math" alttext="448\times 448" display="inline"><semantics id="S4.F4.8.m2.1b"><mrow id="S4.F4.8.m2.1.1" xref="S4.F4.8.m2.1.1.cmml"><mn id="S4.F4.8.m2.1.1.2" xref="S4.F4.8.m2.1.1.2.cmml">448</mn><mo lspace="0.222em" rspace="0.222em" id="S4.F4.8.m2.1.1.1" xref="S4.F4.8.m2.1.1.1.cmml">×</mo><mn id="S4.F4.8.m2.1.1.3" xref="S4.F4.8.m2.1.1.3.cmml">448</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.8.m2.1c"><apply id="S4.F4.8.m2.1.1.cmml" xref="S4.F4.8.m2.1.1"><times id="S4.F4.8.m2.1.1.1.cmml" xref="S4.F4.8.m2.1.1.1"></times><cn type="integer" id="S4.F4.8.m2.1.1.2.cmml" xref="S4.F4.8.m2.1.1.2">448</cn><cn type="integer" id="S4.F4.8.m2.1.1.3.cmml" xref="S4.F4.8.m2.1.1.3">448</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.8.m2.1d">448\times 448</annotation></semantics></math> respectively. The ERF images are smoothed with <math id="S4.F4.9.m3.1" class="ltx_Math" alttext="\sigma=4" display="inline"><semantics id="S4.F4.9.m3.1b"><mrow id="S4.F4.9.m3.1.1" xref="S4.F4.9.m3.1.1.cmml"><mi id="S4.F4.9.m3.1.1.2" xref="S4.F4.9.m3.1.1.2.cmml">σ</mi><mo id="S4.F4.9.m3.1.1.1" xref="S4.F4.9.m3.1.1.1.cmml">=</mo><mn id="S4.F4.9.m3.1.1.3" xref="S4.F4.9.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.9.m3.1c"><apply id="S4.F4.9.m3.1.1.cmml" xref="S4.F4.9.m3.1.1"><eq id="S4.F4.9.m3.1.1.1.cmml" xref="S4.F4.9.m3.1.1.1"></eq><ci id="S4.F4.9.m3.1.1.2.cmml" xref="S4.F4.9.m3.1.1.2">𝜎</ci><cn type="integer" id="S4.F4.9.m3.1.1.3.cmml" xref="S4.F4.9.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.9.m3.1d">\sigma=4</annotation></semantics></math> Gaussian kernels.</figcaption>
</figure>
<figure id="S4.T2" class="ltx_table">
<p id="S4.T2.1" class="ltx_p ltx_align_center"><span id="S4.T2.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S4.T2.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:390.3pt;height:428.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(23.2pt,-25.4pt) scale(1.13464418369047,1.13464418369047) ;">
<span id="S4.T2.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T2.1.1.1.1.1" class="ltx_tr">
<span id="S4.T2.1.1.1.1.1.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T2.1.1.1.1.1.2" class="ltx_td ltx_align_center">All</span>
<span id="S4.T2.1.1.1.1.1.3" class="ltx_td ltx_align_center">Exist</span>
<span id="S4.T2.1.1.1.1.1.4" class="ltx_td ltx_align_center">Count</span>
<span id="S4.T2.1.1.1.1.1.5" class="ltx_td ltx_align_center">CI</span>
<span id="S4.T2.1.1.1.1.1.6" class="ltx_td ltx_align_center">QA</span>
<span id="S4.T2.1.1.1.1.1.7" class="ltx_td ltx_align_center">CA</span></span>
<span id="S4.T2.1.1.1.1.2" class="ltx_tr">
<span id="S4.T2.1.1.1.1.2.1" class="ltx_td ltx_align_left"><span id="S4.T2.1.1.1.1.2.1.1" class="ltx_text ltx_font_typewriter">res5c</span></span>
<span id="S4.T2.1.1.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_6">CLEVR validation</span></span>
<span id="S4.T2.1.1.1.1.3" class="ltx_tr">
<span id="S4.T2.1.1.1.1.3.1" class="ltx_td ltx_align_left ltx_border_t">SM</span>
<span id="S4.T2.1.1.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">68.80</span>
<span id="S4.T2.1.1.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">73.20</span>
<span id="S4.T2.1.1.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">53.16</span>
<span id="S4.T2.1.1.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t">76.52</span>
<span id="S4.T2.1.1.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">81.58</span>
<span id="S4.T2.1.1.1.1.3.7" class="ltx_td ltx_align_center ltx_border_t">56.77</span></span>
<span id="S4.T2.1.1.1.1.4" class="ltx_tr">
<span id="S4.T2.1.1.1.1.4.1" class="ltx_td ltx_align_left">SIG</span>
<span id="S4.T2.1.1.1.1.4.2" class="ltx_td ltx_align_center">70.52</span>
<span id="S4.T2.1.1.1.1.4.3" class="ltx_td ltx_align_center">73.90</span>
<span id="S4.T2.1.1.1.1.4.4" class="ltx_td ltx_align_center">53.89</span>
<span id="S4.T2.1.1.1.1.4.5" class="ltx_td ltx_align_center">76.52</span>
<span id="S4.T2.1.1.1.1.4.6" class="ltx_td ltx_align_center">82.46</span>
<span id="S4.T2.1.1.1.1.4.7" class="ltx_td ltx_align_center">63.06</span></span>
<span id="S4.T2.1.1.1.1.5" class="ltx_tr">
<span id="S4.T2.1.1.1.1.5.1" class="ltx_td ltx_align_left">MF</span>
<span id="S4.T2.1.1.1.1.5.2" class="ltx_td ltx_align_center">73.14</span>
<span id="S4.T2.1.1.1.1.5.3" class="ltx_td ltx_align_center">76.46</span>
<span id="S4.T2.1.1.1.1.5.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.5.4.1" class="ltx_text ltx_font_bold">56.89</span></span>
<span id="S4.T2.1.1.1.1.5.5" class="ltx_td ltx_align_center">77.43</span>
<span id="S4.T2.1.1.1.1.5.6" class="ltx_td ltx_align_center">83.72</span>
<span id="S4.T2.1.1.1.1.5.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.5.7.1" class="ltx_text ltx_font_bold">68.76</span></span></span>
<span id="S4.T2.1.1.1.1.6" class="ltx_tr">
<span id="S4.T2.1.1.1.1.6.1" class="ltx_td ltx_align_left">LBP</span>
<span id="S4.T2.1.1.1.1.6.2" class="ltx_td ltx_align_center">72.30</span>
<span id="S4.T2.1.1.1.1.6.3" class="ltx_td ltx_align_center">76.32</span>
<span id="S4.T2.1.1.1.1.6.4" class="ltx_td ltx_align_center">54.92</span>
<span id="S4.T2.1.1.1.1.6.5" class="ltx_td ltx_align_center">77.50</span>
<span id="S4.T2.1.1.1.1.6.6" class="ltx_td ltx_align_center">83.35</span>
<span id="S4.T2.1.1.1.1.6.7" class="ltx_td ltx_align_center">67.54</span></span>
<span id="S4.T2.1.1.1.1.7" class="ltx_tr">
<span id="S4.T2.1.1.1.1.7.1" class="ltx_td ltx_align_left">MF-SIG</span>
<span id="S4.T2.1.1.1.1.7.2" class="ltx_td ltx_align_center">73.19</span>
<span id="S4.T2.1.1.1.1.7.3" class="ltx_td ltx_align_center">76.53</span>
<span id="S4.T2.1.1.1.1.7.4" class="ltx_td ltx_align_center">56.22</span>
<span id="S4.T2.1.1.1.1.7.5" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.7.5.1" class="ltx_text ltx_font_bold">78.56</span></span>
<span id="S4.T2.1.1.1.1.7.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.7.6.1" class="ltx_text ltx_font_bold">84.23</span></span>
<span id="S4.T2.1.1.1.1.7.7" class="ltx_td ltx_align_center">68.34</span></span>
<span id="S4.T2.1.1.1.1.8" class="ltx_tr">
<span id="S4.T2.1.1.1.1.8.1" class="ltx_td ltx_align_left">LBP-SIG</span>
<span id="S4.T2.1.1.1.1.8.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.8.2.1" class="ltx_text ltx_font_bold">73.33</span></span>
<span id="S4.T2.1.1.1.1.8.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.8.3.1" class="ltx_text ltx_font_bold">77.50</span></span>
<span id="S4.T2.1.1.1.1.8.4" class="ltx_td ltx_align_center">56.39</span>
<span id="S4.T2.1.1.1.1.8.5" class="ltx_td ltx_align_center">77.97</span>
<span id="S4.T2.1.1.1.1.8.6" class="ltx_td ltx_align_center">84.09</span>
<span id="S4.T2.1.1.1.1.8.7" class="ltx_td ltx_align_center">68.70</span></span>
<span id="S4.T2.1.1.1.1.9" class="ltx_tr">
<span id="S4.T2.1.1.1.1.9.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.1.9.1.1" class="ltx_text ltx_font_typewriter">res4b22</span></span>
<span id="S4.T2.1.1.1.1.9.2" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_6">CLEVR validation</span></span>
<span id="S4.T2.1.1.1.1.10" class="ltx_tr">
<span id="S4.T2.1.1.1.1.10.1" class="ltx_td ltx_align_left ltx_border_t">SM</span>
<span id="S4.T2.1.1.1.1.10.2" class="ltx_td ltx_align_center ltx_border_t">75.63</span>
<span id="S4.T2.1.1.1.1.10.3" class="ltx_td ltx_align_center ltx_border_t">77.69</span>
<span id="S4.T2.1.1.1.1.10.4" class="ltx_td ltx_align_center ltx_border_t">57.79</span>
<span id="S4.T2.1.1.1.1.10.5" class="ltx_td ltx_align_center ltx_border_t">78.63</span>
<span id="S4.T2.1.1.1.1.10.6" class="ltx_td ltx_align_center ltx_border_t">87.76</span>
<span id="S4.T2.1.1.1.1.10.7" class="ltx_td ltx_align_center ltx_border_t">71.83</span></span>
<span id="S4.T2.1.1.1.1.11" class="ltx_tr">
<span id="S4.T2.1.1.1.1.11.1" class="ltx_td ltx_align_left">SIG</span>
<span id="S4.T2.1.1.1.1.11.2" class="ltx_td ltx_align_center">75.32</span>
<span id="S4.T2.1.1.1.1.11.3" class="ltx_td ltx_align_center">76.54</span>
<span id="S4.T2.1.1.1.1.11.4" class="ltx_td ltx_align_center">58.93</span>
<span id="S4.T2.1.1.1.1.11.5" class="ltx_td ltx_align_center">78.12</span>
<span id="S4.T2.1.1.1.1.11.6" class="ltx_td ltx_align_center">87.94</span>
<span id="S4.T2.1.1.1.1.11.7" class="ltx_td ltx_align_center">69.38</span></span>
<span id="S4.T2.1.1.1.1.12" class="ltx_tr">
<span id="S4.T2.1.1.1.1.12.1" class="ltx_td ltx_align_left">MF</span>
<span id="S4.T2.1.1.1.1.12.2" class="ltx_td ltx_align_center">76.65</span>
<span id="S4.T2.1.1.1.1.12.3" class="ltx_td ltx_align_center">77.90</span>
<span id="S4.T2.1.1.1.1.12.4" class="ltx_td ltx_align_center">58.87</span>
<span id="S4.T2.1.1.1.1.12.5" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.12.5.1" class="ltx_text ltx_font_bold">80.48</span></span>
<span id="S4.T2.1.1.1.1.12.6" class="ltx_td ltx_align_center">88.10</span>
<span id="S4.T2.1.1.1.1.12.7" class="ltx_td ltx_align_center">74.34</span></span>
<span id="S4.T2.1.1.1.1.13" class="ltx_tr">
<span id="S4.T2.1.1.1.1.13.1" class="ltx_td ltx_align_left">LBP</span>
<span id="S4.T2.1.1.1.1.13.2" class="ltx_td ltx_align_center">76.21</span>
<span id="S4.T2.1.1.1.1.13.3" class="ltx_td ltx_align_center">78.97</span>
<span id="S4.T2.1.1.1.1.13.4" class="ltx_td ltx_align_center">57.52</span>
<span id="S4.T2.1.1.1.1.13.5" class="ltx_td ltx_align_center">80.14</span>
<span id="S4.T2.1.1.1.1.13.6" class="ltx_td ltx_align_center">87.90</span>
<span id="S4.T2.1.1.1.1.13.7" class="ltx_td ltx_align_center">73.43</span></span>
<span id="S4.T2.1.1.1.1.14" class="ltx_tr">
<span id="S4.T2.1.1.1.1.14.1" class="ltx_td ltx_align_left">MF-SIG</span>
<span id="S4.T2.1.1.1.1.14.2" class="ltx_td ltx_align_center">77.4</span>
<span id="S4.T2.1.1.1.1.14.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.14.3.1" class="ltx_text ltx_font_bold">79.8</span></span>
<span id="S4.T2.1.1.1.1.14.4" class="ltx_td ltx_align_center">61.0</span>
<span id="S4.T2.1.1.1.1.14.5" class="ltx_td ltx_align_center">79.3</span>
<span id="S4.T2.1.1.1.1.14.6" class="ltx_td ltx_align_center">88.0</span>
<span id="S4.T2.1.1.1.1.14.7" class="ltx_td ltx_align_center">75.1</span></span>
<span id="S4.T2.1.1.1.1.15" class="ltx_tr">
<span id="S4.T2.1.1.1.1.15.1" class="ltx_td ltx_align_left">LBP-SIG</span>
<span id="S4.T2.1.1.1.1.15.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.15.2.1" class="ltx_text ltx_font_bold">77.97</span></span>
<span id="S4.T2.1.1.1.1.15.3" class="ltx_td ltx_align_center">79.7</span>
<span id="S4.T2.1.1.1.1.15.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.15.4.1" class="ltx_text ltx_font_bold">61.39</span></span>
<span id="S4.T2.1.1.1.1.15.5" class="ltx_td ltx_align_center">80.17</span>
<span id="S4.T2.1.1.1.1.15.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.15.6.1" class="ltx_text ltx_font_bold">88.54</span></span>
<span id="S4.T2.1.1.1.1.15.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.15.7.1" class="ltx_text ltx_font_bold">76.31</span></span></span>
<span id="S4.T2.1.1.1.1.16" class="ltx_tr">
<span id="S4.T2.1.1.1.1.16.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T2.1.1.1.1.16.1.1" class="ltx_text ltx_font_typewriter">res4b22</span></span>
<span id="S4.T2.1.1.1.1.16.2" class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_6">CLEVR test</span></span>
<span id="S4.T2.1.1.1.1.17" class="ltx_tr">
<span id="S4.T2.1.1.1.1.17.1" class="ltx_td ltx_align_left ltx_border_t">MCB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite></span>
<span id="S4.T2.1.1.1.1.17.2" class="ltx_td ltx_align_center ltx_border_t">51.4</span>
<span id="S4.T2.1.1.1.1.17.3" class="ltx_td ltx_align_center ltx_border_t">63.4</span>
<span id="S4.T2.1.1.1.1.17.4" class="ltx_td ltx_align_center ltx_border_t">42.1</span>
<span id="S4.T2.1.1.1.1.17.5" class="ltx_td ltx_align_center ltx_border_t">63.3</span>
<span id="S4.T2.1.1.1.1.17.6" class="ltx_td ltx_align_center ltx_border_t">49.0</span>
<span id="S4.T2.1.1.1.1.17.7" class="ltx_td ltx_align_center ltx_border_t">60.0</span></span>
<span id="S4.T2.1.1.1.1.18" class="ltx_tr">
<span id="S4.T2.1.1.1.1.18.1" class="ltx_td ltx_align_left">SAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite></span>
<span id="S4.T2.1.1.1.1.18.2" class="ltx_td ltx_align_center">68.5</span>
<span id="S4.T2.1.1.1.1.18.3" class="ltx_td ltx_align_center">71.1</span>
<span id="S4.T2.1.1.1.1.18.4" class="ltx_td ltx_align_center">52.2</span>
<span id="S4.T2.1.1.1.1.18.5" class="ltx_td ltx_align_center">73.5</span>
<span id="S4.T2.1.1.1.1.18.6" class="ltx_td ltx_align_center">85.2</span>
<span id="S4.T2.1.1.1.1.18.7" class="ltx_td ltx_align_center">52.2</span></span>
<span id="S4.T2.1.1.1.1.19" class="ltx_tr">
<span id="S4.T2.1.1.1.1.19.1" class="ltx_td ltx_align_left">MF-SIG</span>
<span id="S4.T2.1.1.1.1.19.2" class="ltx_td ltx_align_center">77.57</span>
<span id="S4.T2.1.1.1.1.19.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.19.3.1" class="ltx_text ltx_font_bold">80.05</span></span>
<span id="S4.T2.1.1.1.1.19.4" class="ltx_td ltx_align_center">60.69</span>
<span id="S4.T2.1.1.1.1.19.5" class="ltx_td ltx_align_center">80.08</span>
<span id="S4.T2.1.1.1.1.19.6" class="ltx_td ltx_align_center">88.16</span>
<span id="S4.T2.1.1.1.1.19.7" class="ltx_td ltx_align_center">75.27</span></span>
<span id="S4.T2.1.1.1.1.20" class="ltx_tr">
<span id="S4.T2.1.1.1.1.20.1" class="ltx_td ltx_align_left">LBP-SIG</span>
<span id="S4.T2.1.1.1.1.20.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.20.2.1" class="ltx_text ltx_font_bold">78.04</span></span>
<span id="S4.T2.1.1.1.1.20.3" class="ltx_td ltx_align_center">79.63</span>
<span id="S4.T2.1.1.1.1.20.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.20.4.1" class="ltx_text ltx_font_bold">61.27</span></span>
<span id="S4.T2.1.1.1.1.20.5" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.20.5.1" class="ltx_text ltx_font_bold">80.69</span></span>
<span id="S4.T2.1.1.1.1.20.6" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.20.6.1" class="ltx_text ltx_font_bold">88.59</span></span>
<span id="S4.T2.1.1.1.1.20.7" class="ltx_td ltx_align_center"><span id="S4.T2.1.1.1.1.20.7.1" class="ltx_text ltx_font_bold">76.28</span></span></span>
<span id="S4.T2.1.1.1.1.21" class="ltx_tr">
<span id="S4.T2.1.1.1.1.21.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T2.1.1.1.1.21.2" class="ltx_td"></span>
<span id="S4.T2.1.1.1.1.21.3" class="ltx_td"></span>
<span id="S4.T2.1.1.1.1.21.4" class="ltx_td"></span>
<span id="S4.T2.1.1.1.1.21.5" class="ltx_td"></span>
<span id="S4.T2.1.1.1.1.21.6" class="ltx_td"></span>
<span id="S4.T2.1.1.1.1.21.7" class="ltx_td"></span></span>
</span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S4.T2.3.1" class="ltx_text" style="font-size:90%;">Accuracy on CLEVR. CI, QA, CA stand for Count Integer, Query Attribute and Compare Attribute respectively. The top half uses ResNet-152 features and the bottom half uses ResNet-101 features. Our best model uses the same visual feature as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. </span></figcaption>
</figure>
<figure id="S4.T3" class="ltx_table">
<p id="S4.T3.1" class="ltx_p ltx_align_center"><span id="S4.T3.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S4.T3.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:294.9pt;height:301.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-11.0pt,11.3pt) scale(0.930436088929506,0.930436088929506) ;">
<span id="S4.T3.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T3.1.1.1.1.1" class="ltx_tr">
<span id="S4.T3.1.1.1.1.1.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>
Model</span>
<span id="S4.T3.1.1.1.1.1.2" class="ltx_td ltx_align_center">All</span>
<span id="S4.T3.1.1.1.1.1.3" class="ltx_td ltx_align_center">Y/N</span>
<span id="S4.T3.1.1.1.1.1.4" class="ltx_td ltx_align_center">No.</span>
<span id="S4.T3.1.1.1.1.1.5" class="ltx_td ltx_align_center">Other</span></span>
<span id="S4.T3.1.1.1.1.2" class="ltx_tr">
<span id="S4.T3.1.1.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t">MCB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite></span>
<span id="S4.T3.1.1.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">64.7</span>
<span id="S4.T3.1.1.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">82.5</span>
<span id="S4.T3.1.1.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">37.6</span>
<span id="S4.T3.1.1.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">55.6</span></span>
<span id="S4.T3.1.1.1.1.3" class="ltx_tr">
<span id="S4.T3.1.1.1.1.3.1" class="ltx_td ltx_align_left">MLB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></span>
<span id="S4.T3.1.1.1.1.3.2" class="ltx_td ltx_align_center">65.08</span>
<span id="S4.T3.1.1.1.1.3.3" class="ltx_td ltx_align_center">84.14</span>
<span id="S4.T3.1.1.1.1.3.4" class="ltx_td ltx_align_center">38.21</span>
<span id="S4.T3.1.1.1.1.3.5" class="ltx_td ltx_align_center">54.87</span></span>
<span id="S4.T3.1.1.1.1.4" class="ltx_tr">
<span id="S4.T3.1.1.1.1.4.1" class="ltx_td ltx_align_left ltx_border_t">MF-SIG-T1</span>
<span id="S4.T3.1.1.1.1.4.2" class="ltx_td ltx_align_center ltx_border_t">65.90</span>
<span id="S4.T3.1.1.1.1.4.3" class="ltx_td ltx_align_center ltx_border_t">84.22</span>
<span id="S4.T3.1.1.1.1.4.4" class="ltx_td ltx_align_center ltx_border_t">39.51</span>
<span id="S4.T3.1.1.1.1.4.5" class="ltx_td ltx_align_center ltx_border_t">56.22</span></span>
<span id="S4.T3.1.1.1.1.5" class="ltx_tr">
<span id="S4.T3.1.1.1.1.5.1" class="ltx_td ltx_align_left">MF-SIG-T2</span>
<span id="S4.T3.1.1.1.1.5.2" class="ltx_td ltx_align_center">65.89</span>
<span id="S4.T3.1.1.1.1.5.3" class="ltx_td ltx_align_center">84.21</span>
<span id="S4.T3.1.1.1.1.5.4" class="ltx_td ltx_align_center">39.57</span>
<span id="S4.T3.1.1.1.1.5.5" class="ltx_td ltx_align_center">56.20</span></span>
<span id="S4.T3.1.1.1.1.6" class="ltx_tr">
<span id="S4.T3.1.1.1.1.6.1" class="ltx_td ltx_align_left">MF-SIG-T3</span>
<span id="S4.T3.1.1.1.1.6.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.6.2.1" class="ltx_text ltx_font_bold">66.00</span></span>
<span id="S4.T3.1.1.1.1.6.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.6.3.1" class="ltx_text ltx_font_bold">84.33</span></span>
<span id="S4.T3.1.1.1.1.6.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.6.4.1" class="ltx_text ltx_font_bold">39.34</span></span>
<span id="S4.T3.1.1.1.1.6.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.6.5.1" class="ltx_text ltx_font_bold">56.37</span></span></span>
<span id="S4.T3.1.1.1.1.7" class="ltx_tr">
<span id="S4.T3.1.1.1.1.7.1" class="ltx_td ltx_align_left">MF-SIG-T4</span>
<span id="S4.T3.1.1.1.1.7.2" class="ltx_td ltx_align_center">65.81</span>
<span id="S4.T3.1.1.1.1.7.3" class="ltx_td ltx_align_center">84.22</span>
<span id="S4.T3.1.1.1.1.7.4" class="ltx_td ltx_align_center">38.96</span>
<span id="S4.T3.1.1.1.1.7.5" class="ltx_td ltx_align_center">56.16</span></span>
<span id="S4.T3.1.1.1.1.8" class="ltx_tr">
<span id="S4.T3.1.1.1.1.8.1" class="ltx_td ltx_align_left">LBP-SIG-T1</span>
<span id="S4.T3.1.1.1.1.8.2" class="ltx_td ltx_align_center">65.93</span>
<span id="S4.T3.1.1.1.1.8.3" class="ltx_td ltx_align_center">84.31</span>
<span id="S4.T3.1.1.1.1.8.4" class="ltx_td ltx_align_center">39.27</span>
<span id="S4.T3.1.1.1.1.8.5" class="ltx_td ltx_align_center">56.26</span></span>
<span id="S4.T3.1.1.1.1.9" class="ltx_tr">
<span id="S4.T3.1.1.1.1.9.1" class="ltx_td ltx_align_left">LBP-SIG-T2</span>
<span id="S4.T3.1.1.1.1.9.2" class="ltx_td ltx_align_center">65.90</span>
<span id="S4.T3.1.1.1.1.9.3" class="ltx_td ltx_align_center">84.23</span>
<span id="S4.T3.1.1.1.1.9.4" class="ltx_td ltx_align_center">39.70</span>
<span id="S4.T3.1.1.1.1.9.5" class="ltx_td ltx_align_center">56.16</span></span>
<span id="S4.T3.1.1.1.1.10" class="ltx_tr">
<span id="S4.T3.1.1.1.1.10.1" class="ltx_td ltx_align_left">LBP-SIG-T3</span>
<span id="S4.T3.1.1.1.1.10.2" class="ltx_td ltx_align_center">65.81</span>
<span id="S4.T3.1.1.1.1.10.3" class="ltx_td ltx_align_center">84.05</span>
<span id="S4.T3.1.1.1.1.10.4" class="ltx_td ltx_align_center">39.76</span>
<span id="S4.T3.1.1.1.1.10.5" class="ltx_td ltx_align_center">56.12</span></span>
<span id="S4.T3.1.1.1.1.11" class="ltx_tr">
<span id="S4.T3.1.1.1.1.11.1" class="ltx_td ltx_align_left">LBP-SIG-T4</span>
<span id="S4.T3.1.1.1.1.11.2" class="ltx_td ltx_align_center">65.73</span>
<span id="S4.T3.1.1.1.1.11.3" class="ltx_td ltx_align_center">84.08</span>
<span id="S4.T3.1.1.1.1.11.4" class="ltx_td ltx_align_center">38.87</span>
<span id="S4.T3.1.1.1.1.11.5" class="ltx_td ltx_align_center">56.13</span></span>
<span id="S4.T3.1.1.1.1.12" class="ltx_tr">
<span id="S4.T3.1.1.1.1.12.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>
MCB+VG<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite></span>
<span id="S4.T3.1.1.1.1.12.2" class="ltx_td ltx_align_center">65.4</span>
<span id="S4.T3.1.1.1.1.12.3" class="ltx_td ltx_align_center">82.3</span>
<span id="S4.T3.1.1.1.1.12.4" class="ltx_td ltx_align_center">37.2</span>
<span id="S4.T3.1.1.1.1.12.5" class="ltx_td ltx_align_center">57.4</span></span>
<span id="S4.T3.1.1.1.1.13" class="ltx_tr">
<span id="S4.T3.1.1.1.1.13.1" class="ltx_td ltx_align_left">MLB+VG<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></span>
<span id="S4.T3.1.1.1.1.13.2" class="ltx_td ltx_align_center">65.84</span>
<span id="S4.T3.1.1.1.1.13.3" class="ltx_td ltx_align_center">83.87</span>
<span id="S4.T3.1.1.1.1.13.4" class="ltx_td ltx_align_center">37.87</span>
<span id="S4.T3.1.1.1.1.13.5" class="ltx_td ltx_align_center">56.76</span></span>
<span id="S4.T3.1.1.1.1.14" class="ltx_tr">
<span id="S4.T3.1.1.1.1.14.1" class="ltx_td ltx_align_left ltx_border_t">MF+VG</span>
<span id="S4.T3.1.1.1.1.14.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.1.14.2.1" class="ltx_text ltx_font_bold">67.17</span></span>
<span id="S4.T3.1.1.1.1.14.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.1.14.3.1" class="ltx_text ltx_font_bold">84.77</span></span>
<span id="S4.T3.1.1.1.1.14.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.1.14.4.1" class="ltx_text ltx_font_bold">39.71</span></span>
<span id="S4.T3.1.1.1.1.14.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.1.1.1.1.14.5.1" class="ltx_text ltx_font_bold">58.34</span></span></span>
<span id="S4.T3.1.1.1.1.15" class="ltx_tr">
<span id="S4.T3.1.1.1.1.15.1" class="ltx_td ltx_align_left">MF-SIG+VG</span>
<span id="S4.T3.1.1.1.1.15.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.15.2.1" class="ltx_text ltx_font_bold">67.19</span></span>
<span id="S4.T3.1.1.1.1.15.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.15.3.1" class="ltx_text ltx_font_bold">84.71</span></span>
<span id="S4.T3.1.1.1.1.15.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.15.4.1" class="ltx_text ltx_font_bold">40.58</span></span>
<span id="S4.T3.1.1.1.1.15.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.15.5.1" class="ltx_text ltx_font_bold">58.24</span></span></span>
<span id="S4.T3.1.1.1.1.16" class="ltx_tr">
<span id="S4.T3.1.1.1.1.16.1" class="ltx_td ltx_align_left ltx_colspan ltx_colspan_4"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>     On <span id="S4.T3.1.1.1.1.16.1.1" class="ltx_text ltx_font_typewriter">test-dev2017</span> of VQA2.0</span>
<span id="S4.T3.1.1.1.1.16.2" class="ltx_td"></span></span>
<span id="S4.T3.1.1.1.1.17" class="ltx_tr">
<span id="S4.T3.1.1.1.1.17.1" class="ltx_td ltx_align_left ltx_border_t">MF-SIG+VG</span>
<span id="S4.T3.1.1.1.1.17.2" class="ltx_td ltx_align_center ltx_border_t">64.73</span>
<span id="S4.T3.1.1.1.1.17.3" class="ltx_td ltx_align_center ltx_border_t">81.29</span>
<span id="S4.T3.1.1.1.1.17.4" class="ltx_td ltx_align_center ltx_border_t">42.99</span>
<span id="S4.T3.1.1.1.1.17.5" class="ltx_td ltx_align_center ltx_border_t">55.55</span></span>
<span id="S4.T3.1.1.1.1.18" class="ltx_tr">
<span id="S4.T3.1.1.1.1.18.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T3.1.1.1.1.18.2" class="ltx_td"></span>
<span id="S4.T3.1.1.1.1.18.3" class="ltx_td"></span>
<span id="S4.T3.1.1.1.1.18.4" class="ltx_td"></span>
<span id="S4.T3.1.1.1.1.18.5" class="ltx_td"></span></span>
</span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Results of the Open Ended task on <span id="S4.T3.3.1" class="ltx_text ltx_font_typewriter">test-dev</span>.</figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<p id="S4.T4.1" class="ltx_p ltx_align_center"><span id="S4.T4.1.1" class="ltx_text ltx_inline-block" style="width:433.6pt;">
<span id="S4.T4.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:385.9pt;height:437.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(26.3pt,-29.8pt) scale(1.15756943012903,1.15756943012903) ;">
<span id="S4.T4.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S4.T4.1.1.1.1.1" class="ltx_tr">
<span id="S4.T4.1.1.1.1.1.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T4.1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_colspan ltx_colspan_4">Open Ended</span>
<span id="S4.T4.1.1.1.1.1.3" class="ltx_td ltx_align_center">MC</span></span>
<span id="S4.T4.1.1.1.1.2" class="ltx_tr">
<span id="S4.T4.1.1.1.1.2.1" class="ltx_td ltx_align_left">Single Model</span>
<span id="S4.T4.1.1.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">All</span>
<span id="S4.T4.1.1.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">Y/N</span>
<span id="S4.T4.1.1.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">No.</span>
<span id="S4.T4.1.1.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">Other</span>
<span id="S4.T4.1.1.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">All</span></span>
<span id="S4.T4.1.1.1.1.3" class="ltx_tr">
<span id="S4.T4.1.1.1.1.3.1" class="ltx_td ltx_align_left ltx_border_t">SMem<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite></span>
<span id="S4.T4.1.1.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">58.24</span>
<span id="S4.T4.1.1.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">80.8</span>
<span id="S4.T4.1.1.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">37.53</span>
<span id="S4.T4.1.1.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t">43.48</span>
<span id="S4.T4.1.1.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">-</span></span>
<span id="S4.T4.1.1.1.1.4" class="ltx_tr">
<span id="S4.T4.1.1.1.1.4.1" class="ltx_td ltx_align_left">SAN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite></span>
<span id="S4.T4.1.1.1.1.4.2" class="ltx_td ltx_align_center">58.85</span>
<span id="S4.T4.1.1.1.1.4.3" class="ltx_td ltx_align_center">79.11</span>
<span id="S4.T4.1.1.1.1.4.4" class="ltx_td ltx_align_center">36.41</span>
<span id="S4.T4.1.1.1.1.4.5" class="ltx_td ltx_align_center">46.42</span>
<span id="S4.T4.1.1.1.1.4.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T4.1.1.1.1.5" class="ltx_tr">
<span id="S4.T4.1.1.1.1.5.1" class="ltx_td ltx_align_left">D-NMN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite></span>
<span id="S4.T4.1.1.1.1.5.2" class="ltx_td ltx_align_center">59.4</span>
<span id="S4.T4.1.1.1.1.5.3" class="ltx_td ltx_align_center">81.1</span>
<span id="S4.T4.1.1.1.1.5.4" class="ltx_td ltx_align_center">38.6</span>
<span id="S4.T4.1.1.1.1.5.5" class="ltx_td ltx_align_center">45.5</span>
<span id="S4.T4.1.1.1.1.5.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T4.1.1.1.1.6" class="ltx_tr">
<span id="S4.T4.1.1.1.1.6.1" class="ltx_td ltx_align_left">ACK<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite></span>
<span id="S4.T4.1.1.1.1.6.2" class="ltx_td ltx_align_center">59.44</span>
<span id="S4.T4.1.1.1.1.6.3" class="ltx_td ltx_align_center">81.07</span>
<span id="S4.T4.1.1.1.1.6.4" class="ltx_td ltx_align_center">37.12</span>
<span id="S4.T4.1.1.1.1.6.5" class="ltx_td ltx_align_center">45.83</span>
<span id="S4.T4.1.1.1.1.6.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T4.1.1.1.1.7" class="ltx_tr">
<span id="S4.T4.1.1.1.1.7.1" class="ltx_td ltx_align_left">FDA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></span>
<span id="S4.T4.1.1.1.1.7.2" class="ltx_td ltx_align_center">59.54</span>
<span id="S4.T4.1.1.1.1.7.3" class="ltx_td ltx_align_center">81.34</span>
<span id="S4.T4.1.1.1.1.7.4" class="ltx_td ltx_align_center">35.67</span>
<span id="S4.T4.1.1.1.1.7.5" class="ltx_td ltx_align_center">46.10</span>
<span id="S4.T4.1.1.1.1.7.6" class="ltx_td ltx_align_center">64.18</span></span>
<span id="S4.T4.1.1.1.1.8" class="ltx_tr">
<span id="S4.T4.1.1.1.1.8.1" class="ltx_td ltx_align_left">QRU<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite></span>
<span id="S4.T4.1.1.1.1.8.2" class="ltx_td ltx_align_center">60.76</span>
<span id="S4.T4.1.1.1.1.8.3" class="ltx_td ltx_align_center">-</span>
<span id="S4.T4.1.1.1.1.8.4" class="ltx_td ltx_align_center">-</span>
<span id="S4.T4.1.1.1.1.8.5" class="ltx_td ltx_align_center">-</span>
<span id="S4.T4.1.1.1.1.8.6" class="ltx_td ltx_align_center">65.43</span></span>
<span id="S4.T4.1.1.1.1.9" class="ltx_tr">
<span id="S4.T4.1.1.1.1.9.1" class="ltx_td ltx_align_left">HYBRID<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></span>
<span id="S4.T4.1.1.1.1.9.2" class="ltx_td ltx_align_center">60.06</span>
<span id="S4.T4.1.1.1.1.9.3" class="ltx_td ltx_align_center">80.34</span>
<span id="S4.T4.1.1.1.1.9.4" class="ltx_td ltx_align_center">37.82</span>
<span id="S4.T4.1.1.1.1.9.5" class="ltx_td ltx_align_center">47.56</span>
<span id="S4.T4.1.1.1.1.9.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T4.1.1.1.1.10" class="ltx_tr">
<span id="S4.T4.1.1.1.1.10.1" class="ltx_td ltx_align_left">DMN+<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite></span>
<span id="S4.T4.1.1.1.1.10.2" class="ltx_td ltx_align_center">60.36</span>
<span id="S4.T4.1.1.1.1.10.3" class="ltx_td ltx_align_center">80.43</span>
<span id="S4.T4.1.1.1.1.10.4" class="ltx_td ltx_align_center">36.82</span>
<span id="S4.T4.1.1.1.1.10.5" class="ltx_td ltx_align_center">48.33</span>
<span id="S4.T4.1.1.1.1.10.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T4.1.1.1.1.11" class="ltx_tr">
<span id="S4.T4.1.1.1.1.11.1" class="ltx_td ltx_align_left">MRN<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite></span>
<span id="S4.T4.1.1.1.1.11.2" class="ltx_td ltx_align_center">61.84</span>
<span id="S4.T4.1.1.1.1.11.3" class="ltx_td ltx_align_center">82.39</span>
<span id="S4.T4.1.1.1.1.11.4" class="ltx_td ltx_align_center">38.23</span>
<span id="S4.T4.1.1.1.1.11.5" class="ltx_td ltx_align_center">49.41</span>
<span id="S4.T4.1.1.1.1.11.6" class="ltx_td ltx_align_center">66.33</span></span>
<span id="S4.T4.1.1.1.1.12" class="ltx_tr">
<span id="S4.T4.1.1.1.1.12.1" class="ltx_td ltx_align_left">HieCoAtt<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite></span>
<span id="S4.T4.1.1.1.1.12.2" class="ltx_td ltx_align_center">62.06</span>
<span id="S4.T4.1.1.1.1.12.3" class="ltx_td ltx_align_center">79.95</span>
<span id="S4.T4.1.1.1.1.12.4" class="ltx_td ltx_align_center">38.22</span>
<span id="S4.T4.1.1.1.1.12.5" class="ltx_td ltx_align_center">51.95</span>
<span id="S4.T4.1.1.1.1.12.6" class="ltx_td ltx_align_center">66.07</span></span>
<span id="S4.T4.1.1.1.1.13" class="ltx_tr">
<span id="S4.T4.1.1.1.1.13.1" class="ltx_td ltx_align_left">RAU<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite></span>
<span id="S4.T4.1.1.1.1.13.2" class="ltx_td ltx_align_center">63.2</span>
<span id="S4.T4.1.1.1.1.13.3" class="ltx_td ltx_align_center">81.7</span>
<span id="S4.T4.1.1.1.1.13.4" class="ltx_td ltx_align_center">38.2</span>
<span id="S4.T4.1.1.1.1.13.5" class="ltx_td ltx_align_center">52.8</span>
<span id="S4.T4.1.1.1.1.13.6" class="ltx_td ltx_align_center">67.3</span></span>
<span id="S4.T4.1.1.1.1.14" class="ltx_tr">
<span id="S4.T4.1.1.1.1.14.1" class="ltx_td ltx_align_left">MLB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></span>
<span id="S4.T4.1.1.1.1.14.2" class="ltx_td ltx_align_center">65.07</span>
<span id="S4.T4.1.1.1.1.14.3" class="ltx_td ltx_align_center">84.02</span>
<span id="S4.T4.1.1.1.1.14.4" class="ltx_td ltx_align_center">37.90</span>
<span id="S4.T4.1.1.1.1.14.5" class="ltx_td ltx_align_center">54.77</span>
<span id="S4.T4.1.1.1.1.14.6" class="ltx_td ltx_align_center">68.89</span></span>
<span id="S4.T4.1.1.1.1.15" class="ltx_tr">
<span id="S4.T4.1.1.1.1.15.1" class="ltx_td ltx_align_left ltx_border_t">MF-SIG-T3</span>
<span id="S4.T4.1.1.1.1.15.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.15.2.1" class="ltx_text ltx_font_bold">65.88</span></span>
<span id="S4.T4.1.1.1.1.15.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.15.3.1" class="ltx_text ltx_font_bold">84.42</span></span>
<span id="S4.T4.1.1.1.1.15.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.15.4.1" class="ltx_text ltx_font_bold">38.94</span></span>
<span id="S4.T4.1.1.1.1.15.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.15.5.1" class="ltx_text ltx_font_bold">55.89</span></span>
<span id="S4.T4.1.1.1.1.15.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.15.6.1" class="ltx_text ltx_font_bold">70.33</span></span></span>
<span id="S4.T4.1.1.1.1.16" class="ltx_tr">
<span id="S4.T4.1.1.1.1.16.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span>
Ensemble Model</span>
<span id="S4.T4.1.1.1.1.16.2" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.16.3" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.16.4" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.16.5" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.16.6" class="ltx_td"></span></span>
<span id="S4.T4.1.1.1.1.17" class="ltx_tr">
<span id="S4.T4.1.1.1.1.17.1" class="ltx_td ltx_align_left ltx_border_t">MCB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite></span>
<span id="S4.T4.1.1.1.1.17.2" class="ltx_td ltx_align_center ltx_border_t">66.47</span>
<span id="S4.T4.1.1.1.1.17.3" class="ltx_td ltx_align_center ltx_border_t">83.24</span>
<span id="S4.T4.1.1.1.1.17.4" class="ltx_td ltx_align_center ltx_border_t">39.47</span>
<span id="S4.T4.1.1.1.1.17.5" class="ltx_td ltx_align_center ltx_border_t">58.00</span>
<span id="S4.T4.1.1.1.1.17.6" class="ltx_td ltx_align_center ltx_border_t">70.10</span></span>
<span id="S4.T4.1.1.1.1.18" class="ltx_tr">
<span id="S4.T4.1.1.1.1.18.1" class="ltx_td ltx_align_left">MLB<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite></span>
<span id="S4.T4.1.1.1.1.18.2" class="ltx_td ltx_align_center">66.89</span>
<span id="S4.T4.1.1.1.1.18.3" class="ltx_td ltx_align_center">84.61</span>
<span id="S4.T4.1.1.1.1.18.4" class="ltx_td ltx_align_center">39.07</span>
<span id="S4.T4.1.1.1.1.18.5" class="ltx_td ltx_align_center">57.79</span>
<span id="S4.T4.1.1.1.1.18.6" class="ltx_td ltx_align_center">70.29</span></span>
<span id="S4.T4.1.1.1.1.19" class="ltx_tr">
<span id="S4.T4.1.1.1.1.19.1" class="ltx_td ltx_align_left ltx_border_t">Ours</span>
<span id="S4.T4.1.1.1.1.19.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.19.2.1" class="ltx_text ltx_font_bold">68.14</span></span>
<span id="S4.T4.1.1.1.1.19.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.19.3.1" class="ltx_text ltx_font_bold">85.41</span></span>
<span id="S4.T4.1.1.1.1.19.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.19.4.1" class="ltx_text ltx_font_bold">40.99</span></span>
<span id="S4.T4.1.1.1.1.19.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.19.5.1" class="ltx_text ltx_font_bold">59.27</span></span>
<span id="S4.T4.1.1.1.1.19.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T4.1.1.1.1.19.6.1" class="ltx_text ltx_font_bold">72.08</span></span></span>
<span id="S4.T4.1.1.1.1.20" class="ltx_tr">
<span id="S4.T4.1.1.1.1.20.1" class="ltx_td ltx_align_left">Ours <span id="S4.T4.1.1.1.1.20.1.1" class="ltx_text ltx_font_typewriter">test2017</span></span>
<span id="S4.T4.1.1.1.1.20.2" class="ltx_td ltx_align_center">65.84</span>
<span id="S4.T4.1.1.1.1.20.3" class="ltx_td ltx_align_center">81.85</span>
<span id="S4.T4.1.1.1.1.20.4" class="ltx_td ltx_align_center">43.64</span>
<span id="S4.T4.1.1.1.1.20.5" class="ltx_td ltx_align_center">57.07</span>
<span id="S4.T4.1.1.1.1.20.6" class="ltx_td ltx_align_center">-</span></span>
<span id="S4.T4.1.1.1.1.21" class="ltx_tr">
<span id="S4.T4.1.1.1.1.21.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></span>
<span id="S4.T4.1.1.1.1.21.2" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.21.3" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.21.4" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.21.5" class="ltx_td"></span>
<span id="S4.T4.1.1.1.1.21.6" class="ltx_td"></span></span>
</span>
</span></span></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results of the Open Ended and Multiple Choice tasks on <span id="S4.T4.3.1" class="ltx_text ltx_font_typewriter">test</span>. We compare the accuracy of single models (without augmentation) and ensemble models with published methods.</figcaption>
</figure>
</section>
<section id="S4.SS4.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.3 </span>On the VQA dataset</h4>

<div id="S4.SS4.SSS3.p1" class="ltx_para">
<p id="S4.SS4.SSS3.p1.2" class="ltx_p">Since we have found MF-SIG and LBP-SIG are the best on CLEVR, in this part, we mainly compare the two models with different <math id="S4.SS4.SSS3.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS4.SSS3.p1.1.m1.1a"><mi id="S4.SS4.SSS3.p1.1.m1.1.1" xref="S4.SS4.SSS3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p1.1.m1.1b"><ci id="S4.SS4.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p1.1.m1.1c">T</annotation></semantics></math>. Notice now the total number of glimpses is the same as MCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> and MLB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and both of them use <span id="S4.SS4.SSS3.p1.2.1" class="ltx_text ltx_font_typewriter">res5c</span> features and better feature pooling methods. The optimal choice in these experiments is MF-SIG-T3, which is 0.92% higher in overall accuracy than the previous best method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and outperforms previous methods on all 3 general categories of questions. We then use external data from Visual Genome to train MF-SIG-T3 and MF-T3, in which MF-SIG surpassed MLB under the same condition by 1.35%. The accuracy boost of our model is higher than MCB and MLB, showing that our model has higher capacity. The LBP models, which performs better than MF layers on CLEVR, turns out to be worse on this dataset, and <math id="S4.SS4.SSS3.p1.2.m2.1" class="ltx_Math" alttext="T=1" display="inline"><semantics id="S4.SS4.SSS3.p1.2.m2.1a"><mrow id="S4.SS4.SSS3.p1.2.m2.1.1" xref="S4.SS4.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS4.SSS3.p1.2.m2.1.1.2" xref="S4.SS4.SSS3.p1.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS4.SSS3.p1.2.m2.1.1.1" xref="S4.SS4.SSS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS3.p1.2.m2.1.1.3" xref="S4.SS4.SSS3.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p1.2.m2.1b"><apply id="S4.SS4.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS3.p1.2.m2.1.1"><eq id="S4.SS4.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS4.SSS3.p1.2.m2.1.1.1"></eq><ci id="S4.SS4.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS4.SSS3.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S4.SS4.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS4.SSS3.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p1.2.m2.1c">T=1</annotation></semantics></math> is the optimal choice for LBP. We also find the single MF attention model, which should not be as powerful as MF-SIG, achieved 67.17% accuracy with augmentation. These might be caused by the bias of the current VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, where there are questions with fixed answers across all involved images. We also show the results on <span id="S4.SS4.SSS3.p1.2.2" class="ltx_text ltx_font_typewriter">test</span>, as shown in Table <a href="#S4.T4" title="Table 4 ‣ 4.4.2 On CLEVR ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Our model is the best among published methods without external data. With an ensemble of 3 MF-T3 and 4 MF-SIG-T3 models, we achieve 68.18% accuracy on <span id="S4.SS4.SSS3.p1.2.3" class="ltx_text ltx_font_typewriter">test</span>, 1.25% higher than best published ensemble model on the Open Ended task. By the date of submission, we rank the second on the leaderboard of Open Ended task and the first on that of the Multiple Choice task. The champion on Open Ended has an accuracy of 69.94% but the method is not published. We have also recorded our model’s performance on the <span id="S4.SS4.SSS3.p1.2.4" class="ltx_text ltx_font_typewriter">test-dev2017</span> and <span id="S4.SS4.SSS3.p1.2.5" class="ltx_text ltx_font_typewriter">test2017</span> of VQA2.0 in Table <a href="#S4.T3" title="Table 3 ‣ 4.4.2 On CLEVR ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#S4.T4" title="Table 4 ‣ 4.4.2 On CLEVR ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Accuracy on <span id="S4.SS4.SSS3.p1.2.6" class="ltx_text ltx_font_typewriter">test2017</span> is achieved with 8 snapshots from 4 models with different learning rates.</p>
</div>
</section>
<section id="S4.SS4.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.4 </span>Qualitative Results</h4>

<figure id="S4.F5" class="ltx_figure"><img src="/html/1708.02071/assets/x4.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="487" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Two instances of different attentions on CLEVR, where the SIG model gives wrong answers but MF-SIG and LBP-SIG both give the correct answer. For each instance, from left to right, the first row to the second row, the images are: input image, <math id="S4.F5.5.m1.1" class="ltx_Math" alttext="b^{(0)}" display="inline"><semantics id="S4.F5.5.m1.1b"><msup id="S4.F5.5.m1.1.2" xref="S4.F5.5.m1.1.2.cmml"><mi id="S4.F5.5.m1.1.2.2" xref="S4.F5.5.m1.1.2.2.cmml">b</mi><mrow id="S4.F5.5.m1.1.1.1.3" xref="S4.F5.5.m1.1.2.cmml"><mo stretchy="false" id="S4.F5.5.m1.1.1.1.3.1" xref="S4.F5.5.m1.1.2.cmml">(</mo><mn id="S4.F5.5.m1.1.1.1.1" xref="S4.F5.5.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="S4.F5.5.m1.1.1.1.3.2" xref="S4.F5.5.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.F5.5.m1.1c"><apply id="S4.F5.5.m1.1.2.cmml" xref="S4.F5.5.m1.1.2"><csymbol cd="ambiguous" id="S4.F5.5.m1.1.2.1.cmml" xref="S4.F5.5.m1.1.2">superscript</csymbol><ci id="S4.F5.5.m1.1.2.2.cmml" xref="S4.F5.5.m1.1.2.2">𝑏</ci><cn type="integer" id="S4.F5.5.m1.1.1.1.1.cmml" xref="S4.F5.5.m1.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.m1.1d">b^{(0)}</annotation></semantics></math> of MF-SIG, <math id="S4.F5.6.m2.1" class="ltx_Math" alttext="b^{(3)}" display="inline"><semantics id="S4.F5.6.m2.1b"><msup id="S4.F5.6.m2.1.2" xref="S4.F5.6.m2.1.2.cmml"><mi id="S4.F5.6.m2.1.2.2" xref="S4.F5.6.m2.1.2.2.cmml">b</mi><mrow id="S4.F5.6.m2.1.1.1.3" xref="S4.F5.6.m2.1.2.cmml"><mo stretchy="false" id="S4.F5.6.m2.1.1.1.3.1" xref="S4.F5.6.m2.1.2.cmml">(</mo><mn id="S4.F5.6.m2.1.1.1.1" xref="S4.F5.6.m2.1.1.1.1.cmml">3</mn><mo stretchy="false" id="S4.F5.6.m2.1.1.1.3.2" xref="S4.F5.6.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.F5.6.m2.1c"><apply id="S4.F5.6.m2.1.2.cmml" xref="S4.F5.6.m2.1.2"><csymbol cd="ambiguous" id="S4.F5.6.m2.1.2.1.cmml" xref="S4.F5.6.m2.1.2">superscript</csymbol><ci id="S4.F5.6.m2.1.2.2.cmml" xref="S4.F5.6.m2.1.2.2">𝑏</ci><cn type="integer" id="S4.F5.6.m2.1.1.1.1.cmml" xref="S4.F5.6.m2.1.1.1.1">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m2.1d">b^{(3)}</annotation></semantics></math> of MF-SIG, <math id="S4.F5.7.m3.1" class="ltx_Math" alttext="\psi_{i}(z_{i})" display="inline"><semantics id="S4.F5.7.m3.1b"><mrow id="S4.F5.7.m3.1.1" xref="S4.F5.7.m3.1.1.cmml"><msub id="S4.F5.7.m3.1.1.3" xref="S4.F5.7.m3.1.1.3.cmml"><mi id="S4.F5.7.m3.1.1.3.2" xref="S4.F5.7.m3.1.1.3.2.cmml">ψ</mi><mi id="S4.F5.7.m3.1.1.3.3" xref="S4.F5.7.m3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.F5.7.m3.1.1.2" xref="S4.F5.7.m3.1.1.2.cmml">​</mo><mrow id="S4.F5.7.m3.1.1.1.1" xref="S4.F5.7.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.F5.7.m3.1.1.1.1.2" xref="S4.F5.7.m3.1.1.1.1.1.cmml">(</mo><msub id="S4.F5.7.m3.1.1.1.1.1" xref="S4.F5.7.m3.1.1.1.1.1.cmml"><mi id="S4.F5.7.m3.1.1.1.1.1.2" xref="S4.F5.7.m3.1.1.1.1.1.2.cmml">z</mi><mi id="S4.F5.7.m3.1.1.1.1.1.3" xref="S4.F5.7.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.F5.7.m3.1.1.1.1.3" xref="S4.F5.7.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.7.m3.1c"><apply id="S4.F5.7.m3.1.1.cmml" xref="S4.F5.7.m3.1.1"><times id="S4.F5.7.m3.1.1.2.cmml" xref="S4.F5.7.m3.1.1.2"></times><apply id="S4.F5.7.m3.1.1.3.cmml" xref="S4.F5.7.m3.1.1.3"><csymbol cd="ambiguous" id="S4.F5.7.m3.1.1.3.1.cmml" xref="S4.F5.7.m3.1.1.3">subscript</csymbol><ci id="S4.F5.7.m3.1.1.3.2.cmml" xref="S4.F5.7.m3.1.1.3.2">𝜓</ci><ci id="S4.F5.7.m3.1.1.3.3.cmml" xref="S4.F5.7.m3.1.1.3.3">𝑖</ci></apply><apply id="S4.F5.7.m3.1.1.1.1.1.cmml" xref="S4.F5.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.F5.7.m3.1.1.1.1.1.1.cmml" xref="S4.F5.7.m3.1.1.1.1">subscript</csymbol><ci id="S4.F5.7.m3.1.1.1.1.1.2.cmml" xref="S4.F5.7.m3.1.1.1.1.1.2">𝑧</ci><ci id="S4.F5.7.m3.1.1.1.1.1.3.cmml" xref="S4.F5.7.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.m3.1d">\psi_{i}(z_{i})</annotation></semantics></math> of LBP-SIG, <math id="S4.F5.8.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.F5.8.m4.1b"><mi id="S4.F5.8.m4.1.1" xref="S4.F5.8.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.F5.8.m4.1c"><ci id="S4.F5.8.m4.1.1.cmml" xref="S4.F5.8.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.m4.1d">b</annotation></semantics></math> of LBP-SIG, attention of SIG. Notations are the same as in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.4.1 On SHAPES ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Best viewed in color.</figcaption>
</figure>
<div id="S4.SS4.SSS4.p1" class="ltx_para">
<p id="S4.SS4.SSS4.p1.1" class="ltx_p">We demonstrate some attention maps on CLEVR and the VQA dataset to analyze the behavior of the proposed models. Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.4.4 Qualitative Results ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows 2 instances where the SIG model failed but both MF and LBP succeeded. We find the MF-SIG model has learned interesting patterns where its attention often covers the background surrounding the target initially, but converges to the target after iterative inference. This phenomenon almost never happens with the LBP-SIG model, which usually has better initializations that contained the target region. The shortcoming of the unstructured SIG model is also exposed in the 2 instances, where it tends to get stuck with the key nouns of the question.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/1708.02071/assets/x5.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="383" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Some instances in the VQA dataset. The ERFs locate at the target region in row 1 and 3, and at at initial attention in row 2. Best viewed in color.</figcaption>
</figure>
<div id="S4.SS4.SSS4.p2" class="ltx_para">
<p id="S4.SS4.SSS4.p2.1" class="ltx_p">Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.4.4 Qualitative Results ‣ 4.4 Results and Analysis ‣ 4 Experiments ‣ Structured Attentions for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> demonstrates 3 instances of the MF-SIG model together with the effective receptive field. The model gives 2 correct answers for the first 2 instances and 1 wrong answer for the last instance. In the first instance, the ERF at the target should be enough to encode the relations. The initial attention involves some extra areas due to the key word “luggage”, but it manages to converge to the most relevant region. In the second instance, the initial attention is wrong, as we can see the ERF at the initial attention does not overlap with the target, but with the help of MF, the final attention captures the relation “in the front” and gives an acceptable answer. In the third instance, the ERF at the target region is very weak on the keyword “bulb”, which means the feature vector does not encode this concept, probably due to the size of the bulb. The model fails to attend to the right region and gives a popular answer “2” (3rd most popular answer on the VQA dataset) according to the type of the question.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a novel structured visual attention mechanism for VQA, which models attention with binary latent variables and a grid-structured CRF over these variables. Inference in the CRF is implemented as recurrent layers in neural networks. Experimental results demonstrate that the proposed method is capable of capturing the semantic structure of the image in accordance with the question, which alleviates the problem of unstructured attention that captures only the key nouns in the questions. As a result, our method achieves state-of-the-art accuracy on three challenging datasets. Although structured visual attention does not solve all problems in VQA, we argue that it should be an indispensable module for VQA in the future.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
J. Andreas, M. Rohrbach, T. Darrell, and D. Klein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Learning to compose neural networks for question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">NAACL</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
J. Andreas, M. Rohrbach, T. Darrell, and D. Klein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Neural module networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. Lawrence Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">VQA: Visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
L.-C. Chen, A. G. Schwing, A. L. Yuille, and R. Urtasun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Learning deep structured models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
T. Chen, M. Li, Y. Li, M. Lin, N. Wang, M. Wang, T. Xiao, B. Xu, C. Zhang, and
Z. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Mxnet: A flexible and efficient machine learning library for
heterogeneous distributed systems.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1512.01274</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
A. Das, H. Agrawal, C. L. Zitnick, D. Parikh, and D. Batra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Human attention in visual question answering: Do humans and deep
networks look at the same regions?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
T.-M.-T. Do and T. Artieres.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Neural conditional random fields.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">AISTATS</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2010.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
A. Fukui, D. H. Park, D. Yang, A. Rohrbach, T. Darrell, and M. Rohrbach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Multimodal compact bilinear pooling for visual question answering and
visual grounding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">EMNLP</span><span id="bib.bib8.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Y. Gal and Z. Ghahramani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">A theoretically grounded application of dropout in recurrent neural
networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
K. He, X. Zhang, S. Ren, and J. Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
I. Ilievski, S. Yan, and J. Feng.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">A focused dynamic attention model for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1604.01485</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
M. Jaderberg, K. Simonyan, A. Vedaldi, and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Deep structured output learning for unconstrained text recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
J. Johnson, B. Hariharan, L. van der Maaten, L. Fei-Fei, C. L. Zitnick, and
R. Girshick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Clevr: A diagnostic dataset for compositional language and elementary
visual reasoning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
K. Kafle and C. Kanan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Answer-type prediction for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
K. Kafle and C. Kanan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Visual question answering: Datasets, algorithms, and future
challenges.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1610.01465</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
J.-H. Kim, S.-W. Lee, D. Kwak, M.-O. Heo, J. Kim, J.-W. Ha, and B.-T. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Multimodal residual learning for visual QA.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
J.-H. Kim, K.-W. On, J. Kim, J.-W. Ha, and B.-T. Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Hadamard product for low-rank bilinear pooling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Y. Kim, C. Denton, L. Hoang, and A. M. Rush.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Structured attention networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
D. Kingma and J. Ba.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Adam: A method for stochastic optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
R. Kiros, Y. Zhu, R. R. Salakhutdinov, R. Zemel, R. Urtasun, A. Torralba, and
S. Fidler.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Skip-thought vectors.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
R. Krishna, Y. Zhu, O. Groth, J. Johnson, K. Hata, J. Kravitz, S. Chen,
Y. Kalantidis, L.-J. Li, D. A. Shamma, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IJCV</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
R. Li and J. Jia.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Visual question answering with question representation update
(QRU).
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
T.-Y. Lin, M. Maire, S. Belongie, J. Hays, P. Perona, D. Ramanan,
P. Dollár, and C. L. Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Microsoft COCO: Common objects in context.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
J. Lu, J. Yang, D. Batra, and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Hierarchical question-image co-attention for visual question
answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
W. Luo, Y. Li, R. Urtasun, and R. Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Understanding the effective receptive field in deep convolutional
neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">A multi-world approach to question answering about real-world scenes
based on uncertain input.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
H. Nam, J.-W. Ha, and J. Kim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Dual attention networks for multimodal reasoning and matching.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1611.00471</span><span id="bib.bib27.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
H. Noh and B. Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Training recurrent answering units with joint loss minimization for
VQA.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1606.03647</span><span id="bib.bib28.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
S. Nowozin, C. H. Lampert, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Structured learning and prediction in computer vision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Foundations and Trends® in Computer Graphics and
Vision</span><span id="bib.bib29.4.2" class="ltx_text" style="font-size:90%;">, 6(3–4):185–365, 2011.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
J. Peng, L. Bo, and J. Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Conditional neural fields.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2009.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
K. J. Shih, S. Singh, and D. Hoiem.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Where to look: Focus regions for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
S. E. Shimony.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Finding maps for belief networks is np-hard.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Artificial Intelligence</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, 68(2):399–410, 1994.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
N. Srivastava, G. E. Hinton, A. Krizhevsky, I. Sutskever, and R. Salakhutdinov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Dropout: a simple way to prevent neural networks from overfitting.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">JMLR</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
K. Tu, M. Meng, M. W. Lee, T. E. Choe, and S.-C. Zhu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Joint video and text parsing for understanding events and answering
queries.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE MultiMedia</span><span id="bib.bib34.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Y. Weiss.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Comparing the mean field method and belief propagation for
approximate inference in mrfs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advanced Mean Field Methods—Theory and Practice</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">, pages
229–240, 2001.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Q. Wu, P. Wang, C. Shen, A. Dick, and A. van den Hengel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Ask me anything: Free-form visual question answering based on
knowledge from external sources.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
C. Xiong, S. Merity, and R. Socher.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Dynamic memory networks for visual and textual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib37.4.2" class="ltx_text" style="font-size:90%;">, 1603, 2016.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
H. Xu and K. Saenko.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Ask, attend and answer: Exploring question-guided spatial attention
for visual question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
K. Xu, J. Ba, R. Kiros, K. Cho, A. C. Courville, R. Salakhutdinov, R. S. Zemel,
and Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Show, attend and tell: Neural image caption generation with visual
attention.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib39.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICML</span><span id="bib.bib39.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Z. Yang, X. He, J. Gao, L. Deng, and A. Smola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Stacked attention networks for image question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib40.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib40.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
T. Yeh, J. J. Lee, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Photo-based question answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ACMMM</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, 2008.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
S. Zheng, S. Jayasumana, B. Romera-Paredes, V. Vineet, Z. Su, D. Du, C. Huang,
and P. H. Torr.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Conditional random fields as recurrent neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICCV</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
C. L. Zitnick and P. Dollár.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Edge boxes: Locating object proposals from edges.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib43.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ECCV</span><span id="bib.bib43.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1708.02070" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1708.02071" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1708.02071">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1708.02071" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1708.02072" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 15:50:39 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
