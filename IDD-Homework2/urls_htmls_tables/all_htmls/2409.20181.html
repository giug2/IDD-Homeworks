<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models</title>
<!--Generated on Mon Sep 30 10:48:26 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.20181v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S1" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background and Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2.SS1" title="In 2 Background and Related Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Fine-tuning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2.SS1.SSS0.Px1" title="In 2.1 Fine-tuning ‣ 2 Background and Related Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Full Parameter Fine-tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2.SS1.SSS0.Px2" title="In 2.1 Fine-tuning ‣ 2 Background and Related Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Parameter Efficient Fine-tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2.SS2" title="In 2 Background and Related Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>In-Context Learning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2.SS2.SSS0.Px1" title="In 2.2 In-Context Learning ‣ 2 Background and Related Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Few-Shot Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S2.SS2.SSS0.Px2" title="In 2.2 In-Context Learning ‣ 2 Background and Related Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Retrieval Augmented Generation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Reference Trustable Decoding</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS1" title="In 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Preliminary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS2" title="In 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Reference Trustable Decoding</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS1" title="In 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Generation of Reference Datastore</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS2" title="In 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Decoding Stage</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS2.Px1" title="In 3.2.2 Decoding Stage ‣ 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Fetch</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS2.Px2" title="In 3.2.2 Decoding Stage ‣ 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Normalization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS2.Px3" title="In 3.2.2 Decoding Stage ‣ 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Aggregation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS3" title="In 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multi-head Reference Trustable Decoding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS4" title="In 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Time and Memory Consumption</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS4.SSS0.Px1" title="In 3.4 Time and Memory Consumption ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Time Consumption</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS4.SSS0.Px2" title="In 3.4 Time and Memory Consumption ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Memory Consumption</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS4.SSS0.Px3" title="In 3.4 Time and Memory Consumption ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">MH-RTD for Resource Saving</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Settings and Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS1" title="In 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Language Understanding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS2" title="In 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Language Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS2.SSS0.Px1" title="In 4.2 Language Generation ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Reasoning with Context</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS2.SSS0.Px2" title="In 4.2 Language Generation ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Style transfer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS3" title="In 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Influence of Hyper-parameters in RTD</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S5" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A1" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Testing Environments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A2" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Generation of Reference Datastore</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A2.SS1" title="In Appendix B Generation of Reference Datastore ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>Benchmark Testing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A2.SS2" title="In Appendix B Generation of Reference Datastore ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Wikipedia Fact Retrieval</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A3" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>RAG’s Deficiency in Testing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A4" title="In Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>LoRA Hyperparamters</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Luohe Shi<sup class="ltx_sup" id="id10.10.id1"><span class="ltx_text ltx_font_italic" id="id10.10.id1.1">1</span></sup>, Yao Yao<sup class="ltx_sup" id="id11.11.id2">2</sup>, Zuchao Li<sup class="ltx_sup" id="id12.12.id3"><span class="ltx_text ltx_font_italic" id="id12.12.id3.1">1,</span></sup>, Lefei Zhang<sup class="ltx_sup" id="id13.13.id4"><span class="ltx_text ltx_font_italic" id="id13.13.id4.1">1</span></sup>, and Hai Zhao<sup class="ltx_sup" id="id14.14.id5"><span class="ltx_text ltx_font_italic" id="id14.14.id5.1">2</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id15.15.id6"><span class="ltx_text ltx_font_italic" id="id15.15.id6.1">1</span></sup>National Engineering Research Center for Multimedia Software, 
<br class="ltx_break"/>School of Computer Science, Wuhan University, Wuhan, 430072, P. R. China 
<br class="ltx_break"/><sup class="ltx_sup" id="id16.16.id7"><span class="ltx_text ltx_font_italic" id="id16.16.id7.1">2</span></sup>Department of Computer Science and Engineering, Shanghai Jiao Tong University
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id17.17.id8">shiluohe@whu.edu.cn, yaoyao27@sjtu.edu.cn, zcli-charlie@whu.edu.cn,
<br class="ltx_break"/>zhaohai@cs.sjtu.edu.cn
<br class="ltx_break"/></span>
</span><span class="ltx_author_notes">   Corresponding author. <sup class="ltx_sup" id="id18.18.id1"><span class="ltx_text ltx_font_italic" id="id18.18.id1.1">†</span></sup> Equal contribution.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id19.id1">Large language models (LLMs) have rapidly advanced and demonstrated impressive capabilities. In-Context Learning (ICL) and Parameter-Efficient Fine-Tuning (PEFT) are currently two mainstream methods for augmenting LLMs to downstream tasks. ICL typically constructs a few-shot learning scenario, either manually or by setting up a Retrieval-Augmented Generation (RAG) system, helping models quickly grasp domain knowledge or question-answering patterns without changing model parameters. However, this approach involves trade-offs, such as slower inference speed and increased space occupancy. PEFT assists the model in adapting to tasks through minimal parameter modifications, but the training process still demands high hardware requirements, even with a small number of parameters involved.
To address these challenges, we propose Reference Trustable Decoding (RTD), a paradigm that allows models to quickly adapt to new tasks without fine-tuning, maintaining low inference costs. RTD constructs a reference datastore from the provided training examples and optimizes the LLM’s final vocabulary distribution by flexibly selecting suitable references based on the input, resulting in more trustable responses and enabling the model to adapt to downstream tasks at a low cost.
Experimental evaluations on various LLMs using different benchmarks demonstrate that RTD establishes a new paradigm for augmenting models to downstream tasks. Furthermore, our method exhibits strong orthogonality with traditional methods, allowing for concurrent usage.</p>
</div>
<figure class="ltx_figure" id="S0.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="330" id="S0.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Performance comparison between default LLM and reference trustable decoding in reasoning tests.</figcaption>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In the rapidly advancing field of artificial intelligence, Large Language Models (LLMs) have demonstrated substantial progress. With their extensive parameter size, LLMs have acquired emergent abilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib39" title="">39</a>]</cite> and been able to tackle diverse and challenging tasks in fields like education <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib21" title="">21</a>]</cite> and medicine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib37" title="">37</a>]</cite>. Despite their immense potential, Large Language Models that have just completed pre-training often struggle to effectively adapt to downstream tasks. Moreover, the process of adapting the model is typically costly and requires careful execution by experienced individuals. Otherwise, it could lead to the model generating hallucination <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib48" title="">48</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib27" title="">27</a>]</cite> at best, or at worst, result in a loss of its language capabilities.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In-Context Learning (ICL), as a category of methods that do not require parameter adjustments, is one of the mainstream methods for adapting models to downstream tasks. ICL embeds domain knowledge, question-answering patterns, etc., into prompts through few-shot learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib6" title="">6</a>]</cite>, prompt engineering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib49" title="">49</a>]</cite>, and Retrieval-Augmented Generation (RAG) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib25" title="">25</a>]</cite> methods, leveraging the learning ability of the model itself to provide better answers. As pointed out in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, ICL focuses on the prompt stage. However, ICL significantly increases the length of the input, consequently increases the space occupied by the KV-Cache required for inference. Further, according to the Roofline model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib44" title="">44</a>]</cite>, this part of the KV-Cache cannot be parallelized through batch processing, making memory I/O throughput a system bottleneck, wasting hardware computing power, and increasing token generation time during the entire inference stage.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Fine-tuning is also used to adapt models to downstream tasks. By fine-tuning the pre-trained model based on domain tasks, the model can quickly acquire capabilities within the domain. However, traditional full-parameter fine-tuning often requires a large amount of resources (empirically 8-15 times that of inference), making Parameter-Efficient Fine-Tuning (PEFT) a more popular method. By freezing most parameters and only modifying a few, methods such as Adapters, P-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib26" title="">26</a>]</cite>, LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib16" title="">16</a>]</cite> and others <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib46" title="">46</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib35" title="">35</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib42" title="">42</a>]</cite> have become mainstream methods for quickly adapting models to downstream tasks. However, fine-tuning methods introduce several hyperparameters, which require high experience from the fine-tuners and the effects are unpredictable. Furthermore, due to the need for backpropagation, the computation graph must be saved, meaning that even if only a few parameters need to be updated, there will be a large amount of additional computation and space requirements (several times that of inference), raising the threshold for methods based on fine-tuning.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address these challenges, we introduce Reference Trustable Decoding (RTD), a novel framework designed to fit LLMs for downstream tasks.
Distinct from a conventional <span class="ltx_text ltx_font_typewriter" id="S1.p4.1.1">LM_Head</span> module, RTD strategically retrieves relevant references from a pre-constructed datastore, guided by the final hidden states of the language model. This approach not only enhances the final output distribution by recalculating it with the similarity score of the retrieved references but also allows for the seamless integration of new knowledge or constraints into the response generation process without increasing the input length or using gradient descent.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">RTD, distinctively training-free, emphasizes compact input lengths to expedite inference. RTD’s effectiveness was rigorously tested using varied benchmarks focused on different tasks and a Wikipedia-based knowledge injection scenario. On these benchmarks, RTD achieved results comparable to traditional methods like PEFT and ICL, providing significant improvement. Additionally, we combined RTD with traditional methods, further enhancing the model’s capabilities and demonstrating the good orthogonality of RTD with other approaches.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Our contribution includes:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose a new paradigm, called RTD, for fitting LLMs for downstream tasks. RTD is a training-free method that focused on the decoding stage of large language models (LLMs), as a alternation of <span class="ltx_text ltx_font_typewriter" id="S1.I1.i1.p1.1.1">LM_Head</span>. It helps LLMs to adapt to different tasks with different demands and provide trustable response.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">RTD has achieved performance comparable to, or even better than, ICL and PEFT across different benches, while maintaining the desirable properties of training free and not introducing additional input lengths. This demonstrates the potential of RTD as a new paradigm for LLMs to adapt to downstream tasks. Furthermore, RTD can be seamlessly integrated with other existing methods, such as in-context learning (ICL) and fine-tuning. The combination of RTD, ICL, and fine-tuning has the potential to achieve even higher performance.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="178" id="S1.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The pipeline of LLM inference and the focus of different methods: ICL focuses on the prompt stage, emphasizing the optimization of the model’s input. Fine-tuning methods optimize the model itself by adjusting its parameters. In contrast, our proposed RTD method targets the decoding stage of the language model. By constructing a reference datastore, RTD optimizes the final output distribution without requiring additional training.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background and Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In the field of NLPs, Transformer models have gained influence rapidly after it get original proposed in 2017. As larger scaled model been introduced, especially giant ones like GPT3 which has 175 Billion of parameters <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib9" title="">9</a>]</cite>, the training process is getting more and more expensive, hence to fit the LLMs for downstream tasks.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Fine-tuning</h3>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Full Parameter Fine-tuning</h5>
<div class="ltx_para" id="S2.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px1.p1.1">Full parameter fine-tuning refers to fully optimizing all the parameters of the model during the fine-tuning process. Full parameter fine-tuning has the advantage of allowing the model to adapt more closely to the specific task at hand, as well as injecting more information into the model. However, it also has the disadvantage of being the most computationally expensive and time-consuming, as it requires to manipulate all parameters of the model, with the modern optimizer like Adam <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib19" title="">19</a>]</cite>, 8 to 15 times of more extra GPU memory is demanded comparing to inference empirically, resulting a must of multi-GPU server or even cross sever training.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Parameter Efficient Fine-tuning</h5>
<div class="ltx_para" id="S2.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p1.1">Parameter Efficient Fine-tune (PEFT), for example, LoRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib16" title="">16</a>]</cite> and P-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib26" title="">26</a>]</cite>, is introduced to make fine-tune more reachable. By freezing most of the model parameters and only let a small amount of them accumulate gradient, the GPU memory and computation resource can be cut down by a large margin <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib14" title="">14</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS1.SSS0.Px2.p2.1">However, as fine-tuning introduce many tricky hyper-parameters like learning rate, the process is heavily task related and empirical, even experienced fine-tuner need some trials and error when tuning them.
Moreover, even if the number of parameters trained is not large, processes such as backpropagation still need to be carried out. The computation graph generated on long sequences will also occupy a large amount of memory, making the threshold for computing power and memory still high, which any method that relies on gradient descent is difficult to avoid.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>In-Context Learning</h3>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Few-Shot Learning</h5>
<div class="ltx_para" id="S2.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px1.p1.1">Few-shot Learning is proved to be a great way for LLMs to gain capability. By appending the true task that LLMs are expecting to response after a couple of existing correct examples, LLMs can gain its reasoning ability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib6" title="">6</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib30" title="">30</a>]</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Retrieval Augmented Generation</h5>
<div class="ltx_para" id="S2.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p1.1">Retrieval Augmented Generation (RAG)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib23" title="">23</a>]</cite> is an AI framework for retrieving facts from an external knowledge source to LLMs, which helps LLMs correct its hallucination and use latest fact <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib34" title="">34</a>]</cite>. RAG is to cut external knowledge source into multiple chunks, then embed and store them in a database, then retrieve them at the process of generation to let LLMs get the knowledge in it. This technique allowed LLM to use extra information while maintaining their parameters untouched. RAG have been used on multiple fields, like coding  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib25" title="">25</a>]</cite> and question answering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib28" title="">28</a>]</cite>. And it can be combined with few-shot <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib18" title="">18</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S2.SS2.SSS0.Px2.p2.1">The main drawback of ICL methods lies in their growth of the input sequence. Under the quadratic complexity of the Transformer architecture, this implies a longer KV-Cache, which not only increases the latency during the pre-fill stage but also adds delay each time a token is generated <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib43" title="">43</a>]</cite>. Moreover, unlike model parameters, each instance needs to save its dedicated portion of KV-Cache, leading to memory I/O bottlenecks and computational power waste. Finally, on some smaller models, the irrelevant information that ICL might contain can confuse the model, resulting in performance loss.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Reference Trustable Decoding</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we begin by presenting the fundamental formulas and concepts to elucidate the workings of Reference Trustable Decoding, followed by an exploration of the multi-head Reference Trustable Decoding method.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminary</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">Given an input sentence <math alttext="c=\{t_{1},t_{2},...,t_{n}\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.4"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><mi id="S3.SS1.p1.1.m1.4.4.5" xref="S3.SS1.p1.1.m1.4.4.5.cmml">c</mi><mo id="S3.SS1.p1.1.m1.4.4.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">t</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">t</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.4.4.3.3.7" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.2" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml">t</mi><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.4"></eq><ci id="S3.SS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.p1.1.m1.4.4.5">𝑐</ci><set id="S3.SS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑡</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑡</ci><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2">𝑡</ci><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">c=\{t_{1},t_{2},...,t_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.4d">italic_c = { italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_t start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">t</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑡</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the i-th token and <math alttext="n" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_n</annotation></semantics></math> denotes the sentence length, the last token’s output of the last Transformer block in the language model can be represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h^{(l)}=\mathcal{LM}(c)" class="ltx_Math" display="block" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.3" xref="S3.E1.m1.2.3.cmml"><msup id="S3.E1.m1.2.3.2" xref="S3.E1.m1.2.3.2.cmml"><mi id="S3.E1.m1.2.3.2.2" xref="S3.E1.m1.2.3.2.2.cmml">h</mi><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.2.3.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.2.3.2.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">l</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.2.3.2.cmml">)</mo></mrow></msup><mo id="S3.E1.m1.2.3.1" xref="S3.E1.m1.2.3.1.cmml">=</mo><mrow id="S3.E1.m1.2.3.3" xref="S3.E1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.3.3.2" xref="S3.E1.m1.2.3.3.2.cmml">ℒ</mi><mo id="S3.E1.m1.2.3.3.1" xref="S3.E1.m1.2.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.3.3.3" xref="S3.E1.m1.2.3.3.3.cmml">ℳ</mi><mo id="S3.E1.m1.2.3.3.1a" xref="S3.E1.m1.2.3.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.2.3.3.4.2" xref="S3.E1.m1.2.3.3.cmml"><mo id="S3.E1.m1.2.3.3.4.2.1" stretchy="false" xref="S3.E1.m1.2.3.3.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">c</mi><mo id="S3.E1.m1.2.3.3.4.2.2" stretchy="false" xref="S3.E1.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.3.cmml" xref="S3.E1.m1.2.3"><eq id="S3.E1.m1.2.3.1.cmml" xref="S3.E1.m1.2.3.1"></eq><apply id="S3.E1.m1.2.3.2.cmml" xref="S3.E1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.1.cmml" xref="S3.E1.m1.2.3.2">superscript</csymbol><ci id="S3.E1.m1.2.3.2.2.cmml" xref="S3.E1.m1.2.3.2.2">ℎ</ci><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.E1.m1.2.3.3.cmml" xref="S3.E1.m1.2.3.3"><times id="S3.E1.m1.2.3.3.1.cmml" xref="S3.E1.m1.2.3.3.1"></times><ci id="S3.E1.m1.2.3.3.2.cmml" xref="S3.E1.m1.2.3.3.2">ℒ</ci><ci id="S3.E1.m1.2.3.3.3.cmml" xref="S3.E1.m1.2.3.3.3">ℳ</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">h^{(l)}=\mathcal{LM}(c)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = caligraphic_L caligraphic_M ( italic_c )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.6">In this equation, <math alttext="h^{(l)}\in\mathbb{R}^{d_{m}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m1.1"><semantics id="S3.SS1.p1.4.m1.1a"><mrow id="S3.SS1.p1.4.m1.1.2" xref="S3.SS1.p1.4.m1.1.2.cmml"><msup id="S3.SS1.p1.4.m1.1.2.2" xref="S3.SS1.p1.4.m1.1.2.2.cmml"><mi id="S3.SS1.p1.4.m1.1.2.2.2" xref="S3.SS1.p1.4.m1.1.2.2.2.cmml">h</mi><mrow id="S3.SS1.p1.4.m1.1.1.1.3" xref="S3.SS1.p1.4.m1.1.2.2.cmml"><mo id="S3.SS1.p1.4.m1.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.4.m1.1.2.2.cmml">(</mo><mi id="S3.SS1.p1.4.m1.1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.1.cmml">l</mi><mo id="S3.SS1.p1.4.m1.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.4.m1.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p1.4.m1.1.2.1" xref="S3.SS1.p1.4.m1.1.2.1.cmml">∈</mo><msup id="S3.SS1.p1.4.m1.1.2.3" xref="S3.SS1.p1.4.m1.1.2.3.cmml"><mi id="S3.SS1.p1.4.m1.1.2.3.2" xref="S3.SS1.p1.4.m1.1.2.3.2.cmml">ℝ</mi><msub id="S3.SS1.p1.4.m1.1.2.3.3" xref="S3.SS1.p1.4.m1.1.2.3.3.cmml"><mi id="S3.SS1.p1.4.m1.1.2.3.3.2" xref="S3.SS1.p1.4.m1.1.2.3.3.2.cmml">d</mi><mi id="S3.SS1.p1.4.m1.1.2.3.3.3" xref="S3.SS1.p1.4.m1.1.2.3.3.3.cmml">m</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.1b"><apply id="S3.SS1.p1.4.m1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.2"><in id="S3.SS1.p1.4.m1.1.2.1.cmml" xref="S3.SS1.p1.4.m1.1.2.1"></in><apply id="S3.SS1.p1.4.m1.1.2.2.cmml" xref="S3.SS1.p1.4.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.2.2.1.cmml" xref="S3.SS1.p1.4.m1.1.2.2">superscript</csymbol><ci id="S3.SS1.p1.4.m1.1.2.2.2.cmml" xref="S3.SS1.p1.4.m1.1.2.2.2">ℎ</ci><ci id="S3.SS1.p1.4.m1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.SS1.p1.4.m1.1.2.3.cmml" xref="S3.SS1.p1.4.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.2.3.1.cmml" xref="S3.SS1.p1.4.m1.1.2.3">superscript</csymbol><ci id="S3.SS1.p1.4.m1.1.2.3.2.cmml" xref="S3.SS1.p1.4.m1.1.2.3.2">ℝ</ci><apply id="S3.SS1.p1.4.m1.1.2.3.3.cmml" xref="S3.SS1.p1.4.m1.1.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.2.3.3.1.cmml" xref="S3.SS1.p1.4.m1.1.2.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m1.1.2.3.3.2.cmml" xref="S3.SS1.p1.4.m1.1.2.3.3.2">𝑑</ci><ci id="S3.SS1.p1.4.m1.1.2.3.3.3.cmml" xref="S3.SS1.p1.4.m1.1.2.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.1c">h^{(l)}\in\mathbb{R}^{d_{m}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m1.1d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the last token from the final, or the <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m2.1"><semantics id="S3.SS1.p1.5.m2.1a"><mi id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><ci id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m2.1d">italic_l</annotation></semantics></math>-th, Transformer block of the language model, where <math alttext="d_{m}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m3.1"><semantics id="S3.SS1.p1.6.m3.1a"><msub id="S3.SS1.p1.6.m3.1.1" xref="S3.SS1.p1.6.m3.1.1.cmml"><mi id="S3.SS1.p1.6.m3.1.1.2" xref="S3.SS1.p1.6.m3.1.1.2.cmml">d</mi><mi id="S3.SS1.p1.6.m3.1.1.3" xref="S3.SS1.p1.6.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m3.1b"><apply id="S3.SS1.p1.6.m3.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m3.1.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m3.1.1.2.cmml" xref="S3.SS1.p1.6.m3.1.1.2">𝑑</ci><ci id="S3.SS1.p1.6.m3.1.1.3.cmml" xref="S3.SS1.p1.6.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m3.1c">d_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m3.1d">italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> denotes the hidden size of the model.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">Traditionally, a standard decoder-only architecture Transformer usually employs <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p2.2.1">LM_Head</span>, which is, a fully connected layer, usually includes a learnable weight matrix <math alttext="W" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_W</annotation></semantics></math> and no bias, followed by a softmax function <math alttext="\mathbf{Softmax}(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.2.2" xref="S3.SS1.p2.2.m2.1.2.2.cmml">𝐒𝐨𝐟𝐭𝐦𝐚𝐱</mi><mo id="S3.SS1.p2.2.m2.1.2.1" xref="S3.SS1.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.2.m2.1.2.3.2" xref="S3.SS1.p2.2.m2.1.2.cmml"><mo id="S3.SS1.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.2.m2.1.2.cmml">(</mo><mo id="S3.SS1.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS1.p2.2.m2.1.1.cmml">⋅</mo><mo id="S3.SS1.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.2.cmml" xref="S3.SS1.p2.2.m2.1.2"><times id="S3.SS1.p2.2.m2.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.2.1"></times><ci id="S3.SS1.p2.2.m2.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.2.2">𝐒𝐨𝐟𝐭𝐦𝐚𝐱</ci><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathbf{Softmax}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">bold_Softmax ( ⋅ )</annotation></semantics></math> to predict the output probability distribution <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.2.2">p</span> of the next token from the last hidden states:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{p}=\mathtt{LM\_Head}(h^{(l)})=\mathbf{Softmax}(W\cdot h^{(l)})" class="ltx_Math" display="block" id="S3.E2.m1.4"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mi id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml">𝐩</mi><mo id="S3.E2.m1.4.4.5" xref="S3.E2.m1.4.4.5.cmml">=</mo><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.cmml"><mi id="S3.E2.m1.3.3.1.3" xref="S3.E2.m1.3.3.1.3.cmml">𝙻𝙼</mi><mo id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.4" mathvariant="normal" xref="S3.E2.m1.3.3.1.4.cmml">_</mi><mo id="S3.E2.m1.3.3.1.2a" xref="S3.E2.m1.3.3.1.2.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.5" xref="S3.E2.m1.3.3.1.5.cmml">𝙷𝚎𝚊𝚍</mi><mo id="S3.E2.m1.3.3.1.2b" xref="S3.E2.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.cmml">(</mo><msup id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.2.cmml">h</mi><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.3.1" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">l</mi><mo id="S3.E2.m1.1.1.1.3.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.6" xref="S3.E2.m1.4.4.6.cmml">=</mo><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml"><mi id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.2.3.cmml">𝐒𝐨𝐟𝐭𝐦𝐚𝐱</mi><mo id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.2.1.1" xref="S3.E2.m1.4.4.2.1.1.1.cmml"><mo id="S3.E2.m1.4.4.2.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.2.1.1.1" xref="S3.E2.m1.4.4.2.1.1.1.cmml"><mi id="S3.E2.m1.4.4.2.1.1.1.2" xref="S3.E2.m1.4.4.2.1.1.1.2.cmml">W</mi><mo id="S3.E2.m1.4.4.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.E2.m1.4.4.2.1.1.1.1.cmml">⋅</mo><msup id="S3.E2.m1.4.4.2.1.1.1.3" xref="S3.E2.m1.4.4.2.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.2.1.1.1.3.2" xref="S3.E2.m1.4.4.2.1.1.1.3.2.cmml">h</mi><mrow id="S3.E2.m1.2.2.1.3" xref="S3.E2.m1.4.4.2.1.1.1.3.cmml"><mo id="S3.E2.m1.2.2.1.3.1" stretchy="false" xref="S3.E2.m1.4.4.2.1.1.1.3.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">l</mi><mo id="S3.E2.m1.2.2.1.3.2" stretchy="false" xref="S3.E2.m1.4.4.2.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E2.m1.4.4.2.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><and id="S3.E2.m1.4.4a.cmml" xref="S3.E2.m1.4.4"></and><apply id="S3.E2.m1.4.4b.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.5.cmml" xref="S3.E2.m1.4.4.5"></eq><ci id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4">𝐩</ci><apply id="S3.E2.m1.3.3.1.cmml" xref="S3.E2.m1.3.3.1"><times id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.2"></times><ci id="S3.E2.m1.3.3.1.3.cmml" xref="S3.E2.m1.3.3.1.3">𝙻𝙼</ci><ci id="S3.E2.m1.3.3.1.4.cmml" xref="S3.E2.m1.3.3.1.4">_</ci><ci id="S3.E2.m1.3.3.1.5.cmml" xref="S3.E2.m1.3.3.1.5">𝙷𝚎𝚊𝚍</ci><apply id="S3.E2.m1.3.3.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.2">ℎ</ci><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑙</ci></apply></apply></apply><apply id="S3.E2.m1.4.4c.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.6.cmml" xref="S3.E2.m1.4.4.6"></eq><share href="https://arxiv.org/html/2409.20181v1#S3.E2.m1.3.3.1.cmml" id="S3.E2.m1.4.4d.cmml" xref="S3.E2.m1.4.4"></share><apply id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2"><times id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"></times><ci id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.3">𝐒𝐨𝐟𝐭𝐦𝐚𝐱</ci><apply id="S3.E2.m1.4.4.2.1.1.1.cmml" xref="S3.E2.m1.4.4.2.1.1"><ci id="S3.E2.m1.4.4.2.1.1.1.1.cmml" xref="S3.E2.m1.4.4.2.1.1.1.1">⋅</ci><ci id="S3.E2.m1.4.4.2.1.1.1.2.cmml" xref="S3.E2.m1.4.4.2.1.1.1.2">𝑊</ci><apply id="S3.E2.m1.4.4.2.1.1.1.3.cmml" xref="S3.E2.m1.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.2.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.4.4.2.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.2.1.1.1.3.2">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\mathbf{p}=\mathtt{LM\_Head}(h^{(l)})=\mathbf{Softmax}(W\cdot h^{(l)})</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.4d">bold_p = typewriter_LM _ typewriter_Head ( italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ) = bold_Softmax ( italic_W ⋅ italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.4">where <math alttext="v" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m1.1"><semantics id="S3.SS1.p2.3.m1.1a"><mi id="S3.SS1.p2.3.m1.1.1" xref="S3.SS1.p2.3.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m1.1b"><ci id="S3.SS1.p2.3.m1.1.1.cmml" xref="S3.SS1.p2.3.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m1.1d">italic_v</annotation></semantics></math> is the vocabulary size and <math alttext="W\in\mathbb{R}^{v\times d_{m}}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m2.1"><semantics id="S3.SS1.p2.4.m2.1a"><mrow id="S3.SS1.p2.4.m2.1.1" xref="S3.SS1.p2.4.m2.1.1.cmml"><mi id="S3.SS1.p2.4.m2.1.1.2" xref="S3.SS1.p2.4.m2.1.1.2.cmml">W</mi><mo id="S3.SS1.p2.4.m2.1.1.1" xref="S3.SS1.p2.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.4.m2.1.1.3" xref="S3.SS1.p2.4.m2.1.1.3.cmml"><mi id="S3.SS1.p2.4.m2.1.1.3.2" xref="S3.SS1.p2.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.4.m2.1.1.3.3" xref="S3.SS1.p2.4.m2.1.1.3.3.cmml"><mi id="S3.SS1.p2.4.m2.1.1.3.3.2" xref="S3.SS1.p2.4.m2.1.1.3.3.2.cmml">v</mi><mo id="S3.SS1.p2.4.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.4.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p2.4.m2.1.1.3.3.3" xref="S3.SS1.p2.4.m2.1.1.3.3.3.cmml"><mi id="S3.SS1.p2.4.m2.1.1.3.3.3.2" xref="S3.SS1.p2.4.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS1.p2.4.m2.1.1.3.3.3.3" xref="S3.SS1.p2.4.m2.1.1.3.3.3.3.cmml">m</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m2.1b"><apply id="S3.SS1.p2.4.m2.1.1.cmml" xref="S3.SS1.p2.4.m2.1.1"><in id="S3.SS1.p2.4.m2.1.1.1.cmml" xref="S3.SS1.p2.4.m2.1.1.1"></in><ci id="S3.SS1.p2.4.m2.1.1.2.cmml" xref="S3.SS1.p2.4.m2.1.1.2">𝑊</ci><apply id="S3.SS1.p2.4.m2.1.1.3.cmml" xref="S3.SS1.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m2.1.1.3.1.cmml" xref="S3.SS1.p2.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.4.m2.1.1.3.2.cmml" xref="S3.SS1.p2.4.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.4.m2.1.1.3.3.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3"><times id="S3.SS1.p2.4.m2.1.1.3.3.1.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3.1"></times><ci id="S3.SS1.p2.4.m2.1.1.3.3.2.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3.2">𝑣</ci><apply id="S3.SS1.p2.4.m2.1.1.3.3.3.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m2.1.1.3.3.3.1.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.4.m2.1.1.3.3.3.2.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS1.p2.4.m2.1.1.3.3.3.3.cmml" xref="S3.SS1.p2.4.m2.1.1.3.3.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m2.1c">W\in\mathbb{R}^{v\times d_{m}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m2.1d">italic_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_v × italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">However, traditional next token prediction does not support incorporating external information and therefore, we introduce reference trustable decoding where we build a bypass around the <span class="ltx_text ltx_font_typewriter" id="S3.SS1.p3.1.1">LM_Head</span>, showcased in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.F3" title="Figure 3 ‣ 3.2.1 Generation of Reference Datastore ‣ 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, as the entrance of additional knowledge or guidance.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reference Trustable Decoding</h3>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Generation of Reference Datastore</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.6">In reference trustable decoding, we first build the reference datastore <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">caligraphic_L</annotation></semantics></math>, which stores key-value pairs <math alttext="(k,v)\in(\mathcal{K},\mathcal{V})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.4"><semantics id="S3.SS2.SSS1.p1.2.m2.4a"><mrow id="S3.SS2.SSS1.p1.2.m2.4.5" xref="S3.SS2.SSS1.p1.2.m2.4.5.cmml"><mrow id="S3.SS2.SSS1.p1.2.m2.4.5.2.2" xref="S3.SS2.SSS1.p1.2.m2.4.5.2.1.cmml"><mo id="S3.SS2.SSS1.p1.2.m2.4.5.2.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.2.m2.4.5.2.1.cmml">(</mo><mi id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">k</mi><mo id="S3.SS2.SSS1.p1.2.m2.4.5.2.2.2" xref="S3.SS2.SSS1.p1.2.m2.4.5.2.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.2.m2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.cmml">v</mi><mo id="S3.SS2.SSS1.p1.2.m2.4.5.2.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.2.m2.4.5.2.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS1.p1.2.m2.4.5.1" xref="S3.SS2.SSS1.p1.2.m2.4.5.1.cmml">∈</mo><mrow id="S3.SS2.SSS1.p1.2.m2.4.5.3.2" xref="S3.SS2.SSS1.p1.2.m2.4.5.3.1.cmml"><mo id="S3.SS2.SSS1.p1.2.m2.4.5.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.2.m2.4.5.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.2.m2.3.3" xref="S3.SS2.SSS1.p1.2.m2.3.3.cmml">𝒦</mi><mo id="S3.SS2.SSS1.p1.2.m2.4.5.3.2.2" xref="S3.SS2.SSS1.p1.2.m2.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.2.m2.4.4" xref="S3.SS2.SSS1.p1.2.m2.4.4.cmml">𝒱</mi><mo id="S3.SS2.SSS1.p1.2.m2.4.5.3.2.3" stretchy="false" xref="S3.SS2.SSS1.p1.2.m2.4.5.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.4b"><apply id="S3.SS2.SSS1.p1.2.m2.4.5.cmml" xref="S3.SS2.SSS1.p1.2.m2.4.5"><in id="S3.SS2.SSS1.p1.2.m2.4.5.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.4.5.1"></in><interval closure="open" id="S3.SS2.SSS1.p1.2.m2.4.5.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.4.5.2.2"><ci id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">𝑘</ci><ci id="S3.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2">𝑣</ci></interval><interval closure="open" id="S3.SS2.SSS1.p1.2.m2.4.5.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.4.5.3.2"><ci id="S3.SS2.SSS1.p1.2.m2.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3">𝒦</ci><ci id="S3.SS2.SSS1.p1.2.m2.4.4.cmml" xref="S3.SS2.SSS1.p1.2.m2.4.4">𝒱</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.4c">(k,v)\in(\mathcal{K},\mathcal{V})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.4d">( italic_k , italic_v ) ∈ ( caligraphic_K , caligraphic_V )</annotation></semantics></math>. Here, the key <math alttext="k=\mathcal{LM}(c)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m3.1"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.2.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.2.cmml">k</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.1" xref="S3.SS2.SSS1.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.2.3" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.3.m3.1.2.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.2.cmml">ℒ</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.1" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.3.m3.1.2.3.3" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.3.cmml">ℳ</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.1a" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.2.3.4.2" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml"><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.4.2.1" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml">(</mo><mi id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml">c</mi><mo id="S3.SS2.SSS1.p1.3.m3.1.2.3.4.2.2" stretchy="false" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2"><eq id="S3.SS2.SSS1.p1.3.m3.1.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.1"></eq><ci id="S3.SS2.SSS1.p1.3.m3.1.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.2">𝑘</ci><apply id="S3.SS2.SSS1.p1.3.m3.1.2.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3"><times id="S3.SS2.SSS1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.1"></times><ci id="S3.SS2.SSS1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.2">ℒ</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.2.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.2.3.3">ℳ</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">k=\mathcal{LM}(c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m3.1d">italic_k = caligraphic_L caligraphic_M ( italic_c )</annotation></semantics></math> represents the last hidden states of the token generated by the LMs from the context <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m4.1"><semantics id="S3.SS2.SSS1.p1.4.m4.1a"><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.1b"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m4.1d">italic_c</annotation></semantics></math>, and the value <math alttext="v" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m5.1"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mi id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m5.1d">italic_v</annotation></semantics></math> is the corresponding label <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m6.1"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mi id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><ci id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m6.1d">italic_y</annotation></semantics></math>. Mathematically, we have:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\{(k,v)|(k,v)\in(\mathcal{K},\mathcal{V})\}=\{\left(\mathcal{LM}%
\left(c\right),y\right)\ |\ (c,y)\in\mathcal{D}\}" class="ltx_Math" display="block" id="S3.E3.m1.14"><semantics id="S3.E3.m1.14a"><mrow id="S3.E3.m1.14.14" xref="S3.E3.m1.14.14.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.14.14.6" xref="S3.E3.m1.14.14.6.cmml">ℒ</mi><mo id="S3.E3.m1.14.14.7" xref="S3.E3.m1.14.14.7.cmml">=</mo><mrow id="S3.E3.m1.12.12.2.2" xref="S3.E3.m1.12.12.2.3.cmml"><mo id="S3.E3.m1.12.12.2.2.3" stretchy="false" xref="S3.E3.m1.12.12.2.3.1.cmml">{</mo><mrow id="S3.E3.m1.11.11.1.1.1.2" xref="S3.E3.m1.11.11.1.1.1.1.cmml"><mo id="S3.E3.m1.11.11.1.1.1.2.1" stretchy="false" xref="S3.E3.m1.11.11.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">k</mi><mo id="S3.E3.m1.11.11.1.1.1.2.2" xref="S3.E3.m1.11.11.1.1.1.1.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">v</mi><mo id="S3.E3.m1.11.11.1.1.1.2.3" stretchy="false" xref="S3.E3.m1.11.11.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E3.m1.12.12.2.2.4" lspace="0em" rspace="0em" xref="S3.E3.m1.12.12.2.3.1.cmml">|</mo><mrow id="S3.E3.m1.12.12.2.2.2" xref="S3.E3.m1.12.12.2.2.2.cmml"><mrow id="S3.E3.m1.12.12.2.2.2.2.2" xref="S3.E3.m1.12.12.2.2.2.2.1.cmml"><mo id="S3.E3.m1.12.12.2.2.2.2.2.1" stretchy="false" xref="S3.E3.m1.12.12.2.2.2.2.1.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">k</mi><mo id="S3.E3.m1.12.12.2.2.2.2.2.2" xref="S3.E3.m1.12.12.2.2.2.2.1.cmml">,</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">v</mi><mo id="S3.E3.m1.12.12.2.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.12.12.2.2.2.2.1.cmml">)</mo></mrow><mo id="S3.E3.m1.12.12.2.2.2.1" xref="S3.E3.m1.12.12.2.2.2.1.cmml">∈</mo><mrow id="S3.E3.m1.12.12.2.2.2.3.2" xref="S3.E3.m1.12.12.2.2.2.3.1.cmml"><mo id="S3.E3.m1.12.12.2.2.2.3.2.1" stretchy="false" xref="S3.E3.m1.12.12.2.2.2.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">𝒦</mi><mo id="S3.E3.m1.12.12.2.2.2.3.2.2" xref="S3.E3.m1.12.12.2.2.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">𝒱</mi><mo id="S3.E3.m1.12.12.2.2.2.3.2.3" stretchy="false" xref="S3.E3.m1.12.12.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.12.12.2.2.5" stretchy="false" xref="S3.E3.m1.12.12.2.3.1.cmml">}</mo></mrow><mo id="S3.E3.m1.14.14.8" xref="S3.E3.m1.14.14.8.cmml">=</mo><mrow id="S3.E3.m1.14.14.4.2" xref="S3.E3.m1.14.14.4.3.cmml"><mo id="S3.E3.m1.14.14.4.2.3" stretchy="false" xref="S3.E3.m1.14.14.4.3.1.cmml">{</mo><mrow id="S3.E3.m1.13.13.3.1.1.1" xref="S3.E3.m1.13.13.3.1.1.2.cmml"><mo id="S3.E3.m1.13.13.3.1.1.1.2" xref="S3.E3.m1.13.13.3.1.1.2.cmml">(</mo><mrow id="S3.E3.m1.13.13.3.1.1.1.1" xref="S3.E3.m1.13.13.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.13.13.3.1.1.1.1.2" xref="S3.E3.m1.13.13.3.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E3.m1.13.13.3.1.1.1.1.1" xref="S3.E3.m1.13.13.3.1.1.1.1.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.13.13.3.1.1.1.1.3" xref="S3.E3.m1.13.13.3.1.1.1.1.3.cmml">ℳ</mi><mo id="S3.E3.m1.13.13.3.1.1.1.1.1a" xref="S3.E3.m1.13.13.3.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E3.m1.13.13.3.1.1.1.1.4.2" xref="S3.E3.m1.13.13.3.1.1.1.1.cmml"><mo id="S3.E3.m1.13.13.3.1.1.1.1.4.2.1" xref="S3.E3.m1.13.13.3.1.1.1.1.cmml">(</mo><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">c</mi><mo id="S3.E3.m1.13.13.3.1.1.1.1.4.2.2" xref="S3.E3.m1.13.13.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.13.13.3.1.1.1.3" xref="S3.E3.m1.13.13.3.1.1.2.cmml">,</mo><mi id="S3.E3.m1.8.8" xref="S3.E3.m1.8.8.cmml">y</mi><mo id="S3.E3.m1.13.13.3.1.1.1.4" rspace="0.222em" xref="S3.E3.m1.13.13.3.1.1.2.cmml">)</mo></mrow><mo id="S3.E3.m1.14.14.4.2.4" rspace="0.500em" xref="S3.E3.m1.14.14.4.3.1.cmml">|</mo><mrow id="S3.E3.m1.14.14.4.2.2" xref="S3.E3.m1.14.14.4.2.2.cmml"><mrow id="S3.E3.m1.14.14.4.2.2.2.2" xref="S3.E3.m1.14.14.4.2.2.2.1.cmml"><mo id="S3.E3.m1.14.14.4.2.2.2.2.1" stretchy="false" xref="S3.E3.m1.14.14.4.2.2.2.1.cmml">(</mo><mi id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml">c</mi><mo id="S3.E3.m1.14.14.4.2.2.2.2.2" xref="S3.E3.m1.14.14.4.2.2.2.1.cmml">,</mo><mi id="S3.E3.m1.10.10" xref="S3.E3.m1.10.10.cmml">y</mi><mo id="S3.E3.m1.14.14.4.2.2.2.2.3" stretchy="false" xref="S3.E3.m1.14.14.4.2.2.2.1.cmml">)</mo></mrow><mo id="S3.E3.m1.14.14.4.2.2.1" xref="S3.E3.m1.14.14.4.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.14.14.4.2.2.3" xref="S3.E3.m1.14.14.4.2.2.3.cmml">𝒟</mi></mrow><mo id="S3.E3.m1.14.14.4.2.5" stretchy="false" xref="S3.E3.m1.14.14.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.14b"><apply id="S3.E3.m1.14.14.cmml" xref="S3.E3.m1.14.14"><and id="S3.E3.m1.14.14a.cmml" xref="S3.E3.m1.14.14"></and><apply id="S3.E3.m1.14.14b.cmml" xref="S3.E3.m1.14.14"><eq id="S3.E3.m1.14.14.7.cmml" xref="S3.E3.m1.14.14.7"></eq><ci id="S3.E3.m1.14.14.6.cmml" xref="S3.E3.m1.14.14.6">ℒ</ci><apply id="S3.E3.m1.12.12.2.3.cmml" xref="S3.E3.m1.12.12.2.2"><csymbol cd="latexml" id="S3.E3.m1.12.12.2.3.1.cmml" xref="S3.E3.m1.12.12.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.E3.m1.11.11.1.1.1.1.cmml" xref="S3.E3.m1.11.11.1.1.1.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑘</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑣</ci></interval><apply id="S3.E3.m1.12.12.2.2.2.cmml" xref="S3.E3.m1.12.12.2.2.2"><in id="S3.E3.m1.12.12.2.2.2.1.cmml" xref="S3.E3.m1.12.12.2.2.2.1"></in><interval closure="open" id="S3.E3.m1.12.12.2.2.2.2.1.cmml" xref="S3.E3.m1.12.12.2.2.2.2.2"><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑘</ci><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑣</ci></interval><interval closure="open" id="S3.E3.m1.12.12.2.2.2.3.1.cmml" xref="S3.E3.m1.12.12.2.2.2.3.2"><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝒦</ci><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝒱</ci></interval></apply></apply></apply><apply id="S3.E3.m1.14.14c.cmml" xref="S3.E3.m1.14.14"><eq id="S3.E3.m1.14.14.8.cmml" xref="S3.E3.m1.14.14.8"></eq><share href="https://arxiv.org/html/2409.20181v1#S3.E3.m1.12.12.2.cmml" id="S3.E3.m1.14.14d.cmml" xref="S3.E3.m1.14.14"></share><apply id="S3.E3.m1.14.14.4.3.cmml" xref="S3.E3.m1.14.14.4.2"><csymbol cd="latexml" id="S3.E3.m1.14.14.4.3.1.cmml" xref="S3.E3.m1.14.14.4.2.3">conditional-set</csymbol><interval closure="open" id="S3.E3.m1.13.13.3.1.1.2.cmml" xref="S3.E3.m1.13.13.3.1.1.1"><apply id="S3.E3.m1.13.13.3.1.1.1.1.cmml" xref="S3.E3.m1.13.13.3.1.1.1.1"><times id="S3.E3.m1.13.13.3.1.1.1.1.1.cmml" xref="S3.E3.m1.13.13.3.1.1.1.1.1"></times><ci id="S3.E3.m1.13.13.3.1.1.1.1.2.cmml" xref="S3.E3.m1.13.13.3.1.1.1.1.2">ℒ</ci><ci id="S3.E3.m1.13.13.3.1.1.1.1.3.cmml" xref="S3.E3.m1.13.13.3.1.1.1.1.3">ℳ</ci><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">𝑐</ci></apply><ci id="S3.E3.m1.8.8.cmml" xref="S3.E3.m1.8.8">𝑦</ci></interval><apply id="S3.E3.m1.14.14.4.2.2.cmml" xref="S3.E3.m1.14.14.4.2.2"><in id="S3.E3.m1.14.14.4.2.2.1.cmml" xref="S3.E3.m1.14.14.4.2.2.1"></in><interval closure="open" id="S3.E3.m1.14.14.4.2.2.2.1.cmml" xref="S3.E3.m1.14.14.4.2.2.2.2"><ci id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9">𝑐</ci><ci id="S3.E3.m1.10.10.cmml" xref="S3.E3.m1.10.10">𝑦</ci></interval><ci id="S3.E3.m1.14.14.4.2.2.3.cmml" xref="S3.E3.m1.14.14.4.2.2.3">𝒟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.14c">\mathcal{L}=\{(k,v)|(k,v)\in(\mathcal{K},\mathcal{V})\}=\{\left(\mathcal{LM}%
\left(c\right),y\right)\ |\ (c,y)\in\mathcal{D}\}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.14d">caligraphic_L = { ( italic_k , italic_v ) | ( italic_k , italic_v ) ∈ ( caligraphic_K , caligraphic_V ) } = { ( caligraphic_L caligraphic_M ( italic_c ) , italic_y ) | ( italic_c , italic_y ) ∈ caligraphic_D }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p2.4">where <math alttext="\mathcal{D}=(\mathcal{C},\mathcal{Y})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.2"><semantics id="S3.SS2.SSS1.p2.1.m1.2a"><mrow id="S3.SS2.SSS1.p2.1.m1.2.3" xref="S3.SS2.SSS1.p2.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.2.3.2" xref="S3.SS2.SSS1.p2.1.m1.2.3.2.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p2.1.m1.2.3.1" xref="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p2.1.m1.2.3.3.2" xref="S3.SS2.SSS1.p2.1.m1.2.3.3.1.cmml"><mo id="S3.SS2.SSS1.p2.1.m1.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.2.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">𝒞</mi><mo id="S3.SS2.SSS1.p2.1.m1.2.3.3.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.2.2" xref="S3.SS2.SSS1.p2.1.m1.2.2.cmml">𝒴</mi><mo id="S3.SS2.SSS1.p2.1.m1.2.3.3.2.3" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.2b"><apply id="S3.SS2.SSS1.p2.1.m1.2.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3"><eq id="S3.SS2.SSS1.p2.1.m1.2.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3.1"></eq><ci id="S3.SS2.SSS1.p2.1.m1.2.3.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3.2">𝒟</ci><interval closure="open" id="S3.SS2.SSS1.p2.1.m1.2.3.3.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.3.3.2"><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝒞</ci><ci id="S3.SS2.SSS1.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.2.2">𝒴</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.2c">\mathcal{D}=(\mathcal{C},\mathcal{Y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.2d">caligraphic_D = ( caligraphic_C , caligraphic_Y )</annotation></semantics></math> is the task dataset with input context set <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.1"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">caligraphic_C</annotation></semantics></math> and label set <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">caligraphic_Y</annotation></semantics></math>, and <math alttext="|\mathcal{Y}|" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.4.m4.1"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mrow id="S3.SS2.SSS1.p2.4.m4.1.2.2" xref="S3.SS2.SSS1.p2.4.m4.1.2.1.cmml"><mo id="S3.SS2.SSS1.p2.4.m4.1.2.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.4.m4.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml">𝒴</mi><mo id="S3.SS2.SSS1.p2.4.m4.1.2.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.4.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.2.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.2.2"><abs id="S3.SS2.SSS1.p2.4.m4.1.2.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.2.2.1"></abs><ci id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">|\mathcal{Y}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.4.m4.1d">| caligraphic_Y |</annotation></semantics></math> refers the number of possible labels. This process is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.F3" title="Figure 3 ‣ 3.2.1 Generation of Reference Datastore ‣ 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>. It’s obvious that <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.p2.4.1">the computational requirement is same as performing a forward pass to every content in the task dataset</span>, which aligned with the minimal requirement of the inference stage, denotes the superiority of RTD as a gradient-free method.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="247" id="S3.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Overview of the reference datastore generation and reference trustable decoding process.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Decoding Stage</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.2">At each decoding round, given the input context <math alttext="c" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_c</annotation></semantics></math>, we first compute <math alttext="h^{(l)}=\mathcal{LM}(c)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.2"><semantics id="S3.SS2.SSS2.p1.2.m2.2a"><mrow id="S3.SS2.SSS2.p1.2.m2.2.3" xref="S3.SS2.SSS2.p1.2.m2.2.3.cmml"><msup id="S3.SS2.SSS2.p1.2.m2.2.3.2" xref="S3.SS2.SSS2.p1.2.m2.2.3.2.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.2.3.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.3.2.2.cmml">h</mi><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.2.3.2.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.2.3.2.cmml">(</mo><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.2.3.2.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS2.p1.2.m2.2.3.1" xref="S3.SS2.SSS2.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.2.m2.2.3.3" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.2.m2.2.3.3.2" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.2.cmml">ℒ</mi><mo id="S3.SS2.SSS2.p1.2.m2.2.3.3.1" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.2.m2.2.3.3.3" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.3.cmml">ℳ</mi><mo id="S3.SS2.SSS2.p1.2.m2.2.3.3.1a" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.2.m2.2.3.3.4.2" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.2.3.3.4.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.cmml">(</mo><mi id="S3.SS2.SSS2.p1.2.m2.2.2" xref="S3.SS2.SSS2.p1.2.m2.2.2.cmml">c</mi><mo id="S3.SS2.SSS2.p1.2.m2.2.3.3.4.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.2b"><apply id="S3.SS2.SSS2.p1.2.m2.2.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3"><eq id="S3.SS2.SSS2.p1.2.m2.2.3.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.1"></eq><apply id="S3.SS2.SSS2.p1.2.m2.2.3.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.2.3.2.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.2">superscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.2.3.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.2.2">ℎ</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1">𝑙</ci></apply><apply id="S3.SS2.SSS2.p1.2.m2.2.3.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.3"><times id="S3.SS2.SSS2.p1.2.m2.2.3.3.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.1"></times><ci id="S3.SS2.SSS2.p1.2.m2.2.3.3.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.2">ℒ</ci><ci id="S3.SS2.SSS2.p1.2.m2.2.3.3.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.3.3.3">ℳ</ci><ci id="S3.SS2.SSS2.p1.2.m2.2.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.2.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.2c">h^{(l)}=\mathcal{LM}(c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.2d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT = caligraphic_L caligraphic_M ( italic_c )</annotation></semantics></math>, which is the input to RTD and <span class="ltx_text ltx_font_typewriter" id="S3.SS2.SSS2.p1.2.1">LM_Head</span>. Then we use a three stage approach to get the RTD output, <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS2.p1.2.2">Fetch</span>, <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS2.p1.2.3">Normalization</span>, and <span class="ltx_text ltx_font_bold" id="S3.SS2.SSS2.p1.2.4">Aggregation</span>, depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.F4" title="Figure 4 ‣ Aggregation ‣ 3.2.2 Decoding Stage ‣ 3.2 Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Fetch</h5>
<div class="ltx_para" id="S3.SS2.SSS2.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px1.p1.13">First, we calculate the distance <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.1a"><msup id="S3.SS2.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml">d</mi><mo id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2">𝑑</ci><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.1.m1.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> between <math alttext="h^{(l)}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS2.Px1.p1.2.m2.1a"><msup id="S3.SS2.SSS2.Px1.p1.2.m2.1.2" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.2.m2.1.2.2" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2.2.cmml">h</mi><mrow id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2.cmml"><mo id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px1.p1.2.m2.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.2.m2.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.2.m2.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.2.2">ℎ</ci><ci id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.2.m2.1c">h^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.2.m2.1d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> and all the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS2.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.3.m3.1d">italic_k</annotation></semantics></math> in the reference datastore <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS2.Px1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.4.m4.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.4.m4.1d">caligraphic_L</annotation></semantics></math>. Otherwise stated, we use the Euclidean distance <math alttext="d^{\prime}_{i}=||h^{(l)}-k_{i}||_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.5.m5.2"><semantics id="S3.SS2.SSS2.Px1.p1.5.m5.2a"><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.cmml"><msubsup id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.3.cmml">i</mi><mo id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.2.cmml">=</mo><msub id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.cmml"><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.2.cmml"><mo id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.cmml"><msup id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.1.cmml">−</mo><msub id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.2.cmml">k</mi><mi id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.5.m5.2b"><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2"><eq id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.2"></eq><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3">subscript</csymbol><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.2">𝑑</ci><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.2.3">′</ci></apply><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.3.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1">subscript</csymbol><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.2">norm</csymbol><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1"><minus id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.1"></minus><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.2.2">ℎ</ci><ci id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.1">𝑙</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.2">𝑘</ci><ci id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><cn id="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.3.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p1.5.m5.2.2.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.5.m5.2c">d^{\prime}_{i}=||h^{(l)}-k_{i}||_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.5.m5.2d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = | | italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT - italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>.
We then select the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.6.m6.1"><semantics id="S3.SS2.SSS2.Px1.p1.6.m6.1a"><mi id="S3.SS2.SSS2.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.6.m6.1b"><ci id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.6.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.6.m6.1d">italic_K</annotation></semantics></math> instances from <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.7.m7.1"><semantics id="S3.SS2.SSS2.Px1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.7.m7.1b"><ci id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.7.m7.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.7.m7.1d">caligraphic_L</annotation></semantics></math> which have the smallest distance, and for the <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.8.m8.1"><semantics id="S3.SS2.SSS2.Px1.p1.8.m8.1a"><mi id="S3.SS2.SSS2.Px1.p1.8.m8.1.1" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.8.m8.1b"><ci id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.8.m8.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.8.m8.1d">italic_j</annotation></semantics></math>-th (<math alttext="1\leq j\leq K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.9.m9.1"><semantics id="S3.SS2.SSS2.Px1.p1.9.m9.1a"><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml"><mn id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2.cmml">1</mn><mo id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.cmml">≤</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4.cmml">j</mi><mo id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5.cmml">≤</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.9.m9.1b"><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><and id="S3.SS2.SSS2.Px1.p1.9.m9.1.1a.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"></and><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1b.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><leq id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.3"></leq><cn id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2.cmml" type="integer" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.2">1</cn><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.4">𝑗</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.9.m9.1.1c.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"><leq id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.5"></leq><share href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS2.Px1.p1.9.m9.1.1.4.cmml" id="S3.SS2.SSS2.Px1.p1.9.m9.1.1d.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1"></share><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.9.m9.1c">1\leq j\leq K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.9.m9.1d">1 ≤ italic_j ≤ italic_K</annotation></semantics></math>) closest <math alttext="(k_{i},v_{i})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.10.m10.2"><semantics id="S3.SS2.SSS2.Px1.p1.10.m10.2a"><mrow id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.3.cmml"><mo id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.3.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.2.cmml">k</mi><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.4" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.2.cmml">v</mi><mi id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.10.m10.2b"><interval closure="open" id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2"><apply id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.2">𝑘</ci><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.2">𝑣</ci><ci id="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.10.m10.2c">(k_{i},v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.10.m10.2d">( italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, we define <math alttext="o_{j}=i" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.11.m11.1"><semantics id="S3.SS2.SSS2.Px1.p1.11.m11.1a"><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml"><msub id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.2.cmml">o</mi><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1.cmml">=</mo><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.11.m11.1b"><apply id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1"><eq id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1"></eq><apply id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.2">𝑜</ci><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.11.m11.1c">o_{j}=i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.11.m11.1d">italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_i</annotation></semantics></math>. Then we create a set <math alttext="L_{h}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.12.m12.1"><semantics id="S3.SS2.SSS2.Px1.p1.12.m12.1a"><msub id="S3.SS2.SSS2.Px1.p1.12.m12.1.1" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2.cmml">L</mi><mi id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.12.m12.1b"><apply id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.2">𝐿</ci><ci id="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m12.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.12.m12.1c">L_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.12.m12.1d">italic_L start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>, storing the top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px1.p1.13.m13.1"><semantics id="S3.SS2.SSS2.Px1.p1.13.m13.1a"><mi id="S3.SS2.SSS2.Px1.p1.13.m13.1.1" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.13.m13.1b"><ci id="S3.SS2.SSS2.Px1.p1.13.m13.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m13.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.13.m13.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px1.p1.13.m13.1d">italic_K</annotation></semantics></math> distances and values:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{h}=\{(d^{\prime}_{o_{j}},v_{o_{j}})\}=\{(||h^{(l)}-k_{o_{j}}||_{2},v_{o_{j}%
})\},\quad o_{j}=i\ \mathrm{for}\ j\mathrm{-th\ closest\ }(k_{i},v_{i})" class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.3.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.4" xref="S3.E4.m1.2.2.1.1.4.cmml"><mi id="S3.E4.m1.2.2.1.1.4.2" xref="S3.E4.m1.2.2.1.1.4.2.cmml">L</mi><mi id="S3.E4.m1.2.2.1.1.4.3" xref="S3.E4.m1.2.2.1.1.4.3.cmml">h</mi></msub><mo id="S3.E4.m1.2.2.1.1.5" xref="S3.E4.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.2.cmml"><mo id="S3.E4.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.2.cmml">{</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml"><mo id="S3.E4.m1.2.2.1.1.1.1.1.2.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml">(</mo><msubsup id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">d</mi><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">o</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="S3.E4.m1.2.2.1.1.1.1.1.2.4" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml">,</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.2.cmml">v</mi><msub id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.2.cmml">o</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.3.cmml">j</mi></msub></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.2.5" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S3.E4.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.2.cmml">}</mo></mrow><mo id="S3.E4.m1.2.2.1.1.6" xref="S3.E4.m1.2.2.1.1.6.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.2.1" xref="S3.E4.m1.2.2.1.1.2.2.cmml"><mo id="S3.E4.m1.2.2.1.1.2.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.2.cmml">{</mo><mrow id="S3.E4.m1.2.2.1.1.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.1.1.3.cmml"><mo id="S3.E4.m1.2.2.1.1.2.1.1.2.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.1.3.cmml">(</mo><msub id="S3.E4.m1.2.2.1.1.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><msup id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.cmml">h</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">l</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml">k</mi><msub id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml">o</mi><mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub></msub></mrow><mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E4.m1.2.2.1.1.2.1.1.2.4" xref="S3.E4.m1.2.2.1.1.2.1.1.3.cmml">,</mo><msub id="S3.E4.m1.2.2.1.1.2.1.1.2.2" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.2.cmml">v</mi><msub id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.2" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.2.cmml">o</mi><mi id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.3.cmml">j</mi></msub></msub><mo id="S3.E4.m1.2.2.1.1.2.1.1.2.5" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.1.1.3.cmml">)</mo></mrow><mo id="S3.E4.m1.2.2.1.1.2.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.2.2.cmml">}</mo></mrow></mrow><mo id="S3.E4.m1.3.3.2.3" rspace="1.167em" xref="S3.E4.m1.3.3.3a.cmml">,</mo><mrow id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml"><msub id="S3.E4.m1.3.3.2.2.4" xref="S3.E4.m1.3.3.2.2.4.cmml"><mi id="S3.E4.m1.3.3.2.2.4.2" xref="S3.E4.m1.3.3.2.2.4.2.cmml">o</mi><mi id="S3.E4.m1.3.3.2.2.4.3" xref="S3.E4.m1.3.3.2.2.4.3.cmml">j</mi></msub><mo id="S3.E4.m1.3.3.2.2.3" xref="S3.E4.m1.3.3.2.2.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.2.2.2" xref="S3.E4.m1.3.3.2.2.2.cmml"><mrow id="S3.E4.m1.3.3.2.2.2.4" xref="S3.E4.m1.3.3.2.2.2.4.cmml"><mi id="S3.E4.m1.3.3.2.2.2.4.2" xref="S3.E4.m1.3.3.2.2.2.4.2.cmml">i</mi><mo id="S3.E4.m1.3.3.2.2.2.4.1" lspace="0.500em" xref="S3.E4.m1.3.3.2.2.2.4.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.2.2.2.4.3" xref="S3.E4.m1.3.3.2.2.2.4.3.cmml">for</mi><mo id="S3.E4.m1.3.3.2.2.2.4.1a" lspace="0.500em" xref="S3.E4.m1.3.3.2.2.2.4.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.2.2.2.4.4" xref="S3.E4.m1.3.3.2.2.2.4.4.cmml">j</mi></mrow><mo id="S3.E4.m1.3.3.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.3.cmml">−</mo><mrow id="S3.E4.m1.3.3.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.4" xref="S3.E4.m1.3.3.2.2.2.2.4.cmml">th</mi><mo id="S3.E4.m1.3.3.2.2.2.2.3" lspace="0.500em" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml">⁢</mo><mi id="S3.E4.m1.3.3.2.2.2.2.5" xref="S3.E4.m1.3.3.2.2.2.2.5.cmml">closest</mi><mo id="S3.E4.m1.3.3.2.2.2.2.3a" lspace="0.500em" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.2.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.2.3.cmml"><mo id="S3.E4.m1.3.3.2.2.2.2.2.2.3" stretchy="false" xref="S3.E4.m1.3.3.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E4.m1.3.3.2.2.1.1.1.1.1" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.2.2.1.1.1.1.1.2" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1.2.cmml">k</mi><mi id="S3.E4.m1.3.3.2.2.1.1.1.1.1.3" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.3.3.2.2.2.2.2.2.4" xref="S3.E4.m1.3.3.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E4.m1.3.3.2.2.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E4.m1.3.3.2.2.2.2.2.2.5" stretchy="false" xref="S3.E4.m1.3.3.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3a.cmml" xref="S3.E4.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1"><and id="S3.E4.m1.2.2.1.1a.cmml" xref="S3.E4.m1.2.2.1.1"></and><apply id="S3.E4.m1.2.2.1.1b.cmml" xref="S3.E4.m1.2.2.1.1"><eq id="S3.E4.m1.2.2.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.5"></eq><apply id="S3.E4.m1.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.4.2">𝐿</ci><ci id="S3.E4.m1.2.2.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.4.3">ℎ</ci></apply><set id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><interval closure="open" id="S3.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.2">𝑜</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.2">𝑣</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.2">𝑜</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply></interval></set></apply><apply id="S3.E4.m1.2.2.1.1c.cmml" xref="S3.E4.m1.2.2.1.1"><eq id="S3.E4.m1.2.2.1.1.6.cmml" xref="S3.E4.m1.2.2.1.1.6"></eq><share href="https://arxiv.org/html/2409.20181v1#S3.E4.m1.2.2.1.1.1.cmml" id="S3.E4.m1.2.2.1.1d.cmml" xref="S3.E4.m1.2.2.1.1"></share><set id="S3.E4.m1.2.2.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1"><interval closure="open" id="S3.E4.m1.2.2.1.1.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2"><apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1"><minus id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑙</ci></apply><apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.2">𝑘</ci><apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.2">𝑜</ci><ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><cn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3">2</cn></apply><apply id="S3.E4.m1.2.2.1.1.2.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.2">𝑣</ci><apply id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.2">𝑜</ci><ci id="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.2.2.3.3">𝑗</ci></apply></apply></interval></set></apply></apply><apply id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2"><eq id="S3.E4.m1.3.3.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.3"></eq><apply id="S3.E4.m1.3.3.2.2.4.cmml" xref="S3.E4.m1.3.3.2.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.4.1.cmml" xref="S3.E4.m1.3.3.2.2.4">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.4.2.cmml" xref="S3.E4.m1.3.3.2.2.4.2">𝑜</ci><ci id="S3.E4.m1.3.3.2.2.4.3.cmml" xref="S3.E4.m1.3.3.2.2.4.3">𝑗</ci></apply><apply id="S3.E4.m1.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2"><minus id="S3.E4.m1.3.3.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.3"></minus><apply id="S3.E4.m1.3.3.2.2.2.4.cmml" xref="S3.E4.m1.3.3.2.2.2.4"><times id="S3.E4.m1.3.3.2.2.2.4.1.cmml" xref="S3.E4.m1.3.3.2.2.2.4.1"></times><ci id="S3.E4.m1.3.3.2.2.2.4.2.cmml" xref="S3.E4.m1.3.3.2.2.2.4.2">𝑖</ci><ci id="S3.E4.m1.3.3.2.2.2.4.3.cmml" xref="S3.E4.m1.3.3.2.2.2.4.3">for</ci><ci id="S3.E4.m1.3.3.2.2.2.4.4.cmml" xref="S3.E4.m1.3.3.2.2.2.4.4">𝑗</ci></apply><apply id="S3.E4.m1.3.3.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2"><times id="S3.E4.m1.3.3.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.3"></times><ci id="S3.E4.m1.3.3.2.2.2.2.4.cmml" xref="S3.E4.m1.3.3.2.2.2.2.4">th</ci><ci id="S3.E4.m1.3.3.2.2.2.2.5.cmml" xref="S3.E4.m1.3.3.2.2.2.2.5">closest</ci><interval closure="open" id="S3.E4.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2"><apply id="S3.E4.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1.2">𝑘</ci><ci id="S3.E4.m1.3.3.2.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E4.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">L_{h}=\{(d^{\prime}_{o_{j}},v_{o_{j}})\}=\{(||h^{(l)}-k_{o_{j}}||_{2},v_{o_{j}%
})\},\quad o_{j}=i\ \mathrm{for}\ j\mathrm{-th\ closest\ }(k_{i},v_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_L start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = { ( italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) } = { ( | | italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT - italic_k start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT | | start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) } , italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_i roman_for italic_j - roman_th roman_closest ( italic_k start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Normalization</h5>
<div class="ltx_para" id="S3.SS2.SSS2.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px2.p1.6">We first scale the <math alttext="d^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.Px2.p1.1.m1.1a"><msup id="S3.SS2.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml">d</mi><mo id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.2">𝑑</ci><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.1.m1.1c">d^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.1.m1.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> we got from the previous stage by temperature <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.Px2.p1.2.m2.1a"><mi id="S3.SS2.SSS2.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.2.m2.1d">italic_T</annotation></semantics></math>, as <math alttext="d^{\prime\prime}_{j}={d^{\prime}_{o_{j}}}/{T}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.Px2.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml"><msubsup id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.3.cmml">j</mi><mo id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.3.cmml">′′</mo></msubsup><mo id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.cmml"><msubsup id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.2.cmml">d</mi><msub id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.cmml"><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.2" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.2.cmml">o</mi><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.3.cmml">j</mi></msub><mo id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.3.cmml">′</mo></msubsup><mo id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.1" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.1.cmml">/</mo><mi id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1"><eq id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.1"></eq><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.2">𝑑</ci><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.2.3">′′</ci></apply><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.2.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3"><divide id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.1"></divide><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2">subscript</csymbol><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.2">𝑑</ci><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.2.3">′</ci></apply><apply id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.1.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.2.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.2">𝑜</ci><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.2.3.3">𝑗</ci></apply></apply><ci id="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px2.p1.3.m3.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.3.m3.1c">d^{\prime\prime}_{j}={d^{\prime}_{o_{j}}}/{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.3.m3.1d">italic_d start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT / italic_T</annotation></semantics></math>. The scale operation is introduced to prevent overflow in the following Softmax operation. We take the Softmax of <math alttext="-d^{\prime\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.Px2.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml"><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1a" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml">−</mo><msup id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2.cmml">d</mi><mo id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.cmml">′′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1"><minus id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1"></minus><apply id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.2">𝑑</ci><ci id="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px2.p1.4.m4.1.1.2.3">′′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.4.m4.1c">-d^{\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.4.m4.1d">- italic_d start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.Px2.p1.5.m5.1a"><mi id="S3.SS2.SSS2.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.5.m5.1b"><ci id="S3.SS2.SSS2.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.5.m5.1d">italic_d</annotation></semantics></math>, guaranteed <math alttext="d" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px2.p1.6.m6.1"><semantics id="S3.SS2.SSS2.Px2.p1.6.m6.1a"><mi id="S3.SS2.SSS2.Px2.p1.6.m6.1.1" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.6.m6.1b"><ci id="S3.SS2.SSS2.Px2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px2.p1.6.m6.1d">italic_d</annotation></semantics></math> as a valid possibility distribution.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d=\mathbf{Softmax}(-d^{\prime\prime}),\quad d_{j}=\frac{\mathrm{exp}\{-d^{%
\prime\prime}_{j}\}}{\sum_{\iota=1}^{K}{\mathrm{exp}\{-d^{\prime\prime}_{\iota%
}\}}}=\frac{\mathrm{exp}\{-d^{\prime}_{o_{j}}/T\}}{\sum_{\iota=1}^{K}{\mathrm{%
exp}\{-d^{\prime}_{o_{\iota}}/T\}}}" class="ltx_Math" display="block" id="S3.E5.m1.6"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6.2" xref="S3.E5.m1.6.6.3.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.3" xref="S3.E5.m1.5.5.1.1.3.cmml">d</mi><mo id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml"><mi id="S3.E5.m1.5.5.1.1.1.3" xref="S3.E5.m1.5.5.1.1.1.3.cmml">𝐒𝐨𝐟𝐭𝐦𝐚𝐱</mi><mo id="S3.E5.m1.5.5.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.5.5.1.1.1.1.1.1" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.5.5.1.1.1.1.1.1a" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E5.m1.5.5.1.1.1.1.1.1.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.2.cmml">d</mi><mo id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.cmml">′′</mo></msup></mrow><mo id="S3.E5.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.6.6.2.3" rspace="1.167em" xref="S3.E5.m1.6.6.3a.cmml">,</mo><mrow id="S3.E5.m1.6.6.2.2" xref="S3.E5.m1.6.6.2.2.cmml"><msub id="S3.E5.m1.6.6.2.2.2" xref="S3.E5.m1.6.6.2.2.2.cmml"><mi id="S3.E5.m1.6.6.2.2.2.2" xref="S3.E5.m1.6.6.2.2.2.2.cmml">d</mi><mi id="S3.E5.m1.6.6.2.2.2.3" xref="S3.E5.m1.6.6.2.2.2.3.cmml">j</mi></msub><mo id="S3.E5.m1.6.6.2.2.3" xref="S3.E5.m1.6.6.2.2.3.cmml">=</mo><mfrac id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">exp</mi><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.cmml">{</mo><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1a" xref="S3.E5.m1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2.cmml">d</mi><mi id="S3.E5.m1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.3.cmml">j</mi><mo id="S3.E5.m1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3.cmml">′′</mo></msubsup></mrow><mo id="S3.E5.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><msubsup id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><mo id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.2.3.2.cmml">ι</mi><mo id="S3.E5.m1.2.2.2.2.2.3.1" xref="S3.E5.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.2.2.2.2.2.3.3" xref="S3.E5.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3.cmml">K</mi></msubsup><mrow id="S3.E5.m1.2.2.2.1" xref="S3.E5.m1.2.2.2.1.cmml"><mi id="S3.E5.m1.2.2.2.1.3" xref="S3.E5.m1.2.2.2.1.3.cmml">exp</mi><mo id="S3.E5.m1.2.2.2.1.2" xref="S3.E5.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.2.1.1.1" xref="S3.E5.m1.2.2.2.1.1.2.cmml"><mo id="S3.E5.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.2.1.1.2.cmml">{</mo><mrow id="S3.E5.m1.2.2.2.1.1.1.1" xref="S3.E5.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.2.1.1.1.1a" xref="S3.E5.m1.2.2.2.1.1.1.1.cmml">−</mo><msubsup id="S3.E5.m1.2.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.2.1.1.1.1.2.2.2" xref="S3.E5.m1.2.2.2.1.1.1.1.2.2.2.cmml">d</mi><mi id="S3.E5.m1.2.2.2.1.1.1.1.2.3" xref="S3.E5.m1.2.2.2.1.1.1.1.2.3.cmml">ι</mi><mo id="S3.E5.m1.2.2.2.1.1.1.1.2.2.3" xref="S3.E5.m1.2.2.2.1.1.1.1.2.2.3.cmml">′′</mo></msubsup></mrow><mo id="S3.E5.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.2.1.1.2.cmml">}</mo></mrow></mrow></mrow></mfrac><mo id="S3.E5.m1.6.6.2.2.4" xref="S3.E5.m1.6.6.2.2.4.cmml">=</mo><mfrac id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml"><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.cmml"><mi id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.3.3.1.3.cmml">exp</mi><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1.1" xref="S3.E5.m1.3.3.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.cmml">{</mo><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml"><mo id="S3.E5.m1.3.3.1.1.1.1a" xref="S3.E5.m1.3.3.1.1.1.1.cmml">−</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.2.cmml"><msubsup id="S3.E5.m1.3.3.1.1.1.1.2.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.cmml">d</mi><msub id="S3.E5.m1.3.3.1.1.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3.2.cmml">o</mi><mi id="S3.E5.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3.3.cmml">j</mi></msub><mo id="S3.E5.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.3.3.1.1.1.1.2.1" xref="S3.E5.m1.3.3.1.1.1.1.2.1.cmml">/</mo><mi id="S3.E5.m1.3.3.1.1.1.1.2.3" xref="S3.E5.m1.3.3.1.1.1.1.2.3.cmml">T</mi></mrow></mrow><mo id="S3.E5.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.cmml">}</mo></mrow></mrow><mrow id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.2.cmml"><msubsup id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml"><mo id="S3.E5.m1.4.4.2.2.2.2" xref="S3.E5.m1.4.4.2.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.4.4.2.2.2.3" xref="S3.E5.m1.4.4.2.2.2.3.cmml"><mi id="S3.E5.m1.4.4.2.2.2.3.2" xref="S3.E5.m1.4.4.2.2.2.3.2.cmml">ι</mi><mo id="S3.E5.m1.4.4.2.2.2.3.1" xref="S3.E5.m1.4.4.2.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.4.4.2.2.2.3.3" xref="S3.E5.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.4.4.2.2.3" xref="S3.E5.m1.4.4.2.2.3.cmml">K</mi></msubsup><mrow id="S3.E5.m1.4.4.2.1" xref="S3.E5.m1.4.4.2.1.cmml"><mi id="S3.E5.m1.4.4.2.1.3" xref="S3.E5.m1.4.4.2.1.3.cmml">exp</mi><mo id="S3.E5.m1.4.4.2.1.2" xref="S3.E5.m1.4.4.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.4.4.2.1.1.1" xref="S3.E5.m1.4.4.2.1.1.2.cmml"><mo id="S3.E5.m1.4.4.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.4.4.2.1.1.2.cmml">{</mo><mrow id="S3.E5.m1.4.4.2.1.1.1.1" xref="S3.E5.m1.4.4.2.1.1.1.1.cmml"><mo id="S3.E5.m1.4.4.2.1.1.1.1a" xref="S3.E5.m1.4.4.2.1.1.1.1.cmml">−</mo><mrow id="S3.E5.m1.4.4.2.1.1.1.1.2" xref="S3.E5.m1.4.4.2.1.1.1.1.2.cmml"><msubsup id="S3.E5.m1.4.4.2.1.1.1.1.2.2" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.cmml"><mi id="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.2" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.2.cmml">d</mi><msub id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.2" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.2.cmml">o</mi><mi id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.3" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.3.cmml">ι</mi></msub><mo id="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.3" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.3.cmml">′</mo></msubsup><mo id="S3.E5.m1.4.4.2.1.1.1.1.2.1" xref="S3.E5.m1.4.4.2.1.1.1.1.2.1.cmml">/</mo><mi id="S3.E5.m1.4.4.2.1.1.1.1.2.3" xref="S3.E5.m1.4.4.2.1.1.1.1.2.3.cmml">T</mi></mrow></mrow><mo id="S3.E5.m1.4.4.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.4.4.2.1.1.2.cmml">}</mo></mrow></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.3.cmml" xref="S3.E5.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.3a.cmml" xref="S3.E5.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1.1"><eq id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"></eq><ci id="S3.E5.m1.5.5.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.3">𝑑</ci><apply id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"><times id="S3.E5.m1.5.5.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.2"></times><ci id="S3.E5.m1.5.5.1.1.1.3.cmml" xref="S3.E5.m1.5.5.1.1.1.3">𝐒𝐨𝐟𝐭𝐦𝐚𝐱</ci><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1"><minus id="S3.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1"></minus><apply id="S3.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S3.E5.m1.5.5.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.5.5.1.1.1.1.1.1.2.3">′′</ci></apply></apply></apply></apply><apply id="S3.E5.m1.6.6.2.2.cmml" xref="S3.E5.m1.6.6.2.2"><and id="S3.E5.m1.6.6.2.2a.cmml" xref="S3.E5.m1.6.6.2.2"></and><apply id="S3.E5.m1.6.6.2.2b.cmml" xref="S3.E5.m1.6.6.2.2"><eq id="S3.E5.m1.6.6.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.3"></eq><apply id="S3.E5.m1.6.6.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.2.2.2.1.cmml" xref="S3.E5.m1.6.6.2.2.2">subscript</csymbol><ci id="S3.E5.m1.6.6.2.2.2.2.cmml" xref="S3.E5.m1.6.6.2.2.2.2">𝑑</ci><ci id="S3.E5.m1.6.6.2.2.2.3.cmml" xref="S3.E5.m1.6.6.2.2.2.3">𝑗</ci></apply><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><divide id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2"></divide><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><times id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">exp</ci><set id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1"><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><minus id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"></minus><apply id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.2">𝑑</ci><ci id="S3.E5.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.2.3">′′</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2.3">𝑗</ci></apply></apply></set></apply><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2">subscript</csymbol><sum id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2"></sum><apply id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3"><eq id="S3.E5.m1.2.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.2.3.1"></eq><ci id="S3.E5.m1.2.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.2.3.2">𝜄</ci><cn id="S3.E5.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E5.m1.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.1"><times id="S3.E5.m1.2.2.2.1.2.cmml" xref="S3.E5.m1.2.2.2.1.2"></times><ci id="S3.E5.m1.2.2.2.1.3.cmml" xref="S3.E5.m1.2.2.2.1.3">exp</ci><set id="S3.E5.m1.2.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.2.1.1.1"><apply id="S3.E5.m1.2.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1"><minus id="S3.E5.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1"></minus><apply id="S3.E5.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2">subscript</csymbol><apply id="S3.E5.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2.2.2">𝑑</ci><ci id="S3.E5.m1.2.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2.2.3">′′</ci></apply><ci id="S3.E5.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.2.1.1.1.1.2.3">𝜄</ci></apply></apply></set></apply></apply></apply></apply><apply id="S3.E5.m1.6.6.2.2c.cmml" xref="S3.E5.m1.6.6.2.2"><eq id="S3.E5.m1.6.6.2.2.4.cmml" xref="S3.E5.m1.6.6.2.2.4"></eq><share href="https://arxiv.org/html/2409.20181v1#S3.E5.m1.2.2.cmml" id="S3.E5.m1.6.6.2.2d.cmml" xref="S3.E5.m1.6.6.2.2"></share><apply id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"><divide id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4"></divide><apply id="S3.E5.m1.3.3.1.cmml" xref="S3.E5.m1.3.3.1"><times id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1.2"></times><ci id="S3.E5.m1.3.3.1.3.cmml" xref="S3.E5.m1.3.3.1.3">exp</ci><set id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1"><apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><minus id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1"></minus><apply id="S3.E5.m1.3.3.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2"><divide id="S3.E5.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.1"></divide><apply id="S3.E5.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2">𝑑</ci><ci id="S3.E5.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.3">′</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3.2">𝑜</ci><ci id="S3.E5.m1.3.3.1.1.1.1.2.2.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><ci id="S3.E5.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.3">𝑇</ci></apply></apply></set></apply><apply id="S3.E5.m1.4.4.2.cmml" xref="S3.E5.m1.4.4.2"><apply id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2">superscript</csymbol><apply id="S3.E5.m1.4.4.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.2.2.1.cmml" xref="S3.E5.m1.4.4.2.2">subscript</csymbol><sum id="S3.E5.m1.4.4.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.2.2.2"></sum><apply id="S3.E5.m1.4.4.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.2.3"><eq id="S3.E5.m1.4.4.2.2.2.3.1.cmml" xref="S3.E5.m1.4.4.2.2.2.3.1"></eq><ci id="S3.E5.m1.4.4.2.2.2.3.2.cmml" xref="S3.E5.m1.4.4.2.2.2.3.2">𝜄</ci><cn id="S3.E5.m1.4.4.2.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.4.4.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.4.4.2.2.3.cmml" xref="S3.E5.m1.4.4.2.2.3">𝐾</ci></apply><apply id="S3.E5.m1.4.4.2.1.cmml" xref="S3.E5.m1.4.4.2.1"><times id="S3.E5.m1.4.4.2.1.2.cmml" xref="S3.E5.m1.4.4.2.1.2"></times><ci id="S3.E5.m1.4.4.2.1.3.cmml" xref="S3.E5.m1.4.4.2.1.3">exp</ci><set id="S3.E5.m1.4.4.2.1.1.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1"><apply id="S3.E5.m1.4.4.2.1.1.1.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1"><minus id="S3.E5.m1.4.4.2.1.1.1.1.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1"></minus><apply id="S3.E5.m1.4.4.2.1.1.1.1.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2"><divide id="S3.E5.m1.4.4.2.1.1.1.1.2.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.1"></divide><apply id="S3.E5.m1.4.4.2.1.1.1.1.2.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2">subscript</csymbol><apply id="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.2">𝑑</ci><ci id="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.2.3">′</ci></apply><apply id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.2">𝑜</ci><ci id="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.3.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.2.3.3">𝜄</ci></apply></apply><ci id="S3.E5.m1.4.4.2.1.1.1.1.2.3.cmml" xref="S3.E5.m1.4.4.2.1.1.1.1.2.3">𝑇</ci></apply></apply></set></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">d=\mathbf{Softmax}(-d^{\prime\prime}),\quad d_{j}=\frac{\mathrm{exp}\{-d^{%
\prime\prime}_{j}\}}{\sum_{\iota=1}^{K}{\mathrm{exp}\{-d^{\prime\prime}_{\iota%
}\}}}=\frac{\mathrm{exp}\{-d^{\prime}_{o_{j}}/T\}}{\sum_{\iota=1}^{K}{\mathrm{%
exp}\{-d^{\prime}_{o_{\iota}}/T\}}}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.6d">italic_d = bold_Softmax ( - italic_d start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) , italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = divide start_ARG roman_exp { - italic_d start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT } end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_ι = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp { - italic_d start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_ι end_POSTSUBSCRIPT } end_ARG = divide start_ARG roman_exp { - italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT / italic_T } end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_ι = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp { - italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_ι end_POSTSUBSCRIPT end_POSTSUBSCRIPT / italic_T } end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS2.Px3">
<h5 class="ltx_title ltx_title_paragraph">Aggregation</h5>
<div class="ltx_para" id="S3.SS2.SSS2.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS2.Px3.p1.4">We calculate the final reference possibility distribution <math alttext="\mathbf{r}=[r_{1},r_{2},...,r_{|\mathcal{Y}|}]\in\mathbb{R}^{|\mathcal{Y}|}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p1.1.m1.6"><semantics id="S3.SS2.SSS2.Px3.p1.1.m1.6a"><mrow id="S3.SS2.SSS2.Px3.p1.1.m1.6.6" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.cmml"><mi id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.5" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.5.cmml">𝐫</mi><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.6" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.6.cmml">=</mo><mrow id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml"><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.4" stretchy="false" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml">[</mo><msub id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.2" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.2.cmml">r</mi><mn id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.3" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.5" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.cmml"><mi id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.2" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.2.cmml">r</mi><mn id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.3" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.6" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.Px3.p1.1.m1.3.3" mathvariant="normal" xref="S3.SS2.SSS2.Px3.p1.1.m1.3.3.cmml">…</mi><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.7" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.cmml"><mi id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.2" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.2.cmml">r</mi><mrow id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.1.cmml">𝒴</mi><mo id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.8" stretchy="false" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml">]</mo></mrow><mo id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.7" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.7.cmml">∈</mo><msup id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.cmml"><mi id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.2" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.3" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.2.cmml"><mo id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.1" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.1.cmml">𝒴</mi><mo id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.2.1.cmml">|</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p1.1.m1.6b"><apply id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6"><and id="S3.SS2.SSS2.Px3.p1.1.m1.6.6a.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6"></and><apply id="S3.SS2.SSS2.Px3.p1.1.m1.6.6b.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6"><eq id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.6.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.6"></eq><ci id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.5.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.5">𝐫</ci><list id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.4.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3"><apply id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.2">𝑟</ci><cn id="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.Px3.p1.1.m1.4.4.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.2">𝑟</ci><cn id="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.Px3.p1.1.m1.5.5.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.Px3.p1.1.m1.3.3.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.3.3">…</ci><apply id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.3.3.2">𝑟</ci><apply id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.3"><abs id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.3.1"></abs><ci id="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.1.1.1.1">𝒴</ci></apply></apply></list></apply><apply id="S3.SS2.SSS2.Px3.p1.1.m1.6.6c.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6"><in id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.7.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.7"></in><share href="https://arxiv.org/html/2409.20181v1#S3.SS2.SSS2.Px3.p1.1.m1.6.6.3.cmml" id="S3.SS2.SSS2.Px3.p1.1.m1.6.6d.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6"></share><apply id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8">superscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.6.6.8.2">ℝ</ci><apply id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.2.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.3"><abs id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.3.1"></abs><ci id="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.1.m1.2.2.1.1">𝒴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p1.1.m1.6c">\mathbf{r}=[r_{1},r_{2},...,r_{|\mathcal{Y}|}]\in\mathbb{R}^{|\mathcal{Y}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p1.1.m1.6d">bold_r = [ italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_r start_POSTSUBSCRIPT | caligraphic_Y | end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_Y | end_POSTSUPERSCRIPT</annotation></semantics></math> by aggregating all <math alttext="d_{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p1.2.m2.1"><semantics id="S3.SS2.SSS2.Px3.p1.2.m2.1a"><msub id="S3.SS2.SSS2.Px3.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.Px3.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px3.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p1.2.m2.1b"><apply id="S3.SS2.SSS2.Px3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1.2">𝑑</ci><ci id="S3.SS2.SSS2.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px3.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p1.2.m2.1c">d_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> that satisfies <math alttext="v_{o_{j}}=y_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p1.3.m3.1"><semantics id="S3.SS2.SSS2.Px3.p1.3.m3.1a"><mrow id="S3.SS2.SSS2.Px3.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.cmml"><msub id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.2" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.2.cmml">v</mi><msub id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.cmml"><mi id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.2" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.2.cmml">o</mi><mi id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.3" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.3.cmml">j</mi></msub></msub><mo id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.1" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.1.cmml">=</mo><msub id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p1.3.m3.1b"><apply id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1"><eq id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.1"></eq><apply id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.2">𝑣</ci><apply id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.1.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.2.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.2">𝑜</ci><ci id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.3.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.2">𝑦</ci><ci id="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px3.p1.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p1.3.m3.1c">v_{o_{j}}=y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p1.3.m3.1d">italic_v start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="y_{i}\in\mathcal{Y}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p1.4.m4.1"><semantics id="S3.SS2.SSS2.Px3.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.Px3.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.cmml"><msub id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.2.cmml">y</mi><mi id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.3" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.1" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p1.4.m4.1b"><apply id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1"><in id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.1"></in><apply id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.2">𝑦</ci><ci id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.Px3.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px3.p1.4.m4.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p1.4.m4.1c">y_{i}\in\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ caligraphic_Y</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{i}=\sum_{v_{o_{j}}=y_{i}}d_{j}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">r</mi><mi id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1" rspace="0.111em" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><munder id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml"><mo id="S3.E6.m1.1.1.3.1.2" movablelimits="false" xref="S3.E6.m1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.3.1.3" xref="S3.E6.m1.1.1.3.1.3.cmml"><msub id="S3.E6.m1.1.1.3.1.3.2" xref="S3.E6.m1.1.1.3.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.1.3.2.2" xref="S3.E6.m1.1.1.3.1.3.2.2.cmml">v</mi><msub id="S3.E6.m1.1.1.3.1.3.2.3" xref="S3.E6.m1.1.1.3.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.3.1.3.2.3.2" xref="S3.E6.m1.1.1.3.1.3.2.3.2.cmml">o</mi><mi id="S3.E6.m1.1.1.3.1.3.2.3.3" xref="S3.E6.m1.1.1.3.1.3.2.3.3.cmml">j</mi></msub></msub><mo id="S3.E6.m1.1.1.3.1.3.1" xref="S3.E6.m1.1.1.3.1.3.1.cmml">=</mo><msub id="S3.E6.m1.1.1.3.1.3.3" xref="S3.E6.m1.1.1.3.1.3.3.cmml"><mi id="S3.E6.m1.1.1.3.1.3.3.2" xref="S3.E6.m1.1.1.3.1.3.3.2.cmml">y</mi><mi id="S3.E6.m1.1.1.3.1.3.3.3" xref="S3.E6.m1.1.1.3.1.3.3.3.cmml">i</mi></msub></mrow></munder><msub id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml">d</mi><mi id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">𝑟</ci><ci id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><apply id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.3.1">subscript</csymbol><sum id="S3.E6.m1.1.1.3.1.2.cmml" xref="S3.E6.m1.1.1.3.1.2"></sum><apply id="S3.E6.m1.1.1.3.1.3.cmml" xref="S3.E6.m1.1.1.3.1.3"><eq id="S3.E6.m1.1.1.3.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1.3.1"></eq><apply id="S3.E6.m1.1.1.3.1.3.2.cmml" xref="S3.E6.m1.1.1.3.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.3.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.1.3.2.2">𝑣</ci><apply id="S3.E6.m1.1.1.3.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.3.1.3.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.3.1.3.2.3.2">𝑜</ci><ci id="S3.E6.m1.1.1.3.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.3.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.1.1.3.1.3.3.cmml" xref="S3.E6.m1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.3.3.1.cmml" xref="S3.E6.m1.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.1.3.3.2.cmml" xref="S3.E6.m1.1.1.3.1.3.3.2">𝑦</ci><ci id="S3.E6.m1.1.1.3.1.3.3.3.cmml" xref="S3.E6.m1.1.1.3.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">𝑑</ci><ci id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">r_{i}=\sum_{v_{o_{j}}=y_{i}}d_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_o start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT = italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_d start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.Px3.p2">
<p class="ltx_p" id="S3.SS2.SSS2.Px3.p2.3">We denote <math alttext="\mathcal{R}(\cdot,\mathcal{L}):\mathbb{R}^{d_{m}}\to\mathbb{R}^{|\mathcal{Y}|}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p2.1.m1.3"><semantics id="S3.SS2.SSS2.Px3.p2.1.m1.3a"><mrow id="S3.SS2.SSS2.Px3.p2.1.m1.3.4" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.cmml"><mrow id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.2.cmml">ℛ</mi><mo id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.1" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.1.cmml"><mo id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.1.cmml">(</mo><mo id="S3.SS2.SSS2.Px3.p2.1.m1.2.2" lspace="0em" rspace="0em" xref="S3.SS2.SSS2.Px3.p2.1.m1.2.2.cmml">⋅</mo><mo id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.2.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p2.1.m1.3.3" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.3.cmml">ℒ</mi><mo id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.2.3" rspace="0.278em" stretchy="false" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.1" rspace="0.278em" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.1.cmml">:</mo><mrow id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.cmml"><msup id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.cmml"><mi id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.2.cmml">ℝ</mi><msub id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.cmml"><mi id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.2.cmml">d</mi><mi id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.3" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.3.cmml">m</mi></msub></msup><mo id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.1.cmml">→</mo><msup id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.cmml"><mi id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.2" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.3" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.1.cmml">𝒴</mi><mo id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p2.1.m1.3b"><apply id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4"><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.1">:</ci><apply id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2"><times id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.1"></times><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.2">ℛ</ci><interval closure="open" id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.2.3.2"><ci id="S3.SS2.SSS2.Px3.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.2.2">⋅</ci><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.3.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.3">ℒ</ci></interval></apply><apply id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3"><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.1">→</ci><apply id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2">superscript</csymbol><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.2">ℝ</ci><apply id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.2">𝑑</ci><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.3.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.2.3.3">𝑚</ci></apply></apply><apply id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3">superscript</csymbol><ci id="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.3.4.3.3.2">ℝ</ci><apply id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.3"><abs id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.3.1"></abs><ci id="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p2.1.m1.1.1.1.1">𝒴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p2.1.m1.3c">\mathcal{R}(\cdot,\mathcal{L}):\mathbb{R}^{d_{m}}\to\mathbb{R}^{|\mathcal{Y}|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p2.1.m1.3d">caligraphic_R ( ⋅ , caligraphic_L ) : blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT → blackboard_R start_POSTSUPERSCRIPT | caligraphic_Y | end_POSTSUPERSCRIPT</annotation></semantics></math> as the function represents all three stages of querying the datastore <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p2.2.m2.1"><semantics id="S3.SS2.SSS2.Px3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p2.2.m2.1.1" xref="S3.SS2.SSS2.Px3.p2.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p2.2.m2.1b"><ci id="S3.SS2.SSS2.Px3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px3.p2.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p2.2.m2.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p2.2.m2.1d">caligraphic_L</annotation></semantics></math> and building the corresponding reference possibility distribution <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p2.3.m3.1"><semantics id="S3.SS2.SSS2.Px3.p2.3.m3.1a"><mi id="S3.SS2.SSS2.Px3.p2.3.m3.1.1" xref="S3.SS2.SSS2.Px3.p2.3.m3.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p2.3.m3.1b"><ci id="S3.SS2.SSS2.Px3.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px3.p2.3.m3.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p2.3.m3.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p2.3.m3.1d">bold_r</annotation></semantics></math>. Therefore, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{r}=\mathcal{R}(h^{(l)},\mathcal{L})" class="ltx_Math" display="block" id="S3.E7.m1.3"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mi id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml">𝐫</mi><mo id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.2.cmml">=</mo><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.3.3.1.3" xref="S3.E7.m1.3.3.1.3.cmml">ℛ</mi><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.2.cmml"><mo id="S3.E7.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.cmml">(</mo><msup id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">h</mi><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.3.1" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">l</mi><mo id="S3.E7.m1.1.1.1.3.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E7.m1.3.3.1.1.1.3" xref="S3.E7.m1.3.3.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">ℒ</mi><mo id="S3.E7.m1.3.3.1.1.1.4" stretchy="false" xref="S3.E7.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><eq id="S3.E7.m1.3.3.2.cmml" xref="S3.E7.m1.3.3.2"></eq><ci id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3">𝐫</ci><apply id="S3.E7.m1.3.3.1.cmml" xref="S3.E7.m1.3.3.1"><times id="S3.E7.m1.3.3.1.2.cmml" xref="S3.E7.m1.3.3.1.2"></times><ci id="S3.E7.m1.3.3.1.3.cmml" xref="S3.E7.m1.3.3.1.3">ℛ</ci><interval closure="open" id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1"><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2">ℎ</ci><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑙</ci></apply><ci id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2">ℒ</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">\mathbf{r}=\mathcal{R}(h^{(l)},\mathcal{L})</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.3d">bold_r = caligraphic_R ( italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , caligraphic_L )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.Px3.p3">
<p class="ltx_p" id="S3.SS2.SSS2.Px3.p3.6">Additionally, when <math alttext="|\mathcal{Y}|=v" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p3.1.m1.1"><semantics id="S3.SS2.SSS2.Px3.p3.1.m1.1a"><mrow id="S3.SS2.SSS2.Px3.p3.1.m1.1.2" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.cmml"><mrow id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.2" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.1.cmml"><mo id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.2.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p3.1.m1.1.1" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.1.cmml">𝒴</mi><mo id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.2.2" stretchy="false" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.1" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.1.cmml">=</mo><mi id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.3" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.3.cmml">v</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p3.1.m1.1b"><apply id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.cmml" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2"><eq id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.1"></eq><apply id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.2"><abs id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.2.2.1"></abs><ci id="S3.SS2.SSS2.Px3.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.1">𝒴</ci></apply><ci id="S3.SS2.SSS2.Px3.p3.1.m1.1.2.3.cmml" xref="S3.SS2.SSS2.Px3.p3.1.m1.1.2.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p3.1.m1.1c">|\mathcal{Y}|=v</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p3.1.m1.1d">| caligraphic_Y | = italic_v</annotation></semantics></math>, we can merge the distribution <math alttext="\mathbf{p}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p3.2.m2.1"><semantics id="S3.SS2.SSS2.Px3.p3.2.m2.1a"><mi id="S3.SS2.SSS2.Px3.p3.2.m2.1.1" xref="S3.SS2.SSS2.Px3.p3.2.m2.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p3.2.m2.1b"><ci id="S3.SS2.SSS2.Px3.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.2.m2.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p3.2.m2.1c">\mathbf{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p3.2.m2.1d">bold_p</annotation></semantics></math> given by <math alttext="\mathtt{LM\_Head}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p3.3.m3.1"><semantics id="S3.SS2.SSS2.Px3.p3.3.m3.1a"><mrow id="S3.SS2.SSS2.Px3.p3.3.m3.1.2" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.cmml"><mi id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.2" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.2.cmml">𝙻𝙼</mi><mo id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.3" mathvariant="normal" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.3.cmml">_</mi><mo id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1a" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1.cmml">⁢</mo><mi id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.4" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.4.cmml">𝙷𝚎𝚊𝚍</mi><mo id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1b" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.5.2" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.cmml"><mo id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.5.2.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.cmml">(</mo><mo id="S3.SS2.SSS2.Px3.p3.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.5.2.2" stretchy="false" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p3.3.m3.1b"><apply id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.cmml" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2"><times id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1.cmml" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.1"></times><ci id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.2.cmml" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.2">𝙻𝙼</ci><ci id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.3.cmml" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.3">_</ci><ci id="S3.SS2.SSS2.Px3.p3.3.m3.1.2.4.cmml" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.2.4">𝙷𝚎𝚊𝚍</ci><ci id="S3.SS2.SSS2.Px3.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p3.3.m3.1c">\mathtt{LM\_Head}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p3.3.m3.1d">typewriter_LM _ typewriter_Head ( ⋅ )</annotation></semantics></math> and <math alttext="\mathbf{r}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p3.4.m4.1"><semantics id="S3.SS2.SSS2.Px3.p3.4.m4.1a"><mi id="S3.SS2.SSS2.Px3.p3.4.m4.1.1" xref="S3.SS2.SSS2.Px3.p3.4.m4.1.1.cmml">𝐫</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p3.4.m4.1b"><ci id="S3.SS2.SSS2.Px3.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.4.m4.1.1">𝐫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p3.4.m4.1c">\mathbf{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p3.4.m4.1d">bold_r</annotation></semantics></math> given by <math alttext="\mathcal{R}(\cdot,\mathcal{L})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p3.5.m5.2"><semantics id="S3.SS2.SSS2.Px3.p3.5.m5.2a"><mrow id="S3.SS2.SSS2.Px3.p3.5.m5.2.3" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.2" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.2.cmml">ℛ</mi><mo id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.1" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.2" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.1.cmml"><mo id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.1.cmml">(</mo><mo id="S3.SS2.SSS2.Px3.p3.5.m5.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS2.Px3.p3.5.m5.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.2.2" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px3.p3.5.m5.2.2" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.2.cmml">ℒ</mi><mo id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.2.3" stretchy="false" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p3.5.m5.2b"><apply id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.cmml" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3"><times id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.1.cmml" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.1"></times><ci id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.2.cmml" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.2">ℛ</ci><interval closure="open" id="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.1.cmml" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.3.3.2"><ci id="S3.SS2.SSS2.Px3.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.5.m5.1.1">⋅</ci><ci id="S3.SS2.SSS2.Px3.p3.5.m5.2.2.cmml" xref="S3.SS2.SSS2.Px3.p3.5.m5.2.2">ℒ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p3.5.m5.2c">\mathcal{R}(\cdot,\mathcal{L})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p3.5.m5.2d">caligraphic_R ( ⋅ , caligraphic_L )</annotation></semantics></math> with a hyper-parameter <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS2.SSS2.Px3.p3.6.m6.1"><semantics id="S3.SS2.SSS2.Px3.p3.6.m6.1a"><mi id="S3.SS2.SSS2.Px3.p3.6.m6.1.1" xref="S3.SS2.SSS2.Px3.p3.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px3.p3.6.m6.1b"><ci id="S3.SS2.SSS2.Px3.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px3.p3.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px3.p3.6.m6.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.Px3.p3.6.m6.1d">italic_λ</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="d^{\prime}=\lambda\cdot\mathbf{r}+(1-\lambda)\cdot\mathbf{p}" class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msup id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">d</mi><mo id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml">′</mo></msup><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.3.2.cmml">λ</mi><mo id="S3.E8.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.1.1.1.3.1.cmml">⋅</mo><mi id="S3.E8.m1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.3.3.cmml">𝐫</mi></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo id="S3.E8.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E8.m1.1.1.1.1.2" rspace="0.222em" xref="S3.E8.m1.1.1.1.1.2.cmml">⋅</mo><mi id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml">𝐩</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></eq><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3">superscript</csymbol><ci id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2">𝑑</ci><ci id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3">′</ci></apply><apply id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><plus id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.2"></plus><apply id="S3.E8.m1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.3"><ci id="S3.E8.m1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.3.1">⋅</ci><ci id="S3.E8.m1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.3.2">𝜆</ci><ci id="S3.E8.m1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.3.3">𝐫</ci></apply><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1"><ci id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2">⋅</ci><apply id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><minus id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E8.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E8.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.3">𝜆</ci></apply><ci id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3">𝐩</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">d^{\prime}=\lambda\cdot\mathbf{r}+(1-\lambda)\cdot\mathbf{p}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_d start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_λ ⋅ bold_r + ( 1 - italic_λ ) ⋅ bold_p</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.Px3.p3.7">which is a common fusion method for mixing two distributions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib33" title="">33</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib22" title="">22</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib12" title="">12</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib10" title="">10</a>]</cite>.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="217" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Three stages of reference trustable decoding.</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Multi-head Reference Trustable Decoding</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.5">Large language models like LLaMA2-70B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib38" title="">38</a>]</cite> or Mistral-7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib1" title="">1</a>]</cite> utilized MHA and GQA mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib2" title="">2</a>]</cite>, implies the potential of splitting a large attention vector into smaller ones. So we adapt this method into our RTD process. We define <math alttext="n_{h}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">n</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑛</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">n_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> of the head count of the LM model, and <math alttext="d_{h}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">d</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑑</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">d_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> the dimension of the each attention head where <math alttext="d_{m}=n_{h}\cdot d_{h}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><msub id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2.2" xref="S3.SS3.p1.3.m3.1.1.2.2.cmml">d</mi><mi id="S3.SS3.p1.3.m3.1.1.2.3" xref="S3.SS3.p1.3.m3.1.1.2.3.cmml">m</mi></msub><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><msub id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2.2" xref="S3.SS3.p1.3.m3.1.1.3.2.2.cmml">n</mi><mi id="S3.SS3.p1.3.m3.1.1.3.2.3" xref="S3.SS3.p1.3.m3.1.1.3.2.3.cmml">h</mi></msub><mo id="S3.SS3.p1.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">⋅</mo><msub id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.3.2" xref="S3.SS3.p1.3.m3.1.1.3.3.2.cmml">d</mi><mi id="S3.SS3.p1.3.m3.1.1.3.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.3.cmml">h</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><eq id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></eq><apply id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2">𝑑</ci><ci id="S3.SS3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3">𝑚</ci></apply><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><ci id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1">⋅</ci><apply id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.3.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.3.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2.2">𝑛</ci><ci id="S3.SS3.p1.3.m3.1.1.3.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2.3">ℎ</ci></apply><apply id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">d_{m}=n_{h}\cdot d_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math>. with this in mind, we split the reference datastore into <math alttext="n_{h}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">n_{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT</annotation></semantics></math> sub-datastore by head. When decoding, we first split <math alttext="h^{(l)}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><msup id="S3.SS3.p1.5.m5.1.2" xref="S3.SS3.p1.5.m5.1.2.cmml"><mi id="S3.SS3.p1.5.m5.1.2.2" xref="S3.SS3.p1.5.m5.1.2.2.cmml">h</mi><mrow id="S3.SS3.p1.5.m5.1.1.1.3" xref="S3.SS3.p1.5.m5.1.2.cmml"><mo id="S3.SS3.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.5.m5.1.2.cmml">(</mo><mi id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.cmml">l</mi><mo id="S3.SS3.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.2.cmml" xref="S3.SS3.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.2">superscript</csymbol><ci id="S3.SS3.p1.5.m5.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.2.2">ℎ</ci><ci id="S3.SS3.p1.5.m5.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">h^{(l)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT</annotation></semantics></math> in to heads, then query each sub-datastore and merge the result, showcased in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.F5" title="Figure 5 ‣ 3.3 Multi-head Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>. Mathematically,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E9">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle k^{(i)}=k\left[d_{h}\times(i-1):\ d_{h}\times i\right],\quad h^{%
(l,i)}=h^{(l)}\left[d_{h}\times(i-1):\ d_{h}\times i\right]" class="ltx_math_unparsed" display="inline" id="S3.E9X.2.1.1.m1.4"><semantics id="S3.E9X.2.1.1.m1.4a"><mrow id="S3.E9X.2.1.1.m1.4b"><msup id="S3.E9X.2.1.1.m1.4.5"><mi id="S3.E9X.2.1.1.m1.4.5.2">k</mi><mrow id="S3.E9X.2.1.1.m1.1.1.1.3"><mo id="S3.E9X.2.1.1.m1.1.1.1.3.1" stretchy="false">(</mo><mi id="S3.E9X.2.1.1.m1.1.1.1.1">i</mi><mo id="S3.E9X.2.1.1.m1.1.1.1.3.2" stretchy="false">)</mo></mrow></msup><mo id="S3.E9X.2.1.1.m1.4.6">=</mo><mi id="S3.E9X.2.1.1.m1.4.7">k</mi><mrow id="S3.E9X.2.1.1.m1.4.8"><mo id="S3.E9X.2.1.1.m1.4.8.1">[</mo><msub id="S3.E9X.2.1.1.m1.4.8.2"><mi id="S3.E9X.2.1.1.m1.4.8.2.2">d</mi><mi id="S3.E9X.2.1.1.m1.4.8.2.3">h</mi></msub><mo id="S3.E9X.2.1.1.m1.4.8.3" lspace="0.222em" rspace="0.222em">×</mo><mrow id="S3.E9X.2.1.1.m1.4.8.4"><mo id="S3.E9X.2.1.1.m1.4.8.4.1" stretchy="false">(</mo><mi id="S3.E9X.2.1.1.m1.4.8.4.2">i</mi><mo id="S3.E9X.2.1.1.m1.4.8.4.3">−</mo><mn id="S3.E9X.2.1.1.m1.4.8.4.4">1</mn><mo id="S3.E9X.2.1.1.m1.4.8.4.5" rspace="0.278em" stretchy="false">)</mo></mrow><mo id="S3.E9X.2.1.1.m1.4.8.5" rspace="0.778em">:</mo><msub id="S3.E9X.2.1.1.m1.4.8.6"><mi id="S3.E9X.2.1.1.m1.4.8.6.2">d</mi><mi id="S3.E9X.2.1.1.m1.4.8.6.3">h</mi></msub><mo id="S3.E9X.2.1.1.m1.4.8.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.E9X.2.1.1.m1.4.8.8">i</mi><mo id="S3.E9X.2.1.1.m1.4.8.9">]</mo></mrow><mo id="S3.E9X.2.1.1.m1.4.9" rspace="1.167em">,</mo><msup id="S3.E9X.2.1.1.m1.4.10"><mi id="S3.E9X.2.1.1.m1.4.10.2">h</mi><mrow id="S3.E9X.2.1.1.m1.3.3.2.4"><mo id="S3.E9X.2.1.1.m1.3.3.2.4.1" stretchy="false">(</mo><mi id="S3.E9X.2.1.1.m1.2.2.1.1">l</mi><mo id="S3.E9X.2.1.1.m1.3.3.2.4.2">,</mo><mi id="S3.E9X.2.1.1.m1.3.3.2.2">i</mi><mo id="S3.E9X.2.1.1.m1.3.3.2.4.3" stretchy="false">)</mo></mrow></msup><mo id="S3.E9X.2.1.1.m1.4.11">=</mo><msup id="S3.E9X.2.1.1.m1.4.12"><mi id="S3.E9X.2.1.1.m1.4.12.2">h</mi><mrow id="S3.E9X.2.1.1.m1.4.4.1.3"><mo id="S3.E9X.2.1.1.m1.4.4.1.3.1" stretchy="false">(</mo><mi id="S3.E9X.2.1.1.m1.4.4.1.1">l</mi><mo id="S3.E9X.2.1.1.m1.4.4.1.3.2" stretchy="false">)</mo></mrow></msup><mrow id="S3.E9X.2.1.1.m1.4.13"><mo id="S3.E9X.2.1.1.m1.4.13.1">[</mo><msub id="S3.E9X.2.1.1.m1.4.13.2"><mi id="S3.E9X.2.1.1.m1.4.13.2.2">d</mi><mi id="S3.E9X.2.1.1.m1.4.13.2.3">h</mi></msub><mo id="S3.E9X.2.1.1.m1.4.13.3" lspace="0.222em" rspace="0.222em">×</mo><mrow id="S3.E9X.2.1.1.m1.4.13.4"><mo id="S3.E9X.2.1.1.m1.4.13.4.1" stretchy="false">(</mo><mi id="S3.E9X.2.1.1.m1.4.13.4.2">i</mi><mo id="S3.E9X.2.1.1.m1.4.13.4.3">−</mo><mn id="S3.E9X.2.1.1.m1.4.13.4.4">1</mn><mo id="S3.E9X.2.1.1.m1.4.13.4.5" rspace="0.278em" stretchy="false">)</mo></mrow><mo id="S3.E9X.2.1.1.m1.4.13.5" rspace="0.778em">:</mo><msub id="S3.E9X.2.1.1.m1.4.13.6"><mi id="S3.E9X.2.1.1.m1.4.13.6.2">d</mi><mi id="S3.E9X.2.1.1.m1.4.13.6.3">h</mi></msub><mo id="S3.E9X.2.1.1.m1.4.13.7" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.E9X.2.1.1.m1.4.13.8">i</mi><mo id="S3.E9X.2.1.1.m1.4.13.9">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E9X.2.1.1.m1.4c">\displaystyle k^{(i)}=k\left[d_{h}\times(i-1):\ d_{h}\times i\right],\quad h^{%
(l,i)}=h^{(l)}\left[d_{h}\times(i-1):\ d_{h}\times i\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E9X.2.1.1.m1.4d">italic_k start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_k [ italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × ( italic_i - 1 ) : italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_i ] , italic_h start_POSTSUPERSCRIPT ( italic_l , italic_i ) end_POSTSUPERSCRIPT = italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT [ italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × ( italic_i - 1 ) : italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_i ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E9Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}^{(i)}=\{(k^{(i)},v)|(k,v)\in(\mathcal{K},\mathcal{V})\}" class="ltx_Math" display="inline" id="S3.E9Xa.2.1.1.m1.9"><semantics id="S3.E9Xa.2.1.1.m1.9a"><mrow id="S3.E9Xa.2.1.1.m1.9.9" xref="S3.E9Xa.2.1.1.m1.9.9.cmml"><msup id="S3.E9Xa.2.1.1.m1.9.9.4" xref="S3.E9Xa.2.1.1.m1.9.9.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9Xa.2.1.1.m1.9.9.4.2" xref="S3.E9Xa.2.1.1.m1.9.9.4.2.cmml">ℒ</mi><mrow id="S3.E9Xa.2.1.1.m1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.9.9.4.cmml"><mo id="S3.E9Xa.2.1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.4.cmml">(</mo><mi id="S3.E9Xa.2.1.1.m1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.E9Xa.2.1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.4.cmml">)</mo></mrow></msup><mo id="S3.E9Xa.2.1.1.m1.9.9.3" xref="S3.E9Xa.2.1.1.m1.9.9.3.cmml">=</mo><mrow id="S3.E9Xa.2.1.1.m1.9.9.2.2" xref="S3.E9Xa.2.1.1.m1.9.9.2.3.cmml"><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.3" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.2.3.1.cmml">{</mo><mrow id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml"><mo id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.2" stretchy="false" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml">(</mo><msup id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml"><mi id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.cmml">k</mi><mrow id="S3.E9Xa.2.1.1.m1.2.2.1.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml"><mo id="S3.E9Xa.2.1.1.m1.2.2.1.3.1" stretchy="false" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml">(</mo><mi id="S3.E9Xa.2.1.1.m1.2.2.1.1" xref="S3.E9Xa.2.1.1.m1.2.2.1.1.cmml">i</mi><mo id="S3.E9Xa.2.1.1.m1.2.2.1.3.2" stretchy="false" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.3" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml">,</mo><mi id="S3.E9Xa.2.1.1.m1.3.3" xref="S3.E9Xa.2.1.1.m1.3.3.cmml">v</mi><mo id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.4" stretchy="false" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml">)</mo></mrow><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.4" lspace="0em" rspace="0em" xref="S3.E9Xa.2.1.1.m1.9.9.2.3.1.cmml">|</mo><mrow id="S3.E9Xa.2.1.1.m1.9.9.2.2.2" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.cmml"><mrow id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.2" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.1.cmml"><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.2.1" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.1.cmml">(</mo><mi id="S3.E9Xa.2.1.1.m1.4.4" xref="S3.E9Xa.2.1.1.m1.4.4.cmml">k</mi><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.2.2" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.1.cmml">,</mo><mi id="S3.E9Xa.2.1.1.m1.5.5" xref="S3.E9Xa.2.1.1.m1.5.5.cmml">v</mi><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.2.3" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.1.cmml">)</mo></mrow><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.1" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.1.cmml">∈</mo><mrow id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.2" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.1.cmml"><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.2.1" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9Xa.2.1.1.m1.6.6" xref="S3.E9Xa.2.1.1.m1.6.6.cmml">𝒦</mi><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.2.2" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E9Xa.2.1.1.m1.7.7" xref="S3.E9Xa.2.1.1.m1.7.7.cmml">𝒱</mi><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.2.3" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9Xa.2.1.1.m1.9.9.2.2.5" stretchy="false" xref="S3.E9Xa.2.1.1.m1.9.9.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9Xa.2.1.1.m1.9b"><apply id="S3.E9Xa.2.1.1.m1.9.9.cmml" xref="S3.E9Xa.2.1.1.m1.9.9"><eq id="S3.E9Xa.2.1.1.m1.9.9.3.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.3"></eq><apply id="S3.E9Xa.2.1.1.m1.9.9.4.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.4"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.9.9.4.1.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.4">superscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.9.9.4.2.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.4.2">ℒ</ci><ci id="S3.E9Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E9Xa.2.1.1.m1.9.9.2.3.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.2.2"><csymbol cd="latexml" id="S3.E9Xa.2.1.1.m1.9.9.2.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.3">conditional-set</csymbol><interval closure="open" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1"><apply id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1">superscript</csymbol><ci id="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E9Xa.2.1.1.m1.8.8.1.1.1.1.1.2">𝑘</ci><ci id="S3.E9Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E9Xa.2.1.1.m1.2.2.1.1">𝑖</ci></apply><ci id="S3.E9Xa.2.1.1.m1.3.3.cmml" xref="S3.E9Xa.2.1.1.m1.3.3">𝑣</ci></interval><apply id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2"><in id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.1"></in><interval closure="open" id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.1.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.2.2"><ci id="S3.E9Xa.2.1.1.m1.4.4.cmml" xref="S3.E9Xa.2.1.1.m1.4.4">𝑘</ci><ci id="S3.E9Xa.2.1.1.m1.5.5.cmml" xref="S3.E9Xa.2.1.1.m1.5.5">𝑣</ci></interval><interval closure="open" id="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.1.cmml" xref="S3.E9Xa.2.1.1.m1.9.9.2.2.2.3.2"><ci id="S3.E9Xa.2.1.1.m1.6.6.cmml" xref="S3.E9Xa.2.1.1.m1.6.6">𝒦</ci><ci id="S3.E9Xa.2.1.1.m1.7.7.cmml" xref="S3.E9Xa.2.1.1.m1.7.7">𝒱</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9Xa.2.1.1.m1.9c">\displaystyle\mathcal{L}^{(i)}=\{(k^{(i)},v)|(k,v)\in(\mathcal{K},\mathcal{V})\}</annotation><annotation encoding="application/x-llamapun" id="S3.E9Xa.2.1.1.m1.9d">caligraphic_L start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = { ( italic_k start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_v ) | ( italic_k , italic_v ) ∈ ( caligraphic_K , caligraphic_V ) }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.SS3.p1.6">And we denote <math alttext="\mathcal{R}_{\mathrm{MH}}(\cdot,\mathcal{L})" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m1.2"><semantics id="S3.SS3.p1.6.m1.2a"><mrow id="S3.SS3.p1.6.m1.2.3" xref="S3.SS3.p1.6.m1.2.3.cmml"><msub id="S3.SS3.p1.6.m1.2.3.2" xref="S3.SS3.p1.6.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m1.2.3.2.2" xref="S3.SS3.p1.6.m1.2.3.2.2.cmml">ℛ</mi><mi id="S3.SS3.p1.6.m1.2.3.2.3" xref="S3.SS3.p1.6.m1.2.3.2.3.cmml">MH</mi></msub><mo id="S3.SS3.p1.6.m1.2.3.1" xref="S3.SS3.p1.6.m1.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p1.6.m1.2.3.3.2" xref="S3.SS3.p1.6.m1.2.3.3.1.cmml"><mo id="S3.SS3.p1.6.m1.2.3.3.2.1" stretchy="false" xref="S3.SS3.p1.6.m1.2.3.3.1.cmml">(</mo><mo id="S3.SS3.p1.6.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS3.p1.6.m1.1.1.cmml">⋅</mo><mo id="S3.SS3.p1.6.m1.2.3.3.2.2" xref="S3.SS3.p1.6.m1.2.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m1.2.2" xref="S3.SS3.p1.6.m1.2.2.cmml">ℒ</mi><mo id="S3.SS3.p1.6.m1.2.3.3.2.3" stretchy="false" xref="S3.SS3.p1.6.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m1.2b"><apply id="S3.SS3.p1.6.m1.2.3.cmml" xref="S3.SS3.p1.6.m1.2.3"><times id="S3.SS3.p1.6.m1.2.3.1.cmml" xref="S3.SS3.p1.6.m1.2.3.1"></times><apply id="S3.SS3.p1.6.m1.2.3.2.cmml" xref="S3.SS3.p1.6.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.2.3.2.1.cmml" xref="S3.SS3.p1.6.m1.2.3.2">subscript</csymbol><ci id="S3.SS3.p1.6.m1.2.3.2.2.cmml" xref="S3.SS3.p1.6.m1.2.3.2.2">ℛ</ci><ci id="S3.SS3.p1.6.m1.2.3.2.3.cmml" xref="S3.SS3.p1.6.m1.2.3.2.3">MH</ci></apply><interval closure="open" id="S3.SS3.p1.6.m1.2.3.3.1.cmml" xref="S3.SS3.p1.6.m1.2.3.3.2"><ci id="S3.SS3.p1.6.m1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1">⋅</ci><ci id="S3.SS3.p1.6.m1.2.2.cmml" xref="S3.SS3.p1.6.m1.2.2">ℒ</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m1.2c">\mathcal{R}_{\mathrm{MH}}(\cdot,\mathcal{L})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m1.2d">caligraphic_R start_POSTSUBSCRIPT roman_MH end_POSTSUBSCRIPT ( ⋅ , caligraphic_L )</annotation></semantics></math> as the function of the multi-head RTD query process, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{r}=\mathcal{R}_{\mathrm{MH}}(h^{(l)},\mathcal{L})=\frac{1}{n_{h}}\sum_%
{i=1}^{n_{h}}\mathcal{R}(h^{(l,i)},\mathcal{L}^{(i)})" class="ltx_Math" display="block" id="S3.E10.m1.8"><semantics id="S3.E10.m1.8a"><mrow id="S3.E10.m1.8.8" xref="S3.E10.m1.8.8.cmml"><mi id="S3.E10.m1.8.8.5" xref="S3.E10.m1.8.8.5.cmml">𝐫</mi><mo id="S3.E10.m1.8.8.6" xref="S3.E10.m1.8.8.6.cmml">=</mo><mrow id="S3.E10.m1.6.6.1" xref="S3.E10.m1.6.6.1.cmml"><msub id="S3.E10.m1.6.6.1.3" xref="S3.E10.m1.6.6.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.6.6.1.3.2" xref="S3.E10.m1.6.6.1.3.2.cmml">ℛ</mi><mi id="S3.E10.m1.6.6.1.3.3" xref="S3.E10.m1.6.6.1.3.3.cmml">MH</mi></msub><mo id="S3.E10.m1.6.6.1.2" xref="S3.E10.m1.6.6.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.6.6.1.1.1" xref="S3.E10.m1.6.6.1.1.2.cmml"><mo id="S3.E10.m1.6.6.1.1.1.2" stretchy="false" xref="S3.E10.m1.6.6.1.1.2.cmml">(</mo><msup id="S3.E10.m1.6.6.1.1.1.1" xref="S3.E10.m1.6.6.1.1.1.1.cmml"><mi id="S3.E10.m1.6.6.1.1.1.1.2" xref="S3.E10.m1.6.6.1.1.1.1.2.cmml">h</mi><mrow id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.6.6.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.3.1" stretchy="false" xref="S3.E10.m1.6.6.1.1.1.1.cmml">(</mo><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">l</mi><mo id="S3.E10.m1.1.1.1.3.2" stretchy="false" xref="S3.E10.m1.6.6.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E10.m1.6.6.1.1.1.3" xref="S3.E10.m1.6.6.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.5.5" xref="S3.E10.m1.5.5.cmml">ℒ</mi><mo id="S3.E10.m1.6.6.1.1.1.4" stretchy="false" xref="S3.E10.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.8.8.7" xref="S3.E10.m1.8.8.7.cmml">=</mo><mrow id="S3.E10.m1.8.8.3" xref="S3.E10.m1.8.8.3.cmml"><mfrac id="S3.E10.m1.8.8.3.4" xref="S3.E10.m1.8.8.3.4.cmml"><mn id="S3.E10.m1.8.8.3.4.2" xref="S3.E10.m1.8.8.3.4.2.cmml">1</mn><msub id="S3.E10.m1.8.8.3.4.3" xref="S3.E10.m1.8.8.3.4.3.cmml"><mi id="S3.E10.m1.8.8.3.4.3.2" xref="S3.E10.m1.8.8.3.4.3.2.cmml">n</mi><mi id="S3.E10.m1.8.8.3.4.3.3" xref="S3.E10.m1.8.8.3.4.3.3.cmml">h</mi></msub></mfrac><mo id="S3.E10.m1.8.8.3.3" xref="S3.E10.m1.8.8.3.3.cmml">⁢</mo><mrow id="S3.E10.m1.8.8.3.2" xref="S3.E10.m1.8.8.3.2.cmml"><munderover id="S3.E10.m1.8.8.3.2.3" xref="S3.E10.m1.8.8.3.2.3.cmml"><mo id="S3.E10.m1.8.8.3.2.3.2.2" movablelimits="false" xref="S3.E10.m1.8.8.3.2.3.2.2.cmml">∑</mo><mrow id="S3.E10.m1.8.8.3.2.3.2.3" xref="S3.E10.m1.8.8.3.2.3.2.3.cmml"><mi id="S3.E10.m1.8.8.3.2.3.2.3.2" xref="S3.E10.m1.8.8.3.2.3.2.3.2.cmml">i</mi><mo id="S3.E10.m1.8.8.3.2.3.2.3.1" xref="S3.E10.m1.8.8.3.2.3.2.3.1.cmml">=</mo><mn id="S3.E10.m1.8.8.3.2.3.2.3.3" xref="S3.E10.m1.8.8.3.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E10.m1.8.8.3.2.3.3" xref="S3.E10.m1.8.8.3.2.3.3.cmml"><mi id="S3.E10.m1.8.8.3.2.3.3.2" xref="S3.E10.m1.8.8.3.2.3.3.2.cmml">n</mi><mi id="S3.E10.m1.8.8.3.2.3.3.3" xref="S3.E10.m1.8.8.3.2.3.3.3.cmml">h</mi></msub></munderover><mrow id="S3.E10.m1.8.8.3.2.2" xref="S3.E10.m1.8.8.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.8.8.3.2.2.4" xref="S3.E10.m1.8.8.3.2.2.4.cmml">ℛ</mi><mo id="S3.E10.m1.8.8.3.2.2.3" xref="S3.E10.m1.8.8.3.2.2.3.cmml">⁢</mo><mrow id="S3.E10.m1.8.8.3.2.2.2.2" xref="S3.E10.m1.8.8.3.2.2.2.3.cmml"><mo id="S3.E10.m1.8.8.3.2.2.2.2.3" stretchy="false" xref="S3.E10.m1.8.8.3.2.2.2.3.cmml">(</mo><msup id="S3.E10.m1.7.7.2.1.1.1.1.1" xref="S3.E10.m1.7.7.2.1.1.1.1.1.cmml"><mi id="S3.E10.m1.7.7.2.1.1.1.1.1.2" xref="S3.E10.m1.7.7.2.1.1.1.1.1.2.cmml">h</mi><mrow id="S3.E10.m1.3.3.2.4" xref="S3.E10.m1.3.3.2.3.cmml"><mo id="S3.E10.m1.3.3.2.4.1" stretchy="false" xref="S3.E10.m1.3.3.2.3.cmml">(</mo><mi id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.1.cmml">l</mi><mo id="S3.E10.m1.3.3.2.4.2" xref="S3.E10.m1.3.3.2.3.cmml">,</mo><mi id="S3.E10.m1.3.3.2.2" xref="S3.E10.m1.3.3.2.2.cmml">i</mi><mo id="S3.E10.m1.3.3.2.4.3" stretchy="false" xref="S3.E10.m1.3.3.2.3.cmml">)</mo></mrow></msup><mo id="S3.E10.m1.8.8.3.2.2.2.2.4" xref="S3.E10.m1.8.8.3.2.2.2.3.cmml">,</mo><msup id="S3.E10.m1.8.8.3.2.2.2.2.2" xref="S3.E10.m1.8.8.3.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.8.8.3.2.2.2.2.2.2" xref="S3.E10.m1.8.8.3.2.2.2.2.2.2.cmml">ℒ</mi><mrow id="S3.E10.m1.4.4.1.3" xref="S3.E10.m1.8.8.3.2.2.2.2.2.cmml"><mo id="S3.E10.m1.4.4.1.3.1" stretchy="false" xref="S3.E10.m1.8.8.3.2.2.2.2.2.cmml">(</mo><mi id="S3.E10.m1.4.4.1.1" xref="S3.E10.m1.4.4.1.1.cmml">i</mi><mo id="S3.E10.m1.4.4.1.3.2" stretchy="false" xref="S3.E10.m1.8.8.3.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.E10.m1.8.8.3.2.2.2.2.5" stretchy="false" xref="S3.E10.m1.8.8.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.8b"><apply id="S3.E10.m1.8.8.cmml" xref="S3.E10.m1.8.8"><and id="S3.E10.m1.8.8a.cmml" xref="S3.E10.m1.8.8"></and><apply id="S3.E10.m1.8.8b.cmml" xref="S3.E10.m1.8.8"><eq id="S3.E10.m1.8.8.6.cmml" xref="S3.E10.m1.8.8.6"></eq><ci id="S3.E10.m1.8.8.5.cmml" xref="S3.E10.m1.8.8.5">𝐫</ci><apply id="S3.E10.m1.6.6.1.cmml" xref="S3.E10.m1.6.6.1"><times id="S3.E10.m1.6.6.1.2.cmml" xref="S3.E10.m1.6.6.1.2"></times><apply id="S3.E10.m1.6.6.1.3.cmml" xref="S3.E10.m1.6.6.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.1.3.1.cmml" xref="S3.E10.m1.6.6.1.3">subscript</csymbol><ci id="S3.E10.m1.6.6.1.3.2.cmml" xref="S3.E10.m1.6.6.1.3.2">ℛ</ci><ci id="S3.E10.m1.6.6.1.3.3.cmml" xref="S3.E10.m1.6.6.1.3.3">MH</ci></apply><interval closure="open" id="S3.E10.m1.6.6.1.1.2.cmml" xref="S3.E10.m1.6.6.1.1.1"><apply id="S3.E10.m1.6.6.1.1.1.1.cmml" xref="S3.E10.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.6.6.1.1.1.1.1.cmml" xref="S3.E10.m1.6.6.1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.6.6.1.1.1.1.2.cmml" xref="S3.E10.m1.6.6.1.1.1.1.2">ℎ</ci><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑙</ci></apply><ci id="S3.E10.m1.5.5.cmml" xref="S3.E10.m1.5.5">ℒ</ci></interval></apply></apply><apply id="S3.E10.m1.8.8c.cmml" xref="S3.E10.m1.8.8"><eq id="S3.E10.m1.8.8.7.cmml" xref="S3.E10.m1.8.8.7"></eq><share href="https://arxiv.org/html/2409.20181v1#S3.E10.m1.6.6.1.cmml" id="S3.E10.m1.8.8d.cmml" xref="S3.E10.m1.8.8"></share><apply id="S3.E10.m1.8.8.3.cmml" xref="S3.E10.m1.8.8.3"><times id="S3.E10.m1.8.8.3.3.cmml" xref="S3.E10.m1.8.8.3.3"></times><apply id="S3.E10.m1.8.8.3.4.cmml" xref="S3.E10.m1.8.8.3.4"><divide id="S3.E10.m1.8.8.3.4.1.cmml" xref="S3.E10.m1.8.8.3.4"></divide><cn id="S3.E10.m1.8.8.3.4.2.cmml" type="integer" xref="S3.E10.m1.8.8.3.4.2">1</cn><apply id="S3.E10.m1.8.8.3.4.3.cmml" xref="S3.E10.m1.8.8.3.4.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.3.4.3.1.cmml" xref="S3.E10.m1.8.8.3.4.3">subscript</csymbol><ci id="S3.E10.m1.8.8.3.4.3.2.cmml" xref="S3.E10.m1.8.8.3.4.3.2">𝑛</ci><ci id="S3.E10.m1.8.8.3.4.3.3.cmml" xref="S3.E10.m1.8.8.3.4.3.3">ℎ</ci></apply></apply><apply id="S3.E10.m1.8.8.3.2.cmml" xref="S3.E10.m1.8.8.3.2"><apply id="S3.E10.m1.8.8.3.2.3.cmml" xref="S3.E10.m1.8.8.3.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.3.2.3.1.cmml" xref="S3.E10.m1.8.8.3.2.3">superscript</csymbol><apply id="S3.E10.m1.8.8.3.2.3.2.cmml" xref="S3.E10.m1.8.8.3.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.3.2.3.2.1.cmml" xref="S3.E10.m1.8.8.3.2.3">subscript</csymbol><sum id="S3.E10.m1.8.8.3.2.3.2.2.cmml" xref="S3.E10.m1.8.8.3.2.3.2.2"></sum><apply id="S3.E10.m1.8.8.3.2.3.2.3.cmml" xref="S3.E10.m1.8.8.3.2.3.2.3"><eq id="S3.E10.m1.8.8.3.2.3.2.3.1.cmml" xref="S3.E10.m1.8.8.3.2.3.2.3.1"></eq><ci id="S3.E10.m1.8.8.3.2.3.2.3.2.cmml" xref="S3.E10.m1.8.8.3.2.3.2.3.2">𝑖</ci><cn id="S3.E10.m1.8.8.3.2.3.2.3.3.cmml" type="integer" xref="S3.E10.m1.8.8.3.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E10.m1.8.8.3.2.3.3.cmml" xref="S3.E10.m1.8.8.3.2.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.3.2.3.3.1.cmml" xref="S3.E10.m1.8.8.3.2.3.3">subscript</csymbol><ci id="S3.E10.m1.8.8.3.2.3.3.2.cmml" xref="S3.E10.m1.8.8.3.2.3.3.2">𝑛</ci><ci id="S3.E10.m1.8.8.3.2.3.3.3.cmml" xref="S3.E10.m1.8.8.3.2.3.3.3">ℎ</ci></apply></apply><apply id="S3.E10.m1.8.8.3.2.2.cmml" xref="S3.E10.m1.8.8.3.2.2"><times id="S3.E10.m1.8.8.3.2.2.3.cmml" xref="S3.E10.m1.8.8.3.2.2.3"></times><ci id="S3.E10.m1.8.8.3.2.2.4.cmml" xref="S3.E10.m1.8.8.3.2.2.4">ℛ</ci><interval closure="open" id="S3.E10.m1.8.8.3.2.2.2.3.cmml" xref="S3.E10.m1.8.8.3.2.2.2.2"><apply id="S3.E10.m1.7.7.2.1.1.1.1.1.cmml" xref="S3.E10.m1.7.7.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.7.7.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.7.7.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E10.m1.7.7.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.7.7.2.1.1.1.1.1.2">ℎ</ci><interval closure="open" id="S3.E10.m1.3.3.2.3.cmml" xref="S3.E10.m1.3.3.2.4"><ci id="S3.E10.m1.2.2.1.1.cmml" xref="S3.E10.m1.2.2.1.1">𝑙</ci><ci id="S3.E10.m1.3.3.2.2.cmml" xref="S3.E10.m1.3.3.2.2">𝑖</ci></interval></apply><apply id="S3.E10.m1.8.8.3.2.2.2.2.2.cmml" xref="S3.E10.m1.8.8.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.8.8.3.2.2.2.2.2.1.cmml" xref="S3.E10.m1.8.8.3.2.2.2.2.2">superscript</csymbol><ci id="S3.E10.m1.8.8.3.2.2.2.2.2.2.cmml" xref="S3.E10.m1.8.8.3.2.2.2.2.2.2">ℒ</ci><ci id="S3.E10.m1.4.4.1.1.cmml" xref="S3.E10.m1.4.4.1.1">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.8c">\mathbf{r}=\mathcal{R}_{\mathrm{MH}}(h^{(l)},\mathcal{L})=\frac{1}{n_{h}}\sum_%
{i=1}^{n_{h}}\mathcal{R}(h^{(l,i)},\mathcal{L}^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.8d">bold_r = caligraphic_R start_POSTSUBSCRIPT roman_MH end_POSTSUBSCRIPT ( italic_h start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT , caligraphic_L ) = divide start_ARG 1 end_ARG start_ARG italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT caligraphic_R ( italic_h start_POSTSUPERSCRIPT ( italic_l , italic_i ) end_POSTSUPERSCRIPT , caligraphic_L start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="175" id="S3.F5.g1" src="x5.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Comparison between RTD and multi-head RTD.</figcaption>
</figure>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of RTD and MH-RTD on Open Book QA.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S3.T1.1.1.1.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.2">RTD</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.1.3">MH-RTD</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.2.1.1">MPT-7B</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.2">27.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.3">30.9</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.3.2.1">LLaMA2-7B</th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.2">47.1</td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.3">52.4</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S3.T1.1.4.3.1">LLaMA2-70B</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.2">63.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.4.3.3">65.6</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Time and Memory Consumption</h3>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Time Consumption</h5>
<div class="ltx_para" id="S3.SS4.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p1.4">The time consuming is largely depended on the vector datastore used. For a brute force searching datastore, the time complexity will be <math alttext="\mathcal{O}\left(s_{\mathcal{L}}\cdot d_{m}\right)" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.3.cmml">ℒ</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.3.cmml">m</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1"><times id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.2"></times><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1"><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.1">⋅</ci><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.2.3">ℒ</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.1.m1.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.1.m1.1c">\mathcal{O}\left(s_{\mathcal{L}}\cdot d_{m}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.1.m1.1d">caligraphic_O ( italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT ⋅ italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> where <math alttext="s_{\mathcal{L}}=|\mathcal{L}|" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS4.SSS0.Px1.p1.2.m2.1.2" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.cmml"><msub id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.cmml"><mi id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.2" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.3" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.3.cmml">ℒ</mi></msub><mo id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.1" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.2" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.1.cmml"><mo id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1.cmml">ℒ</mi><mo id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2"><eq id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.1"></eq><apply id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.2.3">ℒ</ci></apply><apply id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.2"><abs id="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.2.3.2.1"></abs><ci id="S3.SS4.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.2.m2.1.1">ℒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.2.m2.1c">s_{\mathcal{L}}=|\mathcal{L}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT = | caligraphic_L |</annotation></semantics></math> is the size of the datastore. However, for those more powerful database like faiss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib20" title="">20</a>]</cite> by Meta, with extra training after the generation of reference datastore, the process which have to be done again if the datastore changes, the time consumption can be cut to <math alttext="\mathcal{O}\left(k\cdot d_{m}\right)" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS4.SSS0.Px1.p1.3.m3.1a"><mrow id="S3.SS4.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.cmml">k</mi><mo id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.3.cmml">m</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1"><times id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.2"></times><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1"><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.1">⋅</ci><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.2">𝑘</ci><apply id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p1.3.m3.1.1.1.1.1.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.3.m3.1c">\mathcal{O}\left(k\cdot d_{m}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.3.m3.1d">caligraphic_O ( italic_k ⋅ italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS4.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS4.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS4.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p1.4.m4.1d">italic_k</annotation></semantics></math> is a constant related the parameters used to train the database.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px1.p2.3">For multi-head reference trustable decoding, the performance cost remains the same. The time complexity of each attention-head wise query is <math alttext="\mathcal{O}\left(d_{h}\cdot s_{\mathcal{L}}\right)" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS4.SSS0.Px1.p2.1.m1.1a"><mrow id="S3.SS4.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.3.cmml">ℒ</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1"><times id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.2"></times><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1"><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.1">⋅</ci><apply id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.2">𝑑</ci><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.1.m1.1.1.1.1.1.3.3">ℒ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.1.m1.1c">\mathcal{O}\left(d_{h}\cdot s_{\mathcal{L}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.1.m1.1d">caligraphic_O ( italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ⋅ italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT )</annotation></semantics></math>, the overall query time complexity is <math alttext="\mathcal{O}\left(n\cdot d_{h}\cdot s_{\mathcal{L}}\right)=\mathcal{O}\left(d%
\cdot s_{\mathcal{L}}\right)" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.2.m2.2"><semantics id="S3.SS4.SSS0.Px1.p2.2.m2.2a"><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.cmml"><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.2.cmml">n</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.3.cmml">h</mi></msub><mo id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.3.cmml">ℒ</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.2.cmml">d</mi><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.3.cmml">ℒ</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.3" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.2.m2.2b"><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2"><eq id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.3"></eq><apply id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1"><times id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.2"></times><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1"><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.1">⋅</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.2">𝑛</ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.2">𝑑</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.3.3">ℎ</ci></apply><apply id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.1.1.1.1.1.1.4.3">ℒ</ci></apply></apply></apply><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2"><times id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.2"></times><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1"><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.1">⋅</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.2">𝑑</ci><apply id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.2">𝑠</ci><ci id="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.2.m2.2.2.2.1.1.1.3.3">ℒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.2.m2.2c">\mathcal{O}\left(n\cdot d_{h}\cdot s_{\mathcal{L}}\right)=\mathcal{O}\left(d%
\cdot s_{\mathcal{L}}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.2.m2.2d">caligraphic_O ( italic_n ⋅ italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ⋅ italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT ) = caligraphic_O ( italic_d ⋅ italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT )</annotation></semantics></math>, which is the time complexity of convention reference trustable decoding processing. The calculation remains the same for a trained database, the overall time complexity is <math alttext="\mathcal{O}\left(n\cdot k\cdot d_{h}\right)=\mathcal{O}\left(k\cdot d_{m}\right)" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px1.p2.3.m3.2"><semantics id="S3.SS4.SSS0.Px1.p2.3.m3.2a"><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.cmml"><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.cmml">n</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml">⋅</mo><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml">k</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.3.cmml">h</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3.cmml">𝒪</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.cmml">⁢</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.cmml"><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.2.cmml">k</mi><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.cmml"><mi id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.2" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.3.cmml">m</mi></msub></mrow><mo id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.3" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px1.p2.3.m3.2b"><apply id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2"><eq id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.3"></eq><apply id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1"><times id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.2"></times><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1"><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1">⋅</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.2">𝑛</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.3">𝑘</ci><apply id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.2">𝑑</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.4.3">ℎ</ci></apply></apply></apply><apply id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2"><times id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.2"></times><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.3">𝒪</ci><apply id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1"><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.1">⋅</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.2">𝑘</ci><apply id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.1.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.2.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.2">𝑑</ci><ci id="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.3.cmml" xref="S3.SS4.SSS0.Px1.p2.3.m3.2.2.2.1.1.1.3.3">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px1.p2.3.m3.2c">\mathcal{O}\left(n\cdot k\cdot d_{h}\right)=\mathcal{O}\left(k\cdot d_{m}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px1.p2.3.m3.2d">caligraphic_O ( italic_n ⋅ italic_k ⋅ italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) = caligraphic_O ( italic_k ⋅ italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Memory Consumption</h5>
<div class="ltx_para" id="S3.SS4.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p1.8">The use of time can be optimized by utilizing vector database, however the memory consumption cannot shrink easily. We further define <math alttext="b" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS4.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.1.m1.1d">italic_b</annotation></semantics></math> as the bit cost of the models’ <math alttext="\mathtt{dtype}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml">𝚍𝚝𝚢𝚙𝚎</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS4.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.2.m2.1.1">𝚍𝚝𝚢𝚙𝚎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.2.m2.1c">\mathtt{dtype}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.2.m2.1d">typewriter_dtype</annotation></semantics></math>, where <math alttext="b_{\mathtt{float32}}=4,b_{\mathtt{float16}}=b_{\mathtt{bfloat16}}=2,b_{\mathtt%
{int8}}=1,b_{\mathtt{int4}}=\frac{1}{2}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.3.m3.2"><semantics id="S3.SS4.SSS0.Px2.p1.3.m3.2a"><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.3.cmml"><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml"><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml"><msub id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.2.cmml">b</mi><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.3.cmml">𝚏𝚕𝚘𝚊𝚝𝟹𝟸</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.cmml">4</mn></mrow><mo id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.3a.cmml">,</mo><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.cmml"><msub id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.2.cmml">b</mi><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.3.cmml">𝚏𝚕𝚘𝚊𝚝𝟷𝟼</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.3.cmml">=</mo><msub id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.2.cmml">b</mi><mi id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.3.cmml">𝚋𝚏𝚕𝚘𝚊𝚝𝟷𝟼</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.5" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.5.cmml">=</mo><mn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.6" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.6.cmml">2</mn></mrow></mrow><mo id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.3a.cmml">,</mo><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml"><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml"><msub id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.2.cmml">b</mi><mi id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.3.cmml">𝚒𝚗𝚝𝟾</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.3a.cmml">,</mo><mrow id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.cmml"><msub id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.2.cmml">b</mi><mi id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.3.cmml">𝚒𝚗𝚝𝟺</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.1" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.1.cmml">=</mo><mfrac id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml"><mn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.2" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.2.cmml">1</mn><mn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.3" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.3.cmml">2</mn></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.3.m3.2b"><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.3a.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.3a.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1"><eq id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.1"></eq><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.2">𝑏</ci><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.2.3">𝚏𝚕𝚘𝚊𝚝𝟹𝟸</ci></apply><cn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.1.1.3">4</cn></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2"><and id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2a.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2"></and><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2b.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2"><eq id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.3"></eq><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.2">𝑏</ci><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.2.3">𝚏𝚕𝚘𝚊𝚝𝟷𝟼</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.2">𝑏</ci><ci id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.3">𝚋𝚏𝚕𝚘𝚊𝚝𝟷𝟼</ci></apply></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2c.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2"><eq id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.5.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.5"></eq><share href="https://arxiv.org/html/2409.20181v1#S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.4.cmml" id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2d.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2"></share><cn id="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.6.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.1.1.1.1.2.2.6">2</cn></apply></apply></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.3a.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1"><eq id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.1"></eq><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.2">𝑏</ci><ci id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.2.3">𝚒𝚗𝚝𝟾</ci></apply><cn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.1.1.3">1</cn></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2"><eq id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.1"></eq><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.2">𝑏</ci><ci id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.2.3">𝚒𝚗𝚝𝟺</ci></apply><apply id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3"><divide id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3"></divide><cn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.2.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.2">1</cn><cn id="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p1.3.m3.2.2.2.2.2.2.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.3.m3.2c">b_{\mathtt{float32}}=4,b_{\mathtt{float16}}=b_{\mathtt{bfloat16}}=2,b_{\mathtt%
{int8}}=1,b_{\mathtt{int4}}=\frac{1}{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.3.m3.2d">italic_b start_POSTSUBSCRIPT typewriter_float32 end_POSTSUBSCRIPT = 4 , italic_b start_POSTSUBSCRIPT typewriter_float16 end_POSTSUBSCRIPT = italic_b start_POSTSUBSCRIPT typewriter_bfloat16 end_POSTSUBSCRIPT = 2 , italic_b start_POSTSUBSCRIPT typewriter_int8 end_POSTSUBSCRIPT = 1 , italic_b start_POSTSUBSCRIPT typewriter_int4 end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 end_ARG</annotation></semantics></math>. The overall memory cost is <math alttext="d_{m}\cdot b\cdot s_{\mathcal{L}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS4.SSS0.Px2.p1.4.m4.1a"><mrow id="S3.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml"><msub id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.cmml">m</mi></msub><mo id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml">⋅</mo><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml">b</mi><mo id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml">⋅</mo><msub id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.cmml"><mi id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.2" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.3" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.3.cmml">ℒ</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1"><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.1">⋅</ci><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.2">𝑑</ci><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.2.3">𝑚</ci></apply><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.3">𝑏</ci><apply id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.1.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.2.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.2">𝑠</ci><ci id="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.3.cmml" xref="S3.SS4.SSS0.Px2.p1.4.m4.1.1.4.3">ℒ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.4.m4.1c">d_{m}\cdot b\cdot s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ⋅ italic_b ⋅ italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math>. Due to the lack of lower precision <math alttext="\mathtt{dtype}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS4.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS4.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1.cmml">𝚍𝚝𝚢𝚙𝚎</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS4.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.5.m5.1.1">𝚍𝚝𝚢𝚙𝚎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.5.m5.1c">\mathtt{dtype}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.5.m5.1d">typewriter_dtype</annotation></semantics></math> support on CPU, even the base model utilized popular half precision <math alttext="\mathtt{dtype}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS4.SSS0.Px2.p1.6.m6.1a"><mi id="S3.SS4.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1.cmml">𝚍𝚝𝚢𝚙𝚎</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.6.m6.1b"><ci id="S3.SS4.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.6.m6.1.1">𝚍𝚝𝚢𝚙𝚎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.6.m6.1c">\mathtt{dtype}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.6.m6.1d">typewriter_dtype</annotation></semantics></math> like <math alttext="\mathtt{bfloat16}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.7.m7.1"><semantics id="S3.SS4.SSS0.Px2.p1.7.m7.1a"><mi id="S3.SS4.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1.cmml">𝚋𝚏𝚕𝚘𝚊𝚝𝟷𝟼</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.7.m7.1b"><ci id="S3.SS4.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.7.m7.1.1">𝚋𝚏𝚕𝚘𝚊𝚝𝟷𝟼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.7.m7.1c">\mathtt{bfloat16}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.7.m7.1d">typewriter_bfloat16</annotation></semantics></math>, it still need to be converted into larger ones to be stored. Since all the hidden states have to be saved to calculate precise distanced when rescalled, the memory cost can’t be reduced significantly by making it irrelevant with <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p1.8.m8.1"><semantics id="S3.SS4.SSS0.Px2.p1.8.m8.1a"><msub id="S3.SS4.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p1.8.m8.1b"><apply id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.2">𝑠</ci><ci id="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p1.8.m8.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p1.8.m8.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p1.8.m8.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS4.SSS0.Px2.p2.6">On the Multi-head RTD side, the memory cost remains the same as the regular RTD takes. The proof is same as the Section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS4.SSS0.Px1" title="Time Consumption ‣ 3.4 Time and Memory Consumption ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a>. For instance, reference datastore and head-wise reference datastore with <math alttext="20,480" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.1.m1.2"><semantics id="S3.SS4.SSS0.Px2.p2.1.m1.2a"><mrow id="S3.SS4.SSS0.Px2.p2.1.m1.2.3.2" xref="S3.SS4.SSS0.Px2.p2.1.m1.2.3.1.cmml"><mn id="S3.SS4.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS4.SSS0.Px2.p2.1.m1.1.1.cmml">20</mn><mo id="S3.SS4.SSS0.Px2.p2.1.m1.2.3.2.1" xref="S3.SS4.SSS0.Px2.p2.1.m1.2.3.1.cmml">,</mo><mn id="S3.SS4.SSS0.Px2.p2.1.m1.2.2" xref="S3.SS4.SSS0.Px2.p2.1.m1.2.2.cmml">480</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.1.m1.2b"><list id="S3.SS4.SSS0.Px2.p2.1.m1.2.3.1.cmml" xref="S3.SS4.SSS0.Px2.p2.1.m1.2.3.2"><cn id="S3.SS4.SSS0.Px2.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p2.1.m1.1.1">20</cn><cn id="S3.SS4.SSS0.Px2.p2.1.m1.2.2.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p2.1.m1.2.2">480</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.1.m1.2c">20,480</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.1.m1.2d">20 , 480</annotation></semantics></math> entries with <math alttext="d_{m}=4096" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS4.SSS0.Px2.p2.2.m2.1a"><mrow id="S3.SS4.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.cmml"><msub id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.2" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.3" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.3.cmml">m</mi></msub><mo id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.1" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.3" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.3.cmml">4096</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1"><eq id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.1"></eq><apply id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.2">𝑑</ci><ci id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.2.3">𝑚</ci></apply><cn id="S3.SS4.SSS0.Px2.p2.2.m2.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p2.2.m2.1.1.3">4096</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.2.m2.1c">d_{m}=4096</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.2.m2.1d">italic_d start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = 4096</annotation></semantics></math>, <math alttext="n=32" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS4.SSS0.Px2.p2.3.m3.1a"><mrow id="S3.SS4.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.cmml"><mi id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.2" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.2.cmml">n</mi><mo id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.1" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.3" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.3.m3.1b"><apply id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1"><eq id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.1"></eq><ci id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.2">𝑛</ci><cn id="S3.SS4.SSS0.Px2.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p2.3.m3.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.3.m3.1c">n=32</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.3.m3.1d">italic_n = 32</annotation></semantics></math> and <math alttext="d_{h}=128" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.4.m4.1"><semantics id="S3.SS4.SSS0.Px2.p2.4.m4.1a"><mrow id="S3.SS4.SSS0.Px2.p2.4.m4.1.1" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.cmml"><msub id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.cmml"><mi id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.2" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.2.cmml">d</mi><mi id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.3" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.1" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.3" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.4.m4.1b"><apply id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1"><eq id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.1"></eq><apply id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.cmml" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.1.cmml" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.2.cmml" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.2">𝑑</ci><ci id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.3.cmml" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.2.3">ℎ</ci></apply><cn id="S3.SS4.SSS0.Px2.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p2.4.m4.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.4.m4.1c">d_{h}=128</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT = 128</annotation></semantics></math>, stored in <math alttext="\mathtt{float32}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.5.m5.1"><semantics id="S3.SS4.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS4.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS4.SSS0.Px2.p2.5.m5.1.1.cmml">𝚏𝚕𝚘𝚊𝚝𝟹𝟸</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS4.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.5.m5.1.1">𝚏𝚕𝚘𝚊𝚝𝟹𝟸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.5.m5.1c">\mathtt{float32}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.5.m5.1d">typewriter_float32</annotation></semantics></math>, takes <math alttext="320\mathtt{MB}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px2.p2.6.m6.1"><semantics id="S3.SS4.SSS0.Px2.p2.6.m6.1a"><mrow id="S3.SS4.SSS0.Px2.p2.6.m6.1.1" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.cmml"><mn id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.2" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.2.cmml">320</mn><mo id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.1" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.3" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.3.cmml">𝙼𝙱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px2.p2.6.m6.1b"><apply id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1"><times id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.1.cmml" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.1"></times><cn id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.2">320</cn><ci id="S3.SS4.SSS0.Px2.p2.6.m6.1.1.3.cmml" xref="S3.SS4.SSS0.Px2.p2.6.m6.1.1.3">𝙼𝙱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px2.p2.6.m6.1c">320\mathtt{MB}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px2.p2.6.m6.1d">320 typewriter_MB</annotation></semantics></math> of memory and hard disk space.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS4.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">MH-RTD for Resource Saving</h5>
<div class="ltx_para" id="S3.SS4.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS4.SSS0.Px3.p1.2">As MH-RTD splits long vectors into multiple smaller ones, it gives us the opportunity to cut time and memory cost by merging different heads together, or directly evict some of them.
If on average, <math alttext="p" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px3.p1.1.m1.1"><semantics id="S3.SS4.SSS0.Px3.p1.1.m1.1a"><mi id="S3.SS4.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS4.SSS0.Px3.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px3.p1.1.m1.1b"><ci id="S3.SS4.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS4.SSS0.Px3.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px3.p1.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px3.p1.1.m1.1d">italic_p</annotation></semantics></math> heads are merged into one head, then we expect a <math alttext="\frac{1}{p}" class="ltx_Math" display="inline" id="S3.SS4.SSS0.Px3.p1.2.m2.1"><semantics id="S3.SS4.SSS0.Px3.p1.2.m2.1a"><mfrac id="S3.SS4.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1.cmml"><mn id="S3.SS4.SSS0.Px3.p1.2.m2.1.1.2" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1.2.cmml">1</mn><mi id="S3.SS4.SSS0.Px3.p1.2.m2.1.1.3" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1.3.cmml">p</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS4.SSS0.Px3.p1.2.m2.1b"><apply id="S3.SS4.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1"><divide id="S3.SS4.SSS0.Px3.p1.2.m2.1.1.1.cmml" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1"></divide><cn id="S3.SS4.SSS0.Px3.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1.2">1</cn><ci id="S3.SS4.SSS0.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS4.SSS0.Px3.p1.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.SSS0.Px3.p1.2.m2.1c">\frac{1}{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.SSS0.Px3.p1.2.m2.1d">divide start_ARG 1 end_ARG start_ARG italic_p end_ARG</annotation></semantics></math> resource consumption. The time and memory improvement and corresponding performance impact can be find in the tuning Section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS3" title="4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Settings and Experiment</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">We categorize the common downstream tasks of language models into two types: language understanding and language generation. The former focuses on understanding the input information, based on the context and the information stored within the model, and then outputs the answer in the form of a few tokens, usually in a very simple form. The latter focuses on generating new sentences with complete semantics. We explored the potential of RTD compared to other methods on these two types of tasks. We first compared the effects of RTD and MH-RTD. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.T1" title="Table 1 ‣ 3.3 Multi-head Reference Trustable Decoding ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>, we found that MH-RTD effectively enhances the capabilities of RTD. Therefore, we default to using the MH-RTD method in the following tests.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Language Understanding</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">We tested the language understanding capabilities of RTD on multiple benchmarks.
When testing, question without answer be shown to the LLM, then we will gather it’s baseline output by LLMs’ first output token and our RTD result through searching our reference datastore. <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_λ</annotation></semantics></math> is set to <math alttext="1" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mn id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><cn id="S4.SS1.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">1</annotation></semantics></math> in this task. How the reference datastore is generated can be fount at appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A2.SS1" title="B.1 Benchmark Testing ‣ Appendix B Generation of Reference Datastore ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">B.1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">Models we used are: LLaMA2-7B and 70B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib38" title="">38</a>]</cite>, LLaMA3-8B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib8" title="">8</a>]</cite>, MPT-7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib36" title="">36</a>]</cite>, GLM3-6B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib45" title="">45</a>]</cite>  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib7" title="">7</a>]</cite>, Yi-34B. Includes model size from 6B to 70B, as most of the major current models are. We use the <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.1">base</span> version of the model by default. Testing benchmarks are: Massive Multitask Language Understanding (MMLU)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib15" title="">15</a>]</cite>, AI2 Reasoning Challenge (ARC, both Easy (E) and Challenge (C) parts)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib4" title="">4</a>]</cite>, Reasoning about Physical Commonsense in Natural Language (PIQA)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib5" title="">5</a>]</cite>, Open Book Question Answering (OBQA)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib29" title="">29</a>]</cite>, and Massive Multitask Language Understanding in Chinese (CMMLU)  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib24" title="">24</a>]</cite>. C-MMLU is a Chinese benchmark, so only Chinese models, GLM3 and Yi, participated in this benchmark.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">The multiple-choice benchmarks we chose is challenging enough in itself and requires strong reasoning ability from the model; moreover, the answer format is fixed, which can simultaneously detect the ability to follow instructions. Since that most tasks in the traditional NLP field can be quickly converted into tasks of choosing one from several categories, even some generative tasks, so the results on the multiple-choice test can also represent many other tasks.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">The performance boost can be found both with or without ICL. Results are in table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.T2" title="Table 2 ‣ 4.1 Language Understanding ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>. Besides testing scores, we also record the confused rate of baseline, the proportion of the questions that failed to be answered properly, including output irrelevant text or can’t give a certain answer, in table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.T4" title="Table 4 ‣ 4.1 Language Understanding ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Meanwhile RTD is designed to given the LLMs’ decision in a trustable and controllable way.
In comparison with fine-tuning methods in table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.T4" title="Table 4 ‣ 4.1 Language Understanding ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, we can notice that RTD can achieve approximate performance improvements as using PEFT methods like LoRA. Although it is still insufficient compared to full-parameter fine-tuning, the latter has a higher cost and has undergone knowledge injection (which is not considered in this part of the experiment). The dataset used for full-parameter fine-tuning is MMLU-Recall <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib31" title="">31</a>; <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib32" title="">32</a>]</cite>, and the hyper-parameters of LoRA can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A4" title="Appendix D LoRA Hyperparamters ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T2.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.2.2">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.2.2.3">Model</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S4.T2.2.2.4">Benchmark</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.5">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.6">5-shot ICL</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1">RTD (<math alttext="\Delta" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" mathvariant="normal" xref="S4.T2.1.1.1.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">roman_Δ</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2">5-shot RTD (<math alttext="\Delta" class="ltx_Math" display="inline" id="S4.T2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.m1.1a"><mi id="S4.T2.2.2.2.m1.1.1" mathvariant="normal" xref="S4.T2.2.2.2.m1.1.1.cmml">Δ</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.m1.1b"><ci id="S4.T2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.m1.1.1">Δ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.m1.1c">\Delta</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.m1.1d">roman_Δ</annotation></semantics></math>)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.3.1.1">LLaMA2-7B</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.2.3.1.2">MMLU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.3">43.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.4">45.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.5">45.1 (1.3↑)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.3.1.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.3.1.6.1">47.2</span> (2.1↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.4.2">
<td class="ltx_td" id="S4.T2.2.4.2.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.4.2.2">ARC (E &amp; C)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.3">30.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.4">65.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.5">41.4 (11.3↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.4.2.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.4.2.6.1">67.3</span> (2.3↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.5.3">
<td class="ltx_td" id="S4.T2.2.5.3.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.5.3.2">PIQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.3">56.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.4">62.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.5">71.4 (14.9↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.5.3.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.5.3.6.1">73.2</span> (11.1↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.6.4">
<td class="ltx_td" id="S4.T2.2.6.4.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.6.4.2">Openbook QA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.3">27.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.4">51.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.5">30.4 (2.6↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.6.4.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.6.4.6.1">53.6</span> (2.6↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.7.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.7.5.1">LLaMA2-70B</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.2.7.5.2">MMLU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.7.5.3">56.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.7.5.4">67.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.7.5.5">56.9 (0.2↑)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.7.5.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.7.5.6.1">68.5</span> (0.6↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.8.6">
<td class="ltx_td" id="S4.T2.2.8.6.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.8.6.2">ARC (E &amp; C)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.3">67.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.4">91.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.5">86.1 (19.7↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.8.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.8.6.6.1">91.7</span> (0.1↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.9.7">
<td class="ltx_td" id="S4.T2.2.9.7.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.9.7.2">PIQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.3">72.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.4">85.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.5">81.9 (9.6↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.9.7.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.9.7.6.1">86.6</span> (1.3↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.10.8">
<td class="ltx_td" id="S4.T2.2.10.8.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.10.8.2">OpenbookQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.3">53.7</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.4">84.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.5">68.2 (14.5↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.10.8.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.10.8.6.1">85.4</span> (1.0↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.11.9">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.11.9.1">LLaMA3-8B</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.2.11.9.2">MMLU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.3">47.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.4"><span class="ltx_text ltx_font_bold" id="S4.T2.2.11.9.4.1">63.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.5">57.2 (9.7↑)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.11.9.6">61.9 (2.0↓)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.12.10">
<td class="ltx_td" id="S4.T2.2.12.10.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.12.10.2">ARC (E &amp; C)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.3">71.2</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.4"><span class="ltx_text ltx_font_bold" id="S4.T2.2.12.10.4.1">87.3</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.5">83.7 (12.5↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.12.10.6">87.1 (0.2↓)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.13.11">
<td class="ltx_td" id="S4.T2.2.13.11.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.13.11.2">PIQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.3">69.9</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.4">78.9</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.5">76.3 (6.4↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.13.11.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.13.11.6.1">80.0</span> (1.1↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.14.12">
<td class="ltx_td" id="S4.T2.2.14.12.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.14.12.2">OpenbookQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.3">53.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.4">77.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.5">71.4(18.1↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.14.12.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.14.12.6.1">78.6</span> (1.1↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.15.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.15.13.1">MPT-7B</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.2.15.13.2">MMLU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.3">27.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.4">29.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.5">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.15.13.5.1">30.4</span> (3.0↑)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.15.13.6">29.8 (0.2↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.16.14">
<td class="ltx_td" id="S4.T2.2.16.14.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.16.14.2">ARC (E &amp; C)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.3">27.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.4">failed</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.5">27.6 (0.1↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.16.14.6"><span class="ltx_text ltx_font_bold" id="S4.T2.2.16.14.6.1">30.1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.17.15">
<td class="ltx_td" id="S4.T2.2.17.15.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.17.15.2">OpenbookQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.17.15.3">29.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.17.15.4">failed</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.17.15.5">27.2 (2.2↓)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.17.15.6"><span class="ltx_text ltx_font_bold" id="S4.T2.2.17.15.6.1">30.4</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.18.16">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.18.16.1">GLM3-6B</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.2.18.16.2">MMLU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.18.16.3">41.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.18.16.4">48.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.18.16.5">47.6 (5.7↑)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.18.16.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.18.16.6.1">49.8</span> (1.2↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.19.17">
<td class="ltx_td" id="S4.T2.2.19.17.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.19.17.2">ARC (E &amp; C)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.19.17.3">59.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.19.17.4">75.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.19.17.5">75.0 (15.9↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.19.17.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.19.17.6.1">76.5</span> (1.2↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.20.18">
<td class="ltx_td" id="S4.T2.2.20.18.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.20.18.2">PIQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.20.18.3">66.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.20.18.4">73.6</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.20.18.5">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.20.18.5.1">75.9</span> (9.1↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.20.18.6">74.5 (0.9↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.21.19">
<td class="ltx_td" id="S4.T2.2.21.19.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.21.19.2">OpenbookQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.21.19.3">55.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.21.19.4">67.1</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.21.19.5">64.0 (8.9↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.21.19.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.21.19.6.1">68.8</span> (1.7↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.22.20">
<td class="ltx_td" id="S4.T2.2.22.20.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.22.20.2">C-MMLU</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.22.20.3">48.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.22.20.4">54.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.22.20.5">53.3 (4.5↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.22.20.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.22.20.6.1">54.7</span> (0.2↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.23.21">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.2.23.21.1">Yi-34B</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T2.2.23.21.2">MMLU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.23.21.3">68.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.23.21.4"><span class="ltx_text ltx_font_bold" id="S4.T2.2.23.21.4.1">74.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.23.21.5">70.3 (1.7↑)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.23.21.6">73.3 (1.0↓)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.24.22">
<td class="ltx_td" id="S4.T2.2.24.22.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.24.22.2">ARC (E &amp; C)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.24.22.3">93.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.24.22.4">94.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.24.22.5">90.7 (2.6↓)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.24.22.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.24.22.6.1">94.6</span> (0.6↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.25.23">
<td class="ltx_td" id="S4.T2.2.25.23.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.25.23.2">PIQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.25.23.3">88.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.25.23.4">83.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.25.23.5">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.25.23.5.1">88.4</span> (0.1↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.25.23.6">87.7 (4.2↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.26.24">
<td class="ltx_td" id="S4.T2.2.26.24.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.26.24.2">OpenbookQA</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.26.24.3">83.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.26.24.4"><span class="ltx_text ltx_font_bold" id="S4.T2.2.26.24.4.1">89.8</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.26.24.5">88.4 (0.9↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.26.24.6">88.8 (1.0↓)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.27.25">
<td class="ltx_td" id="S4.T2.2.27.25.1"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T2.2.27.25.2">C-MMLU</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.27.25.3">70.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.27.25.4">81.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.27.25.5">73.9 (3.6↑)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.27.25.6">
<span class="ltx_text ltx_font_bold" id="S4.T2.2.27.25.6.1">81.8</span> (0.8↑)</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.28.26">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T2.2.28.26.1"><span class="ltx_text ltx_font_bold" id="S4.T2.2.28.26.1.1">Avg</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T2.2.28.26.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.2.28.26.3">56.41</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.2.28.26.4">65.28</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.2.28.26.5">63.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T2.2.28.26.6"><span class="ltx_text ltx_font_bold" id="S4.T2.2.28.26.6.1">68.88</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>RTD on language understanding benches. Baseline refers to zero-shot performance. ICL exceeds MPT-7B’s <math alttext="2048" class="ltx_Math" display="inline" id="S4.T2.4.m1.1"><semantics id="S4.T2.4.m1.1b"><mn id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml">2048</mn><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><cn id="S4.T2.4.m1.1.1.cmml" type="integer" xref="S4.T2.4.m1.1.1">2048</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">2048</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.m1.1e">2048</annotation></semantics></math> context window, with a 0 score result, recorded as failed in the table.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T4.fig1" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 3: </span>Confused rate.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.fig1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.fig1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.fig1.1.1.1.1">Model</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig1.1.1.1.2">Llama2-7B</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig1.1.1.1.3">GLM3-6B</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig1.1.1.1.4">Yi-34B</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.fig1.1.2.2.1">Rate</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig1.1.2.2.2">8.6%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig1.1.2.2.3">11.81%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig1.1.2.2.4">0.44%</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T4.fig2" style="width:212.5pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 4: </span>RTD comparing with fine-tune methods.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T4.fig2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.fig2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T4.fig2.1.1.1.1">Methods</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig2.1.1.1.2">baseline</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig2.1.1.1.3">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig2.1.1.1.4">FT</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.fig2.1.1.1.5">RTD</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T4.fig2.1.2.2.1">Score</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig2.1.2.2.2">41.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig2.1.2.2.3">42.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig2.1.2.2.4">46.31</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.fig2.1.2.2.5">42.8</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Language Generation</h3>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Reasoning with Context</h5>
<div class="ltx_para" id="S4.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px1.p1.1">Generative tasks are generally subjective and difficult to test. We constructed a benchmark based on Retrieval-Augmented Generation (RAG) and Open Book Question Answering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib29" title="">29</a>]</cite> to test the potential of RTD in areas requires advance reasoning such as knowledge injection. Chain-of-Thought <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib40" title="">40</a>]</cite> is a method that encourage the model to provide a step-by-step analysis before giving the final answer, thereby enhancing the model’s capabilities. We compared the performance of the model when introducing references through the ICL method and the RTD method, to determine the effectiveness of the RTD method. The extra knowledge source was Wikipedia. The generation of the datastore can be found in Detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A2.SS2" title="B.2 Wikipedia Fact Retrieval ‣ Appendix B Generation of Reference Datastore ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">B.2</span></a>. With the results of table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.T6" title="Table 6 ‣ Style transfer ‣ 4.2 Language Generation ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, it can be seen that RTD was indeed helpful in knowledge injection. Besides, the context length is shrunk by a lot, thus saves reasoning GPU time and memory consumption. A detailed exploration of why RAG score is lower than baseline can be find in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A3" title="Appendix C RAG’s Deficiency in Testing ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S4.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Style transfer</h5>
<div class="ltx_para" id="S4.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S4.SS2.SSS0.Px2.p1.1">To explore whether the RTD method can be used to modify the language style of the model, we designed a style transfer experiment. We used a moderately scaled and strongly styled dataset, Tiny-Shakespeare <cite class="ltx_cite ltx_citemacro_cite">[<span class="ltx_ref ltx_missing_citation ltx_ref_self">tinyssp</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">tinyssp2</span>]</cite>, and compared the perplexity (PPL) of the model on the test set after LoRA and RTD, to measure whether our method can help the model change the output style. The results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.T6" title="Table 6 ‣ Style transfer ‣ 4.2 Language Generation ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> prove that our RTD method can reduce the perplexity of the model, enabling the model to adapt to the style of different datasets.
The hyperparameters of LoRA are in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A4" title="Appendix D LoRA Hyperparamters ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T6">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T6.fig1" style="width:212.5pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 5: </span>Comparison of RTD and RAG using Wikipedia on LLaMA2-7B-Chat. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T6.fig1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T6.fig1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T6.fig1.1.1.1.1">LLaMA2-7B-Chat</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.fig1.1.1.1.2">Acc</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.fig1.1.1.1.3">Latency (ms)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.fig1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T6.fig1.1.2.1.1">Baseline</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.fig1.1.2.1.2">39.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.fig1.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S4.T6.fig1.1.2.1.3.1">42.5</span></td>
</tr>
<tr class="ltx_tr" id="S4.T6.fig1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T6.fig1.1.3.2.1">Wiki RAG</th>
<td class="ltx_td ltx_align_center" id="S4.T6.fig1.1.3.2.2">29.0</td>
<td class="ltx_td ltx_align_center" id="S4.T6.fig1.1.3.2.3">&gt; 200</td>
</tr>
<tr class="ltx_tr" id="S4.T6.fig1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T6.fig1.1.4.3.1">Wiki RTD</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.fig1.1.4.3.2"><span class="ltx_text ltx_font_bold" id="S4.T6.fig1.1.4.3.2.1">44.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T6.fig1.1.4.3.3">46.5</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_top" id="S4.T6.fig2" style="width:212.5pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Table 6: </span>PPL of the fitted model on domain datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T6.fig2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.fig2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T6.fig2.1.1.1.1">Dataset</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.fig2.1.1.1.2">Baseline</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.fig2.1.1.1.3">LoRA</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T6.fig2.1.1.1.4">RTD</td>
</tr>
<tr class="ltx_tr" id="S4.T6.fig2.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T6.fig2.1.2.2.1">Tiny-S</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.fig2.1.2.2.2">1.6982</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.fig2.1.2.2.3">1.3710</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.fig2.1.2.2.4">1.4501</td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Influence of Hyper-parameters in RTD</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.4">Although our method is quick and efficient, it still introduces several hyper-parameters. We hope to explore the relationship between these hyper-parameters and the final performance of RTD. We conducted a series of ablation experiments on LLaMA2-7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib38" title="">38</a>]</cite> and OBQA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib29" title="">29</a>]</cite> to explore the impact of different hyper-parameters on performance and how to quickly determine the optimal hyper-parameters. The overall result can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.F6" title="Figure 6 ‣ 4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>.
If not tuned, we set <math alttext="k=1024" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">k</mi><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><eq id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝑘</ci><cn id="S4.SS3.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS3.p1.1.m1.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">k=1024</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_k = 1024</annotation></semantics></math>, <math alttext="s_{\mathcal{L}}=19,828" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.2"><semantics id="S4.SS3.p1.2.m2.2a"><mrow id="S4.SS3.p1.2.m2.2.3" xref="S4.SS3.p1.2.m2.2.3.cmml"><msub id="S4.SS3.p1.2.m2.2.3.2" xref="S4.SS3.p1.2.m2.2.3.2.cmml"><mi id="S4.SS3.p1.2.m2.2.3.2.2" xref="S4.SS3.p1.2.m2.2.3.2.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.2.m2.2.3.2.3" xref="S4.SS3.p1.2.m2.2.3.2.3.cmml">ℒ</mi></msub><mo id="S4.SS3.p1.2.m2.2.3.1" xref="S4.SS3.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S4.SS3.p1.2.m2.2.3.3.2" xref="S4.SS3.p1.2.m2.2.3.3.1.cmml"><mn id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">19</mn><mo id="S4.SS3.p1.2.m2.2.3.3.2.1" xref="S4.SS3.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS3.p1.2.m2.2.2" xref="S4.SS3.p1.2.m2.2.2.cmml">828</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.2b"><apply id="S4.SS3.p1.2.m2.2.3.cmml" xref="S4.SS3.p1.2.m2.2.3"><eq id="S4.SS3.p1.2.m2.2.3.1.cmml" xref="S4.SS3.p1.2.m2.2.3.1"></eq><apply id="S4.SS3.p1.2.m2.2.3.2.cmml" xref="S4.SS3.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.2.3.2.1.cmml" xref="S4.SS3.p1.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.2.3.2.2.cmml" xref="S4.SS3.p1.2.m2.2.3.2.2">𝑠</ci><ci id="S4.SS3.p1.2.m2.2.3.2.3.cmml" xref="S4.SS3.p1.2.m2.2.3.2.3">ℒ</ci></apply><list id="S4.SS3.p1.2.m2.2.3.3.1.cmml" xref="S4.SS3.p1.2.m2.2.3.3.2"><cn id="S4.SS3.p1.2.m2.1.1.cmml" type="integer" xref="S4.SS3.p1.2.m2.1.1">19</cn><cn id="S4.SS3.p1.2.m2.2.2.cmml" type="integer" xref="S4.SS3.p1.2.m2.2.2">828</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.2c">s_{\mathcal{L}}=19,828</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.2d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT = 19 , 828</annotation></semantics></math>, <math alttext="\lambda=1" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">λ</mi><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><eq id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1"></eq><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝜆</ci><cn id="S4.SS3.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS3.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\lambda=1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">italic_λ = 1</annotation></semantics></math> and <math alttext="T=750" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">T</mi><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">750</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><eq id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1"></eq><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝑇</ci><cn id="S4.SS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS3.p1.4.m4.1.1.3">750</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">T=750</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_T = 750</annotation></semantics></math> by default.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.18">Depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.F6" title="Figure 6 ‣ 4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (a), RTD’s performance improves initially with increasing <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><msub id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑠</ci><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math> but eventually maxed out and starts oscillating when <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑠</ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math> reaches <math alttext="4096" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><mn id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">4096</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><cn id="S4.SS3.p2.3.m3.1.1.cmml" type="integer" xref="S4.SS3.p2.3.m3.1.1">4096</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">4096</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">4096</annotation></semantics></math>. Generally, a larger <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><msub id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2" xref="S4.SS3.p2.4.m4.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p2.4.m4.1.1.2.cmml" xref="S4.SS3.p2.4.m4.1.1.2">𝑠</ci><ci id="S4.SS3.p2.4.m4.1.1.3.cmml" xref="S4.SS3.p2.4.m4.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math> gives a better performance, but it do get maxed out depends on the specific task.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.F6" title="Figure 6 ‣ 4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (b) showcased us how RTD’s performance consistently improves as <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_k</annotation></semantics></math> increases initially, but eventually reaches a plateau, similiar with the <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m6.1"><semantics id="S4.SS3.p2.6.m6.1a"><msub id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><apply id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m6.1.1.2.cmml" xref="S4.SS3.p2.6.m6.1.1.2">𝑠</ci><ci id="S4.SS3.p2.6.m6.1.1.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math>. To be denoted is that a larger <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m7.1"><semantics id="S4.SS3.p2.7.m7.1a"><mi id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><ci id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">italic_k</annotation></semantics></math> could harm efficiency.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.F6" title="Figure 6 ‣ 4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (c) implies that RTD can only reach it’s best performance when <math alttext="T" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m8.1"><semantics id="S4.SS3.p2.8.m8.1a"><mi id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><ci id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">italic_T</annotation></semantics></math> is large enough. Empirically, due to the characteristics of the exponential function, as long as the range of scaled distances <math alttext="d^{\prime\prime}" class="ltx_Math" display="inline" id="S4.SS3.p2.9.m9.1"><semantics id="S4.SS3.p2.9.m9.1a"><msup id="S4.SS3.p2.9.m9.1.1" xref="S4.SS3.p2.9.m9.1.1.cmml"><mi id="S4.SS3.p2.9.m9.1.1.2" xref="S4.SS3.p2.9.m9.1.1.2.cmml">d</mi><mo id="S4.SS3.p2.9.m9.1.1.3" xref="S4.SS3.p2.9.m9.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m9.1b"><apply id="S4.SS3.p2.9.m9.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.9.m9.1.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1">superscript</csymbol><ci id="S4.SS3.p2.9.m9.1.1.2.cmml" xref="S4.SS3.p2.9.m9.1.1.2">𝑑</ci><ci id="S4.SS3.p2.9.m9.1.1.3.cmml" xref="S4.SS3.p2.9.m9.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m9.1c">d^{\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m9.1d">italic_d start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is kept between <math alttext="1" class="ltx_Math" display="inline" id="S4.SS3.p2.10.m10.1"><semantics id="S4.SS3.p2.10.m10.1a"><mn id="S4.SS3.p2.10.m10.1.1" xref="S4.SS3.p2.10.m10.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m10.1b"><cn id="S4.SS3.p2.10.m10.1.1.cmml" type="integer" xref="S4.SS3.p2.10.m10.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m10.1c">1</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.10.m10.1d">1</annotation></semantics></math>-<math alttext="2" class="ltx_Math" display="inline" id="S4.SS3.p2.11.m11.1"><semantics id="S4.SS3.p2.11.m11.1a"><mn id="S4.SS3.p2.11.m11.1.1" xref="S4.SS3.p2.11.m11.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m11.1b"><cn id="S4.SS3.p2.11.m11.1.1.cmml" type="integer" xref="S4.SS3.p2.11.m11.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m11.1c">2</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.11.m11.1d">2</annotation></semantics></math>, a sufficiently good effect can be achieved.
In RTD, <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p2.12.m12.1"><semantics id="S4.SS3.p2.12.m12.1a"><mi id="S4.SS3.p2.12.m12.1.1" xref="S4.SS3.p2.12.m12.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m12.1b"><ci id="S4.SS3.p2.12.m12.1.1.cmml" xref="S4.SS3.p2.12.m12.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m12.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.12.m12.1d">italic_λ</annotation></semantics></math> is an important variable, especially in generation tasks. However, <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p2.13.m13.1"><semantics id="S4.SS3.p2.13.m13.1a"><mi id="S4.SS3.p2.13.m13.1.1" xref="S4.SS3.p2.13.m13.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m13.1b"><ci id="S4.SS3.p2.13.m13.1.1.cmml" xref="S4.SS3.p2.13.m13.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m13.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.13.m13.1d">italic_λ</annotation></semantics></math> does not require high precision, and the range is relatively limited, so a good enough effect can be achieved quickly through a few attempts. Empirically speaking, <math alttext="0.4" class="ltx_Math" display="inline" id="S4.SS3.p2.14.m14.1"><semantics id="S4.SS3.p2.14.m14.1a"><mn id="S4.SS3.p2.14.m14.1.1" xref="S4.SS3.p2.14.m14.1.1.cmml">0.4</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.14.m14.1b"><cn id="S4.SS3.p2.14.m14.1.1.cmml" type="float" xref="S4.SS3.p2.14.m14.1.1">0.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.14.m14.1c">0.4</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.14.m14.1d">0.4</annotation></semantics></math>-<math alttext="0.7" class="ltx_Math" display="inline" id="S4.SS3.p2.15.m15.1"><semantics id="S4.SS3.p2.15.m15.1a"><mn id="S4.SS3.p2.15.m15.1.1" xref="S4.SS3.p2.15.m15.1.1.cmml">0.7</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.15.m15.1b"><cn id="S4.SS3.p2.15.m15.1.1.cmml" type="float" xref="S4.SS3.p2.15.m15.1.1">0.7</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.15.m15.1c">0.7</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.15.m15.1d">0.7</annotation></semantics></math> is a suitable range for <math alttext="\lambda" class="ltx_Math" display="inline" id="S4.SS3.p2.16.m16.1"><semantics id="S4.SS3.p2.16.m16.1a"><mi id="S4.SS3.p2.16.m16.1.1" xref="S4.SS3.p2.16.m16.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.16.m16.1b"><ci id="S4.SS3.p2.16.m16.1.1.cmml" xref="S4.SS3.p2.16.m16.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.16.m16.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.16.m16.1d">italic_λ</annotation></semantics></math>.

Previous studies indicated that by pruning the dimension of attention won’t hurt <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p2.17.m17.1"><semantics id="S4.SS3.p2.17.m17.1a"><mi id="S4.SS3.p2.17.m17.1.1" xref="S4.SS3.p2.17.m17.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.17.m17.1b"><ci id="S4.SS3.p2.17.m17.1.1.cmml" xref="S4.SS3.p2.17.m17.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.17.m17.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.17.m17.1d">italic_k</annotation></semantics></math>nn algorithm’s performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib13" title="">13</a>]</cite>. In the case of RTD, showcased in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.F6" title="Figure 6 ‣ 4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a> (d), it can be found that the performance won’t drop with at least <math alttext="\frac{1}{4}" class="ltx_Math" display="inline" id="S4.SS3.p2.18.m18.1"><semantics id="S4.SS3.p2.18.m18.1a"><mfrac id="S4.SS3.p2.18.m18.1.1" xref="S4.SS3.p2.18.m18.1.1.cmml"><mn id="S4.SS3.p2.18.m18.1.1.2" xref="S4.SS3.p2.18.m18.1.1.2.cmml">1</mn><mn id="S4.SS3.p2.18.m18.1.1.3" xref="S4.SS3.p2.18.m18.1.1.3.cmml">4</mn></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.18.m18.1b"><apply id="S4.SS3.p2.18.m18.1.1.cmml" xref="S4.SS3.p2.18.m18.1.1"><divide id="S4.SS3.p2.18.m18.1.1.1.cmml" xref="S4.SS3.p2.18.m18.1.1"></divide><cn id="S4.SS3.p2.18.m18.1.1.2.cmml" type="integer" xref="S4.SS3.p2.18.m18.1.1.2">1</cn><cn id="S4.SS3.p2.18.m18.1.1.3.cmml" type="integer" xref="S4.SS3.p2.18.m18.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.18.m18.1c">\frac{1}{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.18.m18.1d">divide start_ARG 1 end_ARG start_ARG 4 end_ARG</annotation></semantics></math> heads remained, and the generation speed was boosted as more heads are dropped.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="218" id="S4.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Hyper-parameters’ influence on RTD’s performance</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduce Reference Trustable Decoding, a novel training-free method designed to augment Large Language Models in downstream tasks. RTD refines the output distribution by leveraging references retrieved from a specially curated datastore, as a bypass of conventional <span class="ltx_text ltx_font_typewriter" id="S5.p1.1.1">LM_Head</span>. Our experimental results demonstrate RTD achieved superior performance compared to the In-Context Learning baseline in 21 out of 25 different dataset and model configurations as well as fine-tune based methods. This result highlights the effectiveness of RTD across a diverse range of scenarios, underscoring its potential as a robust solution for enhancing language model capabilities in downstream tasks.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Limitations &amp; Future Work</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">RTD is an efficient and quick method to augment the capabilities of models on specific downstream tasks. However, for some tasks, especially generative tasks, the large reference datastores that are difficult to directly compress may pose challenges for applications. Nevertheless, we believe that there is likely inherent redundancy in such large datastores. We hope to enable machines to identify these redundancies while maintaining a gradient-free method, in order to achieve efficient fine-tuning. How to make RTD accomplish tasks with high quality while being space-efficient is our following research direction.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">We sincerely appreciate the valuable feedback provided by all reviewers during the review process, as well as the efforts of the area chairs.
This work was supported by the National Natural Science Foundation of China (No. 62306216), the Natural Science Foundation of Hubei Province of China (No. 2023AFB816), the Fundamental Research Funds for the Central Universities (No. 2042023kf0133).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Mistral AI.

</span>
<span class="ltx_bibblock">Mistral 7b, the best 7b model to date, apache 2.0, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Joshua Ainslie, James Lee-Thorp, Michiel de Jong, Yury Zemlyanskiy, Federico Lebrón, and Sumit Sanghai.

</span>
<span class="ltx_bibblock">GQA: training generalized multi-query transformer models from multi-head checkpoints.

</span>
<span class="ltx_bibblock">In Houda Bouamor, Juan Pino, and Kalika Bali, editors, <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing, EMNLP 2023, Singapore, December 6-10, 2023</span>, pages 4895–4901. Association for Computational Linguistics, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Lucas Bandarkar, Davis Liang, Benjamin Muller, Mikel Artetxe, Satya Narayan Shukla, Donald Husa, Naman Goyal, Abhinandan Krishnan, Luke Zettlemoyer, and Madian Khabsa.

</span>
<span class="ltx_bibblock">The belebele benchmark: a parallel reading comprehension dataset in 122 language variants.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2308.16884</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Sumithra Bhakthavatsalam, Daniel Khashabi, Tushar Khot, Bhavana Dalvi Mishra, Kyle Richardson, Ashish Sabharwal, Carissa Schoenick, Oyvind Tafjord, and Peter Clark.

</span>
<span class="ltx_bibblock">Think you have solved direct-answer question answering? try arc-da, the direct-answer AI2 reasoning challenge.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">CoRR</span>, abs/2102.03315, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Yonatan Bisk, Rowan Zellers, Ronan Le Bras, Jianfeng Gao, and Yejin Choi.

</span>
<span class="ltx_bibblock">Piqa: Reasoning about physical commonsense in natural language.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Thirty-Fourth AAAI Conference on Artificial Intelligence</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In H. Larochelle, M. Ranzato, R. Hadsell, M.F. Balcan, and H. Lin, editors, <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</span>, volume 33, pages 1877–1901. Curran Associates, Inc., 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and Jie Tang.

</span>
<span class="ltx_bibblock">Glm: General language model pretraining with autoregressive blank infilling.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</span>, pages 320–335, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, Anirudh Goyal, Anthony Hartshorn, Aobo Yang, Archi Mitra, Archie Sravankumar, Artem Korenev, Arthur Hinsvark, Arun Rao, Aston Zhang, Aurélien Rodriguez, Austen Gregerson, Ava Spataru, Baptiste Rozière, Bethany Biron, Binh Tang, Bobbie Chern, Charlotte Caucheteux, Chaya Nayak, Chloe Bi, Chris Marra, Chris McConnell, Christian Keller, Christophe Touret, Chunyang Wu, Corinne Wong, Cristian Canton Ferrer, Cyrus Nikolaidis, Damien Allonsius, Daniel Song, Danielle Pintz, Danny Livshits, David Esiobu, Dhruv Choudhary, Dhruv Mahajan, Diego Garcia-Olano, Diego Perino, Dieuwke Hupkes, Egor Lakomkin, Ehab AlBadawy, Elina Lobanova, Emily Dinan, Eric Michael Smith, Filip Radenovic, Frank Zhang, Gabriel Synnaeve, Gabrielle Lee, Georgia Lewis Anderson, Graeme Nail, Grégoire Mialon, Guan Pang, Guillem Cucurell, Hailey Nguyen, Hannah Korevaar, Hu Xu, Hugo
Touvron, Iliyan Zarov, Imanol Arrieta Ibarra, Isabel M. Kloumann, Ishan Misra, Ivan Evtimov, Jade Copet, Jaewon Lee, Jan Geffert, Jana Vranes, Jason Park, Jay Mahadeokar, Jeet Shah, Jelmer van der Linde, Jennifer Billock, Jenny Hong, Jenya Lee, Jeremy Fu, Jianfeng Chi, Jianyu Huang, Jiawen Liu, Jie Wang, Jiecao Yu, Joanna Bitton, Joe Spisak, Jongsoo Park, Joseph Rocca, Joshua Johnstun, Joshua Saxe, Junteng Jia, Kalyan Vasuden Alwala, Kartikeya Upasani, Kate Plawiak, Ke Li, Kenneth Heafield, Kevin Stone, and et al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">CoRR</span>, abs/2407.21783, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Luciano Floridi and Massimo Chiriatti.

</span>
<span class="ltx_bibblock">Gpt-3: Its nature, scope, limits, and consequences.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Minds and Machines</span>, 30:681–694, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Jiatao Gu, Yong Wang, Kyunghyun Cho, and Victor O.K. Li.

</span>
<span class="ltx_bibblock">Search engine guided neural machine translation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</span>, 32(1), Apr. 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Michael Günther, Jackmin Ong, Isabelle Mohr, Alaeddine Abdessalem, Tanguy Abel, Mohammad Kalim Akram, Susana Guzman, Georgios Mastrapas, Saba Sturua, Bo Wang, Maximilian Werk, Nan Wang, and Han Xiao.

</span>
<span class="ltx_bibblock">Jina embeddings 2: 8192-token general-purpose text embeddings for long documents, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Kazuma Hashimoto, Raffaella Buschiazzo, James Bradbury, Teresa Marshall, Richard Socher, and Caiming Xiong.

</span>
<span class="ltx_bibblock">A high-quality multilingual dataset for structured documentation translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Proceedings of the Fourth Conference on Machine Translation (Volume 1: Research Papers)</span>, pages 116–127, Florence, Italy, August 2019. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Junxian He, Graham Neubig, and Taylor Berg-Kirkpatrick.

</span>
<span class="ltx_bibblock">Efficient nearest neighbor language models.

</span>
<span class="ltx_bibblock">In Marie-Francine Moens, Xuanjing Huang, Lucia Specia, and Scott Wen-tau Yih, editors, <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, EMNLP 2021, Virtual Event / Punta Cana, Dominican Republic, 7-11 November, 2021</span>, pages 5703–5714. Association for Computational Linguistics, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Ruidan He, Linlin Liu, Hai Ye, Qingyu Tan, Bosheng Ding, Liying Cheng, Jia-Wei Low, Lidong Bing, and Luo Si.

</span>
<span class="ltx_bibblock">On the effectiveness of adapter-based tuning for pretrained language model adaptation.

</span>
<span class="ltx_bibblock">In Chengqing Zong, Fei Xia, Wenjie Li, and Roberto Navigli, editors, <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, ACL/IJCNLP 2021, (Volume 1: Long Papers), Virtual Event, August 1-6, 2021</span>, pages 2208–2222. Association for Computational Linguistics, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring massive multitask language understanding.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</span>. OpenReview.net, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022</span>. OpenReview.net, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Yuzhen Huang, Yuzhuo Bai, Zhihao Zhu, Junlei Zhang, Jinghan Zhang, Tangjun Su, Junteng Liu, Chuancheng Lv, Yikai Zhang, Jiayi Lei, Yao Fu, Maosong Sun, and Junxian He.

</span>
<span class="ltx_bibblock">C-eval: A multi-level multi-discipline chinese evaluation suite for foundation models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Advances in Neural Information Processing Systems</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Gautier Izacard, Patrick S. H. Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand Joulin, Sebastian Riedel, and Edouard Grave.

</span>
<span class="ltx_bibblock">Atlas: Few-shot learning with retrieval augmented language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">J. Mach. Learn. Res.</span>, 24:251:1–251:43, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Imran Khan Mohd Jais, Amelia Ritahani Ismail, and Syed Qamrun Nisa.

</span>
<span class="ltx_bibblock">Adam optimization algorithm for wide and deep neural network.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">Knowledge Engineering and Data Science</span>, 2(1):41–46, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Jeff Johnson, Matthijs Douze, and Hervé Jégou.

</span>
<span class="ltx_bibblock">Billion-scale similarity search with GPUs.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">IEEE Transactions on Big Data</span>, 7(3):535–547, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Enkelejda Kasneci, Kathrin Seßler, Stefan Küchemann, Maria Bannert, Daryna Dementieva, Frank Fischer, Urs Gasser, Georg Groh, Stephan Günnemann, Eyke Hüllermeier, et al.

</span>
<span class="ltx_bibblock">Chatgpt for good? on opportunities and challenges of large language models for education.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">Learning and individual differences</span>, 103:102274, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Urvashi Khandelwal, Omer Levy, Dan Jurafsky, Luke Zettlemoyer, and Mike Lewis.

</span>
<span class="ltx_bibblock">Generalization through memorization: Nearest neighbor language models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Patrick S. H. Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, Sebastian Riedel, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive NLP tasks.

</span>
<span class="ltx_bibblock">In Hugo Larochelle, Marc’Aurelio Ranzato, Raia Hadsell, Maria-Florina Balcan, and Hsuan-Tien Lin, editors, <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Advances in Neural Information Processing Systems 33: Annual Conference on Neural Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020, virtual</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Haonan Li, Yixuan Zhang, Fajri Koto, Yifei Yang, Hai Zhao, Yeyun Gong, Nan Duan, and Timothy Baldwin.

</span>
<span class="ltx_bibblock">CMMLU: measuring massive multitask language understanding in chinese.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">CoRR</span>, abs/2306.09212, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Shangqing Liu, Yu Chen, Xiaofei Xie, Jing Kai Siow, and Yang Liu.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for code summarization via hybrid GNN.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021</span>. OpenReview.net, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Xiao Liu, Kaixuan Ji, Yicheng Fu, Weng Tam, Zhengxiao Du, Zhilin Yang, and Jie Tang.

</span>
<span class="ltx_bibblock">P-tuning: Prompt tuning can be comparable to fine-tuning across scales and tasks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers)</span>, pages 61–68, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Xuan Liu, Jie Zhang, Song Guo, Haoyang Shang, Chengxu Yang, and Quanyan Zhu.

</span>
<span class="ltx_bibblock">Exploring prosocial irrationality for LLM agents: A social cognition view.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">CoRR</span>, abs/2405.14744, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yuning Mao, Pengcheng He, Xiaodong Liu, Yelong Shen, Jianfeng Gao, Jiawei Han, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Generation-augmented retrieval for open-domain question answering.

</span>
<span class="ltx_bibblock">In Chengqing Zong, Fei Xia, Wenjie Li, and Roberto Navigli, editors, <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing, ACL/IJCNLP 2021, (Volume 1: Long Papers), Virtual Event, August 1-6, 2021</span>, pages 4089–4100. Association for Computational Linguistics, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal.

</span>
<span class="ltx_bibblock">Can a suit of armor conduct electricity? a new dataset for open book question answering.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">EMNLP</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Feng Nie, Meixi Chen, Zhirui Zhang, and Xu Cheng.

</span>
<span class="ltx_bibblock">Improving few-shot performance of language models via nearest neighbor calibration.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2212.02216</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Liu Peng.

</span>
<span class="ltx_bibblock">llama2-7b-mmlu, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Liu Peng.

</span>
<span class="ltx_bibblock">Mmlu-recall, employ mmlu (cmmlu) questions as initial seeds to retrieve related articles from multiple training data corpora., 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Abigail See, Peter J. Liu, and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Get to the point: Summarization with pointer-generator networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</span>, pages 1073–1083, Vancouver, Canada, July 2017. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Kurt Shuster, Spencer Poff, Moya Chen, Douwe Kiela, and Jason Weston.

</span>
<span class="ltx_bibblock">Retrieval augmentation reduces hallucination in conversation.

</span>
<span class="ltx_bibblock">In Marie-Francine Moens, Xuanjing Huang, Lucia Specia, and Scott Wen-tau Yih, editors, <span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">Findings of the Association for Computational Linguistics: EMNLP 2021, Virtual Event / Punta Cana, Dominican Republic, 16-20 November, 2021</span>, pages 3784–3803. Association for Computational Linguistics, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Weixi Song, Zuchao Li, Lefei Zhang, Hai Zhao, and Bo Du.

</span>
<span class="ltx_bibblock">Sparse is enough in fine-tuning pre-trained large language models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib35.1.1">Forty-first International Conference on Machine Learning, ICML 2024, Vienna, Austria, July 21-27, 2024</span>. OpenReview.net, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
MosaicML NLP Team.

</span>
<span class="ltx_bibblock">Introducing mpt-7b: A new standard for open-source, commercially usable llms, 2023.

</span>
<span class="ltx_bibblock">Accessed: 2023-05-05.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Arun James Thirunavukarasu, Darren Shu Jeng Ting, Kabilan Elangovan, Laura Gutierrez, Ting Fang Tan, and Daniel Shu Wei Ting.

</span>
<span class="ltx_bibblock">Large language models in medicine.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">Nature medicine</span>, 29(8):1930–1940, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2307.09288</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, Ed H. Chi, Tatsunori Hashimoto, Oriol Vinyals, Percy Liang, Jeff Dean, and William Fedus.

</span>
<span class="ltx_bibblock">Emergent abilities of large language models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib39.1.1">Trans. Mach. Learn. Res.</span>, 2022, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Jason Wei and Xuezhi Wang.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock">In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh, editors, <span class="ltx_text ltx_font_italic" id="bib.bib40.1.1">Advances in Neural Information Processing Systems</span>, volume 35, pages 24824–24837. Curran Associates, Inc., 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Remi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander Rush.

</span>
<span class="ltx_bibblock">Transformers: State-of-the-art natural language processing.

</span>
<span class="ltx_bibblock">In Qun Liu and David Schlangen, editors, <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</span>, pages 38–45, Online, October 2020. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Jun Cheng Yang, Zuchao Li, Shuai Xie, Wei Yu, Shijun Li, and Bo Du.

</span>
<span class="ltx_bibblock">Soft-prompting with graph-of-thought for multi-modal representation learning.

</span>
<span class="ltx_bibblock">In Nicoletta Calzolari, Min-Yen Kan, Veronique Hoste, Alessandro Lenci, Sakriani Sakti, and Nianwen Xue, editors, <span class="ltx_text ltx_font_italic" id="bib.bib42.1.1">Proceedings of the 2024 Joint International Conference on Computational Linguistics, Language Resources and Evaluation (LREC-COLING 2024)</span>, pages 15024–15036, Torino, Italia, May 2024. ELRA and ICCL.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Yao Yao, Zuchao Li, and Hai Zhao.

</span>
<span class="ltx_bibblock">SirLLM: Streaming infinite retentive LLM.

</span>
<span class="ltx_bibblock">In Lun-Wei Ku, Andre Martins, and Vivek Srikumar, editors, <span class="ltx_text ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 62nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</span>, pages 2611–2624, Bangkok, Thailand, August 2024. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Gyeong-In Yu, Joo Seong Jeong, Geon-Woo Kim, Soojeong Kim, and Byung-Gon Chun.

</span>
<span class="ltx_bibblock">Orca: A distributed serving system for Transformer-Based generative models.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib44.1.1">16th USENIX Symposium on Operating Systems Design and Implementation (OSDI 22)</span>, pages 521–538, Carlsbad, CA, July 2022. USENIX Association.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Aohan Zeng, Xiao Liu, Zhengxiao Du, Zihan Wang, Hanyu Lai, Ming Ding, Zhuoyi Yang, Yifan Xu, Wendi Zheng, Xiao Xia, Weng Lam Tam, Zixuan Ma, Yufei Xue, Jidong Zhai, Wenguang Chen, Zhiyuan Liu, Peng Zhang, Yuxiao Dong, and Jie Tang.

</span>
<span class="ltx_bibblock">GLM-130B: an open bilingual pre-trained model.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023</span>. OpenReview.net, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Hongyi Zhang, Zuchao Li, Ping Wang, and Hai Zhao.

</span>
<span class="ltx_bibblock">Selective prefix tuning for pre-trained language models.

</span>
<span class="ltx_bibblock">In Lun-Wei Ku, Andre Martins, and Vivek Srikumar, editors, <span class="ltx_text ltx_font_italic" id="bib.bib46.1.1">Findings of the Association for Computational Linguistics ACL 2024</span>, pages 2806–2813, Bangkok, Thailand and virtual meeting, August 2024. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Yixuan Zhang and Haonan Li.

</span>
<span class="ltx_bibblock">Can large langauge model comprehend ancient chinese? A preliminary test on ACLUE.

</span>
<span class="ltx_bibblock">In Adam Anderson, Shai Gordin, Bin Li, Yudong Liu, and Marco Carlo Passarotti, editors, <span class="ltx_text ltx_font_italic" id="bib.bib47.1.1">Proceedings of the Ancient Language Processing Workshop, ALP@RANLP 2023, Varna, Bulgaria, 8 September, 2023</span>, pages 80–87. INCOMA Ltd., Shoumen, Bulgaria / ACL, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Yue Zhang, Yafu Li, Leyang Cui, Deng Cai, Lemao Liu, Tingchen Fu, Xinting Huang, Enbo Zhao, Yu Zhang, Yulong Chen, Longyue Wang, Anh Tuan Luu, Wei Bi, Freda Shi, and Shuming Shi.

</span>
<span class="ltx_bibblock">Siren’s song in the ai ocean: A survey on hallucination in large language models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Yongchao Zhou, Andrei Ioan Muresanu, Ziwen Han, Keiran Paster, Silviu Pitis, Harris Chan, and Jimmy Ba.

</span>
<span class="ltx_bibblock">Large language models are human-level prompt engineers.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib49.1.1">The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023</span>. OpenReview.net, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="Ax1">
<h2 class="ltx_title ltx_title_appendix">Appendix</h2>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Testing Environments</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">All testing are done on a server with 8*A100 80G SXM. For models with less than 15B parameters, 2 of 8 GPUs are used. For models with more than 15B parameters, 4 of 8 GPUs are used. All testing are carried out under HuggingFace Transformers library <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib41" title="">41</a>]</cite>.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Generation of Reference Datastore</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Benchmark Testing</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.4">To generate reference datastores, LLMs are shown to the questions and options in the training split of the benchmarks and we store the attention output. For each question this process is repeated four times cycling through A, B, C, D as the correct value. <math alttext="3,500" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.2"><semantics id="A2.SS1.p1.1.m1.2a"><mrow id="A2.SS1.p1.1.m1.2.3.2" xref="A2.SS1.p1.1.m1.2.3.1.cmml"><mn id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml">3</mn><mo id="A2.SS1.p1.1.m1.2.3.2.1" xref="A2.SS1.p1.1.m1.2.3.1.cmml">,</mo><mn id="A2.SS1.p1.1.m1.2.2" xref="A2.SS1.p1.1.m1.2.2.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.2b"><list id="A2.SS1.p1.1.m1.2.3.1.cmml" xref="A2.SS1.p1.1.m1.2.3.2"><cn id="A2.SS1.p1.1.m1.1.1.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1">3</cn><cn id="A2.SS1.p1.1.m1.2.2.cmml" type="integer" xref="A2.SS1.p1.1.m1.2.2">500</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.2c">3,500</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.2d">3 , 500</annotation></semantics></math> to <math alttext="5,000" class="ltx_Math" display="inline" id="A2.SS1.p1.2.m2.2"><semantics id="A2.SS1.p1.2.m2.2a"><mrow id="A2.SS1.p1.2.m2.2.3.2" xref="A2.SS1.p1.2.m2.2.3.1.cmml"><mn id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml">5</mn><mo id="A2.SS1.p1.2.m2.2.3.2.1" xref="A2.SS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="A2.SS1.p1.2.m2.2.2" xref="A2.SS1.p1.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.2b"><list id="A2.SS1.p1.2.m2.2.3.1.cmml" xref="A2.SS1.p1.2.m2.2.3.2"><cn id="A2.SS1.p1.2.m2.1.1.cmml" type="integer" xref="A2.SS1.p1.2.m2.1.1">5</cn><cn id="A2.SS1.p1.2.m2.2.2.cmml" type="integer" xref="A2.SS1.p1.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.2c">5,000</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.2.m2.2d">5 , 000</annotation></semantics></math> question is shown to the LLMs and about <math alttext="20,000" class="ltx_Math" display="inline" id="A2.SS1.p1.3.m3.2"><semantics id="A2.SS1.p1.3.m3.2a"><mrow id="A2.SS1.p1.3.m3.2.3.2" xref="A2.SS1.p1.3.m3.2.3.1.cmml"><mn id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">20</mn><mo id="A2.SS1.p1.3.m3.2.3.2.1" xref="A2.SS1.p1.3.m3.2.3.1.cmml">,</mo><mn id="A2.SS1.p1.3.m3.2.2" xref="A2.SS1.p1.3.m3.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.2b"><list id="A2.SS1.p1.3.m3.2.3.1.cmml" xref="A2.SS1.p1.3.m3.2.3.2"><cn id="A2.SS1.p1.3.m3.1.1.cmml" type="integer" xref="A2.SS1.p1.3.m3.1.1">20</cn><cn id="A2.SS1.p1.3.m3.2.2.cmml" type="integer" xref="A2.SS1.p1.3.m3.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.2c">20,000</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.3.m3.2d">20 , 000</annotation></semantics></math> <math alttext="\left(k,v\right)" class="ltx_Math" display="inline" id="A2.SS1.p1.4.m4.2"><semantics id="A2.SS1.p1.4.m4.2a"><mrow id="A2.SS1.p1.4.m4.2.3.2" xref="A2.SS1.p1.4.m4.2.3.1.cmml"><mo id="A2.SS1.p1.4.m4.2.3.2.1" xref="A2.SS1.p1.4.m4.2.3.1.cmml">(</mo><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">k</mi><mo id="A2.SS1.p1.4.m4.2.3.2.2" xref="A2.SS1.p1.4.m4.2.3.1.cmml">,</mo><mi id="A2.SS1.p1.4.m4.2.2" xref="A2.SS1.p1.4.m4.2.2.cmml">v</mi><mo id="A2.SS1.p1.4.m4.2.3.2.3" xref="A2.SS1.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.2b"><interval closure="open" id="A2.SS1.p1.4.m4.2.3.1.cmml" xref="A2.SS1.p1.4.m4.2.3.2"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝑘</ci><ci id="A2.SS1.p1.4.m4.2.2.cmml" xref="A2.SS1.p1.4.m4.2.2">𝑣</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.2c">\left(k,v\right)</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.4.m4.2d">( italic_k , italic_v )</annotation></semantics></math> entries are generated. To be noted is that the reference datastore of CMMLU is generated from validation set of C-eval <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib17" title="">17</a>]</cite>, split <span class="ltx_text ltx_font_italic" id="A2.SS1.p1.4.1">zho_Hans</span> of belebele <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib3" title="">3</a>]</cite> and testing set of ACLUE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib47" title="">47</a>]</cite> since there is no training split for the benchmark.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Wikipedia Fact Retrieval</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.5">For our reference datastore, we encoded all of the Wikipedia sentences using the Jina <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#bib.bib11" title="">11</a>]</cite> model, which is smaller in both it’s parameter count and hidden size, resulting in a faster generation speed and smaller space cost for encoded vector datastore. Every usable sentence in Wikipedia is encoded, meanwhile the sentences from the same page share a same value, which is the no. of this page. When testing, we use the same model to encode the question, then we search the most relevant pages in the datastore, be the metric of cosine similarity, to retrieve the most relevant pages.
In this section, <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="A2.SS2.p1.1.m1.1"><semantics id="A2.SS2.p1.1.m1.1a"><msub id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml"><mi id="A2.SS2.p1.1.m1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="A2.SS2.p1.1.m1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p1.1.m1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.2">𝑠</ci><ci id="A2.SS2.p1.1.m1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math> is same as the sentences count of Wikipedia, around <math alttext="73\mathrm{M}" class="ltx_Math" display="inline" id="A2.SS2.p1.2.m2.1"><semantics id="A2.SS2.p1.2.m2.1a"><mrow id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml"><mn id="A2.SS2.p1.2.m2.1.1.2" xref="A2.SS2.p1.2.m2.1.1.2.cmml">73</mn><mo id="A2.SS2.p1.2.m2.1.1.1" xref="A2.SS2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="A2.SS2.p1.2.m2.1.1.3" mathvariant="normal" xref="A2.SS2.p1.2.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><apply id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1"><times id="A2.SS2.p1.2.m2.1.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1.1"></times><cn id="A2.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="A2.SS2.p1.2.m2.1.1.2">73</cn><ci id="A2.SS2.p1.2.m2.1.1.3.cmml" xref="A2.SS2.p1.2.m2.1.1.3">M</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">73\mathrm{M}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.2.m2.1d">73 roman_M</annotation></semantics></math>. <math alttext="k=1024" class="ltx_Math" display="inline" id="A2.SS2.p1.3.m3.1"><semantics id="A2.SS2.p1.3.m3.1a"><mrow id="A2.SS2.p1.3.m3.1.1" xref="A2.SS2.p1.3.m3.1.1.cmml"><mi id="A2.SS2.p1.3.m3.1.1.2" xref="A2.SS2.p1.3.m3.1.1.2.cmml">k</mi><mo id="A2.SS2.p1.3.m3.1.1.1" xref="A2.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS2.p1.3.m3.1.1.3" xref="A2.SS2.p1.3.m3.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.3.m3.1b"><apply id="A2.SS2.p1.3.m3.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1"><eq id="A2.SS2.p1.3.m3.1.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1.1"></eq><ci id="A2.SS2.p1.3.m3.1.1.2.cmml" xref="A2.SS2.p1.3.m3.1.1.2">𝑘</ci><cn id="A2.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="A2.SS2.p1.3.m3.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.3.m3.1c">k=1024</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.3.m3.1d">italic_k = 1024</annotation></semantics></math>. <math alttext="T" class="ltx_Math" display="inline" id="A2.SS2.p1.4.m4.1"><semantics id="A2.SS2.p1.4.m4.1a"><mi id="A2.SS2.p1.4.m4.1.1" xref="A2.SS2.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.4.m4.1b"><ci id="A2.SS2.p1.4.m4.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.4.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.4.m4.1d">italic_T</annotation></semantics></math> and <math alttext="\lambda" class="ltx_Math" display="inline" id="A2.SS2.p1.5.m5.1"><semantics id="A2.SS2.p1.5.m5.1a"><mi id="A2.SS2.p1.5.m5.1.1" xref="A2.SS2.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.5.m5.1b"><ci id="A2.SS2.p1.5.m5.1.1.cmml" xref="A2.SS2.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.5.m5.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p1.5.m5.1d">italic_λ</annotation></semantics></math> are not applicable here.</p>
</div>
<div class="ltx_para" id="A2.SS2.p2">
<p class="ltx_p" id="A2.SS2.p2.3">With retrieved pages, we generate a reference datastore with every sentence in the pages. We first calculate attention representations for every token, whose corresponding value is the id of next token, <span class="ltx_text ltx_font_italic" id="A2.SS2.p2.3.1">eos</span> for the last token. Then we use this dynamically generated reference datastore for following RTD. In this section, <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="A2.SS2.p2.1.m1.1"><semantics id="A2.SS2.p2.1.m1.1a"><msub id="A2.SS2.p2.1.m1.1.1" xref="A2.SS2.p2.1.m1.1.1.cmml"><mi id="A2.SS2.p2.1.m1.1.1.2" xref="A2.SS2.p2.1.m1.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="A2.SS2.p2.1.m1.1.1.3" xref="A2.SS2.p2.1.m1.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.1.m1.1b"><apply id="A2.SS2.p2.1.m1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p2.1.m1.1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p2.1.m1.1.1.2.cmml" xref="A2.SS2.p2.1.m1.1.1.2">𝑠</ci><ci id="A2.SS2.p2.1.m1.1.1.3.cmml" xref="A2.SS2.p2.1.m1.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math> is the same as the length of tokenized sequence, <math alttext="6200" class="ltx_Math" display="inline" id="A2.SS2.p2.2.m2.1"><semantics id="A2.SS2.p2.2.m2.1a"><mn id="A2.SS2.p2.2.m2.1.1" xref="A2.SS2.p2.2.m2.1.1.cmml">6200</mn><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.2.m2.1b"><cn id="A2.SS2.p2.2.m2.1.1.cmml" type="integer" xref="A2.SS2.p2.2.m2.1.1">6200</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.2.m2.1c">6200</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.2.m2.1d">6200</annotation></semantics></math> on average, and we use <math alttext="T=750,k=1024,\lambda=0.4" class="ltx_Math" display="inline" id="A2.SS2.p2.3.m3.2"><semantics id="A2.SS2.p2.3.m3.2a"><mrow id="A2.SS2.p2.3.m3.2.2.2" xref="A2.SS2.p2.3.m3.2.2.3.cmml"><mrow id="A2.SS2.p2.3.m3.1.1.1.1" xref="A2.SS2.p2.3.m3.1.1.1.1.cmml"><mi id="A2.SS2.p2.3.m3.1.1.1.1.2" xref="A2.SS2.p2.3.m3.1.1.1.1.2.cmml">T</mi><mo id="A2.SS2.p2.3.m3.1.1.1.1.1" xref="A2.SS2.p2.3.m3.1.1.1.1.1.cmml">=</mo><mn id="A2.SS2.p2.3.m3.1.1.1.1.3" xref="A2.SS2.p2.3.m3.1.1.1.1.3.cmml">750</mn></mrow><mo id="A2.SS2.p2.3.m3.2.2.2.3" xref="A2.SS2.p2.3.m3.2.2.3a.cmml">,</mo><mrow id="A2.SS2.p2.3.m3.2.2.2.2.2" xref="A2.SS2.p2.3.m3.2.2.2.2.3.cmml"><mrow id="A2.SS2.p2.3.m3.2.2.2.2.1.1" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.cmml"><mi id="A2.SS2.p2.3.m3.2.2.2.2.1.1.2" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.2.cmml">k</mi><mo id="A2.SS2.p2.3.m3.2.2.2.2.1.1.1" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.1.cmml">=</mo><mn id="A2.SS2.p2.3.m3.2.2.2.2.1.1.3" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.3.cmml">1024</mn></mrow><mo id="A2.SS2.p2.3.m3.2.2.2.2.2.3" xref="A2.SS2.p2.3.m3.2.2.2.2.3a.cmml">,</mo><mrow id="A2.SS2.p2.3.m3.2.2.2.2.2.2" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.cmml"><mi id="A2.SS2.p2.3.m3.2.2.2.2.2.2.2" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.2.cmml">λ</mi><mo id="A2.SS2.p2.3.m3.2.2.2.2.2.2.1" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.1.cmml">=</mo><mn id="A2.SS2.p2.3.m3.2.2.2.2.2.2.3" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml">0.4</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.3.m3.2b"><apply id="A2.SS2.p2.3.m3.2.2.3.cmml" xref="A2.SS2.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="A2.SS2.p2.3.m3.2.2.3a.cmml" xref="A2.SS2.p2.3.m3.2.2.2.3">formulae-sequence</csymbol><apply id="A2.SS2.p2.3.m3.1.1.1.1.cmml" xref="A2.SS2.p2.3.m3.1.1.1.1"><eq id="A2.SS2.p2.3.m3.1.1.1.1.1.cmml" xref="A2.SS2.p2.3.m3.1.1.1.1.1"></eq><ci id="A2.SS2.p2.3.m3.1.1.1.1.2.cmml" xref="A2.SS2.p2.3.m3.1.1.1.1.2">𝑇</ci><cn id="A2.SS2.p2.3.m3.1.1.1.1.3.cmml" type="integer" xref="A2.SS2.p2.3.m3.1.1.1.1.3">750</cn></apply><apply id="A2.SS2.p2.3.m3.2.2.2.2.3.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.SS2.p2.3.m3.2.2.2.2.3a.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="A2.SS2.p2.3.m3.2.2.2.2.1.1.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1"><eq id="A2.SS2.p2.3.m3.2.2.2.2.1.1.1.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.1"></eq><ci id="A2.SS2.p2.3.m3.2.2.2.2.1.1.2.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.2">𝑘</ci><cn id="A2.SS2.p2.3.m3.2.2.2.2.1.1.3.cmml" type="integer" xref="A2.SS2.p2.3.m3.2.2.2.2.1.1.3">1024</cn></apply><apply id="A2.SS2.p2.3.m3.2.2.2.2.2.2.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2"><eq id="A2.SS2.p2.3.m3.2.2.2.2.2.2.1.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.1"></eq><ci id="A2.SS2.p2.3.m3.2.2.2.2.2.2.2.cmml" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.2">𝜆</ci><cn id="A2.SS2.p2.3.m3.2.2.2.2.2.2.3.cmml" type="float" xref="A2.SS2.p2.3.m3.2.2.2.2.2.2.3">0.4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.3.m3.2c">T=750,k=1024,\lambda=0.4</annotation><annotation encoding="application/x-llamapun" id="A2.SS2.p2.3.m3.2d">italic_T = 750 , italic_k = 1024 , italic_λ = 0.4</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>RAG’s Deficiency in Testing</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.3">RAG method’s shows a decline in performance in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.T6" title="Table 6 ‣ Style transfer ‣ 4.2 Language Generation ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>. To explain this, we can further examine the average length of the tokenized sequences of the retrieved context, which is around <math alttext="6200" class="ltx_Math" display="inline" id="A3.p1.1.m1.1"><semantics id="A3.p1.1.m1.1a"><mn id="A3.p1.1.m1.1.1" xref="A3.p1.1.m1.1.1.cmml">6200</mn><annotation-xml encoding="MathML-Content" id="A3.p1.1.m1.1b"><cn id="A3.p1.1.m1.1.1.cmml" type="integer" xref="A3.p1.1.m1.1.1">6200</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.1.m1.1c">6200</annotation><annotation encoding="application/x-llamapun" id="A3.p1.1.m1.1d">6200</annotation></semantics></math>, showcased in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A3.T7" title="Table 7 ‣ Appendix C RAG’s Deficiency in Testing ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>. This length will hardly increase any inference cost for the RTD method, due to the small <math alttext="s_{\mathcal{L}}" class="ltx_Math" display="inline" id="A3.p1.2.m2.1"><semantics id="A3.p1.2.m2.1a"><msub id="A3.p1.2.m2.1.1" xref="A3.p1.2.m2.1.1.cmml"><mi id="A3.p1.2.m2.1.1.2" xref="A3.p1.2.m2.1.1.2.cmml">s</mi><mi class="ltx_font_mathcaligraphic" id="A3.p1.2.m2.1.1.3" xref="A3.p1.2.m2.1.1.3.cmml">ℒ</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p1.2.m2.1b"><apply id="A3.p1.2.m2.1.1.cmml" xref="A3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p1.2.m2.1.1.1.cmml" xref="A3.p1.2.m2.1.1">subscript</csymbol><ci id="A3.p1.2.m2.1.1.2.cmml" xref="A3.p1.2.m2.1.1.2">𝑠</ci><ci id="A3.p1.2.m2.1.1.3.cmml" xref="A3.p1.2.m2.1.1.3">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.2.m2.1c">s_{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="A3.p1.2.m2.1d">italic_s start_POSTSUBSCRIPT caligraphic_L end_POSTSUBSCRIPT</annotation></semantics></math>, but it exceeds the pre-training sequence length of LLaMA2-7B-Chat, which is <math alttext="4096" class="ltx_Math" display="inline" id="A3.p1.3.m3.1"><semantics id="A3.p1.3.m3.1a"><mn id="A3.p1.3.m3.1.1" xref="A3.p1.3.m3.1.1.cmml">4096</mn><annotation-xml encoding="MathML-Content" id="A3.p1.3.m3.1b"><cn id="A3.p1.3.m3.1.1.cmml" type="integer" xref="A3.p1.3.m3.1.1">4096</cn></annotation-xml><annotation encoding="application/x-tex" id="A3.p1.3.m3.1c">4096</annotation><annotation encoding="application/x-llamapun" id="A3.p1.3.m3.1d">4096</annotation></semantics></math>. That is to say, the naive RAG method here will cause sequence length overflow, thereby significantly affecting performance. If the overflow happened, then the model’s ability is cut down significantly.</p>
</div>
<figure class="ltx_table" id="A3.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Average length by token in OBQA question answering process, split by sections.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A3.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T7.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="A3.T7.1.1.1.1">Section</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A3.T7.1.1.1.2">Average Length</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T7.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A3.T7.1.2.1.1">Wikipedia Context</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A3.T7.1.2.1.2">6192</td>
</tr>
<tr class="ltx_tr" id="A3.T7.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A3.T7.1.3.2.1">Question</th>
<td class="ltx_td ltx_align_center" id="A3.T7.1.3.2.2">84</td>
</tr>
<tr class="ltx_tr" id="A3.T7.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A3.T7.1.4.3.1">Response</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A3.T7.1.4.3.2">231</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>LoRA Hyperparamters</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">See Table <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A4.T8" title="Table 8 ‣ Appendix D LoRA Hyperparamters ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>. For LoRA tuning on MMLU, any question whoes tokenized length exceed 4096 was evicted from both training and testing. The maximum tokenized length of the Tiny-Shakespeare dataset is 900.</p>
</div>
<figure class="ltx_table" id="A4.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>LoRA Hyper-parameters</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A4.T8.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T8.4.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="A4.T8.4.5.1.1">Hyper-parameter</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="A4.T8.4.5.1.2">Value</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.6.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T8.4.6.2.1">Batch Size</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.4.6.2.2">4</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.7.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.4.7.3.1">Epochs</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.7.3.2">2</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.8.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.4.8.4.1">Max Seq. Len.</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.8.4.2">4096</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.9.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T8.4.9.5.1">LoRA Target</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.4.9.5.2">{Q, K, V, O, Up, Down, Gate}_proj</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.10.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.4.10.6.1">LoRA Rank</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.10.6.2">16</td>
</tr>
<tr class="ltx_tr" id="A4.T8.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.1.1.1">LoRA <math alttext="\alpha" class="ltx_Math" display="inline" id="A4.T8.1.1.1.m1.1"><semantics id="A4.T8.1.1.1.m1.1a"><mi id="A4.T8.1.1.1.m1.1.1" xref="A4.T8.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A4.T8.1.1.1.m1.1b"><ci id="A4.T8.1.1.1.m1.1.1.cmml" xref="A4.T8.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.1.1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="A4.T8.1.1.1.m1.1d">italic_α</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="A4.T8.1.1.2">32</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.11.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.4.11.7.1">LoRA dropout</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.11.7.2">0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.12.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="A4.T8.4.12.8.1">Learning Rate</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A4.T8.4.12.8.2">1e-5</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.13.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.4.13.9.1">Optimizer</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.13.9.2">AdamW</td>
</tr>
<tr class="ltx_tr" id="A4.T8.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.2.2.1">Adma RMS <math alttext="\epsilon" class="ltx_Math" display="inline" id="A4.T8.2.2.1.m1.1"><semantics id="A4.T8.2.2.1.m1.1a"><mi id="A4.T8.2.2.1.m1.1.1" xref="A4.T8.2.2.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="A4.T8.2.2.1.m1.1b"><ci id="A4.T8.2.2.1.m1.1.1.cmml" xref="A4.T8.2.2.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.2.2.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="A4.T8.2.2.1.m1.1d">italic_ϵ</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="A4.T8.2.2.2">2e-4</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.3.3.1">Adam <math alttext="\beta" class="ltx_Math" display="inline" id="A4.T8.3.3.1.m1.1"><semantics id="A4.T8.3.3.1.m1.1a"><mi id="A4.T8.3.3.1.m1.1.1" xref="A4.T8.3.3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A4.T8.3.3.1.m1.1b"><ci id="A4.T8.3.3.1.m1.1.1.cmml" xref="A4.T8.3.3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.3.3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A4.T8.3.3.1.m1.1d">italic_β</annotation></semantics></math>
</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.4.2"><math alttext="(0.9,0.999)" class="ltx_Math" display="inline" id="A4.T8.4.4.2.m1.2"><semantics id="A4.T8.4.4.2.m1.2a"><mrow id="A4.T8.4.4.2.m1.2.3.2" xref="A4.T8.4.4.2.m1.2.3.1.cmml"><mo id="A4.T8.4.4.2.m1.2.3.2.1" stretchy="false" xref="A4.T8.4.4.2.m1.2.3.1.cmml">(</mo><mn id="A4.T8.4.4.2.m1.1.1" xref="A4.T8.4.4.2.m1.1.1.cmml">0.9</mn><mo id="A4.T8.4.4.2.m1.2.3.2.2" xref="A4.T8.4.4.2.m1.2.3.1.cmml">,</mo><mn id="A4.T8.4.4.2.m1.2.2" xref="A4.T8.4.4.2.m1.2.2.cmml">0.999</mn><mo id="A4.T8.4.4.2.m1.2.3.2.3" stretchy="false" xref="A4.T8.4.4.2.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.T8.4.4.2.m1.2b"><interval closure="open" id="A4.T8.4.4.2.m1.2.3.1.cmml" xref="A4.T8.4.4.2.m1.2.3.2"><cn id="A4.T8.4.4.2.m1.1.1.cmml" type="float" xref="A4.T8.4.4.2.m1.1.1">0.9</cn><cn id="A4.T8.4.4.2.m1.2.2.cmml" type="float" xref="A4.T8.4.4.2.m1.2.2">0.999</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A4.T8.4.4.2.m1.2c">(0.9,0.999)</annotation><annotation encoding="application/x-llamapun" id="A4.T8.4.4.2.m1.2d">( 0.9 , 0.999 )</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.14.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="A4.T8.4.14.10.1">Adam Weight Decay</th>
<td class="ltx_td ltx_align_center" id="A4.T8.4.14.10.2">0.01</td>
</tr>
<tr class="ltx_tr" id="A4.T8.4.15.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="A4.T8.4.15.11.1">Scheduler</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A4.T8.4.15.11.2">Constant LR</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="Ax2">
<h2 class="ltx_title ltx_title_appendix">NeurIPS Paper Checklist</h2>
<div class="ltx_para" id="Ax2.p1">
<ol class="ltx_enumerate" id="Ax2.I1">
<li class="ltx_item" id="Ax2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="Ax2.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i1.p1.1.1">Claims</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix1.p1">
<p class="ltx_p" id="Ax2.I1.ix1.p1.1">Question: Do the main claims made in the abstract and introduction accurately reflect the paper’s contributions and scope?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix2.p1">
<p class="ltx_p" id="Ax2.I1.ix2.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix2.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix3.p1">
<p class="ltx_p" id="Ax2.I1.ix3.p1.1">Justification: Section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3" title="3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> and section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4" title="4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> reflects our main claim.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix4.p1">
<p class="ltx_p" id="Ax2.I1.ix4.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix4.I1">
<li class="ltx_item" id="Ax2.I1.ix4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix4.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix4.I1.i1.p1.1">The answer NA means that the abstract and introduction do not include the claims made in the paper.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix4.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix4.I1.i2.p1.1">The abstract and/or introduction should clearly state the claims made, including the contributions made in the paper and important assumptions and limitations. A No or NA answer to this question will not be perceived well by the reviewers.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix4.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix4.I1.i3.p1.1">The claims made should match theoretical and experimental results, and reflect how much the results can be expected to generalize to other settings.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix4.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix4.I1.i4.p1.1">It is fine to include aspirational goals as motivation as long as it is clear that these goals are not attained by the paper.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="Ax2.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i2.p1.1.1">Limitations</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix5.p1">
<p class="ltx_p" id="Ax2.I1.ix5.p1.1">Question: Does the paper discuss the limitations of the work performed by the authors?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix6.p1">
<p class="ltx_p" id="Ax2.I1.ix6.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix6.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix7.p1">
<p class="ltx_p" id="Ax2.I1.ix7.p1.1">Justification: Section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#Sx1" title="Limitations &amp; Future Work ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_title">Limitations &amp; Future Work</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix8.p1">
<p class="ltx_p" id="Ax2.I1.ix8.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix8.I1">
<li class="ltx_item" id="Ax2.I1.ix8.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i1.p1.1">The answer NA means that the paper has no limitation while the answer No means that the paper has limitations, but those are not discussed in the paper.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i2.p1.1">The authors are encouraged to create a separate "Limitations" section in their paper.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i3.p1.1">The paper should point out any strong assumptions and how robust the results are to violations of these assumptions (e.g., independence assumptions, noiseless settings, model well-specification, asymptotic approximations only holding locally). The authors should reflect on how these assumptions might be violated in practice and what the implications would be.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i4.p1.1">The authors should reflect on the scope of the claims made, e.g., if the approach was only tested on a few datasets or with a few runs. In general, empirical results often depend on implicit assumptions, which should be articulated.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i5.p1.1">The authors should reflect on the factors that influence the performance of the approach. For example, a facial recognition algorithm may perform poorly when image resolution is low or images are taken in low lighting. Or a speech-to-text system might not be used reliably to provide closed captions for online lectures because it fails to handle technical jargon.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i6.p1.1">The authors should discuss the computational efficiency of the proposed algorithms and how they scale with dataset size.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i7.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i7.p1.1">If applicable, the authors should discuss possible limitations of their approach to address problems of privacy and fairness.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix8.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix8.I1.i8.p1">
<p class="ltx_p" id="Ax2.I1.ix8.I1.i8.p1.1">While the authors might fear that complete honesty about limitations might be used by reviewers as grounds for rejection, a worse outcome might be that reviewers discover limitations that aren’t acknowledged in the paper. The authors should use their best judgment and recognize that individual actions in favor of transparency play an important role in developing norms that preserve the integrity of the community. Reviewers will be specifically instructed to not penalize honesty concerning limitations.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="Ax2.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i3.p1.1.1">Theory Assumptions and Proofs</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix9.p1">
<p class="ltx_p" id="Ax2.I1.ix9.p1.1">Question: For each theoretical result, does the paper provide the full set of assumptions and a complete (and correct) proof?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix10" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix10.p1">
<p class="ltx_p" id="Ax2.I1.ix10.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix10.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix11" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix11.p1">
<p class="ltx_p" id="Ax2.I1.ix11.p1.1">Justification: Our main theoretical result is about efficiencies in section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S3.SS4" title="3.4 Time and Memory Consumption ‣ 3 Reference Trustable Decoding ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">3.4</span></a>, in which they were proved.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix12" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix12.p1">
<p class="ltx_p" id="Ax2.I1.ix12.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix12.I1">
<li class="ltx_item" id="Ax2.I1.ix12.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix12.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix12.I1.i1.p1.1">The answer NA means that the paper does not include theoretical results.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix12.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix12.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix12.I1.i2.p1.1">All the theorems, formulas, and proofs in the paper should be numbered and cross-referenced.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix12.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix12.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix12.I1.i3.p1.1">All assumptions should be clearly stated or referenced in the statement of any theorems.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix12.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix12.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix12.I1.i4.p1.1">The proofs can either appear in the main paper or the supplemental material, but if they appear in the supplemental material, the authors are encouraged to provide a short proof sketch to provide intuition.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix12.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix12.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix12.I1.i5.p1.1">Inversely, any informal proof provided in the core of the paper should be complemented by formal proofs provided in appendix or supplemental material.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix12.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix12.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.ix12.I1.i6.p1.1">Theorems and Lemmas that the proof relies upon should be properly referenced.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="Ax2.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i4.p1.1.1">Experimental Result Reproducibility</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix13" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix13.p1">
<p class="ltx_p" id="Ax2.I1.ix13.p1.1">Question: Does the paper fully disclose all the information needed to reproduce the main experimental results of the paper to the extent that it affects the main claims and/or conclusions of the paper (regardless of whether the code and data are provided or not)?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix14" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix14.p1">
<p class="ltx_p" id="Ax2.I1.ix14.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix14.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix15" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix15.p1">
<p class="ltx_p" id="Ax2.I1.ix15.p1.1">Justification: The detailed description of our experiments and hyper-parameters can be found in section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4" title="4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> and appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#A4" title="Appendix D LoRA Hyperparamters ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix16.p1">
<p class="ltx_p" id="Ax2.I1.ix16.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix16.I1">
<li class="ltx_item" id="Ax2.I1.ix16.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i1.p1.1">The answer NA means that the paper does not include experiments.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i2.p1.1">If the paper includes experiments, a No answer to this question will not be perceived well by the reviewers: Making the paper reproducible is important, regardless of whether the code and data are provided or not.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i3.p1.1">If the contribution is a dataset and/or model, the authors should describe the steps taken to make their results reproducible or verifiable.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i4.p1.1">Depending on the contribution, reproducibility can be accomplished in various ways. For example, if the contribution is a novel architecture, describing the architecture fully might suffice, or if the contribution is a specific model and empirical evaluation, it may be necessary to either make it possible for others to replicate the model with the same dataset, or provide access to the model. In general. releasing code and data is often one good way to accomplish this, but reproducibility can also be provided via detailed instructions for how to replicate the results, access to a hosted model (e.g., in the case of a large language model), releasing of a model checkpoint, or other means that are appropriate to the research performed.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i5.p1.1">While NeurIPS does not require releasing code, the conference does require all submissions to provide some reasonable avenue for reproducibility, which may depend on the nature of the contribution. For example</p>
<ol class="ltx_enumerate" id="Ax2.I1.ix16.I1.i5.I1">
<li class="ltx_item" id="Ax2.I1.ix16.I1.i5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(a)</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i5.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i5.I1.i1.p1.1">If the contribution is primarily a new algorithm, the paper should make it clear how to reproduce that algorithm.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(b)</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i5.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i5.I1.i2.p1.1">If the contribution is primarily a new model architecture, the paper should describe the architecture clearly and fully.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(c)</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i5.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i5.I1.i3.p1.1">If the contribution is a new model (e.g., a large language model), then there should either be a way to access this model for reproducing the results or a way to reproduce the model (e.g., with an open-source dataset or instructions for how to construct the dataset).</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix16.I1.i5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(d)</span>
<div class="ltx_para" id="Ax2.I1.ix16.I1.i5.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix16.I1.i5.I1.i4.p1.1">We recognize that reproducibility may be tricky in some cases, in which case authors are welcome to describe the particular way they provide for reproducibility. In the case of closed-source models, it may be that access to the model is limited in some way (e.g., to registered users), but it should be possible for other researchers to have some path to reproducing or verifying the results.</p>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span>
<div class="ltx_para" id="Ax2.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i5.p1.1.1">Open access to data and code</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix17" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix17.p1">
<p class="ltx_p" id="Ax2.I1.ix17.p1.1">Question: Does the paper provide open access to the data and code, with sufficient instructions to faithfully reproduce the main experimental results, as described in supplemental material?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix18" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix18.p1">
<p class="ltx_p" id="Ax2.I1.ix18.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix18.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix19" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix19.p1">
<p class="ltx_p" id="Ax2.I1.ix19.p1.1">Justification: Our main codes can be found in Supplementary Material.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix20.p1">
<p class="ltx_p" id="Ax2.I1.ix20.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix20.I1">
<li class="ltx_item" id="Ax2.I1.ix20.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i1.p1.1">The answer NA means that paper does not include experiments requiring code.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i2.p1.1">Please see the NeurIPS code and data submission guidelines (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://nips.cc/public/guides/CodeSubmissionPolicy" title="">https://nips.cc/public/guides/CodeSubmissionPolicy</a>) for more details.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i3.p1.1">While we encourage the release of code and data, we understand that this might not be possible, so “No” is an acceptable answer. Papers cannot be rejected simply for not including code, unless this is central to the contribution (e.g., for a new open-source benchmark).</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i4.p1.1">The instructions should contain the exact command and environment needed to run to reproduce the results. See the NeurIPS code and data submission guidelines (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://nips.cc/public/guides/CodeSubmissionPolicy" title="">https://nips.cc/public/guides/CodeSubmissionPolicy</a>) for more details.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i5.p1.1">The authors should provide instructions on data access and preparation, including how to access the raw data, preprocessed data, intermediate data, and generated data, etc.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i6.p1.1">The authors should provide scripts to reproduce all experimental results for the new proposed method and baselines. If only a subset of experiments are reproducible, they should state which ones are omitted from the script and why.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i7.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i7.p1.1">At submission time, to preserve anonymity, the authors should release anonymized versions (if applicable).</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix20.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix20.I1.i8.p1">
<p class="ltx_p" id="Ax2.I1.ix20.I1.i8.p1.1">Providing as much information as possible in supplemental material (appended to the paper) is recommended, but including URLs to data and code is permitted.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span>
<div class="ltx_para" id="Ax2.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i6.p1.1.1">Experimental Setting/Details</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix21" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix21.p1">
<p class="ltx_p" id="Ax2.I1.ix21.p1.1">Question: Does the paper specify all the training and test details (e.g., data splits, hyperparameters, how they were chosen, type of optimizer, etc.) necessary to understand the results?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix22" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix22.p1">
<p class="ltx_p" id="Ax2.I1.ix22.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix22.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix23" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix23.p1">
<p class="ltx_p" id="Ax2.I1.ix23.p1.1">Justification: Discussions of hyper-parameters of our methods can be found in section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4.SS3" title="4.3 Influence of Hyper-parameters in RTD ‣ 4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4.3</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix24" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix24.p1">
<p class="ltx_p" id="Ax2.I1.ix24.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix24.I1">
<li class="ltx_item" id="Ax2.I1.ix24.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix24.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix24.I1.i1.p1.1">The answer NA means that the paper does not include experiments.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix24.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix24.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix24.I1.i2.p1.1">The experimental setting should be presented in the core of the paper to a level of detail that is necessary to appreciate the results and make sense of them.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix24.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix24.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix24.I1.i3.p1.1">The full details can be provided either with the code, in appendix, or as supplemental material.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span>
<div class="ltx_para" id="Ax2.I1.i7.p1">
<p class="ltx_p" id="Ax2.I1.i7.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i7.p1.1.1">Experiment Statistical Significance</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix25" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix25.p1">
<p class="ltx_p" id="Ax2.I1.ix25.p1.1">Question: Does the paper report error bars suitably and correctly defined or other appropriate information about the statistical significance of the experiments?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix26" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix26.p1">
<p class="ltx_p" id="Ax2.I1.ix26.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix26.p1.1.1" style="color:#FF8000;">[No] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix27" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix27.p1">
<p class="ltx_p" id="Ax2.I1.ix27.p1.1">Justification: The experimental results are definitive and do not involve any random factors.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix28.p1">
<p class="ltx_p" id="Ax2.I1.ix28.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix28.I1">
<li class="ltx_item" id="Ax2.I1.ix28.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i1.p1.1">The answer NA means that the paper does not include experiments.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i2.p1.1">The authors should answer "Yes" if the results are accompanied by error bars, confidence intervals, or statistical significance tests, at least for the experiments that support the main claims of the paper.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i3.p1.1">The factors of variability that the error bars are capturing should be clearly stated (for example, train/test split, initialization, random drawing of some parameter, or overall run with given experimental conditions).</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i4.p1.1">The method for calculating the error bars should be explained (closed form formula, call to a library function, bootstrap, etc.)</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i5.p1.1">The assumptions made should be given (e.g., Normally distributed errors).</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i6.p1.1">It should be clear whether the error bar is the standard deviation or the standard error of the mean.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i7.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i7.p1.1">It is OK to report 1-sigma error bars, but one should state it. The authors should preferably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis of Normality of errors is not verified.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i8.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i8.p1.1">For asymmetric distributions, the authors should be careful not to show in tables or figures symmetric error bars that would yield results that are out of range (e.g. negative error rates).</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix28.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix28.I1.i9.p1">
<p class="ltx_p" id="Ax2.I1.ix28.I1.i9.p1.1">If error bars are reported in tables or plots, The authors should explain in the text how they were calculated and reference the corresponding figures or tables in the text.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">8.</span>
<div class="ltx_para" id="Ax2.I1.i8.p1">
<p class="ltx_p" id="Ax2.I1.i8.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i8.p1.1.1">Experiments Compute Resources</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix29" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix29.p1">
<p class="ltx_p" id="Ax2.I1.ix29.p1.1">Question: For each experiment, does the paper provide sufficient information on the computer resources (type of compute workers, memory, time of execution) needed to reproduce the experiments?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix30" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix30.p1">
<p class="ltx_p" id="Ax2.I1.ix30.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix30.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix31" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix31.p1">
<p class="ltx_p" id="Ax2.I1.ix31.p1.1">Justification: All information above are given in section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4" title="4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a> and with specific experiment focused on some of them.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix32" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix32.p1">
<p class="ltx_p" id="Ax2.I1.ix32.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix32.I1">
<li class="ltx_item" id="Ax2.I1.ix32.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix32.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix32.I1.i1.p1.1">The answer NA means that the paper does not include experiments.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix32.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix32.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix32.I1.i2.p1.1">The paper should indicate the type of compute workers CPU or GPU, internal cluster, or cloud provider, including relevant memory and storage.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix32.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix32.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix32.I1.i3.p1.1">The paper should provide the amount of compute required for each of the individual experimental runs as well as estimate the total compute.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix32.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix32.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix32.I1.i4.p1.1">The paper should disclose whether the full research project required more compute than the experiments reported in the paper (e.g., preliminary or failed experiments that didn’t make it into the paper).</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">9.</span>
<div class="ltx_para" id="Ax2.I1.i9.p1">
<p class="ltx_p" id="Ax2.I1.i9.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i9.p1.1.1">Code Of Ethics</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix33" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix33.p1">
<p class="ltx_p" id="Ax2.I1.ix33.p1.1">Question: Does the research conducted in the paper conform, in every respect, with the NeurIPS Code of Ethics <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://neurips.cc/public/EthicsGuidelines" title="">https://neurips.cc/public/EthicsGuidelines</a>?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix34" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix34.p1">
<p class="ltx_p" id="Ax2.I1.ix34.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix34.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix35" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix35.p1">
<p class="ltx_p" id="Ax2.I1.ix35.p1.1">Justification: <span class="ltx_text" id="Ax2.I1.ix35.p1.1.1" style="color:#808080;">[N/A] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix36" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix36.p1">
<p class="ltx_p" id="Ax2.I1.ix36.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix36.I1">
<li class="ltx_item" id="Ax2.I1.ix36.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix36.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix36.I1.i1.p1.1">The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix36.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix36.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix36.I1.i2.p1.1">If the authors answer No, they should explain the special circumstances that require a deviation from the Code of Ethics.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix36.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix36.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix36.I1.i3.p1.1">The authors should make sure to preserve anonymity (e.g., if there is a special consideration due to laws or regulations in their jurisdiction).</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i10" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">10.</span>
<div class="ltx_para" id="Ax2.I1.i10.p1">
<p class="ltx_p" id="Ax2.I1.i10.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i10.p1.1.1">Broader Impacts</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix37" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix37.p1">
<p class="ltx_p" id="Ax2.I1.ix37.p1.1">Question: Does the paper discuss both potential positive societal impacts and negative societal impacts of the work performed?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix38" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix38.p1">
<p class="ltx_p" id="Ax2.I1.ix38.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix38.p1.1.1" style="color:#808080;">[N/A] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix39" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix39.p1">
<p class="ltx_p" id="Ax2.I1.ix39.p1.1">Justification: There is no societal impact of the work performed.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix40" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix40.p1">
<p class="ltx_p" id="Ax2.I1.ix40.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix40.I1">
<li class="ltx_item" id="Ax2.I1.ix40.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix40.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix40.I1.i1.p1.1">The answer NA means that there is no societal impact of the work performed.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix40.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix40.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix40.I1.i2.p1.1">If the authors answer NA or No, they should explain why their work has no societal impact or why the paper does not address societal impact.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix40.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix40.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix40.I1.i3.p1.1">Examples of negative societal impacts include potential malicious or unintended uses (e.g., disinformation, generating fake profiles, surveillance), fairness considerations (e.g., deployment of technologies that could make decisions that unfairly impact specific groups), privacy considerations, and security considerations.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix40.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix40.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix40.I1.i4.p1.1">The conference expects that many papers will be foundational research and not tied to particular applications, let alone deployments. However, if there is a direct path to any negative applications, the authors should point it out. For example, it is legitimate to point out that an improvement in the quality of generative models could be used to generate deepfakes for disinformation. On the other hand, it is not needed to point out that a generic algorithm for optimizing neural networks could enable people to train models that generate Deepfakes faster.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix40.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix40.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix40.I1.i5.p1.1">The authors should consider possible harms that could arise when the technology is being used as intended and functioning correctly, harms that could arise when the technology is being used as intended but gives incorrect results, and harms following from (intentional or unintentional) misuse of the technology.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix40.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix40.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.ix40.I1.i6.p1.1">If there are negative societal impacts, the authors could also discuss possible mitigation strategies (e.g., gated release of models, providing defenses in addition to attacks, mechanisms for monitoring misuse, mechanisms to monitor how a system learns from feedback over time, improving the efficiency and accessibility of ML).</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i11" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">11.</span>
<div class="ltx_para" id="Ax2.I1.i11.p1">
<p class="ltx_p" id="Ax2.I1.i11.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i11.p1.1.1">Safeguards</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix41" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix41.p1">
<p class="ltx_p" id="Ax2.I1.ix41.p1.1">Question: Does the paper describe safeguards that have been put in place for responsible release of data or models that have a high risk for misuse (e.g., pretrained language models, image generators, or scraped datasets)?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix42" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix42.p1">
<p class="ltx_p" id="Ax2.I1.ix42.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix42.p1.1.1" style="color:#808080;">[N/A] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix43" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix43.p1">
<p class="ltx_p" id="Ax2.I1.ix43.p1.1">Justification: The paper poses no such risks.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix44" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix44.p1">
<p class="ltx_p" id="Ax2.I1.ix44.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix44.I1">
<li class="ltx_item" id="Ax2.I1.ix44.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix44.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix44.I1.i1.p1.1">The answer NA means that the paper poses no such risks.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix44.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix44.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix44.I1.i2.p1.1">Released models that have a high risk for misuse or dual-use should be released with necessary safeguards to allow for controlled use of the model, for example by requiring that users adhere to usage guidelines or restrictions to access the model or implementing safety filters.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix44.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix44.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix44.I1.i3.p1.1">Datasets that have been scraped from the Internet could pose safety risks. The authors should describe how they avoided releasing unsafe images.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix44.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix44.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix44.I1.i4.p1.1">We recognize that providing effective safeguards is challenging, and many papers do not require this, but we encourage authors to take this into account and make a best faith effort.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i12" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">12.</span>
<div class="ltx_para" id="Ax2.I1.i12.p1">
<p class="ltx_p" id="Ax2.I1.i12.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i12.p1.1.1">Licenses for existing assets</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix45" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix45.p1">
<p class="ltx_p" id="Ax2.I1.ix45.p1.1">Question: Are the creators or original owners of assets (e.g., code, data, models), used in the paper, properly credited and are the license and terms of use explicitly mentioned and properly respected?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix46" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix46.p1">
<p class="ltx_p" id="Ax2.I1.ix46.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix46.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix47" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix47.p1">
<p class="ltx_p" id="Ax2.I1.ix47.p1.1">Justification: All models and datasets we’ve used have been cited properly in section <a class="ltx_ref" href="https://arxiv.org/html/2409.20181v1#S4" title="4 Settings and Experiment ‣ Reference Trustable Decoding: A Training-Free Augmentation Paradigm for Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix48.p1">
<p class="ltx_p" id="Ax2.I1.ix48.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix48.I1">
<li class="ltx_item" id="Ax2.I1.ix48.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i1.p1.1">The answer NA means that the paper does not use existing assets.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i2.p1.1">The authors should cite the original paper that produced the code package or dataset.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i3.p1.1">The authors should state which version of the asset is used and, if possible, include a URL.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i4.p1.1">The name of the license (e.g., CC-BY 4.0) should be included for each asset.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i5.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i5.p1.1">For scraped data from a particular source (e.g., website), the copyright and terms of service of that source should be provided.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i6.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i6.p1.1">If assets are released, the license, copyright information, and terms of use in the package should be provided. For popular datasets, <a class="ltx_ref ltx_url ltx_font_typewriter" href="paperswithcode.com/datasets" title="">paperswithcode.com/datasets</a> has curated licenses for some datasets. Their licensing guide can help determine the license of a dataset.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i7.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i7.p1.1">For existing datasets that are re-packaged, both the original license and the license of the derived asset (if it has changed) should be provided.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix48.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix48.I1.i8.p1">
<p class="ltx_p" id="Ax2.I1.ix48.I1.i8.p1.1">If this information is not available online, the authors are encouraged to reach out to the asset’s creators.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i13" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">13.</span>
<div class="ltx_para" id="Ax2.I1.i13.p1">
<p class="ltx_p" id="Ax2.I1.i13.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i13.p1.1.1">New Assets</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix49" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix49.p1">
<p class="ltx_p" id="Ax2.I1.ix49.p1.1">Question: Are new assets introduced in the paper well documented and is the documentation provided alongside the assets?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix50" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix50.p1">
<p class="ltx_p" id="Ax2.I1.ix50.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix50.p1.1.1" style="color:#0000FF;">[Yes] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix51" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix51.p1">
<p class="ltx_p" id="Ax2.I1.ix51.p1.1">Justification: Our main codes, as assets, are updated in Supplementary Material.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix52" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix52.p1">
<p class="ltx_p" id="Ax2.I1.ix52.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix52.I1">
<li class="ltx_item" id="Ax2.I1.ix52.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix52.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix52.I1.i1.p1.1">The answer NA means that the paper does not release new assets.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix52.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix52.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix52.I1.i2.p1.1">Researchers should communicate the details of the dataset/code/model as part of their submissions via structured templates. This includes details about training, license, limitations, etc.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix52.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix52.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix52.I1.i3.p1.1">The paper should discuss whether and how consent was obtained from people whose asset is used.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix52.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix52.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix52.I1.i4.p1.1">At submission time, remember to anonymize your assets (if applicable). You can either create an anonymized URL or include an anonymized zip file.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i14" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">14.</span>
<div class="ltx_para" id="Ax2.I1.i14.p1">
<p class="ltx_p" id="Ax2.I1.i14.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i14.p1.1.1">Crowdsourcing and Research with Human Subjects</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix53" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix53.p1">
<p class="ltx_p" id="Ax2.I1.ix53.p1.1">Question: For crowdsourcing experiments and research with human subjects, does the paper include the full text of instructions given to participants and screenshots, if applicable, as well as details about compensation (if any)?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix54" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix54.p1">
<p class="ltx_p" id="Ax2.I1.ix54.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix54.p1.1.1" style="color:#808080;">[N/A] </span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix55" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix55.p1">
<p class="ltx_p" id="Ax2.I1.ix55.p1.1">Justification: The paper does not involve crowdsourcing nor research with human subjects.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix56" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix56.p1">
<p class="ltx_p" id="Ax2.I1.ix56.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix56.I1">
<li class="ltx_item" id="Ax2.I1.ix56.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix56.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix56.I1.i1.p1.1">The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix56.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix56.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix56.I1.i2.p1.1">Including this information in the supplemental material is fine, but if the main contribution of the paper involves human subjects, then as much detail as possible should be included in the main paper.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix56.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix56.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix56.I1.i3.p1.1">According to the NeurIPS Code of Ethics, workers involved in data collection, curation, or other labor should be paid at least the minimum wage in the country of the data collector.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.i15" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">15.</span>
<div class="ltx_para" id="Ax2.I1.i15.p1">
<p class="ltx_p" id="Ax2.I1.i15.p1.1"><span class="ltx_text ltx_font_bold" id="Ax2.I1.i15.p1.1.1">Institutional Review Board (IRB) Approvals or Equivalent for Research with Human Subjects</span></p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix57" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix57.p1">
<p class="ltx_p" id="Ax2.I1.ix57.p1.1">Question: Does the paper describe potential risks incurred by study participants, whether such risks were disclosed to the subjects, and whether Institutional Review Board (IRB) approvals (or an equivalent approval/review based on the requirements of your country or institution) were obtained?</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix58" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix58.p1">
<p class="ltx_p" id="Ax2.I1.ix58.p1.1">Answer: <span class="ltx_text" id="Ax2.I1.ix58.p1.1.1" style="color:#808080;">[N/A] </span> </p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix59" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix59.p1">
<p class="ltx_p" id="Ax2.I1.ix59.p1.1">Justification: The paper does not involve crowdsourcing nor research with human subjects.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix60" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"></span>
<div class="ltx_para" id="Ax2.I1.ix60.p1">
<p class="ltx_p" id="Ax2.I1.ix60.p1.1">Guidelines:</p>
<ul class="ltx_itemize" id="Ax2.I1.ix60.I1">
<li class="ltx_item" id="Ax2.I1.ix60.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix60.I1.i1.p1">
<p class="ltx_p" id="Ax2.I1.ix60.I1.i1.p1.1">The answer NA means that the paper does not involve crowdsourcing nor research with human subjects.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix60.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix60.I1.i2.p1">
<p class="ltx_p" id="Ax2.I1.ix60.I1.i2.p1.1">Depending on the country in which research is conducted, IRB approval (or equivalent) may be required for any human subjects research. If you obtained IRB approval, you should clearly state this in the paper.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix60.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix60.I1.i3.p1">
<p class="ltx_p" id="Ax2.I1.ix60.I1.i3.p1.1">We recognize that the procedures for this may vary significantly between institutions and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the guidelines for their institution.</p>
</div>
</li>
<li class="ltx_item" id="Ax2.I1.ix60.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Ax2.I1.ix60.I1.i4.p1">
<p class="ltx_p" id="Ax2.I1.ix60.I1.i4.p1.1">For initial submissions, do not include any information that would break anonymity (if applicable), such as the institution conducting the review.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 30 10:48:26 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
