<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2206.12533] FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING</title><meta property="og:description" content="In order to achieve a general visual question answering (VQA) system, it is essential to learn to answer deeper questions that require compositional reasoning on the image and external knowledge.
Meanwhile, the reasoniâ€¦">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2206.12533">

<!--Generated on Mon Mar 11 16:12:46 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In order to achieve a general visual question answering (VQA) system, it is essential to learn to answer deeper questions that require compositional reasoning on the image and external knowledge.
Meanwhile, the reasoning process should be explicit and explainable to understand the working mechanism of the model.
It is effortless for human but challenging for machines.
In this paper, we propose a Hierarchical Graph Neural Module Network (HGNMN) that reasons over multi-layer graphs with neural modules to address the above issues.
Specifically, we first encode the image by multi-layer graphs from the visual, semantic and commonsense views since the clues that support the answer may exist in different modalities.
Our model consists of several well-designed neural modules that perform specific functions over graphs, which can be used to conduct multi-step reasoning within and between different graphs.
Compared to existing modular networks, we extend visual reasoning from one graph to more graphs.
We can explicitly trace the reasoning process according to module weights and graph attentions.
Experiments show that our model not only achieves state-of-the-art performance on the CRIC dataset but also obtains explicit and explainable reasoning procedures.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">â€”â€‰</span></span>
visual question answering, graph neural modules, compositional reasoning, multi-layer graphs</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">One of the goals of AI is to learn to â€œseeâ€ and â€œtalkâ€, which is consistent with Visual Question Answering (VQA) task â€” aiming to answer natural language questions about an image.
Most existing works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> focused on â€œshallowâ€ questions which are answerable by solely referring to the visible content of the image.
For example, question Q1 in Fig.<a href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> only requires recognizing the color of the helmet to answer, without multi-step reasoning incorporating external knowledge.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, the â€œdeeperâ€ questions (Q2 in Fig.<a href="#S1.F1" title="Figure 1 â€£ 1 Introduction â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) are still obstacles for these methods.
To answer this question, a desirable agent should be able to understand the semantic of the question, perceive the visual content (e.g. <span id="S1.p2.1.1" class="ltx_text ltx_font_typewriter">helmet,boy</span>), incorporate commonsense knowledge (e.g. <span id="S1.p2.1.2" class="ltx_text ltx_font_typewriter">&lt;helmet,Used For,protect head&gt;</span>) and finally compositionally reasons over these clues to predict the correct answer.
Besides, it should present the decision-making process to better understand the modelâ€™s underlying working mechanism.
Therefore, how to extend shallow visual understanding to deeper compositional reasoning and meanwhile provide an explainable diagnosis are essential to achieve a long-standing general VQA goal.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Most of existing VQA models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> that exhibit reasoning capabilities can be divided into three categories.
Firstly, attention-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> stack attention layer that focuses on image regions relevant to the question.
The reasoning process can be post-hoc extracted by observing attention weights.
However, it is implicit reasoning process because the intermediate heat map cannot clarify what the current decision step is.
Secondly, memory-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> perform read and write operations to external memory module iteratively.
It implements reasoning by modeling interaction between multiple parts of data over several passes with attention mechanism, which still faces shortcomings of implicit reasoning.
Thirdly, module-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> implement reasoning procedure by parsing the question into a layout of sub-tasks that are carried out by separate neural sub-networks.
The reasoning steps can be explicitly defined by each module, but relying on strong layout supervision.
Moreover, most existing methods rarely utilize commonsense knowledge that is essential for deeper reasoning.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2206.12533/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="71" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text ltx_font_bold">Fig.Â 1</span>: </span>Examples of shallow and deep visual questions.</figcaption>
</figure>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2206.12533/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="514" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.4.1.1" class="ltx_text ltx_font_bold">Fig.Â 2</span>: </span>An overview of our model at time-step <math id="S1.F2.2.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S1.F2.2.m1.1b"><mi id="S1.F2.2.m1.1.1" xref="S1.F2.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S1.F2.2.m1.1c"><ci id="S1.F2.2.m1.1.1.cmml" xref="S1.F2.2.m1.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.2.m1.1d">t</annotation></semantics></math>. It consists of graph representations, graph modules and module controller</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we propose a Hierarchical Graph Neural Module Network (HGNMN) to address the above problems by compositional reasoning over multi-layer graphs.
Compared with holistic features, graph can model the relationships between objects and makes it easier for a model to reasons from one node to another along the edges <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
Therefore, we first encode an image by multi-layer graphs from the visual, semantic and commonsense views, which contain the clues supporting the answer from different modalities.
Second, we decompose the inference process into several sub-tasks based on a set of well-designed neural modules, which perform specific functions over graphs under the guidance of the semantic information of the question.
Third, we propose a module controller that supplies soft module weights and input query at each reasoning step, which makes our model fully differentiable and trainable using gradient descent without resorting to expert layouts.
Experimental results on the CRIC dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> demonstrate that HGNMN has comparable performance to existing modular networks and monolithic networks.
Meanwhile, the reasoning process can be explicitly traced via module weights and graph attention mechanism.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Proposed Approach</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we elaborate on the proposed Hierarchical Graph Neural Module Network (HGNMN) for answering deeper visual questions.
Fig. <a href="#S1.F2" title="Figure 2 â€£ 1 Introduction â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the overall architecture. It consists of three components:
(1) Graph Representations.
Since the clues supporting answer the question may exist in different modalities, we encode the image by constructing multi-layer graphs from the visual, semantic and commonsense views respectively;
(2) Graph Modules, a set of well-designed neural modules, that can conduct reasoning over hierarchical graphs;
(3) Module Controller guides the execution of each module at each reasoning step.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Graph Representations</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Taking the inspiration from recent graph-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> in visual and language tasks, we first encode the image as multi-layer graphs for unifying the structure representation of different modalities, including visual graph, semantic graph and commonsense graph.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_bold">Visual Graph</span> represents visual objects and their relationships of the image since most of the questions in VQA are visually related.
We construct a fully-connected visual graph over a set of objects identified by Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.
Each node corresponds to a detected object and encoded by visual feature.
Each edge denotes the relationships between objects, encoded by relative spatial feature.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p"><span id="S2.SS1.p3.1.1" class="ltx_text ltx_font_bold">Semantic Graph</span> keeps high-level abstraction of the objects and relationships within natural language also provides essential semantic information.
We first generate captions of the image with DenseCap <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
Then we construct a semantic graph using SPICE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, where node represents the name or attribute of an object and edge represents the relationship between them.
We use the averaged GloVe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> embeddings to represent nodes and edges.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.p4.13" class="ltx_p"><span id="S2.SS1.p4.13.1" class="ltx_text ltx_font_bold">Commonsense Graph</span> contains knowledge related to the image and question that is used for answering open-domain visual questions.
We use ConceptNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> as original knowledge base, which can be seen as a large set of triples of the form <math id="S2.SS1.p4.1.m1.3" class="ltx_Math" alttext="(h,r,t)" display="inline"><semantics id="S2.SS1.p4.1.m1.3a"><mrow id="S2.SS1.p4.1.m1.3.4.2" xref="S2.SS1.p4.1.m1.3.4.1.cmml"><mo stretchy="false" id="S2.SS1.p4.1.m1.3.4.2.1" xref="S2.SS1.p4.1.m1.3.4.1.cmml">(</mo><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">h</mi><mo id="S2.SS1.p4.1.m1.3.4.2.2" xref="S2.SS1.p4.1.m1.3.4.1.cmml">,</mo><mi id="S2.SS1.p4.1.m1.2.2" xref="S2.SS1.p4.1.m1.2.2.cmml">r</mi><mo id="S2.SS1.p4.1.m1.3.4.2.3" xref="S2.SS1.p4.1.m1.3.4.1.cmml">,</mo><mi id="S2.SS1.p4.1.m1.3.3" xref="S2.SS1.p4.1.m1.3.3.cmml">t</mi><mo stretchy="false" id="S2.SS1.p4.1.m1.3.4.2.4" xref="S2.SS1.p4.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.3b"><vector id="S2.SS1.p4.1.m1.3.4.1.cmml" xref="S2.SS1.p4.1.m1.3.4.2"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">â„</ci><ci id="S2.SS1.p4.1.m1.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2">ğ‘Ÿ</ci><ci id="S2.SS1.p4.1.m1.3.3.cmml" xref="S2.SS1.p4.1.m1.3.3">ğ‘¡</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.3c">(h,r,t)</annotation></semantics></math>, where <math id="S2.SS1.p4.2.m2.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">â„</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">h</annotation></semantics></math> and <math id="S2.SS1.p4.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p4.3.m3.1a"><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.1b"><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.1c">t</annotation></semantics></math> represent head and tail entities, <math id="S2.SS1.p4.4.m4.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS1.p4.4.m4.1a"><mi id="S2.SS1.p4.4.m4.1.1" xref="S2.SS1.p4.4.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m4.1b"><ci id="S2.SS1.p4.4.m4.1.1.cmml" xref="S2.SS1.p4.4.m4.1.1">ğ‘Ÿ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m4.1c">r</annotation></semantics></math> represents relationship between them.
We select 10 types of relations to reduce the computation cost following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
A desirable knowledge retrieval should include most of the useful information while ignore the irrelevant ones.
To achieve this goal, we first use labels of visual objects as keys to extract corresponding entities of ConceptNet.
Then we retrieve the first-order subgraph using these selected nodes from ConceptNet, which includes all edges connecting with at least one candidate node, i.e. the label is either <math id="S2.SS1.p4.5.m5.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS1.p4.5.m5.1a"><mi id="S2.SS1.p4.5.m5.1.1" xref="S2.SS1.p4.5.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m5.1b"><ci id="S2.SS1.p4.5.m5.1.1.cmml" xref="S2.SS1.p4.5.m5.1.1">â„</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m5.1c">h</annotation></semantics></math> or <math id="S2.SS1.p4.6.m6.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p4.6.m6.1a"><mi id="S2.SS1.p4.6.m6.1.1" xref="S2.SS1.p4.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.6.m6.1b"><ci id="S2.SS1.p4.6.m6.1.1.cmml" xref="S2.SS1.p4.6.m6.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.6.m6.1c">t</annotation></semantics></math>.
However, the subgraph contains much irrelevant information.
Each object and extracted triplet is associated with probability scores, denoted as <math id="S2.SS1.p4.7.m7.1" class="ltx_Math" alttext="S_{l}" display="inline"><semantics id="S2.SS1.p4.7.m7.1a"><msub id="S2.SS1.p4.7.m7.1.1" xref="S2.SS1.p4.7.m7.1.1.cmml"><mi id="S2.SS1.p4.7.m7.1.1.2" xref="S2.SS1.p4.7.m7.1.1.2.cmml">S</mi><mi id="S2.SS1.p4.7.m7.1.1.3" xref="S2.SS1.p4.7.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.7.m7.1b"><apply id="S2.SS1.p4.7.m7.1.1.cmml" xref="S2.SS1.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.7.m7.1.1.1.cmml" xref="S2.SS1.p4.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p4.7.m7.1.1.2.cmml" xref="S2.SS1.p4.7.m7.1.1.2">ğ‘†</ci><ci id="S2.SS1.p4.7.m7.1.1.3.cmml" xref="S2.SS1.p4.7.m7.1.1.3">ğ‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.7.m7.1c">S_{l}</annotation></semantics></math> and <math id="S2.SS1.p4.8.m8.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S2.SS1.p4.8.m8.1a"><msub id="S2.SS1.p4.8.m8.1.1" xref="S2.SS1.p4.8.m8.1.1.cmml"><mi id="S2.SS1.p4.8.m8.1.1.2" xref="S2.SS1.p4.8.m8.1.1.2.cmml">S</mi><mi id="S2.SS1.p4.8.m8.1.1.3" xref="S2.SS1.p4.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.8.m8.1b"><apply id="S2.SS1.p4.8.m8.1.1.cmml" xref="S2.SS1.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m8.1.1.1.cmml" xref="S2.SS1.p4.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p4.8.m8.1.1.2.cmml" xref="S2.SS1.p4.8.m8.1.1.2">ğ‘†</ci><ci id="S2.SS1.p4.8.m8.1.1.3.cmml" xref="S2.SS1.p4.8.m8.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.8.m8.1c">S_{t}</annotation></semantics></math>.
We assign <math id="S2.SS1.p4.9.m9.1" class="ltx_Math" alttext="a\cdot S_{l}+b\cdot S_{t}" display="inline"><semantics id="S2.SS1.p4.9.m9.1a"><mrow id="S2.SS1.p4.9.m9.1.1" xref="S2.SS1.p4.9.m9.1.1.cmml"><mrow id="S2.SS1.p4.9.m9.1.1.2" xref="S2.SS1.p4.9.m9.1.1.2.cmml"><mi id="S2.SS1.p4.9.m9.1.1.2.2" xref="S2.SS1.p4.9.m9.1.1.2.2.cmml">a</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p4.9.m9.1.1.2.1" xref="S2.SS1.p4.9.m9.1.1.2.1.cmml">â‹…</mo><msub id="S2.SS1.p4.9.m9.1.1.2.3" xref="S2.SS1.p4.9.m9.1.1.2.3.cmml"><mi id="S2.SS1.p4.9.m9.1.1.2.3.2" xref="S2.SS1.p4.9.m9.1.1.2.3.2.cmml">S</mi><mi id="S2.SS1.p4.9.m9.1.1.2.3.3" xref="S2.SS1.p4.9.m9.1.1.2.3.3.cmml">l</mi></msub></mrow><mo id="S2.SS1.p4.9.m9.1.1.1" xref="S2.SS1.p4.9.m9.1.1.1.cmml">+</mo><mrow id="S2.SS1.p4.9.m9.1.1.3" xref="S2.SS1.p4.9.m9.1.1.3.cmml"><mi id="S2.SS1.p4.9.m9.1.1.3.2" xref="S2.SS1.p4.9.m9.1.1.3.2.cmml">b</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS1.p4.9.m9.1.1.3.1" xref="S2.SS1.p4.9.m9.1.1.3.1.cmml">â‹…</mo><msub id="S2.SS1.p4.9.m9.1.1.3.3" xref="S2.SS1.p4.9.m9.1.1.3.3.cmml"><mi id="S2.SS1.p4.9.m9.1.1.3.3.2" xref="S2.SS1.p4.9.m9.1.1.3.3.2.cmml">S</mi><mi id="S2.SS1.p4.9.m9.1.1.3.3.3" xref="S2.SS1.p4.9.m9.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.9.m9.1b"><apply id="S2.SS1.p4.9.m9.1.1.cmml" xref="S2.SS1.p4.9.m9.1.1"><plus id="S2.SS1.p4.9.m9.1.1.1.cmml" xref="S2.SS1.p4.9.m9.1.1.1"></plus><apply id="S2.SS1.p4.9.m9.1.1.2.cmml" xref="S2.SS1.p4.9.m9.1.1.2"><ci id="S2.SS1.p4.9.m9.1.1.2.1.cmml" xref="S2.SS1.p4.9.m9.1.1.2.1">â‹…</ci><ci id="S2.SS1.p4.9.m9.1.1.2.2.cmml" xref="S2.SS1.p4.9.m9.1.1.2.2">ğ‘</ci><apply id="S2.SS1.p4.9.m9.1.1.2.3.cmml" xref="S2.SS1.p4.9.m9.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS1.p4.9.m9.1.1.2.3.1.cmml" xref="S2.SS1.p4.9.m9.1.1.2.3">subscript</csymbol><ci id="S2.SS1.p4.9.m9.1.1.2.3.2.cmml" xref="S2.SS1.p4.9.m9.1.1.2.3.2">ğ‘†</ci><ci id="S2.SS1.p4.9.m9.1.1.2.3.3.cmml" xref="S2.SS1.p4.9.m9.1.1.2.3.3">ğ‘™</ci></apply></apply><apply id="S2.SS1.p4.9.m9.1.1.3.cmml" xref="S2.SS1.p4.9.m9.1.1.3"><ci id="S2.SS1.p4.9.m9.1.1.3.1.cmml" xref="S2.SS1.p4.9.m9.1.1.3.1">â‹…</ci><ci id="S2.SS1.p4.9.m9.1.1.3.2.cmml" xref="S2.SS1.p4.9.m9.1.1.3.2">ğ‘</ci><apply id="S2.SS1.p4.9.m9.1.1.3.3.cmml" xref="S2.SS1.p4.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.9.m9.1.1.3.3.1.cmml" xref="S2.SS1.p4.9.m9.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p4.9.m9.1.1.3.3.2.cmml" xref="S2.SS1.p4.9.m9.1.1.3.3.2">ğ‘†</ci><ci id="S2.SS1.p4.9.m9.1.1.3.3.3.cmml" xref="S2.SS1.p4.9.m9.1.1.3.3.3">ğ‘¡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.9.m9.1c">a\cdot S_{l}+b\cdot S_{t}</annotation></semantics></math> as the final score of the edge, where <math id="S2.SS1.p4.10.m10.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S2.SS1.p4.10.m10.1a"><mi id="S2.SS1.p4.10.m10.1.1" xref="S2.SS1.p4.10.m10.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.10.m10.1b"><ci id="S2.SS1.p4.10.m10.1.1.cmml" xref="S2.SS1.p4.10.m10.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.10.m10.1c">a</annotation></semantics></math> and <math id="S2.SS1.p4.11.m11.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S2.SS1.p4.11.m11.1a"><mi id="S2.SS1.p4.11.m11.1.1" xref="S2.SS1.p4.11.m11.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.11.m11.1b"><ci id="S2.SS1.p4.11.m11.1.1.cmml" xref="S2.SS1.p4.11.m11.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.11.m11.1c">b</annotation></semantics></math> are hyper-parameters that used to adjust the importance of the <math id="S2.SS1.p4.12.m12.1" class="ltx_Math" alttext="S_{l}" display="inline"><semantics id="S2.SS1.p4.12.m12.1a"><msub id="S2.SS1.p4.12.m12.1.1" xref="S2.SS1.p4.12.m12.1.1.cmml"><mi id="S2.SS1.p4.12.m12.1.1.2" xref="S2.SS1.p4.12.m12.1.1.2.cmml">S</mi><mi id="S2.SS1.p4.12.m12.1.1.3" xref="S2.SS1.p4.12.m12.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.12.m12.1b"><apply id="S2.SS1.p4.12.m12.1.1.cmml" xref="S2.SS1.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.12.m12.1.1.1.cmml" xref="S2.SS1.p4.12.m12.1.1">subscript</csymbol><ci id="S2.SS1.p4.12.m12.1.1.2.cmml" xref="S2.SS1.p4.12.m12.1.1.2">ğ‘†</ci><ci id="S2.SS1.p4.12.m12.1.1.3.cmml" xref="S2.SS1.p4.12.m12.1.1.3">ğ‘™</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.12.m12.1c">S_{l}</annotation></semantics></math> and <math id="S2.SS1.p4.13.m13.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S2.SS1.p4.13.m13.1a"><msub id="S2.SS1.p4.13.m13.1.1" xref="S2.SS1.p4.13.m13.1.1.cmml"><mi id="S2.SS1.p4.13.m13.1.1.2" xref="S2.SS1.p4.13.m13.1.1.2.cmml">S</mi><mi id="S2.SS1.p4.13.m13.1.1.3" xref="S2.SS1.p4.13.m13.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.13.m13.1b"><apply id="S2.SS1.p4.13.m13.1.1.cmml" xref="S2.SS1.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.13.m13.1.1.1.cmml" xref="S2.SS1.p4.13.m13.1.1">subscript</csymbol><ci id="S2.SS1.p4.13.m13.1.1.2.cmml" xref="S2.SS1.p4.13.m13.1.1.2">ğ‘†</ci><ci id="S2.SS1.p4.13.m13.1.1.3.cmml" xref="S2.SS1.p4.13.m13.1.1.3">ğ‘¡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.13.m13.1c">S_{t}</annotation></semantics></math>.
Then we obtain the commonsense graph by ranking and selecting top-K edges along with the nodes according to scores.
All nodes and edges are encoded by averaged GloVe embeddings<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Graph Modules</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.2" class="ltx_p">We first define the <span id="S2.SS2.p1.2.1" class="ltx_text ltx_font_typewriter">Find</span>, <span id="S2.SS2.p1.2.2" class="ltx_text ltx_font_typewriter">And</span>, <span id="S2.SS2.p1.2.3" class="ltx_text ltx_font_typewriter">Filter</span> modules to attend objects that are relevant to some subjects, attributes or logic information of the question following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
However, deeper questions commonly cover relationships (e.g. geometric positions or semantic interactions between objects) beyond mere object detection, so we propose the <span id="S2.SS2.p1.2.4" class="ltx_text ltx_font_typewriter">Relate</span> module to transfer node attention maps along the edge in one graph guided by relation information of the question.
Moreover, deeper questions require collecting evidence from different modalities, so it is necessary to associate multi-layer graphs.
We additionally propose the <span id="S2.SS2.p1.2.5" class="ltx_text ltx_font_typewriter">CrossGraph</span> module to extend the reasoning in one graph to more graphs.
The <span id="S2.SS2.p1.2.6" class="ltx_text ltx_font_typewriter">Describe</span> module is proposed to obtain the graph features because the attentive node maps need to be transformed to an embedding to predict the answer.
Due to some questions may not require complete <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">T</annotation></semantics></math>-step reasoning, we also introduce a <span id="S2.SS2.p1.2.7" class="ltx_text ltx_font_typewriter">NoOp</span> module proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, which can be used to pad reasoning steps to maximum length <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">T</annotation></semantics></math>.
We will describe each kind of module in detail below.
Modules of the same type only differ in inputs and parameters.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.5" class="ltx_p"><span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_bold">Find [<math id="S2.SS2.p2.1.1.m1.2" class="ltx_Math" alttext="\mathbf{X},\mathbf{c}" display="inline"><semantics id="S2.SS2.p2.1.1.m1.2a"><mrow id="S2.SS2.p2.1.1.m1.2.3.2" xref="S2.SS2.p2.1.1.m1.2.3.1.cmml"><mi id="S2.SS2.p2.1.1.m1.1.1" xref="S2.SS2.p2.1.1.m1.1.1.cmml">ğ—</mi><mo id="S2.SS2.p2.1.1.m1.2.3.2.1" xref="S2.SS2.p2.1.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS2.p2.1.1.m1.2.2" xref="S2.SS2.p2.1.1.m1.2.2.cmml">ğœ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.1.m1.2b"><list id="S2.SS2.p2.1.1.m1.2.3.1.cmml" xref="S2.SS2.p2.1.1.m1.2.3.2"><ci id="S2.SS2.p2.1.1.m1.1.1.cmml" xref="S2.SS2.p2.1.1.m1.1.1">ğ—</ci><ci id="S2.SS2.p2.1.1.m1.2.2.cmml" xref="S2.SS2.p2.1.1.m1.2.2">ğœ</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.1.m1.2c">\mathbf{X},\mathbf{c}</annotation></semantics></math>]</span>
is proposed to attend the relevant objects given the input query and outputs an attention map <math id="S2.SS2.p2.2.m1.1" class="ltx_Math" alttext="\mathbf{a}\in\mathbb{R}^{n}" display="inline"><semantics id="S2.SS2.p2.2.m1.1a"><mrow id="S2.SS2.p2.2.m1.1.1" xref="S2.SS2.p2.2.m1.1.1.cmml"><mi id="S2.SS2.p2.2.m1.1.1.2" xref="S2.SS2.p2.2.m1.1.1.2.cmml">ğš</mi><mo id="S2.SS2.p2.2.m1.1.1.1" xref="S2.SS2.p2.2.m1.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS2.p2.2.m1.1.1.3" xref="S2.SS2.p2.2.m1.1.1.3.cmml"><mi id="S2.SS2.p2.2.m1.1.1.3.2" xref="S2.SS2.p2.2.m1.1.1.3.2.cmml">â„</mi><mi id="S2.SS2.p2.2.m1.1.1.3.3" xref="S2.SS2.p2.2.m1.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m1.1b"><apply id="S2.SS2.p2.2.m1.1.1.cmml" xref="S2.SS2.p2.2.m1.1.1"><in id="S2.SS2.p2.2.m1.1.1.1.cmml" xref="S2.SS2.p2.2.m1.1.1.1"></in><ci id="S2.SS2.p2.2.m1.1.1.2.cmml" xref="S2.SS2.p2.2.m1.1.1.2">ğš</ci><apply id="S2.SS2.p2.2.m1.1.1.3.cmml" xref="S2.SS2.p2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m1.1.1.3.1.cmml" xref="S2.SS2.p2.2.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.2.m1.1.1.3.2.cmml" xref="S2.SS2.p2.2.m1.1.1.3.2">â„</ci><ci id="S2.SS2.p2.2.m1.1.1.3.3.cmml" xref="S2.SS2.p2.2.m1.1.1.3.3">ğ‘›</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m1.1c">\mathbf{a}\in\mathbb{R}^{n}</annotation></semantics></math> over <math id="S2.SS2.p2.3.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.SS2.p2.3.m2.1a"><mi id="S2.SS2.p2.3.m2.1.1" xref="S2.SS2.p2.3.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m2.1b"><ci id="S2.SS2.p2.3.m2.1.1.cmml" xref="S2.SS2.p2.3.m2.1.1">ğ‘›</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m2.1c">n</annotation></semantics></math> graph nodes.
We first transform the input query <math id="S2.SS2.p2.4.m3.1" class="ltx_Math" alttext="\mathbf{c}" display="inline"><semantics id="S2.SS2.p2.4.m3.1a"><mi id="S2.SS2.p2.4.m3.1.1" xref="S2.SS2.p2.4.m3.1.1.cmml">ğœ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m3.1b"><ci id="S2.SS2.p2.4.m3.1.1.cmml" xref="S2.SS2.p2.4.m3.1.1">ğœ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m3.1c">\mathbf{c}</annotation></semantics></math> and node features <math id="S2.SS2.p2.5.m4.1" class="ltx_Math" alttext="\mathbf{X}" display="inline"><semantics id="S2.SS2.p2.5.m4.1a"><mi id="S2.SS2.p2.5.m4.1.1" xref="S2.SS2.p2.5.m4.1.1.cmml">ğ—</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m4.1b"><ci id="S2.SS2.p2.5.m4.1.1.cmml" xref="S2.SS2.p2.5.m4.1.1">ğ—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m4.1c">\mathbf{X}</annotation></semantics></math> into the same dimensions and then fuse them together to pass a MLP:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\mathbf{a}=\text{softmax}(f_{mlp}(F(W_{1}\mathbf{X},W_{2}\mathbf{c})))," display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml">ğš</mi><mo id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mtext id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">â€‹</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">â€‹</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ğ—</mi></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">W</mi><mn id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml">â€‹</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">ğœ</mi></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.5" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><eq id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></eq><ci id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3">ğš</ci><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.1.1.1.1.1.3a.cmml" xref="S2.E1.m1.1.1.1.1.1.3"><mtext id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">softmax</mtext></ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2">ğ‘“</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2">ğ‘š</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3">ğ‘™</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.4">ğ‘</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3"></times><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.4">ğ¹</ci><interval closure="open" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">ğ‘Š</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">ğ—</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1"></times><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">ğ‘Š</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3">2</cn></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">ğœ</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathbf{a}=\text{softmax}(f_{mlp}(F(W_{1}\mathbf{X},W_{2}\mathbf{c}))),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.8" class="ltx_p">where <math id="S2.SS2.p2.6.m1.2" class="ltx_Math" alttext="W_{1},W_{2}" display="inline"><semantics id="S2.SS2.p2.6.m1.2a"><mrow id="S2.SS2.p2.6.m1.2.2.2" xref="S2.SS2.p2.6.m1.2.2.3.cmml"><msub id="S2.SS2.p2.6.m1.1.1.1.1" xref="S2.SS2.p2.6.m1.1.1.1.1.cmml"><mi id="S2.SS2.p2.6.m1.1.1.1.1.2" xref="S2.SS2.p2.6.m1.1.1.1.1.2.cmml">W</mi><mn id="S2.SS2.p2.6.m1.1.1.1.1.3" xref="S2.SS2.p2.6.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p2.6.m1.2.2.2.3" xref="S2.SS2.p2.6.m1.2.2.3.cmml">,</mo><msub id="S2.SS2.p2.6.m1.2.2.2.2" xref="S2.SS2.p2.6.m1.2.2.2.2.cmml"><mi id="S2.SS2.p2.6.m1.2.2.2.2.2" xref="S2.SS2.p2.6.m1.2.2.2.2.2.cmml">W</mi><mn id="S2.SS2.p2.6.m1.2.2.2.2.3" xref="S2.SS2.p2.6.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m1.2b"><list id="S2.SS2.p2.6.m1.2.2.3.cmml" xref="S2.SS2.p2.6.m1.2.2.2"><apply id="S2.SS2.p2.6.m1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.6.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m1.1.1.1.1.2.cmml" xref="S2.SS2.p2.6.m1.1.1.1.1.2">ğ‘Š</ci><cn type="integer" id="S2.SS2.p2.6.m1.1.1.1.1.3.cmml" xref="S2.SS2.p2.6.m1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p2.6.m1.2.2.2.2.cmml" xref="S2.SS2.p2.6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m1.2.2.2.2.1.cmml" xref="S2.SS2.p2.6.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.6.m1.2.2.2.2.2.cmml" xref="S2.SS2.p2.6.m1.2.2.2.2.2">ğ‘Š</ci><cn type="integer" id="S2.SS2.p2.6.m1.2.2.2.2.3.cmml" xref="S2.SS2.p2.6.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m1.2c">W_{1},W_{2}</annotation></semantics></math> are weight matrices (as well as <math id="S2.SS2.p2.7.m2.3" class="ltx_Math" alttext="W_{3},\dots,W_{10}" display="inline"><semantics id="S2.SS2.p2.7.m2.3a"><mrow id="S2.SS2.p2.7.m2.3.3.2" xref="S2.SS2.p2.7.m2.3.3.3.cmml"><msub id="S2.SS2.p2.7.m2.2.2.1.1" xref="S2.SS2.p2.7.m2.2.2.1.1.cmml"><mi id="S2.SS2.p2.7.m2.2.2.1.1.2" xref="S2.SS2.p2.7.m2.2.2.1.1.2.cmml">W</mi><mn id="S2.SS2.p2.7.m2.2.2.1.1.3" xref="S2.SS2.p2.7.m2.2.2.1.1.3.cmml">3</mn></msub><mo id="S2.SS2.p2.7.m2.3.3.2.3" xref="S2.SS2.p2.7.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p2.7.m2.1.1" xref="S2.SS2.p2.7.m2.1.1.cmml">â€¦</mi><mo id="S2.SS2.p2.7.m2.3.3.2.4" xref="S2.SS2.p2.7.m2.3.3.3.cmml">,</mo><msub id="S2.SS2.p2.7.m2.3.3.2.2" xref="S2.SS2.p2.7.m2.3.3.2.2.cmml"><mi id="S2.SS2.p2.7.m2.3.3.2.2.2" xref="S2.SS2.p2.7.m2.3.3.2.2.2.cmml">W</mi><mn id="S2.SS2.p2.7.m2.3.3.2.2.3" xref="S2.SS2.p2.7.m2.3.3.2.2.3.cmml">10</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m2.3b"><list id="S2.SS2.p2.7.m2.3.3.3.cmml" xref="S2.SS2.p2.7.m2.3.3.2"><apply id="S2.SS2.p2.7.m2.2.2.1.1.cmml" xref="S2.SS2.p2.7.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.2.2.1.1.1.cmml" xref="S2.SS2.p2.7.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p2.7.m2.2.2.1.1.2.cmml" xref="S2.SS2.p2.7.m2.2.2.1.1.2">ğ‘Š</ci><cn type="integer" id="S2.SS2.p2.7.m2.2.2.1.1.3.cmml" xref="S2.SS2.p2.7.m2.2.2.1.1.3">3</cn></apply><ci id="S2.SS2.p2.7.m2.1.1.cmml" xref="S2.SS2.p2.7.m2.1.1">â€¦</ci><apply id="S2.SS2.p2.7.m2.3.3.2.2.cmml" xref="S2.SS2.p2.7.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.7.m2.3.3.2.2.1.cmml" xref="S2.SS2.p2.7.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p2.7.m2.3.3.2.2.2.cmml" xref="S2.SS2.p2.7.m2.3.3.2.2.2">ğ‘Š</ci><cn type="integer" id="S2.SS2.p2.7.m2.3.3.2.2.3.cmml" xref="S2.SS2.p2.7.m2.3.3.2.2.3">10</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m2.3c">W_{3},\dots,W_{10}</annotation></semantics></math> mentioned below), <math id="S2.SS2.p2.8.m3.4" class="ltx_Math" alttext="F(\mathbf{x},\mathbf{y})=\text{ReLU}(\mathbf{x}+\mathbf{y})-(\mathbf{x}-\mathbf{y})^{2}" display="inline"><semantics id="S2.SS2.p2.8.m3.4a"><mrow id="S2.SS2.p2.8.m3.4.4" xref="S2.SS2.p2.8.m3.4.4.cmml"><mrow id="S2.SS2.p2.8.m3.4.4.4" xref="S2.SS2.p2.8.m3.4.4.4.cmml"><mi id="S2.SS2.p2.8.m3.4.4.4.2" xref="S2.SS2.p2.8.m3.4.4.4.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.8.m3.4.4.4.1" xref="S2.SS2.p2.8.m3.4.4.4.1.cmml">â€‹</mo><mrow id="S2.SS2.p2.8.m3.4.4.4.3.2" xref="S2.SS2.p2.8.m3.4.4.4.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.8.m3.4.4.4.3.2.1" xref="S2.SS2.p2.8.m3.4.4.4.3.1.cmml">(</mo><mi id="S2.SS2.p2.8.m3.1.1" xref="S2.SS2.p2.8.m3.1.1.cmml">ğ±</mi><mo id="S2.SS2.p2.8.m3.4.4.4.3.2.2" xref="S2.SS2.p2.8.m3.4.4.4.3.1.cmml">,</mo><mi id="S2.SS2.p2.8.m3.2.2" xref="S2.SS2.p2.8.m3.2.2.cmml">ğ²</mi><mo stretchy="false" id="S2.SS2.p2.8.m3.4.4.4.3.2.3" xref="S2.SS2.p2.8.m3.4.4.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.8.m3.4.4.3" xref="S2.SS2.p2.8.m3.4.4.3.cmml">=</mo><mrow id="S2.SS2.p2.8.m3.4.4.2" xref="S2.SS2.p2.8.m3.4.4.2.cmml"><mrow id="S2.SS2.p2.8.m3.3.3.1.1" xref="S2.SS2.p2.8.m3.3.3.1.1.cmml"><mtext id="S2.SS2.p2.8.m3.3.3.1.1.3" xref="S2.SS2.p2.8.m3.3.3.1.1.3a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p2.8.m3.3.3.1.1.2" xref="S2.SS2.p2.8.m3.3.3.1.1.2.cmml">â€‹</mo><mrow id="S2.SS2.p2.8.m3.3.3.1.1.1.1" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.8.m3.3.3.1.1.1.1.2" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.2" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.2.cmml">ğ±</mi><mo id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.1" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.1.cmml">+</mo><mi id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.3" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.3.cmml">ğ²</mi></mrow><mo stretchy="false" id="S2.SS2.p2.8.m3.3.3.1.1.1.1.3" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.p2.8.m3.4.4.2.3" xref="S2.SS2.p2.8.m3.4.4.2.3.cmml">âˆ’</mo><msup id="S2.SS2.p2.8.m3.4.4.2.2" xref="S2.SS2.p2.8.m3.4.4.2.2.cmml"><mrow id="S2.SS2.p2.8.m3.4.4.2.2.1.1" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p2.8.m3.4.4.2.2.1.1.2" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.cmml"><mi id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.2" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.2.cmml">ğ±</mi><mo id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.1" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.1.cmml">âˆ’</mo><mi id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.3" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.3.cmml">ğ²</mi></mrow><mo stretchy="false" id="S2.SS2.p2.8.m3.4.4.2.2.1.1.3" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.cmml">)</mo></mrow><mn id="S2.SS2.p2.8.m3.4.4.2.2.3" xref="S2.SS2.p2.8.m3.4.4.2.2.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m3.4b"><apply id="S2.SS2.p2.8.m3.4.4.cmml" xref="S2.SS2.p2.8.m3.4.4"><eq id="S2.SS2.p2.8.m3.4.4.3.cmml" xref="S2.SS2.p2.8.m3.4.4.3"></eq><apply id="S2.SS2.p2.8.m3.4.4.4.cmml" xref="S2.SS2.p2.8.m3.4.4.4"><times id="S2.SS2.p2.8.m3.4.4.4.1.cmml" xref="S2.SS2.p2.8.m3.4.4.4.1"></times><ci id="S2.SS2.p2.8.m3.4.4.4.2.cmml" xref="S2.SS2.p2.8.m3.4.4.4.2">ğ¹</ci><interval closure="open" id="S2.SS2.p2.8.m3.4.4.4.3.1.cmml" xref="S2.SS2.p2.8.m3.4.4.4.3.2"><ci id="S2.SS2.p2.8.m3.1.1.cmml" xref="S2.SS2.p2.8.m3.1.1">ğ±</ci><ci id="S2.SS2.p2.8.m3.2.2.cmml" xref="S2.SS2.p2.8.m3.2.2">ğ²</ci></interval></apply><apply id="S2.SS2.p2.8.m3.4.4.2.cmml" xref="S2.SS2.p2.8.m3.4.4.2"><minus id="S2.SS2.p2.8.m3.4.4.2.3.cmml" xref="S2.SS2.p2.8.m3.4.4.2.3"></minus><apply id="S2.SS2.p2.8.m3.3.3.1.1.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1"><times id="S2.SS2.p2.8.m3.3.3.1.1.2.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.2"></times><ci id="S2.SS2.p2.8.m3.3.3.1.1.3a.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.3"><mtext id="S2.SS2.p2.8.m3.3.3.1.1.3.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.3">ReLU</mtext></ci><apply id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1"><plus id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.1"></plus><ci id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.2">ğ±</ci><ci id="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.8.m3.3.3.1.1.1.1.1.3">ğ²</ci></apply></apply><apply id="S2.SS2.p2.8.m3.4.4.2.2.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m3.4.4.2.2.2.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2">superscript</csymbol><apply id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1"><minus id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.1"></minus><ci id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.2">ğ±</ci><ci id="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2.1.1.1.3">ğ²</ci></apply><cn type="integer" id="S2.SS2.p2.8.m3.4.4.2.2.3.cmml" xref="S2.SS2.p2.8.m3.4.4.2.2.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m3.4c">F(\mathbf{x},\mathbf{y})=\text{ReLU}(\mathbf{x}+\mathbf{y})-(\mathbf{x}-\mathbf{y})^{2}</annotation></semantics></math> is multimodal fusion function proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.4" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_bold">And [<math id="S2.SS2.p3.1.1.m1.2" class="ltx_Math" alttext="\mathbf{a}_{1},\mathbf{a}_{2}" display="inline"><semantics id="S2.SS2.p3.1.1.m1.2a"><mrow id="S2.SS2.p3.1.1.m1.2.2.2" xref="S2.SS2.p3.1.1.m1.2.2.3.cmml"><msub id="S2.SS2.p3.1.1.m1.1.1.1.1" xref="S2.SS2.p3.1.1.m1.1.1.1.1.cmml"><mi id="S2.SS2.p3.1.1.m1.1.1.1.1.2" xref="S2.SS2.p3.1.1.m1.1.1.1.1.2.cmml">ğš</mi><mn id="S2.SS2.p3.1.1.m1.1.1.1.1.3" xref="S2.SS2.p3.1.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p3.1.1.m1.2.2.2.3" xref="S2.SS2.p3.1.1.m1.2.2.3.cmml">,</mo><msub id="S2.SS2.p3.1.1.m1.2.2.2.2" xref="S2.SS2.p3.1.1.m1.2.2.2.2.cmml"><mi id="S2.SS2.p3.1.1.m1.2.2.2.2.2" xref="S2.SS2.p3.1.1.m1.2.2.2.2.2.cmml">ğš</mi><mn id="S2.SS2.p3.1.1.m1.2.2.2.2.3" xref="S2.SS2.p3.1.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.1.m1.2b"><list id="S2.SS2.p3.1.1.m1.2.2.3.cmml" xref="S2.SS2.p3.1.1.m1.2.2.2"><apply id="S2.SS2.p3.1.1.m1.1.1.1.1.cmml" xref="S2.SS2.p3.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.1.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.1.1.m1.1.1.1.1.2.cmml" xref="S2.SS2.p3.1.1.m1.1.1.1.1.2">ğš</ci><cn type="integer" id="S2.SS2.p3.1.1.m1.1.1.1.1.3.cmml" xref="S2.SS2.p3.1.1.m1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p3.1.1.m1.2.2.2.2.cmml" xref="S2.SS2.p3.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.1.m1.2.2.2.2.1.cmml" xref="S2.SS2.p3.1.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.1.1.m1.2.2.2.2.2.cmml" xref="S2.SS2.p3.1.1.m1.2.2.2.2.2">ğš</ci><cn type="integer" id="S2.SS2.p3.1.1.m1.2.2.2.2.3.cmml" xref="S2.SS2.p3.1.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.1.m1.2c">\mathbf{a}_{1},\mathbf{a}_{2}</annotation></semantics></math>]</span>
aims to combine attention maps <math id="S2.SS2.p3.2.m1.2" class="ltx_Math" alttext="\mathbf{a}_{1},\mathbf{a}_{2}" display="inline"><semantics id="S2.SS2.p3.2.m1.2a"><mrow id="S2.SS2.p3.2.m1.2.2.2" xref="S2.SS2.p3.2.m1.2.2.3.cmml"><msub id="S2.SS2.p3.2.m1.1.1.1.1" xref="S2.SS2.p3.2.m1.1.1.1.1.cmml"><mi id="S2.SS2.p3.2.m1.1.1.1.1.2" xref="S2.SS2.p3.2.m1.1.1.1.1.2.cmml">ğš</mi><mn id="S2.SS2.p3.2.m1.1.1.1.1.3" xref="S2.SS2.p3.2.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p3.2.m1.2.2.2.3" xref="S2.SS2.p3.2.m1.2.2.3.cmml">,</mo><msub id="S2.SS2.p3.2.m1.2.2.2.2" xref="S2.SS2.p3.2.m1.2.2.2.2.cmml"><mi id="S2.SS2.p3.2.m1.2.2.2.2.2" xref="S2.SS2.p3.2.m1.2.2.2.2.2.cmml">ğš</mi><mn id="S2.SS2.p3.2.m1.2.2.2.2.3" xref="S2.SS2.p3.2.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m1.2b"><list id="S2.SS2.p3.2.m1.2.2.3.cmml" xref="S2.SS2.p3.2.m1.2.2.2"><apply id="S2.SS2.p3.2.m1.1.1.1.1.cmml" xref="S2.SS2.p3.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m1.1.1.1.1.1.cmml" xref="S2.SS2.p3.2.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.2.m1.1.1.1.1.2.cmml" xref="S2.SS2.p3.2.m1.1.1.1.1.2">ğš</ci><cn type="integer" id="S2.SS2.p3.2.m1.1.1.1.1.3.cmml" xref="S2.SS2.p3.2.m1.1.1.1.1.3">1</cn></apply><apply id="S2.SS2.p3.2.m1.2.2.2.2.cmml" xref="S2.SS2.p3.2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m1.2.2.2.2.1.cmml" xref="S2.SS2.p3.2.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p3.2.m1.2.2.2.2.2.cmml" xref="S2.SS2.p3.2.m1.2.2.2.2.2">ğš</ci><cn type="integer" id="S2.SS2.p3.2.m1.2.2.2.2.3.cmml" xref="S2.SS2.p3.2.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m1.2c">\mathbf{a}_{1},\mathbf{a}_{2}</annotation></semantics></math> generated from previous reasoning steps.
We implement it by adding two input attention weights, i.e. <math id="S2.SS2.p3.3.m2.1" class="ltx_Math" alttext="\mathbf{a}=\mathbf{a_{1}}\oplus\mathbf{a_{2}}" display="inline"><semantics id="S2.SS2.p3.3.m2.1a"><mrow id="S2.SS2.p3.3.m2.1.1" xref="S2.SS2.p3.3.m2.1.1.cmml"><mi id="S2.SS2.p3.3.m2.1.1.2" xref="S2.SS2.p3.3.m2.1.1.2.cmml">ğš</mi><mo id="S2.SS2.p3.3.m2.1.1.1" xref="S2.SS2.p3.3.m2.1.1.1.cmml">=</mo><mrow id="S2.SS2.p3.3.m2.1.1.3" xref="S2.SS2.p3.3.m2.1.1.3.cmml"><msub id="S2.SS2.p3.3.m2.1.1.3.2" xref="S2.SS2.p3.3.m2.1.1.3.2.cmml"><mi id="S2.SS2.p3.3.m2.1.1.3.2.2" xref="S2.SS2.p3.3.m2.1.1.3.2.2.cmml">ğš</mi><mn id="S2.SS2.p3.3.m2.1.1.3.2.3" xref="S2.SS2.p3.3.m2.1.1.3.2.3.cmml">ğŸ</mn></msub><mo id="S2.SS2.p3.3.m2.1.1.3.1" xref="S2.SS2.p3.3.m2.1.1.3.1.cmml">âŠ•</mo><msub id="S2.SS2.p3.3.m2.1.1.3.3" xref="S2.SS2.p3.3.m2.1.1.3.3.cmml"><mi id="S2.SS2.p3.3.m2.1.1.3.3.2" xref="S2.SS2.p3.3.m2.1.1.3.3.2.cmml">ğš</mi><mn id="S2.SS2.p3.3.m2.1.1.3.3.3" xref="S2.SS2.p3.3.m2.1.1.3.3.3.cmml">ğŸ</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m2.1b"><apply id="S2.SS2.p3.3.m2.1.1.cmml" xref="S2.SS2.p3.3.m2.1.1"><eq id="S2.SS2.p3.3.m2.1.1.1.cmml" xref="S2.SS2.p3.3.m2.1.1.1"></eq><ci id="S2.SS2.p3.3.m2.1.1.2.cmml" xref="S2.SS2.p3.3.m2.1.1.2">ğš</ci><apply id="S2.SS2.p3.3.m2.1.1.3.cmml" xref="S2.SS2.p3.3.m2.1.1.3"><csymbol cd="latexml" id="S2.SS2.p3.3.m2.1.1.3.1.cmml" xref="S2.SS2.p3.3.m2.1.1.3.1">direct-sum</csymbol><apply id="S2.SS2.p3.3.m2.1.1.3.2.cmml" xref="S2.SS2.p3.3.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m2.1.1.3.2.1.cmml" xref="S2.SS2.p3.3.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p3.3.m2.1.1.3.2.2.cmml" xref="S2.SS2.p3.3.m2.1.1.3.2.2">ğš</ci><cn type="integer" id="S2.SS2.p3.3.m2.1.1.3.2.3.cmml" xref="S2.SS2.p3.3.m2.1.1.3.2.3">1</cn></apply><apply id="S2.SS2.p3.3.m2.1.1.3.3.cmml" xref="S2.SS2.p3.3.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m2.1.1.3.3.1.cmml" xref="S2.SS2.p3.3.m2.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p3.3.m2.1.1.3.3.2.cmml" xref="S2.SS2.p3.3.m2.1.1.3.3.2">ğš</ci><cn type="integer" id="S2.SS2.p3.3.m2.1.1.3.3.3.cmml" xref="S2.SS2.p3.3.m2.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m2.1c">\mathbf{a}=\mathbf{a_{1}}\oplus\mathbf{a_{2}}</annotation></semantics></math>, where <math id="S2.SS2.p3.4.m3.1" class="ltx_Math" alttext="\oplus" display="inline"><semantics id="S2.SS2.p3.4.m3.1a"><mo id="S2.SS2.p3.4.m3.1.1" xref="S2.SS2.p3.4.m3.1.1.cmml">âŠ•</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m3.1b"><csymbol cd="latexml" id="S2.SS2.p3.4.m3.1.1.cmml" xref="S2.SS2.p3.4.m3.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m3.1c">\oplus</annotation></semantics></math> is element-wise addition.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.3" class="ltx_p"><span id="S2.SS2.p4.1.1" class="ltx_text ltx_font_bold">Filter [<math id="S2.SS2.p4.1.1.m1.2" class="ltx_Math" alttext="\mathbf{a},\mathbf{c}" display="inline"><semantics id="S2.SS2.p4.1.1.m1.2a"><mrow id="S2.SS2.p4.1.1.m1.2.3.2" xref="S2.SS2.p4.1.1.m1.2.3.1.cmml"><mi id="S2.SS2.p4.1.1.m1.1.1" xref="S2.SS2.p4.1.1.m1.1.1.cmml">ğš</mi><mo id="S2.SS2.p4.1.1.m1.2.3.2.1" xref="S2.SS2.p4.1.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS2.p4.1.1.m1.2.2" xref="S2.SS2.p4.1.1.m1.2.2.cmml">ğœ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.1.m1.2b"><list id="S2.SS2.p4.1.1.m1.2.3.1.cmml" xref="S2.SS2.p4.1.1.m1.2.3.2"><ci id="S2.SS2.p4.1.1.m1.1.1.cmml" xref="S2.SS2.p4.1.1.m1.1.1">ğš</ci><ci id="S2.SS2.p4.1.1.m1.2.2.cmml" xref="S2.SS2.p4.1.1.m1.2.2">ğœ</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.1.m1.2c">\mathbf{a},\mathbf{c}</annotation></semantics></math>]</span>
is proposed to find nodes relevant to the input query on the basis of the output from the previous step, which is used to further locate objects according to new input information.
We implement it based on <span id="S2.SS2.p4.3.2" class="ltx_text ltx_font_typewriter">Find</span> module, i.e. <math id="S2.SS2.p4.2.m1.1" class="ltx_Math" alttext="\mathbf{a}=\mathbf{a}\oplus\text{Find}(\mathbf{c})" display="inline"><semantics id="S2.SS2.p4.2.m1.1a"><mrow id="S2.SS2.p4.2.m1.1.2" xref="S2.SS2.p4.2.m1.1.2.cmml"><mi id="S2.SS2.p4.2.m1.1.2.2" xref="S2.SS2.p4.2.m1.1.2.2.cmml">ğš</mi><mo id="S2.SS2.p4.2.m1.1.2.1" xref="S2.SS2.p4.2.m1.1.2.1.cmml">=</mo><mrow id="S2.SS2.p4.2.m1.1.2.3" xref="S2.SS2.p4.2.m1.1.2.3.cmml"><mi id="S2.SS2.p4.2.m1.1.2.3.2" xref="S2.SS2.p4.2.m1.1.2.3.2.cmml">ğš</mi><mo id="S2.SS2.p4.2.m1.1.2.3.1" xref="S2.SS2.p4.2.m1.1.2.3.1.cmml">âŠ•</mo><mrow id="S2.SS2.p4.2.m1.1.2.3.3" xref="S2.SS2.p4.2.m1.1.2.3.3.cmml"><mtext id="S2.SS2.p4.2.m1.1.2.3.3.2" xref="S2.SS2.p4.2.m1.1.2.3.3.2a.cmml">Find</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m1.1.2.3.3.1" xref="S2.SS2.p4.2.m1.1.2.3.3.1.cmml">â€‹</mo><mrow id="S2.SS2.p4.2.m1.1.2.3.3.3.2" xref="S2.SS2.p4.2.m1.1.2.3.3.cmml"><mo stretchy="false" id="S2.SS2.p4.2.m1.1.2.3.3.3.2.1" xref="S2.SS2.p4.2.m1.1.2.3.3.cmml">(</mo><mi id="S2.SS2.p4.2.m1.1.1" xref="S2.SS2.p4.2.m1.1.1.cmml">ğœ</mi><mo stretchy="false" id="S2.SS2.p4.2.m1.1.2.3.3.3.2.2" xref="S2.SS2.p4.2.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m1.1b"><apply id="S2.SS2.p4.2.m1.1.2.cmml" xref="S2.SS2.p4.2.m1.1.2"><eq id="S2.SS2.p4.2.m1.1.2.1.cmml" xref="S2.SS2.p4.2.m1.1.2.1"></eq><ci id="S2.SS2.p4.2.m1.1.2.2.cmml" xref="S2.SS2.p4.2.m1.1.2.2">ğš</ci><apply id="S2.SS2.p4.2.m1.1.2.3.cmml" xref="S2.SS2.p4.2.m1.1.2.3"><csymbol cd="latexml" id="S2.SS2.p4.2.m1.1.2.3.1.cmml" xref="S2.SS2.p4.2.m1.1.2.3.1">direct-sum</csymbol><ci id="S2.SS2.p4.2.m1.1.2.3.2.cmml" xref="S2.SS2.p4.2.m1.1.2.3.2">ğš</ci><apply id="S2.SS2.p4.2.m1.1.2.3.3.cmml" xref="S2.SS2.p4.2.m1.1.2.3.3"><times id="S2.SS2.p4.2.m1.1.2.3.3.1.cmml" xref="S2.SS2.p4.2.m1.1.2.3.3.1"></times><ci id="S2.SS2.p4.2.m1.1.2.3.3.2a.cmml" xref="S2.SS2.p4.2.m1.1.2.3.3.2"><mtext id="S2.SS2.p4.2.m1.1.2.3.3.2.cmml" xref="S2.SS2.p4.2.m1.1.2.3.3.2">Find</mtext></ci><ci id="S2.SS2.p4.2.m1.1.1.cmml" xref="S2.SS2.p4.2.m1.1.1">ğœ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m1.1c">\mathbf{a}=\mathbf{a}\oplus\text{Find}(\mathbf{c})</annotation></semantics></math>, where <math id="S2.SS2.p4.3.m2.1" class="ltx_Math" alttext="\oplus" display="inline"><semantics id="S2.SS2.p4.3.m2.1a"><mo id="S2.SS2.p4.3.m2.1.1" xref="S2.SS2.p4.3.m2.1.1.cmml">âŠ•</mo><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m2.1b"><csymbol cd="latexml" id="S2.SS2.p4.3.m2.1.1.cmml" xref="S2.SS2.p4.3.m2.1.1">direct-sum</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m2.1c">\oplus</annotation></semantics></math> is element-wise addition.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS2.p5.3" class="ltx_p"><span id="S2.SS2.p5.1.1" class="ltx_text ltx_font_bold">Relate [<math id="S2.SS2.p5.1.1.m1.3" class="ltx_Math" alttext="\mathbf{a},\mathbf{E},\mathbf{c}" display="inline"><semantics id="S2.SS2.p5.1.1.m1.3a"><mrow id="S2.SS2.p5.1.1.m1.3.4.2" xref="S2.SS2.p5.1.1.m1.3.4.1.cmml"><mi id="S2.SS2.p5.1.1.m1.1.1" xref="S2.SS2.p5.1.1.m1.1.1.cmml">ğš</mi><mo id="S2.SS2.p5.1.1.m1.3.4.2.1" xref="S2.SS2.p5.1.1.m1.3.4.1.cmml">,</mo><mi id="S2.SS2.p5.1.1.m1.2.2" xref="S2.SS2.p5.1.1.m1.2.2.cmml">ğ„</mi><mo id="S2.SS2.p5.1.1.m1.3.4.2.2" xref="S2.SS2.p5.1.1.m1.3.4.1.cmml">,</mo><mi id="S2.SS2.p5.1.1.m1.3.3" xref="S2.SS2.p5.1.1.m1.3.3.cmml">ğœ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.1.m1.3b"><list id="S2.SS2.p5.1.1.m1.3.4.1.cmml" xref="S2.SS2.p5.1.1.m1.3.4.2"><ci id="S2.SS2.p5.1.1.m1.1.1.cmml" xref="S2.SS2.p5.1.1.m1.1.1">ğš</ci><ci id="S2.SS2.p5.1.1.m1.2.2.cmml" xref="S2.SS2.p5.1.1.m1.2.2">ğ„</ci><ci id="S2.SS2.p5.1.1.m1.3.3.cmml" xref="S2.SS2.p5.1.1.m1.3.3">ğœ</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.1.m1.3c">\mathbf{a},\mathbf{E},\mathbf{c}</annotation></semantics></math>].</span>
The deeper questions mostly involve the interaction between objects.
Therefore it is essential to transfer the current node to adjacent nodes via attended edge.
We first find the relevant edges given the input query. The attention weight <math id="S2.SS2.p5.2.m1.1" class="ltx_Math" alttext="W_{ij}\in\mathbf{W}^{n\times n}" display="inline"><semantics id="S2.SS2.p5.2.m1.1a"><mrow id="S2.SS2.p5.2.m1.1.1" xref="S2.SS2.p5.2.m1.1.1.cmml"><msub id="S2.SS2.p5.2.m1.1.1.2" xref="S2.SS2.p5.2.m1.1.1.2.cmml"><mi id="S2.SS2.p5.2.m1.1.1.2.2" xref="S2.SS2.p5.2.m1.1.1.2.2.cmml">W</mi><mrow id="S2.SS2.p5.2.m1.1.1.2.3" xref="S2.SS2.p5.2.m1.1.1.2.3.cmml"><mi id="S2.SS2.p5.2.m1.1.1.2.3.2" xref="S2.SS2.p5.2.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.2.m1.1.1.2.3.1" xref="S2.SS2.p5.2.m1.1.1.2.3.1.cmml">â€‹</mo><mi id="S2.SS2.p5.2.m1.1.1.2.3.3" xref="S2.SS2.p5.2.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS2.p5.2.m1.1.1.1" xref="S2.SS2.p5.2.m1.1.1.1.cmml">âˆˆ</mo><msup id="S2.SS2.p5.2.m1.1.1.3" xref="S2.SS2.p5.2.m1.1.1.3.cmml"><mi id="S2.SS2.p5.2.m1.1.1.3.2" xref="S2.SS2.p5.2.m1.1.1.3.2.cmml">ğ–</mi><mrow id="S2.SS2.p5.2.m1.1.1.3.3" xref="S2.SS2.p5.2.m1.1.1.3.3.cmml"><mi id="S2.SS2.p5.2.m1.1.1.3.3.2" xref="S2.SS2.p5.2.m1.1.1.3.3.2.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS2.p5.2.m1.1.1.3.3.1" xref="S2.SS2.p5.2.m1.1.1.3.3.1.cmml">Ã—</mo><mi id="S2.SS2.p5.2.m1.1.1.3.3.3" xref="S2.SS2.p5.2.m1.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m1.1b"><apply id="S2.SS2.p5.2.m1.1.1.cmml" xref="S2.SS2.p5.2.m1.1.1"><in id="S2.SS2.p5.2.m1.1.1.1.cmml" xref="S2.SS2.p5.2.m1.1.1.1"></in><apply id="S2.SS2.p5.2.m1.1.1.2.cmml" xref="S2.SS2.p5.2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m1.1.1.2.1.cmml" xref="S2.SS2.p5.2.m1.1.1.2">subscript</csymbol><ci id="S2.SS2.p5.2.m1.1.1.2.2.cmml" xref="S2.SS2.p5.2.m1.1.1.2.2">ğ‘Š</ci><apply id="S2.SS2.p5.2.m1.1.1.2.3.cmml" xref="S2.SS2.p5.2.m1.1.1.2.3"><times id="S2.SS2.p5.2.m1.1.1.2.3.1.cmml" xref="S2.SS2.p5.2.m1.1.1.2.3.1"></times><ci id="S2.SS2.p5.2.m1.1.1.2.3.2.cmml" xref="S2.SS2.p5.2.m1.1.1.2.3.2">ğ‘–</ci><ci id="S2.SS2.p5.2.m1.1.1.2.3.3.cmml" xref="S2.SS2.p5.2.m1.1.1.2.3.3">ğ‘—</ci></apply></apply><apply id="S2.SS2.p5.2.m1.1.1.3.cmml" xref="S2.SS2.p5.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m1.1.1.3.1.cmml" xref="S2.SS2.p5.2.m1.1.1.3">superscript</csymbol><ci id="S2.SS2.p5.2.m1.1.1.3.2.cmml" xref="S2.SS2.p5.2.m1.1.1.3.2">ğ–</ci><apply id="S2.SS2.p5.2.m1.1.1.3.3.cmml" xref="S2.SS2.p5.2.m1.1.1.3.3"><times id="S2.SS2.p5.2.m1.1.1.3.3.1.cmml" xref="S2.SS2.p5.2.m1.1.1.3.3.1"></times><ci id="S2.SS2.p5.2.m1.1.1.3.3.2.cmml" xref="S2.SS2.p5.2.m1.1.1.3.3.2">ğ‘›</ci><ci id="S2.SS2.p5.2.m1.1.1.3.3.3.cmml" xref="S2.SS2.p5.2.m1.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m1.1c">W_{ij}\in\mathbf{W}^{n\times n}</annotation></semantics></math> of edge <math id="S2.SS2.p5.3.m2.1" class="ltx_Math" alttext="e_{ij}" display="inline"><semantics id="S2.SS2.p5.3.m2.1a"><msub id="S2.SS2.p5.3.m2.1.1" xref="S2.SS2.p5.3.m2.1.1.cmml"><mi id="S2.SS2.p5.3.m2.1.1.2" xref="S2.SS2.p5.3.m2.1.1.2.cmml">e</mi><mrow id="S2.SS2.p5.3.m2.1.1.3" xref="S2.SS2.p5.3.m2.1.1.3.cmml"><mi id="S2.SS2.p5.3.m2.1.1.3.2" xref="S2.SS2.p5.3.m2.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.3.m2.1.1.3.1" xref="S2.SS2.p5.3.m2.1.1.3.1.cmml">â€‹</mo><mi id="S2.SS2.p5.3.m2.1.1.3.3" xref="S2.SS2.p5.3.m2.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m2.1b"><apply id="S2.SS2.p5.3.m2.1.1.cmml" xref="S2.SS2.p5.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.3.m2.1.1.1.cmml" xref="S2.SS2.p5.3.m2.1.1">subscript</csymbol><ci id="S2.SS2.p5.3.m2.1.1.2.cmml" xref="S2.SS2.p5.3.m2.1.1.2">ğ‘’</ci><apply id="S2.SS2.p5.3.m2.1.1.3.cmml" xref="S2.SS2.p5.3.m2.1.1.3"><times id="S2.SS2.p5.3.m2.1.1.3.1.cmml" xref="S2.SS2.p5.3.m2.1.1.3.1"></times><ci id="S2.SS2.p5.3.m2.1.1.3.2.cmml" xref="S2.SS2.p5.3.m2.1.1.3.2">ğ‘–</ci><ci id="S2.SS2.p5.3.m2.1.1.3.3.cmml" xref="S2.SS2.p5.3.m2.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m2.1c">e_{ij}</annotation></semantics></math> is computed by:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="W_{ij}=\text{ReLU}(f_{mlp}(W_{3}\mathbf{c}\odot W_{4}\mathbf{e}_{ij}))," display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml">W</mi><mrow id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E2.m1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mtext id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3a.cmml">ReLU</mtext><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.1a" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.4" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mn id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">3</mn></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">â€‹</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">ğœ</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">âŠ™</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mn id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">4</mn></msub></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">â€‹</mo><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ğ</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></eq><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2">ğ‘Š</ci><apply id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><times id="S2.E2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.1"></times><ci id="S2.E2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2">ğ‘–</ci><ci id="S2.E2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3">ğ‘—</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.1.1.3a.cmml" xref="S2.E2.m1.1.1.1.1.1.3"><mtext id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">ReLU</mtext></ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.2">ğ‘“</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.2">ğ‘š</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.3">ğ‘™</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.3.3.4">ğ‘</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.1">direct-product</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1"></times><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">ğ‘Š</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">3</cn></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3">ğœ</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">ğ‘Š</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">4</cn></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">ğ</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.2">ğ‘–</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.3">ğ‘—</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">W_{ij}=\text{ReLU}(f_{mlp}(W_{3}\mathbf{c}\odot W_{4}\mathbf{e}_{ij})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p5.6" class="ltx_p">where <math id="S2.SS2.p5.4.m1.1" class="ltx_Math" alttext="\mathbf{e}_{ij}\in\mathbf{E}" display="inline"><semantics id="S2.SS2.p5.4.m1.1a"><mrow id="S2.SS2.p5.4.m1.1.1" xref="S2.SS2.p5.4.m1.1.1.cmml"><msub id="S2.SS2.p5.4.m1.1.1.2" xref="S2.SS2.p5.4.m1.1.1.2.cmml"><mi id="S2.SS2.p5.4.m1.1.1.2.2" xref="S2.SS2.p5.4.m1.1.1.2.2.cmml">ğ</mi><mrow id="S2.SS2.p5.4.m1.1.1.2.3" xref="S2.SS2.p5.4.m1.1.1.2.3.cmml"><mi id="S2.SS2.p5.4.m1.1.1.2.3.2" xref="S2.SS2.p5.4.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.4.m1.1.1.2.3.1" xref="S2.SS2.p5.4.m1.1.1.2.3.1.cmml">â€‹</mo><mi id="S2.SS2.p5.4.m1.1.1.2.3.3" xref="S2.SS2.p5.4.m1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.SS2.p5.4.m1.1.1.1" xref="S2.SS2.p5.4.m1.1.1.1.cmml">âˆˆ</mo><mi id="S2.SS2.p5.4.m1.1.1.3" xref="S2.SS2.p5.4.m1.1.1.3.cmml">ğ„</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m1.1b"><apply id="S2.SS2.p5.4.m1.1.1.cmml" xref="S2.SS2.p5.4.m1.1.1"><in id="S2.SS2.p5.4.m1.1.1.1.cmml" xref="S2.SS2.p5.4.m1.1.1.1"></in><apply id="S2.SS2.p5.4.m1.1.1.2.cmml" xref="S2.SS2.p5.4.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m1.1.1.2.1.cmml" xref="S2.SS2.p5.4.m1.1.1.2">subscript</csymbol><ci id="S2.SS2.p5.4.m1.1.1.2.2.cmml" xref="S2.SS2.p5.4.m1.1.1.2.2">ğ</ci><apply id="S2.SS2.p5.4.m1.1.1.2.3.cmml" xref="S2.SS2.p5.4.m1.1.1.2.3"><times id="S2.SS2.p5.4.m1.1.1.2.3.1.cmml" xref="S2.SS2.p5.4.m1.1.1.2.3.1"></times><ci id="S2.SS2.p5.4.m1.1.1.2.3.2.cmml" xref="S2.SS2.p5.4.m1.1.1.2.3.2">ğ‘–</ci><ci id="S2.SS2.p5.4.m1.1.1.2.3.3.cmml" xref="S2.SS2.p5.4.m1.1.1.2.3.3">ğ‘—</ci></apply></apply><ci id="S2.SS2.p5.4.m1.1.1.3.cmml" xref="S2.SS2.p5.4.m1.1.1.3">ğ„</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m1.1c">\mathbf{e}_{ij}\in\mathbf{E}</annotation></semantics></math> is edge embedding.
Thanks to graph structure, we can transfer the node weights along the attentive relations to update attention weights by matrix multiplication: <math id="S2.SS2.p5.5.m2.1" class="ltx_Math" alttext="\mathbf{a}=\text{norm}(\mathbf{W}^{T}\mathbf{a})" display="inline"><semantics id="S2.SS2.p5.5.m2.1a"><mrow id="S2.SS2.p5.5.m2.1.1" xref="S2.SS2.p5.5.m2.1.1.cmml"><mi id="S2.SS2.p5.5.m2.1.1.3" xref="S2.SS2.p5.5.m2.1.1.3.cmml">ğš</mi><mo id="S2.SS2.p5.5.m2.1.1.2" xref="S2.SS2.p5.5.m2.1.1.2.cmml">=</mo><mrow id="S2.SS2.p5.5.m2.1.1.1" xref="S2.SS2.p5.5.m2.1.1.1.cmml"><mtext id="S2.SS2.p5.5.m2.1.1.1.3" xref="S2.SS2.p5.5.m2.1.1.1.3a.cmml">norm</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.m2.1.1.1.2" xref="S2.SS2.p5.5.m2.1.1.1.2.cmml">â€‹</mo><mrow id="S2.SS2.p5.5.m2.1.1.1.1.1" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p5.5.m2.1.1.1.1.1.2" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p5.5.m2.1.1.1.1.1.1" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.cmml"><msup id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.cmml"><mi id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.2" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.2.cmml">ğ–</mi><mi id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.3" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.m2.1.1.1.1.1.1.1" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.1.cmml">â€‹</mo><mi id="S2.SS2.p5.5.m2.1.1.1.1.1.1.3" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.3.cmml">ğš</mi></mrow><mo stretchy="false" id="S2.SS2.p5.5.m2.1.1.1.1.1.3" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m2.1b"><apply id="S2.SS2.p5.5.m2.1.1.cmml" xref="S2.SS2.p5.5.m2.1.1"><eq id="S2.SS2.p5.5.m2.1.1.2.cmml" xref="S2.SS2.p5.5.m2.1.1.2"></eq><ci id="S2.SS2.p5.5.m2.1.1.3.cmml" xref="S2.SS2.p5.5.m2.1.1.3">ğš</ci><apply id="S2.SS2.p5.5.m2.1.1.1.cmml" xref="S2.SS2.p5.5.m2.1.1.1"><times id="S2.SS2.p5.5.m2.1.1.1.2.cmml" xref="S2.SS2.p5.5.m2.1.1.1.2"></times><ci id="S2.SS2.p5.5.m2.1.1.1.3a.cmml" xref="S2.SS2.p5.5.m2.1.1.1.3"><mtext id="S2.SS2.p5.5.m2.1.1.1.3.cmml" xref="S2.SS2.p5.5.m2.1.1.1.3">norm</mtext></ci><apply id="S2.SS2.p5.5.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1"><times id="S2.SS2.p5.5.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.1"></times><apply id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.2">ğ–</ci><ci id="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.2.3">ğ‘‡</ci></apply><ci id="S2.SS2.p5.5.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p5.5.m2.1.1.1.1.1.1.3">ğš</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m2.1c">\mathbf{a}=\text{norm}(\mathbf{W}^{T}\mathbf{a})</annotation></semantics></math>,
where <math id="S2.SS2.p5.6.m3.1" class="ltx_Math" alttext="\text{norm}(\cdot)" display="inline"><semantics id="S2.SS2.p5.6.m3.1a"><mrow id="S2.SS2.p5.6.m3.1.2" xref="S2.SS2.p5.6.m3.1.2.cmml"><mtext id="S2.SS2.p5.6.m3.1.2.2" xref="S2.SS2.p5.6.m3.1.2.2a.cmml">norm</mtext><mo lspace="0em" rspace="0em" id="S2.SS2.p5.6.m3.1.2.1" xref="S2.SS2.p5.6.m3.1.2.1.cmml">â€‹</mo><mrow id="S2.SS2.p5.6.m3.1.2.3.2" xref="S2.SS2.p5.6.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.6.m3.1.2.3.2.1" xref="S2.SS2.p5.6.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p5.6.m3.1.1" xref="S2.SS2.p5.6.m3.1.1.cmml">â‹…</mo><mo stretchy="false" id="S2.SS2.p5.6.m3.1.2.3.2.2" xref="S2.SS2.p5.6.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m3.1b"><apply id="S2.SS2.p5.6.m3.1.2.cmml" xref="S2.SS2.p5.6.m3.1.2"><times id="S2.SS2.p5.6.m3.1.2.1.cmml" xref="S2.SS2.p5.6.m3.1.2.1"></times><ci id="S2.SS2.p5.6.m3.1.2.2a.cmml" xref="S2.SS2.p5.6.m3.1.2.2"><mtext id="S2.SS2.p5.6.m3.1.2.2.cmml" xref="S2.SS2.p5.6.m3.1.2.2">norm</mtext></ci><ci id="S2.SS2.p5.6.m3.1.1.cmml" xref="S2.SS2.p5.6.m3.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m3.1c">\text{norm}(\cdot)</annotation></semantics></math> is normalization operation.</p>
</div>
<div id="S2.SS2.p6" class="ltx_para ltx_noindent">
<p id="S2.SS2.p6.4" class="ltx_p"><math id="S2.SS2.p6.1.m1.1" class="ltx_Math" alttext="\text{CrossGraph}_{G_{m}\to G_{n}}" display="inline"><semantics id="S2.SS2.p6.1.m1.1a"><msub id="S2.SS2.p6.1.m1.1.1" xref="S2.SS2.p6.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p6.1.m1.1.1.2" xref="S2.SS2.p6.1.m1.1.1.2a.cmml">CrossGraph</mtext><mrow id="S2.SS2.p6.1.m1.1.1.3" xref="S2.SS2.p6.1.m1.1.1.3.cmml"><msub id="S2.SS2.p6.1.m1.1.1.3.2" xref="S2.SS2.p6.1.m1.1.1.3.2.cmml"><mi id="S2.SS2.p6.1.m1.1.1.3.2.2" xref="S2.SS2.p6.1.m1.1.1.3.2.2.cmml">G</mi><mi id="S2.SS2.p6.1.m1.1.1.3.2.3" xref="S2.SS2.p6.1.m1.1.1.3.2.3.cmml">m</mi></msub><mo stretchy="false" id="S2.SS2.p6.1.m1.1.1.3.1" xref="S2.SS2.p6.1.m1.1.1.3.1.cmml">â†’</mo><msub id="S2.SS2.p6.1.m1.1.1.3.3" xref="S2.SS2.p6.1.m1.1.1.3.3.cmml"><mi id="S2.SS2.p6.1.m1.1.1.3.3.2" xref="S2.SS2.p6.1.m1.1.1.3.3.2.cmml">G</mi><mi id="S2.SS2.p6.1.m1.1.1.3.3.3" xref="S2.SS2.p6.1.m1.1.1.3.3.3.cmml">n</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.m1.1b"><apply id="S2.SS2.p6.1.m1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p6.1.m1.1.1.2a.cmml" xref="S2.SS2.p6.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S2.SS2.p6.1.m1.1.1.2.cmml" xref="S2.SS2.p6.1.m1.1.1.2">CrossGraph</mtext></ci><apply id="S2.SS2.p6.1.m1.1.1.3.cmml" xref="S2.SS2.p6.1.m1.1.1.3"><ci id="S2.SS2.p6.1.m1.1.1.3.1.cmml" xref="S2.SS2.p6.1.m1.1.1.3.1">â†’</ci><apply id="S2.SS2.p6.1.m1.1.1.3.2.cmml" xref="S2.SS2.p6.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.1.1.3.2.1.cmml" xref="S2.SS2.p6.1.m1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p6.1.m1.1.1.3.2.2.cmml" xref="S2.SS2.p6.1.m1.1.1.3.2.2">ğº</ci><ci id="S2.SS2.p6.1.m1.1.1.3.2.3.cmml" xref="S2.SS2.p6.1.m1.1.1.3.2.3">ğ‘š</ci></apply><apply id="S2.SS2.p6.1.m1.1.1.3.3.cmml" xref="S2.SS2.p6.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.1.1.3.3.1.cmml" xref="S2.SS2.p6.1.m1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p6.1.m1.1.1.3.3.2.cmml" xref="S2.SS2.p6.1.m1.1.1.3.3.2">ğº</ci><ci id="S2.SS2.p6.1.m1.1.1.3.3.3.cmml" xref="S2.SS2.p6.1.m1.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.m1.1c">\text{CrossGraph}_{G_{m}\to G_{n}}</annotation></semantics></math><span id="S2.SS2.p6.2.1" class="ltx_text ltx_font_bold">[<math id="S2.SS2.p6.2.1.m1.5" class="ltx_Math" alttext="\mathbf{a}_{m},\mathbf{a}_{n},\mathbf{X}_{m},\mathbf{X}_{n},\mathbf{c}" display="inline"><semantics id="S2.SS2.p6.2.1.m1.5a"><mrow id="S2.SS2.p6.2.1.m1.5.5.4" xref="S2.SS2.p6.2.1.m1.5.5.5.cmml"><msub id="S2.SS2.p6.2.1.m1.2.2.1.1" xref="S2.SS2.p6.2.1.m1.2.2.1.1.cmml"><mi id="S2.SS2.p6.2.1.m1.2.2.1.1.2" xref="S2.SS2.p6.2.1.m1.2.2.1.1.2.cmml">ğš</mi><mi id="S2.SS2.p6.2.1.m1.2.2.1.1.3" xref="S2.SS2.p6.2.1.m1.2.2.1.1.3.cmml">m</mi></msub><mo id="S2.SS2.p6.2.1.m1.5.5.4.5" xref="S2.SS2.p6.2.1.m1.5.5.5.cmml">,</mo><msub id="S2.SS2.p6.2.1.m1.3.3.2.2" xref="S2.SS2.p6.2.1.m1.3.3.2.2.cmml"><mi id="S2.SS2.p6.2.1.m1.3.3.2.2.2" xref="S2.SS2.p6.2.1.m1.3.3.2.2.2.cmml">ğš</mi><mi id="S2.SS2.p6.2.1.m1.3.3.2.2.3" xref="S2.SS2.p6.2.1.m1.3.3.2.2.3.cmml">n</mi></msub><mo id="S2.SS2.p6.2.1.m1.5.5.4.6" xref="S2.SS2.p6.2.1.m1.5.5.5.cmml">,</mo><msub id="S2.SS2.p6.2.1.m1.4.4.3.3" xref="S2.SS2.p6.2.1.m1.4.4.3.3.cmml"><mi id="S2.SS2.p6.2.1.m1.4.4.3.3.2" xref="S2.SS2.p6.2.1.m1.4.4.3.3.2.cmml">ğ—</mi><mi id="S2.SS2.p6.2.1.m1.4.4.3.3.3" xref="S2.SS2.p6.2.1.m1.4.4.3.3.3.cmml">m</mi></msub><mo id="S2.SS2.p6.2.1.m1.5.5.4.7" xref="S2.SS2.p6.2.1.m1.5.5.5.cmml">,</mo><msub id="S2.SS2.p6.2.1.m1.5.5.4.4" xref="S2.SS2.p6.2.1.m1.5.5.4.4.cmml"><mi id="S2.SS2.p6.2.1.m1.5.5.4.4.2" xref="S2.SS2.p6.2.1.m1.5.5.4.4.2.cmml">ğ—</mi><mi id="S2.SS2.p6.2.1.m1.5.5.4.4.3" xref="S2.SS2.p6.2.1.m1.5.5.4.4.3.cmml">n</mi></msub><mo id="S2.SS2.p6.2.1.m1.5.5.4.8" xref="S2.SS2.p6.2.1.m1.5.5.5.cmml">,</mo><mi id="S2.SS2.p6.2.1.m1.1.1" xref="S2.SS2.p6.2.1.m1.1.1.cmml">ğœ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.2.1.m1.5b"><list id="S2.SS2.p6.2.1.m1.5.5.5.cmml" xref="S2.SS2.p6.2.1.m1.5.5.4"><apply id="S2.SS2.p6.2.1.m1.2.2.1.1.cmml" xref="S2.SS2.p6.2.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.2.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p6.2.1.m1.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p6.2.1.m1.2.2.1.1.2.cmml" xref="S2.SS2.p6.2.1.m1.2.2.1.1.2">ğš</ci><ci id="S2.SS2.p6.2.1.m1.2.2.1.1.3.cmml" xref="S2.SS2.p6.2.1.m1.2.2.1.1.3">ğ‘š</ci></apply><apply id="S2.SS2.p6.2.1.m1.3.3.2.2.cmml" xref="S2.SS2.p6.2.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p6.2.1.m1.3.3.2.2.1.cmml" xref="S2.SS2.p6.2.1.m1.3.3.2.2">subscript</csymbol><ci id="S2.SS2.p6.2.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p6.2.1.m1.3.3.2.2.2">ğš</ci><ci id="S2.SS2.p6.2.1.m1.3.3.2.2.3.cmml" xref="S2.SS2.p6.2.1.m1.3.3.2.2.3">ğ‘›</ci></apply><apply id="S2.SS2.p6.2.1.m1.4.4.3.3.cmml" xref="S2.SS2.p6.2.1.m1.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.p6.2.1.m1.4.4.3.3.1.cmml" xref="S2.SS2.p6.2.1.m1.4.4.3.3">subscript</csymbol><ci id="S2.SS2.p6.2.1.m1.4.4.3.3.2.cmml" xref="S2.SS2.p6.2.1.m1.4.4.3.3.2">ğ—</ci><ci id="S2.SS2.p6.2.1.m1.4.4.3.3.3.cmml" xref="S2.SS2.p6.2.1.m1.4.4.3.3.3">ğ‘š</ci></apply><apply id="S2.SS2.p6.2.1.m1.5.5.4.4.cmml" xref="S2.SS2.p6.2.1.m1.5.5.4.4"><csymbol cd="ambiguous" id="S2.SS2.p6.2.1.m1.5.5.4.4.1.cmml" xref="S2.SS2.p6.2.1.m1.5.5.4.4">subscript</csymbol><ci id="S2.SS2.p6.2.1.m1.5.5.4.4.2.cmml" xref="S2.SS2.p6.2.1.m1.5.5.4.4.2">ğ—</ci><ci id="S2.SS2.p6.2.1.m1.5.5.4.4.3.cmml" xref="S2.SS2.p6.2.1.m1.5.5.4.4.3">ğ‘›</ci></apply><ci id="S2.SS2.p6.2.1.m1.1.1.cmml" xref="S2.SS2.p6.2.1.m1.1.1">ğœ</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.2.1.m1.5c">\mathbf{a}_{m},\mathbf{a}_{n},\mathbf{X}_{m},\mathbf{X}_{n},\mathbf{c}</annotation></semantics></math>].</span>
Reasoning within one graph is not enough to answer deep questions.
It is essential to associate nodes of different graphs to extend the reasoning process from one graph to multi-layer graphs.
We achieve this goal by computing attention map over nodes of graph <math id="S2.SS2.p6.3.m2.1" class="ltx_Math" alttext="G_{n}" display="inline"><semantics id="S2.SS2.p6.3.m2.1a"><msub id="S2.SS2.p6.3.m2.1.1" xref="S2.SS2.p6.3.m2.1.1.cmml"><mi id="S2.SS2.p6.3.m2.1.1.2" xref="S2.SS2.p6.3.m2.1.1.2.cmml">G</mi><mi id="S2.SS2.p6.3.m2.1.1.3" xref="S2.SS2.p6.3.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.3.m2.1b"><apply id="S2.SS2.p6.3.m2.1.1.cmml" xref="S2.SS2.p6.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.3.m2.1.1.1.cmml" xref="S2.SS2.p6.3.m2.1.1">subscript</csymbol><ci id="S2.SS2.p6.3.m2.1.1.2.cmml" xref="S2.SS2.p6.3.m2.1.1.2">ğº</ci><ci id="S2.SS2.p6.3.m2.1.1.3.cmml" xref="S2.SS2.p6.3.m2.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.3.m2.1c">G_{n}</annotation></semantics></math> guided by the node features of graph <math id="S2.SS2.p6.4.m3.1" class="ltx_Math" alttext="G_{m}" display="inline"><semantics id="S2.SS2.p6.4.m3.1a"><msub id="S2.SS2.p6.4.m3.1.1" xref="S2.SS2.p6.4.m3.1.1.cmml"><mi id="S2.SS2.p6.4.m3.1.1.2" xref="S2.SS2.p6.4.m3.1.1.2.cmml">G</mi><mi id="S2.SS2.p6.4.m3.1.1.3" xref="S2.SS2.p6.4.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.4.m3.1b"><apply id="S2.SS2.p6.4.m3.1.1.cmml" xref="S2.SS2.p6.4.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.4.m3.1.1.1.cmml" xref="S2.SS2.p6.4.m3.1.1">subscript</csymbol><ci id="S2.SS2.p6.4.m3.1.1.2.cmml" xref="S2.SS2.p6.4.m3.1.1.2">ğº</ci><ci id="S2.SS2.p6.4.m3.1.1.3.cmml" xref="S2.SS2.p6.4.m3.1.1.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.4.m3.1c">G_{m}</annotation></semantics></math>:</p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\mathbf{a^{\prime}}_{n}(i)=\text{softmax}(" display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1b"><mmultiscripts id="S2.E3.m1.1.2"><mi id="S2.E3.m1.1.2.2.2">ğš</mi><mrow id="S2.E3.m1.1.2a"></mrow><mo id="S2.E3.m1.1.2.2.3">â€²</mo><mi id="S2.E3.m1.1.2.3">n</mi><mrow id="S2.E3.m1.1.2b"></mrow></mmultiscripts><mrow id="S2.E3.m1.1.3"><mo stretchy="false" id="S2.E3.m1.1.3.1">(</mo><mi id="S2.E3.m1.1.1">i</mi><mo stretchy="false" id="S2.E3.m1.1.3.2">)</mo></mrow><mo id="S2.E3.m1.1.4">=</mo><mtext id="S2.E3.m1.1.5">softmax</mtext><mo stretchy="false" id="S2.E3.m1.1.6">(</mo></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathbf{a^{\prime}}_{n}(i)=\text{softmax}(</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.3" class="ltx_Math" alttext="\displaystyle W_{7}(\tanh(W_{5}\mathbf{X}^{T}_{m}\mathbf{a}_{m}+W_{6}\mathbf{X}_{n}(i)))," display="inline"><semantics id="S2.E3.m2.3a"><mrow id="S2.E3.m2.3.3.1" xref="S2.E3.m2.3.3.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1" xref="S2.E3.m2.3.3.1.1.cmml"><msub id="S2.E3.m2.3.3.1.1.3" xref="S2.E3.m2.3.3.1.1.3.cmml"><mi id="S2.E3.m2.3.3.1.1.3.2" xref="S2.E3.m2.3.3.1.1.3.2.cmml">W</mi><mn id="S2.E3.m2.3.3.1.1.3.3" xref="S2.E3.m2.3.3.1.1.3.3.cmml">7</mn></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.3.3.1.1.2" xref="S2.E3.m2.3.3.1.1.2.cmml">â€‹</mo><mrow id="S2.E3.m2.3.3.1.1.1.1" xref="S2.E3.m2.3.3.1.1.cmml"><mo stretchy="false" id="S2.E3.m2.3.3.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.cmml">(</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E3.m2.2.2" xref="S2.E3.m2.2.2.cmml">tanh</mi><mo id="S2.E3.m2.3.3.1.1.1.1.1.1a" xref="S2.E3.m2.3.3.1.1.1.1.1.2.cmml">â¡</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mn id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">5</mn></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.1.cmml">â€‹</mo><msubsup id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.2.cmml">ğ—</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.3.cmml">m</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.1a" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.1.cmml">â€‹</mo><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.2.cmml">ğš</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.3.cmml">m</mi></msub></mrow><mo id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">W</mi><mn id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">6</mn></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><msub id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">ğ—</mi><mi id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1a" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml">â€‹</mo><mrow id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.4.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.4.2.1" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E3.m2.1.1" xref="S2.E3.m2.1.1.cmml">i</mi><mo stretchy="false" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.4.2.2" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E3.m2.3.3.1.1.1.1.3" xref="S2.E3.m2.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m2.3.3.1.2" xref="S2.E3.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.3b"><apply id="S2.E3.m2.3.3.1.1.cmml" xref="S2.E3.m2.3.3.1"><times id="S2.E3.m2.3.3.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.2"></times><apply id="S2.E3.m2.3.3.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.3.1.cmml" xref="S2.E3.m2.3.3.1.1.3">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.3.2.cmml" xref="S2.E3.m2.3.3.1.1.3.2">ğ‘Š</ci><cn type="integer" id="S2.E3.m2.3.3.1.1.3.3.cmml" xref="S2.E3.m2.3.3.1.1.3.3">7</cn></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1"><tanh id="S2.E3.m2.2.2.cmml" xref="S2.E3.m2.2.2"></tanh><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1"><plus id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.1"></plus><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2"><times id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.1"></times><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.2">ğ‘Š</ci><cn type="integer" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.2.3">5</cn></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.2">ğ—</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.2.3">ğ‘‡</ci></apply><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.3.3">ğ‘š</ci></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.2">ğš</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.2.4.3">ğ‘š</ci></apply></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3"><times id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.2">ğ‘Š</ci><cn type="integer" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.3">6</cn></apply><apply id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2">ğ—</ci><ci id="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">ğ‘›</ci></apply><ci id="S2.E3.m2.1.1.cmml" xref="S2.E3.m2.1.1">ğ‘–</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.3c">\displaystyle W_{7}(\tanh(W_{5}\mathbf{X}^{T}_{m}\mathbf{a}_{m}+W_{6}\mathbf{X}_{n}(i))),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{a}_{n}=\mathbf{a^{\prime}}_{n}+\mathbf{a}_{n}," display="inline"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml"><mi id="S2.E4.m1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.2.2.cmml">ğš</mi><mi id="S2.E4.m1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.cmml"><mmultiscripts id="S2.E4.m1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.3.2.cmml"><mi id="S2.E4.m1.1.1.1.1.3.2.2.2" xref="S2.E4.m1.1.1.1.1.3.2.2.2.cmml">ğš</mi><mrow id="S2.E4.m1.1.1.1.1.3.2a" xref="S2.E4.m1.1.1.1.1.3.2.cmml"></mrow><mo id="S2.E4.m1.1.1.1.1.3.2.2.3" xref="S2.E4.m1.1.1.1.1.3.2.2.3.cmml">â€²</mo><mi id="S2.E4.m1.1.1.1.1.3.2.3" xref="S2.E4.m1.1.1.1.1.3.2.3.cmml">n</mi><mrow id="S2.E4.m1.1.1.1.1.3.2b" xref="S2.E4.m1.1.1.1.1.3.2.cmml"></mrow></mmultiscripts><mo id="S2.E4.m1.1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S2.E4.m1.1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.1.3.3.cmml"><mi id="S2.E4.m1.1.1.1.1.3.3.2" xref="S2.E4.m1.1.1.1.1.3.3.2.cmml">ğš</mi><mi id="S2.E4.m1.1.1.1.1.3.3.3" xref="S2.E4.m1.1.1.1.1.3.3.3.cmml">n</mi></msub></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"></eq><apply id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2">ğš</ci><ci id="S2.E4.m1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3">ğ‘›</ci></apply><apply id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3"><plus id="S2.E4.m1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.3.1"></plus><apply id="S2.E4.m1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.3.2.2.2">ğš</ci><ci id="S2.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.3.2.2.3">â€²</ci></apply><ci id="S2.E4.m1.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.3.2.3">ğ‘›</ci></apply><apply id="S2.E4.m1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.3.3.1.cmml" xref="S2.E4.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.3.3.2.cmml" xref="S2.E4.m1.1.1.1.1.3.3.2">ğš</ci><ci id="S2.E4.m1.1.1.1.1.3.3.3.cmml" xref="S2.E4.m1.1.1.1.1.3.3.3">ğ‘›</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\displaystyle\mathbf{a}_{n}=\mathbf{a^{\prime}}_{n}+\mathbf{a}_{n},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p7" class="ltx_para">
<p id="S2.SS2.p7.3" class="ltx_p">where <math id="S2.SS2.p7.1.m1.1" class="ltx_Math" alttext="\mathbf{X}_{n}(i)" display="inline"><semantics id="S2.SS2.p7.1.m1.1a"><mrow id="S2.SS2.p7.1.m1.1.2" xref="S2.SS2.p7.1.m1.1.2.cmml"><msub id="S2.SS2.p7.1.m1.1.2.2" xref="S2.SS2.p7.1.m1.1.2.2.cmml"><mi id="S2.SS2.p7.1.m1.1.2.2.2" xref="S2.SS2.p7.1.m1.1.2.2.2.cmml">ğ—</mi><mi id="S2.SS2.p7.1.m1.1.2.2.3" xref="S2.SS2.p7.1.m1.1.2.2.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p7.1.m1.1.2.1" xref="S2.SS2.p7.1.m1.1.2.1.cmml">â€‹</mo><mrow id="S2.SS2.p7.1.m1.1.2.3.2" xref="S2.SS2.p7.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p7.1.m1.1.2.3.2.1" xref="S2.SS2.p7.1.m1.1.2.cmml">(</mo><mi id="S2.SS2.p7.1.m1.1.1" xref="S2.SS2.p7.1.m1.1.1.cmml">i</mi><mo stretchy="false" id="S2.SS2.p7.1.m1.1.2.3.2.2" xref="S2.SS2.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.1.m1.1b"><apply id="S2.SS2.p7.1.m1.1.2.cmml" xref="S2.SS2.p7.1.m1.1.2"><times id="S2.SS2.p7.1.m1.1.2.1.cmml" xref="S2.SS2.p7.1.m1.1.2.1"></times><apply id="S2.SS2.p7.1.m1.1.2.2.cmml" xref="S2.SS2.p7.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p7.1.m1.1.2.2.1.cmml" xref="S2.SS2.p7.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.p7.1.m1.1.2.2.2.cmml" xref="S2.SS2.p7.1.m1.1.2.2.2">ğ—</ci><ci id="S2.SS2.p7.1.m1.1.2.2.3.cmml" xref="S2.SS2.p7.1.m1.1.2.2.3">ğ‘›</ci></apply><ci id="S2.SS2.p7.1.m1.1.1.cmml" xref="S2.SS2.p7.1.m1.1.1">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.1.m1.1c">\mathbf{X}_{n}(i)</annotation></semantics></math> is node feature of the <math id="S2.SS2.p7.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p7.2.m2.1a"><mi id="S2.SS2.p7.2.m2.1.1" xref="S2.SS2.p7.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.2.m2.1b"><ci id="S2.SS2.p7.2.m2.1.1.cmml" xref="S2.SS2.p7.2.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.2.m2.1c">i</annotation></semantics></math>-<span id="S2.SS2.p7.3.1" class="ltx_text ltx_font_italic">th</span> node of <math id="S2.SS2.p7.3.m3.1" class="ltx_Math" alttext="G_{n}" display="inline"><semantics id="S2.SS2.p7.3.m3.1a"><msub id="S2.SS2.p7.3.m3.1.1" xref="S2.SS2.p7.3.m3.1.1.cmml"><mi id="S2.SS2.p7.3.m3.1.1.2" xref="S2.SS2.p7.3.m3.1.1.2.cmml">G</mi><mi id="S2.SS2.p7.3.m3.1.1.3" xref="S2.SS2.p7.3.m3.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p7.3.m3.1b"><apply id="S2.SS2.p7.3.m3.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p7.3.m3.1.1.1.cmml" xref="S2.SS2.p7.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p7.3.m3.1.1.2.cmml" xref="S2.SS2.p7.3.m3.1.1.2">ğº</ci><ci id="S2.SS2.p7.3.m3.1.1.3.cmml" xref="S2.SS2.p7.3.m3.1.1.3">ğ‘›</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p7.3.m3.1c">G_{n}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p8" class="ltx_para ltx_noindent">
<p id="S2.SS2.p8.2" class="ltx_p"><span id="S2.SS2.p8.1.1" class="ltx_text ltx_font_bold">Describe [<math id="S2.SS2.p8.1.1.m1.2" class="ltx_Math" alttext="\mathbf{a},\mathbf{X}" display="inline"><semantics id="S2.SS2.p8.1.1.m1.2a"><mrow id="S2.SS2.p8.1.1.m1.2.3.2" xref="S2.SS2.p8.1.1.m1.2.3.1.cmml"><mi id="S2.SS2.p8.1.1.m1.1.1" xref="S2.SS2.p8.1.1.m1.1.1.cmml">ğš</mi><mo id="S2.SS2.p8.1.1.m1.2.3.2.1" xref="S2.SS2.p8.1.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS2.p8.1.1.m1.2.2" xref="S2.SS2.p8.1.1.m1.2.2.cmml">ğ—</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.1.1.m1.2b"><list id="S2.SS2.p8.1.1.m1.2.3.1.cmml" xref="S2.SS2.p8.1.1.m1.2.3.2"><ci id="S2.SS2.p8.1.1.m1.1.1.cmml" xref="S2.SS2.p8.1.1.m1.1.1">ğš</ci><ci id="S2.SS2.p8.1.1.m1.2.2.cmml" xref="S2.SS2.p8.1.1.m1.2.2">ğ—</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.1.1.m1.2c">\mathbf{a},\mathbf{X}</annotation></semantics></math>]</span>
aims to transform the attentive node features to an embedding that summarize the entire graph by computing a weighted sum of node features guided by the input attention, i.e. <math id="S2.SS2.p8.2.m1.1" class="ltx_Math" alttext="\mathbf{y}=\mathbf{X}^{T}\mathbf{a}" display="inline"><semantics id="S2.SS2.p8.2.m1.1a"><mrow id="S2.SS2.p8.2.m1.1.1" xref="S2.SS2.p8.2.m1.1.1.cmml"><mi id="S2.SS2.p8.2.m1.1.1.2" xref="S2.SS2.p8.2.m1.1.1.2.cmml">ğ²</mi><mo id="S2.SS2.p8.2.m1.1.1.1" xref="S2.SS2.p8.2.m1.1.1.1.cmml">=</mo><mrow id="S2.SS2.p8.2.m1.1.1.3" xref="S2.SS2.p8.2.m1.1.1.3.cmml"><msup id="S2.SS2.p8.2.m1.1.1.3.2" xref="S2.SS2.p8.2.m1.1.1.3.2.cmml"><mi id="S2.SS2.p8.2.m1.1.1.3.2.2" xref="S2.SS2.p8.2.m1.1.1.3.2.2.cmml">ğ—</mi><mi id="S2.SS2.p8.2.m1.1.1.3.2.3" xref="S2.SS2.p8.2.m1.1.1.3.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p8.2.m1.1.1.3.1" xref="S2.SS2.p8.2.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.SS2.p8.2.m1.1.1.3.3" xref="S2.SS2.p8.2.m1.1.1.3.3.cmml">ğš</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p8.2.m1.1b"><apply id="S2.SS2.p8.2.m1.1.1.cmml" xref="S2.SS2.p8.2.m1.1.1"><eq id="S2.SS2.p8.2.m1.1.1.1.cmml" xref="S2.SS2.p8.2.m1.1.1.1"></eq><ci id="S2.SS2.p8.2.m1.1.1.2.cmml" xref="S2.SS2.p8.2.m1.1.1.2">ğ²</ci><apply id="S2.SS2.p8.2.m1.1.1.3.cmml" xref="S2.SS2.p8.2.m1.1.1.3"><times id="S2.SS2.p8.2.m1.1.1.3.1.cmml" xref="S2.SS2.p8.2.m1.1.1.3.1"></times><apply id="S2.SS2.p8.2.m1.1.1.3.2.cmml" xref="S2.SS2.p8.2.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p8.2.m1.1.1.3.2.1.cmml" xref="S2.SS2.p8.2.m1.1.1.3.2">superscript</csymbol><ci id="S2.SS2.p8.2.m1.1.1.3.2.2.cmml" xref="S2.SS2.p8.2.m1.1.1.3.2.2">ğ—</ci><ci id="S2.SS2.p8.2.m1.1.1.3.2.3.cmml" xref="S2.SS2.p8.2.m1.1.1.3.2.3">ğ‘‡</ci></apply><ci id="S2.SS2.p8.2.m1.1.1.3.3.cmml" xref="S2.SS2.p8.2.m1.1.1.3.3">ğš</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p8.2.m1.1c">\mathbf{y}=\mathbf{X}^{T}\mathbf{a}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p9" class="ltx_para ltx_noindent">
<p id="S2.SS2.p9.2" class="ltx_p"><span id="S2.SS2.p9.2.1" class="ltx_text ltx_font_bold">NoOp [a]</span> just outputs the input <math id="S2.SS2.p9.1.m1.1" class="ltx_Math" alttext="\mathbf{a}" display="inline"><semantics id="S2.SS2.p9.1.m1.1a"><mi id="S2.SS2.p9.1.m1.1.1" xref="S2.SS2.p9.1.m1.1.1.cmml">ğš</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p9.1.m1.1b"><ci id="S2.SS2.p9.1.m1.1.1.cmml" xref="S2.SS2.p9.1.m1.1.1">ğš</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p9.1.m1.1c">\mathbf{a}</annotation></semantics></math> without transforming, which is used to pad reasoning steps to a maximum length <math id="S2.SS2.p9.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p9.2.m2.1a"><mi id="S2.SS2.p9.2.m2.1.1" xref="S2.SS2.p9.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p9.2.m2.1b"><ci id="S2.SS2.p9.2.m2.1.1.cmml" xref="S2.SS2.p9.2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p9.2.m2.1c">T</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Module Controller</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">To make the network fully differentiable, we draw inspire from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> to propose a module controller to make soft layout selection via a soft module weights distribution and supplies input query at each reasoning step <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">t</annotation></semantics></math>.
Then we execute all modules of each graph and average the outputs according to the module weights as the input for the next step.
We take one of the graphs as an example to describe the procedure in detail below.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.5" class="ltx_p">Specifically, we first encode the question by LSTM to get all word embeddings <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\{\mathbf{h}_{l}\}_{l=1}^{L}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><msubsup id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mrow id="S2.SS3.p2.1.m1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S2.SS3.p2.1.m1.1.1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.1.1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.2.cmml">ğ¡</mi><mi id="S2.SS3.p2.1.m1.1.1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS3.p2.1.m1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.1.3.cmml"><mi id="S2.SS3.p2.1.m1.1.1.1.3.2" xref="S2.SS3.p2.1.m1.1.1.1.3.2.cmml">l</mi><mo id="S2.SS3.p2.1.m1.1.1.1.3.1" xref="S2.SS3.p2.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S2.SS3.p2.1.m1.1.1.1.3.3" xref="S2.SS3.p2.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><set id="S2.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1"><apply id="S2.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.2">ğ¡</ci><ci id="S2.SS3.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1.1.1.3">ğ‘™</ci></apply></set><apply id="S2.SS3.p2.1.m1.1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3"><eq id="S2.SS3.p2.1.m1.1.1.1.3.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3.1"></eq><ci id="S2.SS3.p2.1.m1.1.1.1.3.2.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3.2">ğ‘™</ci><cn type="integer" id="S2.SS3.p2.1.m1.1.1.1.3.3.cmml" xref="S2.SS3.p2.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">ğ¿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\{\mathbf{h}_{l}\}_{l=1}^{L}</annotation></semantics></math> and question embedding <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{q}" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">ğª</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">ğª</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">\mathbf{q}</annotation></semantics></math>.
At each time-step <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><mi id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><ci id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">ğ‘¡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">t</annotation></semantics></math>, we generate intermediate embedding <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><mi id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">ğ®</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">ğ®</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">\mathbf{u}</annotation></semantics></math> based on question embedding and input query of previous step, i.e <math id="S2.SS3.p2.5.m5.2" class="ltx_Math" alttext="\mathbf{u}=f_{mlp}([\mathbf{q};\mathbf{c}_{t-1}])" display="inline"><semantics id="S2.SS3.p2.5.m5.2a"><mrow id="S2.SS3.p2.5.m5.2.2" xref="S2.SS3.p2.5.m5.2.2.cmml"><mi id="S2.SS3.p2.5.m5.2.2.3" xref="S2.SS3.p2.5.m5.2.2.3.cmml">ğ®</mi><mo id="S2.SS3.p2.5.m5.2.2.2" xref="S2.SS3.p2.5.m5.2.2.2.cmml">=</mo><mrow id="S2.SS3.p2.5.m5.2.2.1" xref="S2.SS3.p2.5.m5.2.2.1.cmml"><msub id="S2.SS3.p2.5.m5.2.2.1.3" xref="S2.SS3.p2.5.m5.2.2.1.3.cmml"><mi id="S2.SS3.p2.5.m5.2.2.1.3.2" xref="S2.SS3.p2.5.m5.2.2.1.3.2.cmml">f</mi><mrow id="S2.SS3.p2.5.m5.2.2.1.3.3" xref="S2.SS3.p2.5.m5.2.2.1.3.3.cmml"><mi id="S2.SS3.p2.5.m5.2.2.1.3.3.2" xref="S2.SS3.p2.5.m5.2.2.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.5.m5.2.2.1.3.3.1" xref="S2.SS3.p2.5.m5.2.2.1.3.3.1.cmml">â€‹</mo><mi id="S2.SS3.p2.5.m5.2.2.1.3.3.3" xref="S2.SS3.p2.5.m5.2.2.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.5.m5.2.2.1.3.3.1a" xref="S2.SS3.p2.5.m5.2.2.1.3.3.1.cmml">â€‹</mo><mi id="S2.SS3.p2.5.m5.2.2.1.3.3.4" xref="S2.SS3.p2.5.m5.2.2.1.3.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p2.5.m5.2.2.1.2" xref="S2.SS3.p2.5.m5.2.2.1.2.cmml">â€‹</mo><mrow id="S2.SS3.p2.5.m5.2.2.1.1.1" xref="S2.SS3.p2.5.m5.2.2.1.cmml"><mo stretchy="false" id="S2.SS3.p2.5.m5.2.2.1.1.1.2" xref="S2.SS3.p2.5.m5.2.2.1.cmml">(</mo><mrow id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.2" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.2.cmml">[</mo><mi id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">ğª</mi><mo id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.3" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.2.cmml">;</mo><msub id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.cmml">ğœ</mi><mrow id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.1" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.1.cmml">âˆ’</mo><mn id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.4" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.2.cmml">]</mo></mrow><mo stretchy="false" id="S2.SS3.p2.5.m5.2.2.1.1.1.3" xref="S2.SS3.p2.5.m5.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.2b"><apply id="S2.SS3.p2.5.m5.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2"><eq id="S2.SS3.p2.5.m5.2.2.2.cmml" xref="S2.SS3.p2.5.m5.2.2.2"></eq><ci id="S2.SS3.p2.5.m5.2.2.3.cmml" xref="S2.SS3.p2.5.m5.2.2.3">ğ®</ci><apply id="S2.SS3.p2.5.m5.2.2.1.cmml" xref="S2.SS3.p2.5.m5.2.2.1"><times id="S2.SS3.p2.5.m5.2.2.1.2.cmml" xref="S2.SS3.p2.5.m5.2.2.1.2"></times><apply id="S2.SS3.p2.5.m5.2.2.1.3.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.2.2.1.3.1.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3">subscript</csymbol><ci id="S2.SS3.p2.5.m5.2.2.1.3.2.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3.2">ğ‘“</ci><apply id="S2.SS3.p2.5.m5.2.2.1.3.3.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3.3"><times id="S2.SS3.p2.5.m5.2.2.1.3.3.1.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3.3.1"></times><ci id="S2.SS3.p2.5.m5.2.2.1.3.3.2.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3.3.2">ğ‘š</ci><ci id="S2.SS3.p2.5.m5.2.2.1.3.3.3.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3.3.3">ğ‘™</ci><ci id="S2.SS3.p2.5.m5.2.2.1.3.3.4.cmml" xref="S2.SS3.p2.5.m5.2.2.1.3.3.4">ğ‘</ci></apply></apply><list id="S2.SS3.p2.5.m5.2.2.1.1.1.1.2.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1"><ci id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">ğª</ci><apply id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.2">ğœ</ci><apply id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3"><minus id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.1"></minus><ci id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.2">ğ‘¡</ci><cn type="integer" id="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.SS3.p2.5.m5.2.2.1.1.1.1.1.1.3.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.2c">\mathbf{u}=f_{mlp}([\mathbf{q};\mathbf{c}_{t-1}])</annotation></semantics></math>.
The input query should include question information that is more relevant to the current reasoning step.
Therefore we generate input query by textual attention over words guided by intermediate embedding:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\alpha_{l}=\text{softmax}(f_{mlp}(\mathbf{u}\odot\mathbf{h}_{l}))" display="block"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml"><msub id="S2.E5.m1.1.1.3" xref="S2.E5.m1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.3.2" xref="S2.E5.m1.1.1.3.2.cmml">Î±</mi><mi id="S2.E5.m1.1.1.3.3" xref="S2.E5.m1.1.1.3.3.cmml">l</mi></msub><mo id="S2.E5.m1.1.1.2" xref="S2.E5.m1.1.1.2.cmml">=</mo><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mtext id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E5.m1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.3.3.2" xref="S2.E5.m1.1.1.1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.1.3.3.1" xref="S2.E5.m1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E5.m1.1.1.1.1.1.1.3.3.3" xref="S2.E5.m1.1.1.1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.1.3.3.1a" xref="S2.E5.m1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E5.m1.1.1.1.1.1.1.3.3.4" xref="S2.E5.m1.1.1.1.1.1.1.3.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">ğ®</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml">âŠ™</mo><msub id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">ğ¡</mi><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">l</mi></msub></mrow><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1"><eq id="S2.E5.m1.1.1.2.cmml" xref="S2.E5.m1.1.1.2"></eq><apply id="S2.E5.m1.1.1.3.cmml" xref="S2.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.3.2">ğ›¼</ci><ci id="S2.E5.m1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.3.3">ğ‘™</ci></apply><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><times id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.3a.cmml" xref="S2.E5.m1.1.1.1.3"><mtext id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3">softmax</mtext></ci><apply id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2"></times><apply id="S2.E5.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.2">ğ‘“</ci><apply id="S2.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3"><times id="S2.E5.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E5.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3.2">ğ‘š</ci><ci id="S2.E5.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3.3">ğ‘™</ci><ci id="S2.E5.m1.1.1.1.1.1.1.3.3.4.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3.4">ğ‘</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.1">direct-product</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.2">ğ®</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.2">ğ¡</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.3.3">ğ‘™</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\alpha_{l}=\text{softmax}(f_{mlp}(\mathbf{u}\odot\mathbf{h}_{l}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\mathbf{c}_{t}=\sum_{l=1}^{L}\alpha_{l}\cdot\mathbf{h}_{l}," display="block"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><msub id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml"><mi id="S2.E6.m1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.2.2.cmml">ğœ</mi><mi id="S2.E6.m1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.2.3.cmml">t</mi></msub><mo rspace="0.111em" id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml"><munderover id="S2.E6.m1.1.1.1.1.3.1" xref="S2.E6.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E6.m1.1.1.1.1.3.1.2.2" xref="S2.E6.m1.1.1.1.1.3.1.2.2.cmml">âˆ‘</mo><mrow id="S2.E6.m1.1.1.1.1.3.1.2.3" xref="S2.E6.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S2.E6.m1.1.1.1.1.3.1.2.3.2" xref="S2.E6.m1.1.1.1.1.3.1.2.3.2.cmml">l</mi><mo id="S2.E6.m1.1.1.1.1.3.1.2.3.1" xref="S2.E6.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E6.m1.1.1.1.1.3.1.2.3.3" xref="S2.E6.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.1.1.1.1.3.1.3" xref="S2.E6.m1.1.1.1.1.3.1.3.cmml">L</mi></munderover><mrow id="S2.E6.m1.1.1.1.1.3.2" xref="S2.E6.m1.1.1.1.1.3.2.cmml"><msub id="S2.E6.m1.1.1.1.1.3.2.2" xref="S2.E6.m1.1.1.1.1.3.2.2.cmml"><mi id="S2.E6.m1.1.1.1.1.3.2.2.2" xref="S2.E6.m1.1.1.1.1.3.2.2.2.cmml">Î±</mi><mi id="S2.E6.m1.1.1.1.1.3.2.2.3" xref="S2.E6.m1.1.1.1.1.3.2.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E6.m1.1.1.1.1.3.2.1" xref="S2.E6.m1.1.1.1.1.3.2.1.cmml">â‹…</mo><msub id="S2.E6.m1.1.1.1.1.3.2.3" xref="S2.E6.m1.1.1.1.1.3.2.3.cmml"><mi id="S2.E6.m1.1.1.1.1.3.2.3.2" xref="S2.E6.m1.1.1.1.1.3.2.3.2.cmml">ğ¡</mi><mi id="S2.E6.m1.1.1.1.1.3.2.3.3" xref="S2.E6.m1.1.1.1.1.3.2.3.3.cmml">l</mi></msub></mrow></mrow></mrow><mo id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><eq id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"></eq><apply id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2">ğœ</ci><ci id="S2.E6.m1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.3">ğ‘¡</ci></apply><apply id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3"><apply id="S2.E6.m1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.1.1.cmml" xref="S2.E6.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S2.E6.m1.1.1.1.1.3.1.2.cmml" xref="S2.E6.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E6.m1.1.1.1.1.3.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.1.2.2"></sum><apply id="S2.E6.m1.1.1.1.1.3.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.3.1.2.3"><eq id="S2.E6.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S2.E6.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.1.2.3.2">ğ‘™</ci><cn type="integer" id="S2.E6.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E6.m1.1.1.1.1.3.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3.1.3">ğ¿</ci></apply><apply id="S2.E6.m1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2"><ci id="S2.E6.m1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.2.1">â‹…</ci><apply id="S2.E6.m1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2.2.2">ğ›¼</ci><ci id="S2.E6.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E6.m1.1.1.1.1.3.2.2.3">ğ‘™</ci></apply><apply id="S2.E6.m1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.2.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.2.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2.3.2">ğ¡</ci><ci id="S2.E6.m1.1.1.1.1.3.2.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.2.3.3">ğ‘™</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\mathbf{c}_{t}=\sum_{l=1}^{L}\alpha_{l}\cdot\mathbf{h}_{l},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.6" class="ltx_p">where <math id="S2.SS3.p2.6.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S2.SS3.p2.6.m1.1a"><mo id="S2.SS3.p2.6.m1.1.1" xref="S2.SS3.p2.6.m1.1.1.cmml">âŠ™</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m1.1b"><csymbol cd="latexml" id="S2.SS3.p2.6.m1.1.1.cmml" xref="S2.SS3.p2.6.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m1.1c">\odot</annotation></semantics></math> is element-wise multiplication.
To select which module is more important at the current step, we predict soft module weights which resemble a probability distribution over all the modules using MLP:</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.3" class="ltx_Math" alttext="\mathbf{w}^{(t)}=\text{softmax}(f_{mlp}(\mathbf{u}))" display="block"><semantics id="S2.E7.m1.3a"><mrow id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml"><msup id="S2.E7.m1.3.3.3" xref="S2.E7.m1.3.3.3.cmml"><mi id="S2.E7.m1.3.3.3.2" xref="S2.E7.m1.3.3.3.2.cmml">ğ°</mi><mrow id="S2.E7.m1.1.1.1.3" xref="S2.E7.m1.3.3.3.cmml"><mo stretchy="false" id="S2.E7.m1.1.1.1.3.1" xref="S2.E7.m1.3.3.3.cmml">(</mo><mi id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.E7.m1.1.1.1.3.2" xref="S2.E7.m1.3.3.3.cmml">)</mo></mrow></msup><mo id="S2.E7.m1.3.3.2" xref="S2.E7.m1.3.3.2.cmml">=</mo><mrow id="S2.E7.m1.3.3.1" xref="S2.E7.m1.3.3.1.cmml"><mtext id="S2.E7.m1.3.3.1.3" xref="S2.E7.m1.3.3.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S2.E7.m1.3.3.1.2" xref="S2.E7.m1.3.3.1.2.cmml">â€‹</mo><mrow id="S2.E7.m1.3.3.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.3.3.1.1.1.2" xref="S2.E7.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.3.3.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.cmml"><msub id="S2.E7.m1.3.3.1.1.1.1.2" xref="S2.E7.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E7.m1.3.3.1.1.1.1.2.2" xref="S2.E7.m1.3.3.1.1.1.1.2.2.cmml">f</mi><mrow id="S2.E7.m1.3.3.1.1.1.1.2.3" xref="S2.E7.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S2.E7.m1.3.3.1.1.1.1.2.3.2" xref="S2.E7.m1.3.3.1.1.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.3.3.1.1.1.1.2.3.1" xref="S2.E7.m1.3.3.1.1.1.1.2.3.1.cmml">â€‹</mo><mi id="S2.E7.m1.3.3.1.1.1.1.2.3.3" xref="S2.E7.m1.3.3.1.1.1.1.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.3.3.1.1.1.1.2.3.1a" xref="S2.E7.m1.3.3.1.1.1.1.2.3.1.cmml">â€‹</mo><mi id="S2.E7.m1.3.3.1.1.1.1.2.3.4" xref="S2.E7.m1.3.3.1.1.1.1.2.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E7.m1.3.3.1.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.1.cmml">â€‹</mo><mrow id="S2.E7.m1.3.3.1.1.1.1.3.2" xref="S2.E7.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.3.3.1.1.1.1.3.2.1" xref="S2.E7.m1.3.3.1.1.1.1.cmml">(</mo><mi id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml">ğ®</mi><mo stretchy="false" id="S2.E7.m1.3.3.1.1.1.1.3.2.2" xref="S2.E7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E7.m1.3.3.1.1.1.3" xref="S2.E7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.3b"><apply id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.3.3"><eq id="S2.E7.m1.3.3.2.cmml" xref="S2.E7.m1.3.3.2"></eq><apply id="S2.E7.m1.3.3.3.cmml" xref="S2.E7.m1.3.3.3"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.3.1.cmml" xref="S2.E7.m1.3.3.3">superscript</csymbol><ci id="S2.E7.m1.3.3.3.2.cmml" xref="S2.E7.m1.3.3.3.2">ğ°</ci><ci id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">ğ‘¡</ci></apply><apply id="S2.E7.m1.3.3.1.cmml" xref="S2.E7.m1.3.3.1"><times id="S2.E7.m1.3.3.1.2.cmml" xref="S2.E7.m1.3.3.1.2"></times><ci id="S2.E7.m1.3.3.1.3a.cmml" xref="S2.E7.m1.3.3.1.3"><mtext id="S2.E7.m1.3.3.1.3.cmml" xref="S2.E7.m1.3.3.1.3">softmax</mtext></ci><apply id="S2.E7.m1.3.3.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1"><times id="S2.E7.m1.3.3.1.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.1"></times><apply id="S2.E7.m1.3.3.1.1.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.2">ğ‘“</ci><apply id="S2.E7.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.3"><times id="S2.E7.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.3.1"></times><ci id="S2.E7.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.3.2">ğ‘š</ci><ci id="S2.E7.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.3.3">ğ‘™</ci><ci id="S2.E7.m1.3.3.1.1.1.1.2.3.4.cmml" xref="S2.E7.m1.3.3.1.1.1.1.2.3.4">ğ‘</ci></apply></apply><ci id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2">ğ®</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.3c">\mathbf{w}^{(t)}=\text{softmax}(f_{mlp}(\mathbf{u}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.11" class="ltx_p">We execute all the modules and perform a weighted average of their outputs with respect to the module weights:</p>
<table id="S2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1.4" class="ltx_Math" alttext="\mathbf{a}^{(t)}=\sum_{m\in M}w_{m}^{(t)}\cdot\mathbf{a}^{(t)}_{m}," display="block"><semantics id="S2.E8.m1.4a"><mrow id="S2.E8.m1.4.4.1" xref="S2.E8.m1.4.4.1.1.cmml"><mrow id="S2.E8.m1.4.4.1.1" xref="S2.E8.m1.4.4.1.1.cmml"><msup id="S2.E8.m1.4.4.1.1.2" xref="S2.E8.m1.4.4.1.1.2.cmml"><mi id="S2.E8.m1.4.4.1.1.2.2" xref="S2.E8.m1.4.4.1.1.2.2.cmml">ğš</mi><mrow id="S2.E8.m1.1.1.1.3" xref="S2.E8.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S2.E8.m1.1.1.1.3.1" xref="S2.E8.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.E8.m1.1.1.1.3.2" xref="S2.E8.m1.4.4.1.1.2.cmml">)</mo></mrow></msup><mo rspace="0.111em" id="S2.E8.m1.4.4.1.1.1" xref="S2.E8.m1.4.4.1.1.1.cmml">=</mo><mrow id="S2.E8.m1.4.4.1.1.3" xref="S2.E8.m1.4.4.1.1.3.cmml"><munder id="S2.E8.m1.4.4.1.1.3.1" xref="S2.E8.m1.4.4.1.1.3.1.cmml"><mo movablelimits="false" id="S2.E8.m1.4.4.1.1.3.1.2" xref="S2.E8.m1.4.4.1.1.3.1.2.cmml">âˆ‘</mo><mrow id="S2.E8.m1.4.4.1.1.3.1.3" xref="S2.E8.m1.4.4.1.1.3.1.3.cmml"><mi id="S2.E8.m1.4.4.1.1.3.1.3.2" xref="S2.E8.m1.4.4.1.1.3.1.3.2.cmml">m</mi><mo id="S2.E8.m1.4.4.1.1.3.1.3.1" xref="S2.E8.m1.4.4.1.1.3.1.3.1.cmml">âˆˆ</mo><mi id="S2.E8.m1.4.4.1.1.3.1.3.3" xref="S2.E8.m1.4.4.1.1.3.1.3.3.cmml">M</mi></mrow></munder><mrow id="S2.E8.m1.4.4.1.1.3.2" xref="S2.E8.m1.4.4.1.1.3.2.cmml"><msubsup id="S2.E8.m1.4.4.1.1.3.2.2" xref="S2.E8.m1.4.4.1.1.3.2.2.cmml"><mi id="S2.E8.m1.4.4.1.1.3.2.2.2.2" xref="S2.E8.m1.4.4.1.1.3.2.2.2.2.cmml">w</mi><mi id="S2.E8.m1.4.4.1.1.3.2.2.2.3" xref="S2.E8.m1.4.4.1.1.3.2.2.2.3.cmml">m</mi><mrow id="S2.E8.m1.2.2.1.3" xref="S2.E8.m1.4.4.1.1.3.2.2.cmml"><mo stretchy="false" id="S2.E8.m1.2.2.1.3.1" xref="S2.E8.m1.4.4.1.1.3.2.2.cmml">(</mo><mi id="S2.E8.m1.2.2.1.1" xref="S2.E8.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S2.E8.m1.2.2.1.3.2" xref="S2.E8.m1.4.4.1.1.3.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0.222em" rspace="0.222em" id="S2.E8.m1.4.4.1.1.3.2.1" xref="S2.E8.m1.4.4.1.1.3.2.1.cmml">â‹…</mo><msubsup id="S2.E8.m1.4.4.1.1.3.2.3" xref="S2.E8.m1.4.4.1.1.3.2.3.cmml"><mi id="S2.E8.m1.4.4.1.1.3.2.3.2.2" xref="S2.E8.m1.4.4.1.1.3.2.3.2.2.cmml">ğš</mi><mi id="S2.E8.m1.4.4.1.1.3.2.3.3" xref="S2.E8.m1.4.4.1.1.3.2.3.3.cmml">m</mi><mrow id="S2.E8.m1.3.3.1.3" xref="S2.E8.m1.4.4.1.1.3.2.3.cmml"><mo stretchy="false" id="S2.E8.m1.3.3.1.3.1" xref="S2.E8.m1.4.4.1.1.3.2.3.cmml">(</mo><mi id="S2.E8.m1.3.3.1.1" xref="S2.E8.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S2.E8.m1.3.3.1.3.2" xref="S2.E8.m1.4.4.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo id="S2.E8.m1.4.4.1.2" xref="S2.E8.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.4b"><apply id="S2.E8.m1.4.4.1.1.cmml" xref="S2.E8.m1.4.4.1"><eq id="S2.E8.m1.4.4.1.1.1.cmml" xref="S2.E8.m1.4.4.1.1.1"></eq><apply id="S2.E8.m1.4.4.1.1.2.cmml" xref="S2.E8.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.2.1.cmml" xref="S2.E8.m1.4.4.1.1.2">superscript</csymbol><ci id="S2.E8.m1.4.4.1.1.2.2.cmml" xref="S2.E8.m1.4.4.1.1.2.2">ğš</ci><ci id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1">ğ‘¡</ci></apply><apply id="S2.E8.m1.4.4.1.1.3.cmml" xref="S2.E8.m1.4.4.1.1.3"><apply id="S2.E8.m1.4.4.1.1.3.1.cmml" xref="S2.E8.m1.4.4.1.1.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.3.1.1.cmml" xref="S2.E8.m1.4.4.1.1.3.1">subscript</csymbol><sum id="S2.E8.m1.4.4.1.1.3.1.2.cmml" xref="S2.E8.m1.4.4.1.1.3.1.2"></sum><apply id="S2.E8.m1.4.4.1.1.3.1.3.cmml" xref="S2.E8.m1.4.4.1.1.3.1.3"><in id="S2.E8.m1.4.4.1.1.3.1.3.1.cmml" xref="S2.E8.m1.4.4.1.1.3.1.3.1"></in><ci id="S2.E8.m1.4.4.1.1.3.1.3.2.cmml" xref="S2.E8.m1.4.4.1.1.3.1.3.2">ğ‘š</ci><ci id="S2.E8.m1.4.4.1.1.3.1.3.3.cmml" xref="S2.E8.m1.4.4.1.1.3.1.3.3">ğ‘€</ci></apply></apply><apply id="S2.E8.m1.4.4.1.1.3.2.cmml" xref="S2.E8.m1.4.4.1.1.3.2"><ci id="S2.E8.m1.4.4.1.1.3.2.1.cmml" xref="S2.E8.m1.4.4.1.1.3.2.1">â‹…</ci><apply id="S2.E8.m1.4.4.1.1.3.2.2.cmml" xref="S2.E8.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.3.2.2.1.cmml" xref="S2.E8.m1.4.4.1.1.3.2.2">superscript</csymbol><apply id="S2.E8.m1.4.4.1.1.3.2.2.2.cmml" xref="S2.E8.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.3.2.2.2.1.cmml" xref="S2.E8.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S2.E8.m1.4.4.1.1.3.2.2.2.2.cmml" xref="S2.E8.m1.4.4.1.1.3.2.2.2.2">ğ‘¤</ci><ci id="S2.E8.m1.4.4.1.1.3.2.2.2.3.cmml" xref="S2.E8.m1.4.4.1.1.3.2.2.2.3">ğ‘š</ci></apply><ci id="S2.E8.m1.2.2.1.1.cmml" xref="S2.E8.m1.2.2.1.1">ğ‘¡</ci></apply><apply id="S2.E8.m1.4.4.1.1.3.2.3.cmml" xref="S2.E8.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.3.2.3.1.cmml" xref="S2.E8.m1.4.4.1.1.3.2.3">subscript</csymbol><apply id="S2.E8.m1.4.4.1.1.3.2.3.2.cmml" xref="S2.E8.m1.4.4.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.3.2.3.2.1.cmml" xref="S2.E8.m1.4.4.1.1.3.2.3">superscript</csymbol><ci id="S2.E8.m1.4.4.1.1.3.2.3.2.2.cmml" xref="S2.E8.m1.4.4.1.1.3.2.3.2.2">ğš</ci><ci id="S2.E8.m1.3.3.1.1.cmml" xref="S2.E8.m1.3.3.1.1">ğ‘¡</ci></apply><ci id="S2.E8.m1.4.4.1.1.3.2.3.3.cmml" xref="S2.E8.m1.4.4.1.1.3.2.3.3">ğ‘š</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.4c">\mathbf{a}^{(t)}=\sum_{m\in M}w_{m}^{(t)}\cdot\mathbf{a}^{(t)}_{m},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.10" class="ltx_p">where <math id="S2.SS3.p2.7.m1.2" class="ltx_Math" alttext="w_{m}^{(t)}\in\mathbf{w}^{(t)}" display="inline"><semantics id="S2.SS3.p2.7.m1.2a"><mrow id="S2.SS3.p2.7.m1.2.3" xref="S2.SS3.p2.7.m1.2.3.cmml"><msubsup id="S2.SS3.p2.7.m1.2.3.2" xref="S2.SS3.p2.7.m1.2.3.2.cmml"><mi id="S2.SS3.p2.7.m1.2.3.2.2.2" xref="S2.SS3.p2.7.m1.2.3.2.2.2.cmml">w</mi><mi id="S2.SS3.p2.7.m1.2.3.2.2.3" xref="S2.SS3.p2.7.m1.2.3.2.2.3.cmml">m</mi><mrow id="S2.SS3.p2.7.m1.1.1.1.3" xref="S2.SS3.p2.7.m1.2.3.2.cmml"><mo stretchy="false" id="S2.SS3.p2.7.m1.1.1.1.3.1" xref="S2.SS3.p2.7.m1.2.3.2.cmml">(</mo><mi id="S2.SS3.p2.7.m1.1.1.1.1" xref="S2.SS3.p2.7.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.SS3.p2.7.m1.1.1.1.3.2" xref="S2.SS3.p2.7.m1.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS3.p2.7.m1.2.3.1" xref="S2.SS3.p2.7.m1.2.3.1.cmml">âˆˆ</mo><msup id="S2.SS3.p2.7.m1.2.3.3" xref="S2.SS3.p2.7.m1.2.3.3.cmml"><mi id="S2.SS3.p2.7.m1.2.3.3.2" xref="S2.SS3.p2.7.m1.2.3.3.2.cmml">ğ°</mi><mrow id="S2.SS3.p2.7.m1.2.2.1.3" xref="S2.SS3.p2.7.m1.2.3.3.cmml"><mo stretchy="false" id="S2.SS3.p2.7.m1.2.2.1.3.1" xref="S2.SS3.p2.7.m1.2.3.3.cmml">(</mo><mi id="S2.SS3.p2.7.m1.2.2.1.1" xref="S2.SS3.p2.7.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S2.SS3.p2.7.m1.2.2.1.3.2" xref="S2.SS3.p2.7.m1.2.3.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m1.2b"><apply id="S2.SS3.p2.7.m1.2.3.cmml" xref="S2.SS3.p2.7.m1.2.3"><in id="S2.SS3.p2.7.m1.2.3.1.cmml" xref="S2.SS3.p2.7.m1.2.3.1"></in><apply id="S2.SS3.p2.7.m1.2.3.2.cmml" xref="S2.SS3.p2.7.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m1.2.3.2.1.cmml" xref="S2.SS3.p2.7.m1.2.3.2">superscript</csymbol><apply id="S2.SS3.p2.7.m1.2.3.2.2.cmml" xref="S2.SS3.p2.7.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m1.2.3.2.2.1.cmml" xref="S2.SS3.p2.7.m1.2.3.2">subscript</csymbol><ci id="S2.SS3.p2.7.m1.2.3.2.2.2.cmml" xref="S2.SS3.p2.7.m1.2.3.2.2.2">ğ‘¤</ci><ci id="S2.SS3.p2.7.m1.2.3.2.2.3.cmml" xref="S2.SS3.p2.7.m1.2.3.2.2.3">ğ‘š</ci></apply><ci id="S2.SS3.p2.7.m1.1.1.1.1.cmml" xref="S2.SS3.p2.7.m1.1.1.1.1">ğ‘¡</ci></apply><apply id="S2.SS3.p2.7.m1.2.3.3.cmml" xref="S2.SS3.p2.7.m1.2.3.3"><csymbol cd="ambiguous" id="S2.SS3.p2.7.m1.2.3.3.1.cmml" xref="S2.SS3.p2.7.m1.2.3.3">superscript</csymbol><ci id="S2.SS3.p2.7.m1.2.3.3.2.cmml" xref="S2.SS3.p2.7.m1.2.3.3.2">ğ°</ci><ci id="S2.SS3.p2.7.m1.2.2.1.1.cmml" xref="S2.SS3.p2.7.m1.2.2.1.1">ğ‘¡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m1.2c">w_{m}^{(t)}\in\mathbf{w}^{(t)}</annotation></semantics></math>, <math id="S2.SS3.p2.8.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS3.p2.8.m2.1a"><mi id="S2.SS3.p2.8.m2.1.1" xref="S2.SS3.p2.8.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m2.1b"><ci id="S2.SS3.p2.8.m2.1.1.cmml" xref="S2.SS3.p2.8.m2.1.1">ğ‘€</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m2.1c">M</annotation></semantics></math> is module list of each graph and <math id="S2.SS3.p2.9.m3.1" class="ltx_Math" alttext="\mathbf{a}^{(t)}_{m}" display="inline"><semantics id="S2.SS3.p2.9.m3.1a"><msubsup id="S2.SS3.p2.9.m3.1.2" xref="S2.SS3.p2.9.m3.1.2.cmml"><mi id="S2.SS3.p2.9.m3.1.2.2.2" xref="S2.SS3.p2.9.m3.1.2.2.2.cmml">ğš</mi><mi id="S2.SS3.p2.9.m3.1.2.3" xref="S2.SS3.p2.9.m3.1.2.3.cmml">m</mi><mrow id="S2.SS3.p2.9.m3.1.1.1.3" xref="S2.SS3.p2.9.m3.1.2.cmml"><mo stretchy="false" id="S2.SS3.p2.9.m3.1.1.1.3.1" xref="S2.SS3.p2.9.m3.1.2.cmml">(</mo><mi id="S2.SS3.p2.9.m3.1.1.1.1" xref="S2.SS3.p2.9.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.SS3.p2.9.m3.1.1.1.3.2" xref="S2.SS3.p2.9.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.9.m3.1b"><apply id="S2.SS3.p2.9.m3.1.2.cmml" xref="S2.SS3.p2.9.m3.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m3.1.2.1.cmml" xref="S2.SS3.p2.9.m3.1.2">subscript</csymbol><apply id="S2.SS3.p2.9.m3.1.2.2.cmml" xref="S2.SS3.p2.9.m3.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m3.1.2.2.1.cmml" xref="S2.SS3.p2.9.m3.1.2">superscript</csymbol><ci id="S2.SS3.p2.9.m3.1.2.2.2.cmml" xref="S2.SS3.p2.9.m3.1.2.2.2">ğš</ci><ci id="S2.SS3.p2.9.m3.1.1.1.1.cmml" xref="S2.SS3.p2.9.m3.1.1.1.1">ğ‘¡</ci></apply><ci id="S2.SS3.p2.9.m3.1.2.3.cmml" xref="S2.SS3.p2.9.m3.1.2.3">ğ‘š</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.9.m3.1c">\mathbf{a}^{(t)}_{m}</annotation></semantics></math> is the output attention map of <math id="S2.SS3.p2.10.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.p2.10.m4.1a"><mi id="S2.SS3.p2.10.m4.1.1" xref="S2.SS3.p2.10.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.10.m4.1b"><ci id="S2.SS3.p2.10.m4.1.1.cmml" xref="S2.SS3.p2.10.m4.1.1">ğ‘š</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.10.m4.1c">m</annotation></semantics></math>-<span id="S2.SS3.p2.10.1" class="ltx_text ltx_font_italic">th</span> module.
At the final step, we extract graph features from <span id="S2.SS3.p2.10.2" class="ltx_text ltx_font_typewriter">Describe</span> modules of different graphs and fuse them to predict the answer using MLP:</p>
<table id="S2.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E9.m1.1" class="ltx_Math" alttext="Ans=f_{mlp}([W_{8}\mathbf{y}_{G_{1}},W_{9}\mathbf{y}_{G_{2}},W_{10}\mathbf{y}_{G_{3}},W_{11}\mathbf{q}])" display="block"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1" xref="S2.E9.m1.1.1.cmml"><mrow id="S2.E9.m1.1.1.3" xref="S2.E9.m1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.3.2" xref="S2.E9.m1.1.1.3.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.3.1" xref="S2.E9.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.E9.m1.1.1.3.3" xref="S2.E9.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.3.1a" xref="S2.E9.m1.1.1.3.1.cmml">â€‹</mo><mi id="S2.E9.m1.1.1.3.4" xref="S2.E9.m1.1.1.3.4.cmml">s</mi></mrow><mo id="S2.E9.m1.1.1.2" xref="S2.E9.m1.1.1.2.cmml">=</mo><mrow id="S2.E9.m1.1.1.1" xref="S2.E9.m1.1.1.1.cmml"><msub id="S2.E9.m1.1.1.1.3" xref="S2.E9.m1.1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.3.2.cmml">f</mi><mrow id="S2.E9.m1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.3.3.cmml"><mi id="S2.E9.m1.1.1.1.3.3.2" xref="S2.E9.m1.1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.3.3.1" xref="S2.E9.m1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E9.m1.1.1.1.3.3.3" xref="S2.E9.m1.1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.3.3.1a" xref="S2.E9.m1.1.1.1.3.3.1.cmml">â€‹</mo><mi id="S2.E9.m1.1.1.1.3.3.4" xref="S2.E9.m1.1.1.1.3.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.2" xref="S2.E9.m1.1.1.1.2.cmml">â€‹</mo><mrow id="S2.E9.m1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.cmml"><mo stretchy="false" id="S2.E9.m1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.1.1.1.1.1.1.4" xref="S2.E9.m1.1.1.1.1.1.1.5.cmml"><mo stretchy="false" id="S2.E9.m1.1.1.1.1.1.1.4.5" xref="S2.E9.m1.1.1.1.1.1.1.5.cmml">[</mo><mrow id="S2.E9.m1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mn id="S2.E9.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml">8</mn></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml">â€‹</mo><msub id="S2.E9.m1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml">ğ²</mi><msub id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">G</mi><mn id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></msub></msub></mrow><mo id="S2.E9.m1.1.1.1.1.1.1.4.6" xref="S2.E9.m1.1.1.1.1.1.1.5.cmml">,</mo><mrow id="S2.E9.m1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.1.1.1.1.1.1.2.2.cmml"><msub id="S2.E9.m1.1.1.1.1.1.1.2.2.2" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mn id="S2.E9.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2.3.cmml">9</mn></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.1.1.1.2.2.1" xref="S2.E9.m1.1.1.1.1.1.1.2.2.1.cmml">â€‹</mo><msub id="S2.E9.m1.1.1.1.1.1.1.2.2.3" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.2.2.3.2" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.2.cmml">ğ²</mi><msub id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.2" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.2.cmml">G</mi><mn id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.3" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S2.E9.m1.1.1.1.1.1.1.4.7" xref="S2.E9.m1.1.1.1.1.1.1.5.cmml">,</mo><mrow id="S2.E9.m1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.1.1.1.3.3.cmml"><msub id="S2.E9.m1.1.1.1.1.1.1.3.3.2" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.3.3.2.2" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2.2.cmml">W</mi><mn id="S2.E9.m1.1.1.1.1.1.1.3.3.2.3" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2.3.cmml">10</mn></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.1.1.1.3.3.1" xref="S2.E9.m1.1.1.1.1.1.1.3.3.1.cmml">â€‹</mo><msub id="S2.E9.m1.1.1.1.1.1.1.3.3.3" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.3.3.3.2" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.2.cmml">ğ²</mi><msub id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.2" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.2.cmml">G</mi><mn id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.3" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.3.cmml">3</mn></msub></msub></mrow><mo id="S2.E9.m1.1.1.1.1.1.1.4.8" xref="S2.E9.m1.1.1.1.1.1.1.5.cmml">,</mo><mrow id="S2.E9.m1.1.1.1.1.1.1.4.4" xref="S2.E9.m1.1.1.1.1.1.1.4.4.cmml"><msub id="S2.E9.m1.1.1.1.1.1.1.4.4.2" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.4.4.2.2" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2.2.cmml">W</mi><mn id="S2.E9.m1.1.1.1.1.1.1.4.4.2.3" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2.3.cmml">11</mn></msub><mo lspace="0em" rspace="0em" id="S2.E9.m1.1.1.1.1.1.1.4.4.1" xref="S2.E9.m1.1.1.1.1.1.1.4.4.1.cmml">â€‹</mo><mi id="S2.E9.m1.1.1.1.1.1.1.4.4.3" xref="S2.E9.m1.1.1.1.1.1.1.4.4.3.cmml">ğª</mi></mrow><mo stretchy="false" id="S2.E9.m1.1.1.1.1.1.1.4.9" xref="S2.E9.m1.1.1.1.1.1.1.5.cmml">]</mo></mrow><mo stretchy="false" id="S2.E9.m1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.cmml" xref="S2.E9.m1.1.1"><eq id="S2.E9.m1.1.1.2.cmml" xref="S2.E9.m1.1.1.2"></eq><apply id="S2.E9.m1.1.1.3.cmml" xref="S2.E9.m1.1.1.3"><times id="S2.E9.m1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.3.1"></times><ci id="S2.E9.m1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.3.2">ğ´</ci><ci id="S2.E9.m1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.3.3">ğ‘›</ci><ci id="S2.E9.m1.1.1.3.4.cmml" xref="S2.E9.m1.1.1.3.4">ğ‘ </ci></apply><apply id="S2.E9.m1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"><times id="S2.E9.m1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.2"></times><apply id="S2.E9.m1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.3.2">ğ‘“</ci><apply id="S2.E9.m1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.3.3"><times id="S2.E9.m1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.1.3.3.1"></times><ci id="S2.E9.m1.1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.1.3.3.2">ğ‘š</ci><ci id="S2.E9.m1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.1.3.3.3">ğ‘™</ci><ci id="S2.E9.m1.1.1.1.3.3.4.cmml" xref="S2.E9.m1.1.1.1.3.3.4">ğ‘</ci></apply></apply><list id="S2.E9.m1.1.1.1.1.1.1.5.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4"><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1"><times id="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2.2">ğ‘Š</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.2.3">8</cn></apply><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.2">ğ²</ci><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.2">ğº</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S2.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2"><times id="S2.E9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.1"></times><apply id="S2.E9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2.2">ğ‘Š</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.2.3">9</cn></apply><apply id="S2.E9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.2">ğ²</ci><apply id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.2">ğº</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.2.2.3.3.3">2</cn></apply></apply></apply><apply id="S2.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3"><times id="S2.E9.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.1"></times><apply id="S2.E9.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2.2">ğ‘Š</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.2.3">10</cn></apply><apply id="S2.E9.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.2">ğ²</ci><apply id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.2">ğº</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.3.3.3.3.3">3</cn></apply></apply></apply><apply id="S2.E9.m1.1.1.1.1.1.1.4.4.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4"><times id="S2.E9.m1.1.1.1.1.1.1.4.4.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4.1"></times><apply id="S2.E9.m1.1.1.1.1.1.1.4.4.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.4.4.2.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.4.4.2.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2.2">ğ‘Š</ci><cn type="integer" id="S2.E9.m1.1.1.1.1.1.1.4.4.2.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4.2.3">11</cn></apply><ci id="S2.E9.m1.1.1.1.1.1.1.4.4.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.4.4.3">ğª</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">Ans=f_{mlp}([W_{8}\mathbf{y}_{G_{1}},W_{9}\mathbf{y}_{G_{2}},W_{10}\mathbf{y}_{G_{3}},W_{11}\mathbf{q}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<figure id="S2.T1" class="ltx_table">
<div id="S2.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:142.3pt;height:124pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.1pt,28.0pt) scale(0.689131938615999,0.689131938615999) ;">
<table id="S2.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.1.1.2.1" class="ltx_tr">
<th id="S2.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="S2.T1.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">Model</span></th>
<th id="S2.T1.1.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="S2.T1.1.1.2.1.2.1" class="ltx_text" style="font-size:70%;">Expert layout</span></th>
<th id="S2.T1.1.1.2.1.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S2.T1.1.1.2.1.3.1" class="ltx_text" style="font-size:70%;">Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.1.1.3.1" class="ltx_tr">
<td id="S2.T1.1.1.3.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S2.T1.1.1.3.1.1.1" class="ltx_text" style="font-size:70%;">Q-Type</span></td>
<td id="S2.T1.1.1.3.1.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S2.T1.1.1.3.1.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.3.1.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S2.T1.1.1.3.1.3.1" class="ltx_text" style="font-size:70%;">25.96</span></td>
</tr>
<tr id="S2.T1.1.1.4.2" class="ltx_tr">
<td id="S2.T1.1.1.4.2.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.4.2.1.1" class="ltx_text" style="font-size:70%;">Q-Only</span></td>
<td id="S2.T1.1.1.4.2.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.4.2.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.4.2.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.4.2.3.1" class="ltx_text" style="font-size:70%;">39.40</span></td>
</tr>
<tr id="S2.T1.1.1.5.3" class="ltx_tr">
<td id="S2.T1.1.1.5.3.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.5.3.1.1" class="ltx_text" style="font-size:70%;">I-Only</span></td>
<td id="S2.T1.1.1.5.3.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.5.3.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.5.3.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.5.3.3.1" class="ltx_text" style="font-size:70%;">14.18</span></td>
</tr>
<tr id="S2.T1.1.1.6.4" class="ltx_tr">
<td id="S2.T1.1.1.6.4.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.6.4.1.1" class="ltx_text" style="font-size:70%;">Q+I</span></td>
<td id="S2.T1.1.1.6.4.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.6.4.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.6.4.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.6.4.3.1" class="ltx_text" style="font-size:70%;">48.47</span></td>
</tr>
<tr id="S2.T1.1.1.7.5" class="ltx_tr">
<td id="S2.T1.1.1.7.5.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S2.T1.1.1.7.5.1.1" class="ltx_text" style="font-size:70%;">ButtomUp </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.T1.1.1.7.5.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib20" title="" class="ltx_ref">20</a><span id="S2.T1.1.1.7.5.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S2.T1.1.1.7.5.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.7.5.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.7.5.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.7.5.3.1" class="ltx_text" style="font-size:70%;">52.26</span></td>
</tr>
<tr id="S2.T1.1.1.8.6" class="ltx_tr">
<td id="S2.T1.1.1.8.6.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S2.T1.1.1.8.6.1.1" class="ltx_text" style="font-size:70%;">RVC-w/o-KG </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.T1.1.1.8.6.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S2.T1.1.1.8.6.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S2.T1.1.1.8.6.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.8.6.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="S2.T1.1.1.8.6.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.8.6.3.1" class="ltx_text" style="font-size:70%;">54.68</span></td>
</tr>
<tr id="S2.T1.1.1.1" class="ltx_tr">
<td id="S2.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S2.T1.1.1.1.1.1" class="ltx_text" style="font-size:70%;">RVC-</span><math id="S2.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="l_{ans}" display="inline"><semantics id="S2.T1.1.1.1.1.m1.1a"><msub id="S2.T1.1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.1.m1.1.1.cmml"><mi mathsize="70%" id="S2.T1.1.1.1.1.m1.1.1.2" xref="S2.T1.1.1.1.1.m1.1.1.2.cmml">l</mi><mrow id="S2.T1.1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.1.m1.1.1.3.cmml"><mi mathsize="70%" id="S2.T1.1.1.1.1.m1.1.1.3.2" xref="S2.T1.1.1.1.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.1.m1.1.1.3.1" xref="S2.T1.1.1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi mathsize="70%" id="S2.T1.1.1.1.1.m1.1.1.3.3" xref="S2.T1.1.1.1.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.T1.1.1.1.1.m1.1.1.3.1a" xref="S2.T1.1.1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi mathsize="70%" id="S2.T1.1.1.1.1.m1.1.1.3.4" xref="S2.T1.1.1.1.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.1.1.1.1.m1.1.1.1.cmml" xref="S2.T1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.T1.1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.1.m1.1.1.2">ğ‘™</ci><apply id="S2.T1.1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.1.m1.1.1.3"><times id="S2.T1.1.1.1.1.m1.1.1.3.1.cmml" xref="S2.T1.1.1.1.1.m1.1.1.3.1"></times><ci id="S2.T1.1.1.1.1.m1.1.1.3.2.cmml" xref="S2.T1.1.1.1.1.m1.1.1.3.2">ğ‘</ci><ci id="S2.T1.1.1.1.1.m1.1.1.3.3.cmml" xref="S2.T1.1.1.1.1.m1.1.1.3.3">ğ‘›</ci><ci id="S2.T1.1.1.1.1.m1.1.1.3.4.cmml" xref="S2.T1.1.1.1.1.m1.1.1.3.4">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.1.m1.1c">l_{ans}</annotation></semantics></math><span id="S2.T1.1.1.1.1.2" class="ltx_text" style="font-size:70%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.T1.1.1.1.1.3.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S2.T1.1.1.1.1.4.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S2.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.1.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.1.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.1.3.1" class="ltx_text" style="font-size:70%;">51.20</span></td>
</tr>
<tr id="S2.T1.1.1.9.7" class="ltx_tr">
<td id="S2.T1.1.1.9.7.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S2.T1.1.1.9.7.1.1" class="ltx_text" style="font-size:70%;">RVC </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S2.T1.1.1.9.7.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S2.T1.1.1.9.7.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S2.T1.1.1.9.7.2" class="ltx_td ltx_align_left ltx_border_r"><span id="S2.T1.1.1.9.7.2.1" class="ltx_text" style="font-size:70%;">Yes</span></td>
<td id="S2.T1.1.1.9.7.3" class="ltx_td ltx_nopad_r ltx_align_left"><span id="S2.T1.1.1.9.7.3.1" class="ltx_text" style="font-size:70%;">58.38</span></td>
</tr>
<tr id="S2.T1.1.1.10.8" class="ltx_tr">
<td id="S2.T1.1.1.10.8.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t"><span id="S2.T1.1.1.10.8.1.1" class="ltx_text" style="font-size:70%;">HGNMN (full)</span></td>
<td id="S2.T1.1.1.10.8.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t"><span id="S2.T1.1.1.10.8.2.1" class="ltx_text" style="font-size:70%;">No</span></td>
<td id="S2.T1.1.1.10.8.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t"><span id="S2.T1.1.1.10.8.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">60.32</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.3.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Results on test set of CRIC dataset.</figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Experimental Settings</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Dataset.</span>
We evaluated our model on the CRIC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, a large VQA dataset contains 1,303,271 deeper questions than other common datasets, which are randomly split into train (60%), validation (20%) and test (20%).
It also provides expert layout annotations for each question.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.3" class="ltx_p"><span id="S3.SS1.p2.3.1" class="ltx_text ltx_font_bold">Implementation Details.</span> For each image, we extract 36 objects along with features, labels and probability scores from Faster-RCNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.
We select the top-10 captions and set <math id="S3.SS1.p2.1.m1.2" class="ltx_Math" alttext="a=0.7,b=0.3" display="inline"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.2.2" xref="S3.SS1.p2.1.m1.2.2.3.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml">0.7</mn></mrow><mo id="S3.SS1.p2.1.m1.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.3a.cmml">,</mo><mrow id="S3.SS1.p2.1.m1.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS1.p2.1.m1.2.2.2.2.2" xref="S3.SS1.p2.1.m1.2.2.2.2.2.cmml">b</mi><mo id="S3.SS1.p2.1.m1.2.2.2.2.1" xref="S3.SS1.p2.1.m1.2.2.2.2.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.2.2.2.2.3" xref="S3.SS1.p2.1.m1.2.2.2.2.3.cmml">0.3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><apply id="S3.SS1.p2.1.m1.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.2.2.3a.cmml" xref="S3.SS1.p2.1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1"></eq><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2">ğ‘</ci><cn type="float" id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3">0.7</cn></apply><apply id="S3.SS1.p2.1.m1.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2"><eq id="S3.SS1.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.1"></eq><ci id="S3.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.2">ğ‘</ci><cn type="float" id="S3.SS1.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p2.1.m1.2.2.2.2.3">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">a=0.7,b=0.3</annotation></semantics></math> in the graph construction.
We truncate or pad the length of question to 20 words.
The max reasoning steps <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">ğ‘‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">T</annotation></semantics></math> is set to 12.
We adopt cross entropy loss to train the model by Adam optimizer with <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mn id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><cn type="float" id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">0.001</annotation></semantics></math> learning rate.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Experimental Results</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.2" class="ltx_text ltx_font_bold">Comparison with SOTA Methods.</span>
In this section, we evaluate the performance of following methods on the CRIC:
(1) <span id="S3.SS2.p1.1.3" class="ltx_text ltx_font_bold">Q-Type</span>, <span id="S3.SS2.p1.1.4" class="ltx_text ltx_font_bold">Q-Only</span>, <span id="S3.SS2.p1.1.5" class="ltx_text ltx_font_bold">I-Only</span> and <span id="S3.SS2.p1.1.6" class="ltx_text ltx_font_bold">Q+I</span> are four basic baselines proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
(2) <span id="S3.SS2.p1.1.7" class="ltx_text ltx_font_bold">BottomUp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite></span> implements soft attention on object regions and combines the attended image features and question features to predict the answer.
(3) <span id="S3.SS2.p1.1.8" class="ltx_text ltx_font_bold">RVC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></span> builds upon neural module networks with supervision of expert layout.
(4) <span id="S3.SS2.p1.1.9" class="ltx_text ltx_font_bold">RVC-w/o-KG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></span> is a variation of RVC that doesnâ€™t use the knowledge graph to answer the question.
(5) <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">RVC-<math id="S3.SS2.p1.1.1.m1.1" class="ltx_Math" alttext="l_{ans}" display="inline"><semantics id="S3.SS2.p1.1.1.m1.1a"><msub id="S3.SS2.p1.1.1.m1.1.1" xref="S3.SS2.p1.1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.1.m1.1.1.2" xref="S3.SS2.p1.1.1.m1.1.1.2.cmml">l</mi><mrow id="S3.SS2.p1.1.1.m1.1.1.3" xref="S3.SS2.p1.1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.p1.1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.p1.1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.1.m1.1b"><apply id="S3.SS2.p1.1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.1.m1.1.1.2">ğ‘™</ci><apply id="S3.SS2.p1.1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.1.m1.1.1.3"><times id="S3.SS2.p1.1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.1.m1.1.1.3.2">ğ‘</ci><ci id="S3.SS2.p1.1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.1.m1.1.1.3.3">ğ‘›</ci><ci id="S3.SS2.p1.1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.1.m1.1.1.3.4">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.1.m1.1c">l_{ans}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite></span> is a variation of RVC that can be trained without supervision of expert layout.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">The results are summarized in Table <a href="#S2.T1" title="Table 1 â€£ 2.3 Module Controller â€£ 2 Proposed Approach â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
Our model achieves a new SOTA result.
In particular, although RVC is trained with expert layout, our model still outperforms RVC by 1.94%.
Compared with RVC-<math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="l_{ans}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">l</mi><mrow id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.3.1" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.3.1a" xref="S3.SS2.p2.1.m1.1.1.3.1.cmml">â€‹</mo><mi id="S3.SS2.p2.1.m1.1.1.3.4" xref="S3.SS2.p2.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">ğ‘™</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><times id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3.1"></times><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">ğ‘</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">ğ‘›</ci><ci id="S3.SS2.p2.1.m1.1.1.3.4.cmml" xref="S3.SS2.p2.1.m1.1.1.3.4">ğ‘ </ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">l_{ans}</annotation></semantics></math> that also does not require expert layout, our model improves by 9.12%, which proves the effectiveness of reasoning on multi-layer graphs.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p"><span id="S3.SS2.p3.1.1" class="ltx_text ltx_font_bold">Ablation Study.</span>
We conduct ablation studies to further investigate the key components of HGNMN.
(1) We remove the visual, semantic and commonsense graph from full model respectively to analyze the contributions of each layer of graphs.
The results shown in Table <a href="#S3.T3" title="Table 3 â€£ 3.2 Experimental Results â€£ 3 Experiments â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> all decrease.
Thereinto, the commonsense graph is most important since most of the questions rely on external knowledge.
(2) We further evaluate the effectiveness of different neural modules in Table <a href="#S3.T3" title="Table 3 â€£ 3.2 Experimental Results â€£ 3 Experiments â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
We remove the <span id="S3.SS2.p3.1.2" class="ltx_text ltx_font_typewriter">And</span>, <span id="S3.SS2.p3.1.3" class="ltx_text ltx_font_typewriter">Filter</span>, <span id="S3.SS2.p3.1.4" class="ltx_text ltx_font_typewriter">Relate</span> and <span id="S3.SS2.p3.1.5" class="ltx_text ltx_font_typewriter">CrossGraph</span> modules respectively.
The <span id="S3.SS2.p3.1.6" class="ltx_text ltx_font_typewriter">Find</span>, <span id="S3.SS2.p3.1.7" class="ltx_text ltx_font_typewriter">Describe</span> and <span id="S3.SS2.p3.1.8" class="ltx_text ltx_font_typewriter">NoOp</span> modules are kept because answering any questions at least requires these operations.
We find that the <span id="S3.SS2.p3.1.9" class="ltx_text ltx_font_typewriter">Relate</span> and <span id="S3.SS2.p3.1.10" class="ltx_text ltx_font_typewriter">CrossGraph</span> modules are more important than others, since they can extend reasoning along edges and associate multiple graphs which are essential for multi-step reasoning.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T3.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:173.4pt;">
<div id="S3.T3.fig1.1" class="ltx_inline-block ltx_transformed_outer" style="width:59.8pt;height:70.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-0.8pt,1.0pt) scale(0.972985537754799,0.972985537754799) ;">
<table id="S3.T3.fig1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.fig1.1.1.1.1" class="ltx_tr">
<th id="S3.T3.fig1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.1.1.1.1" class="ltx_text" style="font-size:70%;">Model</span></th>
<th id="S3.T3.fig1.1.1.1.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.1.1.2.1" class="ltx_text" style="font-size:70%;">Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.fig1.1.1.2.1" class="ltx_tr">
<td id="S3.T3.fig1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">w/o VG</span></td>
<td id="S3.T3.fig1.1.1.2.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.2.1.2.1" class="ltx_text" style="font-size:70%;">57.63</span></td>
</tr>
<tr id="S3.T3.fig1.1.1.3.2" class="ltx_tr">
<td id="S3.T3.fig1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.3.2.1.1" class="ltx_text" style="font-size:70%;">w/o SG</span></td>
<td id="S3.T3.fig1.1.1.3.2.2" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">59.11</span></td>
</tr>
<tr id="S3.T3.fig1.1.1.4.3" class="ltx_tr">
<td id="S3.T3.fig1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.4.3.1.1" class="ltx_text" style="font-size:70%;">w/o KG</span></td>
<td id="S3.T3.fig1.1.1.4.3.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-top:-0.05pt;padding-bottom:-0.05pt;"><span id="S3.T3.fig1.1.1.4.3.2.1" class="ltx_text" style="font-size:70%;">55.25</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.T3.fig1.2.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>Ablation study of hierarchical graphs</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.T3.fig2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_bottom" style="width:260.2pt;">
<div id="S3.T3.fig2.1" class="ltx_inline-block ltx_transformed_outer" style="width:85.4pt;height:88.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-0.8pt,0.8pt) scale(0.981144925355281,0.981144925355281) ;">
<table id="S3.T3.fig2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.fig2.1.1.1.1" class="ltx_tr">
<th id="S3.T3.fig2.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.1.1.1.1" class="ltx_text" style="font-size:70%;">Model</span></th>
<th id="S3.T3.fig2.1.1.1.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.1.1.2.1" class="ltx_text" style="font-size:70%;">Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.fig2.1.1.2.1" class="ltx_tr">
<td id="S3.T3.fig2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.2.1.1.1" class="ltx_text" style="font-size:70%;">w/o And</span></td>
<td id="S3.T3.fig2.1.1.2.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.2.1.2.1" class="ltx_text" style="font-size:70%;">59.12</span></td>
</tr>
<tr id="S3.T3.fig2.1.1.3.2" class="ltx_tr">
<td id="S3.T3.fig2.1.1.3.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.3.2.1.1" class="ltx_text" style="font-size:70%;">w/o Filter</span></td>
<td id="S3.T3.fig2.1.1.3.2.2" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.3.2.2.1" class="ltx_text" style="font-size:70%;">58.47</span></td>
</tr>
<tr id="S3.T3.fig2.1.1.4.3" class="ltx_tr">
<td id="S3.T3.fig2.1.1.4.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.4.3.1.1" class="ltx_text" style="font-size:70%;">w/o Relate</span></td>
<td id="S3.T3.fig2.1.1.4.3.2" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.4.3.2.1" class="ltx_text" style="font-size:70%;">57.39</span></td>
</tr>
<tr id="S3.T3.fig2.1.1.5.4" class="ltx_tr">
<td id="S3.T3.fig2.1.1.5.4.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.5.4.1.1" class="ltx_text" style="font-size:70%;">w/o CrossGraph</span></td>
<td id="S3.T3.fig2.1.1.5.4.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" style="padding-top:-0.7pt;padding-bottom:-0.7pt;"><span id="S3.T3.fig2.1.1.5.4.2.1" class="ltx_text" style="font-size:70%;">57.14</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.T3.fig2.2.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>Ablation study of different modules</figcaption>
</figure>
</div>
</div>
</figure>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2206.12533/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="254" height="98" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F3.2.1.1" class="ltx_text ltx_font_bold">Fig.Â 3</span>: </span>Visualization of intermediate reasoning steps.</figcaption>
</figure>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.1" class="ltx_p"><span id="S3.SS2.p4.1.1" class="ltx_text ltx_font_bold">Qualitative Evaluation</span>

Fig. <a href="#S3.F3" title="Figure 3 â€£ 3.2 Experimental Results â€£ 3 Experiments â€£ FROM SHALLOW TO DEEP: COMPOSITIONAL REASONING OVER GRAPHS FOR VISUAL QUESTION ANSWERING" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the qualitative evaluation of one example.
We visualize the results of the first 7 steps and omit the rest <span id="S3.SS2.p4.1.2" class="ltx_text ltx_font_typewriter">NoOp</span> operations.
At each reasoning step, we mark the module with the largest weight in red and the most attentive word of the question in blue and present the attention map of corresponding graph.
It shows that our model can extract explicit and explainable reasoning process.
For example, it locates the â€œblack objectâ€ in VG via <span id="S3.SS2.p4.1.3" class="ltx_text ltx_font_typewriter">Filter</span> at the 2<span id="S3.SS2.p4.1.4" class="ltx_text ltx_font_italic">nd</span> step; finds the most relevant object in SG via <span id="S3.SS2.p4.1.5" class="ltx_text ltx_font_typewriter">CrossGraph</span> at the 3<span id="S3.SS2.p4.1.6" class="ltx_text ltx_font_italic">rd</span> step; finds the nodes related to â€œcarâ€ in KG via <span id="S3.SS2.p4.1.7" class="ltx_text ltx_font_typewriter">Relate</span> at the 6<span id="S3.SS2.p4.1.8" class="ltx_text ltx_font_italic">th</span> step.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, we propose a Hierarchical Graph Neural Module Network (HGNMN) for answering deeper questions of VQA.
We encode the image by multi-layer graphs from different views and define a set of graph-based neural modules to extend reasoning from single graph to more graphs.
Moreover, it can be trained end-to-end without expert layout supervision.
Experimental results on CRIC dataset show that HGNMN outperforms state-of-the-art approaches.
Our model is more interpretable by observing its intermediate outputs.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Huaizu Jiang, Ishan Misra, Marcus Rohrbach, Erik Learned-Miller, and Xinlei
Chen,

</span>
<span class="ltx_bibblock">â€œIn defense of grid features for visual question answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 2020, pp. 10267â€“10276.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Hedi Ben-Younes, Remi Cadene, Nicolas Thome, and Matthieu Cord,

</span>
<span class="ltx_bibblock">â€œBlock: Bilinear superdiagonal fusion for visual question answering
and visual relationship detection,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, 2019, vol.Â 33, pp. 8102â€“8109.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Tuong Do, Thanh-Toan Do, Huy Tran, Erman Tjiputra, and QuangÂ D Tran,

</span>
<span class="ltx_bibblock">â€œCompact trilinear interaction for visual question answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision</span>, 2019, pp. 392â€“401.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Zichao Yang, Xiaodong He, Jianfeng Gao, LiÂ Deng, and Alex Smola,

</span>
<span class="ltx_bibblock">â€œStacked attention networks for image question answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, 2016, pp. 21â€“29.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Zhou Yu, Jun Yu, Yuhao Cui, Dacheng Tao, and QiÂ Tian,

</span>
<span class="ltx_bibblock">â€œDeep modular co-attention networks for visual question answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, 2019, pp. 6281â€“6290.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jing Yu, Zihao Zhu, Yujing Wang, Weifeng Zhang, Yue Hu, and Jianlong Tan,

</span>
<span class="ltx_bibblock">â€œCross-modal knowledge reasoning for knowledge-based visual question
answering,â€

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Pattern Recognition</span>, vol. 108, pp. 107563, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chao Ma, Chunhua Shen, Anthony Dick, QiÂ Wu, Peng Wang, Anton vanÂ den Hengel,
and Ian Reid,

</span>
<span class="ltx_bibblock">â€œVisual question answering with memory-augmented networks,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 2018, pp. 6975â€“6984.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Wenhu Chen, Zhe Gan, Linjie Li, YuÂ Cheng, William Wang, and Jingjing Liu,

</span>
<span class="ltx_bibblock">â€œMeta module network for compositional visual reasoning,â€

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1910.03230</span>, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Ronghang Hu, Jacob Andreas, Trevor Darrell, and Kate Saenko,

</span>
<span class="ltx_bibblock">â€œExplainable neural computation via stack neural module networks,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Proceedings of the European conference on computer vision</span>,
2018, pp. 53â€“69.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Sibei Yang, Guanbin Li, and Yizhou Yu,

</span>
<span class="ltx_bibblock">â€œGraph-structured referring expression reasoning in the wild,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 2020, pp. 9952â€“9961.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Difei Gao, Ruiping Wang, Shiguang Shan, and Xilin Chen,

</span>
<span class="ltx_bibblock">â€œFrom two graphs to n questions: A vqa dataset for compositional
reasoning on vision and commonsense,â€

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1908.02962</span>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Linjie Li, Zhe Gan, YuÂ Cheng, and Jingjing Liu,

</span>
<span class="ltx_bibblock">â€œRelation-aware graph attention network for visual question
answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision</span>, 2019, pp. 10313â€“10322.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Zihao Zhu, Jing Yu, Yujing Wang, Yajing Sun, Yue Hu, and QiÂ Wu,

</span>
<span class="ltx_bibblock">â€œMucko: Multi-layer cross-modal knowledge reasoning for fact-based
visual question answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proceedings of the International Joint Conference on
Artificial Intelligence</span>, 2020, pp. 1097â€“1103.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun,

</span>
<span class="ltx_bibblock">â€œFaster r-cnn: Towards real-time object detection with region
proposal networks,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 2015, pp.
91â€“99.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Justin Johnson, Andrej Karpathy, and LiÂ Fei-Fei,

</span>
<span class="ltx_bibblock">â€œDensecap: Fully convolutional localization networks for dense
captioning,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, 2016, pp. 4565â€“4574.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Peter Anderson, Basura Fernando, Mark Johnson, and Stephen Gould,

</span>
<span class="ltx_bibblock">â€œSpice: Semantic propositional image caption evaluation,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision</span>. Springer, 2016, pp.
382â€“398.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and ChristopherÂ D Manning,

</span>
<span class="ltx_bibblock">â€œGlove: Global vectors for word representation,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2014 conference on empirical methods in
natural language processing</span>, 2014, pp. 1532â€“1543.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Robyn Speer, Joshua Chin, and Catherine Havasi,

</span>
<span class="ltx_bibblock">â€œConceptnet 5.5: an open multilingual graph of general knowledge,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Proceedings of the Thirty-First AAAI Conference on Artificial
Intelligence</span>, 2017, pp. 4444â€“4451.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jiaxin Shi, Hanwang Zhang, and Juanzi Li,

</span>
<span class="ltx_bibblock">â€œExplainable and explicit visual reasoning over scene graphs,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 2019, pp. 8376â€“8384.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang,

</span>
<span class="ltx_bibblock">â€œBottom-up and top-down attention for image captioning and visual
question answering,â€

</span>
<span class="ltx_bibblock">in <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, 2018, pp. 6077â€“6086.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2206.12532" class="ar5iv-nav-button ar5iv-nav-button-prev">â—„</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2206.12533" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2206.12533">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2206.12533" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2206.12534" class="ar5iv-nav-button ar5iv-nav-button-next">â–º</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Mar 11 16:12:46 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "Ã—";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
