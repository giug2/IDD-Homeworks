<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.04455] Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt</title><meta property="og:description" content="Federated Learning (FL) is often impeded by communication overhead issues. Prompt tuning, as a potential solution, has been introduced to only adjust a few trainable parameters rather than the whole model. However, cur…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.04455">

<!--Generated on Wed Feb 28 02:28:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="federated learning,  prompt tuning,  contrastive learning">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zihao Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">Tsinghua-Berkeley Shenzhen Institute,</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_institution">Tsinghua University,</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_city">Shenzhen</span><span id="id4.4.id4" class="ltx_text ltx_affiliation_state">Guangdong</span><span id="id5.5.id5" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhao-zh21@mails.tsinghua.edu.cn">zhao-zh21@mails.tsinghua.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhenpeng Shi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id6.1.id1" class="ltx_text ltx_affiliation_institution">Tsinghua-Berkeley Shenzhen Institute,</span><span id="id7.2.id2" class="ltx_text ltx_affiliation_institution">Tsinghua University,</span><span id="id8.3.id3" class="ltx_text ltx_affiliation_city">Shenzhen</span><span id="id9.4.id4" class="ltx_text ltx_affiliation_state">Guangdong</span><span id="id10.5.id5" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:shizp22@mails.tsinghua.edu.cn">shizp22@mails.tsinghua.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yang Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id11.1.id1" class="ltx_text ltx_affiliation_institution">Institute for AI Industry Research,</span><span id="id12.2.id2" class="ltx_text ltx_affiliation_institution">Tsinghua University,</span><span id="id13.3.id3" class="ltx_text ltx_affiliation_state">Beijing</span><span id="id14.4.id4" class="ltx_text ltx_affiliation_country">China</span>
<br class="ltx_break"><span id="id15.5.id5" class="ltx_text ltx_affiliation_institution">Shanghai Artificial Intelligence Laboratory,</span><span id="id16.6.id6" class="ltx_text ltx_affiliation_state">Shanghai</span><span id="id17.7.id7" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liuy03@air.tsinghua.edu.cn">liuy03@air.tsinghua.edu.cn</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wenbo Ding
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id18.1.id1" class="ltx_text ltx_affiliation_institution">Tsinghua-Berkeley Shenzhen Institute,</span><span id="id19.2.id2" class="ltx_text ltx_affiliation_institution">Tsinghua University,</span><span id="id20.3.id3" class="ltx_text ltx_affiliation_city">Shenzhen</span><span id="id21.4.id4" class="ltx_text ltx_affiliation_state">Guangdong</span><span id="id22.5.id5" class="ltx_text ltx_affiliation_country">China</span>
<br class="ltx_break"><span id="id23.6.id6" class="ltx_text ltx_affiliation_institution">Shanghai Artificial Intelligence Laboratory,</span><span id="id24.7.id7" class="ltx_text ltx_affiliation_state">Shanghai</span><span id="id25.8.id8" class="ltx_text ltx_affiliation_country">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ding.wenbo@sz.tsinghua.edu.cn">ding.wenbo@sz.tsinghua.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2023)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id26.id1" class="ltx_p">Federated Learning (FL) is often impeded by communication overhead issues. Prompt tuning, as a potential solution, has been introduced to only adjust a few trainable parameters rather than the whole model. However, current single-modality prompt tuning approaches fail to comprehensively portray local clients’ data. To overcome this limitation, we present Twin Prompt Federated learning (TPFL), a pioneering solution that integrates both visual and textual modalities, ensuring a more holistic representation of local clients’ data characteristics. Furthermore, in order to tackle the data heterogeneity issues, we introduce the Augmented TPFL (ATPFL) employing the contrastive learning to TPFL, which not only enhances the global knowledge acquisition of client models but also fosters the development of robust, compact models. The effectiveness of TPFL and ATPFL is substantiated by our extensive evaluations, consistently showing superior performance compared to all baselines.</p>
</div>
<div class="ltx_keywords">federated learning, prompt tuning, contrastive learning
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2023</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Adjunct Proceedings of the 2023 International Joint Conference on Pervasive and Ubiquitous Computing &amp; the 2023 International Symposium on Wearable Computers; October 8–12; Cancun, Quintana Roo, Mexico</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Adjunct Proceedings of the 2023 International Joint Conference on Pervasive and Ubiquitous Computing &amp; the 2023 International Symposium on Wearable Computers (UbiComp/ISWC ’23 Companion), October 8–12, 2023, Cancun, Quintana Roo, Mexico</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3594739.3612914</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0200-6/23/10</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Human-centered computing Empirical studies in ubiquitous and mobile computing</span></span></span><span id="id10" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Human-centered computing Collaborative and social computing</span></span></span><span id="id11" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed algorithms</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The emergence of distributed learning systems has provided considerable advantages across a wide range of domains. Nonetheless, growing privacy concerns about distributed learning have necessitated the advent of <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">Federated Learning</span> (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2017</a>; Bonawitz et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2022</a>)</cite>, a framework expressly developed to protect participants’ private information. In FL, instead of uploading their private data, local clients share their local model weights with a central server during each communication round. The server aggregates these models and circulates them back to the local clients, thereby accomplishing the goal of information consolidation.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recently, FL has confronted a wealth of challenges, including significant communication overheads <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2023a</a>; Mao et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2023</a>; Zhao et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2023b</a>)</cite> and data heterogeneity <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>. A variety of recent research initiatives have sought to tackle these obstacles. Specifically, some have proposed innovative efficient encoding and model compression algorithms to reduce the communication cost, such as quantization to a continuous range of values into a finite set and sparsification <cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite> to clip the full gradient into a sparse one, as well as intelligent scheduling of client participation <cite class="ltx_cite ltx_citemacro_citep">(Nishio and Yonetani, <a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite> during the training process. Moreover, some incorporate the original FL framework with an additional step of knowledge distilling <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite> to contract larger models into smaller ones, thereby enhancing the robustness of the global model.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Despite these strategies, certain inherent limitations persist. Primarily, they require a substantial volume of labeled training samples, which may be unavailable to many clients in the FL environment, hindering effective training and resulting in model overfitting <cite class="ltx_cite ltx_citemacro_citep">(Jin et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>. In addition, notwithstanding the communication costs reduction achieved by these efficient methods, most IoT devices such as smart home devices or industrial sensors, cannot accommodate large backbone model training due to their limited processing powers <cite class="ltx_cite ltx_citemacro_citep">(Imteaj et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>, infinitesimal memory, and energy constraints. To illustrate, training a ResNet-50 model <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> involves intensive computation and storage memory. It has approximately 25 million weight parameters and computes 16 million activations in the forward pass. Even after the communication-efficient algorithm to weights and activations, the total storage needed for saving ResNet-50’s intermediate gradient results is over 7.5 GB for a mini-batch of 32 on a high-performance GPU. Given the hardware constraints of typical IoT devices, it is clear that they would struggle to support such intensive computations and memory requirements.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">To resolve these problems, current research is leaning towards prompt tuning <cite class="ltx_cite ltx_citemacro_citep">(Lester et al<span class="ltx_text">.</span>, <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>. Unlike conventional fine-tuning methods in FL that tune and aggregate full model parameters, applying prompt learning in FL only adjusts soft prompts for corresponding downstream tasks, while keeping large backbone models static to diminish both the communication and computation costs. Back to the ResNet-50 case, prompt tuning could save gradient results to just a handful of MB, drastically decreasing the communication overhead. However, most existing work only considers a single modality, failing to represent the local clients comprehensively. For instance, <cite class="ltx_cite ltx_citemacro_citet">Guo et al<span class="ltx_text">.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> exclusively employs textual soft prompts to depict the local clients without taking the visual knowledge into consideration; yet, <cite class="ltx_cite ltx_citemacro_citet">Feng et al<span class="ltx_text">.</span> (<a href="#bib.bib6" title="" class="ltx_ref">2023</a>)</cite> leverages continuous visual prompts to capture the image data information, disregarding text knowledge. In contrast, our work proposes Twin Prompt Federated learning (TPFL), a method resorting to both visual and textual modalities for a more comprehensive representation of the local clients’ data characteristics. First off, we find that merely combining two modalities overlooks the potential for a unified approach. As such, we devise Augmented TPFL (ATPFL) to fuse the contrastive learning approach into the prompt tuning, facilitating the acquisition of global knowledge by client models. To the best of our knowledge, ATPFL is the first to integrate both textual and visual modalities within the context of FL and use contrastive learning to connect them. The contributions of this paper are threefold:</p>
</div>
<div id="S1.p5" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We present an innovative FL framework named ATPFL, that merges both visual and textual modalities for an improved representation of local clients’ data characteristics, surpassing existing work’s performance that only considers a single modality.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">The incorporation of contrastive learning to prompt tuning, enabling clients to acquire more global knowledge and improving on the direct combination of modalities that may overlook the potential for a unified approach. This is the first work to integrate two modalities within the context of FL and to utilize contrastive learning for their integration.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Extensive evaluations have been conducted to ascertain the effectiveness of TPFL and ATPFL. The results demonstrate that ATPFL outperforms all the baselines.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2310.04455/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="433" height="170" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>. </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">This figure illustrates the pipeline of ATPFL with contrastive learning.
In local training, the current prompt, previous prompt, and received global prompt are passed to each modality encoder. After the encoding, two types of contrastive learning are performed. Text contrastive loss and Visual contrastive loss use the feature extracted from the global prompt as positive contrast and the feature extracted from the previous prompt as negative contrast. CLIP contrastive loss is computed with the test prompt feature and the visual prompt feature.
</span></figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Works</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Communication Efficiency</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Communication efficiency has always been a critical challenge in the FL field. Different lines of research have been investigated to tackle this challenge.
Firstly, quantization<cite class="ltx_cite ltx_citemacro_citep">(Gray and Neuhoff, <a href="#bib.bib7" title="" class="ltx_ref">1998</a>)</cite> methods are used to represent the full model parameters with lower bits. This technique involves converting the high-precision floating-point values of the model parameters into lower-precision values. For example, stochastic quantization<cite class="ltx_cite ltx_citemacro_citep">(Alistarh et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> adaptively adjusts the quantization level in a stochastic manner.
Secondly, sparsification methods improve communication efficiency by directly reducing the number of model parameters to be sent. More specifically, the sparsification method selects an important subset of model parameters and sets other insignificant parameters to zero before sending them to the global server. Top-k sparsification and rank-k sparsification are common sparsification methods<cite class="ltx_cite ltx_citemacro_citep">(Eghlidi and Jaggi, <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>. Han et al.<cite class="ltx_cite ltx_citemacro_citep">(Han et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>proposed to adaptively change the sparsification level to minimize overall training time. Shi et al.<cite class="ltx_cite ltx_citemacro_citep">(Shi et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite> introduced global-k sparsification to compress the down streaming communication from the server to the clients.
Thirdly, knowledge distillation is also investigated to alleviate communication overhead<cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>. Knowledge distillation methods transfer knowledge from a larger teacher model to a smaller student model. Examples of knowledge-distillation-based federated learning are FedMD<cite class="ltx_cite ltx_citemacro_citep">(Li and Wang, <a href="#bib.bib16" title="" class="ltx_ref">2019</a>)</cite>, FedDF<cite class="ltx_cite ltx_citemacro_citep">(Sattler et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>, etc. However, all the aforementioned strategies have a high resource requirement and can hardly be implemented in IoT devices due to their limited hardware restrictions.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Prompt Tuning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Houlsby et al<span class="ltx_text">.</span> (<a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> proposed parameter-efficient transfer learning with adapter modules.
<cite class="ltx_cite ltx_citemacro_citet">Liu et al<span class="ltx_text">.</span> (<a href="#bib.bib19" title="" class="ltx_ref">2022</a>)</cite> showed that prompt-tuning can match the performance of fine-tuning with only 0.1% - 3% tuned parameters in the context of Natural Language Understanding.
<cite class="ltx_cite ltx_citemacro_citet">Li and Liang (<a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite> applied prefix-tuning to GPT-2 and BART for downstream tasks and shows that prefix-tuning can outperform fine-tuning in low-data settings.
<cite class="ltx_cite ltx_citemacro_citet">Guo et al<span class="ltx_text">.</span> (<a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> proposed a federated learning framework for prompt-tuning called PromptFL.The PromptFL framework leverages the power of federated learning, which allows training prompts on decentralized data across multiple devices. In this work, only one modality text prompt is used and the result shows that federated prompt tuning achieved better performance compared to fine-tuning FL in many IID and non-IID settings.
Nonetheless, the existing research primarily focuses on a single modality, constraining their capability to obtain more information of local clients. In this paper, we present to employ both textual and visual representations to comprehensively characterize the local client.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">This section begins by outlining the basic structure of FL. Subsequently, we introduce the TPFL which considers both visual and textual information. Despite showing improvements, TPFL has certain inherent limitations. Therefore, we propose ATPFL to address these shortcomings and achieve superior performance.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem Statement</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.8" class="ltx_p">In the general FL setting, the entail system envelops <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">M</annotation></semantics></math> clients, while, in every round, <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">K</annotation></semantics></math> clients will actively participate, each possessing a unique local dataset. Each local dataset on client <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">k</annotation></semantics></math> consists of <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">n_{k}</annotation></semantics></math> samples, with each sample representing a pair, <math id="S3.SS1.p1.5.m5.2" class="ltx_Math" alttext="(x_{i}^{k},y_{i}^{k})" display="inline"><semantics id="S3.SS1.p1.5.m5.2a"><mrow id="S3.SS1.p1.5.m5.2.2.2" xref="S3.SS1.p1.5.m5.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.2.2.2.3" xref="S3.SS1.p1.5.m5.2.2.3.cmml">(</mo><msubsup id="S3.SS1.p1.5.m5.1.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS1.p1.5.m5.1.1.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS1.p1.5.m5.1.1.1.1.3" xref="S3.SS1.p1.5.m5.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS1.p1.5.m5.2.2.2.4" xref="S3.SS1.p1.5.m5.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p1.5.m5.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.cmml"><mi id="S3.SS1.p1.5.m5.2.2.2.2.2.2" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.5.m5.2.2.2.2.2.3" xref="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS1.p1.5.m5.2.2.2.2.3" xref="S3.SS1.p1.5.m5.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.5.m5.2.2.2.5" xref="S3.SS1.p1.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.2b"><interval closure="open" id="S3.SS1.p1.5.m5.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2"><apply id="S3.SS1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS1.p1.5.m5.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.5.m5.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.5.m5.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS1.p1.5.m5.2.2.2.2.3">𝑘</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.2c">(x_{i}^{k},y_{i}^{k})</annotation></semantics></math>, of a data feature <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">x</annotation></semantics></math> and its corresponding target label <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">y</annotation></semantics></math>. The primary objective of FL is to construct a global model parameter vector <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">w</annotation></semantics></math> that minimizes the mean loss across all local datasets, as demonstrated in the following optimization problem:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="w=\arg\min_{w}\frac{1}{K}\sum_{i=1}^{K}\frac{1}{n_{i}}\sum_{n=1}^{n_{i}}\mathcal{L}\left(w;x_{n}^{i},y_{n}^{i}\right)," display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2.1" xref="S3.E1.m1.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.4" xref="S3.E1.m1.2.2.1.1.4.cmml">w</mi><mo id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.1.2.cmml"><mrow id="S3.E1.m1.2.2.1.1.2.4" xref="S3.E1.m1.2.2.1.1.2.4.cmml"><mi id="S3.E1.m1.2.2.1.1.2.4.1" xref="S3.E1.m1.2.2.1.1.2.4.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.2.2.1.1.2.4a" xref="S3.E1.m1.2.2.1.1.2.4.cmml">⁡</mo><mrow id="S3.E1.m1.2.2.1.1.2.4.2" xref="S3.E1.m1.2.2.1.1.2.4.2.cmml"><munder id="S3.E1.m1.2.2.1.1.2.4.2.1" xref="S3.E1.m1.2.2.1.1.2.4.2.1.cmml"><mi id="S3.E1.m1.2.2.1.1.2.4.2.1.2" xref="S3.E1.m1.2.2.1.1.2.4.2.1.2.cmml">min</mi><mi id="S3.E1.m1.2.2.1.1.2.4.2.1.3" xref="S3.E1.m1.2.2.1.1.2.4.2.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S3.E1.m1.2.2.1.1.2.4.2a" xref="S3.E1.m1.2.2.1.1.2.4.2.cmml">⁡</mo><mfrac id="S3.E1.m1.2.2.1.1.2.4.2.2" xref="S3.E1.m1.2.2.1.1.2.4.2.2.cmml"><mn id="S3.E1.m1.2.2.1.1.2.4.2.2.2" xref="S3.E1.m1.2.2.1.1.2.4.2.2.2.cmml">1</mn><mi id="S3.E1.m1.2.2.1.1.2.4.2.2.3" xref="S3.E1.m1.2.2.1.1.2.4.2.2.3.cmml">K</mi></mfrac></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.2.3" xref="S3.E1.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.2.2" xref="S3.E1.m1.2.2.1.1.2.2.cmml"><munderover id="S3.E1.m1.2.2.1.1.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.2.2.1.1.2.2.3.2.2" xref="S3.E1.m1.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.3.2.3" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.3.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.2.2.1.1.2.2.3.2.3.1" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.1.1.2.2.3.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.2.1.1.2.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.3.3.cmml">K</mi></munderover><mrow id="S3.E1.m1.2.2.1.1.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.cmml"><mfrac id="S3.E1.m1.2.2.1.1.2.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.2.4.cmml"><mn id="S3.E1.m1.2.2.1.1.2.2.2.4.2" xref="S3.E1.m1.2.2.1.1.2.2.2.4.2.cmml">1</mn><msub id="S3.E1.m1.2.2.1.1.2.2.2.4.3" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.4.3.2" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3.2.cmml">n</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.4.3.3" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.cmml"><munderover id="S3.E1.m1.2.2.1.1.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.2.cmml">n</mi><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.1" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.2.cmml">n</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml"><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">w</mi><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.4" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">;</mo><msubsup id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi><mi id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.5" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml">n</mi><mi id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.6" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.2.2.1.2" xref="S3.E1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.1.1.cmml" xref="S3.E1.m1.2.2.1"><eq id="S3.E1.m1.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.3"></eq><ci id="S3.E1.m1.2.2.1.1.4.cmml" xref="S3.E1.m1.2.2.1.1.4">𝑤</ci><apply id="S3.E1.m1.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2"><times id="S3.E1.m1.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.3"></times><apply id="S3.E1.m1.2.2.1.1.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.4"><arg id="S3.E1.m1.2.2.1.1.2.4.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4.1"></arg><apply id="S3.E1.m1.2.2.1.1.2.4.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2"><apply id="S3.E1.m1.2.2.1.1.2.4.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.4.2.1.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.1">subscript</csymbol><min id="S3.E1.m1.2.2.1.1.2.4.2.1.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.1.2"></min><ci id="S3.E1.m1.2.2.1.1.2.4.2.1.3.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.1.3">𝑤</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.4.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.2"><divide id="S3.E1.m1.2.2.1.1.2.4.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.2"></divide><cn type="integer" id="S3.E1.m1.2.2.1.1.2.4.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.2.2">1</cn><ci id="S3.E1.m1.2.2.1.1.2.4.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.4.2.2.3">𝐾</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2"><apply id="S3.E1.m1.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3"><eq id="S3.E1.m1.2.2.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.2.2.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.2.1.1.2.2.3.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.3.3">𝐾</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2"><times id="S3.E1.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.3"></times><apply id="S3.E1.m1.2.2.1.1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4"><divide id="S3.E1.m1.2.2.1.1.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4"></divide><cn type="integer" id="S3.E1.m1.2.2.1.1.2.2.2.4.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4.2">1</cn><apply id="S3.E1.m1.2.2.1.1.2.2.2.4.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.4.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.4.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3.2">𝑛</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.4.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2"><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3">subscript</csymbol><sum id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.2"></sum><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3"><eq id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.2">𝑛</ci><cn type="integer" id="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.2">𝑛</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2"><times id="S3.E1.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.3"></times><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.4.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.4">ℒ</ci><list id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑤</ci><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.2.3">𝑛</ci></apply><ci id="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.1.1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">w=\arg\min_{w}\frac{1}{K}\sum_{i=1}^{K}\frac{1}{n_{i}}\sum_{n=1}^{n_{i}}\mathcal{L}\left(w;x_{n}^{i},y_{n}^{i}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.10" class="ltx_p">where <math id="S3.SS1.p1.9.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.9.m1.1a"><mi id="S3.SS1.p1.9.m1.1.1" xref="S3.SS1.p1.9.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m1.1b"><ci id="S3.SS1.p1.9.m1.1.1.cmml" xref="S3.SS1.p1.9.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m1.1c">w</annotation></semantics></math> denotes the weights of the prediction model, <math id="S3.SS1.p1.10.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S3.SS1.p1.10.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m2.1.1" xref="S3.SS1.p1.10.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m2.1b"><ci id="S3.SS1.p1.10.m2.1.1.cmml" xref="S3.SS1.p1.10.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m2.1c">\mathcal{L}</annotation></semantics></math> is the loss function.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Twin Prompt Federated Learning (TPFL)</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.12" class="ltx_p">As aforementioned CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2022</a>)</cite> resorts to a series of continuous learnable parameters as the textual prompts, replacing the manually-designed constant ones. The textual prompt can be denoted as <math id="S3.SS2.p1.1.m1.6" class="ltx_Math" alttext="\bm{\tau}_{c_{i}}=\left\{\bm{\omega}_{1},\bm{\omega}_{2},\ldots,\bm{c}_{i},\ldots,\bm{\omega}_{L}\right\}" display="inline"><semantics id="S3.SS2.p1.1.m1.6a"><mrow id="S3.SS2.p1.1.m1.6.6" xref="S3.SS2.p1.1.m1.6.6.cmml"><msub id="S3.SS2.p1.1.m1.6.6.6" xref="S3.SS2.p1.1.m1.6.6.6.cmml"><mi id="S3.SS2.p1.1.m1.6.6.6.2" xref="S3.SS2.p1.1.m1.6.6.6.2.cmml">𝝉</mi><msub id="S3.SS2.p1.1.m1.6.6.6.3" xref="S3.SS2.p1.1.m1.6.6.6.3.cmml"><mi id="S3.SS2.p1.1.m1.6.6.6.3.2" xref="S3.SS2.p1.1.m1.6.6.6.3.2.cmml">c</mi><mi id="S3.SS2.p1.1.m1.6.6.6.3.3" xref="S3.SS2.p1.1.m1.6.6.6.3.3.cmml">i</mi></msub></msub><mo id="S3.SS2.p1.1.m1.6.6.5" xref="S3.SS2.p1.1.m1.6.6.5.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.6.6.4.4" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml"><mo id="S3.SS2.p1.1.m1.6.6.4.4.5" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">{</mo><msub id="S3.SS2.p1.1.m1.3.3.1.1.1" xref="S3.SS2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.3.3.1.1.1.2" xref="S3.SS2.p1.1.m1.3.3.1.1.1.2.cmml">𝝎</mi><mn id="S3.SS2.p1.1.m1.3.3.1.1.1.3" xref="S3.SS2.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.6.6.4.4.6" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">,</mo><msub id="S3.SS2.p1.1.m1.4.4.2.2.2" xref="S3.SS2.p1.1.m1.4.4.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.4.4.2.2.2.2" xref="S3.SS2.p1.1.m1.4.4.2.2.2.2.cmml">𝝎</mi><mn id="S3.SS2.p1.1.m1.4.4.2.2.2.3" xref="S3.SS2.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.1.m1.6.6.4.4.7" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.6.6.4.4.8" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">,</mo><msub id="S3.SS2.p1.1.m1.5.5.3.3.3" xref="S3.SS2.p1.1.m1.5.5.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.5.5.3.3.3.2" xref="S3.SS2.p1.1.m1.5.5.3.3.3.2.cmml">𝒄</mi><mi id="S3.SS2.p1.1.m1.5.5.3.3.3.3" xref="S3.SS2.p1.1.m1.5.5.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.p1.1.m1.6.6.4.4.9" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">…</mi><mo id="S3.SS2.p1.1.m1.6.6.4.4.10" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">,</mo><msub id="S3.SS2.p1.1.m1.6.6.4.4.4" xref="S3.SS2.p1.1.m1.6.6.4.4.4.cmml"><mi id="S3.SS2.p1.1.m1.6.6.4.4.4.2" xref="S3.SS2.p1.1.m1.6.6.4.4.4.2.cmml">𝝎</mi><mi id="S3.SS2.p1.1.m1.6.6.4.4.4.3" xref="S3.SS2.p1.1.m1.6.6.4.4.4.3.cmml">L</mi></msub><mo id="S3.SS2.p1.1.m1.6.6.4.4.11" xref="S3.SS2.p1.1.m1.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.6b"><apply id="S3.SS2.p1.1.m1.6.6.cmml" xref="S3.SS2.p1.1.m1.6.6"><eq id="S3.SS2.p1.1.m1.6.6.5.cmml" xref="S3.SS2.p1.1.m1.6.6.5"></eq><apply id="S3.SS2.p1.1.m1.6.6.6.cmml" xref="S3.SS2.p1.1.m1.6.6.6"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.6.1.cmml" xref="S3.SS2.p1.1.m1.6.6.6">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.6.2.cmml" xref="S3.SS2.p1.1.m1.6.6.6.2">𝝉</ci><apply id="S3.SS2.p1.1.m1.6.6.6.3.cmml" xref="S3.SS2.p1.1.m1.6.6.6.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.6.3.1.cmml" xref="S3.SS2.p1.1.m1.6.6.6.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.6.3.2.cmml" xref="S3.SS2.p1.1.m1.6.6.6.3.2">𝑐</ci><ci id="S3.SS2.p1.1.m1.6.6.6.3.3.cmml" xref="S3.SS2.p1.1.m1.6.6.6.3.3">𝑖</ci></apply></apply><set id="S3.SS2.p1.1.m1.6.6.4.5.cmml" xref="S3.SS2.p1.1.m1.6.6.4.4"><apply id="S3.SS2.p1.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.2">𝝎</ci><cn type="integer" id="S3.SS2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.1.m1.4.4.2.2.2.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.2.2">𝝎</ci><cn type="integer" id="S3.SS2.p1.1.m1.4.4.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.5.5.3.3.3.cmml" xref="S3.SS2.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.5.5.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.5.5.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.5.5.3.3.3.2">𝒄</ci><ci id="S3.SS2.p1.1.m1.5.5.3.3.3.3.cmml" xref="S3.SS2.p1.1.m1.5.5.3.3.3.3">𝑖</ci></apply><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">…</ci><apply id="S3.SS2.p1.1.m1.6.6.4.4.4.cmml" xref="S3.SS2.p1.1.m1.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.6.6.4.4.4.1.cmml" xref="S3.SS2.p1.1.m1.6.6.4.4.4">subscript</csymbol><ci id="S3.SS2.p1.1.m1.6.6.4.4.4.2.cmml" xref="S3.SS2.p1.1.m1.6.6.4.4.4.2">𝝎</ci><ci id="S3.SS2.p1.1.m1.6.6.4.4.4.3.cmml" xref="S3.SS2.p1.1.m1.6.6.4.4.4.3">𝐿</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.6c">\bm{\tau}_{c_{i}}=\left\{\bm{\omega}_{1},\bm{\omega}_{2},\ldots,\bm{c}_{i},\ldots,\bm{\omega}_{L}\right\}</annotation></semantics></math>, where <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\bm{c}_{i}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝒄</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝒄</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\bm{c}_{i}</annotation></semantics></math> signifies the word embedding of the <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msup id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.3.1" xref="S3.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑖</ci><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><times id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.1"></times><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">i^{th}</annotation></semantics></math> image class names, <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\bm{\omega}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">𝝎</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝝎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\bm{\omega}</annotation></semantics></math> is a collection of learnable vectors, denoted as <math id="S3.SS2.p1.5.m5.3" class="ltx_Math" alttext="\{\bm{\omega}_{i}|_{i=1}^{L}\}" display="inline"><semantics id="S3.SS2.p1.5.m5.3a"><mrow id="S3.SS2.p1.5.m5.3.3.1" xref="S3.SS2.p1.5.m5.3.3.2.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.3.3.1.2" xref="S3.SS2.p1.5.m5.3.3.2.cmml">{</mo><msubsup id="S3.SS2.p1.5.m5.3.3.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.2.cmml"><mrow id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.2.cmml"><msub id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.2" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.2.cmml">𝝎</mi><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.3" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.2" xref="S3.SS2.p1.5.m5.3.3.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.1.2" xref="S3.SS2.p1.5.m5.1.1.1.2.cmml">i</mi><mo id="S3.SS2.p1.5.m5.1.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.5.m5.1.1.1.3" xref="S3.SS2.p1.5.m5.1.1.1.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.5.m5.2.2.1" xref="S3.SS2.p1.5.m5.2.2.1.cmml">L</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.5.m5.3.3.1.3" xref="S3.SS2.p1.5.m5.3.3.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.3b"><set id="S3.SS2.p1.5.m5.3.3.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1"><apply id="S3.SS2.p1.5.m5.3.3.1.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.5.m5.3.3.1.1.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.2">𝝎</ci><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"><eq id="S3.SS2.p1.5.m5.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1.1"></eq><ci id="S3.SS2.p1.5.m5.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.1.2">𝑖</ci><cn type="integer" id="S3.SS2.p1.5.m5.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.5.m5.2.2.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.3c">\{\bm{\omega}_{i}|_{i=1}^{L}\}</annotation></semantics></math>, and <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">L</annotation></semantics></math> symbolizes the length of context words. Importantly, the position of <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="c_{i}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">c</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑐</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">c_{i}</annotation></semantics></math> can be placed anywhere between <math id="S3.SS2.p1.8.m8.2" class="ltx_Math" alttext="(1,L+1)" display="inline"><semantics id="S3.SS2.p1.8.m8.2a"><mrow id="S3.SS2.p1.8.m8.2.2.1" xref="S3.SS2.p1.8.m8.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m8.2.2.1.2" xref="S3.SS2.p1.8.m8.2.2.2.cmml">(</mo><mn id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">1</mn><mo id="S3.SS2.p1.8.m8.2.2.1.3" xref="S3.SS2.p1.8.m8.2.2.2.cmml">,</mo><mrow id="S3.SS2.p1.8.m8.2.2.1.1" xref="S3.SS2.p1.8.m8.2.2.1.1.cmml"><mi id="S3.SS2.p1.8.m8.2.2.1.1.2" xref="S3.SS2.p1.8.m8.2.2.1.1.2.cmml">L</mi><mo id="S3.SS2.p1.8.m8.2.2.1.1.1" xref="S3.SS2.p1.8.m8.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.8.m8.2.2.1.1.3" xref="S3.SS2.p1.8.m8.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS2.p1.8.m8.2.2.1.4" xref="S3.SS2.p1.8.m8.2.2.2.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.2b"><interval closure="open" id="S3.SS2.p1.8.m8.2.2.2.cmml" xref="S3.SS2.p1.8.m8.2.2.1"><cn type="integer" id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">1</cn><apply id="S3.SS2.p1.8.m8.2.2.1.1.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1"><plus id="S3.SS2.p1.8.m8.2.2.1.1.1.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.1"></plus><ci id="S3.SS2.p1.8.m8.2.2.1.1.2.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.2">𝐿</ci><cn type="integer" id="S3.SS2.p1.8.m8.2.2.1.1.3.cmml" xref="S3.SS2.p1.8.m8.2.2.1.1.3">1</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.2c">(1,L+1)</annotation></semantics></math>. In the training process, the textual prompt will be fed into a text encoder <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mrow id="S3.SS2.p1.9.m9.1.2" xref="S3.SS2.p1.9.m9.1.2.cmml"><mi id="S3.SS2.p1.9.m9.1.2.2" xref="S3.SS2.p1.9.m9.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m9.1.2.1" xref="S3.SS2.p1.9.m9.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.9.m9.1.2.3.2" xref="S3.SS2.p1.9.m9.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.9.m9.1.2.3.2.1" xref="S3.SS2.p1.9.m9.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.9.m9.1.2.3.2.2" xref="S3.SS2.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.2.cmml" xref="S3.SS2.p1.9.m9.1.2"><times id="S3.SS2.p1.9.m9.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.2.1"></times><ci id="S3.SS2.p1.9.m9.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.2.2">𝑔</ci><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">g(\cdot)</annotation></semantics></math>, obtaining the textual feature as <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="z_{\tau_{c_{i}}}=g(\bm{\tau}_{c_{i}})" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mrow id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><msub id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml"><mi id="S3.SS2.p1.10.m10.1.1.3.2" xref="S3.SS2.p1.10.m10.1.1.3.2.cmml">z</mi><msub id="S3.SS2.p1.10.m10.1.1.3.3" xref="S3.SS2.p1.10.m10.1.1.3.3.cmml"><mi id="S3.SS2.p1.10.m10.1.1.3.3.2" xref="S3.SS2.p1.10.m10.1.1.3.3.2.cmml">τ</mi><msub id="S3.SS2.p1.10.m10.1.1.3.3.3" xref="S3.SS2.p1.10.m10.1.1.3.3.3.cmml"><mi id="S3.SS2.p1.10.m10.1.1.3.3.3.2" xref="S3.SS2.p1.10.m10.1.1.3.3.3.2.cmml">c</mi><mi id="S3.SS2.p1.10.m10.1.1.3.3.3.3" xref="S3.SS2.p1.10.m10.1.1.3.3.3.3.cmml">i</mi></msub></msub></msub><mo id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.10.m10.1.1.1" xref="S3.SS2.p1.10.m10.1.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.1.3" xref="S3.SS2.p1.10.m10.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.10.m10.1.1.1.2" xref="S3.SS2.p1.10.m10.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.10.m10.1.1.1.1.1" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.10.m10.1.1.1.1.1.2" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.10.m10.1.1.1.1.1.1" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.1.1.1.1.2" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.2.cmml">𝝉</mi><msub id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.2.cmml">c</mi><mi id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.3" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S3.SS2.p1.10.m10.1.1.1.1.1.3" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><eq id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2"></eq><apply id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.3.2">𝑧</ci><apply id="S3.SS2.p1.10.m10.1.1.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.3.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.3.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3.2">𝜏</ci><apply id="S3.SS2.p1.10.m10.1.1.3.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.3.3.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.3.3.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3.3.2">𝑐</ci><ci id="S3.SS2.p1.10.m10.1.1.3.3.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1"><times id="S3.SS2.p1.10.m10.1.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.1.2"></times><ci id="S3.SS2.p1.10.m10.1.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.1.3">𝑔</ci><apply id="S3.SS2.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.2">𝝉</ci><apply id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">z_{\tau_{c_{i}}}=g(\bm{\tau}_{c_{i}})</annotation></semantics></math>. Similarly, the visual feature <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="z_{\upsilon}=f(\bm{x})" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mrow id="S3.SS2.p1.11.m11.1.2" xref="S3.SS2.p1.11.m11.1.2.cmml"><msub id="S3.SS2.p1.11.m11.1.2.2" xref="S3.SS2.p1.11.m11.1.2.2.cmml"><mi id="S3.SS2.p1.11.m11.1.2.2.2" xref="S3.SS2.p1.11.m11.1.2.2.2.cmml">z</mi><mi id="S3.SS2.p1.11.m11.1.2.2.3" xref="S3.SS2.p1.11.m11.1.2.2.3.cmml">υ</mi></msub><mo id="S3.SS2.p1.11.m11.1.2.1" xref="S3.SS2.p1.11.m11.1.2.1.cmml">=</mo><mrow id="S3.SS2.p1.11.m11.1.2.3" xref="S3.SS2.p1.11.m11.1.2.3.cmml"><mi id="S3.SS2.p1.11.m11.1.2.3.2" xref="S3.SS2.p1.11.m11.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.11.m11.1.2.3.1" xref="S3.SS2.p1.11.m11.1.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.11.m11.1.2.3.3.2" xref="S3.SS2.p1.11.m11.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.11.m11.1.2.3.3.2.1" xref="S3.SS2.p1.11.m11.1.2.3.cmml">(</mo><mi id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">𝒙</mi><mo stretchy="false" id="S3.SS2.p1.11.m11.1.2.3.3.2.2" xref="S3.SS2.p1.11.m11.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.2.cmml" xref="S3.SS2.p1.11.m11.1.2"><eq id="S3.SS2.p1.11.m11.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.2.1"></eq><apply id="S3.SS2.p1.11.m11.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.2.2.1.cmml" xref="S3.SS2.p1.11.m11.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.2.2.2.cmml" xref="S3.SS2.p1.11.m11.1.2.2.2">𝑧</ci><ci id="S3.SS2.p1.11.m11.1.2.2.3.cmml" xref="S3.SS2.p1.11.m11.1.2.2.3">𝜐</ci></apply><apply id="S3.SS2.p1.11.m11.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.2.3"><times id="S3.SS2.p1.11.m11.1.2.3.1.cmml" xref="S3.SS2.p1.11.m11.1.2.3.1"></times><ci id="S3.SS2.p1.11.m11.1.2.3.2.cmml" xref="S3.SS2.p1.11.m11.1.2.3.2">𝑓</ci><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">z_{\upsilon}=f(\bm{x})</annotation></semantics></math> is calculated by visual encoder <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mrow id="S3.SS2.p1.12.m12.1.2" xref="S3.SS2.p1.12.m12.1.2.cmml"><mi id="S3.SS2.p1.12.m12.1.2.2" xref="S3.SS2.p1.12.m12.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.12.m12.1.2.1" xref="S3.SS2.p1.12.m12.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.12.m12.1.2.3.2" xref="S3.SS2.p1.12.m12.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.12.m12.1.2.3.2.1" xref="S3.SS2.p1.12.m12.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.12.m12.1.2.3.2.2" xref="S3.SS2.p1.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.2.cmml" xref="S3.SS2.p1.12.m12.1.2"><times id="S3.SS2.p1.12.m12.1.2.1.cmml" xref="S3.SS2.p1.12.m12.1.2.1"></times><ci id="S3.SS2.p1.12.m12.1.2.2.cmml" xref="S3.SS2.p1.12.m12.1.2.2">𝑓</ci><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">f(\cdot)</annotation></semantics></math>. The final prediction probability is computed by the negative log likelihood matching score:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="\vspace{-3pt}\ell_{con}(z_{\tau_{c_{i}}},z_{\upsilon})=-\log p(y=c_{i}\mid\bm{x})=-\log\frac{\exp\big{(}\operatorname{sim}\big{(}z_{\tau_{c_{i}}},z_{\upsilon}\big{)}/\Gamma\big{)}}{\sum_{j}\exp\big{(}\operatorname{sim}\big{(}z_{\tau_{c_{i}}},z_{\upsilon}\big{)}/\Gamma\big{)}}," display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml"><msub id="S3.E2.m1.7.7.1.1.2.4" xref="S3.E2.m1.7.7.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.1.1.2.4.2" xref="S3.E2.m1.7.7.1.1.2.4.2.cmml">ℓ</mi><mrow id="S3.E2.m1.7.7.1.1.2.4.3" xref="S3.E2.m1.7.7.1.1.2.4.3.cmml"><mi id="S3.E2.m1.7.7.1.1.2.4.3.2" xref="S3.E2.m1.7.7.1.1.2.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.2.4.3.1" xref="S3.E2.m1.7.7.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E2.m1.7.7.1.1.2.4.3.3" xref="S3.E2.m1.7.7.1.1.2.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.2.4.3.1a" xref="S3.E2.m1.7.7.1.1.2.4.3.1.cmml">​</mo><mi id="S3.E2.m1.7.7.1.1.2.4.3.4" xref="S3.E2.m1.7.7.1.1.2.4.3.4.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.2.3" xref="S3.E2.m1.7.7.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.2.2.2" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.2.2.2.3" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml">(</mo><msub id="S3.E2.m1.7.7.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2.cmml">z</mi><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.2.cmml">τ</mi><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.2.cmml">c</mi><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></msub><mo id="S3.E2.m1.7.7.1.1.2.2.2.4" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml">,</mo><msub id="S3.E2.m1.7.7.1.1.2.2.2.2" xref="S3.E2.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.7.7.1.1.2.2.2.2.2" xref="S3.E2.m1.7.7.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.7.7.1.1.2.2.2.2.3" xref="S3.E2.m1.7.7.1.1.2.2.2.2.3.cmml">υ</mi></msub><mo stretchy="false" id="S3.E2.m1.7.7.1.1.2.2.2.5" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.1.1.5" xref="S3.E2.m1.7.7.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml"><mo rspace="0.167em" id="S3.E2.m1.7.7.1.1.3a" xref="S3.E2.m1.7.7.1.1.3.cmml">−</mo><mrow id="S3.E2.m1.7.7.1.1.3.1" xref="S3.E2.m1.7.7.1.1.3.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.3.1.3" xref="S3.E2.m1.7.7.1.1.3.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.3.1.3.1" xref="S3.E2.m1.7.7.1.1.3.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.7.7.1.1.3.1.3a" xref="S3.E2.m1.7.7.1.1.3.1.3.cmml">⁡</mo><mi id="S3.E2.m1.7.7.1.1.3.1.3.2" xref="S3.E2.m1.7.7.1.1.3.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.3.1.2" xref="S3.E2.m1.7.7.1.1.3.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.3.1.1.1" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.3.1.1.1.2" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.3.1.1.1.1" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.3.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.2.cmml">y</mi><mo id="S3.E2.m1.7.7.1.1.3.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.cmml"><msub id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.cmml"><mi id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.2" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.2.cmml">c</mi><mi id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.3" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.1" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.1.cmml">∣</mo><mi id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.3.cmml">𝒙</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.7.7.1.1.3.1.1.1.3" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.7.7.1.1.6" xref="S3.E2.m1.7.7.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.7" xref="S3.E2.m1.7.7.1.1.7.cmml"><mo rspace="0.167em" id="S3.E2.m1.7.7.1.1.7a" xref="S3.E2.m1.7.7.1.1.7.cmml">−</mo><mrow id="S3.E2.m1.7.7.1.1.7.2" xref="S3.E2.m1.7.7.1.1.7.2.cmml"><mi id="S3.E2.m1.7.7.1.1.7.2.1" xref="S3.E2.m1.7.7.1.1.7.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.7.7.1.1.7.2a" xref="S3.E2.m1.7.7.1.1.7.2.cmml">⁡</mo><mfrac id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.4.cmml"><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E2.m1.3.3.3.3a" xref="S3.E2.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.3.3.1" xref="S3.E2.m1.3.3.3.4.cmml"><mo maxsize="120%" minsize="120%" id="S3.E2.m1.3.3.3.3.1.2" xref="S3.E2.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E2.m1.3.3.3.3.1.1" xref="S3.E2.m1.3.3.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.3.3.1.1.2.2" xref="S3.E2.m1.3.3.3.3.1.1.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">sim</mi><mo id="S3.E2.m1.3.3.3.3.1.1.2.2a" xref="S3.E2.m1.3.3.3.3.1.1.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.3.3.1.1.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S3.E2.m1.3.3.3.3.1.1.2.2.2.3" xref="S3.E2.m1.3.3.3.3.1.1.2.3.cmml">(</mo><msub id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">z</mi><msub id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml">τ</mi><msub id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml">c</mi><mi id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></msub><mo id="S3.E2.m1.3.3.3.3.1.1.2.2.2.4" xref="S3.E2.m1.3.3.3.3.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.2" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.3" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.3.cmml">υ</mi></msub><mo maxsize="120%" minsize="120%" id="S3.E2.m1.3.3.3.3.1.1.2.2.2.5" xref="S3.E2.m1.3.3.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.3.3.3.3.1.1.3" xref="S3.E2.m1.3.3.3.3.1.1.3.cmml">/</mo><mi mathvariant="normal" id="S3.E2.m1.3.3.3.3.1.1.4" xref="S3.E2.m1.3.3.3.3.1.1.4.cmml">Γ</mi></mrow><mo maxsize="120%" minsize="120%" id="S3.E2.m1.3.3.3.3.1.3" xref="S3.E2.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E2.m1.6.6.6" xref="S3.E2.m1.6.6.6.cmml"><msub id="S3.E2.m1.6.6.6.4" xref="S3.E2.m1.6.6.6.4.cmml"><mo id="S3.E2.m1.6.6.6.4.2" xref="S3.E2.m1.6.6.6.4.2.cmml">∑</mo><mi id="S3.E2.m1.6.6.6.4.3" xref="S3.E2.m1.6.6.6.4.3.cmml">j</mi></msub><mrow id="S3.E2.m1.6.6.6.3.1" xref="S3.E2.m1.6.6.6.3.2.cmml"><mi id="S3.E2.m1.5.5.5.2" xref="S3.E2.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E2.m1.6.6.6.3.1a" xref="S3.E2.m1.6.6.6.3.2.cmml">⁡</mo><mrow id="S3.E2.m1.6.6.6.3.1.1" xref="S3.E2.m1.6.6.6.3.2.cmml"><mo maxsize="120%" minsize="120%" id="S3.E2.m1.6.6.6.3.1.1.2" xref="S3.E2.m1.6.6.6.3.2.cmml">(</mo><mrow id="S3.E2.m1.6.6.6.3.1.1.1" xref="S3.E2.m1.6.6.6.3.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.6.3.1.1.1.2.2" xref="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml"><mi id="S3.E2.m1.4.4.4.1" xref="S3.E2.m1.4.4.4.1.cmml">sim</mi><mo id="S3.E2.m1.6.6.6.3.1.1.1.2.2a" xref="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2" xref="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.3" xref="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml">(</mo><msub id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml">z</mi><msub id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.cmml">τ</mi><msub id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.2.cmml">c</mi><mi id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.3" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub></msub><mo id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.4" xref="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.2" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.3" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.3.cmml">υ</mi></msub><mo maxsize="120%" minsize="120%" id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.5" xref="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.3.1.1.1.3" xref="S3.E2.m1.6.6.6.3.1.1.1.3.cmml">/</mo><mi mathvariant="normal" id="S3.E2.m1.6.6.6.3.1.1.1.4" xref="S3.E2.m1.6.6.6.3.1.1.1.4.cmml">Γ</mi></mrow><mo maxsize="120%" minsize="120%" id="S3.E2.m1.6.6.6.3.1.1.3" xref="S3.E2.m1.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1"><and id="S3.E2.m1.7.7.1.1a.cmml" xref="S3.E2.m1.7.7.1"></and><apply id="S3.E2.m1.7.7.1.1b.cmml" xref="S3.E2.m1.7.7.1"><eq id="S3.E2.m1.7.7.1.1.5.cmml" xref="S3.E2.m1.7.7.1.1.5"></eq><apply id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"><times id="S3.E2.m1.7.7.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.3"></times><apply id="S3.E2.m1.7.7.1.1.2.4.cmml" xref="S3.E2.m1.7.7.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.4.1.cmml" xref="S3.E2.m1.7.7.1.1.2.4">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.4.2.cmml" xref="S3.E2.m1.7.7.1.1.2.4.2">ℓ</ci><apply id="S3.E2.m1.7.7.1.1.2.4.3.cmml" xref="S3.E2.m1.7.7.1.1.2.4.3"><times id="S3.E2.m1.7.7.1.1.2.4.3.1.cmml" xref="S3.E2.m1.7.7.1.1.2.4.3.1"></times><ci id="S3.E2.m1.7.7.1.1.2.4.3.2.cmml" xref="S3.E2.m1.7.7.1.1.2.4.3.2">𝑐</ci><ci id="S3.E2.m1.7.7.1.1.2.4.3.3.cmml" xref="S3.E2.m1.7.7.1.1.2.4.3.3">𝑜</ci><ci id="S3.E2.m1.7.7.1.1.2.4.3.4.cmml" xref="S3.E2.m1.7.7.1.1.2.4.3.4">𝑛</ci></apply></apply><interval closure="open" id="S3.E2.m1.7.7.1.1.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2"><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.2">𝜏</ci><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2.3">𝜐</ci></apply></interval></apply><apply id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"><minus id="S3.E2.m1.7.7.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3"></minus><apply id="S3.E2.m1.7.7.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1"><times id="S3.E2.m1.7.7.1.1.3.1.2.cmml" xref="S3.E2.m1.7.7.1.1.3.1.2"></times><apply id="S3.E2.m1.7.7.1.1.3.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3.1.3"><log id="S3.E2.m1.7.7.1.1.3.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1.3.1"></log><ci id="S3.E2.m1.7.7.1.1.3.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.1.3.2">𝑝</ci></apply><apply id="S3.E2.m1.7.7.1.1.3.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1"><eq id="S3.E2.m1.7.7.1.1.3.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.1"></eq><ci id="S3.E2.m1.7.7.1.1.3.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.2">𝑦</ci><apply id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3"><csymbol cd="latexml" id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.1">conditional</csymbol><apply id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.2">𝑐</ci><ci id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.1.1.1.1.3.3">𝒙</ci></apply></apply></apply></apply></apply><apply id="S3.E2.m1.7.7.1.1c.cmml" xref="S3.E2.m1.7.7.1"><eq id="S3.E2.m1.7.7.1.1.6.cmml" xref="S3.E2.m1.7.7.1.1.6"></eq><share href="#S3.E2.m1.7.7.1.1.3.cmml" id="S3.E2.m1.7.7.1.1d.cmml" xref="S3.E2.m1.7.7.1"></share><apply id="S3.E2.m1.7.7.1.1.7.cmml" xref="S3.E2.m1.7.7.1.1.7"><minus id="S3.E2.m1.7.7.1.1.7.1.cmml" xref="S3.E2.m1.7.7.1.1.7"></minus><apply id="S3.E2.m1.7.7.1.1.7.2.cmml" xref="S3.E2.m1.7.7.1.1.7.2"><log id="S3.E2.m1.7.7.1.1.7.2.1.cmml" xref="S3.E2.m1.7.7.1.1.7.2.1"></log><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><divide id="S3.E2.m1.6.6.7.cmml" xref="S3.E2.m1.6.6"></divide><apply id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.3"><exp id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"></exp><apply id="S3.E2.m1.3.3.3.3.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1"><divide id="S3.E2.m1.3.3.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.3"></divide><apply id="S3.E2.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">sim</ci><apply id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.2">𝜏</ci><apply id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.1.1.2.2.2.2.3">𝜐</ci></apply></apply><ci id="S3.E2.m1.3.3.3.3.1.1.4.cmml" xref="S3.E2.m1.3.3.3.3.1.1.4">Γ</ci></apply></apply><apply id="S3.E2.m1.6.6.6.cmml" xref="S3.E2.m1.6.6.6"><apply id="S3.E2.m1.6.6.6.4.cmml" xref="S3.E2.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.4.1.cmml" xref="S3.E2.m1.6.6.6.4">subscript</csymbol><sum id="S3.E2.m1.6.6.6.4.2.cmml" xref="S3.E2.m1.6.6.6.4.2"></sum><ci id="S3.E2.m1.6.6.6.4.3.cmml" xref="S3.E2.m1.6.6.6.4.3">𝑗</ci></apply><apply id="S3.E2.m1.6.6.6.3.2.cmml" xref="S3.E2.m1.6.6.6.3.1"><exp id="S3.E2.m1.5.5.5.2.cmml" xref="S3.E2.m1.5.5.5.2"></exp><apply id="S3.E2.m1.6.6.6.3.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1"><divide id="S3.E2.m1.6.6.6.3.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.3"></divide><apply id="S3.E2.m1.6.6.6.3.1.1.1.2.3.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2"><ci id="S3.E2.m1.4.4.4.1.cmml" xref="S3.E2.m1.4.4.4.1">sim</ci><apply id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.2">𝜏</ci><apply id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.2">𝑐</ci><ci id="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.2.2.2.2.3">𝜐</ci></apply></apply><ci id="S3.E2.m1.6.6.6.3.1.1.1.4.cmml" xref="S3.E2.m1.6.6.6.3.1.1.1.4">Γ</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\vspace{-3pt}\ell_{con}(z_{\tau_{c_{i}}},z_{\upsilon})=-\log p(y=c_{i}\mid\bm{x})=-\log\frac{\exp\big{(}\operatorname{sim}\big{(}z_{\tau_{c_{i}}},z_{\upsilon}\big{)}/\Gamma\big{)}}{\sum_{j}\exp\big{(}\operatorname{sim}\big{(}z_{\tau_{c_{i}}},z_{\upsilon}\big{)}/\Gamma\big{)}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.14" class="ltx_p">where <math id="S3.SS2.p1.13.m1.3" class="ltx_Math" alttext="\operatorname{sim}(\cdot,\cdot)" display="inline"><semantics id="S3.SS2.p1.13.m1.3a"><mrow id="S3.SS2.p1.13.m1.3.4.2" xref="S3.SS2.p1.13.m1.3.4.1.cmml"><mi id="S3.SS2.p1.13.m1.1.1" xref="S3.SS2.p1.13.m1.1.1.cmml">sim</mi><mo id="S3.SS2.p1.13.m1.3.4.2a" xref="S3.SS2.p1.13.m1.3.4.1.cmml">⁡</mo><mrow id="S3.SS2.p1.13.m1.3.4.2.1" xref="S3.SS2.p1.13.m1.3.4.1.cmml"><mo stretchy="false" id="S3.SS2.p1.13.m1.3.4.2.1.1" xref="S3.SS2.p1.13.m1.3.4.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.13.m1.2.2" xref="S3.SS2.p1.13.m1.2.2.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p1.13.m1.3.4.2.1.2" xref="S3.SS2.p1.13.m1.3.4.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p1.13.m1.3.3" xref="S3.SS2.p1.13.m1.3.3.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p1.13.m1.3.4.2.1.3" xref="S3.SS2.p1.13.m1.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m1.3b"><apply id="S3.SS2.p1.13.m1.3.4.1.cmml" xref="S3.SS2.p1.13.m1.3.4.2"><ci id="S3.SS2.p1.13.m1.1.1.cmml" xref="S3.SS2.p1.13.m1.1.1">sim</ci><ci id="S3.SS2.p1.13.m1.2.2.cmml" xref="S3.SS2.p1.13.m1.2.2">⋅</ci><ci id="S3.SS2.p1.13.m1.3.3.cmml" xref="S3.SS2.p1.13.m1.3.3">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m1.3c">\operatorname{sim}(\cdot,\cdot)</annotation></semantics></math> function represents the similarity function, <math id="S3.SS2.p1.14.m2.1" class="ltx_Math" alttext="\Gamma\in\mathbb{R}" display="inline"><semantics id="S3.SS2.p1.14.m2.1a"><mrow id="S3.SS2.p1.14.m2.1.1" xref="S3.SS2.p1.14.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.14.m2.1.1.2" xref="S3.SS2.p1.14.m2.1.1.2.cmml">Γ</mi><mo id="S3.SS2.p1.14.m2.1.1.1" xref="S3.SS2.p1.14.m2.1.1.1.cmml">∈</mo><mi id="S3.SS2.p1.14.m2.1.1.3" xref="S3.SS2.p1.14.m2.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m2.1b"><apply id="S3.SS2.p1.14.m2.1.1.cmml" xref="S3.SS2.p1.14.m2.1.1"><in id="S3.SS2.p1.14.m2.1.1.1.cmml" xref="S3.SS2.p1.14.m2.1.1.1"></in><ci id="S3.SS2.p1.14.m2.1.1.2.cmml" xref="S3.SS2.p1.14.m2.1.1.2">Γ</ci><ci id="S3.SS2.p1.14.m2.1.1.3.cmml" xref="S3.SS2.p1.14.m2.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m2.1c">\Gamma\in\mathbb{R}</annotation></semantics></math> is the temperature factor to control the overall distribution of the similarity between the embedding of the visual feature and test feature.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.3" class="ltx_p">Different from the previous work, which solely obtains a single modal to represent a local client, our study introduces TPFL to resort to two different modalities, vision and text, to enhance the generalization capability and resilience of the global model. More specifically, instead of relying on a constant input visual feature <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">x</annotation></semantics></math>, we incorporate an additional trainable visual prompt <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\upsilon" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">υ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝜐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\upsilon</annotation></semantics></math> as an extended representation for the local data characterization and conduct <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="x+\upsilon" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">x</mi><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">+</mo><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">υ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><plus id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></plus><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝜐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">x+\upsilon</annotation></semantics></math> to get the final input feature. As illustrated in <a href="#S1.F1" title="In 1. Introduction ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>, three templates of the visual prompt are employed: the padding, random patch, and fixed patch patterns, each contributing to varying model performances. After acquiring both the textual and visual prompts, each local client transmits them to the central server. The server then aggregated the received prompts, in light of the number of their training samples:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\bm{\tau}_{g}\leftarrow\sum_{i=1}^{K}\frac{n_{i}}{\sum_{j=1}^{K}n_{j}}\bm{\tau}_{i},\quad\bm{\upsilon}_{g}\leftarrow\sum_{i=1}^{K}\frac{n_{i}}{\sum_{j=1}^{K}n_{j}}\bm{\upsilon}_{i}." display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1"><mrow id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.3.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">𝝉</mi><mi id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">g</mi></msub><mo rspace="0.111em" stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">←</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E3.m1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.1.1.1.1.3.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.3.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mrow id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.cmml"><msubsup id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.2.cmml">j</mi><mo id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.3.cmml">K</mi></msubsup><msub id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.2.cmml">n</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.3.2.1" xref="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.cmml">𝝉</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E3.m1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E3.m1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.cmml"><msub id="S3.E3.m1.1.1.1.1.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.2.2.cmml">𝝊</mi><mi id="S3.E3.m1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.2.3.cmml">g</mi></msub><mo rspace="0.111em" stretchy="false" id="S3.E3.m1.1.1.1.1.2.2.1" xref="S3.E3.m1.1.1.1.1.2.2.1.cmml">←</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.cmml"><munderover id="S3.E3.m1.1.1.1.1.2.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.1.1.2.2.3.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.2.2.3.1.3" xref="S3.E3.m1.1.1.1.1.2.2.3.1.3.cmml">K</mi></munderover><mrow id="S3.E3.m1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.cmml"><mfrac id="S3.E3.m1.1.1.1.1.2.2.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.cmml"><msub id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.2.cmml">n</mi><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.3.cmml">i</mi></msub><mrow id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.cmml"><msubsup id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.cmml"><mo id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.2.cmml">j</mi><mo id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.1" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.3.cmml">K</mi></msubsup><msub id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.2.cmml">n</mi><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.2.2.3.2.1" xref="S3.E3.m1.1.1.1.1.2.2.3.2.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.2.2.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.3.2" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3.2.cmml">𝝊</mi><mi id="S3.E3.m1.1.1.1.1.2.2.3.2.3.3" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><ci id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">←</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">𝝉</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">𝑔</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><apply id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2"><times id="S3.E3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2"><divide id="S3.E3.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2"></divide><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3"><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.1.3">𝐾</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.2">𝑛</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.2">𝝉</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2"><ci id="S3.E3.m1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1">←</ci><apply id="S3.E3.m1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.2">𝝊</ci><ci id="S3.E3.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.2.3">𝑔</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3"><apply id="S3.E3.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.2.2.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.2.2.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.1.3">𝐾</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2"><times id="S3.E3.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2"><divide id="S3.E3.m1.1.1.1.1.2.2.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2"></divide><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.2">𝑛</ci><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3"><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3"><eq id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.1.3">𝐾</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.2">𝑛</ci><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3.2">𝝊</ci><ci id="S3.E3.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\bm{\tau}_{g}\leftarrow\sum_{i=1}^{K}\frac{n_{i}}{\sum_{j=1}^{K}n_{j}}\bm{\tau}_{i},\quad\bm{\upsilon}_{g}\leftarrow\sum_{i=1}^{K}\frac{n_{i}}{\sum_{j=1}^{K}n_{j}}\bm{\upsilon}_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.4" class="ltx_p">However, the naive aggregation of the uploaded model weights may invite certain problems. To begin with, in practical scenarios, the data distribution across multiple clients may not be independently and identically distributed (IID). In other words, different clients can host data with significantly divergent statistical characteristics. The direct averaging of models struggles to effectively amalgamate local models originating from these devices, owing to this non-IID data distribution, and as a result, the performance of the global model suffers. Moreover, data volume can significantly vary across devices, with certain scenarios providing only a sparse dataset (only a few data points are available). Conventional FL aggregation might lack the robustness required to manage these few-shot learning scenarios, thereby complicating the process of discerning meaningful patterns from such limited data.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Augmented TPFL (ATPFL)</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.15" class="ltx_p">To address these aforementioned challenges, we propose the incorporation of a contrastive learning strategy, thus fortifying the robustness of FL. Specifically, we utilize the InfoNCE loss function <cite class="ltx_cite ltx_citemacro_citep">(Oord et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite> to encourage the output distributions of both the local visual and textual prompts to align closely with the output distribution of the global model. This methodology fosters a better comprehension of the global model by the local client, consequently mitigating the adverse effects of non-IID data. The key insight fueling this strategy is that contrastive learning facilitates the distinction between similar and dissimilar data points. It mitigates the discrepancies among local models caused by non-IID data through the learning of invariant features, making local models more amenable to aggregation at the global level. The contrastive (InfoNCE) loss functions for both textual and visual prompts are formulated in (<a href="#S3.E4" title="Equation 4 ‣ 3.3. Augmented TPFL (ATPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>):</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.23" class="ltx_Math" alttext="\ell_{con\_aug}(z^{t+1},z^{t}_{g},z^{t})=\\
-\log\frac{\exp\big{(}\operatorname{sim}\big{(}z^{t+1},z^{t}_{g}\big{)}/\Gamma\big{)}}{\exp\big{(}\operatorname{sim}\big{(}z^{t+1},z^{t}_{g}\big{)}/\Gamma\big{)}+\exp\left(\operatorname{sim}\left(z^{t+1},z^{t}\right)/\Gamma\right)}," display="block"><semantics id="S3.E4.m1.23a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E4.m1.23.23.5"><mtr id="S3.E4.m1.23.23.5a"><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.23.23.5b"><mrow id="S3.E4.m1.22.22.4.21.17.17"><mrow id="S3.E4.m1.22.22.4.21.17.17.17"><msub id="S3.E4.m1.22.22.4.21.17.17.17.5"><mi mathvariant="normal" id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">ℓ</mi><mrow id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.2.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.1a" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.4" xref="S3.E4.m1.2.2.2.2.2.2.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.1b" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.E4.m1.2.2.2.2.2.2.1.5" xref="S3.E4.m1.2.2.2.2.2.2.1.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.1c" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.6" xref="S3.E4.m1.2.2.2.2.2.2.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.1d" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.7" xref="S3.E4.m1.2.2.2.2.2.2.1.7.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.1e" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E4.m1.2.2.2.2.2.2.1.8" xref="S3.E4.m1.2.2.2.2.2.2.1.8.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.22.22.4.21.17.17.17.4" xref="S3.E4.m1.19.19.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.22.22.4.21.17.17.17.3.3"><mo stretchy="false" id="S3.E4.m1.3.3.3.3.3.3" xref="S3.E4.m1.19.19.1.1.1.cmml">(</mo><msup id="S3.E4.m1.20.20.2.19.15.15.15.1.1.1"><mi id="S3.E4.m1.4.4.4.4.4.4" xref="S3.E4.m1.4.4.4.4.4.4.cmml">z</mi><mrow id="S3.E4.m1.5.5.5.5.5.5.1" xref="S3.E4.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E4.m1.5.5.5.5.5.5.1.2" xref="S3.E4.m1.5.5.5.5.5.5.1.2.cmml">t</mi><mo id="S3.E4.m1.5.5.5.5.5.5.1.1" xref="S3.E4.m1.5.5.5.5.5.5.1.1.cmml">+</mo><mn id="S3.E4.m1.5.5.5.5.5.5.1.3" xref="S3.E4.m1.5.5.5.5.5.5.1.3.cmml">1</mn></mrow></msup><mo id="S3.E4.m1.6.6.6.6.6.6" xref="S3.E4.m1.19.19.1.1.1.cmml">,</mo><msubsup id="S3.E4.m1.21.21.3.20.16.16.16.2.2.2"><mi id="S3.E4.m1.7.7.7.7.7.7" xref="S3.E4.m1.7.7.7.7.7.7.cmml">z</mi><mi id="S3.E4.m1.9.9.9.9.9.9.1" xref="S3.E4.m1.9.9.9.9.9.9.1.cmml">g</mi><mi id="S3.E4.m1.8.8.8.8.8.8.1" xref="S3.E4.m1.8.8.8.8.8.8.1.cmml">t</mi></msubsup><mo id="S3.E4.m1.10.10.10.10.10.10" xref="S3.E4.m1.19.19.1.1.1.cmml">,</mo><msup id="S3.E4.m1.22.22.4.21.17.17.17.3.3.3"><mi id="S3.E4.m1.11.11.11.11.11.11" xref="S3.E4.m1.11.11.11.11.11.11.cmml">z</mi><mi id="S3.E4.m1.12.12.12.12.12.12.1" xref="S3.E4.m1.12.12.12.12.12.12.1.cmml">t</mi></msup><mo stretchy="false" id="S3.E4.m1.13.13.13.13.13.13" xref="S3.E4.m1.19.19.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.14.14.14.14.14.14" xref="S3.E4.m1.14.14.14.14.14.14.cmml">=</mo><mi id="S3.E4.m1.22.22.4.21.17.17.18" xref="S3.E4.m1.19.19.1.1.1.cmml"></mi></mrow></mtd></mtr><mtr id="S3.E4.m1.23.23.5c"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.23.23.5d"><mrow id="S3.E4.m1.23.23.5.22.5.5.5"><mrow id="S3.E4.m1.23.23.5.22.5.5.5.1"><mo rspace="0.167em" id="S3.E4.m1.23.23.5.22.5.5.5.1a" xref="S3.E4.m1.19.19.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.23.23.5.22.5.5.5.1.1"><mi id="S3.E4.m1.16.16.16.2.2.2" xref="S3.E4.m1.16.16.16.2.2.2.cmml">log</mi><mo lspace="0.167em" id="S3.E4.m1.23.23.5.22.5.5.5.1.1a" xref="S3.E4.m1.19.19.1.1.1.cmml">⁡</mo><mfrac id="S3.E4.m1.17.17.17.3.3.3" xref="S3.E4.m1.17.17.17.3.3.3.cmml"><mrow id="S3.E4.m1.17.17.17.3.3.3.3.3" xref="S3.E4.m1.17.17.17.3.3.3.3.4.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.2.2" xref="S3.E4.m1.17.17.17.3.3.3.2.2.cmml">exp</mi><mo id="S3.E4.m1.17.17.17.3.3.3.3.3a" xref="S3.E4.m1.17.17.17.3.3.3.3.4.cmml">⁡</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.3.3.1" xref="S3.E4.m1.17.17.17.3.3.3.3.4.cmml"><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.2" xref="S3.E4.m1.17.17.17.3.3.3.3.4.cmml">(</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.cmml"><mrow id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.1.1" xref="S3.E4.m1.17.17.17.3.3.3.1.1.cmml">sim</mi><mo id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2a" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml">(</mo><msup id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.1" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.3" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.4" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.3.cmml">g</mi><mi id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.5" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.3.cmml">/</mo><mi mathvariant="normal" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.4" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.4.cmml">Γ</mi></mrow><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.3" xref="S3.E4.m1.17.17.17.3.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E4.m1.17.17.17.3.3.3.9" xref="S3.E4.m1.17.17.17.3.3.3.9.cmml"><mrow id="S3.E4.m1.17.17.17.3.3.3.8.5.1" xref="S3.E4.m1.17.17.17.3.3.3.8.5.2.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.5.2" xref="S3.E4.m1.17.17.17.3.3.3.5.2.cmml">exp</mi><mo id="S3.E4.m1.17.17.17.3.3.3.8.5.1a" xref="S3.E4.m1.17.17.17.3.3.3.8.5.2.cmml">⁡</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1" xref="S3.E4.m1.17.17.17.3.3.3.8.5.2.cmml"><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.2.cmml">(</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.cmml"><mrow id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.4.1" xref="S3.E4.m1.17.17.17.3.3.3.4.1.cmml">sim</mi><mo id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2a" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml">(</mo><msup id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.4" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml">,</mo><msubsup id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.3.cmml">g</mi><mi id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.5" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.3.cmml">/</mo><mi mathvariant="normal" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.4" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.4.cmml">Γ</mi></mrow><mo maxsize="120%" minsize="120%" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.8.5.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.17.17.17.3.3.3.9.7" xref="S3.E4.m1.17.17.17.3.3.3.9.7.cmml">+</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.9.6.1" xref="S3.E4.m1.17.17.17.3.3.3.9.6.2.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.7.4" xref="S3.E4.m1.17.17.17.3.3.3.7.4.cmml">exp</mi><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1a" xref="S3.E4.m1.17.17.17.3.3.3.9.6.2.cmml">⁡</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1" xref="S3.E4.m1.17.17.17.3.3.3.9.6.2.cmml"><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.2.cmml">(</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.cmml"><mrow id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.6.3" xref="S3.E4.m1.17.17.17.3.3.3.6.3.cmml">sim</mi><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2a" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml"><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml">(</mo><msup id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.4" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml">,</mo><msup id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.2" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.3" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.3.cmml">t</mi></msup><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.5" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.3.cmml">/</mo><mi mathvariant="normal" id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.4" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.4.cmml">Γ</mi></mrow><mo id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.3" xref="S3.E4.m1.17.17.17.3.3.3.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E4.m1.18.18.18.4.4.4" xref="S3.E4.m1.19.19.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.23b"><apply id="S3.E4.m1.19.19.1.1.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><eq id="S3.E4.m1.14.14.14.14.14.14.cmml" xref="S3.E4.m1.14.14.14.14.14.14"></eq><apply id="S3.E4.m1.19.19.1.1.1.3.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><times id="S3.E4.m1.19.19.1.1.1.3.4.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"></times><apply id="S3.E4.m1.19.19.1.1.1.3.5.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><csymbol cd="ambiguous" id="S3.E4.m1.19.19.1.1.1.3.5.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">ℓ</ci><apply id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1"><times id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2">𝑐</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3">𝑜</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.4.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.4">𝑛</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.5.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.5">_</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.6.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.6">𝑎</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.7.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.7">𝑢</ci><ci id="S3.E4.m1.2.2.2.2.2.2.1.8.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.8">𝑔</ci></apply></apply><vector id="S3.E4.m1.19.19.1.1.1.3.3.4.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><apply id="S3.E4.m1.19.19.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><csymbol cd="ambiguous" id="S3.E4.m1.19.19.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4">superscript</csymbol><ci id="S3.E4.m1.4.4.4.4.4.4.cmml" xref="S3.E4.m1.4.4.4.4.4.4">𝑧</ci><apply id="S3.E4.m1.5.5.5.5.5.5.1.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1"><plus id="S3.E4.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.1"></plus><ci id="S3.E4.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.2">𝑡</ci><cn type="integer" id="S3.E4.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E4.m1.5.5.5.5.5.5.1.3">1</cn></apply></apply><apply id="S3.E4.m1.19.19.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><csymbol cd="ambiguous" id="S3.E4.m1.19.19.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4">subscript</csymbol><apply id="S3.E4.m1.19.19.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><csymbol cd="ambiguous" id="S3.E4.m1.19.19.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4">superscript</csymbol><ci id="S3.E4.m1.7.7.7.7.7.7.cmml" xref="S3.E4.m1.7.7.7.7.7.7">𝑧</ci><ci id="S3.E4.m1.8.8.8.8.8.8.1.cmml" xref="S3.E4.m1.8.8.8.8.8.8.1">𝑡</ci></apply><ci id="S3.E4.m1.9.9.9.9.9.9.1.cmml" xref="S3.E4.m1.9.9.9.9.9.9.1">𝑔</ci></apply><apply id="S3.E4.m1.19.19.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><csymbol cd="ambiguous" id="S3.E4.m1.19.19.1.1.1.3.3.3.3.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4">superscript</csymbol><ci id="S3.E4.m1.11.11.11.11.11.11.cmml" xref="S3.E4.m1.11.11.11.11.11.11">𝑧</ci><ci id="S3.E4.m1.12.12.12.12.12.12.1.cmml" xref="S3.E4.m1.12.12.12.12.12.12.1">𝑡</ci></apply></vector></apply><apply id="S3.E4.m1.19.19.1.1.1.5.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><minus id="S3.E4.m1.15.15.15.1.1.1.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"></minus><apply id="S3.E4.m1.19.19.1.1.1.5.2.cmml" xref="S3.E4.m1.22.22.4.21.17.17.17.4"><log id="S3.E4.m1.16.16.16.2.2.2.cmml" xref="S3.E4.m1.16.16.16.2.2.2"></log><apply id="S3.E4.m1.17.17.17.3.3.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3"><divide id="S3.E4.m1.17.17.17.3.3.3.10.cmml" xref="S3.E4.m1.17.17.17.3.3.3"></divide><apply id="S3.E4.m1.17.17.17.3.3.3.3.4.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3"><exp id="S3.E4.m1.17.17.17.3.3.3.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.2.2"></exp><apply id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1"><divide id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.3"></divide><apply id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2"><ci id="S3.E4.m1.17.17.17.3.3.3.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.1.1">sim</ci><apply id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3"><plus id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.1"></plus><ci id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.2.2.2.2.3">𝑔</ci></apply></apply><ci id="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.4.cmml" xref="S3.E4.m1.17.17.17.3.3.3.3.3.1.1.4">Γ</ci></apply></apply><apply id="S3.E4.m1.17.17.17.3.3.3.9.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9"><plus id="S3.E4.m1.17.17.17.3.3.3.9.7.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.7"></plus><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1"><exp id="S3.E4.m1.17.17.17.3.3.3.5.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.5.2"></exp><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1"><divide id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.3"></divide><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2"><ci id="S3.E4.m1.17.17.17.3.3.3.4.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.4.1">sim</ci><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3"><plus id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.2">𝑧</ci><ci id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.2.2.2.2.3">𝑔</ci></apply></apply><ci id="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.4.cmml" xref="S3.E4.m1.17.17.17.3.3.3.8.5.1.1.1.4">Γ</ci></apply></apply><apply id="S3.E4.m1.17.17.17.3.3.3.9.6.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1"><exp id="S3.E4.m1.17.17.17.3.3.3.7.4.cmml" xref="S3.E4.m1.17.17.17.3.3.3.7.4"></exp><apply id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1"><divide id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.3"></divide><apply id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2"><ci id="S3.E4.m1.17.17.17.3.3.3.6.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.6.3">sim</ci><apply id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3"><plus id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.1"></plus><ci id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.2.2.2.2.3">𝑡</ci></apply></apply><ci id="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.4.cmml" xref="S3.E4.m1.17.17.17.3.3.3.9.6.1.1.1.4">Γ</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.23c">\ell_{con\_aug}(z^{t+1},z^{t}_{g},z^{t})=\\
-\log\frac{\exp\big{(}\operatorname{sim}\big{(}z^{t+1},z^{t}_{g}\big{)}/\Gamma\big{)}}{\exp\big{(}\operatorname{sim}\big{(}z^{t+1},z^{t}_{g}\big{)}/\Gamma\big{)}+\exp\left(\operatorname{sim}\left(z^{t+1},z^{t}\right)/\Gamma\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.5" class="ltx_p">where <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="z^{t+1}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msup id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">z</mi><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑧</ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><plus id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></plus><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">z^{t+1}</annotation></semantics></math> and <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="z^{t}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msup id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">z</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑧</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">z^{t}</annotation></semantics></math> refer to the embedding of local textual or visual prompts at step <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">t</mi><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">+</mo><mn id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><plus id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></plus><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">t+1</annotation></semantics></math> and <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">t</annotation></semantics></math>, respectively, and <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="z_{g}^{t}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><msubsup id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2.2" xref="S3.SS3.p1.5.m5.1.1.2.2.cmml">z</mi><mi id="S3.SS3.p1.5.m5.1.1.2.3" xref="S3.SS3.p1.5.m5.1.1.2.3.cmml">g</mi><mi id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2.2">𝑧</ci><ci id="S3.SS3.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3">𝑔</ci></apply><ci id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">z_{g}^{t}</annotation></semantics></math> represents the global textual and visual prompts.
After attaining the contrastive loss, the overall loss of the trainable prompts can be calculated by:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.69" class="ltx_Math" alttext="\mathcal{L}(z_{i}^{t+1},z^{t}_{g},z_{i}^{t})=\ell_{con}(z_{i,\tau}^{t+1},z_{i,\upsilon}^{t+1})\\
+\mu(\ell_{con\_aug}(z_{i,\tau}^{t+1},z_{g,\tau}^{t},z_{i,\tau}^{t})+\ell_{con\_aug}(z_{i,\upsilon}^{t+1},z_{g,\upsilon}^{t},z_{i,\upsilon}^{t}))," display="block"><semantics id="S3.E5.m1.69a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E5.m1.69.69.7"><mtr id="S3.E5.m1.69.69.7a"><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.69.69.7b"><mrow id="S3.E5.m1.68.68.6.67.31.31"><mrow id="S3.E5.m1.66.66.4.65.29.29.29"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.66.66.4.65.29.29.29.4" xref="S3.E5.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.66.66.4.65.29.29.29.3.3"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.64.64.2.63.27.27.27.1.1.1"><mi id="S3.E5.m1.3.3.3.3.3.3" xref="S3.E5.m1.3.3.3.3.3.3.cmml">z</mi><mi id="S3.E5.m1.4.4.4.4.4.4.1" xref="S3.E5.m1.4.4.4.4.4.4.1.cmml">i</mi><mrow id="S3.E5.m1.5.5.5.5.5.5.1" xref="S3.E5.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E5.m1.5.5.5.5.5.5.1.2" xref="S3.E5.m1.5.5.5.5.5.5.1.2.cmml">t</mi><mo id="S3.E5.m1.5.5.5.5.5.5.1.1" xref="S3.E5.m1.5.5.5.5.5.5.1.1.cmml">+</mo><mn id="S3.E5.m1.5.5.5.5.5.5.1.3" xref="S3.E5.m1.5.5.5.5.5.5.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E5.m1.6.6.6.6.6.6" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.65.65.3.64.28.28.28.2.2.2"><mi id="S3.E5.m1.7.7.7.7.7.7" xref="S3.E5.m1.7.7.7.7.7.7.cmml">z</mi><mi id="S3.E5.m1.9.9.9.9.9.9.1" xref="S3.E5.m1.9.9.9.9.9.9.1.cmml">g</mi><mi id="S3.E5.m1.8.8.8.8.8.8.1" xref="S3.E5.m1.8.8.8.8.8.8.1.cmml">t</mi></msubsup><mo id="S3.E5.m1.10.10.10.10.10.10" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.66.66.4.65.29.29.29.3.3.3"><mi id="S3.E5.m1.11.11.11.11.11.11" xref="S3.E5.m1.11.11.11.11.11.11.cmml">z</mi><mi id="S3.E5.m1.12.12.12.12.12.12.1" xref="S3.E5.m1.12.12.12.12.12.12.1.cmml">i</mi><mi id="S3.E5.m1.13.13.13.13.13.13.1" xref="S3.E5.m1.13.13.13.13.13.13.1.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E5.m1.14.14.14.14.14.14" xref="S3.E5.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.15.15.15.15.15.15" xref="S3.E5.m1.15.15.15.15.15.15.cmml">=</mo><mrow id="S3.E5.m1.68.68.6.67.31.31.31"><msub id="S3.E5.m1.68.68.6.67.31.31.31.4"><mi mathvariant="normal" id="S3.E5.m1.16.16.16.16.16.16" xref="S3.E5.m1.16.16.16.16.16.16.cmml">ℓ</mi><mrow id="S3.E5.m1.17.17.17.17.17.17.1" xref="S3.E5.m1.17.17.17.17.17.17.1.cmml"><mi id="S3.E5.m1.17.17.17.17.17.17.1.2" xref="S3.E5.m1.17.17.17.17.17.17.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.17.17.17.17.17.17.1.1" xref="S3.E5.m1.17.17.17.17.17.17.1.1.cmml">​</mo><mi id="S3.E5.m1.17.17.17.17.17.17.1.3" xref="S3.E5.m1.17.17.17.17.17.17.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.17.17.17.17.17.17.1.1a" xref="S3.E5.m1.17.17.17.17.17.17.1.1.cmml">​</mo><mi id="S3.E5.m1.17.17.17.17.17.17.1.4" xref="S3.E5.m1.17.17.17.17.17.17.1.4.cmml">n</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.68.68.6.67.31.31.31.3" xref="S3.E5.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.68.68.6.67.31.31.31.2.2"><mo stretchy="false" id="S3.E5.m1.18.18.18.18.18.18" xref="S3.E5.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.67.67.5.66.30.30.30.1.1.1"><mi id="S3.E5.m1.19.19.19.19.19.19" xref="S3.E5.m1.19.19.19.19.19.19.cmml">z</mi><mrow id="S3.E5.m1.20.20.20.20.20.20.1.4" xref="S3.E5.m1.20.20.20.20.20.20.1.3.cmml"><mi id="S3.E5.m1.20.20.20.20.20.20.1.1" xref="S3.E5.m1.20.20.20.20.20.20.1.1.cmml">i</mi><mo id="S3.E5.m1.20.20.20.20.20.20.1.4.1" xref="S3.E5.m1.20.20.20.20.20.20.1.3.cmml">,</mo><mi id="S3.E5.m1.20.20.20.20.20.20.1.2" xref="S3.E5.m1.20.20.20.20.20.20.1.2.cmml">τ</mi></mrow><mrow id="S3.E5.m1.21.21.21.21.21.21.1" xref="S3.E5.m1.21.21.21.21.21.21.1.cmml"><mi id="S3.E5.m1.21.21.21.21.21.21.1.2" xref="S3.E5.m1.21.21.21.21.21.21.1.2.cmml">t</mi><mo id="S3.E5.m1.21.21.21.21.21.21.1.1" xref="S3.E5.m1.21.21.21.21.21.21.1.1.cmml">+</mo><mn id="S3.E5.m1.21.21.21.21.21.21.1.3" xref="S3.E5.m1.21.21.21.21.21.21.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E5.m1.22.22.22.22.22.22" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.68.68.6.67.31.31.31.2.2.2"><mi id="S3.E5.m1.23.23.23.23.23.23" xref="S3.E5.m1.23.23.23.23.23.23.cmml">z</mi><mrow id="S3.E5.m1.24.24.24.24.24.24.1.4" xref="S3.E5.m1.24.24.24.24.24.24.1.3.cmml"><mi id="S3.E5.m1.24.24.24.24.24.24.1.1" xref="S3.E5.m1.24.24.24.24.24.24.1.1.cmml">i</mi><mo id="S3.E5.m1.24.24.24.24.24.24.1.4.1" xref="S3.E5.m1.24.24.24.24.24.24.1.3.cmml">,</mo><mi id="S3.E5.m1.24.24.24.24.24.24.1.2" xref="S3.E5.m1.24.24.24.24.24.24.1.2.cmml">υ</mi></mrow><mrow id="S3.E5.m1.25.25.25.25.25.25.1" xref="S3.E5.m1.25.25.25.25.25.25.1.cmml"><mi id="S3.E5.m1.25.25.25.25.25.25.1.2" xref="S3.E5.m1.25.25.25.25.25.25.1.2.cmml">t</mi><mo id="S3.E5.m1.25.25.25.25.25.25.1.1" xref="S3.E5.m1.25.25.25.25.25.25.1.1.cmml">+</mo><mn id="S3.E5.m1.25.25.25.25.25.25.1.3" xref="S3.E5.m1.25.25.25.25.25.25.1.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="S3.E5.m1.26.26.26.26.26.26" xref="S3.E5.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E5.m1.69.69.7c"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.69.69.7d"><mrow id="S3.E5.m1.69.69.7.68.37.37.37"><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1"><mo id="S3.E5.m1.69.69.7.68.37.37.37.1a" xref="S3.E5.m1.63.63.1.1.1.cmml">+</mo><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1"><mi id="S3.E5.m1.28.28.28.2.2.2" xref="S3.E5.m1.28.28.28.2.2.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.69.69.7.68.37.37.37.1.1.2" xref="S3.E5.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1"><mo stretchy="false" id="S3.E5.m1.29.29.29.3.3.3" xref="S3.E5.m1.63.63.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1"><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.3"><msub id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.3.5"><mi mathvariant="normal" id="S3.E5.m1.30.30.30.4.4.4" xref="S3.E5.m1.30.30.30.4.4.4.cmml">ℓ</mi><mrow id="S3.E5.m1.31.31.31.5.5.5.1" xref="S3.E5.m1.31.31.31.5.5.5.1.cmml"><mi id="S3.E5.m1.31.31.31.5.5.5.1.2" xref="S3.E5.m1.31.31.31.5.5.5.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.31.31.31.5.5.5.1.1" xref="S3.E5.m1.31.31.31.5.5.5.1.1.cmml">​</mo><mi id="S3.E5.m1.31.31.31.5.5.5.1.3" xref="S3.E5.m1.31.31.31.5.5.5.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.31.31.31.5.5.5.1.1a" xref="S3.E5.m1.31.31.31.5.5.5.1.1.cmml">​</mo><mi id="S3.E5.m1.31.31.31.5.5.5.1.4" xref="S3.E5.m1.31.31.31.5.5.5.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.31.31.31.5.5.5.1.1b" xref="S3.E5.m1.31.31.31.5.5.5.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5.m1.31.31.31.5.5.5.1.5" xref="S3.E5.m1.31.31.31.5.5.5.1.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.31.31.31.5.5.5.1.1c" xref="S3.E5.m1.31.31.31.5.5.5.1.1.cmml">​</mo><mi id="S3.E5.m1.31.31.31.5.5.5.1.6" xref="S3.E5.m1.31.31.31.5.5.5.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.31.31.31.5.5.5.1.1d" xref="S3.E5.m1.31.31.31.5.5.5.1.1.cmml">​</mo><mi id="S3.E5.m1.31.31.31.5.5.5.1.7" xref="S3.E5.m1.31.31.31.5.5.5.1.7.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.31.31.31.5.5.5.1.1e" xref="S3.E5.m1.31.31.31.5.5.5.1.1.cmml">​</mo><mi id="S3.E5.m1.31.31.31.5.5.5.1.8" xref="S3.E5.m1.31.31.31.5.5.5.1.8.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.3.4" xref="S3.E5.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.3.3.3"><mo stretchy="false" id="S3.E5.m1.32.32.32.6.6.6" xref="S3.E5.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.1.1.1.1"><mi id="S3.E5.m1.33.33.33.7.7.7" xref="S3.E5.m1.33.33.33.7.7.7.cmml">z</mi><mrow id="S3.E5.m1.34.34.34.8.8.8.1.4" xref="S3.E5.m1.34.34.34.8.8.8.1.3.cmml"><mi id="S3.E5.m1.34.34.34.8.8.8.1.1" xref="S3.E5.m1.34.34.34.8.8.8.1.1.cmml">i</mi><mo id="S3.E5.m1.34.34.34.8.8.8.1.4.1" xref="S3.E5.m1.34.34.34.8.8.8.1.3.cmml">,</mo><mi id="S3.E5.m1.34.34.34.8.8.8.1.2" xref="S3.E5.m1.34.34.34.8.8.8.1.2.cmml">τ</mi></mrow><mrow id="S3.E5.m1.35.35.35.9.9.9.1" xref="S3.E5.m1.35.35.35.9.9.9.1.cmml"><mi id="S3.E5.m1.35.35.35.9.9.9.1.2" xref="S3.E5.m1.35.35.35.9.9.9.1.2.cmml">t</mi><mo id="S3.E5.m1.35.35.35.9.9.9.1.1" xref="S3.E5.m1.35.35.35.9.9.9.1.1.cmml">+</mo><mn id="S3.E5.m1.35.35.35.9.9.9.1.3" xref="S3.E5.m1.35.35.35.9.9.9.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E5.m1.36.36.36.10.10.10" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.2.2.2.2"><mi id="S3.E5.m1.37.37.37.11.11.11" xref="S3.E5.m1.37.37.37.11.11.11.cmml">z</mi><mrow id="S3.E5.m1.38.38.38.12.12.12.1.4" xref="S3.E5.m1.38.38.38.12.12.12.1.3.cmml"><mi id="S3.E5.m1.38.38.38.12.12.12.1.1" xref="S3.E5.m1.38.38.38.12.12.12.1.1.cmml">g</mi><mo id="S3.E5.m1.38.38.38.12.12.12.1.4.1" xref="S3.E5.m1.38.38.38.12.12.12.1.3.cmml">,</mo><mi id="S3.E5.m1.38.38.38.12.12.12.1.2" xref="S3.E5.m1.38.38.38.12.12.12.1.2.cmml">τ</mi></mrow><mi id="S3.E5.m1.39.39.39.13.13.13.1" xref="S3.E5.m1.39.39.39.13.13.13.1.cmml">t</mi></msubsup><mo id="S3.E5.m1.40.40.40.14.14.14" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.3.3.3.3"><mi id="S3.E5.m1.41.41.41.15.15.15" xref="S3.E5.m1.41.41.41.15.15.15.cmml">z</mi><mrow id="S3.E5.m1.42.42.42.16.16.16.1.4" xref="S3.E5.m1.42.42.42.16.16.16.1.3.cmml"><mi id="S3.E5.m1.42.42.42.16.16.16.1.1" xref="S3.E5.m1.42.42.42.16.16.16.1.1.cmml">i</mi><mo id="S3.E5.m1.42.42.42.16.16.16.1.4.1" xref="S3.E5.m1.42.42.42.16.16.16.1.3.cmml">,</mo><mi id="S3.E5.m1.42.42.42.16.16.16.1.2" xref="S3.E5.m1.42.42.42.16.16.16.1.2.cmml">τ</mi></mrow><mi id="S3.E5.m1.43.43.43.17.17.17.1" xref="S3.E5.m1.43.43.43.17.17.17.1.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E5.m1.44.44.44.18.18.18" xref="S3.E5.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.45.45.45.19.19.19" xref="S3.E5.m1.45.45.45.19.19.19.cmml">+</mo><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.6"><msub id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.6.5"><mi mathvariant="normal" id="S3.E5.m1.46.46.46.20.20.20" xref="S3.E5.m1.46.46.46.20.20.20.cmml">ℓ</mi><mrow id="S3.E5.m1.47.47.47.21.21.21.1" xref="S3.E5.m1.47.47.47.21.21.21.1.cmml"><mi id="S3.E5.m1.47.47.47.21.21.21.1.2" xref="S3.E5.m1.47.47.47.21.21.21.1.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.47.47.47.21.21.21.1.1" xref="S3.E5.m1.47.47.47.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.47.47.47.21.21.21.1.3" xref="S3.E5.m1.47.47.47.21.21.21.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.47.47.47.21.21.21.1.1a" xref="S3.E5.m1.47.47.47.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.47.47.47.21.21.21.1.4" xref="S3.E5.m1.47.47.47.21.21.21.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.47.47.47.21.21.21.1.1b" xref="S3.E5.m1.47.47.47.21.21.21.1.1.cmml">​</mo><mi mathvariant="normal" id="S3.E5.m1.47.47.47.21.21.21.1.5" xref="S3.E5.m1.47.47.47.21.21.21.1.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.47.47.47.21.21.21.1.1c" xref="S3.E5.m1.47.47.47.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.47.47.47.21.21.21.1.6" xref="S3.E5.m1.47.47.47.21.21.21.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.47.47.47.21.21.21.1.1d" xref="S3.E5.m1.47.47.47.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.47.47.47.21.21.21.1.7" xref="S3.E5.m1.47.47.47.21.21.21.1.7.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.47.47.47.21.21.21.1.1e" xref="S3.E5.m1.47.47.47.21.21.21.1.1.cmml">​</mo><mi id="S3.E5.m1.47.47.47.21.21.21.1.8" xref="S3.E5.m1.47.47.47.21.21.21.1.8.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.6.4" xref="S3.E5.m1.63.63.1.1.1.cmml">​</mo><mrow id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.6.3.3"><mo stretchy="false" id="S3.E5.m1.48.48.48.22.22.22" xref="S3.E5.m1.63.63.1.1.1.cmml">(</mo><msubsup id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.4.1.1.1"><mi id="S3.E5.m1.49.49.49.23.23.23" xref="S3.E5.m1.49.49.49.23.23.23.cmml">z</mi><mrow id="S3.E5.m1.50.50.50.24.24.24.1.4" xref="S3.E5.m1.50.50.50.24.24.24.1.3.cmml"><mi id="S3.E5.m1.50.50.50.24.24.24.1.1" xref="S3.E5.m1.50.50.50.24.24.24.1.1.cmml">i</mi><mo id="S3.E5.m1.50.50.50.24.24.24.1.4.1" xref="S3.E5.m1.50.50.50.24.24.24.1.3.cmml">,</mo><mi id="S3.E5.m1.50.50.50.24.24.24.1.2" xref="S3.E5.m1.50.50.50.24.24.24.1.2.cmml">υ</mi></mrow><mrow id="S3.E5.m1.51.51.51.25.25.25.1" xref="S3.E5.m1.51.51.51.25.25.25.1.cmml"><mi id="S3.E5.m1.51.51.51.25.25.25.1.2" xref="S3.E5.m1.51.51.51.25.25.25.1.2.cmml">t</mi><mo id="S3.E5.m1.51.51.51.25.25.25.1.1" xref="S3.E5.m1.51.51.51.25.25.25.1.1.cmml">+</mo><mn id="S3.E5.m1.51.51.51.25.25.25.1.3" xref="S3.E5.m1.51.51.51.25.25.25.1.3.cmml">1</mn></mrow></msubsup><mo id="S3.E5.m1.52.52.52.26.26.26" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.5.2.2.2"><mi id="S3.E5.m1.53.53.53.27.27.27" xref="S3.E5.m1.53.53.53.27.27.27.cmml">z</mi><mrow id="S3.E5.m1.54.54.54.28.28.28.1.4" xref="S3.E5.m1.54.54.54.28.28.28.1.3.cmml"><mi id="S3.E5.m1.54.54.54.28.28.28.1.1" xref="S3.E5.m1.54.54.54.28.28.28.1.1.cmml">g</mi><mo id="S3.E5.m1.54.54.54.28.28.28.1.4.1" xref="S3.E5.m1.54.54.54.28.28.28.1.3.cmml">,</mo><mi id="S3.E5.m1.54.54.54.28.28.28.1.2" xref="S3.E5.m1.54.54.54.28.28.28.1.2.cmml">υ</mi></mrow><mi id="S3.E5.m1.55.55.55.29.29.29.1" xref="S3.E5.m1.55.55.55.29.29.29.1.cmml">t</mi></msubsup><mo id="S3.E5.m1.56.56.56.30.30.30" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo><msubsup id="S3.E5.m1.69.69.7.68.37.37.37.1.1.1.1.1.6.3.3.3"><mi id="S3.E5.m1.57.57.57.31.31.31" xref="S3.E5.m1.57.57.57.31.31.31.cmml">z</mi><mrow id="S3.E5.m1.58.58.58.32.32.32.1.4" xref="S3.E5.m1.58.58.58.32.32.32.1.3.cmml"><mi id="S3.E5.m1.58.58.58.32.32.32.1.1" xref="S3.E5.m1.58.58.58.32.32.32.1.1.cmml">i</mi><mo id="S3.E5.m1.58.58.58.32.32.32.1.4.1" xref="S3.E5.m1.58.58.58.32.32.32.1.3.cmml">,</mo><mi id="S3.E5.m1.58.58.58.32.32.32.1.2" xref="S3.E5.m1.58.58.58.32.32.32.1.2.cmml">υ</mi></mrow><mi id="S3.E5.m1.59.59.59.33.33.33.1" xref="S3.E5.m1.59.59.59.33.33.33.1.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E5.m1.60.60.60.34.34.34" xref="S3.E5.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E5.m1.61.61.61.35.35.35" xref="S3.E5.m1.63.63.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.62.62.62.36.36.36" xref="S3.E5.m1.63.63.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.69b"><apply id="S3.E5.m1.63.63.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><eq id="S3.E5.m1.15.15.15.15.15.15.cmml" xref="S3.E5.m1.15.15.15.15.15.15"></eq><apply id="S3.E5.m1.63.63.1.1.1.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><times id="S3.E5.m1.63.63.1.1.1.3.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"></times><ci id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1">ℒ</ci><vector id="S3.E5.m1.63.63.1.1.1.3.3.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><apply id="S3.E5.m1.63.63.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.3.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.3.3.3.3">𝑧</ci><ci id="S3.E5.m1.4.4.4.4.4.4.1.cmml" xref="S3.E5.m1.4.4.4.4.4.4.1">𝑖</ci></apply><apply id="S3.E5.m1.5.5.5.5.5.5.1.cmml" xref="S3.E5.m1.5.5.5.5.5.5.1"><plus id="S3.E5.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E5.m1.5.5.5.5.5.5.1.1"></plus><ci id="S3.E5.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E5.m1.5.5.5.5.5.5.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E5.m1.5.5.5.5.5.5.1.3">1</cn></apply></apply><apply id="S3.E5.m1.63.63.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><ci id="S3.E5.m1.7.7.7.7.7.7.cmml" xref="S3.E5.m1.7.7.7.7.7.7">𝑧</ci><ci id="S3.E5.m1.8.8.8.8.8.8.1.cmml" xref="S3.E5.m1.8.8.8.8.8.8.1">𝑡</ci></apply><ci id="S3.E5.m1.9.9.9.9.9.9.1.cmml" xref="S3.E5.m1.9.9.9.9.9.9.1">𝑔</ci></apply><apply id="S3.E5.m1.63.63.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.11.11.11.11.11.11.cmml" xref="S3.E5.m1.11.11.11.11.11.11">𝑧</ci><ci id="S3.E5.m1.12.12.12.12.12.12.1.cmml" xref="S3.E5.m1.12.12.12.12.12.12.1">𝑖</ci></apply><ci id="S3.E5.m1.13.13.13.13.13.13.1.cmml" xref="S3.E5.m1.13.13.13.13.13.13.1">𝑡</ci></apply></vector></apply><apply id="S3.E5.m1.63.63.1.1.1.6.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><plus id="S3.E5.m1.27.27.27.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"></plus><apply id="S3.E5.m1.63.63.1.1.1.5.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><times id="S3.E5.m1.63.63.1.1.1.5.2.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"></times><apply id="S3.E5.m1.63.63.1.1.1.5.2.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.5.2.4.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.16.16.16.16.16.16.cmml" xref="S3.E5.m1.16.16.16.16.16.16">ℓ</ci><apply id="S3.E5.m1.17.17.17.17.17.17.1.cmml" xref="S3.E5.m1.17.17.17.17.17.17.1"><times id="S3.E5.m1.17.17.17.17.17.17.1.1.cmml" xref="S3.E5.m1.17.17.17.17.17.17.1.1"></times><ci id="S3.E5.m1.17.17.17.17.17.17.1.2.cmml" xref="S3.E5.m1.17.17.17.17.17.17.1.2">𝑐</ci><ci id="S3.E5.m1.17.17.17.17.17.17.1.3.cmml" xref="S3.E5.m1.17.17.17.17.17.17.1.3">𝑜</ci><ci id="S3.E5.m1.17.17.17.17.17.17.1.4.cmml" xref="S3.E5.m1.17.17.17.17.17.17.1.4">𝑛</ci></apply></apply><interval closure="open" id="S3.E5.m1.63.63.1.1.1.5.2.2.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><apply id="S3.E5.m1.63.63.1.1.1.4.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.4.1.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.4.1.1.1.1.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.4.1.1.1.1.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.19.19.19.19.19.19.cmml" xref="S3.E5.m1.19.19.19.19.19.19">𝑧</ci><list id="S3.E5.m1.20.20.20.20.20.20.1.3.cmml" xref="S3.E5.m1.20.20.20.20.20.20.1.4"><ci id="S3.E5.m1.20.20.20.20.20.20.1.1.cmml" xref="S3.E5.m1.20.20.20.20.20.20.1.1">𝑖</ci><ci id="S3.E5.m1.20.20.20.20.20.20.1.2.cmml" xref="S3.E5.m1.20.20.20.20.20.20.1.2">𝜏</ci></list></apply><apply id="S3.E5.m1.21.21.21.21.21.21.1.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1"><plus id="S3.E5.m1.21.21.21.21.21.21.1.1.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.1"></plus><ci id="S3.E5.m1.21.21.21.21.21.21.1.2.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.21.21.21.21.21.21.1.3.cmml" xref="S3.E5.m1.21.21.21.21.21.21.1.3">1</cn></apply></apply><apply id="S3.E5.m1.63.63.1.1.1.5.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.5.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.5.2.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.5.2.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.23.23.23.23.23.23.cmml" xref="S3.E5.m1.23.23.23.23.23.23">𝑧</ci><list id="S3.E5.m1.24.24.24.24.24.24.1.3.cmml" xref="S3.E5.m1.24.24.24.24.24.24.1.4"><ci id="S3.E5.m1.24.24.24.24.24.24.1.1.cmml" xref="S3.E5.m1.24.24.24.24.24.24.1.1">𝑖</ci><ci id="S3.E5.m1.24.24.24.24.24.24.1.2.cmml" xref="S3.E5.m1.24.24.24.24.24.24.1.2">𝜐</ci></list></apply><apply id="S3.E5.m1.25.25.25.25.25.25.1.cmml" xref="S3.E5.m1.25.25.25.25.25.25.1"><plus id="S3.E5.m1.25.25.25.25.25.25.1.1.cmml" xref="S3.E5.m1.25.25.25.25.25.25.1.1"></plus><ci id="S3.E5.m1.25.25.25.25.25.25.1.2.cmml" xref="S3.E5.m1.25.25.25.25.25.25.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.25.25.25.25.25.25.1.3.cmml" xref="S3.E5.m1.25.25.25.25.25.25.1.3">1</cn></apply></apply></interval></apply><apply id="S3.E5.m1.63.63.1.1.1.6.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><times id="S3.E5.m1.63.63.1.1.1.6.3.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"></times><ci id="S3.E5.m1.28.28.28.2.2.2.cmml" xref="S3.E5.m1.28.28.28.2.2.2">𝜇</ci><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><plus id="S3.E5.m1.45.45.45.19.19.19.cmml" xref="S3.E5.m1.45.45.45.19.19.19"></plus><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><times id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"></times><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.5.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.5.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.30.30.30.4.4.4.cmml" xref="S3.E5.m1.30.30.30.4.4.4">ℓ</ci><apply id="S3.E5.m1.31.31.31.5.5.5.1.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1"><times id="S3.E5.m1.31.31.31.5.5.5.1.1.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.1"></times><ci id="S3.E5.m1.31.31.31.5.5.5.1.2.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.2">𝑐</ci><ci id="S3.E5.m1.31.31.31.5.5.5.1.3.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.3">𝑜</ci><ci id="S3.E5.m1.31.31.31.5.5.5.1.4.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.4">𝑛</ci><ci id="S3.E5.m1.31.31.31.5.5.5.1.5.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.5">_</ci><ci id="S3.E5.m1.31.31.31.5.5.5.1.6.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.6">𝑎</ci><ci id="S3.E5.m1.31.31.31.5.5.5.1.7.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.7">𝑢</ci><ci id="S3.E5.m1.31.31.31.5.5.5.1.8.cmml" xref="S3.E5.m1.31.31.31.5.5.5.1.8">𝑔</ci></apply></apply><vector id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.3.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.33.33.33.7.7.7.cmml" xref="S3.E5.m1.33.33.33.7.7.7">𝑧</ci><list id="S3.E5.m1.34.34.34.8.8.8.1.3.cmml" xref="S3.E5.m1.34.34.34.8.8.8.1.4"><ci id="S3.E5.m1.34.34.34.8.8.8.1.1.cmml" xref="S3.E5.m1.34.34.34.8.8.8.1.1">𝑖</ci><ci id="S3.E5.m1.34.34.34.8.8.8.1.2.cmml" xref="S3.E5.m1.34.34.34.8.8.8.1.2">𝜏</ci></list></apply><apply id="S3.E5.m1.35.35.35.9.9.9.1.cmml" xref="S3.E5.m1.35.35.35.9.9.9.1"><plus id="S3.E5.m1.35.35.35.9.9.9.1.1.cmml" xref="S3.E5.m1.35.35.35.9.9.9.1.1"></plus><ci id="S3.E5.m1.35.35.35.9.9.9.1.2.cmml" xref="S3.E5.m1.35.35.35.9.9.9.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.35.35.35.9.9.9.1.3.cmml" xref="S3.E5.m1.35.35.35.9.9.9.1.3">1</cn></apply></apply><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.37.37.37.11.11.11.cmml" xref="S3.E5.m1.37.37.37.11.11.11">𝑧</ci><list id="S3.E5.m1.38.38.38.12.12.12.1.3.cmml" xref="S3.E5.m1.38.38.38.12.12.12.1.4"><ci id="S3.E5.m1.38.38.38.12.12.12.1.1.cmml" xref="S3.E5.m1.38.38.38.12.12.12.1.1">𝑔</ci><ci id="S3.E5.m1.38.38.38.12.12.12.1.2.cmml" xref="S3.E5.m1.38.38.38.12.12.12.1.2">𝜏</ci></list></apply><ci id="S3.E5.m1.39.39.39.13.13.13.1.cmml" xref="S3.E5.m1.39.39.39.13.13.13.1">𝑡</ci></apply><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.41.41.41.15.15.15.cmml" xref="S3.E5.m1.41.41.41.15.15.15">𝑧</ci><list id="S3.E5.m1.42.42.42.16.16.16.1.3.cmml" xref="S3.E5.m1.42.42.42.16.16.16.1.4"><ci id="S3.E5.m1.42.42.42.16.16.16.1.1.cmml" xref="S3.E5.m1.42.42.42.16.16.16.1.1">𝑖</ci><ci id="S3.E5.m1.42.42.42.16.16.16.1.2.cmml" xref="S3.E5.m1.42.42.42.16.16.16.1.2">𝜏</ci></list></apply><ci id="S3.E5.m1.43.43.43.17.17.17.1.cmml" xref="S3.E5.m1.43.43.43.17.17.17.1">𝑡</ci></apply></vector></apply><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><times id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"></times><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.5.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.5.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.46.46.46.20.20.20.cmml" xref="S3.E5.m1.46.46.46.20.20.20">ℓ</ci><apply id="S3.E5.m1.47.47.47.21.21.21.1.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1"><times id="S3.E5.m1.47.47.47.21.21.21.1.1.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.1"></times><ci id="S3.E5.m1.47.47.47.21.21.21.1.2.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.2">𝑐</ci><ci id="S3.E5.m1.47.47.47.21.21.21.1.3.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.3">𝑜</ci><ci id="S3.E5.m1.47.47.47.21.21.21.1.4.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.4">𝑛</ci><ci id="S3.E5.m1.47.47.47.21.21.21.1.5.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.5">_</ci><ci id="S3.E5.m1.47.47.47.21.21.21.1.6.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.6">𝑎</ci><ci id="S3.E5.m1.47.47.47.21.21.21.1.7.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.7">𝑢</ci><ci id="S3.E5.m1.47.47.47.21.21.21.1.8.cmml" xref="S3.E5.m1.47.47.47.21.21.21.1.8">𝑔</ci></apply></apply><vector id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.3.4.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.4.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.4.1.1.1.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.4.1.1.1.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.4.1.1.1.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.49.49.49.23.23.23.cmml" xref="S3.E5.m1.49.49.49.23.23.23">𝑧</ci><list id="S3.E5.m1.50.50.50.24.24.24.1.3.cmml" xref="S3.E5.m1.50.50.50.24.24.24.1.4"><ci id="S3.E5.m1.50.50.50.24.24.24.1.1.cmml" xref="S3.E5.m1.50.50.50.24.24.24.1.1">𝑖</ci><ci id="S3.E5.m1.50.50.50.24.24.24.1.2.cmml" xref="S3.E5.m1.50.50.50.24.24.24.1.2">𝜐</ci></list></apply><apply id="S3.E5.m1.51.51.51.25.25.25.1.cmml" xref="S3.E5.m1.51.51.51.25.25.25.1"><plus id="S3.E5.m1.51.51.51.25.25.25.1.1.cmml" xref="S3.E5.m1.51.51.51.25.25.25.1.1"></plus><ci id="S3.E5.m1.51.51.51.25.25.25.1.2.cmml" xref="S3.E5.m1.51.51.51.25.25.25.1.2">𝑡</ci><cn type="integer" id="S3.E5.m1.51.51.51.25.25.25.1.3.cmml" xref="S3.E5.m1.51.51.51.25.25.25.1.3">1</cn></apply></apply><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.5.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.5.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.5.2.2.2.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.5.2.2.2.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.53.53.53.27.27.27.cmml" xref="S3.E5.m1.53.53.53.27.27.27">𝑧</ci><list id="S3.E5.m1.54.54.54.28.28.28.1.3.cmml" xref="S3.E5.m1.54.54.54.28.28.28.1.4"><ci id="S3.E5.m1.54.54.54.28.28.28.1.1.cmml" xref="S3.E5.m1.54.54.54.28.28.28.1.1">𝑔</ci><ci id="S3.E5.m1.54.54.54.28.28.28.1.2.cmml" xref="S3.E5.m1.54.54.54.28.28.28.1.2">𝜐</ci></list></apply><ci id="S3.E5.m1.55.55.55.29.29.29.1.cmml" xref="S3.E5.m1.55.55.55.29.29.29.1">𝑡</ci></apply><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.3.3.3.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.3.3.3.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">superscript</csymbol><apply id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.3.3.3.2.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4"><csymbol cd="ambiguous" id="S3.E5.m1.63.63.1.1.1.6.3.1.1.1.6.3.3.3.2.1.cmml" xref="S3.E5.m1.66.66.4.65.29.29.29.4">subscript</csymbol><ci id="S3.E5.m1.57.57.57.31.31.31.cmml" xref="S3.E5.m1.57.57.57.31.31.31">𝑧</ci><list id="S3.E5.m1.58.58.58.32.32.32.1.3.cmml" xref="S3.E5.m1.58.58.58.32.32.32.1.4"><ci id="S3.E5.m1.58.58.58.32.32.32.1.1.cmml" xref="S3.E5.m1.58.58.58.32.32.32.1.1">𝑖</ci><ci id="S3.E5.m1.58.58.58.32.32.32.1.2.cmml" xref="S3.E5.m1.58.58.58.32.32.32.1.2">𝜐</ci></list></apply><ci id="S3.E5.m1.59.59.59.33.33.33.1.cmml" xref="S3.E5.m1.59.59.59.33.33.33.1">𝑡</ci></apply></vector></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.69c">\mathcal{L}(z_{i}^{t+1},z^{t}_{g},z_{i}^{t})=\ell_{con}(z_{i,\tau}^{t+1},z_{i,\upsilon}^{t+1})\\
+\mu(\ell_{con\_aug}(z_{i,\tau}^{t+1},z_{g,\tau}^{t},z_{i,\tau}^{t})+\ell_{con\_aug}(z_{i,\upsilon}^{t+1},z_{g,\upsilon}^{t},z_{i,\upsilon}^{t})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.14" class="ltx_p">where <math id="S3.SS3.p1.6.m1.1" class="ltx_Math" alttext="\ell_{con}" display="inline"><semantics id="S3.SS3.p1.6.m1.1a"><msub id="S3.SS3.p1.6.m1.1.1" xref="S3.SS3.p1.6.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p1.6.m1.1.1.2" xref="S3.SS3.p1.6.m1.1.1.2.cmml">ℓ</mi><mrow id="S3.SS3.p1.6.m1.1.1.3" xref="S3.SS3.p1.6.m1.1.1.3.cmml"><mi id="S3.SS3.p1.6.m1.1.1.3.2" xref="S3.SS3.p1.6.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m1.1.1.3.1" xref="S3.SS3.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.6.m1.1.1.3.3" xref="S3.SS3.p1.6.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.6.m1.1.1.3.1a" xref="S3.SS3.p1.6.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.6.m1.1.1.3.4" xref="S3.SS3.p1.6.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m1.1b"><apply id="S3.SS3.p1.6.m1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m1.1.1.1.cmml" xref="S3.SS3.p1.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m1.1.1.2.cmml" xref="S3.SS3.p1.6.m1.1.1.2">ℓ</ci><apply id="S3.SS3.p1.6.m1.1.1.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3"><times id="S3.SS3.p1.6.m1.1.1.3.1.cmml" xref="S3.SS3.p1.6.m1.1.1.3.1"></times><ci id="S3.SS3.p1.6.m1.1.1.3.2.cmml" xref="S3.SS3.p1.6.m1.1.1.3.2">𝑐</ci><ci id="S3.SS3.p1.6.m1.1.1.3.3.cmml" xref="S3.SS3.p1.6.m1.1.1.3.3">𝑜</ci><ci id="S3.SS3.p1.6.m1.1.1.3.4.cmml" xref="S3.SS3.p1.6.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m1.1c">\ell_{con}</annotation></semantics></math> denotes the contrastive loss formulated in (<a href="#S3.E2" title="Equation 2 ‣ 3.2. Twin Prompt Federated Learning (TPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), <math id="S3.SS3.p1.7.m2.2" class="ltx_Math" alttext="z_{i,\tau}" display="inline"><semantics id="S3.SS3.p1.7.m2.2a"><msub id="S3.SS3.p1.7.m2.2.3" xref="S3.SS3.p1.7.m2.2.3.cmml"><mi id="S3.SS3.p1.7.m2.2.3.2" xref="S3.SS3.p1.7.m2.2.3.2.cmml">z</mi><mrow id="S3.SS3.p1.7.m2.2.2.2.4" xref="S3.SS3.p1.7.m2.2.2.2.3.cmml"><mi id="S3.SS3.p1.7.m2.1.1.1.1" xref="S3.SS3.p1.7.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.7.m2.2.2.2.4.1" xref="S3.SS3.p1.7.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.7.m2.2.2.2.2" xref="S3.SS3.p1.7.m2.2.2.2.2.cmml">τ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m2.2b"><apply id="S3.SS3.p1.7.m2.2.3.cmml" xref="S3.SS3.p1.7.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m2.2.3.1.cmml" xref="S3.SS3.p1.7.m2.2.3">subscript</csymbol><ci id="S3.SS3.p1.7.m2.2.3.2.cmml" xref="S3.SS3.p1.7.m2.2.3.2">𝑧</ci><list id="S3.SS3.p1.7.m2.2.2.2.3.cmml" xref="S3.SS3.p1.7.m2.2.2.2.4"><ci id="S3.SS3.p1.7.m2.1.1.1.1.cmml" xref="S3.SS3.p1.7.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.7.m2.2.2.2.2.cmml" xref="S3.SS3.p1.7.m2.2.2.2.2">𝜏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m2.2c">z_{i,\tau}</annotation></semantics></math> (<math id="S3.SS3.p1.8.m3.2" class="ltx_Math" alttext="z_{g,\tau}" display="inline"><semantics id="S3.SS3.p1.8.m3.2a"><msub id="S3.SS3.p1.8.m3.2.3" xref="S3.SS3.p1.8.m3.2.3.cmml"><mi id="S3.SS3.p1.8.m3.2.3.2" xref="S3.SS3.p1.8.m3.2.3.2.cmml">z</mi><mrow id="S3.SS3.p1.8.m3.2.2.2.4" xref="S3.SS3.p1.8.m3.2.2.2.3.cmml"><mi id="S3.SS3.p1.8.m3.1.1.1.1" xref="S3.SS3.p1.8.m3.1.1.1.1.cmml">g</mi><mo id="S3.SS3.p1.8.m3.2.2.2.4.1" xref="S3.SS3.p1.8.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.8.m3.2.2.2.2" xref="S3.SS3.p1.8.m3.2.2.2.2.cmml">τ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m3.2b"><apply id="S3.SS3.p1.8.m3.2.3.cmml" xref="S3.SS3.p1.8.m3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m3.2.3.1.cmml" xref="S3.SS3.p1.8.m3.2.3">subscript</csymbol><ci id="S3.SS3.p1.8.m3.2.3.2.cmml" xref="S3.SS3.p1.8.m3.2.3.2">𝑧</ci><list id="S3.SS3.p1.8.m3.2.2.2.3.cmml" xref="S3.SS3.p1.8.m3.2.2.2.4"><ci id="S3.SS3.p1.8.m3.1.1.1.1.cmml" xref="S3.SS3.p1.8.m3.1.1.1.1">𝑔</ci><ci id="S3.SS3.p1.8.m3.2.2.2.2.cmml" xref="S3.SS3.p1.8.m3.2.2.2.2">𝜏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m3.2c">z_{g,\tau}</annotation></semantics></math>) and <math id="S3.SS3.p1.9.m4.2" class="ltx_Math" alttext="z_{i,\upsilon}" display="inline"><semantics id="S3.SS3.p1.9.m4.2a"><msub id="S3.SS3.p1.9.m4.2.3" xref="S3.SS3.p1.9.m4.2.3.cmml"><mi id="S3.SS3.p1.9.m4.2.3.2" xref="S3.SS3.p1.9.m4.2.3.2.cmml">z</mi><mrow id="S3.SS3.p1.9.m4.2.2.2.4" xref="S3.SS3.p1.9.m4.2.2.2.3.cmml"><mi id="S3.SS3.p1.9.m4.1.1.1.1" xref="S3.SS3.p1.9.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.9.m4.2.2.2.4.1" xref="S3.SS3.p1.9.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.9.m4.2.2.2.2" xref="S3.SS3.p1.9.m4.2.2.2.2.cmml">υ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m4.2b"><apply id="S3.SS3.p1.9.m4.2.3.cmml" xref="S3.SS3.p1.9.m4.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m4.2.3.1.cmml" xref="S3.SS3.p1.9.m4.2.3">subscript</csymbol><ci id="S3.SS3.p1.9.m4.2.3.2.cmml" xref="S3.SS3.p1.9.m4.2.3.2">𝑧</ci><list id="S3.SS3.p1.9.m4.2.2.2.3.cmml" xref="S3.SS3.p1.9.m4.2.2.2.4"><ci id="S3.SS3.p1.9.m4.1.1.1.1.cmml" xref="S3.SS3.p1.9.m4.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.9.m4.2.2.2.2.cmml" xref="S3.SS3.p1.9.m4.2.2.2.2">𝜐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m4.2c">z_{i,\upsilon}</annotation></semantics></math> (<math id="S3.SS3.p1.10.m5.2" class="ltx_Math" alttext="z_{g,\upsilon}" display="inline"><semantics id="S3.SS3.p1.10.m5.2a"><msub id="S3.SS3.p1.10.m5.2.3" xref="S3.SS3.p1.10.m5.2.3.cmml"><mi id="S3.SS3.p1.10.m5.2.3.2" xref="S3.SS3.p1.10.m5.2.3.2.cmml">z</mi><mrow id="S3.SS3.p1.10.m5.2.2.2.4" xref="S3.SS3.p1.10.m5.2.2.2.3.cmml"><mi id="S3.SS3.p1.10.m5.1.1.1.1" xref="S3.SS3.p1.10.m5.1.1.1.1.cmml">g</mi><mo id="S3.SS3.p1.10.m5.2.2.2.4.1" xref="S3.SS3.p1.10.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.10.m5.2.2.2.2" xref="S3.SS3.p1.10.m5.2.2.2.2.cmml">υ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m5.2b"><apply id="S3.SS3.p1.10.m5.2.3.cmml" xref="S3.SS3.p1.10.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m5.2.3.1.cmml" xref="S3.SS3.p1.10.m5.2.3">subscript</csymbol><ci id="S3.SS3.p1.10.m5.2.3.2.cmml" xref="S3.SS3.p1.10.m5.2.3.2">𝑧</ci><list id="S3.SS3.p1.10.m5.2.2.2.3.cmml" xref="S3.SS3.p1.10.m5.2.2.2.4"><ci id="S3.SS3.p1.10.m5.1.1.1.1.cmml" xref="S3.SS3.p1.10.m5.1.1.1.1">𝑔</ci><ci id="S3.SS3.p1.10.m5.2.2.2.2.cmml" xref="S3.SS3.p1.10.m5.2.2.2.2">𝜐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m5.2c">z_{g,\upsilon}</annotation></semantics></math>) denote the embedding of the local client <math id="S3.SS3.p1.11.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.11.m6.1a"><mi id="S3.SS3.p1.11.m6.1.1" xref="S3.SS3.p1.11.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m6.1b"><ci id="S3.SS3.p1.11.m6.1.1.cmml" xref="S3.SS3.p1.11.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m6.1c">i</annotation></semantics></math>’s (global) textual or visual prompts, respectively, and <math id="S3.SS3.p1.12.m7.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S3.SS3.p1.12.m7.1a"><mi id="S3.SS3.p1.12.m7.1.1" xref="S3.SS3.p1.12.m7.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m7.1b"><ci id="S3.SS3.p1.12.m7.1.1.cmml" xref="S3.SS3.p1.12.m7.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m7.1c">\mu</annotation></semantics></math> represents a tuning factor to control the influence of textual augmented loss <math id="S3.SS3.p1.13.m8.9" class="ltx_Math" alttext="\ell_{con\_aug}(z_{i,\tau}^{t+1},z_{g,\tau}^{t},z_{i,\tau}^{t})" display="inline"><semantics id="S3.SS3.p1.13.m8.9a"><mrow id="S3.SS3.p1.13.m8.9.9" xref="S3.SS3.p1.13.m8.9.9.cmml"><msub id="S3.SS3.p1.13.m8.9.9.5" xref="S3.SS3.p1.13.m8.9.9.5.cmml"><mi mathvariant="normal" id="S3.SS3.p1.13.m8.9.9.5.2" xref="S3.SS3.p1.13.m8.9.9.5.2.cmml">ℓ</mi><mrow id="S3.SS3.p1.13.m8.9.9.5.3" xref="S3.SS3.p1.13.m8.9.9.5.3.cmml"><mi id="S3.SS3.p1.13.m8.9.9.5.3.2" xref="S3.SS3.p1.13.m8.9.9.5.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.5.3.1" xref="S3.SS3.p1.13.m8.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.13.m8.9.9.5.3.3" xref="S3.SS3.p1.13.m8.9.9.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.5.3.1a" xref="S3.SS3.p1.13.m8.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.13.m8.9.9.5.3.4" xref="S3.SS3.p1.13.m8.9.9.5.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.5.3.1b" xref="S3.SS3.p1.13.m8.9.9.5.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.p1.13.m8.9.9.5.3.5" xref="S3.SS3.p1.13.m8.9.9.5.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.5.3.1c" xref="S3.SS3.p1.13.m8.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.13.m8.9.9.5.3.6" xref="S3.SS3.p1.13.m8.9.9.5.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.5.3.1d" xref="S3.SS3.p1.13.m8.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.13.m8.9.9.5.3.7" xref="S3.SS3.p1.13.m8.9.9.5.3.7.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.5.3.1e" xref="S3.SS3.p1.13.m8.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.13.m8.9.9.5.3.8" xref="S3.SS3.p1.13.m8.9.9.5.3.8.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.13.m8.9.9.4" xref="S3.SS3.p1.13.m8.9.9.4.cmml">​</mo><mrow id="S3.SS3.p1.13.m8.9.9.3.3" xref="S3.SS3.p1.13.m8.9.9.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.13.m8.9.9.3.3.4" xref="S3.SS3.p1.13.m8.9.9.3.4.cmml">(</mo><msubsup id="S3.SS3.p1.13.m8.7.7.1.1.1" xref="S3.SS3.p1.13.m8.7.7.1.1.1.cmml"><mi id="S3.SS3.p1.13.m8.7.7.1.1.1.2.2" xref="S3.SS3.p1.13.m8.7.7.1.1.1.2.2.cmml">z</mi><mrow id="S3.SS3.p1.13.m8.2.2.2.4" xref="S3.SS3.p1.13.m8.2.2.2.3.cmml"><mi id="S3.SS3.p1.13.m8.1.1.1.1" xref="S3.SS3.p1.13.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.13.m8.2.2.2.4.1" xref="S3.SS3.p1.13.m8.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.13.m8.2.2.2.2" xref="S3.SS3.p1.13.m8.2.2.2.2.cmml">τ</mi></mrow><mrow id="S3.SS3.p1.13.m8.7.7.1.1.1.3" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.cmml"><mi id="S3.SS3.p1.13.m8.7.7.1.1.1.3.2" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.13.m8.7.7.1.1.1.3.1" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.13.m8.7.7.1.1.1.3.3" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.SS3.p1.13.m8.9.9.3.3.5" xref="S3.SS3.p1.13.m8.9.9.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.13.m8.8.8.2.2.2" xref="S3.SS3.p1.13.m8.8.8.2.2.2.cmml"><mi id="S3.SS3.p1.13.m8.8.8.2.2.2.2.2" xref="S3.SS3.p1.13.m8.8.8.2.2.2.2.2.cmml">z</mi><mrow id="S3.SS3.p1.13.m8.4.4.2.4" xref="S3.SS3.p1.13.m8.4.4.2.3.cmml"><mi id="S3.SS3.p1.13.m8.3.3.1.1" xref="S3.SS3.p1.13.m8.3.3.1.1.cmml">g</mi><mo id="S3.SS3.p1.13.m8.4.4.2.4.1" xref="S3.SS3.p1.13.m8.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p1.13.m8.4.4.2.2" xref="S3.SS3.p1.13.m8.4.4.2.2.cmml">τ</mi></mrow><mi id="S3.SS3.p1.13.m8.8.8.2.2.2.3" xref="S3.SS3.p1.13.m8.8.8.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.p1.13.m8.9.9.3.3.6" xref="S3.SS3.p1.13.m8.9.9.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.13.m8.9.9.3.3.3" xref="S3.SS3.p1.13.m8.9.9.3.3.3.cmml"><mi id="S3.SS3.p1.13.m8.9.9.3.3.3.2.2" xref="S3.SS3.p1.13.m8.9.9.3.3.3.2.2.cmml">z</mi><mrow id="S3.SS3.p1.13.m8.6.6.2.4" xref="S3.SS3.p1.13.m8.6.6.2.3.cmml"><mi id="S3.SS3.p1.13.m8.5.5.1.1" xref="S3.SS3.p1.13.m8.5.5.1.1.cmml">i</mi><mo id="S3.SS3.p1.13.m8.6.6.2.4.1" xref="S3.SS3.p1.13.m8.6.6.2.3.cmml">,</mo><mi id="S3.SS3.p1.13.m8.6.6.2.2" xref="S3.SS3.p1.13.m8.6.6.2.2.cmml">τ</mi></mrow><mi id="S3.SS3.p1.13.m8.9.9.3.3.3.3" xref="S3.SS3.p1.13.m8.9.9.3.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.13.m8.9.9.3.3.7" xref="S3.SS3.p1.13.m8.9.9.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m8.9b"><apply id="S3.SS3.p1.13.m8.9.9.cmml" xref="S3.SS3.p1.13.m8.9.9"><times id="S3.SS3.p1.13.m8.9.9.4.cmml" xref="S3.SS3.p1.13.m8.9.9.4"></times><apply id="S3.SS3.p1.13.m8.9.9.5.cmml" xref="S3.SS3.p1.13.m8.9.9.5"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.9.9.5.1.cmml" xref="S3.SS3.p1.13.m8.9.9.5">subscript</csymbol><ci id="S3.SS3.p1.13.m8.9.9.5.2.cmml" xref="S3.SS3.p1.13.m8.9.9.5.2">ℓ</ci><apply id="S3.SS3.p1.13.m8.9.9.5.3.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3"><times id="S3.SS3.p1.13.m8.9.9.5.3.1.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.1"></times><ci id="S3.SS3.p1.13.m8.9.9.5.3.2.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.2">𝑐</ci><ci id="S3.SS3.p1.13.m8.9.9.5.3.3.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.3">𝑜</ci><ci id="S3.SS3.p1.13.m8.9.9.5.3.4.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.4">𝑛</ci><ci id="S3.SS3.p1.13.m8.9.9.5.3.5.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.5">_</ci><ci id="S3.SS3.p1.13.m8.9.9.5.3.6.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.6">𝑎</ci><ci id="S3.SS3.p1.13.m8.9.9.5.3.7.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.7">𝑢</ci><ci id="S3.SS3.p1.13.m8.9.9.5.3.8.cmml" xref="S3.SS3.p1.13.m8.9.9.5.3.8">𝑔</ci></apply></apply><vector id="S3.SS3.p1.13.m8.9.9.3.4.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3"><apply id="S3.SS3.p1.13.m8.7.7.1.1.1.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.7.7.1.1.1.1.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.13.m8.7.7.1.1.1.2.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.7.7.1.1.1.2.1.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.13.m8.7.7.1.1.1.2.2.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1.2.2">𝑧</ci><list id="S3.SS3.p1.13.m8.2.2.2.3.cmml" xref="S3.SS3.p1.13.m8.2.2.2.4"><ci id="S3.SS3.p1.13.m8.1.1.1.1.cmml" xref="S3.SS3.p1.13.m8.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.13.m8.2.2.2.2.cmml" xref="S3.SS3.p1.13.m8.2.2.2.2">𝜏</ci></list></apply><apply id="S3.SS3.p1.13.m8.7.7.1.1.1.3.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3"><plus id="S3.SS3.p1.13.m8.7.7.1.1.1.3.1.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.1"></plus><ci id="S3.SS3.p1.13.m8.7.7.1.1.1.3.2.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p1.13.m8.7.7.1.1.1.3.3.cmml" xref="S3.SS3.p1.13.m8.7.7.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p1.13.m8.8.8.2.2.2.cmml" xref="S3.SS3.p1.13.m8.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.8.8.2.2.2.1.cmml" xref="S3.SS3.p1.13.m8.8.8.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.13.m8.8.8.2.2.2.2.cmml" xref="S3.SS3.p1.13.m8.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.8.8.2.2.2.2.1.cmml" xref="S3.SS3.p1.13.m8.8.8.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.13.m8.8.8.2.2.2.2.2.cmml" xref="S3.SS3.p1.13.m8.8.8.2.2.2.2.2">𝑧</ci><list id="S3.SS3.p1.13.m8.4.4.2.3.cmml" xref="S3.SS3.p1.13.m8.4.4.2.4"><ci id="S3.SS3.p1.13.m8.3.3.1.1.cmml" xref="S3.SS3.p1.13.m8.3.3.1.1">𝑔</ci><ci id="S3.SS3.p1.13.m8.4.4.2.2.cmml" xref="S3.SS3.p1.13.m8.4.4.2.2">𝜏</ci></list></apply><ci id="S3.SS3.p1.13.m8.8.8.2.2.2.3.cmml" xref="S3.SS3.p1.13.m8.8.8.2.2.2.3">𝑡</ci></apply><apply id="S3.SS3.p1.13.m8.9.9.3.3.3.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.9.9.3.3.3.1.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.13.m8.9.9.3.3.3.2.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.13.m8.9.9.3.3.3.2.1.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.13.m8.9.9.3.3.3.2.2.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3.3.2.2">𝑧</ci><list id="S3.SS3.p1.13.m8.6.6.2.3.cmml" xref="S3.SS3.p1.13.m8.6.6.2.4"><ci id="S3.SS3.p1.13.m8.5.5.1.1.cmml" xref="S3.SS3.p1.13.m8.5.5.1.1">𝑖</ci><ci id="S3.SS3.p1.13.m8.6.6.2.2.cmml" xref="S3.SS3.p1.13.m8.6.6.2.2">𝜏</ci></list></apply><ci id="S3.SS3.p1.13.m8.9.9.3.3.3.3.cmml" xref="S3.SS3.p1.13.m8.9.9.3.3.3.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m8.9c">\ell_{con\_aug}(z_{i,\tau}^{t+1},z_{g,\tau}^{t},z_{i,\tau}^{t})</annotation></semantics></math> and visual augmented loss <math id="S3.SS3.p1.14.m9.9" class="ltx_Math" alttext="\ell_{con\_aug}(z_{i,\upsilon}^{t+1},z_{g,\upsilon}^{t},z_{i,\upsilon}^{t})" display="inline"><semantics id="S3.SS3.p1.14.m9.9a"><mrow id="S3.SS3.p1.14.m9.9.9" xref="S3.SS3.p1.14.m9.9.9.cmml"><msub id="S3.SS3.p1.14.m9.9.9.5" xref="S3.SS3.p1.14.m9.9.9.5.cmml"><mi mathvariant="normal" id="S3.SS3.p1.14.m9.9.9.5.2" xref="S3.SS3.p1.14.m9.9.9.5.2.cmml">ℓ</mi><mrow id="S3.SS3.p1.14.m9.9.9.5.3" xref="S3.SS3.p1.14.m9.9.9.5.3.cmml"><mi id="S3.SS3.p1.14.m9.9.9.5.3.2" xref="S3.SS3.p1.14.m9.9.9.5.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.5.3.1" xref="S3.SS3.p1.14.m9.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.14.m9.9.9.5.3.3" xref="S3.SS3.p1.14.m9.9.9.5.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.5.3.1a" xref="S3.SS3.p1.14.m9.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.14.m9.9.9.5.3.4" xref="S3.SS3.p1.14.m9.9.9.5.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.5.3.1b" xref="S3.SS3.p1.14.m9.9.9.5.3.1.cmml">​</mo><mi mathvariant="normal" id="S3.SS3.p1.14.m9.9.9.5.3.5" xref="S3.SS3.p1.14.m9.9.9.5.3.5.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.5.3.1c" xref="S3.SS3.p1.14.m9.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.14.m9.9.9.5.3.6" xref="S3.SS3.p1.14.m9.9.9.5.3.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.5.3.1d" xref="S3.SS3.p1.14.m9.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.14.m9.9.9.5.3.7" xref="S3.SS3.p1.14.m9.9.9.5.3.7.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.5.3.1e" xref="S3.SS3.p1.14.m9.9.9.5.3.1.cmml">​</mo><mi id="S3.SS3.p1.14.m9.9.9.5.3.8" xref="S3.SS3.p1.14.m9.9.9.5.3.8.cmml">g</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.14.m9.9.9.4" xref="S3.SS3.p1.14.m9.9.9.4.cmml">​</mo><mrow id="S3.SS3.p1.14.m9.9.9.3.3" xref="S3.SS3.p1.14.m9.9.9.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.14.m9.9.9.3.3.4" xref="S3.SS3.p1.14.m9.9.9.3.4.cmml">(</mo><msubsup id="S3.SS3.p1.14.m9.7.7.1.1.1" xref="S3.SS3.p1.14.m9.7.7.1.1.1.cmml"><mi id="S3.SS3.p1.14.m9.7.7.1.1.1.2.2" xref="S3.SS3.p1.14.m9.7.7.1.1.1.2.2.cmml">z</mi><mrow id="S3.SS3.p1.14.m9.2.2.2.4" xref="S3.SS3.p1.14.m9.2.2.2.3.cmml"><mi id="S3.SS3.p1.14.m9.1.1.1.1" xref="S3.SS3.p1.14.m9.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p1.14.m9.2.2.2.4.1" xref="S3.SS3.p1.14.m9.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.14.m9.2.2.2.2" xref="S3.SS3.p1.14.m9.2.2.2.2.cmml">υ</mi></mrow><mrow id="S3.SS3.p1.14.m9.7.7.1.1.1.3" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.cmml"><mi id="S3.SS3.p1.14.m9.7.7.1.1.1.3.2" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p1.14.m9.7.7.1.1.1.3.1" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.14.m9.7.7.1.1.1.3.3" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.SS3.p1.14.m9.9.9.3.3.5" xref="S3.SS3.p1.14.m9.9.9.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.14.m9.8.8.2.2.2" xref="S3.SS3.p1.14.m9.8.8.2.2.2.cmml"><mi id="S3.SS3.p1.14.m9.8.8.2.2.2.2.2" xref="S3.SS3.p1.14.m9.8.8.2.2.2.2.2.cmml">z</mi><mrow id="S3.SS3.p1.14.m9.4.4.2.4" xref="S3.SS3.p1.14.m9.4.4.2.3.cmml"><mi id="S3.SS3.p1.14.m9.3.3.1.1" xref="S3.SS3.p1.14.m9.3.3.1.1.cmml">g</mi><mo id="S3.SS3.p1.14.m9.4.4.2.4.1" xref="S3.SS3.p1.14.m9.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p1.14.m9.4.4.2.2" xref="S3.SS3.p1.14.m9.4.4.2.2.cmml">υ</mi></mrow><mi id="S3.SS3.p1.14.m9.8.8.2.2.2.3" xref="S3.SS3.p1.14.m9.8.8.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.SS3.p1.14.m9.9.9.3.3.6" xref="S3.SS3.p1.14.m9.9.9.3.4.cmml">,</mo><msubsup id="S3.SS3.p1.14.m9.9.9.3.3.3" xref="S3.SS3.p1.14.m9.9.9.3.3.3.cmml"><mi id="S3.SS3.p1.14.m9.9.9.3.3.3.2.2" xref="S3.SS3.p1.14.m9.9.9.3.3.3.2.2.cmml">z</mi><mrow id="S3.SS3.p1.14.m9.6.6.2.4" xref="S3.SS3.p1.14.m9.6.6.2.3.cmml"><mi id="S3.SS3.p1.14.m9.5.5.1.1" xref="S3.SS3.p1.14.m9.5.5.1.1.cmml">i</mi><mo id="S3.SS3.p1.14.m9.6.6.2.4.1" xref="S3.SS3.p1.14.m9.6.6.2.3.cmml">,</mo><mi id="S3.SS3.p1.14.m9.6.6.2.2" xref="S3.SS3.p1.14.m9.6.6.2.2.cmml">υ</mi></mrow><mi id="S3.SS3.p1.14.m9.9.9.3.3.3.3" xref="S3.SS3.p1.14.m9.9.9.3.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.SS3.p1.14.m9.9.9.3.3.7" xref="S3.SS3.p1.14.m9.9.9.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m9.9b"><apply id="S3.SS3.p1.14.m9.9.9.cmml" xref="S3.SS3.p1.14.m9.9.9"><times id="S3.SS3.p1.14.m9.9.9.4.cmml" xref="S3.SS3.p1.14.m9.9.9.4"></times><apply id="S3.SS3.p1.14.m9.9.9.5.cmml" xref="S3.SS3.p1.14.m9.9.9.5"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.9.9.5.1.cmml" xref="S3.SS3.p1.14.m9.9.9.5">subscript</csymbol><ci id="S3.SS3.p1.14.m9.9.9.5.2.cmml" xref="S3.SS3.p1.14.m9.9.9.5.2">ℓ</ci><apply id="S3.SS3.p1.14.m9.9.9.5.3.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3"><times id="S3.SS3.p1.14.m9.9.9.5.3.1.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.1"></times><ci id="S3.SS3.p1.14.m9.9.9.5.3.2.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.2">𝑐</ci><ci id="S3.SS3.p1.14.m9.9.9.5.3.3.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.3">𝑜</ci><ci id="S3.SS3.p1.14.m9.9.9.5.3.4.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.4">𝑛</ci><ci id="S3.SS3.p1.14.m9.9.9.5.3.5.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.5">_</ci><ci id="S3.SS3.p1.14.m9.9.9.5.3.6.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.6">𝑎</ci><ci id="S3.SS3.p1.14.m9.9.9.5.3.7.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.7">𝑢</ci><ci id="S3.SS3.p1.14.m9.9.9.5.3.8.cmml" xref="S3.SS3.p1.14.m9.9.9.5.3.8">𝑔</ci></apply></apply><vector id="S3.SS3.p1.14.m9.9.9.3.4.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3"><apply id="S3.SS3.p1.14.m9.7.7.1.1.1.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.7.7.1.1.1.1.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.14.m9.7.7.1.1.1.2.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.7.7.1.1.1.2.1.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.14.m9.7.7.1.1.1.2.2.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1.2.2">𝑧</ci><list id="S3.SS3.p1.14.m9.2.2.2.3.cmml" xref="S3.SS3.p1.14.m9.2.2.2.4"><ci id="S3.SS3.p1.14.m9.1.1.1.1.cmml" xref="S3.SS3.p1.14.m9.1.1.1.1">𝑖</ci><ci id="S3.SS3.p1.14.m9.2.2.2.2.cmml" xref="S3.SS3.p1.14.m9.2.2.2.2">𝜐</ci></list></apply><apply id="S3.SS3.p1.14.m9.7.7.1.1.1.3.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3"><plus id="S3.SS3.p1.14.m9.7.7.1.1.1.3.1.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.1"></plus><ci id="S3.SS3.p1.14.m9.7.7.1.1.1.3.2.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p1.14.m9.7.7.1.1.1.3.3.cmml" xref="S3.SS3.p1.14.m9.7.7.1.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p1.14.m9.8.8.2.2.2.cmml" xref="S3.SS3.p1.14.m9.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.8.8.2.2.2.1.cmml" xref="S3.SS3.p1.14.m9.8.8.2.2.2">superscript</csymbol><apply id="S3.SS3.p1.14.m9.8.8.2.2.2.2.cmml" xref="S3.SS3.p1.14.m9.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.8.8.2.2.2.2.1.cmml" xref="S3.SS3.p1.14.m9.8.8.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.14.m9.8.8.2.2.2.2.2.cmml" xref="S3.SS3.p1.14.m9.8.8.2.2.2.2.2">𝑧</ci><list id="S3.SS3.p1.14.m9.4.4.2.3.cmml" xref="S3.SS3.p1.14.m9.4.4.2.4"><ci id="S3.SS3.p1.14.m9.3.3.1.1.cmml" xref="S3.SS3.p1.14.m9.3.3.1.1">𝑔</ci><ci id="S3.SS3.p1.14.m9.4.4.2.2.cmml" xref="S3.SS3.p1.14.m9.4.4.2.2">𝜐</ci></list></apply><ci id="S3.SS3.p1.14.m9.8.8.2.2.2.3.cmml" xref="S3.SS3.p1.14.m9.8.8.2.2.2.3">𝑡</ci></apply><apply id="S3.SS3.p1.14.m9.9.9.3.3.3.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.9.9.3.3.3.1.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3.3">superscript</csymbol><apply id="S3.SS3.p1.14.m9.9.9.3.3.3.2.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.14.m9.9.9.3.3.3.2.1.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3.3">subscript</csymbol><ci id="S3.SS3.p1.14.m9.9.9.3.3.3.2.2.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3.3.2.2">𝑧</ci><list id="S3.SS3.p1.14.m9.6.6.2.3.cmml" xref="S3.SS3.p1.14.m9.6.6.2.4"><ci id="S3.SS3.p1.14.m9.5.5.1.1.cmml" xref="S3.SS3.p1.14.m9.5.5.1.1">𝑖</ci><ci id="S3.SS3.p1.14.m9.6.6.2.2.cmml" xref="S3.SS3.p1.14.m9.6.6.2.2">𝜐</ci></list></apply><ci id="S3.SS3.p1.14.m9.9.9.3.3.3.3.cmml" xref="S3.SS3.p1.14.m9.9.9.3.3.3.3">𝑡</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m9.9c">\ell_{con\_aug}(z_{i,\upsilon}^{t+1},z_{g,\upsilon}^{t},z_{i,\upsilon}^{t})</annotation></semantics></math>. The overall training process of ATPFL is shown in <a href="#alg1" title="In 3.3. Augmented TPFL (ATPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> ATPFL</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> The entire <math id="alg1.l1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">K</annotation></semantics></math> clients are indexed by <math id="alg1.l1.m2.4" class="ltx_Math" alttext="i\in\{1,2,\ldots,K\}" display="inline"><semantics id="alg1.l1.m2.4a"><mrow id="alg1.l1.m2.4.5" xref="alg1.l1.m2.4.5.cmml"><mi id="alg1.l1.m2.4.5.2" xref="alg1.l1.m2.4.5.2.cmml">i</mi><mo id="alg1.l1.m2.4.5.1" xref="alg1.l1.m2.4.5.1.cmml">∈</mo><mrow id="alg1.l1.m2.4.5.3.2" xref="alg1.l1.m2.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l1.m2.4.5.3.2.1" xref="alg1.l1.m2.4.5.3.1.cmml">{</mo><mn id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">1</mn><mo id="alg1.l1.m2.4.5.3.2.2" xref="alg1.l1.m2.4.5.3.1.cmml">,</mo><mn id="alg1.l1.m2.2.2" xref="alg1.l1.m2.2.2.cmml">2</mn><mo id="alg1.l1.m2.4.5.3.2.3" xref="alg1.l1.m2.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m2.3.3" xref="alg1.l1.m2.3.3.cmml">…</mi><mo id="alg1.l1.m2.4.5.3.2.4" xref="alg1.l1.m2.4.5.3.1.cmml">,</mo><mi id="alg1.l1.m2.4.4" xref="alg1.l1.m2.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l1.m2.4.5.3.2.5" xref="alg1.l1.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.4b"><apply id="alg1.l1.m2.4.5.cmml" xref="alg1.l1.m2.4.5"><in id="alg1.l1.m2.4.5.1.cmml" xref="alg1.l1.m2.4.5.1"></in><ci id="alg1.l1.m2.4.5.2.cmml" xref="alg1.l1.m2.4.5.2">𝑖</ci><set id="alg1.l1.m2.4.5.3.1.cmml" xref="alg1.l1.m2.4.5.3.2"><cn type="integer" id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">1</cn><cn type="integer" id="alg1.l1.m2.2.2.cmml" xref="alg1.l1.m2.2.2">2</cn><ci id="alg1.l1.m2.3.3.cmml" xref="alg1.l1.m2.3.3">…</ci><ci id="alg1.l1.m2.4.4.cmml" xref="alg1.l1.m2.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.4c">i\in\{1,2,\ldots,K\}</annotation></semantics></math>; <math id="alg1.l1.m3.1" class="ltx_Math" alttext="T_{g}" display="inline"><semantics id="alg1.l1.m3.1a"><msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">T</mi><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">subscript</csymbol><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑇</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">T_{g}</annotation></semantics></math> and <math id="alg1.l1.m4.1" class="ltx_Math" alttext="T_{loc}" display="inline"><semantics id="alg1.l1.m4.1a"><msub id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">T</mi><mrow id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml"><mi id="alg1.l1.m4.1.1.3.2" xref="alg1.l1.m4.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.3" xref="alg1.l1.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.1.3.1a" xref="alg1.l1.m4.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m4.1.1.3.4" xref="alg1.l1.m4.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑇</ci><apply id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3"><times id="alg1.l1.m4.1.1.3.1.cmml" xref="alg1.l1.m4.1.1.3.1"></times><ci id="alg1.l1.m4.1.1.3.2.cmml" xref="alg1.l1.m4.1.1.3.2">𝑙</ci><ci id="alg1.l1.m4.1.1.3.3.cmml" xref="alg1.l1.m4.1.1.3.3">𝑜</ci><ci id="alg1.l1.m4.1.1.3.4.cmml" xref="alg1.l1.m4.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">T_{loc}</annotation></semantics></math> is the number of global epochs and local epochs, respectively, and <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\alpha</annotation></semantics></math> is the learning rate.

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Server executes:</span>




</div>
<div id="alg1.l3" class="ltx_listingline">     Initialize <math id="alg1.l3.m1.2" class="ltx_Math" alttext="\bm{\tau}_{g}^{0},\bm{\upsilon}_{g}^{0}" display="inline"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2.2" xref="alg1.l3.m1.2.2.3.cmml"><msubsup id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.cmml">𝝉</mi><mi id="alg1.l3.m1.1.1.1.1.2.3" xref="alg1.l3.m1.1.1.1.1.2.3.cmml">g</mi><mn id="alg1.l3.m1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.3.cmml">0</mn></msubsup><mo id="alg1.l3.m1.2.2.2.3" xref="alg1.l3.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l3.m1.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.cmml"><mi id="alg1.l3.m1.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.cmml">𝝊</mi><mi id="alg1.l3.m1.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.3.cmml">g</mi><mn id="alg1.l3.m1.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.3.cmml">0</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><list id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.2"><apply id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2">𝝉</ci><ci id="alg1.l3.m1.1.1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.2.3">𝑔</ci></apply><cn type="integer" id="alg1.l3.m1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.3">0</cn></apply><apply id="alg1.l3.m1.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l3.m1.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2">𝝊</ci><ci id="alg1.l3.m1.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.3">𝑔</ci></apply><cn type="integer" id="alg1.l3.m1.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.3">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">\bm{\tau}_{g}^{0},\bm{\upsilon}_{g}^{0}</annotation></semantics></math>
  
</div>
<div id="alg1.l4" class="ltx_listingline">     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l4.m1.4" class="ltx_Math" alttext="t=1,2,\ldots,T_{g}" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml"><mi id="alg1.l4.m1.4.4.3" xref="alg1.l4.m1.4.4.3.cmml">t</mi><mo id="alg1.l4.m1.4.4.2" xref="alg1.l4.m1.4.4.2.cmml">=</mo><mrow id="alg1.l4.m1.4.4.1.1" xref="alg1.l4.m1.4.4.1.2.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.4.1.1.2" xref="alg1.l4.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.4.1.1.3" xref="alg1.l4.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.4.1.1.4" xref="alg1.l4.m1.4.4.1.2.cmml">,</mo><msub id="alg1.l4.m1.4.4.1.1.1" xref="alg1.l4.m1.4.4.1.1.1.cmml"><mi id="alg1.l4.m1.4.4.1.1.1.2" xref="alg1.l4.m1.4.4.1.1.1.2.cmml">T</mi><mi id="alg1.l4.m1.4.4.1.1.1.3" xref="alg1.l4.m1.4.4.1.1.1.3.cmml">g</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4"><eq id="alg1.l4.m1.4.4.2.cmml" xref="alg1.l4.m1.4.4.2"></eq><ci id="alg1.l4.m1.4.4.3.cmml" xref="alg1.l4.m1.4.4.3">𝑡</ci><list id="alg1.l4.m1.4.4.1.2.cmml" xref="alg1.l4.m1.4.4.1.1"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><apply id="alg1.l4.m1.4.4.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.4.4.1.1.1.1.cmml" xref="alg1.l4.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.4.4.1.1.1.2.cmml" xref="alg1.l4.m1.4.4.1.1.1.2">𝑇</ci><ci id="alg1.l4.m1.4.4.1.1.1.3.cmml" xref="alg1.l4.m1.4.4.1.1.1.3">𝑔</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">t=1,2,\ldots,T_{g}</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">        <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l5.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">i</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">           <math id="alg1.l6.m1.5" class="ltx_Math" alttext="\bm{\tau}_{i}^{t+1},\bm{\upsilon}_{i}^{t+1}\leftarrow ClientUpdate(i,\bm{\tau}_{g}^{t},\bm{\upsilon}_{g}^{t})" display="inline"><semantics id="alg1.l6.m1.5a"><mrow id="alg1.l6.m1.5.5" xref="alg1.l6.m1.5.5.cmml"><mrow id="alg1.l6.m1.3.3.2.2" xref="alg1.l6.m1.3.3.2.3.cmml"><msubsup id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.2.2" xref="alg1.l6.m1.2.2.1.1.1.2.2.cmml">𝝉</mi><mi id="alg1.l6.m1.2.2.1.1.1.2.3" xref="alg1.l6.m1.2.2.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.3.2" xref="alg1.l6.m1.2.2.1.1.1.3.2.cmml">t</mi><mo id="alg1.l6.m1.2.2.1.1.1.3.1" xref="alg1.l6.m1.2.2.1.1.1.3.1.cmml">+</mo><mn id="alg1.l6.m1.2.2.1.1.1.3.3" xref="alg1.l6.m1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l6.m1.3.3.2.2.3" xref="alg1.l6.m1.3.3.2.3.cmml">,</mo><msubsup id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.2.cmml">𝝊</mi><mi id="alg1.l6.m1.3.3.2.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.2.3.cmml">i</mi><mrow id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.3.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.3.2" xref="alg1.l6.m1.3.3.2.2.2.3.2.cmml">t</mi><mo id="alg1.l6.m1.3.3.2.2.2.3.1" xref="alg1.l6.m1.3.3.2.2.2.3.1.cmml">+</mo><mn id="alg1.l6.m1.3.3.2.2.2.3.3" xref="alg1.l6.m1.3.3.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="alg1.l6.m1.5.5.5" xref="alg1.l6.m1.5.5.5.cmml">←</mo><mrow id="alg1.l6.m1.5.5.4" xref="alg1.l6.m1.5.5.4.cmml"><mi id="alg1.l6.m1.5.5.4.4" xref="alg1.l6.m1.5.5.4.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.5" xref="alg1.l6.m1.5.5.4.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3a" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.6" xref="alg1.l6.m1.5.5.4.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3b" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.7" xref="alg1.l6.m1.5.5.4.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3c" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.8" xref="alg1.l6.m1.5.5.4.8.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3d" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.9" xref="alg1.l6.m1.5.5.4.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3e" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.10" xref="alg1.l6.m1.5.5.4.10.cmml">U</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3f" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.11" xref="alg1.l6.m1.5.5.4.11.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3g" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.12" xref="alg1.l6.m1.5.5.4.12.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3h" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.13" xref="alg1.l6.m1.5.5.4.13.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3i" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.14" xref="alg1.l6.m1.5.5.4.14.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3j" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mi id="alg1.l6.m1.5.5.4.15" xref="alg1.l6.m1.5.5.4.15.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.5.5.4.3k" xref="alg1.l6.m1.5.5.4.3.cmml">​</mo><mrow id="alg1.l6.m1.5.5.4.2.2" xref="alg1.l6.m1.5.5.4.2.3.cmml"><mo stretchy="false" id="alg1.l6.m1.5.5.4.2.2.3" xref="alg1.l6.m1.5.5.4.2.3.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">i</mi><mo id="alg1.l6.m1.5.5.4.2.2.4" xref="alg1.l6.m1.5.5.4.2.3.cmml">,</mo><msubsup id="alg1.l6.m1.4.4.3.1.1.1" xref="alg1.l6.m1.4.4.3.1.1.1.cmml"><mi id="alg1.l6.m1.4.4.3.1.1.1.2.2" xref="alg1.l6.m1.4.4.3.1.1.1.2.2.cmml">𝝉</mi><mi id="alg1.l6.m1.4.4.3.1.1.1.2.3" xref="alg1.l6.m1.4.4.3.1.1.1.2.3.cmml">g</mi><mi id="alg1.l6.m1.4.4.3.1.1.1.3" xref="alg1.l6.m1.4.4.3.1.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l6.m1.5.5.4.2.2.5" xref="alg1.l6.m1.5.5.4.2.3.cmml">,</mo><msubsup id="alg1.l6.m1.5.5.4.2.2.2" xref="alg1.l6.m1.5.5.4.2.2.2.cmml"><mi id="alg1.l6.m1.5.5.4.2.2.2.2.2" xref="alg1.l6.m1.5.5.4.2.2.2.2.2.cmml">𝝊</mi><mi id="alg1.l6.m1.5.5.4.2.2.2.2.3" xref="alg1.l6.m1.5.5.4.2.2.2.2.3.cmml">g</mi><mi id="alg1.l6.m1.5.5.4.2.2.2.3" xref="alg1.l6.m1.5.5.4.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.5.5.4.2.2.6" xref="alg1.l6.m1.5.5.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.5b"><apply id="alg1.l6.m1.5.5.cmml" xref="alg1.l6.m1.5.5"><ci id="alg1.l6.m1.5.5.5.cmml" xref="alg1.l6.m1.5.5.5">←</ci><list id="alg1.l6.m1.3.3.2.3.cmml" xref="alg1.l6.m1.3.3.2.2"><apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2.2">𝝉</ci><ci id="alg1.l6.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3"><plus id="alg1.l6.m1.2.2.1.1.1.3.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.3.1"></plus><ci id="alg1.l6.m1.2.2.1.1.1.3.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l6.m1.2.2.1.1.1.3.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l6.m1.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2">𝝊</ci><ci id="alg1.l6.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.3.3.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.3"><plus id="alg1.l6.m1.3.3.2.2.2.3.1.cmml" xref="alg1.l6.m1.3.3.2.2.2.3.1"></plus><ci id="alg1.l6.m1.3.3.2.2.2.3.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l6.m1.3.3.2.2.2.3.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.3.3">1</cn></apply></apply></list><apply id="alg1.l6.m1.5.5.4.cmml" xref="alg1.l6.m1.5.5.4"><times id="alg1.l6.m1.5.5.4.3.cmml" xref="alg1.l6.m1.5.5.4.3"></times><ci id="alg1.l6.m1.5.5.4.4.cmml" xref="alg1.l6.m1.5.5.4.4">𝐶</ci><ci id="alg1.l6.m1.5.5.4.5.cmml" xref="alg1.l6.m1.5.5.4.5">𝑙</ci><ci id="alg1.l6.m1.5.5.4.6.cmml" xref="alg1.l6.m1.5.5.4.6">𝑖</ci><ci id="alg1.l6.m1.5.5.4.7.cmml" xref="alg1.l6.m1.5.5.4.7">𝑒</ci><ci id="alg1.l6.m1.5.5.4.8.cmml" xref="alg1.l6.m1.5.5.4.8">𝑛</ci><ci id="alg1.l6.m1.5.5.4.9.cmml" xref="alg1.l6.m1.5.5.4.9">𝑡</ci><ci id="alg1.l6.m1.5.5.4.10.cmml" xref="alg1.l6.m1.5.5.4.10">𝑈</ci><ci id="alg1.l6.m1.5.5.4.11.cmml" xref="alg1.l6.m1.5.5.4.11">𝑝</ci><ci id="alg1.l6.m1.5.5.4.12.cmml" xref="alg1.l6.m1.5.5.4.12">𝑑</ci><ci id="alg1.l6.m1.5.5.4.13.cmml" xref="alg1.l6.m1.5.5.4.13">𝑎</ci><ci id="alg1.l6.m1.5.5.4.14.cmml" xref="alg1.l6.m1.5.5.4.14">𝑡</ci><ci id="alg1.l6.m1.5.5.4.15.cmml" xref="alg1.l6.m1.5.5.4.15">𝑒</ci><vector id="alg1.l6.m1.5.5.4.2.3.cmml" xref="alg1.l6.m1.5.5.4.2.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑖</ci><apply id="alg1.l6.m1.4.4.3.1.1.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.1.1.1.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1">superscript</csymbol><apply id="alg1.l6.m1.4.4.3.1.1.1.2.cmml" xref="alg1.l6.m1.4.4.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.1.1.1.2.1.cmml" xref="alg1.l6.m1.4.4.3.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.4.4.3.1.1.1.2.2.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.2.2">𝝉</ci><ci id="alg1.l6.m1.4.4.3.1.1.1.2.3.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.2.3">𝑔</ci></apply><ci id="alg1.l6.m1.4.4.3.1.1.1.3.cmml" xref="alg1.l6.m1.4.4.3.1.1.1.3">𝑡</ci></apply><apply id="alg1.l6.m1.5.5.4.2.2.2.cmml" xref="alg1.l6.m1.5.5.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.5.5.4.2.2.2.1.cmml" xref="alg1.l6.m1.5.5.4.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.5.5.4.2.2.2.2.cmml" xref="alg1.l6.m1.5.5.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.5.5.4.2.2.2.2.1.cmml" xref="alg1.l6.m1.5.5.4.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.5.5.4.2.2.2.2.2.cmml" xref="alg1.l6.m1.5.5.4.2.2.2.2.2">𝝊</ci><ci id="alg1.l6.m1.5.5.4.2.2.2.2.3.cmml" xref="alg1.l6.m1.5.5.4.2.2.2.2.3">𝑔</ci></apply><ci id="alg1.l6.m1.5.5.4.2.2.2.3.cmml" xref="alg1.l6.m1.5.5.4.2.2.2.3">𝑡</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.5c">\bm{\tau}_{i}^{t+1},\bm{\upsilon}_{i}^{t+1}\leftarrow ClientUpdate(i,\bm{\tau}_{g}^{t},\bm{\upsilon}_{g}^{t})</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">        <span id="alg1.l7.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l8" class="ltx_listingline">        Aggregate the global prompts <math id="alg1.l8.m1.2" class="ltx_Math" alttext="\bm{\tau}_{g}^{t+1},\bm{\upsilon}_{g}^{t+1}" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.3.cmml"><msubsup id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.2.2.cmml">𝝉</mi><mi id="alg1.l8.m1.1.1.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.2.3.cmml">g</mi><mrow id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l8.m1.1.1.1.1.3.1" xref="alg1.l8.m1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l8.m1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml">𝝊</mi><mi id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">g</mi><mrow id="alg1.l8.m1.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.3.2" xref="alg1.l8.m1.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l8.m1.2.2.2.2.3.1" xref="alg1.l8.m1.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l8.m1.2.2.2.2.3.3" xref="alg1.l8.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><list id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.2"><apply id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.2.2">𝝉</ci><ci id="alg1.l8.m1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.2.3">𝑔</ci></apply><apply id="alg1.l8.m1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.3"><plus id="alg1.l8.m1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.3.1"></plus><ci id="alg1.l8.m1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">𝝊</ci><ci id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3">𝑔</ci></apply><apply id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.3"><plus id="alg1.l8.m1.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.3.1"></plus><ci id="alg1.l8.m1.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\bm{\tau}_{g}^{t+1},\bm{\upsilon}_{g}^{t+1}</annotation></semantics></math> by (<a href="#S3.E3" title="Equation 3 ‣ 3.2. Twin Prompt Federated Learning (TPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div id="alg1.l9" class="ltx_listingline">     <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg1.l10" class="ltx_listingline">  <span id="alg1.l10.1" class="ltx_text ltx_font_bold">ClientUpdate(<math id="alg1.l10.1.m1.3" class="ltx_Math" alttext="i,\bm{\tau}_{g}^{t},\bm{\upsilon}_{g}^{t}" display="inline"><semantics id="alg1.l10.1.m1.3a"><mrow id="alg1.l10.1.m1.3.3.2" xref="alg1.l10.1.m1.3.3.3.cmml"><mi id="alg1.l10.1.m1.1.1" xref="alg1.l10.1.m1.1.1.cmml">i</mi><mo id="alg1.l10.1.m1.3.3.2.3" xref="alg1.l10.1.m1.3.3.3.cmml">,</mo><msubsup id="alg1.l10.1.m1.2.2.1.1" xref="alg1.l10.1.m1.2.2.1.1.cmml"><mi id="alg1.l10.1.m1.2.2.1.1.2.2" xref="alg1.l10.1.m1.2.2.1.1.2.2.cmml">τ</mi><mi id="alg1.l10.1.m1.2.2.1.1.2.3" xref="alg1.l10.1.m1.2.2.1.1.2.3.cmml">g</mi><mi id="alg1.l10.1.m1.2.2.1.1.3" xref="alg1.l10.1.m1.2.2.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l10.1.m1.3.3.2.4" xref="alg1.l10.1.m1.3.3.3.cmml">,</mo><msubsup id="alg1.l10.1.m1.3.3.2.2" xref="alg1.l10.1.m1.3.3.2.2.cmml"><mi id="alg1.l10.1.m1.3.3.2.2.2.2" xref="alg1.l10.1.m1.3.3.2.2.2.2.cmml">υ</mi><mi id="alg1.l10.1.m1.3.3.2.2.2.3" xref="alg1.l10.1.m1.3.3.2.2.2.3.cmml">g</mi><mi id="alg1.l10.1.m1.3.3.2.2.3" xref="alg1.l10.1.m1.3.3.2.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.1.m1.3b"><list id="alg1.l10.1.m1.3.3.3.cmml" xref="alg1.l10.1.m1.3.3.2"><ci id="alg1.l10.1.m1.1.1.cmml" xref="alg1.l10.1.m1.1.1">𝑖</ci><apply id="alg1.l10.1.m1.2.2.1.1.cmml" xref="alg1.l10.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l10.1.m1.2.2.1.1.1.cmml" xref="alg1.l10.1.m1.2.2.1.1">superscript</csymbol><apply id="alg1.l10.1.m1.2.2.1.1.2.cmml" xref="alg1.l10.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l10.1.m1.2.2.1.1.2.1.cmml" xref="alg1.l10.1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l10.1.m1.2.2.1.1.2.2.cmml" xref="alg1.l10.1.m1.2.2.1.1.2.2">𝜏</ci><ci id="alg1.l10.1.m1.2.2.1.1.2.3.cmml" xref="alg1.l10.1.m1.2.2.1.1.2.3">𝑔</ci></apply><ci id="alg1.l10.1.m1.2.2.1.1.3.cmml" xref="alg1.l10.1.m1.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l10.1.m1.3.3.2.2.cmml" xref="alg1.l10.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.1.m1.3.3.2.2.1.cmml" xref="alg1.l10.1.m1.3.3.2.2">superscript</csymbol><apply id="alg1.l10.1.m1.3.3.2.2.2.cmml" xref="alg1.l10.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.1.m1.3.3.2.2.2.1.cmml" xref="alg1.l10.1.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l10.1.m1.3.3.2.2.2.2.cmml" xref="alg1.l10.1.m1.3.3.2.2.2.2">𝜐</ci><ci id="alg1.l10.1.m1.3.3.2.2.2.3.cmml" xref="alg1.l10.1.m1.3.3.2.2.2.3">𝑔</ci></apply><ci id="alg1.l10.1.m1.3.3.2.2.3.cmml" xref="alg1.l10.1.m1.3.3.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.1.m1.3c">i,\bm{\tau}_{g}^{t},\bm{\upsilon}_{g}^{t}</annotation></semantics></math>):</span>

</div>
<div id="alg1.l11" class="ltx_listingline">  <span id="alg1.l11.1" class="ltx_text ltx_font_bold">for</span> each local epoch from <math id="alg1.l11.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="alg1.l11.m1.1a"><mn id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><cn type="integer" id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">1</annotation></semantics></math> to <math id="alg1.l11.m2.1" class="ltx_Math" alttext="T_{loc}" display="inline"><semantics id="alg1.l11.m2.1a"><msub id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2" xref="alg1.l11.m2.1.1.2.cmml">T</mi><mrow id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml"><mi id="alg1.l11.m2.1.1.3.2" xref="alg1.l11.m2.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.1.3.1" xref="alg1.l11.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l11.m2.1.1.3.3" xref="alg1.l11.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.1.1.3.1a" xref="alg1.l11.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l11.m2.1.1.3.4" xref="alg1.l11.m2.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1.2">𝑇</ci><apply id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3"><times id="alg1.l11.m2.1.1.3.1.cmml" xref="alg1.l11.m2.1.1.3.1"></times><ci id="alg1.l11.m2.1.1.3.2.cmml" xref="alg1.l11.m2.1.1.3.2">𝑙</ci><ci id="alg1.l11.m2.1.1.3.3.cmml" xref="alg1.l11.m2.1.1.3.3">𝑜</ci><ci id="alg1.l11.m2.1.1.3.4.cmml" xref="alg1.l11.m2.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">T_{loc}</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l12" class="ltx_listingline">     Calculate the logits and loss for textual prompt and visual prompt by (<a href="#S3.E5" title="Equation 5 ‣ 3.3. Augmented TPFL (ATPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>)

</div>
<div id="alg1.l13" class="ltx_listingline">     Update the local textual and visual prompts by gradient descent:
<math id="alg1.l13.m1.2" class="ltx_Math" alttext="\bm{\tau}_{i}^{t+1}\leftarrow\bm{\tau}_{g}^{t}-\alpha\nabla\mathcal{L}_{\bm{\tau}_{i}^{t}},\ \bm{\upsilon}_{i}^{t+1}\leftarrow\bm{\upsilon}_{g}^{t}-\alpha\nabla\mathcal{L}_{\bm{\upsilon}_{i}^{t}}" display="inline"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.3.cmml"><mrow id="alg1.l13.m1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.cmml"><msubsup id="alg1.l13.m1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.1.1.2.2.2" xref="alg1.l13.m1.1.1.1.1.2.2.2.cmml">𝝉</mi><mi id="alg1.l13.m1.1.1.1.1.2.2.3" xref="alg1.l13.m1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="alg1.l13.m1.1.1.1.1.2.3" xref="alg1.l13.m1.1.1.1.1.2.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.2.3.2" xref="alg1.l13.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l13.m1.1.1.1.1.2.3.1" xref="alg1.l13.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l13.m1.1.1.1.1.2.3.3" xref="alg1.l13.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml">←</mo><mrow id="alg1.l13.m1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.3.cmml"><msubsup id="alg1.l13.m1.1.1.1.1.3.2" xref="alg1.l13.m1.1.1.1.1.3.2.cmml"><mi id="alg1.l13.m1.1.1.1.1.3.2.2.2" xref="alg1.l13.m1.1.1.1.1.3.2.2.2.cmml">𝝉</mi><mi id="alg1.l13.m1.1.1.1.1.3.2.2.3" xref="alg1.l13.m1.1.1.1.1.3.2.2.3.cmml">g</mi><mi id="alg1.l13.m1.1.1.1.1.3.2.3" xref="alg1.l13.m1.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l13.m1.1.1.1.1.3.1" xref="alg1.l13.m1.1.1.1.1.3.1.cmml">−</mo><mrow id="alg1.l13.m1.1.1.1.1.3.3" xref="alg1.l13.m1.1.1.1.1.3.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.3.3.2" xref="alg1.l13.m1.1.1.1.1.3.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg1.l13.m1.1.1.1.1.3.3.1" xref="alg1.l13.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l13.m1.1.1.1.1.3.3.3" xref="alg1.l13.m1.1.1.1.1.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l13.m1.1.1.1.1.3.3.3.1" xref="alg1.l13.m1.1.1.1.1.3.3.3.1.cmml">∇</mo><msub id="alg1.l13.m1.1.1.1.1.3.3.3.2" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.1.1.3.3.3.2.2" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.2.cmml">ℒ</mi><msubsup id="alg1.l13.m1.1.1.1.1.3.3.3.2.3" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.2" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.2.cmml">𝝉</mi><mi id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.3" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.3.cmml">i</mi><mi id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.3" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.3.cmml">t</mi></msubsup></msub></mrow></mrow></mrow></mrow><mo rspace="0.667em" id="alg1.l13.m1.2.2.2.3" xref="alg1.l13.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l13.m1.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.cmml"><msubsup id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.2.cmml">𝝊</mi><mi id="alg1.l13.m1.2.2.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="alg1.l13.m1.2.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.3.2" xref="alg1.l13.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l13.m1.2.2.2.2.2.3.1" xref="alg1.l13.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l13.m1.2.2.2.2.2.3.3" xref="alg1.l13.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg1.l13.m1.2.2.2.2.1" xref="alg1.l13.m1.2.2.2.2.1.cmml">←</mo><mrow id="alg1.l13.m1.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.3.cmml"><msubsup id="alg1.l13.m1.2.2.2.2.3.2" xref="alg1.l13.m1.2.2.2.2.3.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.3.2.2.2" xref="alg1.l13.m1.2.2.2.2.3.2.2.2.cmml">𝝊</mi><mi id="alg1.l13.m1.2.2.2.2.3.2.2.3" xref="alg1.l13.m1.2.2.2.2.3.2.2.3.cmml">g</mi><mi id="alg1.l13.m1.2.2.2.2.3.2.3" xref="alg1.l13.m1.2.2.2.2.3.2.3.cmml">t</mi></msubsup><mo id="alg1.l13.m1.2.2.2.2.3.1" xref="alg1.l13.m1.2.2.2.2.3.1.cmml">−</mo><mrow id="alg1.l13.m1.2.2.2.2.3.3" xref="alg1.l13.m1.2.2.2.2.3.3.cmml"><mi id="alg1.l13.m1.2.2.2.2.3.3.2" xref="alg1.l13.m1.2.2.2.2.3.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="alg1.l13.m1.2.2.2.2.3.3.1" xref="alg1.l13.m1.2.2.2.2.3.3.1.cmml">​</mo><mrow id="alg1.l13.m1.2.2.2.2.3.3.3" xref="alg1.l13.m1.2.2.2.2.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l13.m1.2.2.2.2.3.3.3.1" xref="alg1.l13.m1.2.2.2.2.3.3.3.1.cmml">∇</mo><msub id="alg1.l13.m1.2.2.2.2.3.3.3.2" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.2.2.2.2.3.3.3.2.2" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.2.cmml">ℒ</mi><msubsup id="alg1.l13.m1.2.2.2.2.3.3.3.2.3" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.cmml"><mi id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.2" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.2.cmml">𝝊</mi><mi id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.3" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.3.cmml">i</mi><mi id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.3" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.3.cmml">t</mi></msubsup></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.3a.cmml" xref="alg1.l13.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l13.m1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1"><ci id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">←</ci><apply id="alg1.l13.m1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.2.2.2">𝝉</ci><ci id="alg1.l13.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l13.m1.1.1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.2.3"><plus id="alg1.l13.m1.1.1.1.1.2.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.2.3.1"></plus><ci id="alg1.l13.m1.1.1.1.1.2.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l13.m1.1.1.1.1.2.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l13.m1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.3"><minus id="alg1.l13.m1.1.1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.1"></minus><apply id="alg1.l13.m1.1.1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.2">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.2.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.3.2.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.2.2.2">𝝉</ci><ci id="alg1.l13.m1.1.1.1.1.3.2.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.2.2.3">𝑔</ci></apply><ci id="alg1.l13.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l13.m1.1.1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.3"><times id="alg1.l13.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.1"></times><ci id="alg1.l13.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="alg1.l13.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3"><ci id="alg1.l13.m1.1.1.1.1.3.3.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.1">∇</ci><apply id="alg1.l13.m1.1.1.1.1.3.3.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.3.3.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.3.3.3.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.2">ℒ</ci><apply id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.1.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.2.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.2">𝝉</ci><ci id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.2.3">𝑖</ci></apply><ci id="alg1.l13.m1.1.1.1.1.3.3.3.2.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.3.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply><apply id="alg1.l13.m1.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2"><ci id="alg1.l13.m1.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.1">←</ci><apply id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l13.m1.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.2">𝝊</ci><ci id="alg1.l13.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.l13.m1.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.3"><plus id="alg1.l13.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l13.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l13.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="alg1.l13.m1.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.3"><minus id="alg1.l13.m1.2.2.2.2.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.1"></minus><apply id="alg1.l13.m1.2.2.2.2.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.3.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.2">superscript</csymbol><apply id="alg1.l13.m1.2.2.2.2.3.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.3.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.3.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.2.2.2">𝝊</ci><ci id="alg1.l13.m1.2.2.2.2.3.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.2.2.3">𝑔</ci></apply><ci id="alg1.l13.m1.2.2.2.2.3.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.2.3">𝑡</ci></apply><apply id="alg1.l13.m1.2.2.2.2.3.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.3"><times id="alg1.l13.m1.2.2.2.2.3.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.1"></times><ci id="alg1.l13.m1.2.2.2.2.3.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.2">𝛼</ci><apply id="alg1.l13.m1.2.2.2.2.3.3.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3"><ci id="alg1.l13.m1.2.2.2.2.3.3.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.1">∇</ci><apply id="alg1.l13.m1.2.2.2.2.3.3.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.3.3.3.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.3.3.3.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.2">ℒ</ci><apply id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3">superscript</csymbol><apply id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.2">𝝊</ci><ci id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.2.3">𝑖</ci></apply><ci id="alg1.l13.m1.2.2.2.2.3.3.3.2.3.3.cmml" xref="alg1.l13.m1.2.2.2.2.3.3.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\bm{\tau}_{i}^{t+1}\leftarrow\bm{\tau}_{g}^{t}-\alpha\nabla\mathcal{L}_{\bm{\tau}_{i}^{t}},\ \bm{\upsilon}_{i}^{t+1}\leftarrow\bm{\upsilon}_{g}^{t}-\alpha\nabla\mathcal{L}_{\bm{\upsilon}_{i}^{t}}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">  <span id="alg1.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l15" class="ltx_listingline">  Return <math id="alg1.l15.m1.2" class="ltx_Math" alttext="\bm{\tau}_{i}^{t+1},\bm{\upsilon}_{i}^{t+1}" display="inline"><semantics id="alg1.l15.m1.2a"><mrow id="alg1.l15.m1.2.2.2" xref="alg1.l15.m1.2.2.3.cmml"><msubsup id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.2.2" xref="alg1.l15.m1.1.1.1.1.2.2.cmml">𝝉</mi><mi id="alg1.l15.m1.1.1.1.1.2.3" xref="alg1.l15.m1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l15.m1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l15.m1.1.1.1.1.3.1" xref="alg1.l15.m1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l15.m1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l15.m1.2.2.2.3" xref="alg1.l15.m1.2.2.3.cmml">,</mo><msubsup id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.cmml">𝝊</mi><mi id="alg1.l15.m1.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.3.cmml">i</mi><mrow id="alg1.l15.m1.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.3.cmml"><mi id="alg1.l15.m1.2.2.2.2.3.2" xref="alg1.l15.m1.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l15.m1.2.2.2.2.3.1" xref="alg1.l15.m1.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l15.m1.2.2.2.2.3.3" xref="alg1.l15.m1.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.2b"><list id="alg1.l15.m1.2.2.3.cmml" xref="alg1.l15.m1.2.2.2"><apply id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1">superscript</csymbol><apply id="alg1.l15.m1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.1.1.2.2">𝝉</ci><ci id="alg1.l15.m1.1.1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l15.m1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.3"><plus id="alg1.l15.m1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.3.1"></plus><ci id="alg1.l15.m1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2">superscript</csymbol><apply id="alg1.l15.m1.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2">𝝊</ci><ci id="alg1.l15.m1.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.l15.m1.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.3"><plus id="alg1.l15.m1.2.2.2.2.3.1.cmml" xref="alg1.l15.m1.2.2.2.2.3.1"></plus><ci id="alg1.l15.m1.2.2.2.2.3.2.cmml" xref="alg1.l15.m1.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.2.2.2.2.3.3.cmml" xref="alg1.l15.m1.2.2.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.2c">\bm{\tau}_{i}^{t+1},\bm{\upsilon}_{i}^{t+1}</annotation></semantics></math> to the server

</div>
</div>
</figure>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T1.30.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>. </span><span id="S3.T1.31.2" class="ltx_text" style="font-size:90%;">Test Accuracy (%) Results for ViT model on 7 datasets with 5 different seeds.</span></figcaption>
<div id="S3.T1.28" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:429.3pt;height:58.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-114.7pt,15.7pt) scale(0.65171604648967,0.65171604648967) ;">
<table id="S3.T1.28.28" class="ltx_tabular ltx_align_middle">
<tr id="S3.T1.28.28.29" class="ltx_tr" style="background-color:#EBEBEB;">
<td id="S3.T1.28.28.29.1" class="ltx_td ltx_align_center ltx_border_rr" style="padding:0.1pt 5.0pt;">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span><span id="S3.T1.28.28.29.1.1" class="ltx_text" style="background-color:#EBEBEB;">
Algorithm (ViT)</span>
</td>
<td id="S3.T1.28.28.29.2" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.2.1" class="ltx_text" style="background-color:#EBEBEB;">Caltect-101</span></td>
<td id="S3.T1.28.28.29.3" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.3.1" class="ltx_text" style="background-color:#EBEBEB;">Flowers-102</span></td>
<td id="S3.T1.28.28.29.4" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.4.1" class="ltx_text" style="background-color:#EBEBEB;">Oxford-Pets</span></td>
<td id="S3.T1.28.28.29.5" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.5.1" class="ltx_text" style="background-color:#EBEBEB;">DTD</span></td>
<td id="S3.T1.28.28.29.6" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.6.1" class="ltx_text" style="background-color:#EBEBEB;">EuroSAT</span></td>
<td id="S3.T1.28.28.29.7" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.7.1" class="ltx_text" style="background-color:#EBEBEB;">Stanford Car</span></td>
<td id="S3.T1.28.28.29.8" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.29.8.1" class="ltx_text" style="background-color:#EBEBEB;">UCF-101</span></td>
</tr>
<tr id="S3.T1.7.7.7" class="ltx_tr">
<td id="S3.T1.7.7.7.8" class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" style="padding:0.1pt 5.0pt;">Local Training</td>
<td id="S3.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">86.9<sub id="S3.T1.1.1.1.1.1" class="ltx_sub"><span id="S3.T1.1.1.1.1.1.1" class="ltx_text ltx_font_italic">±0.03</span></sub>
</td>
<td id="S3.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">58.7<sub id="S3.T1.2.2.2.2.1" class="ltx_sub"><span id="S3.T1.2.2.2.2.1.1" class="ltx_text ltx_font_italic">±0.04</span></sub>
</td>
<td id="S3.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">83.6<sub id="S3.T1.3.3.3.3.1" class="ltx_sub"><span id="S3.T1.3.3.3.3.1.1" class="ltx_text ltx_font_italic">±0.02</span></sub>
</td>
<td id="S3.T1.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">37.8<sub id="S3.T1.4.4.4.4.1" class="ltx_sub"><span id="S3.T1.4.4.4.4.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">25.8<sub id="S3.T1.5.5.5.5.1" class="ltx_sub"><span id="S3.T1.5.5.5.5.1.1" class="ltx_text ltx_font_italic">±0.32</span></sub>
</td>
<td id="S3.T1.6.6.6.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">59.5<sub id="S3.T1.6.6.6.6.1" class="ltx_sub"><span id="S3.T1.6.6.6.6.1.1" class="ltx_text ltx_font_italic">±0.12</span></sub>
</td>
<td id="S3.T1.7.7.7.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">61.3<sub id="S3.T1.7.7.7.7.1" class="ltx_sub"><span id="S3.T1.7.7.7.7.1.1" class="ltx_text ltx_font_italic">±0.06</span></sub>
</td>
</tr>
<tr id="S3.T1.14.14.14" class="ltx_tr">
<td id="S3.T1.14.14.14.8" class="ltx_td ltx_align_center ltx_border_rr" style="padding:0.1pt 5.0pt;">PromptFL<cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite>
</td>
<td id="S3.T1.8.8.8.1" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">89.7<sub id="S3.T1.8.8.8.1.1" class="ltx_sub"><span id="S3.T1.8.8.8.1.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.9.9.9.2" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">67.6<sub id="S3.T1.9.9.9.2.1" class="ltx_sub"><span id="S3.T1.9.9.9.2.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.10.10.10.3" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">88.5<sub id="S3.T1.10.10.10.3.1" class="ltx_sub"><span id="S3.T1.10.10.10.3.1.1" class="ltx_text ltx_font_italic">±0.07</span></sub>
</td>
<td id="S3.T1.11.11.11.4" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">42.9<sub id="S3.T1.11.11.11.4.1" class="ltx_sub"><span id="S3.T1.11.11.11.4.1.1" class="ltx_text ltx_font_italic">±0.08</span></sub>
</td>
<td id="S3.T1.12.12.12.5" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">48.1<sub id="S3.T1.12.12.12.5.1" class="ltx_sub"><span id="S3.T1.12.12.12.5.1.1" class="ltx_text ltx_font_italic">±0.22</span></sub>
</td>
<td id="S3.T1.13.13.13.6" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">63.0<sub id="S3.T1.13.13.13.6.1" class="ltx_sub"><span id="S3.T1.13.13.13.6.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.14.14.14.7" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">66.1<sub id="S3.T1.14.14.14.7.1" class="ltx_sub"><span id="S3.T1.14.14.14.7.1.1" class="ltx_text ltx_font_italic">±0.02</span></sub>
</td>
</tr>
<tr id="S3.T1.21.21.21" class="ltx_tr">
<td id="S3.T1.21.21.21.8" class="ltx_td ltx_align_center ltx_border_rr" style="padding:0.1pt 5.0pt;">TPFL (ours)</td>
<td id="S3.T1.15.15.15.1" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">90.6<sub id="S3.T1.15.15.15.1.1" class="ltx_sub"><span id="S3.T1.15.15.15.1.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.16.16.16.2" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">68.9<sub id="S3.T1.16.16.16.2.1" class="ltx_sub"><span id="S3.T1.16.16.16.2.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.17.17.17.3" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">89.1<sub id="S3.T1.17.17.17.3.1" class="ltx_sub"><span id="S3.T1.17.17.17.3.1.1" class="ltx_text ltx_font_italic">±0.00</span></sub>
</td>
<td id="S3.T1.18.18.18.4" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">43.0<sub id="S3.T1.18.18.18.4.1" class="ltx_sub"><span id="S3.T1.18.18.18.4.1.1" class="ltx_text ltx_font_italic">±0.07</span></sub>
</td>
<td id="S3.T1.19.19.19.5" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">54.3<sub id="S3.T1.19.19.19.5.1" class="ltx_sub"><span id="S3.T1.19.19.19.5.1.1" class="ltx_text ltx_font_italic">±0.29</span></sub>
</td>
<td id="S3.T1.20.20.20.6" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">63.4<sub id="S3.T1.20.20.20.6.1" class="ltx_sub"><span id="S3.T1.20.20.20.6.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T1.21.21.21.7" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">65.9<sub id="S3.T1.21.21.21.7.1" class="ltx_sub"><span id="S3.T1.21.21.21.7.1.1" class="ltx_text ltx_font_italic">±0.02</span></sub>
</td>
</tr>
<tr id="S3.T1.28.28.28" class="ltx_tr">
<td id="S3.T1.28.28.28.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr ltx_border_tt" style="padding:0.1pt 5.0pt;">
<span id="S3.T1.28.28.28.8.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">ATPFL</span> (ours)</td>
<td id="S3.T1.22.22.22.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.22.22.22.1.1" class="ltx_text ltx_font_bold">91.3<sub id="S3.T1.22.22.22.1.1.1" class="ltx_sub"><span id="S3.T1.22.22.22.1.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.01</span></sub></span></td>
<td id="S3.T1.23.23.23.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.23.23.23.2.1" class="ltx_text ltx_font_bold">69.6<sub id="S3.T1.23.23.23.2.1.1" class="ltx_sub"><span id="S3.T1.23.23.23.2.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.01</span></sub></span></td>
<td id="S3.T1.24.24.24.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.24.24.24.3.1" class="ltx_text ltx_font_bold">89.5<sub id="S3.T1.24.24.24.3.1.1" class="ltx_sub"><span id="S3.T1.24.24.24.3.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.01</span></sub></span></td>
<td id="S3.T1.25.25.25.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.25.25.25.4.1" class="ltx_text ltx_font_bold">44.1<sub id="S3.T1.25.25.25.4.1.1" class="ltx_sub"><span id="S3.T1.25.25.25.4.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.01</span></sub></span></td>
<td id="S3.T1.26.26.26.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.26.26.26.5.1" class="ltx_text ltx_font_bold">54.9<sub id="S3.T1.26.26.26.5.1.1" class="ltx_sub"><span id="S3.T1.26.26.26.5.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.26</span></sub></span></td>
<td id="S3.T1.27.27.27.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.27.27.27.6.1" class="ltx_text ltx_font_bold">63.8<sub id="S3.T1.27.27.27.6.1.1" class="ltx_sub"><span id="S3.T1.27.27.27.6.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.00</span></sub></span></td>
<td id="S3.T1.28.28.28.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T1.28.28.28.7.1" class="ltx_text ltx_font_bold">66.5<sub id="S3.T1.28.28.28.7.1.1" class="ltx_sub"><span id="S3.T1.28.28.28.7.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.01</span></sub></span></td>
</tr>
</table>
</span></div>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S3.T2.30.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>. </span><span id="S3.T2.31.2" class="ltx_text" style="font-size:90%;">Test Accuracy (%) Results for ResNet-50 model on 7 datasets with 5 different seeds.</span></figcaption>
<div id="S3.T2.28" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:429.3pt;height:58.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-114.7pt,15.7pt) scale(0.65171604648967,0.65171604648967) ;">
<table id="S3.T2.28.28" class="ltx_tabular ltx_align_middle">
<tr id="S3.T2.28.28.29" class="ltx_tr" style="background-color:#EBEBEB;">
<td id="S3.T2.28.28.29.1" class="ltx_td ltx_align_center ltx_border_rr" style="padding:0.1pt 5.0pt;">
<span class="ltx_rule" style="width:100%;height:1.0pt;background:black;display:inline-block;"> </span><span id="S3.T2.28.28.29.1.1" class="ltx_text" style="background-color:#EBEBEB;">
Algorithm (RN50)</span>
</td>
<td id="S3.T2.28.28.29.2" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.2.1" class="ltx_text" style="background-color:#EBEBEB;">Caltect-101</span></td>
<td id="S3.T2.28.28.29.3" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.3.1" class="ltx_text" style="background-color:#EBEBEB;">Flowers-102</span></td>
<td id="S3.T2.28.28.29.4" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.4.1" class="ltx_text" style="background-color:#EBEBEB;">Oxford-Pets</span></td>
<td id="S3.T2.28.28.29.5" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.5.1" class="ltx_text" style="background-color:#EBEBEB;">DTD</span></td>
<td id="S3.T2.28.28.29.6" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.6.1" class="ltx_text" style="background-color:#EBEBEB;">EuroSAT</span></td>
<td id="S3.T2.28.28.29.7" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.7.1" class="ltx_text" style="background-color:#EBEBEB;">Stanford Car</span></td>
<td id="S3.T2.28.28.29.8" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.29.8.1" class="ltx_text" style="background-color:#EBEBEB;">UCF-101</span></td>
</tr>
<tr id="S3.T2.7.7.7" class="ltx_tr">
<td id="S3.T2.7.7.7.8" class="ltx_td ltx_align_center ltx_border_rr ltx_border_tt" style="padding:0.1pt 5.0pt;">Local Training</td>
<td id="S3.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">63.1<sub id="S3.T2.1.1.1.1.1" class="ltx_sub"><span id="S3.T2.1.1.1.1.1.1" class="ltx_text ltx_font_italic">±0.37</span></sub>
</td>
<td id="S3.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">18.7<sub id="S3.T2.2.2.2.2.1" class="ltx_sub"><span id="S3.T2.2.2.2.2.1.1" class="ltx_text ltx_font_italic">±2.61</span></sub>
</td>
<td id="S3.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">30.8<sub id="S3.T2.3.3.3.3.1" class="ltx_sub"><span id="S3.T2.3.3.3.3.1.1" class="ltx_text ltx_font_italic">±4.83</span></sub>
</td>
<td id="S3.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">22.5<sub id="S3.T2.4.4.4.4.1" class="ltx_sub"><span id="S3.T2.4.4.4.4.1.1" class="ltx_text ltx_font_italic">±0.21</span></sub>
</td>
<td id="S3.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">19.2<sub id="S3.T2.5.5.5.5.1" class="ltx_sub"><span id="S3.T2.5.5.5.5.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">20.1<sub id="S3.T2.6.6.6.6.1" class="ltx_sub"><span id="S3.T2.6.6.6.6.1.1" class="ltx_text ltx_font_italic">±0.93</span></sub>
</td>
<td id="S3.T2.7.7.7.7" class="ltx_td ltx_align_center ltx_border_tt" style="padding:0.1pt 5.0pt;">34.3<sub id="S3.T2.7.7.7.7.1" class="ltx_sub"><span id="S3.T2.7.7.7.7.1.1" class="ltx_text ltx_font_italic">±0.36</span></sub>
</td>
</tr>
<tr id="S3.T2.14.14.14" class="ltx_tr">
<td id="S3.T2.14.14.14.8" class="ltx_td ltx_align_center ltx_border_rr" style="padding:0.1pt 5.0pt;">PromptFL<cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite>
</td>
<td id="S3.T2.8.8.8.1" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">84.8<sub id="S3.T2.8.8.8.1.1" class="ltx_sub"><span id="S3.T2.8.8.8.1.1.1" class="ltx_text ltx_font_italic">±0.04</span></sub>
</td>
<td id="S3.T2.9.9.9.2" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">58.7<sub id="S3.T2.9.9.9.2.1" class="ltx_sub"><span id="S3.T2.9.9.9.2.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T2.10.10.10.3" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">85.3<sub id="S3.T2.10.10.10.3.1" class="ltx_sub"><span id="S3.T2.10.10.10.3.1.1" class="ltx_text ltx_font_italic">±0.04</span></sub>
</td>
<td id="S3.T2.11.11.11.4" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">35.7<sub id="S3.T2.11.11.11.4.1" class="ltx_sub"><span id="S3.T2.11.11.11.4.1.1" class="ltx_text ltx_font_italic">±0.03</span></sub>
</td>
<td id="S3.T2.12.12.12.5" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.12.12.12.5.1" class="ltx_text ltx_font_bold">33.4<sub id="S3.T2.12.12.12.5.1.1" class="ltx_sub"><span id="S3.T2.12.12.12.5.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.03</span></sub></span></td>
<td id="S3.T2.13.13.13.6" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">52.9<sub id="S3.T2.13.13.13.6.1" class="ltx_sub"><span id="S3.T2.13.13.13.6.1.1" class="ltx_text ltx_font_italic">±0.02</span></sub>
</td>
<td id="S3.T2.14.14.14.7" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">57.8<sub id="S3.T2.14.14.14.7.1" class="ltx_sub"><span id="S3.T2.14.14.14.7.1.1" class="ltx_text ltx_font_italic">±0.07</span></sub>
</td>
</tr>
<tr id="S3.T2.21.21.21" class="ltx_tr">
<td id="S3.T2.21.21.21.8" class="ltx_td ltx_align_center ltx_border_rr" style="padding:0.1pt 5.0pt;">TPFL (ours)</td>
<td id="S3.T2.15.15.15.1" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">85.2<sub id="S3.T2.15.15.15.1.1" class="ltx_sub"><span id="S3.T2.15.15.15.1.1.1" class="ltx_text ltx_font_italic">±0.02</span></sub>
</td>
<td id="S3.T2.16.16.16.2" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">59.6<sub id="S3.T2.16.16.16.2.1" class="ltx_sub"><span id="S3.T2.16.16.16.2.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T2.17.17.17.3" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.17.17.17.3.1" class="ltx_text ltx_font_bold">85.6<sub id="S3.T2.17.17.17.3.1.1" class="ltx_sub"><span id="S3.T2.17.17.17.3.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.02</span></sub></span></td>
<td id="S3.T2.18.18.18.4" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;"><span id="S3.T2.18.18.18.4.1" class="ltx_text ltx_font_bold">37.4<sub id="S3.T2.18.18.18.4.1.1" class="ltx_sub"><span id="S3.T2.18.18.18.4.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.03</span></sub></span></td>
<td id="S3.T2.19.19.19.5" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">32.2<sub id="S3.T2.19.19.19.5.1" class="ltx_sub"><span id="S3.T2.19.19.19.5.1.1" class="ltx_text ltx_font_italic">±0.04</span></sub>
</td>
<td id="S3.T2.20.20.20.6" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">53.8<sub id="S3.T2.20.20.20.6.1" class="ltx_sub"><span id="S3.T2.20.20.20.6.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T2.21.21.21.7" class="ltx_td ltx_align_center" style="padding:0.1pt 5.0pt;">58.2<sub id="S3.T2.21.21.21.7.1" class="ltx_sub"><span id="S3.T2.21.21.21.7.1.1" class="ltx_text ltx_font_italic">±0.03</span></sub>
</td>
</tr>
<tr id="S3.T2.28.28.28" class="ltx_tr">
<td id="S3.T2.28.28.28.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr ltx_border_tt" style="padding:0.1pt 5.0pt;">
<span id="S3.T2.28.28.28.8.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">ATPFL</span> (ours)</td>
<td id="S3.T2.22.22.22.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T2.22.22.22.1.1" class="ltx_text ltx_font_bold">85.6<sub id="S3.T2.22.22.22.1.1.1" class="ltx_sub"><span id="S3.T2.22.22.22.1.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.02</span></sub></span></td>
<td id="S3.T2.23.23.23.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T2.23.23.23.2.1" class="ltx_text ltx_font_bold">60.5<sub id="S3.T2.23.23.23.2.1.1" class="ltx_sub"><span id="S3.T2.23.23.23.2.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.00</span></sub></span></td>
<td id="S3.T2.24.24.24.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;">85.4<sub id="S3.T2.24.24.24.3.1" class="ltx_sub"><span id="S3.T2.24.24.24.3.1.1" class="ltx_text ltx_font_italic">±0.04</span></sub>
</td>
<td id="S3.T2.25.25.25.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;">36.9<sub id="S3.T2.25.25.25.4.1" class="ltx_sub"><span id="S3.T2.25.25.25.4.1.1" class="ltx_text ltx_font_italic">±0.03</span></sub>
</td>
<td id="S3.T2.26.26.26.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;">32.2<sub id="S3.T2.26.26.26.5.1" class="ltx_sub"><span id="S3.T2.26.26.26.5.1.1" class="ltx_text ltx_font_italic">±0.01</span></sub>
</td>
<td id="S3.T2.27.27.27.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T2.27.27.27.6.1" class="ltx_text ltx_font_bold">54.1<sub id="S3.T2.27.27.27.6.1.1" class="ltx_sub"><span id="S3.T2.27.27.27.6.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.01</span></sub></span></td>
<td id="S3.T2.28.28.28.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_tt" style="padding:0.1pt 5.0pt;"><span id="S3.T2.28.28.28.7.1" class="ltx_text ltx_font_bold">59.3<sub id="S3.T2.28.28.28.7.1.1" class="ltx_sub"><span id="S3.T2.28.28.28.7.1.1.1" class="ltx_text ltx_font_medium ltx_font_italic">±0.04</span></sub></span></td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Evaluation</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we perform intensive evaluations to verify the effectiveness of our proposed TPFL and ATPFL.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Evaluation setup.</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p"><span id="S4.SS1.p1.2.1" class="ltx_text ltx_font_bold">Few-shot Dataset and Data partition.</span>
Extended from PromptFL<cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2022</a>)</cite> who only evaluates their model on four datasets, we verify ATPFL in seven different datasets: Caltech-101 <cite class="ltx_cite ltx_citemacro_citep">(Fei-Fei et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2004</a>)</cite>, Oxford-Pets, Stanford Cars, OxfordFlowers-102, EuroSAT, UCF-101, and Describable Textures (DTD). Furthermore, in order to create the few-shot dataset, we set that each client has <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">n</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑛</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">n_{k}</annotation></semantics></math> samples for each class. For the majority of our evaluations, we choose <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="n_{k}=4" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">n</mi><mi id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></eq><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝑛</ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">n_{k}=4</annotation></semantics></math> meaning that each client has a four-shot dataset; besides, we investigate the effect of the shot size in the ablation section. For the non-IID setting in FL, we select the label-skewing method to emulate the heterogeneous local clients.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Models</span>
Following the existing work, we choose the ResNet-50 (RN50) and Visual Transformer model (ViT) as the backbone of the visual encoder, and the Transformer model as the textual encoder.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines.</span>
In our evaluation, we compare ATPFL with the following baselines: (1) Local training, where all clients train their own models in an offline manner, and no model transmission is conducted; (2) PromptFL, using only the textual modality; (3) TPFL, employing both the textual and visual modalities, but no InfoNCE loss.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.2" class="ltx_p"><span id="S4.SS1.p4.2.1" class="ltx_text ltx_font_bold">Implementation details.</span>
To prevent the influence of randomness and ensure the fairness of our evaluations, each experiment setting has been performed in three identical random seeds, and then we average the results to get the final result. We use the Adam optimizer with learning rate <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\alpha=1e-3" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml"><mrow id="S4.SS1.p4.1.m1.1.1.3.2" xref="S4.SS1.p4.1.m1.1.1.3.2.cmml"><mn id="S4.SS1.p4.1.m1.1.1.3.2.2" xref="S4.SS1.p4.1.m1.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS1.p4.1.m1.1.1.3.2.1" xref="S4.SS1.p4.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.SS1.p4.1.m1.1.1.3.2.3" xref="S4.SS1.p4.1.m1.1.1.3.2.3.cmml">e</mi></mrow><mo id="S4.SS1.p4.1.m1.1.1.3.1" xref="S4.SS1.p4.1.m1.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p4.1.m1.1.1.3.3" xref="S4.SS1.p4.1.m1.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝛼</ci><apply id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3"><minus id="S4.SS1.p4.1.m1.1.1.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3.1"></minus><apply id="S4.SS1.p4.1.m1.1.1.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2"><times id="S4.SS1.p4.1.m1.1.1.3.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2.1"></times><cn type="integer" id="S4.SS1.p4.1.m1.1.1.3.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2.2">1</cn><ci id="S4.SS1.p4.1.m1.1.1.3.2.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S4.SS1.p4.1.m1.1.1.3.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\alpha=1e-3</annotation></semantics></math>, and the Cosine scheduler with <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="epoch=20" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mrow id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2.2" xref="S4.SS1.p4.2.m2.1.1.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.2.1" xref="S4.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.2.3" xref="S4.SS1.p4.2.m2.1.1.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.2.1a" xref="S4.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.2.4" xref="S4.SS1.p4.2.m2.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.2.1b" xref="S4.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.2.5" xref="S4.SS1.p4.2.m2.1.1.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p4.2.m2.1.1.2.1c" xref="S4.SS1.p4.2.m2.1.1.2.1.cmml">​</mo><mi id="S4.SS1.p4.2.m2.1.1.2.6" xref="S4.SS1.p4.2.m2.1.1.2.6.cmml">h</mi></mrow><mo id="S4.SS1.p4.2.m2.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><eq id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1"></eq><apply id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2"><times id="S4.SS1.p4.2.m2.1.1.2.1.cmml" xref="S4.SS1.p4.2.m2.1.1.2.1"></times><ci id="S4.SS1.p4.2.m2.1.1.2.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2.2">𝑒</ci><ci id="S4.SS1.p4.2.m2.1.1.2.3.cmml" xref="S4.SS1.p4.2.m2.1.1.2.3">𝑝</ci><ci id="S4.SS1.p4.2.m2.1.1.2.4.cmml" xref="S4.SS1.p4.2.m2.1.1.2.4">𝑜</ci><ci id="S4.SS1.p4.2.m2.1.1.2.5.cmml" xref="S4.SS1.p4.2.m2.1.1.2.5">𝑐</ci><ci id="S4.SS1.p4.2.m2.1.1.2.6.cmml" xref="S4.SS1.p4.2.m2.1.1.2.6">ℎ</ci></apply><cn type="integer" id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">epoch=20</annotation></semantics></math>. Furthermore,
For the implementation environment, we conduct our code on Python version 3.11.0 and Pytorch 1.13.0. We also use 4 NTX NVIDIA A6000 GPUs to run our code.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Main results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this section, the experimental outcomes are assessed. Table 1 and Table 2 present the average test accuracy for ViT and RN50 backbones across seven diverse datasets in a non-IID setting. Both PromptFL and ATPFL consistently surpass local training, with margins extending up to 18.5%. This is intuitive, as local training or full-model fine-tuning may lead to catastrophic forgetting. This issue is exacerbated by client data heterogeneity. These compounded factors significantly impede fine-tuning performance in the federated learning context, necessitating the exploration of PromptFL and ATPFL. For ViT, TPFL excels over PromptFL in six of the seven datasets, with margins spanning 0.1% - 6.2%, except for UCF-101 where TPFL lags by 0.2%. When factoring in the standard error of test accuracy across multiple experiments, TPFL’s advancements over previous methods are noticeable. Despite TPFL’s success, limitations persist, leading to the proposal of ATPFL to better address these issues. Our ATPFL model outperforms the baseline by 0.4% - 1.1% across all datasets, illustrating ATPFL’s potential to mitigate data heterogeneity in prompt federated learning scenarios.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In the ResNet-50 tests, TPFL outperforms local training and PromptFL in six of the seven datasets, except for the EuroAT dataset. Our ATPFL continues to surpass TPFL in four of the seven datasets, except for Oxford-Pets and DTD where ATPFL trails TPFL by 0.2% and 0.5% respectively. This could be due to the model disparities between ViT and ResNet-50.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">In conclusion, our proposed ATPFL, leveraging the concept of contrastive learning, offers superior performance in handling data heterogeneity. These results corroborate our prior discussions in the methodology section.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Ablation study</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">In this section, we examine various factors influencing our model’s performance, including the application of InfoNCE loss, number of shot size, and client quantity.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">InfoNCE loss.</span> First off, we investigates the impact of InfoNCE loss (i.e., the difference between TPFL and ATPFL). As illustrated in <a href="#S3.T1" title="In 3.3. Augmented TPFL (ATPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S3.T2" title="In 3.3. Augmented TPFL (ATPFL) ‣ 3. Methodology ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">2</span></a>, ATPFL shows a clear advantage compared to TPFL. In 11 out of 14 experiments, ATPFL outperforms TPFL by a margin of up to 1.1%.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Shot size.</span> Second, we explore the impact of shot size, and <a href="#S4.F2" title="In 4.3. Ablation study ‣ 4. Evaluation ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> demonstrates a monotonic increase in the F1-score as the number of shots rises, with the F1-score in a 16-shot scenario exceeding that of a 1-shot scenario by 2.3%. Moreover, despite the absence of a consistent increase, accuracy still trends upward with an increasing number of shots. Even at a 1-shot scenario, ATPFL exhibits substantial performance (90.2% accuracy and 87.8% F1-score), but greater shot numbers offer additional potential performance benefits due to the increased feature information provided at each learning round.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">Client volume.</span> Lastly, the ablation study examines the effect of the number of clients. <a href="#S4.F3" title="In 4.3. Ablation study ‣ 4. Evaluation ‣ Inclusive Data Representation in Federated Learning: A Novel Approach Integrating Textual and Visual Prompt" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a> reveals a decline in both accuracy and the F1-score as the client number rises, with a tenfold increase in clients (from 10 to 100) decreasing accuracy and the F1-score by 2.1% and 3.2%, respectively. However, even with a larger number of clients, ATPFL maintains reasonable performance, achieving 86.1% accuracy in a 100-client scenario.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2310.04455/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="433" height="261" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>. </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">This figure illustrates how shot number affects the model accuracy and F1-score </span></figcaption>
</figure>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2310.04455/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="433" height="260" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>. </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">This figure illustrates how client number affects the model accuracy and F1-score</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose an FL framework, TPFL, which first considers both visual and textual information in prompt tuning to augment the global model in FL. Notwithstanding, the performance improvement offered by TPFL is limited due to data heterogeneity. To address this issue, we developed ATPFL to facilitate local clients in obtaining more information from the global model, thereby enhancing their representing performance. A series of experiments have been conducted to validate the effectiveness of our methods, demonstrating that ATPFL consistently outperforms all baseline methods across various datasets and scenarios.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
This work was supported by the National Key R&amp;D Program of China under Grant No.2022ZD0160504, by Tsinghua Shenzhen International Graduate School-Shenzhen Pengrui Young Faculty Program of Shenzhen Pengrui Foundation (No. SZPR2023005), and by Tsinghua-Toyota Joint Research Institute inter-disciplinary Program and Tsinghua University (AIR)-Asiainfo Technologies (China) Inc. Joint Research Center under grant No. 20203910074. We would also like to thank anonymous reviewers for their insightful comments.

</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alistarh et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Dan Alistarh, Demjan
Grubic, Jerry Li, Ryota Tomioka, and
Milan Vojnovic. 2017.

</span>
<span class="ltx_bibblock">QSGD: Communication-efficient SGD via gradient
quantization and encoding.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">Advances in neural information processing
systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bonawitz et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Kallista Bonawitz, Peter
Kairouz, Brendan Mcmahan, and Daniel
Ramage. 2022.

</span>
<span class="ltx_bibblock">Federated learning and privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">Commun. ACM</em> 65,
4 (2022), 90–97.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eghlidi and Jaggi (2020)</span>
<span class="ltx_bibblock">
Negar Foroutan Eghlidi and
Martin Jaggi. 2020.

</span>
<span class="ltx_bibblock">Sparse communication for training deep networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.09271</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fei-Fei et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2004)</span>
<span class="ltx_bibblock">
Li Fei-Fei, Rob Fergus,
and Pietro Perona. 2004.

</span>
<span class="ltx_bibblock">Learning generative visual models from few training
examples: An incremental bayesian approach tested on 101 object categories.
In <em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">2004 conference on computer vision and pattern
recognition workshop</em>. IEEE, 178–178.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Chun-Mei Feng, Bangjun
Li, Xinxing Xu, Yong Liu,
Huazhu Fu, and Wangmeng Zuo.
2023.

</span>
<span class="ltx_bibblock">Learning Federated Visual Prompt in Null Space for
MRI Reconstruction. In <em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF
Conference on Computer Vision and Pattern Recognition</em>.
8064–8073.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gray and Neuhoff (1998)</span>
<span class="ltx_bibblock">
Robert M. Gray and
David L. Neuhoff. 1998.

</span>
<span class="ltx_bibblock">Quantization.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on information theory</em>
44, 6 (1998),
2325–2383.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Tao Guo, Song Guo,
Junxiao Wang, and Wenchao Xu.
2022.

</span>
<span class="ltx_bibblock">PromptFL: Let Federated Participants Cooperatively
Learn Prompts Instead of Models–Federated Learning in Age of Foundation
Model.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.11625</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Pengchao Han, Shiqiang
Wang, and Kin K Leung. 2020.

</span>
<span class="ltx_bibblock">Adaptive gradient sparsification for efficient
federated learning: An online learning approach. In
<em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">2020 IEEE 40th international conference on
distributed computing systems (ICDCS)</em>. IEEE, 300–310.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu
Zhang, Shaoqing Ren, and Jian Sun.
2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition. In
<em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer
vision and pattern recognition</em>. 770–778.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei
Giurgiu, Stanislaw Jastrzebski, Bruna
Morrone, Quentin De Laroussilhe, Andrea
Gesmundo, Mona Attariyan, and Sylvain
Gelly. 2019.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for NLP. In
<em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.
PMLR, 2790–2799.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Imteaj et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Ahmed Imteaj, Urmish
Thakker, Shiqiang Wang, Jian Li, and
M Hadi Amini. 2021.

</span>
<span class="ltx_bibblock">A survey on federated learning for
resource-constrained IoT devices.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.3.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>
9, 1 (2021),
1–24.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Yilun Jin, Xiguang Wei,
Yang Liu, and Qiang Yang.
2020.

</span>
<span class="ltx_bibblock">Towards utilizing unlabeled data in federated
learning: A survey and prospective.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.11545</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan
McMahan, Brendan Avent, Aurélien
Bellet, Mehdi Bennis, Arjun Nitin
Bhagoji, Kallista Bonawitz, Zachary
Charles, Graham Cormode, Rachel
Cummings, et al<span id="bib.bib14.3.1" class="ltx_text">.</span> 2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.4.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in
Machine Learning</em> 14, 1–2
(2021), 1–210.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et al<span id="bib.bib15.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Brian Lester, Rami
Al-Rfou, and Noah Constant.
2021.

</span>
<span class="ltx_bibblock">The Power of Scale for Parameter-Efficient Prompt
Tuning. In <em id="bib.bib15.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 2021 Conference on
Empirical Methods in Natural Language Processing</em>.
3045–3059.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Wang (2019)</span>
<span class="ltx_bibblock">
Daliang Li and Junpu
Wang. 2019.

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model
distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03581</em>
(2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang (2021)</span>
<span class="ltx_bibblock">
Xiang Lisa Li and Percy
Liang. 2021.

</span>
<span class="ltx_bibblock">Prefix-Tuning: Optimizing Continuous Prompts for
Generation. In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 59th Annual
Meeting of the Association for Computational Linguistics and the 11th
International Joint Conference on Natural Language Processing (Volume 1: Long
Papers)</em>. 4582–4597.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong,
Sebastian U Stich, and Martin Jaggi.
2020.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in
federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em> 33 (2020),
2351–2363.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Xiao Liu, Kaixuan Ji,
Yicheng Fu, Weng Tam,
Zhengxiao Du, Zhilin Yang, and
Jie Tang. 2022.

</span>
<span class="ltx_bibblock">P-Tuning: Prompt Tuning Can Be Comparable to
Fine-tuning Across Scales and Tasks. In
<em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 60th Annual Meeting of the
Association for Computational Linguistics (Volume 2: Short Papers)</em>.
Association for Computational Linguistics,
Dublin, Ireland, 61–68.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.18653/v1/2022.acl-short.8" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.18653/v1/2022.acl-short.8</a>

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mao et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuzhu Mao, Zihao Zhao,
Meilin Yang, Le Liang,
Yang Liu, Wenbo Ding,
Tian Lan, and Xiao-Ping Zhang.
2023.

</span>
<span class="ltx_bibblock">SAFARI: Sparsity-Enabled Federated Learning with
Limited and Unreliable Communications.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Mobile Computing</em>
(2023), 1–12.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1109/TMC.2023.3296624" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1109/TMC.2023.3296624</a>

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">Artificial
intelligence and statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nishio and Yonetani (2019)</span>
<span class="ltx_bibblock">
Takayuki Nishio and Ryo
Yonetani. 2019.

</span>
<span class="ltx_bibblock">Client selection for federated learning with
heterogeneous resources in mobile edge. In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ICC
2019-2019 IEEE international conference on communications (ICC)</em>. IEEE,
1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oord et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Yazhe
Li, and Oriol Vinyals. 2018.

</span>
<span class="ltx_bibblock">Representation learning with contrastive predictive
coding.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.03748</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Felix Sattler, Arturo
Marban, Roman Rischke, and Wojciech
Samek. 2020.

</span>
<span class="ltx_bibblock">Communication-efficient federated distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.00632</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Felix Sattler, Simon
Wiedemann, Klaus-Robert Müller, and
Wojciech Samek. 2019.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated
learning from non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and
learning systems</em> 31, 9
(2019), 3400–3413.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Shaohuai Shi, Qiang Wang,
Kaiyong Zhao, Zhenheng Tang,
Yuxin Wang, Xiang Huang, and
Xiaowen Chu. 2019.

</span>
<span class="ltx_bibblock">A distributed synchronous SGD algorithm with global
top-k sparsification for low bandwidth networks. In
<em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">2019 IEEE 39th International Conference on
Distributed Computing Systems (ICDCS)</em>. IEEE, 2238–2247.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2023a)</span>
<span class="ltx_bibblock">
Zihao Zhao, Yuzhu Mao,
Yang Liu, Linqi Song, Ye
Ouyang, Xinlei Chen, and Wenbo Ding.
2023a.

</span>
<span class="ltx_bibblock">Towards efficient communications in federated
learning: A contemporary survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.3.1" class="ltx_emph ltx_font_italic">Journal of the Franklin Institute</em>
(2023).

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://doi.org/10.1016/j.jfranklin.2022.12.053" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1016/j.jfranklin.2022.12.053</a>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2023b)</span>
<span class="ltx_bibblock">
Zihao Zhao, Yuzhu Mao,
Zhenpeng Shi, Yang Liu,
Tian Lan, Wenbo Ding, and
Xiao-Ping Zhang. 2023b.

</span>
<span class="ltx_bibblock">AQUILA: Communication Efficient Federated Learning
with Adaptive Quantization of Lazily-Aggregated Gradients.

</span>
<span class="ltx_bibblock">(2023).

</span>
<span class="ltx_bibblock">arXiv:2308.00258 [cs.LG]

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Kaiyang Zhou, Jingkang
Yang, Chen Change Loy, and Ziwei Liu.
2022.

</span>
<span class="ltx_bibblock">Conditional prompt learning for vision-language
models. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference
on Computer Vision and Pattern Recognition</em>. 16816–16825.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.04454" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.04455" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.04455">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.04455" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.04456" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 02:28:43 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
