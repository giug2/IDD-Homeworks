<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>1 Interpolated Synthetic Generation</title>
<!--Generated on Wed Oct 16 12:46:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.13674v1/"/></head>
<body>
<nav class="ltx_page_navbar">
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.21">
<div class="ltx_listingline" id="algorithm1.21.22">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_text" id="algorithm1.10.10.1"><span class="ltx_text ltx_font_bold" id="algorithm1.10.10.1.1">Input:</span> </span>
Original training dataset <math alttext="\mathcal{D}=\{(x_{i},y_{i},\lambda_{i}=1)\}_{i=1}^{N}" class="ltx_Math" display="inline" id="algorithm1.1.1.m1.1"><semantics id="algorithm1.1.1.m1.1a"><mrow id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.1.1.m1.1.1.3" xref="algorithm1.1.1.m1.1.1.3.cmml">𝒟</mi><mo id="algorithm1.1.1.m1.1.1.2" xref="algorithm1.1.1.m1.1.1.2.cmml">=</mo><msubsup id="algorithm1.1.1.m1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.cmml"><mrow id="algorithm1.1.1.m1.1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.2.cmml"><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.4" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.5" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">λ</mi><mi id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub></mrow><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.4" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.4.cmml">=</mo><mn id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.5" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.5.cmml">1</mn></mrow><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm1.1.1.m1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm1.1.1.m1.1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.1.3.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.3.2" xref="algorithm1.1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="algorithm1.1.1.m1.1.1.1.1.3.1" xref="algorithm1.1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="algorithm1.1.1.m1.1.1.1.1.3.3" xref="algorithm1.1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm1.1.1.m1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1"><eq id="algorithm1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.2"></eq><ci id="algorithm1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.3">𝒟</ci><apply id="algorithm1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1">superscript</csymbol><apply id="algorithm1.1.1.m1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1">subscript</csymbol><set id="algorithm1.1.1.m1.1.1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1"><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1"><eq id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.4.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.4"></eq><list id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3"><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">𝜆</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply></list><cn id="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.5.cmml" type="integer" xref="algorithm1.1.1.m1.1.1.1.1.1.1.1.1.1.5">1</cn></apply></set><apply id="algorithm1.1.1.m1.1.1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.3"><eq id="algorithm1.1.1.m1.1.1.1.1.3.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.3.1"></eq><ci id="algorithm1.1.1.m1.1.1.1.1.3.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.3.2">𝑖</ci><cn id="algorithm1.1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="algorithm1.1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm1.1.1.m1.1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">\mathcal{D}=\{(x_{i},y_{i},\lambda_{i}=1)\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.m1.1d">caligraphic_D = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>,
text prompts <math alttext="\mathcal{T}=\{(y_{j},T_{j})\}_{j=1}^{labels}" class="ltx_Math" display="inline" id="algorithm1.2.2.m2.1"><semantics id="algorithm1.2.2.m2.1a"><mrow id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.2.2.m2.1.1.3" xref="algorithm1.2.2.m2.1.1.3.cmml">𝒯</mi><mo id="algorithm1.2.2.m2.1.1.2" xref="algorithm1.2.2.m2.1.1.2.cmml">=</mo><msubsup id="algorithm1.2.2.m2.1.1.1" xref="algorithm1.2.2.m2.1.1.1.cmml"><mrow id="algorithm1.2.2.m2.1.1.1.1.1.1" xref="algorithm1.2.2.m2.1.1.1.1.1.2.cmml"><mo id="algorithm1.2.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.2.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.3.cmml"><mo id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.3" stretchy="false" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.3.cmml">(</mo><msub id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.2" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.3" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.4" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msub id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.2" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.2.cmml">T</mi><mi id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.3" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.5" stretchy="false" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="algorithm1.2.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.2.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm1.2.2.m2.1.1.1.1.3" xref="algorithm1.2.2.m2.1.1.1.1.3.cmml"><mi id="algorithm1.2.2.m2.1.1.1.1.3.2" xref="algorithm1.2.2.m2.1.1.1.1.3.2.cmml">j</mi><mo id="algorithm1.2.2.m2.1.1.1.1.3.1" xref="algorithm1.2.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="algorithm1.2.2.m2.1.1.1.1.3.3" xref="algorithm1.2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="algorithm1.2.2.m2.1.1.1.3" xref="algorithm1.2.2.m2.1.1.1.3.cmml"><mi id="algorithm1.2.2.m2.1.1.1.3.2" xref="algorithm1.2.2.m2.1.1.1.3.2.cmml">l</mi><mo id="algorithm1.2.2.m2.1.1.1.3.1" xref="algorithm1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.2.2.m2.1.1.1.3.3" xref="algorithm1.2.2.m2.1.1.1.3.3.cmml">a</mi><mo id="algorithm1.2.2.m2.1.1.1.3.1a" xref="algorithm1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.2.2.m2.1.1.1.3.4" xref="algorithm1.2.2.m2.1.1.1.3.4.cmml">b</mi><mo id="algorithm1.2.2.m2.1.1.1.3.1b" xref="algorithm1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.2.2.m2.1.1.1.3.5" xref="algorithm1.2.2.m2.1.1.1.3.5.cmml">e</mi><mo id="algorithm1.2.2.m2.1.1.1.3.1c" xref="algorithm1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.2.2.m2.1.1.1.3.6" xref="algorithm1.2.2.m2.1.1.1.3.6.cmml">l</mi><mo id="algorithm1.2.2.m2.1.1.1.3.1d" xref="algorithm1.2.2.m2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.2.2.m2.1.1.1.3.7" xref="algorithm1.2.2.m2.1.1.1.3.7.cmml">s</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><apply id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1"><eq id="algorithm1.2.2.m2.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.2"></eq><ci id="algorithm1.2.2.m2.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.3">𝒯</ci><apply id="algorithm1.2.2.m2.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.1">superscript</csymbol><apply id="algorithm1.2.2.m2.1.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.1">subscript</csymbol><set id="algorithm1.2.2.m2.1.1.1.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1"><interval closure="open" id="algorithm1.2.2.m2.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2"><apply id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.2">𝑇</ci><ci id="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm1.2.2.m2.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval></set><apply id="algorithm1.2.2.m2.1.1.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.1.1.3"><eq id="algorithm1.2.2.m2.1.1.1.1.3.1.cmml" xref="algorithm1.2.2.m2.1.1.1.1.3.1"></eq><ci id="algorithm1.2.2.m2.1.1.1.1.3.2.cmml" xref="algorithm1.2.2.m2.1.1.1.1.3.2">𝑗</ci><cn id="algorithm1.2.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="algorithm1.2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="algorithm1.2.2.m2.1.1.1.3.cmml" xref="algorithm1.2.2.m2.1.1.1.3"><times id="algorithm1.2.2.m2.1.1.1.3.1.cmml" xref="algorithm1.2.2.m2.1.1.1.3.1"></times><ci id="algorithm1.2.2.m2.1.1.1.3.2.cmml" xref="algorithm1.2.2.m2.1.1.1.3.2">𝑙</ci><ci id="algorithm1.2.2.m2.1.1.1.3.3.cmml" xref="algorithm1.2.2.m2.1.1.1.3.3">𝑎</ci><ci id="algorithm1.2.2.m2.1.1.1.3.4.cmml" xref="algorithm1.2.2.m2.1.1.1.3.4">𝑏</ci><ci id="algorithm1.2.2.m2.1.1.1.3.5.cmml" xref="algorithm1.2.2.m2.1.1.1.3.5">𝑒</ci><ci id="algorithm1.2.2.m2.1.1.1.3.6.cmml" xref="algorithm1.2.2.m2.1.1.1.3.6">𝑙</ci><ci id="algorithm1.2.2.m2.1.1.1.3.7.cmml" xref="algorithm1.2.2.m2.1.1.1.3.7">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">\mathcal{T}=\{(y_{j},T_{j})\}_{j=1}^{labels}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.m2.1d">caligraphic_T = { ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l italic_a italic_b italic_e italic_l italic_s end_POSTSUPERSCRIPT</annotation></semantics></math>,
image guidance levels <math alttext="\Lambda=\{\lambda_{i}|\lambda_{i}\in[0,1)\}" class="ltx_Math" display="inline" id="algorithm1.3.3.m3.4"><semantics id="algorithm1.3.3.m3.4a"><mrow id="algorithm1.3.3.m3.4.4" xref="algorithm1.3.3.m3.4.4.cmml"><mi id="algorithm1.3.3.m3.4.4.4" mathvariant="normal" xref="algorithm1.3.3.m3.4.4.4.cmml">Λ</mi><mo id="algorithm1.3.3.m3.4.4.3" xref="algorithm1.3.3.m3.4.4.3.cmml">=</mo><mrow id="algorithm1.3.3.m3.4.4.2.2" xref="algorithm1.3.3.m3.4.4.2.3.cmml"><mo id="algorithm1.3.3.m3.4.4.2.2.3" stretchy="false" xref="algorithm1.3.3.m3.4.4.2.3.1.cmml">{</mo><msub id="algorithm1.3.3.m3.3.3.1.1.1" xref="algorithm1.3.3.m3.3.3.1.1.1.cmml"><mi id="algorithm1.3.3.m3.3.3.1.1.1.2" xref="algorithm1.3.3.m3.3.3.1.1.1.2.cmml">λ</mi><mi id="algorithm1.3.3.m3.3.3.1.1.1.3" xref="algorithm1.3.3.m3.3.3.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.3.3.m3.4.4.2.2.4" lspace="0em" rspace="0em" xref="algorithm1.3.3.m3.4.4.2.3.1.cmml">|</mo><mrow id="algorithm1.3.3.m3.4.4.2.2.2" xref="algorithm1.3.3.m3.4.4.2.2.2.cmml"><msub id="algorithm1.3.3.m3.4.4.2.2.2.2" xref="algorithm1.3.3.m3.4.4.2.2.2.2.cmml"><mi id="algorithm1.3.3.m3.4.4.2.2.2.2.2" xref="algorithm1.3.3.m3.4.4.2.2.2.2.2.cmml">λ</mi><mi id="algorithm1.3.3.m3.4.4.2.2.2.2.3" xref="algorithm1.3.3.m3.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm1.3.3.m3.4.4.2.2.2.1" xref="algorithm1.3.3.m3.4.4.2.2.2.1.cmml">∈</mo><mrow id="algorithm1.3.3.m3.4.4.2.2.2.3.2" xref="algorithm1.3.3.m3.4.4.2.2.2.3.1.cmml"><mo id="algorithm1.3.3.m3.4.4.2.2.2.3.2.1" stretchy="false" xref="algorithm1.3.3.m3.4.4.2.2.2.3.1.cmml">[</mo><mn id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">0</mn><mo id="algorithm1.3.3.m3.4.4.2.2.2.3.2.2" xref="algorithm1.3.3.m3.4.4.2.2.2.3.1.cmml">,</mo><mn id="algorithm1.3.3.m3.2.2" xref="algorithm1.3.3.m3.2.2.cmml">1</mn><mo id="algorithm1.3.3.m3.4.4.2.2.2.3.2.3" stretchy="false" xref="algorithm1.3.3.m3.4.4.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.3.3.m3.4.4.2.2.5" stretchy="false" xref="algorithm1.3.3.m3.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.4b"><apply id="algorithm1.3.3.m3.4.4.cmml" xref="algorithm1.3.3.m3.4.4"><eq id="algorithm1.3.3.m3.4.4.3.cmml" xref="algorithm1.3.3.m3.4.4.3"></eq><ci id="algorithm1.3.3.m3.4.4.4.cmml" xref="algorithm1.3.3.m3.4.4.4">Λ</ci><apply id="algorithm1.3.3.m3.4.4.2.3.cmml" xref="algorithm1.3.3.m3.4.4.2.2"><csymbol cd="latexml" id="algorithm1.3.3.m3.4.4.2.3.1.cmml" xref="algorithm1.3.3.m3.4.4.2.2.3">conditional-set</csymbol><apply id="algorithm1.3.3.m3.3.3.1.1.1.cmml" xref="algorithm1.3.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.3.3.1.1.1.1.cmml" xref="algorithm1.3.3.m3.3.3.1.1.1">subscript</csymbol><ci id="algorithm1.3.3.m3.3.3.1.1.1.2.cmml" xref="algorithm1.3.3.m3.3.3.1.1.1.2">𝜆</ci><ci id="algorithm1.3.3.m3.3.3.1.1.1.3.cmml" xref="algorithm1.3.3.m3.3.3.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.3.3.m3.4.4.2.2.2.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2"><in id="algorithm1.3.3.m3.4.4.2.2.2.1.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2.1"></in><apply id="algorithm1.3.3.m3.4.4.2.2.2.2.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.3.3.m3.4.4.2.2.2.2.1.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2.2">subscript</csymbol><ci id="algorithm1.3.3.m3.4.4.2.2.2.2.2.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2.2.2">𝜆</ci><ci id="algorithm1.3.3.m3.4.4.2.2.2.2.3.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2.2.3">𝑖</ci></apply><interval closure="closed-open" id="algorithm1.3.3.m3.4.4.2.2.2.3.1.cmml" xref="algorithm1.3.3.m3.4.4.2.2.2.3.2"><cn id="algorithm1.3.3.m3.1.1.cmml" type="integer" xref="algorithm1.3.3.m3.1.1">0</cn><cn id="algorithm1.3.3.m3.2.2.cmml" type="integer" xref="algorithm1.3.3.m3.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.4c">\Lambda=\{\lambda_{i}|\lambda_{i}\in[0,1)\}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m3.4d">roman_Λ = { italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ [ 0 , 1 ) }</annotation></semantics></math>,
a pre-trained model <math alttext="P_{\theta}" class="ltx_Math" display="inline" id="algorithm1.4.4.m4.1"><semantics id="algorithm1.4.4.m4.1a"><msub id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml"><mi id="algorithm1.4.4.m4.1.1.2" xref="algorithm1.4.4.m4.1.1.2.cmml">P</mi><mi id="algorithm1.4.4.m4.1.1.3" xref="algorithm1.4.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.1b"><apply id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1"><csymbol cd="ambiguous" id="algorithm1.4.4.m4.1.1.1.cmml" xref="algorithm1.4.4.m4.1.1">subscript</csymbol><ci id="algorithm1.4.4.m4.1.1.2.cmml" xref="algorithm1.4.4.m4.1.1.2">𝑃</ci><ci id="algorithm1.4.4.m4.1.1.3.cmml" xref="algorithm1.4.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.1c">P_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m4.1d">italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> on <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="algorithm1.5.5.m5.1"><semantics id="algorithm1.5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.m5.1d">caligraphic_D</annotation></semantics></math>,
CLIPScore filtering model <math alttext="F_{\theta}" class="ltx_Math" display="inline" id="algorithm1.6.6.m6.1"><semantics id="algorithm1.6.6.m6.1a"><msub id="algorithm1.6.6.m6.1.1" xref="algorithm1.6.6.m6.1.1.cmml"><mi id="algorithm1.6.6.m6.1.1.2" xref="algorithm1.6.6.m6.1.1.2.cmml">F</mi><mi id="algorithm1.6.6.m6.1.1.3" xref="algorithm1.6.6.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m6.1b"><apply id="algorithm1.6.6.m6.1.1.cmml" xref="algorithm1.6.6.m6.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m6.1.1.1.cmml" xref="algorithm1.6.6.m6.1.1">subscript</csymbol><ci id="algorithm1.6.6.m6.1.1.2.cmml" xref="algorithm1.6.6.m6.1.1.2">𝐹</ci><ci id="algorithm1.6.6.m6.1.1.3.cmml" xref="algorithm1.6.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m6.1c">F_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.m6.1d">italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>,
diffusion model <math alttext="\epsilon_{\theta}" class="ltx_Math" display="inline" id="algorithm1.7.7.m7.1"><semantics id="algorithm1.7.7.m7.1a"><msub id="algorithm1.7.7.m7.1.1" xref="algorithm1.7.7.m7.1.1.cmml"><mi id="algorithm1.7.7.m7.1.1.2" xref="algorithm1.7.7.m7.1.1.2.cmml">ϵ</mi><mi id="algorithm1.7.7.m7.1.1.3" xref="algorithm1.7.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m7.1b"><apply id="algorithm1.7.7.m7.1.1.cmml" xref="algorithm1.7.7.m7.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m7.1.1.1.cmml" xref="algorithm1.7.7.m7.1.1">subscript</csymbol><ci id="algorithm1.7.7.m7.1.1.2.cmml" xref="algorithm1.7.7.m7.1.1.2">italic-ϵ</ci><ci id="algorithm1.7.7.m7.1.1.3.cmml" xref="algorithm1.7.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m7.1c">\epsilon_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.m7.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>,
number of random seeds per image <math alttext="m" class="ltx_Math" display="inline" id="algorithm1.8.8.m8.1"><semantics id="algorithm1.8.8.m8.1a"><mi id="algorithm1.8.8.m8.1.1" xref="algorithm1.8.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m8.1b"><ci id="algorithm1.8.8.m8.1.1.cmml" xref="algorithm1.8.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m8.1c">m</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m8.1d">italic_m</annotation></semantics></math>,
filtering threshold <math alttext="h_{\text{filter}}" class="ltx_Math" display="inline" id="algorithm1.9.9.m9.1"><semantics id="algorithm1.9.9.m9.1a"><msub id="algorithm1.9.9.m9.1.1" xref="algorithm1.9.9.m9.1.1.cmml"><mi id="algorithm1.9.9.m9.1.1.2" xref="algorithm1.9.9.m9.1.1.2.cmml">h</mi><mtext id="algorithm1.9.9.m9.1.1.3" xref="algorithm1.9.9.m9.1.1.3a.cmml">filter</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m9.1b"><apply id="algorithm1.9.9.m9.1.1.cmml" xref="algorithm1.9.9.m9.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.m9.1.1.1.cmml" xref="algorithm1.9.9.m9.1.1">subscript</csymbol><ci id="algorithm1.9.9.m9.1.1.2.cmml" xref="algorithm1.9.9.m9.1.1.2">ℎ</ci><ci id="algorithm1.9.9.m9.1.1.3a.cmml" xref="algorithm1.9.9.m9.1.1.3"><mtext id="algorithm1.9.9.m9.1.1.3.cmml" mathsize="70%" xref="algorithm1.9.9.m9.1.1.3">filter</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m9.1c">h_{\text{filter}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m9.1d">italic_h start_POSTSUBSCRIPT filter end_POSTSUBSCRIPT</annotation></semantics></math>,
Difficulty threshold <math alttext="h_{\text{hard}}" class="ltx_Math" display="inline" id="algorithm1.10.10.m10.1"><semantics id="algorithm1.10.10.m10.1a"><msub id="algorithm1.10.10.m10.1.1" xref="algorithm1.10.10.m10.1.1.cmml"><mi id="algorithm1.10.10.m10.1.1.2" xref="algorithm1.10.10.m10.1.1.2.cmml">h</mi><mtext id="algorithm1.10.10.m10.1.1.3" xref="algorithm1.10.10.m10.1.1.3a.cmml">hard</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m10.1b"><apply id="algorithm1.10.10.m10.1.1.cmml" xref="algorithm1.10.10.m10.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m10.1.1.1.cmml" xref="algorithm1.10.10.m10.1.1">subscript</csymbol><ci id="algorithm1.10.10.m10.1.1.2.cmml" xref="algorithm1.10.10.m10.1.1.2">ℎ</ci><ci id="algorithm1.10.10.m10.1.1.3a.cmml" xref="algorithm1.10.10.m10.1.1.3"><mtext id="algorithm1.10.10.m10.1.1.3.cmml" mathsize="70%" xref="algorithm1.10.10.m10.1.1.3">hard</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m10.1c">h_{\text{hard}}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m10.1d">italic_h start_POSTSUBSCRIPT hard end_POSTSUBSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algorithm1.11.11">
<span class="ltx_text" id="algorithm1.11.11.1"><span class="ltx_text ltx_font_bold" id="algorithm1.11.11.1.1">Output:</span> </span>Synthetic dataset <math alttext="\mathcal{S}=\{(x^{\prime}_{i},y_{i},\lambda_{i})\}_{i=1}^{M}" class="ltx_Math" display="inline" id="algorithm1.11.11.m1.1"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml">𝒮</mi><mo id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml">=</mo><msubsup id="algorithm1.11.11.m1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.cmml"><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.2.cmml"><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.11.11.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.4.cmml"><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.5" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.6" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.11.11.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm1.11.11.m1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.1.1.3.2.cmml">i</mi><mo id="algorithm1.11.11.m1.1.1.1.1.3.1" xref="algorithm1.11.11.m1.1.1.1.1.3.1.cmml">=</mo><mn id="algorithm1.11.11.m1.1.1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm1.11.11.m1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.3.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><eq id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2"></eq><ci id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3">𝒮</ci><apply id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1">superscript</csymbol><apply id="algorithm1.11.11.m1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1">subscript</csymbol><set id="algorithm1.11.11.m1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1"><vector id="algorithm1.11.11.m1.1.1.1.1.1.1.1.4.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3"><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector></set><apply id="algorithm1.11.11.m1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.3"><eq id="algorithm1.11.11.m1.1.1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.3.1"></eq><ci id="algorithm1.11.11.m1.1.1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.3.2">𝑖</ci><cn id="algorithm1.11.11.m1.1.1.1.1.3.3.cmml" type="integer" xref="algorithm1.11.11.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm1.11.11.m1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">\mathcal{S}=\{(x^{\prime}_{i},y_{i},\lambda_{i})\}_{i=1}^{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.1d">caligraphic_S = { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.12.12">
<span class="ltx_text" id="algorithm1.12.12.1"><span class="ltx_text ltx_font_bold" id="algorithm1.12.12.1.1">Initialize:</span> </span>Empty datasets <math alttext="\mathcal{S}=\phi" class="ltx_Math" display="inline" id="algorithm1.12.12.m1.1"><semantics id="algorithm1.12.12.m1.1a"><mrow id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml">𝒮</mi><mo id="algorithm1.12.12.m1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.cmml">=</mo><mi id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml">ϕ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><eq id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1"></eq><ci id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2">𝒮</ci><ci id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">\mathcal{S}=\phi</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.1d">caligraphic_S = italic_ϕ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.21.23">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="algorithm1.13.13">
<span class="ltx_tag ltx_tag_listingline">3</span>Compute predicted probability <math alttext="p_{i}=P_{\theta}(x_{i}),\forall i\in N" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.2"><semantics id="algorithm1.13.13.m1.2a"><mrow id="algorithm1.13.13.m1.2.2.2" xref="algorithm1.13.13.m1.2.2.3.cmml"><mrow id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml"><msub id="algorithm1.13.13.m1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.1.3.2.cmml">p</mi><mi id="algorithm1.13.13.m1.1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="algorithm1.13.13.m1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml">=</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.cmml"><msub id="algorithm1.13.13.m1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.1.1.3.2.cmml">P</mi><mi id="algorithm1.13.13.m1.1.1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="algorithm1.13.13.m1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm1.13.13.m1.2.2.2.3" xref="algorithm1.13.13.m1.2.2.3a.cmml">,</mo><mrow id="algorithm1.13.13.m1.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.cmml"><mrow id="algorithm1.13.13.m1.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.cmml"><mo id="algorithm1.13.13.m1.2.2.2.2.2.1" rspace="0.167em" xref="algorithm1.13.13.m1.2.2.2.2.2.1.cmml">∀</mo><mi id="algorithm1.13.13.m1.2.2.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.2.2.cmml">i</mi></mrow><mo id="algorithm1.13.13.m1.2.2.2.2.1" xref="algorithm1.13.13.m1.2.2.2.2.1.cmml">∈</mo><mi id="algorithm1.13.13.m1.2.2.2.2.3" xref="algorithm1.13.13.m1.2.2.2.2.3.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.2b"><apply id="algorithm1.13.13.m1.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.2.2.3a.cmml" xref="algorithm1.13.13.m1.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1"><eq id="algorithm1.13.13.m1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2"></eq><apply id="algorithm1.13.13.m1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.13.13.m1.1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1"><times id="algorithm1.13.13.m1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.2"></times><apply id="algorithm1.13.13.m1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.3.2">𝑃</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="algorithm1.13.13.m1.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2"><in id="algorithm1.13.13.m1.2.2.2.2.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.1"></in><apply id="algorithm1.13.13.m1.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2"><csymbol cd="latexml" id="algorithm1.13.13.m1.2.2.2.2.2.1.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.1">for-all</csymbol><ci id="algorithm1.13.13.m1.2.2.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2.2.2">𝑖</ci></apply><ci id="algorithm1.13.13.m1.2.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.2.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.2c">p_{i}=P_{\theta}(x_{i}),\forall i\in N</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.2d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , ∀ italic_i ∈ italic_N</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.14">
<span class="ltx_tag ltx_tag_listingline">4</span>
Find out hard samples <math alttext="\mathcal{H}=\{(x_{i},y_{i})|p_{i}&lt;h_{\text{hard}})\}" class="ltx_math_unparsed" display="inline" id="algorithm1.14.14.m1.1"><semantics id="algorithm1.14.14.m1.1a"><mrow id="algorithm1.14.14.m1.1b"><mi class="ltx_font_mathcaligraphic" id="algorithm1.14.14.m1.1.1">ℋ</mi><mo id="algorithm1.14.14.m1.1.2">=</mo><mrow id="algorithm1.14.14.m1.1.3"><mo id="algorithm1.14.14.m1.1.3.1" stretchy="false">{</mo><mrow id="algorithm1.14.14.m1.1.3.2"><mo id="algorithm1.14.14.m1.1.3.2.1" stretchy="false">(</mo><msub id="algorithm1.14.14.m1.1.3.2.2"><mi id="algorithm1.14.14.m1.1.3.2.2.2">x</mi><mi id="algorithm1.14.14.m1.1.3.2.2.3">i</mi></msub><mo id="algorithm1.14.14.m1.1.3.2.3">,</mo><msub id="algorithm1.14.14.m1.1.3.2.4"><mi id="algorithm1.14.14.m1.1.3.2.4.2">y</mi><mi id="algorithm1.14.14.m1.1.3.2.4.3">i</mi></msub><mo id="algorithm1.14.14.m1.1.3.2.5" stretchy="false">)</mo></mrow><mo fence="false" id="algorithm1.14.14.m1.1.3.3" rspace="0.167em" stretchy="false">|</mo><msub id="algorithm1.14.14.m1.1.3.4"><mi id="algorithm1.14.14.m1.1.3.4.2">p</mi><mi id="algorithm1.14.14.m1.1.3.4.3">i</mi></msub><mo id="algorithm1.14.14.m1.1.3.5">&lt;</mo><msub id="algorithm1.14.14.m1.1.3.6"><mi id="algorithm1.14.14.m1.1.3.6.2">h</mi><mtext id="algorithm1.14.14.m1.1.3.6.3">hard</mtext></msub><mo id="algorithm1.14.14.m1.1.3.7" stretchy="false">)</mo></mrow><mo id="algorithm1.14.14.m1.1.4" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">\mathcal{H}=\{(x_{i},y_{i})|p_{i}&lt;h_{\text{hard}})\}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m1.1d">caligraphic_H = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) | italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT &lt; italic_h start_POSTSUBSCRIPT hard end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.21.24">
<span class="ltx_tag ltx_tag_listingline">5</span>
</div>
<div class="ltx_listingline" id="algorithm1.15.15">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_text ltx_font_bold" id="algorithm1.15.15.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.15.15.1">Hard sample <math alttext="(x_{i},y_{i})\in\mathcal{H}" class="ltx_Math" display="inline" id="algorithm1.15.15.1.m1.2"><semantics id="algorithm1.15.15.1.m1.2a"><mrow id="algorithm1.15.15.1.m1.2.2" xref="algorithm1.15.15.1.m1.2.2.cmml"><mrow id="algorithm1.15.15.1.m1.2.2.2.2" xref="algorithm1.15.15.1.m1.2.2.2.3.cmml"><mo id="algorithm1.15.15.1.m1.2.2.2.2.3" stretchy="false" xref="algorithm1.15.15.1.m1.2.2.2.3.cmml">(</mo><msub id="algorithm1.15.15.1.m1.1.1.1.1.1" xref="algorithm1.15.15.1.m1.1.1.1.1.1.cmml"><mi id="algorithm1.15.15.1.m1.1.1.1.1.1.2" xref="algorithm1.15.15.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.15.15.1.m1.1.1.1.1.1.3" xref="algorithm1.15.15.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.15.15.1.m1.2.2.2.2.4" xref="algorithm1.15.15.1.m1.2.2.2.3.cmml">,</mo><msub id="algorithm1.15.15.1.m1.2.2.2.2.2" xref="algorithm1.15.15.1.m1.2.2.2.2.2.cmml"><mi id="algorithm1.15.15.1.m1.2.2.2.2.2.2" xref="algorithm1.15.15.1.m1.2.2.2.2.2.2.cmml">y</mi><mi id="algorithm1.15.15.1.m1.2.2.2.2.2.3" xref="algorithm1.15.15.1.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm1.15.15.1.m1.2.2.2.2.5" stretchy="false" xref="algorithm1.15.15.1.m1.2.2.2.3.cmml">)</mo></mrow><mo id="algorithm1.15.15.1.m1.2.2.3" xref="algorithm1.15.15.1.m1.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algorithm1.15.15.1.m1.2.2.4" xref="algorithm1.15.15.1.m1.2.2.4.cmml">ℋ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.1.m1.2b"><apply id="algorithm1.15.15.1.m1.2.2.cmml" xref="algorithm1.15.15.1.m1.2.2"><in id="algorithm1.15.15.1.m1.2.2.3.cmml" xref="algorithm1.15.15.1.m1.2.2.3"></in><interval closure="open" id="algorithm1.15.15.1.m1.2.2.2.3.cmml" xref="algorithm1.15.15.1.m1.2.2.2.2"><apply id="algorithm1.15.15.1.m1.1.1.1.1.1.cmml" xref="algorithm1.15.15.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.1.m1.1.1.1.1.1.1.cmml" xref="algorithm1.15.15.1.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.15.15.1.m1.1.1.1.1.1.2.cmml" xref="algorithm1.15.15.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.15.15.1.m1.1.1.1.1.1.3.cmml" xref="algorithm1.15.15.1.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.15.15.1.m1.2.2.2.2.2.cmml" xref="algorithm1.15.15.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.15.15.1.m1.2.2.2.2.2.1.cmml" xref="algorithm1.15.15.1.m1.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.15.15.1.m1.2.2.2.2.2.2.cmml" xref="algorithm1.15.15.1.m1.2.2.2.2.2.2">𝑦</ci><ci id="algorithm1.15.15.1.m1.2.2.2.2.2.3.cmml" xref="algorithm1.15.15.1.m1.2.2.2.2.2.3">𝑖</ci></apply></interval><ci id="algorithm1.15.15.1.m1.2.2.4.cmml" xref="algorithm1.15.15.1.m1.2.2.4">ℋ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.1.m1.2c">(x_{i},y_{i})\in\mathcal{H}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.15.15.1.m1.2d">( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ caligraphic_H</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.15.15.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.16.16">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Extract text prompt <math alttext="t_{i}" class="ltx_Math" display="inline" id="algorithm1.16.16.m1.1"><semantics id="algorithm1.16.16.m1.1a"><msub id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml"><mi id="algorithm1.16.16.m1.1.1.2" xref="algorithm1.16.16.m1.1.1.2.cmml">t</mi><mi id="algorithm1.16.16.m1.1.1.3" xref="algorithm1.16.16.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><apply id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1">subscript</csymbol><ci id="algorithm1.16.16.m1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.2">𝑡</ci><ci id="algorithm1.16.16.m1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.16.16.m1.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for corresponding class 
</div>
<div class="ltx_listingline" id="algorithm1.17.17">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm1.17.17.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.17.17.1"><math alttext="\lambda_{j}\in\Lambda" class="ltx_Math" display="inline" id="algorithm1.17.17.1.m1.1"><semantics id="algorithm1.17.17.1.m1.1a"><mrow id="algorithm1.17.17.1.m1.1.1" xref="algorithm1.17.17.1.m1.1.1.cmml"><msub id="algorithm1.17.17.1.m1.1.1.2" xref="algorithm1.17.17.1.m1.1.1.2.cmml"><mi id="algorithm1.17.17.1.m1.1.1.2.2" xref="algorithm1.17.17.1.m1.1.1.2.2.cmml">λ</mi><mi id="algorithm1.17.17.1.m1.1.1.2.3" xref="algorithm1.17.17.1.m1.1.1.2.3.cmml">j</mi></msub><mo id="algorithm1.17.17.1.m1.1.1.1" xref="algorithm1.17.17.1.m1.1.1.1.cmml">∈</mo><mi id="algorithm1.17.17.1.m1.1.1.3" mathvariant="normal" xref="algorithm1.17.17.1.m1.1.1.3.cmml">Λ</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.1.m1.1b"><apply id="algorithm1.17.17.1.m1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1"><in id="algorithm1.17.17.1.m1.1.1.1.cmml" xref="algorithm1.17.17.1.m1.1.1.1"></in><apply id="algorithm1.17.17.1.m1.1.1.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.17.17.1.m1.1.1.2.1.cmml" xref="algorithm1.17.17.1.m1.1.1.2">subscript</csymbol><ci id="algorithm1.17.17.1.m1.1.1.2.2.cmml" xref="algorithm1.17.17.1.m1.1.1.2.2">𝜆</ci><ci id="algorithm1.17.17.1.m1.1.1.2.3.cmml" xref="algorithm1.17.17.1.m1.1.1.2.3">𝑗</ci></apply><ci id="algorithm1.17.17.1.m1.1.1.3.cmml" xref="algorithm1.17.17.1.m1.1.1.3">Λ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.1.m1.1c">\lambda_{j}\in\Lambda</annotation><annotation encoding="application/x-llamapun" id="algorithm1.17.17.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ roman_Λ</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.17.17.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.19.19">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Generate <math alttext="m" class="ltx_Math" display="inline" id="algorithm1.18.18.m1.1"><semantics id="algorithm1.18.18.m1.1a"><mi id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><ci id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="algorithm1.18.18.m1.1d">italic_m</annotation></semantics></math> samples with diffusion model <math alttext="\{(x^{\prime}_{i},y_{i},\lambda_{j})|x^{\prime}_{i}=\epsilon_{\theta}(x_{i},t_%
{i},\lambda_{j})\}" class="ltx_Math" display="inline" id="algorithm1.19.19.m2.2"><semantics id="algorithm1.19.19.m2.2a"><mrow id="algorithm1.19.19.m2.2.2.2" xref="algorithm1.19.19.m2.2.2.3.cmml"><mo id="algorithm1.19.19.m2.2.2.2.3" stretchy="false" xref="algorithm1.19.19.m2.2.2.3.1.cmml">{</mo><mrow id="algorithm1.19.19.m2.1.1.1.1.3" xref="algorithm1.19.19.m2.1.1.1.1.4.cmml"><mo id="algorithm1.19.19.m2.1.1.1.1.3.4" stretchy="false" xref="algorithm1.19.19.m2.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm1.19.19.m2.1.1.1.1.1.1" xref="algorithm1.19.19.m2.1.1.1.1.1.1.cmml"><mi id="algorithm1.19.19.m2.1.1.1.1.1.1.2.2" xref="algorithm1.19.19.m2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm1.19.19.m2.1.1.1.1.1.1.3" xref="algorithm1.19.19.m2.1.1.1.1.1.1.3.cmml">i</mi><mo id="algorithm1.19.19.m2.1.1.1.1.1.1.2.3" xref="algorithm1.19.19.m2.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm1.19.19.m2.1.1.1.1.3.5" xref="algorithm1.19.19.m2.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.19.19.m2.1.1.1.1.2.2" xref="algorithm1.19.19.m2.1.1.1.1.2.2.cmml"><mi id="algorithm1.19.19.m2.1.1.1.1.2.2.2" xref="algorithm1.19.19.m2.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm1.19.19.m2.1.1.1.1.2.2.3" xref="algorithm1.19.19.m2.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="algorithm1.19.19.m2.1.1.1.1.3.6" xref="algorithm1.19.19.m2.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.19.19.m2.1.1.1.1.3.3" xref="algorithm1.19.19.m2.1.1.1.1.3.3.cmml"><mi id="algorithm1.19.19.m2.1.1.1.1.3.3.2" xref="algorithm1.19.19.m2.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm1.19.19.m2.1.1.1.1.3.3.3" xref="algorithm1.19.19.m2.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm1.19.19.m2.1.1.1.1.3.7" stretchy="false" xref="algorithm1.19.19.m2.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm1.19.19.m2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm1.19.19.m2.2.2.3.1.cmml">|</mo><mrow id="algorithm1.19.19.m2.2.2.2.2" xref="algorithm1.19.19.m2.2.2.2.2.cmml"><msubsup id="algorithm1.19.19.m2.2.2.2.2.5" xref="algorithm1.19.19.m2.2.2.2.2.5.cmml"><mi id="algorithm1.19.19.m2.2.2.2.2.5.2.2" xref="algorithm1.19.19.m2.2.2.2.2.5.2.2.cmml">x</mi><mi id="algorithm1.19.19.m2.2.2.2.2.5.3" xref="algorithm1.19.19.m2.2.2.2.2.5.3.cmml">i</mi><mo id="algorithm1.19.19.m2.2.2.2.2.5.2.3" xref="algorithm1.19.19.m2.2.2.2.2.5.2.3.cmml">′</mo></msubsup><mo id="algorithm1.19.19.m2.2.2.2.2.4" xref="algorithm1.19.19.m2.2.2.2.2.4.cmml">=</mo><mrow id="algorithm1.19.19.m2.2.2.2.2.3" xref="algorithm1.19.19.m2.2.2.2.2.3.cmml"><msub id="algorithm1.19.19.m2.2.2.2.2.3.5" xref="algorithm1.19.19.m2.2.2.2.2.3.5.cmml"><mi id="algorithm1.19.19.m2.2.2.2.2.3.5.2" xref="algorithm1.19.19.m2.2.2.2.2.3.5.2.cmml">ϵ</mi><mi id="algorithm1.19.19.m2.2.2.2.2.3.5.3" xref="algorithm1.19.19.m2.2.2.2.2.3.5.3.cmml">θ</mi></msub><mo id="algorithm1.19.19.m2.2.2.2.2.3.4" xref="algorithm1.19.19.m2.2.2.2.2.3.4.cmml">⁢</mo><mrow id="algorithm1.19.19.m2.2.2.2.2.3.3.3" xref="algorithm1.19.19.m2.2.2.2.2.3.3.4.cmml"><mo id="algorithm1.19.19.m2.2.2.2.2.3.3.3.4" stretchy="false" xref="algorithm1.19.19.m2.2.2.2.2.3.3.4.cmml">(</mo><msub id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.cmml"><mi id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.2" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.3" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm1.19.19.m2.2.2.2.2.3.3.3.5" xref="algorithm1.19.19.m2.2.2.2.2.3.3.4.cmml">,</mo><msub id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.cmml"><mi id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.2" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.2.cmml">t</mi><mi id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.3" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm1.19.19.m2.2.2.2.2.3.3.3.6" xref="algorithm1.19.19.m2.2.2.2.2.3.3.4.cmml">,</mo><msub id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.cmml"><mi id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.2" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.2.cmml">λ</mi><mi id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.3" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.3.cmml">j</mi></msub><mo id="algorithm1.19.19.m2.2.2.2.2.3.3.3.7" stretchy="false" xref="algorithm1.19.19.m2.2.2.2.2.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm1.19.19.m2.2.2.2.5" stretchy="false" xref="algorithm1.19.19.m2.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m2.2b"><apply id="algorithm1.19.19.m2.2.2.3.cmml" xref="algorithm1.19.19.m2.2.2.2"><csymbol cd="latexml" id="algorithm1.19.19.m2.2.2.3.1.cmml" xref="algorithm1.19.19.m2.2.2.2.3">conditional-set</csymbol><vector id="algorithm1.19.19.m2.1.1.1.1.4.cmml" xref="algorithm1.19.19.m2.1.1.1.1.3"><apply id="algorithm1.19.19.m2.1.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.19.19.m2.1.1.1.1.1.1.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.19.19.m2.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm1.19.19.m2.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm1.19.19.m2.1.1.1.1.1.1.3.cmml" xref="algorithm1.19.19.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.19.19.m2.1.1.1.1.2.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.1.1.2.2.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.19.19.m2.1.1.1.1.2.2.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm1.19.19.m2.1.1.1.1.2.2.3.cmml" xref="algorithm1.19.19.m2.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="algorithm1.19.19.m2.1.1.1.1.3.3.cmml" xref="algorithm1.19.19.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.1.1.1.1.3.3.1.cmml" xref="algorithm1.19.19.m2.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm1.19.19.m2.1.1.1.1.3.3.2.cmml" xref="algorithm1.19.19.m2.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm1.19.19.m2.1.1.1.1.3.3.3.cmml" xref="algorithm1.19.19.m2.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm1.19.19.m2.2.2.2.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2"><eq id="algorithm1.19.19.m2.2.2.2.2.4.cmml" xref="algorithm1.19.19.m2.2.2.2.2.4"></eq><apply id="algorithm1.19.19.m2.2.2.2.2.5.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.2.2.2.2.5.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5">subscript</csymbol><apply id="algorithm1.19.19.m2.2.2.2.2.5.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.2.2.2.2.5.2.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5">superscript</csymbol><ci id="algorithm1.19.19.m2.2.2.2.2.5.2.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5.2.2">𝑥</ci><ci id="algorithm1.19.19.m2.2.2.2.2.5.2.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5.2.3">′</ci></apply><ci id="algorithm1.19.19.m2.2.2.2.2.5.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.5.3">𝑖</ci></apply><apply id="algorithm1.19.19.m2.2.2.2.2.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3"><times id="algorithm1.19.19.m2.2.2.2.2.3.4.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.4"></times><apply id="algorithm1.19.19.m2.2.2.2.2.3.5.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.5"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.2.2.2.2.3.5.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.5">subscript</csymbol><ci id="algorithm1.19.19.m2.2.2.2.2.3.5.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.5.2">italic-ϵ</ci><ci id="algorithm1.19.19.m2.2.2.2.2.3.5.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.5.3">𝜃</ci></apply><vector id="algorithm1.19.19.m2.2.2.2.2.3.3.4.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3"><apply id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.2">𝑥</ci><ci id="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.2">𝑡</ci><ci id="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3"><csymbol cd="ambiguous" id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.1.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3">subscript</csymbol><ci id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.2.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.2">𝜆</ci><ci id="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.3.cmml" xref="algorithm1.19.19.m2.2.2.2.2.3.3.3.3.3">𝑗</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m2.2c">\{(x^{\prime}_{i},y_{i},\lambda_{j})|x^{\prime}_{i}=\epsilon_{\theta}(x_{i},t_%
{i},\lambda_{j})\}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.19.19.m2.2d">{ ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.20.20">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\mathcal{S}\leftarrow\mathcal{S}\cup\{(x^{\prime}_{i},y_{i},\lambda_{j})\}" class="ltx_Math" display="inline" id="algorithm1.20.20.m1.1"><semantics id="algorithm1.20.20.m1.1a"><mrow id="algorithm1.20.20.m1.1.1" xref="algorithm1.20.20.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.20.20.m1.1.1.3" xref="algorithm1.20.20.m1.1.1.3.cmml">𝒮</mi><mo id="algorithm1.20.20.m1.1.1.2" stretchy="false" xref="algorithm1.20.20.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.20.20.m1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.20.20.m1.1.1.1.3" xref="algorithm1.20.20.m1.1.1.1.3.cmml">𝒮</mi><mo id="algorithm1.20.20.m1.1.1.1.2" xref="algorithm1.20.20.m1.1.1.1.2.cmml">∪</mo><mrow id="algorithm1.20.20.m1.1.1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.1.2.cmml"><mo id="algorithm1.20.20.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.20.20.m1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm1.20.20.m1.1.1.1.1.1.1.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.4.cmml"><mo id="algorithm1.20.20.m1.1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm1.20.20.m1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.2" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mo id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm1.20.20.m1.1.1.1.1.1.1.3.5" xref="algorithm1.20.20.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.2" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="algorithm1.20.20.m1.1.1.1.1.1.1.3.6" xref="algorithm1.20.20.m1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.2" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.3" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm1.20.20.m1.1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm1.20.20.m1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm1.20.20.m1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.20.20.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m1.1b"><apply id="algorithm1.20.20.m1.1.1.cmml" xref="algorithm1.20.20.m1.1.1"><ci id="algorithm1.20.20.m1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.2">←</ci><ci id="algorithm1.20.20.m1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.3">𝒮</ci><apply id="algorithm1.20.20.m1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1"><union id="algorithm1.20.20.m1.1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.1.2"></union><ci id="algorithm1.20.20.m1.1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.1.3">𝒮</ci><set id="algorithm1.20.20.m1.1.1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1"><vector id="algorithm1.20.20.m1.1.1.1.1.1.1.4.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3"><apply id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m1.1c">\mathcal{S}\leftarrow\mathcal{S}\cup\{(x^{\prime}_{i},y_{i},\lambda_{j})\}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.20.20.m1.1d">caligraphic_S ← caligraphic_S ∪ { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.21.25">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.21.26">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div class="ltx_listingline" id="algorithm1.21.27">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="algorithm1.21.28">
<span class="ltx_tag ltx_tag_listingline">14</span> end for
</div>
<div class="ltx_listingline" id="algorithm1.21.21">Filter synthetic data <math alttext="\mathcal{S}=\{(x^{\prime}_{i},y_{i},\lambda_{j})|F_{\theta}(x^{\prime}_{i})%
\geq h_{\text{filter}}\}" class="ltx_Math" display="inline" id="algorithm1.21.21.m1.2"><semantics id="algorithm1.21.21.m1.2a"><mrow id="algorithm1.21.21.m1.2.2" xref="algorithm1.21.21.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.21.21.m1.2.2.4" xref="algorithm1.21.21.m1.2.2.4.cmml">𝒮</mi><mo id="algorithm1.21.21.m1.2.2.3" xref="algorithm1.21.21.m1.2.2.3.cmml">=</mo><mrow id="algorithm1.21.21.m1.2.2.2.2" xref="algorithm1.21.21.m1.2.2.2.3.cmml"><mo id="algorithm1.21.21.m1.2.2.2.2.3" stretchy="false" xref="algorithm1.21.21.m1.2.2.2.3.1.cmml">{</mo><mrow id="algorithm1.21.21.m1.1.1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.1.1.4.cmml"><mo id="algorithm1.21.21.m1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm1.21.21.m1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm1.21.21.m1.1.1.1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.2" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm1.21.21.m1.1.1.1.1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.3.cmml">i</mi><mo id="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.3" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm1.21.21.m1.1.1.1.1.1.3.5" xref="algorithm1.21.21.m1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.21.21.m1.1.1.1.1.1.2.2" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2.cmml"><mi id="algorithm1.21.21.m1.1.1.1.1.1.2.2.2" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm1.21.21.m1.1.1.1.1.1.2.2.3" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="algorithm1.21.21.m1.1.1.1.1.1.3.6" xref="algorithm1.21.21.m1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm1.21.21.m1.1.1.1.1.1.3.3" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.21.21.m1.1.1.1.1.1.3.3.2" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm1.21.21.m1.1.1.1.1.1.3.3.3" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm1.21.21.m1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm1.21.21.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm1.21.21.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm1.21.21.m1.2.2.2.3.1.cmml">|</mo><mrow id="algorithm1.21.21.m1.2.2.2.2.2" xref="algorithm1.21.21.m1.2.2.2.2.2.cmml"><mrow id="algorithm1.21.21.m1.2.2.2.2.2.1" xref="algorithm1.21.21.m1.2.2.2.2.2.1.cmml"><msub id="algorithm1.21.21.m1.2.2.2.2.2.1.3" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3.cmml"><mi id="algorithm1.21.21.m1.2.2.2.2.2.1.3.2" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3.2.cmml">F</mi><mi id="algorithm1.21.21.m1.2.2.2.2.2.1.3.3" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3.3.cmml">θ</mi></msub><mo id="algorithm1.21.21.m1.2.2.2.2.2.1.2" xref="algorithm1.21.21.m1.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.cmml"><mo id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.2" stretchy="false" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.cmml"><mi id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.2" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.3" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.3.cmml">i</mi><mo id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.3" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.3" stretchy="false" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.21.21.m1.2.2.2.2.2.2" xref="algorithm1.21.21.m1.2.2.2.2.2.2.cmml">≥</mo><msub id="algorithm1.21.21.m1.2.2.2.2.2.3" xref="algorithm1.21.21.m1.2.2.2.2.2.3.cmml"><mi id="algorithm1.21.21.m1.2.2.2.2.2.3.2" xref="algorithm1.21.21.m1.2.2.2.2.2.3.2.cmml">h</mi><mtext id="algorithm1.21.21.m1.2.2.2.2.2.3.3" xref="algorithm1.21.21.m1.2.2.2.2.2.3.3a.cmml">filter</mtext></msub></mrow><mo id="algorithm1.21.21.m1.2.2.2.2.5" stretchy="false" xref="algorithm1.21.21.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.2b"><apply id="algorithm1.21.21.m1.2.2.cmml" xref="algorithm1.21.21.m1.2.2"><eq id="algorithm1.21.21.m1.2.2.3.cmml" xref="algorithm1.21.21.m1.2.2.3"></eq><ci id="algorithm1.21.21.m1.2.2.4.cmml" xref="algorithm1.21.21.m1.2.2.4">𝒮</ci><apply id="algorithm1.21.21.m1.2.2.2.3.cmml" xref="algorithm1.21.21.m1.2.2.2.2"><csymbol cd="latexml" id="algorithm1.21.21.m1.2.2.2.3.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm1.21.21.m1.1.1.1.1.1.4.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.3"><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm1.21.21.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm1.21.21.m1.1.1.1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.2.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.1.1.1.2.2.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm1.21.21.m1.1.1.1.1.1.2.2.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="algorithm1.21.21.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm1.21.21.m1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.21.21.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm1.21.21.m1.2.2.2.2.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2"><geq id="algorithm1.21.21.m1.2.2.2.2.2.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.2"></geq><apply id="algorithm1.21.21.m1.2.2.2.2.2.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1"><times id="algorithm1.21.21.m1.2.2.2.2.2.1.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.2"></times><apply id="algorithm1.21.21.m1.2.2.2.2.2.1.3.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.2.2.2.1.3.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3">subscript</csymbol><ci id="algorithm1.21.21.m1.2.2.2.2.2.1.3.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3.2">𝐹</ci><ci id="algorithm1.21.21.m1.2.2.2.2.2.1.3.3.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.3.3">𝜃</ci></apply><apply id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1">subscript</csymbol><apply id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1">superscript</csymbol><ci id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.2">𝑥</ci><ci id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.3.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.2.3">′</ci></apply><ci id="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="algorithm1.21.21.m1.2.2.2.2.2.3.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.2.2.2.3.1.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.3">subscript</csymbol><ci id="algorithm1.21.21.m1.2.2.2.2.2.3.2.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.3.2">ℎ</ci><ci id="algorithm1.21.21.m1.2.2.2.2.2.3.3a.cmml" xref="algorithm1.21.21.m1.2.2.2.2.2.3.3"><mtext id="algorithm1.21.21.m1.2.2.2.2.2.3.3.cmml" mathsize="70%" xref="algorithm1.21.21.m1.2.2.2.2.2.3.3">filter</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.2c">\mathcal{S}=\{(x^{\prime}_{i},y_{i},\lambda_{j})|F_{\theta}(x^{\prime}_{i})%
\geq h_{\text{filter}}\}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.21.21.m1.2d">caligraphic_S = { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_F start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ≥ italic_h start_POSTSUBSCRIPT filter end_POSTSUBSCRIPT }</annotation></semantics></math>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.23.1.1">Algorithm 1</span> </span>Interpolated Synthetic Generation</figcaption>
</figure>
<figure class="ltx_float ltx_algorithm" id="algorithm2">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm2.19">
<div class="ltx_listingline" id="algorithm2.19.20">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="algorithm2.7.7">
<span class="ltx_text" id="algorithm2.7.7.1"><span class="ltx_text ltx_font_bold" id="algorithm2.7.7.1.1">Input:</span> </span>
Image guidance level <math alttext="\Lambda=\{\lambda_{i}|\lambda_{i}\in[0,1]\}" class="ltx_Math" display="inline" id="algorithm2.1.1.m1.4"><semantics id="algorithm2.1.1.m1.4a"><mrow id="algorithm2.1.1.m1.4.4" xref="algorithm2.1.1.m1.4.4.cmml"><mi id="algorithm2.1.1.m1.4.4.4" mathvariant="normal" xref="algorithm2.1.1.m1.4.4.4.cmml">Λ</mi><mo id="algorithm2.1.1.m1.4.4.3" xref="algorithm2.1.1.m1.4.4.3.cmml">=</mo><mrow id="algorithm2.1.1.m1.4.4.2.2" xref="algorithm2.1.1.m1.4.4.2.3.cmml"><mo id="algorithm2.1.1.m1.4.4.2.2.3" stretchy="false" xref="algorithm2.1.1.m1.4.4.2.3.1.cmml">{</mo><msub id="algorithm2.1.1.m1.3.3.1.1.1" xref="algorithm2.1.1.m1.3.3.1.1.1.cmml"><mi id="algorithm2.1.1.m1.3.3.1.1.1.2" xref="algorithm2.1.1.m1.3.3.1.1.1.2.cmml">λ</mi><mi id="algorithm2.1.1.m1.3.3.1.1.1.3" xref="algorithm2.1.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="algorithm2.1.1.m1.4.4.2.2.4" lspace="0em" rspace="0em" xref="algorithm2.1.1.m1.4.4.2.3.1.cmml">|</mo><mrow id="algorithm2.1.1.m1.4.4.2.2.2" xref="algorithm2.1.1.m1.4.4.2.2.2.cmml"><msub id="algorithm2.1.1.m1.4.4.2.2.2.2" xref="algorithm2.1.1.m1.4.4.2.2.2.2.cmml"><mi id="algorithm2.1.1.m1.4.4.2.2.2.2.2" xref="algorithm2.1.1.m1.4.4.2.2.2.2.2.cmml">λ</mi><mi id="algorithm2.1.1.m1.4.4.2.2.2.2.3" xref="algorithm2.1.1.m1.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm2.1.1.m1.4.4.2.2.2.1" xref="algorithm2.1.1.m1.4.4.2.2.2.1.cmml">∈</mo><mrow id="algorithm2.1.1.m1.4.4.2.2.2.3.2" xref="algorithm2.1.1.m1.4.4.2.2.2.3.1.cmml"><mo id="algorithm2.1.1.m1.4.4.2.2.2.3.2.1" stretchy="false" xref="algorithm2.1.1.m1.4.4.2.2.2.3.1.cmml">[</mo><mn id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">0</mn><mo id="algorithm2.1.1.m1.4.4.2.2.2.3.2.2" xref="algorithm2.1.1.m1.4.4.2.2.2.3.1.cmml">,</mo><mn id="algorithm2.1.1.m1.2.2" xref="algorithm2.1.1.m1.2.2.cmml">1</mn><mo id="algorithm2.1.1.m1.4.4.2.2.2.3.2.3" stretchy="false" xref="algorithm2.1.1.m1.4.4.2.2.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm2.1.1.m1.4.4.2.2.5" stretchy="false" xref="algorithm2.1.1.m1.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.4b"><apply id="algorithm2.1.1.m1.4.4.cmml" xref="algorithm2.1.1.m1.4.4"><eq id="algorithm2.1.1.m1.4.4.3.cmml" xref="algorithm2.1.1.m1.4.4.3"></eq><ci id="algorithm2.1.1.m1.4.4.4.cmml" xref="algorithm2.1.1.m1.4.4.4">Λ</ci><apply id="algorithm2.1.1.m1.4.4.2.3.cmml" xref="algorithm2.1.1.m1.4.4.2.2"><csymbol cd="latexml" id="algorithm2.1.1.m1.4.4.2.3.1.cmml" xref="algorithm2.1.1.m1.4.4.2.2.3">conditional-set</csymbol><apply id="algorithm2.1.1.m1.3.3.1.1.1.cmml" xref="algorithm2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.3.3.1.1.1.1.cmml" xref="algorithm2.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="algorithm2.1.1.m1.3.3.1.1.1.2.cmml" xref="algorithm2.1.1.m1.3.3.1.1.1.2">𝜆</ci><ci id="algorithm2.1.1.m1.3.3.1.1.1.3.cmml" xref="algorithm2.1.1.m1.3.3.1.1.1.3">𝑖</ci></apply><apply id="algorithm2.1.1.m1.4.4.2.2.2.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2"><in id="algorithm2.1.1.m1.4.4.2.2.2.1.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2.1"></in><apply id="algorithm2.1.1.m1.4.4.2.2.2.2.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.1.1.m1.4.4.2.2.2.2.1.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2.2">subscript</csymbol><ci id="algorithm2.1.1.m1.4.4.2.2.2.2.2.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2.2.2">𝜆</ci><ci id="algorithm2.1.1.m1.4.4.2.2.2.2.3.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2.2.3">𝑖</ci></apply><interval closure="closed" id="algorithm2.1.1.m1.4.4.2.2.2.3.1.cmml" xref="algorithm2.1.1.m1.4.4.2.2.2.3.2"><cn id="algorithm2.1.1.m1.1.1.cmml" type="integer" xref="algorithm2.1.1.m1.1.1">0</cn><cn id="algorithm2.1.1.m1.2.2.cmml" type="integer" xref="algorithm2.1.1.m1.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.4c">\Lambda=\{\lambda_{i}|\lambda_{i}\in[0,1]\}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.1.1.m1.4d">roman_Λ = { italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ [ 0 , 1 ] }</annotation></semantics></math>,
non-hard samples <math alttext="\mathcal{D}_{\text{nh}}=\{(x_{i},y_{i},\lambda_{i}=1)\}_{i=1}^{N}" class="ltx_Math" display="inline" id="algorithm2.2.2.m2.1"><semantics id="algorithm2.2.2.m2.1a"><mrow id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml"><msub id="algorithm2.2.2.m2.1.1.3" xref="algorithm2.2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.2.2.m2.1.1.3.2" xref="algorithm2.2.2.m2.1.1.3.2.cmml">𝒟</mi><mtext id="algorithm2.2.2.m2.1.1.3.3" xref="algorithm2.2.2.m2.1.1.3.3a.cmml">nh</mtext></msub><mo id="algorithm2.2.2.m2.1.1.2" xref="algorithm2.2.2.m2.1.1.2.cmml">=</mo><msubsup id="algorithm2.2.2.m2.1.1.1" xref="algorithm2.2.2.m2.1.1.1.cmml"><mrow id="algorithm2.2.2.m2.1.1.1.1.1.1" xref="algorithm2.2.2.m2.1.1.1.1.1.2.cmml"><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="algorithm2.2.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.4" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.5" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">λ</mi><mi id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub></mrow><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.4" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.4.cmml">=</mo><mn id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.5" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.5.cmml">1</mn></mrow><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm2.2.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="algorithm2.2.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm2.2.2.m2.1.1.1.1.3" xref="algorithm2.2.2.m2.1.1.1.1.3.cmml"><mi id="algorithm2.2.2.m2.1.1.1.1.3.2" xref="algorithm2.2.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="algorithm2.2.2.m2.1.1.1.1.3.1" xref="algorithm2.2.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="algorithm2.2.2.m2.1.1.1.1.3.3" xref="algorithm2.2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm2.2.2.m2.1.1.1.3" xref="algorithm2.2.2.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><apply id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1"><eq id="algorithm2.2.2.m2.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.2"></eq><apply id="algorithm2.2.2.m2.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.3.1.cmml" xref="algorithm2.2.2.m2.1.1.3">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.3.2.cmml" xref="algorithm2.2.2.m2.1.1.3.2">𝒟</ci><ci id="algorithm2.2.2.m2.1.1.3.3a.cmml" xref="algorithm2.2.2.m2.1.1.3.3"><mtext id="algorithm2.2.2.m2.1.1.3.3.cmml" mathsize="70%" xref="algorithm2.2.2.m2.1.1.3.3">nh</mtext></ci></apply><apply id="algorithm2.2.2.m2.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.1">superscript</csymbol><apply id="algorithm2.2.2.m2.1.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.1">subscript</csymbol><set id="algorithm2.2.2.m2.1.1.1.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1"><apply id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1"><eq id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.4"></eq><list id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3"><apply id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2">𝜆</ci><ci id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply></list><cn id="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.5.cmml" type="integer" xref="algorithm2.2.2.m2.1.1.1.1.1.1.1.1.1.5">1</cn></apply></set><apply id="algorithm2.2.2.m2.1.1.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.1.1.3"><eq id="algorithm2.2.2.m2.1.1.1.1.3.1.cmml" xref="algorithm2.2.2.m2.1.1.1.1.3.1"></eq><ci id="algorithm2.2.2.m2.1.1.1.1.3.2.cmml" xref="algorithm2.2.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="algorithm2.2.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="algorithm2.2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm2.2.2.m2.1.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">\mathcal{D}_{\text{nh}}=\{(x_{i},y_{i},\lambda_{i}=1)\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT nh end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>,
spectrum of syn-to-real data <math alttext="\mathcal{S}=\{(x^{\prime}_{j},y_{j},\lambda_{j})|\lambda_{j}\in\Lambda\}_{j=1}%
^{M}" class="ltx_Math" display="inline" id="algorithm2.3.3.m3.2"><semantics id="algorithm2.3.3.m3.2a"><mrow id="algorithm2.3.3.m3.2.2" xref="algorithm2.3.3.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.3.3.m3.2.2.4" xref="algorithm2.3.3.m3.2.2.4.cmml">𝒮</mi><mo id="algorithm2.3.3.m3.2.2.3" xref="algorithm2.3.3.m3.2.2.3.cmml">=</mo><msubsup id="algorithm2.3.3.m3.2.2.2" xref="algorithm2.3.3.m3.2.2.2.cmml"><mrow id="algorithm2.3.3.m3.2.2.2.2.2.2" xref="algorithm2.3.3.m3.2.2.2.2.2.3.cmml"><mo id="algorithm2.3.3.m3.2.2.2.2.2.2.3" stretchy="false" xref="algorithm2.3.3.m3.2.2.2.2.2.3.1.cmml">{</mo><mrow id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.4.cmml"><mo id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.2" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.3" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.3" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.5" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.2" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.3" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.6" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.2" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.3" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm2.3.3.m3.2.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm2.3.3.m3.2.2.2.2.2.3.1.cmml">|</mo><mrow id="algorithm2.3.3.m3.2.2.2.2.2.2.2" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.cmml"><msub id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.2" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.2.cmml">λ</mi><mi id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.3" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm2.3.3.m3.2.2.2.2.2.2.2.1" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.1.cmml">∈</mo><mi id="algorithm2.3.3.m3.2.2.2.2.2.2.2.3" mathvariant="normal" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.3.cmml">Λ</mi></mrow><mo id="algorithm2.3.3.m3.2.2.2.2.2.2.5" stretchy="false" xref="algorithm2.3.3.m3.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="algorithm2.3.3.m3.2.2.2.2.4" xref="algorithm2.3.3.m3.2.2.2.2.4.cmml"><mi id="algorithm2.3.3.m3.2.2.2.2.4.2" xref="algorithm2.3.3.m3.2.2.2.2.4.2.cmml">j</mi><mo id="algorithm2.3.3.m3.2.2.2.2.4.1" xref="algorithm2.3.3.m3.2.2.2.2.4.1.cmml">=</mo><mn id="algorithm2.3.3.m3.2.2.2.2.4.3" xref="algorithm2.3.3.m3.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="algorithm2.3.3.m3.2.2.2.4" xref="algorithm2.3.3.m3.2.2.2.4.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m3.2b"><apply id="algorithm2.3.3.m3.2.2.cmml" xref="algorithm2.3.3.m3.2.2"><eq id="algorithm2.3.3.m3.2.2.3.cmml" xref="algorithm2.3.3.m3.2.2.3"></eq><ci id="algorithm2.3.3.m3.2.2.4.cmml" xref="algorithm2.3.3.m3.2.2.4">𝒮</ci><apply id="algorithm2.3.3.m3.2.2.2.cmml" xref="algorithm2.3.3.m3.2.2.2"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.2.2.2.3.cmml" xref="algorithm2.3.3.m3.2.2.2">superscript</csymbol><apply id="algorithm2.3.3.m3.2.2.2.2.cmml" xref="algorithm2.3.3.m3.2.2.2"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.2.2.2.2.3.cmml" xref="algorithm2.3.3.m3.2.2.2">subscript</csymbol><apply id="algorithm2.3.3.m3.2.2.2.2.2.3.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2"><csymbol cd="latexml" id="algorithm2.3.3.m3.2.2.2.2.2.3.1.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm2.3.3.m3.1.1.1.1.1.1.1.4.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3"><apply id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm2.3.3.m3.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm2.3.3.m3.2.2.2.2.2.2.2.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2"><in id="algorithm2.3.3.m3.2.2.2.2.2.2.2.1.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.1"></in><apply id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.2">𝜆</ci><ci id="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="algorithm2.3.3.m3.2.2.2.2.2.2.2.3.cmml" xref="algorithm2.3.3.m3.2.2.2.2.2.2.2.3">Λ</ci></apply></apply><apply id="algorithm2.3.3.m3.2.2.2.2.4.cmml" xref="algorithm2.3.3.m3.2.2.2.2.4"><eq id="algorithm2.3.3.m3.2.2.2.2.4.1.cmml" xref="algorithm2.3.3.m3.2.2.2.2.4.1"></eq><ci id="algorithm2.3.3.m3.2.2.2.2.4.2.cmml" xref="algorithm2.3.3.m3.2.2.2.2.4.2">𝑗</ci><cn id="algorithm2.3.3.m3.2.2.2.2.4.3.cmml" type="integer" xref="algorithm2.3.3.m3.2.2.2.2.4.3">1</cn></apply></apply><ci id="algorithm2.3.3.m3.2.2.2.4.cmml" xref="algorithm2.3.3.m3.2.2.2.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m3.2c">\mathcal{S}=\{(x^{\prime}_{j},y_{j},\lambda_{j})|\lambda_{j}\in\Lambda\}_{j=1}%
^{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.3.3.m3.2d">caligraphic_S = { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ roman_Λ } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>,
original hard samples <math alttext="\mathcal{D}_{\text{h}}=\{(x_{j},y_{j},\lambda_{j})|\lambda_{j}=1,(x_{j},y_{j},%
\lambda_{j})\in\mathcal{S}\}" class="ltx_Math" display="inline" id="algorithm2.4.4.m4.2"><semantics id="algorithm2.4.4.m4.2a"><mrow id="algorithm2.4.4.m4.2.2" xref="algorithm2.4.4.m4.2.2.cmml"><msub id="algorithm2.4.4.m4.2.2.4" xref="algorithm2.4.4.m4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.4.4.m4.2.2.4.2" xref="algorithm2.4.4.m4.2.2.4.2.cmml">𝒟</mi><mtext id="algorithm2.4.4.m4.2.2.4.3" xref="algorithm2.4.4.m4.2.2.4.3a.cmml">h</mtext></msub><mo id="algorithm2.4.4.m4.2.2.3" xref="algorithm2.4.4.m4.2.2.3.cmml">=</mo><mrow id="algorithm2.4.4.m4.2.2.2.2" xref="algorithm2.4.4.m4.2.2.2.3.cmml"><mo id="algorithm2.4.4.m4.2.2.2.2.3" stretchy="false" xref="algorithm2.4.4.m4.2.2.2.3.1.cmml">{</mo><mrow id="algorithm2.4.4.m4.1.1.1.1.1.3" xref="algorithm2.4.4.m4.1.1.1.1.1.4.cmml"><mo id="algorithm2.4.4.m4.1.1.1.1.1.3.4" stretchy="false" xref="algorithm2.4.4.m4.1.1.1.1.1.4.cmml">(</mo><msub id="algorithm2.4.4.m4.1.1.1.1.1.1.1" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1.cmml"><mi id="algorithm2.4.4.m4.1.1.1.1.1.1.1.2" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm2.4.4.m4.1.1.1.1.1.1.1.3" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.1.1.1.1.1.3.5" xref="algorithm2.4.4.m4.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm2.4.4.m4.1.1.1.1.1.2.2" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2.cmml"><mi id="algorithm2.4.4.m4.1.1.1.1.1.2.2.2" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm2.4.4.m4.1.1.1.1.1.2.2.3" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.1.1.1.1.1.3.6" xref="algorithm2.4.4.m4.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm2.4.4.m4.1.1.1.1.1.3.3" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3.cmml"><mi id="algorithm2.4.4.m4.1.1.1.1.1.3.3.2" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm2.4.4.m4.1.1.1.1.1.3.3.3" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.1.1.1.1.1.3.7" stretchy="false" xref="algorithm2.4.4.m4.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm2.4.4.m4.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm2.4.4.m4.2.2.2.3.1.cmml">|</mo><mrow id="algorithm2.4.4.m4.2.2.2.2.2.2" xref="algorithm2.4.4.m4.2.2.2.2.2.3.cmml"><mrow id="algorithm2.4.4.m4.2.2.2.2.2.1.1" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.cmml"><msub id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.cmml"><mi id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.2" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.2.cmml">λ</mi><mi id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.3" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.2.2.2.2.2.1.1.1" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.1.cmml">=</mo><mn id="algorithm2.4.4.m4.2.2.2.2.2.1.1.3" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.3.cmml">1</mn></mrow><mo id="algorithm2.4.4.m4.2.2.2.2.2.2.3" xref="algorithm2.4.4.m4.2.2.2.2.2.3a.cmml">,</mo><mrow id="algorithm2.4.4.m4.2.2.2.2.2.2.2" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.cmml"><mrow id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.4.cmml"><mo id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.4" stretchy="false" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.4.cmml">(</mo><msub id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.2" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.3" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.5" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.4.cmml">,</mo><msub id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.cmml"><mi id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.2" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.3" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.6" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.4.cmml">,</mo><msub id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.cmml"><mi id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.2" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.2.cmml">λ</mi><mi id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.3" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.3.cmml">j</mi></msub><mo id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.7" stretchy="false" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.4.cmml">)</mo></mrow><mo id="algorithm2.4.4.m4.2.2.2.2.2.2.2.4" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algorithm2.4.4.m4.2.2.2.2.2.2.2.5" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.5.cmml">𝒮</mi></mrow></mrow><mo id="algorithm2.4.4.m4.2.2.2.2.5" stretchy="false" xref="algorithm2.4.4.m4.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m4.2b"><apply id="algorithm2.4.4.m4.2.2.cmml" xref="algorithm2.4.4.m4.2.2"><eq id="algorithm2.4.4.m4.2.2.3.cmml" xref="algorithm2.4.4.m4.2.2.3"></eq><apply id="algorithm2.4.4.m4.2.2.4.cmml" xref="algorithm2.4.4.m4.2.2.4"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.2.2.4.1.cmml" xref="algorithm2.4.4.m4.2.2.4">subscript</csymbol><ci id="algorithm2.4.4.m4.2.2.4.2.cmml" xref="algorithm2.4.4.m4.2.2.4.2">𝒟</ci><ci id="algorithm2.4.4.m4.2.2.4.3a.cmml" xref="algorithm2.4.4.m4.2.2.4.3"><mtext id="algorithm2.4.4.m4.2.2.4.3.cmml" mathsize="70%" xref="algorithm2.4.4.m4.2.2.4.3">h</mtext></ci></apply><apply id="algorithm2.4.4.m4.2.2.2.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2"><csymbol cd="latexml" id="algorithm2.4.4.m4.2.2.2.3.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm2.4.4.m4.1.1.1.1.1.4.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.3"><apply id="algorithm2.4.4.m4.1.1.1.1.1.1.1.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.4.4.m4.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm2.4.4.m4.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm2.4.4.m4.1.1.1.1.1.2.2.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.1.1.1.1.1.2.2.1.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm2.4.4.m4.1.1.1.1.1.2.2.2.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm2.4.4.m4.1.1.1.1.1.2.2.3.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm2.4.4.m4.1.1.1.1.1.3.3.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.1.1.1.1.1.3.3.1.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm2.4.4.m4.1.1.1.1.1.3.3.2.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm2.4.4.m4.1.1.1.1.1.3.3.3.cmml" xref="algorithm2.4.4.m4.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm2.4.4.m4.2.2.2.2.2.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.2.2.2.2.2.3a.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="algorithm2.4.4.m4.2.2.2.2.2.1.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1"><eq id="algorithm2.4.4.m4.2.2.2.2.2.1.1.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.1"></eq><apply id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.2">𝜆</ci><ci id="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.2.3">𝑗</ci></apply><cn id="algorithm2.4.4.m4.2.2.2.2.2.1.1.3.cmml" type="integer" xref="algorithm2.4.4.m4.2.2.2.2.2.1.1.3">1</cn></apply><apply id="algorithm2.4.4.m4.2.2.2.2.2.2.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2"><in id="algorithm2.4.4.m4.2.2.2.2.2.2.2.4.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.4"></in><vector id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.4.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3"><apply id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.2">𝑥</ci><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.1.1.1.3">𝑗</ci></apply><apply id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.1.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3">subscript</csymbol><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.2.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.2">𝜆</ci><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.3.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.3.3.3.3">𝑗</ci></apply></vector><ci id="algorithm2.4.4.m4.2.2.2.2.2.2.2.5.cmml" xref="algorithm2.4.4.m4.2.2.2.2.2.2.2.5">𝒮</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m4.2c">\mathcal{D}_{\text{h}}=\{(x_{j},y_{j},\lambda_{j})|\lambda_{j}=1,(x_{j},y_{j},%
\lambda_{j})\in\mathcal{S}\}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.4.4.m4.2d">caligraphic_D start_POSTSUBSCRIPT h end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 , ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ∈ caligraphic_S }</annotation></semantics></math>,
train epochs <math alttext="E" class="ltx_Math" display="inline" id="algorithm2.5.5.m5.1"><semantics id="algorithm2.5.5.m5.1a"><mi id="algorithm2.5.5.m5.1.1" xref="algorithm2.5.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m5.1b"><ci id="algorithm2.5.5.m5.1.1.cmml" xref="algorithm2.5.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m5.1c">E</annotation><annotation encoding="application/x-llamapun" id="algorithm2.5.5.m5.1d">italic_E</annotation></semantics></math>,
curriculum epochs <math alttext="E_{CL}" class="ltx_Math" display="inline" id="algorithm2.6.6.m6.1"><semantics id="algorithm2.6.6.m6.1a"><msub id="algorithm2.6.6.m6.1.1" xref="algorithm2.6.6.m6.1.1.cmml"><mi id="algorithm2.6.6.m6.1.1.2" xref="algorithm2.6.6.m6.1.1.2.cmml">E</mi><mrow id="algorithm2.6.6.m6.1.1.3" xref="algorithm2.6.6.m6.1.1.3.cmml"><mi id="algorithm2.6.6.m6.1.1.3.2" xref="algorithm2.6.6.m6.1.1.3.2.cmml">C</mi><mo id="algorithm2.6.6.m6.1.1.3.1" xref="algorithm2.6.6.m6.1.1.3.1.cmml">⁢</mo><mi id="algorithm2.6.6.m6.1.1.3.3" xref="algorithm2.6.6.m6.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m6.1b"><apply id="algorithm2.6.6.m6.1.1.cmml" xref="algorithm2.6.6.m6.1.1"><csymbol cd="ambiguous" id="algorithm2.6.6.m6.1.1.1.cmml" xref="algorithm2.6.6.m6.1.1">subscript</csymbol><ci id="algorithm2.6.6.m6.1.1.2.cmml" xref="algorithm2.6.6.m6.1.1.2">𝐸</ci><apply id="algorithm2.6.6.m6.1.1.3.cmml" xref="algorithm2.6.6.m6.1.1.3"><times id="algorithm2.6.6.m6.1.1.3.1.cmml" xref="algorithm2.6.6.m6.1.1.3.1"></times><ci id="algorithm2.6.6.m6.1.1.3.2.cmml" xref="algorithm2.6.6.m6.1.1.3.2">𝐶</ci><ci id="algorithm2.6.6.m6.1.1.3.3.cmml" xref="algorithm2.6.6.m6.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m6.1c">E_{CL}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.6.6.m6.1d">italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math>,
predefined guidance schedule <math alttext="\mathcal{G}=\{\lambda_{1},\lambda_{2},...,\lambda_{E_{CL}}\}" class="ltx_Math" display="inline" id="algorithm2.7.7.m7.4"><semantics id="algorithm2.7.7.m7.4a"><mrow id="algorithm2.7.7.m7.4.4" xref="algorithm2.7.7.m7.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.7.7.m7.4.4.5" xref="algorithm2.7.7.m7.4.4.5.cmml">𝒢</mi><mo id="algorithm2.7.7.m7.4.4.4" xref="algorithm2.7.7.m7.4.4.4.cmml">=</mo><mrow id="algorithm2.7.7.m7.4.4.3.3" xref="algorithm2.7.7.m7.4.4.3.4.cmml"><mo id="algorithm2.7.7.m7.4.4.3.3.4" stretchy="false" xref="algorithm2.7.7.m7.4.4.3.4.cmml">{</mo><msub id="algorithm2.7.7.m7.2.2.1.1.1" xref="algorithm2.7.7.m7.2.2.1.1.1.cmml"><mi id="algorithm2.7.7.m7.2.2.1.1.1.2" xref="algorithm2.7.7.m7.2.2.1.1.1.2.cmml">λ</mi><mn id="algorithm2.7.7.m7.2.2.1.1.1.3" xref="algorithm2.7.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="algorithm2.7.7.m7.4.4.3.3.5" xref="algorithm2.7.7.m7.4.4.3.4.cmml">,</mo><msub id="algorithm2.7.7.m7.3.3.2.2.2" xref="algorithm2.7.7.m7.3.3.2.2.2.cmml"><mi id="algorithm2.7.7.m7.3.3.2.2.2.2" xref="algorithm2.7.7.m7.3.3.2.2.2.2.cmml">λ</mi><mn id="algorithm2.7.7.m7.3.3.2.2.2.3" xref="algorithm2.7.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="algorithm2.7.7.m7.4.4.3.3.6" xref="algorithm2.7.7.m7.4.4.3.4.cmml">,</mo><mi id="algorithm2.7.7.m7.1.1" mathvariant="normal" xref="algorithm2.7.7.m7.1.1.cmml">…</mi><mo id="algorithm2.7.7.m7.4.4.3.3.7" xref="algorithm2.7.7.m7.4.4.3.4.cmml">,</mo><msub id="algorithm2.7.7.m7.4.4.3.3.3" xref="algorithm2.7.7.m7.4.4.3.3.3.cmml"><mi id="algorithm2.7.7.m7.4.4.3.3.3.2" xref="algorithm2.7.7.m7.4.4.3.3.3.2.cmml">λ</mi><msub id="algorithm2.7.7.m7.4.4.3.3.3.3" xref="algorithm2.7.7.m7.4.4.3.3.3.3.cmml"><mi id="algorithm2.7.7.m7.4.4.3.3.3.3.2" xref="algorithm2.7.7.m7.4.4.3.3.3.3.2.cmml">E</mi><mrow id="algorithm2.7.7.m7.4.4.3.3.3.3.3" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.cmml"><mi id="algorithm2.7.7.m7.4.4.3.3.3.3.3.2" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.2.cmml">C</mi><mo id="algorithm2.7.7.m7.4.4.3.3.3.3.3.1" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.1.cmml">⁢</mo><mi id="algorithm2.7.7.m7.4.4.3.3.3.3.3.3" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.3.cmml">L</mi></mrow></msub></msub><mo id="algorithm2.7.7.m7.4.4.3.3.8" stretchy="false" xref="algorithm2.7.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.m7.4b"><apply id="algorithm2.7.7.m7.4.4.cmml" xref="algorithm2.7.7.m7.4.4"><eq id="algorithm2.7.7.m7.4.4.4.cmml" xref="algorithm2.7.7.m7.4.4.4"></eq><ci id="algorithm2.7.7.m7.4.4.5.cmml" xref="algorithm2.7.7.m7.4.4.5">𝒢</ci><set id="algorithm2.7.7.m7.4.4.3.4.cmml" xref="algorithm2.7.7.m7.4.4.3.3"><apply id="algorithm2.7.7.m7.2.2.1.1.1.cmml" xref="algorithm2.7.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.7.7.m7.2.2.1.1.1.1.cmml" xref="algorithm2.7.7.m7.2.2.1.1.1">subscript</csymbol><ci id="algorithm2.7.7.m7.2.2.1.1.1.2.cmml" xref="algorithm2.7.7.m7.2.2.1.1.1.2">𝜆</ci><cn id="algorithm2.7.7.m7.2.2.1.1.1.3.cmml" type="integer" xref="algorithm2.7.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="algorithm2.7.7.m7.3.3.2.2.2.cmml" xref="algorithm2.7.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm2.7.7.m7.3.3.2.2.2.1.cmml" xref="algorithm2.7.7.m7.3.3.2.2.2">subscript</csymbol><ci id="algorithm2.7.7.m7.3.3.2.2.2.2.cmml" xref="algorithm2.7.7.m7.3.3.2.2.2.2">𝜆</ci><cn id="algorithm2.7.7.m7.3.3.2.2.2.3.cmml" type="integer" xref="algorithm2.7.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="algorithm2.7.7.m7.1.1.cmml" xref="algorithm2.7.7.m7.1.1">…</ci><apply id="algorithm2.7.7.m7.4.4.3.3.3.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="algorithm2.7.7.m7.4.4.3.3.3.1.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3">subscript</csymbol><ci id="algorithm2.7.7.m7.4.4.3.3.3.2.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.2">𝜆</ci><apply id="algorithm2.7.7.m7.4.4.3.3.3.3.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3"><csymbol cd="ambiguous" id="algorithm2.7.7.m7.4.4.3.3.3.3.1.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3">subscript</csymbol><ci id="algorithm2.7.7.m7.4.4.3.3.3.3.2.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3.2">𝐸</ci><apply id="algorithm2.7.7.m7.4.4.3.3.3.3.3.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3"><times id="algorithm2.7.7.m7.4.4.3.3.3.3.3.1.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.1"></times><ci id="algorithm2.7.7.m7.4.4.3.3.3.3.3.2.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.2">𝐶</ci><ci id="algorithm2.7.7.m7.4.4.3.3.3.3.3.3.cmml" xref="algorithm2.7.7.m7.4.4.3.3.3.3.3.3">𝐿</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.m7.4c">\mathcal{G}=\{\lambda_{1},\lambda_{2},...,\lambda_{E_{CL}}\}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.7.7.m7.4d">caligraphic_G = { italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_λ start_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algorithm2.8.8">
<span class="ltx_text" id="algorithm2.8.8.1"><span class="ltx_text ltx_font_bold" id="algorithm2.8.8.1.1">Output:</span> </span>trained model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm2.8.8.m1.1"><semantics id="algorithm2.8.8.m1.1a"><msub id="algorithm2.8.8.m1.1.1" xref="algorithm2.8.8.m1.1.1.cmml"><mi id="algorithm2.8.8.m1.1.1.2" xref="algorithm2.8.8.m1.1.1.2.cmml">f</mi><mi id="algorithm2.8.8.m1.1.1.3" xref="algorithm2.8.8.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m1.1b"><apply id="algorithm2.8.8.m1.1.1.cmml" xref="algorithm2.8.8.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.8.8.m1.1.1.1.cmml" xref="algorithm2.8.8.m1.1.1">subscript</csymbol><ci id="algorithm2.8.8.m1.1.1.2.cmml" xref="algorithm2.8.8.m1.1.1.2">𝑓</ci><ci id="algorithm2.8.8.m1.1.1.3.cmml" xref="algorithm2.8.8.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.8.8.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.9.9">
<span class="ltx_text" id="algorithm2.9.9.1"><span class="ltx_text ltx_font_bold" id="algorithm2.9.9.1.1">Initialize:</span> </span>pretrained model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm2.9.9.m1.1"><semantics id="algorithm2.9.9.m1.1a"><msub id="algorithm2.9.9.m1.1.1" xref="algorithm2.9.9.m1.1.1.cmml"><mi id="algorithm2.9.9.m1.1.1.2" xref="algorithm2.9.9.m1.1.1.2.cmml">f</mi><mi id="algorithm2.9.9.m1.1.1.3" xref="algorithm2.9.9.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.m1.1b"><apply id="algorithm2.9.9.m1.1.1.cmml" xref="algorithm2.9.9.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.9.9.m1.1.1.1.cmml" xref="algorithm2.9.9.m1.1.1">subscript</csymbol><ci id="algorithm2.9.9.m1.1.1.2.cmml" xref="algorithm2.9.9.m1.1.1.2">𝑓</ci><ci id="algorithm2.9.9.m1.1.1.3.cmml" xref="algorithm2.9.9.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.9.9.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.19.21">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="algorithm2.10.10">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_font_bold" id="algorithm2.10.10.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.10.10.1"><math alttext="e\leq E_{CL}" class="ltx_Math" display="inline" id="algorithm2.10.10.1.m1.1"><semantics id="algorithm2.10.10.1.m1.1a"><mrow id="algorithm2.10.10.1.m1.1.1" xref="algorithm2.10.10.1.m1.1.1.cmml"><mi id="algorithm2.10.10.1.m1.1.1.2" xref="algorithm2.10.10.1.m1.1.1.2.cmml">e</mi><mo id="algorithm2.10.10.1.m1.1.1.1" xref="algorithm2.10.10.1.m1.1.1.1.cmml">≤</mo><msub id="algorithm2.10.10.1.m1.1.1.3" xref="algorithm2.10.10.1.m1.1.1.3.cmml"><mi id="algorithm2.10.10.1.m1.1.1.3.2" xref="algorithm2.10.10.1.m1.1.1.3.2.cmml">E</mi><mrow id="algorithm2.10.10.1.m1.1.1.3.3" xref="algorithm2.10.10.1.m1.1.1.3.3.cmml"><mi id="algorithm2.10.10.1.m1.1.1.3.3.2" xref="algorithm2.10.10.1.m1.1.1.3.3.2.cmml">C</mi><mo id="algorithm2.10.10.1.m1.1.1.3.3.1" xref="algorithm2.10.10.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm2.10.10.1.m1.1.1.3.3.3" xref="algorithm2.10.10.1.m1.1.1.3.3.3.cmml">L</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.1.m1.1b"><apply id="algorithm2.10.10.1.m1.1.1.cmml" xref="algorithm2.10.10.1.m1.1.1"><leq id="algorithm2.10.10.1.m1.1.1.1.cmml" xref="algorithm2.10.10.1.m1.1.1.1"></leq><ci id="algorithm2.10.10.1.m1.1.1.2.cmml" xref="algorithm2.10.10.1.m1.1.1.2">𝑒</ci><apply id="algorithm2.10.10.1.m1.1.1.3.cmml" xref="algorithm2.10.10.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.10.10.1.m1.1.1.3.1.cmml" xref="algorithm2.10.10.1.m1.1.1.3">subscript</csymbol><ci id="algorithm2.10.10.1.m1.1.1.3.2.cmml" xref="algorithm2.10.10.1.m1.1.1.3.2">𝐸</ci><apply id="algorithm2.10.10.1.m1.1.1.3.3.cmml" xref="algorithm2.10.10.1.m1.1.1.3.3"><times id="algorithm2.10.10.1.m1.1.1.3.3.1.cmml" xref="algorithm2.10.10.1.m1.1.1.3.3.1"></times><ci id="algorithm2.10.10.1.m1.1.1.3.3.2.cmml" xref="algorithm2.10.10.1.m1.1.1.3.3.2">𝐶</ci><ci id="algorithm2.10.10.1.m1.1.1.3.3.3.cmml" xref="algorithm2.10.10.1.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.1.m1.1c">e\leq E_{CL}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.10.10.1.m1.1d">italic_e ≤ italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.10.10.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.11.11">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\lambda_{e}=G(e)" class="ltx_Math" display="inline" id="algorithm2.11.11.m1.1"><semantics id="algorithm2.11.11.m1.1a"><mrow id="algorithm2.11.11.m1.1.2" xref="algorithm2.11.11.m1.1.2.cmml"><msub id="algorithm2.11.11.m1.1.2.2" xref="algorithm2.11.11.m1.1.2.2.cmml"><mi id="algorithm2.11.11.m1.1.2.2.2" xref="algorithm2.11.11.m1.1.2.2.2.cmml">λ</mi><mi id="algorithm2.11.11.m1.1.2.2.3" xref="algorithm2.11.11.m1.1.2.2.3.cmml">e</mi></msub><mo id="algorithm2.11.11.m1.1.2.1" xref="algorithm2.11.11.m1.1.2.1.cmml">=</mo><mrow id="algorithm2.11.11.m1.1.2.3" xref="algorithm2.11.11.m1.1.2.3.cmml"><mi id="algorithm2.11.11.m1.1.2.3.2" xref="algorithm2.11.11.m1.1.2.3.2.cmml">G</mi><mo id="algorithm2.11.11.m1.1.2.3.1" xref="algorithm2.11.11.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm2.11.11.m1.1.2.3.3.2" xref="algorithm2.11.11.m1.1.2.3.cmml"><mo id="algorithm2.11.11.m1.1.2.3.3.2.1" stretchy="false" xref="algorithm2.11.11.m1.1.2.3.cmml">(</mo><mi id="algorithm2.11.11.m1.1.1" xref="algorithm2.11.11.m1.1.1.cmml">e</mi><mo id="algorithm2.11.11.m1.1.2.3.3.2.2" stretchy="false" xref="algorithm2.11.11.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.m1.1b"><apply id="algorithm2.11.11.m1.1.2.cmml" xref="algorithm2.11.11.m1.1.2"><eq id="algorithm2.11.11.m1.1.2.1.cmml" xref="algorithm2.11.11.m1.1.2.1"></eq><apply id="algorithm2.11.11.m1.1.2.2.cmml" xref="algorithm2.11.11.m1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.11.11.m1.1.2.2.1.cmml" xref="algorithm2.11.11.m1.1.2.2">subscript</csymbol><ci id="algorithm2.11.11.m1.1.2.2.2.cmml" xref="algorithm2.11.11.m1.1.2.2.2">𝜆</ci><ci id="algorithm2.11.11.m1.1.2.2.3.cmml" xref="algorithm2.11.11.m1.1.2.2.3">𝑒</ci></apply><apply id="algorithm2.11.11.m1.1.2.3.cmml" xref="algorithm2.11.11.m1.1.2.3"><times id="algorithm2.11.11.m1.1.2.3.1.cmml" xref="algorithm2.11.11.m1.1.2.3.1"></times><ci id="algorithm2.11.11.m1.1.2.3.2.cmml" xref="algorithm2.11.11.m1.1.2.3.2">𝐺</ci><ci id="algorithm2.11.11.m1.1.1.cmml" xref="algorithm2.11.11.m1.1.1">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.m1.1c">\lambda_{e}=G(e)</annotation><annotation encoding="application/x-llamapun" id="algorithm2.11.11.m1.1d">italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = italic_G ( italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.12.12">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Extract <math alttext="\mathcal{S}_{\lambda_{e}}=\{(x_{j},y_{j},\lambda_{j})|\lambda_{j}=\lambda_{e}\}" class="ltx_Math" display="inline" id="algorithm2.12.12.m1.2"><semantics id="algorithm2.12.12.m1.2a"><mrow id="algorithm2.12.12.m1.2.2" xref="algorithm2.12.12.m1.2.2.cmml"><msub id="algorithm2.12.12.m1.2.2.4" xref="algorithm2.12.12.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.12.12.m1.2.2.4.2" xref="algorithm2.12.12.m1.2.2.4.2.cmml">𝒮</mi><msub id="algorithm2.12.12.m1.2.2.4.3" xref="algorithm2.12.12.m1.2.2.4.3.cmml"><mi id="algorithm2.12.12.m1.2.2.4.3.2" xref="algorithm2.12.12.m1.2.2.4.3.2.cmml">λ</mi><mi id="algorithm2.12.12.m1.2.2.4.3.3" xref="algorithm2.12.12.m1.2.2.4.3.3.cmml">e</mi></msub></msub><mo id="algorithm2.12.12.m1.2.2.3" xref="algorithm2.12.12.m1.2.2.3.cmml">=</mo><mrow id="algorithm2.12.12.m1.2.2.2.2" xref="algorithm2.12.12.m1.2.2.2.3.cmml"><mo id="algorithm2.12.12.m1.2.2.2.2.3" stretchy="false" xref="algorithm2.12.12.m1.2.2.2.3.1.cmml">{</mo><mrow id="algorithm2.12.12.m1.1.1.1.1.1.3" xref="algorithm2.12.12.m1.1.1.1.1.1.4.cmml"><mo id="algorithm2.12.12.m1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm2.12.12.m1.1.1.1.1.1.4.cmml">(</mo><msub id="algorithm2.12.12.m1.1.1.1.1.1.1.1" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="algorithm2.12.12.m1.1.1.1.1.1.3.5" xref="algorithm2.12.12.m1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm2.12.12.m1.1.1.1.1.1.2.2" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.1.2.2.2" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm2.12.12.m1.1.1.1.1.1.2.2.3" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm2.12.12.m1.1.1.1.1.1.3.6" xref="algorithm2.12.12.m1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm2.12.12.m1.1.1.1.1.1.3.3" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3.cmml"><mi id="algorithm2.12.12.m1.1.1.1.1.1.3.3.2" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm2.12.12.m1.1.1.1.1.1.3.3.3" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm2.12.12.m1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm2.12.12.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm2.12.12.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm2.12.12.m1.2.2.2.3.1.cmml">|</mo><mrow id="algorithm2.12.12.m1.2.2.2.2.2" xref="algorithm2.12.12.m1.2.2.2.2.2.cmml"><msub id="algorithm2.12.12.m1.2.2.2.2.2.2" xref="algorithm2.12.12.m1.2.2.2.2.2.2.cmml"><mi id="algorithm2.12.12.m1.2.2.2.2.2.2.2" xref="algorithm2.12.12.m1.2.2.2.2.2.2.2.cmml">λ</mi><mi id="algorithm2.12.12.m1.2.2.2.2.2.2.3" xref="algorithm2.12.12.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm2.12.12.m1.2.2.2.2.2.1" xref="algorithm2.12.12.m1.2.2.2.2.2.1.cmml">=</mo><msub id="algorithm2.12.12.m1.2.2.2.2.2.3" xref="algorithm2.12.12.m1.2.2.2.2.2.3.cmml"><mi id="algorithm2.12.12.m1.2.2.2.2.2.3.2" xref="algorithm2.12.12.m1.2.2.2.2.2.3.2.cmml">λ</mi><mi id="algorithm2.12.12.m1.2.2.2.2.2.3.3" xref="algorithm2.12.12.m1.2.2.2.2.2.3.3.cmml">e</mi></msub></mrow><mo id="algorithm2.12.12.m1.2.2.2.2.5" stretchy="false" xref="algorithm2.12.12.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.m1.2b"><apply id="algorithm2.12.12.m1.2.2.cmml" xref="algorithm2.12.12.m1.2.2"><eq id="algorithm2.12.12.m1.2.2.3.cmml" xref="algorithm2.12.12.m1.2.2.3"></eq><apply id="algorithm2.12.12.m1.2.2.4.cmml" xref="algorithm2.12.12.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.2.2.4.1.cmml" xref="algorithm2.12.12.m1.2.2.4">subscript</csymbol><ci id="algorithm2.12.12.m1.2.2.4.2.cmml" xref="algorithm2.12.12.m1.2.2.4.2">𝒮</ci><apply id="algorithm2.12.12.m1.2.2.4.3.cmml" xref="algorithm2.12.12.m1.2.2.4.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.2.2.4.3.1.cmml" xref="algorithm2.12.12.m1.2.2.4.3">subscript</csymbol><ci id="algorithm2.12.12.m1.2.2.4.3.2.cmml" xref="algorithm2.12.12.m1.2.2.4.3.2">𝜆</ci><ci id="algorithm2.12.12.m1.2.2.4.3.3.cmml" xref="algorithm2.12.12.m1.2.2.4.3.3">𝑒</ci></apply></apply><apply id="algorithm2.12.12.m1.2.2.2.3.cmml" xref="algorithm2.12.12.m1.2.2.2.2"><csymbol cd="latexml" id="algorithm2.12.12.m1.2.2.2.3.1.cmml" xref="algorithm2.12.12.m1.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm2.12.12.m1.1.1.1.1.1.4.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.3"><apply id="algorithm2.12.12.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm2.12.12.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm2.12.12.m1.1.1.1.1.1.2.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.1.1.1.1.1.2.2.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm2.12.12.m1.1.1.1.1.1.2.2.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm2.12.12.m1.1.1.1.1.1.2.2.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm2.12.12.m1.1.1.1.1.1.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.1.1.1.1.1.3.3.1.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm2.12.12.m1.1.1.1.1.1.3.3.2.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm2.12.12.m1.1.1.1.1.1.3.3.3.cmml" xref="algorithm2.12.12.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm2.12.12.m1.2.2.2.2.2.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2"><eq id="algorithm2.12.12.m1.2.2.2.2.2.1.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.1"></eq><apply id="algorithm2.12.12.m1.2.2.2.2.2.2.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.2.2.2.2.2.2.1.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm2.12.12.m1.2.2.2.2.2.2.2.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.2.2">𝜆</ci><ci id="algorithm2.12.12.m1.2.2.2.2.2.2.3.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="algorithm2.12.12.m1.2.2.2.2.2.3.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm2.12.12.m1.2.2.2.2.2.3.1.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.3">subscript</csymbol><ci id="algorithm2.12.12.m1.2.2.2.2.2.3.2.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.3.2">𝜆</ci><ci id="algorithm2.12.12.m1.2.2.2.2.2.3.3.cmml" xref="algorithm2.12.12.m1.2.2.2.2.2.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.m1.2c">\mathcal{S}_{\lambda_{e}}=\{(x_{j},y_{j},\lambda_{j})|\lambda_{j}=\lambda_{e}\}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.12.12.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.13.13">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Gather new training set <math alttext="\mathcal{D}_{e}=\mathcal{S}_{\lambda_{e}}\cup\mathcal{D}_{\text{nh}}\cup%
\mathcal{D}_{\text{h}}" class="ltx_Math" display="inline" id="algorithm2.13.13.m1.1"><semantics id="algorithm2.13.13.m1.1a"><mrow id="algorithm2.13.13.m1.1.1" xref="algorithm2.13.13.m1.1.1.cmml"><msub id="algorithm2.13.13.m1.1.1.2" xref="algorithm2.13.13.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.13.13.m1.1.1.2.2" xref="algorithm2.13.13.m1.1.1.2.2.cmml">𝒟</mi><mi id="algorithm2.13.13.m1.1.1.2.3" xref="algorithm2.13.13.m1.1.1.2.3.cmml">e</mi></msub><mo id="algorithm2.13.13.m1.1.1.1" xref="algorithm2.13.13.m1.1.1.1.cmml">=</mo><mrow id="algorithm2.13.13.m1.1.1.3" xref="algorithm2.13.13.m1.1.1.3.cmml"><msub id="algorithm2.13.13.m1.1.1.3.2" xref="algorithm2.13.13.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.13.13.m1.1.1.3.2.2" xref="algorithm2.13.13.m1.1.1.3.2.2.cmml">𝒮</mi><msub id="algorithm2.13.13.m1.1.1.3.2.3" xref="algorithm2.13.13.m1.1.1.3.2.3.cmml"><mi id="algorithm2.13.13.m1.1.1.3.2.3.2" xref="algorithm2.13.13.m1.1.1.3.2.3.2.cmml">λ</mi><mi id="algorithm2.13.13.m1.1.1.3.2.3.3" xref="algorithm2.13.13.m1.1.1.3.2.3.3.cmml">e</mi></msub></msub><mo id="algorithm2.13.13.m1.1.1.3.1" xref="algorithm2.13.13.m1.1.1.3.1.cmml">∪</mo><msub id="algorithm2.13.13.m1.1.1.3.3" xref="algorithm2.13.13.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.13.13.m1.1.1.3.3.2" xref="algorithm2.13.13.m1.1.1.3.3.2.cmml">𝒟</mi><mtext id="algorithm2.13.13.m1.1.1.3.3.3" xref="algorithm2.13.13.m1.1.1.3.3.3a.cmml">nh</mtext></msub><mo id="algorithm2.13.13.m1.1.1.3.1a" xref="algorithm2.13.13.m1.1.1.3.1.cmml">∪</mo><msub id="algorithm2.13.13.m1.1.1.3.4" xref="algorithm2.13.13.m1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.13.13.m1.1.1.3.4.2" xref="algorithm2.13.13.m1.1.1.3.4.2.cmml">𝒟</mi><mtext id="algorithm2.13.13.m1.1.1.3.4.3" xref="algorithm2.13.13.m1.1.1.3.4.3a.cmml">h</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.m1.1b"><apply id="algorithm2.13.13.m1.1.1.cmml" xref="algorithm2.13.13.m1.1.1"><eq id="algorithm2.13.13.m1.1.1.1.cmml" xref="algorithm2.13.13.m1.1.1.1"></eq><apply id="algorithm2.13.13.m1.1.1.2.cmml" xref="algorithm2.13.13.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.13.13.m1.1.1.2.1.cmml" xref="algorithm2.13.13.m1.1.1.2">subscript</csymbol><ci id="algorithm2.13.13.m1.1.1.2.2.cmml" xref="algorithm2.13.13.m1.1.1.2.2">𝒟</ci><ci id="algorithm2.13.13.m1.1.1.2.3.cmml" xref="algorithm2.13.13.m1.1.1.2.3">𝑒</ci></apply><apply id="algorithm2.13.13.m1.1.1.3.cmml" xref="algorithm2.13.13.m1.1.1.3"><union id="algorithm2.13.13.m1.1.1.3.1.cmml" xref="algorithm2.13.13.m1.1.1.3.1"></union><apply id="algorithm2.13.13.m1.1.1.3.2.cmml" xref="algorithm2.13.13.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.13.13.m1.1.1.3.2.1.cmml" xref="algorithm2.13.13.m1.1.1.3.2">subscript</csymbol><ci id="algorithm2.13.13.m1.1.1.3.2.2.cmml" xref="algorithm2.13.13.m1.1.1.3.2.2">𝒮</ci><apply id="algorithm2.13.13.m1.1.1.3.2.3.cmml" xref="algorithm2.13.13.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm2.13.13.m1.1.1.3.2.3.1.cmml" xref="algorithm2.13.13.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm2.13.13.m1.1.1.3.2.3.2.cmml" xref="algorithm2.13.13.m1.1.1.3.2.3.2">𝜆</ci><ci id="algorithm2.13.13.m1.1.1.3.2.3.3.cmml" xref="algorithm2.13.13.m1.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="algorithm2.13.13.m1.1.1.3.3.cmml" xref="algorithm2.13.13.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.13.13.m1.1.1.3.3.1.cmml" xref="algorithm2.13.13.m1.1.1.3.3">subscript</csymbol><ci id="algorithm2.13.13.m1.1.1.3.3.2.cmml" xref="algorithm2.13.13.m1.1.1.3.3.2">𝒟</ci><ci id="algorithm2.13.13.m1.1.1.3.3.3a.cmml" xref="algorithm2.13.13.m1.1.1.3.3.3"><mtext id="algorithm2.13.13.m1.1.1.3.3.3.cmml" mathsize="70%" xref="algorithm2.13.13.m1.1.1.3.3.3">nh</mtext></ci></apply><apply id="algorithm2.13.13.m1.1.1.3.4.cmml" xref="algorithm2.13.13.m1.1.1.3.4"><csymbol cd="ambiguous" id="algorithm2.13.13.m1.1.1.3.4.1.cmml" xref="algorithm2.13.13.m1.1.1.3.4">subscript</csymbol><ci id="algorithm2.13.13.m1.1.1.3.4.2.cmml" xref="algorithm2.13.13.m1.1.1.3.4.2">𝒟</ci><ci id="algorithm2.13.13.m1.1.1.3.4.3a.cmml" xref="algorithm2.13.13.m1.1.1.3.4.3"><mtext id="algorithm2.13.13.m1.1.1.3.4.3.cmml" mathsize="70%" xref="algorithm2.13.13.m1.1.1.3.4.3">h</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.m1.1c">\mathcal{D}_{e}=\mathcal{S}_{\lambda_{e}}\cup\mathcal{D}_{\text{nh}}\cup%
\mathcal{D}_{\text{h}}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.13.13.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = caligraphic_S start_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∪ caligraphic_D start_POSTSUBSCRIPT nh end_POSTSUBSCRIPT ∪ caligraphic_D start_POSTSUBSCRIPT h end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.15.15">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Finetune the model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm2.14.14.m1.1"><semantics id="algorithm2.14.14.m1.1a"><msub id="algorithm2.14.14.m1.1.1" xref="algorithm2.14.14.m1.1.1.cmml"><mi id="algorithm2.14.14.m1.1.1.2" xref="algorithm2.14.14.m1.1.1.2.cmml">f</mi><mi id="algorithm2.14.14.m1.1.1.3" xref="algorithm2.14.14.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.m1.1b"><apply id="algorithm2.14.14.m1.1.1.cmml" xref="algorithm2.14.14.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.1.1.1.cmml" xref="algorithm2.14.14.m1.1.1">subscript</csymbol><ci id="algorithm2.14.14.m1.1.1.2.cmml" xref="algorithm2.14.14.m1.1.1.2">𝑓</ci><ci id="algorithm2.14.14.m1.1.1.3.cmml" xref="algorithm2.14.14.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.14.14.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathcal{D}_{e}" class="ltx_Math" display="inline" id="algorithm2.15.15.m2.1"><semantics id="algorithm2.15.15.m2.1a"><msub id="algorithm2.15.15.m2.1.1" xref="algorithm2.15.15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.15.15.m2.1.1.2" xref="algorithm2.15.15.m2.1.1.2.cmml">𝒟</mi><mi id="algorithm2.15.15.m2.1.1.3" xref="algorithm2.15.15.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.15.15.m2.1b"><apply id="algorithm2.15.15.m2.1.1.cmml" xref="algorithm2.15.15.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.15.15.m2.1.1.1.cmml" xref="algorithm2.15.15.m2.1.1">subscript</csymbol><ci id="algorithm2.15.15.m2.1.1.2.cmml" xref="algorithm2.15.15.m2.1.1.2">𝒟</ci><ci id="algorithm2.15.15.m2.1.1.3.cmml" xref="algorithm2.15.15.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.15.15.m2.1c">\mathcal{D}_{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.15.15.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.19.22">
<span class="ltx_tag ltx_tag_listingline">8</span> end for
</div>
<div class="ltx_listingline" id="algorithm2.16.16">
<span class="ltx_tag ltx_tag_listingline">9</span><span class="ltx_text ltx_font_bold" id="algorithm2.16.16.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm2.16.16.1"><math alttext="e&gt;E_{CL}\text{ and }e\leq E" class="ltx_Math" display="inline" id="algorithm2.16.16.1.m1.1"><semantics id="algorithm2.16.16.1.m1.1a"><mrow id="algorithm2.16.16.1.m1.1.1" xref="algorithm2.16.16.1.m1.1.1.cmml"><mi id="algorithm2.16.16.1.m1.1.1.2" xref="algorithm2.16.16.1.m1.1.1.2.cmml">e</mi><mo id="algorithm2.16.16.1.m1.1.1.3" xref="algorithm2.16.16.1.m1.1.1.3.cmml">&gt;</mo><mrow id="algorithm2.16.16.1.m1.1.1.4" xref="algorithm2.16.16.1.m1.1.1.4.cmml"><msub id="algorithm2.16.16.1.m1.1.1.4.2" xref="algorithm2.16.16.1.m1.1.1.4.2.cmml"><mi id="algorithm2.16.16.1.m1.1.1.4.2.2" xref="algorithm2.16.16.1.m1.1.1.4.2.2.cmml">E</mi><mrow id="algorithm2.16.16.1.m1.1.1.4.2.3" xref="algorithm2.16.16.1.m1.1.1.4.2.3.cmml"><mi id="algorithm2.16.16.1.m1.1.1.4.2.3.2" xref="algorithm2.16.16.1.m1.1.1.4.2.3.2.cmml">C</mi><mo id="algorithm2.16.16.1.m1.1.1.4.2.3.1" xref="algorithm2.16.16.1.m1.1.1.4.2.3.1.cmml">⁢</mo><mi id="algorithm2.16.16.1.m1.1.1.4.2.3.3" xref="algorithm2.16.16.1.m1.1.1.4.2.3.3.cmml">L</mi></mrow></msub><mo id="algorithm2.16.16.1.m1.1.1.4.1" xref="algorithm2.16.16.1.m1.1.1.4.1.cmml">⁢</mo><mtext class="ltx_mathvariant_italic" id="algorithm2.16.16.1.m1.1.1.4.3" xref="algorithm2.16.16.1.m1.1.1.4.3a.cmml"> and </mtext><mo id="algorithm2.16.16.1.m1.1.1.4.1a" xref="algorithm2.16.16.1.m1.1.1.4.1.cmml">⁢</mo><mi id="algorithm2.16.16.1.m1.1.1.4.4" xref="algorithm2.16.16.1.m1.1.1.4.4.cmml">e</mi></mrow><mo id="algorithm2.16.16.1.m1.1.1.5" xref="algorithm2.16.16.1.m1.1.1.5.cmml">≤</mo><mi id="algorithm2.16.16.1.m1.1.1.6" xref="algorithm2.16.16.1.m1.1.1.6.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.16.16.1.m1.1b"><apply id="algorithm2.16.16.1.m1.1.1.cmml" xref="algorithm2.16.16.1.m1.1.1"><and id="algorithm2.16.16.1.m1.1.1a.cmml" xref="algorithm2.16.16.1.m1.1.1"></and><apply id="algorithm2.16.16.1.m1.1.1b.cmml" xref="algorithm2.16.16.1.m1.1.1"><gt id="algorithm2.16.16.1.m1.1.1.3.cmml" xref="algorithm2.16.16.1.m1.1.1.3"></gt><ci id="algorithm2.16.16.1.m1.1.1.2.cmml" xref="algorithm2.16.16.1.m1.1.1.2">𝑒</ci><apply id="algorithm2.16.16.1.m1.1.1.4.cmml" xref="algorithm2.16.16.1.m1.1.1.4"><times id="algorithm2.16.16.1.m1.1.1.4.1.cmml" xref="algorithm2.16.16.1.m1.1.1.4.1"></times><apply id="algorithm2.16.16.1.m1.1.1.4.2.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.16.16.1.m1.1.1.4.2.1.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2">subscript</csymbol><ci id="algorithm2.16.16.1.m1.1.1.4.2.2.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2.2">𝐸</ci><apply id="algorithm2.16.16.1.m1.1.1.4.2.3.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2.3"><times id="algorithm2.16.16.1.m1.1.1.4.2.3.1.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2.3.1"></times><ci id="algorithm2.16.16.1.m1.1.1.4.2.3.2.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2.3.2">𝐶</ci><ci id="algorithm2.16.16.1.m1.1.1.4.2.3.3.cmml" xref="algorithm2.16.16.1.m1.1.1.4.2.3.3">𝐿</ci></apply></apply><ci id="algorithm2.16.16.1.m1.1.1.4.3a.cmml" xref="algorithm2.16.16.1.m1.1.1.4.3"><mtext class="ltx_mathvariant_italic" id="algorithm2.16.16.1.m1.1.1.4.3.cmml" xref="algorithm2.16.16.1.m1.1.1.4.3"> and </mtext></ci><ci id="algorithm2.16.16.1.m1.1.1.4.4.cmml" xref="algorithm2.16.16.1.m1.1.1.4.4">𝑒</ci></apply></apply><apply id="algorithm2.16.16.1.m1.1.1c.cmml" xref="algorithm2.16.16.1.m1.1.1"><leq id="algorithm2.16.16.1.m1.1.1.5.cmml" xref="algorithm2.16.16.1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2410.13674v1#algorithm2.16.16.1.m1.1.1.4.cmml" id="algorithm2.16.16.1.m1.1.1d.cmml" xref="algorithm2.16.16.1.m1.1.1"></share><ci id="algorithm2.16.16.1.m1.1.1.6.cmml" xref="algorithm2.16.16.1.m1.1.1.6">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.16.1.m1.1c">e&gt;E_{CL}\text{ and }e\leq E</annotation><annotation encoding="application/x-llamapun" id="algorithm2.16.16.1.m1.1d">italic_e &gt; italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT and italic_e ≤ italic_E</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm2.16.16.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm2.17.17">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Gather new training set <math alttext="\mathcal{D}_{e}=\mathcal{D}_{\text{nh}}\cup\mathcal{D}_{\text{h}}" class="ltx_Math" display="inline" id="algorithm2.17.17.m1.1"><semantics id="algorithm2.17.17.m1.1a"><mrow id="algorithm2.17.17.m1.1.1" xref="algorithm2.17.17.m1.1.1.cmml"><msub id="algorithm2.17.17.m1.1.1.2" xref="algorithm2.17.17.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.17.17.m1.1.1.2.2" xref="algorithm2.17.17.m1.1.1.2.2.cmml">𝒟</mi><mi id="algorithm2.17.17.m1.1.1.2.3" xref="algorithm2.17.17.m1.1.1.2.3.cmml">e</mi></msub><mo id="algorithm2.17.17.m1.1.1.1" xref="algorithm2.17.17.m1.1.1.1.cmml">=</mo><mrow id="algorithm2.17.17.m1.1.1.3" xref="algorithm2.17.17.m1.1.1.3.cmml"><msub id="algorithm2.17.17.m1.1.1.3.2" xref="algorithm2.17.17.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.17.17.m1.1.1.3.2.2" xref="algorithm2.17.17.m1.1.1.3.2.2.cmml">𝒟</mi><mtext id="algorithm2.17.17.m1.1.1.3.2.3" xref="algorithm2.17.17.m1.1.1.3.2.3a.cmml">nh</mtext></msub><mo id="algorithm2.17.17.m1.1.1.3.1" xref="algorithm2.17.17.m1.1.1.3.1.cmml">∪</mo><msub id="algorithm2.17.17.m1.1.1.3.3" xref="algorithm2.17.17.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.17.17.m1.1.1.3.3.2" xref="algorithm2.17.17.m1.1.1.3.3.2.cmml">𝒟</mi><mtext id="algorithm2.17.17.m1.1.1.3.3.3" xref="algorithm2.17.17.m1.1.1.3.3.3a.cmml">h</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.17.17.m1.1b"><apply id="algorithm2.17.17.m1.1.1.cmml" xref="algorithm2.17.17.m1.1.1"><eq id="algorithm2.17.17.m1.1.1.1.cmml" xref="algorithm2.17.17.m1.1.1.1"></eq><apply id="algorithm2.17.17.m1.1.1.2.cmml" xref="algorithm2.17.17.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.17.17.m1.1.1.2.1.cmml" xref="algorithm2.17.17.m1.1.1.2">subscript</csymbol><ci id="algorithm2.17.17.m1.1.1.2.2.cmml" xref="algorithm2.17.17.m1.1.1.2.2">𝒟</ci><ci id="algorithm2.17.17.m1.1.1.2.3.cmml" xref="algorithm2.17.17.m1.1.1.2.3">𝑒</ci></apply><apply id="algorithm2.17.17.m1.1.1.3.cmml" xref="algorithm2.17.17.m1.1.1.3"><union id="algorithm2.17.17.m1.1.1.3.1.cmml" xref="algorithm2.17.17.m1.1.1.3.1"></union><apply id="algorithm2.17.17.m1.1.1.3.2.cmml" xref="algorithm2.17.17.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.17.17.m1.1.1.3.2.1.cmml" xref="algorithm2.17.17.m1.1.1.3.2">subscript</csymbol><ci id="algorithm2.17.17.m1.1.1.3.2.2.cmml" xref="algorithm2.17.17.m1.1.1.3.2.2">𝒟</ci><ci id="algorithm2.17.17.m1.1.1.3.2.3a.cmml" xref="algorithm2.17.17.m1.1.1.3.2.3"><mtext id="algorithm2.17.17.m1.1.1.3.2.3.cmml" mathsize="70%" xref="algorithm2.17.17.m1.1.1.3.2.3">nh</mtext></ci></apply><apply id="algorithm2.17.17.m1.1.1.3.3.cmml" xref="algorithm2.17.17.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.17.17.m1.1.1.3.3.1.cmml" xref="algorithm2.17.17.m1.1.1.3.3">subscript</csymbol><ci id="algorithm2.17.17.m1.1.1.3.3.2.cmml" xref="algorithm2.17.17.m1.1.1.3.3.2">𝒟</ci><ci id="algorithm2.17.17.m1.1.1.3.3.3a.cmml" xref="algorithm2.17.17.m1.1.1.3.3.3"><mtext id="algorithm2.17.17.m1.1.1.3.3.3.cmml" mathsize="70%" xref="algorithm2.17.17.m1.1.1.3.3.3">h</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.17.17.m1.1c">\mathcal{D}_{e}=\mathcal{D}_{\text{nh}}\cup\mathcal{D}_{\text{h}}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.17.17.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = caligraphic_D start_POSTSUBSCRIPT nh end_POSTSUBSCRIPT ∪ caligraphic_D start_POSTSUBSCRIPT h end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.19.23">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm2.19.19">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Finetune the model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm2.18.18.m1.1"><semantics id="algorithm2.18.18.m1.1a"><msub id="algorithm2.18.18.m1.1.1" xref="algorithm2.18.18.m1.1.1.cmml"><mi id="algorithm2.18.18.m1.1.1.2" xref="algorithm2.18.18.m1.1.1.2.cmml">f</mi><mi id="algorithm2.18.18.m1.1.1.3" xref="algorithm2.18.18.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m1.1b"><apply id="algorithm2.18.18.m1.1.1.cmml" xref="algorithm2.18.18.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.1.1.1.cmml" xref="algorithm2.18.18.m1.1.1">subscript</csymbol><ci id="algorithm2.18.18.m1.1.1.2.cmml" xref="algorithm2.18.18.m1.1.1.2">𝑓</ci><ci id="algorithm2.18.18.m1.1.1.3.cmml" xref="algorithm2.18.18.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.18.18.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathcal{D}_{e}" class="ltx_Math" display="inline" id="algorithm2.19.19.m2.1"><semantics id="algorithm2.19.19.m2.1a"><msub id="algorithm2.19.19.m2.1.1" xref="algorithm2.19.19.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.19.19.m2.1.1.2" xref="algorithm2.19.19.m2.1.1.2.cmml">𝒟</mi><mi id="algorithm2.19.19.m2.1.1.3" xref="algorithm2.19.19.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.m2.1b"><apply id="algorithm2.19.19.m2.1.1.cmml" xref="algorithm2.19.19.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.19.19.m2.1.1.1.cmml" xref="algorithm2.19.19.m2.1.1">subscript</csymbol><ci id="algorithm2.19.19.m2.1.1.2.cmml" xref="algorithm2.19.19.m2.1.1.2">𝒟</ci><ci id="algorithm2.19.19.m2.1.1.3.cmml" xref="algorithm2.19.19.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.m2.1c">\mathcal{D}_{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm2.19.19.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm2.19.24">
<span class="ltx_tag ltx_tag_listingline">13</span> end for
</div>
<div class="ltx_listingline" id="algorithm2.19.25">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm2.22.1.1">Algorithm 2</span> </span>Training with <span class="ltx_text ltx_font_bold" id="algorithm2.23.2">non-adaptive</span> Curriculum strategy </figcaption>
</figure>
<figure class="ltx_float ltx_algorithm" id="algorithm3">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm3.28">
<div class="ltx_listingline" id="algorithm3.28.29">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="algorithm3.8.8">
<span class="ltx_text" id="algorithm3.8.8.1"><span class="ltx_text ltx_font_bold" id="algorithm3.8.8.1.1">Input:</span> </span>
Image guidance level <math alttext="\Lambda=\{\lambda_{i}|\lambda_{i}\in[0,1]\}" class="ltx_Math" display="inline" id="algorithm3.1.1.m1.4"><semantics id="algorithm3.1.1.m1.4a"><mrow id="algorithm3.1.1.m1.4.4" xref="algorithm3.1.1.m1.4.4.cmml"><mi id="algorithm3.1.1.m1.4.4.4" mathvariant="normal" xref="algorithm3.1.1.m1.4.4.4.cmml">Λ</mi><mo id="algorithm3.1.1.m1.4.4.3" xref="algorithm3.1.1.m1.4.4.3.cmml">=</mo><mrow id="algorithm3.1.1.m1.4.4.2.2" xref="algorithm3.1.1.m1.4.4.2.3.cmml"><mo id="algorithm3.1.1.m1.4.4.2.2.3" stretchy="false" xref="algorithm3.1.1.m1.4.4.2.3.1.cmml">{</mo><msub id="algorithm3.1.1.m1.3.3.1.1.1" xref="algorithm3.1.1.m1.3.3.1.1.1.cmml"><mi id="algorithm3.1.1.m1.3.3.1.1.1.2" xref="algorithm3.1.1.m1.3.3.1.1.1.2.cmml">λ</mi><mi id="algorithm3.1.1.m1.3.3.1.1.1.3" xref="algorithm3.1.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="algorithm3.1.1.m1.4.4.2.2.4" lspace="0em" rspace="0em" xref="algorithm3.1.1.m1.4.4.2.3.1.cmml">|</mo><mrow id="algorithm3.1.1.m1.4.4.2.2.2" xref="algorithm3.1.1.m1.4.4.2.2.2.cmml"><msub id="algorithm3.1.1.m1.4.4.2.2.2.2" xref="algorithm3.1.1.m1.4.4.2.2.2.2.cmml"><mi id="algorithm3.1.1.m1.4.4.2.2.2.2.2" xref="algorithm3.1.1.m1.4.4.2.2.2.2.2.cmml">λ</mi><mi id="algorithm3.1.1.m1.4.4.2.2.2.2.3" xref="algorithm3.1.1.m1.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="algorithm3.1.1.m1.4.4.2.2.2.1" xref="algorithm3.1.1.m1.4.4.2.2.2.1.cmml">∈</mo><mrow id="algorithm3.1.1.m1.4.4.2.2.2.3.2" xref="algorithm3.1.1.m1.4.4.2.2.2.3.1.cmml"><mo id="algorithm3.1.1.m1.4.4.2.2.2.3.2.1" stretchy="false" xref="algorithm3.1.1.m1.4.4.2.2.2.3.1.cmml">[</mo><mn id="algorithm3.1.1.m1.1.1" xref="algorithm3.1.1.m1.1.1.cmml">0</mn><mo id="algorithm3.1.1.m1.4.4.2.2.2.3.2.2" xref="algorithm3.1.1.m1.4.4.2.2.2.3.1.cmml">,</mo><mn id="algorithm3.1.1.m1.2.2" xref="algorithm3.1.1.m1.2.2.cmml">1</mn><mo id="algorithm3.1.1.m1.4.4.2.2.2.3.2.3" stretchy="false" xref="algorithm3.1.1.m1.4.4.2.2.2.3.1.cmml">]</mo></mrow></mrow><mo id="algorithm3.1.1.m1.4.4.2.2.5" stretchy="false" xref="algorithm3.1.1.m1.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.1.1.m1.4b"><apply id="algorithm3.1.1.m1.4.4.cmml" xref="algorithm3.1.1.m1.4.4"><eq id="algorithm3.1.1.m1.4.4.3.cmml" xref="algorithm3.1.1.m1.4.4.3"></eq><ci id="algorithm3.1.1.m1.4.4.4.cmml" xref="algorithm3.1.1.m1.4.4.4">Λ</ci><apply id="algorithm3.1.1.m1.4.4.2.3.cmml" xref="algorithm3.1.1.m1.4.4.2.2"><csymbol cd="latexml" id="algorithm3.1.1.m1.4.4.2.3.1.cmml" xref="algorithm3.1.1.m1.4.4.2.2.3">conditional-set</csymbol><apply id="algorithm3.1.1.m1.3.3.1.1.1.cmml" xref="algorithm3.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm3.1.1.m1.3.3.1.1.1.1.cmml" xref="algorithm3.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="algorithm3.1.1.m1.3.3.1.1.1.2.cmml" xref="algorithm3.1.1.m1.3.3.1.1.1.2">𝜆</ci><ci id="algorithm3.1.1.m1.3.3.1.1.1.3.cmml" xref="algorithm3.1.1.m1.3.3.1.1.1.3">𝑖</ci></apply><apply id="algorithm3.1.1.m1.4.4.2.2.2.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2"><in id="algorithm3.1.1.m1.4.4.2.2.2.1.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2.1"></in><apply id="algorithm3.1.1.m1.4.4.2.2.2.2.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm3.1.1.m1.4.4.2.2.2.2.1.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2.2">subscript</csymbol><ci id="algorithm3.1.1.m1.4.4.2.2.2.2.2.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2.2.2">𝜆</ci><ci id="algorithm3.1.1.m1.4.4.2.2.2.2.3.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2.2.3">𝑖</ci></apply><interval closure="closed" id="algorithm3.1.1.m1.4.4.2.2.2.3.1.cmml" xref="algorithm3.1.1.m1.4.4.2.2.2.3.2"><cn id="algorithm3.1.1.m1.1.1.cmml" type="integer" xref="algorithm3.1.1.m1.1.1">0</cn><cn id="algorithm3.1.1.m1.2.2.cmml" type="integer" xref="algorithm3.1.1.m1.2.2">1</cn></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.1.1.m1.4c">\Lambda=\{\lambda_{i}|\lambda_{i}\in[0,1]\}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.1.1.m1.4d">roman_Λ = { italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ [ 0 , 1 ] }</annotation></semantics></math>,
non-hard samples <math alttext="\mathcal{D}_{\text{nh}}=\{(x_{i},y_{i},\lambda_{i}=1)\}_{i=1}^{N}" class="ltx_Math" display="inline" id="algorithm3.2.2.m2.1"><semantics id="algorithm3.2.2.m2.1a"><mrow id="algorithm3.2.2.m2.1.1" xref="algorithm3.2.2.m2.1.1.cmml"><msub id="algorithm3.2.2.m2.1.1.3" xref="algorithm3.2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.2.2.m2.1.1.3.2" xref="algorithm3.2.2.m2.1.1.3.2.cmml">𝒟</mi><mtext id="algorithm3.2.2.m2.1.1.3.3" xref="algorithm3.2.2.m2.1.1.3.3a.cmml">nh</mtext></msub><mo id="algorithm3.2.2.m2.1.1.2" xref="algorithm3.2.2.m2.1.1.2.cmml">=</mo><msubsup id="algorithm3.2.2.m2.1.1.1" xref="algorithm3.2.2.m2.1.1.1.cmml"><mrow id="algorithm3.2.2.m2.1.1.1.1.1.1" xref="algorithm3.2.2.m2.1.1.1.1.1.2.cmml"><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.2" stretchy="false" xref="algorithm3.2.2.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.4" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.5" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">λ</mi><mi id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></msub></mrow><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.4" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.4.cmml">=</mo><mn id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.5" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.5.cmml">1</mn></mrow><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="algorithm3.2.2.m2.1.1.1.1.1.1.3" stretchy="false" xref="algorithm3.2.2.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm3.2.2.m2.1.1.1.1.3" xref="algorithm3.2.2.m2.1.1.1.1.3.cmml"><mi id="algorithm3.2.2.m2.1.1.1.1.3.2" xref="algorithm3.2.2.m2.1.1.1.1.3.2.cmml">i</mi><mo id="algorithm3.2.2.m2.1.1.1.1.3.1" xref="algorithm3.2.2.m2.1.1.1.1.3.1.cmml">=</mo><mn id="algorithm3.2.2.m2.1.1.1.1.3.3" xref="algorithm3.2.2.m2.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm3.2.2.m2.1.1.1.3" xref="algorithm3.2.2.m2.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.2.2.m2.1b"><apply id="algorithm3.2.2.m2.1.1.cmml" xref="algorithm3.2.2.m2.1.1"><eq id="algorithm3.2.2.m2.1.1.2.cmml" xref="algorithm3.2.2.m2.1.1.2"></eq><apply id="algorithm3.2.2.m2.1.1.3.cmml" xref="algorithm3.2.2.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm3.2.2.m2.1.1.3.1.cmml" xref="algorithm3.2.2.m2.1.1.3">subscript</csymbol><ci id="algorithm3.2.2.m2.1.1.3.2.cmml" xref="algorithm3.2.2.m2.1.1.3.2">𝒟</ci><ci id="algorithm3.2.2.m2.1.1.3.3a.cmml" xref="algorithm3.2.2.m2.1.1.3.3"><mtext id="algorithm3.2.2.m2.1.1.3.3.cmml" mathsize="70%" xref="algorithm3.2.2.m2.1.1.3.3">nh</mtext></ci></apply><apply id="algorithm3.2.2.m2.1.1.1.cmml" xref="algorithm3.2.2.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm3.2.2.m2.1.1.1.2.cmml" xref="algorithm3.2.2.m2.1.1.1">superscript</csymbol><apply id="algorithm3.2.2.m2.1.1.1.1.cmml" xref="algorithm3.2.2.m2.1.1.1"><csymbol cd="ambiguous" id="algorithm3.2.2.m2.1.1.1.1.2.cmml" xref="algorithm3.2.2.m2.1.1.1">subscript</csymbol><set id="algorithm3.2.2.m2.1.1.1.1.1.2.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1"><apply id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1"><eq id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.4.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.4"></eq><list id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3"><apply id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.2">𝜆</ci><ci id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply></list><cn id="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.5.cmml" type="integer" xref="algorithm3.2.2.m2.1.1.1.1.1.1.1.1.1.5">1</cn></apply></set><apply id="algorithm3.2.2.m2.1.1.1.1.3.cmml" xref="algorithm3.2.2.m2.1.1.1.1.3"><eq id="algorithm3.2.2.m2.1.1.1.1.3.1.cmml" xref="algorithm3.2.2.m2.1.1.1.1.3.1"></eq><ci id="algorithm3.2.2.m2.1.1.1.1.3.2.cmml" xref="algorithm3.2.2.m2.1.1.1.1.3.2">𝑖</ci><cn id="algorithm3.2.2.m2.1.1.1.1.3.3.cmml" type="integer" xref="algorithm3.2.2.m2.1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm3.2.2.m2.1.1.1.3.cmml" xref="algorithm3.2.2.m2.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.2.2.m2.1c">\mathcal{D}_{\text{nh}}=\{(x_{i},y_{i},\lambda_{i}=1)\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT nh end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1 ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>,
spectrum of syn-to-real data <math alttext="\mathcal{S}=\{(x^{\prime}_{j},y_{j},\lambda_{j})|\lambda_{j}\in\Lambda\}_{j=1}%
^{M}" class="ltx_Math" display="inline" id="algorithm3.3.3.m3.2"><semantics id="algorithm3.3.3.m3.2a"><mrow id="algorithm3.3.3.m3.2.2" xref="algorithm3.3.3.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.3.3.m3.2.2.4" xref="algorithm3.3.3.m3.2.2.4.cmml">𝒮</mi><mo id="algorithm3.3.3.m3.2.2.3" xref="algorithm3.3.3.m3.2.2.3.cmml">=</mo><msubsup id="algorithm3.3.3.m3.2.2.2" xref="algorithm3.3.3.m3.2.2.2.cmml"><mrow id="algorithm3.3.3.m3.2.2.2.2.2.2" xref="algorithm3.3.3.m3.2.2.2.2.2.3.cmml"><mo id="algorithm3.3.3.m3.2.2.2.2.2.2.3" stretchy="false" xref="algorithm3.3.3.m3.2.2.2.2.2.3.1.cmml">{</mo><mrow id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.4.cmml"><mo id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.2" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.3" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.3" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.5" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.2" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.3" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.6" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.2" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.3" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm3.3.3.m3.2.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm3.3.3.m3.2.2.2.2.2.3.1.cmml">|</mo><mrow id="algorithm3.3.3.m3.2.2.2.2.2.2.2" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.cmml"><msub id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.cmml"><mi id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.2" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.2.cmml">λ</mi><mi id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.3" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm3.3.3.m3.2.2.2.2.2.2.2.1" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.1.cmml">∈</mo><mi id="algorithm3.3.3.m3.2.2.2.2.2.2.2.3" mathvariant="normal" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.3.cmml">Λ</mi></mrow><mo id="algorithm3.3.3.m3.2.2.2.2.2.2.5" stretchy="false" xref="algorithm3.3.3.m3.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="algorithm3.3.3.m3.2.2.2.2.4" xref="algorithm3.3.3.m3.2.2.2.2.4.cmml"><mi id="algorithm3.3.3.m3.2.2.2.2.4.2" xref="algorithm3.3.3.m3.2.2.2.2.4.2.cmml">j</mi><mo id="algorithm3.3.3.m3.2.2.2.2.4.1" xref="algorithm3.3.3.m3.2.2.2.2.4.1.cmml">=</mo><mn id="algorithm3.3.3.m3.2.2.2.2.4.3" xref="algorithm3.3.3.m3.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="algorithm3.3.3.m3.2.2.2.4" xref="algorithm3.3.3.m3.2.2.2.4.cmml">M</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.3.3.m3.2b"><apply id="algorithm3.3.3.m3.2.2.cmml" xref="algorithm3.3.3.m3.2.2"><eq id="algorithm3.3.3.m3.2.2.3.cmml" xref="algorithm3.3.3.m3.2.2.3"></eq><ci id="algorithm3.3.3.m3.2.2.4.cmml" xref="algorithm3.3.3.m3.2.2.4">𝒮</ci><apply id="algorithm3.3.3.m3.2.2.2.cmml" xref="algorithm3.3.3.m3.2.2.2"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.2.2.2.3.cmml" xref="algorithm3.3.3.m3.2.2.2">superscript</csymbol><apply id="algorithm3.3.3.m3.2.2.2.2.cmml" xref="algorithm3.3.3.m3.2.2.2"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.2.2.2.2.3.cmml" xref="algorithm3.3.3.m3.2.2.2">subscript</csymbol><apply id="algorithm3.3.3.m3.2.2.2.2.2.3.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2"><csymbol cd="latexml" id="algorithm3.3.3.m3.2.2.2.2.2.3.1.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm3.3.3.m3.1.1.1.1.1.1.1.4.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3"><apply id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm3.3.3.m3.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm3.3.3.m3.2.2.2.2.2.2.2.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2"><in id="algorithm3.3.3.m3.2.2.2.2.2.2.2.1.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.1"></in><apply id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.2">𝜆</ci><ci id="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="algorithm3.3.3.m3.2.2.2.2.2.2.2.3.cmml" xref="algorithm3.3.3.m3.2.2.2.2.2.2.2.3">Λ</ci></apply></apply><apply id="algorithm3.3.3.m3.2.2.2.2.4.cmml" xref="algorithm3.3.3.m3.2.2.2.2.4"><eq id="algorithm3.3.3.m3.2.2.2.2.4.1.cmml" xref="algorithm3.3.3.m3.2.2.2.2.4.1"></eq><ci id="algorithm3.3.3.m3.2.2.2.2.4.2.cmml" xref="algorithm3.3.3.m3.2.2.2.2.4.2">𝑗</ci><cn id="algorithm3.3.3.m3.2.2.2.2.4.3.cmml" type="integer" xref="algorithm3.3.3.m3.2.2.2.2.4.3">1</cn></apply></apply><ci id="algorithm3.3.3.m3.2.2.2.4.cmml" xref="algorithm3.3.3.m3.2.2.2.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.3.3.m3.2c">\mathcal{S}=\{(x^{\prime}_{j},y_{j},\lambda_{j})|\lambda_{j}\in\Lambda\}_{j=1}%
^{M}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.3.3.m3.2d">caligraphic_S = { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ roman_Λ } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math>,
original training data <math alttext="\mathcal{D}_{\text{all}}=\mathcal{D}_{\text{nh}}\cup\{(x^{\prime}_{j},y_{j},%
\lambda_{j})|\lambda_{j}=1\}" class="ltx_Math" display="inline" id="algorithm3.4.4.m4.2"><semantics id="algorithm3.4.4.m4.2a"><mrow id="algorithm3.4.4.m4.2.2" xref="algorithm3.4.4.m4.2.2.cmml"><msub id="algorithm3.4.4.m4.2.2.4" xref="algorithm3.4.4.m4.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.4.4.m4.2.2.4.2" xref="algorithm3.4.4.m4.2.2.4.2.cmml">𝒟</mi><mtext id="algorithm3.4.4.m4.2.2.4.3" xref="algorithm3.4.4.m4.2.2.4.3a.cmml">all</mtext></msub><mo id="algorithm3.4.4.m4.2.2.3" xref="algorithm3.4.4.m4.2.2.3.cmml">=</mo><mrow id="algorithm3.4.4.m4.2.2.2" xref="algorithm3.4.4.m4.2.2.2.cmml"><msub id="algorithm3.4.4.m4.2.2.2.4" xref="algorithm3.4.4.m4.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.4.4.m4.2.2.2.4.2" xref="algorithm3.4.4.m4.2.2.2.4.2.cmml">𝒟</mi><mtext id="algorithm3.4.4.m4.2.2.2.4.3" xref="algorithm3.4.4.m4.2.2.2.4.3a.cmml">nh</mtext></msub><mo id="algorithm3.4.4.m4.2.2.2.3" xref="algorithm3.4.4.m4.2.2.2.3.cmml">∪</mo><mrow id="algorithm3.4.4.m4.2.2.2.2.2" xref="algorithm3.4.4.m4.2.2.2.2.3.cmml"><mo id="algorithm3.4.4.m4.2.2.2.2.2.3" stretchy="false" xref="algorithm3.4.4.m4.2.2.2.2.3.1.cmml">{</mo><mrow id="algorithm3.4.4.m4.1.1.1.1.1.1.3" xref="algorithm3.4.4.m4.1.1.1.1.1.1.4.cmml"><mo id="algorithm3.4.4.m4.1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm3.4.4.m4.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.2" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.3" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.3" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm3.4.4.m4.1.1.1.1.1.1.3.5" xref="algorithm3.4.4.m4.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.2" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.3" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm3.4.4.m4.1.1.1.1.1.1.3.6" xref="algorithm3.4.4.m4.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.2" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.3" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm3.4.4.m4.1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm3.4.4.m4.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm3.4.4.m4.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm3.4.4.m4.2.2.2.2.3.1.cmml">|</mo><mrow id="algorithm3.4.4.m4.2.2.2.2.2.2" xref="algorithm3.4.4.m4.2.2.2.2.2.2.cmml"><msub id="algorithm3.4.4.m4.2.2.2.2.2.2.2" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2.cmml"><mi id="algorithm3.4.4.m4.2.2.2.2.2.2.2.2" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2.2.cmml">λ</mi><mi id="algorithm3.4.4.m4.2.2.2.2.2.2.2.3" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm3.4.4.m4.2.2.2.2.2.2.1" xref="algorithm3.4.4.m4.2.2.2.2.2.2.1.cmml">=</mo><mn id="algorithm3.4.4.m4.2.2.2.2.2.2.3" xref="algorithm3.4.4.m4.2.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="algorithm3.4.4.m4.2.2.2.2.2.5" stretchy="false" xref="algorithm3.4.4.m4.2.2.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.4.4.m4.2b"><apply id="algorithm3.4.4.m4.2.2.cmml" xref="algorithm3.4.4.m4.2.2"><eq id="algorithm3.4.4.m4.2.2.3.cmml" xref="algorithm3.4.4.m4.2.2.3"></eq><apply id="algorithm3.4.4.m4.2.2.4.cmml" xref="algorithm3.4.4.m4.2.2.4"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.2.2.4.1.cmml" xref="algorithm3.4.4.m4.2.2.4">subscript</csymbol><ci id="algorithm3.4.4.m4.2.2.4.2.cmml" xref="algorithm3.4.4.m4.2.2.4.2">𝒟</ci><ci id="algorithm3.4.4.m4.2.2.4.3a.cmml" xref="algorithm3.4.4.m4.2.2.4.3"><mtext id="algorithm3.4.4.m4.2.2.4.3.cmml" mathsize="70%" xref="algorithm3.4.4.m4.2.2.4.3">all</mtext></ci></apply><apply id="algorithm3.4.4.m4.2.2.2.cmml" xref="algorithm3.4.4.m4.2.2.2"><union id="algorithm3.4.4.m4.2.2.2.3.cmml" xref="algorithm3.4.4.m4.2.2.2.3"></union><apply id="algorithm3.4.4.m4.2.2.2.4.cmml" xref="algorithm3.4.4.m4.2.2.2.4"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.2.2.2.4.1.cmml" xref="algorithm3.4.4.m4.2.2.2.4">subscript</csymbol><ci id="algorithm3.4.4.m4.2.2.2.4.2.cmml" xref="algorithm3.4.4.m4.2.2.2.4.2">𝒟</ci><ci id="algorithm3.4.4.m4.2.2.2.4.3a.cmml" xref="algorithm3.4.4.m4.2.2.2.4.3"><mtext id="algorithm3.4.4.m4.2.2.2.4.3.cmml" mathsize="70%" xref="algorithm3.4.4.m4.2.2.2.4.3">nh</mtext></ci></apply><apply id="algorithm3.4.4.m4.2.2.2.2.3.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2"><csymbol cd="latexml" id="algorithm3.4.4.m4.2.2.2.2.3.1.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm3.4.4.m4.1.1.1.1.1.1.4.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3"><apply id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm3.4.4.m4.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm3.4.4.m4.2.2.2.2.2.2.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.2"><eq id="algorithm3.4.4.m4.2.2.2.2.2.2.1.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.2.1"></eq><apply id="algorithm3.4.4.m4.2.2.2.2.2.2.2.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm3.4.4.m4.2.2.2.2.2.2.2.1.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm3.4.4.m4.2.2.2.2.2.2.2.2.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2.2">𝜆</ci><ci id="algorithm3.4.4.m4.2.2.2.2.2.2.2.3.cmml" xref="algorithm3.4.4.m4.2.2.2.2.2.2.2.3">𝑗</ci></apply><cn id="algorithm3.4.4.m4.2.2.2.2.2.2.3.cmml" type="integer" xref="algorithm3.4.4.m4.2.2.2.2.2.2.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.4.4.m4.2c">\mathcal{D}_{\text{all}}=\mathcal{D}_{\text{nh}}\cup\{(x^{\prime}_{j},y_{j},%
\lambda_{j})|\lambda_{j}=1\}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.4.4.m4.2d">caligraphic_D start_POSTSUBSCRIPT all end_POSTSUBSCRIPT = caligraphic_D start_POSTSUBSCRIPT nh end_POSTSUBSCRIPT ∪ { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = 1 }</annotation></semantics></math>,
guidance validation set <math alttext="S=\{(x^{\prime}_{j},y_{j},\lambda_{j})|\lambda_{j}\in\Lambda\}_{j=1}^{m}" class="ltx_Math" display="inline" id="algorithm3.5.5.m5.2"><semantics id="algorithm3.5.5.m5.2a"><mrow id="algorithm3.5.5.m5.2.2" xref="algorithm3.5.5.m5.2.2.cmml"><mi id="algorithm3.5.5.m5.2.2.4" xref="algorithm3.5.5.m5.2.2.4.cmml">S</mi><mo id="algorithm3.5.5.m5.2.2.3" xref="algorithm3.5.5.m5.2.2.3.cmml">=</mo><msubsup id="algorithm3.5.5.m5.2.2.2" xref="algorithm3.5.5.m5.2.2.2.cmml"><mrow id="algorithm3.5.5.m5.2.2.2.2.2.2" xref="algorithm3.5.5.m5.2.2.2.2.2.3.cmml"><mo id="algorithm3.5.5.m5.2.2.2.2.2.2.3" stretchy="false" xref="algorithm3.5.5.m5.2.2.2.2.2.3.1.cmml">{</mo><mrow id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.4.cmml"><mo id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.2" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.3" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mo id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.3" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msubsup><mo id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.5" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.cmml"><mi id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.2" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.3" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.6" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.cmml"><mi id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.2" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.3" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm3.5.5.m5.2.2.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm3.5.5.m5.2.2.2.2.2.3.1.cmml">|</mo><mrow id="algorithm3.5.5.m5.2.2.2.2.2.2.2" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.cmml"><msub id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.cmml"><mi id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.2" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.2.cmml">λ</mi><mi id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.3" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm3.5.5.m5.2.2.2.2.2.2.2.1" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.1.cmml">∈</mo><mi id="algorithm3.5.5.m5.2.2.2.2.2.2.2.3" mathvariant="normal" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.3.cmml">Λ</mi></mrow><mo id="algorithm3.5.5.m5.2.2.2.2.2.2.5" stretchy="false" xref="algorithm3.5.5.m5.2.2.2.2.2.3.1.cmml">}</mo></mrow><mrow id="algorithm3.5.5.m5.2.2.2.2.4" xref="algorithm3.5.5.m5.2.2.2.2.4.cmml"><mi id="algorithm3.5.5.m5.2.2.2.2.4.2" xref="algorithm3.5.5.m5.2.2.2.2.4.2.cmml">j</mi><mo id="algorithm3.5.5.m5.2.2.2.2.4.1" xref="algorithm3.5.5.m5.2.2.2.2.4.1.cmml">=</mo><mn id="algorithm3.5.5.m5.2.2.2.2.4.3" xref="algorithm3.5.5.m5.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="algorithm3.5.5.m5.2.2.2.4" xref="algorithm3.5.5.m5.2.2.2.4.cmml">m</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.5.5.m5.2b"><apply id="algorithm3.5.5.m5.2.2.cmml" xref="algorithm3.5.5.m5.2.2"><eq id="algorithm3.5.5.m5.2.2.3.cmml" xref="algorithm3.5.5.m5.2.2.3"></eq><ci id="algorithm3.5.5.m5.2.2.4.cmml" xref="algorithm3.5.5.m5.2.2.4">𝑆</ci><apply id="algorithm3.5.5.m5.2.2.2.cmml" xref="algorithm3.5.5.m5.2.2.2"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.2.2.2.3.cmml" xref="algorithm3.5.5.m5.2.2.2">superscript</csymbol><apply id="algorithm3.5.5.m5.2.2.2.2.cmml" xref="algorithm3.5.5.m5.2.2.2"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.2.2.2.2.3.cmml" xref="algorithm3.5.5.m5.2.2.2">subscript</csymbol><apply id="algorithm3.5.5.m5.2.2.2.2.2.3.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2"><csymbol cd="latexml" id="algorithm3.5.5.m5.2.2.2.2.2.3.1.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm3.5.5.m5.1.1.1.1.1.1.1.4.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3"><apply id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm3.5.5.m5.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm3.5.5.m5.2.2.2.2.2.2.2.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2"><in id="algorithm3.5.5.m5.2.2.2.2.2.2.2.1.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.1"></in><apply id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.1.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.2.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.2">𝜆</ci><ci id="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.3.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="algorithm3.5.5.m5.2.2.2.2.2.2.2.3.cmml" xref="algorithm3.5.5.m5.2.2.2.2.2.2.2.3">Λ</ci></apply></apply><apply id="algorithm3.5.5.m5.2.2.2.2.4.cmml" xref="algorithm3.5.5.m5.2.2.2.2.4"><eq id="algorithm3.5.5.m5.2.2.2.2.4.1.cmml" xref="algorithm3.5.5.m5.2.2.2.2.4.1"></eq><ci id="algorithm3.5.5.m5.2.2.2.2.4.2.cmml" xref="algorithm3.5.5.m5.2.2.2.2.4.2">𝑗</ci><cn id="algorithm3.5.5.m5.2.2.2.2.4.3.cmml" type="integer" xref="algorithm3.5.5.m5.2.2.2.2.4.3">1</cn></apply></apply><ci id="algorithm3.5.5.m5.2.2.2.4.cmml" xref="algorithm3.5.5.m5.2.2.2.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.5.5.m5.2c">S=\{(x^{\prime}_{j},y_{j},\lambda_{j})|\lambda_{j}\in\Lambda\}_{j=1}^{m}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.5.5.m5.2d">italic_S = { ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ roman_Λ } start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT</annotation></semantics></math>,
train epochs <math alttext="E" class="ltx_Math" display="inline" id="algorithm3.6.6.m6.1"><semantics id="algorithm3.6.6.m6.1a"><mi id="algorithm3.6.6.m6.1.1" xref="algorithm3.6.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm3.6.6.m6.1b"><ci id="algorithm3.6.6.m6.1.1.cmml" xref="algorithm3.6.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.6.6.m6.1c">E</annotation><annotation encoding="application/x-llamapun" id="algorithm3.6.6.m6.1d">italic_E</annotation></semantics></math>,
curriculum epoch <math alttext="E_{CL}" class="ltx_Math" display="inline" id="algorithm3.7.7.m7.1"><semantics id="algorithm3.7.7.m7.1a"><msub id="algorithm3.7.7.m7.1.1" xref="algorithm3.7.7.m7.1.1.cmml"><mi id="algorithm3.7.7.m7.1.1.2" xref="algorithm3.7.7.m7.1.1.2.cmml">E</mi><mrow id="algorithm3.7.7.m7.1.1.3" xref="algorithm3.7.7.m7.1.1.3.cmml"><mi id="algorithm3.7.7.m7.1.1.3.2" xref="algorithm3.7.7.m7.1.1.3.2.cmml">C</mi><mo id="algorithm3.7.7.m7.1.1.3.1" xref="algorithm3.7.7.m7.1.1.3.1.cmml">⁢</mo><mi id="algorithm3.7.7.m7.1.1.3.3" xref="algorithm3.7.7.m7.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm3.7.7.m7.1b"><apply id="algorithm3.7.7.m7.1.1.cmml" xref="algorithm3.7.7.m7.1.1"><csymbol cd="ambiguous" id="algorithm3.7.7.m7.1.1.1.cmml" xref="algorithm3.7.7.m7.1.1">subscript</csymbol><ci id="algorithm3.7.7.m7.1.1.2.cmml" xref="algorithm3.7.7.m7.1.1.2">𝐸</ci><apply id="algorithm3.7.7.m7.1.1.3.cmml" xref="algorithm3.7.7.m7.1.1.3"><times id="algorithm3.7.7.m7.1.1.3.1.cmml" xref="algorithm3.7.7.m7.1.1.3.1"></times><ci id="algorithm3.7.7.m7.1.1.3.2.cmml" xref="algorithm3.7.7.m7.1.1.3.2">𝐶</ci><ci id="algorithm3.7.7.m7.1.1.3.3.cmml" xref="algorithm3.7.7.m7.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.7.7.m7.1c">E_{CL}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.7.7.m7.1d">italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math>,
size of real-random set <math alttext="|D|" class="ltx_Math" display="inline" id="algorithm3.8.8.m8.1"><semantics id="algorithm3.8.8.m8.1a"><mrow id="algorithm3.8.8.m8.1.2.2" xref="algorithm3.8.8.m8.1.2.1.cmml"><mo id="algorithm3.8.8.m8.1.2.2.1" stretchy="false" xref="algorithm3.8.8.m8.1.2.1.1.cmml">|</mo><mi id="algorithm3.8.8.m8.1.1" xref="algorithm3.8.8.m8.1.1.cmml">D</mi><mo id="algorithm3.8.8.m8.1.2.2.2" stretchy="false" xref="algorithm3.8.8.m8.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.8.8.m8.1b"><apply id="algorithm3.8.8.m8.1.2.1.cmml" xref="algorithm3.8.8.m8.1.2.2"><abs id="algorithm3.8.8.m8.1.2.1.1.cmml" xref="algorithm3.8.8.m8.1.2.2.1"></abs><ci id="algorithm3.8.8.m8.1.1.cmml" xref="algorithm3.8.8.m8.1.1">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.8.8.m8.1c">|D|</annotation><annotation encoding="application/x-llamapun" id="algorithm3.8.8.m8.1d">| italic_D |</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="algorithm3.9.9">
<span class="ltx_text" id="algorithm3.9.9.1"><span class="ltx_text ltx_font_bold" id="algorithm3.9.9.1.1">Output:</span> </span>trained model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm3.9.9.m1.1"><semantics id="algorithm3.9.9.m1.1a"><msub id="algorithm3.9.9.m1.1.1" xref="algorithm3.9.9.m1.1.1.cmml"><mi id="algorithm3.9.9.m1.1.1.2" xref="algorithm3.9.9.m1.1.1.2.cmml">f</mi><mi id="algorithm3.9.9.m1.1.1.3" xref="algorithm3.9.9.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.9.9.m1.1b"><apply id="algorithm3.9.9.m1.1.1.cmml" xref="algorithm3.9.9.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.9.9.m1.1.1.1.cmml" xref="algorithm3.9.9.m1.1.1">subscript</csymbol><ci id="algorithm3.9.9.m1.1.1.2.cmml" xref="algorithm3.9.9.m1.1.1.2">𝑓</ci><ci id="algorithm3.9.9.m1.1.1.3.cmml" xref="algorithm3.9.9.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.9.9.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.9.9.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.10.10">
<span class="ltx_text" id="algorithm3.10.10.1"><span class="ltx_text ltx_font_bold" id="algorithm3.10.10.1.1">Initialize:</span> </span>pretrained model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm3.10.10.m1.1"><semantics id="algorithm3.10.10.m1.1a"><msub id="algorithm3.10.10.m1.1.1" xref="algorithm3.10.10.m1.1.1.cmml"><mi id="algorithm3.10.10.m1.1.1.2" xref="algorithm3.10.10.m1.1.1.2.cmml">f</mi><mi id="algorithm3.10.10.m1.1.1.3" xref="algorithm3.10.10.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.10.10.m1.1b"><apply id="algorithm3.10.10.m1.1.1.cmml" xref="algorithm3.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.10.10.m1.1.1.1.cmml" xref="algorithm3.10.10.m1.1.1">subscript</csymbol><ci id="algorithm3.10.10.m1.1.1.2.cmml" xref="algorithm3.10.10.m1.1.1.2">𝑓</ci><ci id="algorithm3.10.10.m1.1.1.3.cmml" xref="algorithm3.10.10.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.10.10.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.10.10.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.28.30">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="algorithm3.11.11">
<span class="ltx_tag ltx_tag_listingline">3</span><span class="ltx_text ltx_font_bold" id="algorithm3.11.11.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm3.11.11.1"><math alttext="e\leq E_{CL}" class="ltx_Math" display="inline" id="algorithm3.11.11.1.m1.1"><semantics id="algorithm3.11.11.1.m1.1a"><mrow id="algorithm3.11.11.1.m1.1.1" xref="algorithm3.11.11.1.m1.1.1.cmml"><mi id="algorithm3.11.11.1.m1.1.1.2" xref="algorithm3.11.11.1.m1.1.1.2.cmml">e</mi><mo id="algorithm3.11.11.1.m1.1.1.1" xref="algorithm3.11.11.1.m1.1.1.1.cmml">≤</mo><msub id="algorithm3.11.11.1.m1.1.1.3" xref="algorithm3.11.11.1.m1.1.1.3.cmml"><mi id="algorithm3.11.11.1.m1.1.1.3.2" xref="algorithm3.11.11.1.m1.1.1.3.2.cmml">E</mi><mrow id="algorithm3.11.11.1.m1.1.1.3.3" xref="algorithm3.11.11.1.m1.1.1.3.3.cmml"><mi id="algorithm3.11.11.1.m1.1.1.3.3.2" xref="algorithm3.11.11.1.m1.1.1.3.3.2.cmml">C</mi><mo id="algorithm3.11.11.1.m1.1.1.3.3.1" xref="algorithm3.11.11.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm3.11.11.1.m1.1.1.3.3.3" xref="algorithm3.11.11.1.m1.1.1.3.3.3.cmml">L</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.11.11.1.m1.1b"><apply id="algorithm3.11.11.1.m1.1.1.cmml" xref="algorithm3.11.11.1.m1.1.1"><leq id="algorithm3.11.11.1.m1.1.1.1.cmml" xref="algorithm3.11.11.1.m1.1.1.1"></leq><ci id="algorithm3.11.11.1.m1.1.1.2.cmml" xref="algorithm3.11.11.1.m1.1.1.2">𝑒</ci><apply id="algorithm3.11.11.1.m1.1.1.3.cmml" xref="algorithm3.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.11.11.1.m1.1.1.3.1.cmml" xref="algorithm3.11.11.1.m1.1.1.3">subscript</csymbol><ci id="algorithm3.11.11.1.m1.1.1.3.2.cmml" xref="algorithm3.11.11.1.m1.1.1.3.2">𝐸</ci><apply id="algorithm3.11.11.1.m1.1.1.3.3.cmml" xref="algorithm3.11.11.1.m1.1.1.3.3"><times id="algorithm3.11.11.1.m1.1.1.3.3.1.cmml" xref="algorithm3.11.11.1.m1.1.1.3.3.1"></times><ci id="algorithm3.11.11.1.m1.1.1.3.3.2.cmml" xref="algorithm3.11.11.1.m1.1.1.3.3.2">𝐶</ci><ci id="algorithm3.11.11.1.m1.1.1.3.3.3.cmml" xref="algorithm3.11.11.1.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.11.11.1.m1.1c">e\leq E_{CL}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.11.11.1.m1.1d">italic_e ≤ italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm3.11.11.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm3.13.13">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate probability <math alttext="p_{\text{bef}}" class="ltx_Math" display="inline" id="algorithm3.12.12.m1.1"><semantics id="algorithm3.12.12.m1.1a"><msub id="algorithm3.12.12.m1.1.1" xref="algorithm3.12.12.m1.1.1.cmml"><mi id="algorithm3.12.12.m1.1.1.2" xref="algorithm3.12.12.m1.1.1.2.cmml">p</mi><mtext id="algorithm3.12.12.m1.1.1.3" xref="algorithm3.12.12.m1.1.1.3a.cmml">bef</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm3.12.12.m1.1b"><apply id="algorithm3.12.12.m1.1.1.cmml" xref="algorithm3.12.12.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.12.12.m1.1.1.1.cmml" xref="algorithm3.12.12.m1.1.1">subscript</csymbol><ci id="algorithm3.12.12.m1.1.1.2.cmml" xref="algorithm3.12.12.m1.1.1.2">𝑝</ci><ci id="algorithm3.12.12.m1.1.1.3a.cmml" xref="algorithm3.12.12.m1.1.1.3"><mtext id="algorithm3.12.12.m1.1.1.3.cmml" mathsize="70%" xref="algorithm3.12.12.m1.1.1.3">bef</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.12.12.m1.1c">p_{\text{bef}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.12.12.m1.1d">italic_p start_POSTSUBSCRIPT bef end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="S" class="ltx_Math" display="inline" id="algorithm3.13.13.m2.1"><semantics id="algorithm3.13.13.m2.1a"><mi id="algorithm3.13.13.m2.1.1" xref="algorithm3.13.13.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm3.13.13.m2.1b"><ci id="algorithm3.13.13.m2.1.1.cmml" xref="algorithm3.13.13.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.13.13.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="algorithm3.13.13.m2.1d">italic_S</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.15.15">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sample real-random set <math alttext="D" class="ltx_Math" display="inline" id="algorithm3.14.14.m1.1"><semantics id="algorithm3.14.14.m1.1a"><mi id="algorithm3.14.14.m1.1.1" xref="algorithm3.14.14.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="algorithm3.14.14.m1.1b"><ci id="algorithm3.14.14.m1.1.1.cmml" xref="algorithm3.14.14.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.14.14.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="algorithm3.14.14.m1.1d">italic_D</annotation></semantics></math> from <math alttext="\mathcal{D}_{\text{all}}" class="ltx_Math" display="inline" id="algorithm3.15.15.m2.1"><semantics id="algorithm3.15.15.m2.1a"><msub id="algorithm3.15.15.m2.1.1" xref="algorithm3.15.15.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.15.15.m2.1.1.2" xref="algorithm3.15.15.m2.1.1.2.cmml">𝒟</mi><mtext id="algorithm3.15.15.m2.1.1.3" xref="algorithm3.15.15.m2.1.1.3a.cmml">all</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm3.15.15.m2.1b"><apply id="algorithm3.15.15.m2.1.1.cmml" xref="algorithm3.15.15.m2.1.1"><csymbol cd="ambiguous" id="algorithm3.15.15.m2.1.1.1.cmml" xref="algorithm3.15.15.m2.1.1">subscript</csymbol><ci id="algorithm3.15.15.m2.1.1.2.cmml" xref="algorithm3.15.15.m2.1.1.2">𝒟</ci><ci id="algorithm3.15.15.m2.1.1.3a.cmml" xref="algorithm3.15.15.m2.1.1.3"><mtext id="algorithm3.15.15.m2.1.1.3.cmml" mathsize="70%" xref="algorithm3.15.15.m2.1.1.3">all</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.15.15.m2.1c">\mathcal{D}_{\text{all}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.15.15.m2.1d">caligraphic_D start_POSTSUBSCRIPT all end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.17.17">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Training model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm3.16.16.m1.1"><semantics id="algorithm3.16.16.m1.1a"><msub id="algorithm3.16.16.m1.1.1" xref="algorithm3.16.16.m1.1.1.cmml"><mi id="algorithm3.16.16.m1.1.1.2" xref="algorithm3.16.16.m1.1.1.2.cmml">f</mi><mi id="algorithm3.16.16.m1.1.1.3" xref="algorithm3.16.16.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.16.16.m1.1b"><apply id="algorithm3.16.16.m1.1.1.cmml" xref="algorithm3.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.16.16.m1.1.1.1.cmml" xref="algorithm3.16.16.m1.1.1">subscript</csymbol><ci id="algorithm3.16.16.m1.1.1.2.cmml" xref="algorithm3.16.16.m1.1.1.2">𝑓</ci><ci id="algorithm3.16.16.m1.1.1.3.cmml" xref="algorithm3.16.16.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.16.16.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.16.16.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="D" class="ltx_Math" display="inline" id="algorithm3.17.17.m2.1"><semantics id="algorithm3.17.17.m2.1a"><mi id="algorithm3.17.17.m2.1.1" xref="algorithm3.17.17.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="algorithm3.17.17.m2.1b"><ci id="algorithm3.17.17.m2.1.1.cmml" xref="algorithm3.17.17.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.17.17.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="algorithm3.17.17.m2.1d">italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.19.19">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate probability <math alttext="p_{\text{aft}}" class="ltx_Math" display="inline" id="algorithm3.18.18.m1.1"><semantics id="algorithm3.18.18.m1.1a"><msub id="algorithm3.18.18.m1.1.1" xref="algorithm3.18.18.m1.1.1.cmml"><mi id="algorithm3.18.18.m1.1.1.2" xref="algorithm3.18.18.m1.1.1.2.cmml">p</mi><mtext id="algorithm3.18.18.m1.1.1.3" xref="algorithm3.18.18.m1.1.1.3a.cmml">aft</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm3.18.18.m1.1b"><apply id="algorithm3.18.18.m1.1.1.cmml" xref="algorithm3.18.18.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.18.18.m1.1.1.1.cmml" xref="algorithm3.18.18.m1.1.1">subscript</csymbol><ci id="algorithm3.18.18.m1.1.1.2.cmml" xref="algorithm3.18.18.m1.1.1.2">𝑝</ci><ci id="algorithm3.18.18.m1.1.1.3a.cmml" xref="algorithm3.18.18.m1.1.1.3"><mtext id="algorithm3.18.18.m1.1.1.3.cmml" mathsize="70%" xref="algorithm3.18.18.m1.1.1.3">aft</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.18.18.m1.1c">p_{\text{aft}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.18.18.m1.1d">italic_p start_POSTSUBSCRIPT aft end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="S" class="ltx_Math" display="inline" id="algorithm3.19.19.m2.1"><semantics id="algorithm3.19.19.m2.1a"><mi id="algorithm3.19.19.m2.1.1" xref="algorithm3.19.19.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="algorithm3.19.19.m2.1b"><ci id="algorithm3.19.19.m2.1.1.cmml" xref="algorithm3.19.19.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.19.19.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="algorithm3.19.19.m2.1d">italic_S</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.20.20">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\lambda_{e}\leftarrow\arg\max_{\lambda_{i}\in\Lambda}p_{\text{aft}}-p_{\text{%
bef}}" class="ltx_Math" display="inline" id="algorithm3.20.20.m1.1"><semantics id="algorithm3.20.20.m1.1a"><mrow id="algorithm3.20.20.m1.1.1" xref="algorithm3.20.20.m1.1.1.cmml"><msub id="algorithm3.20.20.m1.1.1.2" xref="algorithm3.20.20.m1.1.1.2.cmml"><mi id="algorithm3.20.20.m1.1.1.2.2" xref="algorithm3.20.20.m1.1.1.2.2.cmml">λ</mi><mi id="algorithm3.20.20.m1.1.1.2.3" xref="algorithm3.20.20.m1.1.1.2.3.cmml">e</mi></msub><mo id="algorithm3.20.20.m1.1.1.1" stretchy="false" xref="algorithm3.20.20.m1.1.1.1.cmml">←</mo><mrow id="algorithm3.20.20.m1.1.1.3" xref="algorithm3.20.20.m1.1.1.3.cmml"><mrow id="algorithm3.20.20.m1.1.1.3.2" xref="algorithm3.20.20.m1.1.1.3.2.cmml"><mi id="algorithm3.20.20.m1.1.1.3.2.1" xref="algorithm3.20.20.m1.1.1.3.2.1.cmml">arg</mi><mo id="algorithm3.20.20.m1.1.1.3.2a" lspace="0.167em" xref="algorithm3.20.20.m1.1.1.3.2.cmml">⁡</mo><mrow id="algorithm3.20.20.m1.1.1.3.2.2" xref="algorithm3.20.20.m1.1.1.3.2.2.cmml"><msub id="algorithm3.20.20.m1.1.1.3.2.2.1" xref="algorithm3.20.20.m1.1.1.3.2.2.1.cmml"><mi id="algorithm3.20.20.m1.1.1.3.2.2.1.2" xref="algorithm3.20.20.m1.1.1.3.2.2.1.2.cmml">max</mi><mrow id="algorithm3.20.20.m1.1.1.3.2.2.1.3" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.cmml"><msub id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.cmml"><mi id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.2" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.2.cmml">λ</mi><mi id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.3" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.3.cmml">i</mi></msub><mo id="algorithm3.20.20.m1.1.1.3.2.2.1.3.1" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.1.cmml">∈</mo><mi id="algorithm3.20.20.m1.1.1.3.2.2.1.3.3" mathvariant="normal" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.3.cmml">Λ</mi></mrow></msub><mo id="algorithm3.20.20.m1.1.1.3.2.2a" lspace="0.167em" xref="algorithm3.20.20.m1.1.1.3.2.2.cmml">⁡</mo><msub id="algorithm3.20.20.m1.1.1.3.2.2.2" xref="algorithm3.20.20.m1.1.1.3.2.2.2.cmml"><mi id="algorithm3.20.20.m1.1.1.3.2.2.2.2" xref="algorithm3.20.20.m1.1.1.3.2.2.2.2.cmml">p</mi><mtext id="algorithm3.20.20.m1.1.1.3.2.2.2.3" xref="algorithm3.20.20.m1.1.1.3.2.2.2.3a.cmml">aft</mtext></msub></mrow></mrow><mo id="algorithm3.20.20.m1.1.1.3.1" xref="algorithm3.20.20.m1.1.1.3.1.cmml">−</mo><msub id="algorithm3.20.20.m1.1.1.3.3" xref="algorithm3.20.20.m1.1.1.3.3.cmml"><mi id="algorithm3.20.20.m1.1.1.3.3.2" xref="algorithm3.20.20.m1.1.1.3.3.2.cmml">p</mi><mtext id="algorithm3.20.20.m1.1.1.3.3.3" xref="algorithm3.20.20.m1.1.1.3.3.3a.cmml">bef</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.20.20.m1.1b"><apply id="algorithm3.20.20.m1.1.1.cmml" xref="algorithm3.20.20.m1.1.1"><ci id="algorithm3.20.20.m1.1.1.1.cmml" xref="algorithm3.20.20.m1.1.1.1">←</ci><apply id="algorithm3.20.20.m1.1.1.2.cmml" xref="algorithm3.20.20.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.20.20.m1.1.1.2.1.cmml" xref="algorithm3.20.20.m1.1.1.2">subscript</csymbol><ci id="algorithm3.20.20.m1.1.1.2.2.cmml" xref="algorithm3.20.20.m1.1.1.2.2">𝜆</ci><ci id="algorithm3.20.20.m1.1.1.2.3.cmml" xref="algorithm3.20.20.m1.1.1.2.3">𝑒</ci></apply><apply id="algorithm3.20.20.m1.1.1.3.cmml" xref="algorithm3.20.20.m1.1.1.3"><minus id="algorithm3.20.20.m1.1.1.3.1.cmml" xref="algorithm3.20.20.m1.1.1.3.1"></minus><apply id="algorithm3.20.20.m1.1.1.3.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2"><arg id="algorithm3.20.20.m1.1.1.3.2.1.cmml" xref="algorithm3.20.20.m1.1.1.3.2.1"></arg><apply id="algorithm3.20.20.m1.1.1.3.2.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2"><apply id="algorithm3.20.20.m1.1.1.3.2.2.1.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1"><csymbol cd="ambiguous" id="algorithm3.20.20.m1.1.1.3.2.2.1.1.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1">subscript</csymbol><max id="algorithm3.20.20.m1.1.1.3.2.2.1.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.2"></max><apply id="algorithm3.20.20.m1.1.1.3.2.2.1.3.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3"><in id="algorithm3.20.20.m1.1.1.3.2.2.1.3.1.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.1"></in><apply id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2"><csymbol cd="ambiguous" id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.1.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2">subscript</csymbol><ci id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.2">𝜆</ci><ci id="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.3.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.2.3">𝑖</ci></apply><ci id="algorithm3.20.20.m1.1.1.3.2.2.1.3.3.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.1.3.3">Λ</ci></apply></apply><apply id="algorithm3.20.20.m1.1.1.3.2.2.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="algorithm3.20.20.m1.1.1.3.2.2.2.1.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.2">subscript</csymbol><ci id="algorithm3.20.20.m1.1.1.3.2.2.2.2.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.2.2">𝑝</ci><ci id="algorithm3.20.20.m1.1.1.3.2.2.2.3a.cmml" xref="algorithm3.20.20.m1.1.1.3.2.2.2.3"><mtext id="algorithm3.20.20.m1.1.1.3.2.2.2.3.cmml" mathsize="70%" xref="algorithm3.20.20.m1.1.1.3.2.2.2.3">aft</mtext></ci></apply></apply></apply><apply id="algorithm3.20.20.m1.1.1.3.3.cmml" xref="algorithm3.20.20.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.20.20.m1.1.1.3.3.1.cmml" xref="algorithm3.20.20.m1.1.1.3.3">subscript</csymbol><ci id="algorithm3.20.20.m1.1.1.3.3.2.cmml" xref="algorithm3.20.20.m1.1.1.3.3.2">𝑝</ci><ci id="algorithm3.20.20.m1.1.1.3.3.3a.cmml" xref="algorithm3.20.20.m1.1.1.3.3.3"><mtext id="algorithm3.20.20.m1.1.1.3.3.3.cmml" mathsize="70%" xref="algorithm3.20.20.m1.1.1.3.3.3">bef</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.20.20.m1.1c">\lambda_{e}\leftarrow\arg\max_{\lambda_{i}\in\Lambda}p_{\text{aft}}-p_{\text{%
bef}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.20.20.m1.1d">italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ← roman_arg roman_max start_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ roman_Λ end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT aft end_POSTSUBSCRIPT - italic_p start_POSTSUBSCRIPT bef end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.21.21">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Extract <math alttext="\mathcal{S}_{\lambda_{e}}=\{(x_{j},y_{j},\lambda_{j})|\lambda_{j}=\lambda_{e}\}" class="ltx_Math" display="inline" id="algorithm3.21.21.m1.2"><semantics id="algorithm3.21.21.m1.2a"><mrow id="algorithm3.21.21.m1.2.2" xref="algorithm3.21.21.m1.2.2.cmml"><msub id="algorithm3.21.21.m1.2.2.4" xref="algorithm3.21.21.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.21.21.m1.2.2.4.2" xref="algorithm3.21.21.m1.2.2.4.2.cmml">𝒮</mi><msub id="algorithm3.21.21.m1.2.2.4.3" xref="algorithm3.21.21.m1.2.2.4.3.cmml"><mi id="algorithm3.21.21.m1.2.2.4.3.2" xref="algorithm3.21.21.m1.2.2.4.3.2.cmml">λ</mi><mi id="algorithm3.21.21.m1.2.2.4.3.3" xref="algorithm3.21.21.m1.2.2.4.3.3.cmml">e</mi></msub></msub><mo id="algorithm3.21.21.m1.2.2.3" xref="algorithm3.21.21.m1.2.2.3.cmml">=</mo><mrow id="algorithm3.21.21.m1.2.2.2.2" xref="algorithm3.21.21.m1.2.2.2.3.cmml"><mo id="algorithm3.21.21.m1.2.2.2.2.3" stretchy="false" xref="algorithm3.21.21.m1.2.2.2.3.1.cmml">{</mo><mrow id="algorithm3.21.21.m1.1.1.1.1.1.3" xref="algorithm3.21.21.m1.1.1.1.1.1.4.cmml"><mo id="algorithm3.21.21.m1.1.1.1.1.1.3.4" stretchy="false" xref="algorithm3.21.21.m1.1.1.1.1.1.4.cmml">(</mo><msub id="algorithm3.21.21.m1.1.1.1.1.1.1.1" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1.cmml"><mi id="algorithm3.21.21.m1.1.1.1.1.1.1.1.2" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm3.21.21.m1.1.1.1.1.1.1.1.3" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="algorithm3.21.21.m1.1.1.1.1.1.3.5" xref="algorithm3.21.21.m1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.21.21.m1.1.1.1.1.1.2.2" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2.cmml"><mi id="algorithm3.21.21.m1.1.1.1.1.1.2.2.2" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="algorithm3.21.21.m1.1.1.1.1.1.2.2.3" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="algorithm3.21.21.m1.1.1.1.1.1.3.6" xref="algorithm3.21.21.m1.1.1.1.1.1.4.cmml">,</mo><msub id="algorithm3.21.21.m1.1.1.1.1.1.3.3" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3.cmml"><mi id="algorithm3.21.21.m1.1.1.1.1.1.3.3.2" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3.2.cmml">λ</mi><mi id="algorithm3.21.21.m1.1.1.1.1.1.3.3.3" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3.3.cmml">j</mi></msub><mo id="algorithm3.21.21.m1.1.1.1.1.1.3.7" stretchy="false" xref="algorithm3.21.21.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="algorithm3.21.21.m1.2.2.2.2.4" lspace="0em" rspace="0em" xref="algorithm3.21.21.m1.2.2.2.3.1.cmml">|</mo><mrow id="algorithm3.21.21.m1.2.2.2.2.2" xref="algorithm3.21.21.m1.2.2.2.2.2.cmml"><msub id="algorithm3.21.21.m1.2.2.2.2.2.2" xref="algorithm3.21.21.m1.2.2.2.2.2.2.cmml"><mi id="algorithm3.21.21.m1.2.2.2.2.2.2.2" xref="algorithm3.21.21.m1.2.2.2.2.2.2.2.cmml">λ</mi><mi id="algorithm3.21.21.m1.2.2.2.2.2.2.3" xref="algorithm3.21.21.m1.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="algorithm3.21.21.m1.2.2.2.2.2.1" xref="algorithm3.21.21.m1.2.2.2.2.2.1.cmml">=</mo><msub id="algorithm3.21.21.m1.2.2.2.2.2.3" xref="algorithm3.21.21.m1.2.2.2.2.2.3.cmml"><mi id="algorithm3.21.21.m1.2.2.2.2.2.3.2" xref="algorithm3.21.21.m1.2.2.2.2.2.3.2.cmml">λ</mi><mi id="algorithm3.21.21.m1.2.2.2.2.2.3.3" xref="algorithm3.21.21.m1.2.2.2.2.2.3.3.cmml">e</mi></msub></mrow><mo id="algorithm3.21.21.m1.2.2.2.2.5" stretchy="false" xref="algorithm3.21.21.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.21.21.m1.2b"><apply id="algorithm3.21.21.m1.2.2.cmml" xref="algorithm3.21.21.m1.2.2"><eq id="algorithm3.21.21.m1.2.2.3.cmml" xref="algorithm3.21.21.m1.2.2.3"></eq><apply id="algorithm3.21.21.m1.2.2.4.cmml" xref="algorithm3.21.21.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.2.2.4.1.cmml" xref="algorithm3.21.21.m1.2.2.4">subscript</csymbol><ci id="algorithm3.21.21.m1.2.2.4.2.cmml" xref="algorithm3.21.21.m1.2.2.4.2">𝒮</ci><apply id="algorithm3.21.21.m1.2.2.4.3.cmml" xref="algorithm3.21.21.m1.2.2.4.3"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.2.2.4.3.1.cmml" xref="algorithm3.21.21.m1.2.2.4.3">subscript</csymbol><ci id="algorithm3.21.21.m1.2.2.4.3.2.cmml" xref="algorithm3.21.21.m1.2.2.4.3.2">𝜆</ci><ci id="algorithm3.21.21.m1.2.2.4.3.3.cmml" xref="algorithm3.21.21.m1.2.2.4.3.3">𝑒</ci></apply></apply><apply id="algorithm3.21.21.m1.2.2.2.3.cmml" xref="algorithm3.21.21.m1.2.2.2.2"><csymbol cd="latexml" id="algorithm3.21.21.m1.2.2.2.3.1.cmml" xref="algorithm3.21.21.m1.2.2.2.2.3">conditional-set</csymbol><vector id="algorithm3.21.21.m1.1.1.1.1.1.4.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.3"><apply id="algorithm3.21.21.m1.1.1.1.1.1.1.1.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm3.21.21.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm3.21.21.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="algorithm3.21.21.m1.1.1.1.1.1.2.2.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.1.1.1.1.1.2.2.1.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algorithm3.21.21.m1.1.1.1.1.1.2.2.2.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="algorithm3.21.21.m1.1.1.1.1.1.2.2.3.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="algorithm3.21.21.m1.1.1.1.1.1.3.3.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.1.1.1.1.1.3.3.1.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="algorithm3.21.21.m1.1.1.1.1.1.3.3.2.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3.2">𝜆</ci><ci id="algorithm3.21.21.m1.1.1.1.1.1.3.3.3.cmml" xref="algorithm3.21.21.m1.1.1.1.1.1.3.3.3">𝑗</ci></apply></vector><apply id="algorithm3.21.21.m1.2.2.2.2.2.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2"><eq id="algorithm3.21.21.m1.2.2.2.2.2.1.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.1"></eq><apply id="algorithm3.21.21.m1.2.2.2.2.2.2.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.2.2.2.2.2.2.1.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm3.21.21.m1.2.2.2.2.2.2.2.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.2.2">𝜆</ci><ci id="algorithm3.21.21.m1.2.2.2.2.2.2.3.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.2.3">𝑗</ci></apply><apply id="algorithm3.21.21.m1.2.2.2.2.2.3.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="algorithm3.21.21.m1.2.2.2.2.2.3.1.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.3">subscript</csymbol><ci id="algorithm3.21.21.m1.2.2.2.2.2.3.2.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.3.2">𝜆</ci><ci id="algorithm3.21.21.m1.2.2.2.2.2.3.3.cmml" xref="algorithm3.21.21.m1.2.2.2.2.2.3.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.21.21.m1.2c">\mathcal{S}_{\lambda_{e}}=\{(x_{j},y_{j},\lambda_{j})|\lambda_{j}=\lambda_{e}\}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.21.21.m1.2d">caligraphic_S start_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT = { ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) | italic_λ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT }</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.22.22">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Generate new training set <math alttext="\mathcal{D}_{e}=\mathcal{S}_{\lambda_{e}}\cup\mathcal{D}_{\text{nl}}" class="ltx_Math" display="inline" id="algorithm3.22.22.m1.1"><semantics id="algorithm3.22.22.m1.1a"><mrow id="algorithm3.22.22.m1.1.1" xref="algorithm3.22.22.m1.1.1.cmml"><msub id="algorithm3.22.22.m1.1.1.2" xref="algorithm3.22.22.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.22.22.m1.1.1.2.2" xref="algorithm3.22.22.m1.1.1.2.2.cmml">𝒟</mi><mi id="algorithm3.22.22.m1.1.1.2.3" xref="algorithm3.22.22.m1.1.1.2.3.cmml">e</mi></msub><mo id="algorithm3.22.22.m1.1.1.1" xref="algorithm3.22.22.m1.1.1.1.cmml">=</mo><mrow id="algorithm3.22.22.m1.1.1.3" xref="algorithm3.22.22.m1.1.1.3.cmml"><msub id="algorithm3.22.22.m1.1.1.3.2" xref="algorithm3.22.22.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.22.22.m1.1.1.3.2.2" xref="algorithm3.22.22.m1.1.1.3.2.2.cmml">𝒮</mi><msub id="algorithm3.22.22.m1.1.1.3.2.3" xref="algorithm3.22.22.m1.1.1.3.2.3.cmml"><mi id="algorithm3.22.22.m1.1.1.3.2.3.2" xref="algorithm3.22.22.m1.1.1.3.2.3.2.cmml">λ</mi><mi id="algorithm3.22.22.m1.1.1.3.2.3.3" xref="algorithm3.22.22.m1.1.1.3.2.3.3.cmml">e</mi></msub></msub><mo id="algorithm3.22.22.m1.1.1.3.1" xref="algorithm3.22.22.m1.1.1.3.1.cmml">∪</mo><msub id="algorithm3.22.22.m1.1.1.3.3" xref="algorithm3.22.22.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.22.22.m1.1.1.3.3.2" xref="algorithm3.22.22.m1.1.1.3.3.2.cmml">𝒟</mi><mtext id="algorithm3.22.22.m1.1.1.3.3.3" xref="algorithm3.22.22.m1.1.1.3.3.3a.cmml">nl</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.22.22.m1.1b"><apply id="algorithm3.22.22.m1.1.1.cmml" xref="algorithm3.22.22.m1.1.1"><eq id="algorithm3.22.22.m1.1.1.1.cmml" xref="algorithm3.22.22.m1.1.1.1"></eq><apply id="algorithm3.22.22.m1.1.1.2.cmml" xref="algorithm3.22.22.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm3.22.22.m1.1.1.2.1.cmml" xref="algorithm3.22.22.m1.1.1.2">subscript</csymbol><ci id="algorithm3.22.22.m1.1.1.2.2.cmml" xref="algorithm3.22.22.m1.1.1.2.2">𝒟</ci><ci id="algorithm3.22.22.m1.1.1.2.3.cmml" xref="algorithm3.22.22.m1.1.1.2.3">𝑒</ci></apply><apply id="algorithm3.22.22.m1.1.1.3.cmml" xref="algorithm3.22.22.m1.1.1.3"><union id="algorithm3.22.22.m1.1.1.3.1.cmml" xref="algorithm3.22.22.m1.1.1.3.1"></union><apply id="algorithm3.22.22.m1.1.1.3.2.cmml" xref="algorithm3.22.22.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm3.22.22.m1.1.1.3.2.1.cmml" xref="algorithm3.22.22.m1.1.1.3.2">subscript</csymbol><ci id="algorithm3.22.22.m1.1.1.3.2.2.cmml" xref="algorithm3.22.22.m1.1.1.3.2.2">𝒮</ci><apply id="algorithm3.22.22.m1.1.1.3.2.3.cmml" xref="algorithm3.22.22.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="algorithm3.22.22.m1.1.1.3.2.3.1.cmml" xref="algorithm3.22.22.m1.1.1.3.2.3">subscript</csymbol><ci id="algorithm3.22.22.m1.1.1.3.2.3.2.cmml" xref="algorithm3.22.22.m1.1.1.3.2.3.2">𝜆</ci><ci id="algorithm3.22.22.m1.1.1.3.2.3.3.cmml" xref="algorithm3.22.22.m1.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="algorithm3.22.22.m1.1.1.3.3.cmml" xref="algorithm3.22.22.m1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm3.22.22.m1.1.1.3.3.1.cmml" xref="algorithm3.22.22.m1.1.1.3.3">subscript</csymbol><ci id="algorithm3.22.22.m1.1.1.3.3.2.cmml" xref="algorithm3.22.22.m1.1.1.3.3.2">𝒟</ci><ci id="algorithm3.22.22.m1.1.1.3.3.3a.cmml" xref="algorithm3.22.22.m1.1.1.3.3.3"><mtext id="algorithm3.22.22.m1.1.1.3.3.3.cmml" mathsize="70%" xref="algorithm3.22.22.m1.1.1.3.3.3">nl</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.22.22.m1.1c">\mathcal{D}_{e}=\mathcal{S}_{\lambda_{e}}\cup\mathcal{D}_{\text{nl}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.22.22.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT = caligraphic_S start_POSTSUBSCRIPT italic_λ start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∪ caligraphic_D start_POSTSUBSCRIPT nl end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.24.24">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Train the model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm3.23.23.m1.1"><semantics id="algorithm3.23.23.m1.1a"><msub id="algorithm3.23.23.m1.1.1" xref="algorithm3.23.23.m1.1.1.cmml"><mi id="algorithm3.23.23.m1.1.1.2" xref="algorithm3.23.23.m1.1.1.2.cmml">f</mi><mi id="algorithm3.23.23.m1.1.1.3" xref="algorithm3.23.23.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.23.23.m1.1b"><apply id="algorithm3.23.23.m1.1.1.cmml" xref="algorithm3.23.23.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.23.23.m1.1.1.1.cmml" xref="algorithm3.23.23.m1.1.1">subscript</csymbol><ci id="algorithm3.23.23.m1.1.1.2.cmml" xref="algorithm3.23.23.m1.1.1.2">𝑓</ci><ci id="algorithm3.23.23.m1.1.1.3.cmml" xref="algorithm3.23.23.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.23.23.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.23.23.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathcal{D}_{e}" class="ltx_Math" display="inline" id="algorithm3.24.24.m2.1"><semantics id="algorithm3.24.24.m2.1a"><msub id="algorithm3.24.24.m2.1.1" xref="algorithm3.24.24.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.24.24.m2.1.1.2" xref="algorithm3.24.24.m2.1.1.2.cmml">𝒟</mi><mi id="algorithm3.24.24.m2.1.1.3" xref="algorithm3.24.24.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.24.24.m2.1b"><apply id="algorithm3.24.24.m2.1.1.cmml" xref="algorithm3.24.24.m2.1.1"><csymbol cd="ambiguous" id="algorithm3.24.24.m2.1.1.1.cmml" xref="algorithm3.24.24.m2.1.1">subscript</csymbol><ci id="algorithm3.24.24.m2.1.1.2.cmml" xref="algorithm3.24.24.m2.1.1.2">𝒟</ci><ci id="algorithm3.24.24.m2.1.1.3.cmml" xref="algorithm3.24.24.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.24.24.m2.1c">\mathcal{D}_{e}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.24.24.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.28.31">
<span class="ltx_tag ltx_tag_listingline">12</span> end for
</div>
<div class="ltx_listingline" id="algorithm3.26.26">
<span class="ltx_tag ltx_tag_listingline">13</span><span class="ltx_text ltx_font_bold" id="algorithm3.26.26.3">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm3.26.26.2"><math alttext="e&gt;E_{CL}" class="ltx_Math" display="inline" id="algorithm3.25.25.1.m1.1"><semantics id="algorithm3.25.25.1.m1.1a"><mrow id="algorithm3.25.25.1.m1.1.1" xref="algorithm3.25.25.1.m1.1.1.cmml"><mi id="algorithm3.25.25.1.m1.1.1.2" xref="algorithm3.25.25.1.m1.1.1.2.cmml">e</mi><mo id="algorithm3.25.25.1.m1.1.1.1" xref="algorithm3.25.25.1.m1.1.1.1.cmml">&gt;</mo><msub id="algorithm3.25.25.1.m1.1.1.3" xref="algorithm3.25.25.1.m1.1.1.3.cmml"><mi id="algorithm3.25.25.1.m1.1.1.3.2" xref="algorithm3.25.25.1.m1.1.1.3.2.cmml">E</mi><mrow id="algorithm3.25.25.1.m1.1.1.3.3" xref="algorithm3.25.25.1.m1.1.1.3.3.cmml"><mi id="algorithm3.25.25.1.m1.1.1.3.3.2" xref="algorithm3.25.25.1.m1.1.1.3.3.2.cmml">C</mi><mo id="algorithm3.25.25.1.m1.1.1.3.3.1" xref="algorithm3.25.25.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm3.25.25.1.m1.1.1.3.3.3" xref="algorithm3.25.25.1.m1.1.1.3.3.3.cmml">L</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.25.25.1.m1.1b"><apply id="algorithm3.25.25.1.m1.1.1.cmml" xref="algorithm3.25.25.1.m1.1.1"><gt id="algorithm3.25.25.1.m1.1.1.1.cmml" xref="algorithm3.25.25.1.m1.1.1.1"></gt><ci id="algorithm3.25.25.1.m1.1.1.2.cmml" xref="algorithm3.25.25.1.m1.1.1.2">𝑒</ci><apply id="algorithm3.25.25.1.m1.1.1.3.cmml" xref="algorithm3.25.25.1.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm3.25.25.1.m1.1.1.3.1.cmml" xref="algorithm3.25.25.1.m1.1.1.3">subscript</csymbol><ci id="algorithm3.25.25.1.m1.1.1.3.2.cmml" xref="algorithm3.25.25.1.m1.1.1.3.2">𝐸</ci><apply id="algorithm3.25.25.1.m1.1.1.3.3.cmml" xref="algorithm3.25.25.1.m1.1.1.3.3"><times id="algorithm3.25.25.1.m1.1.1.3.3.1.cmml" xref="algorithm3.25.25.1.m1.1.1.3.3.1"></times><ci id="algorithm3.25.25.1.m1.1.1.3.3.2.cmml" xref="algorithm3.25.25.1.m1.1.1.3.3.2">𝐶</ci><ci id="algorithm3.25.25.1.m1.1.1.3.3.3.cmml" xref="algorithm3.25.25.1.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.25.25.1.m1.1c">e&gt;E_{CL}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.25.25.1.m1.1d">italic_e &gt; italic_E start_POSTSUBSCRIPT italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="e\leq E" class="ltx_Math" display="inline" id="algorithm3.26.26.2.m2.1"><semantics id="algorithm3.26.26.2.m2.1a"><mrow id="algorithm3.26.26.2.m2.1.1" xref="algorithm3.26.26.2.m2.1.1.cmml"><mi id="algorithm3.26.26.2.m2.1.1.2" xref="algorithm3.26.26.2.m2.1.1.2.cmml">e</mi><mo id="algorithm3.26.26.2.m2.1.1.1" xref="algorithm3.26.26.2.m2.1.1.1.cmml">≤</mo><mi id="algorithm3.26.26.2.m2.1.1.3" xref="algorithm3.26.26.2.m2.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm3.26.26.2.m2.1b"><apply id="algorithm3.26.26.2.m2.1.1.cmml" xref="algorithm3.26.26.2.m2.1.1"><leq id="algorithm3.26.26.2.m2.1.1.1.cmml" xref="algorithm3.26.26.2.m2.1.1.1"></leq><ci id="algorithm3.26.26.2.m2.1.1.2.cmml" xref="algorithm3.26.26.2.m2.1.1.2">𝑒</ci><ci id="algorithm3.26.26.2.m2.1.1.3.cmml" xref="algorithm3.26.26.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.26.26.2.m2.1c">e\leq E</annotation><annotation encoding="application/x-llamapun" id="algorithm3.26.26.2.m2.1d">italic_e ≤ italic_E</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm3.26.26.4">do</span>
</div>
<div class="ltx_listingline" id="algorithm3.28.28">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Train the model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="algorithm3.27.27.m1.1"><semantics id="algorithm3.27.27.m1.1a"><msub id="algorithm3.27.27.m1.1.1" xref="algorithm3.27.27.m1.1.1.cmml"><mi id="algorithm3.27.27.m1.1.1.2" xref="algorithm3.27.27.m1.1.1.2.cmml">f</mi><mi id="algorithm3.27.27.m1.1.1.3" xref="algorithm3.27.27.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm3.27.27.m1.1b"><apply id="algorithm3.27.27.m1.1.1.cmml" xref="algorithm3.27.27.m1.1.1"><csymbol cd="ambiguous" id="algorithm3.27.27.m1.1.1.1.cmml" xref="algorithm3.27.27.m1.1.1">subscript</csymbol><ci id="algorithm3.27.27.m1.1.1.2.cmml" xref="algorithm3.27.27.m1.1.1.2">𝑓</ci><ci id="algorithm3.27.27.m1.1.1.3.cmml" xref="algorithm3.27.27.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.27.27.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.27.27.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="\mathcal{D}_{\text{all}}" class="ltx_Math" display="inline" id="algorithm3.28.28.m2.1"><semantics id="algorithm3.28.28.m2.1a"><msub id="algorithm3.28.28.m2.1.1" xref="algorithm3.28.28.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm3.28.28.m2.1.1.2" xref="algorithm3.28.28.m2.1.1.2.cmml">𝒟</mi><mtext id="algorithm3.28.28.m2.1.1.3" xref="algorithm3.28.28.m2.1.1.3a.cmml">all</mtext></msub><annotation-xml encoding="MathML-Content" id="algorithm3.28.28.m2.1b"><apply id="algorithm3.28.28.m2.1.1.cmml" xref="algorithm3.28.28.m2.1.1"><csymbol cd="ambiguous" id="algorithm3.28.28.m2.1.1.1.cmml" xref="algorithm3.28.28.m2.1.1">subscript</csymbol><ci id="algorithm3.28.28.m2.1.1.2.cmml" xref="algorithm3.28.28.m2.1.1.2">𝒟</ci><ci id="algorithm3.28.28.m2.1.1.3a.cmml" xref="algorithm3.28.28.m2.1.1.3"><mtext id="algorithm3.28.28.m2.1.1.3.cmml" mathsize="70%" xref="algorithm3.28.28.m2.1.1.3">all</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm3.28.28.m2.1c">\mathcal{D}_{\text{all}}</annotation><annotation encoding="application/x-llamapun" id="algorithm3.28.28.m2.1d">caligraphic_D start_POSTSUBSCRIPT all end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm3.28.32">
<span class="ltx_tag ltx_tag_listingline">15</span> end for
</div>
<div class="ltx_listingline" id="algorithm3.28.33">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm3.31.1.1">Algorithm 3</span> </span>Training with <span class="ltx_text ltx_font_bold" id="algorithm3.32.2">adaptive</span> Curriculum strategy</figcaption>
</figure>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct 16 12:46:37 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
