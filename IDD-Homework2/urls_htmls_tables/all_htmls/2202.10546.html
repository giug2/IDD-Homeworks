<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2202.10546] Privacy Leakage of Adversarial Training Models in Federated Learning Systems</title><meta property="og:description" content="Adversarial Training (AT) is crucial for obtaining deep neural networks that are robust to adversarial attacks, yet recent works found that it could also make models more vulnerable to privacy attacks.
In this work, we…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Privacy Leakage of Adversarial Training Models in Federated Learning Systems">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Privacy Leakage of Adversarial Training Models in Federated Learning Systems">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2202.10546">

<!--Generated on Thu Mar  7 19:01:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Privacy Leakage of Adversarial Training Models in Federated Learning Systems</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jingyang Zhang, Yiran Chen, Hai Li
<br class="ltx_break">Department of Electrical and Computer Engineering, Duke University
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">jingyang.zhang@duke.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Adversarial Training (AT) is crucial for obtaining deep neural networks that are robust to adversarial attacks, yet recent works found that it could also make models more vulnerable to privacy attacks.
In this work, we further reveal this unsettling property of AT by designing a novel privacy attack that is practically applicable to the privacy-sensitive Federated Learning (FL) systems.
Using our method, the attacker can exploit AT models in the FL system to accurately reconstruct users’ private training images even when the training batch size is large.
Code is available at <a target="_blank" href="https://github.com/zjysteven/PrivayAttack_AT_FL" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/zjysteven/PrivayAttack_AT_FL</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Deep Neural Networks (DNNs) suffer from the notorious adversarial perturbations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>: These imperceptible noises could easily fool DNNs to yield wildly wrong and malicious decisions (<em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p1.1.2" class="ltx_text"></span>, misclassification with high confidence).
<span id="S1.p1.1.3" class="ltx_text ltx_font_italic">Adversarial Training</span> (AT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> has been one of the most effective techniques that mitigate such vulnerability, which withstands adaptive attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and leads to the highest empirical adversarial robustness to date <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
It is without doubt that AT is crucial for building robust intelligent systems.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Despite the desired robustness, recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> revealed an unexpected and alarming property of AT: It can make models more likely to leak the data privacy than the ones that undergoes vanilla training (<em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p2.1.2" class="ltx_text"></span>, using the original clean images instead of online-generated adversarial examples).
Specifically, Song <em id="S1.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> found that AT makes it easier for <span id="S1.p2.1.5" class="ltx_text ltx_font_italic">membership inference attack</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to succeed, which aims to identify whether a certain sample was used during the training.
In another work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, it is shown that <span id="S1.p2.1.6" class="ltx_text ltx_font_italic">model inversion attack</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is tractable on AT models, with which the attacker can generate images that visually resemble the actual training samples.
In all, both papers indicated that AT models exhibit a robustness-privacy trade-off.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2202.10546/assets/figures/overview.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="262" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">An overview of the proposed privacy attack against FL systems to “steal” the client’s training images. We formulate a novel two-step procedure: 1) Feature restoration from gradients (<a href="#S4.SS2" title="4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>) and 2) Image reconstruction from features (<a href="#S4.SS3" title="4.3 Image reconstruction from features ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.3</span></a>). Zoom in and also refer <a href="#S5.F5" title="In 5.3 Image reconstruction from features ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> to see image reconstruction quality.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we pursue this line of inquiry and further demonstrate such trade-off by presenting a novel privacy attack that exploits AT models.
Our attack is practically applicable to <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">Federated Learning</span> (FL) systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
The goal is to compromise the privacy of FL clients by reconstructing their own training images (which may contain private information) based on the weight gradients that are communicated between the clients and the central server.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Different from previous approaches that directly invert gradients to reconstruct images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, our attack methodology forms a unique two-step procedure, where we first restore the features (<em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p4.1.2" class="ltx_text"></span>, the outputs of the penultimate layer) from the gradients, and then reconstruct the inputs using the recovered features as supervision (see <a href="#S1.F1" title="In 1 Introduction ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a> for illustration).
The key insight behind our method is that while the gradients of the samples within a batch are fused together and prohibit accurate reconstruction of each individual input, the features are less coupled and (once restored) can provide more precise information for the reconstruction than the batch-averaged gradients.
Upon the general framework, the proposed attack leverages AT models which enable the success execution of both attack steps.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We conduct extensive experiments using high-resolution images from ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> to demonstrate how our privacy attack can work with AT models to compromise the privacy of FL clients.
Specifically, we are able to accurately reconstruct the clients’ training images at a large batch size (<em id="S1.p5.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S1.p5.1.2" class="ltx_text"></span>, 256), something that is not achieved by previous methods with vanilla models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
The results suggest that AT poses a risk to the expected-to-be-secure FL systems.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Privacy risks of AT models.</span>
As discussed earlier, a few prior works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> also identified that AT could make models more vulnerable to privacy attacks.
In comparison, our work focuses on a considerably more strict and challenging criterion of privacy leakage: We consider exact reconstruction of the training images owned by the victims, a scenario which we believe poses more severe risks than the attacks that synthesize human-recognizable images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> or infer the membership of data samples <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
Besides, we put ourselves in the realistic, privacy-sensitive FL setting, to which our attack is practically applicable.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Privacy attacks against FL systems.</span>
There has been a line of research trying to expose the privacy vulnerability of the FL systems.
Zhu <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> developed the seminal DLG attack which reconstructs input images by matching the gradients computed using the reconstructed ones and the real ones.
Geiping <em id="S2.p2.1.4" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.5" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> made improvements by using a better matching loss function and optimizer.
They achieved near-perfect recovery quality when the gradients are computed using a single image (<em id="S2.p2.1.6" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.p2.1.7" class="ltx_text"></span>, the batch size is 1).
More recently, Yin <em id="S2.p2.1.8" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.9" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> further incorporated advanced image priors as regularization to enhance the recover quality.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">All these works, however, can only unveil clear visual information under a small batch size (<em id="S2.p3.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p3.1.2" class="ltx_text"></span>, when the batch includes only a single or a few images), while a large batch size (<em id="S2.p3.1.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S2.p3.1.4" class="ltx_text"></span>, 128 or 256) is often required for effective and efficient training of DNNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
As a result, whether the privacy can really be compromised in realistic settings (<em id="S2.p3.1.5" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S2.p3.1.6" class="ltx_text"></span>, with large batch size) remains unclear.
In this paper, we show that the privacy of FL clients is indeed at risk if they are performing AT, as the attacker can leverage our attack and exploit AT models to achieve accurate reconstruction of users’ images even at a batch size of 256.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Inverting features to reconstruct images.</span>
Inverting the features has been studied as a way to understand/interpret what DNN models learn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.
In particular, Engstrom <em id="S2.p4.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p4.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> discovered that AT models are more “invertible” than vanilla models, as the reconstructed images from AT models’ features look much more plausible.
However, their focus is on the interpretability perspective.
In our work, we take the security perspective and demonstrate how the good “invertibility” of AT models can unexpectedly/undesirably enable a privacy attack.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Setting</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.10" class="ltx_p">We first formulate the problem setting and define the threat model before delving into our proposed attack.
In a FL system, in each step the client will receive a copy of the global model from the central server and perform local training.
Here, following prior works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, we focus on the case of single-step local training.
Concretely, considering an image classification task, the gradients of loss w.r.t. the model parameters are computed as follows during the local training:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\Delta_{\theta}\coloneqq\frac{1}{N}\sum_{i=1}^{N}\nabla_{\theta}\mathcal{L}(f_{\theta}(\bm{x}_{i}),y_{i})," display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.4.2.cmml">Δ</mi><mi id="S3.E1.m1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.4.3.cmml">θ</mi></msub><mo id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">≔</mo><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mfrac id="S3.E1.m1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.2.4.cmml"><mn id="S3.E1.m1.1.1.1.1.2.4.2" xref="S3.E1.m1.1.1.1.1.2.4.2.cmml">1</mn><mi id="S3.E1.m1.1.1.1.1.2.4.3" xref="S3.E1.m1.1.1.1.1.2.4.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><munderover id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.2.2.3.2.2" xref="S3.E1.m1.1.1.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.3.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.3.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.2.3.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.2.4.cmml"><msub id="S3.E1.m1.1.1.1.1.2.2.2.4.1" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="S3.E1.m1.1.1.1.1.2.2.2.4.1.2" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1.2.cmml">∇</mo><mi id="S3.E1.m1.1.1.1.1.2.2.2.4.1.3" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.2.2.4.2" xref="S3.E1.m1.1.1.1.1.2.2.2.4.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.5" xref="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">≔</ci><apply id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.4.2">Δ</ci><ci id="S3.E1.m1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3">𝜃</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><times id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"></times><apply id="S3.E1.m1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.4"><divide id="S3.E1.m1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4"></divide><cn type="integer" id="S3.E1.m1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2">1</cn><ci id="S3.E1.m1.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.1.1.1.1.2.4.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><apply id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.2.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3"><eq id="S3.E1.m1.1.1.1.1.2.2.3.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.3.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.2.2.3.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"><times id="S3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.3"></times><apply id="S3.E1.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.4"><apply id="S3.E1.m1.1.1.1.1.2.2.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.4.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.4.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1.2">∇</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.4.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.4.1.3">𝜃</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.4.2">ℒ</ci></apply><interval closure="open" id="S3.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\Delta_{\theta}\coloneqq\frac{1}{N}\sum_{i=1}^{N}\nabla_{\theta}\mathcal{L}(f_{\theta}(\bm{x}_{i}),y_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.9" class="ltx_p">where <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2" xref="S3.p1.1.m1.1.2.cmml"><msub id="S3.p1.1.m1.1.2.2" xref="S3.p1.1.m1.1.2.2.cmml"><mi id="S3.p1.1.m1.1.2.2.2" xref="S3.p1.1.m1.1.2.2.2.cmml">f</mi><mi id="S3.p1.1.m1.1.2.2.3" xref="S3.p1.1.m1.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.2.1" xref="S3.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.p1.1.m1.1.2.3.2" xref="S3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.p1.1.m1.1.2.3.2.1" xref="S3.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p1.1.m1.1.2.3.2.2" xref="S3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.2.cmml" xref="S3.p1.1.m1.1.2"><times id="S3.p1.1.m1.1.2.1.cmml" xref="S3.p1.1.m1.1.2.1"></times><apply id="S3.p1.1.m1.1.2.2.cmml" xref="S3.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.2.2.1.cmml" xref="S3.p1.1.m1.1.2.2">subscript</csymbol><ci id="S3.p1.1.m1.1.2.2.2.cmml" xref="S3.p1.1.m1.1.2.2.2">𝑓</ci><ci id="S3.p1.1.m1.1.2.2.3.cmml" xref="S3.p1.1.m1.1.2.2.3">𝜃</ci></apply><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">f_{\theta}(\cdot)</annotation></semantics></math> is the mapping function of the DNN model parameterized by <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\theta</annotation></semantics></math>, <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">N</annotation></semantics></math> is the batch size, <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\bm{x}_{i}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">𝒙</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝒙</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\bm{x}_{i}</annotation></semantics></math> is <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">i</annotation></semantics></math>-th input image of the batch, <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">y</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝑦</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">y_{i}</annotation></semantics></math> is the corresponding groundtruth label, <math id="S3.p1.7.m7.2" class="ltx_Math" alttext="\mathcal{L}(\cdot,\cdot)" display="inline"><semantics id="S3.p1.7.m7.2a"><mrow id="S3.p1.7.m7.2.3" xref="S3.p1.7.m7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.2.3.2" xref="S3.p1.7.m7.2.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.2.3.1" xref="S3.p1.7.m7.2.3.1.cmml">​</mo><mrow id="S3.p1.7.m7.2.3.3.2" xref="S3.p1.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="S3.p1.7.m7.2.3.3.2.1" xref="S3.p1.7.m7.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.p1.7.m7.2.3.3.2.2" xref="S3.p1.7.m7.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.p1.7.m7.2.2" xref="S3.p1.7.m7.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.p1.7.m7.2.3.3.2.3" xref="S3.p1.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.2b"><apply id="S3.p1.7.m7.2.3.cmml" xref="S3.p1.7.m7.2.3"><times id="S3.p1.7.m7.2.3.1.cmml" xref="S3.p1.7.m7.2.3.1"></times><ci id="S3.p1.7.m7.2.3.2.cmml" xref="S3.p1.7.m7.2.3.2">ℒ</ci><interval closure="open" id="S3.p1.7.m7.2.3.3.1.cmml" xref="S3.p1.7.m7.2.3.3.2"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">⋅</ci><ci id="S3.p1.7.m7.2.2.cmml" xref="S3.p1.7.m7.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.2c">\mathcal{L}(\cdot,\cdot)</annotation></semantics></math> computes the cross-entropy loss, and <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S3.p1.8.m8.1a"><msub id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi mathvariant="normal" id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml">Δ</mi><mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2">Δ</ci><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\Delta_{\theta}</annotation></semantics></math> is a simplified notion for the batch-averaged gradients.
Note, if the client is performing AT, the input <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="\bm{x}_{i}" display="inline"><semantics id="S3.p1.9.m9.1a"><msub id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml"><mi id="S3.p1.9.m9.1.1.2" xref="S3.p1.9.m9.1.1.2.cmml">𝒙</mi><mi id="S3.p1.9.m9.1.1.3" xref="S3.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><apply id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.cmml" xref="S3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.p1.9.m9.1.1.2.cmml" xref="S3.p1.9.m9.1.1.2">𝒙</ci><ci id="S3.p1.9.m9.1.1.3.cmml" xref="S3.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\bm{x}_{i}</annotation></semantics></math> will be the adversarial example instead of the original clean sample.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.7" class="ltx_p">After the local training, the server will collect the gradients <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">Δ</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">Δ</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\Delta_{\theta}</annotation></semantics></math> from the clients and aggregate the updates into the current global model <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.2" xref="S3.p2.2.m2.1.2.cmml"><msub id="S3.p2.2.m2.1.2.2" xref="S3.p2.2.m2.1.2.2.cmml"><mi id="S3.p2.2.m2.1.2.2.2" xref="S3.p2.2.m2.1.2.2.2.cmml">f</mi><mi id="S3.p2.2.m2.1.2.2.3" xref="S3.p2.2.m2.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.2.1" xref="S3.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S3.p2.2.m2.1.2.3.2" xref="S3.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S3.p2.2.m2.1.2.3.2.1" xref="S3.p2.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p2.2.m2.1.2.3.2.2" xref="S3.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.2.cmml" xref="S3.p2.2.m2.1.2"><times id="S3.p2.2.m2.1.2.1.cmml" xref="S3.p2.2.m2.1.2.1"></times><apply id="S3.p2.2.m2.1.2.2.cmml" xref="S3.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.2.2.1.cmml" xref="S3.p2.2.m2.1.2.2">subscript</csymbol><ci id="S3.p2.2.m2.1.2.2.2.cmml" xref="S3.p2.2.m2.1.2.2.2">𝑓</ci><ci id="S3.p2.2.m2.1.2.2.3.cmml" xref="S3.p2.2.m2.1.2.2.3">𝜃</ci></apply><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">f_{\theta}(\cdot)</annotation></semantics></math>.
Here, we assume that the server is malicious or has been compromised by the attacker.
Therefore, the attacker can access the model <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.2" xref="S3.p2.3.m3.1.2.cmml"><msub id="S3.p2.3.m3.1.2.2" xref="S3.p2.3.m3.1.2.2.cmml"><mi id="S3.p2.3.m3.1.2.2.2" xref="S3.p2.3.m3.1.2.2.2.cmml">f</mi><mi id="S3.p2.3.m3.1.2.2.3" xref="S3.p2.3.m3.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.3.m3.1.2.1" xref="S3.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S3.p2.3.m3.1.2.3.2" xref="S3.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S3.p2.3.m3.1.2.3.2.1" xref="S3.p2.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p2.3.m3.1.2.3.2.2" xref="S3.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.2.cmml" xref="S3.p2.3.m3.1.2"><times id="S3.p2.3.m3.1.2.1.cmml" xref="S3.p2.3.m3.1.2.1"></times><apply id="S3.p2.3.m3.1.2.2.cmml" xref="S3.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.2.2.1.cmml" xref="S3.p2.3.m3.1.2.2">subscript</csymbol><ci id="S3.p2.3.m3.1.2.2.2.cmml" xref="S3.p2.3.m3.1.2.2.2">𝑓</ci><ci id="S3.p2.3.m3.1.2.2.3.cmml" xref="S3.p2.3.m3.1.2.2.3">𝜃</ci></apply><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">f_{\theta}(\cdot)</annotation></semantics></math> and the gradients <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S3.p2.4.m4.1a"><msub id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi mathvariant="normal" id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">Δ</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">Δ</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\Delta_{\theta}</annotation></semantics></math>.
Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, we do <span id="S3.p2.7.1" class="ltx_text ltx_font_italic">not</span> pose any further assumptions beyond this point which may allow the attacker to better exploit the vulnerability, <em id="S3.p2.7.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S3.p2.7.3" class="ltx_text"></span>, we do not assume that the attacker can modify the model architecture or send fake, malicious global parameters to the clients.
The attack goal is then to reconstruct the input images <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\bm{x}_{i}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">𝒙</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝒙</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\bm{x}_{i}</annotation></semantics></math> that are used during the last local training step, given the available information <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="f_{\theta}(\cdot)" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.2" xref="S3.p2.6.m6.1.2.cmml"><msub id="S3.p2.6.m6.1.2.2" xref="S3.p2.6.m6.1.2.2.cmml"><mi id="S3.p2.6.m6.1.2.2.2" xref="S3.p2.6.m6.1.2.2.2.cmml">f</mi><mi id="S3.p2.6.m6.1.2.2.3" xref="S3.p2.6.m6.1.2.2.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.6.m6.1.2.1" xref="S3.p2.6.m6.1.2.1.cmml">​</mo><mrow id="S3.p2.6.m6.1.2.3.2" xref="S3.p2.6.m6.1.2.cmml"><mo stretchy="false" id="S3.p2.6.m6.1.2.3.2.1" xref="S3.p2.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p2.6.m6.1.2.3.2.2" xref="S3.p2.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.2.cmml" xref="S3.p2.6.m6.1.2"><times id="S3.p2.6.m6.1.2.1.cmml" xref="S3.p2.6.m6.1.2.1"></times><apply id="S3.p2.6.m6.1.2.2.cmml" xref="S3.p2.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.2.2.1.cmml" xref="S3.p2.6.m6.1.2.2">subscript</csymbol><ci id="S3.p2.6.m6.1.2.2.2.cmml" xref="S3.p2.6.m6.1.2.2.2">𝑓</ci><ci id="S3.p2.6.m6.1.2.2.3.cmml" xref="S3.p2.6.m6.1.2.2.3">𝜃</ci></apply><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">f_{\theta}(\cdot)</annotation></semantics></math> and <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi mathvariant="normal" id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">Δ</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">Δ</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\Delta_{\theta}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Overview</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.9" class="ltx_p">To better motivate and describe our proposed methodology, we first give a brief overview of existing methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and discuss their shortcomings.
Essentially, previous works all solve the following optimization problem:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.2" class="ltx_Math" alttext="\operatorname*{arg\,min}_{\bm{z}}\mathcal{L}_{\text{grad}}\left(\frac{1}{N}\sum_{i=1}^{N}\nabla_{\theta}\mathcal{L}(f_{\theta}(\bm{z}_{i}),\hat{y}_{i}),\Delta_{\theta}\right)+\mathcal{R}(\bm{z})." display="block"><semantics id="S4.E2.m1.2a"><mrow id="S4.E2.m1.2.2.1" xref="S4.E2.m1.2.2.1.1.cmml"><mrow id="S4.E2.m1.2.2.1.1" xref="S4.E2.m1.2.2.1.1.cmml"><mrow id="S4.E2.m1.2.2.1.1.2" xref="S4.E2.m1.2.2.1.1.2.cmml"><mrow id="S4.E2.m1.2.2.1.1.2.4" xref="S4.E2.m1.2.2.1.1.2.4.cmml"><munder id="S4.E2.m1.2.2.1.1.2.4.1" xref="S4.E2.m1.2.2.1.1.2.4.1.cmml"><mrow id="S4.E2.m1.2.2.1.1.2.4.1.2" xref="S4.E2.m1.2.2.1.1.2.4.1.2.cmml"><mi id="S4.E2.m1.2.2.1.1.2.4.1.2.2" xref="S4.E2.m1.2.2.1.1.2.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E2.m1.2.2.1.1.2.4.1.2.1" xref="S4.E2.m1.2.2.1.1.2.4.1.2.1.cmml">​</mo><mi id="S4.E2.m1.2.2.1.1.2.4.1.2.3" xref="S4.E2.m1.2.2.1.1.2.4.1.2.3.cmml">min</mi></mrow><mi id="S4.E2.m1.2.2.1.1.2.4.1.3" xref="S4.E2.m1.2.2.1.1.2.4.1.3.cmml">𝒛</mi></munder><mo lspace="0.167em" id="S4.E2.m1.2.2.1.1.2.4a" xref="S4.E2.m1.2.2.1.1.2.4.cmml">⁡</mo><msub id="S4.E2.m1.2.2.1.1.2.4.2" xref="S4.E2.m1.2.2.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.1.1.2.4.2.2" xref="S4.E2.m1.2.2.1.1.2.4.2.2.cmml">ℒ</mi><mtext id="S4.E2.m1.2.2.1.1.2.4.2.3" xref="S4.E2.m1.2.2.1.1.2.4.2.3a.cmml">grad</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.2.3" xref="S4.E2.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.2.2.2" xref="S4.E2.m1.2.2.1.1.2.2.3.cmml"><mo id="S4.E2.m1.2.2.1.1.2.2.2.3" xref="S4.E2.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.cmml"><mfrac id="S4.E2.m1.2.2.1.1.1.1.1.1.4" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4.cmml"><mn id="S4.E2.m1.2.2.1.1.1.1.1.1.4.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4.2.cmml">1</mn><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.4.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.cmml"><munderover id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.2.cmml">i</mi><mo id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">N</mi></munderover><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml"><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.cmml"><msub id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.cmml"><mo rspace="0.167em" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.2.cmml">∇</mo><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">(</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.4" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml">y</mi><mo id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.5" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.2.2.1.1.2.2.2.4" xref="S4.E2.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S4.E2.m1.2.2.1.1.2.2.2.2" xref="S4.E2.m1.2.2.1.1.2.2.2.2.cmml"><mi mathvariant="normal" id="S4.E2.m1.2.2.1.1.2.2.2.2.2" xref="S4.E2.m1.2.2.1.1.2.2.2.2.2.cmml">Δ</mi><mi id="S4.E2.m1.2.2.1.1.2.2.2.2.3" xref="S4.E2.m1.2.2.1.1.2.2.2.2.3.cmml">θ</mi></msub><mo id="S4.E2.m1.2.2.1.1.2.2.2.5" xref="S4.E2.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.2.2.1.1.3" xref="S4.E2.m1.2.2.1.1.3.cmml">+</mo><mrow id="S4.E2.m1.2.2.1.1.4" xref="S4.E2.m1.2.2.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.1.1.4.2" xref="S4.E2.m1.2.2.1.1.4.2.cmml">ℛ</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.1.4.1" xref="S4.E2.m1.2.2.1.1.4.1.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.4.3.2" xref="S4.E2.m1.2.2.1.1.4.cmml"><mo stretchy="false" id="S4.E2.m1.2.2.1.1.4.3.2.1" xref="S4.E2.m1.2.2.1.1.4.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">𝒛</mi><mo stretchy="false" id="S4.E2.m1.2.2.1.1.4.3.2.2" xref="S4.E2.m1.2.2.1.1.4.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E2.m1.2.2.1.2" xref="S4.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.2b"><apply id="S4.E2.m1.2.2.1.1.cmml" xref="S4.E2.m1.2.2.1"><plus id="S4.E2.m1.2.2.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.3"></plus><apply id="S4.E2.m1.2.2.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.2"><times id="S4.E2.m1.2.2.1.1.2.3.cmml" xref="S4.E2.m1.2.2.1.1.2.3"></times><apply id="S4.E2.m1.2.2.1.1.2.4.cmml" xref="S4.E2.m1.2.2.1.1.2.4"><apply id="S4.E2.m1.2.2.1.1.2.4.1.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.2.4.1.1.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1">subscript</csymbol><apply id="S4.E2.m1.2.2.1.1.2.4.1.2.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1.2"><times id="S4.E2.m1.2.2.1.1.2.4.1.2.1.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1.2.1"></times><ci id="S4.E2.m1.2.2.1.1.2.4.1.2.2.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1.2.2">arg</ci><ci id="S4.E2.m1.2.2.1.1.2.4.1.2.3.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1.2.3">min</ci></apply><ci id="S4.E2.m1.2.2.1.1.2.4.1.3.cmml" xref="S4.E2.m1.2.2.1.1.2.4.1.3">𝒛</ci></apply><apply id="S4.E2.m1.2.2.1.1.2.4.2.cmml" xref="S4.E2.m1.2.2.1.1.2.4.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.2.4.2.1.cmml" xref="S4.E2.m1.2.2.1.1.2.4.2">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.2.4.2.2.cmml" xref="S4.E2.m1.2.2.1.1.2.4.2.2">ℒ</ci><ci id="S4.E2.m1.2.2.1.1.2.4.2.3a.cmml" xref="S4.E2.m1.2.2.1.1.2.4.2.3"><mtext mathsize="70%" id="S4.E2.m1.2.2.1.1.2.4.2.3.cmml" xref="S4.E2.m1.2.2.1.1.2.4.2.3">grad</mtext></ci></apply></apply><interval closure="open" id="S4.E2.m1.2.2.1.1.2.2.3.cmml" xref="S4.E2.m1.2.2.1.1.2.2.2"><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1"><times id="S4.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.3"></times><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4"><divide id="S4.E2.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4"></divide><cn type="integer" id="S4.E2.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4.2">1</cn><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.4.3">𝑁</ci></apply><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2"><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><sum id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.2"></sum><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3"><eq id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.1"></eq><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.2">𝑖</ci><cn type="integer" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.3.3">𝑁</ci></apply><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2"><times id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.3"></times><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4"><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.2">∇</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.1.3">𝜃</ci></apply><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.4.2">ℒ</ci></apply><interval closure="open" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2"><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><times id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2"><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.1">^</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply><apply id="S4.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.2.2.1.1.2.2.2.2.2">Δ</ci><ci id="S4.E2.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E2.m1.2.2.1.1.2.2.2.2.3">𝜃</ci></apply></interval></apply><apply id="S4.E2.m1.2.2.1.1.4.cmml" xref="S4.E2.m1.2.2.1.1.4"><times id="S4.E2.m1.2.2.1.1.4.1.cmml" xref="S4.E2.m1.2.2.1.1.4.1"></times><ci id="S4.E2.m1.2.2.1.1.4.2.cmml" xref="S4.E2.m1.2.2.1.1.4.2">ℛ</ci><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.2c">\operatorname*{arg\,min}_{\bm{z}}\mathcal{L}_{\text{grad}}\left(\frac{1}{N}\sum_{i=1}^{N}\nabla_{\theta}\mathcal{L}(f_{\theta}(\bm{z}_{i}),\hat{y}_{i}),\Delta_{\theta}\right)+\mathcal{R}(\bm{z}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.8" class="ltx_p">Specifically, the optimization variable here is a randomly-initialized batch of inputs <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\bm{z}</annotation></semantics></math>.
The first term in <a href="#S4.E2" title="In 4.1 Overview ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> enforces the gradients of loss computed using <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\bm{z}</annotation></semantics></math> to match the ground-truth gradients <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">Δ</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">Δ</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">\Delta_{\theta}</annotation></semantics></math> according to a certain distance metric <math id="S4.SS1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{L}_{\text{grad}}(\cdot,\cdot)" display="inline"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.3" xref="S4.SS1.p1.4.m4.2.3.cmml"><msub id="S4.SS1.p1.4.m4.2.3.2" xref="S4.SS1.p1.4.m4.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.2.3.2.2" xref="S4.SS1.p1.4.m4.2.3.2.2.cmml">ℒ</mi><mtext id="S4.SS1.p1.4.m4.2.3.2.3" xref="S4.SS1.p1.4.m4.2.3.2.3a.cmml">grad</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.3.1" xref="S4.SS1.p1.4.m4.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.4.m4.2.3.3.2" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.2.3.3.2.1" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS1.p1.4.m4.2.3.3.2.2" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.4.m4.2.3.3.2.3" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3"><times id="S4.SS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.1"></times><apply id="S4.SS1.p1.4.m4.2.3.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.3.2.1.cmml" xref="S4.SS1.p1.4.m4.2.3.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.2.3.2.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2.2">ℒ</ci><ci id="S4.SS1.p1.4.m4.2.3.2.3a.cmml" xref="S4.SS1.p1.4.m4.2.3.2.3"><mtext mathsize="70%" id="S4.SS1.p1.4.m4.2.3.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3.2.3">grad</mtext></ci></apply><interval closure="open" id="S4.SS1.p1.4.m4.2.3.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.3.2"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">⋅</ci><ci id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">\mathcal{L}_{\text{grad}}(\cdot,\cdot)</annotation></semantics></math> (<em id="S4.SS1.p1.8.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS1.p1.8.2" class="ltx_text"></span>, cosine distance is used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><msub id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">ℓ</mi><mn id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">ℓ</ci><cn type="integer" id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\ell_{2}</annotation></semantics></math> distance is used in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>).
Note, an estimation of the ground-truth labels <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="\hat{y}_{i}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><msub id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mover accent="true" id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2.2" xref="S4.SS1.p1.6.m6.1.1.2.2.cmml">y</mi><mo id="S4.SS1.p1.6.m6.1.1.2.1" xref="S4.SS1.p1.6.m6.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">subscript</csymbol><apply id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2"><ci id="S4.SS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1.2.1">^</ci><ci id="S4.SS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2.2">𝑦</ci></apply><ci id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">\hat{y}_{i}</annotation></semantics></math> is used here to compute the loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
The underlying idea of the first term is that the synthesized images <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">\bm{z}</annotation></semantics></math> will resemble the original inputs if the gradients computed on them are similar.
Meanwhile, to encourage the generation of realistic and natural images, the second term in <a href="#S4.E2" title="In 4.1 Overview ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> incorporates image priors <math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{R}(\cdot)" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mrow id="S4.SS1.p1.8.m8.1.2" xref="S4.SS1.p1.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.8.m8.1.2.2" xref="S4.SS1.p1.8.m8.1.2.2.cmml">ℛ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.1.2.1" xref="S4.SS1.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S4.SS1.p1.8.m8.1.2.3.2" xref="S4.SS1.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2.3.2.1" xref="S4.SS1.p1.8.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p1.8.m8.1.2.3.2.2" xref="S4.SS1.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><apply id="S4.SS1.p1.8.m8.1.2.cmml" xref="S4.SS1.p1.8.m8.1.2"><times id="S4.SS1.p1.8.m8.1.2.1.cmml" xref="S4.SS1.p1.8.m8.1.2.1"></times><ci id="S4.SS1.p1.8.m8.1.2.2.cmml" xref="S4.SS1.p1.8.m8.1.2.2">ℛ</ci><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">\mathcal{R}(\cdot)</annotation></semantics></math> as regularization (<em id="S4.SS1.p1.8.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS1.p1.8.4" class="ltx_text"></span>, the Total Variation loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and the Group Consistency loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.6" class="ltx_p">While the idea of <a href="#S4.E2" title="In 4.1 Overview ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> is natural and straightforward, one can identify an obvious limitation.
Note from <a href="#S3.E1" title="In 3 Problem Setting ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a> that the gradients contributed by each individual sample, <em id="S4.SS1.p2.6.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS1.p2.6.2" class="ltx_text"></span>, <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="\nabla_{\theta}\mathcal{L}(f_{\theta}(x_{i}),y_{i})" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml"><mrow id="S4.SS1.p2.1.m1.2.2.4" xref="S4.SS1.p2.1.m1.2.2.4.cmml"><msub id="S4.SS1.p2.1.m1.2.2.4.1" xref="S4.SS1.p2.1.m1.2.2.4.1.cmml"><mo id="S4.SS1.p2.1.m1.2.2.4.1.2" xref="S4.SS1.p2.1.m1.2.2.4.1.2.cmml">∇</mo><mi id="S4.SS1.p2.1.m1.2.2.4.1.3" xref="S4.SS1.p2.1.m1.2.2.4.1.3.cmml">θ</mi></msub><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.2.2.4.2" xref="S4.SS1.p2.1.m1.2.2.4.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.2.2.3" xref="S4.SS1.p2.1.m1.2.2.3.cmml">​</mo><mrow id="S4.SS1.p2.1.m1.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.2.2.3" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">(</mo><mrow id="S4.SS1.p2.1.m1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.cmml"><msub id="S4.SS1.p2.1.m1.1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.1.m1.2.2.2.2.4" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p2.1.m1.2.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.1.m1.2.2.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p2.1.m1.2.2.2.2.2.3" xref="S4.SS1.p2.1.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.2.2.5" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><apply id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2"><times id="S4.SS1.p2.1.m1.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.3"></times><apply id="S4.SS1.p2.1.m1.2.2.4.cmml" xref="S4.SS1.p2.1.m1.2.2.4"><apply id="S4.SS1.p2.1.m1.2.2.4.1.cmml" xref="S4.SS1.p2.1.m1.2.2.4.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.4.1.1.cmml" xref="S4.SS1.p2.1.m1.2.2.4.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.4.1.2.cmml" xref="S4.SS1.p2.1.m1.2.2.4.1.2">∇</ci><ci id="S4.SS1.p2.1.m1.2.2.4.1.3.cmml" xref="S4.SS1.p2.1.m1.2.2.4.1.3">𝜃</ci></apply><ci id="S4.SS1.p2.1.m1.2.2.4.2.cmml" xref="S4.SS1.p2.1.m1.2.2.4.2">ℒ</ci></apply><interval closure="open" id="S4.SS1.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2"><apply id="S4.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.2"></times><apply id="S4.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3.2">𝑓</ci><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">\nabla_{\theta}\mathcal{L}(f_{\theta}(x_{i}),y_{i})</annotation></semantics></math>, are fused together in the batch-averaged gradients <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><msub id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">Δ</mi><mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">Δ</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\Delta_{\theta}</annotation></semantics></math>.
Therefore, <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\Delta_{\theta}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msub id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">Δ</mi><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">Δ</ci><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\Delta_{\theta}</annotation></semantics></math> does not provide precise supervision for each individual image especially under a large batch size, making it much difficult to achieve accurate reconstruction (in a similar sense to how exactly knowing the value of <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">a</annotation></semantics></math> and <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><ci id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">b</annotation></semantics></math> is hard given the value of <math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="a+b" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">a</mi><mo id="S4.SS1.p2.6.m6.1.1.1" xref="S4.SS1.p2.6.m6.1.1.1.cmml">+</mo><mi id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">b</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><plus id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></plus><ci id="S4.SS1.p2.6.m6.1.1.2.cmml" xref="S4.SS1.p2.6.m6.1.1.2">𝑎</ci><ci id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">a+b</annotation></semantics></math>).
As a result, <a href="#S4.E2" title="In 4.1 Overview ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a> only works well when the batch size is extremely small (<em id="S4.SS1.p2.6.3" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS1.p2.6.4" class="ltx_text"></span>, when the batch has only a single or a few samples).
When the batch size is large, the restored images lack clear visual details and do not resemble the real images anymore <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">To mitigate this problem, we propose a unique two-step attack procedure.
In the first step, we decouple the fused information of each individual image by restoring their features from the gradients which are less coupled.
Here, we define the feature vector of a sample as the output of the penultimate layer when that sample is passed through the DNN model.
Once we restore the feature vectors, each corresponding to one input image, we can use them as more accurate supervision to reconstruct the images.
Next, we will explain each of the two steps in detail and discuss how AT models kick in and benefit the attack.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Feature restoration from gradients</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.9" class="ltx_p">We first introduce some notions to facilitate the description.
A DNN model <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.2.1" xref="S4.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.1" xref="S4.SS2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.2" xref="S4.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.2"><times id="S4.SS2.p1.1.m1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.1"></times><ci id="S4.SS2.p1.1.m1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">f(\cdot)</annotation></semantics></math> deployed for image classification tasks can always be decomposed as <math id="S4.SS2.p1.2.m2.3" class="ltx_Math" alttext="f(\cdot)=h(r(\cdot))" display="inline"><semantics id="S4.SS2.p1.2.m2.3a"><mrow id="S4.SS2.p1.2.m2.3.3" xref="S4.SS2.p1.2.m2.3.3.cmml"><mrow id="S4.SS2.p1.2.m2.3.3.3" xref="S4.SS2.p1.2.m2.3.3.3.cmml"><mi id="S4.SS2.p1.2.m2.3.3.3.2" xref="S4.SS2.p1.2.m2.3.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.3.3.3.1" xref="S4.SS2.p1.2.m2.3.3.3.1.cmml">​</mo><mrow id="S4.SS2.p1.2.m2.3.3.3.3.2" xref="S4.SS2.p1.2.m2.3.3.3.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.3.3.3.3.2.1" xref="S4.SS2.p1.2.m2.3.3.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.2.m2.3.3.3.3.2.2" xref="S4.SS2.p1.2.m2.3.3.3.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p1.2.m2.3.3.2" xref="S4.SS2.p1.2.m2.3.3.2.cmml">=</mo><mrow id="S4.SS2.p1.2.m2.3.3.1" xref="S4.SS2.p1.2.m2.3.3.1.cmml"><mi id="S4.SS2.p1.2.m2.3.3.1.3" xref="S4.SS2.p1.2.m2.3.3.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.3.3.1.2" xref="S4.SS2.p1.2.m2.3.3.1.2.cmml">​</mo><mrow id="S4.SS2.p1.2.m2.3.3.1.1.1" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.3.3.1.1.1.2" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.2.m2.3.3.1.1.1.1" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.3.3.1.1.1.1.2" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.3.3.1.1.1.1.1" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.1.cmml">​</mo><mrow id="S4.SS2.p1.2.m2.3.3.1.1.1.1.3.2" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.3.3.1.1.1.1.3.2.1" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.2.2" xref="S4.SS2.p1.2.m2.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.2.m2.3.3.1.1.1.1.3.2.2" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p1.2.m2.3.3.1.1.1.3" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.3b"><apply id="S4.SS2.p1.2.m2.3.3.cmml" xref="S4.SS2.p1.2.m2.3.3"><eq id="S4.SS2.p1.2.m2.3.3.2.cmml" xref="S4.SS2.p1.2.m2.3.3.2"></eq><apply id="S4.SS2.p1.2.m2.3.3.3.cmml" xref="S4.SS2.p1.2.m2.3.3.3"><times id="S4.SS2.p1.2.m2.3.3.3.1.cmml" xref="S4.SS2.p1.2.m2.3.3.3.1"></times><ci id="S4.SS2.p1.2.m2.3.3.3.2.cmml" xref="S4.SS2.p1.2.m2.3.3.3.2">𝑓</ci><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">⋅</ci></apply><apply id="S4.SS2.p1.2.m2.3.3.1.cmml" xref="S4.SS2.p1.2.m2.3.3.1"><times id="S4.SS2.p1.2.m2.3.3.1.2.cmml" xref="S4.SS2.p1.2.m2.3.3.1.2"></times><ci id="S4.SS2.p1.2.m2.3.3.1.3.cmml" xref="S4.SS2.p1.2.m2.3.3.1.3">ℎ</ci><apply id="S4.SS2.p1.2.m2.3.3.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.3.3.1.1.1"><times id="S4.SS2.p1.2.m2.3.3.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.1"></times><ci id="S4.SS2.p1.2.m2.3.3.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.3.3.1.1.1.1.2">𝑟</ci><ci id="S4.SS2.p1.2.m2.2.2.cmml" xref="S4.SS2.p1.2.m2.2.2">⋅</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.3c">f(\cdot)=h(r(\cdot))</annotation></semantics></math>, where <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="r(\cdot)" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.2.2" xref="S4.SS2.p1.3.m3.1.2.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.2.1" xref="S4.SS2.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.3.m3.1.2.3.2" xref="S4.SS2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.3.m3.1.2.3.2.1" xref="S4.SS2.p1.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.3.m3.1.2.3.2.2" xref="S4.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.2.cmml" xref="S4.SS2.p1.3.m3.1.2"><times id="S4.SS2.p1.3.m3.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.2.1"></times><ci id="S4.SS2.p1.3.m3.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.2.2">𝑟</ci><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">r(\cdot)</annotation></semantics></math> typically comprises convolutional layers and extracts high-level representations/features of the inputs, and <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="h(\cdot)" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mi id="S4.SS2.p1.4.m4.1.2.2" xref="S4.SS2.p1.4.m4.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.2.1" xref="S4.SS2.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.4.m4.1.2.3.2" xref="S4.SS2.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.2.1" xref="S4.SS2.p1.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.4.m4.1.2.3.2.2" xref="S4.SS2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.2.cmml" xref="S4.SS2.p1.4.m4.1.2"><times id="S4.SS2.p1.4.m4.1.2.1.cmml" xref="S4.SS2.p1.4.m4.1.2.1"></times><ci id="S4.SS2.p1.4.m4.1.2.2.cmml" xref="S4.SS2.p1.4.m4.1.2.2">ℎ</ci><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">h(\cdot)</annotation></semantics></math> is the linear layer that performs classification on top of the features and outputs activation scores for each class (<em id="S4.SS2.p1.9.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p1.9.2" class="ltx_text"></span>, logits).
For simplicity, we denote the feature of an input <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\bm{x}</annotation></semantics></math> as <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\bm{r}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">𝒓</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><ci id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">𝒓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\bm{r}</annotation></semantics></math>, <em id="S4.SS2.p1.9.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p1.9.4" class="ltx_text"></span>, <math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="\bm{r}\coloneqq r(\bm{x})" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.2" xref="S4.SS2.p1.7.m7.1.2.cmml"><mi id="S4.SS2.p1.7.m7.1.2.2" xref="S4.SS2.p1.7.m7.1.2.2.cmml">𝒓</mi><mo id="S4.SS2.p1.7.m7.1.2.1" xref="S4.SS2.p1.7.m7.1.2.1.cmml">≔</mo><mrow id="S4.SS2.p1.7.m7.1.2.3" xref="S4.SS2.p1.7.m7.1.2.3.cmml"><mi id="S4.SS2.p1.7.m7.1.2.3.2" xref="S4.SS2.p1.7.m7.1.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.7.m7.1.2.3.1" xref="S4.SS2.p1.7.m7.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p1.7.m7.1.2.3.3.2" xref="S4.SS2.p1.7.m7.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.2.3.3.2.1" xref="S4.SS2.p1.7.m7.1.2.3.cmml">(</mo><mi id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">𝒙</mi><mo stretchy="false" id="S4.SS2.p1.7.m7.1.2.3.3.2.2" xref="S4.SS2.p1.7.m7.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><apply id="S4.SS2.p1.7.m7.1.2.cmml" xref="S4.SS2.p1.7.m7.1.2"><ci id="S4.SS2.p1.7.m7.1.2.1.cmml" xref="S4.SS2.p1.7.m7.1.2.1">≔</ci><ci id="S4.SS2.p1.7.m7.1.2.2.cmml" xref="S4.SS2.p1.7.m7.1.2.2">𝒓</ci><apply id="S4.SS2.p1.7.m7.1.2.3.cmml" xref="S4.SS2.p1.7.m7.1.2.3"><times id="S4.SS2.p1.7.m7.1.2.3.1.cmml" xref="S4.SS2.p1.7.m7.1.2.3.1"></times><ci id="S4.SS2.p1.7.m7.1.2.3.2.cmml" xref="S4.SS2.p1.7.m7.1.2.3.2">𝑟</ci><ci id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">\bm{r}\coloneqq r(\bm{x})</annotation></semantics></math>.
Note that <math id="S4.SS2.p1.8.m8.1" class="ltx_Math" alttext="\bm{r}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.SS2.p1.8.m8.1a"><mrow id="S4.SS2.p1.8.m8.1.1" xref="S4.SS2.p1.8.m8.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.2" xref="S4.SS2.p1.8.m8.1.1.2.cmml">𝒓</mi><mo id="S4.SS2.p1.8.m8.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.8.m8.1.1.3" xref="S4.SS2.p1.8.m8.1.1.3.cmml"><mi id="S4.SS2.p1.8.m8.1.1.3.2" xref="S4.SS2.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.p1.8.m8.1.1.3.3" xref="S4.SS2.p1.8.m8.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.1b"><apply id="S4.SS2.p1.8.m8.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1"><in id="S4.SS2.p1.8.m8.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1"></in><ci id="S4.SS2.p1.8.m8.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.2">𝒓</ci><apply id="S4.SS2.p1.8.m8.1.1.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS2.p1.8.m8.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS2.p1.8.m8.1.1.3.2">ℝ</ci><ci id="S4.SS2.p1.8.m8.1.1.3.3.cmml" xref="S4.SS2.p1.8.m8.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.1c">\bm{r}\in\mathbb{R}^{D}</annotation></semantics></math> is a <math id="S4.SS2.p1.9.m9.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS2.p1.9.m9.1a"><mi id="S4.SS2.p1.9.m9.1.1" xref="S4.SS2.p1.9.m9.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m9.1b"><ci id="S4.SS2.p1.9.m9.1.1.cmml" xref="S4.SS2.p1.9.m9.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m9.1c">D</annotation></semantics></math>-dimensional column vector.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.20" class="ltx_p">Our key insight here is that the features can be restored from the gradients w.r.t. the linear layer’s weights, which are directly accessible to the attacker.
To see this, let us first delve into the computation of the weight gradients of <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="h(\cdot)" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.2" xref="S4.SS2.p2.1.m1.1.2.cmml"><mi id="S4.SS2.p2.1.m1.1.2.2" xref="S4.SS2.p2.1.m1.1.2.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.2.1" xref="S4.SS2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p2.1.m1.1.2.3.2" xref="S4.SS2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.1.2.3.2.1" xref="S4.SS2.p2.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p2.1.m1.1.2.3.2.2" xref="S4.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.2"><times id="S4.SS2.p2.1.m1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.2.1"></times><ci id="S4.SS2.p2.1.m1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.2.2">ℎ</ci><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">h(\cdot)</annotation></semantics></math>.
Denote the linear layer’s weight matrix as <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\bm{W}\in\mathbb{R}^{D\times K}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">𝑾</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.3.2" xref="S4.SS2.p2.2.m2.1.1.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p2.2.m2.1.1.3.3.1" xref="S4.SS2.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS2.p2.2.m2.1.1.3.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.3.cmml">K</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><in id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></in><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑾</ci><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3"><times id="S4.SS2.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS2.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.2">𝐷</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\bm{W}\in\mathbb{R}^{D\times K}</annotation></semantics></math>, wherein the <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">k</annotation></semantics></math>-th column <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\bm{W}_{k}\in\mathbb{R}^{D}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mrow id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><msub id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2.2" xref="S4.SS2.p2.4.m4.1.1.2.2.cmml">𝑾</mi><mi id="S4.SS2.p2.4.m4.1.1.2.3" xref="S4.SS2.p2.4.m4.1.1.2.3.cmml">k</mi></msub><mo id="S4.SS2.p2.4.m4.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml"><mi id="S4.SS2.p2.4.m4.1.1.3.2" xref="S4.SS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.p2.4.m4.1.1.3.3" xref="S4.SS2.p2.4.m4.1.1.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><in id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1"></in><apply id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2.2">𝑾</ci><ci id="S4.SS2.p2.4.m4.1.1.2.3.cmml" xref="S4.SS2.p2.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.3.1.cmml" xref="S4.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.3.2.cmml" xref="S4.SS2.p2.4.m4.1.1.3.2">ℝ</ci><ci id="S4.SS2.p2.4.m4.1.1.3.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\bm{W}_{k}\in\mathbb{R}^{D}</annotation></semantics></math> is a weight vector corresponding to the <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><ci id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">k</annotation></semantics></math>-th class, and <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">K</annotation></semantics></math> is the total number of classes.
Then, the class activations/logits are <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="\bm{a}=\bm{W}^{\top}\bm{r}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><mrow id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">𝒂</mi><mo id="S4.SS2.p2.7.m7.1.1.1" xref="S4.SS2.p2.7.m7.1.1.1.cmml">=</mo><mrow id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml"><msup id="S4.SS2.p2.7.m7.1.1.3.2" xref="S4.SS2.p2.7.m7.1.1.3.2.cmml"><mi id="S4.SS2.p2.7.m7.1.1.3.2.2" xref="S4.SS2.p2.7.m7.1.1.3.2.2.cmml">𝑾</mi><mo id="S4.SS2.p2.7.m7.1.1.3.2.3" xref="S4.SS2.p2.7.m7.1.1.3.2.3.cmml">⊤</mo></msup><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.1.1.3.1" xref="S4.SS2.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p2.7.m7.1.1.3.3" xref="S4.SS2.p2.7.m7.1.1.3.3.cmml">𝒓</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><eq id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1.1"></eq><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝒂</ci><apply id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3"><times id="S4.SS2.p2.7.m7.1.1.3.1.cmml" xref="S4.SS2.p2.7.m7.1.1.3.1"></times><apply id="S4.SS2.p2.7.m7.1.1.3.2.cmml" xref="S4.SS2.p2.7.m7.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.3.2.1.cmml" xref="S4.SS2.p2.7.m7.1.1.3.2">superscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.3.2.2.cmml" xref="S4.SS2.p2.7.m7.1.1.3.2.2">𝑾</ci><csymbol cd="latexml" id="S4.SS2.p2.7.m7.1.1.3.2.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3.2.3">top</csymbol></apply><ci id="S4.SS2.p2.7.m7.1.1.3.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3.3">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">\bm{a}=\bm{W}^{\top}\bm{r}</annotation></semantics></math>, and the class probabilities are <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="\bm{p}=\text{softmax}(\bm{a})" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><mrow id="S4.SS2.p2.8.m8.1.2" xref="S4.SS2.p2.8.m8.1.2.cmml"><mi id="S4.SS2.p2.8.m8.1.2.2" xref="S4.SS2.p2.8.m8.1.2.2.cmml">𝒑</mi><mo id="S4.SS2.p2.8.m8.1.2.1" xref="S4.SS2.p2.8.m8.1.2.1.cmml">=</mo><mrow id="S4.SS2.p2.8.m8.1.2.3" xref="S4.SS2.p2.8.m8.1.2.3.cmml"><mtext id="S4.SS2.p2.8.m8.1.2.3.2" xref="S4.SS2.p2.8.m8.1.2.3.2a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.p2.8.m8.1.2.3.1" xref="S4.SS2.p2.8.m8.1.2.3.1.cmml">​</mo><mrow id="S4.SS2.p2.8.m8.1.2.3.3.2" xref="S4.SS2.p2.8.m8.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.1.2.3.3.2.1" xref="S4.SS2.p2.8.m8.1.2.3.cmml">(</mo><mi id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml">𝒂</mi><mo stretchy="false" id="S4.SS2.p2.8.m8.1.2.3.3.2.2" xref="S4.SS2.p2.8.m8.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.2.cmml" xref="S4.SS2.p2.8.m8.1.2"><eq id="S4.SS2.p2.8.m8.1.2.1.cmml" xref="S4.SS2.p2.8.m8.1.2.1"></eq><ci id="S4.SS2.p2.8.m8.1.2.2.cmml" xref="S4.SS2.p2.8.m8.1.2.2">𝒑</ci><apply id="S4.SS2.p2.8.m8.1.2.3.cmml" xref="S4.SS2.p2.8.m8.1.2.3"><times id="S4.SS2.p2.8.m8.1.2.3.1.cmml" xref="S4.SS2.p2.8.m8.1.2.3.1"></times><ci id="S4.SS2.p2.8.m8.1.2.3.2a.cmml" xref="S4.SS2.p2.8.m8.1.2.3.2"><mtext id="S4.SS2.p2.8.m8.1.2.3.2.cmml" xref="S4.SS2.p2.8.m8.1.2.3.2">softmax</mtext></ci><ci id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">𝒂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">\bm{p}=\text{softmax}(\bm{a})</annotation></semantics></math>, where the probability on <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><mi id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><ci id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">k</annotation></semantics></math>-th class <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="\bm{p}_{k}" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><msub id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml"><mi id="S4.SS2.p2.10.m10.1.1.2" xref="S4.SS2.p2.10.m10.1.1.2.cmml">𝒑</mi><mi id="S4.SS2.p2.10.m10.1.1.3" xref="S4.SS2.p2.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><apply id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m10.1.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m10.1.1.2.cmml" xref="S4.SS2.p2.10.m10.1.1.2">𝒑</ci><ci id="S4.SS2.p2.10.m10.1.1.3.cmml" xref="S4.SS2.p2.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">\bm{p}_{k}</annotation></semantics></math> is <math id="S4.SS2.p2.11.m11.1" class="ltx_Math" alttext="\frac{e^{\bm{a}_{k}}}{\sum_{j=1}^{K}e^{\bm{a}_{j}}}" display="inline"><semantics id="S4.SS2.p2.11.m11.1a"><mfrac id="S4.SS2.p2.11.m11.1.1" xref="S4.SS2.p2.11.m11.1.1.cmml"><msup id="S4.SS2.p2.11.m11.1.1.2" xref="S4.SS2.p2.11.m11.1.1.2.cmml"><mi id="S4.SS2.p2.11.m11.1.1.2.2" xref="S4.SS2.p2.11.m11.1.1.2.2.cmml">e</mi><msub id="S4.SS2.p2.11.m11.1.1.2.3" xref="S4.SS2.p2.11.m11.1.1.2.3.cmml"><mi id="S4.SS2.p2.11.m11.1.1.2.3.2" xref="S4.SS2.p2.11.m11.1.1.2.3.2.cmml">𝒂</mi><mi id="S4.SS2.p2.11.m11.1.1.2.3.3" xref="S4.SS2.p2.11.m11.1.1.2.3.3.cmml">k</mi></msub></msup><mrow id="S4.SS2.p2.11.m11.1.1.3" xref="S4.SS2.p2.11.m11.1.1.3.cmml"><mstyle displaystyle="false" id="S4.SS2.p2.11.m11.1.1.3.1" xref="S4.SS2.p2.11.m11.1.1.3.1.cmml"><msubsup id="S4.SS2.p2.11.m11.1.1.3.1a" xref="S4.SS2.p2.11.m11.1.1.3.1.cmml"><mo id="S4.SS2.p2.11.m11.1.1.3.1.2.2" xref="S4.SS2.p2.11.m11.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.SS2.p2.11.m11.1.1.3.1.2.3" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.cmml"><mi id="S4.SS2.p2.11.m11.1.1.3.1.2.3.2" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.2.cmml">j</mi><mo id="S4.SS2.p2.11.m11.1.1.3.1.2.3.1" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS2.p2.11.m11.1.1.3.1.2.3.3" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.p2.11.m11.1.1.3.1.3" xref="S4.SS2.p2.11.m11.1.1.3.1.3.cmml">K</mi></msubsup></mstyle><msup id="S4.SS2.p2.11.m11.1.1.3.2" xref="S4.SS2.p2.11.m11.1.1.3.2.cmml"><mi id="S4.SS2.p2.11.m11.1.1.3.2.2" xref="S4.SS2.p2.11.m11.1.1.3.2.2.cmml">e</mi><msub id="S4.SS2.p2.11.m11.1.1.3.2.3" xref="S4.SS2.p2.11.m11.1.1.3.2.3.cmml"><mi id="S4.SS2.p2.11.m11.1.1.3.2.3.2" xref="S4.SS2.p2.11.m11.1.1.3.2.3.2.cmml">𝒂</mi><mi id="S4.SS2.p2.11.m11.1.1.3.2.3.3" xref="S4.SS2.p2.11.m11.1.1.3.2.3.3.cmml">j</mi></msub></msup></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m11.1b"><apply id="S4.SS2.p2.11.m11.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1"><divide id="S4.SS2.p2.11.m11.1.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1"></divide><apply id="S4.SS2.p2.11.m11.1.1.2.cmml" xref="S4.SS2.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.2.1.cmml" xref="S4.SS2.p2.11.m11.1.1.2">superscript</csymbol><ci id="S4.SS2.p2.11.m11.1.1.2.2.cmml" xref="S4.SS2.p2.11.m11.1.1.2.2">𝑒</ci><apply id="S4.SS2.p2.11.m11.1.1.2.3.cmml" xref="S4.SS2.p2.11.m11.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.2.3.1.cmml" xref="S4.SS2.p2.11.m11.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p2.11.m11.1.1.2.3.2.cmml" xref="S4.SS2.p2.11.m11.1.1.2.3.2">𝒂</ci><ci id="S4.SS2.p2.11.m11.1.1.2.3.3.cmml" xref="S4.SS2.p2.11.m11.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S4.SS2.p2.11.m11.1.1.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3"><apply id="S4.SS2.p2.11.m11.1.1.3.1.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.3.1.1.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1">superscript</csymbol><apply id="S4.SS2.p2.11.m11.1.1.3.1.2.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.3.1.2.1.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1">subscript</csymbol><sum id="S4.SS2.p2.11.m11.1.1.3.1.2.2.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1.2.2"></sum><apply id="S4.SS2.p2.11.m11.1.1.3.1.2.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3"><eq id="S4.SS2.p2.11.m11.1.1.3.1.2.3.1.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.1"></eq><ci id="S4.SS2.p2.11.m11.1.1.3.1.2.3.2.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.2">𝑗</ci><cn type="integer" id="S4.SS2.p2.11.m11.1.1.3.1.2.3.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.p2.11.m11.1.1.3.1.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3.1.3">𝐾</ci></apply><apply id="S4.SS2.p2.11.m11.1.1.3.2.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.3.2.1.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2">superscript</csymbol><ci id="S4.SS2.p2.11.m11.1.1.3.2.2.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2.2">𝑒</ci><apply id="S4.SS2.p2.11.m11.1.1.3.2.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.11.m11.1.1.3.2.3.1.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2.3">subscript</csymbol><ci id="S4.SS2.p2.11.m11.1.1.3.2.3.2.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2.3.2">𝒂</ci><ci id="S4.SS2.p2.11.m11.1.1.3.2.3.3.cmml" xref="S4.SS2.p2.11.m11.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m11.1c">\frac{e^{\bm{a}_{k}}}{\sum_{j=1}^{K}e^{\bm{a}_{j}}}</annotation></semantics></math>.
Here, <math id="S4.SS2.p2.12.m12.2" class="ltx_Math" alttext="\bm{a}_{k}=\bm{W}_{:,k}^{\top}\bm{r}" display="inline"><semantics id="S4.SS2.p2.12.m12.2a"><mrow id="S4.SS2.p2.12.m12.2.3" xref="S4.SS2.p2.12.m12.2.3.cmml"><msub id="S4.SS2.p2.12.m12.2.3.2" xref="S4.SS2.p2.12.m12.2.3.2.cmml"><mi id="S4.SS2.p2.12.m12.2.3.2.2" xref="S4.SS2.p2.12.m12.2.3.2.2.cmml">𝒂</mi><mi id="S4.SS2.p2.12.m12.2.3.2.3" xref="S4.SS2.p2.12.m12.2.3.2.3.cmml">k</mi></msub><mo id="S4.SS2.p2.12.m12.2.3.1" xref="S4.SS2.p2.12.m12.2.3.1.cmml">=</mo><mrow id="S4.SS2.p2.12.m12.2.3.3" xref="S4.SS2.p2.12.m12.2.3.3.cmml"><msubsup id="S4.SS2.p2.12.m12.2.3.3.2" xref="S4.SS2.p2.12.m12.2.3.3.2.cmml"><mi id="S4.SS2.p2.12.m12.2.3.3.2.2.2" xref="S4.SS2.p2.12.m12.2.3.3.2.2.2.cmml">𝑾</mi><mrow id="S4.SS2.p2.12.m12.2.2.2.4" xref="S4.SS2.p2.12.m12.2.2.2.3.cmml"><mo rspace="0em" id="S4.SS2.p2.12.m12.1.1.1.1" xref="S4.SS2.p2.12.m12.1.1.1.1.cmml">:</mo><mo id="S4.SS2.p2.12.m12.2.2.2.4.1" xref="S4.SS2.p2.12.m12.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.12.m12.2.2.2.2" xref="S4.SS2.p2.12.m12.2.2.2.2.cmml">k</mi></mrow><mo id="S4.SS2.p2.12.m12.2.3.3.2.3" xref="S4.SS2.p2.12.m12.2.3.3.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S4.SS2.p2.12.m12.2.3.3.1" xref="S4.SS2.p2.12.m12.2.3.3.1.cmml">​</mo><mi id="S4.SS2.p2.12.m12.2.3.3.3" xref="S4.SS2.p2.12.m12.2.3.3.3.cmml">𝒓</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m12.2b"><apply id="S4.SS2.p2.12.m12.2.3.cmml" xref="S4.SS2.p2.12.m12.2.3"><eq id="S4.SS2.p2.12.m12.2.3.1.cmml" xref="S4.SS2.p2.12.m12.2.3.1"></eq><apply id="S4.SS2.p2.12.m12.2.3.2.cmml" xref="S4.SS2.p2.12.m12.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m12.2.3.2.1.cmml" xref="S4.SS2.p2.12.m12.2.3.2">subscript</csymbol><ci id="S4.SS2.p2.12.m12.2.3.2.2.cmml" xref="S4.SS2.p2.12.m12.2.3.2.2">𝒂</ci><ci id="S4.SS2.p2.12.m12.2.3.2.3.cmml" xref="S4.SS2.p2.12.m12.2.3.2.3">𝑘</ci></apply><apply id="S4.SS2.p2.12.m12.2.3.3.cmml" xref="S4.SS2.p2.12.m12.2.3.3"><times id="S4.SS2.p2.12.m12.2.3.3.1.cmml" xref="S4.SS2.p2.12.m12.2.3.3.1"></times><apply id="S4.SS2.p2.12.m12.2.3.3.2.cmml" xref="S4.SS2.p2.12.m12.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m12.2.3.3.2.1.cmml" xref="S4.SS2.p2.12.m12.2.3.3.2">superscript</csymbol><apply id="S4.SS2.p2.12.m12.2.3.3.2.2.cmml" xref="S4.SS2.p2.12.m12.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m12.2.3.3.2.2.1.cmml" xref="S4.SS2.p2.12.m12.2.3.3.2">subscript</csymbol><ci id="S4.SS2.p2.12.m12.2.3.3.2.2.2.cmml" xref="S4.SS2.p2.12.m12.2.3.3.2.2.2">𝑾</ci><list id="S4.SS2.p2.12.m12.2.2.2.3.cmml" xref="S4.SS2.p2.12.m12.2.2.2.4"><ci id="S4.SS2.p2.12.m12.1.1.1.1.cmml" xref="S4.SS2.p2.12.m12.1.1.1.1">:</ci><ci id="S4.SS2.p2.12.m12.2.2.2.2.cmml" xref="S4.SS2.p2.12.m12.2.2.2.2">𝑘</ci></list></apply><csymbol cd="latexml" id="S4.SS2.p2.12.m12.2.3.3.2.3.cmml" xref="S4.SS2.p2.12.m12.2.3.3.2.3">top</csymbol></apply><ci id="S4.SS2.p2.12.m12.2.3.3.3.cmml" xref="S4.SS2.p2.12.m12.2.3.3.3">𝒓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m12.2c">\bm{a}_{k}=\bm{W}_{:,k}^{\top}\bm{r}</annotation></semantics></math> is the <math id="S4.SS2.p2.13.m13.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.13.m13.1a"><mi id="S4.SS2.p2.13.m13.1.1" xref="S4.SS2.p2.13.m13.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m13.1b"><ci id="S4.SS2.p2.13.m13.1.1.cmml" xref="S4.SS2.p2.13.m13.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m13.1c">k</annotation></semantics></math>-th element of the vector <math id="S4.SS2.p2.14.m14.1" class="ltx_Math" alttext="\bm{a}" display="inline"><semantics id="S4.SS2.p2.14.m14.1a"><mi id="S4.SS2.p2.14.m14.1.1" xref="S4.SS2.p2.14.m14.1.1.cmml">𝒂</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m14.1b"><ci id="S4.SS2.p2.14.m14.1.1.cmml" xref="S4.SS2.p2.14.m14.1.1">𝒂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m14.1c">\bm{a}</annotation></semantics></math>, with <math id="S4.SS2.p2.15.m15.2" class="ltx_Math" alttext="\bm{W}_{:,k}" display="inline"><semantics id="S4.SS2.p2.15.m15.2a"><msub id="S4.SS2.p2.15.m15.2.3" xref="S4.SS2.p2.15.m15.2.3.cmml"><mi id="S4.SS2.p2.15.m15.2.3.2" xref="S4.SS2.p2.15.m15.2.3.2.cmml">𝑾</mi><mrow id="S4.SS2.p2.15.m15.2.2.2.4" xref="S4.SS2.p2.15.m15.2.2.2.3.cmml"><mo rspace="0em" id="S4.SS2.p2.15.m15.1.1.1.1" xref="S4.SS2.p2.15.m15.1.1.1.1.cmml">:</mo><mo id="S4.SS2.p2.15.m15.2.2.2.4.1" xref="S4.SS2.p2.15.m15.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.15.m15.2.2.2.2" xref="S4.SS2.p2.15.m15.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m15.2b"><apply id="S4.SS2.p2.15.m15.2.3.cmml" xref="S4.SS2.p2.15.m15.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.15.m15.2.3.1.cmml" xref="S4.SS2.p2.15.m15.2.3">subscript</csymbol><ci id="S4.SS2.p2.15.m15.2.3.2.cmml" xref="S4.SS2.p2.15.m15.2.3.2">𝑾</ci><list id="S4.SS2.p2.15.m15.2.2.2.3.cmml" xref="S4.SS2.p2.15.m15.2.2.2.4"><ci id="S4.SS2.p2.15.m15.1.1.1.1.cmml" xref="S4.SS2.p2.15.m15.1.1.1.1">:</ci><ci id="S4.SS2.p2.15.m15.2.2.2.2.cmml" xref="S4.SS2.p2.15.m15.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m15.2c">\bm{W}_{:,k}</annotation></semantics></math> being the <math id="S4.SS2.p2.16.m16.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.16.m16.1a"><mi id="S4.SS2.p2.16.m16.1.1" xref="S4.SS2.p2.16.m16.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m16.1b"><ci id="S4.SS2.p2.16.m16.1.1.cmml" xref="S4.SS2.p2.16.m16.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m16.1c">k</annotation></semantics></math>-th column of <math id="S4.SS2.p2.17.m17.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S4.SS2.p2.17.m17.1a"><mi id="S4.SS2.p2.17.m17.1.1" xref="S4.SS2.p2.17.m17.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m17.1b"><ci id="S4.SS2.p2.17.m17.1.1.cmml" xref="S4.SS2.p2.17.m17.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m17.1c">\bm{W}</annotation></semantics></math>.
Finally, the cross-entropy loss computed on an input pair <math id="S4.SS2.p2.18.m18.2" class="ltx_Math" alttext="(\bm{x},y)" display="inline"><semantics id="S4.SS2.p2.18.m18.2a"><mrow id="S4.SS2.p2.18.m18.2.3.2" xref="S4.SS2.p2.18.m18.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.18.m18.2.3.2.1" xref="S4.SS2.p2.18.m18.2.3.1.cmml">(</mo><mi id="S4.SS2.p2.18.m18.1.1" xref="S4.SS2.p2.18.m18.1.1.cmml">𝒙</mi><mo id="S4.SS2.p2.18.m18.2.3.2.2" xref="S4.SS2.p2.18.m18.2.3.1.cmml">,</mo><mi id="S4.SS2.p2.18.m18.2.2" xref="S4.SS2.p2.18.m18.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS2.p2.18.m18.2.3.2.3" xref="S4.SS2.p2.18.m18.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.18.m18.2b"><interval closure="open" id="S4.SS2.p2.18.m18.2.3.1.cmml" xref="S4.SS2.p2.18.m18.2.3.2"><ci id="S4.SS2.p2.18.m18.1.1.cmml" xref="S4.SS2.p2.18.m18.1.1">𝒙</ci><ci id="S4.SS2.p2.18.m18.2.2.cmml" xref="S4.SS2.p2.18.m18.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.18.m18.2c">(\bm{x},y)</annotation></semantics></math> is <math id="S4.SS2.p2.19.m19.1" class="ltx_Math" alttext="l=-\log\bm{p}_{y}" display="inline"><semantics id="S4.SS2.p2.19.m19.1a"><mrow id="S4.SS2.p2.19.m19.1.1" xref="S4.SS2.p2.19.m19.1.1.cmml"><mi id="S4.SS2.p2.19.m19.1.1.2" xref="S4.SS2.p2.19.m19.1.1.2.cmml">l</mi><mo id="S4.SS2.p2.19.m19.1.1.1" xref="S4.SS2.p2.19.m19.1.1.1.cmml">=</mo><mrow id="S4.SS2.p2.19.m19.1.1.3" xref="S4.SS2.p2.19.m19.1.1.3.cmml"><mo rspace="0.167em" id="S4.SS2.p2.19.m19.1.1.3a" xref="S4.SS2.p2.19.m19.1.1.3.cmml">−</mo><mrow id="S4.SS2.p2.19.m19.1.1.3.2" xref="S4.SS2.p2.19.m19.1.1.3.2.cmml"><mi id="S4.SS2.p2.19.m19.1.1.3.2.1" xref="S4.SS2.p2.19.m19.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S4.SS2.p2.19.m19.1.1.3.2a" xref="S4.SS2.p2.19.m19.1.1.3.2.cmml">⁡</mo><msub id="S4.SS2.p2.19.m19.1.1.3.2.2" xref="S4.SS2.p2.19.m19.1.1.3.2.2.cmml"><mi id="S4.SS2.p2.19.m19.1.1.3.2.2.2" xref="S4.SS2.p2.19.m19.1.1.3.2.2.2.cmml">𝒑</mi><mi id="S4.SS2.p2.19.m19.1.1.3.2.2.3" xref="S4.SS2.p2.19.m19.1.1.3.2.2.3.cmml">y</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.19.m19.1b"><apply id="S4.SS2.p2.19.m19.1.1.cmml" xref="S4.SS2.p2.19.m19.1.1"><eq id="S4.SS2.p2.19.m19.1.1.1.cmml" xref="S4.SS2.p2.19.m19.1.1.1"></eq><ci id="S4.SS2.p2.19.m19.1.1.2.cmml" xref="S4.SS2.p2.19.m19.1.1.2">𝑙</ci><apply id="S4.SS2.p2.19.m19.1.1.3.cmml" xref="S4.SS2.p2.19.m19.1.1.3"><minus id="S4.SS2.p2.19.m19.1.1.3.1.cmml" xref="S4.SS2.p2.19.m19.1.1.3"></minus><apply id="S4.SS2.p2.19.m19.1.1.3.2.cmml" xref="S4.SS2.p2.19.m19.1.1.3.2"><log id="S4.SS2.p2.19.m19.1.1.3.2.1.cmml" xref="S4.SS2.p2.19.m19.1.1.3.2.1"></log><apply id="S4.SS2.p2.19.m19.1.1.3.2.2.cmml" xref="S4.SS2.p2.19.m19.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m19.1.1.3.2.2.1.cmml" xref="S4.SS2.p2.19.m19.1.1.3.2.2">subscript</csymbol><ci id="S4.SS2.p2.19.m19.1.1.3.2.2.2.cmml" xref="S4.SS2.p2.19.m19.1.1.3.2.2.2">𝒑</ci><ci id="S4.SS2.p2.19.m19.1.1.3.2.2.3.cmml" xref="S4.SS2.p2.19.m19.1.1.3.2.2.3">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.19.m19.1c">l=-\log\bm{p}_{y}</annotation></semantics></math>.
Accordingly, one can derive the gradients of loss w.r.t. each weight vector <math id="S4.SS2.p2.20.m20.2" class="ltx_Math" alttext="\bm{W}_{:,k}" display="inline"><semantics id="S4.SS2.p2.20.m20.2a"><msub id="S4.SS2.p2.20.m20.2.3" xref="S4.SS2.p2.20.m20.2.3.cmml"><mi id="S4.SS2.p2.20.m20.2.3.2" xref="S4.SS2.p2.20.m20.2.3.2.cmml">𝑾</mi><mrow id="S4.SS2.p2.20.m20.2.2.2.4" xref="S4.SS2.p2.20.m20.2.2.2.3.cmml"><mo rspace="0em" id="S4.SS2.p2.20.m20.1.1.1.1" xref="S4.SS2.p2.20.m20.1.1.1.1.cmml">:</mo><mo id="S4.SS2.p2.20.m20.2.2.2.4.1" xref="S4.SS2.p2.20.m20.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.20.m20.2.2.2.2" xref="S4.SS2.p2.20.m20.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.20.m20.2b"><apply id="S4.SS2.p2.20.m20.2.3.cmml" xref="S4.SS2.p2.20.m20.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.20.m20.2.3.1.cmml" xref="S4.SS2.p2.20.m20.2.3">subscript</csymbol><ci id="S4.SS2.p2.20.m20.2.3.2.cmml" xref="S4.SS2.p2.20.m20.2.3.2">𝑾</ci><list id="S4.SS2.p2.20.m20.2.2.2.3.cmml" xref="S4.SS2.p2.20.m20.2.2.2.4"><ci id="S4.SS2.p2.20.m20.1.1.1.1.cmml" xref="S4.SS2.p2.20.m20.1.1.1.1">:</ci><ci id="S4.SS2.p2.20.m20.2.2.2.2.cmml" xref="S4.SS2.p2.20.m20.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.20.m20.2c">\bm{W}_{:,k}</annotation></semantics></math> in the linear layer:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1.m1.2" class="ltx_Math" alttext="\displaystyle\frac{\partial l}{\partial\bm{W}_{:,k}}" display="inline"><semantics id="S4.Ex1.m1.2a"><mstyle displaystyle="true" id="S4.Ex1.m1.2.2" xref="S4.Ex1.m1.2.2.cmml"><mfrac id="S4.Ex1.m1.2.2a" xref="S4.Ex1.m1.2.2.cmml"><mrow id="S4.Ex1.m1.2.2.4" xref="S4.Ex1.m1.2.2.4.cmml"><mo rspace="0em" id="S4.Ex1.m1.2.2.4.1" xref="S4.Ex1.m1.2.2.4.1.cmml">∂</mo><mi id="S4.Ex1.m1.2.2.4.2" xref="S4.Ex1.m1.2.2.4.2.cmml">l</mi></mrow><mrow id="S4.Ex1.m1.2.2.2" xref="S4.Ex1.m1.2.2.2.cmml"><mo rspace="0em" id="S4.Ex1.m1.2.2.2.3" xref="S4.Ex1.m1.2.2.2.3.cmml">∂</mo><msub id="S4.Ex1.m1.2.2.2.4" xref="S4.Ex1.m1.2.2.2.4.cmml"><mi id="S4.Ex1.m1.2.2.2.4.2" xref="S4.Ex1.m1.2.2.2.4.2.cmml">𝑾</mi><mrow id="S4.Ex1.m1.2.2.2.2.2.4" xref="S4.Ex1.m1.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.cmml">:</mo><mo id="S4.Ex1.m1.2.2.2.2.2.4.1" xref="S4.Ex1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.2.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.2.2.cmml">k</mi></mrow></msub></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.2b"><apply id="S4.Ex1.m1.2.2.cmml" xref="S4.Ex1.m1.2.2"><divide id="S4.Ex1.m1.2.2.3.cmml" xref="S4.Ex1.m1.2.2"></divide><apply id="S4.Ex1.m1.2.2.4.cmml" xref="S4.Ex1.m1.2.2.4"><partialdiff id="S4.Ex1.m1.2.2.4.1.cmml" xref="S4.Ex1.m1.2.2.4.1"></partialdiff><ci id="S4.Ex1.m1.2.2.4.2.cmml" xref="S4.Ex1.m1.2.2.4.2">𝑙</ci></apply><apply id="S4.Ex1.m1.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2"><partialdiff id="S4.Ex1.m1.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.3"></partialdiff><apply id="S4.Ex1.m1.2.2.2.4.cmml" xref="S4.Ex1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.2.4.1.cmml" xref="S4.Ex1.m1.2.2.2.4">subscript</csymbol><ci id="S4.Ex1.m1.2.2.2.4.2.cmml" xref="S4.Ex1.m1.2.2.2.4.2">𝑾</ci><list id="S4.Ex1.m1.2.2.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.2.2.4"><ci id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1">:</ci><ci id="S4.Ex1.m1.2.2.2.2.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.2c">\displaystyle\frac{\partial l}{\partial\bm{W}_{:,k}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex1.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{\partial l}{\partial\bm{p}_{y}}\cdot\sum_{j=1}^{K}\frac{\partial\bm{p}_{y}}{\partial\bm{a}_{j}}\cdot\frac{\partial\bm{a}_{j}}{\bm{W}_{:,k}}" display="inline"><semantics id="S4.Ex1.m2.2a"><mrow id="S4.Ex1.m2.2.3" xref="S4.Ex1.m2.2.3.cmml"><mi id="S4.Ex1.m2.2.3.2" xref="S4.Ex1.m2.2.3.2.cmml"></mi><mo id="S4.Ex1.m2.2.3.1" xref="S4.Ex1.m2.2.3.1.cmml">=</mo><mrow id="S4.Ex1.m2.2.3.3" xref="S4.Ex1.m2.2.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.2.3.3.2" xref="S4.Ex1.m2.2.3.3.2.cmml"><mfrac id="S4.Ex1.m2.2.3.3.2a" xref="S4.Ex1.m2.2.3.3.2.cmml"><mrow id="S4.Ex1.m2.2.3.3.2.2" xref="S4.Ex1.m2.2.3.3.2.2.cmml"><mo rspace="0em" id="S4.Ex1.m2.2.3.3.2.2.1" xref="S4.Ex1.m2.2.3.3.2.2.1.cmml">∂</mo><mi id="S4.Ex1.m2.2.3.3.2.2.2" xref="S4.Ex1.m2.2.3.3.2.2.2.cmml">l</mi></mrow><mrow id="S4.Ex1.m2.2.3.3.2.3" xref="S4.Ex1.m2.2.3.3.2.3.cmml"><mo rspace="0em" id="S4.Ex1.m2.2.3.3.2.3.1" xref="S4.Ex1.m2.2.3.3.2.3.1.cmml">∂</mo><msub id="S4.Ex1.m2.2.3.3.2.3.2" xref="S4.Ex1.m2.2.3.3.2.3.2.cmml"><mi id="S4.Ex1.m2.2.3.3.2.3.2.2" xref="S4.Ex1.m2.2.3.3.2.3.2.2.cmml">𝒑</mi><mi id="S4.Ex1.m2.2.3.3.2.3.2.3" xref="S4.Ex1.m2.2.3.3.2.3.2.3.cmml">y</mi></msub></mrow></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m2.2.3.3.1" xref="S4.Ex1.m2.2.3.3.1.cmml">⋅</mo><mrow id="S4.Ex1.m2.2.3.3.3" xref="S4.Ex1.m2.2.3.3.3.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.2.3.3.3.1" xref="S4.Ex1.m2.2.3.3.3.1.cmml"><munderover id="S4.Ex1.m2.2.3.3.3.1a" xref="S4.Ex1.m2.2.3.3.3.1.cmml"><mo movablelimits="false" id="S4.Ex1.m2.2.3.3.3.1.2.2" xref="S4.Ex1.m2.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S4.Ex1.m2.2.3.3.3.1.2.3" xref="S4.Ex1.m2.2.3.3.3.1.2.3.cmml"><mi id="S4.Ex1.m2.2.3.3.3.1.2.3.2" xref="S4.Ex1.m2.2.3.3.3.1.2.3.2.cmml">j</mi><mo id="S4.Ex1.m2.2.3.3.3.1.2.3.1" xref="S4.Ex1.m2.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S4.Ex1.m2.2.3.3.3.1.2.3.3" xref="S4.Ex1.m2.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex1.m2.2.3.3.3.1.3" xref="S4.Ex1.m2.2.3.3.3.1.3.cmml">K</mi></munderover></mstyle><mrow id="S4.Ex1.m2.2.3.3.3.2" xref="S4.Ex1.m2.2.3.3.3.2.cmml"><mstyle displaystyle="true" id="S4.Ex1.m2.2.3.3.3.2.2" xref="S4.Ex1.m2.2.3.3.3.2.2.cmml"><mfrac id="S4.Ex1.m2.2.3.3.3.2.2a" xref="S4.Ex1.m2.2.3.3.3.2.2.cmml"><mrow id="S4.Ex1.m2.2.3.3.3.2.2.2" xref="S4.Ex1.m2.2.3.3.3.2.2.2.cmml"><mo rspace="0em" id="S4.Ex1.m2.2.3.3.3.2.2.2.1" xref="S4.Ex1.m2.2.3.3.3.2.2.2.1.cmml">∂</mo><msub id="S4.Ex1.m2.2.3.3.3.2.2.2.2" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2.cmml"><mi id="S4.Ex1.m2.2.3.3.3.2.2.2.2.2" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2.2.cmml">𝒑</mi><mi id="S4.Ex1.m2.2.3.3.3.2.2.2.2.3" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2.3.cmml">y</mi></msub></mrow><mrow id="S4.Ex1.m2.2.3.3.3.2.2.3" xref="S4.Ex1.m2.2.3.3.3.2.2.3.cmml"><mo rspace="0em" id="S4.Ex1.m2.2.3.3.3.2.2.3.1" xref="S4.Ex1.m2.2.3.3.3.2.2.3.1.cmml">∂</mo><msub id="S4.Ex1.m2.2.3.3.3.2.2.3.2" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2.cmml"><mi id="S4.Ex1.m2.2.3.3.3.2.2.3.2.2" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2.2.cmml">𝒂</mi><mi id="S4.Ex1.m2.2.3.3.3.2.2.3.2.3" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S4.Ex1.m2.2.3.3.3.2.1" xref="S4.Ex1.m2.2.3.3.3.2.1.cmml">⋅</mo><mstyle displaystyle="true" id="S4.Ex1.m2.2.2" xref="S4.Ex1.m2.2.2.cmml"><mfrac id="S4.Ex1.m2.2.2a" xref="S4.Ex1.m2.2.2.cmml"><mrow id="S4.Ex1.m2.2.2.4" xref="S4.Ex1.m2.2.2.4.cmml"><mo rspace="0em" id="S4.Ex1.m2.2.2.4.1" xref="S4.Ex1.m2.2.2.4.1.cmml">∂</mo><msub id="S4.Ex1.m2.2.2.4.2" xref="S4.Ex1.m2.2.2.4.2.cmml"><mi id="S4.Ex1.m2.2.2.4.2.2" xref="S4.Ex1.m2.2.2.4.2.2.cmml">𝒂</mi><mi id="S4.Ex1.m2.2.2.4.2.3" xref="S4.Ex1.m2.2.2.4.2.3.cmml">j</mi></msub></mrow><msub id="S4.Ex1.m2.2.2.2" xref="S4.Ex1.m2.2.2.2.cmml"><mi id="S4.Ex1.m2.2.2.2.4" xref="S4.Ex1.m2.2.2.2.4.cmml">𝑾</mi><mrow id="S4.Ex1.m2.2.2.2.2.2.4" xref="S4.Ex1.m2.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.Ex1.m2.1.1.1.1.1.1" xref="S4.Ex1.m2.1.1.1.1.1.1.cmml">:</mo><mo id="S4.Ex1.m2.2.2.2.2.2.4.1" xref="S4.Ex1.m2.2.2.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m2.2.2.2.2.2.2" xref="S4.Ex1.m2.2.2.2.2.2.2.cmml">k</mi></mrow></msub></mfrac></mstyle></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m2.2b"><apply id="S4.Ex1.m2.2.3.cmml" xref="S4.Ex1.m2.2.3"><eq id="S4.Ex1.m2.2.3.1.cmml" xref="S4.Ex1.m2.2.3.1"></eq><csymbol cd="latexml" id="S4.Ex1.m2.2.3.2.cmml" xref="S4.Ex1.m2.2.3.2">absent</csymbol><apply id="S4.Ex1.m2.2.3.3.cmml" xref="S4.Ex1.m2.2.3.3"><ci id="S4.Ex1.m2.2.3.3.1.cmml" xref="S4.Ex1.m2.2.3.3.1">⋅</ci><apply id="S4.Ex1.m2.2.3.3.2.cmml" xref="S4.Ex1.m2.2.3.3.2"><divide id="S4.Ex1.m2.2.3.3.2.1.cmml" xref="S4.Ex1.m2.2.3.3.2"></divide><apply id="S4.Ex1.m2.2.3.3.2.2.cmml" xref="S4.Ex1.m2.2.3.3.2.2"><partialdiff id="S4.Ex1.m2.2.3.3.2.2.1.cmml" xref="S4.Ex1.m2.2.3.3.2.2.1"></partialdiff><ci id="S4.Ex1.m2.2.3.3.2.2.2.cmml" xref="S4.Ex1.m2.2.3.3.2.2.2">𝑙</ci></apply><apply id="S4.Ex1.m2.2.3.3.2.3.cmml" xref="S4.Ex1.m2.2.3.3.2.3"><partialdiff id="S4.Ex1.m2.2.3.3.2.3.1.cmml" xref="S4.Ex1.m2.2.3.3.2.3.1"></partialdiff><apply id="S4.Ex1.m2.2.3.3.2.3.2.cmml" xref="S4.Ex1.m2.2.3.3.2.3.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.3.3.2.3.2.1.cmml" xref="S4.Ex1.m2.2.3.3.2.3.2">subscript</csymbol><ci id="S4.Ex1.m2.2.3.3.2.3.2.2.cmml" xref="S4.Ex1.m2.2.3.3.2.3.2.2">𝒑</ci><ci id="S4.Ex1.m2.2.3.3.2.3.2.3.cmml" xref="S4.Ex1.m2.2.3.3.2.3.2.3">𝑦</ci></apply></apply></apply><apply id="S4.Ex1.m2.2.3.3.3.cmml" xref="S4.Ex1.m2.2.3.3.3"><apply id="S4.Ex1.m2.2.3.3.3.1.cmml" xref="S4.Ex1.m2.2.3.3.3.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.3.3.3.1.1.cmml" xref="S4.Ex1.m2.2.3.3.3.1">superscript</csymbol><apply id="S4.Ex1.m2.2.3.3.3.1.2.cmml" xref="S4.Ex1.m2.2.3.3.3.1"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.3.3.3.1.2.1.cmml" xref="S4.Ex1.m2.2.3.3.3.1">subscript</csymbol><sum id="S4.Ex1.m2.2.3.3.3.1.2.2.cmml" xref="S4.Ex1.m2.2.3.3.3.1.2.2"></sum><apply id="S4.Ex1.m2.2.3.3.3.1.2.3.cmml" xref="S4.Ex1.m2.2.3.3.3.1.2.3"><eq id="S4.Ex1.m2.2.3.3.3.1.2.3.1.cmml" xref="S4.Ex1.m2.2.3.3.3.1.2.3.1"></eq><ci id="S4.Ex1.m2.2.3.3.3.1.2.3.2.cmml" xref="S4.Ex1.m2.2.3.3.3.1.2.3.2">𝑗</ci><cn type="integer" id="S4.Ex1.m2.2.3.3.3.1.2.3.3.cmml" xref="S4.Ex1.m2.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex1.m2.2.3.3.3.1.3.cmml" xref="S4.Ex1.m2.2.3.3.3.1.3">𝐾</ci></apply><apply id="S4.Ex1.m2.2.3.3.3.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2"><ci id="S4.Ex1.m2.2.3.3.3.2.1.cmml" xref="S4.Ex1.m2.2.3.3.3.2.1">⋅</ci><apply id="S4.Ex1.m2.2.3.3.3.2.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2"><divide id="S4.Ex1.m2.2.3.3.3.2.2.1.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2"></divide><apply id="S4.Ex1.m2.2.3.3.3.2.2.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.2"><partialdiff id="S4.Ex1.m2.2.3.3.3.2.2.2.1.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.2.1"></partialdiff><apply id="S4.Ex1.m2.2.3.3.3.2.2.2.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.3.3.3.2.2.2.2.1.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2">subscript</csymbol><ci id="S4.Ex1.m2.2.3.3.3.2.2.2.2.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2.2">𝒑</ci><ci id="S4.Ex1.m2.2.3.3.3.2.2.2.2.3.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.2.2.3">𝑦</ci></apply></apply><apply id="S4.Ex1.m2.2.3.3.3.2.2.3.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.3"><partialdiff id="S4.Ex1.m2.2.3.3.3.2.2.3.1.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.3.1"></partialdiff><apply id="S4.Ex1.m2.2.3.3.3.2.2.3.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.3.3.3.2.2.3.2.1.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2">subscript</csymbol><ci id="S4.Ex1.m2.2.3.3.3.2.2.3.2.2.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2.2">𝒂</ci><ci id="S4.Ex1.m2.2.3.3.3.2.2.3.2.3.cmml" xref="S4.Ex1.m2.2.3.3.3.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S4.Ex1.m2.2.2.cmml" xref="S4.Ex1.m2.2.2"><divide id="S4.Ex1.m2.2.2.3.cmml" xref="S4.Ex1.m2.2.2"></divide><apply id="S4.Ex1.m2.2.2.4.cmml" xref="S4.Ex1.m2.2.2.4"><partialdiff id="S4.Ex1.m2.2.2.4.1.cmml" xref="S4.Ex1.m2.2.2.4.1"></partialdiff><apply id="S4.Ex1.m2.2.2.4.2.cmml" xref="S4.Ex1.m2.2.2.4.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.2.4.2.1.cmml" xref="S4.Ex1.m2.2.2.4.2">subscript</csymbol><ci id="S4.Ex1.m2.2.2.4.2.2.cmml" xref="S4.Ex1.m2.2.2.4.2.2">𝒂</ci><ci id="S4.Ex1.m2.2.2.4.2.3.cmml" xref="S4.Ex1.m2.2.2.4.2.3">𝑗</ci></apply></apply><apply id="S4.Ex1.m2.2.2.2.cmml" xref="S4.Ex1.m2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m2.2.2.2.3.cmml" xref="S4.Ex1.m2.2.2.2">subscript</csymbol><ci id="S4.Ex1.m2.2.2.2.4.cmml" xref="S4.Ex1.m2.2.2.2.4">𝑾</ci><list id="S4.Ex1.m2.2.2.2.2.2.3.cmml" xref="S4.Ex1.m2.2.2.2.2.2.4"><ci id="S4.Ex1.m2.1.1.1.1.1.1.cmml" xref="S4.Ex1.m2.1.1.1.1.1.1">:</ci><ci id="S4.Ex1.m2.2.2.2.2.2.2.cmml" xref="S4.Ex1.m2.2.2.2.2.2.2">𝑘</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m2.2c">\displaystyle=\frac{\partial l}{\partial\bm{p}_{y}}\cdot\sum_{j=1}^{K}\frac{\partial\bm{p}_{y}}{\partial\bm{a}_{j}}\cdot\frac{\partial\bm{a}_{j}}{\bm{W}_{:,k}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E3.m1.5" class="ltx_Math" alttext="\displaystyle=\begin{cases}-(1-\bm{p}_{y})\bm{r},&amp;k=y\\
~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}\bm{p}_{k}\bm{r},&amp;k\neq y\end{cases}." display="inline"><semantics id="S4.E3.m1.5a"><mrow id="S4.E3.m1.5.5.1" xref="S4.E3.m1.5.5.1.1.cmml"><mrow id="S4.E3.m1.5.5.1.1" xref="S4.E3.m1.5.5.1.1.cmml"><mi id="S4.E3.m1.5.5.1.1.2" xref="S4.E3.m1.5.5.1.1.2.cmml"></mi><mo id="S4.E3.m1.5.5.1.1.1" xref="S4.E3.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.4.4a" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mo id="S4.E3.m1.4.4a.5" xref="S4.E3.m1.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E3.m1.4.4.4a" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mtr id="S4.E3.m1.4.4.4aa" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4ab" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.1.1.1a" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝒑</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">y</mi></msub></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝒓</mi></mrow></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4ac" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E3.m1.2.2.2.2.2.1" xref="S4.E3.m1.2.2.2.2.2.1.cmml"><mi id="S4.E3.m1.2.2.2.2.2.1.2" xref="S4.E3.m1.2.2.2.2.2.1.2.cmml">k</mi><mo id="S4.E3.m1.2.2.2.2.2.1.1" xref="S4.E3.m1.2.2.2.2.2.1.1.cmml">=</mo><mi id="S4.E3.m1.2.2.2.2.2.1.3" xref="S4.E3.m1.2.2.2.2.2.1.3.cmml">y</mi></mrow></mtd></mtr><mtr id="S4.E3.m1.4.4.4ad" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4ae" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E3.m1.3.3.3.3.1.1.1" xref="S4.E3.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S4.E3.m1.3.3.3.3.1.1.1.1" xref="S4.E3.m1.3.3.3.3.1.1.1.1.cmml"><msub id="S4.E3.m1.3.3.3.3.1.1.1.1.2" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2.cmml"><mi id="S4.E3.m1.3.3.3.3.1.1.1.1.2.2" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2.2.cmml">𝒑</mi><mi id="S4.E3.m1.3.3.3.3.1.1.1.1.2.3" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.3.3.1.1.1.1.1" xref="S4.E3.m1.3.3.3.3.1.1.1.1.1.cmml">​</mo><mi id="S4.E3.m1.3.3.3.3.1.1.1.1.3" xref="S4.E3.m1.3.3.3.3.1.1.1.1.3.cmml">𝒓</mi></mrow><mo id="S4.E3.m1.3.3.3.3.1.1.1.2" xref="S4.E3.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m1.4.4.4af" xref="S4.E3.m1.5.5.1.1.3.1.cmml"><mrow id="S4.E3.m1.4.4.4.4.2.1" xref="S4.E3.m1.4.4.4.4.2.1.cmml"><mi id="S4.E3.m1.4.4.4.4.2.1.2" xref="S4.E3.m1.4.4.4.4.2.1.2.cmml">k</mi><mo id="S4.E3.m1.4.4.4.4.2.1.1" xref="S4.E3.m1.4.4.4.4.2.1.1.cmml">≠</mo><mi id="S4.E3.m1.4.4.4.4.2.1.3" xref="S4.E3.m1.4.4.4.4.2.1.3.cmml">y</mi></mrow></mtd></mtr></mtable></mrow></mrow><mo lspace="0em" id="S4.E3.m1.5.5.1.2" xref="S4.E3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.5b"><apply id="S4.E3.m1.5.5.1.1.cmml" xref="S4.E3.m1.5.5.1"><eq id="S4.E3.m1.5.5.1.1.1.cmml" xref="S4.E3.m1.5.5.1.1.1"></eq><csymbol cd="latexml" id="S4.E3.m1.5.5.1.1.2.cmml" xref="S4.E3.m1.5.5.1.1.2">absent</csymbol><apply id="S4.E3.m1.5.5.1.1.3.1.cmml" xref="S4.E3.m1.4.4a"><csymbol cd="latexml" id="S4.E3.m1.5.5.1.1.3.1.1.cmml" xref="S4.E3.m1.4.4a.5">cases</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝒑</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑦</ci></apply></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.3">𝒓</ci></apply></apply><apply id="S4.E3.m1.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.1"><eq id="S4.E3.m1.2.2.2.2.2.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.1.1"></eq><ci id="S4.E3.m1.2.2.2.2.2.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.1.2">𝑘</ci><ci id="S4.E3.m1.2.2.2.2.2.1.3.cmml" xref="S4.E3.m1.2.2.2.2.2.1.3">𝑦</ci></apply><apply id="S4.E3.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1"><times id="S4.E3.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.1.1"></times><apply id="S4.E3.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.1.1.1.1.2.1.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.3.3.3.3.1.1.1.1.2.2.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2.2">𝒑</ci><ci id="S4.E3.m1.3.3.3.3.1.1.1.1.2.3.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.1.2.3">𝑘</ci></apply><ci id="S4.E3.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.1.3">𝒓</ci></apply><apply id="S4.E3.m1.4.4.4.4.2.1.cmml" xref="S4.E3.m1.4.4.4.4.2.1"><neq id="S4.E3.m1.4.4.4.4.2.1.1.cmml" xref="S4.E3.m1.4.4.4.4.2.1.1"></neq><ci id="S4.E3.m1.4.4.4.4.2.1.2.cmml" xref="S4.E3.m1.4.4.4.4.2.1.2">𝑘</ci><ci id="S4.E3.m1.4.4.4.4.2.1.3.cmml" xref="S4.E3.m1.4.4.4.4.2.1.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.5c">\displaystyle=\begin{cases}-(1-\bm{p}_{y})\bm{r},&amp;k=y\\
~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}~{}\bm{p}_{k}\bm{r},&amp;k\neq y\end{cases}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.10" class="ltx_p">Based on the derivation in <a href="#S4.E3" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we now discuss how one can restore the features from the batch-averaged gradients w.r.t. the linear layer’s weights.
We consider a batch of <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">N</annotation></semantics></math> inputs <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\bm{x}_{i}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><msub id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">𝒙</mi><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝒙</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\bm{x}_{i}</annotation></semantics></math>, each with a corresponding feature vector <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">𝒓</mi><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝒓</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\bm{r}_{i}</annotation></semantics></math>.
Note, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, here we assume that there are no samples sharing the same label within the batch.
This assumption generally holds for the randomly constructed batch when the size <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">N</annotation></semantics></math> is (much) smaller than the number of classes <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">K</annotation></semantics></math> (<em id="S4.SS2.p3.10.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS2.p3.10.2" class="ltx_text"></span>, on ImageNet <math id="S4.SS2.p3.6.m6.1" class="ltx_Math" alttext="K=1000" display="inline"><semantics id="S4.SS2.p3.6.m6.1a"><mrow id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2" xref="S4.SS2.p3.6.m6.1.1.2.cmml">K</mi><mo id="S4.SS2.p3.6.m6.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.1b"><apply id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1"><eq id="S4.SS2.p3.6.m6.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1"></eq><ci id="S4.SS2.p3.6.m6.1.1.2.cmml" xref="S4.SS2.p3.6.m6.1.1.2">𝐾</ci><cn type="integer" id="S4.SS2.p3.6.m6.1.1.3.cmml" xref="S4.SS2.p3.6.m6.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.1c">K=1000</annotation></semantics></math> while <math id="S4.SS2.p3.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p3.7.m7.1a"><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">N</annotation></semantics></math> typically takes 256 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>).
Then, suppose that we want to restore the feature vector <math id="S4.SS2.p3.8.m8.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="S4.SS2.p3.8.m8.1a"><msub id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml"><mi id="S4.SS2.p3.8.m8.1.1.2" xref="S4.SS2.p3.8.m8.1.1.2.cmml">𝒓</mi><mi id="S4.SS2.p3.8.m8.1.1.3" xref="S4.SS2.p3.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><apply id="S4.SS2.p3.8.m8.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p3.8.m8.1.1.2.cmml" xref="S4.SS2.p3.8.m8.1.1.2">𝒓</ci><ci id="S4.SS2.p3.8.m8.1.1.3.cmml" xref="S4.SS2.p3.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">\bm{r}_{i}</annotation></semantics></math> whose corresponding label is <math id="S4.SS2.p3.9.m9.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS2.p3.9.m9.1a"><msub id="S4.SS2.p3.9.m9.1.1" xref="S4.SS2.p3.9.m9.1.1.cmml"><mi id="S4.SS2.p3.9.m9.1.1.2" xref="S4.SS2.p3.9.m9.1.1.2.cmml">y</mi><mi id="S4.SS2.p3.9.m9.1.1.3" xref="S4.SS2.p3.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m9.1b"><apply id="S4.SS2.p3.9.m9.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.9.m9.1.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p3.9.m9.1.1.2.cmml" xref="S4.SS2.p3.9.m9.1.1.2">𝑦</ci><ci id="S4.SS2.p3.9.m9.1.1.3.cmml" xref="S4.SS2.p3.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m9.1c">y_{i}</annotation></semantics></math>, we can directly take the gradients w.r.t. the weight vector <math id="S4.SS2.p3.10.m10.2" class="ltx_Math" alttext="\bm{W}_{:,y_{i}}" display="inline"><semantics id="S4.SS2.p3.10.m10.2a"><msub id="S4.SS2.p3.10.m10.2.3" xref="S4.SS2.p3.10.m10.2.3.cmml"><mi id="S4.SS2.p3.10.m10.2.3.2" xref="S4.SS2.p3.10.m10.2.3.2.cmml">𝑾</mi><mrow id="S4.SS2.p3.10.m10.2.2.2.2" xref="S4.SS2.p3.10.m10.2.2.2.3.cmml"><mo rspace="0em" id="S4.SS2.p3.10.m10.1.1.1.1" xref="S4.SS2.p3.10.m10.1.1.1.1.cmml">:</mo><mo id="S4.SS2.p3.10.m10.2.2.2.2.2" xref="S4.SS2.p3.10.m10.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p3.10.m10.2.2.2.2.1" xref="S4.SS2.p3.10.m10.2.2.2.2.1.cmml"><mi id="S4.SS2.p3.10.m10.2.2.2.2.1.2" xref="S4.SS2.p3.10.m10.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS2.p3.10.m10.2.2.2.2.1.3" xref="S4.SS2.p3.10.m10.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m10.2b"><apply id="S4.SS2.p3.10.m10.2.3.cmml" xref="S4.SS2.p3.10.m10.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.10.m10.2.3.1.cmml" xref="S4.SS2.p3.10.m10.2.3">subscript</csymbol><ci id="S4.SS2.p3.10.m10.2.3.2.cmml" xref="S4.SS2.p3.10.m10.2.3.2">𝑾</ci><list id="S4.SS2.p3.10.m10.2.2.2.3.cmml" xref="S4.SS2.p3.10.m10.2.2.2.2"><ci id="S4.SS2.p3.10.m10.1.1.1.1.cmml" xref="S4.SS2.p3.10.m10.1.1.1.1">:</ci><apply id="S4.SS2.p3.10.m10.2.2.2.2.1.cmml" xref="S4.SS2.p3.10.m10.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p3.10.m10.2.2.2.2.1.1.cmml" xref="S4.SS2.p3.10.m10.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p3.10.m10.2.2.2.2.1.2.cmml" xref="S4.SS2.p3.10.m10.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS2.p3.10.m10.2.2.2.2.1.3.cmml" xref="S4.SS2.p3.10.m10.2.2.2.2.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m10.2c">\bm{W}_{:,y_{i}}</annotation></semantics></math>:</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex2.m1.1" class="ltx_Math" alttext="\displaystyle\hat{\bm{r}}_{i}" display="inline"><semantics id="S4.Ex2.m1.1a"><msub id="S4.Ex2.m1.1.1" xref="S4.Ex2.m1.1.1.cmml"><mover accent="true" id="S4.Ex2.m1.1.1.2" xref="S4.Ex2.m1.1.1.2.cmml"><mi id="S4.Ex2.m1.1.1.2.2" xref="S4.Ex2.m1.1.1.2.2.cmml">𝒓</mi><mo id="S4.Ex2.m1.1.1.2.1" xref="S4.Ex2.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.Ex2.m1.1.1.3" xref="S4.Ex2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.Ex2.m1.1b"><apply id="S4.Ex2.m1.1.1.cmml" xref="S4.Ex2.m1.1.1"><csymbol cd="ambiguous" id="S4.Ex2.m1.1.1.1.cmml" xref="S4.Ex2.m1.1.1">subscript</csymbol><apply id="S4.Ex2.m1.1.1.2.cmml" xref="S4.Ex2.m1.1.1.2"><ci id="S4.Ex2.m1.1.1.2.1.cmml" xref="S4.Ex2.m1.1.1.2.1">^</ci><ci id="S4.Ex2.m1.1.1.2.2.cmml" xref="S4.Ex2.m1.1.1.2.2">𝒓</ci></apply><ci id="S4.Ex2.m1.1.1.3.cmml" xref="S4.Ex2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m1.1c">\displaystyle\hat{\bm{r}}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex2.m2.4" class="ltx_Math" alttext="\displaystyle\coloneqq\Delta_{\bm{W}_{:,y_{i}}}=\frac{1}{N}\sum_{j=1}^{N}\frac{\partial l_{j}}{\partial\bm{W}_{:,y_{i}}}" display="inline"><semantics id="S4.Ex2.m2.4a"><mrow id="S4.Ex2.m2.4.5" xref="S4.Ex2.m2.4.5.cmml"><mi id="S4.Ex2.m2.4.5.2" xref="S4.Ex2.m2.4.5.2.cmml"></mi><mo id="S4.Ex2.m2.4.5.3" xref="S4.Ex2.m2.4.5.3.cmml">≔</mo><msub id="S4.Ex2.m2.4.5.4" xref="S4.Ex2.m2.4.5.4.cmml"><mi mathvariant="normal" id="S4.Ex2.m2.4.5.4.2" xref="S4.Ex2.m2.4.5.4.2.cmml">Δ</mi><msub id="S4.Ex2.m2.2.2.2" xref="S4.Ex2.m2.2.2.2.cmml"><mi id="S4.Ex2.m2.2.2.2.4" xref="S4.Ex2.m2.2.2.2.4.cmml">𝑾</mi><mrow id="S4.Ex2.m2.2.2.2.2.2.2" xref="S4.Ex2.m2.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.Ex2.m2.1.1.1.1.1.1" xref="S4.Ex2.m2.1.1.1.1.1.1.cmml">:</mo><mo id="S4.Ex2.m2.2.2.2.2.2.2.2" xref="S4.Ex2.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.Ex2.m2.2.2.2.2.2.2.1" xref="S4.Ex2.m2.2.2.2.2.2.2.1.cmml"><mi id="S4.Ex2.m2.2.2.2.2.2.2.1.2" xref="S4.Ex2.m2.2.2.2.2.2.2.1.2.cmml">y</mi><mi id="S4.Ex2.m2.2.2.2.2.2.2.1.3" xref="S4.Ex2.m2.2.2.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></msub><mo id="S4.Ex2.m2.4.5.5" xref="S4.Ex2.m2.4.5.5.cmml">=</mo><mrow id="S4.Ex2.m2.4.5.6" xref="S4.Ex2.m2.4.5.6.cmml"><mstyle displaystyle="true" id="S4.Ex2.m2.4.5.6.2" xref="S4.Ex2.m2.4.5.6.2.cmml"><mfrac id="S4.Ex2.m2.4.5.6.2a" xref="S4.Ex2.m2.4.5.6.2.cmml"><mn id="S4.Ex2.m2.4.5.6.2.2" xref="S4.Ex2.m2.4.5.6.2.2.cmml">1</mn><mi id="S4.Ex2.m2.4.5.6.2.3" xref="S4.Ex2.m2.4.5.6.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.Ex2.m2.4.5.6.1" xref="S4.Ex2.m2.4.5.6.1.cmml">​</mo><mrow id="S4.Ex2.m2.4.5.6.3" xref="S4.Ex2.m2.4.5.6.3.cmml"><mstyle displaystyle="true" id="S4.Ex2.m2.4.5.6.3.1" xref="S4.Ex2.m2.4.5.6.3.1.cmml"><munderover id="S4.Ex2.m2.4.5.6.3.1a" xref="S4.Ex2.m2.4.5.6.3.1.cmml"><mo movablelimits="false" id="S4.Ex2.m2.4.5.6.3.1.2.2" xref="S4.Ex2.m2.4.5.6.3.1.2.2.cmml">∑</mo><mrow id="S4.Ex2.m2.4.5.6.3.1.2.3" xref="S4.Ex2.m2.4.5.6.3.1.2.3.cmml"><mi id="S4.Ex2.m2.4.5.6.3.1.2.3.2" xref="S4.Ex2.m2.4.5.6.3.1.2.3.2.cmml">j</mi><mo id="S4.Ex2.m2.4.5.6.3.1.2.3.1" xref="S4.Ex2.m2.4.5.6.3.1.2.3.1.cmml">=</mo><mn id="S4.Ex2.m2.4.5.6.3.1.2.3.3" xref="S4.Ex2.m2.4.5.6.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex2.m2.4.5.6.3.1.3" xref="S4.Ex2.m2.4.5.6.3.1.3.cmml">N</mi></munderover></mstyle><mstyle displaystyle="true" id="S4.Ex2.m2.4.4" xref="S4.Ex2.m2.4.4.cmml"><mfrac id="S4.Ex2.m2.4.4a" xref="S4.Ex2.m2.4.4.cmml"><mrow id="S4.Ex2.m2.4.4.4" xref="S4.Ex2.m2.4.4.4.cmml"><mo rspace="0em" id="S4.Ex2.m2.4.4.4.1" xref="S4.Ex2.m2.4.4.4.1.cmml">∂</mo><msub id="S4.Ex2.m2.4.4.4.2" xref="S4.Ex2.m2.4.4.4.2.cmml"><mi id="S4.Ex2.m2.4.4.4.2.2" xref="S4.Ex2.m2.4.4.4.2.2.cmml">l</mi><mi id="S4.Ex2.m2.4.4.4.2.3" xref="S4.Ex2.m2.4.4.4.2.3.cmml">j</mi></msub></mrow><mrow id="S4.Ex2.m2.4.4.2" xref="S4.Ex2.m2.4.4.2.cmml"><mo rspace="0em" id="S4.Ex2.m2.4.4.2.3" xref="S4.Ex2.m2.4.4.2.3.cmml">∂</mo><msub id="S4.Ex2.m2.4.4.2.4" xref="S4.Ex2.m2.4.4.2.4.cmml"><mi id="S4.Ex2.m2.4.4.2.4.2" xref="S4.Ex2.m2.4.4.2.4.2.cmml">𝑾</mi><mrow id="S4.Ex2.m2.4.4.2.2.2.2" xref="S4.Ex2.m2.4.4.2.2.2.3.cmml"><mo rspace="0em" id="S4.Ex2.m2.3.3.1.1.1.1" xref="S4.Ex2.m2.3.3.1.1.1.1.cmml">:</mo><mo id="S4.Ex2.m2.4.4.2.2.2.2.2" xref="S4.Ex2.m2.4.4.2.2.2.3.cmml">,</mo><msub id="S4.Ex2.m2.4.4.2.2.2.2.1" xref="S4.Ex2.m2.4.4.2.2.2.2.1.cmml"><mi id="S4.Ex2.m2.4.4.2.2.2.2.1.2" xref="S4.Ex2.m2.4.4.2.2.2.2.1.2.cmml">y</mi><mi id="S4.Ex2.m2.4.4.2.2.2.2.1.3" xref="S4.Ex2.m2.4.4.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex2.m2.4b"><apply id="S4.Ex2.m2.4.5.cmml" xref="S4.Ex2.m2.4.5"><and id="S4.Ex2.m2.4.5a.cmml" xref="S4.Ex2.m2.4.5"></and><apply id="S4.Ex2.m2.4.5b.cmml" xref="S4.Ex2.m2.4.5"><ci id="S4.Ex2.m2.4.5.3.cmml" xref="S4.Ex2.m2.4.5.3">≔</ci><csymbol cd="latexml" id="S4.Ex2.m2.4.5.2.cmml" xref="S4.Ex2.m2.4.5.2">absent</csymbol><apply id="S4.Ex2.m2.4.5.4.cmml" xref="S4.Ex2.m2.4.5.4"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.4.1.cmml" xref="S4.Ex2.m2.4.5.4">subscript</csymbol><ci id="S4.Ex2.m2.4.5.4.2.cmml" xref="S4.Ex2.m2.4.5.4.2">Δ</ci><apply id="S4.Ex2.m2.2.2.2.cmml" xref="S4.Ex2.m2.2.2.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.2.2.2.3.cmml" xref="S4.Ex2.m2.2.2.2">subscript</csymbol><ci id="S4.Ex2.m2.2.2.2.4.cmml" xref="S4.Ex2.m2.2.2.2.4">𝑾</ci><list id="S4.Ex2.m2.2.2.2.2.2.3.cmml" xref="S4.Ex2.m2.2.2.2.2.2.2"><ci id="S4.Ex2.m2.1.1.1.1.1.1.cmml" xref="S4.Ex2.m2.1.1.1.1.1.1">:</ci><apply id="S4.Ex2.m2.2.2.2.2.2.2.1.cmml" xref="S4.Ex2.m2.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.2.2.2.2.2.2.1.1.cmml" xref="S4.Ex2.m2.2.2.2.2.2.2.1">subscript</csymbol><ci id="S4.Ex2.m2.2.2.2.2.2.2.1.2.cmml" xref="S4.Ex2.m2.2.2.2.2.2.2.1.2">𝑦</ci><ci id="S4.Ex2.m2.2.2.2.2.2.2.1.3.cmml" xref="S4.Ex2.m2.2.2.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply></apply><apply id="S4.Ex2.m2.4.5c.cmml" xref="S4.Ex2.m2.4.5"><eq id="S4.Ex2.m2.4.5.5.cmml" xref="S4.Ex2.m2.4.5.5"></eq><share href="#S4.Ex2.m2.4.5.4.cmml" id="S4.Ex2.m2.4.5d.cmml" xref="S4.Ex2.m2.4.5"></share><apply id="S4.Ex2.m2.4.5.6.cmml" xref="S4.Ex2.m2.4.5.6"><times id="S4.Ex2.m2.4.5.6.1.cmml" xref="S4.Ex2.m2.4.5.6.1"></times><apply id="S4.Ex2.m2.4.5.6.2.cmml" xref="S4.Ex2.m2.4.5.6.2"><divide id="S4.Ex2.m2.4.5.6.2.1.cmml" xref="S4.Ex2.m2.4.5.6.2"></divide><cn type="integer" id="S4.Ex2.m2.4.5.6.2.2.cmml" xref="S4.Ex2.m2.4.5.6.2.2">1</cn><ci id="S4.Ex2.m2.4.5.6.2.3.cmml" xref="S4.Ex2.m2.4.5.6.2.3">𝑁</ci></apply><apply id="S4.Ex2.m2.4.5.6.3.cmml" xref="S4.Ex2.m2.4.5.6.3"><apply id="S4.Ex2.m2.4.5.6.3.1.cmml" xref="S4.Ex2.m2.4.5.6.3.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.6.3.1.1.cmml" xref="S4.Ex2.m2.4.5.6.3.1">superscript</csymbol><apply id="S4.Ex2.m2.4.5.6.3.1.2.cmml" xref="S4.Ex2.m2.4.5.6.3.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.5.6.3.1.2.1.cmml" xref="S4.Ex2.m2.4.5.6.3.1">subscript</csymbol><sum id="S4.Ex2.m2.4.5.6.3.1.2.2.cmml" xref="S4.Ex2.m2.4.5.6.3.1.2.2"></sum><apply id="S4.Ex2.m2.4.5.6.3.1.2.3.cmml" xref="S4.Ex2.m2.4.5.6.3.1.2.3"><eq id="S4.Ex2.m2.4.5.6.3.1.2.3.1.cmml" xref="S4.Ex2.m2.4.5.6.3.1.2.3.1"></eq><ci id="S4.Ex2.m2.4.5.6.3.1.2.3.2.cmml" xref="S4.Ex2.m2.4.5.6.3.1.2.3.2">𝑗</ci><cn type="integer" id="S4.Ex2.m2.4.5.6.3.1.2.3.3.cmml" xref="S4.Ex2.m2.4.5.6.3.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex2.m2.4.5.6.3.1.3.cmml" xref="S4.Ex2.m2.4.5.6.3.1.3">𝑁</ci></apply><apply id="S4.Ex2.m2.4.4.cmml" xref="S4.Ex2.m2.4.4"><divide id="S4.Ex2.m2.4.4.3.cmml" xref="S4.Ex2.m2.4.4"></divide><apply id="S4.Ex2.m2.4.4.4.cmml" xref="S4.Ex2.m2.4.4.4"><partialdiff id="S4.Ex2.m2.4.4.4.1.cmml" xref="S4.Ex2.m2.4.4.4.1"></partialdiff><apply id="S4.Ex2.m2.4.4.4.2.cmml" xref="S4.Ex2.m2.4.4.4.2"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.4.4.2.1.cmml" xref="S4.Ex2.m2.4.4.4.2">subscript</csymbol><ci id="S4.Ex2.m2.4.4.4.2.2.cmml" xref="S4.Ex2.m2.4.4.4.2.2">𝑙</ci><ci id="S4.Ex2.m2.4.4.4.2.3.cmml" xref="S4.Ex2.m2.4.4.4.2.3">𝑗</ci></apply></apply><apply id="S4.Ex2.m2.4.4.2.cmml" xref="S4.Ex2.m2.4.4.2"><partialdiff id="S4.Ex2.m2.4.4.2.3.cmml" xref="S4.Ex2.m2.4.4.2.3"></partialdiff><apply id="S4.Ex2.m2.4.4.2.4.cmml" xref="S4.Ex2.m2.4.4.2.4"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.4.2.4.1.cmml" xref="S4.Ex2.m2.4.4.2.4">subscript</csymbol><ci id="S4.Ex2.m2.4.4.2.4.2.cmml" xref="S4.Ex2.m2.4.4.2.4.2">𝑾</ci><list id="S4.Ex2.m2.4.4.2.2.2.3.cmml" xref="S4.Ex2.m2.4.4.2.2.2.2"><ci id="S4.Ex2.m2.3.3.1.1.1.1.cmml" xref="S4.Ex2.m2.3.3.1.1.1.1">:</ci><apply id="S4.Ex2.m2.4.4.2.2.2.2.1.cmml" xref="S4.Ex2.m2.4.4.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Ex2.m2.4.4.2.2.2.2.1.1.cmml" xref="S4.Ex2.m2.4.4.2.2.2.2.1">subscript</csymbol><ci id="S4.Ex2.m2.4.4.2.2.2.2.1.2.cmml" xref="S4.Ex2.m2.4.4.2.2.2.2.1.2">𝑦</ci><ci id="S4.Ex2.m2.4.4.2.2.2.2.1.3.cmml" xref="S4.Ex2.m2.4.4.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex2.m2.4c">\displaystyle\coloneqq\Delta_{\bm{W}_{:,y_{i}}}=\frac{1}{N}\sum_{j=1}^{N}\frac{\partial l_{j}}{\partial\bm{W}_{:,y_{i}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex3.m1.7" class="ltx_Math" alttext="\displaystyle\propto-(1-\bm{p}_{i,y_{i}})\bm{r}_{i}+\sum_{j=1,j\neq i}^{N}\bm{p}_{j,y_{i}}\bm{r}_{j}" display="inline"><semantics id="S4.Ex3.m1.7a"><mrow id="S4.Ex3.m1.7.7" xref="S4.Ex3.m1.7.7.cmml"><mi id="S4.Ex3.m1.7.7.3" xref="S4.Ex3.m1.7.7.3.cmml"></mi><mo id="S4.Ex3.m1.7.7.2" xref="S4.Ex3.m1.7.7.2.cmml">∝</mo><mrow id="S4.Ex3.m1.7.7.1" xref="S4.Ex3.m1.7.7.1.cmml"><mrow id="S4.Ex3.m1.7.7.1.1" xref="S4.Ex3.m1.7.7.1.1.cmml"><mo id="S4.Ex3.m1.7.7.1.1a" xref="S4.Ex3.m1.7.7.1.1.cmml">−</mo><mrow id="S4.Ex3.m1.7.7.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.cmml"><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex3.m1.7.7.1.1.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex3.m1.7.7.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml"><mn id="S4.Ex3.m1.7.7.1.1.1.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.2" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.2.cmml">𝒑</mi><mrow id="S4.Ex3.m1.2.2.2.2" xref="S4.Ex3.m1.2.2.2.3.cmml"><mi id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.cmml">i</mi><mo id="S4.Ex3.m1.2.2.2.2.2" xref="S4.Ex3.m1.2.2.2.3.cmml">,</mo><msub id="S4.Ex3.m1.2.2.2.2.1" xref="S4.Ex3.m1.2.2.2.2.1.cmml"><mi id="S4.Ex3.m1.2.2.2.2.1.2" xref="S4.Ex3.m1.2.2.2.2.1.2.cmml">y</mi><mi id="S4.Ex3.m1.2.2.2.2.1.3" xref="S4.Ex3.m1.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow><mo stretchy="false" id="S4.Ex3.m1.7.7.1.1.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.7.7.1.1.1.2" xref="S4.Ex3.m1.7.7.1.1.1.2.cmml">​</mo><msub id="S4.Ex3.m1.7.7.1.1.1.3" xref="S4.Ex3.m1.7.7.1.1.1.3.cmml"><mi id="S4.Ex3.m1.7.7.1.1.1.3.2" xref="S4.Ex3.m1.7.7.1.1.1.3.2.cmml">𝒓</mi><mi id="S4.Ex3.m1.7.7.1.1.1.3.3" xref="S4.Ex3.m1.7.7.1.1.1.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S4.Ex3.m1.7.7.1.2" xref="S4.Ex3.m1.7.7.1.2.cmml">+</mo><mrow id="S4.Ex3.m1.7.7.1.3" xref="S4.Ex3.m1.7.7.1.3.cmml"><mstyle displaystyle="true" id="S4.Ex3.m1.7.7.1.3.1" xref="S4.Ex3.m1.7.7.1.3.1.cmml"><munderover id="S4.Ex3.m1.7.7.1.3.1a" xref="S4.Ex3.m1.7.7.1.3.1.cmml"><mo movablelimits="false" id="S4.Ex3.m1.7.7.1.3.1.2.2" xref="S4.Ex3.m1.7.7.1.3.1.2.2.cmml">∑</mo><mrow id="S4.Ex3.m1.4.4.2.2" xref="S4.Ex3.m1.4.4.2.3.cmml"><mrow id="S4.Ex3.m1.3.3.1.1.1" xref="S4.Ex3.m1.3.3.1.1.1.cmml"><mi id="S4.Ex3.m1.3.3.1.1.1.2" xref="S4.Ex3.m1.3.3.1.1.1.2.cmml">j</mi><mo id="S4.Ex3.m1.3.3.1.1.1.1" xref="S4.Ex3.m1.3.3.1.1.1.1.cmml">=</mo><mn id="S4.Ex3.m1.3.3.1.1.1.3" xref="S4.Ex3.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.Ex3.m1.4.4.2.2.3" xref="S4.Ex3.m1.4.4.2.3a.cmml">,</mo><mrow id="S4.Ex3.m1.4.4.2.2.2" xref="S4.Ex3.m1.4.4.2.2.2.cmml"><mi id="S4.Ex3.m1.4.4.2.2.2.2" xref="S4.Ex3.m1.4.4.2.2.2.2.cmml">j</mi><mo id="S4.Ex3.m1.4.4.2.2.2.1" xref="S4.Ex3.m1.4.4.2.2.2.1.cmml">≠</mo><mi id="S4.Ex3.m1.4.4.2.2.2.3" xref="S4.Ex3.m1.4.4.2.2.2.3.cmml">i</mi></mrow></mrow><mi id="S4.Ex3.m1.7.7.1.3.1.3" xref="S4.Ex3.m1.7.7.1.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="S4.Ex3.m1.7.7.1.3.2" xref="S4.Ex3.m1.7.7.1.3.2.cmml"><msub id="S4.Ex3.m1.7.7.1.3.2.2" xref="S4.Ex3.m1.7.7.1.3.2.2.cmml"><mi id="S4.Ex3.m1.7.7.1.3.2.2.2" xref="S4.Ex3.m1.7.7.1.3.2.2.2.cmml">𝒑</mi><mrow id="S4.Ex3.m1.6.6.2.2" xref="S4.Ex3.m1.6.6.2.3.cmml"><mi id="S4.Ex3.m1.5.5.1.1" xref="S4.Ex3.m1.5.5.1.1.cmml">j</mi><mo id="S4.Ex3.m1.6.6.2.2.2" xref="S4.Ex3.m1.6.6.2.3.cmml">,</mo><msub id="S4.Ex3.m1.6.6.2.2.1" xref="S4.Ex3.m1.6.6.2.2.1.cmml"><mi id="S4.Ex3.m1.6.6.2.2.1.2" xref="S4.Ex3.m1.6.6.2.2.1.2.cmml">y</mi><mi id="S4.Ex3.m1.6.6.2.2.1.3" xref="S4.Ex3.m1.6.6.2.2.1.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S4.Ex3.m1.7.7.1.3.2.1" xref="S4.Ex3.m1.7.7.1.3.2.1.cmml">​</mo><msub id="S4.Ex3.m1.7.7.1.3.2.3" xref="S4.Ex3.m1.7.7.1.3.2.3.cmml"><mi id="S4.Ex3.m1.7.7.1.3.2.3.2" xref="S4.Ex3.m1.7.7.1.3.2.3.2.cmml">𝒓</mi><mi id="S4.Ex3.m1.7.7.1.3.2.3.3" xref="S4.Ex3.m1.7.7.1.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex3.m1.7b"><apply id="S4.Ex3.m1.7.7.cmml" xref="S4.Ex3.m1.7.7"><csymbol cd="latexml" id="S4.Ex3.m1.7.7.2.cmml" xref="S4.Ex3.m1.7.7.2">proportional-to</csymbol><csymbol cd="latexml" id="S4.Ex3.m1.7.7.3.cmml" xref="S4.Ex3.m1.7.7.3">absent</csymbol><apply id="S4.Ex3.m1.7.7.1.cmml" xref="S4.Ex3.m1.7.7.1"><plus id="S4.Ex3.m1.7.7.1.2.cmml" xref="S4.Ex3.m1.7.7.1.2"></plus><apply id="S4.Ex3.m1.7.7.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1"><minus id="S4.Ex3.m1.7.7.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1"></minus><apply id="S4.Ex3.m1.7.7.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1"><times id="S4.Ex3.m1.7.7.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.2"></times><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1"><minus id="S4.Ex3.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.Ex3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.2">1</cn><apply id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.1.1.1.3.2">𝒑</ci><list id="S4.Ex3.m1.2.2.2.3.cmml" xref="S4.Ex3.m1.2.2.2.2"><ci id="S4.Ex3.m1.1.1.1.1.cmml" xref="S4.Ex3.m1.1.1.1.1">𝑖</ci><apply id="S4.Ex3.m1.2.2.2.2.1.cmml" xref="S4.Ex3.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.2.2.2.2.1.1.cmml" xref="S4.Ex3.m1.2.2.2.2.1">subscript</csymbol><ci id="S4.Ex3.m1.2.2.2.2.1.2.cmml" xref="S4.Ex3.m1.2.2.2.2.1.2">𝑦</ci><ci id="S4.Ex3.m1.2.2.2.2.1.3.cmml" xref="S4.Ex3.m1.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply><apply id="S4.Ex3.m1.7.7.1.1.1.3.cmml" xref="S4.Ex3.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.1.1.3.1.cmml" xref="S4.Ex3.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.1.1.3.2.cmml" xref="S4.Ex3.m1.7.7.1.1.1.3.2">𝒓</ci><ci id="S4.Ex3.m1.7.7.1.1.1.3.3.cmml" xref="S4.Ex3.m1.7.7.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S4.Ex3.m1.7.7.1.3.cmml" xref="S4.Ex3.m1.7.7.1.3"><apply id="S4.Ex3.m1.7.7.1.3.1.cmml" xref="S4.Ex3.m1.7.7.1.3.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.3.1.1.cmml" xref="S4.Ex3.m1.7.7.1.3.1">superscript</csymbol><apply id="S4.Ex3.m1.7.7.1.3.1.2.cmml" xref="S4.Ex3.m1.7.7.1.3.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.3.1.2.1.cmml" xref="S4.Ex3.m1.7.7.1.3.1">subscript</csymbol><sum id="S4.Ex3.m1.7.7.1.3.1.2.2.cmml" xref="S4.Ex3.m1.7.7.1.3.1.2.2"></sum><apply id="S4.Ex3.m1.4.4.2.3.cmml" xref="S4.Ex3.m1.4.4.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.4.4.2.3a.cmml" xref="S4.Ex3.m1.4.4.2.2.3">formulae-sequence</csymbol><apply id="S4.Ex3.m1.3.3.1.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1"><eq id="S4.Ex3.m1.3.3.1.1.1.1.cmml" xref="S4.Ex3.m1.3.3.1.1.1.1"></eq><ci id="S4.Ex3.m1.3.3.1.1.1.2.cmml" xref="S4.Ex3.m1.3.3.1.1.1.2">𝑗</ci><cn type="integer" id="S4.Ex3.m1.3.3.1.1.1.3.cmml" xref="S4.Ex3.m1.3.3.1.1.1.3">1</cn></apply><apply id="S4.Ex3.m1.4.4.2.2.2.cmml" xref="S4.Ex3.m1.4.4.2.2.2"><neq id="S4.Ex3.m1.4.4.2.2.2.1.cmml" xref="S4.Ex3.m1.4.4.2.2.2.1"></neq><ci id="S4.Ex3.m1.4.4.2.2.2.2.cmml" xref="S4.Ex3.m1.4.4.2.2.2.2">𝑗</ci><ci id="S4.Ex3.m1.4.4.2.2.2.3.cmml" xref="S4.Ex3.m1.4.4.2.2.2.3">𝑖</ci></apply></apply></apply><ci id="S4.Ex3.m1.7.7.1.3.1.3.cmml" xref="S4.Ex3.m1.7.7.1.3.1.3">𝑁</ci></apply><apply id="S4.Ex3.m1.7.7.1.3.2.cmml" xref="S4.Ex3.m1.7.7.1.3.2"><times id="S4.Ex3.m1.7.7.1.3.2.1.cmml" xref="S4.Ex3.m1.7.7.1.3.2.1"></times><apply id="S4.Ex3.m1.7.7.1.3.2.2.cmml" xref="S4.Ex3.m1.7.7.1.3.2.2"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.3.2.2.1.cmml" xref="S4.Ex3.m1.7.7.1.3.2.2">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.3.2.2.2.cmml" xref="S4.Ex3.m1.7.7.1.3.2.2.2">𝒑</ci><list id="S4.Ex3.m1.6.6.2.3.cmml" xref="S4.Ex3.m1.6.6.2.2"><ci id="S4.Ex3.m1.5.5.1.1.cmml" xref="S4.Ex3.m1.5.5.1.1">𝑗</ci><apply id="S4.Ex3.m1.6.6.2.2.1.cmml" xref="S4.Ex3.m1.6.6.2.2.1"><csymbol cd="ambiguous" id="S4.Ex3.m1.6.6.2.2.1.1.cmml" xref="S4.Ex3.m1.6.6.2.2.1">subscript</csymbol><ci id="S4.Ex3.m1.6.6.2.2.1.2.cmml" xref="S4.Ex3.m1.6.6.2.2.1.2">𝑦</ci><ci id="S4.Ex3.m1.6.6.2.2.1.3.cmml" xref="S4.Ex3.m1.6.6.2.2.1.3">𝑖</ci></apply></list></apply><apply id="S4.Ex3.m1.7.7.1.3.2.3.cmml" xref="S4.Ex3.m1.7.7.1.3.2.3"><csymbol cd="ambiguous" id="S4.Ex3.m1.7.7.1.3.2.3.1.cmml" xref="S4.Ex3.m1.7.7.1.3.2.3">subscript</csymbol><ci id="S4.Ex3.m1.7.7.1.3.2.3.2.cmml" xref="S4.Ex3.m1.7.7.1.3.2.3.2">𝒓</ci><ci id="S4.Ex3.m1.7.7.1.3.2.3.3.cmml" xref="S4.Ex3.m1.7.7.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex3.m1.7c">\displaystyle\propto-(1-\bm{p}_{i,y_{i}})\bm{r}_{i}+\sum_{j=1,j\neq i}^{N}\bm{p}_{j,y_{i}}\bm{r}_{j}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m1.3" class="ltx_Math" alttext="\displaystyle\approx-(1-\bm{p}_{i,y_{i}})\bm{r}_{i}." display="inline"><semantics id="S4.E4.m1.3a"><mrow id="S4.E4.m1.3.3.1" xref="S4.E4.m1.3.3.1.1.cmml"><mrow id="S4.E4.m1.3.3.1.1" xref="S4.E4.m1.3.3.1.1.cmml"><mi id="S4.E4.m1.3.3.1.1.3" xref="S4.E4.m1.3.3.1.1.3.cmml"></mi><mo id="S4.E4.m1.3.3.1.1.2" xref="S4.E4.m1.3.3.1.1.2.cmml">≈</mo><mrow id="S4.E4.m1.3.3.1.1.1" xref="S4.E4.m1.3.3.1.1.1.cmml"><mo id="S4.E4.m1.3.3.1.1.1a" xref="S4.E4.m1.3.3.1.1.1.cmml">−</mo><mrow id="S4.E4.m1.3.3.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E4.m1.3.3.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.3.3.1.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml"><mn id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E4.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">𝒑</mi><mrow id="S4.E4.m1.2.2.2.2" xref="S4.E4.m1.2.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">i</mi><mo id="S4.E4.m1.2.2.2.2.2" xref="S4.E4.m1.2.2.2.3.cmml">,</mo><msub id="S4.E4.m1.2.2.2.2.1" xref="S4.E4.m1.2.2.2.2.1.cmml"><mi id="S4.E4.m1.2.2.2.2.1.2" xref="S4.E4.m1.2.2.2.2.1.2.cmml">y</mi><mi id="S4.E4.m1.2.2.2.2.1.3" xref="S4.E4.m1.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow><mo stretchy="false" id="S4.E4.m1.3.3.1.1.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.3.3.1.1.1.1.2" xref="S4.E4.m1.3.3.1.1.1.1.2.cmml">​</mo><msub id="S4.E4.m1.3.3.1.1.1.1.3" xref="S4.E4.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.E4.m1.3.3.1.1.1.1.3.2" xref="S4.E4.m1.3.3.1.1.1.1.3.2.cmml">𝒓</mi><mi id="S4.E4.m1.3.3.1.1.1.1.3.3" xref="S4.E4.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S4.E4.m1.3.3.1.2" xref="S4.E4.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.3b"><apply id="S4.E4.m1.3.3.1.1.cmml" xref="S4.E4.m1.3.3.1"><approx id="S4.E4.m1.3.3.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.2"></approx><csymbol cd="latexml" id="S4.E4.m1.3.3.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.3">absent</csymbol><apply id="S4.E4.m1.3.3.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1"><minus id="S4.E4.m1.3.3.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1"></minus><apply id="S4.E4.m1.3.3.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1"><times id="S4.E4.m1.3.3.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.2"></times><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1"><minus id="S4.E4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.1.1.1.3.2">𝒑</ci><list id="S4.E4.m1.2.2.2.3.cmml" xref="S4.E4.m1.2.2.2.2"><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝑖</ci><apply id="S4.E4.m1.2.2.2.2.1.cmml" xref="S4.E4.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.2.2.1.1.cmml" xref="S4.E4.m1.2.2.2.2.1">subscript</csymbol><ci id="S4.E4.m1.2.2.2.2.1.2.cmml" xref="S4.E4.m1.2.2.2.2.1.2">𝑦</ci><ci id="S4.E4.m1.2.2.2.2.1.3.cmml" xref="S4.E4.m1.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply><apply id="S4.E4.m1.3.3.1.1.1.1.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E4.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E4.m1.3.3.1.1.1.1.3.2">𝒓</ci><ci id="S4.E4.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.E4.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.3c">\displaystyle\approx-(1-\bm{p}_{i,y_{i}})\bm{r}_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.16" class="ltx_p">Here, we denote the restored feature vector as <math id="S4.SS2.p3.11.m1.1" class="ltx_Math" alttext="\hat{\bm{r}}_{i}" display="inline"><semantics id="S4.SS2.p3.11.m1.1a"><msub id="S4.SS2.p3.11.m1.1.1" xref="S4.SS2.p3.11.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p3.11.m1.1.1.2" xref="S4.SS2.p3.11.m1.1.1.2.cmml"><mi id="S4.SS2.p3.11.m1.1.1.2.2" xref="S4.SS2.p3.11.m1.1.1.2.2.cmml">𝒓</mi><mo id="S4.SS2.p3.11.m1.1.1.2.1" xref="S4.SS2.p3.11.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p3.11.m1.1.1.3" xref="S4.SS2.p3.11.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m1.1b"><apply id="S4.SS2.p3.11.m1.1.1.cmml" xref="S4.SS2.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m1.1.1.1.cmml" xref="S4.SS2.p3.11.m1.1.1">subscript</csymbol><apply id="S4.SS2.p3.11.m1.1.1.2.cmml" xref="S4.SS2.p3.11.m1.1.1.2"><ci id="S4.SS2.p3.11.m1.1.1.2.1.cmml" xref="S4.SS2.p3.11.m1.1.1.2.1">^</ci><ci id="S4.SS2.p3.11.m1.1.1.2.2.cmml" xref="S4.SS2.p3.11.m1.1.1.2.2">𝒓</ci></apply><ci id="S4.SS2.p3.11.m1.1.1.3.cmml" xref="S4.SS2.p3.11.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m1.1c">\hat{\bm{r}}_{i}</annotation></semantics></math>.
<math id="S4.SS2.p3.12.m2.1" class="ltx_Math" alttext="l_{j}" display="inline"><semantics id="S4.SS2.p3.12.m2.1a"><msub id="S4.SS2.p3.12.m2.1.1" xref="S4.SS2.p3.12.m2.1.1.cmml"><mi id="S4.SS2.p3.12.m2.1.1.2" xref="S4.SS2.p3.12.m2.1.1.2.cmml">l</mi><mi id="S4.SS2.p3.12.m2.1.1.3" xref="S4.SS2.p3.12.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.12.m2.1b"><apply id="S4.SS2.p3.12.m2.1.1.cmml" xref="S4.SS2.p3.12.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.12.m2.1.1.1.cmml" xref="S4.SS2.p3.12.m2.1.1">subscript</csymbol><ci id="S4.SS2.p3.12.m2.1.1.2.cmml" xref="S4.SS2.p3.12.m2.1.1.2">𝑙</ci><ci id="S4.SS2.p3.12.m2.1.1.3.cmml" xref="S4.SS2.p3.12.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.12.m2.1c">l_{j}</annotation></semantics></math> is the loss computed on the <math id="S4.SS2.p3.13.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p3.13.m3.1a"><mi id="S4.SS2.p3.13.m3.1.1" xref="S4.SS2.p3.13.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.13.m3.1b"><ci id="S4.SS2.p3.13.m3.1.1.cmml" xref="S4.SS2.p3.13.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.13.m3.1c">j</annotation></semantics></math>-th image, and <math id="S4.SS2.p3.14.m4.2" class="ltx_Math" alttext="\bm{p}_{i,y_{i}}" display="inline"><semantics id="S4.SS2.p3.14.m4.2a"><msub id="S4.SS2.p3.14.m4.2.3" xref="S4.SS2.p3.14.m4.2.3.cmml"><mi id="S4.SS2.p3.14.m4.2.3.2" xref="S4.SS2.p3.14.m4.2.3.2.cmml">𝒑</mi><mrow id="S4.SS2.p3.14.m4.2.2.2.2" xref="S4.SS2.p3.14.m4.2.2.2.3.cmml"><mi id="S4.SS2.p3.14.m4.1.1.1.1" xref="S4.SS2.p3.14.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.14.m4.2.2.2.2.2" xref="S4.SS2.p3.14.m4.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p3.14.m4.2.2.2.2.1" xref="S4.SS2.p3.14.m4.2.2.2.2.1.cmml"><mi id="S4.SS2.p3.14.m4.2.2.2.2.1.2" xref="S4.SS2.p3.14.m4.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS2.p3.14.m4.2.2.2.2.1.3" xref="S4.SS2.p3.14.m4.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.14.m4.2b"><apply id="S4.SS2.p3.14.m4.2.3.cmml" xref="S4.SS2.p3.14.m4.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.14.m4.2.3.1.cmml" xref="S4.SS2.p3.14.m4.2.3">subscript</csymbol><ci id="S4.SS2.p3.14.m4.2.3.2.cmml" xref="S4.SS2.p3.14.m4.2.3.2">𝒑</ci><list id="S4.SS2.p3.14.m4.2.2.2.3.cmml" xref="S4.SS2.p3.14.m4.2.2.2.2"><ci id="S4.SS2.p3.14.m4.1.1.1.1.cmml" xref="S4.SS2.p3.14.m4.1.1.1.1">𝑖</ci><apply id="S4.SS2.p3.14.m4.2.2.2.2.1.cmml" xref="S4.SS2.p3.14.m4.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p3.14.m4.2.2.2.2.1.1.cmml" xref="S4.SS2.p3.14.m4.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p3.14.m4.2.2.2.2.1.2.cmml" xref="S4.SS2.p3.14.m4.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS2.p3.14.m4.2.2.2.2.1.3.cmml" xref="S4.SS2.p3.14.m4.2.2.2.2.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.14.m4.2c">\bm{p}_{i,y_{i}}</annotation></semantics></math> represents the probability of the <math id="S4.SS2.p3.15.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p3.15.m5.1a"><mi id="S4.SS2.p3.15.m5.1.1" xref="S4.SS2.p3.15.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.15.m5.1b"><ci id="S4.SS2.p3.15.m5.1.1.cmml" xref="S4.SS2.p3.15.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.15.m5.1c">i</annotation></semantics></math>-th sample belonging to class <math id="S4.SS2.p3.16.m6.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS2.p3.16.m6.1a"><msub id="S4.SS2.p3.16.m6.1.1" xref="S4.SS2.p3.16.m6.1.1.cmml"><mi id="S4.SS2.p3.16.m6.1.1.2" xref="S4.SS2.p3.16.m6.1.1.2.cmml">y</mi><mi id="S4.SS2.p3.16.m6.1.1.3" xref="S4.SS2.p3.16.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.16.m6.1b"><apply id="S4.SS2.p3.16.m6.1.1.cmml" xref="S4.SS2.p3.16.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.16.m6.1.1.1.cmml" xref="S4.SS2.p3.16.m6.1.1">subscript</csymbol><ci id="S4.SS2.p3.16.m6.1.1.2.cmml" xref="S4.SS2.p3.16.m6.1.1.2">𝑦</ci><ci id="S4.SS2.p3.16.m6.1.1.3.cmml" xref="S4.SS2.p3.16.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.16.m6.1c">y_{i}</annotation></semantics></math>.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2202.10546/assets/figures/feat_restore.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="509" height="244" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.24.12.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.22.11" class="ltx_text" style="font-size:90%;">A toy example showcasing how the features can be restored from the linear layer’s weight gradients on an AT model. Here we suppose the batch size <math id="S4.F2.12.1.m1.1" class="ltx_Math" alttext="N=2" display="inline"><semantics id="S4.F2.12.1.m1.1b"><mrow id="S4.F2.12.1.m1.1.1" xref="S4.F2.12.1.m1.1.1.cmml"><mi id="S4.F2.12.1.m1.1.1.2" xref="S4.F2.12.1.m1.1.1.2.cmml">N</mi><mo id="S4.F2.12.1.m1.1.1.1" xref="S4.F2.12.1.m1.1.1.1.cmml">=</mo><mn id="S4.F2.12.1.m1.1.1.3" xref="S4.F2.12.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.12.1.m1.1c"><apply id="S4.F2.12.1.m1.1.1.cmml" xref="S4.F2.12.1.m1.1.1"><eq id="S4.F2.12.1.m1.1.1.1.cmml" xref="S4.F2.12.1.m1.1.1.1"></eq><ci id="S4.F2.12.1.m1.1.1.2.cmml" xref="S4.F2.12.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.F2.12.1.m1.1.1.3.cmml" xref="S4.F2.12.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.1.m1.1d">N=2</annotation></semantics></math> and the number of classes <math id="S4.F2.13.2.m2.1" class="ltx_Math" alttext="K=5" display="inline"><semantics id="S4.F2.13.2.m2.1b"><mrow id="S4.F2.13.2.m2.1.1" xref="S4.F2.13.2.m2.1.1.cmml"><mi id="S4.F2.13.2.m2.1.1.2" xref="S4.F2.13.2.m2.1.1.2.cmml">K</mi><mo id="S4.F2.13.2.m2.1.1.1" xref="S4.F2.13.2.m2.1.1.1.cmml">=</mo><mn id="S4.F2.13.2.m2.1.1.3" xref="S4.F2.13.2.m2.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.13.2.m2.1c"><apply id="S4.F2.13.2.m2.1.1.cmml" xref="S4.F2.13.2.m2.1.1"><eq id="S4.F2.13.2.m2.1.1.1.cmml" xref="S4.F2.13.2.m2.1.1.1"></eq><ci id="S4.F2.13.2.m2.1.1.2.cmml" xref="S4.F2.13.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S4.F2.13.2.m2.1.1.3.cmml" xref="S4.F2.13.2.m2.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.13.2.m2.1d">K=5</annotation></semantics></math>. Without loss of generality, assume <math id="S4.F2.14.3.m3.1" class="ltx_Math" alttext="\bm{r}_{1}" display="inline"><semantics id="S4.F2.14.3.m3.1b"><msub id="S4.F2.14.3.m3.1.1" xref="S4.F2.14.3.m3.1.1.cmml"><mi id="S4.F2.14.3.m3.1.1.2" xref="S4.F2.14.3.m3.1.1.2.cmml">𝒓</mi><mn id="S4.F2.14.3.m3.1.1.3" xref="S4.F2.14.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.14.3.m3.1c"><apply id="S4.F2.14.3.m3.1.1.cmml" xref="S4.F2.14.3.m3.1.1"><csymbol cd="ambiguous" id="S4.F2.14.3.m3.1.1.1.cmml" xref="S4.F2.14.3.m3.1.1">subscript</csymbol><ci id="S4.F2.14.3.m3.1.1.2.cmml" xref="S4.F2.14.3.m3.1.1.2">𝒓</ci><cn type="integer" id="S4.F2.14.3.m3.1.1.3.cmml" xref="S4.F2.14.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.14.3.m3.1d">\bm{r}_{1}</annotation></semantics></math> and <math id="S4.F2.15.4.m4.1" class="ltx_Math" alttext="\bm{r}_{2}" display="inline"><semantics id="S4.F2.15.4.m4.1b"><msub id="S4.F2.15.4.m4.1.1" xref="S4.F2.15.4.m4.1.1.cmml"><mi id="S4.F2.15.4.m4.1.1.2" xref="S4.F2.15.4.m4.1.1.2.cmml">𝒓</mi><mn id="S4.F2.15.4.m4.1.1.3" xref="S4.F2.15.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.15.4.m4.1c"><apply id="S4.F2.15.4.m4.1.1.cmml" xref="S4.F2.15.4.m4.1.1"><csymbol cd="ambiguous" id="S4.F2.15.4.m4.1.1.1.cmml" xref="S4.F2.15.4.m4.1.1">subscript</csymbol><ci id="S4.F2.15.4.m4.1.1.2.cmml" xref="S4.F2.15.4.m4.1.1.2">𝒓</ci><cn type="integer" id="S4.F2.15.4.m4.1.1.3.cmml" xref="S4.F2.15.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.15.4.m4.1d">\bm{r}_{2}</annotation></semantics></math> have label <math id="S4.F2.16.5.m5.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.F2.16.5.m5.1b"><mn id="S4.F2.16.5.m5.1.1" xref="S4.F2.16.5.m5.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.F2.16.5.m5.1c"><cn type="integer" id="S4.F2.16.5.m5.1.1.cmml" xref="S4.F2.16.5.m5.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.16.5.m5.1d">1</annotation></semantics></math> and <math id="S4.F2.17.6.m6.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S4.F2.17.6.m6.1b"><mn id="S4.F2.17.6.m6.1.1" xref="S4.F2.17.6.m6.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S4.F2.17.6.m6.1c"><cn type="integer" id="S4.F2.17.6.m6.1.1.cmml" xref="S4.F2.17.6.m6.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.17.6.m6.1d">2</annotation></semantics></math>, respectively. The numbers in the brackets are the softmax probabilities. Adversarial examples result in small <math id="S4.F2.18.7.m7.2" class="ltx_Math" alttext="\bm{p}_{1,1}" display="inline"><semantics id="S4.F2.18.7.m7.2b"><msub id="S4.F2.18.7.m7.2.3" xref="S4.F2.18.7.m7.2.3.cmml"><mi id="S4.F2.18.7.m7.2.3.2" xref="S4.F2.18.7.m7.2.3.2.cmml">𝒑</mi><mrow id="S4.F2.18.7.m7.2.2.2.4" xref="S4.F2.18.7.m7.2.2.2.3.cmml"><mn id="S4.F2.18.7.m7.1.1.1.1" xref="S4.F2.18.7.m7.1.1.1.1.cmml">1</mn><mo id="S4.F2.18.7.m7.2.2.2.4.1" xref="S4.F2.18.7.m7.2.2.2.3.cmml">,</mo><mn id="S4.F2.18.7.m7.2.2.2.2" xref="S4.F2.18.7.m7.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F2.18.7.m7.2c"><apply id="S4.F2.18.7.m7.2.3.cmml" xref="S4.F2.18.7.m7.2.3"><csymbol cd="ambiguous" id="S4.F2.18.7.m7.2.3.1.cmml" xref="S4.F2.18.7.m7.2.3">subscript</csymbol><ci id="S4.F2.18.7.m7.2.3.2.cmml" xref="S4.F2.18.7.m7.2.3.2">𝒑</ci><list id="S4.F2.18.7.m7.2.2.2.3.cmml" xref="S4.F2.18.7.m7.2.2.2.4"><cn type="integer" id="S4.F2.18.7.m7.1.1.1.1.cmml" xref="S4.F2.18.7.m7.1.1.1.1">1</cn><cn type="integer" id="S4.F2.18.7.m7.2.2.2.2.cmml" xref="S4.F2.18.7.m7.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.18.7.m7.2d">\bm{p}_{1,1}</annotation></semantics></math> and <math id="S4.F2.19.8.m8.2" class="ltx_Math" alttext="\bm{p}_{2,2}" display="inline"><semantics id="S4.F2.19.8.m8.2b"><msub id="S4.F2.19.8.m8.2.3" xref="S4.F2.19.8.m8.2.3.cmml"><mi id="S4.F2.19.8.m8.2.3.2" xref="S4.F2.19.8.m8.2.3.2.cmml">𝒑</mi><mrow id="S4.F2.19.8.m8.2.2.2.4" xref="S4.F2.19.8.m8.2.2.2.3.cmml"><mn id="S4.F2.19.8.m8.1.1.1.1" xref="S4.F2.19.8.m8.1.1.1.1.cmml">2</mn><mo id="S4.F2.19.8.m8.2.2.2.4.1" xref="S4.F2.19.8.m8.2.2.2.3.cmml">,</mo><mn id="S4.F2.19.8.m8.2.2.2.2" xref="S4.F2.19.8.m8.2.2.2.2.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F2.19.8.m8.2c"><apply id="S4.F2.19.8.m8.2.3.cmml" xref="S4.F2.19.8.m8.2.3"><csymbol cd="ambiguous" id="S4.F2.19.8.m8.2.3.1.cmml" xref="S4.F2.19.8.m8.2.3">subscript</csymbol><ci id="S4.F2.19.8.m8.2.3.2.cmml" xref="S4.F2.19.8.m8.2.3.2">𝒑</ci><list id="S4.F2.19.8.m8.2.2.2.3.cmml" xref="S4.F2.19.8.m8.2.2.2.4"><cn type="integer" id="S4.F2.19.8.m8.1.1.1.1.cmml" xref="S4.F2.19.8.m8.1.1.1.1">2</cn><cn type="integer" id="S4.F2.19.8.m8.2.2.2.2.cmml" xref="S4.F2.19.8.m8.2.2.2.2">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.19.8.m8.2d">\bm{p}_{2,2}</annotation></semantics></math>.
According to <a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, <math id="S4.F2.20.9.m9.3" class="ltx_Math" alttext="\Delta_{\bm{W}_{:,1}}\propto-(1-0.3)\bm{r}_{1}+0.2\bm{r}_{2}" display="inline"><semantics id="S4.F2.20.9.m9.3b"><mrow id="S4.F2.20.9.m9.3.3" xref="S4.F2.20.9.m9.3.3.cmml"><msub id="S4.F2.20.9.m9.3.3.3" xref="S4.F2.20.9.m9.3.3.3.cmml"><mi mathvariant="normal" id="S4.F2.20.9.m9.3.3.3.2" xref="S4.F2.20.9.m9.3.3.3.2.cmml">Δ</mi><msub id="S4.F2.20.9.m9.2.2.2" xref="S4.F2.20.9.m9.2.2.2.cmml"><mi id="S4.F2.20.9.m9.2.2.2.4" xref="S4.F2.20.9.m9.2.2.2.4.cmml">𝑾</mi><mrow id="S4.F2.20.9.m9.2.2.2.2.2.4" xref="S4.F2.20.9.m9.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.F2.20.9.m9.1.1.1.1.1.1" xref="S4.F2.20.9.m9.1.1.1.1.1.1.cmml">:</mo><mo id="S4.F2.20.9.m9.2.2.2.2.2.4.1" xref="S4.F2.20.9.m9.2.2.2.2.2.3.cmml">,</mo><mn id="S4.F2.20.9.m9.2.2.2.2.2.2" xref="S4.F2.20.9.m9.2.2.2.2.2.2.cmml">1</mn></mrow></msub></msub><mo id="S4.F2.20.9.m9.3.3.2" xref="S4.F2.20.9.m9.3.3.2.cmml">∝</mo><mrow id="S4.F2.20.9.m9.3.3.1" xref="S4.F2.20.9.m9.3.3.1.cmml"><mrow id="S4.F2.20.9.m9.3.3.1.1" xref="S4.F2.20.9.m9.3.3.1.1.cmml"><mo id="S4.F2.20.9.m9.3.3.1.1b" xref="S4.F2.20.9.m9.3.3.1.1.cmml">−</mo><mrow id="S4.F2.20.9.m9.3.3.1.1.1" xref="S4.F2.20.9.m9.3.3.1.1.1.cmml"><mrow id="S4.F2.20.9.m9.3.3.1.1.1.1.1" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.F2.20.9.m9.3.3.1.1.1.1.1.2" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.cmml"><mn id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.2" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.1" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.3" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.3.cmml">0.3</mn></mrow><mo stretchy="false" id="S4.F2.20.9.m9.3.3.1.1.1.1.1.3" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.F2.20.9.m9.3.3.1.1.1.2" xref="S4.F2.20.9.m9.3.3.1.1.1.2.cmml">​</mo><msub id="S4.F2.20.9.m9.3.3.1.1.1.3" xref="S4.F2.20.9.m9.3.3.1.1.1.3.cmml"><mi id="S4.F2.20.9.m9.3.3.1.1.1.3.2" xref="S4.F2.20.9.m9.3.3.1.1.1.3.2.cmml">𝒓</mi><mn id="S4.F2.20.9.m9.3.3.1.1.1.3.3" xref="S4.F2.20.9.m9.3.3.1.1.1.3.3.cmml">1</mn></msub></mrow></mrow><mo id="S4.F2.20.9.m9.3.3.1.2" xref="S4.F2.20.9.m9.3.3.1.2.cmml">+</mo><mrow id="S4.F2.20.9.m9.3.3.1.3" xref="S4.F2.20.9.m9.3.3.1.3.cmml"><mn id="S4.F2.20.9.m9.3.3.1.3.2" xref="S4.F2.20.9.m9.3.3.1.3.2.cmml">0.2</mn><mo lspace="0em" rspace="0em" id="S4.F2.20.9.m9.3.3.1.3.1" xref="S4.F2.20.9.m9.3.3.1.3.1.cmml">​</mo><msub id="S4.F2.20.9.m9.3.3.1.3.3" xref="S4.F2.20.9.m9.3.3.1.3.3.cmml"><mi id="S4.F2.20.9.m9.3.3.1.3.3.2" xref="S4.F2.20.9.m9.3.3.1.3.3.2.cmml">𝒓</mi><mn id="S4.F2.20.9.m9.3.3.1.3.3.3" xref="S4.F2.20.9.m9.3.3.1.3.3.3.cmml">2</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.20.9.m9.3c"><apply id="S4.F2.20.9.m9.3.3.cmml" xref="S4.F2.20.9.m9.3.3"><csymbol cd="latexml" id="S4.F2.20.9.m9.3.3.2.cmml" xref="S4.F2.20.9.m9.3.3.2">proportional-to</csymbol><apply id="S4.F2.20.9.m9.3.3.3.cmml" xref="S4.F2.20.9.m9.3.3.3"><csymbol cd="ambiguous" id="S4.F2.20.9.m9.3.3.3.1.cmml" xref="S4.F2.20.9.m9.3.3.3">subscript</csymbol><ci id="S4.F2.20.9.m9.3.3.3.2.cmml" xref="S4.F2.20.9.m9.3.3.3.2">Δ</ci><apply id="S4.F2.20.9.m9.2.2.2.cmml" xref="S4.F2.20.9.m9.2.2.2"><csymbol cd="ambiguous" id="S4.F2.20.9.m9.2.2.2.3.cmml" xref="S4.F2.20.9.m9.2.2.2">subscript</csymbol><ci id="S4.F2.20.9.m9.2.2.2.4.cmml" xref="S4.F2.20.9.m9.2.2.2.4">𝑾</ci><list id="S4.F2.20.9.m9.2.2.2.2.2.3.cmml" xref="S4.F2.20.9.m9.2.2.2.2.2.4"><ci id="S4.F2.20.9.m9.1.1.1.1.1.1.cmml" xref="S4.F2.20.9.m9.1.1.1.1.1.1">:</ci><cn type="integer" id="S4.F2.20.9.m9.2.2.2.2.2.2.cmml" xref="S4.F2.20.9.m9.2.2.2.2.2.2">1</cn></list></apply></apply><apply id="S4.F2.20.9.m9.3.3.1.cmml" xref="S4.F2.20.9.m9.3.3.1"><plus id="S4.F2.20.9.m9.3.3.1.2.cmml" xref="S4.F2.20.9.m9.3.3.1.2"></plus><apply id="S4.F2.20.9.m9.3.3.1.1.cmml" xref="S4.F2.20.9.m9.3.3.1.1"><minus id="S4.F2.20.9.m9.3.3.1.1.2.cmml" xref="S4.F2.20.9.m9.3.3.1.1"></minus><apply id="S4.F2.20.9.m9.3.3.1.1.1.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1"><times id="S4.F2.20.9.m9.3.3.1.1.1.2.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.2"></times><apply id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1"><minus id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.1.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.2.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.2">1</cn><cn type="float" id="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.3.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.1.1.1.3">0.3</cn></apply><apply id="S4.F2.20.9.m9.3.3.1.1.1.3.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.F2.20.9.m9.3.3.1.1.1.3.1.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.3">subscript</csymbol><ci id="S4.F2.20.9.m9.3.3.1.1.1.3.2.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.3.2">𝒓</ci><cn type="integer" id="S4.F2.20.9.m9.3.3.1.1.1.3.3.cmml" xref="S4.F2.20.9.m9.3.3.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S4.F2.20.9.m9.3.3.1.3.cmml" xref="S4.F2.20.9.m9.3.3.1.3"><times id="S4.F2.20.9.m9.3.3.1.3.1.cmml" xref="S4.F2.20.9.m9.3.3.1.3.1"></times><cn type="float" id="S4.F2.20.9.m9.3.3.1.3.2.cmml" xref="S4.F2.20.9.m9.3.3.1.3.2">0.2</cn><apply id="S4.F2.20.9.m9.3.3.1.3.3.cmml" xref="S4.F2.20.9.m9.3.3.1.3.3"><csymbol cd="ambiguous" id="S4.F2.20.9.m9.3.3.1.3.3.1.cmml" xref="S4.F2.20.9.m9.3.3.1.3.3">subscript</csymbol><ci id="S4.F2.20.9.m9.3.3.1.3.3.2.cmml" xref="S4.F2.20.9.m9.3.3.1.3.3.2">𝒓</ci><cn type="integer" id="S4.F2.20.9.m9.3.3.1.3.3.3.cmml" xref="S4.F2.20.9.m9.3.3.1.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.20.9.m9.3d">\Delta_{\bm{W}_{:,1}}\propto-(1-0.3)\bm{r}_{1}+0.2\bm{r}_{2}</annotation></semantics></math>. The attacker can take <math id="S4.F2.21.10.m10.2" class="ltx_Math" alttext="\Delta_{\bm{W}_{:,1}}" display="inline"><semantics id="S4.F2.21.10.m10.2b"><msub id="S4.F2.21.10.m10.2.3" xref="S4.F2.21.10.m10.2.3.cmml"><mi mathvariant="normal" id="S4.F2.21.10.m10.2.3.2" xref="S4.F2.21.10.m10.2.3.2.cmml">Δ</mi><msub id="S4.F2.21.10.m10.2.2.2" xref="S4.F2.21.10.m10.2.2.2.cmml"><mi id="S4.F2.21.10.m10.2.2.2.4" xref="S4.F2.21.10.m10.2.2.2.4.cmml">𝑾</mi><mrow id="S4.F2.21.10.m10.2.2.2.2.2.4" xref="S4.F2.21.10.m10.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.F2.21.10.m10.1.1.1.1.1.1" xref="S4.F2.21.10.m10.1.1.1.1.1.1.cmml">:</mo><mo id="S4.F2.21.10.m10.2.2.2.2.2.4.1" xref="S4.F2.21.10.m10.2.2.2.2.2.3.cmml">,</mo><mn id="S4.F2.21.10.m10.2.2.2.2.2.2" xref="S4.F2.21.10.m10.2.2.2.2.2.2.cmml">1</mn></mrow></msub></msub><annotation-xml encoding="MathML-Content" id="S4.F2.21.10.m10.2c"><apply id="S4.F2.21.10.m10.2.3.cmml" xref="S4.F2.21.10.m10.2.3"><csymbol cd="ambiguous" id="S4.F2.21.10.m10.2.3.1.cmml" xref="S4.F2.21.10.m10.2.3">subscript</csymbol><ci id="S4.F2.21.10.m10.2.3.2.cmml" xref="S4.F2.21.10.m10.2.3.2">Δ</ci><apply id="S4.F2.21.10.m10.2.2.2.cmml" xref="S4.F2.21.10.m10.2.2.2"><csymbol cd="ambiguous" id="S4.F2.21.10.m10.2.2.2.3.cmml" xref="S4.F2.21.10.m10.2.2.2">subscript</csymbol><ci id="S4.F2.21.10.m10.2.2.2.4.cmml" xref="S4.F2.21.10.m10.2.2.2.4">𝑾</ci><list id="S4.F2.21.10.m10.2.2.2.2.2.3.cmml" xref="S4.F2.21.10.m10.2.2.2.2.2.4"><ci id="S4.F2.21.10.m10.1.1.1.1.1.1.cmml" xref="S4.F2.21.10.m10.1.1.1.1.1.1">:</ci><cn type="integer" id="S4.F2.21.10.m10.2.2.2.2.2.2.cmml" xref="S4.F2.21.10.m10.2.2.2.2.2.2">1</cn></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.21.10.m10.2d">\Delta_{\bm{W}_{:,1}}</annotation></semantics></math> as the restored feature <math id="S4.F2.22.11.m11.1" class="ltx_Math" alttext="\hat{\bm{r}}_{1}" display="inline"><semantics id="S4.F2.22.11.m11.1b"><msub id="S4.F2.22.11.m11.1.1" xref="S4.F2.22.11.m11.1.1.cmml"><mover accent="true" id="S4.F2.22.11.m11.1.1.2" xref="S4.F2.22.11.m11.1.1.2.cmml"><mi id="S4.F2.22.11.m11.1.1.2.2" xref="S4.F2.22.11.m11.1.1.2.2.cmml">𝒓</mi><mo id="S4.F2.22.11.m11.1.1.2.1" xref="S4.F2.22.11.m11.1.1.2.1.cmml">^</mo></mover><mn id="S4.F2.22.11.m11.1.1.3" xref="S4.F2.22.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.22.11.m11.1c"><apply id="S4.F2.22.11.m11.1.1.cmml" xref="S4.F2.22.11.m11.1.1"><csymbol cd="ambiguous" id="S4.F2.22.11.m11.1.1.1.cmml" xref="S4.F2.22.11.m11.1.1">subscript</csymbol><apply id="S4.F2.22.11.m11.1.1.2.cmml" xref="S4.F2.22.11.m11.1.1.2"><ci id="S4.F2.22.11.m11.1.1.2.1.cmml" xref="S4.F2.22.11.m11.1.1.2.1">^</ci><ci id="S4.F2.22.11.m11.1.1.2.2.cmml" xref="S4.F2.22.11.m11.1.1.2.2">𝒓</ci></apply><cn type="integer" id="S4.F2.22.11.m11.1.1.3.cmml" xref="S4.F2.22.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.22.11.m11.1d">\hat{\bm{r}}_{1}</annotation></semantics></math>.</span></figcaption>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.8" class="ltx_p">Essentially, <a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a> indicates that the restored feature <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="\hat{\bm{r}}_{i}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2.2" xref="S4.SS2.p4.1.m1.1.1.2.2.cmml">𝒓</mi><mo id="S4.SS2.p4.1.m1.1.1.2.1" xref="S4.SS2.p4.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2"><ci id="S4.SS2.p4.1.m1.1.1.2.1.cmml" xref="S4.SS2.p4.1.m1.1.1.2.1">^</ci><ci id="S4.SS2.p4.1.m1.1.1.2.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2.2">𝒓</ci></apply><ci id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">\hat{\bm{r}}_{i}</annotation></semantics></math> is approximately proportional to the true feature <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><msub id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">𝒓</mi><mi id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝒓</ci><ci id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">\bm{r}_{i}</annotation></semantics></math>.
The approximation in the last row of <a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a> holds because the probabilities assigned to the wrong class <math id="S4.SS2.p4.3.m3.2" class="ltx_Math" alttext="\bm{p}_{j,y_{i}}" display="inline"><semantics id="S4.SS2.p4.3.m3.2a"><msub id="S4.SS2.p4.3.m3.2.3" xref="S4.SS2.p4.3.m3.2.3.cmml"><mi id="S4.SS2.p4.3.m3.2.3.2" xref="S4.SS2.p4.3.m3.2.3.2.cmml">𝒑</mi><mrow id="S4.SS2.p4.3.m3.2.2.2.2" xref="S4.SS2.p4.3.m3.2.2.2.3.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.cmml">j</mi><mo id="S4.SS2.p4.3.m3.2.2.2.2.2" xref="S4.SS2.p4.3.m3.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p4.3.m3.2.2.2.2.1" xref="S4.SS2.p4.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS2.p4.3.m3.2.2.2.2.1.2" xref="S4.SS2.p4.3.m3.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS2.p4.3.m3.2.2.2.2.1.3" xref="S4.SS2.p4.3.m3.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.2b"><apply id="S4.SS2.p4.3.m3.2.3.cmml" xref="S4.SS2.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.2.3.1.cmml" xref="S4.SS2.p4.3.m3.2.3">subscript</csymbol><ci id="S4.SS2.p4.3.m3.2.3.2.cmml" xref="S4.SS2.p4.3.m3.2.3.2">𝒑</ci><list id="S4.SS2.p4.3.m3.2.2.2.3.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2"><ci id="S4.SS2.p4.3.m3.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1">𝑗</ci><apply id="S4.SS2.p4.3.m3.2.2.2.2.1.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p4.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS2.p4.3.m3.2.2.2.2.1.3.cmml" xref="S4.SS2.p4.3.m3.2.2.2.2.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.2c">\bm{p}_{j,y_{i}}</annotation></semantics></math> (recall that <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="y_{j}\neq y_{i}" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><mrow id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><msub id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2.2" xref="S4.SS2.p4.4.m4.1.1.2.2.cmml">y</mi><mi id="S4.SS2.p4.4.m4.1.1.2.3" xref="S4.SS2.p4.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S4.SS2.p4.4.m4.1.1.1" xref="S4.SS2.p4.4.m4.1.1.1.cmml">≠</mo><msub id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml"><mi id="S4.SS2.p4.4.m4.1.1.3.2" xref="S4.SS2.p4.4.m4.1.1.3.2.cmml">y</mi><mi id="S4.SS2.p4.4.m4.1.1.3.3" xref="S4.SS2.p4.4.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><neq id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1.1"></neq><apply id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.2.1.cmml" xref="S4.SS2.p4.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.2.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2.2">𝑦</ci><ci id="S4.SS2.p4.4.m4.1.1.2.3.cmml" xref="S4.SS2.p4.4.m4.1.1.2.3">𝑗</ci></apply><apply id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.3.1.cmml" xref="S4.SS2.p4.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.3.2.cmml" xref="S4.SS2.p4.4.m4.1.1.3.2">𝑦</ci><ci id="S4.SS2.p4.4.m4.1.1.3.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">y_{j}\neq y_{i}</annotation></semantics></math> when <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="j\neq i" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">j</mi><mo id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">≠</mo><mi id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><neq id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1"></neq><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">𝑗</ci><ci id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">j\neq i</annotation></semantics></math>) are becoming smaller and smaller as the training proceeds, therefore they may contribute much less to the summation than <math id="S4.SS2.p4.6.m6.3" class="ltx_Math" alttext="-(1-\bm{p}_{i,y_{i}})\bm{r}_{i}" display="inline"><semantics id="S4.SS2.p4.6.m6.3a"><mrow id="S4.SS2.p4.6.m6.3.3" xref="S4.SS2.p4.6.m6.3.3.cmml"><mo id="S4.SS2.p4.6.m6.3.3a" xref="S4.SS2.p4.6.m6.3.3.cmml">−</mo><mrow id="S4.SS2.p4.6.m6.3.3.1" xref="S4.SS2.p4.6.m6.3.3.1.cmml"><mrow id="S4.SS2.p4.6.m6.3.3.1.1.1" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p4.6.m6.3.3.1.1.1.2" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.6.m6.3.3.1.1.1.1" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.cmml"><mn id="S4.SS2.p4.6.m6.3.3.1.1.1.1.2" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p4.6.m6.3.3.1.1.1.1.1" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.1.cmml">−</mo><msub id="S4.SS2.p4.6.m6.3.3.1.1.1.1.3" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.2" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.2.cmml">𝒑</mi><mrow id="S4.SS2.p4.6.m6.2.2.2.2" xref="S4.SS2.p4.6.m6.2.2.2.3.cmml"><mi id="S4.SS2.p4.6.m6.1.1.1.1" xref="S4.SS2.p4.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p4.6.m6.2.2.2.2.2" xref="S4.SS2.p4.6.m6.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p4.6.m6.2.2.2.2.1" xref="S4.SS2.p4.6.m6.2.2.2.2.1.cmml"><mi id="S4.SS2.p4.6.m6.2.2.2.2.1.2" xref="S4.SS2.p4.6.m6.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS2.p4.6.m6.2.2.2.2.1.3" xref="S4.SS2.p4.6.m6.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow><mo stretchy="false" id="S4.SS2.p4.6.m6.3.3.1.1.1.3" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.SS2.p4.6.m6.3.3.1.2" xref="S4.SS2.p4.6.m6.3.3.1.2.cmml">​</mo><msub id="S4.SS2.p4.6.m6.3.3.1.3" xref="S4.SS2.p4.6.m6.3.3.1.3.cmml"><mi id="S4.SS2.p4.6.m6.3.3.1.3.2" xref="S4.SS2.p4.6.m6.3.3.1.3.2.cmml">𝒓</mi><mi id="S4.SS2.p4.6.m6.3.3.1.3.3" xref="S4.SS2.p4.6.m6.3.3.1.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.3b"><apply id="S4.SS2.p4.6.m6.3.3.cmml" xref="S4.SS2.p4.6.m6.3.3"><minus id="S4.SS2.p4.6.m6.3.3.2.cmml" xref="S4.SS2.p4.6.m6.3.3"></minus><apply id="S4.SS2.p4.6.m6.3.3.1.cmml" xref="S4.SS2.p4.6.m6.3.3.1"><times id="S4.SS2.p4.6.m6.3.3.1.2.cmml" xref="S4.SS2.p4.6.m6.3.3.1.2"></times><apply id="S4.SS2.p4.6.m6.3.3.1.1.1.1.cmml" xref="S4.SS2.p4.6.m6.3.3.1.1.1"><minus id="S4.SS2.p4.6.m6.3.3.1.1.1.1.1.cmml" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.1"></minus><cn type="integer" id="S4.SS2.p4.6.m6.3.3.1.1.1.1.2.cmml" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.2">1</cn><apply id="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.cmml" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.6.m6.3.3.1.1.1.1.3.2">𝒑</ci><list id="S4.SS2.p4.6.m6.2.2.2.3.cmml" xref="S4.SS2.p4.6.m6.2.2.2.2"><ci id="S4.SS2.p4.6.m6.1.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1.1.1">𝑖</ci><apply id="S4.SS2.p4.6.m6.2.2.2.2.1.cmml" xref="S4.SS2.p4.6.m6.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.2.2.2.2.1.1.cmml" xref="S4.SS2.p4.6.m6.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p4.6.m6.2.2.2.2.1.2.cmml" xref="S4.SS2.p4.6.m6.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS2.p4.6.m6.2.2.2.2.1.3.cmml" xref="S4.SS2.p4.6.m6.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply><apply id="S4.SS2.p4.6.m6.3.3.1.3.cmml" xref="S4.SS2.p4.6.m6.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.3.3.1.3.1.cmml" xref="S4.SS2.p4.6.m6.3.3.1.3">subscript</csymbol><ci id="S4.SS2.p4.6.m6.3.3.1.3.2.cmml" xref="S4.SS2.p4.6.m6.3.3.1.3.2">𝒓</ci><ci id="S4.SS2.p4.6.m6.3.3.1.3.3.cmml" xref="S4.SS2.p4.6.m6.3.3.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.3c">-(1-\bm{p}_{i,y_{i}})\bm{r}_{i}</annotation></semantics></math>, especially if <math id="S4.SS2.p4.7.m7.2" class="ltx_Math" alttext="\bm{p}_{i,y_{i}}" display="inline"><semantics id="S4.SS2.p4.7.m7.2a"><msub id="S4.SS2.p4.7.m7.2.3" xref="S4.SS2.p4.7.m7.2.3.cmml"><mi id="S4.SS2.p4.7.m7.2.3.2" xref="S4.SS2.p4.7.m7.2.3.2.cmml">𝒑</mi><mrow id="S4.SS2.p4.7.m7.2.2.2.2" xref="S4.SS2.p4.7.m7.2.2.2.3.cmml"><mi id="S4.SS2.p4.7.m7.1.1.1.1" xref="S4.SS2.p4.7.m7.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p4.7.m7.2.2.2.2.2" xref="S4.SS2.p4.7.m7.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p4.7.m7.2.2.2.2.1" xref="S4.SS2.p4.7.m7.2.2.2.2.1.cmml"><mi id="S4.SS2.p4.7.m7.2.2.2.2.1.2" xref="S4.SS2.p4.7.m7.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS2.p4.7.m7.2.2.2.2.1.3" xref="S4.SS2.p4.7.m7.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.2b"><apply id="S4.SS2.p4.7.m7.2.3.cmml" xref="S4.SS2.p4.7.m7.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.2.3.1.cmml" xref="S4.SS2.p4.7.m7.2.3">subscript</csymbol><ci id="S4.SS2.p4.7.m7.2.3.2.cmml" xref="S4.SS2.p4.7.m7.2.3.2">𝒑</ci><list id="S4.SS2.p4.7.m7.2.2.2.3.cmml" xref="S4.SS2.p4.7.m7.2.2.2.2"><ci id="S4.SS2.p4.7.m7.1.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1.1.1">𝑖</ci><apply id="S4.SS2.p4.7.m7.2.2.2.2.1.cmml" xref="S4.SS2.p4.7.m7.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.2.2.2.2.1.1.cmml" xref="S4.SS2.p4.7.m7.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p4.7.m7.2.2.2.2.1.2.cmml" xref="S4.SS2.p4.7.m7.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS2.p4.7.m7.2.2.2.2.1.3.cmml" xref="S4.SS2.p4.7.m7.2.2.2.2.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.2c">\bm{p}_{i,y_{i}}</annotation></semantics></math> is not too large.
In fact, this is exactly the case for an AT model.
During each iteration, AT uses adversarial examples as inputs, which are generated by maximizing the cross-entropy loss.
Equivalently, adversarial examples minimize the probability assigned to the ground-truth class, <em id="S4.SS2.p4.8.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p4.8.2" class="ltx_text"></span>, <math id="S4.SS2.p4.8.m8.2" class="ltx_Math" alttext="\bm{p}_{i,y_{i}}" display="inline"><semantics id="S4.SS2.p4.8.m8.2a"><msub id="S4.SS2.p4.8.m8.2.3" xref="S4.SS2.p4.8.m8.2.3.cmml"><mi id="S4.SS2.p4.8.m8.2.3.2" xref="S4.SS2.p4.8.m8.2.3.2.cmml">𝒑</mi><mrow id="S4.SS2.p4.8.m8.2.2.2.2" xref="S4.SS2.p4.8.m8.2.2.2.3.cmml"><mi id="S4.SS2.p4.8.m8.1.1.1.1" xref="S4.SS2.p4.8.m8.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p4.8.m8.2.2.2.2.2" xref="S4.SS2.p4.8.m8.2.2.2.3.cmml">,</mo><msub id="S4.SS2.p4.8.m8.2.2.2.2.1" xref="S4.SS2.p4.8.m8.2.2.2.2.1.cmml"><mi id="S4.SS2.p4.8.m8.2.2.2.2.1.2" xref="S4.SS2.p4.8.m8.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS2.p4.8.m8.2.2.2.2.1.3" xref="S4.SS2.p4.8.m8.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.2b"><apply id="S4.SS2.p4.8.m8.2.3.cmml" xref="S4.SS2.p4.8.m8.2.3"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.2.3.1.cmml" xref="S4.SS2.p4.8.m8.2.3">subscript</csymbol><ci id="S4.SS2.p4.8.m8.2.3.2.cmml" xref="S4.SS2.p4.8.m8.2.3.2">𝒑</ci><list id="S4.SS2.p4.8.m8.2.2.2.3.cmml" xref="S4.SS2.p4.8.m8.2.2.2.2"><ci id="S4.SS2.p4.8.m8.1.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1">𝑖</ci><apply id="S4.SS2.p4.8.m8.2.2.2.2.1.cmml" xref="S4.SS2.p4.8.m8.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.2.2.2.2.1.1.cmml" xref="S4.SS2.p4.8.m8.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p4.8.m8.2.2.2.2.1.2.cmml" xref="S4.SS2.p4.8.m8.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS2.p4.8.m8.2.2.2.2.1.3.cmml" xref="S4.SS2.p4.8.m8.2.2.2.2.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.2c">\bm{p}_{i,y_{i}}</annotation></semantics></math>.
As a result, AT models can lead to a more tight approximation of <a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a> and better restoration of the features.
We present a toy example of the feature restoration process in <a href="#S4.F2" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
Note, although in the case of AT the attacker is actually reconstructing the adversarial example, the privacy can still be compromised because the adversarial image is visually very similar to the clean image since their distance is bounded by a small value.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.9" class="ltx_p">We finally discuss how to recover the batch labels <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">y</mi><mi id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝑦</ci><ci id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">y_{i}</annotation></semantics></math>, which is necessary for knowing which columns of the gradient matrix of <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\bm{W}</annotation></semantics></math> should be taken for feature restoration.
Here we adopt the common practice of existing works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, which is to look at the sign of the gradient elements of <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\bm{W}</annotation></semantics></math>.
For the ease of illustration, without loss of generality, assume that the batch of <math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><mi id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><ci id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">N</annotation></semantics></math> samples are with the labels <math id="S4.SS2.p5.5.m5.4" class="ltx_Math" alttext="1,2,...,N" display="inline"><semantics id="S4.SS2.p5.5.m5.4a"><mrow id="S4.SS2.p5.5.m5.4.5.2" xref="S4.SS2.p5.5.m5.4.5.1.cmml"><mn id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml">1</mn><mo id="S4.SS2.p5.5.m5.4.5.2.1" xref="S4.SS2.p5.5.m5.4.5.1.cmml">,</mo><mn id="S4.SS2.p5.5.m5.2.2" xref="S4.SS2.p5.5.m5.2.2.cmml">2</mn><mo id="S4.SS2.p5.5.m5.4.5.2.2" xref="S4.SS2.p5.5.m5.4.5.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p5.5.m5.3.3" xref="S4.SS2.p5.5.m5.3.3.cmml">…</mi><mo id="S4.SS2.p5.5.m5.4.5.2.3" xref="S4.SS2.p5.5.m5.4.5.1.cmml">,</mo><mi id="S4.SS2.p5.5.m5.4.4" xref="S4.SS2.p5.5.m5.4.4.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.5.m5.4b"><list id="S4.SS2.p5.5.m5.4.5.1.cmml" xref="S4.SS2.p5.5.m5.4.5.2"><cn type="integer" id="S4.SS2.p5.5.m5.1.1.cmml" xref="S4.SS2.p5.5.m5.1.1">1</cn><cn type="integer" id="S4.SS2.p5.5.m5.2.2.cmml" xref="S4.SS2.p5.5.m5.2.2">2</cn><ci id="S4.SS2.p5.5.m5.3.3.cmml" xref="S4.SS2.p5.5.m5.3.3">…</ci><ci id="S4.SS2.p5.5.m5.4.4.cmml" xref="S4.SS2.p5.5.m5.4.4">𝑁</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.5.m5.4c">1,2,...,N</annotation></semantics></math>, <em id="S4.SS2.p5.9.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS2.p5.9.2" class="ltx_text"></span>, the <math id="S4.SS2.p5.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p5.6.m6.1a"><mi id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.6.m6.1b"><ci id="S4.SS2.p5.6.m6.1.1.cmml" xref="S4.SS2.p5.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.6.m6.1c">k</annotation></semantics></math>-th sample is from the <math id="S4.SS2.p5.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p5.7.m7.1a"><mi id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.7.m7.1b"><ci id="S4.SS2.p5.7.m7.1.1.cmml" xref="S4.SS2.p5.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.7.m7.1c">k</annotation></semantics></math>-th class.
Then according to <a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, the gradients w.r.t. the <math id="S4.SS2.p5.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p5.8.m8.1a"><mi id="S4.SS2.p5.8.m8.1.1" xref="S4.SS2.p5.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.8.m8.1b"><ci id="S4.SS2.p5.8.m8.1.1.cmml" xref="S4.SS2.p5.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.8.m8.1c">k</annotation></semantics></math>-th column of <math id="S4.SS2.p5.9.m9.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S4.SS2.p5.9.m9.1a"><mi id="S4.SS2.p5.9.m9.1.1" xref="S4.SS2.p5.9.m9.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.9.m9.1b"><ci id="S4.SS2.p5.9.m9.1.1.cmml" xref="S4.SS2.p5.9.m9.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.9.m9.1c">\bm{W}</annotation></semantics></math> are:</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex4.m1.2" class="ltx_Math" alttext="\displaystyle\frac{1}{N}\sum_{j=1}^{N}\frac{\partial l_{j}}{\partial\bm{W}_{:,k}}\propto" display="inline"><semantics id="S4.Ex4.m1.2a"><mrow id="S4.Ex4.m1.2.3" xref="S4.Ex4.m1.2.3.cmml"><mrow id="S4.Ex4.m1.2.3.2" xref="S4.Ex4.m1.2.3.2.cmml"><mstyle displaystyle="true" id="S4.Ex4.m1.2.3.2.2" xref="S4.Ex4.m1.2.3.2.2.cmml"><mfrac id="S4.Ex4.m1.2.3.2.2a" xref="S4.Ex4.m1.2.3.2.2.cmml"><mn id="S4.Ex4.m1.2.3.2.2.2" xref="S4.Ex4.m1.2.3.2.2.2.cmml">1</mn><mi id="S4.Ex4.m1.2.3.2.2.3" xref="S4.Ex4.m1.2.3.2.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.Ex4.m1.2.3.2.1" xref="S4.Ex4.m1.2.3.2.1.cmml">​</mo><mrow id="S4.Ex4.m1.2.3.2.3" xref="S4.Ex4.m1.2.3.2.3.cmml"><mstyle displaystyle="true" id="S4.Ex4.m1.2.3.2.3.1" xref="S4.Ex4.m1.2.3.2.3.1.cmml"><munderover id="S4.Ex4.m1.2.3.2.3.1a" xref="S4.Ex4.m1.2.3.2.3.1.cmml"><mo movablelimits="false" id="S4.Ex4.m1.2.3.2.3.1.2.2" xref="S4.Ex4.m1.2.3.2.3.1.2.2.cmml">∑</mo><mrow id="S4.Ex4.m1.2.3.2.3.1.2.3" xref="S4.Ex4.m1.2.3.2.3.1.2.3.cmml"><mi id="S4.Ex4.m1.2.3.2.3.1.2.3.2" xref="S4.Ex4.m1.2.3.2.3.1.2.3.2.cmml">j</mi><mo id="S4.Ex4.m1.2.3.2.3.1.2.3.1" xref="S4.Ex4.m1.2.3.2.3.1.2.3.1.cmml">=</mo><mn id="S4.Ex4.m1.2.3.2.3.1.2.3.3" xref="S4.Ex4.m1.2.3.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.Ex4.m1.2.3.2.3.1.3" xref="S4.Ex4.m1.2.3.2.3.1.3.cmml">N</mi></munderover></mstyle><mstyle displaystyle="true" id="S4.Ex4.m1.2.2" xref="S4.Ex4.m1.2.2.cmml"><mfrac id="S4.Ex4.m1.2.2a" xref="S4.Ex4.m1.2.2.cmml"><mrow id="S4.Ex4.m1.2.2.4" xref="S4.Ex4.m1.2.2.4.cmml"><mo rspace="0em" id="S4.Ex4.m1.2.2.4.1" xref="S4.Ex4.m1.2.2.4.1.cmml">∂</mo><msub id="S4.Ex4.m1.2.2.4.2" xref="S4.Ex4.m1.2.2.4.2.cmml"><mi id="S4.Ex4.m1.2.2.4.2.2" xref="S4.Ex4.m1.2.2.4.2.2.cmml">l</mi><mi id="S4.Ex4.m1.2.2.4.2.3" xref="S4.Ex4.m1.2.2.4.2.3.cmml">j</mi></msub></mrow><mrow id="S4.Ex4.m1.2.2.2" xref="S4.Ex4.m1.2.2.2.cmml"><mo rspace="0em" id="S4.Ex4.m1.2.2.2.3" xref="S4.Ex4.m1.2.2.2.3.cmml">∂</mo><msub id="S4.Ex4.m1.2.2.2.4" xref="S4.Ex4.m1.2.2.2.4.cmml"><mi id="S4.Ex4.m1.2.2.2.4.2" xref="S4.Ex4.m1.2.2.2.4.2.cmml">𝑾</mi><mrow id="S4.Ex4.m1.2.2.2.2.2.4" xref="S4.Ex4.m1.2.2.2.2.2.3.cmml"><mo rspace="0em" id="S4.Ex4.m1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.cmml">:</mo><mo id="S4.Ex4.m1.2.2.2.2.2.4.1" xref="S4.Ex4.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.Ex4.m1.2.2.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.2.2.cmml">k</mi></mrow></msub></mrow></mfrac></mstyle></mrow></mrow><mo id="S4.Ex4.m1.2.3.1" xref="S4.Ex4.m1.2.3.1.cmml">∝</mo><mi id="S4.Ex4.m1.2.3.3" xref="S4.Ex4.m1.2.3.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex4.m1.2b"><apply id="S4.Ex4.m1.2.3.cmml" xref="S4.Ex4.m1.2.3"><csymbol cd="latexml" id="S4.Ex4.m1.2.3.1.cmml" xref="S4.Ex4.m1.2.3.1">proportional-to</csymbol><apply id="S4.Ex4.m1.2.3.2.cmml" xref="S4.Ex4.m1.2.3.2"><times id="S4.Ex4.m1.2.3.2.1.cmml" xref="S4.Ex4.m1.2.3.2.1"></times><apply id="S4.Ex4.m1.2.3.2.2.cmml" xref="S4.Ex4.m1.2.3.2.2"><divide id="S4.Ex4.m1.2.3.2.2.1.cmml" xref="S4.Ex4.m1.2.3.2.2"></divide><cn type="integer" id="S4.Ex4.m1.2.3.2.2.2.cmml" xref="S4.Ex4.m1.2.3.2.2.2">1</cn><ci id="S4.Ex4.m1.2.3.2.2.3.cmml" xref="S4.Ex4.m1.2.3.2.2.3">𝑁</ci></apply><apply id="S4.Ex4.m1.2.3.2.3.cmml" xref="S4.Ex4.m1.2.3.2.3"><apply id="S4.Ex4.m1.2.3.2.3.1.cmml" xref="S4.Ex4.m1.2.3.2.3.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.3.2.3.1.1.cmml" xref="S4.Ex4.m1.2.3.2.3.1">superscript</csymbol><apply id="S4.Ex4.m1.2.3.2.3.1.2.cmml" xref="S4.Ex4.m1.2.3.2.3.1"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.3.2.3.1.2.1.cmml" xref="S4.Ex4.m1.2.3.2.3.1">subscript</csymbol><sum id="S4.Ex4.m1.2.3.2.3.1.2.2.cmml" xref="S4.Ex4.m1.2.3.2.3.1.2.2"></sum><apply id="S4.Ex4.m1.2.3.2.3.1.2.3.cmml" xref="S4.Ex4.m1.2.3.2.3.1.2.3"><eq id="S4.Ex4.m1.2.3.2.3.1.2.3.1.cmml" xref="S4.Ex4.m1.2.3.2.3.1.2.3.1"></eq><ci id="S4.Ex4.m1.2.3.2.3.1.2.3.2.cmml" xref="S4.Ex4.m1.2.3.2.3.1.2.3.2">𝑗</ci><cn type="integer" id="S4.Ex4.m1.2.3.2.3.1.2.3.3.cmml" xref="S4.Ex4.m1.2.3.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.Ex4.m1.2.3.2.3.1.3.cmml" xref="S4.Ex4.m1.2.3.2.3.1.3">𝑁</ci></apply><apply id="S4.Ex4.m1.2.2.cmml" xref="S4.Ex4.m1.2.2"><divide id="S4.Ex4.m1.2.2.3.cmml" xref="S4.Ex4.m1.2.2"></divide><apply id="S4.Ex4.m1.2.2.4.cmml" xref="S4.Ex4.m1.2.2.4"><partialdiff id="S4.Ex4.m1.2.2.4.1.cmml" xref="S4.Ex4.m1.2.2.4.1"></partialdiff><apply id="S4.Ex4.m1.2.2.4.2.cmml" xref="S4.Ex4.m1.2.2.4.2"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.4.2.1.cmml" xref="S4.Ex4.m1.2.2.4.2">subscript</csymbol><ci id="S4.Ex4.m1.2.2.4.2.2.cmml" xref="S4.Ex4.m1.2.2.4.2.2">𝑙</ci><ci id="S4.Ex4.m1.2.2.4.2.3.cmml" xref="S4.Ex4.m1.2.2.4.2.3">𝑗</ci></apply></apply><apply id="S4.Ex4.m1.2.2.2.cmml" xref="S4.Ex4.m1.2.2.2"><partialdiff id="S4.Ex4.m1.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.2.3"></partialdiff><apply id="S4.Ex4.m1.2.2.2.4.cmml" xref="S4.Ex4.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.Ex4.m1.2.2.2.4.1.cmml" xref="S4.Ex4.m1.2.2.2.4">subscript</csymbol><ci id="S4.Ex4.m1.2.2.2.4.2.cmml" xref="S4.Ex4.m1.2.2.2.4.2">𝑾</ci><list id="S4.Ex4.m1.2.2.2.2.2.3.cmml" xref="S4.Ex4.m1.2.2.2.2.2.4"><ci id="S4.Ex4.m1.1.1.1.1.1.1.cmml" xref="S4.Ex4.m1.1.1.1.1.1.1">:</ci><ci id="S4.Ex4.m1.2.2.2.2.2.2.cmml" xref="S4.Ex4.m1.2.2.2.2.2.2">𝑘</ci></list></apply></apply></apply></apply></apply><csymbol cd="latexml" id="S4.Ex4.m1.2.3.3.cmml" xref="S4.Ex4.m1.2.3.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex4.m1.2c">\displaystyle\frac{1}{N}\sum_{j=1}^{N}\frac{\partial l_{j}}{\partial\bm{W}_{:,k}}\propto</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5.m1.5" class="ltx_Math" alttext="\displaystyle~{}~{}~{}~{}~{}~{}\begin{cases}-(1-\bm{p}_{k,k})\bm{r}_{k}+\sum_{j=1,j\neq k}^{N}\bm{p}_{j,k}\bm{r}_{j},&amp;~{}1\leq k\leq N\\
\sum_{j=1}^{N}\bm{p}_{j,k}\bm{r}_{j},&amp;N&lt;k\leq K\end{cases}." display="inline"><semantics id="S4.E5.m1.5a"><mrow id="S4.E5.m1.5.6.2"><mrow id="S4.E5.m1.4.4a" xref="S4.E5.m1.5.5.1.cmml"><mo id="S4.E5.m1.4.4a.5" xref="S4.E5.m1.5.5.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E5.m1.4.4.4a" xref="S4.E5.m1.5.5.1.cmml"><mtr id="S4.E5.m1.4.4.4aa" xref="S4.E5.m1.5.5.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m1.4.4.4ab" xref="S4.E5.m1.5.5.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.7" xref="S4.E5.m1.1.1.1.1.1.1.7.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.7.1.1a" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.cmml">−</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.cmml"><mn id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.2.cmml">𝒑</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.2.2.4" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">k</mi><mo id="S4.E5.m1.1.1.1.1.1.1.2.2.4.1" xref="S4.E5.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S4.E5.m1.1.1.1.1.1.1.2.2.2" xref="S4.E5.m1.1.1.1.1.1.1.2.2.2.cmml">k</mi></mrow></msub></mrow><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.2.cmml">​</mo><msub id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.2.cmml">𝒓</mi><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.3.cmml">k</mi></msub></mrow></mrow><mo rspace="0.055em" id="S4.E5.m1.1.1.1.1.1.1.7.1.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.2.cmml">+</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.cmml"><msubsup id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.4.2.2" xref="S4.E5.m1.1.1.1.1.1.1.4.2.3.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.2.cmml">j</mi><mo id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.1.cmml">=</mo><mn id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.4.2.2.3" xref="S4.E5.m1.1.1.1.1.1.1.4.2.3a.cmml">,</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.2" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.2.cmml">j</mi><mo id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.1" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.1.cmml">≠</mo><mi id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.3" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.3.cmml">k</mi></mrow></mrow><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.3.cmml">N</mi></msubsup><mrow id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.cmml"><msub id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.2.cmml">𝒑</mi><mrow id="S4.E5.m1.1.1.1.1.1.1.6.2.4" xref="S4.E5.m1.1.1.1.1.1.1.6.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.5.1.1" xref="S4.E5.m1.1.1.1.1.1.1.5.1.1.cmml">j</mi><mo id="S4.E5.m1.1.1.1.1.1.1.6.2.4.1" xref="S4.E5.m1.1.1.1.1.1.1.6.2.3.cmml">,</mo><mi id="S4.E5.m1.1.1.1.1.1.1.6.2.2" xref="S4.E5.m1.1.1.1.1.1.1.6.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.1" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.1.cmml">​</mo><msub id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.2.cmml">𝒓</mi><mi id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.3" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.7.2" xref="S4.E5.m1.1.1.1.1.1.1.7.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m1.4.4.4ac" xref="S4.E5.m1.5.5.1.cmml"><mrow id="S4.E5.m1.2.2.2.2.2.1" xref="S4.E5.m1.2.2.2.2.2.1.cmml"><mn id="S4.E5.m1.2.2.2.2.2.1.2" xref="S4.E5.m1.2.2.2.2.2.1.2.cmml">1</mn><mo id="S4.E5.m1.2.2.2.2.2.1.3" xref="S4.E5.m1.2.2.2.2.2.1.3.cmml">≤</mo><mi id="S4.E5.m1.2.2.2.2.2.1.4" xref="S4.E5.m1.2.2.2.2.2.1.4.cmml">k</mi><mo id="S4.E5.m1.2.2.2.2.2.1.5" xref="S4.E5.m1.2.2.2.2.2.1.5.cmml">≤</mo><mi id="S4.E5.m1.2.2.2.2.2.1.6" xref="S4.E5.m1.2.2.2.2.2.1.6.cmml">N</mi></mrow></mtd></mtr><mtr id="S4.E5.m1.4.4.4ad" xref="S4.E5.m1.5.5.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m1.4.4.4ae" xref="S4.E5.m1.5.5.1.cmml"><mrow id="S4.E5.m1.3.3.3.3.1.1.3" xref="S4.E5.m1.3.3.3.3.1.1.3.1.cmml"><mrow id="S4.E5.m1.3.3.3.3.1.1.3.1" xref="S4.E5.m1.3.3.3.3.1.1.3.1.cmml"><msubsup id="S4.E5.m1.3.3.3.3.1.1.3.1.1" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.cmml"><mo id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.cmml"><mi id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.2.cmml">j</mi><mo id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.1" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.1.cmml">=</mo><mn id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.3" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.3.3.3.3.1.1.3.1.1.3" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.3.cmml">N</mi></msubsup><mrow id="S4.E5.m1.3.3.3.3.1.1.3.1.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.cmml"><msub id="S4.E5.m1.3.3.3.3.1.1.3.1.2.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.cmml"><mi id="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.2.cmml">𝒑</mi><mrow id="S4.E5.m1.3.3.3.3.1.1.2.2.4" xref="S4.E5.m1.3.3.3.3.1.1.2.2.3.cmml"><mi id="S4.E5.m1.3.3.3.3.1.1.1.1.1" xref="S4.E5.m1.3.3.3.3.1.1.1.1.1.cmml">j</mi><mo id="S4.E5.m1.3.3.3.3.1.1.2.2.4.1" xref="S4.E5.m1.3.3.3.3.1.1.2.2.3.cmml">,</mo><mi id="S4.E5.m1.3.3.3.3.1.1.2.2.2" xref="S4.E5.m1.3.3.3.3.1.1.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.3.3.1.1.3.1.2.1" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.1.cmml">​</mo><msub id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.cmml"><mi id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.2.cmml">𝒓</mi><mi id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.3" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S4.E5.m1.3.3.3.3.1.1.3.2" xref="S4.E5.m1.3.3.3.3.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m1.4.4.4af" xref="S4.E5.m1.5.5.1.cmml"><mrow id="S4.E5.m1.4.4.4.4.2.1" xref="S4.E5.m1.4.4.4.4.2.1.cmml"><mi id="S4.E5.m1.4.4.4.4.2.1.2" xref="S4.E5.m1.4.4.4.4.2.1.2.cmml">N</mi><mo id="S4.E5.m1.4.4.4.4.2.1.3" xref="S4.E5.m1.4.4.4.4.2.1.3.cmml">&lt;</mo><mi id="S4.E5.m1.4.4.4.4.2.1.4" xref="S4.E5.m1.4.4.4.4.2.1.4.cmml">k</mi><mo id="S4.E5.m1.4.4.4.4.2.1.5" xref="S4.E5.m1.4.4.4.4.2.1.5.cmml">≤</mo><mi id="S4.E5.m1.4.4.4.4.2.1.6" xref="S4.E5.m1.4.4.4.4.2.1.6.cmml">K</mi></mrow></mtd></mtr></mtable></mrow><mo lspace="0em" id="S4.E5.m1.5.6.2.1">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.5b"><apply id="S4.E5.m1.5.5.1.cmml" xref="S4.E5.m1.4.4a"><csymbol cd="latexml" id="S4.E5.m1.5.5.1.1.cmml" xref="S4.E5.m1.4.4a.5">cases</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7"><plus id="S4.E5.m1.1.1.1.1.1.1.7.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.2"></plus><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1"><minus id="S4.E5.m1.1.1.1.1.1.1.7.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1"></minus><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1"><minus id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.2">1</cn><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.1.1.1.3.2">𝒑</ci><list id="S4.E5.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.4"><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1">𝑘</ci><ci id="S4.E5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2.2.2">𝑘</ci></list></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.2">𝒓</ci><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3"><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1">subscript</csymbol><sum id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.2.2"></sum><apply id="S4.E5.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.4.2.3a.cmml" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1"><eq id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.1"></eq><ci id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.2">𝑗</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.1.1.1.3">1</cn></apply><apply id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2"><neq id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.1"></neq><ci id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.2">𝑗</ci><ci id="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.4.2.2.2.3">𝑘</ci></apply></apply></apply><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.1.3">𝑁</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2"><times id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.1"></times><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.2.2">𝒑</ci><list id="S4.E5.m1.1.1.1.1.1.1.6.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.6.2.4"><ci id="S4.E5.m1.1.1.1.1.1.1.5.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.5.1.1">𝑗</ci><ci id="S4.E5.m1.1.1.1.1.1.1.6.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.6.2.2">𝑘</ci></list></apply><apply id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.2">𝒓</ci><ci id="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.7.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E5.m1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.2.1"><and id="S4.E5.m1.2.2.2.2.2.1a.cmml" xref="S4.E5.m1.2.2.2.2.2.1"></and><apply id="S4.E5.m1.2.2.2.2.2.1b.cmml" xref="S4.E5.m1.2.2.2.2.2.1"><leq id="S4.E5.m1.2.2.2.2.2.1.3.cmml" xref="S4.E5.m1.2.2.2.2.2.1.3"></leq><cn type="integer" id="S4.E5.m1.2.2.2.2.2.1.2.cmml" xref="S4.E5.m1.2.2.2.2.2.1.2">1</cn><ci id="S4.E5.m1.2.2.2.2.2.1.4.cmml" xref="S4.E5.m1.2.2.2.2.2.1.4">𝑘</ci></apply><apply id="S4.E5.m1.2.2.2.2.2.1c.cmml" xref="S4.E5.m1.2.2.2.2.2.1"><leq id="S4.E5.m1.2.2.2.2.2.1.5.cmml" xref="S4.E5.m1.2.2.2.2.2.1.5"></leq><share href="#S4.E5.m1.2.2.2.2.2.1.4.cmml" id="S4.E5.m1.2.2.2.2.2.1d.cmml" xref="S4.E5.m1.2.2.2.2.2.1"></share><ci id="S4.E5.m1.2.2.2.2.2.1.6.cmml" xref="S4.E5.m1.2.2.2.2.2.1.6">𝑁</ci></apply></apply><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3"><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.3.1.1.3.1.1.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1">superscript</csymbol><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1">subscript</csymbol><sum id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.2"></sum><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3"><eq id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.1"></eq><ci id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.2">𝑗</ci><cn type="integer" id="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.3.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.3.3.3.3.1.1.3.1.1.3.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.1.3">𝑁</ci></apply><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2"><times id="S4.E5.m1.3.3.3.3.1.1.3.1.2.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.1"></times><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.2">subscript</csymbol><ci id="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.2.2">𝒑</ci><list id="S4.E5.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S4.E5.m1.3.3.3.3.1.1.2.2.4"><ci id="S4.E5.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.1.1.1">𝑗</ci><ci id="S4.E5.m1.3.3.3.3.1.1.2.2.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.2.2.2">𝑘</ci></list></apply><apply id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.1.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3">subscript</csymbol><ci id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.2.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.2">𝒓</ci><ci id="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.3.cmml" xref="S4.E5.m1.3.3.3.3.1.1.3.1.2.3.3">𝑗</ci></apply></apply></apply><apply id="S4.E5.m1.4.4.4.4.2.1.cmml" xref="S4.E5.m1.4.4.4.4.2.1"><and id="S4.E5.m1.4.4.4.4.2.1a.cmml" xref="S4.E5.m1.4.4.4.4.2.1"></and><apply id="S4.E5.m1.4.4.4.4.2.1b.cmml" xref="S4.E5.m1.4.4.4.4.2.1"><lt id="S4.E5.m1.4.4.4.4.2.1.3.cmml" xref="S4.E5.m1.4.4.4.4.2.1.3"></lt><ci id="S4.E5.m1.4.4.4.4.2.1.2.cmml" xref="S4.E5.m1.4.4.4.4.2.1.2">𝑁</ci><ci id="S4.E5.m1.4.4.4.4.2.1.4.cmml" xref="S4.E5.m1.4.4.4.4.2.1.4">𝑘</ci></apply><apply id="S4.E5.m1.4.4.4.4.2.1c.cmml" xref="S4.E5.m1.4.4.4.4.2.1"><leq id="S4.E5.m1.4.4.4.4.2.1.5.cmml" xref="S4.E5.m1.4.4.4.4.2.1.5"></leq><share href="#S4.E5.m1.4.4.4.4.2.1.4.cmml" id="S4.E5.m1.4.4.4.4.2.1d.cmml" xref="S4.E5.m1.4.4.4.4.2.1"></share><ci id="S4.E5.m1.4.4.4.4.2.1.6.cmml" xref="S4.E5.m1.4.4.4.4.2.1.6">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.5c">\displaystyle~{}~{}~{}~{}~{}~{}\begin{cases}-(1-\bm{p}_{k,k})\bm{r}_{k}+\sum_{j=1,j\neq k}^{N}\bm{p}_{j,k}\bm{r}_{j},&amp;~{}1\leq k\leq N\\
\sum_{j=1}^{N}\bm{p}_{j,k}\bm{r}_{j},&amp;N&lt;k\leq K\end{cases}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p6.5" class="ltx_p">Note that modern DNN architectures (<em id="S4.SS2.p6.5.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS2.p6.5.2" class="ltx_text"></span>, ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and VGG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>) typically use ReLU as the activation function, which makes the elements of the feature vector <math id="S4.SS2.p6.1.m1.1" class="ltx_Math" alttext="\bm{r}" display="inline"><semantics id="S4.SS2.p6.1.m1.1a"><mi id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml">𝒓</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><ci id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1">𝒓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">\bm{r}</annotation></semantics></math> always non-negative.
With this in mind, the takeaway of <a href="#S4.E5" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">5</span></a> is that in the gradient matrix of <math id="S4.SS2.p6.2.m2.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S4.SS2.p6.2.m2.1a"><mi id="S4.SS2.p6.2.m2.1.1" xref="S4.SS2.p6.2.m2.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.2.m2.1b"><ci id="S4.SS2.p6.2.m2.1.1.cmml" xref="S4.SS2.p6.2.m2.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.2.m2.1c">\bm{W}</annotation></semantics></math>, only the columns that correspond to the appeared labels may have negative elements, while the other columns will have all positive values.
Therefore, we can determine the batch labels by checking the sign of the smallest value of each column.
If the smallest value of <math id="S4.SS2.p6.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p6.3.m3.1a"><mi id="S4.SS2.p6.3.m3.1.1" xref="S4.SS2.p6.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.3.m3.1b"><ci id="S4.SS2.p6.3.m3.1.1.cmml" xref="S4.SS2.p6.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.3.m3.1c">k</annotation></semantics></math>-th column is positive, then <math id="S4.SS2.p6.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p6.4.m4.1a"><mi id="S4.SS2.p6.4.m4.1.1" xref="S4.SS2.p6.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.4.m4.1b"><ci id="S4.SS2.p6.4.m4.1.1.cmml" xref="S4.SS2.p6.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.4.m4.1c">k</annotation></semantics></math> is very unlikely to be one of the batch labels.
In practice, one can pick the top-<math id="S4.SS2.p6.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.p6.5.m5.1a"><mi id="S4.SS2.p6.5.m5.1.1" xref="S4.SS2.p6.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.5.m5.1b"><ci id="S4.SS2.p6.5.m5.1.1.cmml" xref="S4.SS2.p6.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.5.m5.1c">N</annotation></semantics></math> columns that have the smallest elements, and take their indices as the batch labels.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Image reconstruction from features</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Once we obtain the restored feature <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\hat{\bm{r}}_{i}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2.2" xref="S4.SS3.p1.1.m1.1.1.2.2.cmml">𝒓</mi><mo id="S4.SS3.p1.1.m1.1.1.2.1" xref="S4.SS3.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><ci id="S4.SS3.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.1.2.1">^</ci><ci id="S4.SS3.p1.1.m1.1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2.2">𝒓</ci></apply><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\hat{\bm{r}}_{i}</annotation></semantics></math>, the attacker can reconstruct each input image by solving the following optimization objective:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\operatorname*{arg\,min}_{\bm{z}_{i}}\mathcal{L}_{\text{feat}}\left(r_{\theta}(\bm{z}_{i}),\hat{\bm{r}}_{i}\right)+\mathcal{R}(\bm{z}_{i})." display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml"><mrow id="S4.E6.m1.1.1.1.1.2.4" xref="S4.E6.m1.1.1.1.1.2.4.cmml"><munder id="S4.E6.m1.1.1.1.1.2.4.1" xref="S4.E6.m1.1.1.1.1.2.4.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.2.4.1.2" xref="S4.E6.m1.1.1.1.1.2.4.1.2.cmml"><mi id="S4.E6.m1.1.1.1.1.2.4.1.2.2" xref="S4.E6.m1.1.1.1.1.2.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E6.m1.1.1.1.1.2.4.1.2.1" xref="S4.E6.m1.1.1.1.1.2.4.1.2.1.cmml">​</mo><mi id="S4.E6.m1.1.1.1.1.2.4.1.2.3" xref="S4.E6.m1.1.1.1.1.2.4.1.2.3.cmml">min</mi></mrow><msub id="S4.E6.m1.1.1.1.1.2.4.1.3" xref="S4.E6.m1.1.1.1.1.2.4.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.2.4.1.3.2" xref="S4.E6.m1.1.1.1.1.2.4.1.3.2.cmml">𝒛</mi><mi id="S4.E6.m1.1.1.1.1.2.4.1.3.3" xref="S4.E6.m1.1.1.1.1.2.4.1.3.3.cmml">i</mi></msub></munder><mo lspace="0.167em" id="S4.E6.m1.1.1.1.1.2.4a" xref="S4.E6.m1.1.1.1.1.2.4.cmml">⁡</mo><msub id="S4.E6.m1.1.1.1.1.2.4.2" xref="S4.E6.m1.1.1.1.1.2.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.2.4.2.2" xref="S4.E6.m1.1.1.1.1.2.4.2.2.cmml">ℒ</mi><mtext id="S4.E6.m1.1.1.1.1.2.4.2.3" xref="S4.E6.m1.1.1.1.1.2.4.2.3a.cmml">feat</mtext></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.2.2.2" xref="S4.E6.m1.1.1.1.1.2.2.3.cmml"><mo id="S4.E6.m1.1.1.1.1.2.2.2.3" xref="S4.E6.m1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.1.1.1.2.2.2.4" xref="S4.E6.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E6.m1.1.1.1.1.2.2.2.2" xref="S4.E6.m1.1.1.1.1.2.2.2.2.cmml"><mover accent="true" id="S4.E6.m1.1.1.1.1.2.2.2.2.2" xref="S4.E6.m1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S4.E6.m1.1.1.1.1.2.2.2.2.2.2" xref="S4.E6.m1.1.1.1.1.2.2.2.2.2.2.cmml">𝒓</mi><mo id="S4.E6.m1.1.1.1.1.2.2.2.2.2.1" xref="S4.E6.m1.1.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S4.E6.m1.1.1.1.1.2.2.2.2.3" xref="S4.E6.m1.1.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E6.m1.1.1.1.1.2.2.2.5" xref="S4.E6.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.1.1.1.4" xref="S4.E6.m1.1.1.1.1.4.cmml">+</mo><mrow id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml">ℛ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml">​</mo><mrow id="S4.E6.m1.1.1.1.1.3.1.1" xref="S4.E6.m1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.3.1.1.2" xref="S4.E6.m1.1.1.1.1.3.1.1.1.cmml">(</mo><msub id="S4.E6.m1.1.1.1.1.3.1.1.1" xref="S4.E6.m1.1.1.1.1.3.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.3.1.1.1.2" xref="S4.E6.m1.1.1.1.1.3.1.1.1.2.cmml">𝒛</mi><mi id="S4.E6.m1.1.1.1.1.3.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E6.m1.1.1.1.1.3.1.1.3" xref="S4.E6.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><plus id="S4.E6.m1.1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.1.4"></plus><apply id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"><times id="S4.E6.m1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.2.3"></times><apply id="S4.E6.m1.1.1.1.1.2.4.cmml" xref="S4.E6.m1.1.1.1.1.2.4"><apply id="S4.E6.m1.1.1.1.1.2.4.1.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.2.4.1.1.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1">subscript</csymbol><apply id="S4.E6.m1.1.1.1.1.2.4.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.2"><times id="S4.E6.m1.1.1.1.1.2.4.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.2.1"></times><ci id="S4.E6.m1.1.1.1.1.2.4.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.2.2">arg</ci><ci id="S4.E6.m1.1.1.1.1.2.4.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.2.3">min</ci></apply><apply id="S4.E6.m1.1.1.1.1.2.4.1.3.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.2.4.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.2.4.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.3.2">𝒛</ci><ci id="S4.E6.m1.1.1.1.1.2.4.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.2.4.1.3.3">𝑖</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.2.4.2.cmml" xref="S4.E6.m1.1.1.1.1.2.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.2.4.2.1.cmml" xref="S4.E6.m1.1.1.1.1.2.4.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.2.4.2.2.cmml" xref="S4.E6.m1.1.1.1.1.2.4.2.2">ℒ</ci><ci id="S4.E6.m1.1.1.1.1.2.4.2.3a.cmml" xref="S4.E6.m1.1.1.1.1.2.4.2.3"><mtext mathsize="70%" id="S4.E6.m1.1.1.1.1.2.4.2.3.cmml" xref="S4.E6.m1.1.1.1.1.2.4.2.3">feat</mtext></ci></apply></apply><interval closure="open" id="S4.E6.m1.1.1.1.1.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2"><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E6.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2.2.2"><ci id="S4.E6.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2.2.2.1">^</ci><ci id="S4.E6.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2.2.2.2">𝒓</ci></apply><ci id="S4.E6.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><times id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2"></times><ci id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3">ℛ</ci><apply id="S4.E6.m1.1.1.1.1.3.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.3.1.1.1.2">𝒛</ci><ci id="S4.E6.m1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\operatorname*{arg\,min}_{\bm{z}_{i}}\mathcal{L}_{\text{feat}}\left(r_{\theta}(\bm{z}_{i}),\hat{\bm{r}}_{i}\right)+\mathcal{R}(\bm{z}_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.11" class="ltx_p">The idea here is to optimize the input <math id="S4.SS3.p1.2.m1.1" class="ltx_Math" alttext="\bm{z}_{i}" display="inline"><semantics id="S4.SS3.p1.2.m1.1a"><msub id="S4.SS3.p1.2.m1.1.1" xref="S4.SS3.p1.2.m1.1.1.cmml"><mi id="S4.SS3.p1.2.m1.1.1.2" xref="S4.SS3.p1.2.m1.1.1.2.cmml">𝒛</mi><mi id="S4.SS3.p1.2.m1.1.1.3" xref="S4.SS3.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m1.1b"><apply id="S4.SS3.p1.2.m1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m1.1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m1.1.1.2.cmml" xref="S4.SS3.p1.2.m1.1.1.2">𝒛</ci><ci id="S4.SS3.p1.2.m1.1.1.3.cmml" xref="S4.SS3.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m1.1c">\bm{z}_{i}</annotation></semantics></math> such that its feature <math id="S4.SS3.p1.3.m2.1" class="ltx_Math" alttext="r_{\theta}(\bm{z}_{i})" display="inline"><semantics id="S4.SS3.p1.3.m2.1a"><mrow id="S4.SS3.p1.3.m2.1.1" xref="S4.SS3.p1.3.m2.1.1.cmml"><msub id="S4.SS3.p1.3.m2.1.1.3" xref="S4.SS3.p1.3.m2.1.1.3.cmml"><mi id="S4.SS3.p1.3.m2.1.1.3.2" xref="S4.SS3.p1.3.m2.1.1.3.2.cmml">r</mi><mi id="S4.SS3.p1.3.m2.1.1.3.3" xref="S4.SS3.p1.3.m2.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m2.1.1.2" xref="S4.SS3.p1.3.m2.1.1.2.cmml">​</mo><mrow id="S4.SS3.p1.3.m2.1.1.1.1" xref="S4.SS3.p1.3.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m2.1.1.1.1.2" xref="S4.SS3.p1.3.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p1.3.m2.1.1.1.1.1" xref="S4.SS3.p1.3.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.3.m2.1.1.1.1.1.2" xref="S4.SS3.p1.3.m2.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S4.SS3.p1.3.m2.1.1.1.1.1.3" xref="S4.SS3.p1.3.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS3.p1.3.m2.1.1.1.1.3" xref="S4.SS3.p1.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m2.1b"><apply id="S4.SS3.p1.3.m2.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1"><times id="S4.SS3.p1.3.m2.1.1.2.cmml" xref="S4.SS3.p1.3.m2.1.1.2"></times><apply id="S4.SS3.p1.3.m2.1.1.3.cmml" xref="S4.SS3.p1.3.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m2.1.1.3.1.cmml" xref="S4.SS3.p1.3.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.3.m2.1.1.3.2.cmml" xref="S4.SS3.p1.3.m2.1.1.3.2">𝑟</ci><ci id="S4.SS3.p1.3.m2.1.1.3.3.cmml" xref="S4.SS3.p1.3.m2.1.1.3.3">𝜃</ci></apply><apply id="S4.SS3.p1.3.m2.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.3.m2.1.1.1.1.1.2">𝒛</ci><ci id="S4.SS3.p1.3.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.3.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m2.1c">r_{\theta}(\bm{z}_{i})</annotation></semantics></math> is close to the restored feature <math id="S4.SS3.p1.4.m3.1" class="ltx_Math" alttext="\hat{\bm{r}}_{i}" display="inline"><semantics id="S4.SS3.p1.4.m3.1a"><msub id="S4.SS3.p1.4.m3.1.1" xref="S4.SS3.p1.4.m3.1.1.cmml"><mover accent="true" id="S4.SS3.p1.4.m3.1.1.2" xref="S4.SS3.p1.4.m3.1.1.2.cmml"><mi id="S4.SS3.p1.4.m3.1.1.2.2" xref="S4.SS3.p1.4.m3.1.1.2.2.cmml">𝒓</mi><mo id="S4.SS3.p1.4.m3.1.1.2.1" xref="S4.SS3.p1.4.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p1.4.m3.1.1.3" xref="S4.SS3.p1.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m3.1b"><apply id="S4.SS3.p1.4.m3.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m3.1.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1">subscript</csymbol><apply id="S4.SS3.p1.4.m3.1.1.2.cmml" xref="S4.SS3.p1.4.m3.1.1.2"><ci id="S4.SS3.p1.4.m3.1.1.2.1.cmml" xref="S4.SS3.p1.4.m3.1.1.2.1">^</ci><ci id="S4.SS3.p1.4.m3.1.1.2.2.cmml" xref="S4.SS3.p1.4.m3.1.1.2.2">𝒓</ci></apply><ci id="S4.SS3.p1.4.m3.1.1.3.cmml" xref="S4.SS3.p1.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m3.1c">\hat{\bm{r}}_{i}</annotation></semantics></math> (which in turn is similar to the ground-truth feature <math id="S4.SS3.p1.5.m4.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="S4.SS3.p1.5.m4.1a"><msub id="S4.SS3.p1.5.m4.1.1" xref="S4.SS3.p1.5.m4.1.1.cmml"><mi id="S4.SS3.p1.5.m4.1.1.2" xref="S4.SS3.p1.5.m4.1.1.2.cmml">𝒓</mi><mi id="S4.SS3.p1.5.m4.1.1.3" xref="S4.SS3.p1.5.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m4.1b"><apply id="S4.SS3.p1.5.m4.1.1.cmml" xref="S4.SS3.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m4.1.1.1.cmml" xref="S4.SS3.p1.5.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m4.1.1.2.cmml" xref="S4.SS3.p1.5.m4.1.1.2">𝒓</ci><ci id="S4.SS3.p1.5.m4.1.1.3.cmml" xref="S4.SS3.p1.5.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m4.1c">\bm{r}_{i}</annotation></semantics></math>) according to a certain metric <math id="S4.SS3.p1.6.m5.2" class="ltx_Math" alttext="\mathcal{L}_{\text{feat}}(\cdot,\cdot)" display="inline"><semantics id="S4.SS3.p1.6.m5.2a"><mrow id="S4.SS3.p1.6.m5.2.3" xref="S4.SS3.p1.6.m5.2.3.cmml"><msub id="S4.SS3.p1.6.m5.2.3.2" xref="S4.SS3.p1.6.m5.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.6.m5.2.3.2.2" xref="S4.SS3.p1.6.m5.2.3.2.2.cmml">ℒ</mi><mtext id="S4.SS3.p1.6.m5.2.3.2.3" xref="S4.SS3.p1.6.m5.2.3.2.3a.cmml">feat</mtext></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m5.2.3.1" xref="S4.SS3.p1.6.m5.2.3.1.cmml">​</mo><mrow id="S4.SS3.p1.6.m5.2.3.3.2" xref="S4.SS3.p1.6.m5.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS3.p1.6.m5.2.3.3.2.1" xref="S4.SS3.p1.6.m5.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m5.1.1" xref="S4.SS3.p1.6.m5.1.1.cmml">⋅</mo><mo rspace="0em" id="S4.SS3.p1.6.m5.2.3.3.2.2" xref="S4.SS3.p1.6.m5.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.6.m5.2.2" xref="S4.SS3.p1.6.m5.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p1.6.m5.2.3.3.2.3" xref="S4.SS3.p1.6.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m5.2b"><apply id="S4.SS3.p1.6.m5.2.3.cmml" xref="S4.SS3.p1.6.m5.2.3"><times id="S4.SS3.p1.6.m5.2.3.1.cmml" xref="S4.SS3.p1.6.m5.2.3.1"></times><apply id="S4.SS3.p1.6.m5.2.3.2.cmml" xref="S4.SS3.p1.6.m5.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m5.2.3.2.1.cmml" xref="S4.SS3.p1.6.m5.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.6.m5.2.3.2.2.cmml" xref="S4.SS3.p1.6.m5.2.3.2.2">ℒ</ci><ci id="S4.SS3.p1.6.m5.2.3.2.3a.cmml" xref="S4.SS3.p1.6.m5.2.3.2.3"><mtext mathsize="70%" id="S4.SS3.p1.6.m5.2.3.2.3.cmml" xref="S4.SS3.p1.6.m5.2.3.2.3">feat</mtext></ci></apply><interval closure="open" id="S4.SS3.p1.6.m5.2.3.3.1.cmml" xref="S4.SS3.p1.6.m5.2.3.3.2"><ci id="S4.SS3.p1.6.m5.1.1.cmml" xref="S4.SS3.p1.6.m5.1.1">⋅</ci><ci id="S4.SS3.p1.6.m5.2.2.cmml" xref="S4.SS3.p1.6.m5.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m5.2c">\mathcal{L}_{\text{feat}}(\cdot,\cdot)</annotation></semantics></math>.
Here we opt to use the scale-invariant cosine distance as <math id="S4.SS3.p1.7.m6.1" class="ltx_Math" alttext="\mathcal{L}_{\text{feat}}" display="inline"><semantics id="S4.SS3.p1.7.m6.1a"><msub id="S4.SS3.p1.7.m6.1.1" xref="S4.SS3.p1.7.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.7.m6.1.1.2" xref="S4.SS3.p1.7.m6.1.1.2.cmml">ℒ</mi><mtext id="S4.SS3.p1.7.m6.1.1.3" xref="S4.SS3.p1.7.m6.1.1.3a.cmml">feat</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m6.1b"><apply id="S4.SS3.p1.7.m6.1.1.cmml" xref="S4.SS3.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m6.1.1.1.cmml" xref="S4.SS3.p1.7.m6.1.1">subscript</csymbol><ci id="S4.SS3.p1.7.m6.1.1.2.cmml" xref="S4.SS3.p1.7.m6.1.1.2">ℒ</ci><ci id="S4.SS3.p1.7.m6.1.1.3a.cmml" xref="S4.SS3.p1.7.m6.1.1.3"><mtext mathsize="70%" id="S4.SS3.p1.7.m6.1.1.3.cmml" xref="S4.SS3.p1.7.m6.1.1.3">feat</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m6.1c">\mathcal{L}_{\text{feat}}</annotation></semantics></math> since <math id="S4.SS3.p1.8.m7.1" class="ltx_Math" alttext="\hat{\bm{r}}_{i}" display="inline"><semantics id="S4.SS3.p1.8.m7.1a"><msub id="S4.SS3.p1.8.m7.1.1" xref="S4.SS3.p1.8.m7.1.1.cmml"><mover accent="true" id="S4.SS3.p1.8.m7.1.1.2" xref="S4.SS3.p1.8.m7.1.1.2.cmml"><mi id="S4.SS3.p1.8.m7.1.1.2.2" xref="S4.SS3.p1.8.m7.1.1.2.2.cmml">𝒓</mi><mo id="S4.SS3.p1.8.m7.1.1.2.1" xref="S4.SS3.p1.8.m7.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p1.8.m7.1.1.3" xref="S4.SS3.p1.8.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m7.1b"><apply id="S4.SS3.p1.8.m7.1.1.cmml" xref="S4.SS3.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.8.m7.1.1.1.cmml" xref="S4.SS3.p1.8.m7.1.1">subscript</csymbol><apply id="S4.SS3.p1.8.m7.1.1.2.cmml" xref="S4.SS3.p1.8.m7.1.1.2"><ci id="S4.SS3.p1.8.m7.1.1.2.1.cmml" xref="S4.SS3.p1.8.m7.1.1.2.1">^</ci><ci id="S4.SS3.p1.8.m7.1.1.2.2.cmml" xref="S4.SS3.p1.8.m7.1.1.2.2">𝒓</ci></apply><ci id="S4.SS3.p1.8.m7.1.1.3.cmml" xref="S4.SS3.p1.8.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m7.1c">\hat{\bm{r}}_{i}</annotation></semantics></math> approximates <math id="S4.SS3.p1.9.m8.1" class="ltx_Math" alttext="\bm{r}_{i}" display="inline"><semantics id="S4.SS3.p1.9.m8.1a"><msub id="S4.SS3.p1.9.m8.1.1" xref="S4.SS3.p1.9.m8.1.1.cmml"><mi id="S4.SS3.p1.9.m8.1.1.2" xref="S4.SS3.p1.9.m8.1.1.2.cmml">𝒓</mi><mi id="S4.SS3.p1.9.m8.1.1.3" xref="S4.SS3.p1.9.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m8.1b"><apply id="S4.SS3.p1.9.m8.1.1.cmml" xref="S4.SS3.p1.9.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.9.m8.1.1.1.cmml" xref="S4.SS3.p1.9.m8.1.1">subscript</csymbol><ci id="S4.SS3.p1.9.m8.1.1.2.cmml" xref="S4.SS3.p1.9.m8.1.1.2">𝒓</ci><ci id="S4.SS3.p1.9.m8.1.1.3.cmml" xref="S4.SS3.p1.9.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m8.1c">\bm{r}_{i}</annotation></semantics></math> by a factor of <math id="S4.SS3.p1.10.m9.3" class="ltx_Math" alttext="-(1-\bm{p}_{i,y_{i}})" display="inline"><semantics id="S4.SS3.p1.10.m9.3a"><mrow id="S4.SS3.p1.10.m9.3.3" xref="S4.SS3.p1.10.m9.3.3.cmml"><mo id="S4.SS3.p1.10.m9.3.3a" xref="S4.SS3.p1.10.m9.3.3.cmml">−</mo><mrow id="S4.SS3.p1.10.m9.3.3.1.1" xref="S4.SS3.p1.10.m9.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p1.10.m9.3.3.1.1.2" xref="S4.SS3.p1.10.m9.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.10.m9.3.3.1.1.1" xref="S4.SS3.p1.10.m9.3.3.1.1.1.cmml"><mn id="S4.SS3.p1.10.m9.3.3.1.1.1.2" xref="S4.SS3.p1.10.m9.3.3.1.1.1.2.cmml">1</mn><mo id="S4.SS3.p1.10.m9.3.3.1.1.1.1" xref="S4.SS3.p1.10.m9.3.3.1.1.1.1.cmml">−</mo><msub id="S4.SS3.p1.10.m9.3.3.1.1.1.3" xref="S4.SS3.p1.10.m9.3.3.1.1.1.3.cmml"><mi id="S4.SS3.p1.10.m9.3.3.1.1.1.3.2" xref="S4.SS3.p1.10.m9.3.3.1.1.1.3.2.cmml">𝒑</mi><mrow id="S4.SS3.p1.10.m9.2.2.2.2" xref="S4.SS3.p1.10.m9.2.2.2.3.cmml"><mi id="S4.SS3.p1.10.m9.1.1.1.1" xref="S4.SS3.p1.10.m9.1.1.1.1.cmml">i</mi><mo id="S4.SS3.p1.10.m9.2.2.2.2.2" xref="S4.SS3.p1.10.m9.2.2.2.3.cmml">,</mo><msub id="S4.SS3.p1.10.m9.2.2.2.2.1" xref="S4.SS3.p1.10.m9.2.2.2.2.1.cmml"><mi id="S4.SS3.p1.10.m9.2.2.2.2.1.2" xref="S4.SS3.p1.10.m9.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS3.p1.10.m9.2.2.2.2.1.3" xref="S4.SS3.p1.10.m9.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow><mo stretchy="false" id="S4.SS3.p1.10.m9.3.3.1.1.3" xref="S4.SS3.p1.10.m9.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m9.3b"><apply id="S4.SS3.p1.10.m9.3.3.cmml" xref="S4.SS3.p1.10.m9.3.3"><minus id="S4.SS3.p1.10.m9.3.3.2.cmml" xref="S4.SS3.p1.10.m9.3.3"></minus><apply id="S4.SS3.p1.10.m9.3.3.1.1.1.cmml" xref="S4.SS3.p1.10.m9.3.3.1.1"><minus id="S4.SS3.p1.10.m9.3.3.1.1.1.1.cmml" xref="S4.SS3.p1.10.m9.3.3.1.1.1.1"></minus><cn type="integer" id="S4.SS3.p1.10.m9.3.3.1.1.1.2.cmml" xref="S4.SS3.p1.10.m9.3.3.1.1.1.2">1</cn><apply id="S4.SS3.p1.10.m9.3.3.1.1.1.3.cmml" xref="S4.SS3.p1.10.m9.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m9.3.3.1.1.1.3.1.cmml" xref="S4.SS3.p1.10.m9.3.3.1.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.10.m9.3.3.1.1.1.3.2.cmml" xref="S4.SS3.p1.10.m9.3.3.1.1.1.3.2">𝒑</ci><list id="S4.SS3.p1.10.m9.2.2.2.3.cmml" xref="S4.SS3.p1.10.m9.2.2.2.2"><ci id="S4.SS3.p1.10.m9.1.1.1.1.cmml" xref="S4.SS3.p1.10.m9.1.1.1.1">𝑖</ci><apply id="S4.SS3.p1.10.m9.2.2.2.2.1.cmml" xref="S4.SS3.p1.10.m9.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.10.m9.2.2.2.2.1.1.cmml" xref="S4.SS3.p1.10.m9.2.2.2.2.1">subscript</csymbol><ci id="S4.SS3.p1.10.m9.2.2.2.2.1.2.cmml" xref="S4.SS3.p1.10.m9.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS3.p1.10.m9.2.2.2.2.1.3.cmml" xref="S4.SS3.p1.10.m9.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m9.3c">-(1-\bm{p}_{i,y_{i}})</annotation></semantics></math> (<a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>).
Again, image prior <math id="S4.SS3.p1.11.m10.1" class="ltx_Math" alttext="\mathcal{R(\cdot)}" display="inline"><semantics id="S4.SS3.p1.11.m10.1a"><mrow id="S4.SS3.p1.11.m10.1.2" xref="S4.SS3.p1.11.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.11.m10.1.2.2" xref="S4.SS3.p1.11.m10.1.2.2.cmml">ℛ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p1.11.m10.1.2.1" xref="S4.SS3.p1.11.m10.1.2.1.cmml">​</mo><mrow id="S4.SS3.p1.11.m10.1.2.3.2" xref="S4.SS3.p1.11.m10.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.11.m10.1.2.3.2.1" xref="S4.SS3.p1.11.m10.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.11.m10.1.1" xref="S4.SS3.p1.11.m10.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p1.11.m10.1.2.3.2.2" xref="S4.SS3.p1.11.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m10.1b"><apply id="S4.SS3.p1.11.m10.1.2.cmml" xref="S4.SS3.p1.11.m10.1.2"><times id="S4.SS3.p1.11.m10.1.2.1.cmml" xref="S4.SS3.p1.11.m10.1.2.1"></times><ci id="S4.SS3.p1.11.m10.1.2.2.cmml" xref="S4.SS3.p1.11.m10.1.2.2">ℛ</ci><ci id="S4.SS3.p1.11.m10.1.1.cmml" xref="S4.SS3.p1.11.m10.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m10.1c">\mathcal{R(\cdot)}</annotation></semantics></math> is incorporated to improve the fidelity of the generated images.
In this work, we apply the Total Variation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> as the regularization, while using more sophisticated/complex image priors is likely to further enhance the reconstruction quality.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">Inverting features to reconstruct input images is more feasible on AT models than on vanilla models.
This observation is first made in the work of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, where it is found that inverting the features of AT models can yield meaningful images that share a great amount of semantic similarity with the real inputs, while doing so on vanilla non-robust models only lead to meaningless noisy patterns.
Back then, the researchers focused on the interpretability aspect of such phenomenon without discussing its security implications.
In this work, we show how AT models’ good “invertibility” can actually be exploited to conduct privacy attack.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Setup</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.2" class="ltx_p"><span id="S5.SS1.p1.2.1" class="ltx_text ltx_font_bold">Dataset.</span>
We target the reconstruction of <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="224\times 224" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">224</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">224</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><times id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></times><cn type="integer" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">224</cn><cn type="integer" id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">224</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">224\times 224</annotation></semantics></math> high-resolution images from ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, which is more challenging than restoring low-resolution images (<em id="S5.SS1.p1.2.2" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS1.p1.2.3" class="ltx_text"></span>, <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><times id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></times><cn type="integer" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">32</cn><cn type="integer" id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">32\times 32</annotation></semantics></math> CIFAR images) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Models.</span>
We consider various DNN architectures to comprehensively demonstrate the effectiveness of our attack and to evaluate how the architecture affects the attack performance.
Specifically, we consider VGG-16 (VGG16) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, ResNet-18/50 (RN18/50) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, WideResNet-50x4 (WRN50x4) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, and DenseNet-161 (DN161) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.2" class="ltx_p"><span id="S5.SS1.p3.2.1" class="ltx_text ltx_font_bold">Training.</span>
We evaluate both vanilla training (<em id="S5.SS1.p3.2.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS1.p3.2.3" class="ltx_text"></span>, minimizing the loss on clean inputs) and AT (<em id="S5.SS1.p3.2.4" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS1.p3.2.5" class="ltx_text"></span>, minimizing the loss on adversarial examples) to demonstrate how AT makes it more easier for the privacy attack to succeed.
Specifically, in this work we consider Madry’s AT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> with <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><msub id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">ℓ</mi><mn id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2">ℓ</ci><cn type="integer" id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\ell_{2}</annotation></semantics></math> norm bound, although our attack can work with other types of AT (<em id="S5.SS1.p3.2.6" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS1.p3.2.7" class="ltx_text"></span>, TRADES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, or with <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="\ell_{\infty}" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><msub id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml"><mi mathvariant="normal" id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml">ℓ</mi><mi mathvariant="normal" id="S5.SS1.p3.2.m2.1.1.3" xref="S5.SS1.p3.2.m2.1.1.3.cmml">∞</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p3.2.m2.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p3.2.m2.1.1.2.cmml" xref="S5.SS1.p3.2.m2.1.1.2">ℓ</ci><infinity id="S5.SS1.p3.2.m2.1.1.3.cmml" xref="S5.SS1.p3.2.m2.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">\ell_{\infty}</annotation></semantics></math> norm bound) as both attack steps only rely on AT’s general properties.
We also vary the perturbation strength of the AT to see its effect on the attack.
We leverage the pre-trained models provided by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to conduct all the experiments.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.1" class="ltx_p"><span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_bold">Attack process.</span>
We simulate an attack process by first creating a set of <span id="S5.SS1.p4.1.2" class="ltx_text ltx_font_italic">anchor</span> images.
Specifically, we randomly sample 5 images from each of the 1,000 categories from the validation set of ImageNet, resulting in a total of 5,000 anchors.
Then, for each anchor, we construct 5 random batches which include that anchor.
Finally, we play as an attacker who tries to reconstruct each anchor given the 5 groups of batch-averaged gradients corresponding to the 5 random batches.
Note, here we focus on the <span id="S5.SS1.p4.1.3" class="ltx_text ltx_font_italic">best-case</span> performance out of the 5 batches, which equivalently exposes the <span id="S5.SS1.p4.1.4" class="ltx_text ltx_font_italic">worst-case</span> scenario for the victim/defender.
We explicitly focus on the reconstruction of the anchor images because it allows easier analysis.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para ltx_noindent">
<p id="S5.SS1.p5.1" class="ltx_p"><span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_bold">Evaluation metric.</span>
We measure the cosine similarity between the restored features and the ground-truth features to evaluate the performance of our first attack step, <em id="S5.SS1.p5.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS1.p5.1.3" class="ltx_text"></span>, the quality of feature restoration.
When evaluating the second step, namely image reconstruction from features, we will both use LPIPS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> as the quantitative metric and qualitatively demonstrate the performance by visualizing the reconstructed images.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2202.10546/assets/figures/feat_recov_1.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="592" height="893" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">Feature restoration quality (in terms of cosine similarity) of the 5,000 anchor images on various AT and vanilla models and under various batch size. The samples are sorted by the recover quality in each plot. The closer the curve is to the upper left corner, the better feature restoration is achieved.</span></figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2202.10546/assets/figures/feat_recov_2.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.8.3.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S5.F4.4.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Left:<span id="S5.F4.3.1.1" class="ltx_text ltx_font_medium"> Feature restoration quality v.s. the perturbation strength <math id="S5.F4.3.1.1.m1.1" class="ltx_Math" alttext="\varepsilon" display="inline"><semantics id="S5.F4.3.1.1.m1.1b"><mi id="S5.F4.3.1.1.m1.1.1" xref="S5.F4.3.1.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="S5.F4.3.1.1.m1.1c"><ci id="S5.F4.3.1.1.m1.1.1.cmml" xref="S5.F4.3.1.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.1.1.m1.1d">\varepsilon</annotation></semantics></math> of AT. RN18 is used here. </span>Right:<span id="S5.F4.4.2.2" class="ltx_text ltx_font_medium"> Feature restoration quality v.s. the model architecture. <math id="S5.F4.4.2.2.m1.1" class="ltx_Math" alttext="\varepsilon=3.0" display="inline"><semantics id="S5.F4.4.2.2.m1.1b"><mrow id="S5.F4.4.2.2.m1.1.1" xref="S5.F4.4.2.2.m1.1.1.cmml"><mi id="S5.F4.4.2.2.m1.1.1.2" xref="S5.F4.4.2.2.m1.1.1.2.cmml">ε</mi><mo id="S5.F4.4.2.2.m1.1.1.1" xref="S5.F4.4.2.2.m1.1.1.1.cmml">=</mo><mn id="S5.F4.4.2.2.m1.1.1.3" xref="S5.F4.4.2.2.m1.1.1.3.cmml">3.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.4.2.2.m1.1c"><apply id="S5.F4.4.2.2.m1.1.1.cmml" xref="S5.F4.4.2.2.m1.1.1"><eq id="S5.F4.4.2.2.m1.1.1.1.cmml" xref="S5.F4.4.2.2.m1.1.1.1"></eq><ci id="S5.F4.4.2.2.m1.1.1.2.cmml" xref="S5.F4.4.2.2.m1.1.1.2">𝜀</ci><cn type="float" id="S5.F4.4.2.2.m1.1.1.3.cmml" xref="S5.F4.4.2.2.m1.1.1.3">3.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.2.2.m1.1d">\varepsilon=3.0</annotation></semantics></math> is used here.</span></span></figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Feature restoration from gradients</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We first evaluate our first attack step, namely feature restoration, for which the results are shown in <a href="#S5.F3" title="In 5.1 Setup ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>.
There are several key observations made from the results.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">AT models enable better restoration of the features.</span>
Comparing the first and second column of <a href="#S5.F3" title="In 5.1 Setup ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3</span></a>, it is obvious that the feature restoration is much more successful on AT models than on vanilla models.
For example, with RN18 architecture and a batch size of 256, there are around 3,500 out of 5,000 samples whose features can be restored nearly perfectly (<em id="S5.SS2.p2.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.SS2.p2.1.3" class="ltx_text"></span>, with <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="\sim 1.0" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml"></mi><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">∼</mo><mn id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">absent</csymbol><cn type="float" id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\sim 1.0</annotation></semantics></math> cosine similarity) on the AT model, while less than 1,000 samples’ features are restored that well on the vanilla model.
This observation aligns with our analysis in <a href="#S4.SS2" title="4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">In the left plot of <a href="#S5.F4" title="In 5.1 Setup ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we also observe that the feature restoration quality (averaged over 5,000 samples) becomes better as the AT’s perturbation strength <math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="\varepsilon" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">ε</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝜀</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\varepsilon</annotation></semantics></math> increases, which further demonstrates that AT makes the model more vulnerable to the feature restoration attack step.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Feature restoration works even under large batch size.</span>
As discussed earlier, the motivation of the feature restoration step is to decouple the fused information of each individual input from the batch-averaged gradients.
Indeed, we find this strategy effective even under a large batch size.
Specifically, under the batch size of 256, the attack applied to an AT model can perfectly restore the features of at least 1,000 samples (with WRN50x4) and up to 4,000 samples (with VGG16), out of the total 5,000 samples.
Not surprisingly, the restoration quality is even better when the batch size is smaller.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para ltx_noindent">
<p id="S5.SS2.p5.1" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Models with smaller capacity are more vulnerable.</span>
In the right plot of <a href="#S5.F4" title="In 5.1 Setup ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, we visualize the feature restoration quality (averaged over 5,000 anchor samples) w.r.t. the test accuracy of various model architectures on the clean images of ImageNet.
The general trend is that the models with lower clean accuracy is more vulnerable to the feature restoration attack step.
We suspect that this is because the models with a smaller learning capacity (in terms of the clean accuracy) do not resist adversarial examples very well, and the probability <math id="S5.SS2.p5.1.m1.2" class="ltx_Math" alttext="\bm{p}_{i,y_{i}}" display="inline"><semantics id="S5.SS2.p5.1.m1.2a"><msub id="S5.SS2.p5.1.m1.2.3" xref="S5.SS2.p5.1.m1.2.3.cmml"><mi id="S5.SS2.p5.1.m1.2.3.2" xref="S5.SS2.p5.1.m1.2.3.2.cmml">𝒑</mi><mrow id="S5.SS2.p5.1.m1.2.2.2.2" xref="S5.SS2.p5.1.m1.2.2.2.3.cmml"><mi id="S5.SS2.p5.1.m1.1.1.1.1" xref="S5.SS2.p5.1.m1.1.1.1.1.cmml">i</mi><mo id="S5.SS2.p5.1.m1.2.2.2.2.2" xref="S5.SS2.p5.1.m1.2.2.2.3.cmml">,</mo><msub id="S5.SS2.p5.1.m1.2.2.2.2.1" xref="S5.SS2.p5.1.m1.2.2.2.2.1.cmml"><mi id="S5.SS2.p5.1.m1.2.2.2.2.1.2" xref="S5.SS2.p5.1.m1.2.2.2.2.1.2.cmml">y</mi><mi id="S5.SS2.p5.1.m1.2.2.2.2.1.3" xref="S5.SS2.p5.1.m1.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.m1.2b"><apply id="S5.SS2.p5.1.m1.2.3.cmml" xref="S5.SS2.p5.1.m1.2.3"><csymbol cd="ambiguous" id="S5.SS2.p5.1.m1.2.3.1.cmml" xref="S5.SS2.p5.1.m1.2.3">subscript</csymbol><ci id="S5.SS2.p5.1.m1.2.3.2.cmml" xref="S5.SS2.p5.1.m1.2.3.2">𝒑</ci><list id="S5.SS2.p5.1.m1.2.2.2.3.cmml" xref="S5.SS2.p5.1.m1.2.2.2.2"><ci id="S5.SS2.p5.1.m1.1.1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1.1.1">𝑖</ci><apply id="S5.SS2.p5.1.m1.2.2.2.2.1.cmml" xref="S5.SS2.p5.1.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S5.SS2.p5.1.m1.2.2.2.2.1.1.cmml" xref="S5.SS2.p5.1.m1.2.2.2.2.1">subscript</csymbol><ci id="S5.SS2.p5.1.m1.2.2.2.2.1.2.cmml" xref="S5.SS2.p5.1.m1.2.2.2.2.1.2">𝑦</ci><ci id="S5.SS2.p5.1.m1.2.2.2.2.1.3.cmml" xref="S5.SS2.p5.1.m1.2.2.2.2.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.1.m1.2c">\bm{p}_{i,y_{i}}</annotation></semantics></math> assigned to the ground-truth class of the adversarial input would be lower.
As a result, small-capacity models could lead to better feature restoration (see <a href="#S4.E4" title="In 4.2 Feature restoration from gradients ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Image reconstruction from features</h3>

<figure id="S5.F5" class="ltx_figure"><img src="/html/2202.10546/assets/figures/demo.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="592" height="650" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F5.4.2.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S5.F5.2.1" class="ltx_text" style="font-size:90%;">Visualization of reconstructed images on AT models (first row in each pair) and ground-truth ones (second row). The numbers are the LPIPS score (<math id="S5.F5.2.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.F5.2.1.m1.1b"><mo stretchy="false" id="S5.F5.2.1.m1.1.1" xref="S5.F5.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.F5.2.1.m1.1c"><ci id="S5.F5.2.1.m1.1.1.cmml" xref="S5.F5.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.2.1.m1.1d">\downarrow</annotation></semantics></math>).</span></figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure"><img src="/html/2202.10546/assets/figures/demo_vanilla.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_square" width="592" height="637" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S5.F6.3.2" class="ltx_text" style="font-size:90%;">Visualization of reconstructed images on vanilla models (first row in each pair) and ground-truth ones (second row).</span></figcaption>
</figure>
<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.2" class="ltx_p">We next invert the restored features to recontruct input images according to <a href="#S4.E6" title="In 4.3 Image reconstruction from features ‣ 4 Methodology ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">6</span></a>.
Specifically, we use Adam optimizer with a learning rate of 0.1 and perform 5,000 steps of optimization.
The weight for the Total Variation loss <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\mathcal{R}</annotation></semantics></math> is <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="1e^{-6}" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mn id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">​</mo><msup id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml"><mi id="S5.SS3.p1.2.m2.1.1.3.2" xref="S5.SS3.p1.2.m2.1.1.3.2.cmml">e</mi><mrow id="S5.SS3.p1.2.m2.1.1.3.3" xref="S5.SS3.p1.2.m2.1.1.3.3.cmml"><mo id="S5.SS3.p1.2.m2.1.1.3.3a" xref="S5.SS3.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S5.SS3.p1.2.m2.1.1.3.3.2" xref="S5.SS3.p1.2.m2.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><times id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></times><cn type="integer" id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">1</cn><apply id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS3.p1.2.m2.1.1.3.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S5.SS3.p1.2.m2.1.1.3.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.2">𝑒</ci><apply id="S5.SS3.p1.2.m2.1.1.3.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3"><minus id="S5.SS3.p1.2.m2.1.1.3.3.1.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3"></minus><cn type="integer" id="S5.SS3.p1.2.m2.1.1.3.3.2.cmml" xref="S5.SS3.p1.2.m2.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">1e^{-6}</annotation></semantics></math>.
Image generation is often sensitive to the initialization, and we find that using multiple random starts (and picking the best result according to the loss) can improve the image quality.
Here we use 5 random starts.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">We present the results obtained on AT models and vanilla models in <a href="#S5.F5" title="In 5.3 Image reconstruction from features ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> and <a href="#S5.F6" title="In 5.3 Image reconstruction from features ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">6</span></a>, respectively.
The takeaway here is twofold.
First, AT models obviously enable much better reconstruction than vanilla models.
Many of the generated images from AT models clearly unveil the object identity, often with accurate restoration of the visual details (<em id="S5.SS3.p2.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S5.SS3.p2.1.2" class="ltx_text"></span>, the branches in the bird image obtained on WRN50x4).
In comparison, vanilla models only yield absurd, hard-to-interpret patterns which hardly reveal useful information about the original images.
Second, we find that the models with larger learning capacity are more suitable for the feature inversion.
Recall that RN50, WRN50x4, and DN161 achieve higher clean accuracy than RN18 and VGG16 according to <a href="#S5.F4" title="In 5.1 Setup ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.
In <a href="#S5.F5" title="In 5.3 Image reconstruction from features ‣ 5 Experiments ‣ Privacy Leakage of Adversarial Training Models in Federated Learning Systems" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>, the latter two models more often have distortions or unnatural patterns in their reconstructed images than the first three models.
We suspect that this is because the large-capacity models can learn more semantic-meaningful features <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> during AT, which is essential for recovering the semantics of the original input images.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.2" class="ltx_p">Finally, we remark that with AT models, our attack can better compromise the clients’ privacy than prior arts.
Specifically, our method achieves an averaged LPIPS score of <math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="0.4424" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><mn id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">0.4424</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><cn type="float" id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">0.4424</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">0.4424</annotation></semantics></math> on RN50 under a batch size of 256, while the current state-of-the-art method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> obtained <math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="0.4840" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mn id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">0.4840</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><cn type="float" id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">0.4840</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">0.4840</annotation></semantics></math> under a batch size of 8 with the same model architecture.
In addition, to our knowledge we are the first to report success of reconstruction under the batch size of 256 among the privacy attacks towards FL systems.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We develop a novel privacy attack against Adversarial Training models to break the privacy of Federated Learning systems.
Evaluation demonstrates that our attack can accurately reconstruct the clients’ training images even when the batch size is large (up to 256).
Thus, the clients that perform AT in the pursuit of <span id="S6.p1.1.1" class="ltx_text ltx_font_italic">robustness</span> are in the same time putting their <span id="S6.p1.1.2" class="ltx_text ltx_font_italic">privacy</span> at risk.
By further exposing such robustness-privacy trade-off of AT models with a practical attack, we hope to motivate future studies to address this issue and develop some kind of privacy-aware AT.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Francesco Croce, Maksym Andriushchenko, Vikash Sehwag, Edoardo Debenedetti,
Nicolas Flammarion, Mung Chiang, Prateek Mittal, and Matthias Hein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Robustbench: a standardized adversarial robustness benchmark.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2010.09670</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib2.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2009 IEEE conference on computer vision and pattern
recognition</span><span id="bib.bib2.5.3" class="ltx_text" style="font-size:90%;">, pages 248–255. Ieee, 2009.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Logan Engstrom, Andrew Ilyas, Shibani Santurkar, Dimitris Tsipras, Brandon
Tran, and Aleksander Madry.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Adversarial robustness as a prior for learned representations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1906.00945</span><span id="bib.bib3.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Matt Fredrikson, Somesh Jha, and Thomas Ristenpart.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Model inversion attacks that exploit confidence information and basic
countermeasures.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 22nd ACM SIGSAC conference on computer and
communications security</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, pages 1322–1333, 2015.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Jonas Geiping, Hartmut Bauermeister, Hannah Dröge, and Michael Moeller.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Inverting gradients - how easy is it to break privacy in federated
learning?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text" style="font-size:90%;">In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin,
editors, </span><span id="bib.bib5.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib5.5.3" class="ltx_text" style="font-size:90%;">, volume 33,
pages 16937–16947. Curran Associates, Inc., 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Deep residual learning for image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages 770–778, 2016.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Gao Huang, Zhuang Liu, Laurens Van Der Maaten, and Kilian Q Weinberger.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Densely connected convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, pages 4700–4708, 2017.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Nitish Shirish Keskar, Dheevatsa Mudigere, Jorge Nocedal, Mikhail Smelyanskiy,
and Ping Tak Peter Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">On large-batch training for deep learning: Generalization gap and
sharp minima.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">5th International Conference on Learning Representations,
ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track
Proceedings</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">. OpenReview.net, 2017.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Aleksander Madry, Aleksandar Makelov, Ludwig Schmidt, Dimitris Tsipras, and
Adrian Vladu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Towards deep learning models resistant to adversarial attacks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">6th International Conference on Learning Representations,
ICLR 2018, Vancouver, BC, Canada, April 30 - May 3, 2018, Conference Track
Proceedings</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">. OpenReview.net, 2018.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Aravindh Mahendran and Andrea Vedaldi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Understanding deep image representations by inverting them.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">, pages 5188–5196, 2015.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y
Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Artificial intelligence and statistics</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, pages 1273–1282.
PMLR, 2017.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Felipe A Mejia, Paul Gamble, Zigfried Hampel-Arias, Michael Lomnitz, Nina
Lopatina, Lucas Tindall, and Maria Alejandra Barrios.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Robust or private? adversarial training makes models more vulnerable
to privacy attacks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1906.06449</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Hadi Salman, Andrew Ilyas, Logan Engstrom, Ashish Kapoor, and Aleksander Madry.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Do adversarially robust imagenet models transfer better?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">,
33:3533–3545, 2020.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Reza Shokri, Marco Stronati, Congzheng Song, and Vitaly Shmatikov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Membership inference attacks against machine learning models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2017 IEEE symposium on security and privacy (SP)</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, pages
3–18. IEEE, 2017.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Karen Simonyan and Andrew Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1409.1556</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Liwei Song, Reza Shokri, and Prateek Mittal.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Privacy risks of securing machine learning models against adversarial
examples.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2019 ACM SIGSAC Conference on Computer and
Communications Security</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, pages 241–257, 2019.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Christian Szegedy, Wojciech Zaremba, Ilya Sutskever, Joan Bruna, Dumitru Erhan,
Ian J. Goodfellow, and Rob Fergus.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Intriguing properties of neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In Yoshua Bengio and Yann LeCun, editors, </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2nd International
Conference on Learning Representations, ICLR 2014, Banff, AB, Canada, April
14-16, 2014, Conference Track Proceedings</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Florian Tramer, Nicholas Carlini, Wieland Brendel, and Aleksander Madry.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">On adaptive attacks to adversarial example defenses.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">,
33:1633–1645, 2020.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Hongxu Yin, Arun Mallya, Arash Vahdat, Jose M Alvarez, Jan Kautz, and Pavlo
Molchanov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">See through gradients: Image batch recovery via gradinversion.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib19.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib19.5.3" class="ltx_text" style="font-size:90%;">, pages 16337–16346, 2021.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Sergey Zagoruyko and Nikos Komodakis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Wide residual networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In Edwin R. Hancock Richard C. Wilson and William A. P. Smith,
editors, </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the British Machine Vision Conference (BMVC)</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">,
pages 87.1–87.12. BMVA Press, September 2016.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Hongyang Zhang, Yaodong Yu, Jiantao Jiao, Eric Xing, Laurent El Ghaoui, and
Michael Jordan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Theoretically principled trade-off between robustness and accuracy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International conference on machine learning</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, pages
7472–7482. PMLR, 2019.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Richard Zhang, Phillip Isola, Alexei A Efros, Eli Shechtman, and Oliver Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">The unreasonable effectiveness of deep features as a perceptual
metric.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE conference on computer vision and
pattern recognition</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, pages 586–595, 2018.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Bo Zhao, Konda Reddy Mopuri, and Hakan Bilen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">idlg: Improved deep leakage from gradients.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2001.02610</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Ligeng Zhu and Song Han.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Deep leakage from gradients.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Federated learning</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 17–31. Springer, 2020.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2202.10545" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2202.10546" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2202.10546">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2202.10546" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2202.10547" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 19:01:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
