<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2104.14628] Cluster-driven Graph Federated Learning over Multiple Domains</title><meta property="og:description" content="Federated Learning (FL) deals with learning a central model (\iethe server) in privacy-constrained scenarios, where data are stored on multiple devices (\iethe clients). The central model has no direct access to the da…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cluster-driven Graph Federated Learning over Multiple Domains">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Cluster-driven Graph Federated Learning over Multiple Domains">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2104.14628">

<!--Generated on Sat Mar  9 03:30:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Cluster-driven Graph Federated Learning over Multiple Domains</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Debora Caldarola<sup id="id1.1.id1" class="ltx_sup">*,1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">  
Massimiliano Mancini<sup id="id2.1.id1" class="ltx_sup">2</sup>
</span><span class="ltx_author_notes"><sup id="id3.2.id1" class="ltx_sup">*</sup>Corresponding author: <span id="id4.3.id2" class="ltx_text ltx_font_typewriter">debora.caldarola@polito.it</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">  Fabio Galasso<sup id="id5.1.id1" class="ltx_sup">3</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">  
<br class="ltx_break">Marco Ciccone<sup id="id6.1.id1" class="ltx_sup">4</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">  Emanuele Rodolà<sup id="id7.1.id1" class="ltx_sup">3</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">  Barbara Caputo<sup id="id8.1.id1" class="ltx_sup">1,5</sup> 
<br class="ltx_break"><sup id="id9.2.id2" class="ltx_sup"><span id="id9.2.id2.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span></sup><span id="id10.3.id3" class="ltx_text ltx_font_typewriter" style="font-size:90%;"> Politecnico di Torino</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> <sup id="id11.1.id1" class="ltx_sup">2</sup> University of Tübingen
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> <sup id="id12.1.id1" class="ltx_sup">3</sup> Sapienza University of Rome
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> 
<br class="ltx_break"><sup id="id13.1.id1" class="ltx_sup"><span id="id13.1.id1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">4</span></sup><span id="id14.2.id2" class="ltx_text ltx_font_typewriter" style="font-size:90%;"> Politecnico di Milano</span>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> <sup id="id15.1.id1" class="ltx_sup">5</sup> Italian Institute of Technology
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id16.id1" class="ltx_p">Federated Learning (FL) deals with learning a central model (<span id="id16.id1.1" class="ltx_ERROR undefined">\ie</span>the server) in privacy-constrained scenarios, where data are stored on multiple devices (<span id="id16.id1.2" class="ltx_ERROR undefined">\ie</span>the clients). The central model has no direct access to the data, but only to the updates of the parameters computed locally by each client. This raises a problem, known as <span id="id16.id1.3" class="ltx_text ltx_font_italic">statistical heterogeneity</span>, because the clients may have different data distributions (<span id="id16.id1.4" class="ltx_ERROR undefined">\ie</span>domains). This is only partly alleviated by clustering the clients. Clustering may reduce heterogeneity by identifying the domains, but it deprives each cluster model of the data and supervision of others.</p>
<p id="id17.id2" class="ltx_p">Here we propose a novel Cluster-driven Graph Federated Learning (FedCG). In FedCG, clustering serves to address statistical heterogeneity, while Graph Convolutional Networks (GCNs) enable sharing knowledge across them.
FedCG: <span id="id17.id2.1" class="ltx_text ltx_font_bold">i.</span> identifies the domains via an FL-compliant clustering and instantiates domain-specific modules (residual branches) for each domain;
<span id="id17.id2.2" class="ltx_text ltx_font_bold">ii.</span> connects the domain-specific modules through a GCN at training to learn the interactions among domains and share knowledge;
and <span id="id17.id2.3" class="ltx_text ltx_font_bold">iii.</span> learns to cluster unsupervised via teacher-student classifier-training iterations and to address novel unseen test domains via their domain soft-assignment scores.
Thanks to the unique interplay of GCN over clusters, FedCG achieves the state-of-the-art on multiple FL benchmarks.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2104.14628/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="461" height="587" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>In a federated scenario, clients and server exchange the parameters of the model <math id="S1.F1.4.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S1.F1.4.m1.1b"><mi id="S1.F1.4.m1.1.1" xref="S1.F1.4.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.F1.4.m1.1c"><ci id="S1.F1.4.m1.1.1.cmml" xref="S1.F1.4.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m1.1d">M</annotation></semantics></math>. Each client has access to its local data, which can be non-i.i.d. and unbalanced. In the image, each color identifies a different distribution, <span id="S1.F1.8.1" class="ltx_ERROR undefined">\ie</span>a domain, such as pictures of skyscrapers or sea landscapes. Our model <math id="S1.F1.5.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S1.F1.5.m2.1b"><mi id="S1.F1.5.m2.1.1" xref="S1.F1.5.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S1.F1.5.m2.1c"><ci id="S1.F1.5.m2.1.1.cmml" xref="S1.F1.5.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m2.1d">M</annotation></semantics></math> is made of domain-agnostic layers (in gray) and a GCN containing domain-specific parameters, added as residual. According to the domains of the input images, the corresponding nodes of the GCN are activated. At test time, new domains can be addressed as a soft combination of the discovered ones, <span id="S1.F1.9.2" class="ltx_ERROR undefined">\eg</span>skyscrapers over the sea.</figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, a central server model is trained using data stored locally on multiple client devices. Each client computes a local update of the model and all the client updates are then aggregated server-side to build the final model. Since no data ever leaves the client devices, the central model has no direct access to the raw data itself, a fundamental requirement for privacy-preserving applications (e.g.  medical records, bank transactions, etc.). FL usually relies upon the key assumption that a single central model can work efficiently across several users  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. This may not hold in practice, since distinct clients might hold different input distributions, <span id="S1.p1.1.1" class="ltx_ERROR undefined">\ie</span><span id="S1.p1.1.2" class="ltx_text ltx_font_italic">domains</span> (<span id="S1.p1.1.3" class="ltx_ERROR undefined">\eg</span>, people speaking different languages, pictures taken at different locations), with their data possibly being not identically distributed and/or unbalanced.
These issues (collectively referred to as <span id="S1.p1.1.4" class="ltx_text ltx_font_italic">statistical heterogeneity</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>) imply that all i.i.d. assumptions made in distributed optimization or centralized training are violated, and modeling the learning problem requires taking into account this new complexity.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To the best of our knowledge, statistical heterogeneity has been tackled so far with diverse approaches, but none of them has modeled the direct share of knowledge between domains. In particular, meta-learning FL techniques focused on the client-server relation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>; multi-task FL methods specialized parts of the models to certain clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>; while
clustering-based FL split the clients and data, learning separate models for them <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we introduce a novel Cluster-driven Graph Federated Learning (FedCG). FedCG leverages clustering and its potential to reduce statistical heterogeneity by identifying homogeneous<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Homogeneous stands in this context for groupings that minimize intra-cluster Vs inter-cluster variance.</span></span></span>. Concurrently, FedCG is the first to model the domain-domain interaction by means of a GCN, which connects domain-specific model components. In the GCN, each node consists of domain-specific model parameters, while the adjacency matrix is composed of the inverse pairwise distances between the domain-specific parameters.
In this way, FedCG not only captures the specificity of each domain but also allows each domain to benefit from the updates of others, sharing knowledge at training.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our clustering is based on unsupervised teacher-student <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> classifier-training iterations and it generalizes to unseen test-time domains. We cluster by pseudo-labels, assigned by a teacher and learned by a student, in rounds of refinements. This is accomplished within the FL training paradigm, respecting the client’s privacy. This allows to estimate soft-assignments for unseen novel test domains.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We test our model extensively on several FL benchmarks, demonstrating results above or competitive with the state-of-the-art. Our main contributions are:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We present the first cluster-driven GCN-based approach to address statistical heterogeneity in the FL scenario. Thanks to the interactions among domains learned by the means of a GCN, knowledge is shared across domains according to a similarity-based criterion, reducing the risk of overfitting and helping the less populated domains.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We introduce an iterative teacher-student clustering algorithm designed for the federated learning scenario, which allows adapting to new domains via soft-assignments. This captures the diverse domain distributions without violating the FL constraints. Each domain is assigned model-specific components, trained via GCN interactions.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We evaluate our model on multiple FL benchmarks, where we compare favorably or on par with respect to the state-of-the-art.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Although FL is a relatively new field of study, it has aroused great interest in the research community because of its wide applicability in privacy-constrained scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.
A simple but effective baseline for FL is the Federated Averaging (FedAvg) algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, where the central model is obtained as a weighted average of the models received from each client after their local updates. FedAvg has been extensively studied and extended by changing either what is averaged, or how the local models are considered in each update. For instance, FedSGD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> bases the update on the model’s gradient instead of the weights, while in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, the updates are parametrized with fewer variables to reduce the uplink communication cost. Similarly, in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> the nodes only send a quantized version of their local information for reducing the communication overhead. Mohri <span id="S2.p1.1.1" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> propose Agnostic Federated Learning (AFL) in order to reduce the bias towards specific clients. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, each client designs its own local model and the local information is shared by means of knowledge distillation. Our work mainly relates to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, but we explicitly revise the FedAvg framework to account for statistical heterogeneity.</p>
</div>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Statistical heterogeneity in FL</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">Despite their effectiveness, the previous methods ignore an important problem of FL, <span id="S2.SS0.SSS0.Px1.p1.1.1" class="ltx_ERROR undefined">\ie</span>statistical heterogeneity.
Many works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> study this challenge in terms of convergence analysis and effects of non-i.i.d. data distributions in the federated scenario.
Others address this problem from the meta-learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and multitask <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> perspectives for building specialized models.
Specifically, Model-Agnostic Meta-Learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> caught the interest of the FL community for its compatibility with any ML model trained with gradient descent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
On the other hand, in Federated Multi-Task Learning (FMTL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, each client is seen as a different task. FMTL addresses underlying similarities and structures common to some clients by learning a separate model for each device of the network. In particular, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> cluster clients according to their data distribution, assigning a specialized model to each cluster: <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> uses the cosine similarity of the clients’ gradient update, while <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> dynamically groups clients exploiting structural similarities. Hsu <span id="S2.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> develop FedIR and FedVC for re-sampling and re-weighting the client pools.</p>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p2.1" class="ltx_p">As in the aforementioned algorithms, in this work, we focus on addressing statistical heterogeneity in FL. Similarly to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, we seek to learn specialized models addressing the different data distributions. However, differently from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, our clusters are built and updated <span id="S2.SS0.SSS0.Px1.p2.1.1" class="ltx_text ltx_font_italic">during</span> the federated communication rounds through a domain classifier, and not offline after the model convergence. This removes the requirement that all client-specific models must be stored server-side. Moreover, our method aims to identify and group distributions rather than the clients themselves, allowing us to model the realistic case where a client’s data may belong to multiple distributions. In addition, while the applicability of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> is constrained to the clients seen during training, our domain model can be applied to unseen clients at test time thanks to the flexibility of our domain classifier. Finally, we explore merging FL with Graph Representation Learning to address statistical heterogeneity, using graphs to learn domain-specific parameters and to model the interactions among them.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Graph Representation Learning</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Our work employs Graph Convolutional Networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, using domain-specific parameters as high-dimensional features at each node of the graph. This is partly inspired from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, where domain-specific batch normalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> layers are connected through a graph for addressing predictive domain adaptation. However, here we focus on a completely different problem (<span id="S2.SS0.SSS0.Px2.p1.1.1" class="ltx_ERROR undefined">\ie</span>FL), requiring a different training paradigm, and we build our graph on arbitrary layers of the network.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p2.1" class="ltx_p">In the context of FL, to the best of our knowledge, the only existing works adopting graphs as auxiliary representations are SGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, ASFGNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite> and GraphFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. The first two employ graphs for a different purpose: they use a similarity-based graph neural network for improving node classification in network embeddings, while preserving user privacy. GraphFL, instead, is a semi-supervised node classification method on graphs and uses the FL scenario to solve real-world graph-based problems. Differently from these works, we use the graph-based formulation not to learn a single general model, but to capture the statistical heterogeneity while taking into account the relations among the different data distributions. Thanks to the graph, each domain can be addressed with specific parameters while still taking advantage of all local updates.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Cluster-driven Graph Federated Learning </h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section we present our approach addressing statistical heterogeneity in FL by means of GCNs. Our method is based on three ideas: i) identify the clusters of data sharing the same distribution, ii) assign specific network components to each cluster, and  iii) let the components interact within a GCN. We name our full model Cluster-driven Graph Federated Learning (FedCG). Before describing FedCG, in the following we formalize the FL problem.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Problem Formulation.</h5>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.7" class="ltx_p">Our goal is to learn a function <math id="S3.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="f_{\theta}:\mathcal{X}\rightarrow\mathcal{Y}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><msub id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml">θ</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.1" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1"><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.1">:</ci><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.2.3">𝜃</ci></apply><apply id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3"><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.1">→</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.2">𝒳</ci><ci id="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p1.1.m1.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.1.m1.1c">f_{\theta}:\mathcal{X}\rightarrow\mathcal{Y}</annotation></semantics></math>, parametrized by <math id="S3.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.2.m2.1c">\theta</annotation></semantics></math>, mapping samples from an input space <math id="S3.SS0.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS0.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.3.m3.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.3.m3.1c">\mathcal{X}</annotation></semantics></math> to their corresponding semantic in an output space <math id="S3.SS0.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS0.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.4.m4.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.4.m4.1c">\mathcal{Y}</annotation></semantics></math>. Specifically, we focus on a classification task, where <math id="S3.SS0.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.5.m5.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.5.m5.1c">\mathcal{X}</annotation></semantics></math> contains images while <math id="S3.SS0.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.6.m6.1b"><ci id="S3.SS0.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.6.m6.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.6.m6.1c">\mathcal{Y}</annotation></semantics></math> is a probability simplex defined over a set of labels <math id="S3.SS0.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S3.SS0.SSS0.Px1.p1.7.m7.1a"><mi id="S3.SS0.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p1.7.m7.1b"><ci id="S3.SS0.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px1.p1.7.m7.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p1.7.m7.1c">Y</annotation></semantics></math>.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p2.17" class="ltx_p">In the FL setting, the server does not have direct access to the data, but can communicate with a set <math id="S3.SS0.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.1.m1.1a"><mi id="S3.SS0.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.1.m1.1b"><ci id="S3.SS0.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.1.m1.1c">C</annotation></semantics></math> of clients, where each client <math id="S3.SS0.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="c\in C" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.2.m2.1a"><mrow id="S3.SS0.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.2" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.2.cmml">c</mi><mo id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.1" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.3" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.2.m2.1b"><apply id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1"><in id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.2">𝑐</ci><ci id="S3.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.2.m2.1c">c\in C</annotation></semantics></math> has access to a local dataset <math id="S3.SS0.SSS0.Px1.p2.3.m3.2" class="ltx_Math" alttext="\mathcal{T}_{c}=\{x_{i},y_{i}\}_{i=1}^{n_{c}}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.3.m3.2a"><mrow id="S3.SS0.SSS0.Px1.p2.3.m3.2.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.cmml"><msub id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.2.cmml">𝒯</mi><mi id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.3.cmml">c</mi></msub><mo id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.3.cmml">=</mo><msubsup id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.cmml"><mrow id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.3.cmml">{</mo><msub id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.4" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.cmml"><mi id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.5" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.cmml"><mi id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.2.cmml">i</mi><mo id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.1" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.3.cmml">1</mn></mrow><msub id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.cmml"><mi id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.2" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.2.cmml">n</mi><mi id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.3" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.3.cmml">c</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.3.m3.2b"><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2"><eq id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.3"></eq><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.1.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.2">𝒯</ci><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.4.3">𝑐</ci></apply><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2">superscript</csymbol><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2">subscript</csymbol><set id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2"><apply id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4"><eq id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.1.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.1"></eq><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.2">𝑖</ci><cn type="integer" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.2.4.3">1</cn></apply></apply><apply id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.1.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.2.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.2">𝑛</ci><ci id="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.3.cmml" xref="S3.SS0.SSS0.Px1.p2.3.m3.2.2.2.4.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.3.m3.2c">\mathcal{T}_{c}=\{x_{i},y_{i}\}_{i=1}^{n_{c}}</annotation></semantics></math> with <math id="S3.SS0.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="x\in\mathcal{X}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.4.m4.1a"><mrow id="S3.SS0.SSS0.Px1.p2.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.2" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml">x</mi><mo id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.1" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.3" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.4.m4.1b"><apply id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1"><in id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.2">𝑥</ci><ci id="S3.SS0.SSS0.Px1.p2.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.4.m4.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.4.m4.1c">x\in\mathcal{X}</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px1.p2.5.m5.1" class="ltx_Math" alttext="y\in{Y}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.5.m5.1a"><mrow id="S3.SS0.SSS0.Px1.p2.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.2" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.2.cmml">y</mi><mo id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.1" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.3" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.5.m5.1b"><apply id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1"><in id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.2">𝑦</ci><ci id="S3.SS0.SSS0.Px1.p2.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.5.m5.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.5.m5.1c">y\in{Y}</annotation></semantics></math>. In this scenario, we can learn <math id="S3.SS0.SSS0.Px1.p2.6.m6.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.6.m6.1a"><msub id="S3.SS0.SSS0.Px1.p2.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.6.m6.1.1.2" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p2.6.m6.1.1.3" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.6.m6.1b"><apply id="S3.SS0.SSS0.Px1.p2.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p2.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.6.m6.1c">f_{\theta}</annotation></semantics></math> by querying clients and relying on their local updates of the parameters <math id="S3.SS0.SSS0.Px1.p2.7.m7.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.7.m7.1a"><mi id="S3.SS0.SSS0.Px1.p2.7.m7.1.1" xref="S3.SS0.SSS0.Px1.p2.7.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.7.m7.1b"><ci id="S3.SS0.SSS0.Px1.p2.7.m7.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.7.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.7.m7.1c">\theta</annotation></semantics></math>. In particular, since <math id="S3.SS0.SSS0.Px1.p2.8.m8.1" class="ltx_Math" alttext="|C|" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.8.m8.1a"><mrow id="S3.SS0.SSS0.Px1.p2.8.m8.1.2.2" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.2.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.8.m8.1.2.2.1" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.2.1.1.cmml">|</mo><mi id="S3.SS0.SSS0.Px1.p2.8.m8.1.1" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.1.cmml">C</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.8.m8.1.2.2.2" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.8.m8.1b"><apply id="S3.SS0.SSS0.Px1.p2.8.m8.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.2.2"><abs id="S3.SS0.SSS0.Px1.p2.8.m8.1.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.2.2.1"></abs><ci id="S3.SS0.SSS0.Px1.p2.8.m8.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.8.m8.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.8.m8.1c">|C|</annotation></semantics></math> is large, we can assume a synchronous update scheme proceeding in communication rounds, where in each round a set <math id="S3.SS0.SSS0.Px1.p2.9.m9.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.9.m9.1a"><mi id="S3.SS0.SSS0.Px1.p2.9.m9.1.1" xref="S3.SS0.SSS0.Px1.p2.9.m9.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.9.m9.1b"><ci id="S3.SS0.SSS0.Px1.p2.9.m9.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.9.m9.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.9.m9.1c">K</annotation></semantics></math> of clients receives <math id="S3.SS0.SSS0.Px1.p2.10.m10.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.10.m10.1a"><msub id="S3.SS0.SSS0.Px1.p2.10.m10.1.1" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.10.m10.1.1.2" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p2.10.m10.1.1.3" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.10.m10.1b"><apply id="S3.SS0.SSS0.Px1.p2.10.m10.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.10.m10.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.10.m10.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p2.10.m10.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.10.m10.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.10.m10.1c">f_{\theta}</annotation></semantics></math>, with <math id="S3.SS0.SSS0.Px1.p2.11.m11.2" class="ltx_Math" alttext="|K|\ll|C|" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.11.m11.2a"><mrow id="S3.SS0.SSS0.Px1.p2.11.m11.2.3" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.cmml"><mrow id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.2" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.2.1" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.1.1.cmml">|</mo><mi id="S3.SS0.SSS0.Px1.p2.11.m11.1.1" xref="S3.SS0.SSS0.Px1.p2.11.m11.1.1.cmml">K</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.2.2" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.1.1.cmml">|</mo></mrow><mo id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.1" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.1.cmml">≪</mo><mrow id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.2" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.2.1" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.1.1.cmml">|</mo><mi id="S3.SS0.SSS0.Px1.p2.11.m11.2.2" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.2.cmml">C</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.2.2" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.11.m11.2b"><apply id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3"><csymbol cd="latexml" id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.1.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.1">much-less-than</csymbol><apply id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.1.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.2"><abs id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.2.2.1"></abs><ci id="S3.SS0.SSS0.Px1.p2.11.m11.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.1.1">𝐾</ci></apply><apply id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.2"><abs id="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.3.3.2.1"></abs><ci id="S3.SS0.SSS0.Px1.p2.11.m11.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.11.m11.2.2">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.11.m11.2c">|K|\ll|C|</annotation></semantics></math>. Each client <math id="S3.SS0.SSS0.Px1.p2.12.m12.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.12.m12.1a"><mrow id="S3.SS0.SSS0.Px1.p2.12.m12.1.1" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.2" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.2.cmml">k</mi><mo id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.1" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.3" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.12.m12.1b"><apply id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1"><in id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.2">𝑘</ci><ci id="S3.SS0.SSS0.Px1.p2.12.m12.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.12.m12.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.12.m12.1c">k\in K</annotation></semantics></math> computes a local update of <math id="S3.SS0.SSS0.Px1.p2.13.m13.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.13.m13.1a"><mi id="S3.SS0.SSS0.Px1.p2.13.m13.1.1" xref="S3.SS0.SSS0.Px1.p2.13.m13.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.13.m13.1b"><ci id="S3.SS0.SSS0.Px1.p2.13.m13.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.13.m13.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.13.m13.1c">\theta</annotation></semantics></math>, <span id="S3.SS0.SSS0.Px1.p2.17.1" class="ltx_ERROR undefined">\ie</span><math id="S3.SS0.SSS0.Px1.p2.14.m14.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.14.m14.1a"><msub id="S3.SS0.SSS0.Px1.p2.14.m14.1.1" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.14.m14.1.1.2" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px1.p2.14.m14.1.1.3" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.14.m14.1b"><apply id="S3.SS0.SSS0.Px1.p2.14.m14.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.14.m14.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.14.m14.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1.2">𝜃</ci><ci id="S3.SS0.SSS0.Px1.p2.14.m14.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.14.m14.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.14.m14.1c">\theta_{k}</annotation></semantics></math>, with its local dataset <math id="S3.SS0.SSS0.Px1.p2.15.m15.1" class="ltx_Math" alttext="\mathcal{T}_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.15.m15.1a"><msub id="S3.SS0.SSS0.Px1.p2.15.m15.1.1" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p2.15.m15.1.1.2" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1.2.cmml">𝒯</mi><mi id="S3.SS0.SSS0.Px1.p2.15.m15.1.1.3" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.15.m15.1b"><apply id="S3.SS0.SSS0.Px1.p2.15.m15.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.15.m15.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.15.m15.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1.2">𝒯</ci><ci id="S3.SS0.SSS0.Px1.p2.15.m15.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.15.m15.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.15.m15.1c">\mathcal{T}_{k}</annotation></semantics></math>, by minimizing a given objective function. Since we consider classification tasks, we update <math id="S3.SS0.SSS0.Px1.p2.16.m16.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.16.m16.1a"><msub id="S3.SS0.SSS0.Px1.p2.16.m16.1.1" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.16.m16.1.1.2" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px1.p2.16.m16.1.1.3" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.16.m16.1b"><apply id="S3.SS0.SSS0.Px1.p2.16.m16.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.16.m16.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.16.m16.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1.2">𝜃</ci><ci id="S3.SS0.SSS0.Px1.p2.16.m16.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.16.m16.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.16.m16.1c">\theta_{k}</annotation></semantics></math> by minimizing the standard cross-entropy loss over <math id="S3.SS0.SSS0.Px1.p2.17.m17.1" class="ltx_Math" alttext="\mathcal{T}_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.17.m17.1a"><msub id="S3.SS0.SSS0.Px1.p2.17.m17.1.1" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p2.17.m17.1.1.2" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1.2.cmml">𝒯</mi><mi id="S3.SS0.SSS0.Px1.p2.17.m17.1.1.3" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.17.m17.1b"><apply id="S3.SS0.SSS0.Px1.p2.17.m17.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.17.m17.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.17.m17.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1.2">𝒯</ci><ci id="S3.SS0.SSS0.Px1.p2.17.m17.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.17.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.17.m17.1c">\mathcal{T}_{k}</annotation></semantics></math>:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\theta_{k}=\min_{\theta}-\frac{1}{n_{k}}\sum_{(x,y)\in\mathcal{T}_{k}}\log{f^{y}_{\theta}(x)}\,," display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2" xref="S3.E1.m1.4.4.1.1.2.2.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.2.3" xref="S3.E1.m1.4.4.1.1.2.3.cmml">k</mi></msub><mo id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><munder id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml"><mi id="S3.E1.m1.4.4.1.1.3.2.2" xref="S3.E1.m1.4.4.1.1.3.2.2.cmml">min</mi><mi id="S3.E1.m1.4.4.1.1.3.2.3" xref="S3.E1.m1.4.4.1.1.3.2.3.cmml">θ</mi></munder><mo lspace="0em" id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="S3.E1.m1.4.4.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.3.cmml"><mfrac id="S3.E1.m1.4.4.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.2.cmml"><mn id="S3.E1.m1.4.4.1.1.3.3.2.2" xref="S3.E1.m1.4.4.1.1.3.3.2.2.cmml">1</mn><msub id="S3.E1.m1.4.4.1.1.3.3.2.3" xref="S3.E1.m1.4.4.1.1.3.3.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.3.2.3.2" xref="S3.E1.m1.4.4.1.1.3.3.2.3.2.cmml">n</mi><mi id="S3.E1.m1.4.4.1.1.3.3.2.3.3" xref="S3.E1.m1.4.4.1.1.3.3.2.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.3.1" xref="S3.E1.m1.4.4.1.1.3.3.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.3.3.3.cmml"><munder id="S3.E1.m1.4.4.1.1.3.3.3.1" xref="S3.E1.m1.4.4.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.4.4.1.1.3.3.3.1.2" xref="S3.E1.m1.4.4.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.4.2" xref="S3.E1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.4.2.1" xref="S3.E1.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">x</mi><mo id="S3.E1.m1.2.2.2.4.2.2" xref="S3.E1.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.4.2.3" xref="S3.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">∈</mo><msub id="S3.E1.m1.2.2.2.5" xref="S3.E1.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.5.2" xref="S3.E1.m1.2.2.2.5.2.cmml">𝒯</mi><mi id="S3.E1.m1.2.2.2.5.3" xref="S3.E1.m1.2.2.2.5.3.cmml">k</mi></msub></mrow></munder><mrow id="S3.E1.m1.4.4.1.1.3.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.3.2.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.3.3.2.2" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.3.3.3.2.2.1" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E1.m1.4.4.1.1.3.3.3.2.2a" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.cmml">⁡</mo><msubsup id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.2.cmml">f</mi><mi id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.3" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.3.cmml">θ</mi><mi id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.3.cmml">y</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.3.3.3.2.1" xref="S3.E1.m1.4.4.1.1.3.3.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.3.3.3.2.3.2" xref="S3.E1.m1.4.4.1.1.3.3.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.3.3.3.2.3.2.1" xref="S3.E1.m1.4.4.1.1.3.3.3.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">x</mi><mo rspace="0.170em" stretchy="false" id="S3.E1.m1.4.4.1.1.3.3.3.2.3.2.2" xref="S3.E1.m1.4.4.1.1.3.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"></eq><apply id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2">𝜃</ci><ci id="S3.E1.m1.4.4.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.2.3">𝑘</ci></apply><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><minus id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1"></minus><apply id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2">subscript</csymbol><min id="S3.E1.m1.4.4.1.1.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2"></min><ci id="S3.E1.m1.4.4.1.1.3.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.2.3">𝜃</ci></apply><apply id="S3.E1.m1.4.4.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3"><times id="S3.E1.m1.4.4.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.1"></times><apply id="S3.E1.m1.4.4.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2"><divide id="S3.E1.m1.4.4.1.1.3.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2"></divide><cn type="integer" id="S3.E1.m1.4.4.1.1.3.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.2">1</cn><apply id="S3.E1.m1.4.4.1.1.3.3.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.3.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.3.2">𝑛</ci><ci id="S3.E1.m1.4.4.1.1.3.3.2.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.4.4.1.1.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3"><apply id="S3.E1.m1.4.4.1.1.3.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.3.1.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E1.m1.4.4.1.1.3.3.3.1.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.1.2"></sum><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><in id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></in><interval closure="open" id="S3.E1.m1.2.2.2.4.1.cmml" xref="S3.E1.m1.2.2.2.4.2"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑥</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E1.m1.2.2.2.5.cmml" xref="S3.E1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.5.1.cmml" xref="S3.E1.m1.2.2.2.5">subscript</csymbol><ci id="S3.E1.m1.2.2.2.5.2.cmml" xref="S3.E1.m1.2.2.2.5.2">𝒯</ci><ci id="S3.E1.m1.2.2.2.5.3.cmml" xref="S3.E1.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.4.4.1.1.3.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2"><times id="S3.E1.m1.4.4.1.1.3.3.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.1"></times><apply id="S3.E1.m1.4.4.1.1.3.3.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2"><log id="S3.E1.m1.4.4.1.1.3.3.3.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.1"></log><apply id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2">superscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.2">𝑓</ci><ci id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.2.3">𝑦</ci></apply><ci id="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.2.2.2.3">𝜃</ci></apply></apply><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\theta_{k}=\min_{\theta}-\frac{1}{n_{k}}\sum_{(x,y)\in\mathcal{T}_{k}}\log{f^{y}_{\theta}(x)}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS0.SSS0.Px1.p2.21" class="ltx_p">where <math id="S3.SS0.SSS0.Px1.p2.18.m1.1" class="ltx_Math" alttext="f^{y}_{\theta}(x)" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.18.m1.1a"><mrow id="S3.SS0.SSS0.Px1.p2.18.m1.1.2" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.cmml"><msubsup id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.cmml"><mi id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.2" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.3" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.3.cmml">θ</mi><mi id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.3" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.3.cmml">y</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.1" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.1.cmml">​</mo><mrow id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.3.2" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.3.2.1" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.cmml">(</mo><mi id="S3.SS0.SSS0.Px1.p2.18.m1.1.1" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.3.2.2" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.18.m1.1b"><apply id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2"><times id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.1.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.1"></times><apply id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2">subscript</csymbol><apply id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.1.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.2.3">𝑦</ci></apply><ci id="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.2.2.3">𝜃</ci></apply><ci id="S3.SS0.SSS0.Px1.p2.18.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.18.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.18.m1.1c">f^{y}_{\theta}(x)</annotation></semantics></math> denotes the probability of <math id="S3.SS0.SSS0.Px1.p2.19.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.19.m2.1a"><mi id="S3.SS0.SSS0.Px1.p2.19.m2.1.1" xref="S3.SS0.SSS0.Px1.p2.19.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.19.m2.1b"><ci id="S3.SS0.SSS0.Px1.p2.19.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.19.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.19.m2.1c">x</annotation></semantics></math> to belong to class <math id="S3.SS0.SSS0.Px1.p2.20.m3.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.20.m3.1a"><mi id="S3.SS0.SSS0.Px1.p2.20.m3.1.1" xref="S3.SS0.SSS0.Px1.p2.20.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.20.m3.1b"><ci id="S3.SS0.SSS0.Px1.p2.20.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.20.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.20.m3.1c">y</annotation></semantics></math> as given by <math id="S3.SS0.SSS0.Px1.p2.21.m4.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p2.21.m4.1a"><msub id="S3.SS0.SSS0.Px1.p2.21.m4.1.1" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p2.21.m4.1.1.2" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1.2.cmml">f</mi><mi id="S3.SS0.SSS0.Px1.p2.21.m4.1.1.3" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p2.21.m4.1b"><apply id="S3.SS0.SSS0.Px1.p2.21.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p2.21.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p2.21.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1.2">𝑓</ci><ci id="S3.SS0.SSS0.Px1.p2.21.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p2.21.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p2.21.m4.1c">f_{\theta}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p3" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p3.6" class="ltx_p">With Eq. (<a href="#S3.E1" title="In Problem Formulation. ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), we obtain for each client <math id="S3.SS0.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="S3.SS0.SSS0.Px1.p3.1.m1.1a"><mrow id="S3.SS0.SSS0.Px1.p3.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.2" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml">k</mi><mo id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.1" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.3" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p3.1.m1.1b"><apply id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1"><in id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.1"></in><ci id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.2">𝑘</ci><ci id="S3.SS0.SSS0.Px1.p3.1.m1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p3.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p3.1.m1.1c">k\in K</annotation></semantics></math> its corresponding local parameters <math id="S3.SS0.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p3.2.m2.1a"><msub id="S3.SS0.SSS0.Px1.p3.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p3.2.m2.1.1.2" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px1.p3.2.m2.1.1.3" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p3.2.m2.1b"><apply id="S3.SS0.SSS0.Px1.p3.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p3.2.m2.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p3.2.m2.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1.2">𝜃</ci><ci id="S3.SS0.SSS0.Px1.p3.2.m2.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p3.2.m2.1c">\theta_{k}</annotation></semantics></math> tuned to address the classification task of <math id="S3.SS0.SSS0.Px1.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{T}_{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p3.3.m3.1a"><msub id="S3.SS0.SSS0.Px1.p3.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p3.3.m3.1.1.2" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1.2.cmml">𝒯</mi><mi id="S3.SS0.SSS0.Px1.p3.3.m3.1.1.3" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p3.3.m3.1b"><apply id="S3.SS0.SSS0.Px1.p3.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p3.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p3.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1.2">𝒯</ci><ci id="S3.SS0.SSS0.Px1.p3.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p3.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p3.3.m3.1c">\mathcal{T}_{k}</annotation></semantics></math>. At each round, the server gathers all local updates and combines them to update the central model parameters <math id="S3.SS0.SSS0.Px1.p3.4.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px1.p3.4.m4.1a"><mi id="S3.SS0.SSS0.Px1.p3.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p3.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p3.4.m4.1b"><ci id="S3.SS0.SSS0.Px1.p3.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p3.4.m4.1c">\theta</annotation></semantics></math>. A simple yet effective strategy to aggregate the local updates is FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, that computes <math id="S3.SS0.SSS0.Px1.p3.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS0.SSS0.Px1.p3.5.m5.1a"><mi id="S3.SS0.SSS0.Px1.p3.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p3.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p3.5.m5.1b"><ci id="S3.SS0.SSS0.Px1.p3.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p3.5.m5.1c">\theta</annotation></semantics></math> as the weighted average of each <math id="S3.SS0.SSS0.Px1.p3.6.m6.1" class="ltx_Math" alttext="\theta^{k}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p3.6.m6.1a"><msup id="S3.SS0.SSS0.Px1.p3.6.m6.1.1" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p3.6.m6.1.1.2" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1.2.cmml">θ</mi><mi id="S3.SS0.SSS0.Px1.p3.6.m6.1.1.3" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p3.6.m6.1b"><apply id="S3.SS0.SSS0.Px1.p3.6.m6.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p3.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1">superscript</csymbol><ci id="S3.SS0.SSS0.Px1.p3.6.m6.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1.2">𝜃</ci><ci id="S3.SS0.SSS0.Px1.p3.6.m6.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p3.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p3.6.m6.1c">\theta^{k}</annotation></semantics></math>:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\theta=\frac{1}{\sum_{k\in K}n_{k}}\sum_{k\in K}n_{k}\theta_{k}\,." display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">θ</mi><mo id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mfrac id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml"><mn id="S3.E2.m1.1.1.1.1.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.2.cmml">1</mn><mrow id="S3.E2.m1.1.1.1.1.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.cmml"><msub id="S3.E2.m1.1.1.1.1.3.2.3.1" xref="S3.E2.m1.1.1.1.1.3.2.3.1.cmml"><mo id="S3.E2.m1.1.1.1.1.3.2.3.1.2" xref="S3.E2.m1.1.1.1.1.3.2.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.3.2.3.1.3" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.3.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.2.cmml">k</mi><mo id="S3.E2.m1.1.1.1.1.3.2.3.1.3.1" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.1.cmml">∈</mo><mi id="S3.E2.m1.1.1.1.1.3.2.3.1.3.3" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.3.cmml">K</mi></mrow></msub><msub id="S3.E2.m1.1.1.1.1.3.2.3.2" xref="S3.E2.m1.1.1.1.1.3.2.3.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.2.3.2.2" xref="S3.E2.m1.1.1.1.1.3.2.3.2.2.cmml">n</mi><mi id="S3.E2.m1.1.1.1.1.3.2.3.2.3" xref="S3.E2.m1.1.1.1.1.3.2.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.cmml"><munder id="S3.E2.m1.1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E2.m1.1.1.1.1.3.3.1.2" xref="S3.E2.m1.1.1.1.1.3.3.1.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.1.3.3.1.3" xref="S3.E2.m1.1.1.1.1.3.3.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.1.3.2" xref="S3.E2.m1.1.1.1.1.3.3.1.3.2.cmml">k</mi><mo id="S3.E2.m1.1.1.1.1.3.3.1.3.1" xref="S3.E2.m1.1.1.1.1.3.3.1.3.1.cmml">∈</mo><mi id="S3.E2.m1.1.1.1.1.3.3.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3.1.3.3.cmml">K</mi></mrow></munder><mrow id="S3.E2.m1.1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.cmml"><msub id="S3.E2.m1.1.1.1.1.3.3.2.2" xref="S3.E2.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2.2.2" xref="S3.E2.m1.1.1.1.1.3.3.2.2.2.cmml">n</mi><mi id="S3.E2.m1.1.1.1.1.3.3.2.2.3" xref="S3.E2.m1.1.1.1.1.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.3.3.2.1" xref="S3.E2.m1.1.1.1.1.3.3.2.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.3.3.2.3" xref="S3.E2.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1.3.3.2.3.2" xref="S3.E2.m1.1.1.1.1.3.3.2.3.2.cmml">θ</mi><mi id="S3.E2.m1.1.1.1.1.3.3.2.3.3" xref="S3.E2.m1.1.1.1.1.3.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"></eq><ci id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2">𝜃</ci><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><times id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.1"></times><apply id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2"><divide id="S3.E2.m1.1.1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2"></divide><cn type="integer" id="S3.E2.m1.1.1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.2">1</cn><apply id="S3.E2.m1.1.1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3"><apply id="S3.E2.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.3.2.3.1.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1.2"></sum><apply id="S3.E2.m1.1.1.1.1.3.2.3.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3"><in id="S3.E2.m1.1.1.1.1.3.2.3.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.1"></in><ci id="S3.E2.m1.1.1.1.1.3.2.3.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.2">𝑘</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.1.3.3">𝐾</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.2.2">𝑛</ci><ci id="S3.E2.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.2.3.2.3">𝑘</ci></apply></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><apply id="S3.E2.m1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.1.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E2.m1.1.1.1.1.3.3.1.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1.2"></sum><apply id="S3.E2.m1.1.1.1.1.3.3.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1.3"><in id="S3.E2.m1.1.1.1.1.3.3.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1.3.1"></in><ci id="S3.E2.m1.1.1.1.1.3.3.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1.3.2">𝑘</ci><ci id="S3.E2.m1.1.1.1.1.3.3.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.1.3.3">𝐾</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2"><times id="S3.E2.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.1"></times><apply id="S3.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2.2">𝑛</ci><ci id="S3.E2.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.2.3">𝑘</ci></apply><apply id="S3.E2.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3.2">𝜃</ci><ci id="S3.E2.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E2.m1.1.1.1.1.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\theta=\frac{1}{\sum_{k\in K}n_{k}}\sum_{k\in K}n_{k}\theta_{k}\,.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS0.SSS0.Px1.p4" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p4.6" class="ltx_p">Heterogeneity may be a problem in FedAvg, and in general for FL strategies, due to the lack of convergence guarantees in non-i.i.d. and unbalanced data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. In realistic applications, the joint probability distributions over <math id="S3.SS0.SSS0.Px1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p4.1.m1.1.1" xref="S3.SS0.SSS0.Px1.p4.1.m1.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p4.1.m1.1b"><ci id="S3.SS0.SSS0.Px1.p4.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.1.m1.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p4.1.m1.1c">\mathcal{X}</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px1.p4.2.m2.1" class="ltx_Math" alttext="{Y}" display="inline"><semantics id="S3.SS0.SSS0.Px1.p4.2.m2.1a"><mi id="S3.SS0.SSS0.Px1.p4.2.m2.1.1" xref="S3.SS0.SSS0.Px1.p4.2.m2.1.1.cmml">Y</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p4.2.m2.1b"><ci id="S3.SS0.SSS0.Px1.p4.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.2.m2.1.1">𝑌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p4.2.m2.1c">{Y}</annotation></semantics></math> are usually different in each client, <span id="S3.SS0.SSS0.Px1.p4.6.1" class="ltx_ERROR undefined">\ie</span>given two clients <math id="S3.SS0.SSS0.Px1.p4.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS0.SSS0.Px1.p4.3.m3.1a"><mi id="S3.SS0.SSS0.Px1.p4.3.m3.1.1" xref="S3.SS0.SSS0.Px1.p4.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p4.3.m3.1b"><ci id="S3.SS0.SSS0.Px1.p4.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p4.3.m3.1c">c</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px1.p4.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS0.SSS0.Px1.p4.4.m4.1a"><mi id="S3.SS0.SSS0.Px1.p4.4.m4.1.1" xref="S3.SS0.SSS0.Px1.p4.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p4.4.m4.1b"><ci id="S3.SS0.SSS0.Px1.p4.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p4.4.m4.1c">k</annotation></semantics></math> with <math id="S3.SS0.SSS0.Px1.p4.5.m5.1" class="ltx_Math" alttext="c\neq k" display="inline"><semantics id="S3.SS0.SSS0.Px1.p4.5.m5.1a"><mrow id="S3.SS0.SSS0.Px1.p4.5.m5.1.1" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.cmml"><mi id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.2" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.2.cmml">c</mi><mo id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.1" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.1.cmml">≠</mo><mi id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.3" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p4.5.m5.1b"><apply id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1"><neq id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.1"></neq><ci id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.2">𝑐</ci><ci id="S3.SS0.SSS0.Px1.p4.5.m5.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p4.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p4.5.m5.1c">c\neq k</annotation></semantics></math>, we have <math id="S3.SS0.SSS0.Px1.p4.6.m6.2" class="ltx_Math" alttext="p_{\mathcal{X}Y}(\mathcal{T}_{c})\neq p_{\mathcal{X}Y}(\mathcal{T}_{k})" display="inline"><semantics id="S3.SS0.SSS0.Px1.p4.6.m6.2a"><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.2.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.cmml"><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.cmml"><msub id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.cmml"><mi id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.2.cmml">p</mi><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.3.cmml">Y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.2.cmml">𝒯</mi><mi id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.3.cmml">≠</mo><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.cmml"><msub id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.cmml"><mi id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.2.cmml">p</mi><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.1.cmml">​</mo><mi id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.3.cmml">Y</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.2.cmml">​</mo><mrow id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.cmml">(</mo><msub id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.2" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.2.cmml">𝒯</mi><mi id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.3" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px1.p4.6.m6.2b"><apply id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2"><neq id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.3"></neq><apply id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1"><times id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.2"></times><apply id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.2">𝑝</ci><apply id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3"><times id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.1"></times><ci id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.2">𝒳</ci><ci id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.3.3.3">𝑌</ci></apply></apply><apply id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.2">𝒯</ci><ci id="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2"><times id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.2"></times><apply id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.2">𝑝</ci><apply id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3"><times id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.1"></times><ci id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.2">𝒳</ci><ci id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.3.3.3">𝑌</ci></apply></apply><apply id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.1.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1">subscript</csymbol><ci id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.2.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.2">𝒯</ci><ci id="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.3.cmml" xref="S3.SS0.SSS0.Px1.p4.6.m6.2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px1.p4.6.m6.2c">p_{\mathcal{X}Y}(\mathcal{T}_{c})\neq p_{\mathcal{X}Y}(\mathcal{T}_{k})</annotation></semantics></math>.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p5" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p5.1" class="ltx_p">To address this problem,
we propose an approach that i) identifies the distributions (<span id="S3.SS0.SSS0.Px1.p5.1.1" class="ltx_ERROR undefined">\ie</span>domains) present in different clients through clustering; ii) instantiates domain-specific components to adapt the model to each domain; iii) makes the various domain-specific modules interact through a GCN, such that updating one of them can benefit the others. In the following we describe each of these elements.</p>
</div>
</section>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated Clustering</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">To address statistical heterogeneity through domain-specific modules, we need to identify the different domains present in the data. This is challenging since data are split across multiple clients and the server cannot cluster them directly. Moreover, these clusters, even if correctly identified for the training set, may not be optimal for the test set.
Here we address the first problem by a clustering procedure built on two <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_italic">domain classifiers</span>, one having the role of the <span id="S3.SS1.p1.1.2" class="ltx_text ltx_font_italic">teacher</span> and the other of the <span id="S3.SS1.p1.1.3" class="ltx_text ltx_font_italic">student</span>, which
iteratively group images such that their grouping is easier to classify.
We describe how we match clusters to the test set in Sec. <a href="#S3.SS3" title="3.3 Connecting Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.13" class="ltx_p">Formally, let us assume our data contain <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">D</annotation></semantics></math> domains, with <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">D</annotation></semantics></math> being a hyperparameter. We initialize two domain classifiers, the teacher <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="g_{\phi}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">g</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑔</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">g_{\phi}</annotation></semantics></math> and the student <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="g_{\varphi}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">g</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑔</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">g_{\varphi}</annotation></semantics></math> parametrized by <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\phi</annotation></semantics></math> and <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\varphi</annotation></semantics></math> respectively. Each domain-classifier is a function, mapping images to a probability vector <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\mathcal{D}</annotation></semantics></math> defined over the <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">D</annotation></semantics></math> domains, <span id="S3.SS1.p2.13.1" class="ltx_ERROR undefined">\ie</span><math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="g_{\cdot}:\mathcal{X}\rightarrow\mathcal{D}" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><mrow id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><msub id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2.2" xref="S3.SS1.p2.9.m9.1.1.2.2.cmml">g</mi><mo id="S3.SS1.p2.9.m9.1.1.2.3" xref="S3.SS1.p2.9.m9.1.1.2.3.cmml">⋅</mo></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p2.9.m9.1.1.1" xref="S3.SS1.p2.9.m9.1.1.1.cmml">:</mo><mrow id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m9.1.1.3.2" xref="S3.SS1.p2.9.m9.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="S3.SS1.p2.9.m9.1.1.3.1" xref="S3.SS1.p2.9.m9.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m9.1.1.3.3" xref="S3.SS1.p2.9.m9.1.1.3.3.cmml">𝒟</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><ci id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1">:</ci><apply id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2.2">𝑔</ci><ci id="S3.SS1.p2.9.m9.1.1.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.2.3">⋅</ci></apply><apply id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3"><ci id="S3.SS1.p2.9.m9.1.1.3.1.cmml" xref="S3.SS1.p2.9.m9.1.1.3.1">→</ci><ci id="S3.SS1.p2.9.m9.1.1.3.2.cmml" xref="S3.SS1.p2.9.m9.1.1.3.2">𝒳</ci><ci id="S3.SS1.p2.9.m9.1.1.3.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3.3">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">g_{\cdot}:\mathcal{X}\rightarrow\mathcal{D}</annotation></semantics></math>. Given an input image, the teacher provides domain pseudo-labels as a target to refine student’s predictions. In particular, we learn the client student parameters <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="\varphi_{k}" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><msub id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">φ</mi><mi id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝜑</ci><ci id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">\varphi_{k}</annotation></semantics></math> by iteratively minimizing the cross-entropy loss between the teacher and student domain predictions over <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="\mathcal{T}_{k}" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">𝒯</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝒯</ci><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">\mathcal{T}_{k}</annotation></semantics></math>. Thus, for a client <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="k\in K" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><mrow id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml">k</mi><mo id="S3.SS1.p2.12.m12.1.1.1" xref="S3.SS1.p2.12.m12.1.1.1.cmml">∈</mo><mi id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><in id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1.1"></in><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">𝑘</ci><ci id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">k\in K</annotation></semantics></math>, the parameters <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="\varphi_{k}" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><msub id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml"><mi id="S3.SS1.p2.13.m13.1.1.2" xref="S3.SS1.p2.13.m13.1.1.2.cmml">φ</mi><mi id="S3.SS1.p2.13.m13.1.1.3" xref="S3.SS1.p2.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.13.m13.1.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p2.13.m13.1.1.2.cmml" xref="S3.SS1.p2.13.m13.1.1.2">𝜑</ci><ci id="S3.SS1.p2.13.m13.1.1.3.cmml" xref="S3.SS1.p2.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">\varphi_{k}</annotation></semantics></math> of the student are:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\varphi_{k}=\arg\min_{\varphi}-\frac{1}{n_{k}}\sum_{(x,y)\in\mathcal{T}_{k}}\log{g^{\hat{d}}_{\varphi}(x)}\,," display="block"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><msub id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml"><mi id="S3.E3.m1.4.4.1.1.2.2" xref="S3.E3.m1.4.4.1.1.2.2.cmml">φ</mi><mi id="S3.E3.m1.4.4.1.1.2.3" xref="S3.E3.m1.4.4.1.1.2.3.cmml">k</mi></msub><mo id="S3.E3.m1.4.4.1.1.1" xref="S3.E3.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml"><mrow id="S3.E3.m1.4.4.1.1.3.2" xref="S3.E3.m1.4.4.1.1.3.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.1" xref="S3.E3.m1.4.4.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E3.m1.4.4.1.1.3.2a" xref="S3.E3.m1.4.4.1.1.3.2.cmml">⁡</mo><munder id="S3.E3.m1.4.4.1.1.3.2.2" xref="S3.E3.m1.4.4.1.1.3.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.2.2.2" xref="S3.E3.m1.4.4.1.1.3.2.2.2.cmml">min</mi><mi id="S3.E3.m1.4.4.1.1.3.2.2.3" xref="S3.E3.m1.4.4.1.1.3.2.2.3.cmml">φ</mi></munder></mrow><mo lspace="0em" id="S3.E3.m1.4.4.1.1.3.1" xref="S3.E3.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="S3.E3.m1.4.4.1.1.3.3" xref="S3.E3.m1.4.4.1.1.3.3.cmml"><mfrac id="S3.E3.m1.4.4.1.1.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.2.cmml"><mn id="S3.E3.m1.4.4.1.1.3.3.2.2" xref="S3.E3.m1.4.4.1.1.3.3.2.2.cmml">1</mn><msub id="S3.E3.m1.4.4.1.1.3.3.2.3" xref="S3.E3.m1.4.4.1.1.3.3.2.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.2.3.2" xref="S3.E3.m1.4.4.1.1.3.3.2.3.2.cmml">n</mi><mi id="S3.E3.m1.4.4.1.1.3.3.2.3.3" xref="S3.E3.m1.4.4.1.1.3.3.2.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.3.3.1" xref="S3.E3.m1.4.4.1.1.3.3.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.3" xref="S3.E3.m1.4.4.1.1.3.3.3.cmml"><munder id="S3.E3.m1.4.4.1.1.3.3.3.1" xref="S3.E3.m1.4.4.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.4.4.1.1.3.3.3.1.2" xref="S3.E3.m1.4.4.1.1.3.3.3.1.2.cmml">∑</mo><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.4.2.1" xref="S3.E3.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">x</mi><mo id="S3.E3.m1.2.2.2.4.2.2" xref="S3.E3.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E3.m1.2.2.2.4.2.3" xref="S3.E3.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">∈</mo><msub id="S3.E3.m1.2.2.2.5" xref="S3.E3.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.2.5.2" xref="S3.E3.m1.2.2.2.5.2.cmml">𝒯</mi><mi id="S3.E3.m1.2.2.2.5.3" xref="S3.E3.m1.2.2.2.5.3.cmml">k</mi></msub></mrow></munder><mrow id="S3.E3.m1.4.4.1.1.3.3.3.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.cmml"><mrow id="S3.E3.m1.4.4.1.1.3.3.3.2.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.3.2.2.1" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E3.m1.4.4.1.1.3.3.3.2.2a" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.cmml">⁡</mo><msubsup id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.2.cmml">g</mi><mi id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.3" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.3.cmml">φ</mi><mover accent="true" id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.cmml"><mi id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.2.cmml">d</mi><mo id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.1" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.1.cmml">^</mo></mover></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.3.3.3.2.1" xref="S3.E3.m1.4.4.1.1.3.3.3.2.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.3.3.3.2.3.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.3.3.3.2.3.2.1" xref="S3.E3.m1.4.4.1.1.3.3.3.2.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">x</mi><mo rspace="0.170em" stretchy="false" id="S3.E3.m1.4.4.1.1.3.3.3.2.3.2.2" xref="S3.E3.m1.4.4.1.1.3.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.1.cmml" xref="S3.E3.m1.4.4.1.1.1"></eq><apply id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.2.1.cmml" xref="S3.E3.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.2.2.cmml" xref="S3.E3.m1.4.4.1.1.2.2">𝜑</ci><ci id="S3.E3.m1.4.4.1.1.2.3.cmml" xref="S3.E3.m1.4.4.1.1.2.3">𝑘</ci></apply><apply id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"><minus id="S3.E3.m1.4.4.1.1.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.1"></minus><apply id="S3.E3.m1.4.4.1.1.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2"><arg id="S3.E3.m1.4.4.1.1.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.1"></arg><apply id="S3.E3.m1.4.4.1.1.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2">subscript</csymbol><min id="S3.E3.m1.4.4.1.1.3.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2.2"></min><ci id="S3.E3.m1.4.4.1.1.3.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.2.2.3">𝜑</ci></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3"><times id="S3.E3.m1.4.4.1.1.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.1"></times><apply id="S3.E3.m1.4.4.1.1.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2"><divide id="S3.E3.m1.4.4.1.1.3.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2"></divide><cn type="integer" id="S3.E3.m1.4.4.1.1.3.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2.2">1</cn><apply id="S3.E3.m1.4.4.1.1.3.3.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.3.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.3.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2.3.2">𝑛</ci><ci id="S3.E3.m1.4.4.1.1.3.3.2.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.2.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.3.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3"><apply id="S3.E3.m1.4.4.1.1.3.3.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.3.3.1.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E3.m1.4.4.1.1.3.3.3.1.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.1.2"></sum><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><in id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></in><interval closure="open" id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4.2"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑥</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E3.m1.2.2.2.5.cmml" xref="S3.E3.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.5.1.cmml" xref="S3.E3.m1.2.2.2.5">subscript</csymbol><ci id="S3.E3.m1.2.2.2.5.2.cmml" xref="S3.E3.m1.2.2.2.5.2">𝒯</ci><ci id="S3.E3.m1.2.2.2.5.3.cmml" xref="S3.E3.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="S3.E3.m1.4.4.1.1.3.3.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2"><times id="S3.E3.m1.4.4.1.1.3.3.3.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.1"></times><apply id="S3.E3.m1.4.4.1.1.3.3.3.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2"><log id="S3.E3.m1.4.4.1.1.3.3.3.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.1"></log><apply id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2">subscript</csymbol><apply id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.2">𝑔</ci><apply id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3"><ci id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.1.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.1">^</ci><ci id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.2.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.2.3.2">𝑑</ci></apply></apply><ci id="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E3.m1.4.4.1.1.3.3.3.2.2.2.3">𝜑</ci></apply></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\varphi_{k}=\arg\min_{\varphi}-\frac{1}{n_{k}}\sum_{(x,y)\in\mathcal{T}_{k}}\log{g^{\hat{d}}_{\varphi}(x)}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.22" class="ltx_p">where <math id="S3.SS1.p2.14.m1.1" class="ltx_Math" alttext="\hat{d}" display="inline"><semantics id="S3.SS1.p2.14.m1.1a"><mover accent="true" id="S3.SS1.p2.14.m1.1.1" xref="S3.SS1.p2.14.m1.1.1.cmml"><mi id="S3.SS1.p2.14.m1.1.1.2" xref="S3.SS1.p2.14.m1.1.1.2.cmml">d</mi><mo id="S3.SS1.p2.14.m1.1.1.1" xref="S3.SS1.p2.14.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.14.m1.1b"><apply id="S3.SS1.p2.14.m1.1.1.cmml" xref="S3.SS1.p2.14.m1.1.1"><ci id="S3.SS1.p2.14.m1.1.1.1.cmml" xref="S3.SS1.p2.14.m1.1.1.1">^</ci><ci id="S3.SS1.p2.14.m1.1.1.2.cmml" xref="S3.SS1.p2.14.m1.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.14.m1.1c">\hat{d}</annotation></semantics></math> is the pseudo-label given by the teacher for <math id="S3.SS1.p2.15.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p2.15.m2.1a"><mi id="S3.SS1.p2.15.m2.1.1" xref="S3.SS1.p2.15.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.15.m2.1b"><ci id="S3.SS1.p2.15.m2.1.1.cmml" xref="S3.SS1.p2.15.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.15.m2.1c">x</annotation></semantics></math>, <span id="S3.SS1.p2.22.1" class="ltx_ERROR undefined">\ie</span><math id="S3.SS1.p2.16.m3.1" class="ltx_Math" alttext="\hat{d}=\arg\max_{d\in D}g_{\phi}^{d}(x)" display="inline"><semantics id="S3.SS1.p2.16.m3.1a"><mrow id="S3.SS1.p2.16.m3.1.2" xref="S3.SS1.p2.16.m3.1.2.cmml"><mover accent="true" id="S3.SS1.p2.16.m3.1.2.2" xref="S3.SS1.p2.16.m3.1.2.2.cmml"><mi id="S3.SS1.p2.16.m3.1.2.2.2" xref="S3.SS1.p2.16.m3.1.2.2.2.cmml">d</mi><mo id="S3.SS1.p2.16.m3.1.2.2.1" xref="S3.SS1.p2.16.m3.1.2.2.1.cmml">^</mo></mover><mo id="S3.SS1.p2.16.m3.1.2.1" xref="S3.SS1.p2.16.m3.1.2.1.cmml">=</mo><mrow id="S3.SS1.p2.16.m3.1.2.3" xref="S3.SS1.p2.16.m3.1.2.3.cmml"><mrow id="S3.SS1.p2.16.m3.1.2.3.2" xref="S3.SS1.p2.16.m3.1.2.3.2.cmml"><mi id="S3.SS1.p2.16.m3.1.2.3.2.1" xref="S3.SS1.p2.16.m3.1.2.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.SS1.p2.16.m3.1.2.3.2a" xref="S3.SS1.p2.16.m3.1.2.3.2.cmml">⁡</mo><mrow id="S3.SS1.p2.16.m3.1.2.3.2.2" xref="S3.SS1.p2.16.m3.1.2.3.2.2.cmml"><msub id="S3.SS1.p2.16.m3.1.2.3.2.2.1" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.cmml"><mi id="S3.SS1.p2.16.m3.1.2.3.2.2.1.2" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.2.cmml">max</mi><mrow id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.cmml"><mi id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.2" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.2.cmml">d</mi><mo id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.1" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.1.cmml">∈</mo><mi id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.3" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.3.cmml">D</mi></mrow></msub><mo lspace="0.167em" id="S3.SS1.p2.16.m3.1.2.3.2.2a" xref="S3.SS1.p2.16.m3.1.2.3.2.2.cmml">⁡</mo><msubsup id="S3.SS1.p2.16.m3.1.2.3.2.2.2" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.cmml"><mi id="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.2" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.2.cmml">g</mi><mi id="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.3" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.3.cmml">ϕ</mi><mi id="S3.SS1.p2.16.m3.1.2.3.2.2.2.3" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.3.cmml">d</mi></msubsup></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.p2.16.m3.1.2.3.1" xref="S3.SS1.p2.16.m3.1.2.3.1.cmml">​</mo><mrow id="S3.SS1.p2.16.m3.1.2.3.3.2" xref="S3.SS1.p2.16.m3.1.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.16.m3.1.2.3.3.2.1" xref="S3.SS1.p2.16.m3.1.2.3.cmml">(</mo><mi id="S3.SS1.p2.16.m3.1.1" xref="S3.SS1.p2.16.m3.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p2.16.m3.1.2.3.3.2.2" xref="S3.SS1.p2.16.m3.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.16.m3.1b"><apply id="S3.SS1.p2.16.m3.1.2.cmml" xref="S3.SS1.p2.16.m3.1.2"><eq id="S3.SS1.p2.16.m3.1.2.1.cmml" xref="S3.SS1.p2.16.m3.1.2.1"></eq><apply id="S3.SS1.p2.16.m3.1.2.2.cmml" xref="S3.SS1.p2.16.m3.1.2.2"><ci id="S3.SS1.p2.16.m3.1.2.2.1.cmml" xref="S3.SS1.p2.16.m3.1.2.2.1">^</ci><ci id="S3.SS1.p2.16.m3.1.2.2.2.cmml" xref="S3.SS1.p2.16.m3.1.2.2.2">𝑑</ci></apply><apply id="S3.SS1.p2.16.m3.1.2.3.cmml" xref="S3.SS1.p2.16.m3.1.2.3"><times id="S3.SS1.p2.16.m3.1.2.3.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.1"></times><apply id="S3.SS1.p2.16.m3.1.2.3.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2"><arg id="S3.SS1.p2.16.m3.1.2.3.2.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.1"></arg><apply id="S3.SS1.p2.16.m3.1.2.3.2.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2"><apply id="S3.SS1.p2.16.m3.1.2.3.2.2.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m3.1.2.3.2.2.1.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1">subscript</csymbol><max id="S3.SS1.p2.16.m3.1.2.3.2.2.1.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.2"></max><apply id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3"><in id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.1"></in><ci id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.2">𝑑</ci><ci id="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.3.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.1.3.3">𝐷</ci></apply></apply><apply id="S3.SS1.p2.16.m3.1.2.3.2.2.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m3.1.2.3.2.2.2.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2">superscript</csymbol><apply id="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.1.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.2.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.2">𝑔</ci><ci id="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.3.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.2.3">italic-ϕ</ci></apply><ci id="S3.SS1.p2.16.m3.1.2.3.2.2.2.3.cmml" xref="S3.SS1.p2.16.m3.1.2.3.2.2.2.3">𝑑</ci></apply></apply></apply><ci id="S3.SS1.p2.16.m3.1.1.cmml" xref="S3.SS1.p2.16.m3.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.16.m3.1c">\hat{d}=\arg\max_{d\in D}g_{\phi}^{d}(x)</annotation></semantics></math> and <math id="S3.SS1.p2.17.m4.1" class="ltx_Math" alttext="g_{*}^{d}(x)" display="inline"><semantics id="S3.SS1.p2.17.m4.1a"><mrow id="S3.SS1.p2.17.m4.1.2" xref="S3.SS1.p2.17.m4.1.2.cmml"><msubsup id="S3.SS1.p2.17.m4.1.2.2" xref="S3.SS1.p2.17.m4.1.2.2.cmml"><mi id="S3.SS1.p2.17.m4.1.2.2.2.2" xref="S3.SS1.p2.17.m4.1.2.2.2.2.cmml">g</mi><mo id="S3.SS1.p2.17.m4.1.2.2.2.3" xref="S3.SS1.p2.17.m4.1.2.2.2.3.cmml">∗</mo><mi id="S3.SS1.p2.17.m4.1.2.2.3" xref="S3.SS1.p2.17.m4.1.2.2.3.cmml">d</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.17.m4.1.2.1" xref="S3.SS1.p2.17.m4.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.17.m4.1.2.3.2" xref="S3.SS1.p2.17.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.17.m4.1.2.3.2.1" xref="S3.SS1.p2.17.m4.1.2.cmml">(</mo><mi id="S3.SS1.p2.17.m4.1.1" xref="S3.SS1.p2.17.m4.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p2.17.m4.1.2.3.2.2" xref="S3.SS1.p2.17.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.17.m4.1b"><apply id="S3.SS1.p2.17.m4.1.2.cmml" xref="S3.SS1.p2.17.m4.1.2"><times id="S3.SS1.p2.17.m4.1.2.1.cmml" xref="S3.SS1.p2.17.m4.1.2.1"></times><apply id="S3.SS1.p2.17.m4.1.2.2.cmml" xref="S3.SS1.p2.17.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m4.1.2.2.1.cmml" xref="S3.SS1.p2.17.m4.1.2.2">superscript</csymbol><apply id="S3.SS1.p2.17.m4.1.2.2.2.cmml" xref="S3.SS1.p2.17.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.17.m4.1.2.2.2.1.cmml" xref="S3.SS1.p2.17.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.17.m4.1.2.2.2.2.cmml" xref="S3.SS1.p2.17.m4.1.2.2.2.2">𝑔</ci><times id="S3.SS1.p2.17.m4.1.2.2.2.3.cmml" xref="S3.SS1.p2.17.m4.1.2.2.2.3"></times></apply><ci id="S3.SS1.p2.17.m4.1.2.2.3.cmml" xref="S3.SS1.p2.17.m4.1.2.2.3">𝑑</ci></apply><ci id="S3.SS1.p2.17.m4.1.1.cmml" xref="S3.SS1.p2.17.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.17.m4.1c">g_{*}^{d}(x)</annotation></semantics></math> denotes the probability of <math id="S3.SS1.p2.18.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p2.18.m5.1a"><mi id="S3.SS1.p2.18.m5.1.1" xref="S3.SS1.p2.18.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.18.m5.1b"><ci id="S3.SS1.p2.18.m5.1.1.cmml" xref="S3.SS1.p2.18.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.18.m5.1c">x</annotation></semantics></math> to belong to the <math id="S3.SS1.p2.19.m6.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p2.19.m6.1a"><mi id="S3.SS1.p2.19.m6.1.1" xref="S3.SS1.p2.19.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.19.m6.1b"><ci id="S3.SS1.p2.19.m6.1.1.cmml" xref="S3.SS1.p2.19.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.19.m6.1c">d</annotation></semantics></math>-th domain as given by <math id="S3.SS1.p2.20.m7.1" class="ltx_Math" alttext="g_{*}" display="inline"><semantics id="S3.SS1.p2.20.m7.1a"><msub id="S3.SS1.p2.20.m7.1.1" xref="S3.SS1.p2.20.m7.1.1.cmml"><mi id="S3.SS1.p2.20.m7.1.1.2" xref="S3.SS1.p2.20.m7.1.1.2.cmml">g</mi><mo id="S3.SS1.p2.20.m7.1.1.3" xref="S3.SS1.p2.20.m7.1.1.3.cmml">∗</mo></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.20.m7.1b"><apply id="S3.SS1.p2.20.m7.1.1.cmml" xref="S3.SS1.p2.20.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.20.m7.1.1.1.cmml" xref="S3.SS1.p2.20.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.20.m7.1.1.2.cmml" xref="S3.SS1.p2.20.m7.1.1.2">𝑔</ci><times id="S3.SS1.p2.20.m7.1.1.3.cmml" xref="S3.SS1.p2.20.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.20.m7.1c">g_{*}</annotation></semantics></math>. Eq. (<a href="#S3.E3" title="In 3.1 Federated Clustering ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) rewards the student from being able to classify according to the pseudo labels, and implicitly encourages agreement on the pseudo-labels, thus on the clustering, which most easily may be agreed upon.
Then the domain classifier parameters <math id="S3.SS1.p2.21.m8.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS1.p2.21.m8.1a"><mi id="S3.SS1.p2.21.m8.1.1" xref="S3.SS1.p2.21.m8.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.21.m8.1b"><ci id="S3.SS1.p2.21.m8.1.1.cmml" xref="S3.SS1.p2.21.m8.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.21.m8.1c">\varphi</annotation></semantics></math> are updated after each round with standard FedAvg, <span id="S3.SS1.p2.22.2" class="ltx_ERROR undefined">\ie</span><math id="S3.SS1.p2.22.m9.1" class="ltx_Math" alttext="\varphi=\frac{1}{\sum_{i=1}^{K}n_{k}}\sum_{k\in K}n_{k}\varphi_{k}" display="inline"><semantics id="S3.SS1.p2.22.m9.1a"><mrow id="S3.SS1.p2.22.m9.1.1" xref="S3.SS1.p2.22.m9.1.1.cmml"><mi id="S3.SS1.p2.22.m9.1.1.2" xref="S3.SS1.p2.22.m9.1.1.2.cmml">φ</mi><mo id="S3.SS1.p2.22.m9.1.1.1" xref="S3.SS1.p2.22.m9.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.22.m9.1.1.3" xref="S3.SS1.p2.22.m9.1.1.3.cmml"><mfrac id="S3.SS1.p2.22.m9.1.1.3.2" xref="S3.SS1.p2.22.m9.1.1.3.2.cmml"><mn id="S3.SS1.p2.22.m9.1.1.3.2.2" xref="S3.SS1.p2.22.m9.1.1.3.2.2.cmml">1</mn><mrow id="S3.SS1.p2.22.m9.1.1.3.2.3" xref="S3.SS1.p2.22.m9.1.1.3.2.3.cmml"><mstyle displaystyle="false" id="S3.SS1.p2.22.m9.1.1.3.2.3.1" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.cmml"><msubsup id="S3.SS1.p2.22.m9.1.1.3.2.3.1a" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.cmml"><mo id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.2" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.cmml"><mi id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.2" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.2.cmml">i</mi><mo id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.1" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.3" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.22.m9.1.1.3.2.3.1.3" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.3.cmml">K</mi></msubsup></mstyle><msub id="S3.SS1.p2.22.m9.1.1.3.2.3.2" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2.cmml"><mi id="S3.SS1.p2.22.m9.1.1.3.2.3.2.2" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2.2.cmml">n</mi><mi id="S3.SS1.p2.22.m9.1.1.3.2.3.2.3" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2.3.cmml">k</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p2.22.m9.1.1.3.1" xref="S3.SS1.p2.22.m9.1.1.3.1.cmml">​</mo><mrow id="S3.SS1.p2.22.m9.1.1.3.3" xref="S3.SS1.p2.22.m9.1.1.3.3.cmml"><msub id="S3.SS1.p2.22.m9.1.1.3.3.1" xref="S3.SS1.p2.22.m9.1.1.3.3.1.cmml"><mo id="S3.SS1.p2.22.m9.1.1.3.3.1.2" xref="S3.SS1.p2.22.m9.1.1.3.3.1.2.cmml">∑</mo><mrow id="S3.SS1.p2.22.m9.1.1.3.3.1.3" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.cmml"><mi id="S3.SS1.p2.22.m9.1.1.3.3.1.3.2" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.2.cmml">k</mi><mo id="S3.SS1.p2.22.m9.1.1.3.3.1.3.1" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.1.cmml">∈</mo><mi id="S3.SS1.p2.22.m9.1.1.3.3.1.3.3" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.3.cmml">K</mi></mrow></msub><mrow id="S3.SS1.p2.22.m9.1.1.3.3.2" xref="S3.SS1.p2.22.m9.1.1.3.3.2.cmml"><msub id="S3.SS1.p2.22.m9.1.1.3.3.2.2" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2.cmml"><mi id="S3.SS1.p2.22.m9.1.1.3.3.2.2.2" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2.2.cmml">n</mi><mi id="S3.SS1.p2.22.m9.1.1.3.3.2.2.3" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.22.m9.1.1.3.3.2.1" xref="S3.SS1.p2.22.m9.1.1.3.3.2.1.cmml">​</mo><msub id="S3.SS1.p2.22.m9.1.1.3.3.2.3" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3.cmml"><mi id="S3.SS1.p2.22.m9.1.1.3.3.2.3.2" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3.2.cmml">φ</mi><mi id="S3.SS1.p2.22.m9.1.1.3.3.2.3.3" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.22.m9.1b"><apply id="S3.SS1.p2.22.m9.1.1.cmml" xref="S3.SS1.p2.22.m9.1.1"><eq id="S3.SS1.p2.22.m9.1.1.1.cmml" xref="S3.SS1.p2.22.m9.1.1.1"></eq><ci id="S3.SS1.p2.22.m9.1.1.2.cmml" xref="S3.SS1.p2.22.m9.1.1.2">𝜑</ci><apply id="S3.SS1.p2.22.m9.1.1.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3"><times id="S3.SS1.p2.22.m9.1.1.3.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.1"></times><apply id="S3.SS1.p2.22.m9.1.1.3.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2"><divide id="S3.SS1.p2.22.m9.1.1.3.2.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2"></divide><cn type="integer" id="S3.SS1.p2.22.m9.1.1.3.2.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.2">1</cn><apply id="S3.SS1.p2.22.m9.1.1.3.2.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3"><apply id="S3.SS1.p2.22.m9.1.1.3.2.3.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m9.1.1.3.2.3.1.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1">superscript</csymbol><apply id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1">subscript</csymbol><sum id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.2"></sum><apply id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3"><eq id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.1"></eq><ci id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.22.m9.1.1.3.2.3.1.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.1.3">𝐾</ci></apply><apply id="S3.SS1.p2.22.m9.1.1.3.2.3.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m9.1.1.3.2.3.2.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2">subscript</csymbol><ci id="S3.SS1.p2.22.m9.1.1.3.2.3.2.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2.2">𝑛</ci><ci id="S3.SS1.p2.22.m9.1.1.3.2.3.2.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.2.3.2.3">𝑘</ci></apply></apply></apply><apply id="S3.SS1.p2.22.m9.1.1.3.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3"><apply id="S3.SS1.p2.22.m9.1.1.3.3.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m9.1.1.3.3.1.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1">subscript</csymbol><sum id="S3.SS1.p2.22.m9.1.1.3.3.1.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1.2"></sum><apply id="S3.SS1.p2.22.m9.1.1.3.3.1.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3"><in id="S3.SS1.p2.22.m9.1.1.3.3.1.3.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.1"></in><ci id="S3.SS1.p2.22.m9.1.1.3.3.1.3.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.2">𝑘</ci><ci id="S3.SS1.p2.22.m9.1.1.3.3.1.3.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.1.3.3">𝐾</ci></apply></apply><apply id="S3.SS1.p2.22.m9.1.1.3.3.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2"><times id="S3.SS1.p2.22.m9.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.1"></times><apply id="S3.SS1.p2.22.m9.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m9.1.1.3.3.2.2.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p2.22.m9.1.1.3.3.2.2.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2.2">𝑛</ci><ci id="S3.SS1.p2.22.m9.1.1.3.3.2.2.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.22.m9.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.22.m9.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3">subscript</csymbol><ci id="S3.SS1.p2.22.m9.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3.2">𝜑</ci><ci id="S3.SS1.p2.22.m9.1.1.3.3.2.3.3.cmml" xref="S3.SS1.p2.22.m9.1.1.3.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.22.m9.1c">\varphi=\frac{1}{\sum_{i=1}^{K}n_{k}}\sum_{k\in K}n_{k}\varphi_{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.8" class="ltx_p">The idea behind this approach is inspired from deep clustering with self-labelling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, i.e. the teacher and the student networks would find the equilibrium once they group images in such a way so they can be more easily recognized. This reconnects to the DNNs being natural deep image priors<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, working well for image-related tasks even if just randomly initialized. And it may intuitively match that a “bad” labelling would leave no alternative to a DNN but to overfit <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, which may be hard to imitate by the student.
Differently from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, since we have no access to data and cluster labels, we use the teacher <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="g_{\phi}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">g</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑔</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">g_{\phi}</annotation></semantics></math> to provide them locally in each client. Both <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\phi</annotation></semantics></math> and <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\varphi</annotation></semantics></math> are randomly initialized and <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\phi</annotation></semantics></math> is fixed during training. After <math id="S3.SS1.p3.5.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">T</annotation></semantics></math> rounds, with <math id="S3.SS1.p3.6.m6.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p3.6.m6.1a"><mi id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">T</annotation></semantics></math> being a hyperparameter, the parameters <math id="S3.SS1.p3.7.m7.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">\phi</annotation></semantics></math> of the teacher are updated with the current student ones <math id="S3.SS1.p3.8.m8.1" class="ltx_Math" alttext="\varphi" display="inline"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">φ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝜑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">\varphi</annotation></semantics></math>, iteratively.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.3" class="ltx_p">Note that, unlike previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>, our clustering algorithm can assign unseen data to clusters at test time, thanks to the domain classifier. In particular, the cluster assignment of a test image <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">x</annotation></semantics></math> corresponds to the domain probabilities given by the student <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="g_{\varphi}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msub id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">g</mi><mi id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑔</ci><ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">g_{\varphi}</annotation></semantics></math>. Since <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="g_{\varphi}(x)" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mrow id="S3.SS1.p4.3.m3.1.2" xref="S3.SS1.p4.3.m3.1.2.cmml"><msub id="S3.SS1.p4.3.m3.1.2.2" xref="S3.SS1.p4.3.m3.1.2.2.cmml"><mi id="S3.SS1.p4.3.m3.1.2.2.2" xref="S3.SS1.p4.3.m3.1.2.2.2.cmml">g</mi><mi id="S3.SS1.p4.3.m3.1.2.2.3" xref="S3.SS1.p4.3.m3.1.2.2.3.cmml">φ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p4.3.m3.1.2.1" xref="S3.SS1.p4.3.m3.1.2.1.cmml">​</mo><mrow id="S3.SS1.p4.3.m3.1.2.3.2" xref="S3.SS1.p4.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.3.m3.1.2.3.2.1" xref="S3.SS1.p4.3.m3.1.2.cmml">(</mo><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p4.3.m3.1.2.3.2.2" xref="S3.SS1.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.2.cmml" xref="S3.SS1.p4.3.m3.1.2"><times id="S3.SS1.p4.3.m3.1.2.1.cmml" xref="S3.SS1.p4.3.m3.1.2.1"></times><apply id="S3.SS1.p4.3.m3.1.2.2.cmml" xref="S3.SS1.p4.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.2.2.1.cmml" xref="S3.SS1.p4.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS1.p4.3.m3.1.2.2.2.cmml" xref="S3.SS1.p4.3.m3.1.2.2.2">𝑔</ci><ci id="S3.SS1.p4.3.m3.1.2.2.3.cmml" xref="S3.SS1.p4.3.m3.1.2.2.3">𝜑</ci></apply><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">g_{\varphi}(x)</annotation></semantics></math> is soft, we can accommodate for data belonging to unseen domains by a combination of existing ones. Additionally, in our formulation, one client’s data samples may belong to multiple clusters, considering the more general case where each client may contain more than one data distribution.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Cluster-specific Models</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.18" class="ltx_p">Since our model can identify data clusters through the previously described procedure, we can design a way to specialize the function <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑓</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">f_{\theta}</annotation></semantics></math> to each domain. Inspired by multi-domain learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, we can achieve this with domain-specific components. For simplicity, let us consider the parameters <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\theta</annotation></semantics></math> to be split into two sets, <span id="S3.SS2.p1.18.1" class="ltx_ERROR undefined">\ie</span><math id="S3.SS2.p1.3.m3.2" class="ltx_Math" alttext="\theta=\{\theta_{a},\theta_{s}\}" display="inline"><semantics id="S3.SS2.p1.3.m3.2a"><mrow id="S3.SS2.p1.3.m3.2.2" xref="S3.SS2.p1.3.m3.2.2.cmml"><mi id="S3.SS2.p1.3.m3.2.2.4" xref="S3.SS2.p1.3.m3.2.2.4.cmml">θ</mi><mo id="S3.SS2.p1.3.m3.2.2.3" xref="S3.SS2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS2.p1.3.m3.2.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m3.2.2.2.2.3" xref="S3.SS2.p1.3.m3.2.2.2.3.cmml">{</mo><msub id="S3.SS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml">a</mi></msub><mo id="S3.SS2.p1.3.m3.2.2.2.2.4" xref="S3.SS2.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p1.3.m3.2.2.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS2.p1.3.m3.2.2.2.2.2.2" xref="S3.SS2.p1.3.m3.2.2.2.2.2.2.cmml">θ</mi><mi id="S3.SS2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS2.p1.3.m3.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS2.p1.3.m3.2.2.2.2.5" xref="S3.SS2.p1.3.m3.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.2b"><apply id="S3.SS2.p1.3.m3.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2"><eq id="S3.SS2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.3"></eq><ci id="S3.SS2.p1.3.m3.2.2.4.cmml" xref="S3.SS2.p1.3.m3.2.2.4">𝜃</ci><set id="S3.SS2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2"><apply id="S3.SS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.2">𝜃</ci><ci id="S3.SS2.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.1.1.1.3">𝑎</ci></apply><apply id="S3.SS2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.p1.3.m3.2.2.2.2.2.3">𝑠</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.2c">\theta=\{\theta_{a},\theta_{s}\}</annotation></semantics></math> where <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\theta_{a}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝜃</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\theta_{a}</annotation></semantics></math> are the domain-agnostic parameters and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\theta_{s}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝜃</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\theta_{s}</annotation></semantics></math> the domain-specific ones. Note that <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\theta_{s}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝜃</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\theta_{s}</annotation></semantics></math> is actually a set <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\theta_{s}=\{\theta^{d}_{s}\}_{d=1}^{D}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><msub id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.3.2.cmml">θ</mi><mi id="S3.SS2.p1.7.m7.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.3.3.cmml">s</mi></msub><mo id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">=</mo><msubsup id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml"><mrow id="S3.SS2.p1.7.m7.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.2" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.cmml">s</mi><mi id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.7.m7.1.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m7.1.1.1.1.3.2" xref="S3.SS2.p1.7.m7.1.1.1.1.3.2.cmml">d</mi><mo id="S3.SS2.p1.7.m7.1.1.1.1.3.1" xref="S3.SS2.p1.7.m7.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p1.7.m7.1.1.1.1.3.3" xref="S3.SS2.p1.7.m7.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.7.m7.1.1.1.3" xref="S3.SS2.p1.7.m7.1.1.1.3.cmml">D</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><eq id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2"></eq><apply id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.3.2">𝜃</ci><ci id="S3.SS2.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3.3">𝑠</ci></apply><apply id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1">subscript</csymbol><set id="S3.SS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1"><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><ci id="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.1.1.1.3">𝑠</ci></apply></set><apply id="S3.SS2.p1.7.m7.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3"><eq id="S3.SS2.p1.7.m7.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3.1"></eq><ci id="S3.SS2.p1.7.m7.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3.2">𝑑</ci><cn type="integer" id="S3.SS2.p1.7.m7.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.7.m7.1.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\theta_{s}=\{\theta^{d}_{s}\}_{d=1}^{D}</annotation></semantics></math> where <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="\theta_{s}^{d}" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><msubsup id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">θ</mi><mi id="S3.SS2.p1.8.m8.1.1.2.3" xref="S3.SS2.p1.8.m8.1.1.2.3.cmml">s</mi><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">d</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">superscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝜃</ci><ci id="S3.SS2.p1.8.m8.1.1.2.3.cmml" xref="S3.SS2.p1.8.m8.1.1.2.3">𝑠</ci></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\theta_{s}^{d}</annotation></semantics></math> are the parameters specific to the <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">d</annotation></semantics></math>-th domain. To tailor the model to a specific domain, we can consider multiple ways to include <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="\theta_{s}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msub id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2" xref="S3.SS2.p1.10.m10.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2">𝜃</ci><ci id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">\theta_{s}</annotation></semantics></math>, such as direct influence on the agnostic parameters <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="\theta_{a}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msub id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2" xref="S3.SS2.p1.11.m11.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2">𝜃</ci><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">\theta_{a}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> or residual activations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. Here we follow the latter strategy, since the former relies on the robustness of <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="\theta_{a}" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><msub id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2">𝜃</ci><ci id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">\theta_{a}</annotation></semantics></math>, which is harder to guarantee in FL.
Let us assume <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><msub id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml"><mi id="S3.SS2.p1.13.m13.1.1.2" xref="S3.SS2.p1.13.m13.1.1.2.cmml">f</mi><mi id="S3.SS2.p1.13.m13.1.1.3" xref="S3.SS2.p1.13.m13.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><apply id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m13.1.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m13.1.1.2.cmml" xref="S3.SS2.p1.13.m13.1.1.2">𝑓</ci><ci id="S3.SS2.p1.13.m13.1.1.3.cmml" xref="S3.SS2.p1.13.m13.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">f_{\theta}</annotation></semantics></math> to be a deep neural network with a set of layers <math id="S3.SS2.p1.14.m14.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS2.p1.14.m14.1a"><mi id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.1b"><ci id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.1c">L</annotation></semantics></math>, denoting as <math id="S3.SS2.p1.15.m15.1" class="ltx_Math" alttext="f^{\ell}_{\theta}" display="inline"><semantics id="S3.SS2.p1.15.m15.1a"><msubsup id="S3.SS2.p1.15.m15.1.1" xref="S3.SS2.p1.15.m15.1.1.cmml"><mi id="S3.SS2.p1.15.m15.1.1.2.2" xref="S3.SS2.p1.15.m15.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p1.15.m15.1.1.3" xref="S3.SS2.p1.15.m15.1.1.3.cmml">θ</mi><mi mathvariant="normal" id="S3.SS2.p1.15.m15.1.1.2.3" xref="S3.SS2.p1.15.m15.1.1.2.3.cmml">ℓ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m15.1b"><apply id="S3.SS2.p1.15.m15.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.1.cmml" xref="S3.SS2.p1.15.m15.1.1">subscript</csymbol><apply id="S3.SS2.p1.15.m15.1.1.2.cmml" xref="S3.SS2.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m15.1.1.2.1.cmml" xref="S3.SS2.p1.15.m15.1.1">superscript</csymbol><ci id="S3.SS2.p1.15.m15.1.1.2.2.cmml" xref="S3.SS2.p1.15.m15.1.1.2.2">𝑓</ci><ci id="S3.SS2.p1.15.m15.1.1.2.3.cmml" xref="S3.SS2.p1.15.m15.1.1.2.3">ℓ</ci></apply><ci id="S3.SS2.p1.15.m15.1.1.3.cmml" xref="S3.SS2.p1.15.m15.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m15.1c">f^{\ell}_{\theta}</annotation></semantics></math> the function applied at layer <math id="S3.SS2.p1.16.m16.1" class="ltx_Math" alttext="\ell\in L" display="inline"><semantics id="S3.SS2.p1.16.m16.1a"><mrow id="S3.SS2.p1.16.m16.1.1" xref="S3.SS2.p1.16.m16.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.16.m16.1.1.2" xref="S3.SS2.p1.16.m16.1.1.2.cmml">ℓ</mi><mo id="S3.SS2.p1.16.m16.1.1.1" xref="S3.SS2.p1.16.m16.1.1.1.cmml">∈</mo><mi id="S3.SS2.p1.16.m16.1.1.3" xref="S3.SS2.p1.16.m16.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m16.1b"><apply id="S3.SS2.p1.16.m16.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1"><in id="S3.SS2.p1.16.m16.1.1.1.cmml" xref="S3.SS2.p1.16.m16.1.1.1"></in><ci id="S3.SS2.p1.16.m16.1.1.2.cmml" xref="S3.SS2.p1.16.m16.1.1.2">ℓ</ci><ci id="S3.SS2.p1.16.m16.1.1.3.cmml" xref="S3.SS2.p1.16.m16.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m16.1c">\ell\in L</annotation></semantics></math>. Given input from a domain and the features <math id="S3.SS2.p1.17.m17.1" class="ltx_Math" alttext="z^{\ell}" display="inline"><semantics id="S3.SS2.p1.17.m17.1a"><msup id="S3.SS2.p1.17.m17.1.1" xref="S3.SS2.p1.17.m17.1.1.cmml"><mi id="S3.SS2.p1.17.m17.1.1.2" xref="S3.SS2.p1.17.m17.1.1.2.cmml">z</mi><mi mathvariant="normal" id="S3.SS2.p1.17.m17.1.1.3" xref="S3.SS2.p1.17.m17.1.1.3.cmml">ℓ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m17.1b"><apply id="S3.SS2.p1.17.m17.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m17.1.1.1.cmml" xref="S3.SS2.p1.17.m17.1.1">superscript</csymbol><ci id="S3.SS2.p1.17.m17.1.1.2.cmml" xref="S3.SS2.p1.17.m17.1.1.2">𝑧</ci><ci id="S3.SS2.p1.17.m17.1.1.3.cmml" xref="S3.SS2.p1.17.m17.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m17.1c">z^{\ell}</annotation></semantics></math> extracted at the previous layer, the output of the <math id="S3.SS2.p1.18.m18.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS2.p1.18.m18.1a"><mi mathvariant="normal" id="S3.SS2.p1.18.m18.1.1" xref="S3.SS2.p1.18.m18.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m18.1b"><ci id="S3.SS2.p1.18.m18.1.1.cmml" xref="S3.SS2.p1.18.m18.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m18.1c">\ell</annotation></semantics></math>-th layer is:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.3" class="ltx_Math" alttext="z^{\ell}=f^{\ell}_{\theta_{a}}(z)+\lambda_{l}\sum_{d=1}^{D}w_{d}\cdot f^{\ell}_{\theta_{s}^{d}}(z)\,," display="block"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><msup id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.2.2" xref="S3.E4.m1.3.3.1.1.2.2.cmml">z</mi><mi mathvariant="normal" id="S3.E4.m1.3.3.1.1.2.3" xref="S3.E4.m1.3.3.1.1.2.3.cmml">ℓ</mi></msup><mo id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml"><mrow id="S3.E4.m1.3.3.1.1.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml"><msubsup id="S3.E4.m1.3.3.1.1.3.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.2.2.2" xref="S3.E4.m1.3.3.1.1.3.2.2.2.2.cmml">f</mi><msub id="S3.E4.m1.3.3.1.1.3.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.2.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.2.3.2.cmml">θ</mi><mi id="S3.E4.m1.3.3.1.1.3.2.2.3.3" xref="S3.E4.m1.3.3.1.1.3.2.2.3.3.cmml">a</mi></msub><mi mathvariant="normal" id="S3.E4.m1.3.3.1.1.3.2.2.2.3" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3.cmml">ℓ</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.2.1" xref="S3.E4.m1.3.3.1.1.3.2.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.2.3.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.3.2.1" xref="S3.E4.m1.3.3.1.1.3.2.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">z</mi><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.2.3.2.2" xref="S3.E4.m1.3.3.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.3.1" xref="S3.E4.m1.3.3.1.1.3.1.cmml">+</mo><mrow id="S3.E4.m1.3.3.1.1.3.3" xref="S3.E4.m1.3.3.1.1.3.3.cmml"><msub id="S3.E4.m1.3.3.1.1.3.3.2" xref="S3.E4.m1.3.3.1.1.3.3.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.2.2.cmml">λ</mi><mi id="S3.E4.m1.3.3.1.1.3.3.2.3" xref="S3.E4.m1.3.3.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.3.1" xref="S3.E4.m1.3.3.1.1.3.3.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.cmml"><munderover id="S3.E4.m1.3.3.1.1.3.3.3.1" xref="S3.E4.m1.3.3.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.3.3.1.1.3.3.3.1.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.2" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.2.cmml">d</mi><mo id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.1" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.3.3.1.1.3.3.3.1.3" xref="S3.E4.m1.3.3.1.1.3.3.3.1.3.cmml">D</mi></munderover><mrow id="S3.E4.m1.3.3.1.1.3.3.3.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.cmml"><mrow id="S3.E4.m1.3.3.1.1.3.3.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.cmml"><msub id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.2.cmml">w</mi><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.3.cmml">d</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.1" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.1.cmml">⋅</mo><msubsup id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.2.cmml">f</mi><msubsup id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.cmml"><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.3.cmml">s</mi><mi id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.3.cmml">d</mi></msubsup><mi mathvariant="normal" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.3" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.3.cmml">ℓ</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.1.1.3.3.3.2.1" xref="S3.E4.m1.3.3.1.1.3.3.3.2.1.cmml">​</mo><mrow id="S3.E4.m1.3.3.1.1.3.3.3.2.3.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3.3.3.2.3.2.1" xref="S3.E4.m1.3.3.1.1.3.3.3.2.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">z</mi><mo rspace="0.170em" stretchy="false" id="S3.E4.m1.3.3.1.1.3.3.3.2.3.2.2" xref="S3.E4.m1.3.3.1.1.3.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"></eq><apply id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.2.2">𝑧</ci><ci id="S3.E4.m1.3.3.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.2.3">ℓ</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"><plus id="S3.E4.m1.3.3.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.1"></plus><apply id="S3.E4.m1.3.3.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2"><times id="S3.E4.m1.3.3.1.1.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.1"></times><apply id="S3.E4.m1.3.3.1.1.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.2">𝑓</ci><ci id="S3.E4.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.2.3">ℓ</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3.2">𝜃</ci><ci id="S3.E4.m1.3.3.1.1.3.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.2.2.3.3">𝑎</ci></apply></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑧</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3"><times id="S3.E4.m1.3.3.1.1.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.1"></times><apply id="S3.E4.m1.3.3.1.1.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.2">𝜆</ci><ci id="S3.E4.m1.3.3.1.1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3"><apply id="S3.E4.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E4.m1.3.3.1.1.3.3.3.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.2"></sum><apply id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3"><eq id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.1"></eq><ci id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.2">𝑑</ci><cn type="integer" id="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.3.3.1.1.3.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.1.3">𝐷</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2"><times id="S3.E4.m1.3.3.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.1"></times><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2"><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.1">⋅</ci><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.2">𝑤</ci><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.2.3">𝑑</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3">subscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.2">𝑓</ci><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.2.3">ℓ</ci></apply><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3">superscript</csymbol><apply id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.1.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.2.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.2">𝜃</ci><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.2.3">𝑠</ci></apply><ci id="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.3.cmml" xref="S3.E4.m1.3.3.1.1.3.3.3.2.2.3.3.3">𝑑</ci></apply></apply></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑧</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">z^{\ell}=f^{\ell}_{\theta_{a}}(z)+\lambda_{l}\sum_{d=1}^{D}w_{d}\cdot f^{\ell}_{\theta_{s}^{d}}(z)\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.25" class="ltx_p">where <math id="S3.SS2.p1.19.m1.1" class="ltx_Math" alttext="\lambda_{l}" display="inline"><semantics id="S3.SS2.p1.19.m1.1a"><msub id="S3.SS2.p1.19.m1.1.1" xref="S3.SS2.p1.19.m1.1.1.cmml"><mi id="S3.SS2.p1.19.m1.1.1.2" xref="S3.SS2.p1.19.m1.1.1.2.cmml">λ</mi><mi id="S3.SS2.p1.19.m1.1.1.3" xref="S3.SS2.p1.19.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m1.1b"><apply id="S3.SS2.p1.19.m1.1.1.cmml" xref="S3.SS2.p1.19.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.19.m1.1.1.1.cmml" xref="S3.SS2.p1.19.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.19.m1.1.1.2.cmml" xref="S3.SS2.p1.19.m1.1.1.2">𝜆</ci><ci id="S3.SS2.p1.19.m1.1.1.3.cmml" xref="S3.SS2.p1.19.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m1.1c">\lambda_{l}</annotation></semantics></math> is a learnable parameter balancing the effect of the domain-specific components and <math id="S3.SS2.p1.20.m2.1" class="ltx_Math" alttext="w_{d}" display="inline"><semantics id="S3.SS2.p1.20.m2.1a"><msub id="S3.SS2.p1.20.m2.1.1" xref="S3.SS2.p1.20.m2.1.1.cmml"><mi id="S3.SS2.p1.20.m2.1.1.2" xref="S3.SS2.p1.20.m2.1.1.2.cmml">w</mi><mi id="S3.SS2.p1.20.m2.1.1.3" xref="S3.SS2.p1.20.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m2.1b"><apply id="S3.SS2.p1.20.m2.1.1.cmml" xref="S3.SS2.p1.20.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.20.m2.1.1.1.cmml" xref="S3.SS2.p1.20.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.20.m2.1.1.2.cmml" xref="S3.SS2.p1.20.m2.1.1.2">𝑤</ci><ci id="S3.SS2.p1.20.m2.1.1.3.cmml" xref="S3.SS2.p1.20.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m2.1c">w_{d}</annotation></semantics></math> is the weight of domain <math id="S3.SS2.p1.21.m3.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS2.p1.21.m3.1a"><mi id="S3.SS2.p1.21.m3.1.1" xref="S3.SS2.p1.21.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.21.m3.1b"><ci id="S3.SS2.p1.21.m3.1.1.cmml" xref="S3.SS2.p1.21.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.21.m3.1c">d</annotation></semantics></math>. During training, we assume data to belong to a single cluster, given by the pseudo-labels of the teacher, thus <math id="S3.SS2.p1.22.m4.1" class="ltx_Math" alttext="w_{d}" display="inline"><semantics id="S3.SS2.p1.22.m4.1a"><msub id="S3.SS2.p1.22.m4.1.1" xref="S3.SS2.p1.22.m4.1.1.cmml"><mi id="S3.SS2.p1.22.m4.1.1.2" xref="S3.SS2.p1.22.m4.1.1.2.cmml">w</mi><mi id="S3.SS2.p1.22.m4.1.1.3" xref="S3.SS2.p1.22.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.22.m4.1b"><apply id="S3.SS2.p1.22.m4.1.1.cmml" xref="S3.SS2.p1.22.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.22.m4.1.1.1.cmml" xref="S3.SS2.p1.22.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.22.m4.1.1.2.cmml" xref="S3.SS2.p1.22.m4.1.1.2">𝑤</ci><ci id="S3.SS2.p1.22.m4.1.1.3.cmml" xref="S3.SS2.p1.22.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.22.m4.1c">w_{d}</annotation></semantics></math> is 1 if <math id="S3.SS2.p1.23.m5.1" class="ltx_Math" alttext="d=\hat{d}" display="inline"><semantics id="S3.SS2.p1.23.m5.1a"><mrow id="S3.SS2.p1.23.m5.1.1" xref="S3.SS2.p1.23.m5.1.1.cmml"><mi id="S3.SS2.p1.23.m5.1.1.2" xref="S3.SS2.p1.23.m5.1.1.2.cmml">d</mi><mo id="S3.SS2.p1.23.m5.1.1.1" xref="S3.SS2.p1.23.m5.1.1.1.cmml">=</mo><mover accent="true" id="S3.SS2.p1.23.m5.1.1.3" xref="S3.SS2.p1.23.m5.1.1.3.cmml"><mi id="S3.SS2.p1.23.m5.1.1.3.2" xref="S3.SS2.p1.23.m5.1.1.3.2.cmml">d</mi><mo id="S3.SS2.p1.23.m5.1.1.3.1" xref="S3.SS2.p1.23.m5.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.23.m5.1b"><apply id="S3.SS2.p1.23.m5.1.1.cmml" xref="S3.SS2.p1.23.m5.1.1"><eq id="S3.SS2.p1.23.m5.1.1.1.cmml" xref="S3.SS2.p1.23.m5.1.1.1"></eq><ci id="S3.SS2.p1.23.m5.1.1.2.cmml" xref="S3.SS2.p1.23.m5.1.1.2">𝑑</ci><apply id="S3.SS2.p1.23.m5.1.1.3.cmml" xref="S3.SS2.p1.23.m5.1.1.3"><ci id="S3.SS2.p1.23.m5.1.1.3.1.cmml" xref="S3.SS2.p1.23.m5.1.1.3.1">^</ci><ci id="S3.SS2.p1.23.m5.1.1.3.2.cmml" xref="S3.SS2.p1.23.m5.1.1.3.2">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.23.m5.1c">d=\hat{d}</annotation></semantics></math> and 0 otherwise. At test time, we want our model to deal with data from arbitrary domains by simply combining residuals of seen ones. Thus we set <math id="S3.SS2.p1.24.m6.1" class="ltx_Math" alttext="w_{d}=g^{d}_{\varphi}(x)" display="inline"><semantics id="S3.SS2.p1.24.m6.1a"><mrow id="S3.SS2.p1.24.m6.1.2" xref="S3.SS2.p1.24.m6.1.2.cmml"><msub id="S3.SS2.p1.24.m6.1.2.2" xref="S3.SS2.p1.24.m6.1.2.2.cmml"><mi id="S3.SS2.p1.24.m6.1.2.2.2" xref="S3.SS2.p1.24.m6.1.2.2.2.cmml">w</mi><mi id="S3.SS2.p1.24.m6.1.2.2.3" xref="S3.SS2.p1.24.m6.1.2.2.3.cmml">d</mi></msub><mo id="S3.SS2.p1.24.m6.1.2.1" xref="S3.SS2.p1.24.m6.1.2.1.cmml">=</mo><mrow id="S3.SS2.p1.24.m6.1.2.3" xref="S3.SS2.p1.24.m6.1.2.3.cmml"><msubsup id="S3.SS2.p1.24.m6.1.2.3.2" xref="S3.SS2.p1.24.m6.1.2.3.2.cmml"><mi id="S3.SS2.p1.24.m6.1.2.3.2.2.2" xref="S3.SS2.p1.24.m6.1.2.3.2.2.2.cmml">g</mi><mi id="S3.SS2.p1.24.m6.1.2.3.2.3" xref="S3.SS2.p1.24.m6.1.2.3.2.3.cmml">φ</mi><mi id="S3.SS2.p1.24.m6.1.2.3.2.2.3" xref="S3.SS2.p1.24.m6.1.2.3.2.2.3.cmml">d</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.24.m6.1.2.3.1" xref="S3.SS2.p1.24.m6.1.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.24.m6.1.2.3.3.2" xref="S3.SS2.p1.24.m6.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.p1.24.m6.1.2.3.3.2.1" xref="S3.SS2.p1.24.m6.1.2.3.cmml">(</mo><mi id="S3.SS2.p1.24.m6.1.1" xref="S3.SS2.p1.24.m6.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.p1.24.m6.1.2.3.3.2.2" xref="S3.SS2.p1.24.m6.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.24.m6.1b"><apply id="S3.SS2.p1.24.m6.1.2.cmml" xref="S3.SS2.p1.24.m6.1.2"><eq id="S3.SS2.p1.24.m6.1.2.1.cmml" xref="S3.SS2.p1.24.m6.1.2.1"></eq><apply id="S3.SS2.p1.24.m6.1.2.2.cmml" xref="S3.SS2.p1.24.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.24.m6.1.2.2.1.cmml" xref="S3.SS2.p1.24.m6.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.24.m6.1.2.2.2.cmml" xref="S3.SS2.p1.24.m6.1.2.2.2">𝑤</ci><ci id="S3.SS2.p1.24.m6.1.2.2.3.cmml" xref="S3.SS2.p1.24.m6.1.2.2.3">𝑑</ci></apply><apply id="S3.SS2.p1.24.m6.1.2.3.cmml" xref="S3.SS2.p1.24.m6.1.2.3"><times id="S3.SS2.p1.24.m6.1.2.3.1.cmml" xref="S3.SS2.p1.24.m6.1.2.3.1"></times><apply id="S3.SS2.p1.24.m6.1.2.3.2.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.24.m6.1.2.3.2.1.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2">subscript</csymbol><apply id="S3.SS2.p1.24.m6.1.2.3.2.2.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.24.m6.1.2.3.2.2.1.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2">superscript</csymbol><ci id="S3.SS2.p1.24.m6.1.2.3.2.2.2.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2.2.2">𝑔</ci><ci id="S3.SS2.p1.24.m6.1.2.3.2.2.3.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2.2.3">𝑑</ci></apply><ci id="S3.SS2.p1.24.m6.1.2.3.2.3.cmml" xref="S3.SS2.p1.24.m6.1.2.3.2.3">𝜑</ci></apply><ci id="S3.SS2.p1.24.m6.1.1.cmml" xref="S3.SS2.p1.24.m6.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.24.m6.1c">w_{d}=g^{d}_{\varphi}(x)</annotation></semantics></math>, weighting the impact of each domain-specific component by the student output probabilities. Note that the formulation in Eq. (<a href="#S3.E4" title="In 3.2 Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) is general, with <math id="S3.SS2.p1.25.m7.1" class="ltx_Math" alttext="f^{\ell}_{\theta}" display="inline"><semantics id="S3.SS2.p1.25.m7.1a"><msubsup id="S3.SS2.p1.25.m7.1.1" xref="S3.SS2.p1.25.m7.1.1.cmml"><mi id="S3.SS2.p1.25.m7.1.1.2.2" xref="S3.SS2.p1.25.m7.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p1.25.m7.1.1.3" xref="S3.SS2.p1.25.m7.1.1.3.cmml">θ</mi><mi mathvariant="normal" id="S3.SS2.p1.25.m7.1.1.2.3" xref="S3.SS2.p1.25.m7.1.1.2.3.cmml">ℓ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.25.m7.1b"><apply id="S3.SS2.p1.25.m7.1.1.cmml" xref="S3.SS2.p1.25.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.25.m7.1.1.1.cmml" xref="S3.SS2.p1.25.m7.1.1">subscript</csymbol><apply id="S3.SS2.p1.25.m7.1.1.2.cmml" xref="S3.SS2.p1.25.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.25.m7.1.1.2.1.cmml" xref="S3.SS2.p1.25.m7.1.1">superscript</csymbol><ci id="S3.SS2.p1.25.m7.1.1.2.2.cmml" xref="S3.SS2.p1.25.m7.1.1.2.2">𝑓</ci><ci id="S3.SS2.p1.25.m7.1.1.2.3.cmml" xref="S3.SS2.p1.25.m7.1.1.2.3">ℓ</ci></apply><ci id="S3.SS2.p1.25.m7.1.1.3.cmml" xref="S3.SS2.p1.25.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.25.m7.1c">f^{\ell}_{\theta}</annotation></semantics></math> being any layer of a standard convolutional neural network. We explored its application to either the whole network or the last layers.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Since we are in a federated scenario, also the central domain-specific parameters must be updated without access to local data and after each round. In practice, we follow Eq. (<a href="#S3.E2" title="In Problem Formulation. ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) and we perform FedAvg on both domain-agnostic and domain-specific parameters in each training round.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2104.14628/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="162" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>FedCG framework (best seen in colors). The server sends the model <math id="S3.F2.20.m1.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.F2.20.m1.1b"><msub id="S3.F2.20.m1.1.1" xref="S3.F2.20.m1.1.1.cmml"><mi id="S3.F2.20.m1.1.1.2" xref="S3.F2.20.m1.1.1.2.cmml">f</mi><mi id="S3.F2.20.m1.1.1.3" xref="S3.F2.20.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.20.m1.1c"><apply id="S3.F2.20.m1.1.1.cmml" xref="S3.F2.20.m1.1.1"><csymbol cd="ambiguous" id="S3.F2.20.m1.1.1.1.cmml" xref="S3.F2.20.m1.1.1">subscript</csymbol><ci id="S3.F2.20.m1.1.1.2.cmml" xref="S3.F2.20.m1.1.1.2">𝑓</ci><ci id="S3.F2.20.m1.1.1.3.cmml" xref="S3.F2.20.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.20.m1.1d">f_{\theta}</annotation></semantics></math> to the clients selected for the federated round, together with the teacher <math id="S3.F2.21.m2.1" class="ltx_Math" alttext="g_{\phi}" display="inline"><semantics id="S3.F2.21.m2.1b"><msub id="S3.F2.21.m2.1.1" xref="S3.F2.21.m2.1.1.cmml"><mi id="S3.F2.21.m2.1.1.2" xref="S3.F2.21.m2.1.1.2.cmml">g</mi><mi id="S3.F2.21.m2.1.1.3" xref="S3.F2.21.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.21.m2.1c"><apply id="S3.F2.21.m2.1.1.cmml" xref="S3.F2.21.m2.1.1"><csymbol cd="ambiguous" id="S3.F2.21.m2.1.1.1.cmml" xref="S3.F2.21.m2.1.1">subscript</csymbol><ci id="S3.F2.21.m2.1.1.2.cmml" xref="S3.F2.21.m2.1.1.2">𝑔</ci><ci id="S3.F2.21.m2.1.1.3.cmml" xref="S3.F2.21.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.21.m2.1d">g_{\phi}</annotation></semantics></math> and student <math id="S3.F2.22.m3.1" class="ltx_Math" alttext="g_{\varphi}" display="inline"><semantics id="S3.F2.22.m3.1b"><msub id="S3.F2.22.m3.1.1" xref="S3.F2.22.m3.1.1.cmml"><mi id="S3.F2.22.m3.1.1.2" xref="S3.F2.22.m3.1.1.2.cmml">g</mi><mi id="S3.F2.22.m3.1.1.3" xref="S3.F2.22.m3.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.22.m3.1c"><apply id="S3.F2.22.m3.1.1.cmml" xref="S3.F2.22.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.22.m3.1.1.1.cmml" xref="S3.F2.22.m3.1.1">subscript</csymbol><ci id="S3.F2.22.m3.1.1.2.cmml" xref="S3.F2.22.m3.1.1.2">𝑔</ci><ci id="S3.F2.22.m3.1.1.3.cmml" xref="S3.F2.22.m3.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.22.m3.1d">g_{\varphi}</annotation></semantics></math> domain classifiers. On the client-side, the domain classifier clusters the local data <math id="S3.F2.23.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.F2.23.m4.1b"><mi id="S3.F2.23.m4.1.1" xref="S3.F2.23.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.F2.23.m4.1c"><ci id="S3.F2.23.m4.1.1.cmml" xref="S3.F2.23.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.23.m4.1d">x</annotation></semantics></math>, producing as output the domain of belonging <math id="S3.F2.24.m5.1" class="ltx_Math" alttext="\hat{d}" display="inline"><semantics id="S3.F2.24.m5.1b"><mover accent="true" id="S3.F2.24.m5.1.1" xref="S3.F2.24.m5.1.1.cmml"><mi id="S3.F2.24.m5.1.1.2" xref="S3.F2.24.m5.1.1.2.cmml">d</mi><mo id="S3.F2.24.m5.1.1.1" xref="S3.F2.24.m5.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.24.m5.1c"><apply id="S3.F2.24.m5.1.1.cmml" xref="S3.F2.24.m5.1.1"><ci id="S3.F2.24.m5.1.1.1.cmml" xref="S3.F2.24.m5.1.1.1">^</ci><ci id="S3.F2.24.m5.1.1.2.cmml" xref="S3.F2.24.m5.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.24.m5.1d">\hat{d}</annotation></semantics></math> of each image. At training time, the hard label <math id="S3.F2.25.m6.1" class="ltx_Math" alttext="\hat{d}" display="inline"><semantics id="S3.F2.25.m6.1b"><mover accent="true" id="S3.F2.25.m6.1.1" xref="S3.F2.25.m6.1.1.cmml"><mi id="S3.F2.25.m6.1.1.2" xref="S3.F2.25.m6.1.1.2.cmml">d</mi><mo id="S3.F2.25.m6.1.1.1" xref="S3.F2.25.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.25.m6.1c"><apply id="S3.F2.25.m6.1.1.cmml" xref="S3.F2.25.m6.1.1"><ci id="S3.F2.25.m6.1.1.1.cmml" xref="S3.F2.25.m6.1.1.1">^</ci><ci id="S3.F2.25.m6.1.1.2.cmml" xref="S3.F2.25.m6.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.25.m6.1d">\hat{d}</annotation></semantics></math> is predicted by <math id="S3.F2.26.m7.1" class="ltx_Math" alttext="g_{\phi}" display="inline"><semantics id="S3.F2.26.m7.1b"><msub id="S3.F2.26.m7.1.1" xref="S3.F2.26.m7.1.1.cmml"><mi id="S3.F2.26.m7.1.1.2" xref="S3.F2.26.m7.1.1.2.cmml">g</mi><mi id="S3.F2.26.m7.1.1.3" xref="S3.F2.26.m7.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.26.m7.1c"><apply id="S3.F2.26.m7.1.1.cmml" xref="S3.F2.26.m7.1.1"><csymbol cd="ambiguous" id="S3.F2.26.m7.1.1.1.cmml" xref="S3.F2.26.m7.1.1">subscript</csymbol><ci id="S3.F2.26.m7.1.1.2.cmml" xref="S3.F2.26.m7.1.1.2">𝑔</ci><ci id="S3.F2.26.m7.1.1.3.cmml" xref="S3.F2.26.m7.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.26.m7.1d">g_{\phi}</annotation></semantics></math> and is used as input to train <math id="S3.F2.27.m8.1" class="ltx_Math" alttext="g_{\varphi}" display="inline"><semantics id="S3.F2.27.m8.1b"><msub id="S3.F2.27.m8.1.1" xref="S3.F2.27.m8.1.1.cmml"><mi id="S3.F2.27.m8.1.1.2" xref="S3.F2.27.m8.1.1.2.cmml">g</mi><mi id="S3.F2.27.m8.1.1.3" xref="S3.F2.27.m8.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.27.m8.1c"><apply id="S3.F2.27.m8.1.1.cmml" xref="S3.F2.27.m8.1.1"><csymbol cd="ambiguous" id="S3.F2.27.m8.1.1.1.cmml" xref="S3.F2.27.m8.1.1">subscript</csymbol><ci id="S3.F2.27.m8.1.1.2.cmml" xref="S3.F2.27.m8.1.1.2">𝑔</ci><ci id="S3.F2.27.m8.1.1.3.cmml" xref="S3.F2.27.m8.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.27.m8.1d">g_{\varphi}</annotation></semantics></math> through a process based on knowledge distillation. At test time, <math id="S3.F2.28.m9.1" class="ltx_Math" alttext="\hat{d}" display="inline"><semantics id="S3.F2.28.m9.1b"><mover accent="true" id="S3.F2.28.m9.1.1" xref="S3.F2.28.m9.1.1.cmml"><mi id="S3.F2.28.m9.1.1.2" xref="S3.F2.28.m9.1.1.2.cmml">d</mi><mo id="S3.F2.28.m9.1.1.1" xref="S3.F2.28.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.28.m9.1c"><apply id="S3.F2.28.m9.1.1.cmml" xref="S3.F2.28.m9.1.1"><ci id="S3.F2.28.m9.1.1.1.cmml" xref="S3.F2.28.m9.1.1.1">^</ci><ci id="S3.F2.28.m9.1.1.2.cmml" xref="S3.F2.28.m9.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.28.m9.1d">\hat{d}</annotation></semantics></math> is given by <math id="S3.F2.29.m10.1" class="ltx_Math" alttext="g_{\varphi}" display="inline"><semantics id="S3.F2.29.m10.1b"><msub id="S3.F2.29.m10.1.1" xref="S3.F2.29.m10.1.1.cmml"><mi id="S3.F2.29.m10.1.1.2" xref="S3.F2.29.m10.1.1.2.cmml">g</mi><mi id="S3.F2.29.m10.1.1.3" xref="S3.F2.29.m10.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.29.m10.1c"><apply id="S3.F2.29.m10.1.1.cmml" xref="S3.F2.29.m10.1.1"><csymbol cd="ambiguous" id="S3.F2.29.m10.1.1.1.cmml" xref="S3.F2.29.m10.1.1">subscript</csymbol><ci id="S3.F2.29.m10.1.1.2.cmml" xref="S3.F2.29.m10.1.1.2">𝑔</ci><ci id="S3.F2.29.m10.1.1.3.cmml" xref="S3.F2.29.m10.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.29.m10.1d">g_{\varphi}</annotation></semantics></math> and is a weighted combination of the discovered domains. In FedCG, the network <math id="S3.F2.30.m11.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.F2.30.m11.1b"><msub id="S3.F2.30.m11.1.1" xref="S3.F2.30.m11.1.1.cmml"><mi id="S3.F2.30.m11.1.1.2" xref="S3.F2.30.m11.1.1.2.cmml">f</mi><mi id="S3.F2.30.m11.1.1.3" xref="S3.F2.30.m11.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.30.m11.1c"><apply id="S3.F2.30.m11.1.1.cmml" xref="S3.F2.30.m11.1.1"><csymbol cd="ambiguous" id="S3.F2.30.m11.1.1.1.cmml" xref="S3.F2.30.m11.1.1">subscript</csymbol><ci id="S3.F2.30.m11.1.1.2.cmml" xref="S3.F2.30.m11.1.1.2">𝑓</ci><ci id="S3.F2.30.m11.1.1.3.cmml" xref="S3.F2.30.m11.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.30.m11.1d">f_{\theta}</annotation></semantics></math> is made of a domain-agnostic part (in gray) and a residual domain-specific one (in blue). The domain-specific parameters are produced by the GCN, receiving as input <math id="S3.F2.31.m12.3" class="ltx_Math" alttext="\textbf{A},\textbf{W}^{\ell},\textbf{V}^{\ell}" display="inline"><semantics id="S3.F2.31.m12.3b"><mrow id="S3.F2.31.m12.3.3.2" xref="S3.F2.31.m12.3.3.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.F2.31.m12.1.1" xref="S3.F2.31.m12.1.1a.cmml">A</mtext><mo id="S3.F2.31.m12.3.3.2.3" xref="S3.F2.31.m12.3.3.3.cmml">,</mo><msup id="S3.F2.31.m12.2.2.1.1" xref="S3.F2.31.m12.2.2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.F2.31.m12.2.2.1.1.2" xref="S3.F2.31.m12.2.2.1.1.2a.cmml">W</mtext><mi mathvariant="normal" id="S3.F2.31.m12.2.2.1.1.3" xref="S3.F2.31.m12.2.2.1.1.3.cmml">ℓ</mi></msup><mo id="S3.F2.31.m12.3.3.2.4" xref="S3.F2.31.m12.3.3.3.cmml">,</mo><msup id="S3.F2.31.m12.3.3.2.2" xref="S3.F2.31.m12.3.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.F2.31.m12.3.3.2.2.2" xref="S3.F2.31.m12.3.3.2.2.2a.cmml">V</mtext><mi mathvariant="normal" id="S3.F2.31.m12.3.3.2.2.3" xref="S3.F2.31.m12.3.3.2.2.3.cmml">ℓ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.31.m12.3c"><list id="S3.F2.31.m12.3.3.3.cmml" xref="S3.F2.31.m12.3.3.2"><ci id="S3.F2.31.m12.1.1a.cmml" xref="S3.F2.31.m12.1.1"><mtext class="ltx_mathvariant_bold" id="S3.F2.31.m12.1.1.cmml" xref="S3.F2.31.m12.1.1">A</mtext></ci><apply id="S3.F2.31.m12.2.2.1.1.cmml" xref="S3.F2.31.m12.2.2.1.1"><csymbol cd="ambiguous" id="S3.F2.31.m12.2.2.1.1.1.cmml" xref="S3.F2.31.m12.2.2.1.1">superscript</csymbol><ci id="S3.F2.31.m12.2.2.1.1.2a.cmml" xref="S3.F2.31.m12.2.2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.F2.31.m12.2.2.1.1.2.cmml" xref="S3.F2.31.m12.2.2.1.1.2">W</mtext></ci><ci id="S3.F2.31.m12.2.2.1.1.3.cmml" xref="S3.F2.31.m12.2.2.1.1.3">ℓ</ci></apply><apply id="S3.F2.31.m12.3.3.2.2.cmml" xref="S3.F2.31.m12.3.3.2.2"><csymbol cd="ambiguous" id="S3.F2.31.m12.3.3.2.2.1.cmml" xref="S3.F2.31.m12.3.3.2.2">superscript</csymbol><ci id="S3.F2.31.m12.3.3.2.2.2a.cmml" xref="S3.F2.31.m12.3.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.F2.31.m12.3.3.2.2.2.cmml" xref="S3.F2.31.m12.3.3.2.2.2">V</mtext></ci><ci id="S3.F2.31.m12.3.3.2.2.3.cmml" xref="S3.F2.31.m12.3.3.2.2.3">ℓ</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.31.m12.3d">\textbf{A},\textbf{W}^{\ell},\textbf{V}^{\ell}</annotation></semantics></math> and <math id="S3.F2.32.m13.1" class="ltx_Math" alttext="\hat{d}" display="inline"><semantics id="S3.F2.32.m13.1b"><mover accent="true" id="S3.F2.32.m13.1.1" xref="S3.F2.32.m13.1.1.cmml"><mi id="S3.F2.32.m13.1.1.2" xref="S3.F2.32.m13.1.1.2.cmml">d</mi><mo id="S3.F2.32.m13.1.1.1" xref="S3.F2.32.m13.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.F2.32.m13.1c"><apply id="S3.F2.32.m13.1.1.cmml" xref="S3.F2.32.m13.1.1"><ci id="S3.F2.32.m13.1.1.1.cmml" xref="S3.F2.32.m13.1.1.1">^</ci><ci id="S3.F2.32.m13.1.1.2.cmml" xref="S3.F2.32.m13.1.1.2">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.32.m13.1d">\hat{d}</annotation></semantics></math>. After training both <math id="S3.F2.33.m14.1" class="ltx_Math" alttext="f_{\theta}" display="inline"><semantics id="S3.F2.33.m14.1b"><msub id="S3.F2.33.m14.1.1" xref="S3.F2.33.m14.1.1.cmml"><mi id="S3.F2.33.m14.1.1.2" xref="S3.F2.33.m14.1.1.2.cmml">f</mi><mi id="S3.F2.33.m14.1.1.3" xref="S3.F2.33.m14.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.33.m14.1c"><apply id="S3.F2.33.m14.1.1.cmml" xref="S3.F2.33.m14.1.1"><csymbol cd="ambiguous" id="S3.F2.33.m14.1.1.1.cmml" xref="S3.F2.33.m14.1.1">subscript</csymbol><ci id="S3.F2.33.m14.1.1.2.cmml" xref="S3.F2.33.m14.1.1.2">𝑓</ci><ci id="S3.F2.33.m14.1.1.3.cmml" xref="S3.F2.33.m14.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.33.m14.1d">f_{\theta}</annotation></semantics></math> and <math id="S3.F2.34.m15.1" class="ltx_Math" alttext="g_{\varphi}" display="inline"><semantics id="S3.F2.34.m15.1b"><msub id="S3.F2.34.m15.1.1" xref="S3.F2.34.m15.1.1.cmml"><mi id="S3.F2.34.m15.1.1.2" xref="S3.F2.34.m15.1.1.2.cmml">g</mi><mi id="S3.F2.34.m15.1.1.3" xref="S3.F2.34.m15.1.1.3.cmml">φ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.34.m15.1c"><apply id="S3.F2.34.m15.1.1.cmml" xref="S3.F2.34.m15.1.1"><csymbol cd="ambiguous" id="S3.F2.34.m15.1.1.1.cmml" xref="S3.F2.34.m15.1.1">subscript</csymbol><ci id="S3.F2.34.m15.1.1.2.cmml" xref="S3.F2.34.m15.1.1.2">𝑔</ci><ci id="S3.F2.34.m15.1.1.3.cmml" xref="S3.F2.34.m15.1.1.3">𝜑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.34.m15.1d">g_{\varphi}</annotation></semantics></math> on its data, the client <math id="S3.F2.35.m16.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.F2.35.m16.1b"><mi id="S3.F2.35.m16.1.1" xref="S3.F2.35.m16.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.F2.35.m16.1c"><ci id="S3.F2.35.m16.1.1.cmml" xref="S3.F2.35.m16.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.35.m16.1d">k</annotation></semantics></math> sends back to the server the updated weights <math id="S3.F2.36.m17.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S3.F2.36.m17.1b"><msub id="S3.F2.36.m17.1.1" xref="S3.F2.36.m17.1.1.cmml"><mi id="S3.F2.36.m17.1.1.2" xref="S3.F2.36.m17.1.1.2.cmml">θ</mi><mi id="S3.F2.36.m17.1.1.3" xref="S3.F2.36.m17.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.36.m17.1c"><apply id="S3.F2.36.m17.1.1.cmml" xref="S3.F2.36.m17.1.1"><csymbol cd="ambiguous" id="S3.F2.36.m17.1.1.1.cmml" xref="S3.F2.36.m17.1.1">subscript</csymbol><ci id="S3.F2.36.m17.1.1.2.cmml" xref="S3.F2.36.m17.1.1.2">𝜃</ci><ci id="S3.F2.36.m17.1.1.3.cmml" xref="S3.F2.36.m17.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.36.m17.1d">\theta_{k}</annotation></semantics></math> and <math id="S3.F2.37.m18.1" class="ltx_Math" alttext="\varphi_{k}" display="inline"><semantics id="S3.F2.37.m18.1b"><msub id="S3.F2.37.m18.1.1" xref="S3.F2.37.m18.1.1.cmml"><mi id="S3.F2.37.m18.1.1.2" xref="S3.F2.37.m18.1.1.2.cmml">φ</mi><mi id="S3.F2.37.m18.1.1.3" xref="S3.F2.37.m18.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.37.m18.1c"><apply id="S3.F2.37.m18.1.1.cmml" xref="S3.F2.37.m18.1.1"><csymbol cd="ambiguous" id="S3.F2.37.m18.1.1.1.cmml" xref="S3.F2.37.m18.1.1">subscript</csymbol><ci id="S3.F2.37.m18.1.1.2.cmml" xref="S3.F2.37.m18.1.1.2">𝜑</ci><ci id="S3.F2.37.m18.1.1.3.cmml" xref="S3.F2.37.m18.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.37.m18.1d">\varphi_{k}</annotation></semantics></math>. On the server-side, the updates are aggregated by the means of the FedAvg algorithm.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Connecting Cluster-specific Models</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.7" class="ltx_p">We now have a model that can adapt to the specificity of each domain. Here we propose to refine the domain-specific parameters by making them interact.
Specifically, we model the interaction of the domain-specific parameters of each layer <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\ell</annotation></semantics></math> via a graph <math id="S3.SS3.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{G}^{\ell}=(\mathcal{V}^{\ell},\mathcal{E}^{\ell})" display="inline"><semantics id="S3.SS3.p1.2.m2.2a"><mrow id="S3.SS3.p1.2.m2.2.2" xref="S3.SS3.p1.2.m2.2.2.cmml"><msup id="S3.SS3.p1.2.m2.2.2.4" xref="S3.SS3.p1.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.2.2.4.2" xref="S3.SS3.p1.2.m2.2.2.4.2.cmml">𝒢</mi><mi mathvariant="normal" id="S3.SS3.p1.2.m2.2.2.4.3" xref="S3.SS3.p1.2.m2.2.2.4.3.cmml">ℓ</mi></msup><mo id="S3.SS3.p1.2.m2.2.2.3" xref="S3.SS3.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS3.p1.2.m2.2.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.2.2.2.2.3" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml">(</mo><msup id="S3.SS3.p1.2.m2.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml">𝒱</mi><mi mathvariant="normal" id="S3.SS3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml">ℓ</mi></msup><mo id="S3.SS3.p1.2.m2.2.2.2.2.4" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml">,</mo><msup id="S3.SS3.p1.2.m2.2.2.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.2.2.2.2.2.2" xref="S3.SS3.p1.2.m2.2.2.2.2.2.2.cmml">ℰ</mi><mi mathvariant="normal" id="S3.SS3.p1.2.m2.2.2.2.2.2.3" xref="S3.SS3.p1.2.m2.2.2.2.2.2.3.cmml">ℓ</mi></msup><mo stretchy="false" id="S3.SS3.p1.2.m2.2.2.2.2.5" xref="S3.SS3.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.2b"><apply id="S3.SS3.p1.2.m2.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2"><eq id="S3.SS3.p1.2.m2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.2.2.3"></eq><apply id="S3.SS3.p1.2.m2.2.2.4.cmml" xref="S3.SS3.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.2.4.1.cmml" xref="S3.SS3.p1.2.m2.2.2.4">superscript</csymbol><ci id="S3.SS3.p1.2.m2.2.2.4.2.cmml" xref="S3.SS3.p1.2.m2.2.2.4.2">𝒢</ci><ci id="S3.SS3.p1.2.m2.2.2.4.3.cmml" xref="S3.SS3.p1.2.m2.2.2.4.3">ℓ</ci></apply><interval closure="open" id="S3.SS3.p1.2.m2.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2"><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2">𝒱</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3">ℓ</ci></apply><apply id="S3.SS3.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.2.2">ℰ</ci><ci id="S3.SS3.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.p1.2.m2.2.2.2.2.2.3">ℓ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.2c">\mathcal{G}^{\ell}=(\mathcal{V}^{\ell},\mathcal{E}^{\ell})</annotation></semantics></math>, where the nodes <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="i\in\mathcal{V}^{\ell}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">i</mi><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">𝒱</mi><mi mathvariant="normal" id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">ℓ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><in id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></in><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑖</ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">𝒱</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">ℓ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">i\in\mathcal{V}^{\ell}</annotation></semantics></math> are the set of all domain-specific parameters at layer <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi mathvariant="normal" id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\ell</annotation></semantics></math>, and <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="e_{ij}\in\mathcal{E}^{\ell}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><msub id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2.2" xref="S3.SS3.p1.5.m5.1.1.2.2.cmml">e</mi><mrow id="S3.SS3.p1.5.m5.1.1.2.3" xref="S3.SS3.p1.5.m5.1.1.2.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2.3.2" xref="S3.SS3.p1.5.m5.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.1.1.2.3.1" xref="S3.SS3.p1.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.5.m5.1.1.2.3.3" xref="S3.SS3.p1.5.m5.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.SS3.p1.5.m5.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.1.1.3.2" xref="S3.SS3.p1.5.m5.1.1.3.2.cmml">ℰ</mi><mi mathvariant="normal" id="S3.SS3.p1.5.m5.1.1.3.3" xref="S3.SS3.p1.5.m5.1.1.3.3.cmml">ℓ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><in id="S3.SS3.p1.5.m5.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1"></in><apply id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2.2">𝑒</ci><apply id="S3.SS3.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3"><times id="S3.SS3.p1.5.m5.1.1.2.3.1.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3.1"></times><ci id="S3.SS3.p1.5.m5.1.1.2.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p1.5.m5.1.1.2.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.3.2">ℰ</ci><ci id="S3.SS3.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3.3">ℓ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">e_{ij}\in\mathcal{E}^{\ell}</annotation></semantics></math> are the edges connecting two domain nodes <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">i</annotation></semantics></math> and <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">j</annotation></semantics></math> which may interact together. This addresses the drawback of our formulation in Sec. <a href="#S3.SS2" title="3.2 Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, <span id="S3.SS3.p1.7.1" class="ltx_ERROR undefined">\ie</span>if a domain has few assigned samples, its parameters will be rarely updated and thus not robust enough to capture the specificity of the domain and generalize to unseen samples of the same domain.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.6" class="ltx_p">We propose to use a GCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> to model the interaction of domain-specific parameters. 
Let us collect in the matrix <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{V}^{\ell}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝐕</mi><mi mathvariant="normal" id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">ℓ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝐕</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathbf{V}^{\ell}</annotation></semantics></math> the value of each node, <span id="S3.SS3.p2.6.1" class="ltx_ERROR undefined">\ie</span>all domain-specific parameters at layer <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi mathvariant="normal" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\ell</annotation></semantics></math>: <math id="S3.SS3.p2.3.m3.3" class="ltx_Math" alttext="\mathbf{V}^{\ell}=[\theta^{1}_{s|l},\dots,\theta^{D}_{s|l}]^{\intercal}\in{\rm I\!R}^{D\times q}" display="inline"><semantics id="S3.SS3.p2.3.m3.3a"><mrow id="S3.SS3.p2.3.m3.3.3" xref="S3.SS3.p2.3.m3.3.3.cmml"><msup id="S3.SS3.p2.3.m3.3.3.4" xref="S3.SS3.p2.3.m3.3.3.4.cmml"><mi id="S3.SS3.p2.3.m3.3.3.4.2" xref="S3.SS3.p2.3.m3.3.3.4.2.cmml">𝐕</mi><mi mathvariant="normal" id="S3.SS3.p2.3.m3.3.3.4.3" xref="S3.SS3.p2.3.m3.3.3.4.3.cmml">ℓ</mi></msup><mo id="S3.SS3.p2.3.m3.3.3.5" xref="S3.SS3.p2.3.m3.3.3.5.cmml">=</mo><msup id="S3.SS3.p2.3.m3.3.3.2" xref="S3.SS3.p2.3.m3.3.3.2.cmml"><mrow id="S3.SS3.p2.3.m3.3.3.2.2.2" xref="S3.SS3.p2.3.m3.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.3.m3.3.3.2.2.2.3" xref="S3.SS3.p2.3.m3.3.3.2.2.3.cmml">[</mo><msubsup id="S3.SS3.p2.3.m3.2.2.1.1.1.1" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.2" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.2" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.2.cmml">s</mi><mo fence="false" id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.1" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.1.cmml">|</mo><mi id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.3" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.3.cmml">l</mi></mrow><mn id="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.3" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.SS3.p2.3.m3.3.3.2.2.2.4" xref="S3.SS3.p2.3.m3.3.3.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.p2.3.m3.3.3.2.2.2.5" xref="S3.SS3.p2.3.m3.3.3.2.2.3.cmml">,</mo><msubsup id="S3.SS3.p2.3.m3.3.3.2.2.2.2" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.cmml"><mi id="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.2" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.2.cmml">θ</mi><mrow id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.cmml"><mi id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.2" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.2.cmml">s</mi><mo fence="false" id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.1" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.1.cmml">|</mo><mi id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.3" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.3.cmml">l</mi></mrow><mi id="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.3" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.3.cmml">D</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.3.m3.3.3.2.2.2.6" xref="S3.SS3.p2.3.m3.3.3.2.2.3.cmml">]</mo></mrow><mo id="S3.SS3.p2.3.m3.3.3.2.4" xref="S3.SS3.p2.3.m3.3.3.2.4.cmml">⊺</mo></msup><mo id="S3.SS3.p2.3.m3.3.3.6" xref="S3.SS3.p2.3.m3.3.3.6.cmml">∈</mo><mrow id="S3.SS3.p2.3.m3.3.3.7" xref="S3.SS3.p2.3.m3.3.3.7.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S3.SS3.p2.3.m3.3.3.7.2" xref="S3.SS3.p2.3.m3.3.3.7.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.3.3.7.1" xref="S3.SS3.p2.3.m3.3.3.7.1.cmml">​</mo><msup id="S3.SS3.p2.3.m3.3.3.7.3" xref="S3.SS3.p2.3.m3.3.3.7.3.cmml"><mi mathvariant="normal" id="S3.SS3.p2.3.m3.3.3.7.3.2" xref="S3.SS3.p2.3.m3.3.3.7.3.2.cmml">R</mi><mrow id="S3.SS3.p2.3.m3.3.3.7.3.3" xref="S3.SS3.p2.3.m3.3.3.7.3.3.cmml"><mi id="S3.SS3.p2.3.m3.3.3.7.3.3.2" xref="S3.SS3.p2.3.m3.3.3.7.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.3.m3.3.3.7.3.3.1" xref="S3.SS3.p2.3.m3.3.3.7.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.3.m3.3.3.7.3.3.3" xref="S3.SS3.p2.3.m3.3.3.7.3.3.3.cmml">q</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.3b"><apply id="S3.SS3.p2.3.m3.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3"><and id="S3.SS3.p2.3.m3.3.3a.cmml" xref="S3.SS3.p2.3.m3.3.3"></and><apply id="S3.SS3.p2.3.m3.3.3b.cmml" xref="S3.SS3.p2.3.m3.3.3"><eq id="S3.SS3.p2.3.m3.3.3.5.cmml" xref="S3.SS3.p2.3.m3.3.3.5"></eq><apply id="S3.SS3.p2.3.m3.3.3.4.cmml" xref="S3.SS3.p2.3.m3.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.4.1.cmml" xref="S3.SS3.p2.3.m3.3.3.4">superscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.4.2.cmml" xref="S3.SS3.p2.3.m3.3.3.4.2">𝐕</ci><ci id="S3.SS3.p2.3.m3.3.3.4.3.cmml" xref="S3.SS3.p2.3.m3.3.3.4.3">ℓ</ci></apply><apply id="S3.SS3.p2.3.m3.3.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2">superscript</csymbol><list id="S3.SS3.p2.3.m3.3.3.2.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2"><apply id="S3.SS3.p2.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.2">𝜃</ci><cn type="integer" id="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.2.3">1</cn></apply><apply id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.1">conditional</csymbol><ci id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.2.2.1.1.1.1.3.3">𝑙</ci></apply></apply><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">…</ci><apply id="S3.SS3.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.2.2.2.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2">subscript</csymbol><apply id="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.2">𝜃</ci><ci id="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.2.3">𝐷</ci></apply><apply id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.1">conditional</csymbol><ci id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.2">𝑠</ci><ci id="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.2.2.2.2.3.3">𝑙</ci></apply></apply></list><ci id="S3.SS3.p2.3.m3.3.3.2.4.cmml" xref="S3.SS3.p2.3.m3.3.3.2.4">⊺</ci></apply></apply><apply id="S3.SS3.p2.3.m3.3.3c.cmml" xref="S3.SS3.p2.3.m3.3.3"><in id="S3.SS3.p2.3.m3.3.3.6.cmml" xref="S3.SS3.p2.3.m3.3.3.6"></in><share href="#S3.SS3.p2.3.m3.3.3.2.cmml" id="S3.SS3.p2.3.m3.3.3d.cmml" xref="S3.SS3.p2.3.m3.3.3"></share><apply id="S3.SS3.p2.3.m3.3.3.7.cmml" xref="S3.SS3.p2.3.m3.3.3.7"><times id="S3.SS3.p2.3.m3.3.3.7.1.cmml" xref="S3.SS3.p2.3.m3.3.3.7.1"></times><ci id="S3.SS3.p2.3.m3.3.3.7.2.cmml" xref="S3.SS3.p2.3.m3.3.3.7.2">I</ci><apply id="S3.SS3.p2.3.m3.3.3.7.3.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.3.3.7.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3">superscript</csymbol><ci id="S3.SS3.p2.3.m3.3.3.7.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3.2">R</ci><apply id="S3.SS3.p2.3.m3.3.3.7.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3.3"><times id="S3.SS3.p2.3.m3.3.3.7.3.3.1.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3.3.1"></times><ci id="S3.SS3.p2.3.m3.3.3.7.3.3.2.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3.3.2">𝐷</ci><ci id="S3.SS3.p2.3.m3.3.3.7.3.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3.7.3.3.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.3c">\mathbf{V}^{\ell}=[\theta^{1}_{s|l},\dots,\theta^{D}_{s|l}]^{\intercal}\in{\rm I\!R}^{D\times q}</annotation></semantics></math>, with <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="q=|\theta^{d}_{s|l}|" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">q</mi><mo id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS3.p2.4.m4.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.4.m4.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.2.1.cmml">|</mo><msubsup id="S3.SS3.p2.4.m4.1.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.2.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.SS3.p2.4.m4.1.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.2.cmml">s</mi><mo fence="false" id="S3.SS3.p2.4.m4.1.1.1.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.3.cmml">l</mi></mrow><mi id="S3.SS3.p2.4.m4.1.1.1.1.1.2.3" xref="S3.SS3.p2.4.m4.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.4.m4.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><eq id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2"></eq><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑞</ci><apply id="S3.SS3.p2.4.m4.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1"><abs id="S3.SS3.p2.4.m4.1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.2"></abs><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.2.2">𝜃</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="S3.SS3.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.SS3.p2.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">q=|\theta^{d}_{s|l}|</annotation></semantics></math> the number of parameters per domain. We compute the graph-version <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\hat{\mathbf{V}}^{\ell}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msup id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mover accent="true" id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2.2" xref="S3.SS3.p2.5.m5.1.1.2.2.cmml">𝐕</mi><mo id="S3.SS3.p2.5.m5.1.1.2.1" xref="S3.SS3.p2.5.m5.1.1.2.1.cmml">^</mo></mover><mi mathvariant="normal" id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">ℓ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">superscript</csymbol><apply id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2"><ci id="S3.SS3.p2.5.m5.1.1.2.1.cmml" xref="S3.SS3.p2.5.m5.1.1.2.1">^</ci><ci id="S3.SS3.p2.5.m5.1.1.2.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2.2">𝐕</ci></apply><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\hat{\mathbf{V}}^{\ell}</annotation></semantics></math> of the domain-specific parameters <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{V}^{\ell}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msup id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">𝐕</mi><mi mathvariant="normal" id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">ℓ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝐕</ci><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\mathbf{V}^{\ell}</annotation></semantics></math> as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\hat{\mathbf{V}}^{\ell}=\sigma({\mathbf{A}}\,\,{\mathbf{V}}^{\ell}\,\,\mathbf{W}^{\ell})\,," display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msup id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml">𝐕</mi><mo id="S3.E5.m1.1.1.1.1.3.2.1" xref="S3.E5.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml">ℓ</mi></msup><mo id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml">𝐀</mi><mo lspace="0.330em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐕</mi><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml">ℓ</mi></msup><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.1.1.1a" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.E5.m1.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝐖</mi><mi mathvariant="normal" id="S3.E5.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4.3.cmml">ℓ</mi></msup></mrow><mo rspace="0.170em" stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></eq><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><ci id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">𝐕</ci></apply><ci id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3">ℓ</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2">𝐀</ci><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.2">𝐕</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.3">ℓ</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4.2">𝐖</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.4.3">ℓ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\hat{\mathbf{V}}^{\ell}=\sigma({\mathbf{A}}\,\,{\mathbf{V}}^{\ell}\,\,\mathbf{W}^{\ell})\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.14" class="ltx_p">where <math id="S3.SS3.p2.7.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS3.p2.7.m1.1a"><mi id="S3.SS3.p2.7.m1.1.1" xref="S3.SS3.p2.7.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m1.1b"><ci id="S3.SS3.p2.7.m1.1.1.cmml" xref="S3.SS3.p2.7.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m1.1c">\sigma</annotation></semantics></math> is an activation function (<span id="S3.SS3.p2.14.1" class="ltx_ERROR undefined">\eg</span>ReLU), <math id="S3.SS3.p2.8.m2.1" class="ltx_Math" alttext="\mathbf{A}\in{\rm I\!R}^{D\times D}" display="inline"><semantics id="S3.SS3.p2.8.m2.1a"><mrow id="S3.SS3.p2.8.m2.1.1" xref="S3.SS3.p2.8.m2.1.1.cmml"><mi id="S3.SS3.p2.8.m2.1.1.2" xref="S3.SS3.p2.8.m2.1.1.2.cmml">𝐀</mi><mo id="S3.SS3.p2.8.m2.1.1.1" xref="S3.SS3.p2.8.m2.1.1.1.cmml">∈</mo><mrow id="S3.SS3.p2.8.m2.1.1.3" xref="S3.SS3.p2.8.m2.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S3.SS3.p2.8.m2.1.1.3.2" xref="S3.SS3.p2.8.m2.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m2.1.1.3.1" xref="S3.SS3.p2.8.m2.1.1.3.1.cmml">​</mo><msup id="S3.SS3.p2.8.m2.1.1.3.3" xref="S3.SS3.p2.8.m2.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.SS3.p2.8.m2.1.1.3.3.2" xref="S3.SS3.p2.8.m2.1.1.3.3.2.cmml">R</mi><mrow id="S3.SS3.p2.8.m2.1.1.3.3.3" xref="S3.SS3.p2.8.m2.1.1.3.3.3.cmml"><mi id="S3.SS3.p2.8.m2.1.1.3.3.3.2" xref="S3.SS3.p2.8.m2.1.1.3.3.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.8.m2.1.1.3.3.3.1" xref="S3.SS3.p2.8.m2.1.1.3.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.8.m2.1.1.3.3.3.3" xref="S3.SS3.p2.8.m2.1.1.3.3.3.3.cmml">D</mi></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m2.1b"><apply id="S3.SS3.p2.8.m2.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1"><in id="S3.SS3.p2.8.m2.1.1.1.cmml" xref="S3.SS3.p2.8.m2.1.1.1"></in><ci id="S3.SS3.p2.8.m2.1.1.2.cmml" xref="S3.SS3.p2.8.m2.1.1.2">𝐀</ci><apply id="S3.SS3.p2.8.m2.1.1.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3"><times id="S3.SS3.p2.8.m2.1.1.3.1.cmml" xref="S3.SS3.p2.8.m2.1.1.3.1"></times><ci id="S3.SS3.p2.8.m2.1.1.3.2.cmml" xref="S3.SS3.p2.8.m2.1.1.3.2">I</ci><apply id="S3.SS3.p2.8.m2.1.1.3.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m2.1.1.3.3.1.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3">superscript</csymbol><ci id="S3.SS3.p2.8.m2.1.1.3.3.2.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3.2">R</ci><apply id="S3.SS3.p2.8.m2.1.1.3.3.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3.3"><times id="S3.SS3.p2.8.m2.1.1.3.3.3.1.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3.3.1"></times><ci id="S3.SS3.p2.8.m2.1.1.3.3.3.2.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3.3.2">𝐷</ci><ci id="S3.SS3.p2.8.m2.1.1.3.3.3.3.cmml" xref="S3.SS3.p2.8.m2.1.1.3.3.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m2.1c">\mathbf{A}\in{\rm I\!R}^{D\times D}</annotation></semantics></math> is the adjacency matrix defined across the domains, and <math id="S3.SS3.p2.9.m3.1" class="ltx_Math" alttext="\mathbf{W}^{\ell}\in{\rm I\!R}^{q\times{q^{\prime}}}" display="inline"><semantics id="S3.SS3.p2.9.m3.1a"><mrow id="S3.SS3.p2.9.m3.1.1" xref="S3.SS3.p2.9.m3.1.1.cmml"><msup id="S3.SS3.p2.9.m3.1.1.2" xref="S3.SS3.p2.9.m3.1.1.2.cmml"><mi id="S3.SS3.p2.9.m3.1.1.2.2" xref="S3.SS3.p2.9.m3.1.1.2.2.cmml">𝐖</mi><mi mathvariant="normal" id="S3.SS3.p2.9.m3.1.1.2.3" xref="S3.SS3.p2.9.m3.1.1.2.3.cmml">ℓ</mi></msup><mo id="S3.SS3.p2.9.m3.1.1.1" xref="S3.SS3.p2.9.m3.1.1.1.cmml">∈</mo><mrow id="S3.SS3.p2.9.m3.1.1.3" xref="S3.SS3.p2.9.m3.1.1.3.cmml"><mpadded width="0.348em"><mi mathvariant="normal" id="S3.SS3.p2.9.m3.1.1.3.2" xref="S3.SS3.p2.9.m3.1.1.3.2.cmml">I</mi></mpadded><mo lspace="0em" rspace="0em" id="S3.SS3.p2.9.m3.1.1.3.1" xref="S3.SS3.p2.9.m3.1.1.3.1.cmml">​</mo><msup id="S3.SS3.p2.9.m3.1.1.3.3" xref="S3.SS3.p2.9.m3.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.SS3.p2.9.m3.1.1.3.3.2" xref="S3.SS3.p2.9.m3.1.1.3.3.2.cmml">R</mi><mrow id="S3.SS3.p2.9.m3.1.1.3.3.3" xref="S3.SS3.p2.9.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.p2.9.m3.1.1.3.3.3.2" xref="S3.SS3.p2.9.m3.1.1.3.3.3.2.cmml">q</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.9.m3.1.1.3.3.3.1" xref="S3.SS3.p2.9.m3.1.1.3.3.3.1.cmml">×</mo><msup id="S3.SS3.p2.9.m3.1.1.3.3.3.3" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3.cmml"><mi id="S3.SS3.p2.9.m3.1.1.3.3.3.3.2" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3.2.cmml">q</mi><mo id="S3.SS3.p2.9.m3.1.1.3.3.3.3.3" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3.3.cmml">′</mo></msup></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m3.1b"><apply id="S3.SS3.p2.9.m3.1.1.cmml" xref="S3.SS3.p2.9.m3.1.1"><in id="S3.SS3.p2.9.m3.1.1.1.cmml" xref="S3.SS3.p2.9.m3.1.1.1"></in><apply id="S3.SS3.p2.9.m3.1.1.2.cmml" xref="S3.SS3.p2.9.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m3.1.1.2.1.cmml" xref="S3.SS3.p2.9.m3.1.1.2">superscript</csymbol><ci id="S3.SS3.p2.9.m3.1.1.2.2.cmml" xref="S3.SS3.p2.9.m3.1.1.2.2">𝐖</ci><ci id="S3.SS3.p2.9.m3.1.1.2.3.cmml" xref="S3.SS3.p2.9.m3.1.1.2.3">ℓ</ci></apply><apply id="S3.SS3.p2.9.m3.1.1.3.cmml" xref="S3.SS3.p2.9.m3.1.1.3"><times id="S3.SS3.p2.9.m3.1.1.3.1.cmml" xref="S3.SS3.p2.9.m3.1.1.3.1"></times><ci id="S3.SS3.p2.9.m3.1.1.3.2.cmml" xref="S3.SS3.p2.9.m3.1.1.3.2">I</ci><apply id="S3.SS3.p2.9.m3.1.1.3.3.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3">superscript</csymbol><ci id="S3.SS3.p2.9.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.2">R</ci><apply id="S3.SS3.p2.9.m3.1.1.3.3.3.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3"><times id="S3.SS3.p2.9.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3.1"></times><ci id="S3.SS3.p2.9.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3.2">𝑞</ci><apply id="S3.SS3.p2.9.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m3.1.1.3.3.3.3.1.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3">superscript</csymbol><ci id="S3.SS3.p2.9.m3.1.1.3.3.3.3.2.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3.2">𝑞</ci><ci id="S3.SS3.p2.9.m3.1.1.3.3.3.3.3.cmml" xref="S3.SS3.p2.9.m3.1.1.3.3.3.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m3.1c">\mathbf{W}^{\ell}\in{\rm I\!R}^{q\times{q^{\prime}}}</annotation></semantics></math> is a weight projection matrix, projecting the domain-specific parameters into dimension <math id="S3.SS3.p2.10.m4.1" class="ltx_Math" alttext="q^{\prime}" display="inline"><semantics id="S3.SS3.p2.10.m4.1a"><msup id="S3.SS3.p2.10.m4.1.1" xref="S3.SS3.p2.10.m4.1.1.cmml"><mi id="S3.SS3.p2.10.m4.1.1.2" xref="S3.SS3.p2.10.m4.1.1.2.cmml">q</mi><mo id="S3.SS3.p2.10.m4.1.1.3" xref="S3.SS3.p2.10.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m4.1b"><apply id="S3.SS3.p2.10.m4.1.1.cmml" xref="S3.SS3.p2.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.10.m4.1.1.1.cmml" xref="S3.SS3.p2.10.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.10.m4.1.1.2.cmml" xref="S3.SS3.p2.10.m4.1.1.2">𝑞</ci><ci id="S3.SS3.p2.10.m4.1.1.3.cmml" xref="S3.SS3.p2.10.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m4.1c">q^{\prime}</annotation></semantics></math>. Here, for simplicity, we set <math id="S3.SS3.p2.11.m5.1" class="ltx_Math" alttext="q=q^{\prime}" display="inline"><semantics id="S3.SS3.p2.11.m5.1a"><mrow id="S3.SS3.p2.11.m5.1.1" xref="S3.SS3.p2.11.m5.1.1.cmml"><mi id="S3.SS3.p2.11.m5.1.1.2" xref="S3.SS3.p2.11.m5.1.1.2.cmml">q</mi><mo id="S3.SS3.p2.11.m5.1.1.1" xref="S3.SS3.p2.11.m5.1.1.1.cmml">=</mo><msup id="S3.SS3.p2.11.m5.1.1.3" xref="S3.SS3.p2.11.m5.1.1.3.cmml"><mi id="S3.SS3.p2.11.m5.1.1.3.2" xref="S3.SS3.p2.11.m5.1.1.3.2.cmml">q</mi><mo id="S3.SS3.p2.11.m5.1.1.3.3" xref="S3.SS3.p2.11.m5.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m5.1b"><apply id="S3.SS3.p2.11.m5.1.1.cmml" xref="S3.SS3.p2.11.m5.1.1"><eq id="S3.SS3.p2.11.m5.1.1.1.cmml" xref="S3.SS3.p2.11.m5.1.1.1"></eq><ci id="S3.SS3.p2.11.m5.1.1.2.cmml" xref="S3.SS3.p2.11.m5.1.1.2">𝑞</ci><apply id="S3.SS3.p2.11.m5.1.1.3.cmml" xref="S3.SS3.p2.11.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m5.1.1.3.1.cmml" xref="S3.SS3.p2.11.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.11.m5.1.1.3.2.cmml" xref="S3.SS3.p2.11.m5.1.1.3.2">𝑞</ci><ci id="S3.SS3.p2.11.m5.1.1.3.3.cmml" xref="S3.SS3.p2.11.m5.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m5.1c">q=q^{\prime}</annotation></semantics></math>. In FedCG, we replace the domain-specific parameters of Eq. (<a href="#S3.E4" title="In 3.2 Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) with the ones computed in Eq. (<a href="#S3.E5" title="In 3.3 Connecting Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). Similarly to all other parameters of the network, we update <math id="S3.SS3.p2.12.m6.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S3.SS3.p2.12.m6.1a"><mi id="S3.SS3.p2.12.m6.1.1" xref="S3.SS3.p2.12.m6.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m6.1b"><ci id="S3.SS3.p2.12.m6.1.1.cmml" xref="S3.SS3.p2.12.m6.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m6.1c">\mathbf{W}</annotation></semantics></math> in each training round through FedAvg. In case <math id="S3.SS3.p2.13.m7.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.SS3.p2.13.m7.1a"><mi id="S3.SS3.p2.13.m7.1.1" xref="S3.SS3.p2.13.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m7.1b"><ci id="S3.SS3.p2.13.m7.1.1.cmml" xref="S3.SS3.p2.13.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m7.1c">q</annotation></semantics></math> is large, we implement <math id="S3.SS3.p2.14.m8.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S3.SS3.p2.14.m8.1a"><mi id="S3.SS3.p2.14.m8.1.1" xref="S3.SS3.p2.14.m8.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m8.1b"><ci id="S3.SS3.p2.14.m8.1.1.cmml" xref="S3.SS3.p2.14.m8.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m8.1c">\mathbf{W}</annotation></semantics></math> as a multi-layer bottleneck (see implementation details).</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.3" class="ltx_p">The values in the adjacency matrix encode, for each edge, how close two domains are; since we have no priors on the structure of the graph, we model <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{G}^{\ell}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msup id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">𝒢</mi><mi mathvariant="normal" id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">ℓ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝒢</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathcal{G}^{\ell}</annotation></semantics></math> as a fully-connected weighted graph. Without direct access to the data server-side, we compute the distance among two domains directly in the (domain-specific) parameter’s space. In practice, we define the similarity <math id="S3.SS3.p3.2.m2.2" class="ltx_Math" alttext="h_{i,j}" display="inline"><semantics id="S3.SS3.p3.2.m2.2a"><msub id="S3.SS3.p3.2.m2.2.3" xref="S3.SS3.p3.2.m2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.2.3.2" xref="S3.SS3.p3.2.m2.2.3.2.cmml">h</mi><mrow id="S3.SS3.p3.2.m2.2.2.2.4" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.2.m2.2.2.2.4.1" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p3.2.m2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.2.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.2.3.2">ℎ</ci><list id="S3.SS3.p3.2.m2.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.4"><ci id="S3.SS3.p3.2.m2.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p3.2.m2.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">h_{i,j}</annotation></semantics></math> among domains <math id="S3.SS3.p3.3.m3.2" class="ltx_Math" alttext="i,j" display="inline"><semantics id="S3.SS3.p3.3.m3.2a"><mrow id="S3.SS3.p3.3.m3.2.3.2" xref="S3.SS3.p3.3.m3.2.3.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">i</mi><mo id="S3.SS3.p3.3.m3.2.3.2.1" xref="S3.SS3.p3.3.m3.2.3.1.cmml">,</mo><mi id="S3.SS3.p3.3.m3.2.2" xref="S3.SS3.p3.3.m3.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.2b"><list id="S3.SS3.p3.3.m3.2.3.1.cmml" xref="S3.SS3.p3.3.m3.2.3.2"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝑖</ci><ci id="S3.SS3.p3.3.m3.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.2c">i,j</annotation></semantics></math> as:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.4" class="ltx_Math" alttext="h_{i,j}=\frac{1}{\|\theta^{i}_{s}-\theta^{j}_{s}\|_{2}}\,," display="block"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4.4.1" xref="S3.E6.m1.4.4.1.1.cmml"><mrow id="S3.E6.m1.4.4.1.1" xref="S3.E6.m1.4.4.1.1.cmml"><msub id="S3.E6.m1.4.4.1.1.2" xref="S3.E6.m1.4.4.1.1.2.cmml"><mi id="S3.E6.m1.4.4.1.1.2.2" xref="S3.E6.m1.4.4.1.1.2.2.cmml">h</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E6.m1.4.4.1.1.1" xref="S3.E6.m1.4.4.1.1.1.cmml">=</mo><mfrac id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><mn id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml">1</mn><msub id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.2.2.2.cmml">θ</mi><mi id="S3.E6.m1.3.3.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.2.3.cmml">s</mi><mi id="S3.E6.m1.3.3.1.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E6.m1.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.3.2.2.cmml">θ</mi><mi id="S3.E6.m1.3.3.1.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.3.3.cmml">s</mi><mi id="S3.E6.m1.3.3.1.1.1.1.3.2.3" xref="S3.E6.m1.3.3.1.1.1.1.3.2.3.cmml">j</mi></msubsup></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E6.m1.3.3.1.3" xref="S3.E6.m1.3.3.1.3.cmml">2</mn></msub></mfrac></mrow><mo lspace="0.170em" id="S3.E6.m1.4.4.1.2" xref="S3.E6.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.4b"><apply id="S3.E6.m1.4.4.1.1.cmml" xref="S3.E6.m1.4.4.1"><eq id="S3.E6.m1.4.4.1.1.1.cmml" xref="S3.E6.m1.4.4.1.1.1"></eq><apply id="S3.E6.m1.4.4.1.1.2.cmml" xref="S3.E6.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.1.1.2.1.cmml" xref="S3.E6.m1.4.4.1.1.2">subscript</csymbol><ci id="S3.E6.m1.4.4.1.1.2.2.cmml" xref="S3.E6.m1.4.4.1.1.2.2">ℎ</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><divide id="S3.E6.m1.3.3.2.cmml" xref="S3.E6.m1.3.3"></divide><cn type="integer" id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3">1</cn><apply id="S3.E6.m1.3.3.1.cmml" xref="S3.E6.m1.3.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.2.cmml" xref="S3.E6.m1.3.3.1">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1"><minus id="S3.E6.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"></minus><apply id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.2">𝜃</ci><ci id="S3.E6.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2.2">𝜃</ci><ci id="S3.E6.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2.3">𝑗</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><cn type="integer" id="S3.E6.m1.3.3.1.3.cmml" xref="S3.E6.m1.3.3.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.4c">h_{i,j}=\frac{1}{\|\theta^{i}_{s}-\theta^{j}_{s}\|_{2}}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.4" class="ltx_p">and the corresponding value <math id="S3.SS3.p3.4.m1.1" class="ltx_Math" alttext="\mathbf{A}_{ij}" display="inline"><semantics id="S3.SS3.p3.4.m1.1a"><msub id="S3.SS3.p3.4.m1.1.1" xref="S3.SS3.p3.4.m1.1.1.cmml"><mi id="S3.SS3.p3.4.m1.1.1.2" xref="S3.SS3.p3.4.m1.1.1.2.cmml">𝐀</mi><mrow id="S3.SS3.p3.4.m1.1.1.3" xref="S3.SS3.p3.4.m1.1.1.3.cmml"><mi id="S3.SS3.p3.4.m1.1.1.3.2" xref="S3.SS3.p3.4.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.4.m1.1.1.3.1" xref="S3.SS3.p3.4.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.4.m1.1.1.3.3" xref="S3.SS3.p3.4.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m1.1b"><apply id="S3.SS3.p3.4.m1.1.1.cmml" xref="S3.SS3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m1.1.1.1.cmml" xref="S3.SS3.p3.4.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m1.1.1.2.cmml" xref="S3.SS3.p3.4.m1.1.1.2">𝐀</ci><apply id="S3.SS3.p3.4.m1.1.1.3.cmml" xref="S3.SS3.p3.4.m1.1.1.3"><times id="S3.SS3.p3.4.m1.1.1.3.1.cmml" xref="S3.SS3.p3.4.m1.1.1.3.1"></times><ci id="S3.SS3.p3.4.m1.1.1.3.2.cmml" xref="S3.SS3.p3.4.m1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.4.m1.1.1.3.3.cmml" xref="S3.SS3.p3.4.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m1.1c">\mathbf{A}_{ij}</annotation></semantics></math> in the adjacency matrix as:</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.4" class="ltx_Math" alttext="\mathbf{A}_{ij}=\begin{cases}\beta\,\,\,&amp;\text{if}\,\,\,i=j\\
\frac{(1-\beta)\cdot h_{ij}}{\sum_{d=1}^{D}\mathbbm{1}_{i\neq d}h_{id}}&amp;\text{otherwise}\end{cases}" display="block"><semantics id="S3.Ex1.m1.4a"><mrow id="S3.Ex1.m1.4.5" xref="S3.Ex1.m1.4.5.cmml"><msub id="S3.Ex1.m1.4.5.2" xref="S3.Ex1.m1.4.5.2.cmml"><mi id="S3.Ex1.m1.4.5.2.2" xref="S3.Ex1.m1.4.5.2.2.cmml">𝐀</mi><mrow id="S3.Ex1.m1.4.5.2.3" xref="S3.Ex1.m1.4.5.2.3.cmml"><mi id="S3.Ex1.m1.4.5.2.3.2" xref="S3.Ex1.m1.4.5.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.4.5.2.3.1" xref="S3.Ex1.m1.4.5.2.3.1.cmml">​</mo><mi id="S3.Ex1.m1.4.5.2.3.3" xref="S3.Ex1.m1.4.5.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1.m1.4.5.1" xref="S3.Ex1.m1.4.5.1.cmml">=</mo><mrow id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.5.3.1.cmml"><mo id="S3.Ex1.m1.4.4.5" xref="S3.Ex1.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.Ex1.m1.4.4.4" xref="S3.Ex1.m1.4.5.3.1.cmml"><mtr id="S3.Ex1.m1.4.4.4a" xref="S3.Ex1.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4b" xref="S3.Ex1.m1.4.5.3.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">β</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4c" xref="S3.Ex1.m1.4.5.3.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.1" xref="S3.Ex1.m1.2.2.2.2.2.1.cmml"><mrow id="S3.Ex1.m1.2.2.2.2.2.1.2" xref="S3.Ex1.m1.2.2.2.2.2.1.2.cmml"><mtext id="S3.Ex1.m1.2.2.2.2.2.1.2.2" xref="S3.Ex1.m1.2.2.2.2.2.1.2.2a.cmml">if</mtext><mo lspace="0.500em" rspace="0em" id="S3.Ex1.m1.2.2.2.2.2.1.2.1" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1.cmml">​</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.2.3" xref="S3.Ex1.m1.2.2.2.2.2.1.2.3.cmml">i</mi></mrow><mo id="S3.Ex1.m1.2.2.2.2.2.1.1" xref="S3.Ex1.m1.2.2.2.2.2.1.1.cmml">=</mo><mi id="S3.Ex1.m1.2.2.2.2.2.1.3" xref="S3.Ex1.m1.2.2.2.2.2.1.3.cmml">j</mi></mrow></mtd></mtr><mtr id="S3.Ex1.m1.4.4.4d" xref="S3.Ex1.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4e" xref="S3.Ex1.m1.4.5.3.1.cmml"><mstyle displaystyle="false" id="S3.Ex1.m1.3.3.3.3.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.cmml"><mfrac id="S3.Ex1.m1.3.3.3.3.1.1a" xref="S3.Ex1.m1.3.3.3.3.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.3.3.1.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml"><mn id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.2.cmml">⋅</mo><msub id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.2.cmml">h</mi><mrow id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.1" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.3" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mrow id="S3.Ex1.m1.3.3.3.3.1.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.cmml"><mstyle displaystyle="false" id="S3.Ex1.m1.3.3.3.3.1.1.3.1" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.cmml"><msubsup id="S3.Ex1.m1.3.3.3.3.1.1.3.1a" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.cmml"><mo id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.2.cmml">d</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.1" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.1.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.3.cmml">D</mi></msubsup></mstyle><mrow id="S3.Ex1.m1.3.3.3.3.1.1.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.cmml"><msub id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.cmml"><mn id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.2.cmml">𝟙</mn><mrow id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.1" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.1.cmml">≠</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.3.cmml">d</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.3.3.1.1.3.2.1" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.1.cmml">​</mo><msub id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.2.cmml">h</mi><mrow id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.cmml"><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.2" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.1" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.1.cmml">​</mo><mi id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.3" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.3.cmml">d</mi></mrow></msub></mrow></mrow></mfrac></mstyle></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.Ex1.m1.4.4.4f" xref="S3.Ex1.m1.4.5.3.1.cmml"><mtext id="S3.Ex1.m1.4.4.4.4.2.1" xref="S3.Ex1.m1.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.4b"><apply id="S3.Ex1.m1.4.5.cmml" xref="S3.Ex1.m1.4.5"><eq id="S3.Ex1.m1.4.5.1.cmml" xref="S3.Ex1.m1.4.5.1"></eq><apply id="S3.Ex1.m1.4.5.2.cmml" xref="S3.Ex1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.5.2.1.cmml" xref="S3.Ex1.m1.4.5.2">subscript</csymbol><ci id="S3.Ex1.m1.4.5.2.2.cmml" xref="S3.Ex1.m1.4.5.2.2">𝐀</ci><apply id="S3.Ex1.m1.4.5.2.3.cmml" xref="S3.Ex1.m1.4.5.2.3"><times id="S3.Ex1.m1.4.5.2.3.1.cmml" xref="S3.Ex1.m1.4.5.2.3.1"></times><ci id="S3.Ex1.m1.4.5.2.3.2.cmml" xref="S3.Ex1.m1.4.5.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.4.5.2.3.3.cmml" xref="S3.Ex1.m1.4.5.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m1.4.5.3.1.cmml" xref="S3.Ex1.m1.4.4"><csymbol cd="latexml" id="S3.Ex1.m1.4.5.3.1.1.cmml" xref="S3.Ex1.m1.4.4.5">cases</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">𝛽</ci><apply id="S3.Ex1.m1.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1"><eq id="S3.Ex1.m1.2.2.2.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.1"></eq><apply id="S3.Ex1.m1.2.2.2.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2"><times id="S3.Ex1.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.1"></times><ci id="S3.Ex1.m1.2.2.2.2.2.1.2.2a.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.2"><mtext id="S3.Ex1.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.2">if</mtext></ci><ci id="S3.Ex1.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.2.3">𝑖</ci></apply><ci id="S3.Ex1.m1.2.2.2.2.2.1.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.1.3">𝑗</ci></apply><apply id="S3.Ex1.m1.3.3.3.3.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1"><divide id="S3.Ex1.m1.3.3.3.3.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1"></divide><apply id="S3.Ex1.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1"><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.2">⋅</ci><apply id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1"><minus id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.2">1</cn><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.1.1.1.3">𝛽</ci></apply><apply id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.2">ℎ</ci><apply id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3"><times id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.1"></times><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3"><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.1.3.1.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1">superscript</csymbol><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1">subscript</csymbol><sum id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.2"></sum><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3"><eq id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.2">𝑑</ci><cn type="integer" id="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.1.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.1.3">𝐷</ci></apply><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2"><times id="S3.Ex1.m1.3.3.3.3.1.1.3.2.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.1"></times><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2">subscript</csymbol><cn type="integer" id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.2">1</cn><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3"><neq id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.1"></neq><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.2.3.3">𝑑</ci></apply></apply><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3">subscript</csymbol><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.2">ℎ</ci><apply id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3"><times id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.1.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.1"></times><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.2.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.2">𝑖</ci><ci id="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.3.cmml" xref="S3.Ex1.m1.3.3.3.3.1.1.3.2.3.3.3">𝑑</ci></apply></apply></apply></apply></apply><ci id="S3.Ex1.m1.4.4.4.4.2.1a.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1"><mtext id="S3.Ex1.m1.4.4.4.4.2.1.cmml" xref="S3.Ex1.m1.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.4c">\mathbf{A}_{ij}=\begin{cases}\beta\,\,\,&amp;\text{if}\,\,\,i=j\\
\frac{(1-\beta)\cdot h_{ij}}{\sum_{d=1}^{D}\mathbbm{1}_{i\neq d}h_{id}}&amp;\text{otherwise}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.8" class="ltx_p">where <math id="S3.SS3.p3.5.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS3.p3.5.m1.1a"><mi id="S3.SS3.p3.5.m1.1.1" xref="S3.SS3.p3.5.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m1.1b"><ci id="S3.SS3.p3.5.m1.1.1.cmml" xref="S3.SS3.p3.5.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m1.1c">\beta</annotation></semantics></math> is a hyperparameter weighing the impact of the self-connection, which we set to <math id="S3.SS3.p3.6.m2.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S3.SS3.p3.6.m2.1a"><mn id="S3.SS3.p3.6.m2.1.1" xref="S3.SS3.p3.6.m2.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m2.1b"><cn type="float" id="S3.SS3.p3.6.m2.1.1.cmml" xref="S3.SS3.p3.6.m2.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m2.1c">0.5</annotation></semantics></math>, and <math id="S3.SS3.p3.7.m3.1" class="ltx_Math" alttext="\mathbbm{1}_{i\neq m}" display="inline"><semantics id="S3.SS3.p3.7.m3.1a"><msub id="S3.SS3.p3.7.m3.1.1" xref="S3.SS3.p3.7.m3.1.1.cmml"><mn id="S3.SS3.p3.7.m3.1.1.2" xref="S3.SS3.p3.7.m3.1.1.2.cmml">𝟙</mn><mrow id="S3.SS3.p3.7.m3.1.1.3" xref="S3.SS3.p3.7.m3.1.1.3.cmml"><mi id="S3.SS3.p3.7.m3.1.1.3.2" xref="S3.SS3.p3.7.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p3.7.m3.1.1.3.1" xref="S3.SS3.p3.7.m3.1.1.3.1.cmml">≠</mo><mi id="S3.SS3.p3.7.m3.1.1.3.3" xref="S3.SS3.p3.7.m3.1.1.3.3.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m3.1b"><apply id="S3.SS3.p3.7.m3.1.1.cmml" xref="S3.SS3.p3.7.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m3.1.1.1.cmml" xref="S3.SS3.p3.7.m3.1.1">subscript</csymbol><cn type="integer" id="S3.SS3.p3.7.m3.1.1.2.cmml" xref="S3.SS3.p3.7.m3.1.1.2">1</cn><apply id="S3.SS3.p3.7.m3.1.1.3.cmml" xref="S3.SS3.p3.7.m3.1.1.3"><neq id="S3.SS3.p3.7.m3.1.1.3.1.cmml" xref="S3.SS3.p3.7.m3.1.1.3.1"></neq><ci id="S3.SS3.p3.7.m3.1.1.3.2.cmml" xref="S3.SS3.p3.7.m3.1.1.3.2">𝑖</ci><ci id="S3.SS3.p3.7.m3.1.1.3.3.cmml" xref="S3.SS3.p3.7.m3.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m3.1c">\mathbbm{1}_{i\neq m}</annotation></semantics></math> is an indicator function being 1 when <math id="S3.SS3.p3.8.m4.1" class="ltx_Math" alttext="i\neq m" display="inline"><semantics id="S3.SS3.p3.8.m4.1a"><mrow id="S3.SS3.p3.8.m4.1.1" xref="S3.SS3.p3.8.m4.1.1.cmml"><mi id="S3.SS3.p3.8.m4.1.1.2" xref="S3.SS3.p3.8.m4.1.1.2.cmml">i</mi><mo id="S3.SS3.p3.8.m4.1.1.1" xref="S3.SS3.p3.8.m4.1.1.1.cmml">≠</mo><mi id="S3.SS3.p3.8.m4.1.1.3" xref="S3.SS3.p3.8.m4.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m4.1b"><apply id="S3.SS3.p3.8.m4.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1"><neq id="S3.SS3.p3.8.m4.1.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1.1"></neq><ci id="S3.SS3.p3.8.m4.1.1.2.cmml" xref="S3.SS3.p3.8.m4.1.1.2">𝑖</ci><ci id="S3.SS3.p3.8.m4.1.1.3.cmml" xref="S3.SS3.p3.8.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m4.1c">i\neq m</annotation></semantics></math> and 0 otherwise.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.7" class="ltx_p">In our formulation, each client receives not only the set of parameters <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\theta</annotation></semantics></math>, but also the adjacency matrix. With this definition, we are forcing the gradient of a domain-specific component to flow to all others through the GCN. Consequently, an update on a domain-specific component will influence all domain-specific parameters, even the ones of the domains not present in the current training round. Moreover, given two domains <math id="S3.SS3.p4.2.m2.2" class="ltx_Math" alttext="i,j" display="inline"><semantics id="S3.SS3.p4.2.m2.2a"><mrow id="S3.SS3.p4.2.m2.2.3.2" xref="S3.SS3.p4.2.m2.2.3.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">i</mi><mo id="S3.SS3.p4.2.m2.2.3.2.1" xref="S3.SS3.p4.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS3.p4.2.m2.2.2" xref="S3.SS3.p4.2.m2.2.2.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.2b"><list id="S3.SS3.p4.2.m2.2.3.1.cmml" xref="S3.SS3.p4.2.m2.2.3.2"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝑖</ci><ci id="S3.SS3.p4.2.m2.2.2.cmml" xref="S3.SS3.p4.2.m2.2.2">𝑗</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.2c">i,j</annotation></semantics></math> with <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="i\neq j" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mrow id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml"><mi id="S3.SS3.p4.3.m3.1.1.2" xref="S3.SS3.p4.3.m3.1.1.2.cmml">i</mi><mo id="S3.SS3.p4.3.m3.1.1.1" xref="S3.SS3.p4.3.m3.1.1.1.cmml">≠</mo><mi id="S3.SS3.p4.3.m3.1.1.3" xref="S3.SS3.p4.3.m3.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><apply id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1"><neq id="S3.SS3.p4.3.m3.1.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1.1"></neq><ci id="S3.SS3.p4.3.m3.1.1.2.cmml" xref="S3.SS3.p4.3.m3.1.1.2">𝑖</ci><ci id="S3.SS3.p4.3.m3.1.1.3.cmml" xref="S3.SS3.p4.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">i\neq j</annotation></semantics></math>, the influence of <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">j</annotation></semantics></math> on <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">i</annotation></semantics></math> in each layer is directly proportional to the adjacency matrix value <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="\mathbf{A}_{ij}" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><msub id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">𝐀</mi><mrow id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml"><mi id="S3.SS3.p4.6.m6.1.1.3.2" xref="S3.SS3.p4.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.6.m6.1.1.3.1" xref="S3.SS3.p4.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p4.6.m6.1.1.3.3" xref="S3.SS3.p4.6.m6.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">𝐀</ci><apply id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3"><times id="S3.SS3.p4.6.m6.1.1.3.1.cmml" xref="S3.SS3.p4.6.m6.1.1.3.1"></times><ci id="S3.SS3.p4.6.m6.1.1.3.2.cmml" xref="S3.SS3.p4.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS3.p4.6.m6.1.1.3.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\mathbf{A}_{ij}</annotation></semantics></math>. This means that the more two sets of domain-specific parameters are close, the higher is their mutual influence. Finally, while the GCN is a way to ensure information flow across domains during training, at inference we can just precompute <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="\hat{\mathbf{V}}^{\ell}" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><msup id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml"><mover accent="true" id="S3.SS3.p4.7.m7.1.1.2" xref="S3.SS3.p4.7.m7.1.1.2.cmml"><mi id="S3.SS3.p4.7.m7.1.1.2.2" xref="S3.SS3.p4.7.m7.1.1.2.2.cmml">𝐕</mi><mo id="S3.SS3.p4.7.m7.1.1.2.1" xref="S3.SS3.p4.7.m7.1.1.2.1.cmml">^</mo></mover><mi mathvariant="normal" id="S3.SS3.p4.7.m7.1.1.3" xref="S3.SS3.p4.7.m7.1.1.3.cmml">ℓ</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><apply id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.7.m7.1.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">superscript</csymbol><apply id="S3.SS3.p4.7.m7.1.1.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2"><ci id="S3.SS3.p4.7.m7.1.1.2.1.cmml" xref="S3.SS3.p4.7.m7.1.1.2.1">^</ci><ci id="S3.SS3.p4.7.m7.1.1.2.2.cmml" xref="S3.SS3.p4.7.m7.1.1.2.2">𝐕</ci></apply><ci id="S3.SS3.p4.7.m7.1.1.3.cmml" xref="S3.SS3.p4.7.m7.1.1.3">ℓ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">\hat{\mathbf{V}}^{\ell}</annotation></semantics></math> for each layer, to save memory usage.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and implementation details</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We evaluate the proposed model on image classification tasks on the LEAF benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, testing both on the CelebA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and Federated Extended MNIST (FEMNIST) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> datasets. Table <a href="#S4.T1" title="Table 1 ‣ Implementation details ‣ 4.1 Datasets and implementation details ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> details each setting.</p>
</div>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">CelebA</h5>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.4" class="ltx_p">is a widely used dataset containing pictures of faces of several celebrities. We follow the same experimental protocol of  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, partitioning the dataset by celebrities and ignoring the ones with less than 5 images. The task is binary classification, recognizing whether the depicted person is smiling or not. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we use <math id="S4.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">10</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">10\%</annotation></semantics></math> of the total clients for training and a separate split of <math id="S4.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">20</mn><mo id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.2.m2.1c">20\%</annotation></semantics></math> of them for test. We train FedAvg and our model on 100 rounds with 10 clients each, training locally for a single epoch with a batch size of <math id="S4.SS1.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.3.m3.1a"><mn id="S4.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.3.m3.1b"><cn type="integer" id="S4.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.3.m3.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.3.m3.1c">5</annotation></semantics></math> and a learning rate of <math id="S4.SS1.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.4.m4.1a"><msup id="S4.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml">10</mn><mrow id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml"><mo id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3a" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml">−</mo><mn id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.2">10</cn><apply id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3"><minus id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3"></minus><cn type="integer" id="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px1.p1.4.m4.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.4.m4.1c">10^{-3}</annotation></semantics></math>.
To perform a fair comparison we used the same architecture of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, replacing convolutional and batch-normalization layers with their FedCG counterpart, based on a 1-layer GCN.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">FEMNIST</h5>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.10" class="ltx_p">contains images depicting different characters drawn by different writers. The task is a <math id="S4.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="62" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">62</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">62</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">62</annotation></semantics></math>-way classification problem, where the classes correspond to the uppercase and lowercase letters of the alphabet and numbers. Following the setting proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, each client corresponds to a different writer, using <math id="S4.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="60" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mn id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">60</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">60</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">60</annotation></semantics></math>% of them for training, <math id="S4.SS1.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.3.m3.1a"><mn id="S4.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m3.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m3.1c">20</annotation></semantics></math>% for validation and <math id="S4.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.4.m4.1a"><mn id="S4.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.4.m4.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.4.m4.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.4.m4.1c">20</annotation></semantics></math>% for test. We run both FedAvg and FedCG for <math id="S4.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.5.m5.1a"><mn id="S4.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.5.m5.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.5.m5.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.5.m5.1c">1000</annotation></semantics></math> rounds of <math id="S4.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.6.m6.1a"><mn id="S4.SS1.SSS0.Px2.p1.6.m6.1.1" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.6.m6.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.6.m6.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.6.m6.1c">5</annotation></semantics></math> clients each, using a batch size of <math id="S4.SS1.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.7.m7.1a"><mn id="S4.SS1.SSS0.Px2.p1.7.m7.1.1" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.7.m7.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.7.m7.1c">10</annotation></semantics></math>, a learning rate of <math id="S4.SS1.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="10^{-3}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.8.m8.1a"><msup id="S4.SS1.SSS0.Px2.p1.8.m8.1.1" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.cmml"><mn id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml">10</mn><mrow id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml"><mo id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3a" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml">−</mo><mn id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.cmml">3</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.8.m8.1b"><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.2">10</cn><apply id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3"><minus id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3"></minus><cn type="integer" id="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px2.p1.8.m8.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.8.m8.1c">10^{-3}</annotation></semantics></math> and one local epoch. We use the same and architecture of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, replacing the last convolutional layer with our GCN-based version. In this case, we use a 2-layers GCN, modeling the projection matrix <math id="S4.SS1.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.9.m9.1a"><mi id="S4.SS1.SSS0.Px2.p1.9.m9.1.1" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.9.m9.1b"><ci id="S4.SS1.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.9.m9.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.9.m9.1c">\mathbf{W}</annotation></semantics></math> as a bottleneck dividing the features by a factor of <math id="S4.SS1.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.10.m10.1a"><mn id="S4.SS1.SSS0.Px2.p1.10.m10.1.1" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.10.m10.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.10.m10.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.10.m10.1c">16</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Implementation details</h5>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.4" class="ltx_p">In all datasets, the domain classifiers are CNNs made of two convolutional layers of <math id="S4.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mn id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><cn type="integer" id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">32</annotation></semantics></math> and <math id="S4.SS1.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.2.m2.1a"><mn id="S4.SS1.SSS0.Px3.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.2.m2.1b"><cn type="integer" id="S4.SS1.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.2.m2.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.2.m2.1c">64</annotation></semantics></math> features and kernel size <math id="S4.SS1.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.3.m3.1a"><mrow id="S4.SS1.SSS0.Px3.p1.3.m3.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml"><mn id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.3.m3.1b"><apply id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1"><times id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.1"></times><cn type="integer" id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.2">3</cn><cn type="integer" id="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.3.m3.1c">3\times 3</annotation></semantics></math>, followed by an average pooling and a linear layer whose output dimension is the number of domains. We train the domain classifiers through an SGD optimizer without weight decay and a learning rate of <math id="S4.SS1.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.4.m4.1a"><msup id="S4.SS1.SSS0.Px3.p1.4.m4.1.1" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml"><mn id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml">10</mn><mrow id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml"><mo id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3a" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml">−</mo><mn id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.4.m4.1b"><apply id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.2">10</cn><apply id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3"><minus id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3"></minus><cn type="integer" id="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.SSS0.Px3.p1.4.m4.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.4.m4.1c">10^{-4}</annotation></semantics></math>. We implement FedCG on PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, running the experiments on NVIDIA GeForce 1070 GTX GPUs. We chose PytTorch due to its higher flexibility for prototyping and experimenting the components of our model. To ensure a fair comparison, we implemented the FedAvg baseline using the same framework, architectures, hyperparameters and training protocols of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.Table <a href="#S4.T2" title="Table 2 ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> compares our results with the performance of the Tensorflow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> implementation from the LEAF repository <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>:
our FedAvg baseline outperforms the original one by almost 3% in accuracy on FEMNIST, while performing almost 2.5% less on CelebA. Nevertheless, our main interest is to evaluate the relative improvement of the proposed model with respect to a baseline that does not exploit domain information, using the same aggregation strategy of FedAvg for federated learning. For these reasons, in the following we will take as reference the FedAvg results of the PyTorch framework, to ensure a comparison with the baseline under the exact conditions. We evaluate our results in terms of global accuracy on the test set, <span id="S4.SS1.SSS0.Px3.p1.4.1" class="ltx_ERROR undefined">\ie</span>on the union of the images of all test devices. All experiments on the same dataset were run with the same configuration to perform a fair comparison between the considered approaches.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:106.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.4pt,-17.3pt) scale(1.48049101230261,1.48049101230261) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Clients</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Total samples</span></td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Samples per client</span></td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.5.1" class="ltx_text ltx_font_bold">Classes</span></td>
</tr>
<tr id="S4.T1.1.1.2" class="ltx_tr">
<td id="S4.T1.1.1.2.1" class="ltx_td"></td>
<td id="S4.T1.1.1.2.2" class="ltx_td"></td>
<td id="S4.T1.1.1.2.3" class="ltx_td"></td>
<td id="S4.T1.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">Mean</td>
<td id="S4.T1.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">Stdev</td>
<td id="S4.T1.1.1.2.6" class="ltx_td"></td>
</tr>
<tr id="S4.T1.1.1.3" class="ltx_tr">
<td id="S4.T1.1.1.3.1" class="ltx_td ltx_align_left ltx_border_t">CelebA</td>
<td id="S4.T1.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">9,343</td>
<td id="S4.T1.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">200,288</td>
<td id="S4.T1.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">21.44</td>
<td id="S4.T1.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t">7.63</td>
<td id="S4.T1.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">2</td>
</tr>
<tr id="S4.T1.1.1.4" class="ltx_tr">
<td id="S4.T1.1.1.4.1" class="ltx_td ltx_align_left ltx_border_b">FEMNIST</td>
<td id="S4.T1.1.1.4.2" class="ltx_td ltx_align_center ltx_border_b">3,550</td>
<td id="S4.T1.1.1.4.3" class="ltx_td ltx_align_center ltx_border_b">805,263</td>
<td id="S4.T1.1.1.4.4" class="ltx_td ltx_align_center ltx_border_b">226.83</td>
<td id="S4.T1.1.1.4.5" class="ltx_td ltx_align_center ltx_border_b">88.94</td>
<td id="S4.T1.1.1.4.6" class="ltx_td ltx_align_center ltx_border_b">62</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S4.T1.3.1" class="ltx_text ltx_font_bold">Datasets Statistics</span></figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Ablation study</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this section, we focus our analysis on testing the performance of the proposed model on the <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">CelebA</span> dataset, analyzing the various components of our approach. All referred studies and results can be found in Table <a href="#S4.T3" title="Table 3 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and <a href="#S4.T4" title="Table 4 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T2.1.1" class="ltx_tr">
<td id="S4.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.2.1" class="ltx_text ltx_font_bold">TensorFlow</span></td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.1.1.3.1" class="ltx_text ltx_font_bold">PyTorch</span></td>
</tr>
<tr id="S4.T2.1.2" class="ltx_tr">
<td id="S4.T2.1.2.1" class="ltx_td ltx_align_center ltx_border_t">CelebA</td>
<td id="S4.T2.1.2.2" class="ltx_td ltx_align_center ltx_border_t">89.46</td>
<td id="S4.T2.1.2.3" class="ltx_td ltx_align_center ltx_border_t">86.88</td>
</tr>
<tr id="S4.T2.1.3" class="ltx_tr">
<td id="S4.T2.1.3.1" class="ltx_td ltx_align_center ltx_border_b">FEMNIST</td>
<td id="S4.T2.1.3.2" class="ltx_td ltx_align_center ltx_border_b">74.72</td>
<td id="S4.T2.1.3.3" class="ltx_td ltx_align_center ltx_border_b">77.81</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy of FedAvg in TensorFlow <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and our version implemented in PyTorch. </figcaption>
</figure>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>How to use domain information</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.6" class="ltx_p">To create a sanity-check for our model, we first define the domains manually, exploiting the a priori knowledge given from the images meta-data, <span id="S4.SS2.SSS1.p1.6.1" class="ltx_ERROR undefined">\ie</span>the 40 attributes of the dataset (Table <a href="#S4.T3" title="Table 3 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). This allows us to isolate the choice of how to include domain-specific information within the model, without any influence from the clustering procedure. From the 40 attributes, we select the combination of <math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">n</annotation></semantics></math> attributes leading to the most balanced subdivisions of the dataset and having a low correlation with the target feature. Since each attribute can only assume the values <math id="S4.SS2.SSS1.p1.2.m2.2" class="ltx_Math" alttext="\{0,1\}" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.2a"><mrow id="S4.SS2.SSS1.p1.2.m2.2.3.2" xref="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.2.m2.2.3.2.1" xref="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml">{</mo><mn id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">0</mn><mo id="S4.SS2.SSS1.p1.2.m2.2.3.2.2" xref="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS2.SSS1.p1.2.m2.2.2" xref="S4.SS2.SSS1.p1.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.SSS1.p1.2.m2.2.3.2.3" xref="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.2b"><set id="S4.SS2.SSS1.p1.2.m2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.2.3.2"><cn type="integer" id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">0</cn><cn type="integer" id="S4.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.2.2">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.2c">\{0,1\}</annotation></semantics></math>, the number of possible <span id="S4.SS2.SSS1.p1.6.2" class="ltx_text ltx_font_italic">domains</span> is given by all the <math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="2^{n}" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><msup id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml"><mn id="S4.SS2.SSS1.p1.3.m3.1.1.2" xref="S4.SS2.SSS1.p1.3.m3.1.1.2.cmml">2</mn><mi id="S4.SS2.SSS1.p1.3.m3.1.1.3" xref="S4.SS2.SSS1.p1.3.m3.1.1.3.cmml">n</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><apply id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">superscript</csymbol><cn type="integer" id="S4.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1.2">2</cn><ci id="S4.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">2^{n}</annotation></semantics></math> combinations of the <math id="S4.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><mi id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><ci id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">n</annotation></semantics></math> features. We choose <math id="S4.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="n=5" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><mrow id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p1.5.m5.1.1.2" xref="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml">n</mi><mo id="S4.SS2.SSS1.p1.5.m5.1.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.5.m5.1.1.3" xref="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><apply id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1"><eq id="S4.SS2.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.2">𝑛</ci><cn type="integer" id="S4.SS2.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">n=5</annotation></semantics></math>, having <math id="S4.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="N=32" display="inline"><semantics id="S4.SS2.SSS1.p1.6.m6.1a"><mrow id="S4.SS2.SSS1.p1.6.m6.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS1.p1.6.m6.1.1.2" xref="S4.SS2.SSS1.p1.6.m6.1.1.2.cmml">N</mi><mo id="S4.SS2.SSS1.p1.6.m6.1.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.6.m6.1.1.3" xref="S4.SS2.SSS1.p1.6.m6.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m6.1b"><apply id="S4.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1"><eq id="S4.SS2.SSS1.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1.2">𝑁</ci><cn type="integer" id="S4.SS2.SSS1.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m6.1c">N=32</annotation></semantics></math> domains. The selected features are <span id="S4.SS2.SSS1.p1.6.3" class="ltx_text ltx_font_italic">attractive</span>, <span id="S4.SS2.SSS1.p1.6.4" class="ltx_text ltx_font_italic">heavy makeup</span>, <span id="S4.SS2.SSS1.p1.6.5" class="ltx_text ltx_font_italic">high cheekbones</span>, <span id="S4.SS2.SSS1.p1.6.6" class="ltx_text ltx_font_italic">mouth slightly open</span> and <span id="S4.SS2.SSS1.p1.6.7" class="ltx_text ltx_font_italic">wavy hair</span>.</p>
</div>
<section id="S4.SS2.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Domain-specific models</h5>

<div id="S4.SS2.SSS1.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.Px1.p1.3" class="ltx_p">We start by replacing the standard single server model with <math id="S4.SS2.SSS1.Px1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.SSS1.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS1.Px1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.Px1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p1.1.m1.1c">N</annotation></semantics></math> separate domain-specific models, trained and tested only on the images of their specific domains. As shown in Table <a href="#S4.T3" title="Table 3 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the performance drops significantly (<math id="S4.SS2.SSS1.Px1.p1.2.m2.1" class="ltx_Math" alttext="33.61" display="inline"><semantics id="S4.SS2.SSS1.Px1.p1.2.m2.1a"><mn id="S4.SS2.SSS1.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS1.Px1.p1.2.m2.1.1.cmml">33.61</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p1.2.m2.1b"><cn type="float" id="S4.SS2.SSS1.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.Px1.p1.2.m2.1.1">33.61</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p1.2.m2.1c">33.61</annotation></semantics></math>% vs <math id="S4.SS2.SSS1.Px1.p1.3.m3.1" class="ltx_Math" alttext="86.88" display="inline"><semantics id="S4.SS2.SSS1.Px1.p1.3.m3.1a"><mn id="S4.SS2.SSS1.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS1.Px1.p1.3.m3.1.1.cmml">86.88</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p1.3.m3.1b"><cn type="float" id="S4.SS2.SSS1.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.Px1.p1.3.m3.1.1">86.88</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p1.3.m3.1c">86.88</annotation></semantics></math>% of FedAvg), since the insufficient amount of data seen by each model leads to poor generalization. This shows that learning a single full model per each domain is not a viable strategy in this scenario.</p>
</div>
</section>
<section id="S4.SS2.SSS1.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Modeling the relations across domains</h5>

<div id="S4.SS2.SSS1.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS1.Px2.p1.4" class="ltx_p">In order to account for the relations existing among the different domains, we introduce the graph, modeled as a 1-layer GCN. To study the impact of introducing a GCN, we also test a simpler version of the model without the weight transformation matrix <math id="S4.SS2.SSS1.Px2.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S4.SS2.SSS1.Px2.p1.1.m1.1a"><mi id="S4.SS2.SSS1.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS1.Px2.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px2.p1.1.m1.1b"><ci id="S4.SS2.SSS1.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.Px2.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px2.p1.1.m1.1c">W</annotation></semantics></math>.
We analyze different choices of <math id="S4.SS2.SSS1.Px2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{A}" display="inline"><semantics id="S4.SS2.SSS1.Px2.p1.2.m2.1a"><mi id="S4.SS2.SSS1.Px2.p1.2.m2.1.1" xref="S4.SS2.SSS1.Px2.p1.2.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px2.p1.2.m2.1b"><ci id="S4.SS2.SSS1.Px2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.Px2.p1.2.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px2.p1.2.m2.1c">\mathbf{A}</annotation></semantics></math>, considering the cases where i) they are uniformly weighted (U) and ii) the domains are weighted according to a similarity criterion (H), specifically the normalized inverse of the Hamming distance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> between the numerical representation of the domains (<span id="S4.SS2.SSS1.Px2.p1.4.1" class="ltx_ERROR undefined">\ie</span>their binary metadata).
As Table <a href="#S4.T3" title="Table 3 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows, using a GCN consistently improves the final performance over the domain-specific models. The uniform adjacency matrix performs slightly better than the weighted one in this case, with both their performance improving when the projection matrix <math id="S4.SS2.SSS1.Px2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S4.SS2.SSS1.Px2.p1.3.m3.1a"><mi id="S4.SS2.SSS1.Px2.p1.3.m3.1.1" xref="S4.SS2.SSS1.Px2.p1.3.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px2.p1.3.m3.1b"><ci id="S4.SS2.SSS1.Px2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.Px2.p1.3.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px2.p1.3.m3.1c">\mathbf{W}</annotation></semantics></math> is introduced. These results confirm the importance of making the domain-specific nodes interact. However, the results are not satisfactory, being either below or just 1% above (GCN-H with <math id="S4.SS2.SSS1.Px2.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{W}" display="inline"><semantics id="S4.SS2.SSS1.Px2.p1.4.m4.1a"><mi id="S4.SS2.SSS1.Px2.p1.4.m4.1.1" xref="S4.SS2.SSS1.Px2.p1.4.m4.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px2.p1.4.m4.1b"><ci id="S4.SS2.SSS1.Px2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.Px2.p1.4.m4.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px2.p1.4.m4.1c">\mathbf{W}</annotation></semantics></math>) FedAvg. This means that domain information is still dully exploited within the model.</p>
</div>
</section>
<section id="S4.SS2.SSS1.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Residual domain-specific layers.</h5>

<div id="S4.SS2.SSS1.Px3.p1" class="ltx_para">
<p id="S4.SS2.SSS1.Px3.p1.1" class="ltx_p">Finally, we analyze the usage of
domain-specific parameters to produce residual activations (<span id="S4.SS2.SSS1.Px3.p1.1.1" class="ltx_ERROR undefined">\ie</span>Eq. (<a href="#S3.E4" title="In 3.2 Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)), as in FedCG, comparing it with the GCN when not using any domain-agnostic component. As Table <a href="#S4.T3" title="Table 3 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows, while the model with uniform adjacency matrix (U) sees a decrease in performance from GCN to FedCG (<span id="S4.SS2.SSS1.Px3.p1.1.2" class="ltx_ERROR undefined">\ie</span>87.92% vs 86.96%), the model with weighted adjacency matrix (H) sees a large boost, going from the 84.25% accuracy of GCN to the 88.65% of FedCG. We can draw two conclusions. First, using residual layers to refine the domain agnostic activations (FedCG) performs better than using only domain-specific components (GCN). Second, when domain-specific components are integrated as residuals, they are much more effective when connected in a weighted (H) rather than a uniform (U) fashion. This is proved by the results of FedCG-H, surpassing FedCG-U by 1.7% in accuracy. Finally, we test the importance of the ReLU non-linearity applied to the output of the residual GCN. The non-linearity improves FedCG, both when the domains are connected uniformly (+1%) and in a weighted fashion (+0.9%). The final FedCG model with 1-layer GCN filtered with a ReLU and a weighted adjacency matrix outperforms the baseline FedAvg by 2.6% accuracy, showing the effectiveness of our choices.</p>
</div>
</section>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>How to identify the domains</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">In the previous section, we analyzed how to integrate domain-specific components given oracle domain information. In this section, we drop the assumption of having such information and we study the effectiveness of the domains discovered through our clustering procedure on FedCG  held out through the teacher-student domain classifier
(cf. Sec. <a href="#S3.SS1" title="3.1 Federated Clustering ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). We report the results of our analysis in Table <a href="#S4.T4" title="Table 4 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<section id="S4.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Domains extracted through clustering</h5>

<div id="S4.SS2.SSS2.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS2.Px1.p1.7" class="ltx_p">We start by comparing our domain classifier with the K-means algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> applied to the parameters of the models trained separately on each client. FedCG performs clustering locally instead, accessing only a subset of the clients at each round. As Table <a href="#S4.T4" title="Table 4 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows, the performance of our clustering procedure is either on par (<math id="S4.SS2.SSS2.Px1.p1.1.m1.1" class="ltx_Math" alttext="D=2" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.1.m1.1a"><mrow id="S4.SS2.SSS2.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.1" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.1.m1.1b"><apply id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1"><eq id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.1.m1.1c">D=2</annotation></semantics></math>) or superior (<math id="S4.SS2.SSS2.Px1.p1.2.m2.1" class="ltx_Math" alttext="D=3" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.2.m2.1a"><mrow id="S4.SS2.SSS2.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.2" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.1" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.2.m2.1b"><apply id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1"><eq id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.2.m2.1c">D=3</annotation></semantics></math>,<math id="S4.SS2.SSS2.Px1.p1.3.m3.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.3.m3.1a"><mn id="S4.SS2.SSS2.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS2.Px1.p1.3.m3.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.3.m3.1b"><cn type="integer" id="S4.SS2.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.3.m3.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.3.m3.1c">4</annotation></semantics></math>) to K-means clustering. In particular, as the number of clusters grows, the performance of K-means drops (<span id="S4.SS2.SSS2.Px1.p1.7.1" class="ltx_ERROR undefined">\ie</span>from 88.36% with <math id="S4.SS2.SSS2.Px1.p1.4.m4.1" class="ltx_Math" alttext="D=2" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.4.m4.1a"><mrow id="S4.SS2.SSS2.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.2" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.1" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.3" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.4.m4.1b"><apply id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1"><eq id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.4.m4.1c">D=2</annotation></semantics></math> to 87.21 with <math id="S4.SS2.SSS2.Px1.p1.5.m5.1" class="ltx_Math" alttext="D=4" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.5.m5.1a"><mrow id="S4.SS2.SSS2.Px1.p1.5.m5.1.1" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.2" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.1" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.3" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.5.m5.1b"><apply id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1"><eq id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p1.5.m5.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.5.m5.1c">D=4</annotation></semantics></math>), while our method - with the same residual GCN - shows performance improvements (<span id="S4.SS2.SSS2.Px1.p1.7.2" class="ltx_ERROR undefined">\ie</span>from 88.03% with <math id="S4.SS2.SSS2.Px1.p1.6.m6.1" class="ltx_Math" alttext="D=2" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.6.m6.1a"><mrow id="S4.SS2.SSS2.Px1.p1.6.m6.1.1" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.2" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.1" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.3" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.6.m6.1b"><apply id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1"><eq id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.6.m6.1c">D=2</annotation></semantics></math> to 88.74 with <math id="S4.SS2.SSS2.Px1.p1.7.m7.1" class="ltx_Math" alttext="D=4" display="inline"><semantics id="S4.SS2.SSS2.Px1.p1.7.m7.1a"><mrow id="S4.SS2.SSS2.Px1.p1.7.m7.1.1" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.2" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.1" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.3" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p1.7.m7.1b"><apply id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1"><eq id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p1.7.m7.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p1.7.m7.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p1.7.m7.1c">D=4</annotation></semantics></math>). This indicates the effectiveness of our local clustering procedure that, differently from K-means, captures the presence of different domains within each client, without requiring one specific model per client.</p>
</div>
<div id="S4.SS2.SSS2.Px1.p2" class="ltx_para">
<p id="S4.SS2.SSS2.Px1.p2.2" class="ltx_p">Then, we analyze the effect of different initialization strategies for the adjacency matrix of the GCN, considering two choices, <span id="S4.SS2.SSS2.Px1.p2.2.1" class="ltx_ERROR undefined">\ie</span>domains either disconnected (identity matrix, <span id="S4.SS2.SSS2.Px1.p2.2.2" class="ltx_text ltx_font_italic">eye</span>) or randomly connected (random adjacency matrix, <span id="S4.SS2.SSS2.Px1.p2.2.3" class="ltx_text ltx_font_italic">rand</span>). From Table <a href="#S4.T4" title="Table 4 ‣ Domains extracted through clustering ‣ 4.2.2 How to identify the domains ‣ 4.2 Ablation study ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, it is easy to see our method performances are not dependent on the particular initialization strategy, achieving over 88.5% for all choices with <math id="S4.SS2.SSS2.Px1.p2.1.m1.1" class="ltx_Math" alttext="D=4" display="inline"><semantics id="S4.SS2.SSS2.Px1.p2.1.m1.1a"><mrow id="S4.SS2.SSS2.Px1.p2.1.m1.1.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p2.1.m1.1b"><apply id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1"><eq id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p2.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p2.1.m1.1c">D=4</annotation></semantics></math>. With random initialization though, the performance does not grow with the number of domains, which may indicate the importance of carefully initializing <math id="S4.SS2.SSS2.Px1.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{A}" display="inline"><semantics id="S4.SS2.SSS2.Px1.p2.2.m2.1a"><mi id="S4.SS2.SSS2.Px1.p2.2.m2.1.1" xref="S4.SS2.SSS2.Px1.p2.2.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p2.2.m2.1b"><ci id="S4.SS2.SSS2.Px1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS2.Px1.p2.2.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p2.2.m2.1c">\mathbf{A}</annotation></semantics></math> as the number of domains grows. For this reason, in the following we always consider a uniform initialization strategy. Note that such a strategy allows the model to refine the domain-specific components separately before merging them based on their distance (see Eq. (<a href="#S3.Ex1" title="3.3 Connecting Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>)).</p>
</div>
<div id="S4.SS2.SSS2.Px1.p3" class="ltx_para">
<p id="S4.SS2.SSS2.Px1.p3.1" class="ltx_p">As a third analysis, we focus on the impact of performing a soft combination of domains at test time (as described in Section <a href="#S3.SS2" title="3.2 Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>) rather than using a hard-assignment derived from the predictions of the domain classifier. In both cases, performances are close for all <math id="S4.SS2.SSS2.Px1.p3.1.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS2.SSS2.Px1.p3.1.m1.1a"><mi id="S4.SS2.SSS2.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS2.Px1.p3.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p3.1.m1.1b"><ci id="S4.SS2.SSS2.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p3.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p3.1.m1.1c">D</annotation></semantics></math>, showing the domain classifier provides reliable domain predictions at test time. In the following, we always consider the soft-assignment due to its higher flexibility.</p>
</div>
<div id="S4.SS2.SSS2.Px1.p4" class="ltx_para">
<p id="S4.SS2.SSS2.Px1.p4.1" class="ltx_p">Finally, we test the application of the domain-specific modules only on the last layer of the network (rather than on all layers) to see whether a good performance can be achieved while reducing the number of parameters required by FedCG. As the experiments show, using domain-specific parameters on the last layer provides the best results overall (89.18% with <math id="S4.SS2.SSS2.Px1.p4.1.m1.1" class="ltx_Math" alttext="D=4" display="inline"><semantics id="S4.SS2.SSS2.Px1.p4.1.m1.1a"><mrow id="S4.SS2.SSS2.Px1.p4.1.m1.1.1" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.2" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.2.cmml">D</mi><mo id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.1" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.3" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.Px1.p4.1.m1.1b"><apply id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1"><eq id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.1"></eq><ci id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.2">𝐷</ci><cn type="integer" id="S4.SS2.SSS2.Px1.p4.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.Px1.p4.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.Px1.p4.1.m1.1c">D=4</annotation></semantics></math>), improving the best combination by 0.44%. Since this choice allows FedCG to use less parameters while still achieving good results, we limit the use of domain-specific parameters to the last layers in the next section.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<div id="S4.T3.2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:322.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(95.7pt,-71.1pt) scale(1.79037714151358,1.79037714151358) ;">
<table id="S4.T3.2.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.2.2.2.2" class="ltx_tr">
<td id="S4.T3.2.2.2.2.3" class="ltx_td ltx_align_left ltx_border_r">Model</td>
<td id="S4.T3.1.1.1.1.1" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">A</span></td>
<td id="S4.T3.2.2.2.2.2" class="ltx_td ltx_align_center"><span id="S4.T3.2.2.2.2.2.1" class="ltx_text ltx_markedasmath ltx_font_bold">W</span></td>
<td id="S4.T3.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_r">ReLU</td>
<td id="S4.T3.2.2.2.2.5" class="ltx_td ltx_align_center">Acc(%)</td>
</tr>
<tr id="S4.T3.2.2.2.3" class="ltx_tr">
<td id="S4.T3.2.2.2.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">Domain-specific models</td>
<td id="S4.T3.2.2.2.3.2" class="ltx_td ltx_align_center ltx_border_tt">-</td>
<td id="S4.T3.2.2.2.3.3" class="ltx_td ltx_align_center ltx_border_tt">-</td>
<td id="S4.T3.2.2.2.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">-</td>
<td id="S4.T3.2.2.2.3.5" class="ltx_td ltx_align_center ltx_border_tt">33.61</td>
</tr>
<tr id="S4.T3.2.2.2.4" class="ltx_tr">
<td id="S4.T3.2.2.2.4.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" rowspan="4"><span id="S4.T3.2.2.2.4.1.1" class="ltx_text">GCN</span></td>
<td id="S4.T3.2.2.2.4.2" class="ltx_td ltx_align_center ltx_border_t">U</td>
<td id="S4.T3.2.2.2.4.3" class="ltx_td ltx_align_center ltx_border_t">✗</td>
<td id="S4.T3.2.2.2.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✗</td>
<td id="S4.T3.2.2.2.4.5" class="ltx_td ltx_align_center ltx_border_t">84.39</td>
</tr>
<tr id="S4.T3.2.2.2.5" class="ltx_tr">
<td id="S4.T3.2.2.2.5.1" class="ltx_td ltx_align_center">H</td>
<td id="S4.T3.2.2.2.5.2" class="ltx_td ltx_align_center">✗</td>
<td id="S4.T3.2.2.2.5.3" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T3.2.2.2.5.4" class="ltx_td ltx_align_center">82.10</td>
</tr>
<tr id="S4.T3.2.2.2.6" class="ltx_tr">
<td id="S4.T3.2.2.2.6.1" class="ltx_td ltx_align_center">U</td>
<td id="S4.T3.2.2.2.6.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T3.2.2.2.6.3" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T3.2.2.2.6.4" class="ltx_td ltx_align_center">87.92</td>
</tr>
<tr id="S4.T3.2.2.2.7" class="ltx_tr">
<td id="S4.T3.2.2.2.7.1" class="ltx_td ltx_align_center">H</td>
<td id="S4.T3.2.2.2.7.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T3.2.2.2.7.3" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T3.2.2.2.7.4" class="ltx_td ltx_align_center">84.25</td>
</tr>
<tr id="S4.T3.2.2.2.8" class="ltx_tr">
<td id="S4.T3.2.2.2.8.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" rowspan="4"><span id="S4.T3.2.2.2.8.1.1" class="ltx_text">FedCG</span></td>
<td id="S4.T3.2.2.2.8.2" class="ltx_td ltx_align_center ltx_border_t">U</td>
<td id="S4.T3.2.2.2.8.3" class="ltx_td ltx_align_center ltx_border_t">✓</td>
<td id="S4.T3.2.2.2.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✗</td>
<td id="S4.T3.2.2.2.8.5" class="ltx_td ltx_align_center ltx_border_t">86.96</td>
</tr>
<tr id="S4.T3.2.2.2.9" class="ltx_tr">
<td id="S4.T3.2.2.2.9.1" class="ltx_td ltx_align_center">H</td>
<td id="S4.T3.2.2.2.9.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T3.2.2.2.9.3" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T3.2.2.2.9.4" class="ltx_td ltx_align_center">88.65</td>
</tr>
<tr id="S4.T3.2.2.2.10" class="ltx_tr">
<td id="S4.T3.2.2.2.10.1" class="ltx_td ltx_align_center">U</td>
<td id="S4.T3.2.2.2.10.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T3.2.2.2.10.3" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T3.2.2.2.10.4" class="ltx_td ltx_align_center">87.97</td>
</tr>
<tr id="S4.T3.2.2.2.11" class="ltx_tr">
<td id="S4.T3.2.2.2.11.1" class="ltx_td ltx_align_center ltx_border_b">H</td>
<td id="S4.T3.2.2.2.11.2" class="ltx_td ltx_align_center ltx_border_b">✓</td>
<td id="S4.T3.2.2.2.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">✓</td>
<td id="S4.T3.2.2.2.11.4" class="ltx_td ltx_align_center ltx_border_b">89.57</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="S4.T3.6.1" class="ltx_text ltx_font_bold">Ablation studies on CelebA dataset with <math id="S4.T3.6.1.m1.1" class="ltx_Math" alttext="N=32" display="inline"><semantics id="S4.T3.6.1.m1.1b"><mrow id="S4.T3.6.1.m1.1.1" xref="S4.T3.6.1.m1.1.1.cmml"><mi id="S4.T3.6.1.m1.1.1.2" xref="S4.T3.6.1.m1.1.1.2.cmml">N</mi><mo id="S4.T3.6.1.m1.1.1.1" xref="S4.T3.6.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.6.1.m1.1.1.3" xref="S4.T3.6.1.m1.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.1.m1.1c"><apply id="S4.T3.6.1.m1.1.1.cmml" xref="S4.T3.6.1.m1.1.1"><eq id="S4.T3.6.1.m1.1.1.1.cmml" xref="S4.T3.6.1.m1.1.1.1"></eq><ci id="S4.T3.6.1.m1.1.1.2.cmml" xref="S4.T3.6.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.T3.6.1.m1.1.1.3.cmml" xref="S4.T3.6.1.m1.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.1.m1.1d">N=32</annotation></semantics></math> domains extracted from images meta-data</span>. <span id="S4.T3.11.2" class="ltx_text ltx_markedasmath ltx_font_bold">A</span> is the adjacency matrix that weights the domains contributions: the symbols (eye,U,H) respectively stand for identity, uniform and weighted (with inverse Hamming distance) matrices. <span id="S4.T3.12.3" class="ltx_text ltx_markedasmath ltx_font_bold">W</span> is the weight projection matrix and ReLU the chosen non-linear activation.</figcaption>
</figure>
<figure id="S4.T4" class="ltx_table">
<div id="S4.T4.2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:442.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(67.0pt,-68.4pt) scale(1.44720685764234,1.44720685764234) ;">
<table id="S4.T4.2.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S4.T4.2.2.2.2" class="ltx_tr">
<td id="S4.T4.2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedCG layers</td>
<td id="S4.T4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T4.1.1.1.1.1.1" class="ltx_text ltx_markedasmath ltx_font_bold">A</span> init</td>
<td id="S4.T4.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Clusters</td>
<td id="S4.T4.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S4.T4.2.2.2.2.2.m1.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.T4.2.2.2.2.2.m1.1a"><mi id="S4.T4.2.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.2.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.2.m1.1b"><ci id="S4.T4.2.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.2.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.2.m1.1c">D</annotation></semantics></math></td>
<td id="S4.T4.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Soft domains</td>
<td id="S4.T4.2.2.2.2.6" class="ltx_td ltx_align_center ltx_border_t">Acc(%)</td>
</tr>
<tr id="S4.T4.2.2.2.3" class="ltx_tr">
<td id="S4.T4.2.2.2.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" rowspan="12"><span id="S4.T4.2.2.2.3.1.1" class="ltx_text">all</span></td>
<td id="S4.T4.2.2.2.3.2" class="ltx_td ltx_align_center ltx_border_tt">eye</td>
<td id="S4.T4.2.2.2.3.3" class="ltx_td ltx_align_center ltx_border_tt">K-means</td>
<td id="S4.T4.2.2.2.3.4" class="ltx_td ltx_align_center ltx_border_tt">2</td>
<td id="S4.T4.2.2.2.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">✗</td>
<td id="S4.T4.2.2.2.3.6" class="ltx_td ltx_align_center ltx_border_tt">88.36</td>
</tr>
<tr id="S4.T4.2.2.2.4" class="ltx_tr">
<td id="S4.T4.2.2.2.4.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.4.2" class="ltx_td ltx_align_center">K-means</td>
<td id="S4.T4.2.2.2.4.3" class="ltx_td ltx_align_center">3</td>
<td id="S4.T4.2.2.2.4.4" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T4.2.2.2.4.5" class="ltx_td ltx_align_center">87.97</td>
</tr>
<tr id="S4.T4.2.2.2.5" class="ltx_tr">
<td id="S4.T4.2.2.2.5.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.5.2" class="ltx_td ltx_align_center">K-means</td>
<td id="S4.T4.2.2.2.5.3" class="ltx_td ltx_align_center">4</td>
<td id="S4.T4.2.2.2.5.4" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T4.2.2.2.5.5" class="ltx_td ltx_align_center">87.21</td>
</tr>
<tr id="S4.T4.2.2.2.6" class="ltx_tr">
<td id="S4.T4.2.2.2.6.1" class="ltx_td ltx_align_center ltx_border_t">eye</td>
<td id="S4.T4.2.2.2.6.2" class="ltx_td ltx_align_center ltx_border_t">Clf</td>
<td id="S4.T4.2.2.2.6.3" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T4.2.2.2.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✗</td>
<td id="S4.T4.2.2.2.6.5" class="ltx_td ltx_align_center ltx_border_t">88.03</td>
</tr>
<tr id="S4.T4.2.2.2.7" class="ltx_tr">
<td id="S4.T4.2.2.2.7.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.7.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.7.3" class="ltx_td ltx_align_center">3</td>
<td id="S4.T4.2.2.2.7.4" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T4.2.2.2.7.5" class="ltx_td ltx_align_center">88.59</td>
</tr>
<tr id="S4.T4.2.2.2.8" class="ltx_tr">
<td id="S4.T4.2.2.2.8.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.8.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.8.3" class="ltx_td ltx_align_center">4</td>
<td id="S4.T4.2.2.2.8.4" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T4.2.2.2.8.5" class="ltx_td ltx_align_center">88.74</td>
</tr>
<tr id="S4.T4.2.2.2.9" class="ltx_tr">
<td id="S4.T4.2.2.2.9.1" class="ltx_td ltx_align_center ltx_border_t">rand</td>
<td id="S4.T4.2.2.2.9.2" class="ltx_td ltx_align_center ltx_border_t">Clf</td>
<td id="S4.T4.2.2.2.9.3" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T4.2.2.2.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✗</td>
<td id="S4.T4.2.2.2.9.5" class="ltx_td ltx_align_center ltx_border_t">88.73</td>
</tr>
<tr id="S4.T4.2.2.2.10" class="ltx_tr">
<td id="S4.T4.2.2.2.10.1" class="ltx_td ltx_align_center">rand</td>
<td id="S4.T4.2.2.2.10.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.10.3" class="ltx_td ltx_align_center">3</td>
<td id="S4.T4.2.2.2.10.4" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T4.2.2.2.10.5" class="ltx_td ltx_align_center">88.24</td>
</tr>
<tr id="S4.T4.2.2.2.11" class="ltx_tr">
<td id="S4.T4.2.2.2.11.1" class="ltx_td ltx_align_center">rand</td>
<td id="S4.T4.2.2.2.11.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.11.3" class="ltx_td ltx_align_center">4</td>
<td id="S4.T4.2.2.2.11.4" class="ltx_td ltx_align_center ltx_border_r">✗</td>
<td id="S4.T4.2.2.2.11.5" class="ltx_td ltx_align_center">88.55</td>
</tr>
<tr id="S4.T4.2.2.2.12" class="ltx_tr">
<td id="S4.T4.2.2.2.12.1" class="ltx_td ltx_align_center ltx_border_t">eye</td>
<td id="S4.T4.2.2.2.12.2" class="ltx_td ltx_align_center ltx_border_t">Clf</td>
<td id="S4.T4.2.2.2.12.3" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T4.2.2.2.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✓</td>
<td id="S4.T4.2.2.2.12.5" class="ltx_td ltx_align_center ltx_border_t">87.88</td>
</tr>
<tr id="S4.T4.2.2.2.13" class="ltx_tr">
<td id="S4.T4.2.2.2.13.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.13.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.13.3" class="ltx_td ltx_align_center">3</td>
<td id="S4.T4.2.2.2.13.4" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T4.2.2.2.13.5" class="ltx_td ltx_align_center">88.74</td>
</tr>
<tr id="S4.T4.2.2.2.14" class="ltx_tr">
<td id="S4.T4.2.2.2.14.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.14.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.14.3" class="ltx_td ltx_align_center">4</td>
<td id="S4.T4.2.2.2.14.4" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T4.2.2.2.14.5" class="ltx_td ltx_align_center">88.67</td>
</tr>
<tr id="S4.T4.2.2.2.15" class="ltx_tr">
<td id="S4.T4.2.2.2.15.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" rowspan="4"><span id="S4.T4.2.2.2.15.1.1" class="ltx_text">last</span></td>
<td id="S4.T4.2.2.2.15.2" class="ltx_td ltx_align_center ltx_border_t">eye</td>
<td id="S4.T4.2.2.2.15.3" class="ltx_td ltx_align_center ltx_border_t">Clf</td>
<td id="S4.T4.2.2.2.15.4" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="S4.T4.2.2.2.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✓</td>
<td id="S4.T4.2.2.2.15.6" class="ltx_td ltx_align_center ltx_border_t">88.31</td>
</tr>
<tr id="S4.T4.2.2.2.16" class="ltx_tr">
<td id="S4.T4.2.2.2.16.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.16.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.16.3" class="ltx_td ltx_align_center">3</td>
<td id="S4.T4.2.2.2.16.4" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T4.2.2.2.16.5" class="ltx_td ltx_align_center">88.13</td>
</tr>
<tr id="S4.T4.2.2.2.17" class="ltx_tr">
<td id="S4.T4.2.2.2.17.1" class="ltx_td ltx_align_center">eye</td>
<td id="S4.T4.2.2.2.17.2" class="ltx_td ltx_align_center">Clf</td>
<td id="S4.T4.2.2.2.17.3" class="ltx_td ltx_align_center">4</td>
<td id="S4.T4.2.2.2.17.4" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T4.2.2.2.17.5" class="ltx_td ltx_align_center"><span id="S4.T4.2.2.2.17.5.1" class="ltx_text ltx_font_bold">89.18</span></td>
</tr>
<tr id="S4.T4.2.2.2.18" class="ltx_tr">
<td id="S4.T4.2.2.2.18.1" class="ltx_td ltx_align_center ltx_border_b">eye</td>
<td id="S4.T4.2.2.2.18.2" class="ltx_td ltx_align_center ltx_border_b">Clf</td>
<td id="S4.T4.2.2.2.18.3" class="ltx_td ltx_align_center ltx_border_b">32</td>
<td id="S4.T4.2.2.2.18.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">✓</td>
<td id="S4.T4.2.2.2.18.5" class="ltx_td ltx_align_center ltx_border_b">88.40</td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span><span id="S4.T4.8.1" class="ltx_text ltx_font_bold">Ablation studies on CelebA dataset with domains given by a priori knowledge or online clustering procedures</span>. In the <span id="S4.T4.9.2" class="ltx_text ltx_markedasmath ltx_font_bold">A</span> init column, “eye” stands for identity matrix and “rand” for random. The third column specifies the clustering, <span id="S4.T4.10.3" class="ltx_ERROR undefined">\ie</span>clusters generated with K-means or the teacher-student classifier (“Clf”).</figcaption>
</figure>
</section>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Comparison with the state of the art</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Here we compare our FedCG with state-of-the-art results on both CelebA and FEMNIST. Unfortunately, since different methods employ different settings and client splits, it is difficult to provide an extensive comparison on these datasets. For this reason, on CelebA we compare our model directly with the FedAvg baseline, while for FEMNIST we compare it with FedAvg, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> adds a proximal term to the standard FedAvg algorithm for improving the model stability when applied over heterogeneous systems and data. SCAFFOLD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> uses variance reduction for minimizing the impact of the drift in the updates of each client. We report the results of FedProx and SCAFFOLD shown in their original papers, while for FedAvg we use our baseline. For our method, we use the domain-specific parameters applied on the last layer, <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="D=4" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mrow id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">D</mi><mo id="S4.SS3.p1.1.m1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><eq id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝐷</ci><cn type="integer" id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">D=4</annotation></semantics></math>, soft domain assignments at test time and the adjacency matrix initialized as identity.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">The experimental comparison is reported in Table <a href="#S4.T5" title="Table 5 ‣ 4.3 Comparison with the state of the art ‣ 4 Experiments ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. FedCG largely outperforms FedAvg in both scenarios. It achieves <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="89.18\%" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mn id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">89.18</mn><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">89.18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">89.18\%</annotation></semantics></math> accuracy compared to 86.88% of FedAvg on CelebA, and <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="83.41\%" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mn id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">83.41</mn><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">83.41</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">83.41\%</annotation></semantics></math> accuracy compared to 77.81% of FedAvg on FEMNIST. This latter improvement (+5.6%) is remarkable given the higher complexity of the classification task in FEMNIST. Comparing FedCG with FedProx and SCAFFOLD on FEMNIST, we can see that FedCG outperforms FedProx by a large margin (+8.41%) while being slightly inferior to SCAFFOLD (<span id="S4.SS3.p2.2.1" class="ltx_ERROR undefined">\ie</span>-0.79%). However, both FedProx and SCAFFOLD present results under different federated protocols, <span id="S4.SS3.p2.2.2" class="ltx_ERROR undefined">\eg</span>FedProx runs the algorithm for 200 rounds of 10 clients while SCAFFOLD performs 1000 rounds with 20 clients each. Despite that, our comparisons demonstrate that FedCG is far superior to the standard FedAvg baselines, due to its better ability to address the statistical heterogeneity across clients, while showing either superior (<span id="S4.SS3.p2.2.3" class="ltx_ERROR undefined">\wrt</span>FedProx) or competitive (<span id="S4.SS3.p2.2.4" class="ltx_ERROR undefined">\wrt</span>SCAFFOLD) results with other state-of-the-art algorithms trained on different settings.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.2" class="ltx_p">As a final analysis, we verify the role of the domain-specific components by checking the final values of the <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\lambda</annotation></semantics></math> scalar of Eq. (<a href="#S3.E4" title="In 3.2 Cluster-specific Models ‣ 3 Cluster-driven Graph Federated Learning ‣ Cluster-driven Graph Federated Learning over Multiple Domains" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), which weighs the importance of the domain-specific residual. Interestingly, in CelebA, where the concept of heterogeneity is less marked, the <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\lambda</annotation></semantics></math> value in the last convolutional layer is 0.3. The final value for FEMNIST, instead, where the heterogeneity across clients is clearer due to the different writing styles, is 2.1. That shows FedCG tailors the use of the domain-specific residual to the specific characteristics of the target dataset and the consequent heterogeneity across the discovered domains.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<table id="S4.T5.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T5.1.1" class="ltx_tr">
<td id="S4.T5.1.1.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T5.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></td>
<td id="S4.T5.1.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T5.1.1.2.1" class="ltx_text ltx_font_bold">Model</span></td>
<td id="S4.T5.1.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T5.1.1.3.1" class="ltx_text ltx_font_bold">Accuracy (%)</span></td>
</tr>
<tr id="S4.T5.1.2" class="ltx_tr">
<td id="S4.T5.1.2.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="2"><span id="S4.T5.1.2.1.1" class="ltx_text">CelebA</span></td>
<td id="S4.T5.1.2.2" class="ltx_td ltx_align_left ltx_border_t">FedAvg</td>
<td id="S4.T5.1.2.3" class="ltx_td ltx_align_center ltx_border_t">86.88</td>
</tr>
<tr id="S4.T5.1.3" class="ltx_tr">
<td id="S4.T5.1.3.1" class="ltx_td ltx_align_left">FedCG</td>
<td id="S4.T5.1.3.2" class="ltx_td ltx_align_center"><span id="S4.T5.1.3.2.1" class="ltx_text ltx_font_bold">89.18</span></td>
</tr>
<tr id="S4.T5.1.4" class="ltx_tr">
<td id="S4.T5.1.4.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="2"><span id="S4.T5.1.4.1.1" class="ltx_text">FEMNIST</span></td>
<td id="S4.T5.1.4.2" class="ltx_td ltx_align_left ltx_border_t">FedAvg</td>
<td id="S4.T5.1.4.3" class="ltx_td ltx_align_center ltx_border_t">77.81</td>
</tr>
<tr id="S4.T5.1.5" class="ltx_tr">
<td id="S4.T5.1.5.1" class="ltx_td ltx_align_left"><span id="S4.T5.1.5.1.1" class="ltx_text ltx_font_bold">FedCG</span></td>
<td id="S4.T5.1.5.2" class="ltx_td ltx_align_center"><span id="S4.T5.1.5.2.1" class="ltx_text ltx_font_bold">83.41</span></td>
</tr>
<tr id="S4.T5.1.6" class="ltx_tr">
<td id="S4.T5.1.6.1" class="ltx_td ltx_align_left">
<span id="S4.T5.1.6.1.1" class="ltx_ERROR undefined">\cdashline</span>2-3</td>
<td id="S4.T5.1.6.2" class="ltx_td ltx_align_left">FedProx</td>
<td id="S4.T5.1.6.3" class="ltx_td ltx_align_center">75.00</td>
</tr>
<tr id="S4.T5.1.7" class="ltx_tr">
<td id="S4.T5.1.7.1" class="ltx_td ltx_align_left ltx_border_b">
<span id="S4.T5.1.7.1.1" class="ltx_ERROR undefined">\cdashline</span>2-3</td>
<td id="S4.T5.1.7.2" class="ltx_td ltx_align_left ltx_border_b">SCAFFOLD</td>
<td id="S4.T5.1.7.3" class="ltx_td ltx_align_center ltx_border_b">84.20</td>
</tr>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span><span id="S4.T5.3.1" class="ltx_text ltx_font_bold">Comparison with the state of the art on CelebA and FEMNIST.</span> We separate the methods according to their setting.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusions</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we introduced FedCG, the first cluster-driven approach addressing statistical heterogeneity in federated learning with Graph Convolutional Neural Networks. FedCG uses an iterative clustering algorithm based on teacher and student domain classifiers. This clustering procedure serves to discover different input distributions, <span id="S5.p1.1.1" class="ltx_ERROR undefined">\ie</span>domains, and to instantiate domain-specific parameters accordingly. The domain-specific parameters are connected through a GCN that enables them to interact and share knowledge during training. These parameters influence the activation of the main, domain-agnostic, network thanks to weighted residual activations. Thanks to the domain classifiers and connections of the GCN, new input distributions and unseen users can be addressed at test time via their domain soft-assignment scores. Experimental results show that FedCG outperforms the FedAvg on multiple benchmarks, demonstrating the efficacy of each component.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acknowledgments <span id="S5.p2.1.1.1" class="ltx_text ltx_font_medium">
This work has been partially funded by the ERC 853489 - DEXIM, the ERC 802554 - SPECGEO, the ERC 637076 RoboExNovo, the DFG – EXC number 2064/1 – Project number 390727645, and the MIUR under grant “Dipartimenti di eccellenza 2018-2022”.
</span></span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.5.1" class="ltx_text" style="font-size:90%;">
Martín Abadi, Paul Barham, Jianmin Chen, Zhifeng Chen, Andy Davis, Jeffrey
Dean, Matthieu Devin, Sanjay Ghemawat, Geoffrey Irving, Michael Isard, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.6.1" class="ltx_text" style="font-size:90%;">Tensorflow: A system for large-scale machine learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.7.5" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.4" class="ltx_text ltx_font_italic" style="font-size:90%;">12th <math id="bib.bib1.1.1.m1.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib1.1.1.m1.1a"><mo stretchy="false" id="bib.bib1.1.1.m1.1.1" xref="bib.bib1.1.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.1.1.m1.1b"><ci id="bib.bib1.1.1.m1.1.1.cmml" xref="bib.bib1.1.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.1.1.m1.1c">\{</annotation></semantics></math>USENIX<math id="bib.bib1.2.2.m2.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib1.2.2.m2.1a"><mo stretchy="false" id="bib.bib1.2.2.m2.1.1" xref="bib.bib1.2.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.2.2.m2.1b"><ci id="bib.bib1.2.2.m2.1.1.cmml" xref="bib.bib1.2.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.2.2.m2.1c">\}</annotation></semantics></math> symposium on operating systems design and
implementation (<math id="bib.bib1.3.3.m3.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib1.3.3.m3.1a"><mo stretchy="false" id="bib.bib1.3.3.m3.1.1" xref="bib.bib1.3.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.3.3.m3.1b"><ci id="bib.bib1.3.3.m3.1.1.cmml" xref="bib.bib1.3.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.3.3.m3.1c">\{</annotation></semantics></math>OSDI<math id="bib.bib1.4.4.m4.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib1.4.4.m4.1a"><mo stretchy="false" id="bib.bib1.4.4.m4.1.1" xref="bib.bib1.4.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.4.4.m4.1b"><ci id="bib.bib1.4.4.m4.1.1.cmml" xref="bib.bib1.4.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.4.4.m4.1c">\}</annotation></semantics></math> 16)</span><span id="bib.bib1.8.6" class="ltx_text" style="font-size:90%;">, pages 265–283, 2016.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Sebastian Caldas, Peter Wu, Tian Li, Jakub Konečnỳ, H Brendan
McMahan, Virginia Smith, and Ameet Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Leaf: A benchmark for federated settings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1812.01097</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Sebastian Caldas, Peter Wu, Tian Li, Jakub Konečnỳ, H Brendan
McMahan, Virginia Smith, and Ameet Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Leaf: A benchmark for federated settings.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">https://github.com/TalwalkarLab/leaf, 2018.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Rich Caruana.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Multitask learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Machine learning</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 28(1):41–75, 1997.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Fei Chen, Mi Luo, Zhenhua Dong, Zhenguo Li, and Xiuqiang He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Federated meta-learning with fast convergence and efficient
communication.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1802.07876</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and Andre Van Schaik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Emnist: Extending mnist to handwritten letters.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2017 International Joint Conference on Neural Networks
(IJCNN)</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, pages 2921–2926. IEEE, 2017.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Luca Corinzia and Joachim M Buhmann.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Variational federated multi-task learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1906.06268</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin,
editors, </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, volume 33,
pages 3557–3568. Curran Associates, Inc., 2020.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Model-agnostic meta-learning for fast adaptation of deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1703.03400</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Geoffrey Hinton, Oriol Vinyals, and Jeffrey Dean.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Distilling the knowledge in a neural network.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib10.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">NIPS Deep Learning and Representation Learning Workshop</span><span id="bib.bib10.5.3" class="ltx_text" style="font-size:90%;">,
2015.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Measuring the effects of non-identical data distribution for
federated visual classification, 2019.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Federated visual classification with real-world data distribution.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In Andrea Vedaldi, Horst Bischof, Thomas Brox, and Jan-Michael Frahm,
editors, </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Computer Vision – ECCV 2020</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, pages 76–92, Cham, 2020.
Springer International Publishing.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Sergey Ioffe and Christian Szegedy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Batch normalization: Accelerating deep network training by reducing
internal covariate shift.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International conference on machine learning</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, pages
448–456. PMLR, 2015.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Yihan Jiang, Jakub Konečnỳ, Keith Rush, and Sreeram Kannan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Improving federated learning personalization via model agnostic meta
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.12488</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Keith Bonawitz, Zachary Charles, Graham Cormode,
Rachel Cummings, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Advances and open problems in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1912.04977</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Scaffold: Stochastic controlled averaging for federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, pages
5132–5143. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Mikhail Khodak, Maria-Florina F Balcan, and Ameet S Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Adaptive gradient-based meta-learning methods.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, editors, </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural
Information Processing Systems</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, volume 32. Curran Associates, Inc., 2019.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Thomas N Kipf and Max Welling.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Semi-supervised classification with graph convolutional networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Jakub Konečnỳ, H Brendan McMahan, Felix X Yu, Peter Richtárik,
Ananda Theertha Suresh, and Dave Bacon.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Federated learning: Strategies for improving communication
efficiency.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1610.05492</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Yann LeCun and Corinna Cortes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">MNIST handwritten digit database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">2010.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Daliang Li and Junpu Wang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Fedmd: Heterogenous federated learning via model distillation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Workshop on Federated Learning for Data Privacy and
Confidentiality</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Federated learning: Challenges, methods, and future directions.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Signal Processing Magazine</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 37(3):50–60, 2020.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Federated optimization in heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In I. Dhillon, D. Papailiopoulos, and V. Sze, editors, </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of Machine Learning and Systems</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, volume 2, pages 429–450, 2020.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V.
Smithy.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Feddane: A federated newton-type method.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2019 53rd Asilomar Conference on Signals, Systems, and
Computers</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, pages 1227–1231, 2019.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Deep learning face attributes in the wild.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib25.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of International Conference on Computer Vision
(ICCV)</span><span id="bib.bib25.5.3" class="ltx_text" style="font-size:90%;">, December 2015.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
James MacQueen et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Some methods for classification and analysis of multivariate
observations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the fifth Berkeley symposium on mathematical
statistics and probability</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, volume 1, pages 281–297. Oakland, CA, USA,
1967.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Arun Mallya, Dillon Davis, and Svetlana Lazebnik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Piggyback: Adapting a single network to multiple tasks by learning to
mask weights.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the European Conference on Computer Vision
(ECCV)</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 67–82, 2018.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Massimiliano Mancini, Samuel Rota Bulo, Barbara Caputo, and Elisa Ricci.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Adagraph: Unifying predictive and continuous domain adaptation
through graphs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, pages 6568–6577, 2019.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Massimiliano Mancini, Elisa Ricci, Barbara Caputo, and Samuel Rota Bulo.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Boosting binary masks for multi-domain learning through affine
transformations.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Machine Vision and Applications</span><span id="bib.bib29.4.2" class="ltx_text" style="font-size:90%;">, 31(6):1–14, 2020.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y
Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. 20th Int. Conf. Artificial Intelligence and
Statistics</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, pages 1273–1282. PMLR, 2017.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Guangxu Mei, Ziyu Guo, Shijun Liu, and Li Pan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Sgnn: A graph neural network based federated learning approach by
hiding structure.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2019 IEEE International Conference on Big Data (Big Data)</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">,
pages 2560–2568. IEEE, 2019.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Mehryar Mohri, Gary Sivek, and Ananda Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Agnostic federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text" style="font-size:90%;">In Kamalika Chaudhuri and Ruslan Salakhutdinov, editors, </span><span id="bib.bib32.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 36th International Conference on Machine Learning</span><span id="bib.bib32.5.3" class="ltx_text" style="font-size:90%;">,
volume 97 of </span><span id="bib.bib32.6.4" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of Machine Learning Research</span><span id="bib.bib32.7.5" class="ltx_text" style="font-size:90%;">, pages
4615–4625. PMLR, 09–15 Jun 2019.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Alex Nichol, Joshua Achiam, and John Schulman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">On first-order meta-learning algorithms.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1803.02999</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Mohammad Norouzi, David J Fleet, and Russ R Salakhutdinov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Hamming distance metric learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, pages
1061–1069, 2012.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban
Desmaison, Andreas Kopf, Edward Yang, Zachary DeVito, Martin Raison, Alykhan
Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith
Chintala.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Pytorch: An imperative style, high-performance deep learning library.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text" style="font-size:90%;">In H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, editors, </span><span id="bib.bib35.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural
Information Processing Systems 32</span><span id="bib.bib35.5.3" class="ltx_text" style="font-size:90%;">, pages 8024–8035. Curran Associates,
Inc., 2019.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Sylvestre-Alvise Rebuffi, Hakan Bilen, and Andrea Vedaldi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Learning multiple visual domains with residual adapters.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib36.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 31st International Conference on Neural
Information Processing Systems</span><span id="bib.bib36.5.3" class="ltx_text" style="font-size:90%;">, pages 506–516, 2017.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Sylvestre-Alvise Rebuffi, Hakan Bilen, and Andrea Vedaldi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Efficient parametrization of multi-domain deep neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, pages 8119–8127, 2018.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Amirhossein Reisizadeh, Aryan Mokhtari, Hamed Hassani, Ali Jadbabaie, and
Ramtin Pedarsani.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Fedpaq: A communication-efficient federated learning method with
periodic averaging and quantization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib38.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Artificial Intelligence and
Statistics</span><span id="bib.bib38.5.3" class="ltx_text" style="font-size:90%;">, pages 2021–2031. PMLR, 2020.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Amir Rosenfeld and John K Tsotsos.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Incremental learning through deep adaptation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE transactions on pattern analysis and machine intelligence</span><span id="bib.bib39.4.2" class="ltx_text" style="font-size:90%;">,
42(3):651–663, 2018.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Felix Sattler, Klaus-Robert Müller, and Wojciech Samek.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Clustered federated learning: Model-agnostic distributed multitask
optimization under privacy constraints.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib40.4.2" class="ltx_text" style="font-size:90%;">,
2020.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Federated multi-task learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib41.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib41.5.3" class="ltx_text" style="font-size:90%;">, pages
4424–4434, 2017.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Dmitry Ulyanov, Andrea Vedaldi, and Victor Lempitsky.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Deep image prior.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib42.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">CVPR</span><span id="bib.bib42.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Binghui Wang, Ang Li, Hai Li, and Yiran Chen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Graphfl: A federated learning framework for semi-supervised node
classification on graphs, 2020.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Ming Xie, Guodong Long, Tao Shen, Tianyi Zhou, Xianzhi Wang, and Jing Jiang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Multi-center federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2005.01026</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Asano YM., Rupprecht C., and Vedaldi A.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Self-labelling via simultaneous clustering and representation
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib45.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib45.5.3" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Chiyuan Zhang, Samy Bengio, Moritz Hardt, Benjamin Recht, and Oriol Vinyals.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Understanding deep learning requires rethinking generalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib46.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">ICLR</span><span id="bib.bib46.5.3" class="ltx_text" style="font-size:90%;">, 2017.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Longfei Zheng, Jun Zhou, Chaochao Chen, Bingzhe Wu, Li Wang, and Benyu Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Asfgnn: Automated separated-federated graph neural network.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Peer-to-Peer Networking and Applications</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, pages 1–13, 2021.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2104.14627" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2104.14628" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2104.14628">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2104.14628" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2104.14629" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  9 03:30:53 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
