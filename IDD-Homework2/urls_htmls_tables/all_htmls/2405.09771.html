<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.09771] Harmonizing Generalization and Personalization in Federated Prompt Learning</title><meta property="og:description" content="Federated Prompt Learning (FPL) incorporates large pre-trained Vision-Language models (VLM) into federated learning through prompt tuning. The transferable representations and remarkable generalization capacity of VLM …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Harmonizing Generalization and Personalization in Federated Prompt Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Harmonizing Generalization and Personalization in Federated Prompt Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.09771">

<!--Generated on Wed Jun  5 17:27:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Harmonizing Generalization and Personalization 
<br class="ltx_break">in Federated Prompt Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tianyu Cui
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hongxia Li
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jingya Wang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ye Shi
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated Prompt Learning (FPL) incorporates large pre-trained Vision-Language models (VLM) into federated learning through prompt tuning. The transferable representations and remarkable generalization capacity of VLM make them highly compatible with the integration of federated learning. Addressing data heterogeneity in federated learning requires personalization, but excessive focus on it across clients could compromise the model’s ability to generalize effectively. To preserve the impressive generalization capability of VLM, it is crucial to strike a balance between personalization and generalization in FPL. To tackle this challenge, we proposed <span id="id1.id1.1" class="ltx_text ltx_font_bold">Fed</span>erated <span id="id1.id1.2" class="ltx_text ltx_font_bold">P</span>rompt Learning with CLIP <span id="id1.id1.3" class="ltx_text ltx_font_bold">G</span>eneralization and low-rank <span id="id1.id1.4" class="ltx_text ltx_font_bold">P</span>ersonalization (FedPGP), which employs pre-trained CLIP to provide knowledge-guidance on the global prompt for improved generalization and incorporates a low-rank adaptation term to personalize the global prompt. Further, FedPGP integrates a prompt-wise contrastive loss to achieve knowledge guidance and personalized adaptation simultaneously, enabling a harmonious balance between personalization and generalization in FPL. We conduct extensive experiments on various datasets to explore base-to-novel generalization in both category-level and domain-level scenarios with heterogeneous data, showing the superiority of FedPGP in balancing generalization and personalization.</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite> has been proposed as an efficient collaborative learning strategy, enabling clients to jointly train a global model while preserving data privacy. In this context, the ability of large pre-trained Vision-Language models (VLM) like CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite> and ALIGN <cite class="ltx_cite ltx_citemacro_citep">(Jia et al., <a href="#bib.bib23" title="" class="ltx_ref">2021</a>)</cite> to learn transferable representations across downstream tasks makes them a natural fit for integration with federated learning. This collaborative approach not only harnesses the outstanding performance and generalization capabilities of pre-trained models but also ensures efficient and privacy-preserving global model training across multiple clients.
However, due to the millions of parameters in VLM, fine-tuning the entire model in federated learning leads to high communication costs and memory footprint issues. Prompt tuning addresses these challenges by adapting pre-trained models to diverse downstream tasks with a reduced parameter count, and its integration of federated learning has been explored in previous research <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib60" title="" class="ltx_ref">2022</a>; Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>. We term the combination of prompt-tuning and federated learning as Federated Prompt Learning (FPL) for simplicity. Currently, studies in FPL have not been thoroughly explored in terms of personalization and generalization. Methods derived from traditional federated learning studies fail to capture the multi-modality of VLM, which hinders a direct transfer of these methods into FPL.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In federated learning, it is essential to account for the generalization capability to unseen domains or categories. <span id="S1.p2.1.1" class="ltx_text" style="color:#000000;"> However, existing studies in FL, like <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib40" title="" class="ltx_ref">2022</a>; Liu et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>; Zhang et al., <a href="#bib.bib57" title="" class="ltx_ref">2021</a>)</cite>, have struggled to achieve satisfactory results in evaluating generalization on target datasets in unseen domains.</span>
<span id="S1.p2.1.2" class="ltx_text" style="color:#000000;"> With the help of VLM which has strong generalization performance, this problem may be solved.
Unfortunately, the generalization issues in prompt-based VLM have been revealed in recent research <cite class="ltx_cite ltx_citemacro_citep">(Khattak et al., <a href="#bib.bib24" title="" class="ltx_ref">2023a</a>, <a href="#bib.bib25" title="" class="ltx_ref">b</a>)</cite>.</span>
For instance, CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite> struggles with generalizing to unseen categories within the same dataset due to overfitting, resulting in lower test accuracy on novel categories compared to the zero-shot CLIP baseline with a handcrafted prompt.
PromptSRC <cite class="ltx_cite ltx_citemacro_citep">(Khattak et al., <a href="#bib.bib25" title="" class="ltx_ref">2023b</a>)</cite> addresses this issue with self-regularization constraints, maximizing the mutual agreement between prompted and frozen VLM features. However, the generalization of FPL is still an open challenge. FedTPG <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al., <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite> takes a step toward exploring generalization by learning a unified prompt generation network among multiple clients but disregards the data heterogeneity.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Data heterogeneity results in another challenge in federated learning, where the data distributions among clients are not independently and identically distributed (Non-IID). This leads to discrepancies between local and global optimization objectives, making it difficult for a single global prompt to adapt to the varied local distributions.
In the endeavor to learn personalized models, pFedPrompt <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>)</cite> incorporates personalized attention modules into FPL while learning a consensus among users through shared text prompts.
<span id="S1.p3.1.1" class="ltx_text" style="color:#000000;"> Nevertheless, if we employ strong personalized techniques to fully adapt the prompts to local distributions, it may lead to the loss of inherent generalization in VLM.</span>
This raises the question we aim to explore:</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_italic">How can we strike a balance between generalization and personalization in FPL?</span></p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To overcome the problems outlined above, we proposed <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">Fed</span>erated <span id="S1.p5.1.2" class="ltx_text ltx_font_bold">P</span>rompt Learning with CLIP <span id="S1.p5.1.3" class="ltx_text ltx_font_bold">G</span>eneralization
and low-rank <span id="S1.p5.1.4" class="ltx_text ltx_font_bold">P</span>ersonalization (FedPGP), an effective method that reaches a balance between personalization and generalization.
In FedPGP, each client learns a personalized prompt, combining a global prompt and an adaptation term to accommodate heterogeneous local distributions. The incorporation of the adaptation term allows fine-tuning of the global prompt for specific client needs.
To enhance prompt generalization, we incorporate category-agnostic knowledge from CLIP, aligning the global prompt in each client towards a unified direction.
</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">To balance generalization and personalization, we utilize a low-rank decomposition for the adaptation term,
ensuring robust generalization capabilities in comparison to a full-rank term.
To enable personalized prompts better access to client-specific knowledge, we aim to separate representations of global and personalized prompts for better personalization.
Considering this and the knowledge-guidance from CLIP to global prompt, we introduce an additional contrastive loss into the optimization objective to further balance personalization and generalization of our FedPGP. This involves treating global prompt representations with personalized ones as negative pairs for personalization, while simultaneously treating them as positive pairs with the representation of handcrafted prompt of CLIP for generalization.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Our main contributions are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We are the first to consider both personalization and generalization in federated prompt learning. <span id="S1.I1.i1.p1.1.1" class="ltx_text" style="color:#000000;"> We aim to learn a personalized prompt for each client in heterogeneous federated scenarios while preserving the remarkble generalization capacity in Visual-Language models, leading to the balance of generalization and personalization.</span></p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose FedPGP, utilizing low-rank decomposition adaptation to flexibly adjust the global prompt to heterogeneous local distributions, which prevents overfitting on local datasets.
Additionally, we integrate an extra contrastive loss, treating representations of global and personalized prompts as negative pairs and representations of global and handcrafted prompts as positive pairs.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct extensive experiments on widely adopted datasets to investigate the base-to-novel generalization of FedPGP on both category-level and domain-level in the case of heterogeneous data. Our comparative experimental results demonstrate FedPGP’s superiority in harmonizing generalization and personalization.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Federated Learning</span>
This subsection mainly introduces the research on personalization and generalization in federated learning.
Personalized federated learning (PFL) algorithms, rather than creating a universal model for all clients, tackle data heterogeneity by learning customized models for each client. Various strategies for achieving PFL have been suggested in previous studies. Some existing methods combine global model optimization with additional local model customization involving local fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib53" title="" class="ltx_ref">2019</a>; Mansour et al., <a href="#bib.bib37" title="" class="ltx_ref">2020</a>; Tan et al., <a href="#bib.bib51" title="" class="ltx_ref">2022a</a>)</cite>, regularization <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>, <a href="#bib.bib32" title="" class="ltx_ref">2021b</a>; T Dinh et al., <a href="#bib.bib50" title="" class="ltx_ref">2020</a>)</cite>, parameter decomposition <cite class="ltx_cite ltx_citemacro_citep">(Jeong &amp; Hwang, <a href="#bib.bib22" title="" class="ltx_ref">2022</a>; Hyeon-Woo et al., <a href="#bib.bib21" title="" class="ltx_ref">2021</a>; Arivazhagan et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, parameter generation <cite class="ltx_cite ltx_citemacro_citep">(Shamsian et al., <a href="#bib.bib48" title="" class="ltx_ref">2021</a>; Ma et al., <a href="#bib.bib36" title="" class="ltx_ref">2022</a>; Li et al., <a href="#bib.bib28" title="" class="ltx_ref">2023</a>)</cite>, and clustering methods for client grouping <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>; Zhang et al., <a href="#bib.bib59" title="" class="ltx_ref">2020</a>; Sattler et al., <a href="#bib.bib47" title="" class="ltx_ref">2020</a>; Zhang et al., <a href="#bib.bib58" title="" class="ltx_ref">2022</a>; Cao et al., <a href="#bib.bib5" title="" class="ltx_ref">2023</a>; Cai et al., <a href="#bib.bib4" title="" class="ltx_ref">2024</a>)</cite>. The theoretical significance of PFL was pointed out by <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib19" title="" class="ltx_ref">2023</a>)</cite>. To be specific,
FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, FedBABU <cite class="ltx_cite ltx_citemacro_citep">(Oh et al., <a href="#bib.bib42" title="" class="ltx_ref">2021</a>)</cite>, and FedRep <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite> share the base layers while learning personalized classifier heads locally. FedBN <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib33" title="" class="ltx_ref">2021c</a>)</cite> uses local batch normalization to alleviate feature shift before averaging models. FedRod <cite class="ltx_cite ltx_citemacro_citep">(Chen &amp; Chao, <a href="#bib.bib6" title="" class="ltx_ref">2021</a>)</cite> proposed learning a global predictor for generic FL and a local predictor for personalized FL.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Many existing studies in federated learning commonly assume the test dataset is a subset of the client dataset. However, a research gap exists for scenarios where the target dataset (i.e., the test dataset) is not included in the training process. This scenario is also referred to as domain generalization in centralized machine learning.
FedSR <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> employs regularization techniques for simplified data representation, intending to achieve improved generalization capabilities. ELCFS <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib34" title="" class="ltx_ref">2021</a>)</cite> tackled federated domain generalization with continuous frequency space interpolation and the boundary-oriented episodic learning scheme. FedADG <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib57" title="" class="ltx_ref">2021</a>)</cite> utilizes federated adversarial learning for dynamic universal feature representation. Unlike traditional federated learning approaches, we are the first to consider both personalization and generalization in the context of FPL.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Federated Prompt Learning</span>
Prompt tuning is a technique employed to adapt pre-trained models to diverse downstream tasks. For instance, CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite> uses tunable text prompts to replace the fixed template in CLIP, and CoCoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib61" title="" class="ltx_ref">2022a</a>)</cite> utilizes image feature to instruct the optimization of the soft text prompt.
ProGrad <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib63" title="" class="ltx_ref">2023</a>)</cite> selectively updates prompts based on aligned gradients with general knowledge to prevent forgetting essential information from VLMs.
Some works also incorporate prompt tuning into federated learning. PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite> introduced prompt learning into Federated Learning.
FedPR <cite class="ltx_cite ltx_citemacro_citep">(Feng et al., <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> focuses on learning federated visual prompts within the null space of the global prompt for MRI reconstruction.
pFedPG <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib56" title="" class="ltx_ref">2023</a>)</cite> employs a client-specific prompt generator on the server side for personalized promptsm, while FedTPG <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al., <a href="#bib.bib45" title="" class="ltx_ref">2023</a>)</cite> also trains a global prompt generation network to enhance generalization.
pFedprompt <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>)</cite> maintains a non-parametric personalized attention module for each client to generate local personalized spatial visual features. FedOTP <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite> employs unbalanced Optimal Transport to promote the collaboration between global and local prompts across heterogeneous clients. Designed for domain discrepancy, FedAPT <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a href="#bib.bib54" title="" class="ltx_ref">2023</a>)</cite> unlocks specific domain knowledge for each test sample to provide personalized prompts, and Fed-DPT <cite class="ltx_cite ltx_citemacro_citep">(Su et al., <a href="#bib.bib49" title="" class="ltx_ref">2022</a>)</cite> applies both visual and textual prompt tuning to facilitate domain adaptation over decentralized data. However, these methods overlook the aspect of generalization.
We propose FedPGP, a framework that effectively balances personalization and generalization in FPL.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Contrastive learning</span>
Contrastive learning methodologies have gained significant attention by consistently attaining state-of-the-art outcomes results in the field of visual representation learning <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib7" title="" class="ltx_ref">2020a</a>, <a href="#bib.bib8" title="" class="ltx_ref">b</a>; Xie et al., <a href="#bib.bib55" title="" class="ltx_ref">2022</a>)</cite>.
The fundamental principle behind contrastive learning is minimize the distance between representations generated from diverse augmentations of the same image (positive pairs) while simultaneously maximizing the distance between representations obtained from augmented views of different images (negative pairs).
A proportion of research <cite class="ltx_cite ltx_citemacro_citep">(Tan et al., <a href="#bib.bib52" title="" class="ltx_ref">2022b</a>; Li et al., <a href="#bib.bib30" title="" class="ltx_ref">2021a</a>; Mu et al., <a href="#bib.bib39" title="" class="ltx_ref">2023</a>)</cite> combines contrastive learning with federated learning, which improves the local training process and achieves higher model effectiveness. FedPCL <cite class="ltx_cite ltx_citemacro_citep">(Tan et al., <a href="#bib.bib52" title="" class="ltx_ref">2022b</a>)</cite> employs prototype-wise contrastive learning for client-specific representations, promoting alignment with global and local prototypes to enhance knowledge sharing.
MOON <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib30" title="" class="ltx_ref">2021a</a>)</cite> minimizes the distance between local and global model representations while increasing the distance from the previous local model’s representation.
Different from model-wise of MOON and prototype-wise of FedPCL, our FedPGP introduces a novel prompt-wise contrastive methodology. In addition, unlike previous work focusing on aligning the global and local components, FedPGP treats representations of global and personalized prompts as negative pairs and representations of global and handcrafted prompts as positive pairs.</p>
</div>
</section>
<section id="S3" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we delve into the details of our proposed FedPGP, illustrated in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed Method ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
FedPGP leverages CLIP knowledge-guidance and low-rank adaptation with an additional contastive loss to balance generalization and personalization.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2405.09771/assets/x1.png" id="S3.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="220" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Pipeline of FedPGP. On the left, clients send global prompts to the server for aggregation while retaining adaptation term locally. The right shows the workflow of CLIP knowledge-guidance and low-rank adaptation with an additional contastive loss to balance generalization and personalization.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminaries of Prompt Learning</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.10" class="ltx_p">Prompt learning methods <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib61" title="" class="ltx_ref">a</a>)</cite> offer an efficient approach to adapting pre-trained models like CLIP to downstream tasks by training a part of the parameters in the prompt. Unlike the zero-shot transfer that utilizes a fixed word embedding <math id="S3.SS1.p1.1.m1.4" class="ltx_Math" alttext="W=\{w_{1},w_{2},...,w_{l}\}" display="inline"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><mi id="S3.SS1.p1.1.m1.4.4.5" xref="S3.SS1.p1.1.m1.4.4.5.cmml">W</mi><mo id="S3.SS1.p1.1.m1.4.4.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.3.3.4" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">w</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.4.4.3.3.7" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.2" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml">w</mi><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.4.4.3.3.8" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.4"></eq><ci id="S3.SS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.p1.1.m1.4.4.5">𝑊</ci><set id="S3.SS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑤</ci><cn type="integer" id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2">𝑤</ci><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">W=\{w_{1},w_{2},...,w_{l}\}</annotation></semantics></math> mapped from a hand-crafted prompt (e.g., “a photo of a ⟨label⟩”), prompt learning replaces a set of <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">M</annotation></semantics></math> continuous context vectors <math id="S3.SS1.p1.3.m3.3" class="ltx_Math" alttext="p=\{p_{1},...,p_{M}\}\in\mathbb{R}^{d\times k}" display="inline"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.4" xref="S3.SS1.p1.3.m3.3.3.4.cmml">p</mi><mo id="S3.SS1.p1.3.m3.3.3.5" xref="S3.SS1.p1.3.m3.3.3.5.cmml">=</mo><mrow id="S3.SS1.p1.3.m3.3.3.2.2" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml">p</mi><mn id="S3.SS1.p1.3.m3.2.2.1.1.1.3" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.3.m3.3.3.2.2.4" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S3.SS1.p1.3.m3.3.3.2.2.5" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.3.3.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.2" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.3.m3.3.3.2.2.2.3" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.2.2.6" xref="S3.SS1.p1.3.m3.3.3.2.3.cmml">}</mo></mrow><mo id="S3.SS1.p1.3.m3.3.3.6" xref="S3.SS1.p1.3.m3.3.3.6.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.3.3.7" xref="S3.SS1.p1.3.m3.3.3.7.cmml"><mi id="S3.SS1.p1.3.m3.3.3.7.2" xref="S3.SS1.p1.3.m3.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.3.m3.3.3.7.3" xref="S3.SS1.p1.3.m3.3.3.7.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.7.3.2" xref="S3.SS1.p1.3.m3.3.3.7.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.3.m3.3.3.7.3.1" xref="S3.SS1.p1.3.m3.3.3.7.3.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.3.3.7.3.3" xref="S3.SS1.p1.3.m3.3.3.7.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><apply id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3"><and id="S3.SS1.p1.3.m3.3.3a.cmml" xref="S3.SS1.p1.3.m3.3.3"></and><apply id="S3.SS1.p1.3.m3.3.3b.cmml" xref="S3.SS1.p1.3.m3.3.3"><eq id="S3.SS1.p1.3.m3.3.3.5.cmml" xref="S3.SS1.p1.3.m3.3.3.5"></eq><ci id="S3.SS1.p1.3.m3.3.3.4.cmml" xref="S3.SS1.p1.3.m3.3.3.4">𝑝</ci><set id="S3.SS1.p1.3.m3.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2"><apply id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.2">𝑝</ci><cn type="integer" id="S3.SS1.p1.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">…</ci><apply id="S3.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.2">𝑝</ci><ci id="S3.SS1.p1.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.3.3.2.2.2.3">𝑀</ci></apply></set></apply><apply id="S3.SS1.p1.3.m3.3.3c.cmml" xref="S3.SS1.p1.3.m3.3.3"><in id="S3.SS1.p1.3.m3.3.3.6.cmml" xref="S3.SS1.p1.3.m3.3.3.6"></in><share href="#S3.SS1.p1.3.m3.3.3.2.cmml" id="S3.SS1.p1.3.m3.3.3d.cmml" xref="S3.SS1.p1.3.m3.3.3"></share><apply id="S3.SS1.p1.3.m3.3.3.7.cmml" xref="S3.SS1.p1.3.m3.3.3.7"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.7.1.cmml" xref="S3.SS1.p1.3.m3.3.3.7">superscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.7.2.cmml" xref="S3.SS1.p1.3.m3.3.3.7.2">ℝ</ci><apply id="S3.SS1.p1.3.m3.3.3.7.3.cmml" xref="S3.SS1.p1.3.m3.3.3.7.3"><times id="S3.SS1.p1.3.m3.3.3.7.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.7.3.1"></times><ci id="S3.SS1.p1.3.m3.3.3.7.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.7.3.2">𝑑</ci><ci id="S3.SS1.p1.3.m3.3.3.7.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.7.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">p=\{p_{1},...,p_{M}\}\in\mathbb{R}^{d\times k}</annotation></semantics></math> as the learnable prompt. Specifically, we use <math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="p=\{p_{1},...,p_{M}\}" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.4" xref="S3.SS1.p1.4.m4.3.3.4.cmml">p</mi><mo id="S3.SS1.p1.4.m4.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.3.3.2.2" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.3.3.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.4.m4.2.2.1.1.1" xref="S3.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.2.2.1.1.1.2" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml">p</mi><mn id="S3.SS1.p1.4.m4.2.2.1.1.1.3" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.4.m4.3.3.2.2.4" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS1.p1.4.m4.3.3.2.2.5" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.4.m4.3.3.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.2" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.4.m4.3.3.2.2.2.3" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml">M</mi></msub><mo stretchy="false" id="S3.SS1.p1.4.m4.3.3.2.2.6" xref="S3.SS1.p1.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3"><eq id="S3.SS1.p1.4.m4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3"></eq><ci id="S3.SS1.p1.4.m4.3.3.4.cmml" xref="S3.SS1.p1.4.m4.3.3.4">𝑝</ci><set id="S3.SS1.p1.4.m4.3.3.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2"><apply id="S3.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.2">𝑝</ci><cn type="integer" id="S3.SS1.p1.4.m4.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">…</ci><apply id="S3.SS1.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.2">𝑝</ci><ci id="S3.SS1.p1.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.3.3.2.2.2.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">p=\{p_{1},...,p_{M}\}</annotation></semantics></math> to replace <math id="S3.SS1.p1.5.m5.3" class="ltx_Math" alttext="\{w_{2},...,w_{M+1}\}" display="inline"><semantics id="S3.SS1.p1.5.m5.3a"><mrow id="S3.SS1.p1.5.m5.3.3.2" xref="S3.SS1.p1.5.m5.3.3.3.cmml"><mo stretchy="false" id="S3.SS1.p1.5.m5.3.3.2.3" xref="S3.SS1.p1.5.m5.3.3.3.cmml">{</mo><msub id="S3.SS1.p1.5.m5.2.2.1.1" xref="S3.SS1.p1.5.m5.2.2.1.1.cmml"><mi id="S3.SS1.p1.5.m5.2.2.1.1.2" xref="S3.SS1.p1.5.m5.2.2.1.1.2.cmml">w</mi><mn id="S3.SS1.p1.5.m5.2.2.1.1.3" xref="S3.SS1.p1.5.m5.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.SS1.p1.5.m5.3.3.2.4" xref="S3.SS1.p1.5.m5.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS1.p1.5.m5.3.3.2.5" xref="S3.SS1.p1.5.m5.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.5.m5.3.3.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.cmml"><mi id="S3.SS1.p1.5.m5.3.3.2.2.2" xref="S3.SS1.p1.5.m5.3.3.2.2.2.cmml">w</mi><mrow id="S3.SS1.p1.5.m5.3.3.2.2.3" xref="S3.SS1.p1.5.m5.3.3.2.2.3.cmml"><mi id="S3.SS1.p1.5.m5.3.3.2.2.3.2" xref="S3.SS1.p1.5.m5.3.3.2.2.3.2.cmml">M</mi><mo id="S3.SS1.p1.5.m5.3.3.2.2.3.1" xref="S3.SS1.p1.5.m5.3.3.2.2.3.1.cmml">+</mo><mn id="S3.SS1.p1.5.m5.3.3.2.2.3.3" xref="S3.SS1.p1.5.m5.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.SS1.p1.5.m5.3.3.2.6" xref="S3.SS1.p1.5.m5.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.3b"><set id="S3.SS1.p1.5.m5.3.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2"><apply id="S3.SS1.p1.5.m5.2.2.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.2">𝑤</ci><cn type="integer" id="S3.SS1.p1.5.m5.2.2.1.1.3.cmml" xref="S3.SS1.p1.5.m5.2.2.1.1.3">2</cn></apply><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">…</ci><apply id="S3.SS1.p1.5.m5.3.3.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.3.3.2.2.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.2">𝑤</ci><apply id="S3.SS1.p1.5.m5.3.3.2.2.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.3"><plus id="S3.SS1.p1.5.m5.3.3.2.2.3.1.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.3.1"></plus><ci id="S3.SS1.p1.5.m5.3.3.2.2.3.2.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.3.2">𝑀</ci><cn type="integer" id="S3.SS1.p1.5.m5.3.3.2.2.3.3.cmml" xref="S3.SS1.p1.5.m5.3.3.2.2.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.3c">\{w_{2},...,w_{M+1}\}</annotation></semantics></math> to be consistent with previous methods. Then the textual prompt of <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">k</annotation></semantics></math> class can be reformulated as <math id="S3.SS1.p1.7.m7.7" class="ltx_Math" alttext="P_{k}=\{w_{1},p_{1},...,p_{M},w_{M+2},...,w_{l}\}" display="inline"><semantics id="S3.SS1.p1.7.m7.7a"><mrow id="S3.SS1.p1.7.m7.7.7" xref="S3.SS1.p1.7.m7.7.7.cmml"><msub id="S3.SS1.p1.7.m7.7.7.7" xref="S3.SS1.p1.7.m7.7.7.7.cmml"><mi id="S3.SS1.p1.7.m7.7.7.7.2" xref="S3.SS1.p1.7.m7.7.7.7.2.cmml">P</mi><mi id="S3.SS1.p1.7.m7.7.7.7.3" xref="S3.SS1.p1.7.m7.7.7.7.3.cmml">k</mi></msub><mo id="S3.SS1.p1.7.m7.7.7.6" xref="S3.SS1.p1.7.m7.7.7.6.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.7.7.5.5" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.7.7.5.5.6" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">{</mo><msub id="S3.SS1.p1.7.m7.3.3.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.2.cmml">w</mi><mn id="S3.SS1.p1.7.m7.3.3.1.1.1.3" xref="S3.SS1.p1.7.m7.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.7.m7.7.7.5.5.7" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">,</mo><msub id="S3.SS1.p1.7.m7.4.4.2.2.2" xref="S3.SS1.p1.7.m7.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.7.m7.4.4.2.2.2.2" xref="S3.SS1.p1.7.m7.4.4.2.2.2.2.cmml">p</mi><mn id="S3.SS1.p1.7.m7.4.4.2.2.2.3" xref="S3.SS1.p1.7.m7.4.4.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS1.p1.7.m7.7.7.5.5.8" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p1.7.m7.7.7.5.5.9" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">,</mo><msub id="S3.SS1.p1.7.m7.5.5.3.3.3" xref="S3.SS1.p1.7.m7.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.7.m7.5.5.3.3.3.2" xref="S3.SS1.p1.7.m7.5.5.3.3.3.2.cmml">p</mi><mi id="S3.SS1.p1.7.m7.5.5.3.3.3.3" xref="S3.SS1.p1.7.m7.5.5.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS1.p1.7.m7.7.7.5.5.10" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">,</mo><msub id="S3.SS1.p1.7.m7.6.6.4.4.4" xref="S3.SS1.p1.7.m7.6.6.4.4.4.cmml"><mi id="S3.SS1.p1.7.m7.6.6.4.4.4.2" xref="S3.SS1.p1.7.m7.6.6.4.4.4.2.cmml">w</mi><mrow id="S3.SS1.p1.7.m7.6.6.4.4.4.3" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.cmml"><mi id="S3.SS1.p1.7.m7.6.6.4.4.4.3.2" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.2.cmml">M</mi><mo id="S3.SS1.p1.7.m7.6.6.4.4.4.3.1" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.1.cmml">+</mo><mn id="S3.SS1.p1.7.m7.6.6.4.4.4.3.3" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.3.cmml">2</mn></mrow></msub><mo id="S3.SS1.p1.7.m7.7.7.5.5.11" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m7.2.2" xref="S3.SS1.p1.7.m7.2.2.cmml">…</mi><mo id="S3.SS1.p1.7.m7.7.7.5.5.12" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">,</mo><msub id="S3.SS1.p1.7.m7.7.7.5.5.5" xref="S3.SS1.p1.7.m7.7.7.5.5.5.cmml"><mi id="S3.SS1.p1.7.m7.7.7.5.5.5.2" xref="S3.SS1.p1.7.m7.7.7.5.5.5.2.cmml">w</mi><mi id="S3.SS1.p1.7.m7.7.7.5.5.5.3" xref="S3.SS1.p1.7.m7.7.7.5.5.5.3.cmml">l</mi></msub><mo stretchy="false" id="S3.SS1.p1.7.m7.7.7.5.5.13" xref="S3.SS1.p1.7.m7.7.7.5.6.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.7b"><apply id="S3.SS1.p1.7.m7.7.7.cmml" xref="S3.SS1.p1.7.m7.7.7"><eq id="S3.SS1.p1.7.m7.7.7.6.cmml" xref="S3.SS1.p1.7.m7.7.7.6"></eq><apply id="S3.SS1.p1.7.m7.7.7.7.cmml" xref="S3.SS1.p1.7.m7.7.7.7"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.7.7.7.1.cmml" xref="S3.SS1.p1.7.m7.7.7.7">subscript</csymbol><ci id="S3.SS1.p1.7.m7.7.7.7.2.cmml" xref="S3.SS1.p1.7.m7.7.7.7.2">𝑃</ci><ci id="S3.SS1.p1.7.m7.7.7.7.3.cmml" xref="S3.SS1.p1.7.m7.7.7.7.3">𝑘</ci></apply><set id="S3.SS1.p1.7.m7.7.7.5.6.cmml" xref="S3.SS1.p1.7.m7.7.7.5.5"><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.2">𝑤</ci><cn type="integer" id="S3.SS1.p1.7.m7.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.7.m7.4.4.2.2.2.cmml" xref="S3.SS1.p1.7.m7.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.7.m7.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.4.4.2.2.2.2">𝑝</ci><cn type="integer" id="S3.SS1.p1.7.m7.4.4.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.4.4.2.2.2.3">1</cn></apply><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">…</ci><apply id="S3.SS1.p1.7.m7.5.5.3.3.3.cmml" xref="S3.SS1.p1.7.m7.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.7.m7.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.7.m7.5.5.3.3.3.2">𝑝</ci><ci id="S3.SS1.p1.7.m7.5.5.3.3.3.3.cmml" xref="S3.SS1.p1.7.m7.5.5.3.3.3.3">𝑀</ci></apply><apply id="S3.SS1.p1.7.m7.6.6.4.4.4.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.6.6.4.4.4.1.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4">subscript</csymbol><ci id="S3.SS1.p1.7.m7.6.6.4.4.4.2.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4.2">𝑤</ci><apply id="S3.SS1.p1.7.m7.6.6.4.4.4.3.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3"><plus id="S3.SS1.p1.7.m7.6.6.4.4.4.3.1.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.1"></plus><ci id="S3.SS1.p1.7.m7.6.6.4.4.4.3.2.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.2">𝑀</ci><cn type="integer" id="S3.SS1.p1.7.m7.6.6.4.4.4.3.3.cmml" xref="S3.SS1.p1.7.m7.6.6.4.4.4.3.3">2</cn></apply></apply><ci id="S3.SS1.p1.7.m7.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2">…</ci><apply id="S3.SS1.p1.7.m7.7.7.5.5.5.cmml" xref="S3.SS1.p1.7.m7.7.7.5.5.5"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.7.7.5.5.5.1.cmml" xref="S3.SS1.p1.7.m7.7.7.5.5.5">subscript</csymbol><ci id="S3.SS1.p1.7.m7.7.7.5.5.5.2.cmml" xref="S3.SS1.p1.7.m7.7.7.5.5.5.2">𝑤</ci><ci id="S3.SS1.p1.7.m7.7.7.5.5.5.3.cmml" xref="S3.SS1.p1.7.m7.7.7.5.5.5.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.7c">P_{k}=\{w_{1},p_{1},...,p_{M},w_{M+2},...,w_{l}\}</annotation></semantics></math> and is fed into pre-trained text encoder <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.2" xref="S3.SS1.p1.8.m8.1.2.cmml"><mi id="S3.SS1.p1.8.m8.1.2.2" xref="S3.SS1.p1.8.m8.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.1.2.1" xref="S3.SS1.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.8.m8.1.2.3.2" xref="S3.SS1.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.1.2.3.2.1" xref="S3.SS1.p1.8.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.8.m8.1.2.3.2.2" xref="S3.SS1.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.2.cmml" xref="S3.SS1.p1.8.m8.1.2"><times id="S3.SS1.p1.8.m8.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.2.1"></times><ci id="S3.SS1.p1.8.m8.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.2.2">𝑔</ci><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">g(\cdot)</annotation></semantics></math>. Denote image encoder as <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.2" xref="S3.SS1.p1.9.m9.1.2.cmml"><mi id="S3.SS1.p1.9.m9.1.2.2" xref="S3.SS1.p1.9.m9.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.2.1" xref="S3.SS1.p1.9.m9.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.9.m9.1.2.3.2" xref="S3.SS1.p1.9.m9.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m9.1.2.3.2.1" xref="S3.SS1.p1.9.m9.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.9.m9.1.2.3.2.2" xref="S3.SS1.p1.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.2.cmml" xref="S3.SS1.p1.9.m9.1.2"><times id="S3.SS1.p1.9.m9.1.2.1.cmml" xref="S3.SS1.p1.9.m9.1.2.1"></times><ci id="S3.SS1.p1.9.m9.1.2.2.cmml" xref="S3.SS1.p1.9.m9.1.2.2">𝑓</ci><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">f(\cdot)</annotation></semantics></math>, the prediction probability for each category of input image <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">x</annotation></semantics></math> is computed through matching scores:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.7" class="ltx_Math" alttext="p(\hat{y}=k|x)=\frac{\exp(\text{sim}(f(x),g(P_{k}))/\tau)}{\sum_{c=1}^{K}\exp(\text{sim}(f(x),g(P_{c}))/\tau)}," display="block"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1.1" xref="S3.E1.m1.7.7.1.1.1.cmml"><mi id="S3.E1.m1.7.7.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.7.7.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E1.m1.7.7.1.1.1.1.1.1.2.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E1.m1.7.7.1.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.cmml">k</mi><mo fence="false" id="S3.E1.m1.7.7.1.1.1.1.1.1.3.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml">=</mo><mfrac id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.4.cmml"><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S3.E1.m1.3.3.3.3a" xref="S3.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S3.E1.m1.3.3.3.3.1" xref="S3.E1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.2" xref="S3.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.3.1.1" xref="S3.E1.m1.3.3.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.3.3.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.2.cmml"><mtext id="S3.E1.m1.3.3.3.3.1.1.2.4" xref="S3.E1.m1.3.3.3.3.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.1.1.2.3" xref="S3.E1.m1.3.3.3.3.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.3" xref="S3.E1.m1.3.3.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.3.3.1.1.2.2.2.4" xref="S3.E1.m1.3.3.3.3.1.1.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.3" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.2.cmml">P</mi><mi id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.5" xref="S3.E1.m1.3.3.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.3.3.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.3.cmml">/</mo><mi id="S3.E1.m1.3.3.3.3.1.1.4" xref="S3.E1.m1.3.3.3.3.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E1.m1.3.3.3.3.1.3" xref="S3.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.6.6.6" xref="S3.E1.m1.6.6.6.cmml"><msubsup id="S3.E1.m1.6.6.6.4" xref="S3.E1.m1.6.6.6.4.cmml"><mo id="S3.E1.m1.6.6.6.4.2.2" xref="S3.E1.m1.6.6.6.4.2.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.6.4.2.3" xref="S3.E1.m1.6.6.6.4.2.3.cmml"><mi id="S3.E1.m1.6.6.6.4.2.3.2" xref="S3.E1.m1.6.6.6.4.2.3.2.cmml">c</mi><mo id="S3.E1.m1.6.6.6.4.2.3.1" xref="S3.E1.m1.6.6.6.4.2.3.1.cmml">=</mo><mn id="S3.E1.m1.6.6.6.4.2.3.3" xref="S3.E1.m1.6.6.6.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.6.6.6.4.3" xref="S3.E1.m1.6.6.6.4.3.cmml">K</mi></msubsup><mrow id="S3.E1.m1.6.6.6.3.1" xref="S3.E1.m1.6.6.6.3.2.cmml"><mi id="S3.E1.m1.5.5.5.2" xref="S3.E1.m1.5.5.5.2.cmml">exp</mi><mo id="S3.E1.m1.6.6.6.3.1a" xref="S3.E1.m1.6.6.6.3.2.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.6.3.1.1" xref="S3.E1.m1.6.6.6.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.2" xref="S3.E1.m1.6.6.6.3.2.cmml">(</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.6.3.1.1.1.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.cmml"><mtext id="S3.E1.m1.6.6.6.3.1.1.1.2.4" xref="S3.E1.m1.6.6.6.3.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.3.1.1.1.2.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml">​</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.1" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.4.4.4.1" xref="S3.E1.m1.4.4.4.1.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.4" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.2" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.2.cmml">P</mi><mi id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.3" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.5" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.6.3.1.1.1.3" xref="S3.E1.m1.6.6.6.3.1.1.1.3.cmml">/</mo><mi id="S3.E1.m1.6.6.6.3.1.1.1.4" xref="S3.E1.m1.6.6.6.3.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E1.m1.6.6.6.3.1.1.3" xref="S3.E1.m1.6.6.6.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"></eq><apply id="S3.E1.m1.7.7.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1"><times id="S3.E1.m1.7.7.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.2"></times><ci id="S3.E1.m1.7.7.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.1.3">𝑝</ci><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1"><eq id="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1"></eq><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2"><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><divide id="S3.E1.m1.6.6.7.cmml" xref="S3.E1.m1.6.6"></divide><apply id="S3.E1.m1.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.3"><exp id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"></exp><apply id="S3.E1.m1.3.3.3.3.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1"><divide id="S3.E1.m1.3.3.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.3"></divide><apply id="S3.E1.m1.3.3.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2"><times id="S3.E1.m1.3.3.3.3.1.1.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.3"></times><ci id="S3.E1.m1.3.3.3.3.1.1.2.4a.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.4"><mtext id="S3.E1.m1.3.3.3.3.1.1.2.4.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E1.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2"><apply id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1"><times id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑥</ci></apply><apply id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2"><times id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.2"></times><ci id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.3">𝑔</ci><apply id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.2">𝑃</ci><ci id="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.2.2.2.2.1.1.1.3">𝑘</ci></apply></apply></interval></apply><ci id="S3.E1.m1.3.3.3.3.1.1.4.cmml" xref="S3.E1.m1.3.3.3.3.1.1.4">𝜏</ci></apply></apply><apply id="S3.E1.m1.6.6.6.cmml" xref="S3.E1.m1.6.6.6"><apply id="S3.E1.m1.6.6.6.4.cmml" xref="S3.E1.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.1.cmml" xref="S3.E1.m1.6.6.6.4">superscript</csymbol><apply id="S3.E1.m1.6.6.6.4.2.cmml" xref="S3.E1.m1.6.6.6.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.1.cmml" xref="S3.E1.m1.6.6.6.4">subscript</csymbol><sum id="S3.E1.m1.6.6.6.4.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.2"></sum><apply id="S3.E1.m1.6.6.6.4.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3"><eq id="S3.E1.m1.6.6.6.4.2.3.1.cmml" xref="S3.E1.m1.6.6.6.4.2.3.1"></eq><ci id="S3.E1.m1.6.6.6.4.2.3.2.cmml" xref="S3.E1.m1.6.6.6.4.2.3.2">𝑐</ci><cn type="integer" id="S3.E1.m1.6.6.6.4.2.3.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.6.6.6.4.3.cmml" xref="S3.E1.m1.6.6.6.4.3">𝐾</ci></apply><apply id="S3.E1.m1.6.6.6.3.2.cmml" xref="S3.E1.m1.6.6.6.3.1"><exp id="S3.E1.m1.5.5.5.2.cmml" xref="S3.E1.m1.5.5.5.2"></exp><apply id="S3.E1.m1.6.6.6.3.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1"><divide id="S3.E1.m1.6.6.6.3.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.3"></divide><apply id="S3.E1.m1.6.6.6.3.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2"><times id="S3.E1.m1.6.6.6.3.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.3"></times><ci id="S3.E1.m1.6.6.6.3.1.1.1.2.4a.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.4"><mtext id="S3.E1.m1.6.6.6.3.1.1.1.2.4.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2"><apply id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1"><times id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.1"></times><ci id="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E1.m1.4.4.4.1.cmml" xref="S3.E1.m1.4.4.4.1">𝑥</ci></apply><apply id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2"><times id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.2"></times><ci id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.3">𝑔</ci><apply id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.2">𝑃</ci><ci id="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.2.2.2.2.1.1.1.3">𝑐</ci></apply></apply></interval></apply><ci id="S3.E1.m1.6.6.6.3.1.1.1.4.cmml" xref="S3.E1.m1.6.6.6.3.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">p(\hat{y}=k|x)=\frac{\exp(\text{sim}(f(x),g(P_{k}))/\tau)}{\sum_{c=1}^{K}\exp(\text{sim}(f(x),g(P_{c}))/\tau)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.14" class="ltx_p">where <math id="S3.SS1.p1.11.m1.2" class="ltx_Math" alttext="\text{sim}(\cdot,\cdot)" display="inline"><semantics id="S3.SS1.p1.11.m1.2a"><mrow id="S3.SS1.p1.11.m1.2.3" xref="S3.SS1.p1.11.m1.2.3.cmml"><mtext id="S3.SS1.p1.11.m1.2.3.2" xref="S3.SS1.p1.11.m1.2.3.2a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m1.2.3.1" xref="S3.SS1.p1.11.m1.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.11.m1.2.3.3.2" xref="S3.SS1.p1.11.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m1.2.3.3.2.1" xref="S3.SS1.p1.11.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m1.1.1" xref="S3.SS1.p1.11.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.p1.11.m1.2.3.3.2.2" xref="S3.SS1.p1.11.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m1.2.2" xref="S3.SS1.p1.11.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.11.m1.2.3.3.2.3" xref="S3.SS1.p1.11.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m1.2b"><apply id="S3.SS1.p1.11.m1.2.3.cmml" xref="S3.SS1.p1.11.m1.2.3"><times id="S3.SS1.p1.11.m1.2.3.1.cmml" xref="S3.SS1.p1.11.m1.2.3.1"></times><ci id="S3.SS1.p1.11.m1.2.3.2a.cmml" xref="S3.SS1.p1.11.m1.2.3.2"><mtext id="S3.SS1.p1.11.m1.2.3.2.cmml" xref="S3.SS1.p1.11.m1.2.3.2">sim</mtext></ci><interval closure="open" id="S3.SS1.p1.11.m1.2.3.3.1.cmml" xref="S3.SS1.p1.11.m1.2.3.3.2"><ci id="S3.SS1.p1.11.m1.1.1.cmml" xref="S3.SS1.p1.11.m1.1.1">⋅</ci><ci id="S3.SS1.p1.11.m1.2.2.cmml" xref="S3.SS1.p1.11.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m1.2c">\text{sim}(\cdot,\cdot)</annotation></semantics></math> denotes a metric function (e.g., cosine similarity), <math id="S3.SS1.p1.12.m2.1" class="ltx_Math" alttext="\hat{y}" display="inline"><semantics id="S3.SS1.p1.12.m2.1a"><mover accent="true" id="S3.SS1.p1.12.m2.1.1" xref="S3.SS1.p1.12.m2.1.1.cmml"><mi id="S3.SS1.p1.12.m2.1.1.2" xref="S3.SS1.p1.12.m2.1.1.2.cmml">y</mi><mo id="S3.SS1.p1.12.m2.1.1.1" xref="S3.SS1.p1.12.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m2.1b"><apply id="S3.SS1.p1.12.m2.1.1.cmml" xref="S3.SS1.p1.12.m2.1.1"><ci id="S3.SS1.p1.12.m2.1.1.1.cmml" xref="S3.SS1.p1.12.m2.1.1.1">^</ci><ci id="S3.SS1.p1.12.m2.1.1.2.cmml" xref="S3.SS1.p1.12.m2.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m2.1c">\hat{y}</annotation></semantics></math> denotes the predicted label, <math id="S3.SS1.p1.13.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.13.m3.1a"><mi id="S3.SS1.p1.13.m3.1.1" xref="S3.SS1.p1.13.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m3.1b"><ci id="S3.SS1.p1.13.m3.1.1.cmml" xref="S3.SS1.p1.13.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m3.1c">K</annotation></semantics></math> denotes the number of classes, and <math id="S3.SS1.p1.14.m4.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS1.p1.14.m4.1a"><mi id="S3.SS1.p1.14.m4.1.1" xref="S3.SS1.p1.14.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m4.1b"><ci id="S3.SS1.p1.14.m4.1.1.cmml" xref="S3.SS1.p1.14.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m4.1c">\tau</annotation></semantics></math> denotes the temperature of Softmax. Then we optimize the learnable prompt by cross-entropy loss:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\mathcal{L}_{ce}=-\frac{1}{|\mathcal{D}|}\sum_{(x,y)\in\mathcal{D}}\sum_{k}y\log p(\hat{y}=k|x)," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml">ℒ</mi><mrow id="S3.E2.m1.4.4.1.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.3.3.1" xref="S3.E2.m1.4.4.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.4.4.1.1.3.3.3" xref="S3.E2.m1.4.4.1.1.3.3.3.cmml">e</mi></mrow></msub><mo id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mo id="S3.E2.m1.4.4.1.1.1a" xref="S3.E2.m1.4.4.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">1</mn><mrow id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.cmml"><munder id="S3.E2.m1.4.4.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml"><mrow id="S3.E2.m1.3.3.2.4.2" xref="S3.E2.m1.3.3.2.4.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.2.4.2.1" xref="S3.E2.m1.3.3.2.4.1.cmml">(</mo><mi id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">x</mi><mo id="S3.E2.m1.3.3.2.4.2.2" xref="S3.E2.m1.3.3.2.4.1.cmml">,</mo><mi id="S3.E2.m1.3.3.2.2" xref="S3.E2.m1.3.3.2.2.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.3.3.2.4.2.3" xref="S3.E2.m1.3.3.2.4.1.cmml">)</mo></mrow><mo id="S3.E2.m1.3.3.2.3" xref="S3.E2.m1.3.3.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.2.5" xref="S3.E2.m1.3.3.2.5.cmml">𝒟</mi></mrow></munder><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml"><munder id="S3.E2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.3.cmml">k</mi></munder><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml">y</mi><mo lspace="0.167em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4a" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.cmml">⁡</mo><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2a" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo fence="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><eq id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2"></eq><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2">ℒ</ci><apply id="S3.E2.m1.4.4.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3"><times id="S3.E2.m1.4.4.1.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.3.1"></times><ci id="S3.E2.m1.4.4.1.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.3.2">𝑐</ci><ci id="S3.E2.m1.4.4.1.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3.3">𝑒</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><minus id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1"></minus><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1"></divide><cn type="integer" id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3">1</cn><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.3"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.3.1"></abs><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2"></sum><apply id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"><in id="S3.E2.m1.3.3.2.3.cmml" xref="S3.E2.m1.3.3.2.3"></in><interval closure="open" id="S3.E2.m1.3.3.2.4.1.cmml" xref="S3.E2.m1.3.3.2.4.2"><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝑥</ci><ci id="S3.E2.m1.3.3.2.2.cmml" xref="S3.E2.m1.3.3.2.2">𝑦</ci></interval><ci id="S3.E2.m1.3.3.2.5.cmml" xref="S3.E2.m1.3.3.2.5">𝒟</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1"><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2"></sum><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3">𝑦</ci><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4"><log id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.1"></log><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.4.2">𝑝</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1"><eq id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\mathcal{L}_{ce}=-\frac{1}{|\mathcal{D}|}\sum_{(x,y)\in\mathcal{D}}\sum_{k}y\log p(\hat{y}=k|x),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.15" class="ltx_p">where <math id="S3.SS1.p1.15.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS1.p1.15.m1.1a"><mi id="S3.SS1.p1.15.m1.1.1" xref="S3.SS1.p1.15.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m1.1b"><ci id="S3.SS1.p1.15.m1.1.1.cmml" xref="S3.SS1.p1.15.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m1.1c">y</annotation></semantics></math> denotes the one-hot ground-truth annotation.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Federated Prompt Learning</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.14" class="ltx_p">Suppose there are <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">N</annotation></semantics></math> clients and a central server. Each client <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">i</annotation></semantics></math> holds local dataset <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">D</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝐷</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">D_{i}</annotation></semantics></math> with <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">n_{i}</annotation></semantics></math> samples and <math id="S3.SS2.p1.5.m5.4" class="ltx_Math" alttext="D=\{D_{1},D_{2},...,D_{N}\}" display="inline"><semantics id="S3.SS2.p1.5.m5.4a"><mrow id="S3.SS2.p1.5.m5.4.4" xref="S3.SS2.p1.5.m5.4.4.cmml"><mi id="S3.SS2.p1.5.m5.4.4.5" xref="S3.SS2.p1.5.m5.4.4.5.cmml">D</mi><mo id="S3.SS2.p1.5.m5.4.4.4" xref="S3.SS2.p1.5.m5.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.5.m5.4.4.3.3" xref="S3.SS2.p1.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.4.4.3.3.4" xref="S3.SS2.p1.5.m5.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.5.m5.2.2.1.1.1" xref="S3.SS2.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.2.2.1.1.1.2" xref="S3.SS2.p1.5.m5.2.2.1.1.1.2.cmml">D</mi><mn id="S3.SS2.p1.5.m5.2.2.1.1.1.3" xref="S3.SS2.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.5.m5.4.4.3.3.5" xref="S3.SS2.p1.5.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.5.m5.3.3.2.2.2" xref="S3.SS2.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.3.3.2.2.2.2" xref="S3.SS2.p1.5.m5.3.3.2.2.2.2.cmml">D</mi><mn id="S3.SS2.p1.5.m5.3.3.2.2.2.3" xref="S3.SS2.p1.5.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.5.m5.4.4.3.3.6" xref="S3.SS2.p1.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.p1.5.m5.4.4.3.3.7" xref="S3.SS2.p1.5.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.5.m5.4.4.3.3.3" xref="S3.SS2.p1.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.5.m5.4.4.3.3.3.2" xref="S3.SS2.p1.5.m5.4.4.3.3.3.2.cmml">D</mi><mi id="S3.SS2.p1.5.m5.4.4.3.3.3.3" xref="S3.SS2.p1.5.m5.4.4.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS2.p1.5.m5.4.4.3.3.8" xref="S3.SS2.p1.5.m5.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.4b"><apply id="S3.SS2.p1.5.m5.4.4.cmml" xref="S3.SS2.p1.5.m5.4.4"><eq id="S3.SS2.p1.5.m5.4.4.4.cmml" xref="S3.SS2.p1.5.m5.4.4.4"></eq><ci id="S3.SS2.p1.5.m5.4.4.5.cmml" xref="S3.SS2.p1.5.m5.4.4.5">𝐷</ci><set id="S3.SS2.p1.5.m5.4.4.3.4.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3"><apply id="S3.SS2.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1.2">𝐷</ci><cn type="integer" id="S3.SS2.p1.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2.2">𝐷</ci><cn type="integer" id="S3.SS2.p1.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">…</ci><apply id="S3.SS2.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3.2">𝐷</ci><ci id="S3.SS2.p1.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.4c">D=\{D_{1},D_{2},...,D_{N}\}</annotation></semantics></math> represents the total dataset where each dataset is derived from a distinct data distribution <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝒟</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{D}_{i}</annotation></semantics></math>. Each client is equipped with a pre-trained CLIP model and a prompt learner in our federated learning setup. Let <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="C_{t}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">C</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝐶</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">C_{t}</annotation></semantics></math> represent the set of selected clients participating in communication round <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">t</annotation></semantics></math>. For each communication round <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">t</annotation></semantics></math>, the selected clients initialize the global prompt with <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="p_{G}^{t-1}" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><msubsup id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.p1.10.m10.1.1.2.2" xref="S3.SS2.p1.10.m10.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.10.m10.1.1.2.3" xref="S3.SS2.p1.10.m10.1.1.2.3.cmml">G</mi><mrow id="S3.SS2.p1.10.m10.1.1.3" xref="S3.SS2.p1.10.m10.1.1.3.cmml"><mi id="S3.SS2.p1.10.m10.1.1.3.2" xref="S3.SS2.p1.10.m10.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p1.10.m10.1.1.3.1" xref="S3.SS2.p1.10.m10.1.1.3.1.cmml">−</mo><mn id="S3.SS2.p1.10.m10.1.1.3.3" xref="S3.SS2.p1.10.m10.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><apply id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.p1.10.m10.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.p1.10.m10.1.1.2.3">𝐺</ci></apply><apply id="S3.SS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3"><minus id="S3.SS2.p1.10.m10.1.1.3.1.cmml" xref="S3.SS2.p1.10.m10.1.1.3.1"></minus><ci id="S3.SS2.p1.10.m10.1.1.3.2.cmml" xref="S3.SS2.p1.10.m10.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p1.10.m10.1.1.3.3.cmml" xref="S3.SS2.p1.10.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">p_{G}^{t-1}</annotation></semantics></math> and perform local training <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="p_{i}^{t}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><msubsup id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2.2" xref="S3.SS2.p1.11.m11.1.1.2.2.cmml">p</mi><mi id="S3.SS2.p1.11.m11.1.1.2.3" xref="S3.SS2.p1.11.m11.1.1.2.3.cmml">i</mi><mi id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">superscript</csymbol><apply id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.2.1.cmml" xref="S3.SS2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.2.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2.2">𝑝</ci><ci id="S3.SS2.p1.11.m11.1.1.2.3.cmml" xref="S3.SS2.p1.11.m11.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">p_{i}^{t}</annotation></semantics></math> through cross-entropy loss <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{L}_{ce}" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><msub id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml">ℒ</mi><mrow id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3.cmml"><mi id="S3.SS2.p1.12.m12.1.1.3.2" xref="S3.SS2.p1.12.m12.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.12.m12.1.1.3.1" xref="S3.SS2.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.12.m12.1.1.3.3" xref="S3.SS2.p1.12.m12.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2">ℒ</ci><apply id="S3.SS2.p1.12.m12.1.1.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3"><times id="S3.SS2.p1.12.m12.1.1.3.1.cmml" xref="S3.SS2.p1.12.m12.1.1.3.1"></times><ci id="S3.SS2.p1.12.m12.1.1.3.2.cmml" xref="S3.SS2.p1.12.m12.1.1.3.2">𝑐</ci><ci id="S3.SS2.p1.12.m12.1.1.3.3.cmml" xref="S3.SS2.p1.12.m12.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">\mathcal{L}_{ce}</annotation></semantics></math> for <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><mi id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><ci id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">E</annotation></semantics></math> local epoch, at <math id="S3.SS2.p1.14.m14.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p1.14.m14.1a"><mi id="S3.SS2.p1.14.m14.1.1" xref="S3.SS2.p1.14.m14.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m14.1b"><ci id="S3.SS2.p1.14.m14.1.1.cmml" xref="S3.SS2.p1.14.m14.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m14.1c">e</annotation></semantics></math> local epoch the update of global prompt is:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.13" class="ltx_Math" alttext="p_{G,i}^{t,e}=p_{G,i}^{t,e-1}-\eta\nabla\mathcal{L}_{ce}(p_{G,i}^{t,e-1})." display="block"><semantics id="S3.E3.m1.13a"><mrow id="S3.E3.m1.13.13.1" xref="S3.E3.m1.13.13.1.1.cmml"><mrow id="S3.E3.m1.13.13.1.1" xref="S3.E3.m1.13.13.1.1.cmml"><msubsup id="S3.E3.m1.13.13.1.1.3" xref="S3.E3.m1.13.13.1.1.3.cmml"><mi id="S3.E3.m1.13.13.1.1.3.2.2" xref="S3.E3.m1.13.13.1.1.3.2.2.cmml">p</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">G</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">t</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">e</mi></mrow></msubsup><mo id="S3.E3.m1.13.13.1.1.2" xref="S3.E3.m1.13.13.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.13.13.1.1.1" xref="S3.E3.m1.13.13.1.1.1.cmml"><msubsup id="S3.E3.m1.13.13.1.1.1.3" xref="S3.E3.m1.13.13.1.1.1.3.cmml"><mi id="S3.E3.m1.13.13.1.1.1.3.2.2" xref="S3.E3.m1.13.13.1.1.1.3.2.2.cmml">p</mi><mrow id="S3.E3.m1.6.6.2.4" xref="S3.E3.m1.6.6.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml">G</mi><mo id="S3.E3.m1.6.6.2.4.1" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><mi id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml">i</mi></mrow><mrow id="S3.E3.m1.8.8.2.2" xref="S3.E3.m1.8.8.2.3.cmml"><mi id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml">t</mi><mo id="S3.E3.m1.8.8.2.2.2" xref="S3.E3.m1.8.8.2.3.cmml">,</mo><mrow id="S3.E3.m1.8.8.2.2.1" xref="S3.E3.m1.8.8.2.2.1.cmml"><mi id="S3.E3.m1.8.8.2.2.1.2" xref="S3.E3.m1.8.8.2.2.1.2.cmml">e</mi><mo id="S3.E3.m1.8.8.2.2.1.1" xref="S3.E3.m1.8.8.2.2.1.1.cmml">−</mo><mn id="S3.E3.m1.8.8.2.2.1.3" xref="S3.E3.m1.8.8.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="S3.E3.m1.13.13.1.1.1.2" xref="S3.E3.m1.13.13.1.1.1.2.cmml">−</mo><mrow id="S3.E3.m1.13.13.1.1.1.1" xref="S3.E3.m1.13.13.1.1.1.1.cmml"><mi id="S3.E3.m1.13.13.1.1.1.1.3" xref="S3.E3.m1.13.13.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E3.m1.13.13.1.1.1.1.2" xref="S3.E3.m1.13.13.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.13.13.1.1.1.1.4" xref="S3.E3.m1.13.13.1.1.1.1.4.cmml"><mo rspace="0.167em" id="S3.E3.m1.13.13.1.1.1.1.4.1" xref="S3.E3.m1.13.13.1.1.1.1.4.1.cmml">∇</mo><msub id="S3.E3.m1.13.13.1.1.1.1.4.2" xref="S3.E3.m1.13.13.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.13.13.1.1.1.1.4.2.2" xref="S3.E3.m1.13.13.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S3.E3.m1.13.13.1.1.1.1.4.2.3" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.cmml"><mi id="S3.E3.m1.13.13.1.1.1.1.4.2.3.2" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.13.13.1.1.1.1.4.2.3.1" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E3.m1.13.13.1.1.1.1.4.2.3.3" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.3.cmml">e</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.13.13.1.1.1.1.2a" xref="S3.E3.m1.13.13.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.13.13.1.1.1.1.1.1" xref="S3.E3.m1.13.13.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.13.13.1.1.1.1.1.1.2" xref="S3.E3.m1.13.13.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E3.m1.13.13.1.1.1.1.1.1.1" xref="S3.E3.m1.13.13.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.13.13.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.13.13.1.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.E3.m1.10.10.2.4" xref="S3.E3.m1.10.10.2.3.cmml"><mi id="S3.E3.m1.9.9.1.1" xref="S3.E3.m1.9.9.1.1.cmml">G</mi><mo id="S3.E3.m1.10.10.2.4.1" xref="S3.E3.m1.10.10.2.3.cmml">,</mo><mi id="S3.E3.m1.10.10.2.2" xref="S3.E3.m1.10.10.2.2.cmml">i</mi></mrow><mrow id="S3.E3.m1.12.12.2.2" xref="S3.E3.m1.12.12.2.3.cmml"><mi id="S3.E3.m1.11.11.1.1" xref="S3.E3.m1.11.11.1.1.cmml">t</mi><mo id="S3.E3.m1.12.12.2.2.2" xref="S3.E3.m1.12.12.2.3.cmml">,</mo><mrow id="S3.E3.m1.12.12.2.2.1" xref="S3.E3.m1.12.12.2.2.1.cmml"><mi id="S3.E3.m1.12.12.2.2.1.2" xref="S3.E3.m1.12.12.2.2.1.2.cmml">e</mi><mo id="S3.E3.m1.12.12.2.2.1.1" xref="S3.E3.m1.12.12.2.2.1.1.cmml">−</mo><mn id="S3.E3.m1.12.12.2.2.1.3" xref="S3.E3.m1.12.12.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo stretchy="false" id="S3.E3.m1.13.13.1.1.1.1.1.1.3" xref="S3.E3.m1.13.13.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.13.13.1.2" xref="S3.E3.m1.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.13b"><apply id="S3.E3.m1.13.13.1.1.cmml" xref="S3.E3.m1.13.13.1"><eq id="S3.E3.m1.13.13.1.1.2.cmml" xref="S3.E3.m1.13.13.1.1.2"></eq><apply id="S3.E3.m1.13.13.1.1.3.cmml" xref="S3.E3.m1.13.13.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.3.1.cmml" xref="S3.E3.m1.13.13.1.1.3">superscript</csymbol><apply id="S3.E3.m1.13.13.1.1.3.2.cmml" xref="S3.E3.m1.13.13.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.3.2.1.cmml" xref="S3.E3.m1.13.13.1.1.3">subscript</csymbol><ci id="S3.E3.m1.13.13.1.1.3.2.2.cmml" xref="S3.E3.m1.13.13.1.1.3.2.2">𝑝</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝐺</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑡</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑒</ci></list></apply><apply id="S3.E3.m1.13.13.1.1.1.cmml" xref="S3.E3.m1.13.13.1.1.1"><minus id="S3.E3.m1.13.13.1.1.1.2.cmml" xref="S3.E3.m1.13.13.1.1.1.2"></minus><apply id="S3.E3.m1.13.13.1.1.1.3.cmml" xref="S3.E3.m1.13.13.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.1.3.1.cmml" xref="S3.E3.m1.13.13.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.13.13.1.1.1.3.2.cmml" xref="S3.E3.m1.13.13.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.1.3.2.1.cmml" xref="S3.E3.m1.13.13.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.13.13.1.1.1.3.2.2.cmml" xref="S3.E3.m1.13.13.1.1.1.3.2.2">𝑝</ci><list id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.4"><ci id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1">𝐺</ci><ci id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2">𝑖</ci></list></apply><list id="S3.E3.m1.8.8.2.3.cmml" xref="S3.E3.m1.8.8.2.2"><ci id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1.1">𝑡</ci><apply id="S3.E3.m1.8.8.2.2.1.cmml" xref="S3.E3.m1.8.8.2.2.1"><minus id="S3.E3.m1.8.8.2.2.1.1.cmml" xref="S3.E3.m1.8.8.2.2.1.1"></minus><ci id="S3.E3.m1.8.8.2.2.1.2.cmml" xref="S3.E3.m1.8.8.2.2.1.2">𝑒</ci><cn type="integer" id="S3.E3.m1.8.8.2.2.1.3.cmml" xref="S3.E3.m1.8.8.2.2.1.3">1</cn></apply></list></apply><apply id="S3.E3.m1.13.13.1.1.1.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1"><times id="S3.E3.m1.13.13.1.1.1.1.2.cmml" xref="S3.E3.m1.13.13.1.1.1.1.2"></times><ci id="S3.E3.m1.13.13.1.1.1.1.3.cmml" xref="S3.E3.m1.13.13.1.1.1.1.3">𝜂</ci><apply id="S3.E3.m1.13.13.1.1.1.1.4.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4"><ci id="S3.E3.m1.13.13.1.1.1.1.4.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.1">∇</ci><apply id="S3.E3.m1.13.13.1.1.1.1.4.2.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.1.1.4.2.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E3.m1.13.13.1.1.1.1.4.2.2.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2.2">ℒ</ci><apply id="S3.E3.m1.13.13.1.1.1.1.4.2.3.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3"><times id="S3.E3.m1.13.13.1.1.1.1.4.2.3.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.1"></times><ci id="S3.E3.m1.13.13.1.1.1.1.4.2.3.2.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.2">𝑐</ci><ci id="S3.E3.m1.13.13.1.1.1.1.4.2.3.3.cmml" xref="S3.E3.m1.13.13.1.1.1.1.4.2.3.3">𝑒</ci></apply></apply></apply><apply id="S3.E3.m1.13.13.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.13.13.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.13.13.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.13.13.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.13.13.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.13.13.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.13.13.1.1.1.1.1.1.1.2.2">𝑝</ci><list id="S3.E3.m1.10.10.2.3.cmml" xref="S3.E3.m1.10.10.2.4"><ci id="S3.E3.m1.9.9.1.1.cmml" xref="S3.E3.m1.9.9.1.1">𝐺</ci><ci id="S3.E3.m1.10.10.2.2.cmml" xref="S3.E3.m1.10.10.2.2">𝑖</ci></list></apply><list id="S3.E3.m1.12.12.2.3.cmml" xref="S3.E3.m1.12.12.2.2"><ci id="S3.E3.m1.11.11.1.1.cmml" xref="S3.E3.m1.11.11.1.1">𝑡</ci><apply id="S3.E3.m1.12.12.2.2.1.cmml" xref="S3.E3.m1.12.12.2.2.1"><minus id="S3.E3.m1.12.12.2.2.1.1.cmml" xref="S3.E3.m1.12.12.2.2.1.1"></minus><ci id="S3.E3.m1.12.12.2.2.1.2.cmml" xref="S3.E3.m1.12.12.2.2.1.2">𝑒</ci><cn type="integer" id="S3.E3.m1.12.12.2.2.1.3.cmml" xref="S3.E3.m1.12.12.2.2.1.3">1</cn></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.13c">p_{G,i}^{t,e}=p_{G,i}^{t,e-1}-\eta\nabla\mathcal{L}_{ce}(p_{G,i}^{t,e-1}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.17" class="ltx_p">After <math id="S3.SS2.p1.15.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.15.m1.1a"><mi id="S3.SS2.p1.15.m1.1.1" xref="S3.SS2.p1.15.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m1.1b"><ci id="S3.SS2.p1.15.m1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m1.1c">E</annotation></semantics></math> local epoch training, each client in <math id="S3.SS2.p1.16.m2.1" class="ltx_Math" alttext="C_{t}" display="inline"><semantics id="S3.SS2.p1.16.m2.1a"><msub id="S3.SS2.p1.16.m2.1.1" xref="S3.SS2.p1.16.m2.1.1.cmml"><mi id="S3.SS2.p1.16.m2.1.1.2" xref="S3.SS2.p1.16.m2.1.1.2.cmml">C</mi><mi id="S3.SS2.p1.16.m2.1.1.3" xref="S3.SS2.p1.16.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m2.1b"><apply id="S3.SS2.p1.16.m2.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.16.m2.1.1.1.cmml" xref="S3.SS2.p1.16.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.16.m2.1.1.2.cmml" xref="S3.SS2.p1.16.m2.1.1.2">𝐶</ci><ci id="S3.SS2.p1.16.m2.1.1.3.cmml" xref="S3.SS2.p1.16.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m2.1c">C_{t}</annotation></semantics></math> uploads the global prompt <math id="S3.SS2.p1.17.m3.4" class="ltx_Math" alttext="p_{G,i}^{t,E}" display="inline"><semantics id="S3.SS2.p1.17.m3.4a"><msubsup id="S3.SS2.p1.17.m3.4.5" xref="S3.SS2.p1.17.m3.4.5.cmml"><mi id="S3.SS2.p1.17.m3.4.5.2.2" xref="S3.SS2.p1.17.m3.4.5.2.2.cmml">p</mi><mrow id="S3.SS2.p1.17.m3.2.2.2.4" xref="S3.SS2.p1.17.m3.2.2.2.3.cmml"><mi id="S3.SS2.p1.17.m3.1.1.1.1" xref="S3.SS2.p1.17.m3.1.1.1.1.cmml">G</mi><mo id="S3.SS2.p1.17.m3.2.2.2.4.1" xref="S3.SS2.p1.17.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p1.17.m3.2.2.2.2" xref="S3.SS2.p1.17.m3.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS2.p1.17.m3.4.4.2.4" xref="S3.SS2.p1.17.m3.4.4.2.3.cmml"><mi id="S3.SS2.p1.17.m3.3.3.1.1" xref="S3.SS2.p1.17.m3.3.3.1.1.cmml">t</mi><mo id="S3.SS2.p1.17.m3.4.4.2.4.1" xref="S3.SS2.p1.17.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p1.17.m3.4.4.2.2" xref="S3.SS2.p1.17.m3.4.4.2.2.cmml">E</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m3.4b"><apply id="S3.SS2.p1.17.m3.4.5.cmml" xref="S3.SS2.p1.17.m3.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m3.4.5.1.cmml" xref="S3.SS2.p1.17.m3.4.5">superscript</csymbol><apply id="S3.SS2.p1.17.m3.4.5.2.cmml" xref="S3.SS2.p1.17.m3.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.17.m3.4.5.2.1.cmml" xref="S3.SS2.p1.17.m3.4.5">subscript</csymbol><ci id="S3.SS2.p1.17.m3.4.5.2.2.cmml" xref="S3.SS2.p1.17.m3.4.5.2.2">𝑝</ci><list id="S3.SS2.p1.17.m3.2.2.2.3.cmml" xref="S3.SS2.p1.17.m3.2.2.2.4"><ci id="S3.SS2.p1.17.m3.1.1.1.1.cmml" xref="S3.SS2.p1.17.m3.1.1.1.1">𝐺</ci><ci id="S3.SS2.p1.17.m3.2.2.2.2.cmml" xref="S3.SS2.p1.17.m3.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS2.p1.17.m3.4.4.2.3.cmml" xref="S3.SS2.p1.17.m3.4.4.2.4"><ci id="S3.SS2.p1.17.m3.3.3.1.1.cmml" xref="S3.SS2.p1.17.m3.3.3.1.1">𝑡</ci><ci id="S3.SS2.p1.17.m3.4.4.2.2.cmml" xref="S3.SS2.p1.17.m3.4.4.2.2">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m3.4c">p_{G,i}^{t,E}</annotation></semantics></math> to the server for aggregation:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.5" class="ltx_Math" alttext="p_{G}^{t}=\sum_{i\in C_{t}}\frac{n_{i}}{\sum_{j\in C_{t}}n_{j}}p_{G,i}^{t,E}." display="block"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msubsup id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2.2" xref="S3.E4.m1.5.5.1.1.2.2.2.cmml">p</mi><mi id="S3.E4.m1.5.5.1.1.2.2.3" xref="S3.E4.m1.5.5.1.1.2.2.3.cmml">G</mi><mi id="S3.E4.m1.5.5.1.1.2.3" xref="S3.E4.m1.5.5.1.1.2.3.cmml">t</mi></msubsup><mo rspace="0.111em" id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3" xref="S3.E4.m1.5.5.1.1.3.cmml"><munder id="S3.E4.m1.5.5.1.1.3.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.5.5.1.1.3.1.2" xref="S3.E4.m1.5.5.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E4.m1.5.5.1.1.3.1.3" xref="S3.E4.m1.5.5.1.1.3.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.1.3.2" xref="S3.E4.m1.5.5.1.1.3.1.3.2.cmml">i</mi><mo id="S3.E4.m1.5.5.1.1.3.1.3.1" xref="S3.E4.m1.5.5.1.1.3.1.3.1.cmml">∈</mo><msub id="S3.E4.m1.5.5.1.1.3.1.3.3" xref="S3.E4.m1.5.5.1.1.3.1.3.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.1.3.3.2" xref="S3.E4.m1.5.5.1.1.3.1.3.3.2.cmml">C</mi><mi id="S3.E4.m1.5.5.1.1.3.1.3.3.3" xref="S3.E4.m1.5.5.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></munder><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.cmml"><mfrac id="S3.E4.m1.5.5.1.1.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.cmml"><msub id="S3.E4.m1.5.5.1.1.3.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2.cmml">n</mi><mi id="S3.E4.m1.5.5.1.1.3.2.2.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.2.3.cmml">i</mi></msub><mrow id="S3.E4.m1.5.5.1.1.3.2.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.cmml"><msub id="S3.E4.m1.5.5.1.1.3.2.2.3.1" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.3.2.2.3.1.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.2.cmml">∑</mo><mrow id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.2.cmml">j</mi><mo id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.1" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.1.cmml">∈</mo><msub id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.2.cmml">C</mi><mi id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="S3.E4.m1.5.5.1.1.3.2.2.3.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.2.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2.2.cmml">n</mi><mi id="S3.E4.m1.5.5.1.1.3.2.2.3.2.3" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E4.m1.5.5.1.1.3.2.3" xref="S3.E4.m1.5.5.1.1.3.2.3.cmml"><mi id="S3.E4.m1.5.5.1.1.3.2.3.2.2" xref="S3.E4.m1.5.5.1.1.3.2.3.2.2.cmml">p</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">G</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml">t</mi><mo id="S3.E4.m1.4.4.2.4.1" xref="S3.E4.m1.4.4.2.3.cmml">,</mo><mi id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">E</mi></mrow></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2.2">𝑝</ci><ci id="S3.E4.m1.5.5.1.1.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.2.3">𝐺</ci></apply><ci id="S3.E4.m1.5.5.1.1.2.3.cmml" xref="S3.E4.m1.5.5.1.1.2.3">𝑡</ci></apply><apply id="S3.E4.m1.5.5.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3"><apply id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E4.m1.5.5.1.1.3.1.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.2"></sum><apply id="S3.E4.m1.5.5.1.1.3.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3"><in id="S3.E4.m1.5.5.1.1.3.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3.1"></in><ci id="S3.E4.m1.5.5.1.1.3.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3.2">𝑖</ci><apply id="S3.E4.m1.5.5.1.1.3.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.1.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.1.3.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3.3.2">𝐶</ci><ci id="S3.E4.m1.5.5.1.1.3.1.3.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><times id="S3.E4.m1.5.5.1.1.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.1"></times><apply id="S3.E4.m1.5.5.1.1.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2"><divide id="S3.E4.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2"></divide><apply id="S3.E4.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.2">𝑛</ci><ci id="S3.E4.m1.5.5.1.1.3.2.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.2.3">𝑖</ci></apply><apply id="S3.E4.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3"><apply id="S3.E4.m1.5.5.1.1.3.2.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.3.1.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1">subscript</csymbol><sum id="S3.E4.m1.5.5.1.1.3.2.2.3.1.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.2"></sum><apply id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3"><in id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.1"></in><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.2">𝑗</ci><apply id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.2">𝐶</ci><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.3.2.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.2.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2.2">𝑛</ci><ci id="S3.E4.m1.5.5.1.1.3.2.2.3.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E4.m1.5.5.1.1.3.2.3.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3">superscript</csymbol><apply id="S3.E4.m1.5.5.1.1.3.2.3.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.3.2.3.2.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.3.2.3.2.2.cmml" xref="S3.E4.m1.5.5.1.1.3.2.3.2.2">𝑝</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝐺</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.4"><ci id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1">𝑡</ci><ci id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">𝐸</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">p_{G}^{t}=\sum_{i\in C_{t}}\frac{n_{i}}{\sum_{j\in C_{t}}n_{j}}p_{G,i}^{t,E}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.21" class="ltx_p">The global prompt is aggregated in the context of federated learning, carrying the unique characteristics learned from other clients. The optimization objective of FPL can be formulated as:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\min_{p_{G}}\sum_{i=1}^{N}\frac{n_{i}}{\sum_{j}n_{j}}\mathcal{L}_{ce}^{D_{i}}(p_{G})," display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><munder id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml">min</mi><msub id="S3.E5.m1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.3.3.2.cmml">p</mi><mi id="S3.E5.m1.1.1.1.1.3.3.3" xref="S3.E5.m1.1.1.1.1.3.3.3.cmml">G</mi></msub></munder><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><munderover id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E5.m1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2.2.3.2" xref="S3.E5.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E5.m1.1.1.1.1.1.2.2.3.1" xref="S3.E5.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.1.2.2.3.3" xref="S3.E5.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mfrac id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mrow id="S3.E5.m1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.cmml"><msub id="S3.E5.m1.1.1.1.1.1.1.3.3.1" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.3.3.1.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.3.cmml">j</mi></msub><msub id="S3.E5.m1.1.1.1.1.1.1.3.3.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2.2.cmml">n</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S3.E5.m1.1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.1.1.4.2.2" xref="S3.E5.m1.1.1.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S3.E5.m1.1.1.1.1.1.1.4.2.3" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.4.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.1.1.4.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.3.cmml">e</mi></mrow><msub id="S3.E5.m1.1.1.1.1.1.1.4.3" xref="S3.E5.m1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.4.3.2" xref="S3.E5.m1.1.1.1.1.1.1.4.3.2.cmml">D</mi><mi id="S3.E5.m1.1.1.1.1.1.1.4.3.3" xref="S3.E5.m1.1.1.1.1.1.1.4.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.1.1.2a" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><times id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3">subscript</csymbol><min id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"></min><apply id="S3.E5.m1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.3.2">𝑝</ci><ci id="S3.E5.m1.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.3.3">𝐺</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><apply id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E5.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3"><eq id="S3.E5.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><divide id="S3.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3"><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.3.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.1.1.3.3.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.2"></sum><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.1.3">𝑗</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2.2">𝑛</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.2">ℒ</ci><apply id="S3.E5.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3"><times id="S3.E5.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.2">𝑐</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.2.3.3">𝑒</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3.2">𝐷</ci><ci id="S3.E5.m1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.4.3.3">𝑖</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.1.3">𝐺</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\min_{p_{G}}\sum_{i=1}^{N}\frac{n_{i}}{\sum_{j}n_{j}}\mathcal{L}_{ce}^{D_{i}}(p_{G}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.20" class="ltx_p">where <math id="S3.SS2.p1.18.m1.1" class="ltx_Math" alttext="\mathcal{L}_{ce}^{D_{i}}(p_{G})" display="inline"><semantics id="S3.SS2.p1.18.m1.1a"><mrow id="S3.SS2.p1.18.m1.1.1" xref="S3.SS2.p1.18.m1.1.1.cmml"><msubsup id="S3.SS2.p1.18.m1.1.1.3" xref="S3.SS2.p1.18.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.18.m1.1.1.3.2.2" xref="S3.SS2.p1.18.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.SS2.p1.18.m1.1.1.3.2.3" xref="S3.SS2.p1.18.m1.1.1.3.2.3.cmml"><mi id="S3.SS2.p1.18.m1.1.1.3.2.3.2" xref="S3.SS2.p1.18.m1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.18.m1.1.1.3.2.3.1" xref="S3.SS2.p1.18.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.18.m1.1.1.3.2.3.3" xref="S3.SS2.p1.18.m1.1.1.3.2.3.3.cmml">e</mi></mrow><msub id="S3.SS2.p1.18.m1.1.1.3.3" xref="S3.SS2.p1.18.m1.1.1.3.3.cmml"><mi id="S3.SS2.p1.18.m1.1.1.3.3.2" xref="S3.SS2.p1.18.m1.1.1.3.3.2.cmml">D</mi><mi id="S3.SS2.p1.18.m1.1.1.3.3.3" xref="S3.SS2.p1.18.m1.1.1.3.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p1.18.m1.1.1.2" xref="S3.SS2.p1.18.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.18.m1.1.1.1.1" xref="S3.SS2.p1.18.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.18.m1.1.1.1.1.2" xref="S3.SS2.p1.18.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.18.m1.1.1.1.1.1" xref="S3.SS2.p1.18.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.18.m1.1.1.1.1.1.2" xref="S3.SS2.p1.18.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.p1.18.m1.1.1.1.1.1.3" xref="S3.SS2.p1.18.m1.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S3.SS2.p1.18.m1.1.1.1.1.3" xref="S3.SS2.p1.18.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.18.m1.1b"><apply id="S3.SS2.p1.18.m1.1.1.cmml" xref="S3.SS2.p1.18.m1.1.1"><times id="S3.SS2.p1.18.m1.1.1.2.cmml" xref="S3.SS2.p1.18.m1.1.1.2"></times><apply id="S3.SS2.p1.18.m1.1.1.3.cmml" xref="S3.SS2.p1.18.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.18.m1.1.1.3.1.cmml" xref="S3.SS2.p1.18.m1.1.1.3">superscript</csymbol><apply id="S3.SS2.p1.18.m1.1.1.3.2.cmml" xref="S3.SS2.p1.18.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.18.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.18.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.18.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.18.m1.1.1.3.2.2">ℒ</ci><apply id="S3.SS2.p1.18.m1.1.1.3.2.3.cmml" xref="S3.SS2.p1.18.m1.1.1.3.2.3"><times id="S3.SS2.p1.18.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.p1.18.m1.1.1.3.2.3.1"></times><ci id="S3.SS2.p1.18.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.p1.18.m1.1.1.3.2.3.2">𝑐</ci><ci id="S3.SS2.p1.18.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.p1.18.m1.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="S3.SS2.p1.18.m1.1.1.3.3.cmml" xref="S3.SS2.p1.18.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.18.m1.1.1.3.3.1.cmml" xref="S3.SS2.p1.18.m1.1.1.3.3">subscript</csymbol><ci id="S3.SS2.p1.18.m1.1.1.3.3.2.cmml" xref="S3.SS2.p1.18.m1.1.1.3.3.2">𝐷</ci><ci id="S3.SS2.p1.18.m1.1.1.3.3.3.cmml" xref="S3.SS2.p1.18.m1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.p1.18.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.18.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.18.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.18.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.18.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.18.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.p1.18.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.18.m1.1.1.1.1.1.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.18.m1.1c">\mathcal{L}_{ce}^{D_{i}}(p_{G})</annotation></semantics></math> represents the cross-entropy loss on dataset <math id="S3.SS2.p1.19.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.SS2.p1.19.m2.1a"><msub id="S3.SS2.p1.19.m2.1.1" xref="S3.SS2.p1.19.m2.1.1.cmml"><mi id="S3.SS2.p1.19.m2.1.1.2" xref="S3.SS2.p1.19.m2.1.1.2.cmml">D</mi><mi id="S3.SS2.p1.19.m2.1.1.3" xref="S3.SS2.p1.19.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.19.m2.1b"><apply id="S3.SS2.p1.19.m2.1.1.cmml" xref="S3.SS2.p1.19.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.19.m2.1.1.1.cmml" xref="S3.SS2.p1.19.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.19.m2.1.1.2.cmml" xref="S3.SS2.p1.19.m2.1.1.2">𝐷</ci><ci id="S3.SS2.p1.19.m2.1.1.3.cmml" xref="S3.SS2.p1.19.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.19.m2.1c">D_{i}</annotation></semantics></math> of client <math id="S3.SS2.p1.20.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p1.20.m3.1a"><mi id="S3.SS2.p1.20.m3.1.1" xref="S3.SS2.p1.20.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.20.m3.1b"><ci id="S3.SS2.p1.20.m3.1.1.cmml" xref="S3.SS2.p1.20.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.20.m3.1c">i</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Generalization and Personalization for FPL</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.4" class="ltx_p">Previous research has discovered that prompted visual-language models, such as CoOp, overfit to the base classes and cannot generalize to the unseen class observed during training <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib61" title="" class="ltx_ref">2022a</a>; Zhu et al., <a href="#bib.bib63" title="" class="ltx_ref">2023</a>; Ma et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite>.
This phenomenon of overfitting to base classes implies that the prompt fails to capture more generalized elements that are crucial for recognizing a wider range of scenarios. On the contrary, the manually designed prompts adopted by the zero-shot CLIP are relatively generalizable. The problem of generalization in prompt vision-language models remains unresolved in FPL. The objective of the client’s local training can be formulated as:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.8" class="ltx_Math" alttext="\mathcal{L}_{ce}^{D_{i}}(p_{G,i}^{t,e})=-\frac{1}{|\mathcal{D}_{i}|}\sum_{(x,y)\in\mathcal{D}_{i}}\sum_{k}y\log p(\hat{y}=k|x)." display="block"><semantics id="S3.E6.m1.8a"><mrow id="S3.E6.m1.8.8.1" xref="S3.E6.m1.8.8.1.1.cmml"><mrow id="S3.E6.m1.8.8.1.1" xref="S3.E6.m1.8.8.1.1.cmml"><mrow id="S3.E6.m1.8.8.1.1.1" xref="S3.E6.m1.8.8.1.1.1.cmml"><msubsup id="S3.E6.m1.8.8.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.8.8.1.1.1.3.2.2" xref="S3.E6.m1.8.8.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E6.m1.8.8.1.1.1.3.2.3" xref="S3.E6.m1.8.8.1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.8.8.1.1.1.3.2.3.2" xref="S3.E6.m1.8.8.1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.3.2.3.1" xref="S3.E6.m1.8.8.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.8.8.1.1.1.3.2.3.3" xref="S3.E6.m1.8.8.1.1.1.3.2.3.3.cmml">e</mi></mrow><msub id="S3.E6.m1.8.8.1.1.1.3.3" xref="S3.E6.m1.8.8.1.1.1.3.3.cmml"><mi id="S3.E6.m1.8.8.1.1.1.3.3.2" xref="S3.E6.m1.8.8.1.1.1.3.3.2.cmml">D</mi><mi id="S3.E6.m1.8.8.1.1.1.3.3.3" xref="S3.E6.m1.8.8.1.1.1.3.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E6.m1.8.8.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.8.8.1.1.1.1.1.1.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">G</mi><mo id="S3.E6.m1.2.2.2.4.1" xref="S3.E6.m1.2.2.2.3.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.E6.m1.4.4.2.4" xref="S3.E6.m1.4.4.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml">t</mi><mo id="S3.E6.m1.4.4.2.4.1" xref="S3.E6.m1.4.4.2.3.cmml">,</mo><mi id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml">e</mi></mrow></msubsup><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.8.8.1.1.3" xref="S3.E6.m1.8.8.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.8.8.1.1.2" xref="S3.E6.m1.8.8.1.1.2.cmml"><mo id="S3.E6.m1.8.8.1.1.2a" xref="S3.E6.m1.8.8.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.8.8.1.1.2.1" xref="S3.E6.m1.8.8.1.1.2.1.cmml"><mfrac id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml"><mn id="S3.E6.m1.5.5.3" xref="S3.E6.m1.5.5.3.cmml">1</mn><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.2.1.cmml">|</mo><msub id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.2.cmml">𝒟</mi><mi id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.2.1.2" xref="S3.E6.m1.8.8.1.1.2.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.2.1.1" xref="S3.E6.m1.8.8.1.1.2.1.1.cmml"><munder id="S3.E6.m1.8.8.1.1.2.1.1.2" xref="S3.E6.m1.8.8.1.1.2.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.8.8.1.1.2.1.1.2.2" xref="S3.E6.m1.8.8.1.1.2.1.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.7.7.2" xref="S3.E6.m1.7.7.2.cmml"><mrow id="S3.E6.m1.7.7.2.4.2" xref="S3.E6.m1.7.7.2.4.1.cmml"><mo stretchy="false" id="S3.E6.m1.7.7.2.4.2.1" xref="S3.E6.m1.7.7.2.4.1.cmml">(</mo><mi id="S3.E6.m1.6.6.1.1" xref="S3.E6.m1.6.6.1.1.cmml">x</mi><mo id="S3.E6.m1.7.7.2.4.2.2" xref="S3.E6.m1.7.7.2.4.1.cmml">,</mo><mi id="S3.E6.m1.7.7.2.2" xref="S3.E6.m1.7.7.2.2.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.7.7.2.4.2.3" xref="S3.E6.m1.7.7.2.4.1.cmml">)</mo></mrow><mo id="S3.E6.m1.7.7.2.3" xref="S3.E6.m1.7.7.2.3.cmml">∈</mo><msub id="S3.E6.m1.7.7.2.5" xref="S3.E6.m1.7.7.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.7.7.2.5.2" xref="S3.E6.m1.7.7.2.5.2.cmml">𝒟</mi><mi id="S3.E6.m1.7.7.2.5.3" xref="S3.E6.m1.7.7.2.5.3.cmml">i</mi></msub></mrow></munder><mrow id="S3.E6.m1.8.8.1.1.2.1.1.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.cmml"><munder id="S3.E6.m1.8.8.1.1.2.1.1.1.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E6.m1.8.8.1.1.2.1.1.1.2.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2.2.cmml">∑</mo><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.2.3" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2.3.cmml">k</mi></munder><mrow id="S3.E6.m1.8.8.1.1.2.1.1.1.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.cmml"><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.3.cmml">y</mi><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.cmml"><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4a" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.cmml">⁡</mo><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.2a" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo fence="false" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo stretchy="false" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.8.8.1.2" xref="S3.E6.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.8b"><apply id="S3.E6.m1.8.8.1.1.cmml" xref="S3.E6.m1.8.8.1"><eq id="S3.E6.m1.8.8.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.3"></eq><apply id="S3.E6.m1.8.8.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1"><times id="S3.E6.m1.8.8.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.1.2"></times><apply id="S3.E6.m1.8.8.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.3">superscript</csymbol><apply id="S3.E6.m1.8.8.1.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.3.2.1.cmml" xref="S3.E6.m1.8.8.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.3.2.2.cmml" xref="S3.E6.m1.8.8.1.1.1.3.2.2">ℒ</ci><apply id="S3.E6.m1.8.8.1.1.1.3.2.3.cmml" xref="S3.E6.m1.8.8.1.1.1.3.2.3"><times id="S3.E6.m1.8.8.1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.3.2.3.1"></times><ci id="S3.E6.m1.8.8.1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E6.m1.8.8.1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.8.8.1.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="S3.E6.m1.8.8.1.1.1.3.3.cmml" xref="S3.E6.m1.8.8.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.3.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.3.3">subscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.3.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.3.3.2">𝐷</ci><ci id="S3.E6.m1.8.8.1.1.1.3.3.3.cmml" xref="S3.E6.m1.8.8.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.2.2">𝑝</ci><list id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.4"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝐺</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑖</ci></list></apply><list id="S3.E6.m1.4.4.2.3.cmml" xref="S3.E6.m1.4.4.2.4"><ci id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1">𝑡</ci><ci id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2">𝑒</ci></list></apply></apply><apply id="S3.E6.m1.8.8.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2"><minus id="S3.E6.m1.8.8.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2"></minus><apply id="S3.E6.m1.8.8.1.1.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1"><times id="S3.E6.m1.8.8.1.1.2.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.2"></times><apply id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5"><divide id="S3.E6.m1.5.5.2.cmml" xref="S3.E6.m1.5.5"></divide><cn type="integer" id="S3.E6.m1.5.5.3.cmml" xref="S3.E6.m1.5.5.3">1</cn><apply id="S3.E6.m1.5.5.1.2.cmml" xref="S3.E6.m1.5.5.1.1"><abs id="S3.E6.m1.5.5.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2"></abs><apply id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.2">𝒟</ci><ci id="S3.E6.m1.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.8.8.1.1.2.1.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1"><apply id="S3.E6.m1.8.8.1.1.2.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.2.1.1.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.2">subscript</csymbol><sum id="S3.E6.m1.8.8.1.1.2.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.2.2"></sum><apply id="S3.E6.m1.7.7.2.cmml" xref="S3.E6.m1.7.7.2"><in id="S3.E6.m1.7.7.2.3.cmml" xref="S3.E6.m1.7.7.2.3"></in><interval closure="open" id="S3.E6.m1.7.7.2.4.1.cmml" xref="S3.E6.m1.7.7.2.4.2"><ci id="S3.E6.m1.6.6.1.1.cmml" xref="S3.E6.m1.6.6.1.1">𝑥</ci><ci id="S3.E6.m1.7.7.2.2.cmml" xref="S3.E6.m1.7.7.2.2">𝑦</ci></interval><apply id="S3.E6.m1.7.7.2.5.cmml" xref="S3.E6.m1.7.7.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.2.5.1.cmml" xref="S3.E6.m1.7.7.2.5">subscript</csymbol><ci id="S3.E6.m1.7.7.2.5.2.cmml" xref="S3.E6.m1.7.7.2.5.2">𝒟</ci><ci id="S3.E6.m1.7.7.2.5.3.cmml" xref="S3.E6.m1.7.7.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1"><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.2.1.1.1.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.8.8.1.1.2.1.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2.2"></sum><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.2.3.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1"><times id="S3.E6.m1.8.8.1.1.2.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.2"></times><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.3">𝑦</ci><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4"><log id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.1"></log><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.4.2">𝑝</ci></apply><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1"><eq id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.1"></eq><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2"><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.1">^</ci><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><apply id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.1">conditional</csymbol><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.8.8.1.1.2.1.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.8c">\mathcal{L}_{ce}^{D_{i}}(p_{G,i}^{t,e})=-\frac{1}{|\mathcal{D}_{i}|}\sum_{(x,y)\in\mathcal{D}_{i}}\sum_{k}y\log p(\hat{y}=k|x).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.3" class="ltx_p"><math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{ce}^{D_{i}}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msubsup id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.2.2" xref="S3.SS3.p1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.SS3.p1.1.m1.1.1.2.3" xref="S3.SS3.p1.1.m1.1.1.2.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2.3.2" xref="S3.SS3.p1.1.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.2.3.1" xref="S3.SS3.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.2.3.3" xref="S3.SS3.p1.1.m1.1.1.2.3.3.cmml">e</mi></mrow><msub id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">D</mi><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">i</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2">ℒ</ci><apply id="S3.SS3.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3"><times id="S3.SS3.p1.1.m1.1.1.2.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.2.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3.2">𝑐</ci><ci id="S3.SS3.p1.1.m1.1.1.2.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝐷</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{L}_{ce}^{D_{i}}</annotation></semantics></math> is to optimize the prompts for the client-specific task.
Despite aggregating prompts in federated learning, overfitting to client-specific tasks remains a challenge. Leveraging the remarkable generalization capabilities of CLIP, FedPGP utilizes knowledge from CLIP to guide the global prompt to enhance generalization. Specifically, we obtain the representations of the handcrafted prompt <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="g(p_{C})" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mrow id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.2.m2.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.2.m2.1.1.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml">C</mi></msub><mo stretchy="false" id="S3.SS3.p1.2.m2.1.1.1.1.3" xref="S3.SS3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><times id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"></times><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑔</ci><apply id="S3.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">g(p_{C})</annotation></semantics></math> of CLIP and the global prompt <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="g(p_{G})" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.3.m3.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.3.m3.1.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.3.m3.1.1.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.1.1.1.2" xref="S3.SS3.p1.3.m3.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS3.p1.3.m3.1.1.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S3.SS3.p1.3.m3.1.1.1.1.3" xref="S3.SS3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><times id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2"></times><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑔</ci><apply id="S3.SS3.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS3.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.1.1.1.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">g(p_{G})</annotation></semantics></math> and align them through a metric function, such as cosine similarity. This knowledge-guidance from CLIP promotes the preservation of category-agnostic information within learnable global prompts, contributing to improve model generalization.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.3" class="ltx_p">Due to data heterogeneity, it is difficult for a single global prompt to adapt to diverse local distributions. Different from tuning model parameters in traditional federated learning, FPL involves frozen client models and learnable prompts, leading to a distinct approach in adapting global prompt to local distributions.
In FedPGP, the adaptation of global prompt <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="p_{G}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">p</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑝</ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">p_{G}</annotation></semantics></math> to the client-specific prompt <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑝</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">p_{i}</annotation></semantics></math> is achieved by introducing an additional adaptation term <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">​</mo><msub id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">p</mi><mi id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><times id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></times><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">Δ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑝</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\Delta p_{i}</annotation></semantics></math>:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="p_{i}=p_{G}+\Delta p_{i}," display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml">G</mi></msub><mo id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.E7.m1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.3.3.1" xref="S3.E7.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S3.E7.m1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.3.2.cmml">p</mi><mi id="S3.E7.m1.1.1.1.1.3.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><plus id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3">𝐺</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><times id="S3.E7.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2">Δ</ci><apply id="S3.E7.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.2">𝑝</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">p_{i}=p_{G}+\Delta p_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.5" class="ltx_p">where <math id="S3.SS3.p2.4.m1.1" class="ltx_Math" alttext="\Delta p_{i}\in\mathbb{R}^{d\times k}" display="inline"><semantics id="S3.SS3.p2.4.m1.1a"><mrow id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml"><mrow id="S3.SS3.p2.4.m1.1.1.2" xref="S3.SS3.p2.4.m1.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS3.p2.4.m1.1.1.2.2" xref="S3.SS3.p2.4.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.4.m1.1.1.2.1" xref="S3.SS3.p2.4.m1.1.1.2.1.cmml">​</mo><msub id="S3.SS3.p2.4.m1.1.1.2.3" xref="S3.SS3.p2.4.m1.1.1.2.3.cmml"><mi id="S3.SS3.p2.4.m1.1.1.2.3.2" xref="S3.SS3.p2.4.m1.1.1.2.3.2.cmml">p</mi><mi id="S3.SS3.p2.4.m1.1.1.2.3.3" xref="S3.SS3.p2.4.m1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p2.4.m1.1.1.1" xref="S3.SS3.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.4.m1.1.1.3" xref="S3.SS3.p2.4.m1.1.1.3.cmml"><mi id="S3.SS3.p2.4.m1.1.1.3.2" xref="S3.SS3.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p2.4.m1.1.1.3.3" xref="S3.SS3.p2.4.m1.1.1.3.3.cmml"><mi id="S3.SS3.p2.4.m1.1.1.3.3.2" xref="S3.SS3.p2.4.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.4.m1.1.1.3.3.1" xref="S3.SS3.p2.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.4.m1.1.1.3.3.3" xref="S3.SS3.p2.4.m1.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><apply id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1"><in id="S3.SS3.p2.4.m1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1.1"></in><apply id="S3.SS3.p2.4.m1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2"><times id="S3.SS3.p2.4.m1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m1.1.1.2.1"></times><ci id="S3.SS3.p2.4.m1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2.2">Δ</ci><apply id="S3.SS3.p2.4.m1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.1.1.2.3.1.cmml" xref="S3.SS3.p2.4.m1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p2.4.m1.1.1.2.3.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2.3.2">𝑝</ci><ci id="S3.SS3.p2.4.m1.1.1.2.3.3.cmml" xref="S3.SS3.p2.4.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p2.4.m1.1.1.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.4.m1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S3.SS3.p2.4.m1.1.1.3.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3"><times id="S3.SS3.p2.4.m1.1.1.3.3.1.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3.1"></times><ci id="S3.SS3.p2.4.m1.1.1.3.3.2.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p2.4.m1.1.1.3.3.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">\Delta p_{i}\in\mathbb{R}^{d\times k}</annotation></semantics></math> owns the same dimension of <math id="S3.SS3.p2.5.m2.1" class="ltx_Math" alttext="p_{G}" display="inline"><semantics id="S3.SS3.p2.5.m2.1a"><msub id="S3.SS3.p2.5.m2.1.1" xref="S3.SS3.p2.5.m2.1.1.cmml"><mi id="S3.SS3.p2.5.m2.1.1.2" xref="S3.SS3.p2.5.m2.1.1.2.cmml">p</mi><mi id="S3.SS3.p2.5.m2.1.1.3" xref="S3.SS3.p2.5.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.1b"><apply id="S3.SS3.p2.5.m2.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m2.1.1.2.cmml" xref="S3.SS3.p2.5.m2.1.1.2">𝑝</ci><ci id="S3.SS3.p2.5.m2.1.1.3.cmml" xref="S3.SS3.p2.5.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.1c">p_{G}</annotation></semantics></math>. Then the objective of federated learning can be formulated as:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.3" class="ltx_Math" alttext="\min_{p_{G},\{\Delta p_{i}\}_{i=1}^{N}}\sum_{i=1}^{N}\frac{n_{i}}{\sum_{j}n_{j}}\mathcal{L}_{ce}^{D_{i}}(p_{G}+\Delta p_{i})." display="block"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><munder id="S3.E8.m1.3.3.1.1.3" xref="S3.E8.m1.3.3.1.1.3.cmml"><mi id="S3.E8.m1.3.3.1.1.3.2" xref="S3.E8.m1.3.3.1.1.3.2.cmml">min</mi><mrow id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.3.cmml"><msub id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">G</mi></msub><mo id="S3.E8.m1.2.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.E8.m1.2.2.2.2.2" xref="S3.E8.m1.2.2.2.2.2.cmml"><mrow id="S3.E8.m1.2.2.2.2.2.1.1.1" xref="S3.E8.m1.2.2.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.2.1.1.1.2" xref="S3.E8.m1.2.2.2.2.2.1.1.2.cmml">{</mo><mrow id="S3.E8.m1.2.2.2.2.2.1.1.1.1" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.cmml"><mi mathvariant="normal" id="S3.E8.m1.2.2.2.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.1.cmml">​</mo><msub id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.2" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.3" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E8.m1.2.2.2.2.2.1.1.1.3" xref="S3.E8.m1.2.2.2.2.2.1.1.2.cmml">}</mo></mrow><mrow id="S3.E8.m1.2.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.2.2.1.3.cmml"><mi id="S3.E8.m1.2.2.2.2.2.1.3.2" xref="S3.E8.m1.2.2.2.2.2.1.3.2.cmml">i</mi><mo id="S3.E8.m1.2.2.2.2.2.1.3.1" xref="S3.E8.m1.2.2.2.2.2.1.3.1.cmml">=</mo><mn id="S3.E8.m1.2.2.2.2.2.1.3.3" xref="S3.E8.m1.2.2.2.2.2.1.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.2.2.2.2.2.3" xref="S3.E8.m1.2.2.2.2.2.3.cmml">N</mi></msubsup></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.1.cmml"><munderover id="S3.E8.m1.3.3.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E8.m1.3.3.1.1.1.2.2.2" xref="S3.E8.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.3.3.1.1.1.2.2.3" xref="S3.E8.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.2.2.3.2" xref="S3.E8.m1.3.3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E8.m1.3.3.1.1.1.2.2.3.1" xref="S3.E8.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.3.3.1.1.1.2.2.3.3" xref="S3.E8.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.3.3.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.cmml"><mfrac id="S3.E8.m1.3.3.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.3.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.3.2" xref="S3.E8.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.3.2.2" xref="S3.E8.m1.3.3.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E8.m1.3.3.1.1.1.1.3.2.3" xref="S3.E8.m1.3.3.1.1.1.1.3.2.3.cmml">i</mi></msub><mrow id="S3.E8.m1.3.3.1.1.1.1.3.3" xref="S3.E8.m1.3.3.1.1.1.1.3.3.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.3.3.1" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.3.3.1.2" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.1.3" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.3.cmml">j</mi></msub><msub id="S3.E8.m1.3.3.1.1.1.1.3.3.2" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.2.2" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2.2.cmml">n</mi><mi id="S3.E8.m1.3.3.1.1.1.1.3.3.2.3" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">​</mo><msubsup id="S3.E8.m1.3.3.1.1.1.1.4" xref="S3.E8.m1.3.3.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.3.3.1.1.1.1.4.2.2" xref="S3.E8.m1.3.3.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.3.3.1.1.1.1.4.2.3" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.4.2.3.2" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.1.1.1.1.4.2.3.1" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E8.m1.3.3.1.1.1.1.4.2.3.3" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.3.cmml">e</mi></mrow><msub id="S3.E8.m1.3.3.1.1.1.1.4.3" xref="S3.E8.m1.3.3.1.1.1.1.4.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.4.3.2" xref="S3.E8.m1.3.3.1.1.1.1.4.3.2.cmml">D</mi><mi id="S3.E8.m1.3.3.1.1.1.1.4.3.3" xref="S3.E8.m1.3.3.1.1.1.1.4.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.1.1.1.1.2a" xref="S3.E8.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">G</mi></msub><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml">p</mi><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E8.m1.3.3.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E8.m1.3.3.1.2" xref="S3.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><times id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"></times><apply id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3">subscript</csymbol><min id="S3.E8.m1.3.3.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.3.2"></min><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2"><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S3.E8.m1.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E8.m1.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.1.2.cmml" xref="S3.E8.m1.2.2.2.2.2">subscript</csymbol><set id="S3.E8.m1.2.2.2.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1"><apply id="S3.E8.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1"><times id="S3.E8.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.1"></times><ci id="S3.E8.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.2">Δ</ci><apply id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.2">𝑝</ci><ci id="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></set><apply id="S3.E8.m1.2.2.2.2.2.1.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.3"><eq id="S3.E8.m1.2.2.2.2.2.1.3.1.cmml" xref="S3.E8.m1.2.2.2.2.2.1.3.1"></eq><ci id="S3.E8.m1.2.2.2.2.2.1.3.2.cmml" xref="S3.E8.m1.2.2.2.2.2.1.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.2.2.2.2.2.1.3.3.cmml" xref="S3.E8.m1.2.2.2.2.2.1.3.3">1</cn></apply></apply><ci id="S3.E8.m1.2.2.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2.2.3">𝑁</ci></apply></list></apply><apply id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"><apply id="S3.E8.m1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E8.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.2.2.3"><eq id="S3.E8.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E8.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E8.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.3.3.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1"><times id="S3.E8.m1.3.3.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.2"></times><apply id="S3.E8.m1.3.3.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3"><divide id="S3.E8.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3"></divide><apply id="S3.E8.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E8.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3"><apply id="S3.E8.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E8.m1.3.3.1.1.1.1.3.3.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.2"></sum><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.1.3">𝑗</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2.2">𝑛</ci><ci id="S3.E8.m1.3.3.1.1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E8.m1.3.3.1.1.1.1.4.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.2.2">ℒ</ci><apply id="S3.E8.m1.3.3.1.1.1.1.4.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3"><times id="S3.E8.m1.3.3.1.1.1.1.4.2.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.1"></times><ci id="S3.E8.m1.3.3.1.1.1.1.4.2.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.2">𝑐</ci><ci id="S3.E8.m1.3.3.1.1.1.1.4.2.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.2.3.3">𝑒</ci></apply></apply><apply id="S3.E8.m1.3.3.1.1.1.1.4.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.4.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.4.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.3.2">𝐷</ci><ci id="S3.E8.m1.3.3.1.1.1.1.4.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.4.3.3">𝑖</ci></apply></apply><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><plus id="S3.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.1"></plus><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.2.3">𝐺</ci></apply><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3"><times id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.2">Δ</ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\min_{p_{G},\{\Delta p_{i}\}_{i=1}^{N}}\sum_{i=1}^{N}\frac{n_{i}}{\sum_{j}n_{j}}\mathcal{L}_{ce}^{D_{i}}(p_{G}+\Delta p_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Balance FPL’s Generalization and Personalization</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.9" class="ltx_p">Previous research <cite class="ltx_cite ltx_citemacro_citep">(Aghajanyan et al., <a href="#bib.bib1" title="" class="ltx_ref">2020</a>)</cite> has shown that pre-trained language models with lower intrinsic dimensions tend to exhibit better evaluation accuracy and lower relative generalization gaps across various tasks. Inspired by this, we propose that the prompt may also possess a low ”intrinsic rank” during the adaptation process. To retain information derived from aggregation and knowledge-guidance of CLIP, our adaptation term is designed in a low-rank form instead of adding a full-rank term to overwrite the global prompt entirely. Specifically, the additional term is decomposed as:</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\Delta p_{i}=U_{i}V_{i}." display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E9.m1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E9.m1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.2.3.2" xref="S3.E9.m1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.E9.m1.1.1.1.1.2.3.3" xref="S3.E9.m1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><msub id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S3.E9.m1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.3.1" xref="S3.E9.m1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.2.cmml">V</mi><mi id="S3.E9.m1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo lspace="0em" id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"></eq><apply id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"><times id="S3.E9.m1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.2.1"></times><ci id="S3.E9.m1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.2.2">Δ</ci><apply id="S3.E9.m1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.E9.m1.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><times id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.1"></times><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2">𝑈</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.2">𝑉</ci><ci id="S3.E9.m1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\Delta p_{i}=U_{i}V_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.5" class="ltx_p">We decompose <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">​</mo><msub id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">p</mi><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></times><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">Δ</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\Delta p_{i}</annotation></semantics></math> into multiplication between two low-rank matrices <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="U_{i}\in\mathbb{R}^{d\times b}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><msub id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2.2" xref="S3.SS4.p1.2.m2.1.1.2.2.cmml">U</mi><mi id="S3.SS4.p1.2.m2.1.1.2.3" xref="S3.SS4.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.3.2" xref="S3.SS4.p1.2.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.2.m2.1.1.3.3.1" xref="S3.SS4.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.3.cmml">b</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><in id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></in><apply id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.2.1.cmml" xref="S3.SS4.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2.2">𝑈</ci><ci id="S3.SS4.p1.2.m2.1.1.2.3.cmml" xref="S3.SS4.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3"><times id="S3.SS4.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS4.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">U_{i}\in\mathbb{R}^{d\times b}</annotation></semantics></math> and <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="V_{i}\in\mathbb{R}^{b\times k}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><msub id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2.2" xref="S3.SS4.p1.3.m3.1.1.2.2.cmml">V</mi><mi id="S3.SS4.p1.3.m3.1.1.2.3" xref="S3.SS4.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.3.m3.1.1.1" xref="S3.SS4.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml"><mi id="S3.SS4.p1.3.m3.1.1.3.2" xref="S3.SS4.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.3.m3.1.1.3.3" xref="S3.SS4.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS4.p1.3.m3.1.1.3.3.2" xref="S3.SS4.p1.3.m3.1.1.3.3.2.cmml">b</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.3.m3.1.1.3.3.1" xref="S3.SS4.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.3.m3.1.1.3.3.3" xref="S3.SS4.p1.3.m3.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><in id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1.1"></in><apply id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2.2">𝑉</ci><ci id="S3.SS4.p1.3.m3.1.1.2.3.cmml" xref="S3.SS4.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.3.1.cmml" xref="S3.SS4.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.3.2.cmml" xref="S3.SS4.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.3.m3.1.1.3.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3"><times id="S3.SS4.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS4.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3.2">𝑏</ci><ci id="S3.SS4.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">V_{i}\in\mathbb{R}^{b\times k}</annotation></semantics></math>, where <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">b</annotation></semantics></math> denotes the bottleneck dimension of low-rank decomposition. Consequently, each client’s personalized learnable prompt <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="p_{i}\in\mathbb{R}^{d\times k}" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mrow id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><msub id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2.2" xref="S3.SS4.p1.5.m5.1.1.2.2.cmml">p</mi><mi id="S3.SS4.p1.5.m5.1.1.2.3" xref="S3.SS4.p1.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p1.5.m5.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.3.2" xref="S3.SS4.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.5.m5.1.1.3.3" xref="S3.SS4.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.3.3.2" xref="S3.SS4.p1.5.m5.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.5.m5.1.1.3.3.1" xref="S3.SS4.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.5.m5.1.1.3.3.3" xref="S3.SS4.p1.5.m5.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><in id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1"></in><apply id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2.2">𝑝</ci><ci id="S3.SS4.p1.5.m5.1.1.2.3.cmml" xref="S3.SS4.p1.5.m5.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.5.m5.1.1.3.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3"><times id="S3.SS4.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3.1"></times><ci id="S3.SS4.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">p_{i}\in\mathbb{R}^{d\times k}</annotation></semantics></math> can be reformulated as:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="p_{i}=p_{G}+\Delta p_{i}=p_{G}+U_{i}V_{i}," display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E10.m1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.4.cmml"><msub id="S3.E10.m1.1.1.1.1.4.2" xref="S3.E10.m1.1.1.1.1.4.2.cmml"><mi id="S3.E10.m1.1.1.1.1.4.2.2" xref="S3.E10.m1.1.1.1.1.4.2.2.cmml">p</mi><mi id="S3.E10.m1.1.1.1.1.4.2.3" xref="S3.E10.m1.1.1.1.1.4.2.3.cmml">G</mi></msub><mo id="S3.E10.m1.1.1.1.1.4.1" xref="S3.E10.m1.1.1.1.1.4.1.cmml">+</mo><mrow id="S3.E10.m1.1.1.1.1.4.3" xref="S3.E10.m1.1.1.1.1.4.3.cmml"><mi mathvariant="normal" id="S3.E10.m1.1.1.1.1.4.3.2" xref="S3.E10.m1.1.1.1.1.4.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.4.3.1" xref="S3.E10.m1.1.1.1.1.4.3.1.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.4.3.3" xref="S3.E10.m1.1.1.1.1.4.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.4.3.3.2" xref="S3.E10.m1.1.1.1.1.4.3.3.2.cmml">p</mi><mi id="S3.E10.m1.1.1.1.1.4.3.3.3" xref="S3.E10.m1.1.1.1.1.4.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.5" xref="S3.E10.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.6" xref="S3.E10.m1.1.1.1.1.6.cmml"><msub id="S3.E10.m1.1.1.1.1.6.2" xref="S3.E10.m1.1.1.1.1.6.2.cmml"><mi id="S3.E10.m1.1.1.1.1.6.2.2" xref="S3.E10.m1.1.1.1.1.6.2.2.cmml">p</mi><mi id="S3.E10.m1.1.1.1.1.6.2.3" xref="S3.E10.m1.1.1.1.1.6.2.3.cmml">G</mi></msub><mo id="S3.E10.m1.1.1.1.1.6.1" xref="S3.E10.m1.1.1.1.1.6.1.cmml">+</mo><mrow id="S3.E10.m1.1.1.1.1.6.3" xref="S3.E10.m1.1.1.1.1.6.3.cmml"><msub id="S3.E10.m1.1.1.1.1.6.3.2" xref="S3.E10.m1.1.1.1.1.6.3.2.cmml"><mi id="S3.E10.m1.1.1.1.1.6.3.2.2" xref="S3.E10.m1.1.1.1.1.6.3.2.2.cmml">U</mi><mi id="S3.E10.m1.1.1.1.1.6.3.2.3" xref="S3.E10.m1.1.1.1.1.6.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.6.3.1" xref="S3.E10.m1.1.1.1.1.6.3.1.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.6.3.3" xref="S3.E10.m1.1.1.1.1.6.3.3.cmml"><mi id="S3.E10.m1.1.1.1.1.6.3.3.2" xref="S3.E10.m1.1.1.1.1.6.3.3.2.cmml">V</mi><mi id="S3.E10.m1.1.1.1.1.6.3.3.3" xref="S3.E10.m1.1.1.1.1.6.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><and id="S3.E10.m1.1.1.1.1a.cmml" xref="S3.E10.m1.1.1.1"></and><apply id="S3.E10.m1.1.1.1.1b.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"></eq><apply id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.4"><plus id="S3.E10.m1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.1.1.1.1.4.1"></plus><apply id="S3.E10.m1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.2.1.cmml" xref="S3.E10.m1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.4.2.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.4.2.3.cmml" xref="S3.E10.m1.1.1.1.1.4.2.3">𝐺</ci></apply><apply id="S3.E10.m1.1.1.1.1.4.3.cmml" xref="S3.E10.m1.1.1.1.1.4.3"><times id="S3.E10.m1.1.1.1.1.4.3.1.cmml" xref="S3.E10.m1.1.1.1.1.4.3.1"></times><ci id="S3.E10.m1.1.1.1.1.4.3.2.cmml" xref="S3.E10.m1.1.1.1.1.4.3.2">Δ</ci><apply id="S3.E10.m1.1.1.1.1.4.3.3.cmml" xref="S3.E10.m1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.4.3.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.4.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.4.3.3.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.4.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.4.3.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1c.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.5.cmml" xref="S3.E10.m1.1.1.1.1.5"></eq><share href="#S3.E10.m1.1.1.1.1.4.cmml" id="S3.E10.m1.1.1.1.1d.cmml" xref="S3.E10.m1.1.1.1"></share><apply id="S3.E10.m1.1.1.1.1.6.cmml" xref="S3.E10.m1.1.1.1.1.6"><plus id="S3.E10.m1.1.1.1.1.6.1.cmml" xref="S3.E10.m1.1.1.1.1.6.1"></plus><apply id="S3.E10.m1.1.1.1.1.6.2.cmml" xref="S3.E10.m1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.6.2.1.cmml" xref="S3.E10.m1.1.1.1.1.6.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.6.2.2.cmml" xref="S3.E10.m1.1.1.1.1.6.2.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.6.2.3.cmml" xref="S3.E10.m1.1.1.1.1.6.2.3">𝐺</ci></apply><apply id="S3.E10.m1.1.1.1.1.6.3.cmml" xref="S3.E10.m1.1.1.1.1.6.3"><times id="S3.E10.m1.1.1.1.1.6.3.1.cmml" xref="S3.E10.m1.1.1.1.1.6.3.1"></times><apply id="S3.E10.m1.1.1.1.1.6.3.2.cmml" xref="S3.E10.m1.1.1.1.1.6.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.6.3.2.1.cmml" xref="S3.E10.m1.1.1.1.1.6.3.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.6.3.2.2.cmml" xref="S3.E10.m1.1.1.1.1.6.3.2.2">𝑈</ci><ci id="S3.E10.m1.1.1.1.1.6.3.2.3.cmml" xref="S3.E10.m1.1.1.1.1.6.3.2.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.6.3.3.cmml" xref="S3.E10.m1.1.1.1.1.6.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.6.3.3.1.cmml" xref="S3.E10.m1.1.1.1.1.6.3.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.6.3.3.2.cmml" xref="S3.E10.m1.1.1.1.1.6.3.3.2">𝑉</ci><ci id="S3.E10.m1.1.1.1.1.6.3.3.3.cmml" xref="S3.E10.m1.1.1.1.1.6.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">p_{i}=p_{G}+\Delta p_{i}=p_{G}+U_{i}V_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.8" class="ltx_p">where <math id="S3.SS4.p1.6.m1.1" class="ltx_Math" alttext="p_{G}\in\mathbb{R}^{d\times k}" display="inline"><semantics id="S3.SS4.p1.6.m1.1a"><mrow id="S3.SS4.p1.6.m1.1.1" xref="S3.SS4.p1.6.m1.1.1.cmml"><msub id="S3.SS4.p1.6.m1.1.1.2" xref="S3.SS4.p1.6.m1.1.1.2.cmml"><mi id="S3.SS4.p1.6.m1.1.1.2.2" xref="S3.SS4.p1.6.m1.1.1.2.2.cmml">p</mi><mi id="S3.SS4.p1.6.m1.1.1.2.3" xref="S3.SS4.p1.6.m1.1.1.2.3.cmml">G</mi></msub><mo id="S3.SS4.p1.6.m1.1.1.1" xref="S3.SS4.p1.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p1.6.m1.1.1.3" xref="S3.SS4.p1.6.m1.1.1.3.cmml"><mi id="S3.SS4.p1.6.m1.1.1.3.2" xref="S3.SS4.p1.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS4.p1.6.m1.1.1.3.3" xref="S3.SS4.p1.6.m1.1.1.3.3.cmml"><mi id="S3.SS4.p1.6.m1.1.1.3.3.2" xref="S3.SS4.p1.6.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS4.p1.6.m1.1.1.3.3.1" xref="S3.SS4.p1.6.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS4.p1.6.m1.1.1.3.3.3" xref="S3.SS4.p1.6.m1.1.1.3.3.3.cmml">k</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m1.1b"><apply id="S3.SS4.p1.6.m1.1.1.cmml" xref="S3.SS4.p1.6.m1.1.1"><in id="S3.SS4.p1.6.m1.1.1.1.cmml" xref="S3.SS4.p1.6.m1.1.1.1"></in><apply id="S3.SS4.p1.6.m1.1.1.2.cmml" xref="S3.SS4.p1.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m1.1.1.2.1.cmml" xref="S3.SS4.p1.6.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.p1.6.m1.1.1.2.2.cmml" xref="S3.SS4.p1.6.m1.1.1.2.2">𝑝</ci><ci id="S3.SS4.p1.6.m1.1.1.2.3.cmml" xref="S3.SS4.p1.6.m1.1.1.2.3">𝐺</ci></apply><apply id="S3.SS4.p1.6.m1.1.1.3.cmml" xref="S3.SS4.p1.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m1.1.1.3.1.cmml" xref="S3.SS4.p1.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p1.6.m1.1.1.3.2.cmml" xref="S3.SS4.p1.6.m1.1.1.3.2">ℝ</ci><apply id="S3.SS4.p1.6.m1.1.1.3.3.cmml" xref="S3.SS4.p1.6.m1.1.1.3.3"><times id="S3.SS4.p1.6.m1.1.1.3.3.1.cmml" xref="S3.SS4.p1.6.m1.1.1.3.3.1"></times><ci id="S3.SS4.p1.6.m1.1.1.3.3.2.cmml" xref="S3.SS4.p1.6.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS4.p1.6.m1.1.1.3.3.3.cmml" xref="S3.SS4.p1.6.m1.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m1.1c">p_{G}\in\mathbb{R}^{d\times k}</annotation></semantics></math> is the full-rank matrix and <math id="S3.SS4.p1.7.m2.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="S3.SS4.p1.7.m2.1a"><mrow id="S3.SS4.p1.7.m2.1.1" xref="S3.SS4.p1.7.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p1.7.m2.1.1.2" xref="S3.SS4.p1.7.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m2.1.1.1" xref="S3.SS4.p1.7.m2.1.1.1.cmml">​</mo><msub id="S3.SS4.p1.7.m2.1.1.3" xref="S3.SS4.p1.7.m2.1.1.3.cmml"><mi id="S3.SS4.p1.7.m2.1.1.3.2" xref="S3.SS4.p1.7.m2.1.1.3.2.cmml">p</mi><mi id="S3.SS4.p1.7.m2.1.1.3.3" xref="S3.SS4.p1.7.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m2.1b"><apply id="S3.SS4.p1.7.m2.1.1.cmml" xref="S3.SS4.p1.7.m2.1.1"><times id="S3.SS4.p1.7.m2.1.1.1.cmml" xref="S3.SS4.p1.7.m2.1.1.1"></times><ci id="S3.SS4.p1.7.m2.1.1.2.cmml" xref="S3.SS4.p1.7.m2.1.1.2">Δ</ci><apply id="S3.SS4.p1.7.m2.1.1.3.cmml" xref="S3.SS4.p1.7.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m2.1.1.3.1.cmml" xref="S3.SS4.p1.7.m2.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.7.m2.1.1.3.2.cmml" xref="S3.SS4.p1.7.m2.1.1.3.2">𝑝</ci><ci id="S3.SS4.p1.7.m2.1.1.3.3.cmml" xref="S3.SS4.p1.7.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m2.1c">\Delta p_{i}</annotation></semantics></math> is the low-rank component of personalized <math id="S3.SS4.p1.8.m3.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.SS4.p1.8.m3.1a"><msub id="S3.SS4.p1.8.m3.1.1" xref="S3.SS4.p1.8.m3.1.1.cmml"><mi id="S3.SS4.p1.8.m3.1.1.2" xref="S3.SS4.p1.8.m3.1.1.2.cmml">p</mi><mi id="S3.SS4.p1.8.m3.1.1.3" xref="S3.SS4.p1.8.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m3.1b"><apply id="S3.SS4.p1.8.m3.1.1.cmml" xref="S3.SS4.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m3.1.1.1.cmml" xref="S3.SS4.p1.8.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m3.1.1.2.cmml" xref="S3.SS4.p1.8.m3.1.1.2">𝑝</ci><ci id="S3.SS4.p1.8.m3.1.1.3.cmml" xref="S3.SS4.p1.8.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m3.1c">p_{i}</annotation></semantics></math>. Consequently, the objective of FedPGP can be reformulated as:</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.3" class="ltx_Math" alttext="\min_{p_{G},\{U_{i},V_{i}\}_{i=1}^{N}}\sum_{i=1}^{N}\frac{n_{i}}{\sum_{j}n_{j}}\mathcal{L}_{ce}^{D_{i}}(p_{G}+U_{i}V_{i})." display="block"><semantics id="S3.E11.m1.3a"><mrow id="S3.E11.m1.3.3.1" xref="S3.E11.m1.3.3.1.1.cmml"><mrow id="S3.E11.m1.3.3.1.1" xref="S3.E11.m1.3.3.1.1.cmml"><munder id="S3.E11.m1.3.3.1.1.3" xref="S3.E11.m1.3.3.1.1.3.cmml"><mi id="S3.E11.m1.3.3.1.1.3.2" xref="S3.E11.m1.3.3.1.1.3.2.cmml">min</mi><mrow id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.3.cmml"><msub id="S3.E11.m1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E11.m1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.3.cmml">G</mi></msub><mo id="S3.E11.m1.2.2.2.2.3" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.E11.m1.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.cmml"><mrow id="S3.E11.m1.2.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E11.m1.2.2.2.2.2.2.2.2.3" xref="S3.E11.m1.2.2.2.2.2.2.2.3.cmml">{</mo><msub id="S3.E11.m1.2.2.2.2.2.1.1.1.1" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.2.2.2.1.1.1.1.2" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1.2.cmml">U</mi><mi id="S3.E11.m1.2.2.2.2.2.1.1.1.1.3" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E11.m1.2.2.2.2.2.2.2.2.4" xref="S3.E11.m1.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E11.m1.2.2.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E11.m1.2.2.2.2.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2.2.cmml">V</mi><mi id="S3.E11.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E11.m1.2.2.2.2.2.2.2.2.5" xref="S3.E11.m1.2.2.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.E11.m1.2.2.2.2.2.2.4" xref="S3.E11.m1.2.2.2.2.2.2.4.cmml"><mi id="S3.E11.m1.2.2.2.2.2.2.4.2" xref="S3.E11.m1.2.2.2.2.2.2.4.2.cmml">i</mi><mo id="S3.E11.m1.2.2.2.2.2.2.4.1" xref="S3.E11.m1.2.2.2.2.2.2.4.1.cmml">=</mo><mn id="S3.E11.m1.2.2.2.2.2.2.4.3" xref="S3.E11.m1.2.2.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="S3.E11.m1.2.2.2.2.2.4" xref="S3.E11.m1.2.2.2.2.2.4.cmml">N</mi></msubsup></mrow></munder><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.2" xref="S3.E11.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E11.m1.3.3.1.1.1" xref="S3.E11.m1.3.3.1.1.1.cmml"><munderover id="S3.E11.m1.3.3.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E11.m1.3.3.1.1.1.2.2.2" xref="S3.E11.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E11.m1.3.3.1.1.1.2.2.3" xref="S3.E11.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E11.m1.3.3.1.1.1.2.2.3.2" xref="S3.E11.m1.3.3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E11.m1.3.3.1.1.1.2.2.3.1" xref="S3.E11.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E11.m1.3.3.1.1.1.2.2.3.3" xref="S3.E11.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E11.m1.3.3.1.1.1.2.3" xref="S3.E11.m1.3.3.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E11.m1.3.3.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.cmml"><mfrac id="S3.E11.m1.3.3.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.3.cmml"><msub id="S3.E11.m1.3.3.1.1.1.1.3.2" xref="S3.E11.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.3.2.2" xref="S3.E11.m1.3.3.1.1.1.1.3.2.2.cmml">n</mi><mi id="S3.E11.m1.3.3.1.1.1.1.3.2.3" xref="S3.E11.m1.3.3.1.1.1.1.3.2.3.cmml">i</mi></msub><mrow id="S3.E11.m1.3.3.1.1.1.1.3.3" xref="S3.E11.m1.3.3.1.1.1.1.3.3.cmml"><msub id="S3.E11.m1.3.3.1.1.1.1.3.3.1" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1.cmml"><mo id="S3.E11.m1.3.3.1.1.1.1.3.3.1.2" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.E11.m1.3.3.1.1.1.1.3.3.1.3" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1.3.cmml">j</mi></msub><msub id="S3.E11.m1.3.3.1.1.1.1.3.3.2" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.3.3.2.2" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2.2.cmml">n</mi><mi id="S3.E11.m1.3.3.1.1.1.1.3.3.2.3" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.2.cmml">​</mo><msubsup id="S3.E11.m1.3.3.1.1.1.1.4" xref="S3.E11.m1.3.3.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.3.3.1.1.1.1.4.2.2" xref="S3.E11.m1.3.3.1.1.1.1.4.2.2.cmml">ℒ</mi><mrow id="S3.E11.m1.3.3.1.1.1.1.4.2.3" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.4.2.3.2" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.1.1.4.2.3.1" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E11.m1.3.3.1.1.1.1.4.2.3.3" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.3.cmml">e</mi></mrow><msub id="S3.E11.m1.3.3.1.1.1.1.4.3" xref="S3.E11.m1.3.3.1.1.1.1.4.3.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.4.3.2" xref="S3.E11.m1.3.3.1.1.1.1.4.3.2.cmml">D</mi><mi id="S3.E11.m1.3.3.1.1.1.1.4.3.3" xref="S3.E11.m1.3.3.1.1.1.1.4.3.3.cmml">i</mi></msub></msubsup><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.1.1.2a" xref="S3.E11.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.3.3.1.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">G</mi></msub><mo id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.cmml"><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml">U</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.2" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml">V</mi><mi id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E11.m1.3.3.1.1.1.1.1.1.3" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E11.m1.3.3.1.2" xref="S3.E11.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.3b"><apply id="S3.E11.m1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1"><times id="S3.E11.m1.3.3.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.2"></times><apply id="S3.E11.m1.3.3.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.3.1.cmml" xref="S3.E11.m1.3.3.1.1.3">subscript</csymbol><min id="S3.E11.m1.3.3.1.1.3.2.cmml" xref="S3.E11.m1.3.3.1.1.3.2"></min><list id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2"><apply id="S3.E11.m1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E11.m1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S3.E11.m1.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E11.m1.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2">subscript</csymbol><set id="S3.E11.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2"><apply id="S3.E11.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1.2">𝑈</ci><ci id="S3.E11.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E11.m1.2.2.2.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E11.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2.2">𝑉</ci><ci id="S3.E11.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.E11.m1.2.2.2.2.2.2.4.cmml" xref="S3.E11.m1.2.2.2.2.2.2.4"><eq id="S3.E11.m1.2.2.2.2.2.2.4.1.cmml" xref="S3.E11.m1.2.2.2.2.2.2.4.1"></eq><ci id="S3.E11.m1.2.2.2.2.2.2.4.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2.4.2">𝑖</ci><cn type="integer" id="S3.E11.m1.2.2.2.2.2.2.4.3.cmml" xref="S3.E11.m1.2.2.2.2.2.2.4.3">1</cn></apply></apply><ci id="S3.E11.m1.2.2.2.2.2.4.cmml" xref="S3.E11.m1.2.2.2.2.2.4">𝑁</ci></apply></list></apply><apply id="S3.E11.m1.3.3.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1"><apply id="S3.E11.m1.3.3.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E11.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E11.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.2.2.3"><eq id="S3.E11.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E11.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E11.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E11.m1.3.3.1.1.1.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1"><times id="S3.E11.m1.3.3.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.2"></times><apply id="S3.E11.m1.3.3.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3"><divide id="S3.E11.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3"></divide><apply id="S3.E11.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2.2">𝑛</ci><ci id="S3.E11.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3"><apply id="S3.E11.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.3.3.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E11.m1.3.3.1.1.1.1.3.3.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1.2"></sum><ci id="S3.E11.m1.3.3.1.1.1.1.3.3.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.1.3">𝑗</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.3.3.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.3.3.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2.2">𝑛</ci><ci id="S3.E11.m1.3.3.1.1.1.1.3.3.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E11.m1.3.3.1.1.1.1.4.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4">superscript</csymbol><apply id="S3.E11.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.4.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.4.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.2.2">ℒ</ci><apply id="S3.E11.m1.3.3.1.1.1.1.4.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3"><times id="S3.E11.m1.3.3.1.1.1.1.4.2.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.1"></times><ci id="S3.E11.m1.3.3.1.1.1.1.4.2.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.2">𝑐</ci><ci id="S3.E11.m1.3.3.1.1.1.1.4.2.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.2.3.3">𝑒</ci></apply></apply><apply id="S3.E11.m1.3.3.1.1.1.1.4.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.4.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.4.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.3.2">𝐷</ci><ci id="S3.E11.m1.3.3.1.1.1.1.4.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.4.3.3">𝑖</ci></apply></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1"><plus id="S3.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.1"></plus><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.2.3">𝐺</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3"><times id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.2">𝑈</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.2">𝑉</ci><ci id="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.3.3.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.3c">\min_{p_{G},\{U_{i},V_{i}\}_{i=1}^{N}}\sum_{i=1}^{N}\frac{n_{i}}{\sum_{j}n_{j}}\mathcal{L}_{ce}^{D_{i}}(p_{G}+U_{i}V_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.10" class="ltx_p">Employing the low-rank adaptation, FedPGP introduces personalization while preserving generalizability, striking a balance between the model’s ability to generalize and personalize.
Moreover, our objective is to go beyond the consensus knowledge communicated by clients through the global prompt and instead offer them personalized knowledge. To enable personalized prompts better access to client-specific knowledge, we aim to increase dissimilarity between representations of global and personalized prompts for better personalization.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.8" class="ltx_p">Summarizing the target we mentioned, our objective is 1) to bring close the representations of the handcrafted prompt <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="g(p_{C})" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.1.m1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.1.m1.1.1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS4.p2.1.m1.1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.3.cmml">C</mi></msub><mo stretchy="false" id="S3.SS4.p2.1.m1.1.1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><times id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"></times><ci id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3">𝑔</ci><apply id="S3.SS4.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS4.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">g(p_{C})</annotation></semantics></math> of CLIP and the global prompt <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="g(p_{G})" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mrow id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.2.m2.1.1.1.1.2" xref="S3.SS4.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.2.m2.1.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.1.1.1.2" xref="S3.SS4.p2.2.m2.1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS4.p2.2.m2.1.1.1.1.1.3" xref="S3.SS4.p2.2.m2.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S3.SS4.p2.2.m2.1.1.1.1.3" xref="S3.SS4.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><times id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2"></times><ci id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">𝑔</ci><apply id="S3.SS4.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1.2">𝑝</ci><ci id="S3.SS4.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1.1.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">g(p_{G})</annotation></semantics></math>, and 2) to create a clear distinction between the representations of the global prompt <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="g(P_{G})" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.3.m3.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.3.m3.1.1.1.1.2" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.3.m3.1.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.1.1.1.2" xref="S3.SS4.p2.3.m3.1.1.1.1.1.2.cmml">P</mi><mi id="S3.SS4.p2.3.m3.1.1.1.1.1.3" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3.cmml">G</mi></msub><mo stretchy="false" id="S3.SS4.p2.3.m3.1.1.1.1.3" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><times id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2"></times><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝑔</ci><apply id="S3.SS4.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS4.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3">𝐺</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">g(P_{G})</annotation></semantics></math> and personalized prompt <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="g(P_{i})" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><mrow id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.4.m4.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.4.m4.1.1.1.1.2" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.4.m4.1.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.2" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml">P</mi><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.3" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS4.p2.4.m4.1.1.1.1.3" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><times id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2"></times><ci id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3">𝑔</ci><apply id="S3.SS4.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2">𝑃</ci><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">g(P_{i})</annotation></semantics></math>. Building upon the above analysis,
We consider the global prompt representations <math id="S3.SS4.p2.5.m5.1" class="ltx_Math" alttext="z_{G}" display="inline"><semantics id="S3.SS4.p2.5.m5.1a"><msub id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml">z</mi><mi id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2">𝑧</ci><ci id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">z_{G}</annotation></semantics></math> with handcrafted prompt representation <math id="S3.SS4.p2.6.m6.1" class="ltx_Math" alttext="z_{C}" display="inline"><semantics id="S3.SS4.p2.6.m6.1a"><msub id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml"><mi id="S3.SS4.p2.6.m6.1.1.2" xref="S3.SS4.p2.6.m6.1.1.2.cmml">z</mi><mi id="S3.SS4.p2.6.m6.1.1.3" xref="S3.SS4.p2.6.m6.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><apply id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2">𝑧</ci><ci id="S3.SS4.p2.6.m6.1.1.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">z_{C}</annotation></semantics></math> as positive pairs, while simultaneously treating them as negative pairs with personalized prompt representations <math id="S3.SS4.p2.7.m7.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS4.p2.7.m7.1a"><msub id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.2" xref="S3.SS4.p2.7.m7.1.1.2.cmml">z</mi><mi id="S3.SS4.p2.7.m7.1.1.3" xref="S3.SS4.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p2.7.m7.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.2">𝑧</ci><ci id="S3.SS4.p2.7.m7.1.1.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">z_{i}</annotation></semantics></math>.
Consequently, we design an additional contrastive loss <math id="S3.SS4.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{L}_{con}" display="inline"><semantics id="S3.SS4.p2.8.m8.1a"><msub id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.8.m8.1.1.2" xref="S3.SS4.p2.8.m8.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p2.8.m8.1.1.3" xref="S3.SS4.p2.8.m8.1.1.3.cmml"><mi id="S3.SS4.p2.8.m8.1.1.3.2" xref="S3.SS4.p2.8.m8.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.8.m8.1.1.3.1" xref="S3.SS4.p2.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.8.m8.1.1.3.3" xref="S3.SS4.p2.8.m8.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.8.m8.1.1.3.1a" xref="S3.SS4.p2.8.m8.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.8.m8.1.1.3.4" xref="S3.SS4.p2.8.m8.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><apply id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m8.1.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS4.p2.8.m8.1.1.2.cmml" xref="S3.SS4.p2.8.m8.1.1.2">ℒ</ci><apply id="S3.SS4.p2.8.m8.1.1.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3"><times id="S3.SS4.p2.8.m8.1.1.3.1.cmml" xref="S3.SS4.p2.8.m8.1.1.3.1"></times><ci id="S3.SS4.p2.8.m8.1.1.3.2.cmml" xref="S3.SS4.p2.8.m8.1.1.3.2">𝑐</ci><ci id="S3.SS4.p2.8.m8.1.1.3.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3.3">𝑜</ci><ci id="S3.SS4.p2.8.m8.1.1.3.4.cmml" xref="S3.SS4.p2.8.m8.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">\mathcal{L}_{con}</annotation></semantics></math> for FedPGP to balance generalization and personalization:</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.7" class="ltx_Math" alttext="\mathcal{L}_{con}\!=\!-\!\log\frac{\exp(\text{sim}(z_{G},\!z_{C})/\tau)}{\exp(\text{sim}(z_{G},\!z_{C})\!/\!\tau)\!+\!\exp(\text{sim}(z_{G},\!z_{i})\!/\!\tau)}," display="block"><semantics id="S3.E12.m1.7a"><mrow id="S3.E12.m1.7.7.1" xref="S3.E12.m1.7.7.1.1.cmml"><mrow id="S3.E12.m1.7.7.1.1" xref="S3.E12.m1.7.7.1.1.cmml"><msub id="S3.E12.m1.7.7.1.1.2" xref="S3.E12.m1.7.7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.7.7.1.1.2.2" xref="S3.E12.m1.7.7.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E12.m1.7.7.1.1.2.3" xref="S3.E12.m1.7.7.1.1.2.3.cmml"><mi id="S3.E12.m1.7.7.1.1.2.3.2" xref="S3.E12.m1.7.7.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.7.1.1.2.3.1" xref="S3.E12.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E12.m1.7.7.1.1.2.3.3" xref="S3.E12.m1.7.7.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.7.7.1.1.2.3.1a" xref="S3.E12.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E12.m1.7.7.1.1.2.3.4" xref="S3.E12.m1.7.7.1.1.2.3.4.cmml">n</mi></mrow></msub><mo lspace="0.108em" rspace="0.108em" id="S3.E12.m1.7.7.1.1.1" xref="S3.E12.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E12.m1.7.7.1.1.3" xref="S3.E12.m1.7.7.1.1.3.cmml"><mo rspace="0.167em" id="S3.E12.m1.7.7.1.1.3a" xref="S3.E12.m1.7.7.1.1.3.cmml">−</mo><mrow id="S3.E12.m1.7.7.1.1.3.2" xref="S3.E12.m1.7.7.1.1.3.2.cmml"><mi id="S3.E12.m1.7.7.1.1.3.2.1" xref="S3.E12.m1.7.7.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.E12.m1.7.7.1.1.3.2a" xref="S3.E12.m1.7.7.1.1.3.2.cmml">⁡</mo><mfrac id="S3.E12.m1.6.6" xref="S3.E12.m1.6.6.cmml"><mrow id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E12.m1.2.2.2.2a" xref="S3.E12.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E12.m1.2.2.2.2.1" xref="S3.E12.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E12.m1.2.2.2.2.1.2" xref="S3.E12.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E12.m1.2.2.2.2.1.1" xref="S3.E12.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E12.m1.2.2.2.2.1.1.2" xref="S3.E12.m1.2.2.2.2.1.1.2.cmml"><mtext id="S3.E12.m1.2.2.2.2.1.1.2.4" xref="S3.E12.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.2.2.1.1.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E12.m1.2.2.2.2.1.1.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E12.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">G</mi></msub><mpadded width="0.275em"><mo id="S3.E12.m1.2.2.2.2.1.1.2.2.2.4" xref="S3.E12.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo></mpadded><msub id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">C</mi></msub><mo stretchy="false" id="S3.E12.m1.2.2.2.2.1.1.2.2.2.5" xref="S3.E12.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.2.2.2.2.1.1.3" xref="S3.E12.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S3.E12.m1.2.2.2.2.1.1.4" xref="S3.E12.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E12.m1.2.2.2.2.1.3" xref="S3.E12.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E12.m1.6.6.6" xref="S3.E12.m1.6.6.6.cmml"><mrow id="S3.E12.m1.5.5.5.3.1" xref="S3.E12.m1.5.5.5.3.2.cmml"><mi id="S3.E12.m1.3.3.3.1" xref="S3.E12.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E12.m1.5.5.5.3.1a" xref="S3.E12.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S3.E12.m1.5.5.5.3.1.1" xref="S3.E12.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S3.E12.m1.5.5.5.3.1.1.2" xref="S3.E12.m1.5.5.5.3.2.cmml">(</mo><mrow id="S3.E12.m1.5.5.5.3.1.1.1" xref="S3.E12.m1.5.5.5.3.1.1.1.cmml"><mrow id="S3.E12.m1.5.5.5.3.1.1.1.2" xref="S3.E12.m1.5.5.5.3.1.1.1.2.cmml"><mtext id="S3.E12.m1.5.5.5.3.1.1.1.2.4" xref="S3.E12.m1.5.5.5.3.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.5.5.5.3.1.1.1.2.3" xref="S3.E12.m1.5.5.5.3.1.1.1.2.3.cmml">​</mo><mrow id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.3" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.2" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.3" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mpadded width="0.275em"><mo id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.4" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.3.cmml">,</mo></mpadded><msub id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.cmml"><mi id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.2" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.3" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.3.cmml">C</mi></msub><mo stretchy="false" id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.5" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo lspace="0.052em" rspace="0.052em" id="S3.E12.m1.5.5.5.3.1.1.1.3" xref="S3.E12.m1.5.5.5.3.1.1.1.3.cmml">/</mo><mi id="S3.E12.m1.5.5.5.3.1.1.1.4" xref="S3.E12.m1.5.5.5.3.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E12.m1.5.5.5.3.1.1.3" xref="S3.E12.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow><mo lspace="0.052em" rspace="0.052em" id="S3.E12.m1.6.6.6.5" xref="S3.E12.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E12.m1.6.6.6.4.1" xref="S3.E12.m1.6.6.6.4.2.cmml"><mi id="S3.E12.m1.4.4.4.2" xref="S3.E12.m1.4.4.4.2.cmml">exp</mi><mo id="S3.E12.m1.6.6.6.4.1a" xref="S3.E12.m1.6.6.6.4.2.cmml">⁡</mo><mrow id="S3.E12.m1.6.6.6.4.1.1" xref="S3.E12.m1.6.6.6.4.2.cmml"><mo stretchy="false" id="S3.E12.m1.6.6.6.4.1.1.2" xref="S3.E12.m1.6.6.6.4.2.cmml">(</mo><mrow id="S3.E12.m1.6.6.6.4.1.1.1" xref="S3.E12.m1.6.6.6.4.1.1.1.cmml"><mrow id="S3.E12.m1.6.6.6.4.1.1.1.2" xref="S3.E12.m1.6.6.6.4.1.1.1.2.cmml"><mtext id="S3.E12.m1.6.6.6.4.1.1.1.2.4" xref="S3.E12.m1.6.6.6.4.1.1.1.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.6.6.6.4.1.1.1.2.3" xref="S3.E12.m1.6.6.6.4.1.1.1.2.3.cmml">​</mo><mrow id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.3" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.2" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.3" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mpadded width="0.275em"><mo id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.4" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.3.cmml">,</mo></mpadded><msub id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.cmml"><mi id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.2" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.2.cmml">z</mi><mi id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.3" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.5" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo lspace="0.052em" rspace="0.052em" id="S3.E12.m1.6.6.6.4.1.1.1.3" xref="S3.E12.m1.6.6.6.4.1.1.1.3.cmml">/</mo><mi id="S3.E12.m1.6.6.6.4.1.1.1.4" xref="S3.E12.m1.6.6.6.4.1.1.1.4.cmml">τ</mi></mrow><mo stretchy="false" id="S3.E12.m1.6.6.6.4.1.1.3" xref="S3.E12.m1.6.6.6.4.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E12.m1.7.7.1.2" xref="S3.E12.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.7b"><apply id="S3.E12.m1.7.7.1.1.cmml" xref="S3.E12.m1.7.7.1"><eq id="S3.E12.m1.7.7.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1"></eq><apply id="S3.E12.m1.7.7.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.2.1.cmml" xref="S3.E12.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E12.m1.7.7.1.1.2.2.cmml" xref="S3.E12.m1.7.7.1.1.2.2">ℒ</ci><apply id="S3.E12.m1.7.7.1.1.2.3.cmml" xref="S3.E12.m1.7.7.1.1.2.3"><times id="S3.E12.m1.7.7.1.1.2.3.1.cmml" xref="S3.E12.m1.7.7.1.1.2.3.1"></times><ci id="S3.E12.m1.7.7.1.1.2.3.2.cmml" xref="S3.E12.m1.7.7.1.1.2.3.2">𝑐</ci><ci id="S3.E12.m1.7.7.1.1.2.3.3.cmml" xref="S3.E12.m1.7.7.1.1.2.3.3">𝑜</ci><ci id="S3.E12.m1.7.7.1.1.2.3.4.cmml" xref="S3.E12.m1.7.7.1.1.2.3.4">𝑛</ci></apply></apply><apply id="S3.E12.m1.7.7.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.3"><minus id="S3.E12.m1.7.7.1.1.3.1.cmml" xref="S3.E12.m1.7.7.1.1.3"></minus><apply id="S3.E12.m1.7.7.1.1.3.2.cmml" xref="S3.E12.m1.7.7.1.1.3.2"><log id="S3.E12.m1.7.7.1.1.3.2.1.cmml" xref="S3.E12.m1.7.7.1.1.3.2.1"></log><apply id="S3.E12.m1.6.6.cmml" xref="S3.E12.m1.6.6"><divide id="S3.E12.m1.6.6.7.cmml" xref="S3.E12.m1.6.6"></divide><apply id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2"><exp id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1"></exp><apply id="S3.E12.m1.2.2.2.2.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1"><divide id="S3.E12.m1.2.2.2.2.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.3"></divide><apply id="S3.E12.m1.2.2.2.2.1.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2"><times id="S3.E12.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.3"></times><ci id="S3.E12.m1.2.2.2.2.1.1.2.4a.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.4"><mtext id="S3.E12.m1.2.2.2.2.1.1.2.4.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E12.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2"><apply id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2.1.1.2.2.2.2.3">𝐶</ci></apply></interval></apply><ci id="S3.E12.m1.2.2.2.2.1.1.4.cmml" xref="S3.E12.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S3.E12.m1.6.6.6.cmml" xref="S3.E12.m1.6.6.6"><plus id="S3.E12.m1.6.6.6.5.cmml" xref="S3.E12.m1.6.6.6.5"></plus><apply id="S3.E12.m1.5.5.5.3.2.cmml" xref="S3.E12.m1.5.5.5.3.1"><exp id="S3.E12.m1.3.3.3.1.cmml" xref="S3.E12.m1.3.3.3.1"></exp><apply id="S3.E12.m1.5.5.5.3.1.1.1.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1"><divide id="S3.E12.m1.5.5.5.3.1.1.1.3.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.3"></divide><apply id="S3.E12.m1.5.5.5.3.1.1.1.2.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2"><times id="S3.E12.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.3"></times><ci id="S3.E12.m1.5.5.5.3.1.1.1.2.4a.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.4"><mtext id="S3.E12.m1.5.5.5.3.1.1.1.2.4.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E12.m1.5.5.5.3.1.1.1.2.2.3.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2"><apply id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.3.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.2.2.2.2.3">𝐶</ci></apply></interval></apply><ci id="S3.E12.m1.5.5.5.3.1.1.1.4.cmml" xref="S3.E12.m1.5.5.5.3.1.1.1.4">𝜏</ci></apply></apply><apply id="S3.E12.m1.6.6.6.4.2.cmml" xref="S3.E12.m1.6.6.6.4.1"><exp id="S3.E12.m1.4.4.4.2.cmml" xref="S3.E12.m1.4.4.4.2"></exp><apply id="S3.E12.m1.6.6.6.4.1.1.1.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1"><divide id="S3.E12.m1.6.6.6.4.1.1.1.3.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.3"></divide><apply id="S3.E12.m1.6.6.6.4.1.1.1.2.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2"><times id="S3.E12.m1.6.6.6.4.1.1.1.2.3.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.3"></times><ci id="S3.E12.m1.6.6.6.4.1.1.1.2.4a.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.4"><mtext id="S3.E12.m1.6.6.6.4.1.1.1.2.4.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S3.E12.m1.6.6.6.4.1.1.1.2.2.3.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2"><apply id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.1.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.2.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.2">𝑧</ci><ci id="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.3.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S3.E12.m1.6.6.6.4.1.1.1.4.cmml" xref="S3.E12.m1.6.6.6.4.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.7c">\mathcal{L}_{con}\!=\!-\!\log\frac{\exp(\text{sim}(z_{G},\!z_{C})/\tau)}{\exp(\text{sim}(z_{G},\!z_{C})\!/\!\tau)\!+\!\exp(\text{sim}(z_{G},\!z_{i})\!/\!\tau)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.10" class="ltx_p">where <math id="S3.SS4.p2.9.m1.2" class="ltx_Math" alttext="\text{sim}(\cdot,\cdot)" display="inline"><semantics id="S3.SS4.p2.9.m1.2a"><mrow id="S3.SS4.p2.9.m1.2.3" xref="S3.SS4.p2.9.m1.2.3.cmml"><mtext id="S3.SS4.p2.9.m1.2.3.2" xref="S3.SS4.p2.9.m1.2.3.2a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="S3.SS4.p2.9.m1.2.3.1" xref="S3.SS4.p2.9.m1.2.3.1.cmml">​</mo><mrow id="S3.SS4.p2.9.m1.2.3.3.2" xref="S3.SS4.p2.9.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.9.m1.2.3.3.2.1" xref="S3.SS4.p2.9.m1.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p2.9.m1.1.1" xref="S3.SS4.p2.9.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS4.p2.9.m1.2.3.3.2.2" xref="S3.SS4.p2.9.m1.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p2.9.m1.2.2" xref="S3.SS4.p2.9.m1.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS4.p2.9.m1.2.3.3.2.3" xref="S3.SS4.p2.9.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m1.2b"><apply id="S3.SS4.p2.9.m1.2.3.cmml" xref="S3.SS4.p2.9.m1.2.3"><times id="S3.SS4.p2.9.m1.2.3.1.cmml" xref="S3.SS4.p2.9.m1.2.3.1"></times><ci id="S3.SS4.p2.9.m1.2.3.2a.cmml" xref="S3.SS4.p2.9.m1.2.3.2"><mtext id="S3.SS4.p2.9.m1.2.3.2.cmml" xref="S3.SS4.p2.9.m1.2.3.2">sim</mtext></ci><interval closure="open" id="S3.SS4.p2.9.m1.2.3.3.1.cmml" xref="S3.SS4.p2.9.m1.2.3.3.2"><ci id="S3.SS4.p2.9.m1.1.1.cmml" xref="S3.SS4.p2.9.m1.1.1">⋅</ci><ci id="S3.SS4.p2.9.m1.2.2.cmml" xref="S3.SS4.p2.9.m1.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m1.2c">\text{sim}(\cdot,\cdot)</annotation></semantics></math> denotes a metric function (e.g., cosine similarity).
The contrastive loss can guide the global prompt to gain complementary knowledge from pre-trained CLIP representation and enable <math id="S3.SS4.p2.10.m2.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="S3.SS4.p2.10.m2.1a"><mrow id="S3.SS4.p2.10.m2.1.1" xref="S3.SS4.p2.10.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p2.10.m2.1.1.2" xref="S3.SS4.p2.10.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.10.m2.1.1.1" xref="S3.SS4.p2.10.m2.1.1.1.cmml">​</mo><msub id="S3.SS4.p2.10.m2.1.1.3" xref="S3.SS4.p2.10.m2.1.1.3.cmml"><mi id="S3.SS4.p2.10.m2.1.1.3.2" xref="S3.SS4.p2.10.m2.1.1.3.2.cmml">p</mi><mi id="S3.SS4.p2.10.m2.1.1.3.3" xref="S3.SS4.p2.10.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.10.m2.1b"><apply id="S3.SS4.p2.10.m2.1.1.cmml" xref="S3.SS4.p2.10.m2.1.1"><times id="S3.SS4.p2.10.m2.1.1.1.cmml" xref="S3.SS4.p2.10.m2.1.1.1"></times><ci id="S3.SS4.p2.10.m2.1.1.2.cmml" xref="S3.SS4.p2.10.m2.1.1.2">Δ</ci><apply id="S3.SS4.p2.10.m2.1.1.3.cmml" xref="S3.SS4.p2.10.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.10.m2.1.1.3.1.cmml" xref="S3.SS4.p2.10.m2.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.10.m2.1.1.3.2.cmml" xref="S3.SS4.p2.10.m2.1.1.3.2">𝑝</ci><ci id="S3.SS4.p2.10.m2.1.1.3.3.cmml" xref="S3.SS4.p2.10.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.10.m2.1c">\Delta p_{i}</annotation></semantics></math> to learn personalized knowledge distinct from the global prompt.
Consequently, our overall training objective thus becomes:</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{ce}+\mu\mathcal{L}_{con}," display="block"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mrow id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.2.cmml">ℒ</mi><mo id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.3.cmml"><msub id="S3.E13.m1.1.1.1.1.3.2" xref="S3.E13.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.2.2" xref="S3.E13.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.2.3" xref="S3.E13.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.2.3.2" xref="S3.E13.m1.1.1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.2.3.1" xref="S3.E13.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.1.1.3.2.3.3" xref="S3.E13.m1.1.1.1.1.3.2.3.3.cmml">e</mi></mrow></msub><mo id="S3.E13.m1.1.1.1.1.3.1" xref="S3.E13.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E13.m1.1.1.1.1.3.3" xref="S3.E13.m1.1.1.1.1.3.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.1" xref="S3.E13.m1.1.1.1.1.3.3.1.cmml">​</mo><msub id="S3.E13.m1.1.1.1.1.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.1.1.1.1.3.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E13.m1.1.1.1.1.3.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E13.m1.1.1.1.1.3.3.3.3.2" xref="S3.E13.m1.1.1.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.3.3.1" xref="S3.E13.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.1.1.3.3.3.3.3" xref="S3.E13.m1.1.1.1.1.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.1.1.1.1.3.3.3.3.1a" xref="S3.E13.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E13.m1.1.1.1.1.3.3.3.3.4" xref="S3.E13.m1.1.1.1.1.3.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E13.m1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"><eq id="S3.E13.m1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"></eq><ci id="S3.E13.m1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.3"><plus id="S3.E13.m1.1.1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.1"></plus><apply id="S3.E13.m1.1.1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3"><times id="S3.E13.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.2">𝑐</ci><ci id="S3.E13.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="S3.E13.m1.1.1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3"><times id="S3.E13.m1.1.1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.2">𝜇</ci><apply id="S3.E13.m1.1.1.1.1.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S3.E13.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3"><times id="S3.E13.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.2">𝑐</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.3">𝑜</ci><ci id="S3.E13.m1.1.1.1.1.3.3.3.3.4.cmml" xref="S3.E13.m1.1.1.1.1.3.3.3.3.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\mathcal{L}=\mathcal{L}_{ce}+\mu\mathcal{L}_{con},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.16" class="ltx_p">where <math id="S3.SS4.p2.11.m1.1" class="ltx_Math" alttext="\mu\geq 0" display="inline"><semantics id="S3.SS4.p2.11.m1.1a"><mrow id="S3.SS4.p2.11.m1.1.1" xref="S3.SS4.p2.11.m1.1.1.cmml"><mi id="S3.SS4.p2.11.m1.1.1.2" xref="S3.SS4.p2.11.m1.1.1.2.cmml">μ</mi><mo id="S3.SS4.p2.11.m1.1.1.1" xref="S3.SS4.p2.11.m1.1.1.1.cmml">≥</mo><mn id="S3.SS4.p2.11.m1.1.1.3" xref="S3.SS4.p2.11.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.11.m1.1b"><apply id="S3.SS4.p2.11.m1.1.1.cmml" xref="S3.SS4.p2.11.m1.1.1"><geq id="S3.SS4.p2.11.m1.1.1.1.cmml" xref="S3.SS4.p2.11.m1.1.1.1"></geq><ci id="S3.SS4.p2.11.m1.1.1.2.cmml" xref="S3.SS4.p2.11.m1.1.1.2">𝜇</ci><cn type="integer" id="S3.SS4.p2.11.m1.1.1.3.cmml" xref="S3.SS4.p2.11.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.11.m1.1c">\mu\geq 0</annotation></semantics></math> is a hyper-parameter. We offer comprehensive algorithmic details for FedPGP in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.4 Balance FPL’s Generalization and Personalization ‣ 3 Proposed Method ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. For every communication round <math id="S3.SS4.p2.12.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS4.p2.12.m2.1a"><mi id="S3.SS4.p2.12.m2.1.1" xref="S3.SS4.p2.12.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.12.m2.1b"><ci id="S3.SS4.p2.12.m2.1.1.cmml" xref="S3.SS4.p2.12.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.12.m2.1c">t</annotation></semantics></math>, the selected clients locally train both the global prompt <math id="S3.SS4.p2.13.m3.2" class="ltx_Math" alttext="p_{G,i}" display="inline"><semantics id="S3.SS4.p2.13.m3.2a"><msub id="S3.SS4.p2.13.m3.2.3" xref="S3.SS4.p2.13.m3.2.3.cmml"><mi id="S3.SS4.p2.13.m3.2.3.2" xref="S3.SS4.p2.13.m3.2.3.2.cmml">p</mi><mrow id="S3.SS4.p2.13.m3.2.2.2.4" xref="S3.SS4.p2.13.m3.2.2.2.3.cmml"><mi id="S3.SS4.p2.13.m3.1.1.1.1" xref="S3.SS4.p2.13.m3.1.1.1.1.cmml">G</mi><mo id="S3.SS4.p2.13.m3.2.2.2.4.1" xref="S3.SS4.p2.13.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p2.13.m3.2.2.2.2" xref="S3.SS4.p2.13.m3.2.2.2.2.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.13.m3.2b"><apply id="S3.SS4.p2.13.m3.2.3.cmml" xref="S3.SS4.p2.13.m3.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m3.2.3.1.cmml" xref="S3.SS4.p2.13.m3.2.3">subscript</csymbol><ci id="S3.SS4.p2.13.m3.2.3.2.cmml" xref="S3.SS4.p2.13.m3.2.3.2">𝑝</ci><list id="S3.SS4.p2.13.m3.2.2.2.3.cmml" xref="S3.SS4.p2.13.m3.2.2.2.4"><ci id="S3.SS4.p2.13.m3.1.1.1.1.cmml" xref="S3.SS4.p2.13.m3.1.1.1.1">𝐺</ci><ci id="S3.SS4.p2.13.m3.2.2.2.2.cmml" xref="S3.SS4.p2.13.m3.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.13.m3.2c">p_{G,i}</annotation></semantics></math> and the low-rank adaptation term <math id="S3.SS4.p2.14.m4.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="S3.SS4.p2.14.m4.1a"><mrow id="S3.SS4.p2.14.m4.1.1" xref="S3.SS4.p2.14.m4.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p2.14.m4.1.1.2" xref="S3.SS4.p2.14.m4.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.14.m4.1.1.1" xref="S3.SS4.p2.14.m4.1.1.1.cmml">​</mo><msub id="S3.SS4.p2.14.m4.1.1.3" xref="S3.SS4.p2.14.m4.1.1.3.cmml"><mi id="S3.SS4.p2.14.m4.1.1.3.2" xref="S3.SS4.p2.14.m4.1.1.3.2.cmml">p</mi><mi id="S3.SS4.p2.14.m4.1.1.3.3" xref="S3.SS4.p2.14.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.14.m4.1b"><apply id="S3.SS4.p2.14.m4.1.1.cmml" xref="S3.SS4.p2.14.m4.1.1"><times id="S3.SS4.p2.14.m4.1.1.1.cmml" xref="S3.SS4.p2.14.m4.1.1.1"></times><ci id="S3.SS4.p2.14.m4.1.1.2.cmml" xref="S3.SS4.p2.14.m4.1.1.2">Δ</ci><apply id="S3.SS4.p2.14.m4.1.1.3.cmml" xref="S3.SS4.p2.14.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.14.m4.1.1.3.1.cmml" xref="S3.SS4.p2.14.m4.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.14.m4.1.1.3.2.cmml" xref="S3.SS4.p2.14.m4.1.1.3.2">𝑝</ci><ci id="S3.SS4.p2.14.m4.1.1.3.3.cmml" xref="S3.SS4.p2.14.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.14.m4.1c">\Delta p_{i}</annotation></semantics></math>. After local training, the updated global prompt <math id="S3.SS4.p2.15.m5.4" class="ltx_Math" alttext="p_{G,i}^{t,E}" display="inline"><semantics id="S3.SS4.p2.15.m5.4a"><msubsup id="S3.SS4.p2.15.m5.4.5" xref="S3.SS4.p2.15.m5.4.5.cmml"><mi id="S3.SS4.p2.15.m5.4.5.2.2" xref="S3.SS4.p2.15.m5.4.5.2.2.cmml">p</mi><mrow id="S3.SS4.p2.15.m5.2.2.2.4" xref="S3.SS4.p2.15.m5.2.2.2.3.cmml"><mi id="S3.SS4.p2.15.m5.1.1.1.1" xref="S3.SS4.p2.15.m5.1.1.1.1.cmml">G</mi><mo id="S3.SS4.p2.15.m5.2.2.2.4.1" xref="S3.SS4.p2.15.m5.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p2.15.m5.2.2.2.2" xref="S3.SS4.p2.15.m5.2.2.2.2.cmml">i</mi></mrow><mrow id="S3.SS4.p2.15.m5.4.4.2.4" xref="S3.SS4.p2.15.m5.4.4.2.3.cmml"><mi id="S3.SS4.p2.15.m5.3.3.1.1" xref="S3.SS4.p2.15.m5.3.3.1.1.cmml">t</mi><mo id="S3.SS4.p2.15.m5.4.4.2.4.1" xref="S3.SS4.p2.15.m5.4.4.2.3.cmml">,</mo><mi id="S3.SS4.p2.15.m5.4.4.2.2" xref="S3.SS4.p2.15.m5.4.4.2.2.cmml">E</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.15.m5.4b"><apply id="S3.SS4.p2.15.m5.4.5.cmml" xref="S3.SS4.p2.15.m5.4.5"><csymbol cd="ambiguous" id="S3.SS4.p2.15.m5.4.5.1.cmml" xref="S3.SS4.p2.15.m5.4.5">superscript</csymbol><apply id="S3.SS4.p2.15.m5.4.5.2.cmml" xref="S3.SS4.p2.15.m5.4.5"><csymbol cd="ambiguous" id="S3.SS4.p2.15.m5.4.5.2.1.cmml" xref="S3.SS4.p2.15.m5.4.5">subscript</csymbol><ci id="S3.SS4.p2.15.m5.4.5.2.2.cmml" xref="S3.SS4.p2.15.m5.4.5.2.2">𝑝</ci><list id="S3.SS4.p2.15.m5.2.2.2.3.cmml" xref="S3.SS4.p2.15.m5.2.2.2.4"><ci id="S3.SS4.p2.15.m5.1.1.1.1.cmml" xref="S3.SS4.p2.15.m5.1.1.1.1">𝐺</ci><ci id="S3.SS4.p2.15.m5.2.2.2.2.cmml" xref="S3.SS4.p2.15.m5.2.2.2.2">𝑖</ci></list></apply><list id="S3.SS4.p2.15.m5.4.4.2.3.cmml" xref="S3.SS4.p2.15.m5.4.4.2.4"><ci id="S3.SS4.p2.15.m5.3.3.1.1.cmml" xref="S3.SS4.p2.15.m5.3.3.1.1">𝑡</ci><ci id="S3.SS4.p2.15.m5.4.4.2.2.cmml" xref="S3.SS4.p2.15.m5.4.4.2.2">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.15.m5.4c">p_{G,i}^{t,E}</annotation></semantics></math> are sent to the server for aggregation, while the low-rank adaptation term <math id="S3.SS4.p2.16.m6.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="S3.SS4.p2.16.m6.1a"><mrow id="S3.SS4.p2.16.m6.1.1" xref="S3.SS4.p2.16.m6.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p2.16.m6.1.1.2" xref="S3.SS4.p2.16.m6.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.16.m6.1.1.1" xref="S3.SS4.p2.16.m6.1.1.1.cmml">​</mo><msub id="S3.SS4.p2.16.m6.1.1.3" xref="S3.SS4.p2.16.m6.1.1.3.cmml"><mi id="S3.SS4.p2.16.m6.1.1.3.2" xref="S3.SS4.p2.16.m6.1.1.3.2.cmml">p</mi><mi id="S3.SS4.p2.16.m6.1.1.3.3" xref="S3.SS4.p2.16.m6.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.16.m6.1b"><apply id="S3.SS4.p2.16.m6.1.1.cmml" xref="S3.SS4.p2.16.m6.1.1"><times id="S3.SS4.p2.16.m6.1.1.1.cmml" xref="S3.SS4.p2.16.m6.1.1.1"></times><ci id="S3.SS4.p2.16.m6.1.1.2.cmml" xref="S3.SS4.p2.16.m6.1.1.2">Δ</ci><apply id="S3.SS4.p2.16.m6.1.1.3.cmml" xref="S3.SS4.p2.16.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.16.m6.1.1.3.1.cmml" xref="S3.SS4.p2.16.m6.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.16.m6.1.1.3.2.cmml" xref="S3.SS4.p2.16.m6.1.1.3.2">𝑝</ci><ci id="S3.SS4.p2.16.m6.1.1.3.3.cmml" xref="S3.SS4.p2.16.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.16.m6.1c">\Delta p_{i}</annotation></semantics></math> is retained locally.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.14.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> FedPGP</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.12" class="ltx_p ltx_figure_panel"><span id="alg1.12.1" class="ltx_text ltx_font_bold">Input</span>: Communication rounds <math id="alg1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.1.m1.1a"><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">T</annotation></semantics></math>, local epochs <math id="alg1.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">R</annotation></semantics></math>, client number <math id="alg1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.3.m3.1a"><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">N</annotation></semantics></math>, local dataset <math id="alg1.4.m4.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.4.m4.1a"><msub id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mi id="alg1.4.m4.1.1.2" xref="alg1.4.m4.1.1.2.cmml">D</mi><mi id="alg1.4.m4.1.1.3" xref="alg1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">𝐷</ci><ci id="alg1.4.m4.1.1.3.cmml" xref="alg1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">D_{i}</annotation></semantics></math> , sample numbers <math id="alg1.5.m5.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="alg1.5.m5.1a"><msub id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml"><mi id="alg1.5.m5.1.1.2" xref="alg1.5.m5.1.1.2.cmml">m</mi><mi id="alg1.5.m5.1.1.3" xref="alg1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><apply id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1"><csymbol cd="ambiguous" id="alg1.5.m5.1.1.1.cmml" xref="alg1.5.m5.1.1">subscript</csymbol><ci id="alg1.5.m5.1.1.2.cmml" xref="alg1.5.m5.1.1.2">𝑚</ci><ci id="alg1.5.m5.1.1.3.cmml" xref="alg1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">m_{i}</annotation></semantics></math>, pre-trained CLIP model text encoder <math id="alg1.6.m6.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="alg1.6.m6.1a"><mrow id="alg1.6.m6.1.2" xref="alg1.6.m6.1.2.cmml"><mi id="alg1.6.m6.1.2.2" xref="alg1.6.m6.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.6.m6.1.2.1" xref="alg1.6.m6.1.2.1.cmml">​</mo><mrow id="alg1.6.m6.1.2.3.2" xref="alg1.6.m6.1.2.cmml"><mo stretchy="false" id="alg1.6.m6.1.2.3.2.1" xref="alg1.6.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.6.m6.1.1" xref="alg1.6.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.6.m6.1.2.3.2.2" xref="alg1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.m6.1b"><apply id="alg1.6.m6.1.2.cmml" xref="alg1.6.m6.1.2"><times id="alg1.6.m6.1.2.1.cmml" xref="alg1.6.m6.1.2.1"></times><ci id="alg1.6.m6.1.2.2.cmml" xref="alg1.6.m6.1.2.2">𝑔</ci><ci id="alg1.6.m6.1.1.cmml" xref="alg1.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m6.1c">g(\cdot)</annotation></semantics></math> and image encoder <math id="alg1.7.m7.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="alg1.7.m7.1a"><mrow id="alg1.7.m7.1.2" xref="alg1.7.m7.1.2.cmml"><mi id="alg1.7.m7.1.2.2" xref="alg1.7.m7.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.2.1" xref="alg1.7.m7.1.2.1.cmml">​</mo><mrow id="alg1.7.m7.1.2.3.2" xref="alg1.7.m7.1.2.cmml"><mo stretchy="false" id="alg1.7.m7.1.2.3.2.1" xref="alg1.7.m7.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.7.m7.1.1" xref="alg1.7.m7.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.7.m7.1.2.3.2.2" xref="alg1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.m7.1b"><apply id="alg1.7.m7.1.2.cmml" xref="alg1.7.m7.1.2"><times id="alg1.7.m7.1.2.1.cmml" xref="alg1.7.m7.1.2.1"></times><ci id="alg1.7.m7.1.2.2.cmml" xref="alg1.7.m7.1.2.2">𝑓</ci><ci id="alg1.7.m7.1.1.cmml" xref="alg1.7.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m7.1c">f(\cdot)</annotation></semantics></math>, class number <math id="alg1.8.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.8.m8.1a"><mi id="alg1.8.m8.1.1" xref="alg1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m8.1b"><ci id="alg1.8.m8.1.1.cmml" xref="alg1.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m8.1c">K</annotation></semantics></math>, learning rate <math id="alg1.9.m9.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.9.m9.1a"><mi id="alg1.9.m9.1.1" xref="alg1.9.m9.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.9.m9.1b"><ci id="alg1.9.m9.1.1.cmml" xref="alg1.9.m9.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m9.1c">\eta</annotation></semantics></math>, the temperature of Softmax <math id="alg1.10.m10.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.10.m10.1a"><mi id="alg1.10.m10.1.1" xref="alg1.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m10.1b"><ci id="alg1.10.m10.1.1.cmml" xref="alg1.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m10.1c">\tau</annotation></semantics></math>, hyper-parameter<math id="alg1.11.m11.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg1.11.m11.1a"><mi id="alg1.11.m11.1.1" xref="alg1.11.m11.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg1.11.m11.1b"><ci id="alg1.11.m11.1.1.cmml" xref="alg1.11.m11.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m11.1c">\mu</annotation></semantics></math>, and bottleneck number <math id="alg1.12.m12.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg1.12.m12.1a"><mi id="alg1.12.m12.1.1" xref="alg1.12.m12.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.12.m12.1b"><ci id="alg1.12.m12.1.1.cmml" xref="alg1.12.m12.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m12.1c">b</annotation></semantics></math>.












































</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.15" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize parameters <math id="alg1.l1.m1.1" class="ltx_Math" alttext="p_{i}^{0}=p_{G}^{0}+\Delta p_{i}^{0}" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><msubsup id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml"><mi id="alg1.l1.m1.1.1.2.2.2" xref="alg1.l1.m1.1.1.2.2.2.cmml">p</mi><mi id="alg1.l1.m1.1.1.2.2.3" xref="alg1.l1.m1.1.1.2.2.3.cmml">i</mi><mn id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">0</mn></msubsup><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">=</mo><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><msubsup id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml"><mi id="alg1.l1.m1.1.1.3.2.2.2" xref="alg1.l1.m1.1.1.3.2.2.2.cmml">p</mi><mi id="alg1.l1.m1.1.1.3.2.2.3" xref="alg1.l1.m1.1.1.3.2.2.3.cmml">G</mi><mn id="alg1.l1.m1.1.1.3.2.3" xref="alg1.l1.m1.1.1.3.2.3.cmml">0</mn></msubsup><mo id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="alg1.l1.m1.1.1.3.3.2" xref="alg1.l1.m1.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.3.1" xref="alg1.l1.m1.1.1.3.3.1.cmml">​</mo><msubsup id="alg1.l1.m1.1.1.3.3.3" xref="alg1.l1.m1.1.1.3.3.3.cmml"><mi id="alg1.l1.m1.1.1.3.3.3.2.2" xref="alg1.l1.m1.1.1.3.3.3.2.2.cmml">p</mi><mi id="alg1.l1.m1.1.1.3.3.3.2.3" xref="alg1.l1.m1.1.1.3.3.3.2.3.cmml">i</mi><mn id="alg1.l1.m1.1.1.3.3.3.3" xref="alg1.l1.m1.1.1.3.3.3.3.cmml">0</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><eq id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></eq><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2">superscript</csymbol><apply id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.2.1.cmml" xref="alg1.l1.m1.1.1.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.2.cmml" xref="alg1.l1.m1.1.1.2.2.2">𝑝</ci><ci id="alg1.l1.m1.1.1.2.2.3.cmml" xref="alg1.l1.m1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">0</cn></apply><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><plus id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></plus><apply id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.2.1.cmml" xref="alg1.l1.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l1.m1.1.1.3.2.2.cmml" xref="alg1.l1.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.2.2.1.cmml" xref="alg1.l1.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.3.2.2.2.cmml" xref="alg1.l1.m1.1.1.3.2.2.2">𝑝</ci><ci id="alg1.l1.m1.1.1.3.2.2.3.cmml" xref="alg1.l1.m1.1.1.3.2.2.3">𝐺</ci></apply><cn type="integer" id="alg1.l1.m1.1.1.3.2.3.cmml" xref="alg1.l1.m1.1.1.3.2.3">0</cn></apply><apply id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3"><times id="alg1.l1.m1.1.1.3.3.1.cmml" xref="alg1.l1.m1.1.1.3.3.1"></times><ci id="alg1.l1.m1.1.1.3.3.2.cmml" xref="alg1.l1.m1.1.1.3.3.2">Δ</ci><apply id="alg1.l1.m1.1.1.3.3.3.cmml" xref="alg1.l1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.3.3.1.cmml" xref="alg1.l1.m1.1.1.3.3.3">superscript</csymbol><apply id="alg1.l1.m1.1.1.3.3.3.2.cmml" xref="alg1.l1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l1.m1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l1.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l1.m1.1.1.3.3.3.2.2">𝑝</ci><ci id="alg1.l1.m1.1.1.3.3.3.2.3.cmml" xref="alg1.l1.m1.1.1.3.3.3.2.3">𝑖</ci></apply><cn type="integer" id="alg1.l1.m1.1.1.3.3.3.3.cmml" xref="alg1.l1.m1.1.1.3.3.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">p_{i}^{0}=p_{G}^{0}+\Delta p_{i}^{0}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> each communication rounds <math id="alg1.l2.m1.3" class="ltx_Math" alttext="t\in\{1,...,T\}" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.4" xref="alg1.l2.m1.3.4.cmml"><mi id="alg1.l2.m1.3.4.2" xref="alg1.l2.m1.3.4.2.cmml">t</mi><mo id="alg1.l2.m1.3.4.1" xref="alg1.l2.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l2.m1.3.4.3.2" xref="alg1.l2.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg1.l2.m1.3.4.3.2.1" xref="alg1.l2.m1.3.4.3.1.cmml">{</mo><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.3.4.3.2.2" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">…</mi><mo id="alg1.l2.m1.3.4.3.2.3" xref="alg1.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">T</mi><mo stretchy="false" id="alg1.l2.m1.3.4.3.2.4" xref="alg1.l2.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><apply id="alg1.l2.m1.3.4.cmml" xref="alg1.l2.m1.3.4"><in id="alg1.l2.m1.3.4.1.cmml" xref="alg1.l2.m1.3.4.1"></in><ci id="alg1.l2.m1.3.4.2.cmml" xref="alg1.l2.m1.3.4.2">𝑡</ci><set id="alg1.l2.m1.3.4.3.1.cmml" xref="alg1.l2.m1.3.4.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><ci id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">…</ci><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">t\in\{1,...,T\}</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Sample client <math id="alg1.l3.m1.3" class="ltx_Math" alttext="C^{t}\in\{1,...,N\}" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><msup id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml"><mi id="alg1.l3.m1.3.4.2.2" xref="alg1.l3.m1.3.4.2.2.cmml">C</mi><mi id="alg1.l3.m1.3.4.2.3" xref="alg1.l3.m1.3.4.2.3.cmml">t</mi></msup><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">{</mo><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">…</mi><mo id="alg1.l3.m1.3.4.3.2.3" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">N</mi><mo stretchy="false" id="alg1.l3.m1.3.4.3.2.4" xref="alg1.l3.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><in id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></in><apply id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l3.m1.3.4.2.1.cmml" xref="alg1.l3.m1.3.4.2">superscript</csymbol><ci id="alg1.l3.m1.3.4.2.2.cmml" xref="alg1.l3.m1.3.4.2.2">𝐶</ci><ci id="alg1.l3.m1.3.4.2.3.cmml" xref="alg1.l3.m1.3.4.2.3">𝑡</ci></apply><set id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">…</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝑁</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">C^{t}\in\{1,...,N\}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i\in C^{t}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><msup id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">C</mi><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">superscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝐶</ci><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i\in C^{t}</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Initialize <math id="alg1.l5.m1.2" class="ltx_Math" alttext="p_{G}^{t,0}=p_{G}^{t-1}" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.3" xref="alg1.l5.m1.2.3.cmml"><msubsup id="alg1.l5.m1.2.3.2" xref="alg1.l5.m1.2.3.2.cmml"><mi id="alg1.l5.m1.2.3.2.2.2" xref="alg1.l5.m1.2.3.2.2.2.cmml">p</mi><mi id="alg1.l5.m1.2.3.2.2.3" xref="alg1.l5.m1.2.3.2.2.3.cmml">G</mi><mrow id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.2.3.cmml"><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">t</mi><mo id="alg1.l5.m1.2.2.2.4.1" xref="alg1.l5.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml">0</mn></mrow></msubsup><mo id="alg1.l5.m1.2.3.1" xref="alg1.l5.m1.2.3.1.cmml">=</mo><msubsup id="alg1.l5.m1.2.3.3" xref="alg1.l5.m1.2.3.3.cmml"><mi id="alg1.l5.m1.2.3.3.2.2" xref="alg1.l5.m1.2.3.3.2.2.cmml">p</mi><mi id="alg1.l5.m1.2.3.3.2.3" xref="alg1.l5.m1.2.3.3.2.3.cmml">G</mi><mrow id="alg1.l5.m1.2.3.3.3" xref="alg1.l5.m1.2.3.3.3.cmml"><mi id="alg1.l5.m1.2.3.3.3.2" xref="alg1.l5.m1.2.3.3.3.2.cmml">t</mi><mo id="alg1.l5.m1.2.3.3.3.1" xref="alg1.l5.m1.2.3.3.3.1.cmml">−</mo><mn id="alg1.l5.m1.2.3.3.3.3" xref="alg1.l5.m1.2.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><apply id="alg1.l5.m1.2.3.cmml" xref="alg1.l5.m1.2.3"><eq id="alg1.l5.m1.2.3.1.cmml" xref="alg1.l5.m1.2.3.1"></eq><apply id="alg1.l5.m1.2.3.2.cmml" xref="alg1.l5.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.3.2.1.cmml" xref="alg1.l5.m1.2.3.2">superscript</csymbol><apply id="alg1.l5.m1.2.3.2.2.cmml" xref="alg1.l5.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.3.2.2.1.cmml" xref="alg1.l5.m1.2.3.2">subscript</csymbol><ci id="alg1.l5.m1.2.3.2.2.2.cmml" xref="alg1.l5.m1.2.3.2.2.2">𝑝</ci><ci id="alg1.l5.m1.2.3.2.2.3.cmml" xref="alg1.l5.m1.2.3.2.2.3">𝐺</ci></apply><list id="alg1.l5.m1.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.4"><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑡</ci><cn type="integer" id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2">0</cn></list></apply><apply id="alg1.l5.m1.2.3.3.cmml" xref="alg1.l5.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.3.3.1.cmml" xref="alg1.l5.m1.2.3.3">superscript</csymbol><apply id="alg1.l5.m1.2.3.3.2.cmml" xref="alg1.l5.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.2.3.3.2.1.cmml" xref="alg1.l5.m1.2.3.3">subscript</csymbol><ci id="alg1.l5.m1.2.3.3.2.2.cmml" xref="alg1.l5.m1.2.3.3.2.2">𝑝</ci><ci id="alg1.l5.m1.2.3.3.2.3.cmml" xref="alg1.l5.m1.2.3.3.2.3">𝐺</ci></apply><apply id="alg1.l5.m1.2.3.3.3.cmml" xref="alg1.l5.m1.2.3.3.3"><minus id="alg1.l5.m1.2.3.3.3.1.cmml" xref="alg1.l5.m1.2.3.3.3.1"></minus><ci id="alg1.l5.m1.2.3.3.3.2.cmml" xref="alg1.l5.m1.2.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m1.2.3.3.3.3.cmml" xref="alg1.l5.m1.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">p_{G}^{t,0}=p_{G}^{t-1}</annotation></semantics></math>,<math id="alg1.l5.m2.4" class="ltx_Math" alttext="p_{i}^{t,0}=p_{G}^{t,0}+\Delta p_{i}^{t-1}" display="inline"><semantics id="alg1.l5.m2.4a"><mrow id="alg1.l5.m2.4.5" xref="alg1.l5.m2.4.5.cmml"><msubsup id="alg1.l5.m2.4.5.2" xref="alg1.l5.m2.4.5.2.cmml"><mi id="alg1.l5.m2.4.5.2.2.2" xref="alg1.l5.m2.4.5.2.2.2.cmml">p</mi><mi id="alg1.l5.m2.4.5.2.2.3" xref="alg1.l5.m2.4.5.2.2.3.cmml">i</mi><mrow id="alg1.l5.m2.2.2.2.4" xref="alg1.l5.m2.2.2.2.3.cmml"><mi id="alg1.l5.m2.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.cmml">t</mi><mo id="alg1.l5.m2.2.2.2.4.1" xref="alg1.l5.m2.2.2.2.3.cmml">,</mo><mn id="alg1.l5.m2.2.2.2.2" xref="alg1.l5.m2.2.2.2.2.cmml">0</mn></mrow></msubsup><mo id="alg1.l5.m2.4.5.1" xref="alg1.l5.m2.4.5.1.cmml">=</mo><mrow id="alg1.l5.m2.4.5.3" xref="alg1.l5.m2.4.5.3.cmml"><msubsup id="alg1.l5.m2.4.5.3.2" xref="alg1.l5.m2.4.5.3.2.cmml"><mi id="alg1.l5.m2.4.5.3.2.2.2" xref="alg1.l5.m2.4.5.3.2.2.2.cmml">p</mi><mi id="alg1.l5.m2.4.5.3.2.2.3" xref="alg1.l5.m2.4.5.3.2.2.3.cmml">G</mi><mrow id="alg1.l5.m2.4.4.2.4" xref="alg1.l5.m2.4.4.2.3.cmml"><mi id="alg1.l5.m2.3.3.1.1" xref="alg1.l5.m2.3.3.1.1.cmml">t</mi><mo id="alg1.l5.m2.4.4.2.4.1" xref="alg1.l5.m2.4.4.2.3.cmml">,</mo><mn id="alg1.l5.m2.4.4.2.2" xref="alg1.l5.m2.4.4.2.2.cmml">0</mn></mrow></msubsup><mo id="alg1.l5.m2.4.5.3.1" xref="alg1.l5.m2.4.5.3.1.cmml">+</mo><mrow id="alg1.l5.m2.4.5.3.3" xref="alg1.l5.m2.4.5.3.3.cmml"><mi mathvariant="normal" id="alg1.l5.m2.4.5.3.3.2" xref="alg1.l5.m2.4.5.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.4.5.3.3.1" xref="alg1.l5.m2.4.5.3.3.1.cmml">​</mo><msubsup id="alg1.l5.m2.4.5.3.3.3" xref="alg1.l5.m2.4.5.3.3.3.cmml"><mi id="alg1.l5.m2.4.5.3.3.3.2.2" xref="alg1.l5.m2.4.5.3.3.3.2.2.cmml">p</mi><mi id="alg1.l5.m2.4.5.3.3.3.2.3" xref="alg1.l5.m2.4.5.3.3.3.2.3.cmml">i</mi><mrow id="alg1.l5.m2.4.5.3.3.3.3" xref="alg1.l5.m2.4.5.3.3.3.3.cmml"><mi id="alg1.l5.m2.4.5.3.3.3.3.2" xref="alg1.l5.m2.4.5.3.3.3.3.2.cmml">t</mi><mo id="alg1.l5.m2.4.5.3.3.3.3.1" xref="alg1.l5.m2.4.5.3.3.3.3.1.cmml">−</mo><mn id="alg1.l5.m2.4.5.3.3.3.3.3" xref="alg1.l5.m2.4.5.3.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.4b"><apply id="alg1.l5.m2.4.5.cmml" xref="alg1.l5.m2.4.5"><eq id="alg1.l5.m2.4.5.1.cmml" xref="alg1.l5.m2.4.5.1"></eq><apply id="alg1.l5.m2.4.5.2.cmml" xref="alg1.l5.m2.4.5.2"><csymbol cd="ambiguous" id="alg1.l5.m2.4.5.2.1.cmml" xref="alg1.l5.m2.4.5.2">superscript</csymbol><apply id="alg1.l5.m2.4.5.2.2.cmml" xref="alg1.l5.m2.4.5.2"><csymbol cd="ambiguous" id="alg1.l5.m2.4.5.2.2.1.cmml" xref="alg1.l5.m2.4.5.2">subscript</csymbol><ci id="alg1.l5.m2.4.5.2.2.2.cmml" xref="alg1.l5.m2.4.5.2.2.2">𝑝</ci><ci id="alg1.l5.m2.4.5.2.2.3.cmml" xref="alg1.l5.m2.4.5.2.2.3">𝑖</ci></apply><list id="alg1.l5.m2.2.2.2.3.cmml" xref="alg1.l5.m2.2.2.2.4"><ci id="alg1.l5.m2.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1">𝑡</ci><cn type="integer" id="alg1.l5.m2.2.2.2.2.cmml" xref="alg1.l5.m2.2.2.2.2">0</cn></list></apply><apply id="alg1.l5.m2.4.5.3.cmml" xref="alg1.l5.m2.4.5.3"><plus id="alg1.l5.m2.4.5.3.1.cmml" xref="alg1.l5.m2.4.5.3.1"></plus><apply id="alg1.l5.m2.4.5.3.2.cmml" xref="alg1.l5.m2.4.5.3.2"><csymbol cd="ambiguous" id="alg1.l5.m2.4.5.3.2.1.cmml" xref="alg1.l5.m2.4.5.3.2">superscript</csymbol><apply id="alg1.l5.m2.4.5.3.2.2.cmml" xref="alg1.l5.m2.4.5.3.2"><csymbol cd="ambiguous" id="alg1.l5.m2.4.5.3.2.2.1.cmml" xref="alg1.l5.m2.4.5.3.2">subscript</csymbol><ci id="alg1.l5.m2.4.5.3.2.2.2.cmml" xref="alg1.l5.m2.4.5.3.2.2.2">𝑝</ci><ci id="alg1.l5.m2.4.5.3.2.2.3.cmml" xref="alg1.l5.m2.4.5.3.2.2.3">𝐺</ci></apply><list id="alg1.l5.m2.4.4.2.3.cmml" xref="alg1.l5.m2.4.4.2.4"><ci id="alg1.l5.m2.3.3.1.1.cmml" xref="alg1.l5.m2.3.3.1.1">𝑡</ci><cn type="integer" id="alg1.l5.m2.4.4.2.2.cmml" xref="alg1.l5.m2.4.4.2.2">0</cn></list></apply><apply id="alg1.l5.m2.4.5.3.3.cmml" xref="alg1.l5.m2.4.5.3.3"><times id="alg1.l5.m2.4.5.3.3.1.cmml" xref="alg1.l5.m2.4.5.3.3.1"></times><ci id="alg1.l5.m2.4.5.3.3.2.cmml" xref="alg1.l5.m2.4.5.3.3.2">Δ</ci><apply id="alg1.l5.m2.4.5.3.3.3.cmml" xref="alg1.l5.m2.4.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m2.4.5.3.3.3.1.cmml" xref="alg1.l5.m2.4.5.3.3.3">superscript</csymbol><apply id="alg1.l5.m2.4.5.3.3.3.2.cmml" xref="alg1.l5.m2.4.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m2.4.5.3.3.3.2.1.cmml" xref="alg1.l5.m2.4.5.3.3.3">subscript</csymbol><ci id="alg1.l5.m2.4.5.3.3.3.2.2.cmml" xref="alg1.l5.m2.4.5.3.3.3.2.2">𝑝</ci><ci id="alg1.l5.m2.4.5.3.3.3.2.3.cmml" xref="alg1.l5.m2.4.5.3.3.3.2.3">𝑖</ci></apply><apply id="alg1.l5.m2.4.5.3.3.3.3.cmml" xref="alg1.l5.m2.4.5.3.3.3.3"><minus id="alg1.l5.m2.4.5.3.3.3.3.1.cmml" xref="alg1.l5.m2.4.5.3.3.3.3.1"></minus><ci id="alg1.l5.m2.4.5.3.3.3.3.2.cmml" xref="alg1.l5.m2.4.5.3.3.3.3.2">𝑡</ci><cn type="integer" id="alg1.l5.m2.4.5.3.3.3.3.3.cmml" xref="alg1.l5.m2.4.5.3.3.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.4c">p_{i}^{t,0}=p_{G}^{t,0}+\Delta p_{i}^{t-1}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l6.m1.3" class="ltx_Math" alttext="e\in\{1,...,E\}" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.4" xref="alg1.l6.m1.3.4.cmml"><mi id="alg1.l6.m1.3.4.2" xref="alg1.l6.m1.3.4.2.cmml">e</mi><mo id="alg1.l6.m1.3.4.1" xref="alg1.l6.m1.3.4.1.cmml">∈</mo><mrow id="alg1.l6.m1.3.4.3.2" xref="alg1.l6.m1.3.4.3.1.cmml"><mo stretchy="false" id="alg1.l6.m1.3.4.3.2.1" xref="alg1.l6.m1.3.4.3.1.cmml">{</mo><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">1</mn><mo id="alg1.l6.m1.3.4.3.2.2" xref="alg1.l6.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">…</mi><mo id="alg1.l6.m1.3.4.3.2.3" xref="alg1.l6.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">E</mi><mo stretchy="false" id="alg1.l6.m1.3.4.3.2.4" xref="alg1.l6.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.4.cmml" xref="alg1.l6.m1.3.4"><in id="alg1.l6.m1.3.4.1.cmml" xref="alg1.l6.m1.3.4.1"></in><ci id="alg1.l6.m1.3.4.2.cmml" xref="alg1.l6.m1.3.4.2">𝑒</ci><set id="alg1.l6.m1.3.4.3.1.cmml" xref="alg1.l6.m1.3.4.3.2"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">1</cn><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">…</ci><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">𝐸</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">e\in\{1,...,E\}</annotation></semantics></math> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           Sample a mini-batch <math id="alg1.l7.m1.1" class="ltx_Math" alttext="B_{i}\in D_{i}" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">B</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">∈</mo><msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">D</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><in id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"></in><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝐵</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">𝐷</ci><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">B_{i}\in D_{i}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>           Obtain the image feature <math id="alg1.l8.m1.2" class="ltx_Math" alttext="f(x)(x\in B_{i})" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><mi id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml">​</mo><mrow id="alg1.l8.m1.2.2.4.2" xref="alg1.l8.m1.2.2.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.4.2.1" xref="alg1.l8.m1.2.2.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l8.m1.2.2.4.2.2" xref="alg1.l8.m1.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2a" xref="alg1.l8.m1.2.2.2.cmml">​</mo><mrow id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.cmml">(</mo><mrow id="alg1.l8.m1.2.2.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.2" xref="alg1.l8.m1.2.2.1.1.1.2.cmml">x</mi><mo id="alg1.l8.m1.2.2.1.1.1.1" xref="alg1.l8.m1.2.2.1.1.1.1.cmml">∈</mo><msub id="alg1.l8.m1.2.2.1.1.1.3" xref="alg1.l8.m1.2.2.1.1.1.3.cmml"><mi id="alg1.l8.m1.2.2.1.1.1.3.2" xref="alg1.l8.m1.2.2.1.1.1.3.2.cmml">B</mi><mi id="alg1.l8.m1.2.2.1.1.1.3.3" xref="alg1.l8.m1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l8.m1.2.2.1.1.3" xref="alg1.l8.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><times id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"></times><ci id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3">𝑓</ci><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑥</ci><apply id="alg1.l8.m1.2.2.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1"><in id="alg1.l8.m1.2.2.1.1.1.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.1"></in><ci id="alg1.l8.m1.2.2.1.1.1.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.2">𝑥</ci><apply id="alg1.l8.m1.2.2.1.1.1.3.cmml" xref="alg1.l8.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.1.1.1.3.1.cmml" xref="alg1.l8.m1.2.2.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.2.2.1.1.1.3.2.cmml" xref="alg1.l8.m1.2.2.1.1.1.3.2">𝐵</ci><ci id="alg1.l8.m1.2.2.1.1.1.3.3.cmml" xref="alg1.l8.m1.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">f(x)(x\in B_{i})</annotation></semantics></math> through image encoder <math id="alg1.l8.m2.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1.2" xref="alg1.l8.m2.1.2.cmml"><mi id="alg1.l8.m2.1.2.2" xref="alg1.l8.m2.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m2.1.2.1" xref="alg1.l8.m2.1.2.1.cmml">​</mo><mrow id="alg1.l8.m2.1.2.3.2" xref="alg1.l8.m2.1.2.cmml"><mo stretchy="false" id="alg1.l8.m2.1.2.3.2.1" xref="alg1.l8.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.l8.m2.1.2.3.2.2" xref="alg1.l8.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.2.cmml" xref="alg1.l8.m2.1.2"><times id="alg1.l8.m2.1.2.1.cmml" xref="alg1.l8.m2.1.2.1"></times><ci id="alg1.l8.m2.1.2.2.cmml" xref="alg1.l8.m2.1.2.2">𝑓</ci><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">f(\cdot)</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>           Obtain the global text feature <math id="alg1.l9.m1.3" class="ltx_Math" alttext="g(P_{G}^{t,e})" display="inline"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml"><mi id="alg1.l9.m1.3.3.3" xref="alg1.l9.m1.3.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.2" xref="alg1.l9.m1.3.3.2.cmml">​</mo><mrow id="alg1.l9.m1.3.3.1.1" xref="alg1.l9.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.3.3.1.1.2" xref="alg1.l9.m1.3.3.1.1.1.cmml">(</mo><msubsup id="alg1.l9.m1.3.3.1.1.1" xref="alg1.l9.m1.3.3.1.1.1.cmml"><mi id="alg1.l9.m1.3.3.1.1.1.2.2" xref="alg1.l9.m1.3.3.1.1.1.2.2.cmml">P</mi><mi id="alg1.l9.m1.3.3.1.1.1.2.3" xref="alg1.l9.m1.3.3.1.1.1.2.3.cmml">G</mi><mrow id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.3.cmml"><mi id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml">t</mi><mo id="alg1.l9.m1.2.2.2.4.1" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.cmml">e</mi></mrow></msubsup><mo stretchy="false" id="alg1.l9.m1.3.3.1.1.3" xref="alg1.l9.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3"><times id="alg1.l9.m1.3.3.2.cmml" xref="alg1.l9.m1.3.3.2"></times><ci id="alg1.l9.m1.3.3.3.cmml" xref="alg1.l9.m1.3.3.3">𝑔</ci><apply id="alg1.l9.m1.3.3.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.1.1">superscript</csymbol><apply id="alg1.l9.m1.3.3.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l9.m1.3.3.1.1">subscript</csymbol><ci id="alg1.l9.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l9.m1.3.3.1.1.1.2.2">𝑃</ci><ci id="alg1.l9.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l9.m1.3.3.1.1.1.2.3">𝐺</ci></apply><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.4"><ci id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">𝑡</ci><ci id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2">𝑒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">g(P_{G}^{t,e})</annotation></semantics></math> ,the personalized text feature <math id="alg1.l9.m2.3" class="ltx_Math" alttext="g(P_{i}^{t,e})" display="inline"><semantics id="alg1.l9.m2.3a"><mrow id="alg1.l9.m2.3.3" xref="alg1.l9.m2.3.3.cmml"><mi id="alg1.l9.m2.3.3.3" xref="alg1.l9.m2.3.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m2.3.3.2" xref="alg1.l9.m2.3.3.2.cmml">​</mo><mrow id="alg1.l9.m2.3.3.1.1" xref="alg1.l9.m2.3.3.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m2.3.3.1.1.2" xref="alg1.l9.m2.3.3.1.1.1.cmml">(</mo><msubsup id="alg1.l9.m2.3.3.1.1.1" xref="alg1.l9.m2.3.3.1.1.1.cmml"><mi id="alg1.l9.m2.3.3.1.1.1.2.2" xref="alg1.l9.m2.3.3.1.1.1.2.2.cmml">P</mi><mi id="alg1.l9.m2.3.3.1.1.1.2.3" xref="alg1.l9.m2.3.3.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l9.m2.2.2.2.4" xref="alg1.l9.m2.2.2.2.3.cmml"><mi id="alg1.l9.m2.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.cmml">t</mi><mo id="alg1.l9.m2.2.2.2.4.1" xref="alg1.l9.m2.2.2.2.3.cmml">,</mo><mi id="alg1.l9.m2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.cmml">e</mi></mrow></msubsup><mo stretchy="false" id="alg1.l9.m2.3.3.1.1.3" xref="alg1.l9.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.3b"><apply id="alg1.l9.m2.3.3.cmml" xref="alg1.l9.m2.3.3"><times id="alg1.l9.m2.3.3.2.cmml" xref="alg1.l9.m2.3.3.2"></times><ci id="alg1.l9.m2.3.3.3.cmml" xref="alg1.l9.m2.3.3.3">𝑔</ci><apply id="alg1.l9.m2.3.3.1.1.1.cmml" xref="alg1.l9.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.3.3.1.1.1.1.cmml" xref="alg1.l9.m2.3.3.1.1">superscript</csymbol><apply id="alg1.l9.m2.3.3.1.1.1.2.cmml" xref="alg1.l9.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.3.3.1.1.1.2.1.cmml" xref="alg1.l9.m2.3.3.1.1">subscript</csymbol><ci id="alg1.l9.m2.3.3.1.1.1.2.2.cmml" xref="alg1.l9.m2.3.3.1.1.1.2.2">𝑃</ci><ci id="alg1.l9.m2.3.3.1.1.1.2.3.cmml" xref="alg1.l9.m2.3.3.1.1.1.2.3">𝑖</ci></apply><list id="alg1.l9.m2.2.2.2.3.cmml" xref="alg1.l9.m2.2.2.2.4"><ci id="alg1.l9.m2.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1">𝑡</ci><ci id="alg1.l9.m2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2">𝑒</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.3c">g(P_{i}^{t,e})</annotation></semantics></math>, the CLIP general text feature <math id="alg1.l9.m3.1" class="ltx_Math" alttext="g(P_{C})" display="inline"><semantics id="alg1.l9.m3.1a"><mrow id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml"><mi id="alg1.l9.m3.1.1.3" xref="alg1.l9.m3.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m3.1.1.2" xref="alg1.l9.m3.1.1.2.cmml">​</mo><mrow id="alg1.l9.m3.1.1.1.1" xref="alg1.l9.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m3.1.1.1.1.2" xref="alg1.l9.m3.1.1.1.1.1.cmml">(</mo><msub id="alg1.l9.m3.1.1.1.1.1" xref="alg1.l9.m3.1.1.1.1.1.cmml"><mi id="alg1.l9.m3.1.1.1.1.1.2" xref="alg1.l9.m3.1.1.1.1.1.2.cmml">P</mi><mi id="alg1.l9.m3.1.1.1.1.1.3" xref="alg1.l9.m3.1.1.1.1.1.3.cmml">C</mi></msub><mo stretchy="false" id="alg1.l9.m3.1.1.1.1.3" xref="alg1.l9.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><apply id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1"><times id="alg1.l9.m3.1.1.2.cmml" xref="alg1.l9.m3.1.1.2"></times><ci id="alg1.l9.m3.1.1.3.cmml" xref="alg1.l9.m3.1.1.3">𝑔</ci><apply id="alg1.l9.m3.1.1.1.1.1.cmml" xref="alg1.l9.m3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.1.1.1.1.cmml" xref="alg1.l9.m3.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m3.1.1.1.1.1.2.cmml" xref="alg1.l9.m3.1.1.1.1.1.2">𝑃</ci><ci id="alg1.l9.m3.1.1.1.1.1.3.cmml" xref="alg1.l9.m3.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">g(P_{C})</annotation></semantics></math> through text encoder <math id="alg1.l9.m4.1" class="ltx_Math" alttext="g(\cdot)" display="inline"><semantics id="alg1.l9.m4.1a"><mrow id="alg1.l9.m4.1.2" xref="alg1.l9.m4.1.2.cmml"><mi id="alg1.l9.m4.1.2.2" xref="alg1.l9.m4.1.2.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m4.1.2.1" xref="alg1.l9.m4.1.2.1.cmml">​</mo><mrow id="alg1.l9.m4.1.2.3.2" xref="alg1.l9.m4.1.2.cmml"><mo stretchy="false" id="alg1.l9.m4.1.2.3.2.1" xref="alg1.l9.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.l9.m4.1.1" xref="alg1.l9.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.l9.m4.1.2.3.2.2" xref="alg1.l9.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m4.1b"><apply id="alg1.l9.m4.1.2.cmml" xref="alg1.l9.m4.1.2"><times id="alg1.l9.m4.1.2.1.cmml" xref="alg1.l9.m4.1.2.1"></times><ci id="alg1.l9.m4.1.2.2.cmml" xref="alg1.l9.m4.1.2.2">𝑔</ci><ci id="alg1.l9.m4.1.1.cmml" xref="alg1.l9.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m4.1c">g(\cdot)</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>           Calculate the cross-entropy loss <math id="alg1.l10.m1.1" class="ltx_Math" alttext="\mathcal{L}_{ce}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">ℒ</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><times id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑐</ci><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\mathcal{L}_{ce}</annotation></semantics></math> ,the contrastive loss <math id="alg1.l10.m2.1" class="ltx_Math" alttext="\mathcal{L}_{con}" display="inline"><semantics id="alg1.l10.m2.1a"><msub id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">ℒ</mi><mrow id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml"><mi id="alg1.l10.m2.1.1.3.2" xref="alg1.l10.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.3.1" xref="alg1.l10.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m2.1.1.3.3" xref="alg1.l10.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.3.1a" xref="alg1.l10.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m2.1.1.3.4" xref="alg1.l10.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><ci id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2">ℒ</ci><apply id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3"><times id="alg1.l10.m2.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.3.1"></times><ci id="alg1.l10.m2.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.3.2">𝑐</ci><ci id="alg1.l10.m2.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.3.3">𝑜</ci><ci id="alg1.l10.m2.1.1.3.4.cmml" xref="alg1.l10.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">\mathcal{L}_{con}</annotation></semantics></math> according to (<a href="#S3.E12" title="Equation 12 ‣ 3.4 Balance FPL’s Generalization and Personalization ‣ 3 Proposed Method ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>) and the optimization objective <math id="alg1.l10.m3.1" class="ltx_Math" alttext="\mathcal{L}=\mathcal{L}_{ce}+\mu\mathcal{L}_{con}" display="inline"><semantics id="alg1.l10.m3.1a"><mrow id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m3.1.1.2" xref="alg1.l10.m3.1.1.2.cmml">ℒ</mi><mo id="alg1.l10.m3.1.1.1" xref="alg1.l10.m3.1.1.1.cmml">=</mo><mrow id="alg1.l10.m3.1.1.3" xref="alg1.l10.m3.1.1.3.cmml"><msub id="alg1.l10.m3.1.1.3.2" xref="alg1.l10.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m3.1.1.3.2.2" xref="alg1.l10.m3.1.1.3.2.2.cmml">ℒ</mi><mrow id="alg1.l10.m3.1.1.3.2.3" xref="alg1.l10.m3.1.1.3.2.3.cmml"><mi id="alg1.l10.m3.1.1.3.2.3.2" xref="alg1.l10.m3.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m3.1.1.3.2.3.1" xref="alg1.l10.m3.1.1.3.2.3.1.cmml">​</mo><mi id="alg1.l10.m3.1.1.3.2.3.3" xref="alg1.l10.m3.1.1.3.2.3.3.cmml">e</mi></mrow></msub><mo id="alg1.l10.m3.1.1.3.1" xref="alg1.l10.m3.1.1.3.1.cmml">+</mo><mrow id="alg1.l10.m3.1.1.3.3" xref="alg1.l10.m3.1.1.3.3.cmml"><mi id="alg1.l10.m3.1.1.3.3.2" xref="alg1.l10.m3.1.1.3.3.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m3.1.1.3.3.1" xref="alg1.l10.m3.1.1.3.3.1.cmml">​</mo><msub id="alg1.l10.m3.1.1.3.3.3" xref="alg1.l10.m3.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m3.1.1.3.3.3.2" xref="alg1.l10.m3.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="alg1.l10.m3.1.1.3.3.3.3" xref="alg1.l10.m3.1.1.3.3.3.3.cmml"><mi id="alg1.l10.m3.1.1.3.3.3.3.2" xref="alg1.l10.m3.1.1.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m3.1.1.3.3.3.3.1" xref="alg1.l10.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m3.1.1.3.3.3.3.3" xref="alg1.l10.m3.1.1.3.3.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m3.1.1.3.3.3.3.1a" xref="alg1.l10.m3.1.1.3.3.3.3.1.cmml">​</mo><mi id="alg1.l10.m3.1.1.3.3.3.3.4" xref="alg1.l10.m3.1.1.3.3.3.3.4.cmml">n</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1"><eq id="alg1.l10.m3.1.1.1.cmml" xref="alg1.l10.m3.1.1.1"></eq><ci id="alg1.l10.m3.1.1.2.cmml" xref="alg1.l10.m3.1.1.2">ℒ</ci><apply id="alg1.l10.m3.1.1.3.cmml" xref="alg1.l10.m3.1.1.3"><plus id="alg1.l10.m3.1.1.3.1.cmml" xref="alg1.l10.m3.1.1.3.1"></plus><apply id="alg1.l10.m3.1.1.3.2.cmml" xref="alg1.l10.m3.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.3.2.1.cmml" xref="alg1.l10.m3.1.1.3.2">subscript</csymbol><ci id="alg1.l10.m3.1.1.3.2.2.cmml" xref="alg1.l10.m3.1.1.3.2.2">ℒ</ci><apply id="alg1.l10.m3.1.1.3.2.3.cmml" xref="alg1.l10.m3.1.1.3.2.3"><times id="alg1.l10.m3.1.1.3.2.3.1.cmml" xref="alg1.l10.m3.1.1.3.2.3.1"></times><ci id="alg1.l10.m3.1.1.3.2.3.2.cmml" xref="alg1.l10.m3.1.1.3.2.3.2">𝑐</ci><ci id="alg1.l10.m3.1.1.3.2.3.3.cmml" xref="alg1.l10.m3.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="alg1.l10.m3.1.1.3.3.cmml" xref="alg1.l10.m3.1.1.3.3"><times id="alg1.l10.m3.1.1.3.3.1.cmml" xref="alg1.l10.m3.1.1.3.3.1"></times><ci id="alg1.l10.m3.1.1.3.3.2.cmml" xref="alg1.l10.m3.1.1.3.3.2">𝜇</ci><apply id="alg1.l10.m3.1.1.3.3.3.cmml" xref="alg1.l10.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.3.3.3.1.cmml" xref="alg1.l10.m3.1.1.3.3.3">subscript</csymbol><ci id="alg1.l10.m3.1.1.3.3.3.2.cmml" xref="alg1.l10.m3.1.1.3.3.3.2">ℒ</ci><apply id="alg1.l10.m3.1.1.3.3.3.3.cmml" xref="alg1.l10.m3.1.1.3.3.3.3"><times id="alg1.l10.m3.1.1.3.3.3.3.1.cmml" xref="alg1.l10.m3.1.1.3.3.3.3.1"></times><ci id="alg1.l10.m3.1.1.3.3.3.3.2.cmml" xref="alg1.l10.m3.1.1.3.3.3.3.2">𝑐</ci><ci id="alg1.l10.m3.1.1.3.3.3.3.3.cmml" xref="alg1.l10.m3.1.1.3.3.3.3.3">𝑜</ci><ci id="alg1.l10.m3.1.1.3.3.3.3.4.cmml" xref="alg1.l10.m3.1.1.3.3.3.3.4">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">\mathcal{L}=\mathcal{L}_{ce}+\mu\mathcal{L}_{con}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>           Update prompts <math id="alg1.l11.m1.6" class="ltx_Math" alttext="p_{G,i}^{t,e}\leftarrow p^{t,e-1}_{G}-\eta\nabla\mathcal{L}_{D_{i}}" display="inline"><semantics id="alg1.l11.m1.6a"><mrow id="alg1.l11.m1.6.7" xref="alg1.l11.m1.6.7.cmml"><msubsup id="alg1.l11.m1.6.7.2" xref="alg1.l11.m1.6.7.2.cmml"><mi id="alg1.l11.m1.6.7.2.2.2" xref="alg1.l11.m1.6.7.2.2.2.cmml">p</mi><mrow id="alg1.l11.m1.2.2.2.4" xref="alg1.l11.m1.2.2.2.3.cmml"><mi id="alg1.l11.m1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.cmml">G</mi><mo id="alg1.l11.m1.2.2.2.4.1" xref="alg1.l11.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l11.m1.2.2.2.2" xref="alg1.l11.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="alg1.l11.m1.4.4.2.4" xref="alg1.l11.m1.4.4.2.3.cmml"><mi id="alg1.l11.m1.3.3.1.1" xref="alg1.l11.m1.3.3.1.1.cmml">t</mi><mo id="alg1.l11.m1.4.4.2.4.1" xref="alg1.l11.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l11.m1.4.4.2.2" xref="alg1.l11.m1.4.4.2.2.cmml">e</mi></mrow></msubsup><mo stretchy="false" id="alg1.l11.m1.6.7.1" xref="alg1.l11.m1.6.7.1.cmml">←</mo><mrow id="alg1.l11.m1.6.7.3" xref="alg1.l11.m1.6.7.3.cmml"><msubsup id="alg1.l11.m1.6.7.3.2" xref="alg1.l11.m1.6.7.3.2.cmml"><mi id="alg1.l11.m1.6.7.3.2.2.2" xref="alg1.l11.m1.6.7.3.2.2.2.cmml">p</mi><mi id="alg1.l11.m1.6.7.3.2.3" xref="alg1.l11.m1.6.7.3.2.3.cmml">G</mi><mrow id="alg1.l11.m1.6.6.2.2" xref="alg1.l11.m1.6.6.2.3.cmml"><mi id="alg1.l11.m1.5.5.1.1" xref="alg1.l11.m1.5.5.1.1.cmml">t</mi><mo id="alg1.l11.m1.6.6.2.2.2" xref="alg1.l11.m1.6.6.2.3.cmml">,</mo><mrow id="alg1.l11.m1.6.6.2.2.1" xref="alg1.l11.m1.6.6.2.2.1.cmml"><mi id="alg1.l11.m1.6.6.2.2.1.2" xref="alg1.l11.m1.6.6.2.2.1.2.cmml">e</mi><mo id="alg1.l11.m1.6.6.2.2.1.1" xref="alg1.l11.m1.6.6.2.2.1.1.cmml">−</mo><mn id="alg1.l11.m1.6.6.2.2.1.3" xref="alg1.l11.m1.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo id="alg1.l11.m1.6.7.3.1" xref="alg1.l11.m1.6.7.3.1.cmml">−</mo><mrow id="alg1.l11.m1.6.7.3.3" xref="alg1.l11.m1.6.7.3.3.cmml"><mi id="alg1.l11.m1.6.7.3.3.2" xref="alg1.l11.m1.6.7.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l11.m1.6.7.3.3.1" xref="alg1.l11.m1.6.7.3.3.1.cmml">​</mo><mrow id="alg1.l11.m1.6.7.3.3.3" xref="alg1.l11.m1.6.7.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l11.m1.6.7.3.3.3.1" xref="alg1.l11.m1.6.7.3.3.3.1.cmml">∇</mo><msub id="alg1.l11.m1.6.7.3.3.3.2" xref="alg1.l11.m1.6.7.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.6.7.3.3.3.2.2" xref="alg1.l11.m1.6.7.3.3.3.2.2.cmml">ℒ</mi><msub id="alg1.l11.m1.6.7.3.3.3.2.3" xref="alg1.l11.m1.6.7.3.3.3.2.3.cmml"><mi id="alg1.l11.m1.6.7.3.3.3.2.3.2" xref="alg1.l11.m1.6.7.3.3.3.2.3.2.cmml">D</mi><mi id="alg1.l11.m1.6.7.3.3.3.2.3.3" xref="alg1.l11.m1.6.7.3.3.3.2.3.3.cmml">i</mi></msub></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.6b"><apply id="alg1.l11.m1.6.7.cmml" xref="alg1.l11.m1.6.7"><ci id="alg1.l11.m1.6.7.1.cmml" xref="alg1.l11.m1.6.7.1">←</ci><apply id="alg1.l11.m1.6.7.2.cmml" xref="alg1.l11.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.7.2.1.cmml" xref="alg1.l11.m1.6.7.2">superscript</csymbol><apply id="alg1.l11.m1.6.7.2.2.cmml" xref="alg1.l11.m1.6.7.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.7.2.2.1.cmml" xref="alg1.l11.m1.6.7.2">subscript</csymbol><ci id="alg1.l11.m1.6.7.2.2.2.cmml" xref="alg1.l11.m1.6.7.2.2.2">𝑝</ci><list id="alg1.l11.m1.2.2.2.3.cmml" xref="alg1.l11.m1.2.2.2.4"><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">𝐺</ci><ci id="alg1.l11.m1.2.2.2.2.cmml" xref="alg1.l11.m1.2.2.2.2">𝑖</ci></list></apply><list id="alg1.l11.m1.4.4.2.3.cmml" xref="alg1.l11.m1.4.4.2.4"><ci id="alg1.l11.m1.3.3.1.1.cmml" xref="alg1.l11.m1.3.3.1.1">𝑡</ci><ci id="alg1.l11.m1.4.4.2.2.cmml" xref="alg1.l11.m1.4.4.2.2">𝑒</ci></list></apply><apply id="alg1.l11.m1.6.7.3.cmml" xref="alg1.l11.m1.6.7.3"><minus id="alg1.l11.m1.6.7.3.1.cmml" xref="alg1.l11.m1.6.7.3.1"></minus><apply id="alg1.l11.m1.6.7.3.2.cmml" xref="alg1.l11.m1.6.7.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.7.3.2.1.cmml" xref="alg1.l11.m1.6.7.3.2">subscript</csymbol><apply id="alg1.l11.m1.6.7.3.2.2.cmml" xref="alg1.l11.m1.6.7.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.7.3.2.2.1.cmml" xref="alg1.l11.m1.6.7.3.2">superscript</csymbol><ci id="alg1.l11.m1.6.7.3.2.2.2.cmml" xref="alg1.l11.m1.6.7.3.2.2.2">𝑝</ci><list id="alg1.l11.m1.6.6.2.3.cmml" xref="alg1.l11.m1.6.6.2.2"><ci id="alg1.l11.m1.5.5.1.1.cmml" xref="alg1.l11.m1.5.5.1.1">𝑡</ci><apply id="alg1.l11.m1.6.6.2.2.1.cmml" xref="alg1.l11.m1.6.6.2.2.1"><minus id="alg1.l11.m1.6.6.2.2.1.1.cmml" xref="alg1.l11.m1.6.6.2.2.1.1"></minus><ci id="alg1.l11.m1.6.6.2.2.1.2.cmml" xref="alg1.l11.m1.6.6.2.2.1.2">𝑒</ci><cn type="integer" id="alg1.l11.m1.6.6.2.2.1.3.cmml" xref="alg1.l11.m1.6.6.2.2.1.3">1</cn></apply></list></apply><ci id="alg1.l11.m1.6.7.3.2.3.cmml" xref="alg1.l11.m1.6.7.3.2.3">𝐺</ci></apply><apply id="alg1.l11.m1.6.7.3.3.cmml" xref="alg1.l11.m1.6.7.3.3"><times id="alg1.l11.m1.6.7.3.3.1.cmml" xref="alg1.l11.m1.6.7.3.3.1"></times><ci id="alg1.l11.m1.6.7.3.3.2.cmml" xref="alg1.l11.m1.6.7.3.3.2">𝜂</ci><apply id="alg1.l11.m1.6.7.3.3.3.cmml" xref="alg1.l11.m1.6.7.3.3.3"><ci id="alg1.l11.m1.6.7.3.3.3.1.cmml" xref="alg1.l11.m1.6.7.3.3.3.1">∇</ci><apply id="alg1.l11.m1.6.7.3.3.3.2.cmml" xref="alg1.l11.m1.6.7.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l11.m1.6.7.3.3.3.2.1.cmml" xref="alg1.l11.m1.6.7.3.3.3.2">subscript</csymbol><ci id="alg1.l11.m1.6.7.3.3.3.2.2.cmml" xref="alg1.l11.m1.6.7.3.3.3.2.2">ℒ</ci><apply id="alg1.l11.m1.6.7.3.3.3.2.3.cmml" xref="alg1.l11.m1.6.7.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l11.m1.6.7.3.3.3.2.3.1.cmml" xref="alg1.l11.m1.6.7.3.3.3.2.3">subscript</csymbol><ci id="alg1.l11.m1.6.7.3.3.3.2.3.2.cmml" xref="alg1.l11.m1.6.7.3.3.3.2.3.2">𝐷</ci><ci id="alg1.l11.m1.6.7.3.3.3.2.3.3.cmml" xref="alg1.l11.m1.6.7.3.3.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.6c">p_{G,i}^{t,e}\leftarrow p^{t,e-1}_{G}-\eta\nabla\mathcal{L}_{D_{i}}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        <span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     Aggregate and calculate the global prompt <math id="alg1.l14.m1.4" class="ltx_Math" alttext="p_{G}^{t}=\sum_{i\in C_{t}}\frac{n_{i}}{\sum_{j\in C_{t}}n_{j}}p_{G,i}^{t,E}" display="inline"><semantics id="alg1.l14.m1.4a"><mrow id="alg1.l14.m1.4.5" xref="alg1.l14.m1.4.5.cmml"><msubsup id="alg1.l14.m1.4.5.2" xref="alg1.l14.m1.4.5.2.cmml"><mi id="alg1.l14.m1.4.5.2.2.2" xref="alg1.l14.m1.4.5.2.2.2.cmml">p</mi><mi id="alg1.l14.m1.4.5.2.2.3" xref="alg1.l14.m1.4.5.2.2.3.cmml">G</mi><mi id="alg1.l14.m1.4.5.2.3" xref="alg1.l14.m1.4.5.2.3.cmml">t</mi></msubsup><mo rspace="0.111em" id="alg1.l14.m1.4.5.1" xref="alg1.l14.m1.4.5.1.cmml">=</mo><mrow id="alg1.l14.m1.4.5.3" xref="alg1.l14.m1.4.5.3.cmml"><msub id="alg1.l14.m1.4.5.3.1" xref="alg1.l14.m1.4.5.3.1.cmml"><mo id="alg1.l14.m1.4.5.3.1.2" xref="alg1.l14.m1.4.5.3.1.2.cmml">∑</mo><mrow id="alg1.l14.m1.4.5.3.1.3" xref="alg1.l14.m1.4.5.3.1.3.cmml"><mi id="alg1.l14.m1.4.5.3.1.3.2" xref="alg1.l14.m1.4.5.3.1.3.2.cmml">i</mi><mo id="alg1.l14.m1.4.5.3.1.3.1" xref="alg1.l14.m1.4.5.3.1.3.1.cmml">∈</mo><msub id="alg1.l14.m1.4.5.3.1.3.3" xref="alg1.l14.m1.4.5.3.1.3.3.cmml"><mi id="alg1.l14.m1.4.5.3.1.3.3.2" xref="alg1.l14.m1.4.5.3.1.3.3.2.cmml">C</mi><mi id="alg1.l14.m1.4.5.3.1.3.3.3" xref="alg1.l14.m1.4.5.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.l14.m1.4.5.3.2" xref="alg1.l14.m1.4.5.3.2.cmml"><mfrac id="alg1.l14.m1.4.5.3.2.2" xref="alg1.l14.m1.4.5.3.2.2.cmml"><msub id="alg1.l14.m1.4.5.3.2.2.2" xref="alg1.l14.m1.4.5.3.2.2.2.cmml"><mi id="alg1.l14.m1.4.5.3.2.2.2.2" xref="alg1.l14.m1.4.5.3.2.2.2.2.cmml">n</mi><mi id="alg1.l14.m1.4.5.3.2.2.2.3" xref="alg1.l14.m1.4.5.3.2.2.2.3.cmml">i</mi></msub><mrow id="alg1.l14.m1.4.5.3.2.2.3" xref="alg1.l14.m1.4.5.3.2.2.3.cmml"><mstyle displaystyle="false" id="alg1.l14.m1.4.5.3.2.2.3.1" xref="alg1.l14.m1.4.5.3.2.2.3.1.cmml"><msub id="alg1.l14.m1.4.5.3.2.2.3.1a" xref="alg1.l14.m1.4.5.3.2.2.3.1.cmml"><mo id="alg1.l14.m1.4.5.3.2.2.3.1.2" xref="alg1.l14.m1.4.5.3.2.2.3.1.2.cmml">∑</mo><mrow id="alg1.l14.m1.4.5.3.2.2.3.1.3" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.cmml"><mi id="alg1.l14.m1.4.5.3.2.2.3.1.3.2" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.2.cmml">j</mi><mo id="alg1.l14.m1.4.5.3.2.2.3.1.3.1" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.1.cmml">∈</mo><msub id="alg1.l14.m1.4.5.3.2.2.3.1.3.3" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3.cmml"><mi id="alg1.l14.m1.4.5.3.2.2.3.1.3.3.2" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3.2.cmml">C</mi><mi id="alg1.l14.m1.4.5.3.2.2.3.1.3.3.3" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub></mstyle><msub id="alg1.l14.m1.4.5.3.2.2.3.2" xref="alg1.l14.m1.4.5.3.2.2.3.2.cmml"><mi id="alg1.l14.m1.4.5.3.2.2.3.2.2" xref="alg1.l14.m1.4.5.3.2.2.3.2.2.cmml">n</mi><mi id="alg1.l14.m1.4.5.3.2.2.3.2.3" xref="alg1.l14.m1.4.5.3.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m1.4.5.3.2.1" xref="alg1.l14.m1.4.5.3.2.1.cmml">​</mo><msubsup id="alg1.l14.m1.4.5.3.2.3" xref="alg1.l14.m1.4.5.3.2.3.cmml"><mi id="alg1.l14.m1.4.5.3.2.3.2.2" xref="alg1.l14.m1.4.5.3.2.3.2.2.cmml">p</mi><mrow id="alg1.l14.m1.2.2.2.4" xref="alg1.l14.m1.2.2.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml">G</mi><mo id="alg1.l14.m1.2.2.2.4.1" xref="alg1.l14.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.cmml">i</mi></mrow><mrow id="alg1.l14.m1.4.4.2.4" xref="alg1.l14.m1.4.4.2.3.cmml"><mi id="alg1.l14.m1.3.3.1.1" xref="alg1.l14.m1.3.3.1.1.cmml">t</mi><mo id="alg1.l14.m1.4.4.2.4.1" xref="alg1.l14.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l14.m1.4.4.2.2" xref="alg1.l14.m1.4.4.2.2.cmml">E</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.4b"><apply id="alg1.l14.m1.4.5.cmml" xref="alg1.l14.m1.4.5"><eq id="alg1.l14.m1.4.5.1.cmml" xref="alg1.l14.m1.4.5.1"></eq><apply id="alg1.l14.m1.4.5.2.cmml" xref="alg1.l14.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.2.1.cmml" xref="alg1.l14.m1.4.5.2">superscript</csymbol><apply id="alg1.l14.m1.4.5.2.2.cmml" xref="alg1.l14.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.2.2.1.cmml" xref="alg1.l14.m1.4.5.2">subscript</csymbol><ci id="alg1.l14.m1.4.5.2.2.2.cmml" xref="alg1.l14.m1.4.5.2.2.2">𝑝</ci><ci id="alg1.l14.m1.4.5.2.2.3.cmml" xref="alg1.l14.m1.4.5.2.2.3">𝐺</ci></apply><ci id="alg1.l14.m1.4.5.2.3.cmml" xref="alg1.l14.m1.4.5.2.3">𝑡</ci></apply><apply id="alg1.l14.m1.4.5.3.cmml" xref="alg1.l14.m1.4.5.3"><apply id="alg1.l14.m1.4.5.3.1.cmml" xref="alg1.l14.m1.4.5.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.1.1.cmml" xref="alg1.l14.m1.4.5.3.1">subscript</csymbol><sum id="alg1.l14.m1.4.5.3.1.2.cmml" xref="alg1.l14.m1.4.5.3.1.2"></sum><apply id="alg1.l14.m1.4.5.3.1.3.cmml" xref="alg1.l14.m1.4.5.3.1.3"><in id="alg1.l14.m1.4.5.3.1.3.1.cmml" xref="alg1.l14.m1.4.5.3.1.3.1"></in><ci id="alg1.l14.m1.4.5.3.1.3.2.cmml" xref="alg1.l14.m1.4.5.3.1.3.2">𝑖</ci><apply id="alg1.l14.m1.4.5.3.1.3.3.cmml" xref="alg1.l14.m1.4.5.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.1.3.3.1.cmml" xref="alg1.l14.m1.4.5.3.1.3.3">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.1.3.3.2.cmml" xref="alg1.l14.m1.4.5.3.1.3.3.2">𝐶</ci><ci id="alg1.l14.m1.4.5.3.1.3.3.3.cmml" xref="alg1.l14.m1.4.5.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l14.m1.4.5.3.2.cmml" xref="alg1.l14.m1.4.5.3.2"><times id="alg1.l14.m1.4.5.3.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.1"></times><apply id="alg1.l14.m1.4.5.3.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.2"><divide id="alg1.l14.m1.4.5.3.2.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.2"></divide><apply id="alg1.l14.m1.4.5.3.2.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.2.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.2.2.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.2.2">𝑛</ci><ci id="alg1.l14.m1.4.5.3.2.2.2.3.cmml" xref="alg1.l14.m1.4.5.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.4.5.3.2.2.3.cmml" xref="alg1.l14.m1.4.5.3.2.2.3"><apply id="alg1.l14.m1.4.5.3.2.2.3.1.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.2.3.1.1.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1">subscript</csymbol><sum id="alg1.l14.m1.4.5.3.2.2.3.1.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.2"></sum><apply id="alg1.l14.m1.4.5.3.2.2.3.1.3.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3"><in id="alg1.l14.m1.4.5.3.2.2.3.1.3.1.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.1"></in><ci id="alg1.l14.m1.4.5.3.2.2.3.1.3.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.2">𝑗</ci><apply id="alg1.l14.m1.4.5.3.2.2.3.1.3.3.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.2.3.1.3.3.1.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.2.2.3.1.3.3.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3.2">𝐶</ci><ci id="alg1.l14.m1.4.5.3.2.2.3.1.3.3.3.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l14.m1.4.5.3.2.2.3.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.2.3.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.2">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.2.2.3.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.2.2">𝑛</ci><ci id="alg1.l14.m1.4.5.3.2.2.3.2.3.cmml" xref="alg1.l14.m1.4.5.3.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="alg1.l14.m1.4.5.3.2.3.cmml" xref="alg1.l14.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.3.1.cmml" xref="alg1.l14.m1.4.5.3.2.3">superscript</csymbol><apply id="alg1.l14.m1.4.5.3.2.3.2.cmml" xref="alg1.l14.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.3.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.3">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.2.3.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.3.2.2">𝑝</ci><list id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.4"><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">𝐺</ci><ci id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2">𝑖</ci></list></apply><list id="alg1.l14.m1.4.4.2.3.cmml" xref="alg1.l14.m1.4.4.2.4"><ci id="alg1.l14.m1.3.3.1.1.cmml" xref="alg1.l14.m1.3.3.1.1">𝑡</ci><ci id="alg1.l14.m1.4.4.2.2.cmml" xref="alg1.l14.m1.4.4.2.2">𝐸</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.4c">p_{G}^{t}=\sum_{i\in C_{t}}\frac{n_{i}}{\sum_{j\in C_{t}}n_{j}}p_{G,i}^{t,E}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l16.m1.1" class="ltx_Math" alttext="p_{i}=p_{G}+\Delta p_{i}" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msub id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml"><mi id="alg1.l16.m1.1.1.2.2" xref="alg1.l16.m1.1.1.2.2.cmml">p</mi><mi id="alg1.l16.m1.1.1.2.3" xref="alg1.l16.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">=</mo><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><msub id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml"><mi id="alg1.l16.m1.1.1.3.2.2" xref="alg1.l16.m1.1.1.3.2.2.cmml">p</mi><mi id="alg1.l16.m1.1.1.3.2.3" xref="alg1.l16.m1.1.1.3.2.3.cmml">G</mi></msub><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">+</mo><mrow id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="alg1.l16.m1.1.1.3.3.2" xref="alg1.l16.m1.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.3.3.1" xref="alg1.l16.m1.1.1.3.3.1.cmml">​</mo><msub id="alg1.l16.m1.1.1.3.3.3" xref="alg1.l16.m1.1.1.3.3.3.cmml"><mi id="alg1.l16.m1.1.1.3.3.3.2" xref="alg1.l16.m1.1.1.3.3.3.2.cmml">p</mi><mi id="alg1.l16.m1.1.1.3.3.3.3" xref="alg1.l16.m1.1.1.3.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><eq id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"></eq><apply id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.2.2">𝑝</ci><ci id="alg1.l16.m1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><plus id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></plus><apply id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.3.2.2">𝑝</ci><ci id="alg1.l16.m1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.3.2.3">𝐺</ci></apply><apply id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3"><times id="alg1.l16.m1.1.1.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3.1"></times><ci id="alg1.l16.m1.1.1.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.2">Δ</ci><apply id="alg1.l16.m1.1.1.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.3.3.1.cmml" xref="alg1.l16.m1.1.1.3.3.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.3.3.2.cmml" xref="alg1.l16.m1.1.1.3.3.3.2">𝑝</ci><ci id="alg1.l16.m1.1.1.3.3.3.3.cmml" xref="alg1.l16.m1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">p_{i}=p_{G}+\Delta p_{i}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we conduct extensive experiments aiming at evaluating the generalization and personalization capability of FedPGP in scenarios of heterogeneous data distribution.</p>
</div>
<section id="S4.SS1" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets and Data Heterogeneity.</span>
Following previous research <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>, <a href="#bib.bib17" title="" class="ltx_ref">b</a>)</cite>, we selected five datasets to investigate base-to-novel class generalization ability: OxfordPets <cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite>, Flowers102 <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite>, DTD <cite class="ltx_cite ltx_citemacro_citep">(Cimpoi et al., <a href="#bib.bib10" title="" class="ltx_ref">2014</a>)</cite>, Caltech101 <cite class="ltx_cite ltx_citemacro_citep">(Fei-Fei, <a href="#bib.bib13" title="" class="ltx_ref">2004</a>)</cite>, Food101 <cite class="ltx_cite ltx_citemacro_citep">(Bossard et al., <a href="#bib.bib3" title="" class="ltx_ref">2014</a>)</cite>. We equally split the datasets into base and novel classes and utilized the pathological setting by assigning a specific number of non-overlapping base classes to each client.
Each client model is trained on their local classes and evaluated on both local classes, base classes (classes seen on other clients), and novel classes (unseen in the whole training process).
For domain generalization, we evaluate FedPGP on two datasets with multi-domains: DomainNet <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite> with six domains and Office-Caltech10 <cite class="ltx_cite ltx_citemacro_citep">(Gong et al., <a href="#bib.bib15" title="" class="ltx_ref">2012</a>)</cite> with four domains.
Similar to previous research <cite class="ltx_cite ltx_citemacro_citep">(Nguyen et al., <a href="#bib.bib40" title="" class="ltx_ref">2022</a>; Zhang et al., <a href="#bib.bib57" title="" class="ltx_ref">2021</a>)</cite>, we utilize the leave-one-domain-out validation strategy. Each client participating in the federated learning system is assigned data from one of the distinct domains. We pick one domain to serve as the target domain and use the rest as source domains. Each client possesses a distinct source domain for training and then tests its model generalization ability on the whole target domain.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">For evaluation of personalization, beyond the datasets used in base-to-novel class generalization, we employed two additional benchmark datasets: CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib27" title="" class="ltx_ref">2010</a>)</cite> and CIFAR-100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib26" title="" class="ltx_ref">2009</a>)</cite>. We applied the Dirichlet Distribution, as in previous work where the datasets were partitioned randomly among clients using a symmetric Dirichlet distribution. Besides, we employ the Pathlogicacl setting the same as in base-to-novel class generalization with non-overlapping classes across clients.
The Appendix Section <a href="#A1.SS1" title="A.1 Dataset Setup ‣ Appendix A Experimental Details ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a> contains comprehensive information regarding each dataset and provides additional details about the Non-IID settings.</p>
</div>
<figure id="S4.T1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy comparison (<math id="S4.T1.2.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S4.T1.2.m1.1b"><mo id="S4.T1.2.m1.1.1" xref="S4.T1.2.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.m1.1c"><csymbol cd="latexml" id="S4.T1.2.m1.1.1.cmml" xref="S4.T1.2.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.m1.1d">\%</annotation></semantics></math>) on clients’ local classes and Base-to-novel generalization.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.fig1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption">(a) Average over 5 datasets.</figcaption>
<div id="S4.T1.fig1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.5pt,-2.9pt) scale(1.04068603191347,1.04068603191347) ;">
<table id="S4.T1.fig1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.fig1.1.1.1.1" class="ltx_tr">
<th id="S4.T1.fig1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T1.fig1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="S4.T1.fig1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="S4.T1.fig1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="S4.T1.fig1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.fig1.1.1.2.1" class="ltx_tr">
<th id="S4.T1.fig1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T1.fig1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.18</td>
<td id="S4.T1.fig1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.83</td>
<td id="S4.T1.fig1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig1.1.1.2.1.4.1" class="ltx_text ltx_font_bold">83.25</span></td>
<td id="S4.T1.fig1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.72</td>
</tr>
<tr id="S4.T1.fig1.1.1.3.2" class="ltx_tr">
<th id="S4.T1.fig1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T1.fig1.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.28</td>
<td id="S4.T1.fig1.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.40</td>
<td id="S4.T1.fig1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.16</td>
<td id="S4.T1.fig1.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.55</td>
</tr>
<tr id="S4.T1.fig1.1.1.4.3" class="ltx_tr">
<th id="S4.T1.fig1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</th>
<td id="S4.T1.fig1.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.00</td>
<td id="S4.T1.fig1.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.65</td>
<td id="S4.T1.fig1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.53</td>
<td id="S4.T1.fig1.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.46</td>
</tr>
<tr id="S4.T1.fig1.1.1.5.4" class="ltx_tr">
<th id="S4.T1.fig1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T1.fig1.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.84</td>
<td id="S4.T1.fig1.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.04</td>
<td id="S4.T1.fig1.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.40</td>
<td id="S4.T1.fig1.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.78</td>
</tr>
<tr id="S4.T1.fig1.1.1.6.5" class="ltx_tr">
<th id="S4.T1.fig1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMaPLe</th>
<td id="S4.T1.fig1.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.81</td>
<td id="S4.T1.fig1.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.90</td>
<td id="S4.T1.fig1.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.49</td>
<td id="S4.T1.fig1.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.56</td>
</tr>
<tr id="S4.T1.fig1.1.1.7.6" class="ltx_tr">
<th id="S4.T1.fig1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedCoCoOp</th>
<td id="S4.T1.fig1.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.01</td>
<td id="S4.T1.fig1.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.08</td>
<td id="S4.T1.fig1.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.4</td>
<td id="S4.T1.fig1.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.35</td>
</tr>
<tr id="S4.T1.fig1.1.1.8.7" class="ltx_tr">
<th id="S4.T1.fig1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T1.fig1.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig1.1.1.8.7.2.1" class="ltx_text ltx_font_bold">95.67</span></td>
<td id="S4.T1.fig1.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig1.1.1.8.7.3.1" class="ltx_text ltx_font_bold">85.69</span></td>
<td id="S4.T1.fig1.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.75</td>
<td id="S4.T1.fig1.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig1.1.1.8.7.5.1" class="ltx_text ltx_font_bold">87.33</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.fig2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption">(b) OxfordPets.</figcaption>
<div id="S4.T1.fig2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.5pt,-2.9pt) scale(1.04068603191347,1.04068603191347) ;">
<table id="S4.T1.fig2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.fig2.1.1.1.1" class="ltx_tr">
<th id="S4.T1.fig2.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T1.fig2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="S4.T1.fig2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="S4.T1.fig2.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="S4.T1.fig2.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.fig2.1.1.2.1" class="ltx_tr">
<th id="S4.T1.fig2.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T1.fig2.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.34</td>
<td id="S4.T1.fig2.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.31</td>
<td id="S4.T1.fig2.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.86</td>
<td id="S4.T1.fig2.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.70</td>
</tr>
<tr id="S4.T1.fig2.1.1.3.2" class="ltx_tr">
<th id="S4.T1.fig2.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T1.fig2.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.33</td>
<td id="S4.T1.fig2.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.51</td>
<td id="S4.T1.fig2.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.92</td>
<td id="S4.T1.fig2.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.90</td>
</tr>
<tr id="S4.T1.fig2.1.1.4.3" class="ltx_tr">
<th id="S4.T1.fig2.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</th>
<td id="S4.T1.fig2.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.12</td>
<td id="S4.T1.fig2.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.16</td>
<td id="S4.T1.fig2.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.89</td>
<td id="S4.T1.fig2.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.03</td>
</tr>
<tr id="S4.T1.fig2.1.1.5.4" class="ltx_tr">
<th id="S4.T1.fig2.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T1.fig2.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.95</td>
<td id="S4.T1.fig2.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.24</td>
<td id="S4.T1.fig2.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.25</td>
<td id="S4.T1.fig2.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.10</td>
</tr>
<tr id="S4.T1.fig2.1.1.6.5" class="ltx_tr">
<th id="S4.T1.fig2.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMaPLe</th>
<td id="S4.T1.fig2.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.75</td>
<td id="S4.T1.fig2.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.53</td>
<td id="S4.T1.fig2.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig2.1.1.6.5.4.1" class="ltx_text ltx_font_bold">97.45</span></td>
<td id="S4.T1.fig2.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.55</td>
</tr>
<tr id="S4.T1.fig2.1.1.7.6" class="ltx_tr">
<th id="S4.T1.fig2.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedCoCoOp</th>
<td id="S4.T1.fig2.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.02</td>
<td id="S4.T1.fig2.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.01</td>
<td id="S4.T1.fig2.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.25</td>
<td id="S4.T1.fig2.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.42</td>
</tr>
<tr id="S4.T1.fig2.1.1.8.7" class="ltx_tr">
<th id="S4.T1.fig2.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T1.fig2.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig2.1.1.8.7.2.1" class="ltx_text ltx_font_bold">96.65</span></td>
<td id="S4.T1.fig2.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig2.1.1.8.7.3.1" class="ltx_text ltx_font_bold">95.87</span></td>
<td id="S4.T1.fig2.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.33</td>
<td id="S4.T1.fig2.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig2.1.1.8.7.5.1" class="ltx_text ltx_font_bold">96.61</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.fig3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption">(c) Flowers102.</figcaption>
<div id="S4.T1.fig3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.5pt,-2.9pt) scale(1.04068603191347,1.04068603191347) ;">
<table id="S4.T1.fig3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.fig3.1.1.1.1" class="ltx_tr">
<th id="S4.T1.fig3.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T1.fig3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="S4.T1.fig3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="S4.T1.fig3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="S4.T1.fig3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.fig3.1.1.2.1" class="ltx_tr">
<th id="S4.T1.fig3.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T1.fig3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.69</td>
<td id="S4.T1.fig3.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.85</td>
<td id="S4.T1.fig3.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig3.1.1.2.1.4.1" class="ltx_text ltx_font_bold">77.23</span></td>
<td id="S4.T1.fig3.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.01</td>
</tr>
<tr id="S4.T1.fig3.1.1.3.2" class="ltx_tr">
<th id="S4.T1.fig3.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T1.fig3.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.39</td>
<td id="S4.T1.fig3.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.91</td>
<td id="S4.T1.fig3.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.47</td>
<td id="S4.T1.fig3.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.54</td>
</tr>
<tr id="S4.T1.fig3.1.1.4.3" class="ltx_tr">
<th id="S4.T1.fig3.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</th>
<td id="S4.T1.fig3.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.32</td>
<td id="S4.T1.fig3.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.19</td>
<td id="S4.T1.fig3.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.1</td>
<td id="S4.T1.fig3.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.96</td>
</tr>
<tr id="S4.T1.fig3.1.1.5.4" class="ltx_tr">
<th id="S4.T1.fig3.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T1.fig3.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.73</td>
<td id="S4.T1.fig3.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.06</td>
<td id="S4.T1.fig3.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.09</td>
<td id="S4.T1.fig3.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.75</td>
</tr>
<tr id="S4.T1.fig3.1.1.6.5" class="ltx_tr">
<th id="S4.T1.fig3.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMaPLe</th>
<td id="S4.T1.fig3.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.89</td>
<td id="S4.T1.fig3.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.49</td>
<td id="S4.T1.fig3.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.46</td>
<td id="S4.T1.fig3.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.71</td>
</tr>
<tr id="S4.T1.fig3.1.1.7.6" class="ltx_tr">
<th id="S4.T1.fig3.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedCoCoOp</th>
<td id="S4.T1.fig3.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.57</td>
<td id="S4.T1.fig3.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.88</td>
<td id="S4.T1.fig3.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.39</td>
<td id="S4.T1.fig3.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.4</td>
</tr>
<tr id="S4.T1.fig3.1.1.8.7" class="ltx_tr">
<th id="S4.T1.fig3.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T1.fig3.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig3.1.1.8.7.2.1" class="ltx_text ltx_font_bold">99.68</span></td>
<td id="S4.T1.fig3.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig3.1.1.8.7.3.1" class="ltx_text ltx_font_bold">78.48</span></td>
<td id="S4.T1.fig3.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.11</td>
<td id="S4.T1.fig3.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig3.1.1.8.7.5.1" class="ltx_text ltx_font_bold">83.13</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.fig4" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption">(d) DTD.</figcaption>
<div id="S4.T1.fig4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.5pt,-2.9pt) scale(1.04068603191347,1.04068603191347) ;">
<table id="S4.T1.fig4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.fig4.1.1.1.1" class="ltx_tr">
<th id="S4.T1.fig4.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T1.fig4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="S4.T1.fig4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="S4.T1.fig4.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="S4.T1.fig4.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.fig4.1.1.2.1" class="ltx_tr">
<th id="S4.T1.fig4.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T1.fig4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.79</td>
<td id="S4.T1.fig4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">54.62</td>
<td id="S4.T1.fig4.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig4.1.1.2.1.4.1" class="ltx_text ltx_font_bold">58.20</span></td>
<td id="S4.T1.fig4.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.47</td>
</tr>
<tr id="S4.T1.fig4.1.1.3.2" class="ltx_tr">
<th id="S4.T1.fig4.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T1.fig4.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.38</td>
<td id="S4.T1.fig4.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">39.2</td>
<td id="S4.T1.fig4.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">37.65</td>
<td id="S4.T1.fig4.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">47.13</td>
</tr>
<tr id="S4.T1.fig4.1.1.4.3" class="ltx_tr">
<th id="S4.T1.fig4.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</th>
<td id="S4.T1.fig4.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.71</td>
<td id="S4.T1.fig4.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.41</td>
<td id="S4.T1.fig4.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.28</td>
<td id="S4.T1.fig4.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.44</td>
</tr>
<tr id="S4.T1.fig4.1.1.5.4" class="ltx_tr">
<th id="S4.T1.fig4.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T1.fig4.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.07</td>
<td id="S4.T1.fig4.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig4.1.1.5.4.3.1" class="ltx_text ltx_font_bold">71.84</span></td>
<td id="S4.T1.fig4.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.20</td>
<td id="S4.T1.fig4.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.37</td>
</tr>
<tr id="S4.T1.fig4.1.1.6.5" class="ltx_tr">
<th id="S4.T1.fig4.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMaPLe</th>
<td id="S4.T1.fig4.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">78.37</td>
<td id="S4.T1.fig4.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.35</td>
<td id="S4.T1.fig4.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.85</td>
<td id="S4.T1.fig4.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.26</td>
</tr>
<tr id="S4.T1.fig4.1.1.7.6" class="ltx_tr">
<th id="S4.T1.fig4.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedCoCoOp</th>
<td id="S4.T1.fig4.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">72.61</td>
<td id="S4.T1.fig4.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">68.20</td>
<td id="S4.T1.fig4.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">54.4</td>
<td id="S4.T1.fig4.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.08</td>
</tr>
<tr id="S4.T1.fig4.1.1.8.7" class="ltx_tr">
<th id="S4.T1.fig4.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T1.fig4.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig4.1.1.8.7.2.1" class="ltx_text ltx_font_bold">89.07</span></td>
<td id="S4.T1.fig4.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.65</td>
<td id="S4.T1.fig4.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.25</td>
<td id="S4.T1.fig4.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig4.1.1.8.7.5.1" class="ltx_text ltx_font_bold">68.15</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.fig5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption">(e) Caltech101.</figcaption>
<div id="S4.T1.fig5.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.5pt,-2.9pt) scale(1.04068603191347,1.04068603191347) ;">
<table id="S4.T1.fig5.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.fig5.1.1.1.1" class="ltx_tr">
<th id="S4.T1.fig5.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T1.fig5.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="S4.T1.fig5.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="S4.T1.fig5.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="S4.T1.fig5.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.fig5.1.1.2.1" class="ltx_tr">
<th id="S4.T1.fig5.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T1.fig5.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.72</td>
<td id="S4.T1.fig5.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.96</td>
<td id="S4.T1.fig5.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.99</td>
<td id="S4.T1.fig5.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.54</td>
</tr>
<tr id="S4.T1.fig5.1.1.3.2" class="ltx_tr">
<th id="S4.T1.fig5.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T1.fig5.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">99.39</td>
<td id="S4.T1.fig5.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.37</td>
<td id="S4.T1.fig5.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.12</td>
<td id="S4.T1.fig5.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.22</td>
</tr>
<tr id="S4.T1.fig5.1.1.4.3" class="ltx_tr">
<th id="S4.T1.fig5.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</th>
<td id="S4.T1.fig5.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.04</td>
<td id="S4.T1.fig5.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.27</td>
<td id="S4.T1.fig5.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.79</td>
<td id="S4.T1.fig5.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.65</td>
</tr>
<tr id="S4.T1.fig5.1.1.5.4" class="ltx_tr">
<th id="S4.T1.fig5.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T1.fig5.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.76</td>
<td id="S4.T1.fig5.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig5.1.1.5.4.3.1" class="ltx_text ltx_font_bold">97.34</span></td>
<td id="S4.T1.fig5.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.99</td>
<td id="S4.T1.fig5.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.30</td>
</tr>
<tr id="S4.T1.fig5.1.1.6.5" class="ltx_tr">
<th id="S4.T1.fig5.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMaPLe</th>
<td id="S4.T1.fig5.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.47</td>
<td id="S4.T1.fig5.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.7</td>
<td id="S4.T1.fig5.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig5.1.1.6.5.4.1" class="ltx_text ltx_font_bold">94.32</span></td>
<td id="S4.T1.fig5.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.82</td>
</tr>
<tr id="S4.T1.fig5.1.1.7.6" class="ltx_tr">
<th id="S4.T1.fig5.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedCoCoOp</th>
<td id="S4.T1.fig5.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.65</td>
<td id="S4.T1.fig5.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.45</td>
<td id="S4.T1.fig5.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.46</td>
<td id="S4.T1.fig5.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.82</td>
</tr>
<tr id="S4.T1.fig5.1.1.8.7" class="ltx_tr">
<th id="S4.T1.fig5.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T1.fig5.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig5.1.1.8.7.2.1" class="ltx_text ltx_font_bold">99.46</span></td>
<td id="S4.T1.fig5.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.09</td>
<td id="S4.T1.fig5.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.62</td>
<td id="S4.T1.fig5.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig5.1.1.8.7.5.1" class="ltx_text ltx_font_bold">96.33</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.fig6" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" style="width:216.8pt;">
<figcaption class="ltx_caption">(f) Food101.</figcaption>
<div id="S4.T1.fig6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:149.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(8.5pt,-2.9pt) scale(1.04068603191347,1.04068603191347) ;">
<table id="S4.T1.fig6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.fig6.1.1.1.1" class="ltx_tr">
<th id="S4.T1.fig6.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T1.fig6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="S4.T1.fig6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="S4.T1.fig6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="S4.T1.fig6.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.fig6.1.1.2.1" class="ltx_tr">
<th id="S4.T1.fig6.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T1.fig6.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.38</td>
<td id="S4.T1.fig6.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.39</td>
<td id="S4.T1.fig6.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig6.1.1.2.1.4.1" class="ltx_text ltx_font_bold">89.98</span></td>
<td id="S4.T1.fig6.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.58</td>
</tr>
<tr id="S4.T1.fig6.1.1.3.2" class="ltx_tr">
<th id="S4.T1.fig6.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T1.fig6.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig6.1.1.3.2.2.1" class="ltx_text ltx_font_bold">93.92</span></td>
<td id="S4.T1.fig6.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.99</td>
<td id="S4.T1.fig6.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.62</td>
<td id="S4.T1.fig6.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.92</td>
</tr>
<tr id="S4.T1.fig6.1.1.4.3" class="ltx_tr">
<th id="S4.T1.fig6.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</th>
<td id="S4.T1.fig6.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.79</td>
<td id="S4.T1.fig6.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.22</td>
<td id="S4.T1.fig6.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.6</td>
<td id="S4.T1.fig6.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.19</td>
</tr>
<tr id="S4.T1.fig6.1.1.5.4" class="ltx_tr">
<th id="S4.T1.fig6.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T1.fig6.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.68</td>
<td id="S4.T1.fig6.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.72</td>
<td id="S4.T1.fig6.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.49</td>
<td id="S4.T1.fig6.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.29</td>
</tr>
<tr id="S4.T1.fig6.1.1.6.5" class="ltx_tr">
<th id="S4.T1.fig6.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedMaPLe</th>
<td id="S4.T1.fig6.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.59</td>
<td id="S4.T1.fig6.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig6.1.1.6.5.3.1" class="ltx_text ltx_font_bold">89.43</span></td>
<td id="S4.T1.fig6.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.38</td>
<td id="S4.T1.fig6.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.80</td>
</tr>
<tr id="S4.T1.fig6.1.1.7.6" class="ltx_tr">
<th id="S4.T1.fig6.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedCoCoOp</th>
<td id="S4.T1.fig6.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.18</td>
<td id="S4.T1.fig6.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.86</td>
<td id="S4.T1.fig6.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.51</td>
<td id="S4.T1.fig6.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.84</td>
</tr>
<tr id="S4.T1.fig6.1.1.8.7" class="ltx_tr">
<th id="S4.T1.fig6.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T1.fig6.1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.51</td>
<td id="S4.T1.fig6.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.37</td>
<td id="S4.T1.fig6.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">88.44</td>
<td id="S4.T1.fig6.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T1.fig6.1.1.8.7.5.1" class="ltx_text ltx_font_bold">90.04</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</div>
</div>
</figure>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines.</span>
For generalization, we compare FedPGP with (i) Zero-shot CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite> with hand-crafted text prompt template, e.g., “a photo of a [class]” (ii) CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite> with learnable prompt vectors replacing hand-crafted text prompts trained on each client locally. (iii) PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite> with unified prompt vectors learned across clients via FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite> collectively. For personalization, we consider (iv) pFedPrompt <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>)</cite> which learns a unified prompt with personalized attention modules for each client and four baselines introduced in <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>)</cite>, which are derived from traditional personalized federated learning techniques: (v) PromptFL+FT <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>, (vi) Prompt+Per <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>, (vii) Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite> and Prompt+AMP <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The average classification accuracy using leave-one-domain-out validation on Offica-Caltech10 and DomainNet.</figcaption>
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:79.9pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-127.6pt,23.3pt) scale(0.62942174070869,0.62942174070869) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">Datasets</th>
<th id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;" colspan="5">Office-Caltech10</th>
<th id="S4.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;" colspan="7">DomainNet</th>
</tr>
<tr id="S4.T2.1.1.2.2" class="ltx_tr">
<th id="S4.T2.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">Domains</th>
<th id="S4.T2.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">A</th>
<th id="S4.T2.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">C</th>
<th id="S4.T2.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">D</th>
<th id="S4.T2.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">W</th>
<th id="S4.T2.1.1.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">Avg</th>
<th id="S4.T2.1.1.2.2.7" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">C</th>
<th id="S4.T2.1.1.2.2.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">I</th>
<th id="S4.T2.1.1.2.2.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">P</th>
<th id="S4.T2.1.1.2.2.10" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">Q</th>
<th id="S4.T2.1.1.2.2.11" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">R</th>
<th id="S4.T2.1.1.2.2.12" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">S</th>
<th id="S4.T2.1.1.2.2.13" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.3.1" class="ltx_tr">
<td id="S4.T2.1.1.3.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</td>
<td id="S4.T2.1.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">19.40</td>
<td id="S4.T2.1.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">18.32</td>
<td id="S4.T2.1.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">21.87</td>
<td id="S4.T2.1.1.3.1.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">18.59</td>
<td id="S4.T2.1.1.3.1.6" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">19.55</td>
<td id="S4.T2.1.1.3.1.7" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">49.89</td>
<td id="S4.T2.1.1.3.1.8" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">47.23</td>
<td id="S4.T2.1.1.3.1.9" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">53.61</td>
<td id="S4.T2.1.1.3.1.10" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">32.10</td>
<td id="S4.T2.1.1.3.1.11" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">48.19</td>
<td id="S4.T2.1.1.3.1.12" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">50.79</td>
<td id="S4.T2.1.1.3.1.13" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">46.96</td>
</tr>
<tr id="S4.T2.1.1.4.2" class="ltx_tr">
<td id="S4.T2.1.1.4.2.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</td>
<td id="S4.T2.1.1.4.2.2" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">41.54</td>
<td id="S4.T2.1.1.4.2.3" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">15.55</td>
<td id="S4.T2.1.1.4.2.4" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">56.04</td>
<td id="S4.T2.1.1.4.2.5" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">43.60</td>
<td id="S4.T2.1.1.4.2.6" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">39.18</td>
<td id="S4.T2.1.1.4.2.7" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">83.42</td>
<td id="S4.T2.1.1.4.2.8" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">53.28</td>
<td id="S4.T2.1.1.4.2.9" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">80.80</td>
<td id="S4.T2.1.1.4.2.10" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">49.41</td>
<td id="S4.T2.1.1.4.2.11" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">75.18</td>
<td id="S4.T2.1.1.4.2.12" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">82.88</td>
<td id="S4.T2.1.1.4.2.13" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">70.83</td>
</tr>
<tr id="S4.T2.1.1.5.3" class="ltx_tr">
<td id="S4.T2.1.1.5.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib17" title="" class="ltx_ref">2023b</a>)</cite>
</td>
<td id="S4.T2.1.1.5.3.2" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">96.34</td>
<td id="S4.T2.1.1.5.3.3" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">91.57</td>
<td id="S4.T2.1.1.5.3.4" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">97.96</td>
<td id="S4.T2.1.1.5.3.5" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">98.30</td>
<td id="S4.T2.1.1.5.3.6" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">96.04</td>
<td id="S4.T2.1.1.5.3.7" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">95.28</td>
<td id="S4.T2.1.1.5.3.8" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">73.72</td>
<td id="S4.T2.1.1.5.3.9" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">94.50</td>
<td id="S4.T2.1.1.5.3.10" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">61.60</td>
<td id="S4.T2.1.1.5.3.11" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">95.72</td>
<td id="S4.T2.1.1.5.3.12" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">95.43</td>
<td id="S4.T2.1.1.5.3.13" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">86.04</td>
</tr>
<tr id="S4.T2.1.1.6.4" class="ltx_tr">
<td id="S4.T2.1.1.6.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</td>
<td id="S4.T2.1.1.6.4.2" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">96.13</td>
<td id="S4.T2.1.1.6.4.3" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.6.4.3.1" class="ltx_text ltx_font_bold">92.52</span></td>
<td id="S4.T2.1.1.6.4.4" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">97.57</td>
<td id="S4.T2.1.1.6.4.5" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">97.96</td>
<td id="S4.T2.1.1.6.4.6" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">96.05</td>
<td id="S4.T2.1.1.6.4.7" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">95.47</td>
<td id="S4.T2.1.1.6.4.8" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">69.44</td>
<td id="S4.T2.1.1.6.4.9" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">94.95</td>
<td id="S4.T2.1.1.6.4.10" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">61.24</td>
<td id="S4.T2.1.1.6.4.11" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">75.18</td>
<td id="S4.T2.1.1.6.4.12" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">95.41</td>
<td id="S4.T2.1.1.6.4.13" class="ltx_td ltx_align_left" style="padding-top:0.6pt;padding-bottom:0.6pt;">81.95</td>
</tr>
<tr id="S4.T2.1.1.7.5" class="ltx_tr">
<td id="S4.T2.1.1.7.5.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">FedPGP</td>
<td id="S4.T2.1.1.7.5.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.2.1" class="ltx_text ltx_font_bold">96.55</span></td>
<td id="S4.T2.1.1.7.5.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">91.92</td>
<td id="S4.T2.1.1.7.5.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.4.1" class="ltx_text ltx_font_bold">98.93</span></td>
<td id="S4.T2.1.1.7.5.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.5.1" class="ltx_text ltx_font_bold">98.75</span></td>
<td id="S4.T2.1.1.7.5.6" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.6.1" class="ltx_text ltx_font_bold">96.54</span></td>
<td id="S4.T2.1.1.7.5.7" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.7.1" class="ltx_text ltx_font_bold">96.45</span></td>
<td id="S4.T2.1.1.7.5.8" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.8.1" class="ltx_text ltx_font_bold">74.46</span></td>
<td id="S4.T2.1.1.7.5.9" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.9.1" class="ltx_text ltx_font_bold">95.43</span></td>
<td id="S4.T2.1.1.7.5.10" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.10.1" class="ltx_text ltx_font_bold">62.12</span></td>
<td id="S4.T2.1.1.7.5.11" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.11.1" class="ltx_text ltx_font_bold">96.06</span></td>
<td id="S4.T2.1.1.7.5.12" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.12.1" class="ltx_text ltx_font_bold">96.05</span></td>
<td id="S4.T2.1.1.7.5.13" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T2.1.1.7.5.13.1" class="ltx_text ltx_font_bold">86.76</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Accuracy comparison (%) on the Pathological Non-IID setting over 10 clients.</figcaption>
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:381.6pt;height:100.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-119.7pt,31.2pt) scale(0.614499080330152,0.614499080330152) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.1.1.1.1" class="ltx_tr">
<th id="S4.T3.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">Methods</th>
<th id="S4.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">OxfordPets</th>
<th id="S4.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">Flowers102</th>
<th id="S4.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">DTD</th>
<th id="S4.T3.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">Caltech101</th>
<th id="S4.T3.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.6pt;padding-bottom:0.6pt;">Food101</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.1.1.2.1" class="ltx_tr">
<th id="S4.T3.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T3.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">83.21±1.30</td>
<td id="S4.T3.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">70.14±0.76</td>
<td id="S4.T3.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">44.23±0.63</td>
<td id="S4.T3.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">87.37±0.44</td>
<td id="S4.T3.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">70.43±2.42</td>
</tr>
<tr id="S4.T3.1.1.3.2" class="ltx_tr">
<th id="S4.T3.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T3.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">90.79±0.61</td>
<td id="S4.T3.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">72.80±1.14</td>
<td id="S4.T3.1.1.3.2.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">54.11±0.22</td>
<td id="S4.T3.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">89.70±1.99</td>
<td id="S4.T3.1.1.3.2.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">77.31±1.64</td>
</tr>
<tr id="S4.T3.1.1.4.3" class="ltx_tr">
<th id="S4.T3.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">PromptFL+FT <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T3.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">91.23±0.50</td>
<td id="S4.T3.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">72.31±0.91</td>
<td id="S4.T3.1.1.4.3.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">53.74±1.36</td>
<td id="S4.T3.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">89.70±0.25</td>
<td id="S4.T3.1.1.4.3.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">77.16±1.56</td>
</tr>
<tr id="S4.T3.1.1.5.4" class="ltx_tr">
<th id="S4.T3.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">Prompt+PER <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib2" title="" class="ltx_ref">2019</a>)</cite>
</th>
<td id="S4.T3.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">89.50±1.62</td>
<td id="S4.T3.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">72.11±1.35</td>
<td id="S4.T3.1.1.5.4.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">50.23±0.82</td>
<td id="S4.T3.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">86.72±1.45</td>
<td id="S4.T3.1.1.5.4.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">71.29±1.87</td>
</tr>
<tr id="S4.T3.1.1.6.5" class="ltx_tr">
<th id="S4.T3.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T3.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">89.24±0.41</td>
<td id="S4.T3.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">66.40±0.29</td>
<td id="S4.T3.1.1.6.5.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">44.26±1.11</td>
<td id="S4.T3.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">89.41±0.55</td>
<td id="S4.T3.1.1.6.5.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">76.24±1.94</td>
</tr>
<tr id="S4.T3.1.1.7.6" class="ltx_tr">
<th id="S4.T3.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">Prompt+AMP <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib20" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T3.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">80.21±0.44</td>
<td id="S4.T3.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">69.10±0.13</td>
<td id="S4.T3.1.1.7.6.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">47.16±0.92</td>
<td id="S4.T3.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">87.31±1.60</td>
<td id="S4.T3.1.1.7.6.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">74.48±1.71</td>
</tr>
<tr id="S4.T3.1.1.8.7" class="ltx_tr">
<th id="S4.T3.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.6pt;padding-bottom:0.6pt;">pFedPrompt <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>)</cite>
</th>
<td id="S4.T3.1.1.8.7.2" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">91.84±0.41</td>
<td id="S4.T3.1.1.8.7.3" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">86.46±0.15</td>
<td id="S4.T3.1.1.8.7.4" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">77.14±0.09</td>
<td id="S4.T3.1.1.8.7.5" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">96.54±1.31</td>
<td id="S4.T3.1.1.8.7.6" class="ltx_td ltx_align_center" style="padding-top:0.6pt;padding-bottom:0.6pt;">92.26±1.34</td>
</tr>
<tr id="S4.T3.1.1.9.8" class="ltx_tr">
<th id="S4.T3.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;">FedPGP</th>
<td id="S4.T3.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T3.1.1.9.8.2.1" class="ltx_text ltx_font_bold">98.96±0.42</span></td>
<td id="S4.T3.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T3.1.1.9.8.3.1" class="ltx_text ltx_font_bold">99.29±0.03</span></td>
<td id="S4.T3.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T3.1.1.9.8.4.1" class="ltx_text ltx_font_bold">91.52±0.41</span></td>
<td id="S4.T3.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T3.1.1.9.8.5.1" class="ltx_text ltx_font_bold">98.90±0.19</span></td>
<td id="S4.T3.1.1.9.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.6pt;padding-bottom:0.6pt;"><span id="S4.T3.1.1.9.8.6.1" class="ltx_text ltx_font_bold">95.52±0.15</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.16" class="ltx_p"><span id="S4.SS1.p4.16.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
All methods presented in this paper are based on a frozen CLIP using two backbones, ResNet50 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib18" title="" class="ltx_ref">2016</a>)</cite> and ViT-B16 <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, defaulting to ViT-B16 if not explicitly specified. In federated learning, we set the client’s local training epoch <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">E</mi><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">E=1</annotation></semantics></math> and communication round <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="T=150" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">T</mi><mo id="S4.SS1.p4.2.m2.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><eq id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1"></eq><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝑇</ci><cn type="integer" id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">T=150</annotation></semantics></math> with <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">N</mi><mo id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><eq id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1"></eq><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝑁</ci><cn type="integer" id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">N=100</annotation></semantics></math> clients and partition rate <math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="r=10\%" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mrow id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml"><mi id="S4.SS1.p4.4.m4.1.1.2" xref="S4.SS1.p4.4.m4.1.1.2.cmml">r</mi><mo id="S4.SS1.p4.4.m4.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.4.m4.1.1.3" xref="S4.SS1.p4.4.m4.1.1.3.cmml"><mn id="S4.SS1.p4.4.m4.1.1.3.2" xref="S4.SS1.p4.4.m4.1.1.3.2.cmml">10</mn><mo id="S4.SS1.p4.4.m4.1.1.3.1" xref="S4.SS1.p4.4.m4.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><apply id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1"><eq id="S4.SS1.p4.4.m4.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1"></eq><ci id="S4.SS1.p4.4.m4.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.2">𝑟</ci><apply id="S4.SS1.p4.4.m4.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.3"><csymbol cd="latexml" id="S4.SS1.p4.4.m4.1.1.3.1.cmml" xref="S4.SS1.p4.4.m4.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS1.p4.4.m4.1.1.3.2.cmml" xref="S4.SS1.p4.4.m4.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">r=10\%</annotation></semantics></math> for CIFAR-10/CIFAR-100 datasets. Besides, we consider training epoch <math id="S4.SS1.p4.5.m5.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S4.SS1.p4.5.m5.1a"><mrow id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">E</mi><mo id="S4.SS1.p4.5.m5.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><eq id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1"></eq><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">𝐸</ci><cn type="integer" id="S4.SS1.p4.5.m5.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">E=2</annotation></semantics></math> and communication round <math id="S4.SS1.p4.6.m6.1" class="ltx_Math" alttext="T=25" display="inline"><semantics id="S4.SS1.p4.6.m6.1a"><mrow id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.2" xref="S4.SS1.p4.6.m6.1.1.2.cmml">T</mi><mo id="S4.SS1.p4.6.m6.1.1.1" xref="S4.SS1.p4.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.6.m6.1.1.3" xref="S4.SS1.p4.6.m6.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><apply id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1"><eq id="S4.SS1.p4.6.m6.1.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1.1"></eq><ci id="S4.SS1.p4.6.m6.1.1.2.cmml" xref="S4.SS1.p4.6.m6.1.1.2">𝑇</ci><cn type="integer" id="S4.SS1.p4.6.m6.1.1.3.cmml" xref="S4.SS1.p4.6.m6.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">T=25</annotation></semantics></math> with client numbers <math id="S4.SS1.p4.7.m7.1" class="ltx_Math" alttext="N=10" display="inline"><semantics id="S4.SS1.p4.7.m7.1a"><mrow id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml"><mi id="S4.SS1.p4.7.m7.1.1.2" xref="S4.SS1.p4.7.m7.1.1.2.cmml">N</mi><mo id="S4.SS1.p4.7.m7.1.1.1" xref="S4.SS1.p4.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.7.m7.1.1.3" xref="S4.SS1.p4.7.m7.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m7.1b"><apply id="S4.SS1.p4.7.m7.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1"><eq id="S4.SS1.p4.7.m7.1.1.1.cmml" xref="S4.SS1.p4.7.m7.1.1.1"></eq><ci id="S4.SS1.p4.7.m7.1.1.2.cmml" xref="S4.SS1.p4.7.m7.1.1.2">𝑁</ci><cn type="integer" id="S4.SS1.p4.7.m7.1.1.3.cmml" xref="S4.SS1.p4.7.m7.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m7.1c">N=10</annotation></semantics></math> and a full partition rate, i.e., <math id="S4.SS1.p4.8.m8.1" class="ltx_Math" alttext="r=100\%" display="inline"><semantics id="S4.SS1.p4.8.m8.1a"><mrow id="S4.SS1.p4.8.m8.1.1" xref="S4.SS1.p4.8.m8.1.1.cmml"><mi id="S4.SS1.p4.8.m8.1.1.2" xref="S4.SS1.p4.8.m8.1.1.2.cmml">r</mi><mo id="S4.SS1.p4.8.m8.1.1.1" xref="S4.SS1.p4.8.m8.1.1.1.cmml">=</mo><mrow id="S4.SS1.p4.8.m8.1.1.3" xref="S4.SS1.p4.8.m8.1.1.3.cmml"><mn id="S4.SS1.p4.8.m8.1.1.3.2" xref="S4.SS1.p4.8.m8.1.1.3.2.cmml">100</mn><mo id="S4.SS1.p4.8.m8.1.1.3.1" xref="S4.SS1.p4.8.m8.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.8.m8.1b"><apply id="S4.SS1.p4.8.m8.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1"><eq id="S4.SS1.p4.8.m8.1.1.1.cmml" xref="S4.SS1.p4.8.m8.1.1.1"></eq><ci id="S4.SS1.p4.8.m8.1.1.2.cmml" xref="S4.SS1.p4.8.m8.1.1.2">𝑟</ci><apply id="S4.SS1.p4.8.m8.1.1.3.cmml" xref="S4.SS1.p4.8.m8.1.1.3"><csymbol cd="latexml" id="S4.SS1.p4.8.m8.1.1.3.1.cmml" xref="S4.SS1.p4.8.m8.1.1.3.1">percent</csymbol><cn type="integer" id="S4.SS1.p4.8.m8.1.1.3.2.cmml" xref="S4.SS1.p4.8.m8.1.1.3.2">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.8.m8.1c">r=100\%</annotation></semantics></math> for other datasets. The low-rank decomposition bottleneck is set to <math id="S4.SS1.p4.9.m9.1" class="ltx_Math" alttext="b=8" display="inline"><semantics id="S4.SS1.p4.9.m9.1a"><mrow id="S4.SS1.p4.9.m9.1.1" xref="S4.SS1.p4.9.m9.1.1.cmml"><mi id="S4.SS1.p4.9.m9.1.1.2" xref="S4.SS1.p4.9.m9.1.1.2.cmml">b</mi><mo id="S4.SS1.p4.9.m9.1.1.1" xref="S4.SS1.p4.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.9.m9.1.1.3" xref="S4.SS1.p4.9.m9.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.9.m9.1b"><apply id="S4.SS1.p4.9.m9.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1"><eq id="S4.SS1.p4.9.m9.1.1.1.cmml" xref="S4.SS1.p4.9.m9.1.1.1"></eq><ci id="S4.SS1.p4.9.m9.1.1.2.cmml" xref="S4.SS1.p4.9.m9.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p4.9.m9.1.1.3.cmml" xref="S4.SS1.p4.9.m9.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.9.m9.1c">b=8</annotation></semantics></math>, and the hyperparameter <math id="S4.SS1.p4.10.m10.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS1.p4.10.m10.1a"><mi id="S4.SS1.p4.10.m10.1.1" xref="S4.SS1.p4.10.m10.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.10.m10.1b"><ci id="S4.SS1.p4.10.m10.1.1.cmml" xref="S4.SS1.p4.10.m10.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.10.m10.1c">\mu</annotation></semantics></math> for the contrastive loss is set to <math id="S4.SS1.p4.11.m11.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S4.SS1.p4.11.m11.1a"><mn id="S4.SS1.p4.11.m11.1.1" xref="S4.SS1.p4.11.m11.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.11.m11.1b"><cn type="integer" id="S4.SS1.p4.11.m11.1.1.cmml" xref="S4.SS1.p4.11.m11.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.11.m11.1c">1</annotation></semantics></math>. We employ cosine similarity as the metric function in contrastive loss. For the setting of learnable prompts, the length of prompt vectors <math id="S4.SS1.p4.12.m12.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS1.p4.12.m12.1a"><mi id="S4.SS1.p4.12.m12.1.1" xref="S4.SS1.p4.12.m12.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.12.m12.1b"><ci id="S4.SS1.p4.12.m12.1.1.cmml" xref="S4.SS1.p4.12.m12.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.12.m12.1c">p</annotation></semantics></math> is <math id="S4.SS1.p4.13.m13.1" class="ltx_Math" alttext="16" display="inline"><semantics id="S4.SS1.p4.13.m13.1a"><mn id="S4.SS1.p4.13.m13.1.1" xref="S4.SS1.p4.13.m13.1.1.cmml">16</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.13.m13.1b"><cn type="integer" id="S4.SS1.p4.13.m13.1.1.cmml" xref="S4.SS1.p4.13.m13.1.1">16</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.13.m13.1c">16</annotation></semantics></math> with a dimension of <math id="S4.SS1.p4.14.m14.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS1.p4.14.m14.1a"><mn id="S4.SS1.p4.14.m14.1.1" xref="S4.SS1.p4.14.m14.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.14.m14.1b"><cn type="integer" id="S4.SS1.p4.14.m14.1.1.cmml" xref="S4.SS1.p4.14.m14.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.14.m14.1c">512</annotation></semantics></math>, token position is “end” with “random” initialization. Apart from the few-shot learning, batch sizes are set to <math id="S4.SS1.p4.15.m15.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S4.SS1.p4.15.m15.1a"><mn id="S4.SS1.p4.15.m15.1.1" xref="S4.SS1.p4.15.m15.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.15.m15.1b"><cn type="integer" id="S4.SS1.p4.15.m15.1.1.cmml" xref="S4.SS1.p4.15.m15.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.15.m15.1c">32</annotation></semantics></math> during training and <math id="S4.SS1.p4.16.m16.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S4.SS1.p4.16.m16.1a"><mn id="S4.SS1.p4.16.m16.1.1" xref="S4.SS1.p4.16.m16.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.16.m16.1b"><cn type="integer" id="S4.SS1.p4.16.m16.1.1.cmml" xref="S4.SS1.p4.16.m16.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.16.m16.1c">100</annotation></semantics></math> during testing. Additional implementation details can be found in the Appendix Section <a href="#A1.SS2" title="A.2 Experimental Setup ‣ Appendix A Experimental Details ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Evaluation</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Base-to-Novel Class Generalization.</span>
We evaluated the performance of FedPGP against baselines on their local classes, base classes, and novel classes respectively. We present the harmonic mean (HM) of these three accuracies to demonstrate the overall performance. The experiment results are summarized in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. As indicated in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a), FedPGP achieves the best performances in local classes, highlighting its exceptional personalization capability. Moreover, FedPGP outperforms other methods in both base classes and the harmonic mean while also exhibiting the second-best performance in novel classes. These results show its exceptional capacity for balancing personalization and generalization. CoOp achieves the second-best performance in local classes owing to the pathological setting. However, it cannot effectively generalize its performance to other base classes and new classes. When it comes to FPL, PromptFL and PromptProx sacrifice the personalization capability in local classes to gain better generalization ability.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p"><span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_bold">Leave-One-Domain-Out Generalization.</span>
Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows the average classification accuracy with leave-one-domain-out validation on Office-Caltech10 and DomainNet. As we can see, FedPGP achieves the highest average accuracy and outperforms all baselines across nearly all target domains. Through local prompt tuning, CoOp’s domain generalization capabilities generally surpass those of CLIP.
We notice that FPL enhances the model’s domain generalization power, marking a significant improvement compared to the local approach. Moreover, FedPGP enhances the model’s ability to generalize while accomplishing personalization, which proves the effectiveness of our framework’s design. We provide the detailed classification accuracy on each source domain within the Office-Caltech10 dataset in Table <a href="#S4.T4" title="Table 4 ‣ 4.2 Performance Evaluation ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. Additional experiment results on specific client domain generalization are available in the Appendix Section <a href="#A2.SS1" title="B.1 Detailed Results of Leave-One-Domain-Out Generalization ‣ Appendix B Additional Experimental Results ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.1</span></a>.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The detailed classification accuracy using leave-one-domain-out validation on Offica-Caltech10 dataset.</figcaption>
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:116pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-97.0pt,32.3pt) scale(0.641345554209663,0.641345554209663) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.1.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Datasets</th>
<th id="S4.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="6">Office-Caltech10</th>
</tr>
<tr id="S4.T4.1.1.2.2" class="ltx_tr">
<th id="S4.T4.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Source Domains</th>
<th id="S4.T4.1.1.2.2.2" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="S4.T4.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Amazon</th>
<th id="S4.T4.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Caltech</th>
<th id="S4.T4.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">DSLR</th>
<th id="S4.T4.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Webcam</th>
<th id="S4.T4.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.3.1" class="ltx_tr">
<th id="S4.T4.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="4"><span id="S4.T4.1.1.3.1.1.1" class="ltx_text">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite></span></th>
<th id="S4.T4.1.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Amazon</th>
<td id="S4.T4.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.03</td>
<td id="S4.T4.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">16.49</td>
<td id="S4.T4.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">19.1</td>
<td id="S4.T4.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.54±41.15</td>
</tr>
<tr id="S4.T4.1.1.4.2" class="ltx_tr">
<th id="S4.T4.1.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Caltech</th>
<td id="S4.T4.1.1.4.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">26.89</td>
<td id="S4.T4.1.1.4.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.4.2.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">5.87</td>
<td id="S4.T4.1.1.4.2.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">13.89</td>
<td id="S4.T4.1.1.4.2.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">15.55±10.61</td>
</tr>
<tr id="S4.T4.1.1.5.3" class="ltx_tr">
<th id="S4.T4.1.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DSLR</th>
<td id="S4.T4.1.1.5.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.96</td>
<td id="S4.T4.1.1.5.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.62</td>
<td id="S4.T4.1.1.5.3.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.5.3.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">16.56</td>
<td id="S4.T4.1.1.5.3.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">56.04±35.87</td>
</tr>
<tr id="S4.T4.1.1.6.4" class="ltx_tr">
<th id="S4.T4.1.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Webcam</th>
<td id="S4.T4.1.1.6.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.16</td>
<td id="S4.T4.1.1.6.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.94</td>
<td id="S4.T4.1.1.6.4.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">3.72</td>
<td id="S4.T4.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.6.4.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">43.6±37.05</td>
</tr>
<tr id="S4.T4.1.1.7.5" class="ltx_tr">
<th id="S4.T4.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="4"><span id="S4.T4.1.1.7.5.1.1" class="ltx_text">FedPGP</span></th>
<th id="S4.T4.1.1.7.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Amazon</th>
<td id="S4.T4.1.1.7.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.7.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.45</td>
<td id="S4.T4.1.1.7.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.03</td>
<td id="S4.T4.1.1.7.5.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.18</td>
<td id="S4.T4.1.1.7.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.1.7.5.7.1" class="ltx_text ltx_font_bold">96.55±0.58</span></td>
</tr>
<tr id="S4.T4.1.1.8.6" class="ltx_tr">
<th id="S4.T4.1.1.8.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Caltech</th>
<td id="S4.T4.1.1.8.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.66</td>
<td id="S4.T4.1.1.8.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.8.6.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.92</td>
<td id="S4.T4.1.1.8.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.59</td>
<td id="S4.T4.1.1.8.6.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.1.8.6.6.1" class="ltx_text ltx_font_bold">91.92±4.19</span></td>
</tr>
<tr id="S4.T4.1.1.9.7" class="ltx_tr">
<th id="S4.T4.1.1.9.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">DSLR</th>
<td id="S4.T4.1.1.9.7.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.08</td>
<td id="S4.T4.1.1.9.7.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">99.36</td>
<td id="S4.T4.1.1.9.7.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.9.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">99.36</td>
<td id="S4.T4.1.1.9.7.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.1.9.7.6.1" class="ltx_text ltx_font_bold">98.93±0.74</span></td>
</tr>
<tr id="S4.T4.1.1.10.8" class="ltx_tr">
<th id="S4.T4.1.1.10.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Webcam</th>
<td id="S4.T4.1.1.10.8.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.98</td>
<td id="S4.T4.1.1.10.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.98</td>
<td id="S4.T4.1.1.10.8.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.3</td>
<td id="S4.T4.1.1.10.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="S4.T4.1.1.10.8.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T4.1.1.10.8.6.1" class="ltx_text ltx_font_bold">98.75±0.39</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_bold">Evaluation on Personalization.</span>
We report the performance of FedPGP against baselines in Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, <a href="#S4.T5" title="Table 5 ‣ 4.2 Performance Evaluation ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. To facilitate comparison, we present the results in Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> utilizing ResNet50 as the backbone, aligning with the setting in <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib16" title="" class="ltx_ref">2023a</a>)</cite>. As shown in Table <a href="#S4.T3" title="Table 3 ‣ 4.1 Experimental Setup ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, our FedPGP demonstrates significantly superior performance compared to baseline methods across all datasets. This confirms that our framework’s ability to personalize effectively is successful in addressing extreme non-IID scenarios. Table <a href="#S4.T5" title="Table 5 ‣ 4.2 Performance Evaluation ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the results of FedPGP and baseline methods on CIFAR-10 and CIFAR100 datasets with Dirichlet Non-IID setting over 100 clients with 10% partition. In the scenario with Dirichlet settings and the substantial number of clients, our approach FedPGP consistently demonstrates superior performance compared to the baseline methods. This further emphasizes the effectiveness of our approach.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Accuracy comparison (%) on the Dirichlet Non-IID setting in CIFAR-10 and CIFAR-100 over 100 clients.</figcaption>
<div id="S4.T5.10" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:108.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.5pt,-0.1pt) scale(1.00245886696268,1.00245886696268) ;">
<table id="S4.T5.10.10" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.10.10.11.1" class="ltx_tr">
<th id="S4.T5.10.10.11.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="S4.T5.10.10.11.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">CIFAR-10</th>
<th id="S4.T5.10.10.11.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">CIFAR-100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.2.2.2" class="ltx_tr">
<th id="S4.T5.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>
</th>
<td id="S4.T5.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.52<math id="S4.T5.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.1.1.1.1.m1.1a"><mo id="S4.T5.1.1.1.1.m1.1.1" xref="S4.T5.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T5.1.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.1.m1.1c">\pm</annotation></semantics></math>0.56</td>
<td id="S4.T5.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.83<math id="S4.T5.2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.2.2.2.2.m1.1a"><mo id="S4.T5.2.2.2.2.m1.1.1" xref="S4.T5.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T5.2.2.2.2.m1.1.1.cmml" xref="S4.T5.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.2.2.m1.1c">\pm</annotation></semantics></math>0.49</td>
</tr>
<tr id="S4.T5.4.4.4" class="ltx_tr">
<th id="S4.T5.4.4.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T5.3.3.3.1" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.13<math id="S4.T5.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.3.3.3.1.m1.1a"><mo id="S4.T5.3.3.3.1.m1.1.1" xref="S4.T5.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T5.3.3.3.1.m1.1.1.cmml" xref="S4.T5.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.3.1.m1.1c">\pm</annotation></semantics></math>0.34</td>
<td id="S4.T5.4.4.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.78<math id="S4.T5.4.4.4.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.4.4.4.2.m1.1a"><mo id="S4.T5.4.4.4.2.m1.1.1" xref="S4.T5.4.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.4.2.m1.1b"><csymbol cd="latexml" id="S4.T5.4.4.4.2.m1.1.1.cmml" xref="S4.T5.4.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.4.2.m1.1c">\pm</annotation></semantics></math>0.41</td>
</tr>
<tr id="S4.T5.6.6.6" class="ltx_tr">
<th id="S4.T5.6.6.6.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">PromptFL <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite>
</th>
<td id="S4.T5.5.5.5.1" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.32<math id="S4.T5.5.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.5.5.5.1.m1.1a"><mo id="S4.T5.5.5.5.1.m1.1.1" xref="S4.T5.5.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T5.5.5.5.1.m1.1.1.cmml" xref="S4.T5.5.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.5.5.1.m1.1c">\pm</annotation></semantics></math>0.79</td>
<td id="S4.T5.6.6.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.72<math id="S4.T5.6.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.6.6.6.2.m1.1a"><mo id="S4.T5.6.6.6.2.m1.1.1" xref="S4.T5.6.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.6.6.6.2.m1.1b"><csymbol cd="latexml" id="S4.T5.6.6.6.2.m1.1.1.cmml" xref="S4.T5.6.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.6.6.2.m1.1c">\pm</annotation></semantics></math>0.61</td>
</tr>
<tr id="S4.T5.8.8.8" class="ltx_tr">
<th id="S4.T5.8.8.8.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Prompt+Prox <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib31" title="" class="ltx_ref">2020</a>)</cite>
</th>
<td id="S4.T5.7.7.7.1" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.79<math id="S4.T5.7.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.7.7.7.1.m1.1a"><mo id="S4.T5.7.7.7.1.m1.1.1" xref="S4.T5.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S4.T5.7.7.7.1.m1.1.1.cmml" xref="S4.T5.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.7.7.7.1.m1.1c">\pm</annotation></semantics></math>0.46</td>
<td id="S4.T5.8.8.8.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">71.08<math id="S4.T5.8.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.8.8.8.2.m1.1a"><mo id="S4.T5.8.8.8.2.m1.1.1" xref="S4.T5.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S4.T5.8.8.8.2.m1.1.1.cmml" xref="S4.T5.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.8.8.8.2.m1.1c">\pm</annotation></semantics></math>0.89</td>
</tr>
<tr id="S4.T5.10.10.10" class="ltx_tr">
<th id="S4.T5.10.10.10.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="S4.T5.9.9.9.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T5.9.9.9.1.1" class="ltx_text ltx_font_bold">94.82<math id="S4.T5.9.9.9.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.9.9.9.1.1.m1.1a"><mo id="S4.T5.9.9.9.1.1.m1.1.1" xref="S4.T5.9.9.9.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.9.9.9.1.1.m1.1b"><csymbol cd="latexml" id="S4.T5.9.9.9.1.1.m1.1.1.cmml" xref="S4.T5.9.9.9.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.9.9.9.1.1.m1.1c">\pm</annotation></semantics></math>0.37</span></td>
<td id="S4.T5.10.10.10.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="S4.T5.10.10.10.2.1" class="ltx_text ltx_font_bold">77.44<math id="S4.T5.10.10.10.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.10.10.10.2.1.m1.1a"><mo id="S4.T5.10.10.10.2.1.m1.1.1" xref="S4.T5.10.10.10.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.10.10.10.2.1.m1.1b"><csymbol cd="latexml" id="S4.T5.10.10.10.2.1.m1.1.1.cmml" xref="S4.T5.10.10.10.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.10.10.10.2.1.m1.1c">\pm</annotation></semantics></math>0.15</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.4" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Effect of Parameter <math id="S4.SS3.p1.1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.1.1.m1.1a"><mi id="S4.SS3.p1.1.1.m1.1.1" xref="S4.SS3.p1.1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.1.m1.1b"><ci id="S4.SS3.p1.1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.1.m1.1c">\mu</annotation></semantics></math> of Contrastive Loss</span>
In this subsection, we investigated the impact of the contrastive loss parameter <math id="S4.SS3.p1.2.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.2.m1.1a"><mi id="S4.SS3.p1.2.m1.1.1" xref="S4.SS3.p1.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m1.1b"><ci id="S4.SS3.p1.2.m1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m1.1c">\mu</annotation></semantics></math> in a Pathlogical Non-IID setting across four datasets with varying shot numbers. The results are presented in Figure <a href="#S4.F2" title="Figure 2 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where shows an improvement in test accuracy with an increase in the number of shots.
Upon observation, optimal results are mostly achieved with <math id="S4.SS3.p1.3.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.3.m2.1a"><mi id="S4.SS3.p1.3.m2.1.1" xref="S4.SS3.p1.3.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m2.1b"><ci id="S4.SS3.p1.3.m2.1.1.cmml" xref="S4.SS3.p1.3.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m2.1c">\mu</annotation></semantics></math> set to 1 in experiments, leading to our adoption of <math id="S4.SS3.p1.4.m3.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="S4.SS3.p1.4.m3.1a"><mrow id="S4.SS3.p1.4.m3.1.1" xref="S4.SS3.p1.4.m3.1.1.cmml"><mi id="S4.SS3.p1.4.m3.1.1.2" xref="S4.SS3.p1.4.m3.1.1.2.cmml">μ</mi><mo id="S4.SS3.p1.4.m3.1.1.1" xref="S4.SS3.p1.4.m3.1.1.1.cmml">=</mo><mn id="S4.SS3.p1.4.m3.1.1.3" xref="S4.SS3.p1.4.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m3.1b"><apply id="S4.SS3.p1.4.m3.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1"><eq id="S4.SS3.p1.4.m3.1.1.1.cmml" xref="S4.SS3.p1.4.m3.1.1.1"></eq><ci id="S4.SS3.p1.4.m3.1.1.2.cmml" xref="S4.SS3.p1.4.m3.1.1.2">𝜇</ci><cn type="integer" id="S4.SS3.p1.4.m3.1.1.3.cmml" xref="S4.SS3.p1.4.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m3.1c">\mu=1</annotation></semantics></math> for other experiments.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2405.09771/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="115" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Quantitative comparisons on four datasets across varying shot numbers and parameter <math id="S4.F2.2.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.F2.2.m1.1b"><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.1c"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.1d">\mu</annotation></semantics></math> of contrastive loss in FedPGP over 10 clients.</figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_bold">Effective of Low-rank Adaption</span>
In this subsection, we explored the effectiveness of low-rank adaptation by comparing it with full-rank adaptation. The results of the two methods are shown in Table <a href="#S4.T6" title="Table 6 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. As we can see, full-rank adaptation achieves the best performance on local classes but it completely overwrites the global prompt, resulting in a loss of category-
agnostic knowledge and the generalization capacity. Although low-rank adaptation performance on the local class is below the full-rank adaptation, it significantly outperforms the full-rank adaptation in terms of base-to-novel generalization.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>Accuracy (%) of ablation study on adaption and additional loss for clients’ local classes and Base-to-novel generalization.</figcaption>
<div id="S4.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:89.9pt;vertical-align:-2.4pt;"><span class="ltx_transformed_inner" style="transform:translate(38.4pt,-7.8pt) scale(1.21542336031815,1.21542336031815) ;">
<table id="S4.T6.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.1.1.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Methods</th>
<th id="S4.T6.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Local</th>
<th id="S4.T6.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Base</th>
<th id="S4.T6.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Novel</th>
<th id="S4.T6.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.1.1.2.1" class="ltx_tr">
<th id="S4.T6.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">FedPGP w/o Positive</th>
<td id="S4.T6.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">94.63</td>
<td id="S4.T6.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">84.68</td>
<td id="S4.T6.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">77.75</td>
<td id="S4.T6.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">85.13</td>
</tr>
<tr id="S4.T6.1.1.3.2" class="ltx_tr">
<th id="S4.T6.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedPGP w/ Full-rank Adaption</th>
<td id="S4.T6.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.1.1.3.2.2.1" class="ltx_text ltx_font_bold">98.57</span></td>
<td id="S4.T6.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">48.00</td>
<td id="S4.T6.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">63.40</td>
<td id="S4.T6.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">64.17</td>
</tr>
<tr id="S4.T6.1.1.4.3" class="ltx_tr">
<th id="S4.T6.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">FedPGP</th>
<td id="S4.T6.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">95.67</td>
<td id="S4.T6.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.1.1.4.3.3.1" class="ltx_text ltx_font_bold">85.69</span></td>
<td id="S4.T6.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.1.1.4.3.4.1" class="ltx_text ltx_font_bold">81.75</span></td>
<td id="S4.T6.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;"><span id="S4.T6.1.1.4.3.5.1" class="ltx_text ltx_font_bold">87.33</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Effective of Contrastive Loss</span>
We demonstrate the efficacy of contrastive loss in achieving balance by separately testing the generalization ability of the model without positive pairs and the personalization ability of the model with negative pairs. Table <a href="#S4.T6" title="Table 6 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the performance of the model without knowledge-guidance from CLIP (positive pairs), compared to the performance when the contrastive loss is employed. FedPGP outperforms the model without knowledge-guidance across all three accuracies and the harmonic mean. Table <a href="#S4.T7" title="Table 7 ‣ 4.3 Ablation Study ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows the performance of the model without pushing the representation of global prompt and personalized prompt (negative pairs), compared to the performance when the contrastive loss is employed. The results show the negative pairs enhance the model’s ability to personalize for Non-IID data distribution in federated prompt learning. In general, our ablation study on contrastive loss demonstrates its ability to balance personalization and generalization in federated prompt learning.</p>
</div>
<figure id="S4.T7" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Accuary (%) of ablation study on additional loss for personalization.</figcaption>
<div id="S4.T7.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:55.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(4.2pt,-0.5pt) scale(1.01964685597954,1.01964685597954) ;">
<table id="S4.T7.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T7.1.1.1.1" class="ltx_tr">
<th id="S4.T7.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Methods</th>
<th id="S4.T7.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">OxfordPets</th>
<th id="S4.T7.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Flowers102</th>
<th id="S4.T7.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">DTD</th>
<th id="S4.T7.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Caltech101</th>
<th id="S4.T7.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Food101</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T7.1.1.2.1" class="ltx_tr">
<th id="S4.T7.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">FedPGP w/o Negative</th>
<td id="S4.T7.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">97.65±0.20</td>
<td id="S4.T7.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">98.63±0.11</td>
<td id="S4.T7.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">90.78±0.31</td>
<td id="S4.T7.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">98.48±0.17</td>
<td id="S4.T7.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">94.72±0.18</td>
</tr>
<tr id="S4.T7.1.1.3.2" class="ltx_tr">
<th id="S4.T7.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-left:2.0pt;padding-right:2.0pt;">FedPGP</th>
<td id="S4.T7.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S4.T7.1.1.3.2.2.1" class="ltx_text ltx_font_bold">98.96±0.42</span></td>
<td id="S4.T7.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S4.T7.1.1.3.2.3.1" class="ltx_text ltx_font_bold">99.29±0.03</span></td>
<td id="S4.T7.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S4.T7.1.1.3.2.4.1" class="ltx_text ltx_font_bold">91.52±0.41</span></td>
<td id="S4.T7.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S4.T7.1.1.3.2.5.1" class="ltx_text ltx_font_bold">98.90±0.19</span></td>
<td id="S4.T7.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S4.T7.1.1.3.2.6.1" class="ltx_text ltx_font_bold">95.52±0.15</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we propose a novel approach named FedPGP, which represents a pioneering effort to harmonize personalization and generalization in federated prompt learning. In our approach, each client gains generalization capabilities through knowledge-guidance of CLIP and acquires personalization abilities by adapting the global prompt to a personalized prompt. Further, with low-rank decomposition adaptation and an extra contrastive loss, FedPGP learns a personalized prompt for each client in heterogeneous federated scenarios while preserving the remarkble generalization capacity in pre-trained Vision-Language models.
Extensive experiments on various datasets explored base-to-novel generalization in both unseen categories and domains, showing the superiority of FedPGP in balancing generalization and personalization.
In future work, we aim to explore the theoretical foundations of low-rank adaptation in federated prompt learning.
</p>
</div>
</section>
<section id="S6" class="ltx_section ltx_indent_first">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgement</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This work was supported by NSFC (No.62303319), Shanghai Sailing Program (22YF1428800, 21YF1429400), Shanghai Local College Capacity Building Program (23010503100), Shanghai Frontiers Science Center of Human-centered Artificial Intelligence (ShangHAI), MoE
Key Laboratory of Intelligent Perception and Human Machine Collaboration (ShanghaiTech University), and Shanghai Engineering Research Center of Intelligent Vision and Imaging.</p>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
<section id="Sx1" class="ltx_section ltx_indentfirst">
<h2 class="ltx_title ltx_title_section">Impact Statements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">There are many potential societal consequences of our work, none of which we feel must be specifically highlighted here.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aghajanyan et al. (2020)</span>
<span class="ltx_bibblock">
Aghajanyan, A., Zettlemoyer, L., and Gupta, S.

</span>
<span class="ltx_bibblock">Intrinsic dimensionality explains the effectiveness of language model fine-tuning.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.13255</em>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Arivazhagan, M. G., Aggarwal, V., Singh, A. K., and Choudhary, S.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.00818</em>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bossard et al. (2014)</span>
<span class="ltx_bibblock">
Bossard, L., Guillaumin, M., and Van Gool, L.

</span>
<span class="ltx_bibblock">Food-101–mining discriminative components with random forests.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Computer Vision–ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6-12, 2014, Proceedings, Part VI 13</em>, pp.  446–461. Springer, 2014.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cai et al. (2024)</span>
<span class="ltx_bibblock">
Cai, Z., Shi, Y., Huang, W., and Wang, J.

</span>
<span class="ltx_bibblock">Fed-CO<sub id="bib.bib4.2.1" class="ltx_sub">2</sub>: Cooperation of online and offline models for severe data heterogeneity in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2023)</span>
<span class="ltx_bibblock">
Cao, Y.-T., Shi, Y., Yu, B., Wang, J., and Tao, D.

</span>
<span class="ltx_bibblock">Knowledge-aware federated active learning with non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  22279–22289, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen &amp; Chao (2021)</span>
<span class="ltx_bibblock">
Chen, H.-Y. and Chao, W.-L.

</span>
<span class="ltx_bibblock">On bridging generic and personalized federated learning for image classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.00778</em>, 2021.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020a)</span>
<span class="ltx_bibblock">
Chen, T., Kornblith, S., Norouzi, M., and Hinton, G.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.  1597–1607. PMLR, 2020a.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020b)</span>
<span class="ltx_bibblock">
Chen, X., Fan, H., Girshick, R., and He, K.

</span>
<span class="ltx_bibblock">Improved baselines with momentum contrastive learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.04297</em>, 2020b.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2021)</span>
<span class="ltx_bibblock">
Cheng, G., Chadha, K., and Duchi, J.

</span>
<span class="ltx_bibblock">Fine-tuning is fine in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.07313</em>, 3, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cimpoi et al. (2014)</span>
<span class="ltx_bibblock">
Cimpoi, M., Maji, S., Kokkinos, I., Mohamed, S., and Vedaldi, A.

</span>
<span class="ltx_bibblock">Describing textures in the wild.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  3606–3613, 2014.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. (2021)</span>
<span class="ltx_bibblock">
Collins, L., Hassani, H., Mokhtari, A., and Shakkottai, S.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.  2089–2099. PMLR, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fei-Fei (2004)</span>
<span class="ltx_bibblock">
Fei-Fei, L.

</span>
<span class="ltx_bibblock">Learning generative visual models from few training examples.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Workshop on Generative-Model Based Vision, IEEE Proc. CVPR, 2004</em>, 2004.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. (2023)</span>
<span class="ltx_bibblock">
Feng, C.-M., Li, B., Xu, X., Liu, Y., Fu, H., and Zuo, W.

</span>
<span class="ltx_bibblock">Learning Federated Visual Prompt in Null Space for MRI Reconstruction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  8064–8073, 2023.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al. (2012)</span>
<span class="ltx_bibblock">
Gong, B., Shi, Y., Sha, F., and Grauman, K.

</span>
<span class="ltx_bibblock">Geodesic flow kernel for unsupervised domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2012 IEEE conference on computer vision and pattern recognition</em>, pp.  2066–2073. IEEE, 2012.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2023a)</span>
<span class="ltx_bibblock">
Guo, T., Guo, S., and Wang, J.

</span>
<span class="ltx_bibblock">pFedPrompt: Learning Personalized Prompt for Vision-Language Models in Federated Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACM Web Conference 2023</em>, pp.  1364–1374, 2023a.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2023b)</span>
<span class="ltx_bibblock">
Guo, T., Guo, S., Wang, J., Tang, X., and Xu, W.

</span>
<span class="ltx_bibblock">PromptFL: Let federated participants cooperatively learn prompts instead of models-federated learning in age of foundation model.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Mobile Computing</em>, 2023b.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., and Sun, J.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp.  770–778, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2023)</span>
<span class="ltx_bibblock">
Huang, W., Shi, Y., Cai, Z., and Suzuki, T.

</span>
<span class="ltx_bibblock">Understanding convergence and generalization in federated learning through feature learning theory.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2021)</span>
<span class="ltx_bibblock">
Huang, Y., Chu, L., Zhou, Z., Wang, L., Liu, J., Pei, J., and Zhang, Y.

</span>
<span class="ltx_bibblock">Personalized cross-silo federated learning on non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</em>, volume 35, pp.  7865–7873, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hyeon-Woo et al. (2021)</span>
<span class="ltx_bibblock">
Hyeon-Woo, N., Ye-Bin, M., and Oh, T.-H.

</span>
<span class="ltx_bibblock">Fedpara: Low-rank hadamard product for communication-efficient federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.06098</em>, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong &amp; Hwang (2022)</span>
<span class="ltx_bibblock">
Jeong, W. and Hwang, S. J.

</span>
<span class="ltx_bibblock">Factorized-FL: Personalized Federated Learning with Parameter Factorization &amp; Similarity Matching.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:35684–35695, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2021)</span>
<span class="ltx_bibblock">
Jia, C., Yang, Y., Xia, Y., Chen, Y.-T., Parekh, Z., Pham, H., Le, Q., Sung, Y.-H., Li, Z., and Duerig, T.

</span>
<span class="ltx_bibblock">Scaling up visual and vision-language representation learning with noisy text supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.  4904–4916. PMLR, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khattak et al. (2023a)</span>
<span class="ltx_bibblock">
Khattak, M. U., Rasheed, H., Maaz, M., Khan, S., and Khan, F. S.

</span>
<span class="ltx_bibblock">Maple: Multi-modal prompt learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  19113–19122, 2023a.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khattak et al. (2023b)</span>
<span class="ltx_bibblock">
Khattak, M. U., Wasim, S. T., Naseer, M., Khan, S., Yang, M.-H., and Khan, F. S.

</span>
<span class="ltx_bibblock">Self-regulating Prompts: Foundational model adaptation without forgetting.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  15190–15200, 2023b.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2010)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Nair, V., and Hinton, G.

</span>
<span class="ltx_bibblock">Cifar-10 (canadian institute for advanced research).

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">URL http://www. cs. toronto. edu/kriz/cifar. html</em>, 5(4):1, 2010.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Li, H., Cai, Z., Wang, J., Tang, J., Ding, W., Lin, C.-T., and Shi, Y.

</span>
<span class="ltx_bibblock">FedTP: Federated Learning by Transformer Personalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, 2023.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
<span class="ltx_bibblock">
Li, H., Huang, W., Wang, J., and Shi, Y.

</span>
<span class="ltx_bibblock">Global and local prompts cooperation via optimal transport for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2024.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021a)</span>
<span class="ltx_bibblock">
Li, Q., He, B., and Song, D.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  10713–10722, 2021a.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021b)</span>
<span class="ltx_bibblock">
Li, T., Hu, S., Beirami, A., and Smith, V.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  6357–6368. PMLR, 2021b.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021c)</span>
<span class="ltx_bibblock">
Li, X., Jiang, M., Zhang, X., Kamp, M., and Dou, Q.

</span>
<span class="ltx_bibblock">FedBN: Federated learning on non-iid features via local batch normalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2102.07623</em>, 2021c.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, Q., Chen, C., Qin, J., Dou, Q., and Heng, P.-A.

</span>
<span class="ltx_bibblock">FedDG: Federated domain generalization on medical image segmentation via episodic learning in continuous frequency space.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  1013–1023, 2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023)</span>
<span class="ltx_bibblock">
Ma, C., Liu, Y., Deng, J., Xie, L., Dong, W., and Xu, C.

</span>
<span class="ltx_bibblock">Understanding and mitigating overfitting in prompt tuning for vision-language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Circuits and Systems for Video Technology</em>, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2022)</span>
<span class="ltx_bibblock">
Ma, X., Zhang, J., Guo, S., and Xu, W.

</span>
<span class="ltx_bibblock">Layer-wised model aggregation for personalized federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  10092–10101, 2022.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansour et al. (2020)</span>
<span class="ltx_bibblock">
Mansour, Y., Mohri, M., Ro, J., and Suresh, A. T.

</span>
<span class="ltx_bibblock">Three approaches for personalization with applications to federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282. PMLR, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu et al. (2023)</span>
<span class="ltx_bibblock">
Mu, X., Shen, Y., Cheng, K., Geng, X., Fu, J., Zhang, T., and Zhang, Z.

</span>
<span class="ltx_bibblock">FedProc: Prototypical contrastive federated learning on non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, 143:93–104, 2023.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2022)</span>
<span class="ltx_bibblock">
Nguyen, A. T., Torr, P., and Lim, S. N.

</span>
<span class="ltx_bibblock">FedSR: A simple and effective domain generalization method for federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:38831–38843, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nilsback &amp; Zisserman (2008)</span>
<span class="ltx_bibblock">
Nilsback, M.-E. and Zisserman, A.

</span>
<span class="ltx_bibblock">Automated flower classification over a large number of classes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">2008 Sixth Indian conference on computer vision, graphics &amp; image processing</em>, pp.  722–729. IEEE, 2008.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. (2021)</span>
<span class="ltx_bibblock">
Oh, J., Kim, S., and Yun, S.-Y.

</span>
<span class="ltx_bibblock">FedBABU: Towards enhanced representation for federated image classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.06042</em>, 2021.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Parkhi et al. (2012)</span>
<span class="ltx_bibblock">
Parkhi, O. M., Vedaldi, A., Zisserman, A., and Jawahar, C.

</span>
<span class="ltx_bibblock">Cats and dogs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">2012 IEEE conference on computer vision and pattern recognition</em>, pp.  3498–3505. IEEE, 2012.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2019)</span>
<span class="ltx_bibblock">
Peng, X., Bai, Q., Xia, X., Huang, Z., Saenko, K., and Wang, B.

</span>
<span class="ltx_bibblock">Moment matching for multi-source domain adaptation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF international conference on computer vision</em>, pp.  1406–1415, 2019.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al. (2023)</span>
<span class="ltx_bibblock">
Qiu, C., Li, X., Mummadi, C. K., Ganesh, M. R., Li, Z., Peng, L., and Lin, W.-Y.

</span>
<span class="ltx_bibblock">Text-driven Prompt Generation for Vision-Language Models in Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.06123</em>, 2023.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Radford, A., Kim, J. W., Hallacy, C., Ramesh, A., Goh, G., Agarwal, S., Sastry, G., Askell, A., Mishkin, P., Clark, J., et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>, pp.  8748–8763. PMLR, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2020)</span>
<span class="ltx_bibblock">
Sattler, F., Müller, K.-R., and Samek, W.

</span>
<span class="ltx_bibblock">Clustered federated learning: Model-agnostic distributed multitask optimization under privacy constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on neural networks and learning systems</em>, 32(8):3710–3722, 2020.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shamsian et al. (2021)</span>
<span class="ltx_bibblock">
Shamsian, A., Navon, A., Fetaya, E., and Chechik, G.

</span>
<span class="ltx_bibblock">Personalized federated learning using hypernetworks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp.  9489–9502. PMLR, 2021.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. (2022)</span>
<span class="ltx_bibblock">
Su, S., Yang, M., Li, B., and Xue, X.

</span>
<span class="ltx_bibblock">Cross-domain federated adaptive prompt tuning for clip.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.07864</em>, 2022.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">T Dinh et al. (2020)</span>
<span class="ltx_bibblock">
T Dinh, C., Tran, N., and Nguyen, J.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33:21394–21405, 2020.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022a)</span>
<span class="ltx_bibblock">
Tan, A. Z., Yu, H., Cui, L., and Yang, Q.

</span>
<span class="ltx_bibblock">Towards personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>, 2022a.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022b)</span>
<span class="ltx_bibblock">
Tan, Y., Long, G., Ma, J., Liu, L., Zhou, T., and Jiang, J.

</span>
<span class="ltx_bibblock">Federated learning from pre-trained models: A contrastive learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 35:19332–19344, 2022b.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, K., Mathews, R., Kiddon, C., Eichner, H., Beaufays, F., and Ramage, D.

</span>
<span class="ltx_bibblock">Federated evaluation of on-device personalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.10252</em>, 2019.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2023)</span>
<span class="ltx_bibblock">
Wei, G., Wang, F., Shah, A., and Chellappa, R.

</span>
<span class="ltx_bibblock">Dual prompt tuning for domain-aware federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2310.03103</em>, 2023.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2022)</span>
<span class="ltx_bibblock">
Xie, Z., Zhang, Z., Cao, Y., Lin, Y., Bao, J., Yao, Z., Dai, Q., and Hu, H.

</span>
<span class="ltx_bibblock">Simmim: A simple framework for masked image modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  9653–9663, 2022.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Yang, F.-E., Wang, C.-Y., and Wang, Y.-C. F.

</span>
<span class="ltx_bibblock">Efficient model personalization in federated learning via client-specific prompt generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  19159–19168, 2023.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zhang, L., Lei, X., Shi, Y., Huang, H., and Chen, C.

</span>
<span class="ltx_bibblock">Federated learning with domain generalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2111.10487</em>, 2021.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Zhang, L., Shi, Y., Chang, Y.-C., and Lin, C.-T.

</span>
<span class="ltx_bibblock">Federated fuzzy neural network with evolutionary rule learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Fuzzy Systems</em>, 2022.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Zhang, M., Sapra, K., Fidler, S., Yeung, S., and Alvarez, J. M.

</span>
<span class="ltx_bibblock">Personalized federated learning with first order model optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2012.08565</em>, 2020.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2022)</span>
<span class="ltx_bibblock">
Zhao, H., Du, W., Li, F., Li, P., and Liu, G.

</span>
<span class="ltx_bibblock">Reduce communication costs and preserve privacy: Prompt tuning method in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.12268</em>, 2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022a)</span>
<span class="ltx_bibblock">
Zhou, K., Yang, J., Loy, C. C., and Liu, Z.

</span>
<span class="ltx_bibblock">Conditional prompt learning for vision-language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  16816–16825, 2022a.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022b)</span>
<span class="ltx_bibblock">
Zhou, K., Yang, J., Loy, C. C., and Liu, Z.

</span>
<span class="ltx_bibblock">Learning to prompt for vision-language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 130(9):2337–2348, 2022b.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2023)</span>
<span class="ltx_bibblock">
Zhu, B., Niu, Y., Han, Y., Wu, Y., and Zhang, H.

</span>
<span class="ltx_bibblock">Prompt-aligned gradient for prompt tuning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pp.  15659–15669, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix ltx_indent_first">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental Details</h2>

<section id="A1.SS1" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Dataset Setup</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">For our evaluation, we’ve chosen nine diverse visual classification datasets as our benchmark. Table <a href="#A1.T8" title="Table 8 ‣ A.1 Dataset Setup ‣ Appendix A Experimental Details ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> provides a detailed overview, including information on original tasks, class numbers, training and testing sample sizes, and domain counts.
In datasets with multiple domains, we utilize the well-established Office-Caltech10 benchmark, featuring four domains: Amazon, Caltech, DSLR, and WebCam. These domains capture variations arising from different camera devices and real-world environments. Additionally, we leverage DomainNet, a large-scale dataset comprising six domains: Clipart, Infograph, Painting, Quickdraw, Real, and Sketch. We focus on training with 10 selected classes from each dataset. Visual examples of raw instances from these two multi-domain datasets can be found in Figure <a href="#A1.F3" title="Figure 3 ‣ A.1 Dataset Setup ‣ Appendix A Experimental Details ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="A1.T8" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>Statistical details of datasets used in experiments.</figcaption>
<div id="A1.T8.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:424.9pt;height:124.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-96.8pt,28.2pt) scale(0.687026507781039,0.687026507781039) ;">
<table id="A1.T8.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T8.1.1.1.1" class="ltx_tr">
<td id="A1.T8.1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Dataset</td>
<td id="A1.T8.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Classes</td>
<td id="A1.T8.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Train</td>
<td id="A1.T8.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Test</td>
<td id="A1.T8.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Domains</td>
<td id="A1.T8.1.1.1.1.6" class="ltx_td ltx_align_left ltx_border_tt" style="padding-top:1pt;padding-bottom:1pt;">Task</td>
</tr>
<tr id="A1.T8.1.1.2.2" class="ltx_tr">
<td id="A1.T8.1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">OxfordPets <cite class="ltx_cite ltx_citemacro_citep">(Parkhi et al., <a href="#bib.bib43" title="" class="ltx_ref">2012</a>)</cite>
</td>
<td id="A1.T8.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">37</td>
<td id="A1.T8.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">2,944</td>
<td id="A1.T8.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">3,669</td>
<td id="A1.T8.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.2.2.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Fine-grained pets recognition</td>
</tr>
<tr id="A1.T8.1.1.3.3" class="ltx_tr">
<td id="A1.T8.1.1.3.3.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Flowers102 <cite class="ltx_cite ltx_citemacro_citep">(Nilsback &amp; Zisserman, <a href="#bib.bib41" title="" class="ltx_ref">2008</a>)</cite>
</td>
<td id="A1.T8.1.1.3.3.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">102</td>
<td id="A1.T8.1.1.3.3.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">4,093</td>
<td id="A1.T8.1.1.3.3.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2,463</td>
<td id="A1.T8.1.1.3.3.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.3.3.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Fine-grained flowers recognition</td>
</tr>
<tr id="A1.T8.1.1.4.4" class="ltx_tr">
<td id="A1.T8.1.1.4.4.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">DTD <cite class="ltx_cite ltx_citemacro_citep">(Cimpoi et al., <a href="#bib.bib10" title="" class="ltx_ref">2014</a>)</cite>
</td>
<td id="A1.T8.1.1.4.4.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">47</td>
<td id="A1.T8.1.1.4.4.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2,820</td>
<td id="A1.T8.1.1.4.4.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">1,692</td>
<td id="A1.T8.1.1.4.4.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.4.4.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Texture recognition</td>
</tr>
<tr id="A1.T8.1.1.5.5" class="ltx_tr">
<td id="A1.T8.1.1.5.5.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Caltech101 <cite class="ltx_cite ltx_citemacro_citep">(Fei-Fei, <a href="#bib.bib13" title="" class="ltx_ref">2004</a>)</cite>
</td>
<td id="A1.T8.1.1.5.5.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">100</td>
<td id="A1.T8.1.1.5.5.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">4,128</td>
<td id="A1.T8.1.1.5.5.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">2,465</td>
<td id="A1.T8.1.1.5.5.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.5.5.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Object recognition</td>
</tr>
<tr id="A1.T8.1.1.6.6" class="ltx_tr">
<td id="A1.T8.1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Food101 <cite class="ltx_cite ltx_citemacro_citep">(Bossard et al., <a href="#bib.bib3" title="" class="ltx_ref">2014</a>)</cite>
</td>
<td id="A1.T8.1.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">101</td>
<td id="A1.T8.1.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50,500</td>
<td id="A1.T8.1.1.6.6.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">30,300</td>
<td id="A1.T8.1.1.6.6.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.6.6.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Fine-grained food recognition</td>
</tr>
<tr id="A1.T8.1.1.7.7" class="ltx_tr">
<td id="A1.T8.1.1.7.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">CIFAR10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib26" title="" class="ltx_ref">2009</a>)</cite>
</td>
<td id="A1.T8.1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10</td>
<td id="A1.T8.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">50,000</td>
<td id="A1.T8.1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10,000</td>
<td id="A1.T8.1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.7.7.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Image Classification</td>
</tr>
<tr id="A1.T8.1.1.8.8" class="ltx_tr">
<td id="A1.T8.1.1.8.8.1" class="ltx_td ltx_align_left ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">CIFAR100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib26" title="" class="ltx_ref">2009</a>)</cite>
</td>
<td id="A1.T8.1.1.8.8.2" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">100</td>
<td id="A1.T8.1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">50,000</td>
<td id="A1.T8.1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">10,000</td>
<td id="A1.T8.1.1.8.8.5" class="ltx_td ltx_align_center" style="padding-top:1pt;padding-bottom:1pt;">1</td>
<td id="A1.T8.1.1.8.8.6" class="ltx_td ltx_align_left" style="padding-top:1pt;padding-bottom:1pt;">Image Classification</td>
</tr>
<tr id="A1.T8.1.1.9.9" class="ltx_tr">
<td id="A1.T8.1.1.9.9.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">DomainNet <cite class="ltx_cite ltx_citemacro_citep">(Peng et al., <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite>
</td>
<td id="A1.T8.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">10</td>
<td id="A1.T8.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">18278</td>
<td id="A1.T8.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">4573</td>
<td id="A1.T8.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">6</td>
<td id="A1.T8.1.1.9.9.6" class="ltx_td ltx_align_left ltx_border_t" style="padding-top:1pt;padding-bottom:1pt;">Image recognition</td>
</tr>
<tr id="A1.T8.1.1.10.10" class="ltx_tr">
<td id="A1.T8.1.1.10.10.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" style="padding-top:1pt;padding-bottom:1pt;">Office-Caltech10 <cite class="ltx_cite ltx_citemacro_citep">(Gong et al., <a href="#bib.bib15" title="" class="ltx_ref">2012</a>)</cite>
</td>
<td id="A1.T8.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">10</td>
<td id="A1.T8.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">2025</td>
<td id="A1.T8.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">508</td>
<td id="A1.T8.1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">4</td>
<td id="A1.T8.1.1.10.10.6" class="ltx_td ltx_align_left ltx_border_bb" style="padding-top:1pt;padding-bottom:1pt;">Image recognition</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="A1.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.09771/assets/x3.png" id="A1.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="212" height="186" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="A1.F3.sf1.3.2" class="ltx_text" style="font-size:80%;">DomainNet</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2405.09771/assets/x4.png" id="A1.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="226" height="169" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="A1.F3.sf2.3.2" class="ltx_text" style="font-size:80%;">Office-Caltech10</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Visual examples of raw instances from two datasets with multiple domains: “Bird” in DomainNet (left) and “Bike” in Office-Caltech10 (right).</figcaption>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Experimental Setup</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">We employ SGD optimizer with learning rate <math id="A1.SS2.p1.1.m1.1" class="ltx_Math" alttext="\eta=0.001" display="inline"><semantics id="A1.SS2.p1.1.m1.1a"><mrow id="A1.SS2.p1.1.m1.1.1" xref="A1.SS2.p1.1.m1.1.1.cmml"><mi id="A1.SS2.p1.1.m1.1.1.2" xref="A1.SS2.p1.1.m1.1.1.2.cmml">η</mi><mo id="A1.SS2.p1.1.m1.1.1.1" xref="A1.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS2.p1.1.m1.1.1.3" xref="A1.SS2.p1.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p1.1.m1.1b"><apply id="A1.SS2.p1.1.m1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1"><eq id="A1.SS2.p1.1.m1.1.1.1.cmml" xref="A1.SS2.p1.1.m1.1.1.1"></eq><ci id="A1.SS2.p1.1.m1.1.1.2.cmml" xref="A1.SS2.p1.1.m1.1.1.2">𝜂</ci><cn type="float" id="A1.SS2.p1.1.m1.1.1.3.cmml" xref="A1.SS2.p1.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p1.1.m1.1c">\eta=0.001</annotation></semantics></math>. The experiments were conducted three times using different seeds. We calculated the average performance and the final result in federated prompt learning is obtained by averaging the performance across all clients. All experiments are conducted with Pytorch on NVIDIA A40 GPUs.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para ltx_noindent">
<p id="A1.SS2.p2.1" class="ltx_p"><span id="A1.SS2.p2.1.1" class="ltx_text ltx_font_bold">Base-to-Novel Class Generalization.</span>
For Base-to-Novel generalization, we separate each dataset into base and novel classes equally and distribute the base classes to each client without overlapping. Each client trains their local model on their local classes, and we evaluate their personalized prompt on both local classes, base classes (classes seen on other clients but unseen during local training), and novel classes (unseen in the whole training process). The accuracy is the average overall 10 clients.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para ltx_noindent">
<p id="A1.SS2.p3.1" class="ltx_p"><span id="A1.SS2.p3.1.1" class="ltx_text ltx_font_bold">Leave-One-Domain-Out Generalization.</span>
For Leave-One-Domain-Out generalization, each client participating in the federated learning system is assigned data from one of the distinct domains. We pick one domain to serve as the target domain and use the rest of the domains as source domains. Each client possesses a distinct source domain for training and then tests its model generalization ability on the whole target domain. The accuracy is the average overall 3 clients in Office-Caltech10 and 5 clients in DomainNet.</p>
</div>
<div id="A1.SS2.p4" class="ltx_para ltx_noindent">
<p id="A1.SS2.p4.1" class="ltx_p"><span id="A1.SS2.p4.1.1" class="ltx_text ltx_font_bold">Personalization.</span>
For evaluation of personalization, we apply Dirichlet distribution on CIFAR-10 and CIFAR-100 over 100 clients. Specifically, the datasets are partitioned randomly among clients using a symmetric Dirichlet distribution with hyperparameter <math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><mi id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><ci id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">\alpha</annotation></semantics></math> = 0.3. Besides, we employ the Pathlogicacl setting the same as in base-to-novel class generalization with non-overlapping classes across 10 clients for other datasets.</p>
</div>
<div id="A1.SS2.p5" class="ltx_para ltx_noindent">
<p id="A1.SS2.p5.3" class="ltx_p"><span id="A1.SS2.p5.3.1" class="ltx_text ltx_font_bold">Effect of Individual Components.</span>
For the ablation study, we employ <math id="A1.SS2.p5.1.m1.2" class="ltx_Math" alttext="\mathcal{L}_{neg}=1-\text{sim}(z_{G},z_{i})" display="inline"><semantics id="A1.SS2.p5.1.m1.2a"><mrow id="A1.SS2.p5.1.m1.2.2" xref="A1.SS2.p5.1.m1.2.2.cmml"><msub id="A1.SS2.p5.1.m1.2.2.4" xref="A1.SS2.p5.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p5.1.m1.2.2.4.2" xref="A1.SS2.p5.1.m1.2.2.4.2.cmml">ℒ</mi><mrow id="A1.SS2.p5.1.m1.2.2.4.3" xref="A1.SS2.p5.1.m1.2.2.4.3.cmml"><mi id="A1.SS2.p5.1.m1.2.2.4.3.2" xref="A1.SS2.p5.1.m1.2.2.4.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.2.2.4.3.1" xref="A1.SS2.p5.1.m1.2.2.4.3.1.cmml">​</mo><mi id="A1.SS2.p5.1.m1.2.2.4.3.3" xref="A1.SS2.p5.1.m1.2.2.4.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.2.2.4.3.1a" xref="A1.SS2.p5.1.m1.2.2.4.3.1.cmml">​</mo><mi id="A1.SS2.p5.1.m1.2.2.4.3.4" xref="A1.SS2.p5.1.m1.2.2.4.3.4.cmml">g</mi></mrow></msub><mo id="A1.SS2.p5.1.m1.2.2.3" xref="A1.SS2.p5.1.m1.2.2.3.cmml">=</mo><mrow id="A1.SS2.p5.1.m1.2.2.2" xref="A1.SS2.p5.1.m1.2.2.2.cmml"><mn id="A1.SS2.p5.1.m1.2.2.2.4" xref="A1.SS2.p5.1.m1.2.2.2.4.cmml">1</mn><mo id="A1.SS2.p5.1.m1.2.2.2.3" xref="A1.SS2.p5.1.m1.2.2.2.3.cmml">−</mo><mrow id="A1.SS2.p5.1.m1.2.2.2.2" xref="A1.SS2.p5.1.m1.2.2.2.2.cmml"><mtext id="A1.SS2.p5.1.m1.2.2.2.2.4" xref="A1.SS2.p5.1.m1.2.2.2.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="A1.SS2.p5.1.m1.2.2.2.2.3" xref="A1.SS2.p5.1.m1.2.2.2.2.3.cmml">​</mo><mrow id="A1.SS2.p5.1.m1.2.2.2.2.2.2" xref="A1.SS2.p5.1.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p5.1.m1.2.2.2.2.2.2.3" xref="A1.SS2.p5.1.m1.2.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.2" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.3" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mo id="A1.SS2.p5.1.m1.2.2.2.2.2.2.4" xref="A1.SS2.p5.1.m1.2.2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.2" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.2.cmml">z</mi><mi id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.3" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS2.p5.1.m1.2.2.2.2.2.2.5" xref="A1.SS2.p5.1.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.2b"><apply id="A1.SS2.p5.1.m1.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2"><eq id="A1.SS2.p5.1.m1.2.2.3.cmml" xref="A1.SS2.p5.1.m1.2.2.3"></eq><apply id="A1.SS2.p5.1.m1.2.2.4.cmml" xref="A1.SS2.p5.1.m1.2.2.4"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.2.2.4.1.cmml" xref="A1.SS2.p5.1.m1.2.2.4">subscript</csymbol><ci id="A1.SS2.p5.1.m1.2.2.4.2.cmml" xref="A1.SS2.p5.1.m1.2.2.4.2">ℒ</ci><apply id="A1.SS2.p5.1.m1.2.2.4.3.cmml" xref="A1.SS2.p5.1.m1.2.2.4.3"><times id="A1.SS2.p5.1.m1.2.2.4.3.1.cmml" xref="A1.SS2.p5.1.m1.2.2.4.3.1"></times><ci id="A1.SS2.p5.1.m1.2.2.4.3.2.cmml" xref="A1.SS2.p5.1.m1.2.2.4.3.2">𝑛</ci><ci id="A1.SS2.p5.1.m1.2.2.4.3.3.cmml" xref="A1.SS2.p5.1.m1.2.2.4.3.3">𝑒</ci><ci id="A1.SS2.p5.1.m1.2.2.4.3.4.cmml" xref="A1.SS2.p5.1.m1.2.2.4.3.4">𝑔</ci></apply></apply><apply id="A1.SS2.p5.1.m1.2.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2.2"><minus id="A1.SS2.p5.1.m1.2.2.2.3.cmml" xref="A1.SS2.p5.1.m1.2.2.2.3"></minus><cn type="integer" id="A1.SS2.p5.1.m1.2.2.2.4.cmml" xref="A1.SS2.p5.1.m1.2.2.2.4">1</cn><apply id="A1.SS2.p5.1.m1.2.2.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2"><times id="A1.SS2.p5.1.m1.2.2.2.2.3.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.3"></times><ci id="A1.SS2.p5.1.m1.2.2.2.2.4a.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.4"><mtext id="A1.SS2.p5.1.m1.2.2.2.2.4.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.4">sim</mtext></ci><interval closure="open" id="A1.SS2.p5.1.m1.2.2.2.2.2.3.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2"><apply id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.1.m1.1.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.2">𝑧</ci><ci id="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p5.1.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.2c">\mathcal{L}_{neg}=1-\text{sim}(z_{G},z_{i})</annotation></semantics></math> as the additional loss for FedPGP without positive pairs, and <math id="A1.SS2.p5.2.m2.2" class="ltx_Math" alttext="\mathcal{L}_{pos}=\text{sim}(z_{G},z_{C})" display="inline"><semantics id="A1.SS2.p5.2.m2.2a"><mrow id="A1.SS2.p5.2.m2.2.2" xref="A1.SS2.p5.2.m2.2.2.cmml"><msub id="A1.SS2.p5.2.m2.2.2.4" xref="A1.SS2.p5.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p5.2.m2.2.2.4.2" xref="A1.SS2.p5.2.m2.2.2.4.2.cmml">ℒ</mi><mrow id="A1.SS2.p5.2.m2.2.2.4.3" xref="A1.SS2.p5.2.m2.2.2.4.3.cmml"><mi id="A1.SS2.p5.2.m2.2.2.4.3.2" xref="A1.SS2.p5.2.m2.2.2.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.2.m2.2.2.4.3.1" xref="A1.SS2.p5.2.m2.2.2.4.3.1.cmml">​</mo><mi id="A1.SS2.p5.2.m2.2.2.4.3.3" xref="A1.SS2.p5.2.m2.2.2.4.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.2.m2.2.2.4.3.1a" xref="A1.SS2.p5.2.m2.2.2.4.3.1.cmml">​</mo><mi id="A1.SS2.p5.2.m2.2.2.4.3.4" xref="A1.SS2.p5.2.m2.2.2.4.3.4.cmml">s</mi></mrow></msub><mo id="A1.SS2.p5.2.m2.2.2.3" xref="A1.SS2.p5.2.m2.2.2.3.cmml">=</mo><mrow id="A1.SS2.p5.2.m2.2.2.2" xref="A1.SS2.p5.2.m2.2.2.2.cmml"><mtext id="A1.SS2.p5.2.m2.2.2.2.4" xref="A1.SS2.p5.2.m2.2.2.2.4a.cmml">sim</mtext><mo lspace="0em" rspace="0em" id="A1.SS2.p5.2.m2.2.2.2.3" xref="A1.SS2.p5.2.m2.2.2.2.3.cmml">​</mo><mrow id="A1.SS2.p5.2.m2.2.2.2.2.2" xref="A1.SS2.p5.2.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p5.2.m2.2.2.2.2.2.3" xref="A1.SS2.p5.2.m2.2.2.2.2.3.cmml">(</mo><msub id="A1.SS2.p5.2.m2.1.1.1.1.1.1" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p5.2.m2.1.1.1.1.1.1.2" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml">z</mi><mi id="A1.SS2.p5.2.m2.1.1.1.1.1.1.3" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml">G</mi></msub><mo id="A1.SS2.p5.2.m2.2.2.2.2.2.4" xref="A1.SS2.p5.2.m2.2.2.2.2.3.cmml">,</mo><msub id="A1.SS2.p5.2.m2.2.2.2.2.2.2" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2.cmml"><mi id="A1.SS2.p5.2.m2.2.2.2.2.2.2.2" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2.2.cmml">z</mi><mi id="A1.SS2.p5.2.m2.2.2.2.2.2.2.3" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2.3.cmml">C</mi></msub><mo stretchy="false" id="A1.SS2.p5.2.m2.2.2.2.2.2.5" xref="A1.SS2.p5.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.2b"><apply id="A1.SS2.p5.2.m2.2.2.cmml" xref="A1.SS2.p5.2.m2.2.2"><eq id="A1.SS2.p5.2.m2.2.2.3.cmml" xref="A1.SS2.p5.2.m2.2.2.3"></eq><apply id="A1.SS2.p5.2.m2.2.2.4.cmml" xref="A1.SS2.p5.2.m2.2.2.4"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.2.2.4.1.cmml" xref="A1.SS2.p5.2.m2.2.2.4">subscript</csymbol><ci id="A1.SS2.p5.2.m2.2.2.4.2.cmml" xref="A1.SS2.p5.2.m2.2.2.4.2">ℒ</ci><apply id="A1.SS2.p5.2.m2.2.2.4.3.cmml" xref="A1.SS2.p5.2.m2.2.2.4.3"><times id="A1.SS2.p5.2.m2.2.2.4.3.1.cmml" xref="A1.SS2.p5.2.m2.2.2.4.3.1"></times><ci id="A1.SS2.p5.2.m2.2.2.4.3.2.cmml" xref="A1.SS2.p5.2.m2.2.2.4.3.2">𝑝</ci><ci id="A1.SS2.p5.2.m2.2.2.4.3.3.cmml" xref="A1.SS2.p5.2.m2.2.2.4.3.3">𝑜</ci><ci id="A1.SS2.p5.2.m2.2.2.4.3.4.cmml" xref="A1.SS2.p5.2.m2.2.2.4.3.4">𝑠</ci></apply></apply><apply id="A1.SS2.p5.2.m2.2.2.2.cmml" xref="A1.SS2.p5.2.m2.2.2.2"><times id="A1.SS2.p5.2.m2.2.2.2.3.cmml" xref="A1.SS2.p5.2.m2.2.2.2.3"></times><ci id="A1.SS2.p5.2.m2.2.2.2.4a.cmml" xref="A1.SS2.p5.2.m2.2.2.2.4"><mtext id="A1.SS2.p5.2.m2.2.2.2.4.cmml" xref="A1.SS2.p5.2.m2.2.2.2.4">sim</mtext></ci><interval closure="open" id="A1.SS2.p5.2.m2.2.2.2.2.3.cmml" xref="A1.SS2.p5.2.m2.2.2.2.2.2"><apply id="A1.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1.2">𝑧</ci><ci id="A1.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.2.m2.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="A1.SS2.p5.2.m2.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.2.2.2.2.2.2.1.cmml" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="A1.SS2.p5.2.m2.2.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2.2">𝑧</ci><ci id="A1.SS2.p5.2.m2.2.2.2.2.2.2.3.cmml" xref="A1.SS2.p5.2.m2.2.2.2.2.2.2.3">𝐶</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.2c">\mathcal{L}_{pos}=\text{sim}(z_{G},z_{C})</annotation></semantics></math> as the additional loss for FedPGP without negative pairs. The hyperparameter is set as <math id="A1.SS2.p5.3.m3.1" class="ltx_Math" alttext="\mu=1" display="inline"><semantics id="A1.SS2.p5.3.m3.1a"><mrow id="A1.SS2.p5.3.m3.1.1" xref="A1.SS2.p5.3.m3.1.1.cmml"><mi id="A1.SS2.p5.3.m3.1.1.2" xref="A1.SS2.p5.3.m3.1.1.2.cmml">μ</mi><mo id="A1.SS2.p5.3.m3.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.cmml">=</mo><mn id="A1.SS2.p5.3.m3.1.1.3" xref="A1.SS2.p5.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.1b"><apply id="A1.SS2.p5.3.m3.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1"><eq id="A1.SS2.p5.3.m3.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1"></eq><ci id="A1.SS2.p5.3.m3.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.2">𝜇</ci><cn type="integer" id="A1.SS2.p5.3.m3.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.1c">\mu=1</annotation></semantics></math> for the additional loss.</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix ltx_indent_first">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experimental Results</h2>

<section id="A2.SS1" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Detailed Results of Leave-One-Domain-Out Generalization</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">In Table <a href="#S4.T4" title="Table 4 ‣ 4.2 Performance Evaluation ‣ 4 Experiments ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Table <a href="#A2.T9" title="Table 9 ‣ B.1 Detailed Results of Leave-One-Domain-Out Generalization ‣ Appendix B Additional Experimental Results ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, we provide the detailed classification accuracy on each source domain within Office-Caltech10 and DomainNet datasets, respectively. Notably, as PromptFL and PromptProx utilize a single global prompt, their results remain consistent across different source domains. Therefore, the presented results specifically focus on CoOp and our FedPGP, both employing distinct local models for each client. To be specific, the values shown in the table indicate the testing results on the target domain across clients with different source domains. Comparing the results of CoOp and our FedPGP, we observe that FedPGP consistently outperforms CoOp in all cases with a significantly smaller standard deviation, showcasing the robust generalization capability of our proposed method.</p>
</div>
<figure id="A2.T9" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>The detailed classification accuracy using leave-one-domain-out validation on DomainNet dataset.</figcaption>
<div id="A2.T9.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:168.9pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-108.1pt,41.9pt) scale(0.667391618894353,0.667391618894353) ;">
<table id="A2.T9.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T9.1.1.1.1" class="ltx_tr">
<th id="A2.T9.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Datasets</th>
<th id="A2.T9.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;" colspan="7">DomainNet</th>
<th id="A2.T9.1.1.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
</tr>
<tr id="A2.T9.1.1.2.2" class="ltx_tr">
<th id="A2.T9.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Source Domains</th>
<th id="A2.T9.1.1.2.2.2" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"></th>
<th id="A2.T9.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Clipart</th>
<th id="A2.T9.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Infograph</th>
<th id="A2.T9.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Painting</th>
<th id="A2.T9.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Quickdraw</th>
<th id="A2.T9.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Real</th>
<th id="A2.T9.1.1.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Sketch</th>
<th id="A2.T9.1.1.2.2.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Avg.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T9.1.1.3.1" class="ltx_tr">
<th id="A2.T9.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="6"><span id="A2.T9.1.1.3.1.1.1" class="ltx_text">CoOp <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib62" title="" class="ltx_ref">2022b</a>)</cite></span></th>
<th id="A2.T9.1.1.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Clipart</th>
<td id="A2.T9.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.17</td>
<td id="A2.T9.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.80</td>
<td id="A2.T9.1.1.3.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.98</td>
<td id="A2.T9.1.1.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.71</td>
<td id="A2.T9.1.1.3.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.46</td>
<td id="A2.T9.1.1.3.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.42±8.96</td>
</tr>
<tr id="A2.T9.1.1.4.2" class="ltx_tr">
<th id="A2.T9.1.1.4.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Infograph</th>
<td id="A2.T9.1.1.4.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">57.41</td>
<td id="A2.T9.1.1.4.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.4.2.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">60.00</td>
<td id="A2.T9.1.1.4.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">30.64</td>
<td id="A2.T9.1.1.4.2.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">65.09</td>
<td id="A2.T9.1.1.4.2.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.24</td>
<td id="A2.T9.1.1.4.2.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.28±15.20</td>
</tr>
<tr id="A2.T9.1.1.5.3" class="ltx_tr">
<th id="A2.T9.1.1.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Painting</th>
<td id="A2.T9.1.1.5.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.80</td>
<td id="A2.T9.1.1.5.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.88</td>
<td id="A2.T9.1.1.5.3.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.5.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.06</td>
<td id="A2.T9.1.1.5.3.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.62</td>
<td id="A2.T9.1.1.5.3.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.04</td>
<td id="A2.T9.1.1.5.3.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">80.80±11.67</td>
</tr>
<tr id="A2.T9.1.1.6.4" class="ltx_tr">
<th id="A2.T9.1.1.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Quickdraw</th>
<td id="A2.T9.1.1.6.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.50</td>
<td id="A2.T9.1.1.6.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">44.02</td>
<td id="A2.T9.1.1.6.4.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">50.00</td>
<td id="A2.T9.1.1.6.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.6.4.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.02</td>
<td id="A2.T9.1.1.6.4.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">51.50</td>
<td id="A2.T9.1.1.6.4.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.41±3.94</td>
</tr>
<tr id="A2.T9.1.1.7.5" class="ltx_tr">
<th id="A2.T9.1.1.7.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Real</th>
<td id="A2.T9.1.1.7.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.95</td>
<td id="A2.T9.1.1.7.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">79.27</td>
<td id="A2.T9.1.1.7.5.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.70</td>
<td id="A2.T9.1.1.7.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">27.29</td>
<td id="A2.T9.1.1.7.5.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.7.5.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.69</td>
<td id="A2.T9.1.1.7.5.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.18±30.05</td>
</tr>
<tr id="A2.T9.1.1.8.6" class="ltx_tr">
<th id="A2.T9.1.1.8.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Sketch</th>
<td id="A2.T9.1.1.8.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.55</td>
<td id="A2.T9.1.1.8.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.27</td>
<td id="A2.T9.1.1.8.6.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.91</td>
<td id="A2.T9.1.1.8.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.51</td>
<td id="A2.T9.1.1.8.6.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.15</td>
<td id="A2.T9.1.1.8.6.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.8.6.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">82.88±12.09</td>
</tr>
<tr id="A2.T9.1.1.9.7" class="ltx_tr">
<th id="A2.T9.1.1.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="6"><span id="A2.T9.1.1.9.7.1.1" class="ltx_text">FedPGP</span></th>
<th id="A2.T9.1.1.9.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">Clipart</th>
<td id="A2.T9.1.1.9.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.9.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.23</td>
<td id="A2.T9.1.1.9.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.80</td>
<td id="A2.T9.1.1.9.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.96</td>
<td id="A2.T9.1.1.9.7.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.27</td>
<td id="A2.T9.1.1.9.7.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.99</td>
<td id="A2.T9.1.1.9.7.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T9.1.1.9.7.9.1" class="ltx_text ltx_font_bold">96.45±0.43</span></td>
</tr>
<tr id="A2.T9.1.1.10.8" class="ltx_tr">
<th id="A2.T9.1.1.10.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Infograph</th>
<td id="A2.T9.1.1.10.8.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.45</td>
<td id="A2.T9.1.1.10.8.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.10.8.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">74.44</td>
<td id="A2.T9.1.1.10.8.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">69.29</td>
<td id="A2.T9.1.1.10.8.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.24</td>
<td id="A2.T9.1.1.10.8.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.90</td>
<td id="A2.T9.1.1.10.8.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T9.1.1.10.8.8.1" class="ltx_text ltx_font_bold">74.46±3.21</span></td>
</tr>
<tr id="A2.T9.1.1.11.9" class="ltx_tr">
<th id="A2.T9.1.1.11.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Painting</th>
<td id="A2.T9.1.1.11.9.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.18</td>
<td id="A2.T9.1.1.11.9.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.89</td>
<td id="A2.T9.1.1.11.9.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.11.9.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.01</td>
<td id="A2.T9.1.1.11.9.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.02</td>
<td id="A2.T9.1.1.11.9.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.08</td>
<td id="A2.T9.1.1.11.9.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T9.1.1.11.9.8.1" class="ltx_text ltx_font_bold">95.43±1.50</span></td>
</tr>
<tr id="A2.T9.1.1.12.10" class="ltx_tr">
<th id="A2.T9.1.1.12.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Quickdraw</th>
<td id="A2.T9.1.1.12.10.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.22</td>
<td id="A2.T9.1.1.12.10.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">52.30</td>
<td id="A2.T9.1.1.12.10.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.42</td>
<td id="A2.T9.1.1.12.10.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.12.10.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.30</td>
<td id="A2.T9.1.1.12.10.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.36</td>
<td id="A2.T9.1.1.12.10.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T9.1.1.12.10.8.1" class="ltx_text ltx_font_bold">62.12±6.11</span></td>
</tr>
<tr id="A2.T9.1.1.13.11" class="ltx_tr">
<th id="A2.T9.1.1.13.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Real</th>
<td id="A2.T9.1.1.13.11.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.12</td>
<td id="A2.T9.1.1.13.11.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.75</td>
<td id="A2.T9.1.1.13.11.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.03</td>
<td id="A2.T9.1.1.13.11.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.17</td>
<td id="A2.T9.1.1.13.11.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.13.11.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.25</td>
<td id="A2.T9.1.1.13.11.8" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T9.1.1.13.11.8.1" class="ltx_text ltx_font_bold">96.06±1.87</span></td>
</tr>
<tr id="A2.T9.1.1.14.12" class="ltx_tr">
<th id="A2.T9.1.1.14.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">Sketch</th>
<td id="A2.T9.1.1.14.12.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.71</td>
<td id="A2.T9.1.1.14.12.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.88</td>
<td id="A2.T9.1.1.14.12.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.56</td>
<td id="A2.T9.1.1.14.12.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.75</td>
<td id="A2.T9.1.1.14.12.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.38</td>
<td id="A2.T9.1.1.14.12.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">——</td>
<td id="A2.T9.1.1.14.12.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T9.1.1.14.12.8.1" class="ltx_text ltx_font_bold">96.05±0.81</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Detailed Results of Individual Components in Base-to-Novel Generalization</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">Table <a href="#A2.T10" title="Table 10 ‣ B.2 Detailed Results of Individual Components in Base-to-Novel Generalization ‣ Appendix B Additional Experimental Results ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> presents the per-dataset results for each component of our FedPGP framework in the Base-to-novel generalization setting. The results demonstrate the effectiveness of CLIP knowledge-guidance in enhancing performance for both base and novel classes. Additionally, even though full-rank adaptation outperforms our low-rank adaptation on local classes, its generalization on both base and novel classes significantly diminishes due to overwriting the global prompt. These findings emphasize the efficacy of FedPGP in enhancing model generalization across diverse datasets.</p>
</div>
<figure id="A2.T10" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>Accuracy (%) of ablation study on adaption and additional loss for clients’ local classes and Base-to-novel generalization.</figcaption>
<div id="A2.T10.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:325.2pt;height:245.1pt;vertical-align:-2.1pt;"><span class="ltx_transformed_inner" style="transform:translate(-66.3pt,49.5pt) scale(0.71048449229435,0.71048449229435) ;">
<table id="A2.T10.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T10.1.1.1.1" class="ltx_tr">
<th id="A2.T10.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Dataset</th>
<th id="A2.T10.1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Methods</th>
<th id="A2.T10.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Local</th>
<th id="A2.T10.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Base</th>
<th id="A2.T10.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Novel</th>
<th id="A2.T10.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">HM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T10.1.1.2.1" class="ltx_tr">
<th id="A2.T10.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="A2.T10.1.1.2.1.1.1" class="ltx_text">
<span id="A2.T10.1.1.2.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="A2.T10.1.1.2.1.1.1.1.1" class="ltx_tr">
<span id="A2.T10.1.1.2.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;">Average over</span></span>
<span id="A2.T10.1.1.2.1.1.1.1.2" class="ltx_tr">
<span id="A2.T10.1.1.2.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_left" style="padding-top:0.5pt;padding-bottom:0.5pt;">5 datasets</span></span>
</span></span></th>
<th id="A2.T10.1.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/o Positive</th>
<td id="A2.T10.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.63</td>
<td id="A2.T10.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.68</td>
<td id="A2.T10.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.75</td>
<td id="A2.T10.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.13</td>
</tr>
<tr id="A2.T10.1.1.3.2" class="ltx_tr">
<th id="A2.T10.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/ Full-rank Adaption</th>
<td id="A2.T10.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.3.2.2.1" class="ltx_text ltx_font_bold">98.57</span></td>
<td id="A2.T10.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">48.00</td>
<td id="A2.T10.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">63.40</td>
<td id="A2.T10.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.17</td>
</tr>
<tr id="A2.T10.1.1.4.3" class="ltx_tr">
<th id="A2.T10.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="A2.T10.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.67</td>
<td id="A2.T10.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.4.3.3.1" class="ltx_text ltx_font_bold">85.69</span></td>
<td id="A2.T10.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.4.3.4.1" class="ltx_text ltx_font_bold">81.75</span></td>
<td id="A2.T10.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.4.3.5.1" class="ltx_text ltx_font_bold">87.33</span></td>
</tr>
<tr id="A2.T10.1.1.5.4" class="ltx_tr">
<th id="A2.T10.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="A2.T10.1.1.5.4.1.1" class="ltx_text">Oxford Pets</span></th>
<th id="A2.T10.1.1.5.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/o Positive</th>
<td id="A2.T10.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.88</td>
<td id="A2.T10.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.44</td>
<td id="A2.T10.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.77</td>
<td id="A2.T10.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.03</td>
</tr>
<tr id="A2.T10.1.1.6.5" class="ltx_tr">
<th id="A2.T10.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/ Full-rank Adaption</th>
<td id="A2.T10.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.6.5.2.1" class="ltx_text ltx_font_bold">99.94</span></td>
<td id="A2.T10.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">41.28</td>
<td id="A2.T10.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.32</td>
<td id="A2.T10.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.67</td>
</tr>
<tr id="A2.T10.1.1.7.6" class="ltx_tr">
<th id="A2.T10.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="A2.T10.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.65</td>
<td id="A2.T10.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.7.6.3.1" class="ltx_text ltx_font_bold">95.87</span></td>
<td id="A2.T10.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.7.6.4.1" class="ltx_text ltx_font_bold">97.33</span></td>
<td id="A2.T10.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.7.6.5.1" class="ltx_text ltx_font_bold">96.61</span></td>
</tr>
<tr id="A2.T10.1.1.8.7" class="ltx_tr">
<th id="A2.T10.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="A2.T10.1.1.8.7.1.1" class="ltx_text">Flowers102</span></th>
<th id="A2.T10.1.1.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/o Positive</th>
<td id="A2.T10.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.73</td>
<td id="A2.T10.1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">77.18</td>
<td id="A2.T10.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.22</td>
<td id="A2.T10.1.1.8.7.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.61</td>
</tr>
<tr id="A2.T10.1.1.9.8" class="ltx_tr">
<th id="A2.T10.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/ Full-rank Adaption</th>
<td id="A2.T10.1.1.9.8.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.9.8.2.1" class="ltx_text ltx_font_bold">99.91</span></td>
<td id="A2.T10.1.1.9.8.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">35.43</td>
<td id="A2.T10.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.97</td>
<td id="A2.T10.1.1.9.8.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">52.85</td>
</tr>
<tr id="A2.T10.1.1.10.9" class="ltx_tr">
<th id="A2.T10.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="A2.T10.1.1.10.9.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">99.68</td>
<td id="A2.T10.1.1.10.9.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.10.9.3.1" class="ltx_text ltx_font_bold">78.48</span></td>
<td id="A2.T10.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.10.9.4.1" class="ltx_text ltx_font_bold">75.11</span></td>
<td id="A2.T10.1.1.10.9.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.10.9.5.1" class="ltx_text ltx_font_bold">83.13</span></td>
</tr>
<tr id="A2.T10.1.1.11.10" class="ltx_tr">
<th id="A2.T10.1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="A2.T10.1.1.11.10.1.1" class="ltx_text">DTD</span></th>
<th id="A2.T10.1.1.11.10.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/o Positive</th>
<td id="A2.T10.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.34</td>
<td id="A2.T10.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">67.33</td>
<td id="A2.T10.1.1.11.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">49.83</td>
<td id="A2.T10.1.1.11.10.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">64.70</td>
</tr>
<tr id="A2.T10.1.1.12.11" class="ltx_tr">
<th id="A2.T10.1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/ Full-rank Adaption</th>
<td id="A2.T10.1.1.12.11.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.12.11.2.1" class="ltx_text ltx_font_bold">96.29</span></td>
<td id="A2.T10.1.1.12.11.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">25.12</td>
<td id="A2.T10.1.1.12.11.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">34.81</td>
<td id="A2.T10.1.1.12.11.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">38.01</td>
</tr>
<tr id="A2.T10.1.1.13.12" class="ltx_tr">
<th id="A2.T10.1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="A2.T10.1.1.13.12.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.07</td>
<td id="A2.T10.1.1.13.12.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.13.12.3.1" class="ltx_text ltx_font_bold">69.65</span></td>
<td id="A2.T10.1.1.13.12.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.13.12.4.1" class="ltx_text ltx_font_bold">54.25</span></td>
<td id="A2.T10.1.1.13.12.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.13.12.5.1" class="ltx_text ltx_font_bold">68.15</span></td>
</tr>
<tr id="A2.T10.1.1.14.13" class="ltx_tr">
<th id="A2.T10.1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="A2.T10.1.1.14.13.1.1" class="ltx_text">Caltech101</span></th>
<th id="A2.T10.1.1.14.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/o Positive</th>
<td id="A2.T10.1.1.14.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.34</td>
<td id="A2.T10.1.1.14.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.02</td>
<td id="A2.T10.1.1.14.13.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.57</td>
<td id="A2.T10.1.1.14.13.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.58</td>
</tr>
<tr id="A2.T10.1.1.15.14" class="ltx_tr">
<th id="A2.T10.1.1.15.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/ Full-rank Adaption</th>
<td id="A2.T10.1.1.15.14.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.15.14.2.1" class="ltx_text ltx_font_bold">99.89</span></td>
<td id="A2.T10.1.1.15.14.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.94</td>
<td id="A2.T10.1.1.15.14.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">81.08</td>
<td id="A2.T10.1.1.15.14.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">84.48</td>
</tr>
<tr id="A2.T10.1.1.16.15" class="ltx_tr">
<th id="A2.T10.1.1.16.15.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="A2.T10.1.1.16.15.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">99.46</td>
<td id="A2.T10.1.1.16.15.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.16.15.3.1" class="ltx_text ltx_font_bold">96.09</span></td>
<td id="A2.T10.1.1.16.15.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.16.15.4.1" class="ltx_text ltx_font_bold">93.62</span></td>
<td id="A2.T10.1.1.16.15.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.16.15.5.1" class="ltx_text ltx_font_bold">96.33</span></td>
</tr>
<tr id="A2.T10.1.1.17.16" class="ltx_tr">
<th id="A2.T10.1.1.17.16.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="3"><span id="A2.T10.1.1.17.16.1.1" class="ltx_text">Food101</span></th>
<th id="A2.T10.1.1.17.16.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/o Positive</th>
<td id="A2.T10.1.1.17.16.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.85</td>
<td id="A2.T10.1.1.17.16.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.42</td>
<td id="A2.T10.1.1.17.16.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.36</td>
<td id="A2.T10.1.1.17.16.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.14</td>
</tr>
<tr id="A2.T10.1.1.18.17" class="ltx_tr">
<th id="A2.T10.1.1.18.17.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP w/ Full-rank Adaption</th>
<td id="A2.T10.1.1.18.17.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.18.17.2.1" class="ltx_text ltx_font_bold">96.84</span></td>
<td id="A2.T10.1.1.18.17.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">62.21</td>
<td id="A2.T10.1.1.18.17.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.8</td>
<td id="A2.T10.1.1.18.17.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">75.09</td>
</tr>
<tr id="A2.T10.1.1.19.18" class="ltx_tr">
<th id="A2.T10.1.1.19.18.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;">FedPGP</th>
<td id="A2.T10.1.1.19.18.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.51</td>
<td id="A2.T10.1.1.19.18.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.19.18.3.1" class="ltx_text ltx_font_bold">88.37</span></td>
<td id="A2.T10.1.1.19.18.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.19.18.4.1" class="ltx_text ltx_font_bold">88.44</span></td>
<td id="A2.T10.1.1.19.18.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T10.1.1.19.18.5.1" class="ltx_text ltx_font_bold">90.04</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A2.SS3" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Effect of Number of Bottleneck</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.3" class="ltx_p">In this subsection, we explore the impact of the number of bottleneck <math id="A2.SS3.p1.1.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="A2.SS3.p1.1.m1.1a"><mi id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.1b"><ci id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.1c">b</annotation></semantics></math> in our low-rank decomposition of adaptation term <math id="A2.SS3.p1.2.m2.1" class="ltx_Math" alttext="\Delta p_{i}" display="inline"><semantics id="A2.SS3.p1.2.m2.1a"><mrow id="A2.SS3.p1.2.m2.1.1" xref="A2.SS3.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="A2.SS3.p1.2.m2.1.1.2" xref="A2.SS3.p1.2.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="A2.SS3.p1.2.m2.1.1.1" xref="A2.SS3.p1.2.m2.1.1.1.cmml">​</mo><msub id="A2.SS3.p1.2.m2.1.1.3" xref="A2.SS3.p1.2.m2.1.1.3.cmml"><mi id="A2.SS3.p1.2.m2.1.1.3.2" xref="A2.SS3.p1.2.m2.1.1.3.2.cmml">p</mi><mi id="A2.SS3.p1.2.m2.1.1.3.3" xref="A2.SS3.p1.2.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.2.m2.1b"><apply id="A2.SS3.p1.2.m2.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1"><times id="A2.SS3.p1.2.m2.1.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1.1"></times><ci id="A2.SS3.p1.2.m2.1.1.2.cmml" xref="A2.SS3.p1.2.m2.1.1.2">Δ</ci><apply id="A2.SS3.p1.2.m2.1.1.3.cmml" xref="A2.SS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.SS3.p1.2.m2.1.1.3.1.cmml" xref="A2.SS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="A2.SS3.p1.2.m2.1.1.3.2.cmml" xref="A2.SS3.p1.2.m2.1.1.3.2">𝑝</ci><ci id="A2.SS3.p1.2.m2.1.1.3.3.cmml" xref="A2.SS3.p1.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.2.m2.1c">\Delta p_{i}</annotation></semantics></math>. We present the accuracy results considering the impact of both the bottleneck and shot number using a random seed. It can be observed that the classification accuracy improves as the bottleneck and shot number increase, showing the number of bottleneck determines the extent to which the knowledge in the global prompt is rewritten. We select the number of bottleneck <math id="A2.SS3.p1.3.m3.1" class="ltx_Math" alttext="b=8" display="inline"><semantics id="A2.SS3.p1.3.m3.1a"><mrow id="A2.SS3.p1.3.m3.1.1" xref="A2.SS3.p1.3.m3.1.1.cmml"><mi id="A2.SS3.p1.3.m3.1.1.2" xref="A2.SS3.p1.3.m3.1.1.2.cmml">b</mi><mo id="A2.SS3.p1.3.m3.1.1.1" xref="A2.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.SS3.p1.3.m3.1.1.3" xref="A2.SS3.p1.3.m3.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.3.m3.1b"><apply id="A2.SS3.p1.3.m3.1.1.cmml" xref="A2.SS3.p1.3.m3.1.1"><eq id="A2.SS3.p1.3.m3.1.1.1.cmml" xref="A2.SS3.p1.3.m3.1.1.1"></eq><ci id="A2.SS3.p1.3.m3.1.1.2.cmml" xref="A2.SS3.p1.3.m3.1.1.2">𝑏</ci><cn type="integer" id="A2.SS3.p1.3.m3.1.1.3.cmml" xref="A2.SS3.p1.3.m3.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.3.m3.1c">b=8</annotation></semantics></math> for the balance of generalization and personalization.</p>
</div>
<figure id="A2.T11" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>Quantitative comparisons on 4 datasets across varying number of shots with different number of bottleneck in FedPGP over 10 clients.</figcaption>
<div id="A2.T11.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:312.2pt;height:223.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-58.0pt,41.4pt) scale(0.729123042584516,0.729123042584516) ;">
<table id="A2.T11.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T11.1.1.1.1" class="ltx_tr">
<th id="A2.T11.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Dataset</th>
<th id="A2.T11.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">Bottleneck</th>
<th id="A2.T11.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">1 shot</th>
<th id="A2.T11.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">2 shots</th>
<th id="A2.T11.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">4 shots</th>
<th id="A2.T11.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">8 shots</th>
<th id="A2.T11.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:0.5pt;padding-bottom:0.5pt;">16 shots</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T11.1.1.2.1" class="ltx_tr">
<th id="A2.T11.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="4"><span id="A2.T11.1.1.2.1.1.1" class="ltx_text">Oxford Pets</span></th>
<th id="A2.T11.1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</th>
<td id="A2.T11.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.4</td>
<td id="A2.T11.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.89</td>
<td id="A2.T11.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.96</td>
<td id="A2.T11.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.28</td>
<td id="A2.T11.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.12</td>
</tr>
<tr id="A2.T11.1.1.3.2" class="ltx_tr">
<th id="A2.T11.1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">2</th>
<td id="A2.T11.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.39</td>
<td id="A2.T11.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.04</td>
<td id="A2.T11.1.1.3.2.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.93</td>
<td id="A2.T11.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.91</td>
<td id="A2.T11.1.1.3.2.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.39</td>
</tr>
<tr id="A2.T11.1.1.4.3" class="ltx_tr">
<th id="A2.T11.1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">4</th>
<td id="A2.T11.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">92.51</td>
<td id="A2.T11.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.4.3.3.1" class="ltx_text ltx_font_bold">93.62</span></td>
<td id="A2.T11.1.1.4.3.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.66</td>
<td id="A2.T11.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.72</td>
<td id="A2.T11.1.1.4.3.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.32</td>
</tr>
<tr id="A2.T11.1.1.5.4" class="ltx_tr">
<th id="A2.T11.1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">8</th>
<td id="A2.T11.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.5.4.2.1" class="ltx_text ltx_font_bold">93.16</span></td>
<td id="A2.T11.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.12</td>
<td id="A2.T11.1.1.5.4.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.5.4.4.1" class="ltx_text ltx_font_bold">96.31</span></td>
<td id="A2.T11.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.5.4.5.1" class="ltx_text ltx_font_bold">97.93</span></td>
<td id="A2.T11.1.1.5.4.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.5.4.6.1" class="ltx_text ltx_font_bold">97.81</span></td>
</tr>
<tr id="A2.T11.1.1.6.5" class="ltx_tr">
<th id="A2.T11.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="4"><span id="A2.T11.1.1.6.5.1.1" class="ltx_text">Flowers102</span></th>
<th id="A2.T11.1.1.6.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</th>
<td id="A2.T11.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">86.89</td>
<td id="A2.T11.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.92</td>
<td id="A2.T11.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.26</td>
<td id="A2.T11.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.56</td>
<td id="A2.T11.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.75</td>
</tr>
<tr id="A2.T11.1.1.7.6" class="ltx_tr">
<th id="A2.T11.1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">2</th>
<td id="A2.T11.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.79</td>
<td id="A2.T11.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.95</td>
<td id="A2.T11.1.1.7.6.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.28</td>
<td id="A2.T11.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.60</td>
<td id="A2.T11.1.1.7.6.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.71</td>
</tr>
<tr id="A2.T11.1.1.8.7" class="ltx_tr">
<th id="A2.T11.1.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">4</th>
<td id="A2.T11.1.1.8.7.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.77</td>
<td id="A2.T11.1.1.8.7.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.86</td>
<td id="A2.T11.1.1.8.7.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.61</td>
<td id="A2.T11.1.1.8.7.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.8.7.5.1" class="ltx_text ltx_font_bold">98.92</span></td>
<td id="A2.T11.1.1.8.7.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.8.7.6.1" class="ltx_text ltx_font_bold">99.37</span></td>
</tr>
<tr id="A2.T11.1.1.9.8" class="ltx_tr">
<th id="A2.T11.1.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">8</th>
<td id="A2.T11.1.1.9.8.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.9.8.2.1" class="ltx_text ltx_font_bold">89.74</span></td>
<td id="A2.T11.1.1.9.8.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.9.8.3.1" class="ltx_text ltx_font_bold">96.55</span></td>
<td id="A2.T11.1.1.9.8.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.9.8.4.1" class="ltx_text ltx_font_bold">97.64</span></td>
<td id="A2.T11.1.1.9.8.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.88</td>
<td id="A2.T11.1.1.9.8.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">99.05</td>
</tr>
<tr id="A2.T11.1.1.10.9" class="ltx_tr">
<th id="A2.T11.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="4"><span id="A2.T11.1.1.10.9.1.1" class="ltx_text">DTD</span></th>
<th id="A2.T11.1.1.10.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</th>
<td id="A2.T11.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">53.13</td>
<td id="A2.T11.1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">60.52</td>
<td id="A2.T11.1.1.10.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">70.41</td>
<td id="A2.T11.1.1.10.9.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">85.61</td>
<td id="A2.T11.1.1.10.9.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">83.00</td>
</tr>
<tr id="A2.T11.1.1.11.10" class="ltx_tr">
<th id="A2.T11.1.1.11.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">2</th>
<td id="A2.T11.1.1.11.10.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">52.63</td>
<td id="A2.T11.1.1.11.10.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">58.77</td>
<td id="A2.T11.1.1.11.10.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">73.97</td>
<td id="A2.T11.1.1.11.10.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">87.75</td>
<td id="A2.T11.1.1.11.10.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">91.05</td>
</tr>
<tr id="A2.T11.1.1.12.11" class="ltx_tr">
<th id="A2.T11.1.1.12.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">4</th>
<td id="A2.T11.1.1.12.11.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">55.02</td>
<td id="A2.T11.1.1.12.11.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">66.05</td>
<td id="A2.T11.1.1.12.11.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">76.80</td>
<td id="A2.T11.1.1.12.11.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.12.11.5.1" class="ltx_text ltx_font_bold">89.27</span></td>
<td id="A2.T11.1.1.12.11.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">90.08</td>
</tr>
<tr id="A2.T11.1.1.13.12" class="ltx_tr">
<th id="A2.T11.1.1.13.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">8</th>
<td id="A2.T11.1.1.13.12.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.13.12.2.1" class="ltx_text ltx_font_bold">55.47</span></td>
<td id="A2.T11.1.1.13.12.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.13.12.3.1" class="ltx_text ltx_font_bold">69.91</span></td>
<td id="A2.T11.1.1.13.12.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.13.12.4.1" class="ltx_text ltx_font_bold">85.27</span></td>
<td id="A2.T11.1.1.13.12.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">89.16</td>
<td id="A2.T11.1.1.13.12.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.13.12.6.1" class="ltx_text ltx_font_bold">92.00</span></td>
</tr>
<tr id="A2.T11.1.1.14.13" class="ltx_tr">
<th id="A2.T11.1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;" rowspan="4"><span id="A2.T11.1.1.14.13.1.1" class="ltx_text">Caltech101</span></th>
<th id="A2.T11.1.1.14.13.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">1</th>
<td id="A2.T11.1.1.14.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.46</td>
<td id="A2.T11.1.1.14.13.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.93</td>
<td id="A2.T11.1.1.14.13.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.06</td>
<td id="A2.T11.1.1.14.13.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.62</td>
<td id="A2.T11.1.1.14.13.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.40</td>
</tr>
<tr id="A2.T11.1.1.15.14" class="ltx_tr">
<th id="A2.T11.1.1.15.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">2</th>
<td id="A2.T11.1.1.15.14.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">93.27</td>
<td id="A2.T11.1.1.15.14.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.36</td>
<td id="A2.T11.1.1.15.14.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">96.69</td>
<td id="A2.T11.1.1.15.14.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.89</td>
<td id="A2.T11.1.1.15.14.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.33</td>
</tr>
<tr id="A2.T11.1.1.16.15" class="ltx_tr">
<th id="A2.T11.1.1.16.15.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-top:0.5pt;padding-bottom:0.5pt;">4</th>
<td id="A2.T11.1.1.16.15.2" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">94.44</td>
<td id="A2.T11.1.1.16.15.3" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.16.15.3.1" class="ltx_text ltx_font_bold">96.32</span></td>
<td id="A2.T11.1.1.16.15.4" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">97.02</td>
<td id="A2.T11.1.1.16.15.5" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.20</td>
<td id="A2.T11.1.1.16.15.6" class="ltx_td ltx_align_center" style="padding-top:0.5pt;padding-bottom:0.5pt;">98.30</td>
</tr>
<tr id="A2.T11.1.1.17.16" class="ltx_tr">
<th id="A2.T11.1.1.17.16.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">8</th>
<td id="A2.T11.1.1.17.16.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.17.16.2.1" class="ltx_text ltx_font_bold">95.74</span></td>
<td id="A2.T11.1.1.17.16.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;">95.10</td>
<td id="A2.T11.1.1.17.16.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.17.16.4.1" class="ltx_text ltx_font_bold">98.09</span></td>
<td id="A2.T11.1.1.17.16.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.17.16.5.1" class="ltx_text ltx_font_bold">98.28</span></td>
<td id="A2.T11.1.1.17.16.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.5pt;padding-bottom:0.5pt;"><span id="A2.T11.1.1.17.16.6.1" class="ltx_text ltx_font_bold">99.00</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A2.SS4" class="ltx_subsection ltx_indent_first">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Learning Curves</h3>

<div id="A2.SS4.p1" class="ltx_para">
<p id="A2.SS4.p1.2" class="ltx_p">To analyze the convergence pattern of our FedPGP, we visualized the test accuracy across 10 clients with a local training epoch <math id="A2.SS4.p1.1.m1.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="A2.SS4.p1.1.m1.1a"><mrow id="A2.SS4.p1.1.m1.1.1" xref="A2.SS4.p1.1.m1.1.1.cmml"><mi id="A2.SS4.p1.1.m1.1.1.2" xref="A2.SS4.p1.1.m1.1.1.2.cmml">E</mi><mo id="A2.SS4.p1.1.m1.1.1.1" xref="A2.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS4.p1.1.m1.1.1.3" xref="A2.SS4.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p1.1.m1.1b"><apply id="A2.SS4.p1.1.m1.1.1.cmml" xref="A2.SS4.p1.1.m1.1.1"><eq id="A2.SS4.p1.1.m1.1.1.1.cmml" xref="A2.SS4.p1.1.m1.1.1.1"></eq><ci id="A2.SS4.p1.1.m1.1.1.2.cmml" xref="A2.SS4.p1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="A2.SS4.p1.1.m1.1.1.3.cmml" xref="A2.SS4.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p1.1.m1.1c">E=2</annotation></semantics></math> and communication round <math id="A2.SS4.p1.2.m2.1" class="ltx_Math" alttext="T=25" display="inline"><semantics id="A2.SS4.p1.2.m2.1a"><mrow id="A2.SS4.p1.2.m2.1.1" xref="A2.SS4.p1.2.m2.1.1.cmml"><mi id="A2.SS4.p1.2.m2.1.1.2" xref="A2.SS4.p1.2.m2.1.1.2.cmml">T</mi><mo id="A2.SS4.p1.2.m2.1.1.1" xref="A2.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS4.p1.2.m2.1.1.3" xref="A2.SS4.p1.2.m2.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS4.p1.2.m2.1b"><apply id="A2.SS4.p1.2.m2.1.1.cmml" xref="A2.SS4.p1.2.m2.1.1"><eq id="A2.SS4.p1.2.m2.1.1.1.cmml" xref="A2.SS4.p1.2.m2.1.1.1"></eq><ci id="A2.SS4.p1.2.m2.1.1.2.cmml" xref="A2.SS4.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="A2.SS4.p1.2.m2.1.1.3.cmml" xref="A2.SS4.p1.2.m2.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS4.p1.2.m2.1c">T=25</annotation></semantics></math>. The results are illustrated in Figure <a href="#A2.F4" title="Figure 4 ‣ B.4 Learning Curves ‣ Appendix B Additional Experimental Results ‣ Harmonizing Generalization and Personalization in Federated Prompt Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, revealing accelerated convergence and enhanced stability exhibited by FedPGP.</p>
</div>
<figure id="A2.F4" class="ltx_figure"><img src="/html/2405.09771/assets/x5.png" id="A2.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="242" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Accuracy learning curves of FedPGP and baselines on four datasets over 10 clients.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.09769" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.09771" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.09771">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.09771" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.09772" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 17:27:42 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
