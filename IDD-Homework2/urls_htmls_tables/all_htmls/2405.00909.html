<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2405.00909] Quantum Federated Learning Experiments in the Cloud with Data Encoding</title><meta property="og:description" content="Quantum Federated Learning (QFL) is an emerging concept that aims to unfold federated learning (FL) over quantum networks, enabling collaborative quantum model training along with local data privacy. We explore the cha…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Quantum Federated Learning Experiments in the Cloud with Data Encoding">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Quantum Federated Learning Experiments in the Cloud with Data Encoding">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2405.00909">

<!--Generated on Wed Jun  5 13:54:09 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Quantum Federated Learning Experiments in the Cloud with Data Encoding</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shiva Raj Pokhrel,
Naman Yash,
Jonathan Kua,
Gang Li and
Lei Pan
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id1.id1" class="ltx_p">Quantum Federated Learning (QFL) is an emerging concept that aims to unfold federated learning (FL) over quantum networks, enabling collaborative quantum model training along with local data privacy. We explore the challenges of deploying QFL on cloud platforms, emphasizing quantum intricacies and platform limitations. The proposed data-encoding-driven QFL, with a proof of concept (GitHub Open Source) using genomic data sets on quantum simulators, shows promising results.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Authors are from IoT &amp; SE Lab, School of IT, Deakin University, shiva.pokhrel@deakin.edu.au.</span></span></span></p>
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span></span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span></span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span></span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Quantum computing has unlocked unprecedented computational capabilities, offering solutions to problems beyond classical computers’ reach <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib1" title="" class="ltx_ref">gill2022quantum, </a>)</cite>. This breakthrough holds particular promise in machine learning, where quantum algorithms can vastly accelerate data processing, impacting sectors like healthcare, finance, and cybersecurity <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib2" title="" class="ltx_ref">QFLRnC, </a>; <a href="#bib.bib3" title="" class="ltx_ref">QFLwQD, </a>)</cite>. By harnessing quantum computing, we can tackle previously insurmountable challenges, marking a significant milestone in computational science and its practical applications.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Our focus lies on Quantum Federated Learning (QFL), a frontier merging federated learning (FL) principles with quantum machine learning (QML) over quantum networks <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib4" title="" class="ltx_ref">caro2022generalization, </a>)</cite>. FL, designed to train models on decentralized devices while preserving data privacy, offers a potent solution for data analysis. By marrying FL with QML, our goal is to enhance computational efficiency and model performance within the quantum realm, all while safeguarding data privacy. Our key contribution lies in crafting and implementing a QFL algorithm, leveraging the potential of cloud-based quantum computing platforms. The analysis of various quantum cloud service providers is crucial to grasp the unique challenges and opportunities in this burgeoning field. Understanding existing quantum cloud infrastructures’ capabilities, limitations, and progression roadmaps is paramount for translating FL principles into practical quantum implementations.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In classic FL, each client trains its model locally, sending model parameters to a global server for aggregation without sharing raw data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">9079513, </a>)</cite>. Our paper demonstrates the feasibility of QFL using IBM’s Qiskit quantum computing library, distinguishing itself by integrating FL into QML, specifically in cloud-based platforms. Our contributions encompass an in-depth analysis of current cloud-based quantum resources for QFL suitability and a proposal for a data-encoding-driven QFL implementation. By comparing state-of-the-art FL techniques, we aim to surmount challenges associated with deploying QFL algorithms.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The novelty of this research lies in its potential to expedite QFL adoption, paving the way for quantum-enhanced machine learning models over the cloud trained efficiently in a distributed setting while upholding local privacy. We design a novel process, as illustrated with Qiskit components in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, that can be perceived as approximately transforming input data into a quantum state, exploring and exploiting it using a customizable parameterized quantum circuit, and iteratively optimizing the parameters to steer and achieve the desired outcome based on the global objective function.
The background details are discussed later in Sec. <a href="#S3" title="3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> with implementation details deferred later in Sec. <a href="#S3.SS2" title="3.2. Implementation in Qiskit ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In the proposed QFL realization, clients transform their unique data into quantum states using a Feature Map, then process them with a parameterized quantum circuit (Ansatz) where local training is conducted using Qiskit and the updated weights are aggregated centrally, and global weights are returned to clients for local model updates.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2405.00909/assets/quant_1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="538" height="235" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>A high level view of local learning in the proposed QFL Process consisting of several key components. The <span id="S1.F1.5.1" class="ltx_text ltx_font_italic">Feature Map</span> ingests input data and encodes it into a quantum state. Following this, the <span id="S1.F1.6.2" class="ltx_text ltx_font_italic">Ansatz</span> comes into play as a parameterized quantum circuit, with its parameters being iteratively fed by the<span id="S1.F1.7.3" class="ltx_text ltx_font_italic"> Optimizer</span>–optimization objective function is driven by the outcomes from the <span id="S1.F1.8.4" class="ltx_text ltx_font_italic">Sampler</span>.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>State of quantum computing</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Quantum computing and QML promise dramatic speedups over classical machines for certain tasks. A prime example is the popular Shor’s algorithm for factoring integers, where quantum computing provides an exponential advantage over the best-known classical methods <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib6" title="" class="ltx_ref">Shor94, </a>)</cite>. Major tech firms are currently racing to build proprietary quantum hardware and offer cloud access. However, despite rapid progress quantum hardware development is still in nascent development stages <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib2" title="" class="ltx_ref">QFLRnC, </a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Major tech companies like IBM, Amazon and Microsoft now offer cloud-based access to quantum computers. This allows users to experiment with the latest quantum algorithms without investing in specialized labs or hardware. IBM has emerged as an early front-runner, recently unveiling a 433-qubit quantum processor that currently reigns as the most powerful quantum system.<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>IBM unveils 400 qubit-plus quantum processor and next-generation IBM Quantum System Two, <a target="_blank" href="https://newsroom.ibm.com/2022-11-09-IBM-Unveils-400-Qubit-Plus-Quantum-Processor-and-Next-Generation-IBM-Quantum-System-Two" title="" class="ltx_ref ltx_href">link</a></span></span></span> In contrast, Amazon and Microsoft provide access to a diverse range of third-party quantum processors, like IONQ’s Harmony and Rigetti’s Ankaa-1. By using AWS Braket and Azure Quantum, researchers can test algorithms on systems like IONQ’s 32-qubit Harmony or Rigetti’s 80-qubit Ankaa processor. As underlying quantum technologies continue rapidly improving, we should see more powerful processors integrated into the cloud ecosystems <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib7" title="" class="ltx_ref">AzurePricing, </a>; <a href="#bib.bib8" title="" class="ltx_ref">AmazonBraket, </a>)</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">QML shows promise but remains in early developmental stages. While programming frameworks like IBM’s Qiskit are emerging as robust tools, there is a lack of standardization of different software libraries and limited developer forums and up-to-date resources which pose challenges to newcomers in the field. Cloud-based access aims to increase experimentation by removing on-premises infrastructure barriers. However, resource contention on shared quantum hardware can result in prolonged queuing delays before algorithms execute. This severely impacts techniques like QFL ( a full-fledge federation of QML) which require repeated access to quantum circuits for the model training.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">While QFL holds immense potential, the current landscape faces challenges in hardware development, software standardization, and efficient cloud-based access for QFL. Looking at specific QML roadmaps, IBM aims to unveil Quantum System Two in 2024, a modular platform paving the way for a scalable quantum-centric ecosystem. By 2025, IBM targets Quantum Condor, a processor with over 1,000 qubits. IONQ focuses on practical quantum devices, projecting increased algorithmic qubits in their Forte and Tempo systems. Google’s focus on increasing qubits, achieving a logical qubit prototype, and forming industry partnerships showcases its commitment to practical quantum applications. Meanwhile, Rigetti Computing’s strides include launching Ankaa and Lyra processors and collaborations to enhance quantum cloud services, with plans to deploy testbeds at Fermilab by 2025.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">Developed by IBM, Qiskit<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://qiskit-community.github.io/qiskit-machine-learning/</span></span></span> can play an important role in driving the substantial research and development progress of QFL. Its capabilities in quantum simulation and QML are key factors in overcoming QFL operationalization challenges and pushing the boundaries of this emerging field.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Operationalizing QFL in Qiskit</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In the realm of quantum computing, Qiskit’s quantum simulators <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib9" title="" class="ltx_ref">IonQ_simulator_2023, </a>)</cite> emerge as indispensable tools, empowering developers to test quantum algorithms on classical computers. These simulators serve as flexible platforms that facilitate robust algorithm development and testing processes. Their accessibility benefits users of all levels of proficiency, reducing the iterative journey of algorithm refinement <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib10" title="" class="ltx_ref">kashifQiskitSim, </a>)</cite>. By providing a means to test algorithms on classical machines, they eliminate hardware access barriers while faithfully emulating the expected behavior of actual quantum systems. This capability accelerates rapid prototyping, empowering developers to iterate and refine without incurring costly overhead. Embracing Qiskit’s quantum simulators is not just a choice, it is a strategic imperative for advancing distributed quantum algorithms development efficiently and effectively.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Modeling QML Libraries</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Advances in the Qiskit’s QML libraries will be cutting-edge contributions to advancing QFL. The existing library includes pre-built implementations of classifiers like the Variational Quantum Classifier (<a target="_blank" href="https://qiskit-community.github.io/qiskit-machine-learning/stubs/qiskit_machine_learning.algorithms.VQC.html#" title="" class="ltx_ref ltx_href">VQC</a>) and the Quantum Support Vector Regressor (<a target="_blank" href="https://qiskit-community.github.io/qiskit-machine-learning/stubs/qiskit_machine_learning.algorithms.QSVR.html#" title="" class="ltx_ref ltx_href">QSVR</a>). Extending these classifiers are vital in constructing QFL models, which form the foundation for success of the framework proposed in this paper. By offering ready-to-use modules, Qiskit simplifies the development cycle, allowing researchers and developers to focus on tailoring QFL models to specific application requirements.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the quantum machine learning process enabled by extending the <a target="_blank" href="https://qiskit-community.github.io/qiskit-machine-learning/stubs/qiskit_machine_learning.algorithms.VQC.html#" title="" class="ltx_ref ltx_href">VQC</a>. In our QFL implementation, the VQC uses <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_typewriter">RawFeatureVector()</span> as a feature map to encode classical data into quantum states. This feature map transforms classical input vectors into quantum states through a series of quantum gates, effectively preparing the quantum data for analysis. The <span id="S3.SS1.p2.1.2" class="ltx_text ltx_font_typewriter">Sampler()</span> component executes the quantum circuits on various backends, which can be either simulators or real quantum hardware, thereby providing the flexibility to test and run quantum machine learning models in different environments. As shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the ansatz is a parameterized quantum circuit that is repeatedly run, where each iteration or’rep’ applies a sequence of gates whose parameters are adjusted in each step of the optimization process. The <span id="S3.SS1.p2.1.3" class="ltx_text ltx_font_typewriter">RealAmplitudes()</span> in ansatz is used within variational circuits to construct quantum states that are optimized for our QFL operationalization. The optimization is performed by employing the <span id="S3.SS1.p2.1.4" class="ltx_text ltx_font_typewriter">COBYLA()</span> algorithm, a gradient-free optimizer suitable for the noisy conditions of current quantum technology. <span id="S3.SS1.p2.1.5" class="ltx_text ltx_font_typewriter">COBYLA</span> iteratively adjusts the parameters of the ansatz in an attempt to minimize a loss function, guiding the model towards the most accurate classifications possible given the input data. This synergy of components represents the architecture of a VQC, which transforms classical data for quantum processing, leverages quantum computation for machine learning tasks, and optimizes its performance over multiple iterations.<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>https://qiskit-community.github.io/qiskit-machine-learning/</span></span></span></p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">It is worth noting that Qiskit’s quantum simulators and libraries collectively empower researchers and developers to develop and evaluate new QML and QFL algorithms easily. Furthermore, the inclusion of extended libraries within Qiskit shows a broader commitment to the evolution of distributed quantum machine learning algorithms.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Implementation in Qiskit</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In our pursuit of new strategies to operationalize QFL, we embark on an evolutionary journey from traditional FL. Witnessing the decentralization of model training in FL, where clients actively contribute while preserving data privacy, marks a pivotal phase. However, the transition to QFL introduces practical challenges demanding a fresh perspective.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Currently, achieving QFL with quantum devices on each client poses significant hurdles, primarily due to the absence of small-scale quantum devices on client-side platforms. The quantum computing landscape is dominated by technologies like superconducting qubits and ion trap-based quantum computers, which lack mobility.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">In our current QFL implementation, client and global model training occurs primarily on the server. Clients provide data utilized for training on the server, which then returns client models. This orchestration, occurring after each epoch, represents a pragmatic compromise balancing quantum computing capabilities with the absence of client-side quantum devices and edge computing limitations.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">To pioneer the operationalization of QFL, we leverage IBM’s quantum cloud platform, tapping into its array of quantum processors and simulators. Utilizing Qiskit’s simulation capabilities forms the foundation for implementing the QFL framework, opting for established frameworks such as QFedAvg. Our proposed design and implementation of QFL is shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2. Implementation in Qiskit ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and is detailed in the following.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2405.00909/assets/qFed1.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="479" height="419" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span><span id="S3.F2.2.1" class="ltx_text ltx_font_italic">QFL Process.</span> Each client in the setup trains models locally and only shares its parameters with a central server (step 1). The server aggregates these to enhance the global model(step 2), then circulates the updated parameters back to clients(step 3), preserving data privacy as client data stays local.</figcaption>
</figure>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.5" class="ltx_p">We consider a server, as shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2. Implementation in Qiskit ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, coexists with a set <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">K</annotation></semantics></math> of quantum computing clients, collectively training a distributed quantum neural network model (QNN) <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib11" title="" class="ltx_ref">cong2019quantum, </a>)</cite>. Each client possesses a local dataset comprising quantum states <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="{|\psi_{m}\rangle}" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.2.m2.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p5.2.m2.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.1.1.2.cmml">ψ</mi><mi id="S3.SS2.p5.2.m2.1.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.SS2.p5.2.m2.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.2.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1"><csymbol cd="latexml" id="S3.SS2.p5.2.m2.1.1.2.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.2">ket</csymbol><apply id="S3.SS2.p5.2.m2.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.2">𝜓</ci><ci id="S3.SS2.p5.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">{|\psi_{m}\rangle}</annotation></semantics></math> and corresponding labels <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="{y_{m}}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">y</mi><mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝑦</ci><ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">{y_{m}}</annotation></semantics></math> for <math id="S3.SS2.p5.4.m4.3" class="ltx_Math" alttext="m=1,...,M_{k}" display="inline"><semantics id="S3.SS2.p5.4.m4.3a"><mrow id="S3.SS2.p5.4.m4.3.3" xref="S3.SS2.p5.4.m4.3.3.cmml"><mi id="S3.SS2.p5.4.m4.3.3.3" xref="S3.SS2.p5.4.m4.3.3.3.cmml">m</mi><mo id="S3.SS2.p5.4.m4.3.3.2" xref="S3.SS2.p5.4.m4.3.3.2.cmml">=</mo><mrow id="S3.SS2.p5.4.m4.3.3.1.1" xref="S3.SS2.p5.4.m4.3.3.1.2.cmml"><mn id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">1</mn><mo id="S3.SS2.p5.4.m4.3.3.1.1.2" xref="S3.SS2.p5.4.m4.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p5.4.m4.2.2" xref="S3.SS2.p5.4.m4.2.2.cmml">…</mi><mo id="S3.SS2.p5.4.m4.3.3.1.1.3" xref="S3.SS2.p5.4.m4.3.3.1.2.cmml">,</mo><msub id="S3.SS2.p5.4.m4.3.3.1.1.1" xref="S3.SS2.p5.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS2.p5.4.m4.3.3.1.1.1.2" xref="S3.SS2.p5.4.m4.3.3.1.1.1.2.cmml">M</mi><mi id="S3.SS2.p5.4.m4.3.3.1.1.1.3" xref="S3.SS2.p5.4.m4.3.3.1.1.1.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.3b"><apply id="S3.SS2.p5.4.m4.3.3.cmml" xref="S3.SS2.p5.4.m4.3.3"><eq id="S3.SS2.p5.4.m4.3.3.2.cmml" xref="S3.SS2.p5.4.m4.3.3.2"></eq><ci id="S3.SS2.p5.4.m4.3.3.3.cmml" xref="S3.SS2.p5.4.m4.3.3.3">𝑚</ci><list id="S3.SS2.p5.4.m4.3.3.1.2.cmml" xref="S3.SS2.p5.4.m4.3.3.1.1"><cn type="integer" id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">1</cn><ci id="S3.SS2.p5.4.m4.2.2.cmml" xref="S3.SS2.p5.4.m4.2.2">…</ci><apply id="S3.SS2.p5.4.m4.3.3.1.1.1.cmml" xref="S3.SS2.p5.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.p5.4.m4.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS2.p5.4.m4.3.3.1.1.1.2">𝑀</ci><ci id="S3.SS2.p5.4.m4.3.3.1.1.1.3.cmml" xref="S3.SS2.p5.4.m4.3.3.1.1.1.3">𝑘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.3c">m=1,...,M_{k}</annotation></semantics></math>, which serve as the foundation for training an individual QCNN with learnable parameters <math id="S3.SS2.p5.5.m5.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S3.SS2.p5.5.m5.1a"><msub id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><mi id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml">θ</mi><mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2">𝜃</ci><ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">\theta_{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">The model parameter vector, denoted as <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\theta_{k}" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><msub id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.1.1.2" xref="S3.SS2.p6.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p6.1.m1.1.1.3" xref="S3.SS2.p6.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><apply id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\theta_{k}</annotation></semantics></math>, encapsulates all learnable parameters essential for both quantum circuit operations and classical components. Our principal objective lies in optimizing the QNN model’s performance, enabling accurate predictions based on the quantum states within each client’s dataset. This innovative approach sets the stage for exploring the intricate intersection of quantum computing and federated learning, opening avenues for transformative advancements in QFL.
For simplicity and tractability, we utilize the mean squared error (MSE) loss function:</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="J(\theta_{k})=\frac{1}{2M_{k}}\sum_{m=1}^{M_{k}}(y_{m}-f_{\theta_{k}}(|\psi_{m}\rangle))^{2}" display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">J</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml">=</mo><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mfrac id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml"><mn id="S3.E1.m1.2.2.2.3.2" xref="S3.E1.m1.2.2.2.3.2.cmml">1</mn><mrow id="S3.E1.m1.2.2.2.3.3" xref="S3.E1.m1.2.2.2.3.3.cmml"><mn id="S3.E1.m1.2.2.2.3.3.2" xref="S3.E1.m1.2.2.2.3.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.3.3.1" xref="S3.E1.m1.2.2.2.3.3.1.cmml">​</mo><msub id="S3.E1.m1.2.2.2.3.3.3" xref="S3.E1.m1.2.2.2.3.3.3.cmml"><mi id="S3.E1.m1.2.2.2.3.3.3.2" xref="S3.E1.m1.2.2.2.3.3.3.2.cmml">M</mi><mi id="S3.E1.m1.2.2.2.3.3.3.3" xref="S3.E1.m1.2.2.2.3.3.3.3.cmml">k</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.1.cmml"><munderover id="S3.E1.m1.2.2.2.1.2" xref="S3.E1.m1.2.2.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.2.2.2.1.2.2.2" xref="S3.E1.m1.2.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.2.1.2.2.3" xref="S3.E1.m1.2.2.2.1.2.2.3.cmml"><mi id="S3.E1.m1.2.2.2.1.2.2.3.2" xref="S3.E1.m1.2.2.2.1.2.2.3.2.cmml">m</mi><mo id="S3.E1.m1.2.2.2.1.2.2.3.1" xref="S3.E1.m1.2.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.2.1.2.2.3.3" xref="S3.E1.m1.2.2.2.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E1.m1.2.2.2.1.2.3" xref="S3.E1.m1.2.2.2.1.2.3.cmml"><mi id="S3.E1.m1.2.2.2.1.2.3.2" xref="S3.E1.m1.2.2.2.1.2.3.2.cmml">M</mi><mi id="S3.E1.m1.2.2.2.1.2.3.3" xref="S3.E1.m1.2.2.2.1.2.3.3.cmml">k</mi></msub></munderover><msup id="S3.E1.m1.2.2.2.1.1" xref="S3.E1.m1.2.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.2.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.2.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3.3.cmml">m</mi></msub><mo id="S3.E1.m1.2.2.2.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E1.m1.2.2.2.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.2.cmml">f</mi><msub id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2.cmml">θ</mi><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ψ</mi><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">⟩</mo></mrow><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E1.m1.2.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E1.m1.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><eq id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3"></eq><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝐽</ci><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"></times><apply id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"><divide id="S3.E1.m1.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.3"></divide><cn type="integer" id="S3.E1.m1.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.2.3.2">1</cn><apply id="S3.E1.m1.2.2.2.3.3.cmml" xref="S3.E1.m1.2.2.2.3.3"><times id="S3.E1.m1.2.2.2.3.3.1.cmml" xref="S3.E1.m1.2.2.2.3.3.1"></times><cn type="integer" id="S3.E1.m1.2.2.2.3.3.2.cmml" xref="S3.E1.m1.2.2.2.3.3.2">2</cn><apply id="S3.E1.m1.2.2.2.3.3.3.cmml" xref="S3.E1.m1.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.3.3.3.1.cmml" xref="S3.E1.m1.2.2.2.3.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.3.3.3.2.cmml" xref="S3.E1.m1.2.2.2.3.3.3.2">𝑀</ci><ci id="S3.E1.m1.2.2.2.3.3.3.3.cmml" xref="S3.E1.m1.2.2.2.3.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1"><apply id="S3.E1.m1.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.2.1.2">superscript</csymbol><apply id="S3.E1.m1.2.2.2.1.2.2.cmml" xref="S3.E1.m1.2.2.2.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1.2">subscript</csymbol><sum id="S3.E1.m1.2.2.2.1.2.2.2.cmml" xref="S3.E1.m1.2.2.2.1.2.2.2"></sum><apply id="S3.E1.m1.2.2.2.1.2.2.3.cmml" xref="S3.E1.m1.2.2.2.1.2.2.3"><eq id="S3.E1.m1.2.2.2.1.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.1.2.2.3.1"></eq><ci id="S3.E1.m1.2.2.2.1.2.2.3.2.cmml" xref="S3.E1.m1.2.2.2.1.2.2.3.2">𝑚</ci><cn type="integer" id="S3.E1.m1.2.2.2.1.2.2.3.3.cmml" xref="S3.E1.m1.2.2.2.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.2.2.2.1.2.3.cmml" xref="S3.E1.m1.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.2.3.1.cmml" xref="S3.E1.m1.2.2.2.1.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.2.3.2.cmml" xref="S3.E1.m1.2.2.2.1.2.3.2">𝑀</ci><ci id="S3.E1.m1.2.2.2.1.2.3.3.cmml" xref="S3.E1.m1.2.2.2.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1"><minus id="S3.E1.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.2"></minus><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.3.3">𝑚</ci></apply><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1"><times id="S3.E1.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.2">𝑓</ci><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.2">𝜃</ci><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2">ket</csymbol><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝜓</ci><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></apply><cn type="integer" id="S3.E1.m1.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">J(\theta_{k})=\frac{1}{2M_{k}}\sum_{m=1}^{M_{k}}(y_{m}-f_{\theta_{k}}(|\psi_{m}\rangle))^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p7.1" class="ltx_p">and adopt locally via the VQC <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib12" title="" class="ltx_ref">yano2021efficient, </a>)</cite>. In the proposed approach, each client device has access to its own dataset and trains its model locally. The primary goal is along the lines of FL design principles as to collectively train a global model without sharing raw data among clients, thereby preserving data privacy <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib13" title="" class="ltx_ref">mcmahan2017communication, </a>)</cite>.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.1" class="ltx_p">Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2. Implementation in Qiskit ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the federation process of the proposed QFL, which involves the following stages:</p>
</div>
<div id="S3.SS2.p9" class="ltx_para ltx_noindent">
<p id="S3.SS2.p9.2" class="ltx_p"><span id="S3.SS2.p9.2.1" class="ltx_text ltx_font_bold">Local Training</span>: Each client uses its quantum circuit to process its part of the dataset. The local quantum model is then trained using this data.
<br class="ltx_break"><span id="S3.SS2.p9.2.2" class="ltx_text ltx_font_bold">Parameter Sharing</span>: Upon completion of training in each epoch, clients send their quantum circuit parameters (model weights) to a central server.
<br class="ltx_break"><span id="S3.SS2.p9.2.3" class="ltx_text ltx_font_bold">Aggregation</span>: The server aggregates these local updates using techniques like simple averaging, weighted averaging, or best pick <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib13" title="" class="ltx_ref">mcmahan2017communication, </a>)</cite>. This aggregation results in an updated global model.
<br class="ltx_break"><span id="S3.SS2.p9.2.4" class="ltx_text ltx_font_bold">Global Model Update</span>: The updated weights of the global model are sent back to the client devices.
<br class="ltx_break"><span id="S3.SS2.p9.2.5" class="ltx_text ltx_font_bold">Local Model Update</span>: Each client updates its local model using global weights. The weight updation formula evolves as</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\mathrm{\theta^{h+1}}=\alpha\times\mathrm{\theta^{h}}+(1-\alpha)\times\mathrm{global(\theta^{h+1})}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><msup id="S3.E2.m1.2.2.4" xref="S3.E2.m1.2.2.4.cmml"><mi id="S3.E2.m1.2.2.4.2" xref="S3.E2.m1.2.2.4.2.cmml">θ</mi><mrow id="S3.E2.m1.2.2.4.3" xref="S3.E2.m1.2.2.4.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.2.2.4.3.2" xref="S3.E2.m1.2.2.4.3.2.cmml">h</mi><mo id="S3.E2.m1.2.2.4.3.1" xref="S3.E2.m1.2.2.4.3.1.cmml">+</mo><mn id="S3.E2.m1.2.2.4.3.3" xref="S3.E2.m1.2.2.4.3.3.cmml">1</mn></mrow></msup><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.4.cmml"><mi id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.4.1.cmml">×</mo><msup id="S3.E2.m1.2.2.2.4.3" xref="S3.E2.m1.2.2.2.4.3.cmml"><mi id="S3.E2.m1.2.2.2.4.3.2" xref="S3.E2.m1.2.2.2.4.3.2.cmml">θ</mi><mi mathvariant="normal" id="S3.E2.m1.2.2.2.4.3.3" xref="S3.E2.m1.2.2.2.4.3.3.cmml">h</mi></msup></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">+</mo><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">×</mo><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">global</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.2.1.1.cmml">(</mo><msup id="S3.E2.m1.2.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.2.2.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.2.2.1.1.2.cmml">θ</mi><mrow id="S3.E2.m1.2.2.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.2.2.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.2.2.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.2.2.1.1.3.2.cmml">h</mi><mo id="S3.E2.m1.2.2.2.2.2.1.1.3.1" xref="S3.E2.m1.2.2.2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.E2.m1.2.2.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></eq><apply id="S3.E2.m1.2.2.4.cmml" xref="S3.E2.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.4.1.cmml" xref="S3.E2.m1.2.2.4">superscript</csymbol><ci id="S3.E2.m1.2.2.4.2.cmml" xref="S3.E2.m1.2.2.4.2">𝜃</ci><apply id="S3.E2.m1.2.2.4.3.cmml" xref="S3.E2.m1.2.2.4.3"><plus id="S3.E2.m1.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.4.3.1"></plus><ci id="S3.E2.m1.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.4.3.2">h</ci><cn type="integer" id="S3.E2.m1.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.4.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><plus id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"></plus><apply id="S3.E2.m1.2.2.2.4.cmml" xref="S3.E2.m1.2.2.2.4"><times id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.1"></times><ci id="S3.E2.m1.2.2.2.4.2.cmml" xref="S3.E2.m1.2.2.2.4.2">𝛼</ci><apply id="S3.E2.m1.2.2.2.4.3.cmml" xref="S3.E2.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.4.3.1.cmml" xref="S3.E2.m1.2.2.2.4.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.4.3.2.cmml" xref="S3.E2.m1.2.2.2.4.3.2">𝜃</ci><ci id="S3.E2.m1.2.2.2.4.3.3.cmml" xref="S3.E2.m1.2.2.2.4.3.3">h</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3"></times><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">global</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.2.2.1.1.2">𝜃</ci><apply id="S3.E2.m1.2.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.2.2.1.1.3"><plus id="S3.E2.m1.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.1.1.3.1"></plus><ci id="S3.E2.m1.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.1.1.3.2">h</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.1.1.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\mathrm{\theta^{h+1}}=\alpha\times\mathrm{\theta^{h}}+(1-\alpha)\times\mathrm{global(\theta^{h+1})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.p9.1" class="ltx_p">where <math id="S3.SS2.p9.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p9.1.m1.1a"><mi id="S3.SS2.p9.1.m1.1.1" xref="S3.SS2.p9.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p9.1.m1.1b"><ci id="S3.SS2.p9.1.m1.1.1.cmml" xref="S3.SS2.p9.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p9.1.m1.1c">\alpha</annotation></semantics></math> is a weighting factor determined by the current epoch and specific to each client.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2405.00909/assets/Fig_2.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="383" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span><span id="S3.F3.2.1" class="ltx_text ltx_font_italic">Details of the QFL framework.</span> Each client possesses unique data (V1, V2, V3), which undergoes transformation into quantum states using a Feature Map of size 255. These quantum states are then processed by a parameterized quantum circuit (Ansatz) with a depth of 3 and 32 weights. Local training using these quantum components is performed using the Qiskit Simulator. After training, the updated weights from the Ansatz are sent to the server for aggregation, where parameters from all clients are combined, and finally, the aggregated global weights are returned to the clients for local model updates.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span> Analyzing Aggregation Schemes</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.4" class="ltx_p">Three weight aggregation schemes are employed to refine the global model by managing client updates effectively. Firstly, Simple Averaging calculates the average of all local model updates. Mathematically, the new global model parameters <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\theta^{h+1}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msup id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">h</mi><mo id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝜃</ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><plus id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></plus><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">ℎ</ci><cn type="integer" id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\theta^{h+1}</annotation></semantics></math> are determined as the mean of parameters from individual client models, represented by <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\theta_{k}^{h}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msubsup id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">θ</mi><mi id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml">k</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">𝜃</ci><ci id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\theta_{k}^{h}</annotation></semantics></math> for the <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msup id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">k</mi><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.1.1.3.1" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">superscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑘</ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><times id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1"></times><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">k^{th}</annotation></semantics></math> client’s model in the <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="h^{th}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msup id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">h</mi><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">ℎ</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><times id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">h^{th}</annotation></semantics></math> iteration.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\theta^{h+1}=\frac{1}{K}\sum_{k=1}^{K}\theta_{k}^{h}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msup id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">θ</mi><mrow id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1.2.3.2" xref="S3.E3.m1.1.1.2.3.2.cmml">h</mi><mo id="S3.E3.m1.1.1.2.3.1" xref="S3.E3.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E3.m1.1.1.2.3.3" xref="S3.E3.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mfrac id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml"><mn id="S3.E3.m1.1.1.3.2.2" xref="S3.E3.m1.1.1.3.2.2.cmml">1</mn><mi id="S3.E3.m1.1.1.3.2.3" xref="S3.E3.m1.1.1.3.2.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><munderover id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.3.3.1.2.2" xref="S3.E3.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.3.3.1.2.3" xref="S3.E3.m1.1.1.3.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.1.2.3.2" xref="S3.E3.m1.1.1.3.3.1.2.3.2.cmml">k</mi><mo id="S3.E3.m1.1.1.3.3.1.2.3.1" xref="S3.E3.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.3.3.1.2.3.3" xref="S3.E3.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.3.3.1.3" xref="S3.E3.m1.1.1.3.3.1.3.cmml">K</mi></munderover><msubsup id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml"><mi id="S3.E3.m1.1.1.3.3.2.2.2" xref="S3.E3.m1.1.1.3.3.2.2.2.cmml">θ</mi><mi id="S3.E3.m1.1.1.3.3.2.2.3" xref="S3.E3.m1.1.1.3.3.2.2.3.cmml">k</mi><mi id="S3.E3.m1.1.1.3.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.cmml">h</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">𝜃</ci><apply id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3"><plus id="S3.E3.m1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.2.3.1"></plus><ci id="S3.E3.m1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.2.3.2">ℎ</ci><cn type="integer" id="S3.E3.m1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><times id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></times><apply id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2"><divide id="S3.E3.m1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.3.2"></divide><cn type="integer" id="S3.E3.m1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.3.2.2">1</cn><ci id="S3.E3.m1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.3.2.3">𝐾</ci></apply><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><apply id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.1.cmml" xref="S3.E3.m1.1.1.3.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.3.3.1.2.cmml" xref="S3.E3.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.1.2.1.cmml" xref="S3.E3.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.3.3.1.2.2.cmml" xref="S3.E3.m1.1.1.3.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.3.3.1.2.3.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3"><eq id="S3.E3.m1.1.1.3.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.3.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.1.1.3.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.3.3.1.3.cmml" xref="S3.E3.m1.1.1.3.3.1.3">𝐾</ci></apply><apply id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2">superscript</csymbol><apply id="S3.E3.m1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.2.2">𝜃</ci><ci id="S3.E3.m1.1.1.3.3.2.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.2.3">𝑘</ci></apply><ci id="S3.E3.m1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\theta^{h+1}=\frac{1}{K}\sum_{k=1}^{K}\theta_{k}^{h}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.1" class="ltx_p">This method assumes equal contribution from all clients, regardless of the size or diversity of their local datasets.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p"><span id="S3.SS3.p3.1.1" class="ltx_text ltx_font_italic">Weighted Averaging</span> improves the aggregation process by considering the relative importance of each client’s update. It assigns weights based on the significance of each client’s contribution, resulting in a weighted sum of individual client model updates. This approach allows for a more tailored integration of contributions, accounting for variations in client performance. In this technique, each client’s update is weighted by a factor <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑤</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">w_{k}</annotation></semantics></math> reflecting its significance in the learning process as</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\theta^{h+1}=\sum_{k=1}^{K}w_{k}\theta_{k}^{h}," display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msup id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.2.2.cmml">θ</mi><mrow id="S3.E4.m1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.2.3.2" xref="S3.E4.m1.1.1.1.1.2.3.2.cmml">h</mi><mo id="S3.E4.m1.1.1.1.1.2.3.1" xref="S3.E4.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E4.m1.1.1.1.1.2.3.3" xref="S3.E4.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><munderover id="S3.E4.m1.1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.1.1.1.1.3.1.2.2" xref="S3.E4.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.1.1.3.1.2.3" xref="S3.E4.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.1.2.3.2" xref="S3.E4.m1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E4.m1.1.1.1.1.3.1.2.3.1" xref="S3.E4.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.1.1.3.1.2.3.3" xref="S3.E4.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.1.1.3.1.3" xref="S3.E4.m1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml"><msub id="S3.E4.m1.1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.1.1.3.2.2.2.cmml">w</mi><mi id="S3.E4.m1.1.1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.1.3.2.1" xref="S3.E4.m1.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E4.m1.1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2.3.2.2" xref="S3.E4.m1.1.1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="S3.E4.m1.1.1.1.1.3.2.3.2.3" xref="S3.E4.m1.1.1.1.1.3.2.3.2.3.cmml">k</mi><mi id="S3.E4.m1.1.1.1.1.3.2.3.3" xref="S3.E4.m1.1.1.1.1.3.2.3.3.cmml">h</mi></msubsup></mrow></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"></eq><apply id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2">superscript</csymbol><ci id="S3.E4.m1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.2.2">𝜃</ci><apply id="S3.E4.m1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3"><plus id="S3.E4.m1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.2.3.1"></plus><ci id="S3.E4.m1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.2.3.2">ℎ</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><apply id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.1.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E4.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E4.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3"><eq id="S3.E4.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.1.1.3.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2"><times id="S3.E4.m1.1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.1"></times><apply id="S3.E4.m1.1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.2">𝑤</ci><ci id="S3.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E4.m1.1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3.2.2">𝜃</ci><ci id="S3.E4.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3.2.3">𝑘</ci></apply><ci id="S3.E4.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.2.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\theta^{h+1}=\sum_{k=1}^{K}w_{k}\theta_{k}^{h},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.5" class="ltx_p">where <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\theta^{h+1}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><msup id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.m1.1.1.2" xref="S3.SS3.p4.1.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p4.1.m1.1.1.3" xref="S3.SS3.p4.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.m1.1.1.3.2" xref="S3.SS3.p4.1.m1.1.1.3.2.cmml">h</mi><mo id="S3.SS3.p4.1.m1.1.1.3.1" xref="S3.SS3.p4.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p4.1.m1.1.1.3.3" xref="S3.SS3.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><apply id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p4.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.m1.1.1.2">𝜃</ci><apply id="S3.SS3.p4.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3"><plus id="S3.SS3.p4.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.m1.1.1.3.1"></plus><ci id="S3.SS3.p4.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.m1.1.1.3.2">ℎ</ci><cn type="integer" id="S3.SS3.p4.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\theta^{h+1}</annotation></semantics></math> represents the updated parameters of the model after the <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">h</annotation></semantics></math>-th iteration. The parameters are updated as a weighted sum of the parameters from <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">K</annotation></semantics></math> client models, denoted by <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="\theta_{k}^{h}" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><msubsup id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml"><mi id="S3.SS3.p4.4.m4.1.1.2.2" xref="S3.SS3.p4.4.m4.1.1.2.2.cmml">θ</mi><mi id="S3.SS3.p4.4.m4.1.1.2.3" xref="S3.SS3.p4.4.m4.1.1.2.3.cmml">k</mi><mi id="S3.SS3.p4.4.m4.1.1.3" xref="S3.SS3.p4.4.m4.1.1.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">superscript</csymbol><apply id="S3.SS3.p4.4.m4.1.1.2.cmml" xref="S3.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.1.2.2">𝜃</ci><ci id="S3.SS3.p4.4.m4.1.1.2.3.cmml" xref="S3.SS3.p4.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p4.4.m4.1.1.3.cmml" xref="S3.SS3.p4.4.m4.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\theta_{k}^{h}</annotation></semantics></math>, where each model’s contribution is scaled by a weight <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><msub id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml"><mi id="S3.SS3.p4.5.m5.1.1.2" xref="S3.SS3.p4.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS3.p4.5.m5.1.1.3" xref="S3.SS3.p4.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><apply id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.5.m5.1.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p4.5.m5.1.1.2.cmml" xref="S3.SS3.p4.5.m5.1.1.2">𝑤</ci><ci id="S3.SS3.p4.5.m5.1.1.3.cmml" xref="S3.SS3.p4.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">w_{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">Finally, the <span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_italic">Best Pick</span> scheme adopts a selective approach, incorporating updates only from clients meeting a predefined performance criterion. The resulting global model is a weighted sum of selected client updates, prioritizing accuracy and reliability. By setting a performance threshold, only updates surpassing this threshold contribute to the global model. The global model update can be represented as:</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="\theta^{h+1}=\sum_{k\in\mathcal{S}}w_{k}\theta_{k}^{h}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msup id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.2.2" xref="S3.E5.m1.1.1.2.2.cmml">θ</mi><mrow id="S3.E5.m1.1.1.2.3" xref="S3.E5.m1.1.1.2.3.cmml"><mi id="S3.E5.m1.1.1.2.3.2" xref="S3.E5.m1.1.1.2.3.2.cmml">h</mi><mo id="S3.E5.m1.1.1.2.3.1" xref="S3.E5.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E5.m1.1.1.2.3.3" xref="S3.E5.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><munder id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E5.m1.1.1.3.1.2" xref="S3.E5.m1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.3.1.3" xref="S3.E5.m1.1.1.3.1.3.cmml"><mi id="S3.E5.m1.1.1.3.1.3.2" xref="S3.E5.m1.1.1.3.1.3.2.cmml">k</mi><mo id="S3.E5.m1.1.1.3.1.3.1" xref="S3.E5.m1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.3.1.3.3" xref="S3.E5.m1.1.1.3.1.3.3.cmml">𝒮</mi></mrow></munder><mrow id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><msub id="S3.E5.m1.1.1.3.2.2" xref="S3.E5.m1.1.1.3.2.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.cmml">w</mi><mi id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.1" xref="S3.E5.m1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.3.2.2" xref="S3.E5.m1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="S3.E5.m1.1.1.3.2.3.2.3" xref="S3.E5.m1.1.1.3.2.3.2.3.cmml">k</mi><mi id="S3.E5.m1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.3.cmml">h</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><apply id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.2.2">𝜃</ci><apply id="S3.E5.m1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.2.3"><plus id="S3.E5.m1.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.2.3.1"></plus><ci id="S3.E5.m1.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.2.3.2">ℎ</ci><cn type="integer" id="S3.E5.m1.1.1.2.3.3.cmml" xref="S3.E5.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><apply id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.1.cmml" xref="S3.E5.m1.1.1.3.1">subscript</csymbol><sum id="S3.E5.m1.1.1.3.1.2.cmml" xref="S3.E5.m1.1.1.3.1.2"></sum><apply id="S3.E5.m1.1.1.3.1.3.cmml" xref="S3.E5.m1.1.1.3.1.3"><in id="S3.E5.m1.1.1.3.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1.3.1"></in><ci id="S3.E5.m1.1.1.3.1.3.2.cmml" xref="S3.E5.m1.1.1.3.1.3.2">𝑘</ci><ci id="S3.E5.m1.1.1.3.1.3.3.cmml" xref="S3.E5.m1.1.1.3.1.3.3">𝒮</ci></apply></apply><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><times id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.1"></times><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2">𝑤</ci><ci id="S3.E5.m1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3">superscript</csymbol><apply id="S3.E5.m1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2.2">𝜃</ci><ci id="S3.E5.m1.1.1.3.2.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3.2.3">𝑘</ci></apply><ci id="S3.E5.m1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\theta^{h+1}=\sum_{k\in\mathcal{S}}w_{k}\theta_{k}^{h}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p6.3" class="ltx_p">where summation is taken over the set <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{S}" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\mathcal{S}</annotation></semantics></math>, which represents the subset of clients whose updates satisfy the criterion. The weighting factor <math id="S3.SS3.p6.2.m2.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="S3.SS3.p6.2.m2.1a"><msub id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml"><mi id="S3.SS3.p6.2.m2.1.1.2" xref="S3.SS3.p6.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS3.p6.2.m2.1.1.3" xref="S3.SS3.p6.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><apply id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.2.m2.1.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p6.2.m2.1.1.2.cmml" xref="S3.SS3.p6.2.m2.1.1.2">𝑤</ci><ci id="S3.SS3.p6.2.m2.1.1.3.cmml" xref="S3.SS3.p6.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">w_{k}</annotation></semantics></math> assigned to each client model’s parameters, <math id="S3.SS3.p6.3.m3.1" class="ltx_Math" alttext="\theta_{k}^{h}" display="inline"><semantics id="S3.SS3.p6.3.m3.1a"><msubsup id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml"><mi id="S3.SS3.p6.3.m3.1.1.2.2" xref="S3.SS3.p6.3.m3.1.1.2.2.cmml">θ</mi><mi id="S3.SS3.p6.3.m3.1.1.2.3" xref="S3.SS3.p6.3.m3.1.1.2.3.cmml">k</mi><mi id="S3.SS3.p6.3.m3.1.1.3" xref="S3.SS3.p6.3.m3.1.1.3.cmml">h</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.1b"><apply id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.3.m3.1.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p6.3.m3.1.1.2.cmml" xref="S3.SS3.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p6.3.m3.1.1.2.1.cmml" xref="S3.SS3.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p6.3.m3.1.1.2.2.cmml" xref="S3.SS3.p6.3.m3.1.1.2.2">𝜃</ci><ci id="S3.SS3.p6.3.m3.1.1.2.3.cmml" xref="S3.SS3.p6.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p6.3.m3.1.1.3.cmml" xref="S3.SS3.p6.3.m3.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.1c">\theta_{k}^{h}</annotation></semantics></math>, is determined by the performance of the client, emphasizing updates from clients deemed more accurate or reliable, potentially enhancing the overall performance and efficiency of the model.</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Datasets</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para">
<p id="S3.SS3.SSS1.p1.1" class="ltx_p">In our experiments, we use a genomic dataset to train a decentralized QFL model, crucial to understanding genomic sequences, consisting of labeled data points <math id="S3.SS3.SSS1.p1.1.m1.2" class="ltx_Math" alttext="(X,Y)" display="inline"><semantics id="S3.SS3.SSS1.p1.1.m1.2a"><mrow id="S3.SS3.SSS1.p1.1.m1.2.3.2" xref="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS3.SSS1.p1.1.m1.2.3.2.1" xref="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">X</mi><mo id="S3.SS3.SSS1.p1.1.m1.2.3.2.2" xref="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS3.SSS1.p1.1.m1.2.2" xref="S3.SS3.SSS1.p1.1.m1.2.2.cmml">Y</mi><mo stretchy="false" id="S3.SS3.SSS1.p1.1.m1.2.3.2.3" xref="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.2b"><interval closure="open" id="S3.SS3.SSS1.p1.1.m1.2.3.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.2.3.2"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝑋</ci><ci id="S3.SS3.SSS1.p1.1.m1.2.2.cmml" xref="S3.SS3.SSS1.p1.1.m1.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.2c">(X,Y)</annotation></semantics></math> representing different genomic characteristics. We chose this dataset due to its sufficient sample size for algorithm testing and the promising potential of genomics for future QFL applications. Our algorithm, demonstrated on the IBM Cloud platform, utilizes multiple QML models and follows the essential steps outlined in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.3.1. Datasets ‣ 3.3. Analyzing Aggregation Schemes ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, encompassing data preparation, model training, and aggregation of updates from multiple clients. Each client, in our proposed QFL implementation, utilizes a quantum circuit to process genomic data and update model weights based on its local dataset, subsequently aggregated by the server to refine the global model, ensuring data privacy while leveraging collective learning.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.7.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Proof of Concept QFL over IBM Cloud</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.5" class="ltx_p ltx_figure_panel"><span id="alg1.5.1" class="ltx_text ltx_font_bold">Input</span>: Data <math id="alg1.1.m1.2" class="ltx_Math" alttext="(X,Y)" display="inline"><semantics id="alg1.1.m1.2a"><mrow id="alg1.1.m1.2.3.2" xref="alg1.1.m1.2.3.1.cmml"><mo stretchy="false" id="alg1.1.m1.2.3.2.1" xref="alg1.1.m1.2.3.1.cmml">(</mo><mi id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">X</mi><mo id="alg1.1.m1.2.3.2.2" xref="alg1.1.m1.2.3.1.cmml">,</mo><mi id="alg1.1.m1.2.2" xref="alg1.1.m1.2.2.cmml">Y</mi><mo stretchy="false" id="alg1.1.m1.2.3.2.3" xref="alg1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.2b"><interval closure="open" id="alg1.1.m1.2.3.1.cmml" xref="alg1.1.m1.2.3.2"><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">𝑋</ci><ci id="alg1.1.m1.2.2.cmml" xref="alg1.1.m1.2.2">𝑌</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.2c">(X,Y)</annotation></semantics></math>, Max  iterations <math id="alg1.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.2.m2.1a"><mi id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><ci id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">I</annotation></semantics></math>, Initial client weights <math id="alg1.3.m3.1" class="ltx_Math" alttext="{w_{i}}_{i=1}^{n}" display="inline"><semantics id="alg1.3.m3.1a"><mmultiscripts id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml"><mi id="alg1.3.m3.1.1.2.2.2" xref="alg1.3.m3.1.1.2.2.2.cmml">w</mi><mi id="alg1.3.m3.1.1.2.2.3" xref="alg1.3.m3.1.1.2.2.3.cmml">i</mi><mrow id="alg1.3.m3.1.1a" xref="alg1.3.m3.1.1.cmml"></mrow><mrow id="alg1.3.m3.1.1.2.3" xref="alg1.3.m3.1.1.2.3.cmml"><mi id="alg1.3.m3.1.1.2.3.2" xref="alg1.3.m3.1.1.2.3.2.cmml">i</mi><mo id="alg1.3.m3.1.1.2.3.1" xref="alg1.3.m3.1.1.2.3.1.cmml">=</mo><mn id="alg1.3.m3.1.1.2.3.3" xref="alg1.3.m3.1.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.3.m3.1.1.3" xref="alg1.3.m3.1.1.3.cmml">n</mi></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg1.3.m3.1b"><apply id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.1.cmml" xref="alg1.3.m3.1.1">superscript</csymbol><apply id="alg1.3.m3.1.1.2.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.2.1.cmml" xref="alg1.3.m3.1.1">subscript</csymbol><apply id="alg1.3.m3.1.1.2.2.cmml" xref="alg1.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.1.1.2.2.1.cmml" xref="alg1.3.m3.1.1">subscript</csymbol><ci id="alg1.3.m3.1.1.2.2.2.cmml" xref="alg1.3.m3.1.1.2.2.2">𝑤</ci><ci id="alg1.3.m3.1.1.2.2.3.cmml" xref="alg1.3.m3.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.3.m3.1.1.2.3.cmml" xref="alg1.3.m3.1.1.2.3"><eq id="alg1.3.m3.1.1.2.3.1.cmml" xref="alg1.3.m3.1.1.2.3.1"></eq><ci id="alg1.3.m3.1.1.2.3.2.cmml" xref="alg1.3.m3.1.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.3.m3.1.1.2.3.3.cmml" xref="alg1.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="alg1.3.m3.1.1.3.cmml" xref="alg1.3.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.1c">{w_{i}}_{i=1}^{n}</annotation></semantics></math>, Initial global weights <math id="alg1.4.m4.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="alg1.4.m4.1a"><msub id="alg1.4.m4.1.1" xref="alg1.4.m4.1.1.cmml"><mi id="alg1.4.m4.1.1.2" xref="alg1.4.m4.1.1.2.cmml">w</mi><mi id="alg1.4.m4.1.1.3" xref="alg1.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m4.1b"><apply id="alg1.4.m4.1.1.cmml" xref="alg1.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.4.m4.1.1.1.cmml" xref="alg1.4.m4.1.1">subscript</csymbol><ci id="alg1.4.m4.1.1.2.cmml" xref="alg1.4.m4.1.1.2">𝑤</ci><ci id="alg1.4.m4.1.1.3.cmml" xref="alg1.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m4.1c">w_{g}</annotation></semantics></math>, Number of clients <math id="alg1.5.m5.1" class="ltx_Math" alttext="n" display="inline"><semantics id="alg1.5.m5.1a"><mi id="alg1.5.m5.1.1" xref="alg1.5.m5.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m5.1b"><ci id="alg1.5.m5.1.1.cmml" xref="alg1.5.m5.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m5.1c">n</annotation></semantics></math>
<br class="ltx_break"></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.8" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">Procedure Initialize</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>Split genomic data into user-specific datasets:

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><math id="alg1.l3.m1.7" class="ltx_Math" alttext="(x_{i},y_{i})\sim(X,Y)\quad\text{for }i=1,\ldots,n" display="inline"><semantics id="alg1.l3.m1.7a"><mrow id="alg1.l3.m1.7.7.2" xref="alg1.l3.m1.7.7.3.cmml"><mrow id="alg1.l3.m1.6.6.1.1" xref="alg1.l3.m1.6.6.1.1.cmml"><mrow id="alg1.l3.m1.6.6.1.1.2.2" xref="alg1.l3.m1.6.6.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l3.m1.6.6.1.1.2.2.3" xref="alg1.l3.m1.6.6.1.1.2.3.cmml">(</mo><msub id="alg1.l3.m1.6.6.1.1.1.1.1" xref="alg1.l3.m1.6.6.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.6.6.1.1.1.1.1.2" xref="alg1.l3.m1.6.6.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.l3.m1.6.6.1.1.1.1.1.3" xref="alg1.l3.m1.6.6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l3.m1.6.6.1.1.2.2.4" xref="alg1.l3.m1.6.6.1.1.2.3.cmml">,</mo><msub id="alg1.l3.m1.6.6.1.1.2.2.2" xref="alg1.l3.m1.6.6.1.1.2.2.2.cmml"><mi id="alg1.l3.m1.6.6.1.1.2.2.2.2" xref="alg1.l3.m1.6.6.1.1.2.2.2.2.cmml">y</mi><mi id="alg1.l3.m1.6.6.1.1.2.2.2.3" xref="alg1.l3.m1.6.6.1.1.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l3.m1.6.6.1.1.2.2.5" xref="alg1.l3.m1.6.6.1.1.2.3.cmml">)</mo></mrow><mo id="alg1.l3.m1.6.6.1.1.3" xref="alg1.l3.m1.6.6.1.1.3.cmml">∼</mo><mrow id="alg1.l3.m1.6.6.1.1.4.2" xref="alg1.l3.m1.6.6.1.1.4.1.cmml"><mo stretchy="false" id="alg1.l3.m1.6.6.1.1.4.2.1" xref="alg1.l3.m1.6.6.1.1.4.1.cmml">(</mo><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">X</mi><mo id="alg1.l3.m1.6.6.1.1.4.2.2" xref="alg1.l3.m1.6.6.1.1.4.1.cmml">,</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">Y</mi><mo stretchy="false" id="alg1.l3.m1.6.6.1.1.4.2.3" xref="alg1.l3.m1.6.6.1.1.4.1.cmml">)</mo></mrow></mrow><mspace width="1em" id="alg1.l3.m1.7.7.2.3" xref="alg1.l3.m1.7.7.3a.cmml"></mspace><mrow id="alg1.l3.m1.7.7.2.2" xref="alg1.l3.m1.7.7.2.2.cmml"><mrow id="alg1.l3.m1.7.7.2.2.2" xref="alg1.l3.m1.7.7.2.2.2.cmml"><mtext id="alg1.l3.m1.7.7.2.2.2.2" xref="alg1.l3.m1.7.7.2.2.2.2a.cmml">for </mtext><mo lspace="0em" rspace="0em" id="alg1.l3.m1.7.7.2.2.2.1" xref="alg1.l3.m1.7.7.2.2.2.1.cmml">​</mo><mi id="alg1.l3.m1.7.7.2.2.2.3" xref="alg1.l3.m1.7.7.2.2.2.3.cmml">i</mi></mrow><mo id="alg1.l3.m1.7.7.2.2.1" xref="alg1.l3.m1.7.7.2.2.1.cmml">=</mo><mrow id="alg1.l3.m1.7.7.2.2.3.2" xref="alg1.l3.m1.7.7.2.2.3.1.cmml"><mn id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">1</mn><mo id="alg1.l3.m1.7.7.2.2.3.2.1" xref="alg1.l3.m1.7.7.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml">…</mi><mo id="alg1.l3.m1.7.7.2.2.3.2.2" xref="alg1.l3.m1.7.7.2.2.3.1.cmml">,</mo><mi id="alg1.l3.m1.5.5" xref="alg1.l3.m1.5.5.cmml">n</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.7b"><apply id="alg1.l3.m1.7.7.3.cmml" xref="alg1.l3.m1.7.7.2"><csymbol cd="ambiguous" id="alg1.l3.m1.7.7.3a.cmml" xref="alg1.l3.m1.7.7.2.3">formulae-sequence</csymbol><apply id="alg1.l3.m1.6.6.1.1.cmml" xref="alg1.l3.m1.6.6.1.1"><csymbol cd="latexml" id="alg1.l3.m1.6.6.1.1.3.cmml" xref="alg1.l3.m1.6.6.1.1.3">similar-to</csymbol><interval closure="open" id="alg1.l3.m1.6.6.1.1.2.3.cmml" xref="alg1.l3.m1.6.6.1.1.2.2"><apply id="alg1.l3.m1.6.6.1.1.1.1.1.cmml" xref="alg1.l3.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.6.6.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.6.6.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.6.6.1.1.1.1.1.2">𝑥</ci><ci id="alg1.l3.m1.6.6.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.6.6.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l3.m1.6.6.1.1.2.2.2.cmml" xref="alg1.l3.m1.6.6.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.6.6.1.1.2.2.2.1.cmml" xref="alg1.l3.m1.6.6.1.1.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.6.6.1.1.2.2.2.2.cmml" xref="alg1.l3.m1.6.6.1.1.2.2.2.2">𝑦</ci><ci id="alg1.l3.m1.6.6.1.1.2.2.2.3.cmml" xref="alg1.l3.m1.6.6.1.1.2.2.2.3">𝑖</ci></apply></interval><interval closure="open" id="alg1.l3.m1.6.6.1.1.4.1.cmml" xref="alg1.l3.m1.6.6.1.1.4.2"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑋</ci><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝑌</ci></interval></apply><apply id="alg1.l3.m1.7.7.2.2.cmml" xref="alg1.l3.m1.7.7.2.2"><eq id="alg1.l3.m1.7.7.2.2.1.cmml" xref="alg1.l3.m1.7.7.2.2.1"></eq><apply id="alg1.l3.m1.7.7.2.2.2.cmml" xref="alg1.l3.m1.7.7.2.2.2"><times id="alg1.l3.m1.7.7.2.2.2.1.cmml" xref="alg1.l3.m1.7.7.2.2.2.1"></times><ci id="alg1.l3.m1.7.7.2.2.2.2a.cmml" xref="alg1.l3.m1.7.7.2.2.2.2"><mtext id="alg1.l3.m1.7.7.2.2.2.2.cmml" xref="alg1.l3.m1.7.7.2.2.2.2">for </mtext></ci><ci id="alg1.l3.m1.7.7.2.2.2.3.cmml" xref="alg1.l3.m1.7.7.2.2.2.3">𝑖</ci></apply><list id="alg1.l3.m1.7.7.2.2.3.1.cmml" xref="alg1.l3.m1.7.7.2.2.3.2"><cn type="integer" id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">1</cn><ci id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4">…</ci><ci id="alg1.l3.m1.5.5.cmml" xref="alg1.l3.m1.5.5">𝑛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.7c">(x_{i},y_{i})\sim(X,Y)\quad\text{for }i=1,\ldots,n</annotation></semantics></math>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.9" class="ltx_p ltx_figure_panel">——————————————-</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.10" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1a.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1a.2" class="ltx_text ltx_font_bold">Procedure QFL Learning with Training</span>

</div>
<div id="alg1.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2a.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2a.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2a.m1.3" class="ltx_Math" alttext="epoch=1,\ldots,I" display="inline"><semantics id="alg1.l2a.m1.3a"><mrow id="alg1.l2a.m1.3.4" xref="alg1.l2a.m1.3.4.cmml"><mrow id="alg1.l2a.m1.3.4.2" xref="alg1.l2a.m1.3.4.2.cmml"><mi id="alg1.l2a.m1.3.4.2.2" xref="alg1.l2a.m1.3.4.2.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l2a.m1.3.4.2.1" xref="alg1.l2a.m1.3.4.2.1.cmml">​</mo><mi id="alg1.l2a.m1.3.4.2.3" xref="alg1.l2a.m1.3.4.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l2a.m1.3.4.2.1a" xref="alg1.l2a.m1.3.4.2.1.cmml">​</mo><mi id="alg1.l2a.m1.3.4.2.4" xref="alg1.l2a.m1.3.4.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l2a.m1.3.4.2.1b" xref="alg1.l2a.m1.3.4.2.1.cmml">​</mo><mi id="alg1.l2a.m1.3.4.2.5" xref="alg1.l2a.m1.3.4.2.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l2a.m1.3.4.2.1c" xref="alg1.l2a.m1.3.4.2.1.cmml">​</mo><mi id="alg1.l2a.m1.3.4.2.6" xref="alg1.l2a.m1.3.4.2.6.cmml">h</mi></mrow><mo id="alg1.l2a.m1.3.4.1" xref="alg1.l2a.m1.3.4.1.cmml">=</mo><mrow id="alg1.l2a.m1.3.4.3.2" xref="alg1.l2a.m1.3.4.3.1.cmml"><mn id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml">1</mn><mo id="alg1.l2a.m1.3.4.3.2.1" xref="alg1.l2a.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2a.m1.2.2" xref="alg1.l2a.m1.2.2.cmml">…</mi><mo id="alg1.l2a.m1.3.4.3.2.2" xref="alg1.l2a.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l2a.m1.3.3" xref="alg1.l2a.m1.3.3.cmml">I</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.3b"><apply id="alg1.l2a.m1.3.4.cmml" xref="alg1.l2a.m1.3.4"><eq id="alg1.l2a.m1.3.4.1.cmml" xref="alg1.l2a.m1.3.4.1"></eq><apply id="alg1.l2a.m1.3.4.2.cmml" xref="alg1.l2a.m1.3.4.2"><times id="alg1.l2a.m1.3.4.2.1.cmml" xref="alg1.l2a.m1.3.4.2.1"></times><ci id="alg1.l2a.m1.3.4.2.2.cmml" xref="alg1.l2a.m1.3.4.2.2">𝑒</ci><ci id="alg1.l2a.m1.3.4.2.3.cmml" xref="alg1.l2a.m1.3.4.2.3">𝑝</ci><ci id="alg1.l2a.m1.3.4.2.4.cmml" xref="alg1.l2a.m1.3.4.2.4">𝑜</ci><ci id="alg1.l2a.m1.3.4.2.5.cmml" xref="alg1.l2a.m1.3.4.2.5">𝑐</ci><ci id="alg1.l2a.m1.3.4.2.6.cmml" xref="alg1.l2a.m1.3.4.2.6">ℎ</ci></apply><list id="alg1.l2a.m1.3.4.3.1.cmml" xref="alg1.l2a.m1.3.4.3.2"><cn type="integer" id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1">1</cn><ci id="alg1.l2a.m1.2.2.cmml" xref="alg1.l2a.m1.2.2">…</ci><ci id="alg1.l2a.m1.3.3.cmml" xref="alg1.l2a.m1.3.3">𝐼</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.3c">epoch=1,\ldots,I</annotation></semantics></math> <span id="alg1.l2a.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3a.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Select a subset of participating clients, say <math id="alg1.l3a.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l3a.m1.1a"><mi id="alg1.l3a.m1.1.1" xref="alg1.l3a.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.1b"><ci id="alg1.l3a.m1.1.1.cmml" xref="alg1.l3a.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.1c">m</annotation></semantics></math> clients

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i</annotation></semantics></math> in the selected subset <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>         Initialize client-specific quantum circuit <math id="alg1.l5.m1.1" class="ltx_Math" alttext="Q_{i}" display="inline"><semantics id="alg1.l5.m1.1a"><msub id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">Q</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑄</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">Q_{i}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>         Encode client data <math id="alg1.l6.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">x</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑥</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">x_{i}</annotation></semantics></math> into quantum states <math id="alg1.l6.m2.1" class="ltx_Math" alttext="X_{q_{i}}" display="inline"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">X</mi><msub id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml"><mi id="alg1.l6.m2.1.1.3.2" xref="alg1.l6.m2.1.1.3.2.cmml">q</mi><mi id="alg1.l6.m2.1.1.3.3" xref="alg1.l6.m2.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑋</ci><apply id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.3">subscript</csymbol><ci id="alg1.l6.m2.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.3.2">𝑞</ci><ci id="alg1.l6.m2.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">X_{q_{i}}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>         Optimize client’s model to minimize loss and update weights: <math id="alg1.l7.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">w</mi><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑤</ci><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">w_{i}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         <math id="alg1.l8.m1.2" class="ltx_Math" alttext="w_{i}=\text{minimize loss}(f_{Q_{i}}(X_{q_{i}}),y_{i})" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><msub id="alg1.l8.m1.2.2.4" xref="alg1.l8.m1.2.2.4.cmml"><mi id="alg1.l8.m1.2.2.4.2" xref="alg1.l8.m1.2.2.4.2.cmml">w</mi><mi id="alg1.l8.m1.2.2.4.3" xref="alg1.l8.m1.2.2.4.3.cmml">i</mi></msub><mo id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">=</mo><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml"><mtext id="alg1.l8.m1.2.2.2.4" xref="alg1.l8.m1.2.2.2.4a.cmml">minimize loss</mtext><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.3.2.cmml">f</mi><msub id="alg1.l8.m1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2.cmml">Q</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l8.m1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml">X</mi><msub id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">q</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m1.2.2.2.2.2.4" xref="alg1.l8.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.2.5" xref="alg1.l8.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><eq id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3"></eq><apply id="alg1.l8.m1.2.2.4.cmml" xref="alg1.l8.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.4">subscript</csymbol><ci id="alg1.l8.m1.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.4.2">𝑤</ci><ci id="alg1.l8.m1.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.4.3">𝑖</ci></apply><apply id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"><times id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.3"></times><ci id="alg1.l8.m1.2.2.2.4a.cmml" xref="alg1.l8.m1.2.2.2.4"><mtext id="alg1.l8.m1.2.2.2.4.cmml" xref="alg1.l8.m1.2.2.2.4">minimize loss</mtext></ci><interval closure="open" id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2"><apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><times id="alg1.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2"></times><apply id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.2">𝑓</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.2">𝑄</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">w_{i}=\text{minimize loss}(f_{Q_{i}}(X_{q_{i}}),y_{i})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         Upload local updates <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑤</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w_{i}</annotation></semantics></math> to the global server

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     Aggregate local updates at the global server:

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     Broadcast updated global weights <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑤</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w_{g}</annotation></semantics></math> to all clients

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l13.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l13.m1.1a"><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">i</annotation></semantics></math> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>         Update local model weights with global weights: 
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span><span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</div>
</div>
</figure>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Encoding driven QFL</h3>

<figure id="S3.F4" class="ltx_figure"><img src="/html/2405.00909/assets/Averaging_Top1_Clients_Global.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Comparision of the evolution of Top-1 Accuracy over epochs for the global model and clients models using the averaging technique.</figcaption>
</figure>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2405.00909/assets/Averaging_Train_Loss.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Evolution of Top-1 Accuracy and Loss over epochs for clients using the averaging technique.</figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">In our implementation of QFL, data encoding stands out as a critical step, transforming classical data into a format compatible with quantum processing.
Our QFL implementation using a genomic dataset showcases the potential of quantum facilities to manage complex, high-dimensional data. By employing amplitude encoding, we simplify model training with our 200-feature dataset, leveraging only a fraction of the qubits typically required. This approach proves particularly advantageous in genomic data analysis, where traditional computing methods may struggle with data scale and complexity.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">We consider three primary encoding techniques: basis encoding, amplitude encoding, and angle encoding, as follows. Basis encoding, while straightforward, suffers from inefficiencies in qubit usage, particularly for larger datasets. Amplitude encoding emerges as a more efficient alternative, especially for handling substantial data volumes. This technique capitalizes on the amplitudes of a quantum state to represent data points, offering a compact representation that can encode vast amounts of information with minimal qubits. For instance, our 200-feature genomic dataset can be effectively encoded using just 8 qubits, making amplitude encoding a practical choice within current quantum computing limitations. This method proves invaluable in quantum machine learning, offering a streamlined approach to represent high-dimensional data.</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.1" class="ltx_p">In contrast, angle encoding, akin to basis encoding in its reliance on one qubit per feature, falls short in scalability for larger datasets due to its demanding qubit requirements. Given these considerations, we opt for amplitude encoding, which efficiently utilizes qubits and aligns with the 25-qubit limit of Qiskit’s <span id="S3.SS4.p3.1.1" class="ltx_text ltx_font_typewriter">aer_simulator</span> utilized in our research.</p>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.1" class="ltx_p">As shown in Step 6, our Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.3.1. Datasets ‣ 3.3. Analyzing Aggregation Schemes ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> efficiently uses quantum circuits for data encoding and processing, presenting a novel methodology for genomic data analysis within a federated learning framework. Utilizing the IBM Cloud platform for quantum computing, our implementation offers scalability and accessibility, potentially paving the way for transformative advancements in genomic research.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Performance Evaluation</h3>

<figure id="S3.F6" class="ltx_figure"><img src="/html/2405.00909/assets/Best_Pick_Top1_Clients_Global.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Evolution of Top-1 Accuracy for the global model and individual clients using the Best Pick scheme.</figcaption>
</figure>
<figure id="S3.F7" class="ltx_figure"><img src="/html/2405.00909/assets/Best_Pick_Train_Loss.png" id="S3.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Temporal evolution of the training scores and losses for all clients using the Best Pick.</figcaption>
</figure>
<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">We conducted a series of experiments to train the developed Quantum Federated Learning (QFL) framework using three distinct global aggregation methods: <span id="S3.SS5.p1.1.1" class="ltx_text ltx_font_italic">Averaging, Best Pick, and Weighted Averaging</span>. The results of these experiments are depicted in Figures <a href="#S3.F4" title="Figure 4 ‣ 3.4. Encoding driven QFL ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> to <a href="#S3.F9" title="Figure 9 ‣ 3.5. Performance Evaluation ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> and are detailed below.</p>
</div>
<div id="S3.SS5.p2" class="ltx_para">
<p id="S3.SS5.p2.1" class="ltx_p">In Figure <a href="#S3.F4" title="Figure 4 ‣ 3.4. Encoding driven QFL ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> averaging method exhibited varying Top-1 accuracy between clients, with the global model’s accuracy typically positioned between the clients’ accuracies. Both the high and low performances of the individual client models directly influenced the global model, placing its accuracy within the range of the client’s accuracy. The accuracy and training loss patterns for all clients demonstrated in Figure <a href="#S3.F5" title="Figure 5 ‣ 3.4. Encoding driven QFL ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> exhibit a consistent decrease in loss and a tractable improvement in accuracy over epochs.</p>
</div>
<div id="S3.SS5.p3" class="ltx_para">
<p id="S3.SS5.p3.1" class="ltx_p">In contrast, the best pick method demonstrated a more selective behavior in Figure <a href="#S3.F6" title="Figure 6 ‣ 3.5. Performance Evaluation ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> of our experiments, often resulting in the global model’s accuracy surpassing individual clients’ accuracies. This observation suggests that the global model performance was driven by the highest-performing clients, with minimal or no contributions from poorly performing ones. The decreasing loss and increasing accuracy observed in Figure <a href="#S3.F7" title="Figure 7 ‣ 3.5. Performance Evaluation ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> over epochs indicated progressive improvements in the training of clients.</p>
</div>
<figure id="S3.F8" class="ltx_figure"><img src="/html/2405.00909/assets/Weighted_Averaging__Top1_Clients_Global.png" id="S3.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>Temporal evolution of the Top-1 Accuracy for the global model and individual clients using the Weighted Averaging.</figcaption>
</figure>
<figure id="S3.F9" class="ltx_figure"><img src="/html/2405.00909/assets/Weighted_Averaging_Train_Loss.png" id="S3.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="359" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9. </span>Temporal evolution of training scores and losses for all clients using the Weighted Averaging.</figcaption>
</figure>
<div id="S3.SS5.p4" class="ltx_para">
<p id="S3.SS5.p4.1" class="ltx_p">With weighted averaging, see the results in Figures <a href="#S3.F8" title="Figure 8 ‣ 3.5. Performance Evaluation ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and <a href="#S3.F9" title="Figure 9 ‣ 3.5. Performance Evaluation ‣ 3. Operationalizing QFL in Qiskit ‣ Quantum Federated Learning Experiments in the Cloud with Data Encoding" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>. The QFL performance closely matched the highest performing clients. This approach minimally affected the global model’s performance by poor-performing clients while significantly benefiting from higher-performing ones. This method ensures that the global model takes advantage of the strengths of the higher performing clients while mitigating the impact of the lower performing ones. Training scores and losses exhibited a steady trend of reduced loss and improved accuracy.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Conclusion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">This article highlights the efficacy of different aggregation methods in the operationalization of QFL over Qiskit, demonstrating how data encoding and weighted averaging enhance overall performance by leveraging the strengths of high-performing clients while mitigating the impact of low-performing ones. More research is needed to refine QFL techniques, Qiskit implementation, and transition from simulators to real quantum hardware for successful implementation on cloud computing infrastructure.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
S. S. Gill, A. Kumar, H. Singh, M. Singh, K. Kaur, M. Usman, and R. Buyya,
“Quantum computing: A taxonomy, systematic review and future directions,”
<span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Software: Practice and Experience</span>, vol. 52, no. 1, pp. 66–114, 2022.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(2)</span>
<span class="ltx_bibblock">
H. T. Larasati, M. Firdaus, and H. Kim, “Quantum federated learning: Remarks
and challenges,” in <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">2022 IEEE 9th International Conference on Cyber
Security and Cloud Computing (CSCloud)/2022 IEEE 8th International Conference
on Edge Computing and Scalable Cloud (EdgeCom)</span>, pp. 1–5, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(3)</span>
<span class="ltx_bibblock">
M. Chehimi and W. Saad, “Quantum federated learning with quantum data,” in
<span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">ICASSP 2022 - 2022 IEEE International Conference on Acoustics, Speech
and Signal Processing (ICASSP)</span>, pp. 8617–8621, 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(4)</span>
<span class="ltx_bibblock">
M. C. Caro, H.-Y. Huang, M. Cerezo, K. Sharma, A. Sornborger, L. Cincio, and
P. J. Coles, “Generalization in quantum machine learning from few training
data,” <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Nature communications</span>, vol. 13, no. 1, p. 4919, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(5)</span>
<span class="ltx_bibblock">
S. R. Pokhrel and J. Choi, “Federated learning with blockchain for autonomous
vehicles: Analysis and design challenges,” <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on
Communications</span>, vol. 68, no. 8, pp. 4734–4746, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(6)</span>
<span class="ltx_bibblock">
P. W. Shor, “Algorithms for quantum computation: Discrete logarithms and
factoring,” in <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Proceedings 35th Annual Symposium on Foundations of
Computer Science</span>, pp. 124–134, 1994.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(7)</span>
<span class="ltx_bibblock">
S. L. et al., “Pricing plans - azure quantum.”
<a target="_blank" href="https://learn.microsoft.com/en-us/azure/quantum/pricing" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://learn.microsoft.com/en-us/azure/quantum/pricing</a>.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(8)</span>
<span class="ltx_bibblock">
Amazon, “Amazon braket pricing.”
<a target="_blank" href="https://aws.amazon.com/braket/pricing/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://aws.amazon.com/braket/pricing/</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(9)</span>
<span class="ltx_bibblock">
IonQ Staff, “The value of classical quantum simulators,” March 2023.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(10)</span>
<span class="ltx_bibblock">
M. Kashif and S. Al-Kuwari, “Qiskit as a simulation platform for
measurement-based quantum computation,” in <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">2022 IEEE 19th International
Conference on Software Architecture Companion (ICSA-C)</span>, pp. 152–159, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(11)</span>
<span class="ltx_bibblock">
I. Cong, S. Choi, and M. D. Lukin, “Quantum convolutional neural networks,”
<span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Nature Physics</span>, vol. 15, no. 12, pp. 1273–1278, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(12)</span>
<span class="ltx_bibblock">
H. Yano, Y. Suzuki, K. M. Itoh, R. Raymond, and N. Yamamoto, “Efficient
discrete feature encoding for variational quantum classifier,” <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">IEEE
Transactions on Quantum Engineering</span>, vol. 2, pp. 1–14, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(13)</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pp. 1273–1282,
PMLR, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2405.00907" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2405.00909" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2405.00909">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2405.00909" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2405.00910" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Jun  5 13:54:09 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
