<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>SimpleStrat: Diversifying Language Model Generation with Stratification</title>
<!--Generated on Mon Oct 14 17:31:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.09038v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S1" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S2" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related work.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.SS1" title="In 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Workflow overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.SS2" title="In 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Auto-Stratification</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.SS3" title="In 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Heuristic estimation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.SS4" title="In 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Probabilistic Prompting.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S4" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>CoverageQA Dataset</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S4.SS1" title="In 4 CoverageQA Dataset ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S4.SS2" title="In 4 CoverageQA Dataset ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>CoverageQA-Wikipedia Approach</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.SS1" title="In 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Evaluation Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.SS2" title="In 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Measuring Diversity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.SS3" title="In 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Qualitative Example</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.SS4" title="In 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Coverage Diversity on Proprietary Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.SS5" title="In 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>Distributional diversity with Llama 3</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S6" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S7" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A1" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A1.SS1" title="In Appendix A Appendix ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>CoverageQA Dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A2" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>F1 Scores</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A3" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Auto-stratification Prompt</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A4" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Heuristic Estimation Prompt</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A5" title="In SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Additional Plots: Distributional Analysis with Llama</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">SimpleStrat: Diversifying Language Model Generation with Stratification</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Justin Wong 
<br class="ltx_break"/>UC Berkeley
<br class="ltx_break"/>&amp;Yury Orlovskiy 
<br class="ltx_break"/>UC Berkeley
<br class="ltx_break"/>&amp;Michael Luo 
<br class="ltx_break"/>UC Berkeley
<br class="ltx_break"/>&amp;Sanjit A. Seshia 
<br class="ltx_break"/>UC Berkeley
<br class="ltx_break"/>&amp;Joseph E. Gonzalez 
<br class="ltx_break"/>UC Berkeley
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Generating diverse responses from large language models (LLMs) is crucial for applications such as planning/search and synthetic data generation, where diversity provides distinct answers across generations.
Prior approaches rely on increasing temperature to increase diversity. However, contrary to popular belief, we show not only does this approach produce lower quality individual generations as temperature increases, but it depends on model’s next-token probabilities being similar to the true distribution of answers. We propose SimpleStrat, an alternative approach that uses the language model itself to partition the space into strata. At inference, a random stratum is selected and a sample drawn from within the strata.
To measure diversity, we introduce CoverageQA, a dataset of underspecified questions with multiple equally plausible answers, and assess diversity by measuring KL Divergence between the output distribution and uniform distribution over valid ground truth answers. As computing probability per response/solution for proprietary models is infeasible, we measure recall on ground truth solutions.
Our evaluation show using SimpleStrat achieves higher recall by 0.05 compared to GPT-4o and 0.36 average reduction in KL Divergence compared to Llama 3.</p>
</div>
<figure class="ltx_figure ltx_minipage ltx_align_center ltx_align_middle" id="S0.F1.1" style="width:377.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="290" id="S0.F1.1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S0.F1.1.3.1"> Stratfied Sampling vs Temperature Scaling</span> Consider the LLM user request "Name a US State." SimpleStrat employs auto-stratification to utilize the LLM to identify good dimensions of diversity, for instance "East/West of the Mississippi River." Then, SimpleStrat uses stratified sampling to diversify LLM generations.</figcaption>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction.</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large language models (LLMs) are routinely resampled in order to get a wide set of plausible generations. Three key settings where this is important are: 1) improving downstream accuracy with planning or search for agentic tasks (i.e. Tree-of-thought <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib42" title="">2024</a>)</cite>, AgentQ <cite class="ltx_cite ltx_citemacro_citep">(Putta et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib28" title="">2024</a>)</cite>), 2) estimating prediction uncertainty <cite class="ltx_cite ltx_citemacro_citep">(Aichberger et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib1" title="">2024</a>)</cite>, and 3) generating diverse datasets for post-training <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib9" title="">2024</a>)</cite> and fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib8" title="">2023</a>)</cite>. All these use cases rely on the model generating multiple plausible generations for the same prompt when multiple answers exists.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Naively, increasing temperature, a parameter that controllably flattens an LLM’s softmax, can improve an LLM’s generation diversity. However, temperature introduces two problems. First, higher temperatures degrades generation quality. Recent evidence suggests removing temperature scaling is desirable for multi-step reasoning to reduce errors compounding <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib44" title="">2024</a>)</cite>.
This is especially critical in syntax sensitive settings like code generation where low temperatures (<math alttext="\leq 0.15" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mrow id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml"></mi><mo id="S1.p2.1.m1.1.1.1" xref="S1.p2.1.m1.1.1.1.cmml">≤</mo><mn id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">0.15</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><leq id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1.1"></leq><csymbol cd="latexml" id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">absent</csymbol><cn id="S1.p2.1.m1.1.1.3.cmml" type="float" xref="S1.p2.1.m1.1.1.3">0.15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\leq 0.15</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">≤ 0.15</annotation></semantics></math>) are often used. Second, controlling for temperature does not necessarily improve diversity in the answer space. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S0.F1.1" title="Figure 1 ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">1</span></a>, we illustrate increasing temperature doesn’t lead to meaningful increase in diversity if the model is excessively confident and suffers from mode collapse. When asked to "Name a US State," the model heavily skews towards answering "California", high temperature only marginally softens the skew while surfacing incorrect answers and hurting instruction following.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our goal is to improve diversity when resampling LLMs, even in cases of severe mode collapse in next-token probabilities without manual intervention. Our analysis reveals that GPT-4 assigns 87% of its logit weight to "California" when prompted to name a US state. This observed bias can be attributed to the worsening of calibration due to post-training as reported in the GPT-4 tech report <cite class="ltx_cite ltx_citemacro_citep">(OpenAI et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib26" title="">2024</a>)</cite>. This stark bias mirrors human cognitive bias, exemplified by the blue-seven phenomenon—where individuals disproportionately select blue and seven when asked to choose a random color and number. To counteract similar biases in human populations, social scientists, particularly in political polling, employ stratified sampling techniques <cite class="ltx_cite ltx_citemacro_citep">(Simpson, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib33" title="">1951</a>; Howell, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib15" title="">1992</a>; Morris, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib23" title="">2022</a>)</cite>. We propose adapting this method to address mode collapse in LLMs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">We propose SimpleStrat, a training-free sampling approach to increase diversity. SimpleStrat improves LLM generation diversity without degradation to generation quality while ensuring that an LLM’s outputs are aligned with the true distribution of answers. SimpleStrat consist of three stages: auto-stratification, heuristic estimation, and probabilistic prompting. Even if a language model cannot generate diverse solutions, we find that it can be prompted to identify useful partitions of the solution space based on the user request. We call this process <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">auto-stratification</span>.
In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S0.F1.1" title="Figure 1 ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">1</span></a>, SimpleStrat identifies two semantically significant strata from user request, "Name a US State": "(East/West) of the Mississippi River" and "(North/South) of the Missouri Compromise Line."</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Next, the heuristic estimation computes the joint probabilities across all strata. Back to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S0.F1.1" title="Figure 1 ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">1</span></a>, SimpleStrat then outputs the probability for all four possible regions in US.
Finally, SimpleStrat samples from the joint probability distribution to augment the original user prompt with the selected stratas.
We note that this approach to diversity is orthogonal to increasing temperature and hence does not affect generation quality.
</p>
</div>
<figure class="ltx_figure ltx_minipage ltx_align_center ltx_align_middle" id="S1.F2.1" style="width:397.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="186" id="S1.F2.1.g1" src="x2.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S1.F2.1.3.1"> SimpleStrat workflow.</span> SimpleStrat employs 3 phases: 1) auto-stratification to identify good dimensions of diversity that divide the solution space into equal partitions, 2) heuristic estimation to estimate the proportion of solutions in each stratum, and 3) probabilistic prompting where a concrete prompt is randomly sampled from the prompt distribution specified by the previous two phases. Critically, diverse resampling comes from both the random choice of prompt as well as the temperature of the LLM decoding.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">We evaluate SimpleStrat on underspecified questions, specifically questions that have more than one plausible answer. However, unlike ambiguous questions more widely, an answer to an underspecified question can be easily verified to be a valid without additional context. These questions capture settings where the user is indifferent to the particular answer as long as it’s valid or in settings where we wish to resample to get a set of candidates solutions. We introduce CoverageQA, a benchmark of underspecified questions with on average 28.7 equally plausible answers.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">We measure diversity by computing the Kullback-Leibler (KL) Divergence from the response distribution to a uniform distribution over all valid answers. By computing the response distribution using next-token probabilities, we show SimpleStrat samples from a less biased distribution. For proprietary models where we cannot close form express the response distribution, we measure the model’s coverage via recall of ground-truth solutions over 100 samples. On CoverageQA, SimpleStrat leads to 0.36 reduction in KL Divergence on average on Llama 3 models and a consistent 0.05 increase in recall. We show gains on top of temperature scaling leading to improved diversity orthogonal to increasing temperature.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">Concretely, our work contributes the following:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">CoverageQA dataset of 105 under-specified questions automatically generated from WikiData <cite class="ltx_cite ltx_citemacro_citep">(Vrandečić &amp; Krötzsch, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib37" title="">2014</a>)</cite> annotated with on average 28.7 valid solutions per question.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose SimpleStrat a training-free approach for improving diversity with <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.1">auto-stratification</span> and <span class="ltx_text ltx_font_italic" id="S1.I1.i2.p1.1.2">probabilistic prompting</span>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We demonstrate SimpleStrat improves diversity on CoverageQA with 0.36 reduction in KL Divergence on average on Llama 3 models and a consistent 0.05 increase in recall across all temperatures for GPT-4o.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work.</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Temperature Scaling.</span>
Going back as far as Platt scaling <cite class="ltx_cite ltx_citemacro_citep">(Platt, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib27" title="">2000</a>)</cite> and later applied to neural networks <cite class="ltx_cite ltx_citemacro_citep">(Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib14" title="">2015</a>; Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib11" title="">2017</a>)</cite>, temperature scaling controls the randomness of probability distributions<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Use of temperature parameter goes back at least to Verhulst’s development of logistic regression in response to Malthus’ <span class="ltx_text ltx_font_italic" id="footnote1.1">An Essay on Principle of Population</span> <cite class="ltx_cite ltx_citemacro_citep">(Malthus, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib20" title="">1798</a>; Verhulst, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib35" title="">1838</a>)</cite>.</span></span></span>.
For dataset generation with LLMs,  <cite class="ltx_cite ltx_citemacro_citet">Chung et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib7" title="">2023</a>)</cite> extends temperature-based diversity by additionally downsampling previously sampled tokens. To address the decrease in quality, they advocate for human intervention to manually filter out irrelevant diversity and manually fixing wrong answers in QA tasks. We show in our work temperature scaling leaves much to be desired.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Improving Language Model Diversity with Search.</span>
In autoregressive generation, choices over early tokens tend to have more impact on the eventual completion. Beam search ameliorates this bias by allowing for multiple candidates in searching for the probability maximizing completion, Maximum a Posteriori (MAP) <cite class="ltx_cite ltx_citemacro_cite">Lowerre &amp; Reddy (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib19" title="">1976</a>)</cite>. At the end of the search, beam search will have multiple candidate solutions encountered during search. Diverse Beam Search (DBS) proposes introducing an auxiliary dissimilarity objective quantifying the diversity among candidates in the beam <cite class="ltx_cite ltx_citemacro_citep">(Vijayakumar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib36" title="">2016</a>)</cite>. Especially on the task of image captioning, DBS shows improvement for discovering higher probability completions and discovering diverse continuations. Our improvements are orthogonal to beam search and our in-context approach corrects for inaccuracies in the modeled likelihoods of candidate solutions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Other approaches <cite class="ltx_cite ltx_citemacro_citep">(Samvelyan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib30" title="">2024</a>; Bradley et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib3" title="">2023</a>)</cite> based on MAP-Elites <cite class="ltx_cite ltx_citemacro_citep">(Mouret &amp; Clune, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib24" title="">2015</a>)</cite> require manual determined dimensions of relevant diversity and discretization of the solution space into equally-sized bins. Diversity is then achieved by mutations and evolutionary methods to cover adjacent bins. This search is potentially slow if the seed set of solutions do not already provide coverage over the solutions space. Our approach does not need seed solutions and avoids manually identifying dimensions of diversity. Instead, we rely solely on capabilities within the model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.1"><span class="ltx_text ltx_font_bold" id="S2.p4.1.1">In-context Methods to Increase Diversity.</span>
When LLMs were first introduced, LMs were used to augment existing datasets with more diversity <cite class="ltx_cite ltx_citemacro_citep">(Wei &amp; Zou, <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib38" title="">2019</a>; Ng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib25" title="">2020</a>; Dai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib8" title="">2023</a>)</cite>. As natural language is difficult to guarantee correctness, the space of augmentations is conservatively limited to thesaurus based synonym replacement. More recently, Language Model Crossover proposes presenting a random subset of existing data points to an LLM and ask it to hallucinate more data points that likely came from the same distribution <cite class="ltx_cite ltx_citemacro_cite">Meyerson et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib21" title="">2023</a>)</cite>. This is limited combining aspects of existing data points into new generations.
Although these methods address the limitations of using the model’s token probabilities by in-context learning, they are ineffective at generating meaningful diversity. They are limited to either a human identified domains of interest or trivial variations sourced from synonyms or minicking random subsets of the existing dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p5">
<p class="ltx_p" id="S2.p5.1"><span class="ltx_text ltx_font_bold" id="S2.p5.1.1">Applications of Diversity.</span>
As shown by <cite class="ltx_cite ltx_citemacro_cite">Raventós et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib29" title="">2024</a>)</cite>, dataset diversity is crucial for model generalization. Below sufficient coverage of the desired task, the model will resort to memorization, but when sufficient diversity is presented it will learn to generalize. As LLMs are increasingly used for generating synthetic data <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib9" title="">2024</a>)</cite>, methods for diversity will be critical. This insight follows from extensive work demonstrating the benefits of data augmentation for bias mitigation <cite class="ltx_cite ltx_citemacro_citep">(Sharmanska et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib31" title="">2020</a>)</cite> and domain adaptation <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib16" title="">2018</a>; Dunlap et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib10" title="">2023</a>; Trabucco et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib34" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">In code and math applications, checking validity efficiently enables more aggressive augmentations. One such augmentation for diversifying the languages supported by the model, data is translated to different natural or programming language <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib6" title="">2023</a>; Cassano et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib5" title="">2023</a>)</cite>. In other domains such as images, text-to-image models have been used to do diversify data into uncommon settings. In the setting of diversifying an accumulating dataset, these methods can take advantage of an existing source of variance (for translation) or set of previously generated data points. Our primary focus is on settings where SimpleStrat is unaware of past data samples to support a wider set of applications.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p7">
<p class="ltx_p" id="S2.p7.1"><span class="ltx_text ltx_font_bold" id="S2.p7.1.1">Ambiguous or Underspecified Datasets.</span>
ClariQ <cite class="ltx_cite ltx_citemacro_citep">(Aliannejadi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib2" title="">2020</a>)</cite>, CLAQUA <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib40" title="">2019</a>)</cite>, and AmbigQA <cite class="ltx_cite ltx_citemacro_citep">(Min et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib22" title="">2020</a>)</cite> focus on assessing LM’s ability to formulate clarifying questions. These question tend to have only 2 candidate solutions, as there exists a ground truth clarifying question whose answer fully specifies the question. Ambiguous Trivia QA <cite class="ltx_cite ltx_citemacro_citep">(Kuhn et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib17" title="">2022</a>)</cite> also looks at under-specified questions, but assume a user has contextual information that’s hidden. For instance, "Where in England was she born?" or "Who was the first woman to make a solo flight across this ocean?". We distinguish our underspecified question setting in this paper as one where the user is indifferent. In this setting, the given an answer it should be easy to verify the answer is correct without additional hidden context.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p8">
<p class="ltx_p" id="S2.p8.1">Coding datasets like Description2Code <cite class="ltx_cite ltx_citemacro_citep">(Caballero et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib4" title="">2016</a>)</cite>, Wiki2SQL <cite class="ltx_cite ltx_citemacro_citep">(Zhong et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib45" title="">2017</a>)</cite>, SPIDER <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib43" title="">2019</a>)</cite>, code-contest <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib18" title="">2022</a>)</cite>, Apps <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib13" title="">2021</a>)</cite>, and Leetcode Hard <cite class="ltx_cite ltx_citemacro_cite">Shinn et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib32" title="">2023</a>)</cite> admit multiple valid answers. However, the space of valid implementations is infinite, making diversity difficult to measure, and good coding practices enforce preferences among valid implementations. We additionally construct CoverageQA to have an exhaustive list of ground-truth answers in order to measure the impact of diversity on coverage.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Workflow overview</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">As illustrated in <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S1.F2.1" title="Figure 2 ‣ 1 Introduction. ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">2</span></a>, SimpleStrat consist of three stages, 1) auto-stratification, 2) heuristic estimation, and 3) probabilistic prompting. For each unique user prompt, the outputs of the first two stages can be cached to avoid recomputing feed-forwards.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Auto-Stratification</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.10">For a given user request, <math alttext="r_{user}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">r</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">u</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">s</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.m1.1.1.3.4.cmml">e</mi><mo id="S3.SS2.p1.1.m1.1.1.3.1b" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.1.m1.1.1.3.5" xref="S3.SS2.p1.1.m1.1.1.3.5.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑟</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑢</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑠</ci><ci id="S3.SS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.4">𝑒</ci><ci id="S3.SS2.p1.1.m1.1.1.3.5.cmml" xref="S3.SS2.p1.1.m1.1.1.3.5">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">r_{user}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_u italic_s italic_e italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, we call <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_S</annotation></semantics></math>, the space of valid solutions.
In many settings, the space of potential solutions, <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_S</annotation></semantics></math> may be naturally partitioned based on geography, parity, or demographics. The partition function, <math alttext="P:S\rightarrow L" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">P</mi><mo id="S3.SS2.p1.4.m4.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p1.4.m4.1.1.1.cmml">:</mo><mrow id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">S</mi><mo id="S3.SS2.p1.4.m4.1.1.3.1" stretchy="false" xref="S3.SS2.p1.4.m4.1.1.3.1.cmml">→</mo><mi id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><ci id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1">:</ci><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑃</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><ci id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.1">→</ci><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">𝑆</ci><ci id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">P:S\rightarrow L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_P : italic_S → italic_L</annotation></semantics></math>, assigns any solution <math alttext="s" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_s</annotation></semantics></math> from <math alttext="S" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_S</annotation></semantics></math> to a partition label <math alttext="l_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">l</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑙</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">l_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_l start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_L</annotation></semantics></math> the set of partition labels. Partition functions are most useful if they’re as balanced as possible. A balanced partition function minimizes <math alttext="imbalance(P,L)=\max_{l\in L}\left(|\{s\mid P(s)=l\}|\right)-\min_{l\in L}\left%
(|\{s\mid P(s)=l\}|\right)" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.10"><semantics id="S3.SS2.p1.9.m9.10a"><mrow id="S3.SS2.p1.9.m9.10.10" xref="S3.SS2.p1.9.m9.10.10.cmml"><mrow id="S3.SS2.p1.9.m9.10.10.6" xref="S3.SS2.p1.9.m9.10.10.6.cmml"><mi id="S3.SS2.p1.9.m9.10.10.6.2" xref="S3.SS2.p1.9.m9.10.10.6.2.cmml">i</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.3" xref="S3.SS2.p1.9.m9.10.10.6.3.cmml">m</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1a" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.4" xref="S3.SS2.p1.9.m9.10.10.6.4.cmml">b</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1b" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.5" xref="S3.SS2.p1.9.m9.10.10.6.5.cmml">a</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1c" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.6" xref="S3.SS2.p1.9.m9.10.10.6.6.cmml">l</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1d" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.7" xref="S3.SS2.p1.9.m9.10.10.6.7.cmml">a</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1e" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.8" xref="S3.SS2.p1.9.m9.10.10.6.8.cmml">n</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1f" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.9" xref="S3.SS2.p1.9.m9.10.10.6.9.cmml">c</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1g" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mi id="S3.SS2.p1.9.m9.10.10.6.10" xref="S3.SS2.p1.9.m9.10.10.6.10.cmml">e</mi><mo id="S3.SS2.p1.9.m9.10.10.6.1h" xref="S3.SS2.p1.9.m9.10.10.6.1.cmml">⁢</mo><mrow id="S3.SS2.p1.9.m9.10.10.6.11.2" xref="S3.SS2.p1.9.m9.10.10.6.11.1.cmml"><mo id="S3.SS2.p1.9.m9.10.10.6.11.2.1" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.6.11.1.cmml">(</mo><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">P</mi><mo id="S3.SS2.p1.9.m9.10.10.6.11.2.2" xref="S3.SS2.p1.9.m9.10.10.6.11.1.cmml">,</mo><mi id="S3.SS2.p1.9.m9.2.2" xref="S3.SS2.p1.9.m9.2.2.cmml">L</mi><mo id="S3.SS2.p1.9.m9.10.10.6.11.2.3" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.6.11.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.9.m9.10.10.5" xref="S3.SS2.p1.9.m9.10.10.5.cmml">=</mo><mrow id="S3.SS2.p1.9.m9.10.10.4" xref="S3.SS2.p1.9.m9.10.10.4.cmml"><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2" xref="S3.SS2.p1.9.m9.8.8.2.2.3.cmml"><msub id="S3.SS2.p1.9.m9.7.7.1.1.1.1" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.cmml"><mi id="S3.SS2.p1.9.m9.7.7.1.1.1.1.2" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.2.cmml">max</mi><mrow id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.2" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.2.cmml">l</mi><mo id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.1" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.1.cmml">∈</mo><mi id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.3" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.3.cmml">L</mi></mrow></msub><mo id="S3.SS2.p1.9.m9.8.8.2.2.2a" xref="S3.SS2.p1.9.m9.8.8.2.2.3.cmml">⁡</mo><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2.2" xref="S3.SS2.p1.9.m9.8.8.2.2.3.cmml"><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.2" xref="S3.SS2.p1.9.m9.8.8.2.2.3.cmml">(</mo><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.2.cmml"><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.2.1.cmml">|</mo><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.2.cmml"><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.2.1.cmml">{</mo><mi id="S3.SS2.p1.9.m9.4.4" xref="S3.SS2.p1.9.m9.4.4.cmml">s</mi><mo fence="true" id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.3" lspace="0em" rspace="0em" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.2.1.cmml">∣</mo><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.cmml"><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.2" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.2.cmml">P</mi><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.1" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS2.p1.9.m9.3.3" xref="S3.SS2.p1.9.m9.3.3.cmml">s</mi><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.1" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.1.cmml">=</mo><mi id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.3" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.3.cmml">l</mi></mrow><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.4" stretchy="false" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.2.1.cmml">}</mo></mrow><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.3" stretchy="false" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.9.m9.8.8.2.2.2.2.3" xref="S3.SS2.p1.9.m9.8.8.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.9.m9.10.10.4.5" xref="S3.SS2.p1.9.m9.10.10.4.5.cmml">−</mo><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2" xref="S3.SS2.p1.9.m9.10.10.4.4.3.cmml"><msub id="S3.SS2.p1.9.m9.9.9.3.3.1.1" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.cmml"><mi id="S3.SS2.p1.9.m9.9.9.3.3.1.1.2" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.2.cmml">min</mi><mrow id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.cmml"><mi id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.2" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.2.cmml">l</mi><mo id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.1" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.1.cmml">∈</mo><mi id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.3" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.3.cmml">L</mi></mrow></msub><mo id="S3.SS2.p1.9.m9.10.10.4.4.2a" xref="S3.SS2.p1.9.m9.10.10.4.4.3.cmml">⁡</mo><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2.2" xref="S3.SS2.p1.9.m9.10.10.4.4.3.cmml"><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.2" xref="S3.SS2.p1.9.m9.10.10.4.4.3.cmml">(</mo><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.2.cmml"><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.2" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.2.1.cmml">|</mo><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.2.cmml"><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.2.1.cmml">{</mo><mi id="S3.SS2.p1.9.m9.6.6" xref="S3.SS2.p1.9.m9.6.6.cmml">s</mi><mo fence="true" id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.3" lspace="0em" rspace="0em" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.2.1.cmml">∣</mo><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.cmml"><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.2" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.2.cmml">P</mi><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.1" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.3.2" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.cmml"><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS2.p1.9.m9.5.5" xref="S3.SS2.p1.9.m9.5.5.cmml">s</mi><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.1" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.1.cmml">=</mo><mi id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.3" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.3.cmml">l</mi></mrow><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.4" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.2.1.cmml">}</mo></mrow><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.3" stretchy="false" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.2.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.9.m9.10.10.4.4.2.2.3" xref="S3.SS2.p1.9.m9.10.10.4.4.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.10b"><apply id="S3.SS2.p1.9.m9.10.10.cmml" xref="S3.SS2.p1.9.m9.10.10"><eq id="S3.SS2.p1.9.m9.10.10.5.cmml" xref="S3.SS2.p1.9.m9.10.10.5"></eq><apply id="S3.SS2.p1.9.m9.10.10.6.cmml" xref="S3.SS2.p1.9.m9.10.10.6"><times id="S3.SS2.p1.9.m9.10.10.6.1.cmml" xref="S3.SS2.p1.9.m9.10.10.6.1"></times><ci id="S3.SS2.p1.9.m9.10.10.6.2.cmml" xref="S3.SS2.p1.9.m9.10.10.6.2">𝑖</ci><ci id="S3.SS2.p1.9.m9.10.10.6.3.cmml" xref="S3.SS2.p1.9.m9.10.10.6.3">𝑚</ci><ci id="S3.SS2.p1.9.m9.10.10.6.4.cmml" xref="S3.SS2.p1.9.m9.10.10.6.4">𝑏</ci><ci id="S3.SS2.p1.9.m9.10.10.6.5.cmml" xref="S3.SS2.p1.9.m9.10.10.6.5">𝑎</ci><ci id="S3.SS2.p1.9.m9.10.10.6.6.cmml" xref="S3.SS2.p1.9.m9.10.10.6.6">𝑙</ci><ci id="S3.SS2.p1.9.m9.10.10.6.7.cmml" xref="S3.SS2.p1.9.m9.10.10.6.7">𝑎</ci><ci id="S3.SS2.p1.9.m9.10.10.6.8.cmml" xref="S3.SS2.p1.9.m9.10.10.6.8">𝑛</ci><ci id="S3.SS2.p1.9.m9.10.10.6.9.cmml" xref="S3.SS2.p1.9.m9.10.10.6.9">𝑐</ci><ci id="S3.SS2.p1.9.m9.10.10.6.10.cmml" xref="S3.SS2.p1.9.m9.10.10.6.10">𝑒</ci><interval closure="open" id="S3.SS2.p1.9.m9.10.10.6.11.1.cmml" xref="S3.SS2.p1.9.m9.10.10.6.11.2"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑃</ci><ci id="S3.SS2.p1.9.m9.2.2.cmml" xref="S3.SS2.p1.9.m9.2.2">𝐿</ci></interval></apply><apply id="S3.SS2.p1.9.m9.10.10.4.cmml" xref="S3.SS2.p1.9.m9.10.10.4"><minus id="S3.SS2.p1.9.m9.10.10.4.5.cmml" xref="S3.SS2.p1.9.m9.10.10.4.5"></minus><apply id="S3.SS2.p1.9.m9.8.8.2.2.3.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2"><apply id="S3.SS2.p1.9.m9.7.7.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.7.7.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1">subscript</csymbol><max id="S3.SS2.p1.9.m9.7.7.1.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.2"></max><apply id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3"><in id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.1"></in><ci id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.2">𝑙</ci><ci id="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.7.7.1.1.1.1.3.3">𝐿</ci></apply></apply><apply id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.2.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1"><abs id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.2.1.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.2"></abs><apply id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.2">conditional-set</csymbol><ci id="S3.SS2.p1.9.m9.4.4.cmml" xref="S3.SS2.p1.9.m9.4.4">𝑠</ci><apply id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1"><eq id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.1"></eq><apply id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2"><times id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.1"></times><ci id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.2.2">𝑃</ci><ci id="S3.SS2.p1.9.m9.3.3.cmml" xref="S3.SS2.p1.9.m9.3.3">𝑠</ci></apply><ci id="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.9.m9.8.8.2.2.2.2.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply><apply id="S3.SS2.p1.9.m9.10.10.4.4.3.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2"><apply id="S3.SS2.p1.9.m9.9.9.3.3.1.1.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.9.9.3.3.1.1.1.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1">subscript</csymbol><min id="S3.SS2.p1.9.m9.9.9.3.3.1.1.2.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.2"></min><apply id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3"><in id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.1"></in><ci id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.2">𝑙</ci><ci id="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.9.9.3.3.1.1.3.3">𝐿</ci></apply></apply><apply id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.2.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1"><abs id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.2.1.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.2"></abs><apply id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.2">conditional-set</csymbol><ci id="S3.SS2.p1.9.m9.6.6.cmml" xref="S3.SS2.p1.9.m9.6.6">𝑠</ci><apply id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1"><eq id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.1"></eq><apply id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2"><times id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.1"></times><ci id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.2.2">𝑃</ci><ci id="S3.SS2.p1.9.m9.5.5.cmml" xref="S3.SS2.p1.9.m9.5.5">𝑠</ci></apply><ci id="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.9.m9.10.10.4.4.2.2.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.10c">imbalance(P,L)=\max_{l\in L}\left(|\{s\mid P(s)=l\}|\right)-\min_{l\in L}\left%
(|\{s\mid P(s)=l\}|\right)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.10d">italic_i italic_m italic_b italic_a italic_l italic_a italic_n italic_c italic_e ( italic_P , italic_L ) = roman_max start_POSTSUBSCRIPT italic_l ∈ italic_L end_POSTSUBSCRIPT ( | { italic_s ∣ italic_P ( italic_s ) = italic_l } | ) - roman_min start_POSTSUBSCRIPT italic_l ∈ italic_L end_POSTSUBSCRIPT ( | { italic_s ∣ italic_P ( italic_s ) = italic_l } | )</annotation></semantics></math>. The goal of auto-stratification is to search for a set of partition functions <math alttext="\mathbf{P}=\{P_{1},P_{2},...,P_{n}\}" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.4"><semantics id="S3.SS2.p1.10.m10.4a"><mrow id="S3.SS2.p1.10.m10.4.4" xref="S3.SS2.p1.10.m10.4.4.cmml"><mi id="S3.SS2.p1.10.m10.4.4.5" xref="S3.SS2.p1.10.m10.4.4.5.cmml">𝐏</mi><mo id="S3.SS2.p1.10.m10.4.4.4" xref="S3.SS2.p1.10.m10.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.10.m10.4.4.3.3" xref="S3.SS2.p1.10.m10.4.4.3.4.cmml"><mo id="S3.SS2.p1.10.m10.4.4.3.3.4" stretchy="false" xref="S3.SS2.p1.10.m10.4.4.3.4.cmml">{</mo><msub id="S3.SS2.p1.10.m10.2.2.1.1.1" xref="S3.SS2.p1.10.m10.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.10.m10.2.2.1.1.1.2" xref="S3.SS2.p1.10.m10.2.2.1.1.1.2.cmml">P</mi><mn id="S3.SS2.p1.10.m10.2.2.1.1.1.3" xref="S3.SS2.p1.10.m10.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.10.m10.4.4.3.3.5" xref="S3.SS2.p1.10.m10.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.10.m10.3.3.2.2.2" xref="S3.SS2.p1.10.m10.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.10.m10.3.3.2.2.2.2" xref="S3.SS2.p1.10.m10.3.3.2.2.2.2.cmml">P</mi><mn id="S3.SS2.p1.10.m10.3.3.2.2.2.3" xref="S3.SS2.p1.10.m10.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.10.m10.4.4.3.3.6" xref="S3.SS2.p1.10.m10.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p1.10.m10.1.1" mathvariant="normal" xref="S3.SS2.p1.10.m10.1.1.cmml">…</mi><mo id="S3.SS2.p1.10.m10.4.4.3.3.7" xref="S3.SS2.p1.10.m10.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.10.m10.4.4.3.3.3" xref="S3.SS2.p1.10.m10.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.10.m10.4.4.3.3.3.2" xref="S3.SS2.p1.10.m10.4.4.3.3.3.2.cmml">P</mi><mi id="S3.SS2.p1.10.m10.4.4.3.3.3.3" xref="S3.SS2.p1.10.m10.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS2.p1.10.m10.4.4.3.3.8" stretchy="false" xref="S3.SS2.p1.10.m10.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.4b"><apply id="S3.SS2.p1.10.m10.4.4.cmml" xref="S3.SS2.p1.10.m10.4.4"><eq id="S3.SS2.p1.10.m10.4.4.4.cmml" xref="S3.SS2.p1.10.m10.4.4.4"></eq><ci id="S3.SS2.p1.10.m10.4.4.5.cmml" xref="S3.SS2.p1.10.m10.4.4.5">𝐏</ci><set id="S3.SS2.p1.10.m10.4.4.3.4.cmml" xref="S3.SS2.p1.10.m10.4.4.3.3"><apply id="S3.SS2.p1.10.m10.2.2.1.1.1.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.10.m10.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.10.m10.2.2.1.1.1.2">𝑃</ci><cn id="S3.SS2.p1.10.m10.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.10.m10.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.10.m10.3.3.2.2.2.cmml" xref="S3.SS2.p1.10.m10.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.10.m10.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.10.m10.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.10.m10.3.3.2.2.2.2">𝑃</ci><cn id="S3.SS2.p1.10.m10.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.10.m10.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">…</ci><apply id="S3.SS2.p1.10.m10.4.4.3.3.3.cmml" xref="S3.SS2.p1.10.m10.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.10.m10.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.10.m10.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.10.m10.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.10.m10.4.4.3.3.3.2">𝑃</ci><ci id="S3.SS2.p1.10.m10.4.4.3.3.3.3.cmml" xref="S3.SS2.p1.10.m10.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.4c">\mathbf{P}=\{P_{1},P_{2},...,P_{n}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.4d">bold_P = { italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_P start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>, that are balanced. Traditionally, in settings where there are oft-overlooked or a large or infinite number of valid solutions, stratified sampling can ensure our limited budget of samples covers the space of solutions evenly.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">Based on this insight, we prompt the language model to identify promising dimensions of diversity. Concretely, the language model proposes good clarifying questions that will potentially eliminate half of the potential solutions based on the user request. These clarifying questions tend to align with semantically significant differences. In the running example, when asked, "Name a US State," the states can be partitioned based on East or West of the Mississippi River. See App. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A3" title="Appendix C Auto-stratification Prompt ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">C</span></a> for full prompt.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Heuristic estimation </h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">As previously observed in <cite class="ltx_cite ltx_citemacro_citet">Zou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib46" title="">2022</a>); Yan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib41" title="">2023</a>); Halawi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib12" title="">2024</a>)</cite>, LLMs can used in forecasting to estimate well-calibrated probabilities of events that have not yet occured.
For forecasting, the model success benefits substantially from having updated news through web search. Although our unnecessary for the offline benchmarks we consider, this may be helpful for accurate estimation depending on the application. However, as our goal is diversity, we stand to benefit even from coarse-grain approximate proportions. We employ a similar reasoning template as <cite class="ltx_cite ltx_citemacro_citet">Halawi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib12" title="">2024</a>)</cite> to estimate the proportion of valid solutions lie within each strata.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.4">In heuristic estimation, we look to estimate the joint distribution for each stratum, <math alttext="\vec{l}=[l_{1},l_{2},l_{3},...]" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.4"><semantics id="S3.SS3.p2.1.m1.4a"><mrow id="S3.SS3.p2.1.m1.4.4" xref="S3.SS3.p2.1.m1.4.4.cmml"><mover accent="true" id="S3.SS3.p2.1.m1.4.4.5" xref="S3.SS3.p2.1.m1.4.4.5.cmml"><mi id="S3.SS3.p2.1.m1.4.4.5.2" xref="S3.SS3.p2.1.m1.4.4.5.2.cmml">l</mi><mo id="S3.SS3.p2.1.m1.4.4.5.1" stretchy="false" xref="S3.SS3.p2.1.m1.4.4.5.1.cmml">→</mo></mover><mo id="S3.SS3.p2.1.m1.4.4.4" xref="S3.SS3.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.4.4.3.3" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml">l</mi><mn id="S3.SS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p2.1.m1.4.4.3.3.5" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p2.1.m1.3.3.2.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.p2.1.m1.3.3.2.2.2.2.cmml">l</mi><mn id="S3.SS3.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p2.1.m1.4.4.3.3.6" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.p2.1.m1.4.4.3.3.3" xref="S3.SS3.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.p2.1.m1.4.4.3.3.3.2" xref="S3.SS3.p2.1.m1.4.4.3.3.3.2.cmml">l</mi><mn id="S3.SS3.p2.1.m1.4.4.3.3.3.3" xref="S3.SS3.p2.1.m1.4.4.3.3.3.3.cmml">3</mn></msub><mo id="S3.SS3.p2.1.m1.4.4.3.3.7" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS3.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS3.p2.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.4b"><apply id="S3.SS3.p2.1.m1.4.4.cmml" xref="S3.SS3.p2.1.m1.4.4"><eq id="S3.SS3.p2.1.m1.4.4.4.cmml" xref="S3.SS3.p2.1.m1.4.4.4"></eq><apply id="S3.SS3.p2.1.m1.4.4.5.cmml" xref="S3.SS3.p2.1.m1.4.4.5"><ci id="S3.SS3.p2.1.m1.4.4.5.1.cmml" xref="S3.SS3.p2.1.m1.4.4.5.1">→</ci><ci id="S3.SS3.p2.1.m1.4.4.5.2.cmml" xref="S3.SS3.p2.1.m1.4.4.5.2">𝑙</ci></apply><list id="S3.SS3.p2.1.m1.4.4.3.4.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3"><apply id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2">𝑙</ci><cn id="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.3.3.2.2.2.2">𝑙</ci><cn id="S3.SS3.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.3.3.2.2.2.3">2</cn></apply><apply id="S3.SS3.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.p2.1.m1.4.4.3.3.3.2">𝑙</ci><cn id="S3.SS3.p2.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.4.4.3.3.3.3">3</cn></apply><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.4c">\vec{l}=[l_{1},l_{2},l_{3},...]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.4d">over→ start_ARG italic_l end_ARG = [ italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , … ]</annotation></semantics></math>.
Formally, we define the weighted-stratification as <math alttext="\mathcal{W}=(\textbf{P},\rho)" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.2"><semantics id="S3.SS3.p2.2.m2.2a"><mrow id="S3.SS3.p2.2.m2.2.3" xref="S3.SS3.p2.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.2.3.2" xref="S3.SS3.p2.2.m2.2.3.2.cmml">𝒲</mi><mo id="S3.SS3.p2.2.m2.2.3.1" xref="S3.SS3.p2.2.m2.2.3.1.cmml">=</mo><mrow id="S3.SS3.p2.2.m2.2.3.3.2" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml"><mo id="S3.SS3.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1a.cmml">P</mtext><mo id="S3.SS3.p2.2.m2.2.3.3.2.2" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">ρ</mi><mo id="S3.SS3.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S3.SS3.p2.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b"><apply id="S3.SS3.p2.2.m2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.3"><eq id="S3.SS3.p2.2.m2.2.3.1.cmml" xref="S3.SS3.p2.2.m2.2.3.1"></eq><ci id="S3.SS3.p2.2.m2.2.3.2.cmml" xref="S3.SS3.p2.2.m2.2.3.2">𝒲</ci><interval closure="open" id="S3.SS3.p2.2.m2.2.3.3.1.cmml" xref="S3.SS3.p2.2.m2.2.3.3.2"><ci id="S3.SS3.p2.2.m2.1.1a.cmml" xref="S3.SS3.p2.2.m2.1.1"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">P</mtext></ci><ci id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2">𝜌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">\mathcal{W}=(\textbf{P},\rho)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.2d">caligraphic_W = ( P , italic_ρ )</annotation></semantics></math>, where <math alttext="\rho(\vec{l})=Pr_{s\sim S}[P_{1}(s)=l_{1,j},P_{2}(s)=l_{2,j},P_{3}(s)=l_{1,j},%
...]" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.12"><semantics id="S3.SS3.p2.3.m3.12a"><mrow id="S3.SS3.p2.3.m3.12.12" xref="S3.SS3.p2.3.m3.12.12.cmml"><mrow id="S3.SS3.p2.3.m3.12.12.3" xref="S3.SS3.p2.3.m3.12.12.3.cmml"><mi id="S3.SS3.p2.3.m3.12.12.3.2" xref="S3.SS3.p2.3.m3.12.12.3.2.cmml">ρ</mi><mo id="S3.SS3.p2.3.m3.12.12.3.1" xref="S3.SS3.p2.3.m3.12.12.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.12.12.3.3.2" xref="S3.SS3.p2.3.m3.7.7.cmml"><mo id="S3.SS3.p2.3.m3.12.12.3.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.7.7.cmml">(</mo><mover accent="true" id="S3.SS3.p2.3.m3.7.7" xref="S3.SS3.p2.3.m3.7.7.cmml"><mi id="S3.SS3.p2.3.m3.7.7.2" xref="S3.SS3.p2.3.m3.7.7.2.cmml">l</mi><mo id="S3.SS3.p2.3.m3.7.7.1" stretchy="false" xref="S3.SS3.p2.3.m3.7.7.1.cmml">→</mo></mover><mo id="S3.SS3.p2.3.m3.12.12.3.3.2.2" stretchy="false" xref="S3.SS3.p2.3.m3.7.7.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.3.m3.12.12.2" xref="S3.SS3.p2.3.m3.12.12.2.cmml">=</mo><mrow id="S3.SS3.p2.3.m3.12.12.1" xref="S3.SS3.p2.3.m3.12.12.1.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.3" xref="S3.SS3.p2.3.m3.12.12.1.3.cmml">P</mi><mo id="S3.SS3.p2.3.m3.12.12.1.2" xref="S3.SS3.p2.3.m3.12.12.1.2.cmml">⁢</mo><msub id="S3.SS3.p2.3.m3.12.12.1.4" xref="S3.SS3.p2.3.m3.12.12.1.4.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.4.2" xref="S3.SS3.p2.3.m3.12.12.1.4.2.cmml">r</mi><mrow id="S3.SS3.p2.3.m3.12.12.1.4.3" xref="S3.SS3.p2.3.m3.12.12.1.4.3.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.4.3.2" xref="S3.SS3.p2.3.m3.12.12.1.4.3.2.cmml">s</mi><mo id="S3.SS3.p2.3.m3.12.12.1.4.3.1" xref="S3.SS3.p2.3.m3.12.12.1.4.3.1.cmml">∼</mo><mi id="S3.SS3.p2.3.m3.12.12.1.4.3.3" xref="S3.SS3.p2.3.m3.12.12.1.4.3.3.cmml">S</mi></mrow></msub><mo id="S3.SS3.p2.3.m3.12.12.1.2a" xref="S3.SS3.p2.3.m3.12.12.1.2.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.2.cmml"><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.2" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.3.cmml"><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.cmml"><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.cmml"><msub id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.2.cmml">P</mi><mn id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.3.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.cmml"><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.3.m3.8.8" xref="S3.SS3.p2.3.m3.8.8.cmml">s</mi><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.1.cmml">=</mo><msub id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.2.cmml">l</mi><mrow id="S3.SS3.p2.3.m3.2.2.2.4" xref="S3.SS3.p2.3.m3.2.2.2.3.cmml"><mn id="S3.SS3.p2.3.m3.1.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.1.cmml">1</mn><mo id="S3.SS3.p2.3.m3.2.2.2.4.1" xref="S3.SS3.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.3.m3.2.2.2.2" xref="S3.SS3.p2.3.m3.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.3a.cmml">,</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.3.cmml"><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.cmml"><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.cmml"><msub id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.2.cmml">P</mi><mn id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.3.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.cmml"><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.cmml">(</mo><mi id="S3.SS3.p2.3.m3.9.9" xref="S3.SS3.p2.3.m3.9.9.cmml">s</mi><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.1.cmml">=</mo><msub id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.2.cmml">l</mi><mrow id="S3.SS3.p2.3.m3.4.4.2.4" xref="S3.SS3.p2.3.m3.4.4.2.3.cmml"><mn id="S3.SS3.p2.3.m3.3.3.1.1" xref="S3.SS3.p2.3.m3.3.3.1.1.cmml">2</mn><mo id="S3.SS3.p2.3.m3.4.4.2.4.1" xref="S3.SS3.p2.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS3.p2.3.m3.4.4.2.2" xref="S3.SS3.p2.3.m3.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.cmml"><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.cmml"><msub id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.2.cmml">P</mi><mn id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.3" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.3.cmml">3</mn></msub><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.3.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.cmml"><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.cmml">(</mo><mi id="S3.SS3.p2.3.m3.10.10" xref="S3.SS3.p2.3.m3.10.10.cmml">s</mi><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.3.2.2" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.2.cmml">=</mo><mrow id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.2.cmml"><msub id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.2.cmml">l</mi><mrow id="S3.SS3.p2.3.m3.6.6.2.4" xref="S3.SS3.p2.3.m3.6.6.2.3.cmml"><mn id="S3.SS3.p2.3.m3.5.5.1.1" xref="S3.SS3.p2.3.m3.5.5.1.1.cmml">1</mn><mo id="S3.SS3.p2.3.m3.6.6.2.4.1" xref="S3.SS3.p2.3.m3.6.6.2.3.cmml">,</mo><mi id="S3.SS3.p2.3.m3.6.6.2.2" xref="S3.SS3.p2.3.m3.6.6.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.2" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.2.cmml">,</mo><mi id="S3.SS3.p2.3.m3.11.11" mathvariant="normal" xref="S3.SS3.p2.3.m3.11.11.cmml">…</mi></mrow></mrow></mrow></mrow><mo id="S3.SS3.p2.3.m3.12.12.1.1.1.3" stretchy="false" xref="S3.SS3.p2.3.m3.12.12.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.12b"><apply id="S3.SS3.p2.3.m3.12.12.cmml" xref="S3.SS3.p2.3.m3.12.12"><eq id="S3.SS3.p2.3.m3.12.12.2.cmml" xref="S3.SS3.p2.3.m3.12.12.2"></eq><apply id="S3.SS3.p2.3.m3.12.12.3.cmml" xref="S3.SS3.p2.3.m3.12.12.3"><times id="S3.SS3.p2.3.m3.12.12.3.1.cmml" xref="S3.SS3.p2.3.m3.12.12.3.1"></times><ci id="S3.SS3.p2.3.m3.12.12.3.2.cmml" xref="S3.SS3.p2.3.m3.12.12.3.2">𝜌</ci><apply id="S3.SS3.p2.3.m3.7.7.cmml" xref="S3.SS3.p2.3.m3.12.12.3.3.2"><ci id="S3.SS3.p2.3.m3.7.7.1.cmml" xref="S3.SS3.p2.3.m3.7.7.1">→</ci><ci id="S3.SS3.p2.3.m3.7.7.2.cmml" xref="S3.SS3.p2.3.m3.7.7.2">𝑙</ci></apply></apply><apply id="S3.SS3.p2.3.m3.12.12.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1"><times id="S3.SS3.p2.3.m3.12.12.1.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.2"></times><ci id="S3.SS3.p2.3.m3.12.12.1.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.3">𝑃</ci><apply id="S3.SS3.p2.3.m3.12.12.1.4.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.4.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.4.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4.2">𝑟</ci><apply id="S3.SS3.p2.3.m3.12.12.1.4.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4.3"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.12.12.1.4.3.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4.3.1">similar-to</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.4.3.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4.3.2">𝑠</ci><ci id="S3.SS3.p2.3.m3.12.12.1.4.3.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.4.3.3">𝑆</ci></apply></apply><apply id="S3.SS3.p2.3.m3.12.12.1.1.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.12.12.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.3a.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1"><eq id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.1"></eq><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2"><times id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.1"></times><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.2">𝑃</ci><cn id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.2.2.3">1</cn></apply><ci id="S3.SS3.p2.3.m3.8.8.cmml" xref="S3.SS3.p2.3.m3.8.8">𝑠</ci></apply><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.1.1.3.2">𝑙</ci><list id="S3.SS3.p2.3.m3.2.2.2.3.cmml" xref="S3.SS3.p2.3.m3.2.2.2.4"><cn id="S3.SS3.p2.3.m3.1.1.1.1.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.1.1">1</cn><ci id="S3.SS3.p2.3.m3.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.3a.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1"><eq id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.1"></eq><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2"><times id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.1"></times><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.2">𝑃</ci><cn id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.2.2.3">2</cn></apply><ci id="S3.SS3.p2.3.m3.9.9.cmml" xref="S3.SS3.p2.3.m3.9.9">𝑠</ci></apply><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.1.1.3.2">𝑙</ci><list id="S3.SS3.p2.3.m3.4.4.2.3.cmml" xref="S3.SS3.p2.3.m3.4.4.2.4"><cn id="S3.SS3.p2.3.m3.3.3.1.1.cmml" type="integer" xref="S3.SS3.p2.3.m3.3.3.1.1">2</cn><ci id="S3.SS3.p2.3.m3.4.4.2.2.cmml" xref="S3.SS3.p2.3.m3.4.4.2.2">𝑗</ci></list></apply></apply><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2"><eq id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.2"></eq><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3"><times id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.1"></times><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.2">𝑃</ci><cn id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.3.2.3">3</cn></apply><ci id="S3.SS3.p2.3.m3.10.10.cmml" xref="S3.SS3.p2.3.m3.10.10">𝑠</ci></apply><list id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1"><apply id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.12.12.1.1.1.1.2.2.2.2.1.1.1.2">𝑙</ci><list id="S3.SS3.p2.3.m3.6.6.2.3.cmml" xref="S3.SS3.p2.3.m3.6.6.2.4"><cn id="S3.SS3.p2.3.m3.5.5.1.1.cmml" type="integer" xref="S3.SS3.p2.3.m3.5.5.1.1">1</cn><ci id="S3.SS3.p2.3.m3.6.6.2.2.cmml" xref="S3.SS3.p2.3.m3.6.6.2.2">𝑗</ci></list></apply><ci id="S3.SS3.p2.3.m3.11.11.cmml" xref="S3.SS3.p2.3.m3.11.11">…</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.12c">\rho(\vec{l})=Pr_{s\sim S}[P_{1}(s)=l_{1,j},P_{2}(s)=l_{2,j},P_{3}(s)=l_{1,j},%
...]</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.12d">italic_ρ ( over→ start_ARG italic_l end_ARG ) = italic_P italic_r start_POSTSUBSCRIPT italic_s ∼ italic_S end_POSTSUBSCRIPT [ italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_s ) = italic_l start_POSTSUBSCRIPT 1 , italic_j end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_s ) = italic_l start_POSTSUBSCRIPT 2 , italic_j end_POSTSUBSCRIPT , italic_P start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ( italic_s ) = italic_l start_POSTSUBSCRIPT 1 , italic_j end_POSTSUBSCRIPT , … ]</annotation></semantics></math> for <span class="ltx_text ltx_markedasmath ltx_font_bold" id="S3.SS3.p2.4.1">P</span> identified in auto-stratification. To improve scalability, we assume the partition functions are independent and multiply the marginal probabilities to get the joint probabilities associated with each stratum.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\rho(l_{1},l_{2},...,l_{m})=\prod\limits_{i}\rho_{i}(l_{i})" class="ltx_Math" display="block" id="S3.E1.m1.5"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml"><mrow id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><mi id="S3.E1.m1.4.4.3.5" xref="S3.E1.m1.4.4.3.5.cmml">ρ</mi><mo id="S3.E1.m1.4.4.3.4" xref="S3.E1.m1.4.4.3.4.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.3.3.3" xref="S3.E1.m1.4.4.3.3.4.cmml"><mo id="S3.E1.m1.4.4.3.3.3.4" stretchy="false" xref="S3.E1.m1.4.4.3.3.4.cmml">(</mo><msub id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.1.1.1.1.2.cmml">l</mi><mn id="S3.E1.m1.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.4.4.3.3.3.5" xref="S3.E1.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.E1.m1.3.3.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.2.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2.2.cmml">l</mi><mn id="S3.E1.m1.3.3.2.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E1.m1.4.4.3.3.3.6" xref="S3.E1.m1.4.4.3.3.4.cmml">,</mo><mi id="S3.E1.m1.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.4.4.3.3.3.7" xref="S3.E1.m1.4.4.3.3.4.cmml">,</mo><msub id="S3.E1.m1.4.4.3.3.3.3" xref="S3.E1.m1.4.4.3.3.3.3.cmml"><mi id="S3.E1.m1.4.4.3.3.3.3.2" xref="S3.E1.m1.4.4.3.3.3.3.2.cmml">l</mi><mi id="S3.E1.m1.4.4.3.3.3.3.3" xref="S3.E1.m1.4.4.3.3.3.3.3.cmml">m</mi></msub><mo id="S3.E1.m1.4.4.3.3.3.8" stretchy="false" xref="S3.E1.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.5.5.5" rspace="0.111em" xref="S3.E1.m1.5.5.5.cmml">=</mo><mrow id="S3.E1.m1.5.5.4" xref="S3.E1.m1.5.5.4.cmml"><munder id="S3.E1.m1.5.5.4.2" xref="S3.E1.m1.5.5.4.2.cmml"><mo id="S3.E1.m1.5.5.4.2.2" movablelimits="false" xref="S3.E1.m1.5.5.4.2.2.cmml">∏</mo><mi id="S3.E1.m1.5.5.4.2.3" xref="S3.E1.m1.5.5.4.2.3.cmml">i</mi></munder><mrow id="S3.E1.m1.5.5.4.1" xref="S3.E1.m1.5.5.4.1.cmml"><msub id="S3.E1.m1.5.5.4.1.3" xref="S3.E1.m1.5.5.4.1.3.cmml"><mi id="S3.E1.m1.5.5.4.1.3.2" xref="S3.E1.m1.5.5.4.1.3.2.cmml">ρ</mi><mi id="S3.E1.m1.5.5.4.1.3.3" xref="S3.E1.m1.5.5.4.1.3.3.cmml">i</mi></msub><mo id="S3.E1.m1.5.5.4.1.2" xref="S3.E1.m1.5.5.4.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.5.5.4.1.1.1" xref="S3.E1.m1.5.5.4.1.1.1.1.cmml"><mo id="S3.E1.m1.5.5.4.1.1.1.2" stretchy="false" xref="S3.E1.m1.5.5.4.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.5.5.4.1.1.1.1" xref="S3.E1.m1.5.5.4.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.4.1.1.1.1.2" xref="S3.E1.m1.5.5.4.1.1.1.1.2.cmml">l</mi><mi id="S3.E1.m1.5.5.4.1.1.1.1.3" xref="S3.E1.m1.5.5.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.5.5.4.1.1.1.3" stretchy="false" xref="S3.E1.m1.5.5.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5"><eq id="S3.E1.m1.5.5.5.cmml" xref="S3.E1.m1.5.5.5"></eq><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><times id="S3.E1.m1.4.4.3.4.cmml" xref="S3.E1.m1.4.4.3.4"></times><ci id="S3.E1.m1.4.4.3.5.cmml" xref="S3.E1.m1.4.4.3.5">𝜌</ci><vector id="S3.E1.m1.4.4.3.3.4.cmml" xref="S3.E1.m1.4.4.3.3.3"><apply id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2">𝑙</ci><cn id="S3.E1.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.3.3.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2">𝑙</ci><cn id="S3.E1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.4.4.3.3.3.3.cmml" xref="S3.E1.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.3.3.3.3.1.cmml" xref="S3.E1.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.E1.m1.4.4.3.3.3.3.2.cmml" xref="S3.E1.m1.4.4.3.3.3.3.2">𝑙</ci><ci id="S3.E1.m1.4.4.3.3.3.3.3.cmml" xref="S3.E1.m1.4.4.3.3.3.3.3">𝑚</ci></apply></vector></apply><apply id="S3.E1.m1.5.5.4.cmml" xref="S3.E1.m1.5.5.4"><apply id="S3.E1.m1.5.5.4.2.cmml" xref="S3.E1.m1.5.5.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.4.2.1.cmml" xref="S3.E1.m1.5.5.4.2">subscript</csymbol><csymbol cd="latexml" id="S3.E1.m1.5.5.4.2.2.cmml" xref="S3.E1.m1.5.5.4.2.2">product</csymbol><ci id="S3.E1.m1.5.5.4.2.3.cmml" xref="S3.E1.m1.5.5.4.2.3">𝑖</ci></apply><apply id="S3.E1.m1.5.5.4.1.cmml" xref="S3.E1.m1.5.5.4.1"><times id="S3.E1.m1.5.5.4.1.2.cmml" xref="S3.E1.m1.5.5.4.1.2"></times><apply id="S3.E1.m1.5.5.4.1.3.cmml" xref="S3.E1.m1.5.5.4.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.4.1.3.1.cmml" xref="S3.E1.m1.5.5.4.1.3">subscript</csymbol><ci id="S3.E1.m1.5.5.4.1.3.2.cmml" xref="S3.E1.m1.5.5.4.1.3.2">𝜌</ci><ci id="S3.E1.m1.5.5.4.1.3.3.cmml" xref="S3.E1.m1.5.5.4.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.5.5.4.1.1.1.1.cmml" xref="S3.E1.m1.5.5.4.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.4.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.4.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.4.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.4.1.1.1.1.2">𝑙</ci><ci id="S3.E1.m1.5.5.4.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.4.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\rho(l_{1},l_{2},...,l_{m})=\prod\limits_{i}\rho_{i}(l_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.5d">italic_ρ ( italic_l start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_l start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_l start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_ρ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">We ask the LLM for each <math alttext="l_{j}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">l</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝑙</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">l_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, to estimate the marginal proportion of solutions this holds for. As this may not add up to 1, we normalize the estimates to form a proper probability distribution. For simplicity, we focus in this work on settings where all solution in the solution space is equally like. As noted in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.SS2" title="3.2 Auto-Stratification ‣ 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we encourage the LLM to propose balanced partitions. However, heuristic estimation allow us to support imbalanced partitions by reweighing the sampling to favor stratum with more potential solutions. More details on prompting in App. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A4" title="Appendix D Heuristic Estimation Prompt ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">D</span></a>. In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S1.F2.1" title="Figure 2 ‣ 1 Introduction. ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">2</span></a>, the LLM determines the joint probabilities across two stratas, the Mississippi River and the Missouri Compromise Line.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Probabilistic Prompting.</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Post heuristic estimation, a set of statum is sampled from the joint probability distribution in Eqn. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.E1" title="In 3.3 Heuristic estimation ‣ 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">1</span></a>. This implicitly forms a <span class="ltx_text ltx_font_italic" id="S3.SS4.p1.1.1">probabilistic prompt</span>, which specifies a distribution over concrete language model prompts. After a prompt is sampled, the LLM is then used to sample from within the stratum. Back to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S1.F2.1" title="Figure 2 ‣ 1 Introduction. ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">2</span></a>, East and South are sampled from the Mississippi and Missouri strata respectively, augmenting the final prompt with diverse specifications.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.8">Formally, call <math alttext="\vec{l}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><mover accent="true" id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">l</mi><mo id="S3.SS4.p2.1.m1.1.1.1" stretchy="false" xref="S3.SS4.p2.1.m1.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><ci id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1">→</ci><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\vec{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">over→ start_ARG italic_l end_ARG</annotation></semantics></math> a stratum defined by choices of <math alttext="l_{i,j}" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.2"><semantics id="S3.SS4.p2.2.m2.2a"><msub id="S3.SS4.p2.2.m2.2.3" xref="S3.SS4.p2.2.m2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.2.3.2" xref="S3.SS4.p2.2.m2.2.3.2.cmml">l</mi><mrow id="S3.SS4.p2.2.m2.2.2.2.4" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml"><mi id="S3.SS4.p2.2.m2.1.1.1.1" xref="S3.SS4.p2.2.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS4.p2.2.m2.2.2.2.4.1" xref="S3.SS4.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS4.p2.2.m2.2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><apply id="S3.SS4.p2.2.m2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.3.1.cmml" xref="S3.SS4.p2.2.m2.2.3">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.3.2.cmml" xref="S3.SS4.p2.2.m2.2.3.2">𝑙</ci><list id="S3.SS4.p2.2.m2.2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.2.4"><ci id="S3.SS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1.1.1">𝑖</ci><ci id="S3.SS4.p2.2.m2.2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">l_{i,j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.2d">italic_l start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT</annotation></semantics></math> for each <math alttext="P_{i}" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><msub id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">P</mi><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝑃</ci><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">P_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> across all <math alttext="i" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><mi id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><ci id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">italic_i</annotation></semantics></math>. Call <math alttext="Prompt" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><mrow id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml">P</mi><mo id="S3.SS4.p2.5.m5.1.1.1" xref="S3.SS4.p2.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml">r</mi><mo id="S3.SS4.p2.5.m5.1.1.1a" xref="S3.SS4.p2.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p2.5.m5.1.1.4" xref="S3.SS4.p2.5.m5.1.1.4.cmml">o</mi><mo id="S3.SS4.p2.5.m5.1.1.1b" xref="S3.SS4.p2.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p2.5.m5.1.1.5" xref="S3.SS4.p2.5.m5.1.1.5.cmml">m</mi><mo id="S3.SS4.p2.5.m5.1.1.1c" xref="S3.SS4.p2.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p2.5.m5.1.1.6" xref="S3.SS4.p2.5.m5.1.1.6.cmml">p</mi><mo id="S3.SS4.p2.5.m5.1.1.1d" xref="S3.SS4.p2.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p2.5.m5.1.1.7" xref="S3.SS4.p2.5.m5.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><times id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1.1"></times><ci id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2">𝑃</ci><ci id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3">𝑟</ci><ci id="S3.SS4.p2.5.m5.1.1.4.cmml" xref="S3.SS4.p2.5.m5.1.1.4">𝑜</ci><ci id="S3.SS4.p2.5.m5.1.1.5.cmml" xref="S3.SS4.p2.5.m5.1.1.5">𝑚</ci><ci id="S3.SS4.p2.5.m5.1.1.6.cmml" xref="S3.SS4.p2.5.m5.1.1.6">𝑝</ci><ci id="S3.SS4.p2.5.m5.1.1.7.cmml" xref="S3.SS4.p2.5.m5.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">Prompt</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_P italic_r italic_o italic_m italic_p italic_t</annotation></semantics></math> a function that maps the stratum, <math alttext="\vec{l}" class="ltx_Math" display="inline" id="S3.SS4.p2.6.m6.1"><semantics id="S3.SS4.p2.6.m6.1a"><mover accent="true" id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml"><mi id="S3.SS4.p2.6.m6.1.1.2" xref="S3.SS4.p2.6.m6.1.1.2.cmml">l</mi><mo id="S3.SS4.p2.6.m6.1.1.1" stretchy="false" xref="S3.SS4.p2.6.m6.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><apply id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1"><ci id="S3.SS4.p2.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1.1">→</ci><ci id="S3.SS4.p2.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">\vec{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.6.m6.1d">over→ start_ARG italic_l end_ARG</annotation></semantics></math> to a concrete prompt, <math alttext="Prompt(\vec{l})" class="ltx_Math" display="inline" id="S3.SS4.p2.7.m7.1"><semantics id="S3.SS4.p2.7.m7.1a"><mrow id="S3.SS4.p2.7.m7.1.2" xref="S3.SS4.p2.7.m7.1.2.cmml"><mi id="S3.SS4.p2.7.m7.1.2.2" xref="S3.SS4.p2.7.m7.1.2.2.cmml">P</mi><mo id="S3.SS4.p2.7.m7.1.2.1" xref="S3.SS4.p2.7.m7.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.2.3" xref="S3.SS4.p2.7.m7.1.2.3.cmml">r</mi><mo id="S3.SS4.p2.7.m7.1.2.1a" xref="S3.SS4.p2.7.m7.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.2.4" xref="S3.SS4.p2.7.m7.1.2.4.cmml">o</mi><mo id="S3.SS4.p2.7.m7.1.2.1b" xref="S3.SS4.p2.7.m7.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.2.5" xref="S3.SS4.p2.7.m7.1.2.5.cmml">m</mi><mo id="S3.SS4.p2.7.m7.1.2.1c" xref="S3.SS4.p2.7.m7.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.2.6" xref="S3.SS4.p2.7.m7.1.2.6.cmml">p</mi><mo id="S3.SS4.p2.7.m7.1.2.1d" xref="S3.SS4.p2.7.m7.1.2.1.cmml">⁢</mo><mi id="S3.SS4.p2.7.m7.1.2.7" xref="S3.SS4.p2.7.m7.1.2.7.cmml">t</mi><mo id="S3.SS4.p2.7.m7.1.2.1e" xref="S3.SS4.p2.7.m7.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p2.7.m7.1.2.8.2" xref="S3.SS4.p2.7.m7.1.1.cmml"><mo id="S3.SS4.p2.7.m7.1.2.8.2.1" stretchy="false" xref="S3.SS4.p2.7.m7.1.1.cmml">(</mo><mover accent="true" id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.2" xref="S3.SS4.p2.7.m7.1.1.2.cmml">l</mi><mo id="S3.SS4.p2.7.m7.1.1.1" stretchy="false" xref="S3.SS4.p2.7.m7.1.1.1.cmml">→</mo></mover><mo id="S3.SS4.p2.7.m7.1.2.8.2.2" stretchy="false" xref="S3.SS4.p2.7.m7.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.2.cmml" xref="S3.SS4.p2.7.m7.1.2"><times id="S3.SS4.p2.7.m7.1.2.1.cmml" xref="S3.SS4.p2.7.m7.1.2.1"></times><ci id="S3.SS4.p2.7.m7.1.2.2.cmml" xref="S3.SS4.p2.7.m7.1.2.2">𝑃</ci><ci id="S3.SS4.p2.7.m7.1.2.3.cmml" xref="S3.SS4.p2.7.m7.1.2.3">𝑟</ci><ci id="S3.SS4.p2.7.m7.1.2.4.cmml" xref="S3.SS4.p2.7.m7.1.2.4">𝑜</ci><ci id="S3.SS4.p2.7.m7.1.2.5.cmml" xref="S3.SS4.p2.7.m7.1.2.5">𝑚</ci><ci id="S3.SS4.p2.7.m7.1.2.6.cmml" xref="S3.SS4.p2.7.m7.1.2.6">𝑝</ci><ci id="S3.SS4.p2.7.m7.1.2.7.cmml" xref="S3.SS4.p2.7.m7.1.2.7">𝑡</ci><apply id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.2.8.2"><ci id="S3.SS4.p2.7.m7.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1.1">→</ci><ci id="S3.SS4.p2.7.m7.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.2">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">Prompt(\vec{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.7.m7.1d">italic_P italic_r italic_o italic_m italic_p italic_t ( over→ start_ARG italic_l end_ARG )</annotation></semantics></math>. Intuitively, the probabilities of the prompt distribution is defined by <math alttext="Pr[Prompt(\vec{l}]=\rho(\vec{l})" class="ltx_math_unparsed" display="inline" id="S3.SS4.p2.8.m8.1"><semantics id="S3.SS4.p2.8.m8.1a"><mrow id="S3.SS4.p2.8.m8.1b"><mi id="S3.SS4.p2.8.m8.1.1">P</mi><mi id="S3.SS4.p2.8.m8.1.2">r</mi><mrow id="S3.SS4.p2.8.m8.1.3"><mo id="S3.SS4.p2.8.m8.1.3.1" stretchy="false">[</mo><mi id="S3.SS4.p2.8.m8.1.3.2">P</mi><mi id="S3.SS4.p2.8.m8.1.3.3">r</mi><mi id="S3.SS4.p2.8.m8.1.3.4">o</mi><mi id="S3.SS4.p2.8.m8.1.3.5">m</mi><mi id="S3.SS4.p2.8.m8.1.3.6">p</mi><mi id="S3.SS4.p2.8.m8.1.3.7">t</mi><mrow id="S3.SS4.p2.8.m8.1.3.8"><mo id="S3.SS4.p2.8.m8.1.3.8.1" stretchy="false">(</mo><mover accent="true" id="S3.SS4.p2.8.m8.1.3.8.2"><mi id="S3.SS4.p2.8.m8.1.3.8.2.2">l</mi><mo id="S3.SS4.p2.8.m8.1.3.8.2.1" stretchy="false">→</mo></mover><mo id="S3.SS4.p2.8.m8.1.3.8.3" stretchy="false">]</mo></mrow><mo id="S3.SS4.p2.8.m8.1.3.9">=</mo><mi id="S3.SS4.p2.8.m8.1.3.10">ρ</mi><mrow id="S3.SS4.p2.8.m8.1.3.11"><mo id="S3.SS4.p2.8.m8.1.3.11.1" stretchy="false">(</mo><mover accent="true" id="S3.SS4.p2.8.m8.1.3.11.2"><mi id="S3.SS4.p2.8.m8.1.3.11.2.2">l</mi><mo id="S3.SS4.p2.8.m8.1.3.11.2.1" stretchy="false">→</mo></mover><mo id="S3.SS4.p2.8.m8.1.3.11.3" stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">Pr[Prompt(\vec{l}]=\rho(\vec{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.8.m8.1d">italic_P italic_r [ italic_P italic_r italic_o italic_m italic_p italic_t ( over→ start_ARG italic_l end_ARG ] = italic_ρ ( over→ start_ARG italic_l end_ARG )</annotation></semantics></math>. We can then compute the probability of a solution</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Pr[s]=\sum_{\vec{l}}Pr[\text{Prompt}(\vec{l})]*Pr[s\mid\text{Prompt}(\vec{l})]%
=\sum_{\vec{l}}\rho(\vec{l})*Pr[s\mid\text{Prompt}(\vec{l})]" class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml"><mrow id="S3.E2.m1.8.8.5" xref="S3.E2.m1.8.8.5.cmml"><mi id="S3.E2.m1.8.8.5.2" xref="S3.E2.m1.8.8.5.2.cmml">P</mi><mo id="S3.E2.m1.8.8.5.1" xref="S3.E2.m1.8.8.5.1.cmml">⁢</mo><mi id="S3.E2.m1.8.8.5.3" xref="S3.E2.m1.8.8.5.3.cmml">r</mi><mo id="S3.E2.m1.8.8.5.1a" xref="S3.E2.m1.8.8.5.1.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.5.4.2" xref="S3.E2.m1.8.8.5.4.1.cmml"><mo id="S3.E2.m1.8.8.5.4.2.1" stretchy="false" xref="S3.E2.m1.8.8.5.4.1.1.cmml">[</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">s</mi><mo id="S3.E2.m1.8.8.5.4.2.2" stretchy="false" xref="S3.E2.m1.8.8.5.4.1.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.8.8.6" rspace="0.111em" xref="S3.E2.m1.8.8.6.cmml">=</mo><mrow id="S3.E2.m1.7.7.2" xref="S3.E2.m1.7.7.2.cmml"><munder id="S3.E2.m1.7.7.2.3" xref="S3.E2.m1.7.7.2.3.cmml"><mo id="S3.E2.m1.7.7.2.3.2" movablelimits="false" xref="S3.E2.m1.7.7.2.3.2.cmml">∑</mo><mover accent="true" id="S3.E2.m1.7.7.2.3.3" xref="S3.E2.m1.7.7.2.3.3.cmml"><mi id="S3.E2.m1.7.7.2.3.3.2" xref="S3.E2.m1.7.7.2.3.3.2.cmml">l</mi><mo id="S3.E2.m1.7.7.2.3.3.1" stretchy="false" xref="S3.E2.m1.7.7.2.3.3.1.cmml">→</mo></mover></munder><mrow id="S3.E2.m1.7.7.2.2" xref="S3.E2.m1.7.7.2.2.cmml"><mrow id="S3.E2.m1.6.6.1.1.1" xref="S3.E2.m1.6.6.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.1.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.1.3.cmml">P</mi><mo id="S3.E2.m1.6.6.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E2.m1.6.6.1.1.1.1.4" xref="S3.E2.m1.6.6.1.1.1.1.4.cmml">r</mi><mo id="S3.E2.m1.6.6.1.1.1.1.2a" xref="S3.E2.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml"><mtext id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2a.cmml">Prompt</mtext><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.cmml"><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E2.m1.2.2.cmml">(</mo><mover accent="true" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mi id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml">l</mi><mo id="S3.E2.m1.2.2.1" stretchy="false" xref="S3.E2.m1.2.2.1.cmml">→</mo></mover><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E2.m1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E2.m1.6.6.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E2.m1.6.6.1.1.1.2" rspace="0.222em" xref="S3.E2.m1.6.6.1.1.1.2.cmml">∗</mo><mi id="S3.E2.m1.6.6.1.1.1.3" xref="S3.E2.m1.6.6.1.1.1.3.cmml">P</mi></mrow><mo id="S3.E2.m1.7.7.2.2.3" xref="S3.E2.m1.7.7.2.2.3.cmml">⁢</mo><mi id="S3.E2.m1.7.7.2.2.4" xref="S3.E2.m1.7.7.2.2.4.cmml">r</mi><mo id="S3.E2.m1.7.7.2.2.3a" xref="S3.E2.m1.7.7.2.2.3.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.2.2.2.1" xref="S3.E2.m1.7.7.2.2.2.2.cmml"><mo id="S3.E2.m1.7.7.2.2.2.1.2" stretchy="false" xref="S3.E2.m1.7.7.2.2.2.2.1.cmml">[</mo><mrow id="S3.E2.m1.7.7.2.2.2.1.1" xref="S3.E2.m1.7.7.2.2.2.1.1.cmml"><mi id="S3.E2.m1.7.7.2.2.2.1.1.2" xref="S3.E2.m1.7.7.2.2.2.1.1.2.cmml">s</mi><mo id="S3.E2.m1.7.7.2.2.2.1.1.1" xref="S3.E2.m1.7.7.2.2.2.1.1.1.cmml">∣</mo><mrow id="S3.E2.m1.7.7.2.2.2.1.1.3" xref="S3.E2.m1.7.7.2.2.2.1.1.3.cmml"><mtext id="S3.E2.m1.7.7.2.2.2.1.1.3.2" xref="S3.E2.m1.7.7.2.2.2.1.1.3.2a.cmml">Prompt</mtext><mo id="S3.E2.m1.7.7.2.2.2.1.1.3.1" xref="S3.E2.m1.7.7.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.2.2.2.1.1.3.3.2" xref="S3.E2.m1.3.3.cmml"><mo id="S3.E2.m1.7.7.2.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.3.3.cmml">(</mo><mover accent="true" id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><mi id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml">l</mi><mo id="S3.E2.m1.3.3.1" stretchy="false" xref="S3.E2.m1.3.3.1.cmml">→</mo></mover><mo id="S3.E2.m1.7.7.2.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.7.7.2.2.2.1.3" stretchy="false" xref="S3.E2.m1.7.7.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.7" rspace="0.111em" xref="S3.E2.m1.8.8.7.cmml">=</mo><mrow id="S3.E2.m1.8.8.3" xref="S3.E2.m1.8.8.3.cmml"><munder id="S3.E2.m1.8.8.3.2" xref="S3.E2.m1.8.8.3.2.cmml"><mo id="S3.E2.m1.8.8.3.2.2" movablelimits="false" xref="S3.E2.m1.8.8.3.2.2.cmml">∑</mo><mover accent="true" id="S3.E2.m1.8.8.3.2.3" xref="S3.E2.m1.8.8.3.2.3.cmml"><mi id="S3.E2.m1.8.8.3.2.3.2" xref="S3.E2.m1.8.8.3.2.3.2.cmml">l</mi><mo id="S3.E2.m1.8.8.3.2.3.1" stretchy="false" xref="S3.E2.m1.8.8.3.2.3.1.cmml">→</mo></mover></munder><mrow id="S3.E2.m1.8.8.3.1" xref="S3.E2.m1.8.8.3.1.cmml"><mrow id="S3.E2.m1.8.8.3.1.3" xref="S3.E2.m1.8.8.3.1.3.cmml"><mrow id="S3.E2.m1.8.8.3.1.3.2" xref="S3.E2.m1.8.8.3.1.3.2.cmml"><mi id="S3.E2.m1.8.8.3.1.3.2.2" xref="S3.E2.m1.8.8.3.1.3.2.2.cmml">ρ</mi><mo id="S3.E2.m1.8.8.3.1.3.2.1" xref="S3.E2.m1.8.8.3.1.3.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.3.1.3.2.3.2" xref="S3.E2.m1.4.4.cmml"><mo id="S3.E2.m1.8.8.3.1.3.2.3.2.1" stretchy="false" xref="S3.E2.m1.4.4.cmml">(</mo><mover accent="true" id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mi id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.2.cmml">l</mi><mo id="S3.E2.m1.4.4.1" stretchy="false" xref="S3.E2.m1.4.4.1.cmml">→</mo></mover><mo id="S3.E2.m1.8.8.3.1.3.2.3.2.2" rspace="0.055em" stretchy="false" xref="S3.E2.m1.4.4.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.8.8.3.1.3.1" rspace="0.222em" xref="S3.E2.m1.8.8.3.1.3.1.cmml">∗</mo><mi id="S3.E2.m1.8.8.3.1.3.3" xref="S3.E2.m1.8.8.3.1.3.3.cmml">P</mi></mrow><mo id="S3.E2.m1.8.8.3.1.2" xref="S3.E2.m1.8.8.3.1.2.cmml">⁢</mo><mi id="S3.E2.m1.8.8.3.1.4" xref="S3.E2.m1.8.8.3.1.4.cmml">r</mi><mo id="S3.E2.m1.8.8.3.1.2a" xref="S3.E2.m1.8.8.3.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.3.1.1.1" xref="S3.E2.m1.8.8.3.1.1.2.cmml"><mo id="S3.E2.m1.8.8.3.1.1.1.2" stretchy="false" xref="S3.E2.m1.8.8.3.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.8.8.3.1.1.1.1" xref="S3.E2.m1.8.8.3.1.1.1.1.cmml"><mi id="S3.E2.m1.8.8.3.1.1.1.1.2" xref="S3.E2.m1.8.8.3.1.1.1.1.2.cmml">s</mi><mo id="S3.E2.m1.8.8.3.1.1.1.1.1" xref="S3.E2.m1.8.8.3.1.1.1.1.1.cmml">∣</mo><mrow id="S3.E2.m1.8.8.3.1.1.1.1.3" xref="S3.E2.m1.8.8.3.1.1.1.1.3.cmml"><mtext id="S3.E2.m1.8.8.3.1.1.1.1.3.2" xref="S3.E2.m1.8.8.3.1.1.1.1.3.2a.cmml">Prompt</mtext><mo id="S3.E2.m1.8.8.3.1.1.1.1.3.1" xref="S3.E2.m1.8.8.3.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.8.8.3.1.1.1.1.3.3.2" xref="S3.E2.m1.5.5.cmml"><mo id="S3.E2.m1.8.8.3.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.5.5.cmml">(</mo><mover accent="true" id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml"><mi id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.2.cmml">l</mi><mo id="S3.E2.m1.5.5.1" stretchy="false" xref="S3.E2.m1.5.5.1.cmml">→</mo></mover><mo id="S3.E2.m1.8.8.3.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E2.m1.5.5.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.3.1.1.1.3" stretchy="false" xref="S3.E2.m1.8.8.3.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"><and id="S3.E2.m1.8.8a.cmml" xref="S3.E2.m1.8.8"></and><apply id="S3.E2.m1.8.8b.cmml" xref="S3.E2.m1.8.8"><eq id="S3.E2.m1.8.8.6.cmml" xref="S3.E2.m1.8.8.6"></eq><apply id="S3.E2.m1.8.8.5.cmml" xref="S3.E2.m1.8.8.5"><times id="S3.E2.m1.8.8.5.1.cmml" xref="S3.E2.m1.8.8.5.1"></times><ci id="S3.E2.m1.8.8.5.2.cmml" xref="S3.E2.m1.8.8.5.2">𝑃</ci><ci id="S3.E2.m1.8.8.5.3.cmml" xref="S3.E2.m1.8.8.5.3">𝑟</ci><apply id="S3.E2.m1.8.8.5.4.1.cmml" xref="S3.E2.m1.8.8.5.4.2"><csymbol cd="latexml" id="S3.E2.m1.8.8.5.4.1.1.cmml" xref="S3.E2.m1.8.8.5.4.2.1">delimited-[]</csymbol><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑠</ci></apply></apply><apply id="S3.E2.m1.7.7.2.cmml" xref="S3.E2.m1.7.7.2"><apply id="S3.E2.m1.7.7.2.3.cmml" xref="S3.E2.m1.7.7.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.2.3.1.cmml" xref="S3.E2.m1.7.7.2.3">subscript</csymbol><sum id="S3.E2.m1.7.7.2.3.2.cmml" xref="S3.E2.m1.7.7.2.3.2"></sum><apply id="S3.E2.m1.7.7.2.3.3.cmml" xref="S3.E2.m1.7.7.2.3.3"><ci id="S3.E2.m1.7.7.2.3.3.1.cmml" xref="S3.E2.m1.7.7.2.3.3.1">→</ci><ci id="S3.E2.m1.7.7.2.3.3.2.cmml" xref="S3.E2.m1.7.7.2.3.3.2">𝑙</ci></apply></apply><apply id="S3.E2.m1.7.7.2.2.cmml" xref="S3.E2.m1.7.7.2.2"><times id="S3.E2.m1.7.7.2.2.3.cmml" xref="S3.E2.m1.7.7.2.2.3"></times><apply id="S3.E2.m1.6.6.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.2"></times><apply id="S3.E2.m1.6.6.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.2"></times><ci id="S3.E2.m1.6.6.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.1.3">𝑃</ci><ci id="S3.E2.m1.6.6.1.1.1.1.4.cmml" xref="S3.E2.m1.6.6.1.1.1.1.4">𝑟</ci><apply id="S3.E2.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1"><times id="S3.E2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.1"></times><ci id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2a.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2"><mtext id="S3.E2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.2">Prompt</mtext></ci><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.6.6.1.1.1.1.1.1.1.3.2"><ci id="S3.E2.m1.2.2.1.cmml" xref="S3.E2.m1.2.2.1">→</ci><ci id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2">𝑙</ci></apply></apply></apply></apply><ci id="S3.E2.m1.6.6.1.1.1.3.cmml" xref="S3.E2.m1.6.6.1.1.1.3">𝑃</ci></apply><ci id="S3.E2.m1.7.7.2.2.4.cmml" xref="S3.E2.m1.7.7.2.2.4">𝑟</ci><apply id="S3.E2.m1.7.7.2.2.2.2.cmml" xref="S3.E2.m1.7.7.2.2.2.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.2.2.2.2.1.cmml" xref="S3.E2.m1.7.7.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.7.7.2.2.2.1.1.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.2.2.2.1.1.1.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.1">conditional</csymbol><ci id="S3.E2.m1.7.7.2.2.2.1.1.2.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.2">𝑠</ci><apply id="S3.E2.m1.7.7.2.2.2.1.1.3.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.3"><times id="S3.E2.m1.7.7.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.3.1"></times><ci id="S3.E2.m1.7.7.2.2.2.1.1.3.2a.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.3.2"><mtext id="S3.E2.m1.7.7.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.3.2">Prompt</mtext></ci><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.7.7.2.2.2.1.1.3.3.2"><ci id="S3.E2.m1.3.3.1.cmml" xref="S3.E2.m1.3.3.1">→</ci><ci id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2">𝑙</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.8.8c.cmml" xref="S3.E2.m1.8.8"><eq id="S3.E2.m1.8.8.7.cmml" xref="S3.E2.m1.8.8.7"></eq><share href="https://arxiv.org/html/2410.09038v2#S3.E2.m1.7.7.2.cmml" id="S3.E2.m1.8.8d.cmml" xref="S3.E2.m1.8.8"></share><apply id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.3"><apply id="S3.E2.m1.8.8.3.2.cmml" xref="S3.E2.m1.8.8.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3.2.1.cmml" xref="S3.E2.m1.8.8.3.2">subscript</csymbol><sum id="S3.E2.m1.8.8.3.2.2.cmml" xref="S3.E2.m1.8.8.3.2.2"></sum><apply id="S3.E2.m1.8.8.3.2.3.cmml" xref="S3.E2.m1.8.8.3.2.3"><ci id="S3.E2.m1.8.8.3.2.3.1.cmml" xref="S3.E2.m1.8.8.3.2.3.1">→</ci><ci id="S3.E2.m1.8.8.3.2.3.2.cmml" xref="S3.E2.m1.8.8.3.2.3.2">𝑙</ci></apply></apply><apply id="S3.E2.m1.8.8.3.1.cmml" xref="S3.E2.m1.8.8.3.1"><times id="S3.E2.m1.8.8.3.1.2.cmml" xref="S3.E2.m1.8.8.3.1.2"></times><apply id="S3.E2.m1.8.8.3.1.3.cmml" xref="S3.E2.m1.8.8.3.1.3"><times id="S3.E2.m1.8.8.3.1.3.1.cmml" xref="S3.E2.m1.8.8.3.1.3.1"></times><apply id="S3.E2.m1.8.8.3.1.3.2.cmml" xref="S3.E2.m1.8.8.3.1.3.2"><times id="S3.E2.m1.8.8.3.1.3.2.1.cmml" xref="S3.E2.m1.8.8.3.1.3.2.1"></times><ci id="S3.E2.m1.8.8.3.1.3.2.2.cmml" xref="S3.E2.m1.8.8.3.1.3.2.2">𝜌</ci><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.8.8.3.1.3.2.3.2"><ci id="S3.E2.m1.4.4.1.cmml" xref="S3.E2.m1.4.4.1">→</ci><ci id="S3.E2.m1.4.4.2.cmml" xref="S3.E2.m1.4.4.2">𝑙</ci></apply></apply><ci id="S3.E2.m1.8.8.3.1.3.3.cmml" xref="S3.E2.m1.8.8.3.1.3.3">𝑃</ci></apply><ci id="S3.E2.m1.8.8.3.1.4.cmml" xref="S3.E2.m1.8.8.3.1.4">𝑟</ci><apply id="S3.E2.m1.8.8.3.1.1.2.cmml" xref="S3.E2.m1.8.8.3.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.3.1.1.2.1.cmml" xref="S3.E2.m1.8.8.3.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.8.8.3.1.1.1.1.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.8.8.3.1.1.1.1.1.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.1">conditional</csymbol><ci id="S3.E2.m1.8.8.3.1.1.1.1.2.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.2">𝑠</ci><apply id="S3.E2.m1.8.8.3.1.1.1.1.3.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.3"><times id="S3.E2.m1.8.8.3.1.1.1.1.3.1.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.3.1"></times><ci id="S3.E2.m1.8.8.3.1.1.1.1.3.2a.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.3.2"><mtext id="S3.E2.m1.8.8.3.1.1.1.1.3.2.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.3.2">Prompt</mtext></ci><apply id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.8.8.3.1.1.1.1.3.3.2"><ci id="S3.E2.m1.5.5.1.cmml" xref="S3.E2.m1.5.5.1">→</ci><ci id="S3.E2.m1.5.5.2.cmml" xref="S3.E2.m1.5.5.2">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">Pr[s]=\sum_{\vec{l}}Pr[\text{Prompt}(\vec{l})]*Pr[s\mid\text{Prompt}(\vec{l})]%
=\sum_{\vec{l}}\rho(\vec{l})*Pr[s\mid\text{Prompt}(\vec{l})]</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">italic_P italic_r [ italic_s ] = ∑ start_POSTSUBSCRIPT over→ start_ARG italic_l end_ARG end_POSTSUBSCRIPT italic_P italic_r [ Prompt ( over→ start_ARG italic_l end_ARG ) ] ∗ italic_P italic_r [ italic_s ∣ Prompt ( over→ start_ARG italic_l end_ARG ) ] = ∑ start_POSTSUBSCRIPT over→ start_ARG italic_l end_ARG end_POSTSUBSCRIPT italic_ρ ( over→ start_ARG italic_l end_ARG ) ∗ italic_P italic_r [ italic_s ∣ Prompt ( over→ start_ARG italic_l end_ARG ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.9">The specific language model’s next-token probabilities define <math alttext="Pr[s\mid\text{Prompt}(\vec{l})]" class="ltx_Math" display="inline" id="S3.SS4.p2.9.m1.2"><semantics id="S3.SS4.p2.9.m1.2a"><mrow id="S3.SS4.p2.9.m1.2.2" xref="S3.SS4.p2.9.m1.2.2.cmml"><mi id="S3.SS4.p2.9.m1.2.2.3" xref="S3.SS4.p2.9.m1.2.2.3.cmml">P</mi><mo id="S3.SS4.p2.9.m1.2.2.2" xref="S3.SS4.p2.9.m1.2.2.2.cmml">⁢</mo><mi id="S3.SS4.p2.9.m1.2.2.4" xref="S3.SS4.p2.9.m1.2.2.4.cmml">r</mi><mo id="S3.SS4.p2.9.m1.2.2.2a" xref="S3.SS4.p2.9.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS4.p2.9.m1.2.2.1.1" xref="S3.SS4.p2.9.m1.2.2.1.2.cmml"><mo id="S3.SS4.p2.9.m1.2.2.1.1.2" stretchy="false" xref="S3.SS4.p2.9.m1.2.2.1.2.1.cmml">[</mo><mrow id="S3.SS4.p2.9.m1.2.2.1.1.1" xref="S3.SS4.p2.9.m1.2.2.1.1.1.cmml"><mi id="S3.SS4.p2.9.m1.2.2.1.1.1.2" xref="S3.SS4.p2.9.m1.2.2.1.1.1.2.cmml">s</mi><mo id="S3.SS4.p2.9.m1.2.2.1.1.1.1" xref="S3.SS4.p2.9.m1.2.2.1.1.1.1.cmml">∣</mo><mrow id="S3.SS4.p2.9.m1.2.2.1.1.1.3" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.cmml"><mtext id="S3.SS4.p2.9.m1.2.2.1.1.1.3.2" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.2a.cmml">Prompt</mtext><mo id="S3.SS4.p2.9.m1.2.2.1.1.1.3.1" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.SS4.p2.9.m1.2.2.1.1.1.3.3.2" xref="S3.SS4.p2.9.m1.1.1.cmml"><mo id="S3.SS4.p2.9.m1.2.2.1.1.1.3.3.2.1" stretchy="false" xref="S3.SS4.p2.9.m1.1.1.cmml">(</mo><mover accent="true" id="S3.SS4.p2.9.m1.1.1" xref="S3.SS4.p2.9.m1.1.1.cmml"><mi id="S3.SS4.p2.9.m1.1.1.2" xref="S3.SS4.p2.9.m1.1.1.2.cmml">l</mi><mo id="S3.SS4.p2.9.m1.1.1.1" stretchy="false" xref="S3.SS4.p2.9.m1.1.1.1.cmml">→</mo></mover><mo id="S3.SS4.p2.9.m1.2.2.1.1.1.3.3.2.2" stretchy="false" xref="S3.SS4.p2.9.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS4.p2.9.m1.2.2.1.1.3" stretchy="false" xref="S3.SS4.p2.9.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m1.2b"><apply id="S3.SS4.p2.9.m1.2.2.cmml" xref="S3.SS4.p2.9.m1.2.2"><times id="S3.SS4.p2.9.m1.2.2.2.cmml" xref="S3.SS4.p2.9.m1.2.2.2"></times><ci id="S3.SS4.p2.9.m1.2.2.3.cmml" xref="S3.SS4.p2.9.m1.2.2.3">𝑃</ci><ci id="S3.SS4.p2.9.m1.2.2.4.cmml" xref="S3.SS4.p2.9.m1.2.2.4">𝑟</ci><apply id="S3.SS4.p2.9.m1.2.2.1.2.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS4.p2.9.m1.2.2.1.2.1.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.p2.9.m1.2.2.1.1.1.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS4.p2.9.m1.2.2.1.1.1.1.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS4.p2.9.m1.2.2.1.1.1.2.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.2">𝑠</ci><apply id="S3.SS4.p2.9.m1.2.2.1.1.1.3.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3"><times id="S3.SS4.p2.9.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.1"></times><ci id="S3.SS4.p2.9.m1.2.2.1.1.1.3.2a.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.2"><mtext id="S3.SS4.p2.9.m1.2.2.1.1.1.3.2.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.2">Prompt</mtext></ci><apply id="S3.SS4.p2.9.m1.1.1.cmml" xref="S3.SS4.p2.9.m1.2.2.1.1.1.3.3.2"><ci id="S3.SS4.p2.9.m1.1.1.1.cmml" xref="S3.SS4.p2.9.m1.1.1.1">→</ci><ci id="S3.SS4.p2.9.m1.1.1.2.cmml" xref="S3.SS4.p2.9.m1.1.1.2">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m1.2c">Pr[s\mid\text{Prompt}(\vec{l})]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.9.m1.2d">italic_P italic_r [ italic_s ∣ Prompt ( over→ start_ARG italic_l end_ARG ) ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1">As the probabilistic prompt is human readable form, the user can inspect the properties and the proportions and modify it to adjust for unwanted bias or remove unwanted factors. For instance, when proposing English baby names, we may want the model to propose male vs female names equally often, even though there are more female than male baby names <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>As reported in <cite class="ltx_cite ltx_citemacro_cite">Wilson (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib39" title="">2016</a>)</cite>, there are 18,993 unique names for girls and 13,959 for boys in 2015 report by Social Security Administration.</span></span></span>. This interpretability and controllability is a major advantage of SimpleStrat in practice.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>CoverageQA Dataset</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Overview</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We wish to evaluate generation diversity in settings where 1) user requests have more than one distinct correct answer, 2) and answers are equally likely, and 3) answers do not require hidden or implicit context to verify. These three properties allow us to measure diversity in the sense of whether the language model will provide coverage over the full solution space when resampled. Unfortunately existing benchmarks discussed in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S2" title="2 Related work. ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">2</span></a> do not satisfy these properties. We introduce CoverageQA to assess the language model generation diversity. The dataset consists of two splits: CoverageQA-Curated, manually curated naturally underspecified questions, and CoverageQA-Wikipedia, and auto-generated dataset of underspecified questions.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>CoverageQA-Wikipedia Approach</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To generate CoverageQA-Wikipedia, we leverage the Wikidata knowledge base which contains all relational mappings between entities and properties in Wikipedia. Our generation process starts with an initial item-property pairing and a constraint on the number of correct answers. We then perform a recursive search through Wikidata to find all sets of item-property constraints and their corresponding answers that meet our criteria. These constraints are subsequently transformed into natural language questions using GPT-4.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Consider an initial pairing of the Wikidata item "country" with the property "instance of". We might specify that we want between 20 and 40 valid answers. Our search would then yield a set of all constraints from the knowledge base that fit the initial conditions, such as "instance of country, located in Europe, uses Euro as currency". GPT-4 would convert this into a natural language question like "Name a country located in Europe that uses the Euro as its currency."</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">This approach has several advantages: 1) it allows us to create a diverse and extensive benchmark that can be easily updated with weekly updates to Wikidata, 2) it allows us to arbitrarily specify the size of the solution space as constraints can be added or removed to form; and 3) this process in principle can curate a large dataset with little manual effort or supervision. In the initial instantiation of CoverageQA dataset, we publish 105 questions across 4 domains, each corresponding to a different initial seed item-property pair. To ensure quality, we employ both automatic filters (e.g., excluding certain generic properties) and manual curation to remove redundant or unsuitable questions.
This dataset can be substantially expanded as we only used 4 domains, but we leave this for future work. For a details on the dataset breakdown and details on the question generation process, please refer to Appendix  <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A1.SS1" title="A.1 CoverageQA Dataset ‣ Appendix A Appendix ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Evaluation Setup</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">For the primary empirical evaluation of SimpleStrat, we use gpt4o-2024-08-06. To obtain true answer distributions and perform divergence from uniform analysis, we use open-source models from the Llama 3 and 3.1 families, specifically the 8B and 70B variants. The inference of these models were run on 8 A100-80GB GPUs. Additionally, we leverage claude-3.5-sonnet-20240620 for baseline evaluations on two datasets: CoverageQA Curated and CoverageQA Wikipedia. For CoverageQA, we used WikiData version from 07-03-2024.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Measuring Diversity</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We consider two measures of diversity. For models with accessible softmax next-token probabilities, we compute the probability of each solution in the solution space. We then define distributional diversity as the distributional distance between the response distribution implied by the sampling process and logits and the ground-truth distribution derived from these probabilities. For CoverageQA, the ground-truth distribution is uniform over valid solutions and zero elsewhere. In general, it can be more complex.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">In setting where we do not have access to the next-token distribution, we evaluate diversity by resampling responses to CoverageQA 100 times per question. This allows us to empirically observe the diversity in the form of coverage. We call this coverage diversity. To measure coverage, we report the recall (<math alttext="unique\ valid\ solutions/total\ unique\ valid\ solutions" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mrow id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml"><mrow id="S5.SS2.p2.1.m1.1.1.2.2" xref="S5.SS2.p2.1.m1.1.1.2.2.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2.2.2" xref="S5.SS2.p2.1.m1.1.1.2.2.2.cmml">u</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.3" xref="S5.SS2.p2.1.m1.1.1.2.2.3.cmml">n</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1a" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.4" xref="S5.SS2.p2.1.m1.1.1.2.2.4.cmml">i</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1b" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.5" xref="S5.SS2.p2.1.m1.1.1.2.2.5.cmml">q</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1c" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.6" xref="S5.SS2.p2.1.m1.1.1.2.2.6.cmml">u</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1d" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.7" xref="S5.SS2.p2.1.m1.1.1.2.2.7.cmml">e</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1e" lspace="0.500em" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.8" xref="S5.SS2.p2.1.m1.1.1.2.2.8.cmml">v</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1f" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.9" xref="S5.SS2.p2.1.m1.1.1.2.2.9.cmml">a</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1g" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.10" xref="S5.SS2.p2.1.m1.1.1.2.2.10.cmml">l</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1h" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.11" xref="S5.SS2.p2.1.m1.1.1.2.2.11.cmml">i</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1i" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.12" xref="S5.SS2.p2.1.m1.1.1.2.2.12.cmml">d</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1j" lspace="0.500em" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.13" xref="S5.SS2.p2.1.m1.1.1.2.2.13.cmml">s</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1k" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.14" xref="S5.SS2.p2.1.m1.1.1.2.2.14.cmml">o</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1l" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.15" xref="S5.SS2.p2.1.m1.1.1.2.2.15.cmml">l</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1m" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.16" xref="S5.SS2.p2.1.m1.1.1.2.2.16.cmml">u</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1n" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.17" xref="S5.SS2.p2.1.m1.1.1.2.2.17.cmml">t</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1o" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.18" xref="S5.SS2.p2.1.m1.1.1.2.2.18.cmml">i</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1p" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.19" xref="S5.SS2.p2.1.m1.1.1.2.2.19.cmml">o</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1q" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.20" xref="S5.SS2.p2.1.m1.1.1.2.2.20.cmml">n</mi><mo id="S5.SS2.p2.1.m1.1.1.2.2.1r" xref="S5.SS2.p2.1.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.2.2.21" xref="S5.SS2.p2.1.m1.1.1.2.2.21.cmml">s</mi></mrow><mo id="S5.SS2.p2.1.m1.1.1.2.1" xref="S5.SS2.p2.1.m1.1.1.2.1.cmml">/</mo><mi id="S5.SS2.p2.1.m1.1.1.2.3" xref="S5.SS2.p2.1.m1.1.1.2.3.cmml">t</mi></mrow><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml">o</mi><mo id="S5.SS2.p2.1.m1.1.1.1a" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.4" xref="S5.SS2.p2.1.m1.1.1.4.cmml">t</mi><mo id="S5.SS2.p2.1.m1.1.1.1b" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.5" xref="S5.SS2.p2.1.m1.1.1.5.cmml">a</mi><mo id="S5.SS2.p2.1.m1.1.1.1c" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.6" xref="S5.SS2.p2.1.m1.1.1.6.cmml">l</mi><mo id="S5.SS2.p2.1.m1.1.1.1d" lspace="0.500em" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.7" xref="S5.SS2.p2.1.m1.1.1.7.cmml">u</mi><mo id="S5.SS2.p2.1.m1.1.1.1e" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.8" xref="S5.SS2.p2.1.m1.1.1.8.cmml">n</mi><mo id="S5.SS2.p2.1.m1.1.1.1f" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.9" xref="S5.SS2.p2.1.m1.1.1.9.cmml">i</mi><mo id="S5.SS2.p2.1.m1.1.1.1g" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.10" xref="S5.SS2.p2.1.m1.1.1.10.cmml">q</mi><mo id="S5.SS2.p2.1.m1.1.1.1h" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.11" xref="S5.SS2.p2.1.m1.1.1.11.cmml">u</mi><mo id="S5.SS2.p2.1.m1.1.1.1i" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.12" xref="S5.SS2.p2.1.m1.1.1.12.cmml">e</mi><mo id="S5.SS2.p2.1.m1.1.1.1j" lspace="0.500em" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.13" xref="S5.SS2.p2.1.m1.1.1.13.cmml">v</mi><mo id="S5.SS2.p2.1.m1.1.1.1k" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.14" xref="S5.SS2.p2.1.m1.1.1.14.cmml">a</mi><mo id="S5.SS2.p2.1.m1.1.1.1l" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.15" xref="S5.SS2.p2.1.m1.1.1.15.cmml">l</mi><mo id="S5.SS2.p2.1.m1.1.1.1m" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.16" xref="S5.SS2.p2.1.m1.1.1.16.cmml">i</mi><mo id="S5.SS2.p2.1.m1.1.1.1n" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.17" xref="S5.SS2.p2.1.m1.1.1.17.cmml">d</mi><mo id="S5.SS2.p2.1.m1.1.1.1o" lspace="0.500em" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.18" xref="S5.SS2.p2.1.m1.1.1.18.cmml">s</mi><mo id="S5.SS2.p2.1.m1.1.1.1p" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.19" xref="S5.SS2.p2.1.m1.1.1.19.cmml">o</mi><mo id="S5.SS2.p2.1.m1.1.1.1q" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.20" xref="S5.SS2.p2.1.m1.1.1.20.cmml">l</mi><mo id="S5.SS2.p2.1.m1.1.1.1r" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.21" xref="S5.SS2.p2.1.m1.1.1.21.cmml">u</mi><mo id="S5.SS2.p2.1.m1.1.1.1s" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.22" xref="S5.SS2.p2.1.m1.1.1.22.cmml">t</mi><mo id="S5.SS2.p2.1.m1.1.1.1t" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.23" xref="S5.SS2.p2.1.m1.1.1.23.cmml">i</mi><mo id="S5.SS2.p2.1.m1.1.1.1u" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.24" xref="S5.SS2.p2.1.m1.1.1.24.cmml">o</mi><mo id="S5.SS2.p2.1.m1.1.1.1v" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.25" xref="S5.SS2.p2.1.m1.1.1.25.cmml">n</mi><mo id="S5.SS2.p2.1.m1.1.1.1w" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS2.p2.1.m1.1.1.26" xref="S5.SS2.p2.1.m1.1.1.26.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><times id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1"></times><apply id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2"><divide id="S5.SS2.p2.1.m1.1.1.2.1.cmml" xref="S5.SS2.p2.1.m1.1.1.2.1"></divide><apply id="S5.SS2.p2.1.m1.1.1.2.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2"><times id="S5.SS2.p2.1.m1.1.1.2.2.1.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.1"></times><ci id="S5.SS2.p2.1.m1.1.1.2.2.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.2">𝑢</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.3.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.3">𝑛</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.4.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.4">𝑖</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.5.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.5">𝑞</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.6.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.6">𝑢</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.7.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.7">𝑒</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.8.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.8">𝑣</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.9.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.9">𝑎</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.10.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.10">𝑙</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.11.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.11">𝑖</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.12.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.12">𝑑</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.13.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.13">𝑠</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.14.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.14">𝑜</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.15.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.15">𝑙</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.16.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.16">𝑢</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.17.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.17">𝑡</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.18.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.18">𝑖</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.19.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.19">𝑜</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.20.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.20">𝑛</ci><ci id="S5.SS2.p2.1.m1.1.1.2.2.21.cmml" xref="S5.SS2.p2.1.m1.1.1.2.2.21">𝑠</ci></apply><ci id="S5.SS2.p2.1.m1.1.1.2.3.cmml" xref="S5.SS2.p2.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3">𝑜</ci><ci id="S5.SS2.p2.1.m1.1.1.4.cmml" xref="S5.SS2.p2.1.m1.1.1.4">𝑡</ci><ci id="S5.SS2.p2.1.m1.1.1.5.cmml" xref="S5.SS2.p2.1.m1.1.1.5">𝑎</ci><ci id="S5.SS2.p2.1.m1.1.1.6.cmml" xref="S5.SS2.p2.1.m1.1.1.6">𝑙</ci><ci id="S5.SS2.p2.1.m1.1.1.7.cmml" xref="S5.SS2.p2.1.m1.1.1.7">𝑢</ci><ci id="S5.SS2.p2.1.m1.1.1.8.cmml" xref="S5.SS2.p2.1.m1.1.1.8">𝑛</ci><ci id="S5.SS2.p2.1.m1.1.1.9.cmml" xref="S5.SS2.p2.1.m1.1.1.9">𝑖</ci><ci id="S5.SS2.p2.1.m1.1.1.10.cmml" xref="S5.SS2.p2.1.m1.1.1.10">𝑞</ci><ci id="S5.SS2.p2.1.m1.1.1.11.cmml" xref="S5.SS2.p2.1.m1.1.1.11">𝑢</ci><ci id="S5.SS2.p2.1.m1.1.1.12.cmml" xref="S5.SS2.p2.1.m1.1.1.12">𝑒</ci><ci id="S5.SS2.p2.1.m1.1.1.13.cmml" xref="S5.SS2.p2.1.m1.1.1.13">𝑣</ci><ci id="S5.SS2.p2.1.m1.1.1.14.cmml" xref="S5.SS2.p2.1.m1.1.1.14">𝑎</ci><ci id="S5.SS2.p2.1.m1.1.1.15.cmml" xref="S5.SS2.p2.1.m1.1.1.15">𝑙</ci><ci id="S5.SS2.p2.1.m1.1.1.16.cmml" xref="S5.SS2.p2.1.m1.1.1.16">𝑖</ci><ci id="S5.SS2.p2.1.m1.1.1.17.cmml" xref="S5.SS2.p2.1.m1.1.1.17">𝑑</ci><ci id="S5.SS2.p2.1.m1.1.1.18.cmml" xref="S5.SS2.p2.1.m1.1.1.18">𝑠</ci><ci id="S5.SS2.p2.1.m1.1.1.19.cmml" xref="S5.SS2.p2.1.m1.1.1.19">𝑜</ci><ci id="S5.SS2.p2.1.m1.1.1.20.cmml" xref="S5.SS2.p2.1.m1.1.1.20">𝑙</ci><ci id="S5.SS2.p2.1.m1.1.1.21.cmml" xref="S5.SS2.p2.1.m1.1.1.21">𝑢</ci><ci id="S5.SS2.p2.1.m1.1.1.22.cmml" xref="S5.SS2.p2.1.m1.1.1.22">𝑡</ci><ci id="S5.SS2.p2.1.m1.1.1.23.cmml" xref="S5.SS2.p2.1.m1.1.1.23">𝑖</ci><ci id="S5.SS2.p2.1.m1.1.1.24.cmml" xref="S5.SS2.p2.1.m1.1.1.24">𝑜</ci><ci id="S5.SS2.p2.1.m1.1.1.25.cmml" xref="S5.SS2.p2.1.m1.1.1.25">𝑛</ci><ci id="S5.SS2.p2.1.m1.1.1.26.cmml" xref="S5.SS2.p2.1.m1.1.1.26">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">unique\ valid\ solutions/total\ unique\ valid\ solutions</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">italic_u italic_n italic_i italic_q italic_u italic_e italic_v italic_a italic_l italic_i italic_d italic_s italic_o italic_l italic_u italic_t italic_i italic_o italic_n italic_s / italic_t italic_o italic_t italic_a italic_l italic_u italic_n italic_i italic_q italic_u italic_e italic_v italic_a italic_l italic_i italic_d italic_s italic_o italic_l italic_u italic_t italic_i italic_o italic_n italic_s</annotation></semantics></math>) on the reference solutions. Note that this is an unconventional measure of recall as it’s over the solution space<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Not to be confused with conventional recall where we might measure how many valid solutions the LLM recognize as valid.</span></span></span>. To ensure this doesn’t come at the cost of quality, we also show precision is not reduced.</p>
</div>
<figure class="ltx_figure ltx_minipage ltx_align_center ltx_align_middle" id="S5.F3.1" style="width:389.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="285" id="S5.F3.1.g1" src="x3.png" width="761"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S5.F3.1.3.1"> Diversity scaled with temperature.</span> We show 100 resamples of "Name one Great Lake in the United States." On the right, we show the result of resampling GPT-4o 100 times per temperature. In contrast to SimpleStrat on the left, GPT-4o at temperature 1.5 still only samples Lake Huron once and never samples Lake Ontario. SimpleStrat improves the diversity across all temperatures.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Qualitative Example</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Consider the question "Name one Great Lake in the United States." as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F3.1" title="Figure 3 ‣ 5.2 Measuring Diversity ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">3</span></a>. We see that temperature scaling with GPT-4o results in a strong preference/bias for Lake Erie. This is certainly a correct continuation and under the language modeling objective should be incentivized. Increasing the temperature helps sample the next most likely candidate solutions more often. However, even when increasing the temperature past 1 there is still low coverage over the solutions space. Specifically, Huron is only seen once out of 100 samples at 1.5 temperature, and Lake Ontario is never observed. This is undesirable if the data is used to proposing candidate plans, generating test cases, or generating training data. Not only is there insufficient coverage over all possible solutions, but the model consistently has a strong preference for Lake Erie. This undesired biases in generations may lead to problems in downstream use cases.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F3.1" title="Figure 3 ‣ 5.2 Measuring Diversity ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">3</span></a>, we observe a much more uniform distribution over valid solutions when using SimpleStrat. Notably, we observe full coverage over all 5 Great Lakes. At lower temperatures, there is still a preference of a single lake over the others, in this case Lake Huron. However, this is less pronounced at higher temperatures and is a significant improvement over GPT-4o without SimpleStrat.</p>
</div>
<figure class="ltx_figure" id="S5.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S5.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="S5.F4.sf1.g1" src="extracted/5926242/plots/temperature_scaling_recall/big_recall.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text ltx_font_bold" id="S5.F4.sf1.2.1"> CoverageQA-Curated.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="S5.F4.sf2.g1" src="extracted/5926242/plots/temperature_scaling_recall/entity_game_recall.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_bold" id="S5.F4.sf2.2.1">CoverageQA-Wikipedia</span> </figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S5.F4.2.1"> Diversity measured with recall scaled with temperature.</span> The figure shows the improved recall on CoverageQA compared to GPT-4o and Claude 3.5<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Claude does not allow for temperatures above 1. </span></span></span>. Recall indicates the percentage of ground truth questions observed after sampling 100 times. The benefit of SimpleStrat is especially pronounced at low temperatures, but the benefit is evident across all temperatures. </figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Coverage Diversity on Proprietary Models</h3>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">We first assess coverage diversity, specifically, the model’s ability to recall all the valid solutions upon resampling. This measure is clearly impacted by temperature as temperature zero or greedy decoding of LLMs leads to a single deterministic result.
We compare the coverage diversity (recall) of SimpleStrat, GPT-4o, and Claude 3.5 Sonnet as a function of temperature. We sweep over temperatures from 0.15 to 1.5. Although not shown in the evaluation, note that SimpleStrat has the advantage of providing diversity even when sampled at temperature zero. SimpleStrat with GPT-4o leads to an improvement to recall across all temperatures as shown in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F4" title="Figure 4 ‣ 5.3 Qualitative Example ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">4</span></a>. On the CoverageQA-Curated, we see a consistent 0.2 increase in recall over the same base model, GPT-4o. On CoverageQA-Wikipedia, we see as much as 0.05 increase in recall</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.1">Our quantitative results are consistent with the Great Lakes example in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F3.1" title="Figure 3 ‣ 5.2 Measuring Diversity ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">3</span></a>. Scaling temperature alone does not lead to as much coverage diversity as combining with SimpleStrat. The recall importantly does not come at the expense of quality as measure by precision as shown in App.  <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A2" title="Appendix B F1 Scores ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<figure class="ltx_figure" id="S5.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel" id="S5.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="S5.F5.sf1.g1" src="extracted/5926242/plots/kl_divergence_scatter/Meta-Llama-3.1-8B-Instruct.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text ltx_font_bold" id="S5.F5.sf1.2.1">Llama 3.1 8B</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="S5.F5.sf2.g1" src="extracted/5926242/plots/kl_divergence_scatter/Meta-Llama-3.1-70B-Instruct.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_bold" id="S5.F5.sf2.2.1">Llama 3.1 70B</span> </figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>KL divergence from uniform for Baseline vs SimpleStrat on CoverageQA Wikipedia. Lower divergence indicates closer alignment with the desired uniform distribution, arrow indicates direction of maximum improvement from baseline</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Distributional diversity with Llama 3</h3>
<div class="ltx_para ltx_noindent" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">We use the Llama 3 model family to analyze answer distributional diversity in CoverageQA. Open-source models let us calculate exact expected distributions by examining logits of all valid continuations for a prompt. This is not possible with GPT-4o and Claude 3.5 Sonnet, where reliably estimating the true probabilities would require extensive sampling. Our approach efficiently determines true expected distributions of valid answers for any input, improving analysis accuracy, and overcoming the resource constraints of high count sampling.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.3">For our baseline, we prompt the models and directly compute <math alttext="Pr[s|Prompt(\vec{l})]" class="ltx_Math" display="inline" id="S5.SS5.p2.1.m1.2"><semantics id="S5.SS5.p2.1.m1.2a"><mrow id="S5.SS5.p2.1.m1.2.2" xref="S5.SS5.p2.1.m1.2.2.cmml"><mi id="S5.SS5.p2.1.m1.2.2.3" xref="S5.SS5.p2.1.m1.2.2.3.cmml">P</mi><mo id="S5.SS5.p2.1.m1.2.2.2" xref="S5.SS5.p2.1.m1.2.2.2.cmml">⁢</mo><mi id="S5.SS5.p2.1.m1.2.2.4" xref="S5.SS5.p2.1.m1.2.2.4.cmml">r</mi><mo id="S5.SS5.p2.1.m1.2.2.2a" xref="S5.SS5.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S5.SS5.p2.1.m1.2.2.1.1" xref="S5.SS5.p2.1.m1.2.2.1.2.cmml"><mo id="S5.SS5.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S5.SS5.p2.1.m1.2.2.1.2.1.cmml">[</mo><mrow id="S5.SS5.p2.1.m1.2.2.1.1.1" xref="S5.SS5.p2.1.m1.2.2.1.1.1.cmml"><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.2" xref="S5.SS5.p2.1.m1.2.2.1.1.1.2.cmml">s</mi><mo fence="false" id="S5.SS5.p2.1.m1.2.2.1.1.1.1" xref="S5.SS5.p2.1.m1.2.2.1.1.1.1.cmml">|</mo><mrow id="S5.SS5.p2.1.m1.2.2.1.1.1.3" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.cmml"><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.3.2" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.2.cmml">P</mi><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.3.3" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.3.cmml">r</mi><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1a" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.3.4" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.4.cmml">o</mi><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1b" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.3.5" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.5.cmml">m</mi><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1c" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.3.6" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.6.cmml">p</mi><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1d" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.1.m1.2.2.1.1.1.3.7" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.7.cmml">t</mi><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1e" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S5.SS5.p2.1.m1.2.2.1.1.1.3.8.2" xref="S5.SS5.p2.1.m1.1.1.cmml"><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.8.2.1" stretchy="false" xref="S5.SS5.p2.1.m1.1.1.cmml">(</mo><mover accent="true" id="S5.SS5.p2.1.m1.1.1" xref="S5.SS5.p2.1.m1.1.1.cmml"><mi id="S5.SS5.p2.1.m1.1.1.2" xref="S5.SS5.p2.1.m1.1.1.2.cmml">l</mi><mo id="S5.SS5.p2.1.m1.1.1.1" stretchy="false" xref="S5.SS5.p2.1.m1.1.1.1.cmml">→</mo></mover><mo id="S5.SS5.p2.1.m1.2.2.1.1.1.3.8.2.2" stretchy="false" xref="S5.SS5.p2.1.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.SS5.p2.1.m1.2.2.1.1.3" stretchy="false" xref="S5.SS5.p2.1.m1.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.1.m1.2b"><apply id="S5.SS5.p2.1.m1.2.2.cmml" xref="S5.SS5.p2.1.m1.2.2"><times id="S5.SS5.p2.1.m1.2.2.2.cmml" xref="S5.SS5.p2.1.m1.2.2.2"></times><ci id="S5.SS5.p2.1.m1.2.2.3.cmml" xref="S5.SS5.p2.1.m1.2.2.3">𝑃</ci><ci id="S5.SS5.p2.1.m1.2.2.4.cmml" xref="S5.SS5.p2.1.m1.2.2.4">𝑟</ci><apply id="S5.SS5.p2.1.m1.2.2.1.2.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1"><csymbol cd="latexml" id="S5.SS5.p2.1.m1.2.2.1.2.1.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.2">delimited-[]</csymbol><apply id="S5.SS5.p2.1.m1.2.2.1.1.1.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS5.p2.1.m1.2.2.1.1.1.1.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.2.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.2">𝑠</ci><apply id="S5.SS5.p2.1.m1.2.2.1.1.1.3.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3"><times id="S5.SS5.p2.1.m1.2.2.1.1.1.3.1.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.1"></times><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.3.2.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.2">𝑃</ci><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.3.3.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.3">𝑟</ci><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.3.4.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.4">𝑜</ci><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.3.5.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.5">𝑚</ci><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.3.6.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.6">𝑝</ci><ci id="S5.SS5.p2.1.m1.2.2.1.1.1.3.7.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.7">𝑡</ci><apply id="S5.SS5.p2.1.m1.1.1.cmml" xref="S5.SS5.p2.1.m1.2.2.1.1.1.3.8.2"><ci id="S5.SS5.p2.1.m1.1.1.1.cmml" xref="S5.SS5.p2.1.m1.1.1.1">→</ci><ci id="S5.SS5.p2.1.m1.1.1.2.cmml" xref="S5.SS5.p2.1.m1.1.1.2">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.1.m1.2c">Pr[s|Prompt(\vec{l})]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.1.m1.2d">italic_P italic_r [ italic_s | italic_P italic_r italic_o italic_m italic_p italic_t ( over→ start_ARG italic_l end_ARG ) ]</annotation></semantics></math> for each solution, <math alttext="s" class="ltx_Math" display="inline" id="S5.SS5.p2.2.m2.1"><semantics id="S5.SS5.p2.2.m2.1a"><mi id="S5.SS5.p2.2.m2.1.1" xref="S5.SS5.p2.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.2.m2.1b"><ci id="S5.SS5.p2.2.m2.1.1.cmml" xref="S5.SS5.p2.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.2.m2.1d">italic_s</annotation></semantics></math>. This is simply the product of the individual next-token probabilities. For SimpleStrat, the probability involves the next-token probability conditioned on the prompt weighted by the probability the prompt is selected. Concretely,
the probability an answer is sampled by SimpleStrat can be computed based on Eqn.<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S3.E2" title="In 3.4 Probabilistic Prompting. ‣ 3 Method ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">2</span></a>. The next-token probability based response distribution <math alttext="Pr[s|Prompt(\vec{l})]" class="ltx_Math" display="inline" id="S5.SS5.p2.3.m3.2"><semantics id="S5.SS5.p2.3.m3.2a"><mrow id="S5.SS5.p2.3.m3.2.2" xref="S5.SS5.p2.3.m3.2.2.cmml"><mi id="S5.SS5.p2.3.m3.2.2.3" xref="S5.SS5.p2.3.m3.2.2.3.cmml">P</mi><mo id="S5.SS5.p2.3.m3.2.2.2" xref="S5.SS5.p2.3.m3.2.2.2.cmml">⁢</mo><mi id="S5.SS5.p2.3.m3.2.2.4" xref="S5.SS5.p2.3.m3.2.2.4.cmml">r</mi><mo id="S5.SS5.p2.3.m3.2.2.2a" xref="S5.SS5.p2.3.m3.2.2.2.cmml">⁢</mo><mrow id="S5.SS5.p2.3.m3.2.2.1.1" xref="S5.SS5.p2.3.m3.2.2.1.2.cmml"><mo id="S5.SS5.p2.3.m3.2.2.1.1.2" stretchy="false" xref="S5.SS5.p2.3.m3.2.2.1.2.1.cmml">[</mo><mrow id="S5.SS5.p2.3.m3.2.2.1.1.1" xref="S5.SS5.p2.3.m3.2.2.1.1.1.cmml"><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.2" xref="S5.SS5.p2.3.m3.2.2.1.1.1.2.cmml">s</mi><mo fence="false" id="S5.SS5.p2.3.m3.2.2.1.1.1.1" xref="S5.SS5.p2.3.m3.2.2.1.1.1.1.cmml">|</mo><mrow id="S5.SS5.p2.3.m3.2.2.1.1.1.3" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.cmml"><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.3.2" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.2.cmml">P</mi><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.3.3" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.3.cmml">r</mi><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1a" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.3.4" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.4.cmml">o</mi><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1b" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.3.5" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.5.cmml">m</mi><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1c" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.3.6" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.6.cmml">p</mi><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1d" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S5.SS5.p2.3.m3.2.2.1.1.1.3.7" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.7.cmml">t</mi><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1e" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mrow id="S5.SS5.p2.3.m3.2.2.1.1.1.3.8.2" xref="S5.SS5.p2.3.m3.1.1.cmml"><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.8.2.1" stretchy="false" xref="S5.SS5.p2.3.m3.1.1.cmml">(</mo><mover accent="true" id="S5.SS5.p2.3.m3.1.1" xref="S5.SS5.p2.3.m3.1.1.cmml"><mi id="S5.SS5.p2.3.m3.1.1.2" xref="S5.SS5.p2.3.m3.1.1.2.cmml">l</mi><mo id="S5.SS5.p2.3.m3.1.1.1" stretchy="false" xref="S5.SS5.p2.3.m3.1.1.1.cmml">→</mo></mover><mo id="S5.SS5.p2.3.m3.2.2.1.1.1.3.8.2.2" stretchy="false" xref="S5.SS5.p2.3.m3.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S5.SS5.p2.3.m3.2.2.1.1.3" stretchy="false" xref="S5.SS5.p2.3.m3.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p2.3.m3.2b"><apply id="S5.SS5.p2.3.m3.2.2.cmml" xref="S5.SS5.p2.3.m3.2.2"><times id="S5.SS5.p2.3.m3.2.2.2.cmml" xref="S5.SS5.p2.3.m3.2.2.2"></times><ci id="S5.SS5.p2.3.m3.2.2.3.cmml" xref="S5.SS5.p2.3.m3.2.2.3">𝑃</ci><ci id="S5.SS5.p2.3.m3.2.2.4.cmml" xref="S5.SS5.p2.3.m3.2.2.4">𝑟</ci><apply id="S5.SS5.p2.3.m3.2.2.1.2.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1"><csymbol cd="latexml" id="S5.SS5.p2.3.m3.2.2.1.2.1.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.2">delimited-[]</csymbol><apply id="S5.SS5.p2.3.m3.2.2.1.1.1.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1"><csymbol cd="latexml" id="S5.SS5.p2.3.m3.2.2.1.1.1.1.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.1">conditional</csymbol><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.2.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.2">𝑠</ci><apply id="S5.SS5.p2.3.m3.2.2.1.1.1.3.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3"><times id="S5.SS5.p2.3.m3.2.2.1.1.1.3.1.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.1"></times><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.3.2.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.2">𝑃</ci><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.3.3.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.3">𝑟</ci><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.3.4.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.4">𝑜</ci><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.3.5.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.5">𝑚</ci><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.3.6.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.6">𝑝</ci><ci id="S5.SS5.p2.3.m3.2.2.1.1.1.3.7.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.7">𝑡</ci><apply id="S5.SS5.p2.3.m3.1.1.cmml" xref="S5.SS5.p2.3.m3.2.2.1.1.1.3.8.2"><ci id="S5.SS5.p2.3.m3.1.1.1.cmml" xref="S5.SS5.p2.3.m3.1.1.1">→</ci><ci id="S5.SS5.p2.3.m3.1.1.2.cmml" xref="S5.SS5.p2.3.m3.1.1.2">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p2.3.m3.2c">Pr[s|Prompt(\vec{l})]</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p2.3.m3.2d">italic_P italic_r [ italic_s | italic_P italic_r italic_o italic_m italic_p italic_t ( over→ start_ARG italic_l end_ARG ) ]</annotation></semantics></math> computed just as the baseline, and we do a sum weighted by the joint probabilities assigned in heuristic estimation.
We assign remaining probability density to an "Invalid" category to form a proper distribution.
The probabilistic formulation allows us to easily compute the response distribution of SimpleStrat.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">Our ground-truth distribution is a distribution where each valid answer has equal probability, and no invalid answers have probability density. We use Kullback–Leibler (KL) Divergence as the discrepancy metric to measure how much our distribution deviates from a uniform distribution. Across the four models in the Llama 3 family, SimpleStrat achieves an average reduction in KL divergence from uniform of 1.14 compared to the baseline on the curated CoverageQA dataset. For the general CoverageQA dataset, the reduction is 0.36. These results indicate that SimpleStrat produces a response distribution much closer to the ground truth distribution than the baseline method.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p4">
<p class="ltx_p" id="S5.SS5.p4.1">Additionally, we analyze the KL divergence on a per-question basis to identify where our method achieves improvement (a more uniform distribution). The scatter plot in Fig  <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F5.sf2" title="In Figure 5 ‣ 5.4 Coverage Diversity on Proprietary Models ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">5(b)</span></a> shows KL divergence values for SimpleStrat (y-axis) versus the baseline (x-axis) for each question in the CoverageQA Wikipedia dataset. Points above the diagonal line represent questions where SimpleStrat outperforms the baseline by yielding a lower KL divergence. The vast majority of points fall on or above this line, indicating that SimpleStrat consistently produces improvement in generating more uniform distributions across the questions in the dataset.</p>
</div>
<figure class="ltx_figure" id="S5.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="345" id="S5.F6.sf1.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-8B-comparison/Name_a_US_state_.png" width="521"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text ltx_font_bold" id="S5.F6.sf1.2.1">Llama 3.1 8B.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F6.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="345" id="S5.F6.sf2.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-70B-comparison/Name_a_US_state_.png" width="521"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_bold" id="S5.F6.sf2.2.1">Llama 3.1 70B.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S5.F6.2.1">Distributional Diversity Comparison.</span> We show the response probability as defined by next-token-probabilities for the top 20 ground truth answers on Llama 3.1. For both 8B and 70B, SimpleStrat provides meaningful improvement to the response distribution both for values previously over-represented in the distribution and those previously underrepresented. </figcaption>
</figure>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of Baseline and SimpleStrat Average KL Divergence for Different Models on CoverageQA-Curated and CoverageQA-Wikipedia. Smaller numbers reflect closer alignment to uniform distribution. </figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T1.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.2.1">CoverageQA Curated</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S5.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.3.1">CoverageQA Wikipedia</span></th>
</tr>
<tr class="ltx_tr" id="S5.T1.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.2.2.1.1">Baseline</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.2.2.2.1">SimpleStrat</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.2.2.3.1">Baseline</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T1.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S5.T1.1.2.2.4.1">SimpleStrat</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.1.3.1.1">Meta-Llama-3-8B-Instruct</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.1.2">2.78</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.3.1.3.1">1.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.1.4">2.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.3.1.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.3.1.5.1">2.47</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.1.4.2.1">Meta-Llama-3.1-8B-Instruct</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.2.2">2.47</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.2.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.2.3.1">1.19</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.2.4">2.60</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.2.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.4.2.5.1">2.39</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.1.5.3.1">Meta-Llama-3-70B-Instruct</th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.3.2">3.24</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.3.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.5.3.3.1">2.17</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.3.4">3.28</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.5.3.5.1">2.73</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T1.1.6.4.1">Meta-Llama-3.1-70B-Instruct</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.6.4.2">2.70</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.6.4.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.6.4.3.1">1.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.6.4.4">2.78</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S5.T1.1.6.4.5.1">2.38</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS5.p5">
<p class="ltx_p" id="S5.SS5.p5.1">In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F6" title="Figure 6 ‣ 5.5 Distributional diversity with Llama 3 ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">6</span></a>, we see an example of the response distribution for Llama 3.1 with and without the correction due to SimpleStrat. The base model distribution is strongly biased towards it’s most desired output. As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S0.F1.1" title="Figure 1 ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">1</span></a>, California is preferred by a long margin. Thus, it’s not surprising that we observed little diversity when by simply increasing temperature. In contrast, SimpleStrat provides a much more uniform distribution. The over represented solutions are adjusted to be lower and the under represented solutions are adjusted to be higher. We note that the distributions are still not perfectly uniform. For more examples, see App. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A5" title="Appendix E Additional Plots: Distributional Analysis with Llama ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">E</span></a>. Although Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.F6" title="Figure 6 ‣ 5.5 Distributional diversity with Llama 3 ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">6</span></a> shows the larger model has a closer to ideal distribution, the results in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#S5.T1" title="Table 1 ‣ 5.5 Distributional diversity with Llama 3 ‣ 5 Results ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">1</span></a> indicate larger models have on average worse diversity. This may be a result of memorization exacerbated in larger models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS5.p6">
<p class="ltx_p" id="S5.SS5.p6.1"><span class="ltx_text ltx_font_bold" id="S5.SS5.p6.1.1">Model versions.</span> Interestingly, Llama 3.1 handles underspecified questions better as it has consistent lower KL Divergence. Although we do not have access to the training methodology, the likely increase in dataset size and more careful model design seems to improve based mode capabilities on underspecified questions.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Although SimpleStrat shows improvement empirically, it is sensitive to the model selecting good meaningful axis in <span class="ltx_text ltx_font_italic" id="S6.p1.1.1">auto-stratification</span> and correct joint probabilities in heuristic estimation. As work on LLMs for forecasting improve, we expect LLMs to produce better estimates especially when given access to external data and data analysis tools. For our prototype, we restricted to studying the model’s intrinsic capabilities. Further, the model may have biases concerning race and gender that may be reflected also in the auto-stratification and heuristic estimation. As such, it is recommended the probabilistic prompt distribution of SimpleStrat is carefully inspected for critical applications. Finally, CoverageQA is a dataset of short responses. Although this make evaluation more practical, we believe SimpleStrat will be especially impactful in settings that require low temperature especially multi-step reasoning as identified by <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib44" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this paper, we propose SimpleStrat which offers an innovative alternative by leveraging the LLM itself to partition the solution space into distinct strata. This process we call <span class="ltx_text ltx_font_italic" id="S7.p1.1.1">auto-stratification</span>. At inference time, a random stratum is selected, and a sample is drawn from within that stratum. This approach achieves better diversity without sacrificing quality as increasing temperature would.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">To quantitatively measure diversity, we introduced the CoverageQA dataset, which consists of underspecified questions with multiple equally valid answers. We measure diversity with two metrics: for open-source models, we measure distributional difference with KL Divergence and for proprietary models, we measure coverage over the set of ground-truth solutions. Our rigorous evaluation on both proprietary and open-source LLMs demonstrated that SimpleStrat achieves significantly higher recall and produces answer distributions closer to uniform compared to traditional temperature-based sampling methods.</p>
</div>
<section class="ltx_subsection" id="S7.SSx1">
<h3 class="ltx_title ltx_title_subsection">Acknowledgement</h3>
<div class="ltx_para ltx_noindent" id="S7.SSx1.p1">
<p class="ltx_p" id="S7.SSx1.p1.1">We thank Anastasios Angelopoulos, Jacob Steinhardt, Brandon Trubucco, Kevin Yang, Parth Asawa, and Alan Zhu for their insightful discussion. Sky Computing Lab is supported by gifts from Accenture, AMD, Anyscale, Google, IBM, Intel, Microsoft, Mohamed Bin Zayed University of Artificial Intelligence, Samsung SDS, SAP, Uber, and VMware.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aichberger et al. (2024)</span>
<span class="ltx_bibblock">
Lukas Aichberger, Kajetan Schweighofer, Mykyta Ielanskyi, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Semantically diverse language generation for uncertainty estimation in language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2406.04306</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aliannejadi et al. (2020)</span>
<span class="ltx_bibblock">
Mohammad Aliannejadi, Julia Kiseleva, Aleksandr Chuklin, Jeff Dalton, and Mikhail Burtsev.

</span>
<span class="ltx_bibblock">Convai3: Generating clarifying questions for open-domain dialogue systems (clariq), 2020.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2009.11352" title="">https://arxiv.org/abs/2009.11352</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradley et al. (2023)</span>
<span class="ltx_bibblock">
Herbie Bradley, Andrew Dai, Hannah Teufel, Jenny Zhang, Koen Oostermeijer, Marco Bellagente, Jeff Clune, Kenneth Stanley, Grégory Schott, and Joel Lehman.

</span>
<span class="ltx_bibblock">Quality-diversity through ai feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2310.13032</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caballero et al. (2016)</span>
<span class="ltx_bibblock">
Ethan Caballero, . OpenAI, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Description2Code Dataset, 8 2016.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ethancaballero/description2code" title="">https://github.com/ethancaballero/description2code</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cassano et al. (2023)</span>
<span class="ltx_bibblock">
Federico Cassano, John Gouwar, Francesca Lucchetti, Claire Schlesinger, Anders Freeman, Carolyn Jane Anderson, Molly Q Feldman, Michael Greenberg, Abhinav Jangda, and Arjun Guha.

</span>
<span class="ltx_bibblock">Knowledge transfer from high-resource to low-resource programming languages for code llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2308.09895</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Nuo Chen, Zinan Zheng, Ning Wu, Linjun Shou, Ming Gong, Yangqiu Song, Dongmei Zhang, and Jia Li.

</span>
<span class="ltx_bibblock">Breaking language barriers in multilingual mathematical reasoning: Insights and observations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2310.20246</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al. (2023)</span>
<span class="ltx_bibblock">
John Joon Young Chung, Ece Kamar, and Saleema Amershi.

</span>
<span class="ltx_bibblock">Increasing diversity while maintaining accuracy: Text data generation with large language models and human interventions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2306.04140</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2023)</span>
<span class="ltx_bibblock">
Haixing Dai, Zhengliang Liu, Wenxiong Liao, Xiaoke Huang, Yihan Cao, Zihao Wu, Lin Zhao, Shaochen Xu, Wei Liu, Ninghao Liu, et al.

</span>
<span class="ltx_bibblock">Auggpt: Leveraging chatgpt for text data augmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2302.13007</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, et al.

</span>
<span class="ltx_bibblock">The llama 3 herd of models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2407.21783</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dunlap et al. (2023)</span>
<span class="ltx_bibblock">
Lisa Dunlap, Alyssa Umino, Han Zhang, Jiezhi Yang, Joseph E Gonzalez, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Diversify your vision datasets with automatic diffusion-based augmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Advances in neural information processing systems</em>, 36:79024–79034, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2017)</span>
<span class="ltx_bibblock">
Chuan Guo, Geoff Pleiss, Yu Sun, and Kilian Q. Weinberger.

</span>
<span class="ltx_bibblock">On calibration of modern neural networks.

</span>
<span class="ltx_bibblock">In Doina Precup and Yee Whye Teh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 34th International Conference on Machine Learning</em>, volume 70 of <em class="ltx_emph ltx_font_italic" id="bib.bib11.2.2">Proceedings of Machine Learning Research</em>, pp.  1321–1330. PMLR, 06–11 Aug 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v70/guo17a.html" title="">https://proceedings.mlr.press/v70/guo17a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Halawi et al. (2024)</span>
<span class="ltx_bibblock">
Danny Halawi, Fred Zhang, Chen Yueh-Han, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Approaching human-level forecasting with language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2402.18563</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et al. (2021)</span>
<span class="ltx_bibblock">
Dan Hendrycks, Steven Basart, Saurav Kadavath, Mantas Mazeika, Akul Arora, Ethan Guo, Collin Burns, Samir Puranik, Horace He, Dawn Song, and Jacob Steinhardt.

</span>
<span class="ltx_bibblock">Measuring coding challenge competence with apps, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2105.09938" title="">https://arxiv.org/abs/2105.09938</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton (2015)</span>
<span class="ltx_bibblock">
Geoffrey Hinton.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1503.02531</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Howell (1992)</span>
<span class="ltx_bibblock">
David C Howell.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Statistical methods for psychology</em>.

</span>
<span class="ltx_bibblock">PWS-Kent Publishing Co, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2018)</span>
<span class="ltx_bibblock">
Sheng-Wei Huang, Che-Tsung Lin, Shu-Ping Chen, Yen-Yi Wu, Po-Hao Hsu, and Shang-Hong Lai.

</span>
<span class="ltx_bibblock">Auggan: Cross domain adaptation with gan-based data augmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the European Conference on Computer Vision (ECCV)</em>, pp.  718–731, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuhn et al. (2022)</span>
<span class="ltx_bibblock">
Lorenz Kuhn, Yarin Gal, and Sebastian Farquhar.

</span>
<span class="ltx_bibblock">Clam: Selective clarification for ambiguous questions with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2212.07769</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Yujia Li, David Choi, Junyoung Chung, Nate Kushman, Julian Schrittwieser, Rémi Leblond, Tom Eccles, James Keeling, Felix Gimeno, Agustin Dal Lago, Thomas Hubert, Peter Choy, Cyprien de Masson d’Autume, Igor Babuschkin, Xinyun Chen, Po-Sen Huang, Johannes Welbl, Sven Gowal, Alexey Cherepanov, James Molloy, Daniel J. Mankowitz, Esme Sutherland Robson, Pushmeet Kohli, Nando de Freitas, Koray Kavukcuoglu, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Competition-level code generation with alphacode.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Science</em>, 378(6624):1092–1097, December 2022.

</span>
<span class="ltx_bibblock">ISSN 1095-9203.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1126/science.abq1158</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1126/science.abq1158" title="">http://dx.doi.org/10.1126/science.abq1158</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lowerre &amp; Reddy (1976)</span>
<span class="ltx_bibblock">
Bruce P Lowerre and B Raj Reddy.

</span>
<span class="ltx_bibblock">Harpy, a connected speech recognition system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">The Journal of the Acoustical Society of America</em>, 59(S1):S97–S97, 1976.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malthus (1798)</span>
<span class="ltx_bibblock">
Thomas Robert Malthus.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">An Essay on the Principle of Population</em>.

</span>
<span class="ltx_bibblock">J. Johnson, London, 1798.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meyerson et al. (2023)</span>
<span class="ltx_bibblock">
Elliot Meyerson, Mark J Nelson, Herbie Bradley, Adam Gaier, Arash Moradi, Amy K Hoover, and Joel Lehman.

</span>
<span class="ltx_bibblock">Language model crossover: Variation through few-shot prompting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2302.12170</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al. (2020)</span>
<span class="ltx_bibblock">
Sewon Min, Julian Michael, Hannaneh Hajishirzi, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Ambigqa: Answering ambiguous open-domain questions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:2004.10645</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Morris (2022)</span>
<span class="ltx_bibblock">
G Elliott Morris.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Strength in Numbers: How Polls Work and why We Need Them</em>.

</span>
<span class="ltx_bibblock">WW Norton &amp; Company, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mouret &amp; Clune (2015)</span>
<span class="ltx_bibblock">
Jean-Baptiste Mouret and Jeff Clune.

</span>
<span class="ltx_bibblock">Illuminating search spaces by mapping elites.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:1504.04909</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ng et al. (2020)</span>
<span class="ltx_bibblock">
Nathan Ng, Kyunghyun Cho, and Marzyeh Ghassemi.

</span>
<span class="ltx_bibblock">Ssmba: Self-supervised manifold based data augmentation for improving out-of-domain robustness.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2009.10195</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI et al. (2024)</span>
<span class="ltx_bibblock">
OpenAI, Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, Red Avila, Igor Babuschkin, Suchir Balaji, Valerie Balcom, Paul Baltescu, Haiming Bao, Mohammad Bavarian, Jeff Belgum, Irwan Bello, Jake Berdine, Gabriel Bernadett-Shapiro, Christopher Berner, Lenny Bogdonoff, Oleg Boiko, Madelaine Boyd, Anna-Luisa Brakman, Greg Brockman, Tim Brooks, Miles Brundage, Kevin Button, Trevor Cai, Rosie Campbell, Andrew Cann, Brittany Carey, Chelsea Carlson, Rory Carmichael, Brooke Chan, Che Chang, Fotis Chantzis, Derek Chen, Sully Chen, Ruby Chen, Jason Chen, Mark Chen, Ben Chess, Chester Cho, Casey Chu, Hyung Won Chung, Dave Cummings, Jeremiah Currier, Yunxing Dai, Cory Decareaux, Thomas Degry, Noah Deutsch, Damien Deville, Arka Dhar, David Dohan, Steve Dowling, Sheila Dunning, Adrien Ecoffet, Atty Eleti, Tyna Eloundou, David Farhi, Liam Fedus, Niko Felix, Simón Posada Fishman, Juston Forte, Isabella Fulford, Leo
Gao, Elie Georges, Christian Gibson, Vik Goel, Tarun Gogineni, Gabriel Goh, Rapha Gontijo-Lopes, Jonathan Gordon, Morgan Grafstein, Scott Gray, Ryan Greene, Joshua Gross, Shixiang Shane Gu, Yufei Guo, Chris Hallacy, Jesse Han, Jeff Harris, Yuchen He, Mike Heaton, Johannes Heidecke, Chris Hesse, Alan Hickey, Wade Hickey, Peter Hoeschele, Brandon Houghton, Kenny Hsu, Shengli Hu, Xin Hu, Joost Huizinga, Shantanu Jain, Shawn Jain, Joanne Jang, Angela Jiang, Roger Jiang, Haozhun Jin, Denny Jin, Shino Jomoto, Billie Jonn, Heewoo Jun, Tomer Kaftan, Łukasz Kaiser, Ali Kamali, Ingmar Kanitscheider, Nitish Shirish Keskar, Tabarak Khan, Logan Kilpatrick, Jong Wook Kim, Christina Kim, Yongjik Kim, Jan Hendrik Kirchner, Jamie Kiros, Matt Knight, Daniel Kokotajlo, Łukasz Kondraciuk, Andrew Kondrich, Aris Konstantinidis, Kyle Kosic, Gretchen Krueger, Vishal Kuo, Michael Lampe, Ikai Lan, Teddy Lee, Jan Leike, Jade Leung, Daniel Levy, Chak Ming Li, Rachel Lim, Molly Lin, Stephanie Lin, Mateusz Litwin, Theresa Lopez, Ryan
Lowe, Patricia Lue, Anna Makanju, Kim Malfacini, Sam Manning, Todor Markov, Yaniv Markovski, Bianca Martin, Katie Mayer, Andrew Mayne, Bob McGrew, Scott Mayer McKinney, Christine McLeavey, Paul McMillan, Jake McNeil, David Medina, Aalok Mehta, Jacob Menick, Luke Metz, Andrey Mishchenko, Pamela Mishkin, Vinnie Monaco, Evan Morikawa, Daniel Mossing, Tong Mu, Mira Murati, Oleg Murk, David Mély, Ashvin Nair, Reiichiro Nakano, Rajeev Nayak, Arvind Neelakantan, Richard Ngo, Hyeonwoo Noh, Long Ouyang, Cullen O’Keefe, Jakub Pachocki, Alex Paino, Joe Palermo, Ashley Pantuliano, Giambattista Parascandolo, Joel Parish, Emy Parparita, Alex Passos, Mikhail Pavlov, Andrew Peng, Adam Perelman, Filipe de Avila Belbute Peres, Michael Petrov, Henrique Ponde de Oliveira Pinto, Michael, Pokorny, Michelle Pokrass, Vitchyr H. Pong, Tolly Powell, Alethea Power, Boris Power, Elizabeth Proehl, Raul Puri, Alec Radford, Jack Rae, Aditya Ramesh, Cameron Raymond, Francis Real, Kendra Rimbach, Carl Ross, Bob Rotsted, Henri Roussez,
Nick Ryder, Mario Saltarelli, Ted Sanders, Shibani Santurkar, Girish Sastry, Heather Schmidt, David Schnurr, John Schulman, Daniel Selsam, Kyla Sheppard, Toki Sherbakov, Jessica Shieh, Sarah Shoker, Pranav Shyam, Szymon Sidor, Eric Sigler, Maddie Simens, Jordan Sitkin, Katarina Slama, Ian Sohl, Benjamin Sokolowsky, Yang Song, Natalie Staudacher, Felipe Petroski Such, Natalie Summers, Ilya Sutskever, Jie Tang, Nikolas Tezak, Madeleine B. Thompson, Phil Tillet, Amin Tootoonchian, Elizabeth Tseng, Preston Tuggle, Nick Turley, Jerry Tworek, Juan Felipe Cerón Uribe, Andrea Vallone, Arun Vijayvergiya, Chelsea Voss, Carroll Wainwright, Justin Jay Wang, Alvin Wang, Ben Wang, Jonathan Ward, Jason Wei, CJ Weinmann, Akila Welihinda, Peter Welinder, Jiayi Weng, Lilian Weng, Matt Wiethoff, Dave Willner, Clemens Winter, Samuel Wolrich, Hannah Wong, Lauren Workman, Sherwin Wu, Jeff Wu, Michael Wu, Kai Xiao, Tao Xu, Sarah Yoo, Kevin Yu, Qiming Yuan, Wojciech Zaremba, Rowan Zellers, Chong Zhang, Marvin Zhang, Shengjia
Zhao, Tianhao Zheng, Juntang Zhuang, William Zhuk, and Barret Zoph.

</span>
<span class="ltx_bibblock">Gpt-4 technical report, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2303.08774" title="">https://arxiv.org/abs/2303.08774</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Platt (2000)</span>
<span class="ltx_bibblock">
John Platt.

</span>
<span class="ltx_bibblock">Probabilistic outputs for support vector machines and comparisons to regularized likelihood methods.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Adv. Large Margin Classif.</em>, 10, 06 2000.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Putta et al. (2024)</span>
<span class="ltx_bibblock">
Pranav Putta, Edmund Mills, Naman Garg, Sumeet Motwani, Chelsea Finn, Divyansh Garg, and Rafael Rafailov.

</span>
<span class="ltx_bibblock">Agent q: Advanced reasoning and learning for autonomous ai agents.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2408.07199</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raventós et al. (2024)</span>
<span class="ltx_bibblock">
Allan Raventós, Mansheej Paul, Feng Chen, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Pretraining task diversity and the emergence of non-bayesian in-context learning for regression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Samvelyan et al. (2024)</span>
<span class="ltx_bibblock">
Mikayel Samvelyan, Sharath Chandra Raparthy, Andrei Lupu, Eric Hambro, Aram H Markosyan, Manish Bhatt, Yuning Mao, Minqi Jiang, Jack Parker-Holder, Jakob Foerster, et al.

</span>
<span class="ltx_bibblock">Rainbow teaming: Open-ended generation of diverse adversarial prompts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:2402.16822</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sharmanska et al. (2020)</span>
<span class="ltx_bibblock">
Viktoriia Sharmanska, Lisa Anne Hendricks, Trevor Darrell, and Novi Quadrianto.

</span>
<span class="ltx_bibblock">Contrastive examples for addressing the tyranny of the majority.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2004.06524</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shinn et al. (2023)</span>
<span class="ltx_bibblock">
Noah Shinn, Federico Cassano, Edward Berman, Ashwin Gopinath, Karthik Narasimhan, and Shunyu Yao.

</span>
<span class="ltx_bibblock">Reflexion: Language agents with verbal reinforcement learning, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Simpson (1951)</span>
<span class="ltx_bibblock">
Edward H Simpson.

</span>
<span class="ltx_bibblock">The interpretation of interaction in contingency tables.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Journal of the Royal Statistical Society: Series B (Methodological)</em>, 13(2):238–241, 1951.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Trabucco et al. (2023)</span>
<span class="ltx_bibblock">
Brandon Trabucco, Kyle Doherty, Max Gurinas, and Ruslan Salakhutdinov.

</span>
<span class="ltx_bibblock">Effective data augmentation with diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2302.07944</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Verhulst (1838)</span>
<span class="ltx_bibblock">
PF Verhulst.

</span>
<span class="ltx_bibblock">Notice on the law that the population follows in its growth.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Corresp Math Phys</em>, 10:113–26, 1838.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vijayakumar et al. (2016)</span>
<span class="ltx_bibblock">
Ashwin K Vijayakumar, Michael Cogswell, Ramprasath R Selvaraju, Qing Sun, Stefan Lee, David Crandall, and Dhruv Batra.

</span>
<span class="ltx_bibblock">Diverse beam search: Decoding diverse solutions from neural sequence models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:1610.02424</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vrandečić &amp; Krötzsch (2014)</span>
<span class="ltx_bibblock">
Denny Vrandečić and Markus Krötzsch.

</span>
<span class="ltx_bibblock">Wikidata: a free collaborative knowledgebase.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Commun. ACM</em>, 57(10):78–85, September 2014.

</span>
<span class="ltx_bibblock">ISSN 0001-0782.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/2629489</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2629489" title="">https://doi.org/10.1145/2629489</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei &amp; Zou (2019)</span>
<span class="ltx_bibblock">
Jason Wei and Kai Zou.

</span>
<span class="ltx_bibblock">Eda: Easy data augmentation techniques for boosting performance on text classification tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:1901.11196</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wilson (2016)</span>
<span class="ltx_bibblock">
Chris Wilson.

</span>
<span class="ltx_bibblock">Baby names: Why there are more for girls than boys.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Time</em>, May 2016.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://time.com/4322881/baby-names-girls-boys/" title="">https://time.com/4322881/baby-names-girls-boys/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2019)</span>
<span class="ltx_bibblock">
Jingjing Xu, Yuechen Wang, Duyu Tang, Nan Duan, Pengcheng Yang, Qi Zeng, Ming Zhou, and Xu Sun.

</span>
<span class="ltx_bibblock">Asking clarification questions in knowledge-based question answering.

</span>
<span class="ltx_bibblock">In Kentaro Inui, Jing Jiang, Vincent Ng, and Xiaojun Wan (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pp.  1618–1629, Hong Kong, China, November 2019. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/D19-1172</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D19-1172" title="">https://aclanthology.org/D19-1172</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2023)</span>
<span class="ltx_bibblock">
Qi Yan, Raihan Seraj, Jiawei He, Lili Meng, and Tristan Sylvain.

</span>
<span class="ltx_bibblock">Autocast++: Enhancing world event prediction with zero-shot ranking-based context retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2310.01880</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2024)</span>
<span class="ltx_bibblock">
Shunyu Yao, Dian Yu, Jeffrey Zhao, Izhak Shafran, Tom Griffiths, Yuan Cao, and Karthik Narasimhan.

</span>
<span class="ltx_bibblock">Tree of thoughts: Deliberate problem solving with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Tao Yu, Rui Zhang, Kai Yang, Michihiro Yasunaga, Dongxu Wang, Zifan Li, James Ma, Irene Li, Qingning Yao, Shanelle Roman, Zilin Zhang, and Dragomir Radev.

</span>
<span class="ltx_bibblock">Spider: A large-scale human-labeled dataset for complex and cross-domain semantic parsing and text-to-sql task, 2019.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1809.08887" title="">https://arxiv.org/abs/1809.08887</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Edwin Zhang, Vincent Zhu, Naomi Saphra, Anat Kleiman, Benjamin L Edelman, Milind Tambe, Sham M Kakade, and Eran Malach.

</span>
<span class="ltx_bibblock">Transcendence: Generative models can outperform the experts that train them.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2406.11741</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2017)</span>
<span class="ltx_bibblock">
Victor Zhong, Caiming Xiong, and Richard Socher.

</span>
<span class="ltx_bibblock">Seq2sql: Generating structured queries from natural language using reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">arXiv preprint arXiv:1709.00103</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al. (2022)</span>
<span class="ltx_bibblock">
Andy Zou, Tristan Xiao, Ryan Jia, Joe Kwon, Mantas Mazeika, Richard Li, Dawn Song, Jacob Steinhardt, Owain Evans, and Dan Hendrycks.

</span>
<span class="ltx_bibblock">Forecasting future world events with neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Advances in Neural Information Processing Systems</em>, 35:27293–27305, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>CoverageQA Dataset</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p1.1.1">Generation Procedure</span></p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">To generate the questions, we manually came up with initial item and property pairings to run the recursive search. We constrain the recursive search to yield between 20-40 possible answers to keep the questions within common and relevant categories. We found that with fewer than 20 answers, the questions become too obvious, while with more than 40, they tend to get too specific and stray from general knowledge. The recursive search first finds all items that satisfy the initial conditions, then iteratively adds properties in steps until either the maximum depth (number of constraints) is reached or the number of answers falls outside the desired range. We blacklist properties that are detrimental to high-quality question generation, such as an item’s presence in a specific database, numeric properties like population, and properties that introduce high ambiguity. We then manually evaluate the generated conditions and answers to ensure they meet our criteria. With an appropriate initial condition, one query can generate hundreds of valid constraints that can later be turned into questions. Finally, we use GPT-4 to convert these constraints into natural language.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>F1 Scores</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">We show F1 scores in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A2.F7" title="Figure 7 ‣ Appendix B F1 Scores ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">7</span></a> to emphasize that the precision does not change substantially as a result of our method. Precision is calculated over the set of 100 attempts how many are in the ground truth. Recall as mentioned is calculated as how many unique ground truth solutions were observed in the 100 attempts.</p>
</div>
<figure class="ltx_figure" id="A2.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="A2.F7.sf1.g1" src="extracted/5926242/plots/temperature_scaling_recall/big_f1_score.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span><span class="ltx_text ltx_font_bold" id="A2.F7.sf1.2.1">CoverageQA-Curated</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A2.F7.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="A2.F7.sf2.g1" src="extracted/5926242/plots/temperature_scaling_recall/entity_game_f1_score.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span><span class="ltx_text ltx_font_bold" id="A2.F7.sf2.2.1">CoverageQA-Wikipedia</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="A2.F7.2.1">F1 score scaled with temperature.</span> The figure shows similar curves to recall on CoverageQA. This indicates the improved diversity does not come at a cost to precision.</figcaption>
</figure>
<figure class="ltx_table" id="A2.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>CoverageQA Domains</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T2.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A2.T2.1.1.1.1.1">
<span class="ltx_p" id="A2.T2.1.1.1.1.1.1" style="width:142.3pt;"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.1.1.1.1">Domain</span></span>
</span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.2.1">Question Count</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="A2.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T2.1.1.1.3.1">Average Number of Answers</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T2.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A2.T2.1.2.1.1">
<span class="ltx_inline-block ltx_align_top" id="A2.T2.1.2.1.1.1">
<span class="ltx_p" id="A2.T2.1.2.1.1.1.1" style="width:142.3pt;">General Knowledge (Curated)</span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T2.1.2.1.2">10</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="A2.T2.1.2.1.3">64.1</td>
</tr>
<tr class="ltx_tr" id="A2.T2.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T2.1.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="A2.T2.1.3.2.1.1">
<span class="ltx_p" id="A2.T2.1.3.2.1.1.1" style="width:142.3pt;">US National Parks</span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="A2.T2.1.3.2.2">6</td>
<td class="ltx_td ltx_align_right" id="A2.T2.1.3.2.3">12.2</td>
</tr>
<tr class="ltx_tr" id="A2.T2.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A2.T2.1.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="A2.T2.1.4.3.1.1">
<span class="ltx_p" id="A2.T2.1.4.3.1.1.1" style="width:142.3pt;">Geography Questions</span>
</span>
</td>
<td class="ltx_td ltx_align_right" id="A2.T2.1.4.3.2">75</td>
<td class="ltx_td ltx_align_right" id="A2.T2.1.4.3.3">27.4</td>
</tr>
<tr class="ltx_tr" id="A2.T2.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="A2.T2.1.5.4.1">
<span class="ltx_inline-block ltx_align_top" id="A2.T2.1.5.4.1.1">
<span class="ltx_p" id="A2.T2.1.5.4.1.1.1" style="width:142.3pt;">Chemical Elements</span>
</span>
</td>
<td class="ltx_td ltx_align_right ltx_border_b" id="A2.T2.1.5.4.2">14</td>
<td class="ltx_td ltx_align_right ltx_border_b" id="A2.T2.1.5.4.3">17.5</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Auto-stratification Prompt</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We provide the full prompt in Tbl. <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A3.T3" title="Table 3 ‣ Appendix C Auto-stratification Prompt ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">3</span></a>. To improve prompt adherence, we provide one in context example in the form of one simulated round of multi-turn conversation, i.e. we provide an example set of reasoning following the template.</p>
</div>
<figure class="ltx_table" id="A3.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A3.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T3.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A3.T3.1.1.1.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T3.1.1.1.1.1">
<span class="ltx_p" id="A3.T3.1.1.1.1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T3.1.1.1.1.1.1.1">System Prompt:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T3.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A3.T3.1.2.2.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T3.1.2.2.1.1">
<span class="ltx_p" id="A3.T3.1.2.2.1.1.1" style="width:433.6pt;">You’re a helpful brainstorming assistant that is careful to consider all factors to a problem.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T3.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A3.T3.1.3.3.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T3.1.3.3.1.1">
<span class="ltx_p" id="A3.T3.1.3.3.1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_font_bold" id="A3.T3.1.3.3.1.1.1.1">User:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T3.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A3.T3.1.4.4.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T3.1.4.4.1.1">
<span class="ltx_p" id="A3.T3.1.4.4.1.1.1" style="width:433.6pt;">I am tasked with the following request:</span>
<span class="ltx_p" id="A3.T3.1.4.4.1.1.2"><span class="ltx_text ltx_font_italic" id="A3.T3.1.4.4.1.1.2.1" style="color:#00FFFF;">% User Request</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T3.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A3.T3.1.5.5.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T3.1.5.5.1.1">
<span class="ltx_p" id="A3.T3.1.5.5.1.1.1" style="width:433.6pt;">Help me brainstorm how to respond to the user request by providing a list of True/False properties the solution may or may not have. Use the following step-by-step to come up with good properties:

<span class="ltx_enumerate" id="A3.I1">
<span class="ltx_item" id="A3.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A3.I1.i1.p1">
<span class="ltx_p" id="A3.I1.i1.p1.1">If you were playing 20 questions, what’s a good first question to ask that would split the possibilities in half?</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix1.p1">
<span class="ltx_p" id="A3.I1.ix1.p1.1">List at least 5 questions and their corresponding properties.</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix2.p1">
<span class="ltx_p" id="A3.I1.ix2.p1.1">Question: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para" id="A3.I1.i2.p1">
<span class="ltx_p" id="A3.I1.i2.p1.1">Rewrite each question as a True/False property that’s true for one half and false for the other.</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix3.p1">
<span class="ltx_p" id="A3.I1.ix3.p1.1">Question: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix4.p1">
<span class="ltx_p" id="A3.I1.ix4.p1.1">True/False Property: &lt;Property Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">3.</span>
<span class="ltx_para" id="A3.I1.i3.p1">
<span class="ltx_p" id="A3.I1.i3.p1.1">For each property, come up with an example that would satisfy the property.</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix5.p1">
<span class="ltx_p" id="A3.I1.ix5.p1.1">Property: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix6" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix6.p1">
<span class="ltx_p" id="A3.I1.ix6.p1.1">Example: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix7" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix7.p1">
<span class="ltx_p" id="A3.I1.ix7.p1.1">Is it a valid answer to the user’s request? &lt;Yes/No&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">4.</span>
<span class="ltx_para" id="A3.I1.i4.p1">
<span class="ltx_p" id="A3.I1.i4.p1.1">For each property, come up with an example that would not satisfy the property.</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix8" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix8.p1">
<span class="ltx_p" id="A3.I1.ix8.p1.1">Property: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix9" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix9.p1">
<span class="ltx_p" id="A3.I1.ix9.p1.1">Example: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix10" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix10.p1">
<span class="ltx_p" id="A3.I1.ix10.p1.1">Is it a valid answer to the user’s request? &lt;Yes/No&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">5.</span>
<span class="ltx_para" id="A3.I1.i5.p1">
<span class="ltx_p" id="A3.I1.i5.p1.1">Does the property mention a candidate answer in it?</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix11" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix11.p1">
<span class="ltx_p" id="A3.I1.ix11.p1.1">Property: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix12" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix12.p1">
<span class="ltx_p" id="A3.I1.ix12.p1.1">Does the property mention a candidate answer in it? &lt;Yes/No&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.i6" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">6.</span>
<span class="ltx_para" id="A3.I1.i6.p1">
<span class="ltx_p" id="A3.I1.i6.p1.1">For each property, list whether we should include it or not in the final list of properties. Do not include ones where an example from above is not valid or if it mentions a candidate answer in it.</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix13" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A3.I1.ix13.p1">
<span class="ltx_p" id="A3.I1.ix13.p1.1">Property: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I1.ix14" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para ltx_noindent" id="A3.I1.ix14.p1">
<span class="ltx_p" id="A3.I1.ix14.p1.1">Include in final list? &lt;Yes/No&gt;</span>
</span></span>
</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T3.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A3.T3.1.6.6.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A3.T3.1.6.6.1.1">
<span class="ltx_p" id="A3.T3.1.6.6.1.1.1" style="width:433.6pt;">Final List of True/False Properties:

<span class="ltx_enumerate" id="A3.I2">
<span class="ltx_item" id="A3.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A3.I2.i1.p1">
<span class="ltx_p" id="A3.I2.i1.p1.1">&lt;Property Description 1&gt;</span>
</span></span>
<span class="ltx_item" id="A3.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para ltx_noindent" id="A3.I2.i2.p1">
<span class="ltx_p" id="A3.I2.i2.p1.1">&lt;Property Description 2&gt;</span>
</span></span>
</span></span>
<span class="ltx_p" id="A3.T3.1.6.6.1.1.2">Ensure all properties are listed are sentences that are either True or False</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Full prompt for Auto-stratification.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Heuristic Estimation Prompt</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">We first take each partition function from auto-stratification and estimate a starting probability with the prompt in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A4.T4" title="Table 4 ‣ Appendix D Heuristic Estimation Prompt ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">4</span></a>.
This prompt is heavily inspired by <cite class="ltx_cite ltx_citemacro_citet">Halawi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#bib.bib12" title="">2024</a>)</cite>.
We then collect all the proportions and pass it through a final Heuristic Estimation prompt to remove redundant properties (negations for instance) and give the model a chance to correct any incorrect probabilities. See Table <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A4.T5" title="Table 5 ‣ Appendix D Heuristic Estimation Prompt ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">5</span></a> for full prompt. Finally, we ask the model to select at most 3.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.p2">
<p class="ltx_p" id="A4.p2.1">Note that for performance reasons, we estimate the marginal probabilities and make a simplifying assumption of independence. This is not strictly true if one partition function is the negation of the other. This leads potential stratum assigned positive probability but actually the stratum has no solutions. Otherwise, there would be <math alttext="2^{\text{\# of Partition Functions}}" class="ltx_Math" display="inline" id="A4.p2.1.m1.1"><semantics id="A4.p2.1.m1.1a"><msup id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml"><mn id="A4.p2.1.m1.1.1.2" xref="A4.p2.1.m1.1.1.2.cmml">2</mn><mtext id="A4.p2.1.m1.1.1.3" xref="A4.p2.1.m1.1.1.3a.cmml"># of Partition Functions</mtext></msup><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><apply id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A4.p2.1.m1.1.1.1.cmml" xref="A4.p2.1.m1.1.1">superscript</csymbol><cn id="A4.p2.1.m1.1.1.2.cmml" type="integer" xref="A4.p2.1.m1.1.1.2">2</cn><ci id="A4.p2.1.m1.1.1.3a.cmml" xref="A4.p2.1.m1.1.1.3"><mtext id="A4.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="A4.p2.1.m1.1.1.3"># of Partition Functions</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">2^{\text{\# of Partition Functions}}</annotation><annotation encoding="application/x-llamapun" id="A4.p2.1.m1.1d">2 start_POSTSUPERSCRIPT # of Partition Functions end_POSTSUPERSCRIPT</annotation></semantics></math> strata to estimate probabilities of. Further, LLMs seem less reliable when asked to estimate fine-grained probabilities, whereas most marginal probabilities are by design close to 0.5.</p>
</div>
<div class="ltx_para ltx_noindent" id="A4.p3">
<p class="ltx_p" id="A4.p3.3">Formally, if <math alttext="P=\neg Q" class="ltx_Math" display="inline" id="A4.p3.1.m1.1"><semantics id="A4.p3.1.m1.1a"><mrow id="A4.p3.1.m1.1.1" xref="A4.p3.1.m1.1.1.cmml"><mi id="A4.p3.1.m1.1.1.2" xref="A4.p3.1.m1.1.1.2.cmml">P</mi><mo id="A4.p3.1.m1.1.1.1" xref="A4.p3.1.m1.1.1.1.cmml">=</mo><mrow id="A4.p3.1.m1.1.1.3" xref="A4.p3.1.m1.1.1.3.cmml"><mo id="A4.p3.1.m1.1.1.3.1" rspace="0.167em" xref="A4.p3.1.m1.1.1.3.1.cmml">¬</mo><mi id="A4.p3.1.m1.1.1.3.2" xref="A4.p3.1.m1.1.1.3.2.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.1.m1.1b"><apply id="A4.p3.1.m1.1.1.cmml" xref="A4.p3.1.m1.1.1"><eq id="A4.p3.1.m1.1.1.1.cmml" xref="A4.p3.1.m1.1.1.1"></eq><ci id="A4.p3.1.m1.1.1.2.cmml" xref="A4.p3.1.m1.1.1.2">𝑃</ci><apply id="A4.p3.1.m1.1.1.3.cmml" xref="A4.p3.1.m1.1.1.3"><not id="A4.p3.1.m1.1.1.3.1.cmml" xref="A4.p3.1.m1.1.1.3.1"></not><ci id="A4.p3.1.m1.1.1.3.2.cmml" xref="A4.p3.1.m1.1.1.3.2">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.1.m1.1c">P=\neg Q</annotation><annotation encoding="application/x-llamapun" id="A4.p3.1.m1.1d">italic_P = ¬ italic_Q</annotation></semantics></math>, the the stratum <math alttext="P\wedge Q" class="ltx_Math" display="inline" id="A4.p3.2.m2.1"><semantics id="A4.p3.2.m2.1a"><mrow id="A4.p3.2.m2.1.1" xref="A4.p3.2.m2.1.1.cmml"><mi id="A4.p3.2.m2.1.1.2" xref="A4.p3.2.m2.1.1.2.cmml">P</mi><mo id="A4.p3.2.m2.1.1.1" xref="A4.p3.2.m2.1.1.1.cmml">∧</mo><mi id="A4.p3.2.m2.1.1.3" xref="A4.p3.2.m2.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.2.m2.1b"><apply id="A4.p3.2.m2.1.1.cmml" xref="A4.p3.2.m2.1.1"><and id="A4.p3.2.m2.1.1.1.cmml" xref="A4.p3.2.m2.1.1.1"></and><ci id="A4.p3.2.m2.1.1.2.cmml" xref="A4.p3.2.m2.1.1.2">𝑃</ci><ci id="A4.p3.2.m2.1.1.3.cmml" xref="A4.p3.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.2.m2.1c">P\wedge Q</annotation><annotation encoding="application/x-llamapun" id="A4.p3.2.m2.1d">italic_P ∧ italic_Q</annotation></semantics></math> has zero probability, even though we assumed it to be <math alttext="Pr[P]*Pr[Q]" class="ltx_Math" display="inline" id="A4.p3.3.m3.2"><semantics id="A4.p3.3.m3.2a"><mrow id="A4.p3.3.m3.2.3" xref="A4.p3.3.m3.2.3.cmml"><mrow id="A4.p3.3.m3.2.3.2" xref="A4.p3.3.m3.2.3.2.cmml"><mrow id="A4.p3.3.m3.2.3.2.2" xref="A4.p3.3.m3.2.3.2.2.cmml"><mi id="A4.p3.3.m3.2.3.2.2.2" xref="A4.p3.3.m3.2.3.2.2.2.cmml">P</mi><mo id="A4.p3.3.m3.2.3.2.2.1" xref="A4.p3.3.m3.2.3.2.2.1.cmml">⁢</mo><mi id="A4.p3.3.m3.2.3.2.2.3" xref="A4.p3.3.m3.2.3.2.2.3.cmml">r</mi><mo id="A4.p3.3.m3.2.3.2.2.1a" xref="A4.p3.3.m3.2.3.2.2.1.cmml">⁢</mo><mrow id="A4.p3.3.m3.2.3.2.2.4.2" xref="A4.p3.3.m3.2.3.2.2.4.1.cmml"><mo id="A4.p3.3.m3.2.3.2.2.4.2.1" stretchy="false" xref="A4.p3.3.m3.2.3.2.2.4.1.1.cmml">[</mo><mi id="A4.p3.3.m3.1.1" xref="A4.p3.3.m3.1.1.cmml">P</mi><mo id="A4.p3.3.m3.2.3.2.2.4.2.2" rspace="0.055em" stretchy="false" xref="A4.p3.3.m3.2.3.2.2.4.1.1.cmml">]</mo></mrow></mrow><mo id="A4.p3.3.m3.2.3.2.1" rspace="0.222em" xref="A4.p3.3.m3.2.3.2.1.cmml">∗</mo><mi id="A4.p3.3.m3.2.3.2.3" xref="A4.p3.3.m3.2.3.2.3.cmml">P</mi></mrow><mo id="A4.p3.3.m3.2.3.1" xref="A4.p3.3.m3.2.3.1.cmml">⁢</mo><mi id="A4.p3.3.m3.2.3.3" xref="A4.p3.3.m3.2.3.3.cmml">r</mi><mo id="A4.p3.3.m3.2.3.1a" xref="A4.p3.3.m3.2.3.1.cmml">⁢</mo><mrow id="A4.p3.3.m3.2.3.4.2" xref="A4.p3.3.m3.2.3.4.1.cmml"><mo id="A4.p3.3.m3.2.3.4.2.1" stretchy="false" xref="A4.p3.3.m3.2.3.4.1.1.cmml">[</mo><mi id="A4.p3.3.m3.2.2" xref="A4.p3.3.m3.2.2.cmml">Q</mi><mo id="A4.p3.3.m3.2.3.4.2.2" stretchy="false" xref="A4.p3.3.m3.2.3.4.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.3.m3.2b"><apply id="A4.p3.3.m3.2.3.cmml" xref="A4.p3.3.m3.2.3"><times id="A4.p3.3.m3.2.3.1.cmml" xref="A4.p3.3.m3.2.3.1"></times><apply id="A4.p3.3.m3.2.3.2.cmml" xref="A4.p3.3.m3.2.3.2"><times id="A4.p3.3.m3.2.3.2.1.cmml" xref="A4.p3.3.m3.2.3.2.1"></times><apply id="A4.p3.3.m3.2.3.2.2.cmml" xref="A4.p3.3.m3.2.3.2.2"><times id="A4.p3.3.m3.2.3.2.2.1.cmml" xref="A4.p3.3.m3.2.3.2.2.1"></times><ci id="A4.p3.3.m3.2.3.2.2.2.cmml" xref="A4.p3.3.m3.2.3.2.2.2">𝑃</ci><ci id="A4.p3.3.m3.2.3.2.2.3.cmml" xref="A4.p3.3.m3.2.3.2.2.3">𝑟</ci><apply id="A4.p3.3.m3.2.3.2.2.4.1.cmml" xref="A4.p3.3.m3.2.3.2.2.4.2"><csymbol cd="latexml" id="A4.p3.3.m3.2.3.2.2.4.1.1.cmml" xref="A4.p3.3.m3.2.3.2.2.4.2.1">delimited-[]</csymbol><ci id="A4.p3.3.m3.1.1.cmml" xref="A4.p3.3.m3.1.1">𝑃</ci></apply></apply><ci id="A4.p3.3.m3.2.3.2.3.cmml" xref="A4.p3.3.m3.2.3.2.3">𝑃</ci></apply><ci id="A4.p3.3.m3.2.3.3.cmml" xref="A4.p3.3.m3.2.3.3">𝑟</ci><apply id="A4.p3.3.m3.2.3.4.1.cmml" xref="A4.p3.3.m3.2.3.4.2"><csymbol cd="latexml" id="A4.p3.3.m3.2.3.4.1.1.cmml" xref="A4.p3.3.m3.2.3.4.2.1">delimited-[]</csymbol><ci id="A4.p3.3.m3.2.2.cmml" xref="A4.p3.3.m3.2.2">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.3.m3.2c">Pr[P]*Pr[Q]</annotation><annotation encoding="application/x-llamapun" id="A4.p3.3.m3.2d">italic_P italic_r [ italic_P ] ∗ italic_P italic_r [ italic_Q ]</annotation></semantics></math>. We handle approximation error in estimating the true prompt distribution by allowing the model to reply "Invalid" to trigger a resample. With this adjustment, the probabilistic prompt distribution is maintained for this extreme case. This correction however does not ameliorate potential issues with</p>
</div>
<figure class="ltx_table" id="A4.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A4.T4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T4.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A4.T4.1.1.1.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T4.1.1.1.1.1">
<span class="ltx_p" id="A4.T4.1.1.1.1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.1.1.1.1.1.1.1">System Prompt:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T4.1.2.2.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T4.1.2.2.1.1">
<span class="ltx_p" id="A4.T4.1.2.2.1.1.1" style="width:433.6pt;">You are an expert superforecaster, familiar with the work of Tetlock and others.
Your mission is to generate accurate predictions for forecasting questions.
Aggregate the information provided by the user. Make sure to give detailed reasoning.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T4.1.3.3.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T4.1.3.3.1.1">
<span class="ltx_p" id="A4.T4.1.3.3.1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T4.1.3.3.1.1.1.1">User:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T4.1.4.4.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T4.1.4.4.1.1">
<span class="ltx_p" id="A4.T4.1.4.4.1.1.1" style="width:433.6pt;">I am tasked to estimate the probability that a random solution to "<span class="ltx_text ltx_font_italic" id="A4.T4.1.4.4.1.1.1.1" style="color:#00FFFF;">User Request</span>" has the following property "<span class="ltx_text ltx_font_italic" id="A4.T4.1.4.4.1.1.1.2" style="color:#00FFFF;">Partitioning Property</span>"</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T4.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A4.T4.1.5.5.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T4.1.5.5.1.1">
<span class="ltx_p" id="A4.T4.1.5.5.1.1.1" style="width:433.6pt;">Instructions:

<span class="ltx_enumerate" id="A4.I1">
<span class="ltx_item" id="A4.I1.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A4.I1.i1.p1">
<span class="ltx_p" id="A4.I1.i1.p1.1">Provide at least 3 reasons why the answer might be no.</span>
</span></span>
<span class="ltx_item" id="A4.I1.ix1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I1.ix1.p1">
<span class="ltx_p" id="A4.I1.ix1.p1.1">{ Insert your thoughts }</span>
</span></span>
<span class="ltx_item" id="A4.I1.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para" id="A4.I1.i2.p1">
<span class="ltx_p" id="A4.I1.i2.p1.1">Provide at least 3 reasons why the answer might be yes.</span>
</span></span>
<span class="ltx_item" id="A4.I1.ix2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para ltx_noindent" id="A4.I1.ix2.p1">
<span class="ltx_p" id="A4.I1.ix2.p1.1">{ Insert your thoughts }</span>
</span></span>
<span class="ltx_item" id="A4.I1.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">3.</span>
<span class="ltx_para" id="A4.I1.i3.p1">
<span class="ltx_p" id="A4.I1.i3.p1.1">Rate the strength of each of the reasons given in the last two responses. Think like a superforecaster (e.g. Nate Silver).</span>
</span></span>
<span class="ltx_item" id="A4.I1.ix3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I1.ix3.p1">
<span class="ltx_p" id="A4.I1.ix3.p1.1">{ Insert your rating of the strength of each reason }</span>
</span></span>
<span class="ltx_item" id="A4.I1.i4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">4.</span>
<span class="ltx_para" id="A4.I1.i4.p1">
<span class="ltx_p" id="A4.I1.i4.p1.1">Aggregate your considerations.</span>
</span></span>
<span class="ltx_item" id="A4.I1.ix4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I1.ix4.p1">
<span class="ltx_p" id="A4.I1.ix4.p1.1">{ Insert your aggregated considerations }</span>
</span></span>
<span class="ltx_item" id="A4.I1.i5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">5.</span>
<span class="ltx_para" id="A4.I1.i5.p1">
<span class="ltx_p" id="A4.I1.i5.p1.1">Output your answer (a number between 0 and 1) with an asterisk at the beginning and end of the decimal.</span>
</span></span>
<span class="ltx_item" id="A4.I1.ix5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para ltx_noindent" id="A4.I1.ix5.p1">
<span class="ltx_p" id="A4.I1.ix5.p1.1">{ Insert your answer }</span>
</span></span>
</span></span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Prompt for Partition-specific Heuristic Estimation.</figcaption>
</figure>
<figure class="ltx_table" id="A4.T5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A4.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T5.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_tt" id="A4.T5.1.1.1.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.1.1.1.1">
<span class="ltx_p" id="A4.T5.1.1.1.1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.1.1.1.1.1.1.1">System Prompt:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T5.1.2.2.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.2.2.1.1">
<span class="ltx_p" id="A4.T5.1.2.2.1.1.1" style="width:433.6pt;">You are an expert superforecaster, familiar with the work of Tetlock and others.
Your mission is to generate accurate predictions for forecasting questions.
Aggregate the information provided by the user. Make sure to give detailed reasoning.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A4.T5.1.3.3.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.3.3.1.1">
<span class="ltx_p" id="A4.T5.1.3.3.1.1.1" style="width:433.6pt;"><span class="ltx_text ltx_font_bold" id="A4.T5.1.3.3.1.1.1.1">User:</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T5.1.4.4.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.4.4.1.1">
<span class="ltx_p" id="A4.T5.1.4.4.1.1.1" style="width:433.6pt;">I’m playing a game where my friend has been tasked to:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T5.1.5.5.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.5.5.1.1">
<span class="ltx_p" id="A4.T5.1.5.5.1.1.1" style="width:433.6pt;">"<span class="ltx_text ltx_font_italic" id="A4.T5.1.5.5.1.1.1.1" style="color:#00FFFF;">User Request</span>"</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A4.T5.1.6.6.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.6.6.1.1">
<span class="ltx_p" id="A4.T5.1.6.6.1.1.1" style="width:433.6pt;">I have the following Y/N statements I can ask my friend. I have probabilities that I think it’s true:
<span class="ltx_text" id="A4.T5.1.6.6.1.1.1.1" style="color:#00FFFF;">% Insert numbered list of partitions and proportions.</span></span>
<span class="ltx_p" id="A4.T5.1.6.6.1.1.2">Instructions:</span>
<span class="ltx_enumerate" id="A4.I2">
<span class="ltx_item" id="A4.I2.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A4.I2.i1.p1">
<span class="ltx_p" id="A4.I2.i1.p1.1">For each Y/N statement, is it redundant with another statement?</span>
</span></span>
<span class="ltx_item" id="A4.I2.ix1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I2.ix1.p1">
<span class="ltx_p" id="A4.I2.ix1.p1.1">Y/N statement: &lt;description&gt;</span>
</span></span>
<span class="ltx_item" id="A4.I2.ix2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I2.ix2.p1">
<span class="ltx_p" id="A4.I2.ix2.p1.1">Is redundant? &lt;Y/N: Explanation&gt;</span>
</span></span>
<span class="ltx_item" id="A4.I2.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para" id="A4.I2.i2.p1">
<span class="ltx_p" id="A4.I2.i2.p1.1">Are any of the probabilities in accurate? If it’s sufficiently accurate just report back the same value.</span>
</span></span>
<span class="ltx_item" id="A4.I2.ix3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I2.ix3.p1">
<span class="ltx_p" id="A4.I2.ix3.p1.1">Y/N statement: &lt;Description&gt;</span>
</span></span>
<span class="ltx_item" id="A4.I2.ix4" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para" id="A4.I2.ix4.p1">
<span class="ltx_p" id="A4.I2.ix4.p1.1">Is accurate? &lt;Y/N: Explanation&gt;</span>
</span></span>
<span class="ltx_item" id="A4.I2.ix5" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item"></span>
<span class="ltx_para ltx_noindent" id="A4.I2.ix5.p1">
<span class="ltx_p" id="A4.I2.ix5.p1.1">Probability: &lt;Probability&gt;</span>
</span></span>
<span class="ltx_item" id="A4.I2.i3" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">3.</span>
<span class="ltx_para ltx_noindent" id="A4.I2.i3.p1">
<span class="ltx_p" id="A4.I2.i3.p1.1">Pick at most three statements that are least redundant and pair well together. Prefer ones that are closest to 50% for most information.</span>
</span></span>
</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T5.1.7.7">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb" id="A4.T5.1.7.7.1" style="padding-left:7.2pt;padding-right:7.2pt;">
<span class="ltx_inline-block ltx_align_top" id="A4.T5.1.7.7.1.1">
<span class="ltx_p" id="A4.T5.1.7.7.1.1.1" style="width:433.6pt;">Final List of True/False Properties:

<span class="ltx_enumerate" id="A4.I3">
<span class="ltx_item" id="A4.I3.i1" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">1.</span>
<span class="ltx_para" id="A4.I3.i1.p1">
<span class="ltx_p" id="A4.I3.i1.p1.1">&lt;Y/N Properties&gt; :: &lt;Probability&gt;</span>
</span></span>
<span class="ltx_item" id="A4.I3.i2" style="list-style-type:none;"><span class="ltx_tag ltx_tag_item">2.</span>
<span class="ltx_para ltx_noindent" id="A4.I3.i2.p1">
<span class="ltx_p" id="A4.I3.i2.p1.1">&lt;Y/N Properties&gt; :: &lt;Probability&gt;</span>
</span></span>
</span></span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Prompt for Final Heuristic Estimation.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Plots: Distributional Analysis with Llama</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">We provide additional examples in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A5.F9" title="Figure 9 ‣ Appendix E Additional Plots: Distributional Analysis with Llama ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">9</span></a> and scatter plots for Llama 3 in Fig <a class="ltx_ref" href="https://arxiv.org/html/2410.09038v2#A5.F8" title="Figure 8 ‣ Appendix E Additional Plots: Distributional Analysis with Llama ‣ SimpleStrat: Diversifying Language Model Generation with Stratification"><span class="ltx_text ltx_ref_tag">8</span></a></p>
</div>
<figure class="ltx_figure" id="A5.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F8.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="A5.F8.sf1.g1" src="extracted/5926242/plots/kl_divergence_scatter/Meta-Llama-3-8B-Instruct.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Llama 3 8B</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F8.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="411" id="A5.F8.sf2.g1" src="extracted/5926242/plots/kl_divergence_scatter/Meta-Llama-3-70B-Instruct.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Llama 3 70B</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>KL divergence from uniform for Baseline vs SimpleStrat on CoverageQA Wikipedia. Additional plots for Llama 3 8B and 70B models</figcaption>
</figure>
<figure class="ltx_figure" id="A5.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="365" id="A5.F9.sf1.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-8B-comparison/Name_a_country_capital_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(a) </span>Llama 3.1 8B</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="365" id="A5.F9.sf2.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-70B-comparison/Name_a_country_capital_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(b) </span>Llama 3.1 70B</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="365" id="A5.F9.sf3.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-8B-comparison/Name_a_US_president_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(c) </span>Llama 3.1 8B</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="365" id="A5.F9.sf4.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-70B-comparison/Name_a_US_president_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(d) </span>Llama 3.1 70B</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="365" id="A5.F9.sf5.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-8B-comparison/Name_one_NBA_basketball_team_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(e) </span>Llama 3.1 8B</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="365" id="A5.F9.sf6.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-70B-comparison/Name_one_NBA_basketball_team_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(f) </span>Llama 3.1 70B</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="362" id="A5.F9.sf7.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-8B-comparison/Name_a_periodic_element_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(g) </span>Llama 3.1 8B</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="A5.F9.sf8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="362" id="A5.F9.sf8.g1" src="extracted/5926242/plots/logprob_histograms_overlayed/llama3.1-70B-comparison/Name_a_periodic_element_.png" width="548"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">(h) </span>Llama 3.1 70B</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="A5.F9.2.1">Baseline vs SimpleStrat Probability Distributions</span> This figure shows the answer distributions for 4 additional questions from CoverageQA curated. Each row represents a different question, showing distributions for Llama 3.1 8B and 70B.</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Oct 14 17:31:59 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
