<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.01615] Partial Federated Learning</title><meta property="og:description" content="Federated Learning (FL) is a popular algorithm to train machine learning models on user data constrained to edge devices (for example, mobile phones) due to privacy concerns. Typically, FL is trained with the assumptio…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Partial Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Partial Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.01615">

<!--Generated on Fri Apr  5 14:40:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Partial Federated Learning</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated Learning (FL) is a popular algorithm to train machine learning models on user data constrained to edge devices (for example, mobile phones) due to privacy concerns. Typically, FL is trained with the assumption that no part of the user data can be egressed from the edge. However, in many production settings, specific data-modalities/meta-data are limited to be on device while others are not. For example, in commercial SLU systems, it is typically desired to prevent transmission of biometric signals (such as audio recordings of the input prompt) to the cloud, but egress of locally (i.e. on the edge device) transcribed text to the cloud may be possible. In this work, we propose a new algorithm called Partial Federated Learning (PartialFL), where a machine learning model is trained using data where a subset of data modalities or their intermediate representations can be made available to the server. We further restrict our model training by preventing the egress of data labels to the cloud for better privacy, and instead use a contrastive learning based model objective. We evaluate our approach on two different multi-modal datasets and show promising results with our proposed approach.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Existing FL paradigms typically assume a uniform set of restrictions applied to all available data modalities. With this framework of uniform restrictions, depending on available permissions on the data, we maybe allowed to move all of them to a server for <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">central</span> model training or we maybe required to retain all data on the user devices (hereafter referred to as edge devices) for a <span id="S1.p1.1.2" class="ltx_text ltx_font_italic">federated</span> model training. However, in many real world settings, a subset of data modalities may carry looser constraints allowing easy egress of such data to a server.
As an example, consider a machine learning model built using medical data. In this case, certain biometric modalities such as the patient’s speech recordings, electrocardiogram (ECG), electroencephalogram (EEG), continuous heart rate (HR) measurements are likely to be protected more strictly compared to anonymized doctor’s notes and reports.
This is because biometric data are associated with Personal Identifiable Information (P.I.I) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, and sharing these can raise privacy concerns leading to a number of legislations to protect them, including the recently introduced California Biometric privacy law <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and Illinois Biometric Information Privacy Act <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning has been studied extensively in uni-modal settings while multi-modal federated learning has recently gained attention from several works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. However, existing learning paradigms do not support efficient and large scale training with distributed data modalities as described above, leading ML practitioners to choose the more restrictive setting of keeping all data on edge devices for federated model training.
This brings with it all the challenges typical for federated learning: i) restricted model sizes due to small computational power on edge and ii) gradient drift issues due to heterogeneity in data, thus leading to lower performance compared to centralized training.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we propose to address this gap by building a ”Partial” Federated Learning model (PartialFL), where a model is trained using distributed data for which some modalities are shared centrally while other modalities and the class labels are only available on the edge device. In addition to the distributed training, a closely related objective is to utilize the shared modalities to improve on FL model performance by addressing the data heterogeneity challenge. Our approach is related to the existing paradigm of vertical federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, where features for same set of samples maybe separated among different edge devices; in our case, we similarly have portions of data distributed between the central server and the edge devices, but the key difference in our work is that here we assume entirely different modalities of data exist on the edge and hence we can train a new artifact, such as an edge specific text encoder or acoustic signal encoder. Our main contributions in this work are:</p>
</div>
<div id="S1.p4" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We present a new Federated Learning algorithm to train a machine learning model when data modalities are split among different devices</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We evaluate our algorithm on two different data sets present key results showing improvements in model performance</p>
</div>
</li>
</ul>
<p id="S1.p4.1" class="ltx_p">We also present additional results on a new dataset in the supplemental material along with various ablation results, highlighting the key areas of improvement introduced by our approach.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Approach</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In a multi-modal FL setting, we can categorize each data modality into either the protected <span id="S2.p1.1.1" class="ltx_text ltx_font_bold">non-shareable group</span> or the less restricted <span id="S2.p1.1.2" class="ltx_text ltx_font_bold">shareable group</span> based on whether they are permitted to be egressed to the central server.
In this work, without loss of generalization, we assume that anonymized text data are shareable with the remote server (but note that our treatment holds for any other modality that is deemed shareable), while holding other modalities in the non-shareable group on the edge devices. For further protection against information leakage, we map the raw text data into latent representations using a pre-trained language models such as DistilBERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, and only share these representations with the server in all our experiments.
The benefit of training with shareable data in the server is that we can now train a larger model due to increased availability of compute in the server, and also extract a more robust representation when compared to the model trained on an unbalanced local data set. We assume availability of labels on edge for local modal training, but in their absence we can leverage user feedback similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, which we defer for future work.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2403.01615/assets/img/learning_architecture3.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="509" height="157" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.2.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>Different models in the PartialFL learning architecture.</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Outline</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.9" class="ltx_p">We consider a decentralized setup with <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">K</annotation></semantics></math> edge devices and a given multi-modal data set <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\mathcal{D}</annotation></semantics></math>. For ease of exposition, we describe our approach using text and audio data, but note that it can be applied to any multi-modal setting. As noted in the previous section, latent representations of text data is assumed shareable but no form of audio data is shareable. We denote <math id="S2.SS1.p1.3.m3.7" class="ltx_Math" alttext="\mathcal{D}^{k}:\{\mathbf{X}^{k}_{A,i},\mathbf{X}^{k}_{T,i},\mathbf{y}^{k}_{i}\}^{n_{k}}_{i=1}" display="inline"><semantics id="S2.SS1.p1.3.m3.7a"><mrow id="S2.SS1.p1.3.m3.7.7" xref="S2.SS1.p1.3.m3.7.7.cmml"><msup id="S2.SS1.p1.3.m3.7.7.5" xref="S2.SS1.p1.3.m3.7.7.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.7.7.5.2" xref="S2.SS1.p1.3.m3.7.7.5.2.cmml">𝒟</mi><mi id="S2.SS1.p1.3.m3.7.7.5.3" xref="S2.SS1.p1.3.m3.7.7.5.3.cmml">k</mi></msup><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p1.3.m3.7.7.4" xref="S2.SS1.p1.3.m3.7.7.4.cmml">:</mo><msubsup id="S2.SS1.p1.3.m3.7.7.3" xref="S2.SS1.p1.3.m3.7.7.3.cmml"><mrow id="S2.SS1.p1.3.m3.7.7.3.3.3.3" xref="S2.SS1.p1.3.m3.7.7.3.3.3.4.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.7.7.3.3.3.3.4" xref="S2.SS1.p1.3.m3.7.7.3.3.3.4.cmml">{</mo><msubsup id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.2" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.2.cmml">𝐗</mi><mrow id="S2.SS1.p1.3.m3.2.2.2.4" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.cmml">A</mi><mo id="S2.SS1.p1.3.m3.2.2.2.4.1" xref="S2.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS1.p1.3.m3.2.2.2.2" xref="S2.SS1.p1.3.m3.2.2.2.2.cmml">i</mi></mrow><mi id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.3" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.SS1.p1.3.m3.7.7.3.3.3.3.5" xref="S2.SS1.p1.3.m3.7.7.3.3.3.4.cmml">,</mo><msubsup id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.2" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.2.cmml">𝐗</mi><mrow id="S2.SS1.p1.3.m3.4.4.2.4" xref="S2.SS1.p1.3.m3.4.4.2.3.cmml"><mi id="S2.SS1.p1.3.m3.3.3.1.1" xref="S2.SS1.p1.3.m3.3.3.1.1.cmml">T</mi><mo id="S2.SS1.p1.3.m3.4.4.2.4.1" xref="S2.SS1.p1.3.m3.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p1.3.m3.4.4.2.2" xref="S2.SS1.p1.3.m3.4.4.2.2.cmml">i</mi></mrow><mi id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.3" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S2.SS1.p1.3.m3.7.7.3.3.3.3.6" xref="S2.SS1.p1.3.m3.7.7.3.3.3.4.cmml">,</mo><msubsup id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.cmml"><mi id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.2" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.2.cmml">𝐲</mi><mi id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.3" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.3.cmml">i</mi><mi id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.3" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.SS1.p1.3.m3.7.7.3.3.3.3.7" xref="S2.SS1.p1.3.m3.7.7.3.3.3.4.cmml">}</mo></mrow><mrow id="S2.SS1.p1.3.m3.7.7.3.5" xref="S2.SS1.p1.3.m3.7.7.3.5.cmml"><mi id="S2.SS1.p1.3.m3.7.7.3.5.2" xref="S2.SS1.p1.3.m3.7.7.3.5.2.cmml">i</mi><mo id="S2.SS1.p1.3.m3.7.7.3.5.1" xref="S2.SS1.p1.3.m3.7.7.3.5.1.cmml">=</mo><mn id="S2.SS1.p1.3.m3.7.7.3.5.3" xref="S2.SS1.p1.3.m3.7.7.3.5.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.3.m3.7.7.3.3.5" xref="S2.SS1.p1.3.m3.7.7.3.3.5.cmml"><mi id="S2.SS1.p1.3.m3.7.7.3.3.5.2" xref="S2.SS1.p1.3.m3.7.7.3.3.5.2.cmml">n</mi><mi id="S2.SS1.p1.3.m3.7.7.3.3.5.3" xref="S2.SS1.p1.3.m3.7.7.3.3.5.3.cmml">k</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.7b"><apply id="S2.SS1.p1.3.m3.7.7.cmml" xref="S2.SS1.p1.3.m3.7.7"><ci id="S2.SS1.p1.3.m3.7.7.4.cmml" xref="S2.SS1.p1.3.m3.7.7.4">:</ci><apply id="S2.SS1.p1.3.m3.7.7.5.cmml" xref="S2.SS1.p1.3.m3.7.7.5"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.5.1.cmml" xref="S2.SS1.p1.3.m3.7.7.5">superscript</csymbol><ci id="S2.SS1.p1.3.m3.7.7.5.2.cmml" xref="S2.SS1.p1.3.m3.7.7.5.2">𝒟</ci><ci id="S2.SS1.p1.3.m3.7.7.5.3.cmml" xref="S2.SS1.p1.3.m3.7.7.5.3">𝑘</ci></apply><apply id="S2.SS1.p1.3.m3.7.7.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.3.4.cmml" xref="S2.SS1.p1.3.m3.7.7.3">subscript</csymbol><apply id="S2.SS1.p1.3.m3.7.7.3.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.3.3.4.cmml" xref="S2.SS1.p1.3.m3.7.7.3">superscript</csymbol><set id="S2.SS1.p1.3.m3.7.7.3.3.3.4.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3"><apply id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1">subscript</csymbol><apply id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.2">𝐗</ci><ci id="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.3.m3.5.5.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.SS1.p1.3.m3.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.2.2.2.4"><ci id="S2.SS1.p1.3.m3.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1">𝐴</ci><ci id="S2.SS1.p1.3.m3.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.2.2.2.2">𝑖</ci></list></apply><apply id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2">subscript</csymbol><apply id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.2">𝐗</ci><ci id="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.3.m3.6.6.2.2.2.2.2.2.3">𝑘</ci></apply><list id="S2.SS1.p1.3.m3.4.4.2.3.cmml" xref="S2.SS1.p1.3.m3.4.4.2.4"><ci id="S2.SS1.p1.3.m3.3.3.1.1.cmml" xref="S2.SS1.p1.3.m3.3.3.1.1">𝑇</ci><ci id="S2.SS1.p1.3.m3.4.4.2.2.cmml" xref="S2.SS1.p1.3.m3.4.4.2.2">𝑖</ci></list></apply><apply id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.1.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3">subscript</csymbol><apply id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.1.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.2.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.2">𝐲</ci><ci id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.3.3.3.3">𝑖</ci></apply></set><apply id="S2.SS1.p1.3.m3.7.7.3.3.5.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.5"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.7.7.3.3.5.1.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.5">subscript</csymbol><ci id="S2.SS1.p1.3.m3.7.7.3.3.5.2.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.5.2">𝑛</ci><ci id="S2.SS1.p1.3.m3.7.7.3.3.5.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3.3.5.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.3.m3.7.7.3.5.cmml" xref="S2.SS1.p1.3.m3.7.7.3.5"><eq id="S2.SS1.p1.3.m3.7.7.3.5.1.cmml" xref="S2.SS1.p1.3.m3.7.7.3.5.1"></eq><ci id="S2.SS1.p1.3.m3.7.7.3.5.2.cmml" xref="S2.SS1.p1.3.m3.7.7.3.5.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.3.m3.7.7.3.5.3.cmml" xref="S2.SS1.p1.3.m3.7.7.3.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.7c">\mathcal{D}^{k}:\{\mathbf{X}^{k}_{A,i},\mathbf{X}^{k}_{T,i},\mathbf{y}^{k}_{i}\}^{n_{k}}_{i=1}</annotation></semantics></math> as the multi-modal dataset from <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">k</mi><mrow id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml"><mi id="S2.SS1.p1.4.m4.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.1.3.1" xref="S2.SS1.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS1.p1.4.m4.1.1.3.3" xref="S2.SS1.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑘</ci><apply id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3"><times id="S2.SS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.3.1"></times><ci id="S2.SS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.3.2">𝑡</ci><ci id="S2.SS1.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">k^{th}</annotation></semantics></math> edge device containing audio, text and labels respectively. <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">n</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝑛</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">n_{k}</annotation></semantics></math> is the size of the data set in <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msup id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝒟</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{D}^{k}</annotation></semantics></math>, with <math id="S2.SS1.p1.7.m7.4" class="ltx_Math" alttext="\mathcal{D}=\{\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{K}\}" display="inline"><semantics id="S2.SS1.p1.7.m7.4a"><mrow id="S2.SS1.p1.7.m7.4.4" xref="S2.SS1.p1.7.m7.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.4.4.5" xref="S2.SS1.p1.7.m7.4.4.5.cmml">𝒟</mi><mo id="S2.SS1.p1.7.m7.4.4.4" xref="S2.SS1.p1.7.m7.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.7.m7.4.4.3.3" xref="S2.SS1.p1.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.4.4.3.3.4" xref="S2.SS1.p1.7.m7.4.4.3.4.cmml">{</mo><msup id="S2.SS1.p1.7.m7.2.2.1.1.1" xref="S2.SS1.p1.7.m7.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.2.2.1.1.1.2" xref="S2.SS1.p1.7.m7.2.2.1.1.1.2.cmml">𝒟</mi><mn id="S2.SS1.p1.7.m7.2.2.1.1.1.3" xref="S2.SS1.p1.7.m7.2.2.1.1.1.3.cmml">1</mn></msup><mo id="S2.SS1.p1.7.m7.4.4.3.3.5" xref="S2.SS1.p1.7.m7.4.4.3.4.cmml">,</mo><msup id="S2.SS1.p1.7.m7.3.3.2.2.2" xref="S2.SS1.p1.7.m7.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.3.3.2.2.2.2" xref="S2.SS1.p1.7.m7.3.3.2.2.2.2.cmml">𝒟</mi><mn id="S2.SS1.p1.7.m7.3.3.2.2.2.3" xref="S2.SS1.p1.7.m7.3.3.2.2.2.3.cmml">2</mn></msup><mo id="S2.SS1.p1.7.m7.4.4.3.3.6" xref="S2.SS1.p1.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">…</mi><mo id="S2.SS1.p1.7.m7.4.4.3.3.7" xref="S2.SS1.p1.7.m7.4.4.3.4.cmml">,</mo><msup id="S2.SS1.p1.7.m7.4.4.3.3.3" xref="S2.SS1.p1.7.m7.4.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.4.4.3.3.3.2" xref="S2.SS1.p1.7.m7.4.4.3.3.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.7.m7.4.4.3.3.3.3" xref="S2.SS1.p1.7.m7.4.4.3.3.3.3.cmml">K</mi></msup><mo stretchy="false" id="S2.SS1.p1.7.m7.4.4.3.3.8" xref="S2.SS1.p1.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.4b"><apply id="S2.SS1.p1.7.m7.4.4.cmml" xref="S2.SS1.p1.7.m7.4.4"><eq id="S2.SS1.p1.7.m7.4.4.4.cmml" xref="S2.SS1.p1.7.m7.4.4.4"></eq><ci id="S2.SS1.p1.7.m7.4.4.5.cmml" xref="S2.SS1.p1.7.m7.4.4.5">𝒟</ci><set id="S2.SS1.p1.7.m7.4.4.3.4.cmml" xref="S2.SS1.p1.7.m7.4.4.3.3"><apply id="S2.SS1.p1.7.m7.2.2.1.1.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1.2">𝒟</ci><cn type="integer" id="S2.SS1.p1.7.m7.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p1.7.m7.3.3.2.2.2.cmml" xref="S2.SS1.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.7.m7.3.3.2.2.2">superscript</csymbol><ci id="S2.SS1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.7.m7.3.3.2.2.2.2">𝒟</ci><cn type="integer" id="S2.SS1.p1.7.m7.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">…</ci><apply id="S2.SS1.p1.7.m7.4.4.3.3.3.cmml" xref="S2.SS1.p1.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.7.m7.4.4.3.3.3">superscript</csymbol><ci id="S2.SS1.p1.7.m7.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.7.m7.4.4.3.3.3.2">𝒟</ci><ci id="S2.SS1.p1.7.m7.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.7.m7.4.4.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.4c">\mathcal{D}=\{\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{K}\}</annotation></semantics></math> and the total number of utterances in <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">\mathcal{D}</annotation></semantics></math> is <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="N=\sum^{K}_{k=1}n_{k}" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mrow id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml"><mi id="S2.SS1.p1.9.m9.1.1.2" xref="S2.SS1.p1.9.m9.1.1.2.cmml">N</mi><mo rspace="0.111em" id="S2.SS1.p1.9.m9.1.1.1" xref="S2.SS1.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.9.m9.1.1.3" xref="S2.SS1.p1.9.m9.1.1.3.cmml"><msubsup id="S2.SS1.p1.9.m9.1.1.3.1" xref="S2.SS1.p1.9.m9.1.1.3.1.cmml"><mo id="S2.SS1.p1.9.m9.1.1.3.1.2.2" xref="S2.SS1.p1.9.m9.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.SS1.p1.9.m9.1.1.3.1.3" xref="S2.SS1.p1.9.m9.1.1.3.1.3.cmml"><mi id="S2.SS1.p1.9.m9.1.1.3.1.3.2" xref="S2.SS1.p1.9.m9.1.1.3.1.3.2.cmml">k</mi><mo id="S2.SS1.p1.9.m9.1.1.3.1.3.1" xref="S2.SS1.p1.9.m9.1.1.3.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.9.m9.1.1.3.1.3.3" xref="S2.SS1.p1.9.m9.1.1.3.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.9.m9.1.1.3.1.2.3" xref="S2.SS1.p1.9.m9.1.1.3.1.2.3.cmml">K</mi></msubsup><msub id="S2.SS1.p1.9.m9.1.1.3.2" xref="S2.SS1.p1.9.m9.1.1.3.2.cmml"><mi id="S2.SS1.p1.9.m9.1.1.3.2.2" xref="S2.SS1.p1.9.m9.1.1.3.2.2.cmml">n</mi><mi id="S2.SS1.p1.9.m9.1.1.3.2.3" xref="S2.SS1.p1.9.m9.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><apply id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1"><eq id="S2.SS1.p1.9.m9.1.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.1"></eq><ci id="S2.SS1.p1.9.m9.1.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.2">𝑁</ci><apply id="S2.SS1.p1.9.m9.1.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3"><apply id="S2.SS1.p1.9.m9.1.1.3.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.3.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1">subscript</csymbol><apply id="S2.SS1.p1.9.m9.1.1.3.1.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.3.1.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1">superscript</csymbol><sum id="S2.SS1.p1.9.m9.1.1.3.1.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1.2.2"></sum><ci id="S2.SS1.p1.9.m9.1.1.3.1.2.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1.2.3">𝐾</ci></apply><apply id="S2.SS1.p1.9.m9.1.1.3.1.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1.3"><eq id="S2.SS1.p1.9.m9.1.1.3.1.3.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1.3.1"></eq><ci id="S2.SS1.p1.9.m9.1.1.3.1.3.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1.3.2">𝑘</ci><cn type="integer" id="S2.SS1.p1.9.m9.1.1.3.1.3.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.1.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.9.m9.1.1.3.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.1.1.3.2.1.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.1.1.3.2.2.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2.2">𝑛</ci><ci id="S2.SS1.p1.9.m9.1.1.3.2.3.cmml" xref="S2.SS1.p1.9.m9.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">N=\sum^{K}_{k=1}n_{k}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">PartialFL follows a structure similar to regular FL but with one key modification: we maintain additional models on both the server and edge devices trained entirely on the shareable modality. We further augment model training by using cross device and cross-modality contrastive loss objectives. These are described in more detail below.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Learning Components</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.4" class="ltx_p">Given the multi-modal setting described in the last section, the PartialFL framework consists of three model components as shown in Figure <a href="#S2.F1" title="Figure 1 ‣ 2 Approach ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>: the server model <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{s}(\cdot)" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.2" xref="S2.SS2.p1.1.m1.1.2.cmml"><msub id="S2.SS2.p1.1.m1.1.2.2" xref="S2.SS2.p1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.2.2.2" xref="S2.SS2.p1.1.m1.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p1.1.m1.1.2.2.3" xref="S2.SS2.p1.1.m1.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.2.1" xref="S2.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.1.m1.1.2.3.2" xref="S2.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.1.m1.1.2.3.2.1" xref="S2.SS2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p1.1.m1.1.2.3.2.2" xref="S2.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.2"><times id="S2.SS2.p1.1.m1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.2.1"></times><apply id="S2.SS2.p1.1.m1.1.2.2.cmml" xref="S2.SS2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.2.2.1.cmml" xref="S2.SS2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.2.2.2.cmml" xref="S2.SS2.p1.1.m1.1.2.2.2">ℱ</ci><ci id="S2.SS2.p1.1.m1.1.2.2.3.cmml" xref="S2.SS2.p1.1.m1.1.2.2.3">𝑠</ci></apply><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\mathcal{F}_{s}(\cdot)</annotation></semantics></math>, the global model <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{F}_{g}(\cdot)" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.2" xref="S2.SS2.p1.2.m2.1.2.cmml"><msub id="S2.SS2.p1.2.m2.1.2.2" xref="S2.SS2.p1.2.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.2.2.2" xref="S2.SS2.p1.2.m2.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p1.2.m2.1.2.2.3" xref="S2.SS2.p1.2.m2.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.2.m2.1.2.1" xref="S2.SS2.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.2.m2.1.2.3.2" xref="S2.SS2.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.2.m2.1.2.3.2.1" xref="S2.SS2.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p1.2.m2.1.2.3.2.2" xref="S2.SS2.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.2.cmml" xref="S2.SS2.p1.2.m2.1.2"><times id="S2.SS2.p1.2.m2.1.2.1.cmml" xref="S2.SS2.p1.2.m2.1.2.1"></times><apply id="S2.SS2.p1.2.m2.1.2.2.cmml" xref="S2.SS2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.2.2.1.cmml" xref="S2.SS2.p1.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.2.2.2.cmml" xref="S2.SS2.p1.2.m2.1.2.2.2">ℱ</ci><ci id="S2.SS2.p1.2.m2.1.2.2.3.cmml" xref="S2.SS2.p1.2.m2.1.2.2.3">𝑔</ci></apply><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathcal{F}_{g}(\cdot)</annotation></semantics></math>, and the local models <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{F}_{k}(\cdot)" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mrow id="S2.SS2.p1.3.m3.1.2" xref="S2.SS2.p1.3.m3.1.2.cmml"><msub id="S2.SS2.p1.3.m3.1.2.2" xref="S2.SS2.p1.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.3.m3.1.2.2.2" xref="S2.SS2.p1.3.m3.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p1.3.m3.1.2.2.3" xref="S2.SS2.p1.3.m3.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m3.1.2.1" xref="S2.SS2.p1.3.m3.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.3.m3.1.2.3.2" xref="S2.SS2.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.3.m3.1.2.3.2.1" xref="S2.SS2.p1.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p1.3.m3.1.2.3.2.2" xref="S2.SS2.p1.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.2.cmml" xref="S2.SS2.p1.3.m3.1.2"><times id="S2.SS2.p1.3.m3.1.2.1.cmml" xref="S2.SS2.p1.3.m3.1.2.1"></times><apply id="S2.SS2.p1.3.m3.1.2.2.cmml" xref="S2.SS2.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.2.2.1.cmml" xref="S2.SS2.p1.3.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.3.m3.1.2.2.2.cmml" xref="S2.SS2.p1.3.m3.1.2.2.2">ℱ</ci><ci id="S2.SS2.p1.3.m3.1.2.2.3.cmml" xref="S2.SS2.p1.3.m3.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">\mathcal{F}_{k}(\cdot)</annotation></semantics></math> where <math id="S2.SS2.p1.4.m4.4" class="ltx_Math" alttext="k\in\{1,2,...,K\}" display="inline"><semantics id="S2.SS2.p1.4.m4.4a"><mrow id="S2.SS2.p1.4.m4.4.5" xref="S2.SS2.p1.4.m4.4.5.cmml"><mi id="S2.SS2.p1.4.m4.4.5.2" xref="S2.SS2.p1.4.m4.4.5.2.cmml">k</mi><mo id="S2.SS2.p1.4.m4.4.5.1" xref="S2.SS2.p1.4.m4.4.5.1.cmml">∈</mo><mrow id="S2.SS2.p1.4.m4.4.5.3.2" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml"><mo stretchy="false" id="S2.SS2.p1.4.m4.4.5.3.2.1" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">{</mo><mn id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">1</mn><mo id="S2.SS2.p1.4.m4.4.5.3.2.2" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">,</mo><mn id="S2.SS2.p1.4.m4.2.2" xref="S2.SS2.p1.4.m4.2.2.cmml">2</mn><mo id="S2.SS2.p1.4.m4.4.5.3.2.3" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.4.m4.3.3" xref="S2.SS2.p1.4.m4.3.3.cmml">…</mi><mo id="S2.SS2.p1.4.m4.4.5.3.2.4" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">,</mo><mi id="S2.SS2.p1.4.m4.4.4" xref="S2.SS2.p1.4.m4.4.4.cmml">K</mi><mo stretchy="false" id="S2.SS2.p1.4.m4.4.5.3.2.5" xref="S2.SS2.p1.4.m4.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.4b"><apply id="S2.SS2.p1.4.m4.4.5.cmml" xref="S2.SS2.p1.4.m4.4.5"><in id="S2.SS2.p1.4.m4.4.5.1.cmml" xref="S2.SS2.p1.4.m4.4.5.1"></in><ci id="S2.SS2.p1.4.m4.4.5.2.cmml" xref="S2.SS2.p1.4.m4.4.5.2">𝑘</ci><set id="S2.SS2.p1.4.m4.4.5.3.1.cmml" xref="S2.SS2.p1.4.m4.4.5.3.2"><cn type="integer" id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">1</cn><cn type="integer" id="S2.SS2.p1.4.m4.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2">2</cn><ci id="S2.SS2.p1.4.m4.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3">…</ci><ci id="S2.SS2.p1.4.m4.4.4.cmml" xref="S2.SS2.p1.4.m4.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.4c">k\in\{1,2,...,K\}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.6" class="ltx_p"><span id="S2.SS2.p2.6.1" class="ltx_text ltx_font_bold">The server model</span> <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{s}(\cdot)" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><msub id="S2.SS2.p2.1.m1.1.2.2" xref="S2.SS2.p2.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.1.m1.1.2.2.2" xref="S2.SS2.p2.1.m1.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p2.1.m1.1.2.2.3" xref="S2.SS2.p2.1.m1.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.1.2.1" xref="S2.SS2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.1.m1.1.2.3.2" xref="S2.SS2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.1.m1.1.2.3.2.1" xref="S2.SS2.p2.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p2.1.m1.1.2.3.2.2" xref="S2.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.2"><times id="S2.SS2.p2.1.m1.1.2.1.cmml" xref="S2.SS2.p2.1.m1.1.2.1"></times><apply id="S2.SS2.p2.1.m1.1.2.2.cmml" xref="S2.SS2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.2.2.1.cmml" xref="S2.SS2.p2.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.2.2.2.cmml" xref="S2.SS2.p2.1.m1.1.2.2.2">ℱ</ci><ci id="S2.SS2.p2.1.m1.1.2.2.3.cmml" xref="S2.SS2.p2.1.m1.1.2.2.3">𝑠</ci></apply><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\mathcal{F}_{s}(\cdot)</annotation></semantics></math> exists in the server as an encoder which is trained on the shareable data (<math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{X_{T}}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">𝐗</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝐗</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathbf{X_{T}}</annotation></semantics></math>) to generate embeddings. In our example, we define the server-side textual embedding as <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><msub id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝐳</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\mathbf{z_{T}}</annotation></semantics></math>. Since we do not have training labels at the server to train a classifier, the learning objective of <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{F}_{s}(\cdot)" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.2" xref="S2.SS2.p2.4.m4.1.2.cmml"><msub id="S2.SS2.p2.4.m4.1.2.2" xref="S2.SS2.p2.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m4.1.2.2.2" xref="S2.SS2.p2.4.m4.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p2.4.m4.1.2.2.3" xref="S2.SS2.p2.4.m4.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m4.1.2.1" xref="S2.SS2.p2.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.4.m4.1.2.3.2" xref="S2.SS2.p2.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.4.m4.1.2.3.2.1" xref="S2.SS2.p2.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p2.4.m4.1.2.3.2.2" xref="S2.SS2.p2.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.2.cmml" xref="S2.SS2.p2.4.m4.1.2"><times id="S2.SS2.p2.4.m4.1.2.1.cmml" xref="S2.SS2.p2.4.m4.1.2.1"></times><apply id="S2.SS2.p2.4.m4.1.2.2.cmml" xref="S2.SS2.p2.4.m4.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.2.2.1.cmml" xref="S2.SS2.p2.4.m4.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.2.2.2.cmml" xref="S2.SS2.p2.4.m4.1.2.2.2">ℱ</ci><ci id="S2.SS2.p2.4.m4.1.2.2.3.cmml" xref="S2.SS2.p2.4.m4.1.2.2.3">𝑠</ci></apply><ci id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathcal{F}_{s}(\cdot)</annotation></semantics></math> is to reduce the distance between the server generated textual embedding <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><msub id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝐳</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">\mathbf{z_{T}}</annotation></semantics></math> with the local textual embedding <math id="S2.SS2.p2.6.m6.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="S2.SS2.p2.6.m6.1a"><msubsup id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.2.2" xref="S2.SS2.p2.6.m6.1.1.2.2.cmml">𝐳</mi><mi id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">𝐓</mi><mo id="S2.SS2.p2.6.m6.1.1.2.3" xref="S2.SS2.p2.6.m6.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">subscript</csymbol><apply id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.2.1.cmml" xref="S2.SS2.p2.6.m6.1.1">superscript</csymbol><ci id="S2.SS2.p2.6.m6.1.1.2.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2.2">𝐳</ci><ci id="S2.SS2.p2.6.m6.1.1.2.3.cmml" xref="S2.SS2.p2.6.m6.1.1.2.3">′</ci></apply><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.5" class="ltx_p"><span id="S2.SS2.p3.5.1" class="ltx_text ltx_font_bold">The global model</span> <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{g}(\cdot)" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><msub id="S2.SS2.p3.1.m1.1.2.2" xref="S2.SS2.p3.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.1.m1.1.2.2.2" xref="S2.SS2.p3.1.m1.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p3.1.m1.1.2.2.3" xref="S2.SS2.p3.1.m1.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.1.m1.1.2.1" xref="S2.SS2.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.1.m1.1.2.3.2" xref="S2.SS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.1.m1.1.2.3.2.1" xref="S2.SS2.p3.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p3.1.m1.1.2.3.2.2" xref="S2.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.2"><times id="S2.SS2.p3.1.m1.1.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2.1"></times><apply id="S2.SS2.p3.1.m1.1.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.2.2.1.cmml" xref="S2.SS2.p3.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.2.2.2.cmml" xref="S2.SS2.p3.1.m1.1.2.2.2">ℱ</ci><ci id="S2.SS2.p3.1.m1.1.2.2.3.cmml" xref="S2.SS2.p3.1.m1.1.2.2.3">𝑔</ci></apply><ci id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">\mathcal{F}_{g}(\cdot)</annotation></semantics></math> is a typical FL model and is trained in a distributed manner on the non-shareable data on edge, followed by a global aggregation in the server using typical FL algorithms, like FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> or FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
The global model can be either audio only or a multi-modal global model. The objective is to learn <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{F}_{g}(\cdot)" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mrow id="S2.SS2.p3.2.m2.1.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><msub id="S2.SS2.p3.2.m2.1.2.2" xref="S2.SS2.p3.2.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.2.m2.1.2.2.2" xref="S2.SS2.p3.2.m2.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p3.2.m2.1.2.2.3" xref="S2.SS2.p3.2.m2.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.1.2.1" xref="S2.SS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.p3.2.m2.1.2.3.2" xref="S2.SS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p3.2.m2.1.2.3.2.1" xref="S2.SS2.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p3.2.m2.1.2.3.2.2" xref="S2.SS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><apply id="S2.SS2.p3.2.m2.1.2.cmml" xref="S2.SS2.p3.2.m2.1.2"><times id="S2.SS2.p3.2.m2.1.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.1"></times><apply id="S2.SS2.p3.2.m2.1.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.1.2.2.1.cmml" xref="S2.SS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.p3.2.m2.1.2.2.2.cmml" xref="S2.SS2.p3.2.m2.1.2.2.2">ℱ</ci><ci id="S2.SS2.p3.2.m2.1.2.2.3.cmml" xref="S2.SS2.p3.2.m2.1.2.2.3">𝑔</ci></apply><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">\mathcal{F}_{g}(\cdot)</annotation></semantics></math> parameterized by <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{\theta}_{g}" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><msub id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2" xref="S2.SS2.p3.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS2.p3.3.m3.1.1.3" xref="S2.SS2.p3.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2">𝜃</ci><ci id="S2.SS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">\mathcal{\theta}_{g}</annotation></semantics></math> over the data set <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">\mathcal{D}</annotation></semantics></math> without accessing <math id="S2.SS2.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{X_{A}}" display="inline"><semantics id="S2.SS2.p3.5.m5.1a"><msub id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml"><mi id="S2.SS2.p3.5.m5.1.1.2" xref="S2.SS2.p3.5.m5.1.1.2.cmml">𝐗</mi><mi id="S2.SS2.p3.5.m5.1.1.3" xref="S2.SS2.p3.5.m5.1.1.3.cmml">𝐀</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><apply id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.1.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p3.5.m5.1.1.2.cmml" xref="S2.SS2.p3.5.m5.1.1.2">𝐗</ci><ci id="S2.SS2.p3.5.m5.1.1.3.cmml" xref="S2.SS2.p3.5.m5.1.1.3">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">\mathbf{X_{A}}</annotation></semantics></math> from edge devices. Since not every edge device may have every modality, training the global model can further help those devices with missing modalities.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.3" class="ltx_p">Further, since the edge-side training of this model can suffer from gradient drifts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, we add a cross-modal alignment objective to decrease the distance between the audio embedding <math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{z_{A}}" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><msub id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mi id="S2.SS2.p4.1.m1.1.1.2" xref="S2.SS2.p4.1.m1.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p4.1.m1.1.1.3" xref="S2.SS2.p4.1.m1.1.1.3.cmml">𝐀</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2">𝐳</ci><ci id="S2.SS2.p4.1.m1.1.1.3.cmml" xref="S2.SS2.p4.1.m1.1.1.3">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">\mathbf{z_{A}}</annotation></semantics></math> (or multi-modal embedding <math id="S2.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{z_{M}}" display="inline"><semantics id="S2.SS2.p4.2.m2.1a"><msub id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml"><mi id="S2.SS2.p4.2.m2.1.1.2" xref="S2.SS2.p4.2.m2.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p4.2.m2.1.1.3" xref="S2.SS2.p4.2.m2.1.1.3.cmml">𝐌</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><apply id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.2">𝐳</ci><ci id="S2.SS2.p4.2.m2.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.3">𝐌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">\mathbf{z_{M}}</annotation></semantics></math>) and <math id="S2.SS2.p4.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS2.p4.3.m3.1a"><msub id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml"><mi id="S2.SS2.p4.3.m3.1.1.2" xref="S2.SS2.p4.3.m3.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p4.3.m3.1.1.3" xref="S2.SS2.p4.3.m3.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><apply id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2">𝐳</ci><ci id="S2.SS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">\mathbf{z_{T}}</annotation></semantics></math>. This idea is similar to the model contrastive loss presented in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.</p>
</div>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS2.p5.10" class="ltx_p"><span id="S2.SS2.p5.10.1" class="ltx_text ltx_font_bold">The local model</span> <math id="S2.SS2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{k}(\cdot)" display="inline"><semantics id="S2.SS2.p5.1.m1.1a"><mrow id="S2.SS2.p5.1.m1.1.2" xref="S2.SS2.p5.1.m1.1.2.cmml"><msub id="S2.SS2.p5.1.m1.1.2.2" xref="S2.SS2.p5.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.1.m1.1.2.2.2" xref="S2.SS2.p5.1.m1.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p5.1.m1.1.2.2.3" xref="S2.SS2.p5.1.m1.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.1.m1.1.2.1" xref="S2.SS2.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.p5.1.m1.1.2.3.2" xref="S2.SS2.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.1.m1.1.2.3.2.1" xref="S2.SS2.p5.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p5.1.m1.1.1" xref="S2.SS2.p5.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p5.1.m1.1.2.3.2.2" xref="S2.SS2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.1.m1.1b"><apply id="S2.SS2.p5.1.m1.1.2.cmml" xref="S2.SS2.p5.1.m1.1.2"><times id="S2.SS2.p5.1.m1.1.2.1.cmml" xref="S2.SS2.p5.1.m1.1.2.1"></times><apply id="S2.SS2.p5.1.m1.1.2.2.cmml" xref="S2.SS2.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.1.m1.1.2.2.1.cmml" xref="S2.SS2.p5.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.1.m1.1.2.2.2.cmml" xref="S2.SS2.p5.1.m1.1.2.2.2">ℱ</ci><ci id="S2.SS2.p5.1.m1.1.2.2.3.cmml" xref="S2.SS2.p5.1.m1.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p5.1.m1.1.1.cmml" xref="S2.SS2.p5.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.1.m1.1c">\mathcal{F}_{k}(\cdot)</annotation></semantics></math> is only available in the <math id="S2.SS2.p5.2.m2.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S2.SS2.p5.2.m2.1a"><msup id="S2.SS2.p5.2.m2.1.1" xref="S2.SS2.p5.2.m2.1.1.cmml"><mi id="S2.SS2.p5.2.m2.1.1.2" xref="S2.SS2.p5.2.m2.1.1.2.cmml">k</mi><mrow id="S2.SS2.p5.2.m2.1.1.3" xref="S2.SS2.p5.2.m2.1.1.3.cmml"><mi id="S2.SS2.p5.2.m2.1.1.3.2" xref="S2.SS2.p5.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p5.2.m2.1.1.3.1" xref="S2.SS2.p5.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p5.2.m2.1.1.3.3" xref="S2.SS2.p5.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.2.m2.1b"><apply id="S2.SS2.p5.2.m2.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.2.m2.1.1.1.cmml" xref="S2.SS2.p5.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p5.2.m2.1.1.2.cmml" xref="S2.SS2.p5.2.m2.1.1.2">𝑘</ci><apply id="S2.SS2.p5.2.m2.1.1.3.cmml" xref="S2.SS2.p5.2.m2.1.1.3"><times id="S2.SS2.p5.2.m2.1.1.3.1.cmml" xref="S2.SS2.p5.2.m2.1.1.3.1"></times><ci id="S2.SS2.p5.2.m2.1.1.3.2.cmml" xref="S2.SS2.p5.2.m2.1.1.3.2">𝑡</ci><ci id="S2.SS2.p5.2.m2.1.1.3.3.cmml" xref="S2.SS2.p5.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.2.m2.1c">k^{th}</annotation></semantics></math> edge device. Unlike the server model <math id="S2.SS2.p5.3.m3.1" class="ltx_Math" alttext="\mathcal{F}_{s}(\cdot)" display="inline"><semantics id="S2.SS2.p5.3.m3.1a"><mrow id="S2.SS2.p5.3.m3.1.2" xref="S2.SS2.p5.3.m3.1.2.cmml"><msub id="S2.SS2.p5.3.m3.1.2.2" xref="S2.SS2.p5.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.3.m3.1.2.2.2" xref="S2.SS2.p5.3.m3.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p5.3.m3.1.2.2.3" xref="S2.SS2.p5.3.m3.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.3.m3.1.2.1" xref="S2.SS2.p5.3.m3.1.2.1.cmml">​</mo><mrow id="S2.SS2.p5.3.m3.1.2.3.2" xref="S2.SS2.p5.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.3.m3.1.2.3.2.1" xref="S2.SS2.p5.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p5.3.m3.1.1" xref="S2.SS2.p5.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p5.3.m3.1.2.3.2.2" xref="S2.SS2.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.3.m3.1b"><apply id="S2.SS2.p5.3.m3.1.2.cmml" xref="S2.SS2.p5.3.m3.1.2"><times id="S2.SS2.p5.3.m3.1.2.1.cmml" xref="S2.SS2.p5.3.m3.1.2.1"></times><apply id="S2.SS2.p5.3.m3.1.2.2.cmml" xref="S2.SS2.p5.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.3.m3.1.2.2.1.cmml" xref="S2.SS2.p5.3.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.3.m3.1.2.2.2.cmml" xref="S2.SS2.p5.3.m3.1.2.2.2">ℱ</ci><ci id="S2.SS2.p5.3.m3.1.2.2.3.cmml" xref="S2.SS2.p5.3.m3.1.2.2.3">𝑠</ci></apply><ci id="S2.SS2.p5.3.m3.1.1.cmml" xref="S2.SS2.p5.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.3.m3.1c">\mathcal{F}_{s}(\cdot)</annotation></semantics></math>, here we have access to data labels so the local model includes a classifier trained using cross-entropy loss over the text modality. Note that the full <math id="S2.SS2.p5.4.m4.1" class="ltx_Math" alttext="\mathcal{F}_{k}(\cdot)" display="inline"><semantics id="S2.SS2.p5.4.m4.1a"><mrow id="S2.SS2.p5.4.m4.1.2" xref="S2.SS2.p5.4.m4.1.2.cmml"><msub id="S2.SS2.p5.4.m4.1.2.2" xref="S2.SS2.p5.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.4.m4.1.2.2.2" xref="S2.SS2.p5.4.m4.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p5.4.m4.1.2.2.3" xref="S2.SS2.p5.4.m4.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.4.m4.1.2.1" xref="S2.SS2.p5.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS2.p5.4.m4.1.2.3.2" xref="S2.SS2.p5.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.4.m4.1.2.3.2.1" xref="S2.SS2.p5.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p5.4.m4.1.1" xref="S2.SS2.p5.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p5.4.m4.1.2.3.2.2" xref="S2.SS2.p5.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.4.m4.1b"><apply id="S2.SS2.p5.4.m4.1.2.cmml" xref="S2.SS2.p5.4.m4.1.2"><times id="S2.SS2.p5.4.m4.1.2.1.cmml" xref="S2.SS2.p5.4.m4.1.2.1"></times><apply id="S2.SS2.p5.4.m4.1.2.2.cmml" xref="S2.SS2.p5.4.m4.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.4.m4.1.2.2.1.cmml" xref="S2.SS2.p5.4.m4.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.4.m4.1.2.2.2.cmml" xref="S2.SS2.p5.4.m4.1.2.2.2">ℱ</ci><ci id="S2.SS2.p5.4.m4.1.2.2.3.cmml" xref="S2.SS2.p5.4.m4.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p5.4.m4.1.1.cmml" xref="S2.SS2.p5.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.4.m4.1c">\mathcal{F}_{k}(\cdot)</annotation></semantics></math> is not shareable since the server would then be able to infer local labels using <math id="S2.SS2.p5.5.m5.1" class="ltx_Math" alttext="\mathcal{F}_{k}(\cdot)" display="inline"><semantics id="S2.SS2.p5.5.m5.1a"><mrow id="S2.SS2.p5.5.m5.1.2" xref="S2.SS2.p5.5.m5.1.2.cmml"><msub id="S2.SS2.p5.5.m5.1.2.2" xref="S2.SS2.p5.5.m5.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.5.m5.1.2.2.2" xref="S2.SS2.p5.5.m5.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p5.5.m5.1.2.2.3" xref="S2.SS2.p5.5.m5.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.m5.1.2.1" xref="S2.SS2.p5.5.m5.1.2.1.cmml">​</mo><mrow id="S2.SS2.p5.5.m5.1.2.3.2" xref="S2.SS2.p5.5.m5.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.5.m5.1.2.3.2.1" xref="S2.SS2.p5.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p5.5.m5.1.1" xref="S2.SS2.p5.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p5.5.m5.1.2.3.2.2" xref="S2.SS2.p5.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.5.m5.1b"><apply id="S2.SS2.p5.5.m5.1.2.cmml" xref="S2.SS2.p5.5.m5.1.2"><times id="S2.SS2.p5.5.m5.1.2.1.cmml" xref="S2.SS2.p5.5.m5.1.2.1"></times><apply id="S2.SS2.p5.5.m5.1.2.2.cmml" xref="S2.SS2.p5.5.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.5.m5.1.2.2.1.cmml" xref="S2.SS2.p5.5.m5.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.5.m5.1.2.2.2.cmml" xref="S2.SS2.p5.5.m5.1.2.2.2">ℱ</ci><ci id="S2.SS2.p5.5.m5.1.2.2.3.cmml" xref="S2.SS2.p5.5.m5.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p5.5.m5.1.1.cmml" xref="S2.SS2.p5.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.5.m5.1c">\mathcal{F}_{k}(\cdot)</annotation></semantics></math> as <math id="S2.SS2.p5.6.m6.1" class="ltx_Math" alttext="\mathbf{X_{T}}" display="inline"><semantics id="S2.SS2.p5.6.m6.1a"><msub id="S2.SS2.p5.6.m6.1.1" xref="S2.SS2.p5.6.m6.1.1.cmml"><mi id="S2.SS2.p5.6.m6.1.1.2" xref="S2.SS2.p5.6.m6.1.1.2.cmml">𝐗</mi><mi id="S2.SS2.p5.6.m6.1.1.3" xref="S2.SS2.p5.6.m6.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.6.m6.1b"><apply id="S2.SS2.p5.6.m6.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.6.m6.1.1.1.cmml" xref="S2.SS2.p5.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p5.6.m6.1.1.2.cmml" xref="S2.SS2.p5.6.m6.1.1.2">𝐗</ci><ci id="S2.SS2.p5.6.m6.1.1.3.cmml" xref="S2.SS2.p5.6.m6.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.6.m6.1c">\mathbf{X_{T}}</annotation></semantics></math> is already uploaded to the server. Instead, the edge device only sends the local textual embeddings <math id="S2.SS2.p5.7.m7.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="S2.SS2.p5.7.m7.1a"><msubsup id="S2.SS2.p5.7.m7.1.1" xref="S2.SS2.p5.7.m7.1.1.cmml"><mi id="S2.SS2.p5.7.m7.1.1.2.2" xref="S2.SS2.p5.7.m7.1.1.2.2.cmml">𝐳</mi><mi id="S2.SS2.p5.7.m7.1.1.3" xref="S2.SS2.p5.7.m7.1.1.3.cmml">𝐓</mi><mo id="S2.SS2.p5.7.m7.1.1.2.3" xref="S2.SS2.p5.7.m7.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.7.m7.1b"><apply id="S2.SS2.p5.7.m7.1.1.cmml" xref="S2.SS2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.1.1.1.cmml" xref="S2.SS2.p5.7.m7.1.1">subscript</csymbol><apply id="S2.SS2.p5.7.m7.1.1.2.cmml" xref="S2.SS2.p5.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.7.m7.1.1.2.1.cmml" xref="S2.SS2.p5.7.m7.1.1">superscript</csymbol><ci id="S2.SS2.p5.7.m7.1.1.2.2.cmml" xref="S2.SS2.p5.7.m7.1.1.2.2">𝐳</ci><ci id="S2.SS2.p5.7.m7.1.1.2.3.cmml" xref="S2.SS2.p5.7.m7.1.1.2.3">′</ci></apply><ci id="S2.SS2.p5.7.m7.1.1.3.cmml" xref="S2.SS2.p5.7.m7.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.7.m7.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math> generated from the encoder layer of <math id="S2.SS2.p5.8.m8.1" class="ltx_Math" alttext="\mathcal{F}_{k}(\cdot)" display="inline"><semantics id="S2.SS2.p5.8.m8.1a"><mrow id="S2.SS2.p5.8.m8.1.2" xref="S2.SS2.p5.8.m8.1.2.cmml"><msub id="S2.SS2.p5.8.m8.1.2.2" xref="S2.SS2.p5.8.m8.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p5.8.m8.1.2.2.2" xref="S2.SS2.p5.8.m8.1.2.2.2.cmml">ℱ</mi><mi id="S2.SS2.p5.8.m8.1.2.2.3" xref="S2.SS2.p5.8.m8.1.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p5.8.m8.1.2.1" xref="S2.SS2.p5.8.m8.1.2.1.cmml">​</mo><mrow id="S2.SS2.p5.8.m8.1.2.3.2" xref="S2.SS2.p5.8.m8.1.2.cmml"><mo stretchy="false" id="S2.SS2.p5.8.m8.1.2.3.2.1" xref="S2.SS2.p5.8.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p5.8.m8.1.1" xref="S2.SS2.p5.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.p5.8.m8.1.2.3.2.2" xref="S2.SS2.p5.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.8.m8.1b"><apply id="S2.SS2.p5.8.m8.1.2.cmml" xref="S2.SS2.p5.8.m8.1.2"><times id="S2.SS2.p5.8.m8.1.2.1.cmml" xref="S2.SS2.p5.8.m8.1.2.1"></times><apply id="S2.SS2.p5.8.m8.1.2.2.cmml" xref="S2.SS2.p5.8.m8.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p5.8.m8.1.2.2.1.cmml" xref="S2.SS2.p5.8.m8.1.2.2">subscript</csymbol><ci id="S2.SS2.p5.8.m8.1.2.2.2.cmml" xref="S2.SS2.p5.8.m8.1.2.2.2">ℱ</ci><ci id="S2.SS2.p5.8.m8.1.2.2.3.cmml" xref="S2.SS2.p5.8.m8.1.2.2.3">𝑘</ci></apply><ci id="S2.SS2.p5.8.m8.1.1.cmml" xref="S2.SS2.p5.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.8.m8.1c">\mathcal{F}_{k}(\cdot)</annotation></semantics></math>. Similar to training the global model, over-fitting can occur easily while training this model, so we add an embedding alignment loss to minimize the distance between the local embeddings <math id="S2.SS2.p5.9.m9.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="S2.SS2.p5.9.m9.1a"><msubsup id="S2.SS2.p5.9.m9.1.1" xref="S2.SS2.p5.9.m9.1.1.cmml"><mi id="S2.SS2.p5.9.m9.1.1.2.2" xref="S2.SS2.p5.9.m9.1.1.2.2.cmml">𝐳</mi><mi id="S2.SS2.p5.9.m9.1.1.3" xref="S2.SS2.p5.9.m9.1.1.3.cmml">𝐓</mi><mo id="S2.SS2.p5.9.m9.1.1.2.3" xref="S2.SS2.p5.9.m9.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.9.m9.1b"><apply id="S2.SS2.p5.9.m9.1.1.cmml" xref="S2.SS2.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.9.m9.1.1.1.cmml" xref="S2.SS2.p5.9.m9.1.1">subscript</csymbol><apply id="S2.SS2.p5.9.m9.1.1.2.cmml" xref="S2.SS2.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.9.m9.1.1.2.1.cmml" xref="S2.SS2.p5.9.m9.1.1">superscript</csymbol><ci id="S2.SS2.p5.9.m9.1.1.2.2.cmml" xref="S2.SS2.p5.9.m9.1.1.2.2">𝐳</ci><ci id="S2.SS2.p5.9.m9.1.1.2.3.cmml" xref="S2.SS2.p5.9.m9.1.1.2.3">′</ci></apply><ci id="S2.SS2.p5.9.m9.1.1.3.cmml" xref="S2.SS2.p5.9.m9.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.9.m9.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math> from the server generated embeddings <math id="S2.SS2.p5.10.m10.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS2.p5.10.m10.1a"><msub id="S2.SS2.p5.10.m10.1.1" xref="S2.SS2.p5.10.m10.1.1.cmml"><mi id="S2.SS2.p5.10.m10.1.1.2" xref="S2.SS2.p5.10.m10.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p5.10.m10.1.1.3" xref="S2.SS2.p5.10.m10.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p5.10.m10.1b"><apply id="S2.SS2.p5.10.m10.1.1.cmml" xref="S2.SS2.p5.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p5.10.m10.1.1.1.cmml" xref="S2.SS2.p5.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.p5.10.m10.1.1.2.cmml" xref="S2.SS2.p5.10.m10.1.1.2">𝐳</ci><ci id="S2.SS2.p5.10.m10.1.1.3.cmml" xref="S2.SS2.p5.10.m10.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p5.10.m10.1c">\mathbf{z_{T}}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p id="S2.SS2.p6.3" class="ltx_p">The key intuition behind PartialFL is that by iteratively aligning server side representations of the shared text modality (<math id="S2.SS2.p6.1.m1.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS2.p6.1.m1.1a"><msub id="S2.SS2.p6.1.m1.1.1" xref="S2.SS2.p6.1.m1.1.1.cmml"><mi id="S2.SS2.p6.1.m1.1.1.2" xref="S2.SS2.p6.1.m1.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p6.1.m1.1.1.3" xref="S2.SS2.p6.1.m1.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.m1.1b"><apply id="S2.SS2.p6.1.m1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.1.m1.1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p6.1.m1.1.1.2.cmml" xref="S2.SS2.p6.1.m1.1.1.2">𝐳</ci><ci id="S2.SS2.p6.1.m1.1.1.3.cmml" xref="S2.SS2.p6.1.m1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.m1.1c">\mathbf{z_{T}}</annotation></semantics></math>) with different client side representations <math id="S2.SS2.p6.2.m2.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="S2.SS2.p6.2.m2.1a"><msubsup id="S2.SS2.p6.2.m2.1.1" xref="S2.SS2.p6.2.m2.1.1.cmml"><mi id="S2.SS2.p6.2.m2.1.1.2.2" xref="S2.SS2.p6.2.m2.1.1.2.2.cmml">𝐳</mi><mi id="S2.SS2.p6.2.m2.1.1.3" xref="S2.SS2.p6.2.m2.1.1.3.cmml">𝐓</mi><mo id="S2.SS2.p6.2.m2.1.1.2.3" xref="S2.SS2.p6.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.2.m2.1b"><apply id="S2.SS2.p6.2.m2.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.1.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1">subscript</csymbol><apply id="S2.SS2.p6.2.m2.1.1.2.cmml" xref="S2.SS2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.2.m2.1.1.2.1.cmml" xref="S2.SS2.p6.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p6.2.m2.1.1.2.2.cmml" xref="S2.SS2.p6.2.m2.1.1.2.2">𝐳</ci><ci id="S2.SS2.p6.2.m2.1.1.2.3.cmml" xref="S2.SS2.p6.2.m2.1.1.2.3">′</ci></apply><ci id="S2.SS2.p6.2.m2.1.1.3.cmml" xref="S2.SS2.p6.2.m2.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.2.m2.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math> on the server, and by aligning the edge side text and audio representations with the realigned <math id="S2.SS2.p6.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS2.p6.3.m3.1a"><msub id="S2.SS2.p6.3.m3.1.1" xref="S2.SS2.p6.3.m3.1.1.cmml"><mi id="S2.SS2.p6.3.m3.1.1.2" xref="S2.SS2.p6.3.m3.1.1.2.cmml">𝐳</mi><mi id="S2.SS2.p6.3.m3.1.1.3" xref="S2.SS2.p6.3.m3.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.3.m3.1b"><apply id="S2.SS2.p6.3.m3.1.1.cmml" xref="S2.SS2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p6.3.m3.1.1.1.cmml" xref="S2.SS2.p6.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p6.3.m3.1.1.2.cmml" xref="S2.SS2.p6.3.m3.1.1.2">𝐳</ci><ci id="S2.SS2.p6.3.m3.1.1.3.cmml" xref="S2.SS2.p6.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.3.m3.1c">\mathbf{z_{T}}</annotation></semantics></math>, we are improving model robustness to extreme data heterogeneity.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Cross-modal Alignment</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.3" class="ltx_p">Cross-modal alignment is a popular learning task when working with multiple modalities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. This learning task focuses on aligning embeddings of the same instance across the different modalities. More concretely, we compute modality specific representations denoted as <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{z_{A}}" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">𝐳</mi><mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">𝐀</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝐳</ci><ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\mathbf{z_{A}}</annotation></semantics></math>, <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">𝐳</mi><mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">𝐳</ci><ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">\mathbf{z_{T}}</annotation></semantics></math> and <math id="S2.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{M}}" display="inline"><semantics id="S2.SS3.p1.3.m3.1a"><msub id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.p1.3.m3.1.1.2" xref="S2.SS3.p1.3.m3.1.1.2.cmml">𝐳</mi><mi id="S2.SS3.p1.3.m3.1.1.3" xref="S2.SS3.p1.3.m3.1.1.3.cmml">𝐌</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><apply id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.p1.3.m3.1.1.2">𝐳</ci><ci id="S2.SS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.p1.3.m3.1.1.3">𝐌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">\mathbf{z_{M}}</annotation></semantics></math> for the audio embedding, text embedding and the multi-modal embedding respectively. Cross-modal alignment in PartialFL aims to push these embeddings close to each other if they belong to the same data sample, and increase the distance between them otherwise.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.10" class="ltx_p">Similar to previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, a <span id="S2.SS3.p2.10.1" class="ltx_text ltx_font_bold">positive pair</span> is defined as <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{z_{A}}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><msub id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">𝐳</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">𝐀</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝐳</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\mathbf{z_{A}}</annotation></semantics></math> (or <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="\mathbf{z_{M}}" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><msub id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">𝐳</mi><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">𝐌</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝐳</ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝐌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">\mathbf{z_{M}}</annotation></semantics></math>) and <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><msub id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">𝐳</mi><mi id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝐳</ci><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\mathbf{z_{T}}</annotation></semantics></math> from the same data sample. On the other hand, <span id="S2.SS3.p2.10.2" class="ltx_text ltx_font_bold">negative pairs</span> are constructed from different data samples. More precisely, we define <span id="S2.SS3.p2.10.3" class="ltx_text ltx_font_bold">intra-modal negative pairs</span> as the embeddings from the same modality but different data samples. For instance, <math id="S2.SS3.p2.4.m4.6" class="ltx_Math" alttext="(\mathbf{z}^{k}_{A,i},\mathbf{z}^{k}_{A,j})" display="inline"><semantics id="S2.SS3.p2.4.m4.6a"><mrow id="S2.SS3.p2.4.m4.6.6.2" xref="S2.SS3.p2.4.m4.6.6.3.cmml"><mo stretchy="false" id="S2.SS3.p2.4.m4.6.6.2.3" xref="S2.SS3.p2.4.m4.6.6.3.cmml">(</mo><msubsup id="S2.SS3.p2.4.m4.5.5.1.1" xref="S2.SS3.p2.4.m4.5.5.1.1.cmml"><mi id="S2.SS3.p2.4.m4.5.5.1.1.2.2" xref="S2.SS3.p2.4.m4.5.5.1.1.2.2.cmml">𝐳</mi><mrow id="S2.SS3.p2.4.m4.2.2.2.4" xref="S2.SS3.p2.4.m4.2.2.2.3.cmml"><mi id="S2.SS3.p2.4.m4.1.1.1.1" xref="S2.SS3.p2.4.m4.1.1.1.1.cmml">A</mi><mo id="S2.SS3.p2.4.m4.2.2.2.4.1" xref="S2.SS3.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p2.4.m4.2.2.2.2" xref="S2.SS3.p2.4.m4.2.2.2.2.cmml">i</mi></mrow><mi id="S2.SS3.p2.4.m4.5.5.1.1.2.3" xref="S2.SS3.p2.4.m4.5.5.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.SS3.p2.4.m4.6.6.2.4" xref="S2.SS3.p2.4.m4.6.6.3.cmml">,</mo><msubsup id="S2.SS3.p2.4.m4.6.6.2.2" xref="S2.SS3.p2.4.m4.6.6.2.2.cmml"><mi id="S2.SS3.p2.4.m4.6.6.2.2.2.2" xref="S2.SS3.p2.4.m4.6.6.2.2.2.2.cmml">𝐳</mi><mrow id="S2.SS3.p2.4.m4.4.4.2.4" xref="S2.SS3.p2.4.m4.4.4.2.3.cmml"><mi id="S2.SS3.p2.4.m4.3.3.1.1" xref="S2.SS3.p2.4.m4.3.3.1.1.cmml">A</mi><mo id="S2.SS3.p2.4.m4.4.4.2.4.1" xref="S2.SS3.p2.4.m4.4.4.2.3.cmml">,</mo><mi id="S2.SS3.p2.4.m4.4.4.2.2" xref="S2.SS3.p2.4.m4.4.4.2.2.cmml">j</mi></mrow><mi id="S2.SS3.p2.4.m4.6.6.2.2.2.3" xref="S2.SS3.p2.4.m4.6.6.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.SS3.p2.4.m4.6.6.2.5" xref="S2.SS3.p2.4.m4.6.6.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.6b"><interval closure="open" id="S2.SS3.p2.4.m4.6.6.3.cmml" xref="S2.SS3.p2.4.m4.6.6.2"><apply id="S2.SS3.p2.4.m4.5.5.1.1.cmml" xref="S2.SS3.p2.4.m4.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.5.5.1.1.1.cmml" xref="S2.SS3.p2.4.m4.5.5.1.1">subscript</csymbol><apply id="S2.SS3.p2.4.m4.5.5.1.1.2.cmml" xref="S2.SS3.p2.4.m4.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.5.5.1.1.2.1.cmml" xref="S2.SS3.p2.4.m4.5.5.1.1">superscript</csymbol><ci id="S2.SS3.p2.4.m4.5.5.1.1.2.2.cmml" xref="S2.SS3.p2.4.m4.5.5.1.1.2.2">𝐳</ci><ci id="S2.SS3.p2.4.m4.5.5.1.1.2.3.cmml" xref="S2.SS3.p2.4.m4.5.5.1.1.2.3">𝑘</ci></apply><list id="S2.SS3.p2.4.m4.2.2.2.3.cmml" xref="S2.SS3.p2.4.m4.2.2.2.4"><ci id="S2.SS3.p2.4.m4.1.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1.1.1">𝐴</ci><ci id="S2.SS3.p2.4.m4.2.2.2.2.cmml" xref="S2.SS3.p2.4.m4.2.2.2.2">𝑖</ci></list></apply><apply id="S2.SS3.p2.4.m4.6.6.2.2.cmml" xref="S2.SS3.p2.4.m4.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.6.6.2.2.1.cmml" xref="S2.SS3.p2.4.m4.6.6.2.2">subscript</csymbol><apply id="S2.SS3.p2.4.m4.6.6.2.2.2.cmml" xref="S2.SS3.p2.4.m4.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.6.6.2.2.2.1.cmml" xref="S2.SS3.p2.4.m4.6.6.2.2">superscript</csymbol><ci id="S2.SS3.p2.4.m4.6.6.2.2.2.2.cmml" xref="S2.SS3.p2.4.m4.6.6.2.2.2.2">𝐳</ci><ci id="S2.SS3.p2.4.m4.6.6.2.2.2.3.cmml" xref="S2.SS3.p2.4.m4.6.6.2.2.2.3">𝑘</ci></apply><list id="S2.SS3.p2.4.m4.4.4.2.3.cmml" xref="S2.SS3.p2.4.m4.4.4.2.4"><ci id="S2.SS3.p2.4.m4.3.3.1.1.cmml" xref="S2.SS3.p2.4.m4.3.3.1.1">𝐴</ci><ci id="S2.SS3.p2.4.m4.4.4.2.2.cmml" xref="S2.SS3.p2.4.m4.4.4.2.2">𝑗</ci></list></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.6c">(\mathbf{z}^{k}_{A,i},\mathbf{z}^{k}_{A,j})</annotation></semantics></math> is a negative pair if <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="i\neq j" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><mrow id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml">i</mi><mo id="S2.SS3.p2.5.m5.1.1.1" xref="S2.SS3.p2.5.m5.1.1.1.cmml">≠</mo><mi id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><neq id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1.1"></neq><ci id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2">𝑖</ci><ci id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">i\neq j</annotation></semantics></math>. Further, we define <span id="S2.SS3.p2.10.4" class="ltx_text ltx_font_bold">inter-modality negative pairs</span> as embeddings from different modalities <span id="S2.SS3.p2.10.5" class="ltx_text ltx_font_italic">and</span> data samples. An example of the inter-modality negative pair is <math id="S2.SS3.p2.6.m6.6" class="ltx_Math" alttext="(\mathbf{z}^{k}_{A,i},\mathbf{z}^{k}_{T,j})" display="inline"><semantics id="S2.SS3.p2.6.m6.6a"><mrow id="S2.SS3.p2.6.m6.6.6.2" xref="S2.SS3.p2.6.m6.6.6.3.cmml"><mo stretchy="false" id="S2.SS3.p2.6.m6.6.6.2.3" xref="S2.SS3.p2.6.m6.6.6.3.cmml">(</mo><msubsup id="S2.SS3.p2.6.m6.5.5.1.1" xref="S2.SS3.p2.6.m6.5.5.1.1.cmml"><mi id="S2.SS3.p2.6.m6.5.5.1.1.2.2" xref="S2.SS3.p2.6.m6.5.5.1.1.2.2.cmml">𝐳</mi><mrow id="S2.SS3.p2.6.m6.2.2.2.4" xref="S2.SS3.p2.6.m6.2.2.2.3.cmml"><mi id="S2.SS3.p2.6.m6.1.1.1.1" xref="S2.SS3.p2.6.m6.1.1.1.1.cmml">A</mi><mo id="S2.SS3.p2.6.m6.2.2.2.4.1" xref="S2.SS3.p2.6.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS3.p2.6.m6.2.2.2.2" xref="S2.SS3.p2.6.m6.2.2.2.2.cmml">i</mi></mrow><mi id="S2.SS3.p2.6.m6.5.5.1.1.2.3" xref="S2.SS3.p2.6.m6.5.5.1.1.2.3.cmml">k</mi></msubsup><mo id="S2.SS3.p2.6.m6.6.6.2.4" xref="S2.SS3.p2.6.m6.6.6.3.cmml">,</mo><msubsup id="S2.SS3.p2.6.m6.6.6.2.2" xref="S2.SS3.p2.6.m6.6.6.2.2.cmml"><mi id="S2.SS3.p2.6.m6.6.6.2.2.2.2" xref="S2.SS3.p2.6.m6.6.6.2.2.2.2.cmml">𝐳</mi><mrow id="S2.SS3.p2.6.m6.4.4.2.4" xref="S2.SS3.p2.6.m6.4.4.2.3.cmml"><mi id="S2.SS3.p2.6.m6.3.3.1.1" xref="S2.SS3.p2.6.m6.3.3.1.1.cmml">T</mi><mo id="S2.SS3.p2.6.m6.4.4.2.4.1" xref="S2.SS3.p2.6.m6.4.4.2.3.cmml">,</mo><mi id="S2.SS3.p2.6.m6.4.4.2.2" xref="S2.SS3.p2.6.m6.4.4.2.2.cmml">j</mi></mrow><mi id="S2.SS3.p2.6.m6.6.6.2.2.2.3" xref="S2.SS3.p2.6.m6.6.6.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.SS3.p2.6.m6.6.6.2.5" xref="S2.SS3.p2.6.m6.6.6.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.6b"><interval closure="open" id="S2.SS3.p2.6.m6.6.6.3.cmml" xref="S2.SS3.p2.6.m6.6.6.2"><apply id="S2.SS3.p2.6.m6.5.5.1.1.cmml" xref="S2.SS3.p2.6.m6.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.5.5.1.1.1.cmml" xref="S2.SS3.p2.6.m6.5.5.1.1">subscript</csymbol><apply id="S2.SS3.p2.6.m6.5.5.1.1.2.cmml" xref="S2.SS3.p2.6.m6.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.5.5.1.1.2.1.cmml" xref="S2.SS3.p2.6.m6.5.5.1.1">superscript</csymbol><ci id="S2.SS3.p2.6.m6.5.5.1.1.2.2.cmml" xref="S2.SS3.p2.6.m6.5.5.1.1.2.2">𝐳</ci><ci id="S2.SS3.p2.6.m6.5.5.1.1.2.3.cmml" xref="S2.SS3.p2.6.m6.5.5.1.1.2.3">𝑘</ci></apply><list id="S2.SS3.p2.6.m6.2.2.2.3.cmml" xref="S2.SS3.p2.6.m6.2.2.2.4"><ci id="S2.SS3.p2.6.m6.1.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1.1.1">𝐴</ci><ci id="S2.SS3.p2.6.m6.2.2.2.2.cmml" xref="S2.SS3.p2.6.m6.2.2.2.2">𝑖</ci></list></apply><apply id="S2.SS3.p2.6.m6.6.6.2.2.cmml" xref="S2.SS3.p2.6.m6.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.6.6.2.2.1.cmml" xref="S2.SS3.p2.6.m6.6.6.2.2">subscript</csymbol><apply id="S2.SS3.p2.6.m6.6.6.2.2.2.cmml" xref="S2.SS3.p2.6.m6.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.6.6.2.2.2.1.cmml" xref="S2.SS3.p2.6.m6.6.6.2.2">superscript</csymbol><ci id="S2.SS3.p2.6.m6.6.6.2.2.2.2.cmml" xref="S2.SS3.p2.6.m6.6.6.2.2.2.2">𝐳</ci><ci id="S2.SS3.p2.6.m6.6.6.2.2.2.3.cmml" xref="S2.SS3.p2.6.m6.6.6.2.2.2.3">𝑘</ci></apply><list id="S2.SS3.p2.6.m6.4.4.2.3.cmml" xref="S2.SS3.p2.6.m6.4.4.2.4"><ci id="S2.SS3.p2.6.m6.3.3.1.1.cmml" xref="S2.SS3.p2.6.m6.3.3.1.1">𝑇</ci><ci id="S2.SS3.p2.6.m6.4.4.2.2.cmml" xref="S2.SS3.p2.6.m6.4.4.2.2">𝑗</ci></list></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.6c">(\mathbf{z}^{k}_{A,i},\mathbf{z}^{k}_{T,j})</annotation></semantics></math> where <math id="S2.SS3.p2.7.m7.1" class="ltx_Math" alttext="i\neq j" display="inline"><semantics id="S2.SS3.p2.7.m7.1a"><mrow id="S2.SS3.p2.7.m7.1.1" xref="S2.SS3.p2.7.m7.1.1.cmml"><mi id="S2.SS3.p2.7.m7.1.1.2" xref="S2.SS3.p2.7.m7.1.1.2.cmml">i</mi><mo id="S2.SS3.p2.7.m7.1.1.1" xref="S2.SS3.p2.7.m7.1.1.1.cmml">≠</mo><mi id="S2.SS3.p2.7.m7.1.1.3" xref="S2.SS3.p2.7.m7.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.7.m7.1b"><apply id="S2.SS3.p2.7.m7.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1"><neq id="S2.SS3.p2.7.m7.1.1.1.cmml" xref="S2.SS3.p2.7.m7.1.1.1"></neq><ci id="S2.SS3.p2.7.m7.1.1.2.cmml" xref="S2.SS3.p2.7.m7.1.1.2">𝑖</ci><ci id="S2.SS3.p2.7.m7.1.1.3.cmml" xref="S2.SS3.p2.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.7.m7.1c">i\neq j</annotation></semantics></math>. With the audio global model, we can define the loss term <math id="S2.SS3.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{L}^{T\rightarrow A}_{i}" display="inline"><semantics id="S2.SS3.p2.8.m8.1a"><msubsup id="S2.SS3.p2.8.m8.1.1" xref="S2.SS3.p2.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.8.m8.1.1.2.2" xref="S2.SS3.p2.8.m8.1.1.2.2.cmml">ℒ</mi><mi id="S2.SS3.p2.8.m8.1.1.3" xref="S2.SS3.p2.8.m8.1.1.3.cmml">i</mi><mrow id="S2.SS3.p2.8.m8.1.1.2.3" xref="S2.SS3.p2.8.m8.1.1.2.3.cmml"><mi id="S2.SS3.p2.8.m8.1.1.2.3.2" xref="S2.SS3.p2.8.m8.1.1.2.3.2.cmml">T</mi><mo stretchy="false" id="S2.SS3.p2.8.m8.1.1.2.3.1" xref="S2.SS3.p2.8.m8.1.1.2.3.1.cmml">→</mo><mi id="S2.SS3.p2.8.m8.1.1.2.3.3" xref="S2.SS3.p2.8.m8.1.1.2.3.3.cmml">A</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.8.m8.1b"><apply id="S2.SS3.p2.8.m8.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.1.cmml" xref="S2.SS3.p2.8.m8.1.1">subscript</csymbol><apply id="S2.SS3.p2.8.m8.1.1.2.cmml" xref="S2.SS3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.8.m8.1.1.2.1.cmml" xref="S2.SS3.p2.8.m8.1.1">superscript</csymbol><ci id="S2.SS3.p2.8.m8.1.1.2.2.cmml" xref="S2.SS3.p2.8.m8.1.1.2.2">ℒ</ci><apply id="S2.SS3.p2.8.m8.1.1.2.3.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3"><ci id="S2.SS3.p2.8.m8.1.1.2.3.1.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3.1">→</ci><ci id="S2.SS3.p2.8.m8.1.1.2.3.2.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3.2">𝑇</ci><ci id="S2.SS3.p2.8.m8.1.1.2.3.3.cmml" xref="S2.SS3.p2.8.m8.1.1.2.3.3">𝐴</ci></apply></apply><ci id="S2.SS3.p2.8.m8.1.1.3.cmml" xref="S2.SS3.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.8.m8.1c">\mathcal{L}^{T\rightarrow A}_{i}</annotation></semantics></math> for data <math id="S2.SS3.p2.9.m9.1" class="ltx_Math" alttext="\mathbf{X}^{k}_{i}" display="inline"><semantics id="S2.SS3.p2.9.m9.1a"><msubsup id="S2.SS3.p2.9.m9.1.1" xref="S2.SS3.p2.9.m9.1.1.cmml"><mi id="S2.SS3.p2.9.m9.1.1.2.2" xref="S2.SS3.p2.9.m9.1.1.2.2.cmml">𝐗</mi><mi id="S2.SS3.p2.9.m9.1.1.3" xref="S2.SS3.p2.9.m9.1.1.3.cmml">i</mi><mi id="S2.SS3.p2.9.m9.1.1.2.3" xref="S2.SS3.p2.9.m9.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.9.m9.1b"><apply id="S2.SS3.p2.9.m9.1.1.cmml" xref="S2.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m9.1.1.1.cmml" xref="S2.SS3.p2.9.m9.1.1">subscript</csymbol><apply id="S2.SS3.p2.9.m9.1.1.2.cmml" xref="S2.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.9.m9.1.1.2.1.cmml" xref="S2.SS3.p2.9.m9.1.1">superscript</csymbol><ci id="S2.SS3.p2.9.m9.1.1.2.2.cmml" xref="S2.SS3.p2.9.m9.1.1.2.2">𝐗</ci><ci id="S2.SS3.p2.9.m9.1.1.2.3.cmml" xref="S2.SS3.p2.9.m9.1.1.2.3">𝑘</ci></apply><ci id="S2.SS3.p2.9.m9.1.1.3.cmml" xref="S2.SS3.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.9.m9.1c">\mathbf{X}^{k}_{i}</annotation></semantics></math> in a training batch of size B with a temperature parameter <math id="S2.SS3.p2.10.m10.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S2.SS3.p2.10.m10.1a"><mi id="S2.SS3.p2.10.m10.1.1" xref="S2.SS3.p2.10.m10.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.10.m10.1b"><ci id="S2.SS3.p2.10.m10.1.1.cmml" xref="S2.SS3.p2.10.m10.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.10.m10.1c">\tau</annotation></semantics></math> as:</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.17" class="ltx_Math" alttext="\mathcal{L}^{T\rightarrow A}_{i}=-\log\frac{e^{(\mathbf{z}^{k}_{A,i})^{T}\mathbf{z}^{k}_{T,i}/\tau}}{\sum^{B}_{j=1,i\neq j}e^{(\mathbf{z}^{k}_{A,i})^{T}\mathbf{z}^{k}_{A,j}/\tau}+e^{(\mathbf{z}^{k}_{A,i})^{T}\mathbf{z}^{k}_{T,i}/\tau}}" display="block"><semantics id="S2.E1.m1.17a"><mrow id="S2.E1.m1.17.18" xref="S2.E1.m1.17.18.cmml"><msubsup id="S2.E1.m1.17.18.2" xref="S2.E1.m1.17.18.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="S2.E1.m1.17.18.2.2.2" xref="S2.E1.m1.17.18.2.2.2.cmml">ℒ</mi><mi mathsize="80%" id="S2.E1.m1.17.18.2.3" xref="S2.E1.m1.17.18.2.3.cmml">i</mi><mrow id="S2.E1.m1.17.18.2.2.3" xref="S2.E1.m1.17.18.2.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.17.18.2.2.3.2" xref="S2.E1.m1.17.18.2.2.3.2.cmml">T</mi><mo mathsize="80%" stretchy="false" id="S2.E1.m1.17.18.2.2.3.1" xref="S2.E1.m1.17.18.2.2.3.1.cmml">→</mo><mi mathsize="80%" id="S2.E1.m1.17.18.2.2.3.3" xref="S2.E1.m1.17.18.2.2.3.3.cmml">A</mi></mrow></msubsup><mo mathsize="80%" id="S2.E1.m1.17.18.1" xref="S2.E1.m1.17.18.1.cmml">=</mo><mrow id="S2.E1.m1.17.18.3" xref="S2.E1.m1.17.18.3.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.E1.m1.17.18.3a" xref="S2.E1.m1.17.18.3.cmml">−</mo><mrow id="S2.E1.m1.17.18.3.2" xref="S2.E1.m1.17.18.3.2.cmml"><mi mathsize="80%" id="S2.E1.m1.17.18.3.2.1" xref="S2.E1.m1.17.18.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E1.m1.17.18.3.2a" xref="S2.E1.m1.17.18.3.2.cmml">⁡</mo><mfrac id="S2.E1.m1.17.17" xref="S2.E1.m1.17.17.cmml"><msup id="S2.E1.m1.5.5.5" xref="S2.E1.m1.5.5.5.cmml"><mi mathsize="80%" id="S2.E1.m1.5.5.5.7" xref="S2.E1.m1.5.5.5.7.cmml">e</mi><mrow id="S2.E1.m1.5.5.5.5.5" xref="S2.E1.m1.5.5.5.5.5.cmml"><mrow id="S2.E1.m1.5.5.5.5.5.5" xref="S2.E1.m1.5.5.5.5.5.5.cmml"><msup id="S2.E1.m1.5.5.5.5.5.5.1" xref="S2.E1.m1.5.5.5.5.5.5.1.cmml"><mrow id="S2.E1.m1.5.5.5.5.5.5.1.1.1" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E1.m1.5.5.5.5.5.5.1.1.1.2" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.2" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E1.m1.2.2.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.2.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">A</mi><mo mathsize="80%" id="S2.E1.m1.2.2.2.2.2.2.2.4.1" xref="S2.E1.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E1.m1.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.3" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo maxsize="80%" minsize="80%" id="S2.E1.m1.5.5.5.5.5.5.1.1.1.3" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.cmml">)</mo></mrow><mi mathsize="80%" id="S2.E1.m1.5.5.5.5.5.5.1.3" xref="S2.E1.m1.5.5.5.5.5.5.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.5.5.5.5.2" xref="S2.E1.m1.5.5.5.5.5.5.2.cmml">​</mo><msubsup id="S2.E1.m1.5.5.5.5.5.5.3" xref="S2.E1.m1.5.5.5.5.5.5.3.cmml"><mi mathsize="80%" id="S2.E1.m1.5.5.5.5.5.5.3.2.2" xref="S2.E1.m1.5.5.5.5.5.5.3.2.2.cmml">𝐳</mi><mrow id="S2.E1.m1.4.4.4.4.4.4.2.4" xref="S2.E1.m1.4.4.4.4.4.4.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.3.3.3.3.3.3.1.1" xref="S2.E1.m1.3.3.3.3.3.3.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E1.m1.4.4.4.4.4.4.2.4.1" xref="S2.E1.m1.4.4.4.4.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E1.m1.4.4.4.4.4.4.2.2" xref="S2.E1.m1.4.4.4.4.4.4.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E1.m1.5.5.5.5.5.5.3.2.3" xref="S2.E1.m1.5.5.5.5.5.5.3.2.3.cmml">k</mi></msubsup></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E1.m1.5.5.5.5.5.6" xref="S2.E1.m1.5.5.5.5.5.6.cmml">/</mo><mi mathsize="80%" id="S2.E1.m1.5.5.5.5.5.7" xref="S2.E1.m1.5.5.5.5.5.7.cmml">τ</mi></mrow></msup><mrow id="S2.E1.m1.17.17.17" xref="S2.E1.m1.17.17.17.cmml"><mrow id="S2.E1.m1.17.17.17.14" xref="S2.E1.m1.17.17.17.14.cmml"><msubsup id="S2.E1.m1.17.17.17.14.1" xref="S2.E1.m1.17.17.17.14.1.cmml"><mo maxsize="80%" minsize="80%" stretchy="true" id="S2.E1.m1.17.17.17.14.1.2.2" xref="S2.E1.m1.17.17.17.14.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.7.7.7.2.2.2" xref="S2.E1.m1.7.7.7.2.2.3.cmml"><mrow id="S2.E1.m1.6.6.6.1.1.1.1" xref="S2.E1.m1.6.6.6.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E1.m1.6.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.6.1.1.1.1.2.cmml">j</mi><mo mathsize="80%" id="S2.E1.m1.6.6.6.1.1.1.1.1" xref="S2.E1.m1.6.6.6.1.1.1.1.1.cmml">=</mo><mn mathsize="80%" id="S2.E1.m1.6.6.6.1.1.1.1.3" xref="S2.E1.m1.6.6.6.1.1.1.1.3.cmml">1</mn></mrow><mo mathsize="80%" id="S2.E1.m1.7.7.7.2.2.2.3" xref="S2.E1.m1.7.7.7.2.2.3a.cmml">,</mo><mrow id="S2.E1.m1.7.7.7.2.2.2.2" xref="S2.E1.m1.7.7.7.2.2.2.2.cmml"><mi mathsize="80%" id="S2.E1.m1.7.7.7.2.2.2.2.2" xref="S2.E1.m1.7.7.7.2.2.2.2.2.cmml">i</mi><mo mathsize="80%" id="S2.E1.m1.7.7.7.2.2.2.2.1" xref="S2.E1.m1.7.7.7.2.2.2.2.1.cmml">≠</mo><mi mathsize="80%" id="S2.E1.m1.7.7.7.2.2.2.2.3" xref="S2.E1.m1.7.7.7.2.2.2.2.3.cmml">j</mi></mrow></mrow><mi mathsize="80%" id="S2.E1.m1.17.17.17.14.1.2.3" xref="S2.E1.m1.17.17.17.14.1.2.3.cmml">B</mi></msubsup><msup id="S2.E1.m1.17.17.17.14.2" xref="S2.E1.m1.17.17.17.14.2.cmml"><mi mathsize="80%" id="S2.E1.m1.17.17.17.14.2.2" xref="S2.E1.m1.17.17.17.14.2.2.cmml">e</mi><mrow id="S2.E1.m1.12.12.12.7.5" xref="S2.E1.m1.12.12.12.7.5.cmml"><mrow id="S2.E1.m1.12.12.12.7.5.5" xref="S2.E1.m1.12.12.12.7.5.5.cmml"><msup id="S2.E1.m1.12.12.12.7.5.5.1" xref="S2.E1.m1.12.12.12.7.5.5.1.cmml"><mrow id="S2.E1.m1.12.12.12.7.5.5.1.1.1" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E1.m1.12.12.12.7.5.5.1.1.1.2" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.2" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E1.m1.9.9.9.4.2.2.2.4" xref="S2.E1.m1.9.9.9.4.2.2.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.8.8.8.3.1.1.1.1" xref="S2.E1.m1.8.8.8.3.1.1.1.1.cmml">A</mi><mo mathsize="80%" id="S2.E1.m1.9.9.9.4.2.2.2.4.1" xref="S2.E1.m1.9.9.9.4.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E1.m1.9.9.9.4.2.2.2.2" xref="S2.E1.m1.9.9.9.4.2.2.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.3" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo maxsize="80%" minsize="80%" id="S2.E1.m1.12.12.12.7.5.5.1.1.1.3" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.cmml">)</mo></mrow><mi mathsize="80%" id="S2.E1.m1.12.12.12.7.5.5.1.3" xref="S2.E1.m1.12.12.12.7.5.5.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E1.m1.12.12.12.7.5.5.2" xref="S2.E1.m1.12.12.12.7.5.5.2.cmml">​</mo><msubsup id="S2.E1.m1.12.12.12.7.5.5.3" xref="S2.E1.m1.12.12.12.7.5.5.3.cmml"><mi mathsize="80%" id="S2.E1.m1.12.12.12.7.5.5.3.2.2" xref="S2.E1.m1.12.12.12.7.5.5.3.2.2.cmml">𝐳</mi><mrow id="S2.E1.m1.11.11.11.6.4.4.2.4" xref="S2.E1.m1.11.11.11.6.4.4.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.10.10.10.5.3.3.1.1" xref="S2.E1.m1.10.10.10.5.3.3.1.1.cmml">A</mi><mo mathsize="80%" id="S2.E1.m1.11.11.11.6.4.4.2.4.1" xref="S2.E1.m1.11.11.11.6.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E1.m1.11.11.11.6.4.4.2.2" xref="S2.E1.m1.11.11.11.6.4.4.2.2.cmml">j</mi></mrow><mi mathsize="80%" id="S2.E1.m1.12.12.12.7.5.5.3.2.3" xref="S2.E1.m1.12.12.12.7.5.5.3.2.3.cmml">k</mi></msubsup></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E1.m1.12.12.12.7.5.6" xref="S2.E1.m1.12.12.12.7.5.6.cmml">/</mo><mi mathsize="80%" id="S2.E1.m1.12.12.12.7.5.7" xref="S2.E1.m1.12.12.12.7.5.7.cmml">τ</mi></mrow></msup></mrow><mo mathsize="80%" id="S2.E1.m1.17.17.17.13" xref="S2.E1.m1.17.17.17.13.cmml">+</mo><msup id="S2.E1.m1.17.17.17.15" xref="S2.E1.m1.17.17.17.15.cmml"><mi mathsize="80%" id="S2.E1.m1.17.17.17.15.2" xref="S2.E1.m1.17.17.17.15.2.cmml">e</mi><mrow id="S2.E1.m1.17.17.17.12.5" xref="S2.E1.m1.17.17.17.12.5.cmml"><mrow id="S2.E1.m1.17.17.17.12.5.5" xref="S2.E1.m1.17.17.17.12.5.5.cmml"><msup id="S2.E1.m1.17.17.17.12.5.5.1" xref="S2.E1.m1.17.17.17.12.5.5.1.cmml"><mrow id="S2.E1.m1.17.17.17.12.5.5.1.1.1" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E1.m1.17.17.17.12.5.5.1.1.1.2" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.2" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E1.m1.14.14.14.9.2.2.2.4" xref="S2.E1.m1.14.14.14.9.2.2.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.13.13.13.8.1.1.1.1" xref="S2.E1.m1.13.13.13.8.1.1.1.1.cmml">A</mi><mo mathsize="80%" id="S2.E1.m1.14.14.14.9.2.2.2.4.1" xref="S2.E1.m1.14.14.14.9.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E1.m1.14.14.14.9.2.2.2.2" xref="S2.E1.m1.14.14.14.9.2.2.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.3" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo maxsize="80%" minsize="80%" id="S2.E1.m1.17.17.17.12.5.5.1.1.1.3" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.cmml">)</mo></mrow><mi mathsize="80%" id="S2.E1.m1.17.17.17.12.5.5.1.3" xref="S2.E1.m1.17.17.17.12.5.5.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E1.m1.17.17.17.12.5.5.2" xref="S2.E1.m1.17.17.17.12.5.5.2.cmml">​</mo><msubsup id="S2.E1.m1.17.17.17.12.5.5.3" xref="S2.E1.m1.17.17.17.12.5.5.3.cmml"><mi mathsize="80%" id="S2.E1.m1.17.17.17.12.5.5.3.2.2" xref="S2.E1.m1.17.17.17.12.5.5.3.2.2.cmml">𝐳</mi><mrow id="S2.E1.m1.16.16.16.11.4.4.2.4" xref="S2.E1.m1.16.16.16.11.4.4.2.3.cmml"><mi mathsize="80%" id="S2.E1.m1.15.15.15.10.3.3.1.1" xref="S2.E1.m1.15.15.15.10.3.3.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E1.m1.16.16.16.11.4.4.2.4.1" xref="S2.E1.m1.16.16.16.11.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E1.m1.16.16.16.11.4.4.2.2" xref="S2.E1.m1.16.16.16.11.4.4.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E1.m1.17.17.17.12.5.5.3.2.3" xref="S2.E1.m1.17.17.17.12.5.5.3.2.3.cmml">k</mi></msubsup></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E1.m1.17.17.17.12.5.6" xref="S2.E1.m1.17.17.17.12.5.6.cmml">/</mo><mi mathsize="80%" id="S2.E1.m1.17.17.17.12.5.7" xref="S2.E1.m1.17.17.17.12.5.7.cmml">τ</mi></mrow></msup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.17b"><apply id="S2.E1.m1.17.18.cmml" xref="S2.E1.m1.17.18"><eq id="S2.E1.m1.17.18.1.cmml" xref="S2.E1.m1.17.18.1"></eq><apply id="S2.E1.m1.17.18.2.cmml" xref="S2.E1.m1.17.18.2"><csymbol cd="ambiguous" id="S2.E1.m1.17.18.2.1.cmml" xref="S2.E1.m1.17.18.2">subscript</csymbol><apply id="S2.E1.m1.17.18.2.2.cmml" xref="S2.E1.m1.17.18.2"><csymbol cd="ambiguous" id="S2.E1.m1.17.18.2.2.1.cmml" xref="S2.E1.m1.17.18.2">superscript</csymbol><ci id="S2.E1.m1.17.18.2.2.2.cmml" xref="S2.E1.m1.17.18.2.2.2">ℒ</ci><apply id="S2.E1.m1.17.18.2.2.3.cmml" xref="S2.E1.m1.17.18.2.2.3"><ci id="S2.E1.m1.17.18.2.2.3.1.cmml" xref="S2.E1.m1.17.18.2.2.3.1">→</ci><ci id="S2.E1.m1.17.18.2.2.3.2.cmml" xref="S2.E1.m1.17.18.2.2.3.2">𝑇</ci><ci id="S2.E1.m1.17.18.2.2.3.3.cmml" xref="S2.E1.m1.17.18.2.2.3.3">𝐴</ci></apply></apply><ci id="S2.E1.m1.17.18.2.3.cmml" xref="S2.E1.m1.17.18.2.3">𝑖</ci></apply><apply id="S2.E1.m1.17.18.3.cmml" xref="S2.E1.m1.17.18.3"><minus id="S2.E1.m1.17.18.3.1.cmml" xref="S2.E1.m1.17.18.3"></minus><apply id="S2.E1.m1.17.18.3.2.cmml" xref="S2.E1.m1.17.18.3.2"><log id="S2.E1.m1.17.18.3.2.1.cmml" xref="S2.E1.m1.17.18.3.2.1"></log><apply id="S2.E1.m1.17.17.cmml" xref="S2.E1.m1.17.17"><divide id="S2.E1.m1.17.17.18.cmml" xref="S2.E1.m1.17.17"></divide><apply id="S2.E1.m1.5.5.5.cmml" xref="S2.E1.m1.5.5.5"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.6.cmml" xref="S2.E1.m1.5.5.5">superscript</csymbol><ci id="S2.E1.m1.5.5.5.7.cmml" xref="S2.E1.m1.5.5.5.7">𝑒</ci><apply id="S2.E1.m1.5.5.5.5.5.cmml" xref="S2.E1.m1.5.5.5.5.5"><divide id="S2.E1.m1.5.5.5.5.5.6.cmml" xref="S2.E1.m1.5.5.5.5.5.6"></divide><apply id="S2.E1.m1.5.5.5.5.5.5.cmml" xref="S2.E1.m1.5.5.5.5.5.5"><times id="S2.E1.m1.5.5.5.5.5.5.2.cmml" xref="S2.E1.m1.5.5.5.5.5.5.2"></times><apply id="S2.E1.m1.5.5.5.5.5.5.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.5.5.5.1.2.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1">superscript</csymbol><apply id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1">subscript</csymbol><apply id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1">superscript</csymbol><ci id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.2">𝐳</ci><ci id="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.E1.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1">𝐴</ci><ci id="S2.E1.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2">𝑖</ci></list></apply><ci id="S2.E1.m1.5.5.5.5.5.5.1.3.cmml" xref="S2.E1.m1.5.5.5.5.5.5.1.3">𝑇</ci></apply><apply id="S2.E1.m1.5.5.5.5.5.5.3.cmml" xref="S2.E1.m1.5.5.5.5.5.5.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.5.5.5.3.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.3">subscript</csymbol><apply id="S2.E1.m1.5.5.5.5.5.5.3.2.cmml" xref="S2.E1.m1.5.5.5.5.5.5.3"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.5.5.5.5.3.2.1.cmml" xref="S2.E1.m1.5.5.5.5.5.5.3">superscript</csymbol><ci id="S2.E1.m1.5.5.5.5.5.5.3.2.2.cmml" xref="S2.E1.m1.5.5.5.5.5.5.3.2.2">𝐳</ci><ci id="S2.E1.m1.5.5.5.5.5.5.3.2.3.cmml" xref="S2.E1.m1.5.5.5.5.5.5.3.2.3">𝑘</ci></apply><list id="S2.E1.m1.4.4.4.4.4.4.2.3.cmml" xref="S2.E1.m1.4.4.4.4.4.4.2.4"><ci id="S2.E1.m1.3.3.3.3.3.3.1.1.cmml" xref="S2.E1.m1.3.3.3.3.3.3.1.1">𝑇</ci><ci id="S2.E1.m1.4.4.4.4.4.4.2.2.cmml" xref="S2.E1.m1.4.4.4.4.4.4.2.2">𝑖</ci></list></apply></apply><ci id="S2.E1.m1.5.5.5.5.5.7.cmml" xref="S2.E1.m1.5.5.5.5.5.7">𝜏</ci></apply></apply><apply id="S2.E1.m1.17.17.17.cmml" xref="S2.E1.m1.17.17.17"><plus id="S2.E1.m1.17.17.17.13.cmml" xref="S2.E1.m1.17.17.17.13"></plus><apply id="S2.E1.m1.17.17.17.14.cmml" xref="S2.E1.m1.17.17.17.14"><apply id="S2.E1.m1.17.17.17.14.1.cmml" xref="S2.E1.m1.17.17.17.14.1"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.14.1.1.cmml" xref="S2.E1.m1.17.17.17.14.1">subscript</csymbol><apply id="S2.E1.m1.17.17.17.14.1.2.cmml" xref="S2.E1.m1.17.17.17.14.1"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.14.1.2.1.cmml" xref="S2.E1.m1.17.17.17.14.1">superscript</csymbol><sum id="S2.E1.m1.17.17.17.14.1.2.2.cmml" xref="S2.E1.m1.17.17.17.14.1.2.2"></sum><ci id="S2.E1.m1.17.17.17.14.1.2.3.cmml" xref="S2.E1.m1.17.17.17.14.1.2.3">𝐵</ci></apply><apply id="S2.E1.m1.7.7.7.2.2.3.cmml" xref="S2.E1.m1.7.7.7.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.7.2.2.3a.cmml" xref="S2.E1.m1.7.7.7.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.6.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.6.1.1.1.1"><eq id="S2.E1.m1.6.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.6.1.1.1.1.1"></eq><ci id="S2.E1.m1.6.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.6.1.1.1.1.2">𝑗</ci><cn type="integer" id="S2.E1.m1.6.6.6.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.6.1.1.1.1.3">1</cn></apply><apply id="S2.E1.m1.7.7.7.2.2.2.2.cmml" xref="S2.E1.m1.7.7.7.2.2.2.2"><neq id="S2.E1.m1.7.7.7.2.2.2.2.1.cmml" xref="S2.E1.m1.7.7.7.2.2.2.2.1"></neq><ci id="S2.E1.m1.7.7.7.2.2.2.2.2.cmml" xref="S2.E1.m1.7.7.7.2.2.2.2.2">𝑖</ci><ci id="S2.E1.m1.7.7.7.2.2.2.2.3.cmml" xref="S2.E1.m1.7.7.7.2.2.2.2.3">𝑗</ci></apply></apply></apply><apply id="S2.E1.m1.17.17.17.14.2.cmml" xref="S2.E1.m1.17.17.17.14.2"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.14.2.1.cmml" xref="S2.E1.m1.17.17.17.14.2">superscript</csymbol><ci id="S2.E1.m1.17.17.17.14.2.2.cmml" xref="S2.E1.m1.17.17.17.14.2.2">𝑒</ci><apply id="S2.E1.m1.12.12.12.7.5.cmml" xref="S2.E1.m1.12.12.12.7.5"><divide id="S2.E1.m1.12.12.12.7.5.6.cmml" xref="S2.E1.m1.12.12.12.7.5.6"></divide><apply id="S2.E1.m1.12.12.12.7.5.5.cmml" xref="S2.E1.m1.12.12.12.7.5.5"><times id="S2.E1.m1.12.12.12.7.5.5.2.cmml" xref="S2.E1.m1.12.12.12.7.5.5.2"></times><apply id="S2.E1.m1.12.12.12.7.5.5.1.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.7.5.5.1.2.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1">superscript</csymbol><apply id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1">subscript</csymbol><apply id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.1.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1">superscript</csymbol><ci id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.2.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.2">𝐳</ci><ci id="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.3.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.E1.m1.9.9.9.4.2.2.2.3.cmml" xref="S2.E1.m1.9.9.9.4.2.2.2.4"><ci id="S2.E1.m1.8.8.8.3.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.3.1.1.1.1">𝐴</ci><ci id="S2.E1.m1.9.9.9.4.2.2.2.2.cmml" xref="S2.E1.m1.9.9.9.4.2.2.2.2">𝑖</ci></list></apply><ci id="S2.E1.m1.12.12.12.7.5.5.1.3.cmml" xref="S2.E1.m1.12.12.12.7.5.5.1.3">𝑇</ci></apply><apply id="S2.E1.m1.12.12.12.7.5.5.3.cmml" xref="S2.E1.m1.12.12.12.7.5.5.3"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.7.5.5.3.1.cmml" xref="S2.E1.m1.12.12.12.7.5.5.3">subscript</csymbol><apply id="S2.E1.m1.12.12.12.7.5.5.3.2.cmml" xref="S2.E1.m1.12.12.12.7.5.5.3"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.12.7.5.5.3.2.1.cmml" xref="S2.E1.m1.12.12.12.7.5.5.3">superscript</csymbol><ci id="S2.E1.m1.12.12.12.7.5.5.3.2.2.cmml" xref="S2.E1.m1.12.12.12.7.5.5.3.2.2">𝐳</ci><ci id="S2.E1.m1.12.12.12.7.5.5.3.2.3.cmml" xref="S2.E1.m1.12.12.12.7.5.5.3.2.3">𝑘</ci></apply><list id="S2.E1.m1.11.11.11.6.4.4.2.3.cmml" xref="S2.E1.m1.11.11.11.6.4.4.2.4"><ci id="S2.E1.m1.10.10.10.5.3.3.1.1.cmml" xref="S2.E1.m1.10.10.10.5.3.3.1.1">𝐴</ci><ci id="S2.E1.m1.11.11.11.6.4.4.2.2.cmml" xref="S2.E1.m1.11.11.11.6.4.4.2.2">𝑗</ci></list></apply></apply><ci id="S2.E1.m1.12.12.12.7.5.7.cmml" xref="S2.E1.m1.12.12.12.7.5.7">𝜏</ci></apply></apply></apply><apply id="S2.E1.m1.17.17.17.15.cmml" xref="S2.E1.m1.17.17.17.15"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.15.1.cmml" xref="S2.E1.m1.17.17.17.15">superscript</csymbol><ci id="S2.E1.m1.17.17.17.15.2.cmml" xref="S2.E1.m1.17.17.17.15.2">𝑒</ci><apply id="S2.E1.m1.17.17.17.12.5.cmml" xref="S2.E1.m1.17.17.17.12.5"><divide id="S2.E1.m1.17.17.17.12.5.6.cmml" xref="S2.E1.m1.17.17.17.12.5.6"></divide><apply id="S2.E1.m1.17.17.17.12.5.5.cmml" xref="S2.E1.m1.17.17.17.12.5.5"><times id="S2.E1.m1.17.17.17.12.5.5.2.cmml" xref="S2.E1.m1.17.17.17.12.5.5.2"></times><apply id="S2.E1.m1.17.17.17.12.5.5.1.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.12.5.5.1.2.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1">superscript</csymbol><apply id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.1.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1">subscript</csymbol><apply id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.1.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1">superscript</csymbol><ci id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.2.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.2">𝐳</ci><ci id="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.3.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.E1.m1.14.14.14.9.2.2.2.3.cmml" xref="S2.E1.m1.14.14.14.9.2.2.2.4"><ci id="S2.E1.m1.13.13.13.8.1.1.1.1.cmml" xref="S2.E1.m1.13.13.13.8.1.1.1.1">𝐴</ci><ci id="S2.E1.m1.14.14.14.9.2.2.2.2.cmml" xref="S2.E1.m1.14.14.14.9.2.2.2.2">𝑖</ci></list></apply><ci id="S2.E1.m1.17.17.17.12.5.5.1.3.cmml" xref="S2.E1.m1.17.17.17.12.5.5.1.3">𝑇</ci></apply><apply id="S2.E1.m1.17.17.17.12.5.5.3.cmml" xref="S2.E1.m1.17.17.17.12.5.5.3"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.12.5.5.3.1.cmml" xref="S2.E1.m1.17.17.17.12.5.5.3">subscript</csymbol><apply id="S2.E1.m1.17.17.17.12.5.5.3.2.cmml" xref="S2.E1.m1.17.17.17.12.5.5.3"><csymbol cd="ambiguous" id="S2.E1.m1.17.17.17.12.5.5.3.2.1.cmml" xref="S2.E1.m1.17.17.17.12.5.5.3">superscript</csymbol><ci id="S2.E1.m1.17.17.17.12.5.5.3.2.2.cmml" xref="S2.E1.m1.17.17.17.12.5.5.3.2.2">𝐳</ci><ci id="S2.E1.m1.17.17.17.12.5.5.3.2.3.cmml" xref="S2.E1.m1.17.17.17.12.5.5.3.2.3">𝑘</ci></apply><list id="S2.E1.m1.16.16.16.11.4.4.2.3.cmml" xref="S2.E1.m1.16.16.16.11.4.4.2.4"><ci id="S2.E1.m1.15.15.15.10.3.3.1.1.cmml" xref="S2.E1.m1.15.15.15.10.3.3.1.1">𝑇</ci><ci id="S2.E1.m1.16.16.16.11.4.4.2.2.cmml" xref="S2.E1.m1.16.16.16.11.4.4.2.2">𝑖</ci></list></apply></apply><ci id="S2.E1.m1.17.17.17.12.5.7.cmml" xref="S2.E1.m1.17.17.17.12.5.7">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.17c">\mathcal{L}^{T\rightarrow A}_{i}=-\log\frac{e^{(\mathbf{z}^{k}_{A,i})^{T}\mathbf{z}^{k}_{T,i}/\tau}}{\sum^{B}_{j=1,i\neq j}e^{(\mathbf{z}^{k}_{A,i})^{T}\mathbf{z}^{k}_{A,j}/\tau}+e^{(\mathbf{z}^{k}_{A,i})^{T}\mathbf{z}^{k}_{T,i}/\tau}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Embedding Alignment at Server and Local models</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.5" class="ltx_p">As noted before, to prevent over-fitting, we aim to decrease the distance between the local and server side textual embeddings <math id="S2.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="S2.SS4.p1.1.m1.1a"><msubsup id="S2.SS4.p1.1.m1.1.1" xref="S2.SS4.p1.1.m1.1.1.cmml"><mi id="S2.SS4.p1.1.m1.1.1.2.2" xref="S2.SS4.p1.1.m1.1.1.2.2.cmml">𝐳</mi><mi id="S2.SS4.p1.1.m1.1.1.3" xref="S2.SS4.p1.1.m1.1.1.3.cmml">𝐓</mi><mo id="S2.SS4.p1.1.m1.1.1.2.3" xref="S2.SS4.p1.1.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.1b"><apply id="S2.SS4.p1.1.m1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.1.cmml" xref="S2.SS4.p1.1.m1.1.1">subscript</csymbol><apply id="S2.SS4.p1.1.m1.1.1.2.cmml" xref="S2.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.1.1">superscript</csymbol><ci id="S2.SS4.p1.1.m1.1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.1.1.2.2">𝐳</ci><ci id="S2.SS4.p1.1.m1.1.1.2.3.cmml" xref="S2.SS4.p1.1.m1.1.1.2.3">′</ci></apply><ci id="S2.SS4.p1.1.m1.1.1.3.cmml" xref="S2.SS4.p1.1.m1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math> and <math id="S2.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS4.p1.2.m2.1a"><msub id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">𝐳</mi><mi id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝐳</ci><ci id="S2.SS4.p1.2.m2.1.1.3.cmml" xref="S2.SS4.p1.2.m2.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\mathbf{z_{T}}</annotation></semantics></math> using the contrastive loss. We define a positive pair as <math id="S2.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="S2.SS4.p1.3.m3.1a"><msubsup id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml"><mi id="S2.SS4.p1.3.m3.1.1.2.2" xref="S2.SS4.p1.3.m3.1.1.2.2.cmml">𝐳</mi><mi id="S2.SS4.p1.3.m3.1.1.3" xref="S2.SS4.p1.3.m3.1.1.3.cmml">𝐓</mi><mo id="S2.SS4.p1.3.m3.1.1.2.3" xref="S2.SS4.p1.3.m3.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><apply id="S2.SS4.p1.3.m3.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.1.cmml" xref="S2.SS4.p1.3.m3.1.1">subscript</csymbol><apply id="S2.SS4.p1.3.m3.1.1.2.cmml" xref="S2.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.3.m3.1.1.2.1.cmml" xref="S2.SS4.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS4.p1.3.m3.1.1.2.2.cmml" xref="S2.SS4.p1.3.m3.1.1.2.2">𝐳</ci><ci id="S2.SS4.p1.3.m3.1.1.2.3.cmml" xref="S2.SS4.p1.3.m3.1.1.2.3">′</ci></apply><ci id="S2.SS4.p1.3.m3.1.1.3.cmml" xref="S2.SS4.p1.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math> and <math id="S2.SS4.p1.4.m4.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="S2.SS4.p1.4.m4.1a"><msub id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml"><mi id="S2.SS4.p1.4.m4.1.1.2" xref="S2.SS4.p1.4.m4.1.1.2.cmml">𝐳</mi><mi id="S2.SS4.p1.4.m4.1.1.3" xref="S2.SS4.p1.4.m4.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><apply id="S2.SS4.p1.4.m4.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.4.m4.1.1.1.cmml" xref="S2.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS4.p1.4.m4.1.1.2.cmml" xref="S2.SS4.p1.4.m4.1.1.2">𝐳</ci><ci id="S2.SS4.p1.4.m4.1.1.3.cmml" xref="S2.SS4.p1.4.m4.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">\mathbf{z_{T}}</annotation></semantics></math> from the same data sample, and a negative pair from different samples. We can then write the server side contrastive loss <math id="S2.SS4.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{L}^{L\rightarrow S}_{i}" display="inline"><semantics id="S2.SS4.p1.5.m5.1a"><msubsup id="S2.SS4.p1.5.m5.1.1" xref="S2.SS4.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p1.5.m5.1.1.2.2" xref="S2.SS4.p1.5.m5.1.1.2.2.cmml">ℒ</mi><mi id="S2.SS4.p1.5.m5.1.1.3" xref="S2.SS4.p1.5.m5.1.1.3.cmml">i</mi><mrow id="S2.SS4.p1.5.m5.1.1.2.3" xref="S2.SS4.p1.5.m5.1.1.2.3.cmml"><mi id="S2.SS4.p1.5.m5.1.1.2.3.2" xref="S2.SS4.p1.5.m5.1.1.2.3.2.cmml">L</mi><mo stretchy="false" id="S2.SS4.p1.5.m5.1.1.2.3.1" xref="S2.SS4.p1.5.m5.1.1.2.3.1.cmml">→</mo><mi id="S2.SS4.p1.5.m5.1.1.2.3.3" xref="S2.SS4.p1.5.m5.1.1.2.3.3.cmml">S</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.5.m5.1b"><apply id="S2.SS4.p1.5.m5.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.5.m5.1.1.1.cmml" xref="S2.SS4.p1.5.m5.1.1">subscript</csymbol><apply id="S2.SS4.p1.5.m5.1.1.2.cmml" xref="S2.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.5.m5.1.1.2.1.cmml" xref="S2.SS4.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS4.p1.5.m5.1.1.2.2.cmml" xref="S2.SS4.p1.5.m5.1.1.2.2">ℒ</ci><apply id="S2.SS4.p1.5.m5.1.1.2.3.cmml" xref="S2.SS4.p1.5.m5.1.1.2.3"><ci id="S2.SS4.p1.5.m5.1.1.2.3.1.cmml" xref="S2.SS4.p1.5.m5.1.1.2.3.1">→</ci><ci id="S2.SS4.p1.5.m5.1.1.2.3.2.cmml" xref="S2.SS4.p1.5.m5.1.1.2.3.2">𝐿</ci><ci id="S2.SS4.p1.5.m5.1.1.2.3.3.cmml" xref="S2.SS4.p1.5.m5.1.1.2.3.3">𝑆</ci></apply></apply><ci id="S2.SS4.p1.5.m5.1.1.3.cmml" xref="S2.SS4.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.5.m5.1c">\mathcal{L}^{L\rightarrow S}_{i}</annotation></semantics></math> as:</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.17" class="ltx_Math" alttext="\mathcal{L}^{L\rightarrow S}_{i}=-\log\frac{e^{(\mathbf{z}^{k}_{T,i})^{T}\mathbf{z^{\prime}}^{k}_{T,i}/\tau}}{\sum^{B}_{j=1,i\neq j}e^{(\mathbf{z}^{k}_{T,i})^{T}\mathbf{z}^{k}_{T,j}/\tau}+e^{(\mathbf{z}^{k}_{T,i})^{T}\mathbf{z^{\prime}}^{k}_{T,i}/\tau}}" display="block"><semantics id="S2.E2.m1.17a"><mrow id="S2.E2.m1.17.18" xref="S2.E2.m1.17.18.cmml"><msubsup id="S2.E2.m1.17.18.2" xref="S2.E2.m1.17.18.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="80%" id="S2.E2.m1.17.18.2.2.2" xref="S2.E2.m1.17.18.2.2.2.cmml">ℒ</mi><mi mathsize="80%" id="S2.E2.m1.17.18.2.3" xref="S2.E2.m1.17.18.2.3.cmml">i</mi><mrow id="S2.E2.m1.17.18.2.2.3" xref="S2.E2.m1.17.18.2.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.17.18.2.2.3.2" xref="S2.E2.m1.17.18.2.2.3.2.cmml">L</mi><mo mathsize="80%" stretchy="false" id="S2.E2.m1.17.18.2.2.3.1" xref="S2.E2.m1.17.18.2.2.3.1.cmml">→</mo><mi mathsize="80%" id="S2.E2.m1.17.18.2.2.3.3" xref="S2.E2.m1.17.18.2.2.3.3.cmml">S</mi></mrow></msubsup><mo mathsize="80%" id="S2.E2.m1.17.18.1" xref="S2.E2.m1.17.18.1.cmml">=</mo><mrow id="S2.E2.m1.17.18.3" xref="S2.E2.m1.17.18.3.cmml"><mo mathsize="80%" rspace="0.167em" id="S2.E2.m1.17.18.3a" xref="S2.E2.m1.17.18.3.cmml">−</mo><mrow id="S2.E2.m1.17.18.3.2" xref="S2.E2.m1.17.18.3.2.cmml"><mi mathsize="80%" id="S2.E2.m1.17.18.3.2.1" xref="S2.E2.m1.17.18.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S2.E2.m1.17.18.3.2a" xref="S2.E2.m1.17.18.3.2.cmml">⁡</mo><mfrac id="S2.E2.m1.17.17" xref="S2.E2.m1.17.17.cmml"><msup id="S2.E2.m1.5.5.5" xref="S2.E2.m1.5.5.5.cmml"><mi mathsize="80%" id="S2.E2.m1.5.5.5.7" xref="S2.E2.m1.5.5.5.7.cmml">e</mi><mrow id="S2.E2.m1.5.5.5.5.5" xref="S2.E2.m1.5.5.5.5.5.cmml"><mrow id="S2.E2.m1.5.5.5.5.5.5" xref="S2.E2.m1.5.5.5.5.5.5.cmml"><msup id="S2.E2.m1.5.5.5.5.5.5.1" xref="S2.E2.m1.5.5.5.5.5.5.1.cmml"><mrow id="S2.E2.m1.5.5.5.5.5.5.1.1.1" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.2" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.2" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E2.m1.2.2.2.2.2.2.2.4" xref="S2.E2.m1.2.2.2.2.2.2.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E2.m1.2.2.2.2.2.2.2.4.1" xref="S2.E2.m1.2.2.2.2.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E2.m1.2.2.2.2.2.2.2.2" xref="S2.E2.m1.2.2.2.2.2.2.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.3" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo maxsize="80%" minsize="80%" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.3" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml">)</mo></mrow><mi mathsize="80%" id="S2.E2.m1.5.5.5.5.5.5.1.3" xref="S2.E2.m1.5.5.5.5.5.5.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.5.5.5.5.2" xref="S2.E2.m1.5.5.5.5.5.5.2.cmml">​</mo><mmultiscripts id="S2.E2.m1.5.5.5.5.5.5.3" xref="S2.E2.m1.5.5.5.5.5.5.3.cmml"><mi mathsize="80%" id="S2.E2.m1.5.5.5.5.5.5.3.2.2.2" xref="S2.E2.m1.5.5.5.5.5.5.3.2.2.2.cmml">𝐳</mi><mrow id="S2.E2.m1.5.5.5.5.5.5.3a" xref="S2.E2.m1.5.5.5.5.5.5.3.cmml"></mrow><mo mathsize="80%" id="S2.E2.m1.5.5.5.5.5.5.3.2.2.3" xref="S2.E2.m1.5.5.5.5.5.5.3.2.2.3.cmml">′</mo><mrow id="S2.E2.m1.4.4.4.4.4.4.2.4" xref="S2.E2.m1.4.4.4.4.4.4.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.3.3.3.3.3.3.1.1" xref="S2.E2.m1.3.3.3.3.3.3.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E2.m1.4.4.4.4.4.4.2.4.1" xref="S2.E2.m1.4.4.4.4.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E2.m1.4.4.4.4.4.4.2.2" xref="S2.E2.m1.4.4.4.4.4.4.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E2.m1.5.5.5.5.5.5.3.2.3" xref="S2.E2.m1.5.5.5.5.5.5.3.2.3.cmml">k</mi></mmultiscripts></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E2.m1.5.5.5.5.5.6" xref="S2.E2.m1.5.5.5.5.5.6.cmml">/</mo><mi mathsize="80%" id="S2.E2.m1.5.5.5.5.5.7" xref="S2.E2.m1.5.5.5.5.5.7.cmml">τ</mi></mrow></msup><mrow id="S2.E2.m1.17.17.17" xref="S2.E2.m1.17.17.17.cmml"><mrow id="S2.E2.m1.17.17.17.14" xref="S2.E2.m1.17.17.17.14.cmml"><msubsup id="S2.E2.m1.17.17.17.14.1" xref="S2.E2.m1.17.17.17.14.1.cmml"><mo maxsize="80%" minsize="80%" stretchy="true" id="S2.E2.m1.17.17.17.14.1.2.2" xref="S2.E2.m1.17.17.17.14.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.7.7.7.2.2.2" xref="S2.E2.m1.7.7.7.2.2.3.cmml"><mrow id="S2.E2.m1.6.6.6.1.1.1.1" xref="S2.E2.m1.6.6.6.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E2.m1.6.6.6.1.1.1.1.2" xref="S2.E2.m1.6.6.6.1.1.1.1.2.cmml">j</mi><mo mathsize="80%" id="S2.E2.m1.6.6.6.1.1.1.1.1" xref="S2.E2.m1.6.6.6.1.1.1.1.1.cmml">=</mo><mn mathsize="80%" id="S2.E2.m1.6.6.6.1.1.1.1.3" xref="S2.E2.m1.6.6.6.1.1.1.1.3.cmml">1</mn></mrow><mo mathsize="80%" id="S2.E2.m1.7.7.7.2.2.2.3" xref="S2.E2.m1.7.7.7.2.2.3a.cmml">,</mo><mrow id="S2.E2.m1.7.7.7.2.2.2.2" xref="S2.E2.m1.7.7.7.2.2.2.2.cmml"><mi mathsize="80%" id="S2.E2.m1.7.7.7.2.2.2.2.2" xref="S2.E2.m1.7.7.7.2.2.2.2.2.cmml">i</mi><mo mathsize="80%" id="S2.E2.m1.7.7.7.2.2.2.2.1" xref="S2.E2.m1.7.7.7.2.2.2.2.1.cmml">≠</mo><mi mathsize="80%" id="S2.E2.m1.7.7.7.2.2.2.2.3" xref="S2.E2.m1.7.7.7.2.2.2.2.3.cmml">j</mi></mrow></mrow><mi mathsize="80%" id="S2.E2.m1.17.17.17.14.1.2.3" xref="S2.E2.m1.17.17.17.14.1.2.3.cmml">B</mi></msubsup><msup id="S2.E2.m1.17.17.17.14.2" xref="S2.E2.m1.17.17.17.14.2.cmml"><mi mathsize="80%" id="S2.E2.m1.17.17.17.14.2.2" xref="S2.E2.m1.17.17.17.14.2.2.cmml">e</mi><mrow id="S2.E2.m1.12.12.12.7.5" xref="S2.E2.m1.12.12.12.7.5.cmml"><mrow id="S2.E2.m1.12.12.12.7.5.5" xref="S2.E2.m1.12.12.12.7.5.5.cmml"><msup id="S2.E2.m1.12.12.12.7.5.5.1" xref="S2.E2.m1.12.12.12.7.5.5.1.cmml"><mrow id="S2.E2.m1.12.12.12.7.5.5.1.1.1" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E2.m1.12.12.12.7.5.5.1.1.1.2" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.2" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E2.m1.9.9.9.4.2.2.2.4" xref="S2.E2.m1.9.9.9.4.2.2.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.8.8.8.3.1.1.1.1" xref="S2.E2.m1.8.8.8.3.1.1.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E2.m1.9.9.9.4.2.2.2.4.1" xref="S2.E2.m1.9.9.9.4.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E2.m1.9.9.9.4.2.2.2.2" xref="S2.E2.m1.9.9.9.4.2.2.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.3" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo maxsize="80%" minsize="80%" id="S2.E2.m1.12.12.12.7.5.5.1.1.1.3" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.cmml">)</mo></mrow><mi mathsize="80%" id="S2.E2.m1.12.12.12.7.5.5.1.3" xref="S2.E2.m1.12.12.12.7.5.5.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E2.m1.12.12.12.7.5.5.2" xref="S2.E2.m1.12.12.12.7.5.5.2.cmml">​</mo><msubsup id="S2.E2.m1.12.12.12.7.5.5.3" xref="S2.E2.m1.12.12.12.7.5.5.3.cmml"><mi mathsize="80%" id="S2.E2.m1.12.12.12.7.5.5.3.2.2" xref="S2.E2.m1.12.12.12.7.5.5.3.2.2.cmml">𝐳</mi><mrow id="S2.E2.m1.11.11.11.6.4.4.2.4" xref="S2.E2.m1.11.11.11.6.4.4.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.10.10.10.5.3.3.1.1" xref="S2.E2.m1.10.10.10.5.3.3.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E2.m1.11.11.11.6.4.4.2.4.1" xref="S2.E2.m1.11.11.11.6.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E2.m1.11.11.11.6.4.4.2.2" xref="S2.E2.m1.11.11.11.6.4.4.2.2.cmml">j</mi></mrow><mi mathsize="80%" id="S2.E2.m1.12.12.12.7.5.5.3.2.3" xref="S2.E2.m1.12.12.12.7.5.5.3.2.3.cmml">k</mi></msubsup></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E2.m1.12.12.12.7.5.6" xref="S2.E2.m1.12.12.12.7.5.6.cmml">/</mo><mi mathsize="80%" id="S2.E2.m1.12.12.12.7.5.7" xref="S2.E2.m1.12.12.12.7.5.7.cmml">τ</mi></mrow></msup></mrow><mo mathsize="80%" id="S2.E2.m1.17.17.17.13" xref="S2.E2.m1.17.17.17.13.cmml">+</mo><msup id="S2.E2.m1.17.17.17.15" xref="S2.E2.m1.17.17.17.15.cmml"><mi mathsize="80%" id="S2.E2.m1.17.17.17.15.2" xref="S2.E2.m1.17.17.17.15.2.cmml">e</mi><mrow id="S2.E2.m1.17.17.17.12.5" xref="S2.E2.m1.17.17.17.12.5.cmml"><mrow id="S2.E2.m1.17.17.17.12.5.5" xref="S2.E2.m1.17.17.17.12.5.5.cmml"><msup id="S2.E2.m1.17.17.17.12.5.5.1" xref="S2.E2.m1.17.17.17.12.5.5.1.cmml"><mrow id="S2.E2.m1.17.17.17.12.5.5.1.1.1" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.cmml"><mo maxsize="80%" minsize="80%" id="S2.E2.m1.17.17.17.12.5.5.1.1.1.2" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.cmml">(</mo><msubsup id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.cmml"><mi mathsize="80%" id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.2" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S2.E2.m1.14.14.14.9.2.2.2.4" xref="S2.E2.m1.14.14.14.9.2.2.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.13.13.13.8.1.1.1.1" xref="S2.E2.m1.13.13.13.8.1.1.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E2.m1.14.14.14.9.2.2.2.4.1" xref="S2.E2.m1.14.14.14.9.2.2.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E2.m1.14.14.14.9.2.2.2.2" xref="S2.E2.m1.14.14.14.9.2.2.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.3" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.3.cmml">k</mi></msubsup><mo maxsize="80%" minsize="80%" id="S2.E2.m1.17.17.17.12.5.5.1.1.1.3" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.cmml">)</mo></mrow><mi mathsize="80%" id="S2.E2.m1.17.17.17.12.5.5.1.3" xref="S2.E2.m1.17.17.17.12.5.5.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S2.E2.m1.17.17.17.12.5.5.2" xref="S2.E2.m1.17.17.17.12.5.5.2.cmml">​</mo><mmultiscripts id="S2.E2.m1.17.17.17.12.5.5.3" xref="S2.E2.m1.17.17.17.12.5.5.3.cmml"><mi mathsize="80%" id="S2.E2.m1.17.17.17.12.5.5.3.2.2.2" xref="S2.E2.m1.17.17.17.12.5.5.3.2.2.2.cmml">𝐳</mi><mrow id="S2.E2.m1.17.17.17.12.5.5.3a" xref="S2.E2.m1.17.17.17.12.5.5.3.cmml"></mrow><mo mathsize="80%" id="S2.E2.m1.17.17.17.12.5.5.3.2.2.3" xref="S2.E2.m1.17.17.17.12.5.5.3.2.2.3.cmml">′</mo><mrow id="S2.E2.m1.16.16.16.11.4.4.2.4" xref="S2.E2.m1.16.16.16.11.4.4.2.3.cmml"><mi mathsize="80%" id="S2.E2.m1.15.15.15.10.3.3.1.1" xref="S2.E2.m1.15.15.15.10.3.3.1.1.cmml">T</mi><mo mathsize="80%" id="S2.E2.m1.16.16.16.11.4.4.2.4.1" xref="S2.E2.m1.16.16.16.11.4.4.2.3.cmml">,</mo><mi mathsize="80%" id="S2.E2.m1.16.16.16.11.4.4.2.2" xref="S2.E2.m1.16.16.16.11.4.4.2.2.cmml">i</mi></mrow><mi mathsize="80%" id="S2.E2.m1.17.17.17.12.5.5.3.2.3" xref="S2.E2.m1.17.17.17.12.5.5.3.2.3.cmml">k</mi></mmultiscripts></mrow><mo maxsize="80%" minsize="80%" stretchy="true" symmetric="true" id="S2.E2.m1.17.17.17.12.5.6" xref="S2.E2.m1.17.17.17.12.5.6.cmml">/</mo><mi mathsize="80%" id="S2.E2.m1.17.17.17.12.5.7" xref="S2.E2.m1.17.17.17.12.5.7.cmml">τ</mi></mrow></msup></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.17b"><apply id="S2.E2.m1.17.18.cmml" xref="S2.E2.m1.17.18"><eq id="S2.E2.m1.17.18.1.cmml" xref="S2.E2.m1.17.18.1"></eq><apply id="S2.E2.m1.17.18.2.cmml" xref="S2.E2.m1.17.18.2"><csymbol cd="ambiguous" id="S2.E2.m1.17.18.2.1.cmml" xref="S2.E2.m1.17.18.2">subscript</csymbol><apply id="S2.E2.m1.17.18.2.2.cmml" xref="S2.E2.m1.17.18.2"><csymbol cd="ambiguous" id="S2.E2.m1.17.18.2.2.1.cmml" xref="S2.E2.m1.17.18.2">superscript</csymbol><ci id="S2.E2.m1.17.18.2.2.2.cmml" xref="S2.E2.m1.17.18.2.2.2">ℒ</ci><apply id="S2.E2.m1.17.18.2.2.3.cmml" xref="S2.E2.m1.17.18.2.2.3"><ci id="S2.E2.m1.17.18.2.2.3.1.cmml" xref="S2.E2.m1.17.18.2.2.3.1">→</ci><ci id="S2.E2.m1.17.18.2.2.3.2.cmml" xref="S2.E2.m1.17.18.2.2.3.2">𝐿</ci><ci id="S2.E2.m1.17.18.2.2.3.3.cmml" xref="S2.E2.m1.17.18.2.2.3.3">𝑆</ci></apply></apply><ci id="S2.E2.m1.17.18.2.3.cmml" xref="S2.E2.m1.17.18.2.3">𝑖</ci></apply><apply id="S2.E2.m1.17.18.3.cmml" xref="S2.E2.m1.17.18.3"><minus id="S2.E2.m1.17.18.3.1.cmml" xref="S2.E2.m1.17.18.3"></minus><apply id="S2.E2.m1.17.18.3.2.cmml" xref="S2.E2.m1.17.18.3.2"><log id="S2.E2.m1.17.18.3.2.1.cmml" xref="S2.E2.m1.17.18.3.2.1"></log><apply id="S2.E2.m1.17.17.cmml" xref="S2.E2.m1.17.17"><divide id="S2.E2.m1.17.17.18.cmml" xref="S2.E2.m1.17.17"></divide><apply id="S2.E2.m1.5.5.5.cmml" xref="S2.E2.m1.5.5.5"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.6.cmml" xref="S2.E2.m1.5.5.5">superscript</csymbol><ci id="S2.E2.m1.5.5.5.7.cmml" xref="S2.E2.m1.5.5.5.7">𝑒</ci><apply id="S2.E2.m1.5.5.5.5.5.cmml" xref="S2.E2.m1.5.5.5.5.5"><divide id="S2.E2.m1.5.5.5.5.5.6.cmml" xref="S2.E2.m1.5.5.5.5.5.6"></divide><apply id="S2.E2.m1.5.5.5.5.5.5.cmml" xref="S2.E2.m1.5.5.5.5.5.5"><times id="S2.E2.m1.5.5.5.5.5.5.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.2"></times><apply id="S2.E2.m1.5.5.5.5.5.5.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.1.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1">superscript</csymbol><apply id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1">subscript</csymbol><apply id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1">superscript</csymbol><ci id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.2">𝐳</ci><ci id="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.E2.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1">𝑇</ci><ci id="S2.E2.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2.2.2.2.2">𝑖</ci></list></apply><ci id="S2.E2.m1.5.5.5.5.5.5.1.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.1.3">𝑇</ci></apply><apply id="S2.E2.m1.5.5.5.5.5.5.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.3.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3">subscript</csymbol><apply id="S2.E2.m1.5.5.5.5.5.5.3.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.3.2.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3">superscript</csymbol><apply id="S2.E2.m1.5.5.5.5.5.5.3.2.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.5.5.5.5.3.2.2.1.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3">superscript</csymbol><ci id="S2.E2.m1.5.5.5.5.5.5.3.2.2.2.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3.2.2.2">𝐳</ci><ci id="S2.E2.m1.5.5.5.5.5.5.3.2.2.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3.2.2.3">′</ci></apply><ci id="S2.E2.m1.5.5.5.5.5.5.3.2.3.cmml" xref="S2.E2.m1.5.5.5.5.5.5.3.2.3">𝑘</ci></apply><list id="S2.E2.m1.4.4.4.4.4.4.2.3.cmml" xref="S2.E2.m1.4.4.4.4.4.4.2.4"><ci id="S2.E2.m1.3.3.3.3.3.3.1.1.cmml" xref="S2.E2.m1.3.3.3.3.3.3.1.1">𝑇</ci><ci id="S2.E2.m1.4.4.4.4.4.4.2.2.cmml" xref="S2.E2.m1.4.4.4.4.4.4.2.2">𝑖</ci></list></apply></apply><ci id="S2.E2.m1.5.5.5.5.5.7.cmml" xref="S2.E2.m1.5.5.5.5.5.7">𝜏</ci></apply></apply><apply id="S2.E2.m1.17.17.17.cmml" xref="S2.E2.m1.17.17.17"><plus id="S2.E2.m1.17.17.17.13.cmml" xref="S2.E2.m1.17.17.17.13"></plus><apply id="S2.E2.m1.17.17.17.14.cmml" xref="S2.E2.m1.17.17.17.14"><apply id="S2.E2.m1.17.17.17.14.1.cmml" xref="S2.E2.m1.17.17.17.14.1"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.14.1.1.cmml" xref="S2.E2.m1.17.17.17.14.1">subscript</csymbol><apply id="S2.E2.m1.17.17.17.14.1.2.cmml" xref="S2.E2.m1.17.17.17.14.1"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.14.1.2.1.cmml" xref="S2.E2.m1.17.17.17.14.1">superscript</csymbol><sum id="S2.E2.m1.17.17.17.14.1.2.2.cmml" xref="S2.E2.m1.17.17.17.14.1.2.2"></sum><ci id="S2.E2.m1.17.17.17.14.1.2.3.cmml" xref="S2.E2.m1.17.17.17.14.1.2.3">𝐵</ci></apply><apply id="S2.E2.m1.7.7.7.2.2.3.cmml" xref="S2.E2.m1.7.7.7.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.7.2.2.3a.cmml" xref="S2.E2.m1.7.7.7.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.6.6.6.1.1.1.1.cmml" xref="S2.E2.m1.6.6.6.1.1.1.1"><eq id="S2.E2.m1.6.6.6.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.6.1.1.1.1.1"></eq><ci id="S2.E2.m1.6.6.6.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.6.1.1.1.1.2">𝑗</ci><cn type="integer" id="S2.E2.m1.6.6.6.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.6.1.1.1.1.3">1</cn></apply><apply id="S2.E2.m1.7.7.7.2.2.2.2.cmml" xref="S2.E2.m1.7.7.7.2.2.2.2"><neq id="S2.E2.m1.7.7.7.2.2.2.2.1.cmml" xref="S2.E2.m1.7.7.7.2.2.2.2.1"></neq><ci id="S2.E2.m1.7.7.7.2.2.2.2.2.cmml" xref="S2.E2.m1.7.7.7.2.2.2.2.2">𝑖</ci><ci id="S2.E2.m1.7.7.7.2.2.2.2.3.cmml" xref="S2.E2.m1.7.7.7.2.2.2.2.3">𝑗</ci></apply></apply></apply><apply id="S2.E2.m1.17.17.17.14.2.cmml" xref="S2.E2.m1.17.17.17.14.2"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.14.2.1.cmml" xref="S2.E2.m1.17.17.17.14.2">superscript</csymbol><ci id="S2.E2.m1.17.17.17.14.2.2.cmml" xref="S2.E2.m1.17.17.17.14.2.2">𝑒</ci><apply id="S2.E2.m1.12.12.12.7.5.cmml" xref="S2.E2.m1.12.12.12.7.5"><divide id="S2.E2.m1.12.12.12.7.5.6.cmml" xref="S2.E2.m1.12.12.12.7.5.6"></divide><apply id="S2.E2.m1.12.12.12.7.5.5.cmml" xref="S2.E2.m1.12.12.12.7.5.5"><times id="S2.E2.m1.12.12.12.7.5.5.2.cmml" xref="S2.E2.m1.12.12.12.7.5.5.2"></times><apply id="S2.E2.m1.12.12.12.7.5.5.1.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.7.5.5.1.2.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1">superscript</csymbol><apply id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1">subscript</csymbol><apply id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1">superscript</csymbol><ci id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.2">𝐳</ci><ci id="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.3.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.E2.m1.9.9.9.4.2.2.2.3.cmml" xref="S2.E2.m1.9.9.9.4.2.2.2.4"><ci id="S2.E2.m1.8.8.8.3.1.1.1.1.cmml" xref="S2.E2.m1.8.8.8.3.1.1.1.1">𝑇</ci><ci id="S2.E2.m1.9.9.9.4.2.2.2.2.cmml" xref="S2.E2.m1.9.9.9.4.2.2.2.2">𝑖</ci></list></apply><ci id="S2.E2.m1.12.12.12.7.5.5.1.3.cmml" xref="S2.E2.m1.12.12.12.7.5.5.1.3">𝑇</ci></apply><apply id="S2.E2.m1.12.12.12.7.5.5.3.cmml" xref="S2.E2.m1.12.12.12.7.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.7.5.5.3.1.cmml" xref="S2.E2.m1.12.12.12.7.5.5.3">subscript</csymbol><apply id="S2.E2.m1.12.12.12.7.5.5.3.2.cmml" xref="S2.E2.m1.12.12.12.7.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.12.12.12.7.5.5.3.2.1.cmml" xref="S2.E2.m1.12.12.12.7.5.5.3">superscript</csymbol><ci id="S2.E2.m1.12.12.12.7.5.5.3.2.2.cmml" xref="S2.E2.m1.12.12.12.7.5.5.3.2.2">𝐳</ci><ci id="S2.E2.m1.12.12.12.7.5.5.3.2.3.cmml" xref="S2.E2.m1.12.12.12.7.5.5.3.2.3">𝑘</ci></apply><list id="S2.E2.m1.11.11.11.6.4.4.2.3.cmml" xref="S2.E2.m1.11.11.11.6.4.4.2.4"><ci id="S2.E2.m1.10.10.10.5.3.3.1.1.cmml" xref="S2.E2.m1.10.10.10.5.3.3.1.1">𝑇</ci><ci id="S2.E2.m1.11.11.11.6.4.4.2.2.cmml" xref="S2.E2.m1.11.11.11.6.4.4.2.2">𝑗</ci></list></apply></apply><ci id="S2.E2.m1.12.12.12.7.5.7.cmml" xref="S2.E2.m1.12.12.12.7.5.7">𝜏</ci></apply></apply></apply><apply id="S2.E2.m1.17.17.17.15.cmml" xref="S2.E2.m1.17.17.17.15"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.15.1.cmml" xref="S2.E2.m1.17.17.17.15">superscript</csymbol><ci id="S2.E2.m1.17.17.17.15.2.cmml" xref="S2.E2.m1.17.17.17.15.2">𝑒</ci><apply id="S2.E2.m1.17.17.17.12.5.cmml" xref="S2.E2.m1.17.17.17.12.5"><divide id="S2.E2.m1.17.17.17.12.5.6.cmml" xref="S2.E2.m1.17.17.17.12.5.6"></divide><apply id="S2.E2.m1.17.17.17.12.5.5.cmml" xref="S2.E2.m1.17.17.17.12.5.5"><times id="S2.E2.m1.17.17.17.12.5.5.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.2"></times><apply id="S2.E2.m1.17.17.17.12.5.5.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.12.5.5.1.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1">superscript</csymbol><apply id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1">subscript</csymbol><apply id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1">superscript</csymbol><ci id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.2">𝐳</ci><ci id="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.3.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.1.1.1.2.3">𝑘</ci></apply><list id="S2.E2.m1.14.14.14.9.2.2.2.3.cmml" xref="S2.E2.m1.14.14.14.9.2.2.2.4"><ci id="S2.E2.m1.13.13.13.8.1.1.1.1.cmml" xref="S2.E2.m1.13.13.13.8.1.1.1.1">𝑇</ci><ci id="S2.E2.m1.14.14.14.9.2.2.2.2.cmml" xref="S2.E2.m1.14.14.14.9.2.2.2.2">𝑖</ci></list></apply><ci id="S2.E2.m1.17.17.17.12.5.5.1.3.cmml" xref="S2.E2.m1.17.17.17.12.5.5.1.3">𝑇</ci></apply><apply id="S2.E2.m1.17.17.17.12.5.5.3.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.12.5.5.3.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3">subscript</csymbol><apply id="S2.E2.m1.17.17.17.12.5.5.3.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.12.5.5.3.2.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3">superscript</csymbol><apply id="S2.E2.m1.17.17.17.12.5.5.3.2.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3"><csymbol cd="ambiguous" id="S2.E2.m1.17.17.17.12.5.5.3.2.2.1.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3">superscript</csymbol><ci id="S2.E2.m1.17.17.17.12.5.5.3.2.2.2.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3.2.2.2">𝐳</ci><ci id="S2.E2.m1.17.17.17.12.5.5.3.2.2.3.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3.2.2.3">′</ci></apply><ci id="S2.E2.m1.17.17.17.12.5.5.3.2.3.cmml" xref="S2.E2.m1.17.17.17.12.5.5.3.2.3">𝑘</ci></apply><list id="S2.E2.m1.16.16.16.11.4.4.2.3.cmml" xref="S2.E2.m1.16.16.16.11.4.4.2.4"><ci id="S2.E2.m1.15.15.15.10.3.3.1.1.cmml" xref="S2.E2.m1.15.15.15.10.3.3.1.1">𝑇</ci><ci id="S2.E2.m1.16.16.16.11.4.4.2.2.cmml" xref="S2.E2.m1.16.16.16.11.4.4.2.2">𝑖</ci></list></apply></apply><ci id="S2.E2.m1.17.17.17.12.5.7.cmml" xref="S2.E2.m1.17.17.17.12.5.7">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.17c">\mathcal{L}^{L\rightarrow S}_{i}=-\log\frac{e^{(\mathbf{z}^{k}_{T,i})^{T}\mathbf{z^{\prime}}^{k}_{T,i}/\tau}}{\sum^{B}_{j=1,i\neq j}e^{(\mathbf{z}^{k}_{T,i})^{T}\mathbf{z}^{k}_{T,j}/\tau}+e^{(\mathbf{z}^{k}_{T,i})^{T}\mathbf{z^{\prime}}^{k}_{T,i}/\tau}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS4.p3" class="ltx_para">
<p id="S2.SS4.p3.1" class="ltx_p">We define the edge side loss <math id="S2.SS4.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}^{S\rightarrow L}_{i}" display="inline"><semantics id="S2.SS4.p3.1.m1.1a"><msubsup id="S2.SS4.p3.1.m1.1.1" xref="S2.SS4.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS4.p3.1.m1.1.1.2.2" xref="S2.SS4.p3.1.m1.1.1.2.2.cmml">ℒ</mi><mi id="S2.SS4.p3.1.m1.1.1.3" xref="S2.SS4.p3.1.m1.1.1.3.cmml">i</mi><mrow id="S2.SS4.p3.1.m1.1.1.2.3" xref="S2.SS4.p3.1.m1.1.1.2.3.cmml"><mi id="S2.SS4.p3.1.m1.1.1.2.3.2" xref="S2.SS4.p3.1.m1.1.1.2.3.2.cmml">S</mi><mo stretchy="false" id="S2.SS4.p3.1.m1.1.1.2.3.1" xref="S2.SS4.p3.1.m1.1.1.2.3.1.cmml">→</mo><mi id="S2.SS4.p3.1.m1.1.1.2.3.3" xref="S2.SS4.p3.1.m1.1.1.2.3.3.cmml">L</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.1b"><apply id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">subscript</csymbol><apply id="S2.SS4.p3.1.m1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.1.1.2.1.cmml" xref="S2.SS4.p3.1.m1.1.1">superscript</csymbol><ci id="S2.SS4.p3.1.m1.1.1.2.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2.2">ℒ</ci><apply id="S2.SS4.p3.1.m1.1.1.2.3.cmml" xref="S2.SS4.p3.1.m1.1.1.2.3"><ci id="S2.SS4.p3.1.m1.1.1.2.3.1.cmml" xref="S2.SS4.p3.1.m1.1.1.2.3.1">→</ci><ci id="S2.SS4.p3.1.m1.1.1.2.3.2.cmml" xref="S2.SS4.p3.1.m1.1.1.2.3.2">𝑆</ci><ci id="S2.SS4.p3.1.m1.1.1.2.3.3.cmml" xref="S2.SS4.p3.1.m1.1.1.2.3.3">𝐿</ci></apply></apply><ci id="S2.SS4.p3.1.m1.1.1.3.cmml" xref="S2.SS4.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.1c">\mathcal{L}^{S\rightarrow L}_{i}</annotation></semantics></math> similarly.</p>
</div>
</section>
<section id="S2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Learning Algorithm</h3>

<div id="S2.SS5.p1" class="ltx_para">
<p id="S2.SS5.p1.1" class="ltx_p">Unlike training centralized contrastive models, PartialFL needs to optimize the server model and the edge models asynchronously. To optimize the edge model and the server model in such manner, we use alternating minimization (AM) similar to FedGKT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, where we alternatively fix one model and optimize the other. The full algorithm is presented in Appendix <a href="#A3" title="Appendix C Learning Algorithm ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
</section>
<section id="S2.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6 </span>Implementation</h3>

<div id="S2.SS6.p1" class="ltx_para">
<p id="S2.SS6.p1.1" class="ltx_p">We use PyTorch to implement the PartialFL and the other baselines. In this study, we experiment with two popular FL algorithms: FedAvg and FedProx. We fix the weight of the proximal loss in FedProx as 0.01.
We fix the number of edge devices as 200. When experimenting with the Food-101 data set, we choose the edge sample rate in each training round as 10%. On the other hand, we regard each speaker as a separate client in the emotion recognition task as it provides a natural data split in the FL. Since there are fewer clients in emotion recognition data sets, we decide to use an edge sample rate of 50% in each global training round.</p>
</div>
</section>
<section id="S2.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7 </span>Hyper-parameters</h3>

<div id="S2.SS7.p1" class="ltx_para">
<p id="S2.SS7.p1.5" class="ltx_p">We set the local training batch size as 16 and the local training epoch as 1 in all FL algorithms. We set the learning rate as 0.0001 and 0.0005 in training the emotion recognition task and Food-101 classification tasks, respectively. We apply the Adam optimizer in all experiments. The global training round is 150 in the emotion recognition task and 200 in the Food-101 data set. In PartialFL, we explore the temperature parameter <math id="S2.SS7.p1.1.m1.3" class="ltx_Math" alttext="\tau\in\{0.05,0.1,0.2\}" display="inline"><semantics id="S2.SS7.p1.1.m1.3a"><mrow id="S2.SS7.p1.1.m1.3.4" xref="S2.SS7.p1.1.m1.3.4.cmml"><mi id="S2.SS7.p1.1.m1.3.4.2" xref="S2.SS7.p1.1.m1.3.4.2.cmml">τ</mi><mo id="S2.SS7.p1.1.m1.3.4.1" xref="S2.SS7.p1.1.m1.3.4.1.cmml">∈</mo><mrow id="S2.SS7.p1.1.m1.3.4.3.2" xref="S2.SS7.p1.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S2.SS7.p1.1.m1.3.4.3.2.1" xref="S2.SS7.p1.1.m1.3.4.3.1.cmml">{</mo><mn id="S2.SS7.p1.1.m1.1.1" xref="S2.SS7.p1.1.m1.1.1.cmml">0.05</mn><mo id="S2.SS7.p1.1.m1.3.4.3.2.2" xref="S2.SS7.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S2.SS7.p1.1.m1.2.2" xref="S2.SS7.p1.1.m1.2.2.cmml">0.1</mn><mo id="S2.SS7.p1.1.m1.3.4.3.2.3" xref="S2.SS7.p1.1.m1.3.4.3.1.cmml">,</mo><mn id="S2.SS7.p1.1.m1.3.3" xref="S2.SS7.p1.1.m1.3.3.cmml">0.2</mn><mo stretchy="false" id="S2.SS7.p1.1.m1.3.4.3.2.4" xref="S2.SS7.p1.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p1.1.m1.3b"><apply id="S2.SS7.p1.1.m1.3.4.cmml" xref="S2.SS7.p1.1.m1.3.4"><in id="S2.SS7.p1.1.m1.3.4.1.cmml" xref="S2.SS7.p1.1.m1.3.4.1"></in><ci id="S2.SS7.p1.1.m1.3.4.2.cmml" xref="S2.SS7.p1.1.m1.3.4.2">𝜏</ci><set id="S2.SS7.p1.1.m1.3.4.3.1.cmml" xref="S2.SS7.p1.1.m1.3.4.3.2"><cn type="float" id="S2.SS7.p1.1.m1.1.1.cmml" xref="S2.SS7.p1.1.m1.1.1">0.05</cn><cn type="float" id="S2.SS7.p1.1.m1.2.2.cmml" xref="S2.SS7.p1.1.m1.2.2">0.1</cn><cn type="float" id="S2.SS7.p1.1.m1.3.3.cmml" xref="S2.SS7.p1.1.m1.3.3">0.2</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p1.1.m1.3c">\tau\in\{0.05,0.1,0.2\}</annotation></semantics></math>. We tune the weight <math id="S2.SS7.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS7.p1.2.m2.1a"><mi id="S2.SS7.p1.2.m2.1.1" xref="S2.SS7.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS7.p1.2.m2.1b"><ci id="S2.SS7.p1.2.m2.1.1.cmml" xref="S2.SS7.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p1.2.m2.1c">\beta</annotation></semantics></math> in both <math id="S2.SS7.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{glob}" display="inline"><semantics id="S2.SS7.p1.3.m3.1a"><msub id="S2.SS7.p1.3.m3.1.1" xref="S2.SS7.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS7.p1.3.m3.1.1.2" xref="S2.SS7.p1.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S2.SS7.p1.3.m3.1.1.3" xref="S2.SS7.p1.3.m3.1.1.3.cmml"><mi id="S2.SS7.p1.3.m3.1.1.3.2" xref="S2.SS7.p1.3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.SS7.p1.3.m3.1.1.3.1" xref="S2.SS7.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS7.p1.3.m3.1.1.3.3" xref="S2.SS7.p1.3.m3.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS7.p1.3.m3.1.1.3.1a" xref="S2.SS7.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS7.p1.3.m3.1.1.3.4" xref="S2.SS7.p1.3.m3.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS7.p1.3.m3.1.1.3.1b" xref="S2.SS7.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS7.p1.3.m3.1.1.3.5" xref="S2.SS7.p1.3.m3.1.1.3.5.cmml">b</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS7.p1.3.m3.1b"><apply id="S2.SS7.p1.3.m3.1.1.cmml" xref="S2.SS7.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS7.p1.3.m3.1.1.1.cmml" xref="S2.SS7.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS7.p1.3.m3.1.1.2.cmml" xref="S2.SS7.p1.3.m3.1.1.2">ℒ</ci><apply id="S2.SS7.p1.3.m3.1.1.3.cmml" xref="S2.SS7.p1.3.m3.1.1.3"><times id="S2.SS7.p1.3.m3.1.1.3.1.cmml" xref="S2.SS7.p1.3.m3.1.1.3.1"></times><ci id="S2.SS7.p1.3.m3.1.1.3.2.cmml" xref="S2.SS7.p1.3.m3.1.1.3.2">𝑔</ci><ci id="S2.SS7.p1.3.m3.1.1.3.3.cmml" xref="S2.SS7.p1.3.m3.1.1.3.3">𝑙</ci><ci id="S2.SS7.p1.3.m3.1.1.3.4.cmml" xref="S2.SS7.p1.3.m3.1.1.3.4">𝑜</ci><ci id="S2.SS7.p1.3.m3.1.1.3.5.cmml" xref="S2.SS7.p1.3.m3.1.1.3.5">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p1.3.m3.1c">\mathcal{L}_{glob}</annotation></semantics></math> and <math id="S2.SS7.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{L}_{loc}" display="inline"><semantics id="S2.SS7.p1.4.m4.1a"><msub id="S2.SS7.p1.4.m4.1.1" xref="S2.SS7.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS7.p1.4.m4.1.1.2" xref="S2.SS7.p1.4.m4.1.1.2.cmml">ℒ</mi><mrow id="S2.SS7.p1.4.m4.1.1.3" xref="S2.SS7.p1.4.m4.1.1.3.cmml"><mi id="S2.SS7.p1.4.m4.1.1.3.2" xref="S2.SS7.p1.4.m4.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS7.p1.4.m4.1.1.3.1" xref="S2.SS7.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS7.p1.4.m4.1.1.3.3" xref="S2.SS7.p1.4.m4.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.SS7.p1.4.m4.1.1.3.1a" xref="S2.SS7.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS7.p1.4.m4.1.1.3.4" xref="S2.SS7.p1.4.m4.1.1.3.4.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS7.p1.4.m4.1b"><apply id="S2.SS7.p1.4.m4.1.1.cmml" xref="S2.SS7.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS7.p1.4.m4.1.1.1.cmml" xref="S2.SS7.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS7.p1.4.m4.1.1.2.cmml" xref="S2.SS7.p1.4.m4.1.1.2">ℒ</ci><apply id="S2.SS7.p1.4.m4.1.1.3.cmml" xref="S2.SS7.p1.4.m4.1.1.3"><times id="S2.SS7.p1.4.m4.1.1.3.1.cmml" xref="S2.SS7.p1.4.m4.1.1.3.1"></times><ci id="S2.SS7.p1.4.m4.1.1.3.2.cmml" xref="S2.SS7.p1.4.m4.1.1.3.2">𝑙</ci><ci id="S2.SS7.p1.4.m4.1.1.3.3.cmml" xref="S2.SS7.p1.4.m4.1.1.3.3">𝑜</ci><ci id="S2.SS7.p1.4.m4.1.1.3.4.cmml" xref="S2.SS7.p1.4.m4.1.1.3.4">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p1.4.m4.1c">\mathcal{L}_{loc}</annotation></semantics></math> in <math id="S2.SS7.p1.5.m5.2" class="ltx_Math" alttext="\{0.001,0.01\}" display="inline"><semantics id="S2.SS7.p1.5.m5.2a"><mrow id="S2.SS7.p1.5.m5.2.3.2" xref="S2.SS7.p1.5.m5.2.3.1.cmml"><mo stretchy="false" id="S2.SS7.p1.5.m5.2.3.2.1" xref="S2.SS7.p1.5.m5.2.3.1.cmml">{</mo><mn id="S2.SS7.p1.5.m5.1.1" xref="S2.SS7.p1.5.m5.1.1.cmml">0.001</mn><mo id="S2.SS7.p1.5.m5.2.3.2.2" xref="S2.SS7.p1.5.m5.2.3.1.cmml">,</mo><mn id="S2.SS7.p1.5.m5.2.2" xref="S2.SS7.p1.5.m5.2.2.cmml">0.01</mn><mo stretchy="false" id="S2.SS7.p1.5.m5.2.3.2.3" xref="S2.SS7.p1.5.m5.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS7.p1.5.m5.2b"><set id="S2.SS7.p1.5.m5.2.3.1.cmml" xref="S2.SS7.p1.5.m5.2.3.2"><cn type="float" id="S2.SS7.p1.5.m5.1.1.cmml" xref="S2.SS7.p1.5.m5.1.1">0.001</cn><cn type="float" id="S2.SS7.p1.5.m5.2.2.cmml" xref="S2.SS7.p1.5.m5.2.2">0.01</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS7.p1.5.m5.2c">\{0.001,0.01\}</annotation></semantics></math> in training emotion recognition models.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We evaluate the PartialFL algorithm on two datasets from the Speech Emotion Recognition task (SER): IEMOCAP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> which contains utterances from ten subjects expressing various categorical emotions, and MSP-Improv <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> which contains multi-modal emotion recognition data set collected from 12 speakers. Additional details on all our datasets and models are provided in Appendix <a href="#A4" title="Appendix D Experiment Details ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>. We also present results on image classification task from the Food101 dataset along with detailed ablation studies in Appendix <a href="#A5" title="Appendix E Additional Results ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2403.01615/assets/x1.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="392" height="107" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2403.01615/assets/x2.png" id="S3.F2.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="392" height="107" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>Model performance for the IEMOCAP and MSP-Improv data set. PartialFL considerably outperforms FL and SL and has performance close to the Centralized upper bound.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Baselines</h3>

<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Centralized</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">Here we assume that all data modalities are available in one central server for training in both uni-modal and multi-modal settings. Since we are no longer limited by edge size computational power, this acts as an upper limit for the model performance.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Split Learning</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">We also implemented split learning to compare against our model. We set model size to be same as in the centralized baseline, and it serves as an upper bound for decentralized training. However, split learning incurs significant communication costs in practice compared to typical federated learning (refer to Section 3.3 in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> for a comparison of training times for both algorithms).</p>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Federated Learning</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.1" class="ltx_p">Finally, we also compare against a typical FL baseline. We experiment with both FedAvg and FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> variants of FL, and set the global model size to be same as PartialFL for a fair comparison.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We report unweighted average recall (UAR) score to measure the model performance. We use each recording session as a separate test fold, and repeat the training 5 and 6 times on the IEMOCAP and the MSP-Improv data sets respectively.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Uni-model global model (audio only)</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Full results from our experiments are shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3 Experiments ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>; PartialFL showed stronger results than both FedProx and FedAvg in both datasets, but especially so in IEMOCAP, where we observed nearly 4.00% improvement.
Further, PartialFL approaches the performance of the centralized and split learning baselines by leveraging the additional data modality leading to improved robustness, while still retaining the benefits of federated learning.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Multi-modal global model (audio+text)</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this setting, we observed stronger performance in the centralized and SL baselines, with SL surprisingly outperforming centralized training in both data sets. However, similar to the previous experiments, PartialFL consistently outperforms both FL baselines, with overall improvement in the range of 1.0-2.0%, highlighting the robustness of our proposed approach.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We propose a novel Federated Learning framework called PartialFL with a goal of addressing the heterogeneity challenge in FL and improve the final model performance. Unlike traditional FL, PartialFL allows some modalities to be shared with the server which enables us to train a robust embedding network over the shared modality in the server.
We experiment with multiple multi-modal data sets and report strong performance against three baselines. We observe that PartialFL consistently outperforms traditional FL in all tasks, and approaches the performance of centralized models, as well as split learning without any of its communication overhead or straggler problems.
Future work includes deploying PartialFL in real world applications to further evaluate its efficacy.
</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Umut Uludag, Sharath Pankanti, Salil Prabhakar, and Anil K Jain,

</span>
<span class="ltx_bibblock">“Biometric cryptosystems: issues and challenges,”

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, vol. 92, no. 6, pp. 948–960, 2004.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
SB-1189,

</span>
<span class="ltx_bibblock">“California bio-metric privacy law,”
<a target="_blank" href="https://leginfo.legislature.ca.gov/faces/billTextClient.xhtml?bill_id=202120220SB1189" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://leginfo.legislature.ca.gov/faces/billTextClient.xhtml?bill_id=202120220SB1189</a>,
2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
BIPA,

</span>
<span class="ltx_bibblock">“Illinois biometric information privacy act,”
<a target="_blank" href="https://www.ilga.gov/legislation/ilcs/ilcs3.asp?ActID=3004&amp;ChapterID=57" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.ilga.gov/legislation/ilcs/ilcs3.asp?ActID=3004&amp;ChapterID=57</a>,
2008.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jiayi Chen and Aidong Zhang,

</span>
<span class="ltx_bibblock">“Fedmsplit: Correlation-adaptive federated multi-task learning
across multimodal split networks,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Proceedings of the 28th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining</span>, 2022, pp. 87–96.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Tiantian Feng, Digbalay Bose, Tuo Zhang, Rajat Hebbar, Anil Ramakrishna, Rahul
Gupta, Mi Zhang, Salman Avestimehr, and Shrikanth Narayanan,

</span>
<span class="ltx_bibblock">“Fedmultimodal: A benchmark for multimodal federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2306.09486</span>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong,

</span>
<span class="ltx_bibblock">“Federated machine learning: Concept and applications,”

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">ACM Transactions on Intelligent Systems and Technology (TIST)</span>,
vol. 10, no. 2, pp. 1–19, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Victor Sanh, Lysandre Debut, Julien Chaumond, and Thomas Wolf,

</span>
<span class="ltx_bibblock">“Distilbert, a distilled version of bert: smaller, faster, cheaper
and lighter,”

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1910.01108</span>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Rahul Sharma, Anil Ramakrishna, Ansel MacLaughlin, Anna Rumshisky, Jimit
Majmudar, Clement Chung, Salman Avestimehr, and Rahul Gupta,

</span>
<span class="ltx_bibblock">“Federated learning with noisy user feedback,”

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2205.03092</span>, 2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Jakub Konečnỳ, H Brendan McMahan, Felix X Yu, Peter Richtárik,
Ananda Theertha Suresh, and Dave Bacon,

</span>
<span class="ltx_bibblock">“Federated learning: Strategies for improving communication
efficiency,”

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1610.05492</span>, 2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith,

</span>
<span class="ltx_bibblock">“Federated optimization in heterogeneous networks,”

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, vol. 2, pp.
429–450, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh,

</span>
<span class="ltx_bibblock">“Scaffold: Stochastic controlled averaging for federated learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2020,
pp. 5132–5143.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Qinbin Li, Bingsheng He, and Dawn Song,

</span>
<span class="ltx_bibblock">“Model-contrastive federated learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span>, 2021, pp. 10713–10722.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Valentin Gabeur, Chen Sun, Karteek Alahari, and Cordelia Schmid,

</span>
<span class="ltx_bibblock">“Multi-modal transformer for video retrieval,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision</span>. Springer, 2020, pp.
214–229.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Simon Ging, Mohammadreza Zolfaghari, Hamed Pirsiavash, and Thomas Brox,

</span>
<span class="ltx_bibblock">“Coot: Cooperative hierarchical transformer for video-text
representation learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, vol. 33, pp.
22605–22618, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Mohammadreza Zolfaghari, Yi Zhu, Peter Gehler, and Thomas Brox,

</span>
<span class="ltx_bibblock">“Crossclr: Cross-modal contrastive learning for multi-modal video
representations,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span>, 2021, pp. 1450–1459.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Chaoyang He, Murali Annavaram, and Salman Avestimehr,

</span>
<span class="ltx_bibblock">“Group knowledge transfer: Federated learning of large cnns at the
edge,”

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 33, pp.
14068–14080, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Carlos Busso, Murtaza Bulut, Chi-Chun Lee, Abe Kazemzadeh, Emily Mower, Samuel
Kim, Jeannette N Chang, Sungbok Lee, and Shrikanth S Narayanan,

</span>
<span class="ltx_bibblock">“IEMOCAP: Interactive emotional dyadic motion capture database,”

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Language resources and evaluation</span>, vol. 42, no. 4, pp.
335–359, 2008.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Carlos Busso, Srinivas Parthasarathy, Alec Burmania, Mohammed AbdelWahab,
Najmeh Sadoughi, and Emily Mower Provost,

</span>
<span class="ltx_bibblock">“Msp-improv: An acted corpus of dyadic interactions to study emotion
perception,”

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Affective Computing</span>, vol. 8, no. 1, pp.
67–80, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Chandra Thapa, Pathum Chamikara Mahawaga Arachchige, Seyit Camtepe, and Lichao
Sun,

</span>
<span class="ltx_bibblock">“Splitfed: When federated learning meets split learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, 2022, vol. 36, pp. 8485–8493.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Ligeng Zhu, Zhijian Liu, and Song Han,

</span>
<span class="ltx_bibblock">“Deep leakage from gradients,”

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, vol. 32,
2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Chong Fu, Xuhong Zhang, Shouling Ji, Jinyin Chen, Jingzheng Wu, Shanqing Guo,
Jun Zhou, Alex X Liu, and Ting Wang,

</span>
<span class="ltx_bibblock">“Label inference attacks against vertical federated learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">31st USENIX Security Symposium (USENIX Security 22), Boston,
MA</span>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Tiantian Feng, Hanieh Hashemi, Rajat Hebbar, Murali Annavaram, and Shrikanth S
Narayanan,

</span>
<span class="ltx_bibblock">“Attribute inference attack of speech emotion recognition in
federated learning settings,”

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2112.13416</span>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Otkrist Gupta and Ramesh Raskar,

</span>
<span class="ltx_bibblock">“Distributed learning of deep neural network over multiple agents,”

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Journal of Network and Computer Applications</span>, vol. 116, pp.
1–8, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Baochen Xiong, Xiaoshan Yang, Fan Qi, and Changsheng Xu,

</span>
<span class="ltx_bibblock">“A unified framework for multi-modal federated learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Neurocomputing</span>, vol. 480, pp. 110–118, 2022.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Qiying Yu, Yang Liu, Yimu Wang, Ke Xu, and Jingjing Liu,

</span>
<span class="ltx_bibblock">“Multimodal federated learning via contrastive representation
ensemble,”

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2302.08888</span>, 2023.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Yuanyuan Zhang, Jun Du, Zirui Wang, Jianshu Zhang, and Yanhui Tu,

</span>
<span class="ltx_bibblock">“Attention based fully convolutional network for speech emotion
recognition,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">2018 Asia-Pacific Signal and Information Processing
Association Annual Summit and Conference (APSIPA ASC)</span>. IEEE, 2018, pp.
1771–1775.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Xin Wang, Devinder Kumar, Nicolas Thome, Matthieu Cord, and Frederic Precioso,

</span>
<span class="ltx_bibblock">“Recipe recognition with large multimodal food dataset,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">2015 IEEE International Conference on Multimedia &amp; Expo
Workshops (ICMEW)</span>. IEEE, 2015, pp. 1–6.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Mimansa Jaiswal and Emily Mower Provost,

</span>
<span class="ltx_bibblock">“Privacy enhanced multimodal neural representations for emotion
recognition,”

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</span>,
vol. 34, no. 05, pp. 7985–7993, Apr. 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Anmol Gulati, James Qin, Chung-Cheng Chiu, Niki Parmar, Yu Zhang, Jiahui Yu,
Wei Han, Shibo Wang, Zhengdong Zhang, Yonghui Wu, et al.,

</span>
<span class="ltx_bibblock">“Conformer: Convolution-augmented transformer for speech
recognition,”

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2005.08100</span>, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Junyoung Chung, Caglar Gulcehre, KyungHyun Cho, and Yoshua Bengio,

</span>
<span class="ltx_bibblock">“Empirical evaluation of gated recurrent neural networks on sequence
modeling,”

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.3555</span>, 2014.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Mark Sandler, Andrew Howard, Menglong Zhu, Andrey Zhmoginov, and Liang-Chieh
Chen,

</span>
<span class="ltx_bibblock">“Mobilenetv2: Inverted residuals and linear bottlenecks,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, 2018, pp. 4510–4520.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Qinbin Li, Yiqun Diao, Quan Chen, and Bingsheng He,

</span>
<span class="ltx_bibblock">“Federated learning on non-iid data silos: An experimental study,”

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2102.02079</span>, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Feng Wang and Huaping Liu,

</span>
<span class="ltx_bibblock">“Understanding the behaviour of contrastive loss,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF conference on computer vision and
pattern recognition</span>, 2021, pp. 2495–2504.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Limitations and Future Work</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">The primarily limitation of our proposed approach is the added computation needed to train local and server models when compared to typical FL model training. Further, since we use pretrained models to extract sentence and image representations, we maybe inadvertently exposed to any underlying dataset biases in these models. We encourage downstream applications of this approach to suitably evaluate the model performance against different demographic cohorts before deployment.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.1" class="ltx_p">Another area of concern is the privacy risk associated with sharing the representation of a modality to the remote server. Many recent studies have demonstrated that FL is vulnerable to privacy attacks such as data reconstruction attacks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, label inference attack <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, and property inference attack <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. In our experiments, we employ preliminary strategies to protect privacy by sharing representations of the shareable modality instead of raw data as well as only sharing representations from modalities without any biometric information (text). Further, we also place a strong constraint in our model training whereby we do not share class labels with the server. Nevertheless, it is still possible that some of aforementioned privacy attacks can achieve high success rates using just the shareable representations. For instance, the privacy attacker may formulate contrastive learning objectives between the model updates and shared representations to implement more effective inference attacks. Our future works plan to extensively investigate the privacy risks associated with sharing modalities in FL.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Related Work</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">Several algorithms have been developed to train with distributed data with disjoint modalities stored on different devices, but each of these have specific drawbacks which we highlight here.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">While we can assume that all modalities are restricted to the edge devices and use traditional FL, this poses challenges for training on low power devices and in cases of high data heterogeneity. <span id="A2.p2.1.1" class="ltx_text ltx_font_italic">Split learning</span> (SL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> is one way to address these concerns by splitting the entire ML model into multiple smaller parts and distributing them on both the central server and edge devices. Each model part can further be constrained to a specific data modality. In a typical SL setting, the first edge device initializes the training by performing forward propagation on local data, and then uploads the <span id="A2.p2.1.2" class="ltx_text ltx_font_italic">smashed</span> data (outermost activations of the local model) and ground-truth labels to the central server. In the next step, the central server continues forward propagation from the <span id="A2.p2.1.3" class="ltx_text ltx_font_italic">smashed</span> data using a server-side model. Then, the server starts back-propagation on its model and sends the gradients at the cut layer back to the edge for local back-propagation. After finishing back-propagation at the first edge device, it shares the trained model to the next edge device, and the training process continues. While this theoretically allows us to train large multi-modal models, the main drawback here is the sequential training process which makes it considerably slower than FL. Further, there is a significant communication overhead for each model update, since we need to propagate the intermediate activations from edge to server in the forward pass and then back in the backward pass, <span id="A2.p2.1.4" class="ltx_text ltx_font_italic">for each data sample and on all the edge devices</span>. In addition, SL can also suffer from server straggler problem as the training process requires frequent communications between the server and the edge devices. In our work, we avoid all of these problems by training device specific encoders until convergence which are then shared with other devices/the centralized server more efficiently (in terms of both communication cost and time). We assume availability of labels on edge for local modal training, but in their absence we can leverage user feedback similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="A2.p3" class="ltx_para">
<p id="A2.p3.1" class="ltx_p">Federated Group Knowledge Transfer (FedGKT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> was originally proposed to address the challenges of training with non-IID datasets; it can also be applied to train a large multi-modal model in a distributed manner since it allows us to train device/modality specific encoders till convergence which are then aggregated centrally using knowledge distillation. However, FedGKT assumes that edge specific labels are also shared with the server which enables them to train a server side classifier till convergence, but these labels may not always be available, or not permitted to be shared freely with the server. For example, patients may prefer not to share their diagnosis information (class labels) outside the hospital. In our work, we therefore avoid label sharing entirely by using a contrastive objective to train the device specific encoders, and show strong model performance without sharing any edge specific labels with the central server.</p>
</div>
<div id="A2.p4" class="ltx_para">
<p id="A2.p4.1" class="ltx_p">Split Federated Learning (SFL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> is a recent work which attempts to bridge SL and FL. However, this also carries heavy communication costs due to the combined overheads of split learning and federated learning, which limits its applications to practical settings. Further, in our experiments, they do not demonstrate any gains in accuracy compared to our baselines.</p>
</div>
<div id="A2.p5" class="ltx_para">
<p id="A2.p5.1" class="ltx_p">Finally, while federated learning has been studied extensively in uni-modal settings, multi-modal federated learning has recently gained attention from several works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Learning Algorithm</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">Detailed training steps are as follows:</p>
</div>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p id="A3.p2.3" class="ltx_p"><span id="A3.p2.3.1" class="ltx_text ltx_font_bold">Step 1 (server):</span> At the beginning of each global round, the server samples the edge devices and sends the global model <math id="A3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{g}(\cdot)" display="inline"><semantics id="A3.p2.1.m1.1a"><mrow id="A3.p2.1.m1.1.2" xref="A3.p2.1.m1.1.2.cmml"><msub id="A3.p2.1.m1.1.2.2" xref="A3.p2.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p2.1.m1.1.2.2.2" xref="A3.p2.1.m1.1.2.2.2.cmml">ℱ</mi><mi id="A3.p2.1.m1.1.2.2.3" xref="A3.p2.1.m1.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="A3.p2.1.m1.1.2.1" xref="A3.p2.1.m1.1.2.1.cmml">​</mo><mrow id="A3.p2.1.m1.1.2.3.2" xref="A3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="A3.p2.1.m1.1.2.3.2.1" xref="A3.p2.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="A3.p2.1.m1.1.2.3.2.2" xref="A3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.2.cmml" xref="A3.p2.1.m1.1.2"><times id="A3.p2.1.m1.1.2.1.cmml" xref="A3.p2.1.m1.1.2.1"></times><apply id="A3.p2.1.m1.1.2.2.cmml" xref="A3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.2.2.1.cmml" xref="A3.p2.1.m1.1.2.2">subscript</csymbol><ci id="A3.p2.1.m1.1.2.2.2.cmml" xref="A3.p2.1.m1.1.2.2.2">ℱ</ci><ci id="A3.p2.1.m1.1.2.2.3.cmml" xref="A3.p2.1.m1.1.2.2.3">𝑔</ci></apply><ci id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">\mathcal{F}_{g}(\cdot)</annotation></semantics></math> parameterized by <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{\theta}_{g}" display="inline"><semantics id="A3.p2.2.m2.1a"><msub id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><mi id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">θ</mi><mi id="A3.p2.2.m2.1.1.3" xref="A3.p2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p2.2.m2.1.1.1.cmml" xref="A3.p2.2.m2.1.1">subscript</csymbol><ci id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2">𝜃</ci><ci id="A3.p2.2.m2.1.1.3.cmml" xref="A3.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">\mathcal{\theta}_{g}</annotation></semantics></math> and <math id="A3.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="A3.p2.3.m3.1a"><msub id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml"><mi id="A3.p2.3.m3.1.1.2" xref="A3.p2.3.m3.1.1.2.cmml">𝐳</mi><mi id="A3.p2.3.m3.1.1.3" xref="A3.p2.3.m3.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><apply id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.cmml" xref="A3.p2.3.m3.1.1">subscript</csymbol><ci id="A3.p2.3.m3.1.1.2.cmml" xref="A3.p2.3.m3.1.1.2">𝐳</ci><ci id="A3.p2.3.m3.1.1.3.cmml" xref="A3.p2.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">\mathbf{z_{T}}</annotation></semantics></math> to each device.</p>
</div>
<div id="A3.p3" class="ltx_para ltx_noindent">
<p id="A3.p3.7" class="ltx_p"><span id="A3.p3.7.1" class="ltx_text ltx_font_bold">Step 2 (edge):</span> After receiving <math id="A3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{\theta}_{g}" display="inline"><semantics id="A3.p3.1.m1.1a"><msub id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml"><mi id="A3.p3.1.m1.1.1.2" xref="A3.p3.1.m1.1.1.2.cmml">θ</mi><mi id="A3.p3.1.m1.1.1.3" xref="A3.p3.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><apply id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.1.m1.1.1.1.cmml" xref="A3.p3.1.m1.1.1">subscript</csymbol><ci id="A3.p3.1.m1.1.1.2.cmml" xref="A3.p3.1.m1.1.1.2">𝜃</ci><ci id="A3.p3.1.m1.1.1.3.cmml" xref="A3.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">\mathcal{\theta}_{g}</annotation></semantics></math> and the server side embeddings <math id="A3.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{z}^{k}_{T}" display="inline"><semantics id="A3.p3.2.m2.1a"><msubsup id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml"><mi id="A3.p3.2.m2.1.1.2.2" xref="A3.p3.2.m2.1.1.2.2.cmml">𝐳</mi><mi id="A3.p3.2.m2.1.1.3" xref="A3.p3.2.m2.1.1.3.cmml">T</mi><mi id="A3.p3.2.m2.1.1.2.3" xref="A3.p3.2.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><apply id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.1.cmml" xref="A3.p3.2.m2.1.1">subscript</csymbol><apply id="A3.p3.2.m2.1.1.2.cmml" xref="A3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p3.2.m2.1.1.2.1.cmml" xref="A3.p3.2.m2.1.1">superscript</csymbol><ci id="A3.p3.2.m2.1.1.2.2.cmml" xref="A3.p3.2.m2.1.1.2.2">𝐳</ci><ci id="A3.p3.2.m2.1.1.2.3.cmml" xref="A3.p3.2.m2.1.1.2.3">𝑘</ci></apply><ci id="A3.p3.2.m2.1.1.3.cmml" xref="A3.p3.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">\mathbf{z}^{k}_{T}</annotation></semantics></math>, the edge device trains the global <math id="A3.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{F}_{g}(\cdot)" display="inline"><semantics id="A3.p3.3.m3.1a"><mrow id="A3.p3.3.m3.1.2" xref="A3.p3.3.m3.1.2.cmml"><msub id="A3.p3.3.m3.1.2.2" xref="A3.p3.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.3.m3.1.2.2.2" xref="A3.p3.3.m3.1.2.2.2.cmml">ℱ</mi><mi id="A3.p3.3.m3.1.2.2.3" xref="A3.p3.3.m3.1.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="A3.p3.3.m3.1.2.1" xref="A3.p3.3.m3.1.2.1.cmml">​</mo><mrow id="A3.p3.3.m3.1.2.3.2" xref="A3.p3.3.m3.1.2.cmml"><mo stretchy="false" id="A3.p3.3.m3.1.2.3.2.1" xref="A3.p3.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A3.p3.3.m3.1.1" xref="A3.p3.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="A3.p3.3.m3.1.2.3.2.2" xref="A3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.3.m3.1b"><apply id="A3.p3.3.m3.1.2.cmml" xref="A3.p3.3.m3.1.2"><times id="A3.p3.3.m3.1.2.1.cmml" xref="A3.p3.3.m3.1.2.1"></times><apply id="A3.p3.3.m3.1.2.2.cmml" xref="A3.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="A3.p3.3.m3.1.2.2.1.cmml" xref="A3.p3.3.m3.1.2.2">subscript</csymbol><ci id="A3.p3.3.m3.1.2.2.2.cmml" xref="A3.p3.3.m3.1.2.2.2">ℱ</ci><ci id="A3.p3.3.m3.1.2.2.3.cmml" xref="A3.p3.3.m3.1.2.2.3">𝑔</ci></apply><ci id="A3.p3.3.m3.1.1.cmml" xref="A3.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.3.m3.1c">\mathcal{F}_{g}(\cdot)</annotation></semantics></math> on its local image data <math id="A3.p3.4.m4.1" class="ltx_Math" alttext="\mathbf{X_{I}}" display="inline"><semantics id="A3.p3.4.m4.1a"><msub id="A3.p3.4.m4.1.1" xref="A3.p3.4.m4.1.1.cmml"><mi id="A3.p3.4.m4.1.1.2" xref="A3.p3.4.m4.1.1.2.cmml">𝐗</mi><mi id="A3.p3.4.m4.1.1.3" xref="A3.p3.4.m4.1.1.3.cmml">𝐈</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.4.m4.1b"><apply id="A3.p3.4.m4.1.1.cmml" xref="A3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p3.4.m4.1.1.1.cmml" xref="A3.p3.4.m4.1.1">subscript</csymbol><ci id="A3.p3.4.m4.1.1.2.cmml" xref="A3.p3.4.m4.1.1.2">𝐗</ci><ci id="A3.p3.4.m4.1.1.3.cmml" xref="A3.p3.4.m4.1.1.3">𝐈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.4.m4.1c">\mathbf{X_{I}}</annotation></semantics></math>. The learning objective is a combination of cross-entropy loss <math id="A3.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="A3.p3.5.m5.1a"><msub id="A3.p3.5.m5.1.1" xref="A3.p3.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.5.m5.1.1.2" xref="A3.p3.5.m5.1.1.2.cmml">ℒ</mi><mrow id="A3.p3.5.m5.1.1.3" xref="A3.p3.5.m5.1.1.3.cmml"><mi id="A3.p3.5.m5.1.1.3.2" xref="A3.p3.5.m5.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A3.p3.5.m5.1.1.3.1" xref="A3.p3.5.m5.1.1.3.1.cmml">​</mo><mi id="A3.p3.5.m5.1.1.3.3" xref="A3.p3.5.m5.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p3.5.m5.1b"><apply id="A3.p3.5.m5.1.1.cmml" xref="A3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A3.p3.5.m5.1.1.1.cmml" xref="A3.p3.5.m5.1.1">subscript</csymbol><ci id="A3.p3.5.m5.1.1.2.cmml" xref="A3.p3.5.m5.1.1.2">ℒ</ci><apply id="A3.p3.5.m5.1.1.3.cmml" xref="A3.p3.5.m5.1.1.3"><times id="A3.p3.5.m5.1.1.3.1.cmml" xref="A3.p3.5.m5.1.1.3.1"></times><ci id="A3.p3.5.m5.1.1.3.2.cmml" xref="A3.p3.5.m5.1.1.3.2">𝐶</ci><ci id="A3.p3.5.m5.1.1.3.3.cmml" xref="A3.p3.5.m5.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.5.m5.1c">\mathcal{L}_{CE}</annotation></semantics></math> and the cross-modal contrastive loss <math id="A3.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{L}^{T\rightarrow I}" display="inline"><semantics id="A3.p3.6.m6.1a"><msup id="A3.p3.6.m6.1.1" xref="A3.p3.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.6.m6.1.1.2" xref="A3.p3.6.m6.1.1.2.cmml">ℒ</mi><mrow id="A3.p3.6.m6.1.1.3" xref="A3.p3.6.m6.1.1.3.cmml"><mi id="A3.p3.6.m6.1.1.3.2" xref="A3.p3.6.m6.1.1.3.2.cmml">T</mi><mo stretchy="false" id="A3.p3.6.m6.1.1.3.1" xref="A3.p3.6.m6.1.1.3.1.cmml">→</mo><mi id="A3.p3.6.m6.1.1.3.3" xref="A3.p3.6.m6.1.1.3.3.cmml">I</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.p3.6.m6.1b"><apply id="A3.p3.6.m6.1.1.cmml" xref="A3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="A3.p3.6.m6.1.1.1.cmml" xref="A3.p3.6.m6.1.1">superscript</csymbol><ci id="A3.p3.6.m6.1.1.2.cmml" xref="A3.p3.6.m6.1.1.2">ℒ</ci><apply id="A3.p3.6.m6.1.1.3.cmml" xref="A3.p3.6.m6.1.1.3"><ci id="A3.p3.6.m6.1.1.3.1.cmml" xref="A3.p3.6.m6.1.1.3.1">→</ci><ci id="A3.p3.6.m6.1.1.3.2.cmml" xref="A3.p3.6.m6.1.1.3.2">𝑇</ci><ci id="A3.p3.6.m6.1.1.3.3.cmml" xref="A3.p3.6.m6.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.6.m6.1c">\mathcal{L}^{T\rightarrow I}</annotation></semantics></math>. We use the weight parameter <math id="A3.p3.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A3.p3.7.m7.1a"><mi id="A3.p3.7.m7.1.1" xref="A3.p3.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A3.p3.7.m7.1b"><ci id="A3.p3.7.m7.1.1.cmml" xref="A3.p3.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.7.m7.1c">\beta</annotation></semantics></math> to set the importance of the cross-modal contrastive loss. The combined loss for the image global model is shown below:</p>
<table id="A3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E3.m1.4" class="ltx_Math" alttext="\mathcal{L}_{glob}=\mathcal{L}_{CE}(\mathcal{F}_{g}(\theta_{g};\mathbf{X}^{k}_{I}),y^{k})+\beta\mathcal{L}^{T\rightarrow I}(\mathbf{z_{I}},\mathbf{z_{T}})" display="block"><semantics id="A3.E3.m1.4a"><mrow id="A3.E3.m1.4.4" xref="A3.E3.m1.4.4.cmml"><msub id="A3.E3.m1.4.4.6" xref="A3.E3.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E3.m1.4.4.6.2" xref="A3.E3.m1.4.4.6.2.cmml">ℒ</mi><mrow id="A3.E3.m1.4.4.6.3" xref="A3.E3.m1.4.4.6.3.cmml"><mi id="A3.E3.m1.4.4.6.3.2" xref="A3.E3.m1.4.4.6.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="A3.E3.m1.4.4.6.3.1" xref="A3.E3.m1.4.4.6.3.1.cmml">​</mo><mi id="A3.E3.m1.4.4.6.3.3" xref="A3.E3.m1.4.4.6.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="A3.E3.m1.4.4.6.3.1a" xref="A3.E3.m1.4.4.6.3.1.cmml">​</mo><mi id="A3.E3.m1.4.4.6.3.4" xref="A3.E3.m1.4.4.6.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.E3.m1.4.4.6.3.1b" xref="A3.E3.m1.4.4.6.3.1.cmml">​</mo><mi id="A3.E3.m1.4.4.6.3.5" xref="A3.E3.m1.4.4.6.3.5.cmml">b</mi></mrow></msub><mo id="A3.E3.m1.4.4.5" xref="A3.E3.m1.4.4.5.cmml">=</mo><mrow id="A3.E3.m1.4.4.4" xref="A3.E3.m1.4.4.4.cmml"><mrow id="A3.E3.m1.2.2.2.2" xref="A3.E3.m1.2.2.2.2.cmml"><msub id="A3.E3.m1.2.2.2.2.4" xref="A3.E3.m1.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E3.m1.2.2.2.2.4.2" xref="A3.E3.m1.2.2.2.2.4.2.cmml">ℒ</mi><mrow id="A3.E3.m1.2.2.2.2.4.3" xref="A3.E3.m1.2.2.2.2.4.3.cmml"><mi id="A3.E3.m1.2.2.2.2.4.3.2" xref="A3.E3.m1.2.2.2.2.4.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A3.E3.m1.2.2.2.2.4.3.1" xref="A3.E3.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="A3.E3.m1.2.2.2.2.4.3.3" xref="A3.E3.m1.2.2.2.2.4.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E3.m1.2.2.2.2.3" xref="A3.E3.m1.2.2.2.2.3.cmml">​</mo><mrow id="A3.E3.m1.2.2.2.2.2.2" xref="A3.E3.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A3.E3.m1.2.2.2.2.2.2.3" xref="A3.E3.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="A3.E3.m1.1.1.1.1.1.1.1" xref="A3.E3.m1.1.1.1.1.1.1.1.cmml"><msub id="A3.E3.m1.1.1.1.1.1.1.1.4" xref="A3.E3.m1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E3.m1.1.1.1.1.1.1.1.4.2" xref="A3.E3.m1.1.1.1.1.1.1.1.4.2.cmml">ℱ</mi><mi id="A3.E3.m1.1.1.1.1.1.1.1.4.3" xref="A3.E3.m1.1.1.1.1.1.1.1.4.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="A3.E3.m1.1.1.1.1.1.1.1.3" xref="A3.E3.m1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="A3.E3.m1.1.1.1.1.1.1.1.2.2" xref="A3.E3.m1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="A3.E3.m1.1.1.1.1.1.1.1.2.2.3" xref="A3.E3.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="A3.E3.m1.1.1.1.1.1.1.1.2.2.4" xref="A3.E3.m1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msubsup id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐗</mi><mi id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.3" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">I</mi><mi id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A3.E3.m1.1.1.1.1.1.1.1.2.2.5" xref="A3.E3.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E3.m1.2.2.2.2.2.2.4" xref="A3.E3.m1.2.2.2.2.2.3.cmml">,</mo><msup id="A3.E3.m1.2.2.2.2.2.2.2" xref="A3.E3.m1.2.2.2.2.2.2.2.cmml"><mi id="A3.E3.m1.2.2.2.2.2.2.2.2" xref="A3.E3.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="A3.E3.m1.2.2.2.2.2.2.2.3" xref="A3.E3.m1.2.2.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="A3.E3.m1.2.2.2.2.2.2.5" xref="A3.E3.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E3.m1.4.4.4.5" xref="A3.E3.m1.4.4.4.5.cmml">+</mo><mrow id="A3.E3.m1.4.4.4.4" xref="A3.E3.m1.4.4.4.4.cmml"><mi id="A3.E3.m1.4.4.4.4.4" xref="A3.E3.m1.4.4.4.4.4.cmml">β</mi><mo lspace="0em" rspace="0em" id="A3.E3.m1.4.4.4.4.3" xref="A3.E3.m1.4.4.4.4.3.cmml">​</mo><msup id="A3.E3.m1.4.4.4.4.5" xref="A3.E3.m1.4.4.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E3.m1.4.4.4.4.5.2" xref="A3.E3.m1.4.4.4.4.5.2.cmml">ℒ</mi><mrow id="A3.E3.m1.4.4.4.4.5.3" xref="A3.E3.m1.4.4.4.4.5.3.cmml"><mi id="A3.E3.m1.4.4.4.4.5.3.2" xref="A3.E3.m1.4.4.4.4.5.3.2.cmml">T</mi><mo stretchy="false" id="A3.E3.m1.4.4.4.4.5.3.1" xref="A3.E3.m1.4.4.4.4.5.3.1.cmml">→</mo><mi id="A3.E3.m1.4.4.4.4.5.3.3" xref="A3.E3.m1.4.4.4.4.5.3.3.cmml">I</mi></mrow></msup><mo lspace="0em" rspace="0em" id="A3.E3.m1.4.4.4.4.3a" xref="A3.E3.m1.4.4.4.4.3.cmml">​</mo><mrow id="A3.E3.m1.4.4.4.4.2.2" xref="A3.E3.m1.4.4.4.4.2.3.cmml"><mo stretchy="false" id="A3.E3.m1.4.4.4.4.2.2.3" xref="A3.E3.m1.4.4.4.4.2.3.cmml">(</mo><msub id="A3.E3.m1.3.3.3.3.1.1.1" xref="A3.E3.m1.3.3.3.3.1.1.1.cmml"><mi id="A3.E3.m1.3.3.3.3.1.1.1.2" xref="A3.E3.m1.3.3.3.3.1.1.1.2.cmml">𝐳</mi><mi id="A3.E3.m1.3.3.3.3.1.1.1.3" xref="A3.E3.m1.3.3.3.3.1.1.1.3.cmml">𝐈</mi></msub><mo id="A3.E3.m1.4.4.4.4.2.2.4" xref="A3.E3.m1.4.4.4.4.2.3.cmml">,</mo><msub id="A3.E3.m1.4.4.4.4.2.2.2" xref="A3.E3.m1.4.4.4.4.2.2.2.cmml"><mi id="A3.E3.m1.4.4.4.4.2.2.2.2" xref="A3.E3.m1.4.4.4.4.2.2.2.2.cmml">𝐳</mi><mi id="A3.E3.m1.4.4.4.4.2.2.2.3" xref="A3.E3.m1.4.4.4.4.2.2.2.3.cmml">𝐓</mi></msub><mo stretchy="false" id="A3.E3.m1.4.4.4.4.2.2.5" xref="A3.E3.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E3.m1.4b"><apply id="A3.E3.m1.4.4.cmml" xref="A3.E3.m1.4.4"><eq id="A3.E3.m1.4.4.5.cmml" xref="A3.E3.m1.4.4.5"></eq><apply id="A3.E3.m1.4.4.6.cmml" xref="A3.E3.m1.4.4.6"><csymbol cd="ambiguous" id="A3.E3.m1.4.4.6.1.cmml" xref="A3.E3.m1.4.4.6">subscript</csymbol><ci id="A3.E3.m1.4.4.6.2.cmml" xref="A3.E3.m1.4.4.6.2">ℒ</ci><apply id="A3.E3.m1.4.4.6.3.cmml" xref="A3.E3.m1.4.4.6.3"><times id="A3.E3.m1.4.4.6.3.1.cmml" xref="A3.E3.m1.4.4.6.3.1"></times><ci id="A3.E3.m1.4.4.6.3.2.cmml" xref="A3.E3.m1.4.4.6.3.2">𝑔</ci><ci id="A3.E3.m1.4.4.6.3.3.cmml" xref="A3.E3.m1.4.4.6.3.3">𝑙</ci><ci id="A3.E3.m1.4.4.6.3.4.cmml" xref="A3.E3.m1.4.4.6.3.4">𝑜</ci><ci id="A3.E3.m1.4.4.6.3.5.cmml" xref="A3.E3.m1.4.4.6.3.5">𝑏</ci></apply></apply><apply id="A3.E3.m1.4.4.4.cmml" xref="A3.E3.m1.4.4.4"><plus id="A3.E3.m1.4.4.4.5.cmml" xref="A3.E3.m1.4.4.4.5"></plus><apply id="A3.E3.m1.2.2.2.2.cmml" xref="A3.E3.m1.2.2.2.2"><times id="A3.E3.m1.2.2.2.2.3.cmml" xref="A3.E3.m1.2.2.2.2.3"></times><apply id="A3.E3.m1.2.2.2.2.4.cmml" xref="A3.E3.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="A3.E3.m1.2.2.2.2.4.1.cmml" xref="A3.E3.m1.2.2.2.2.4">subscript</csymbol><ci id="A3.E3.m1.2.2.2.2.4.2.cmml" xref="A3.E3.m1.2.2.2.2.4.2">ℒ</ci><apply id="A3.E3.m1.2.2.2.2.4.3.cmml" xref="A3.E3.m1.2.2.2.2.4.3"><times id="A3.E3.m1.2.2.2.2.4.3.1.cmml" xref="A3.E3.m1.2.2.2.2.4.3.1"></times><ci id="A3.E3.m1.2.2.2.2.4.3.2.cmml" xref="A3.E3.m1.2.2.2.2.4.3.2">𝐶</ci><ci id="A3.E3.m1.2.2.2.2.4.3.3.cmml" xref="A3.E3.m1.2.2.2.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="A3.E3.m1.2.2.2.2.2.3.cmml" xref="A3.E3.m1.2.2.2.2.2.2"><apply id="A3.E3.m1.1.1.1.1.1.1.1.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1"><times id="A3.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.3"></times><apply id="A3.E3.m1.1.1.1.1.1.1.1.4.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E3.m1.1.1.1.1.1.1.1.4.1.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A3.E3.m1.1.1.1.1.1.1.1.4.2.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.4.2">ℱ</ci><ci id="A3.E3.m1.1.1.1.1.1.1.1.4.3.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.4.3">𝑔</ci></apply><list id="A3.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2"><apply id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.2">𝐗</ci><ci id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A3.E3.m1.1.1.1.1.1.1.1.2.2.2.3">𝐼</ci></apply></list></apply><apply id="A3.E3.m1.2.2.2.2.2.2.2.cmml" xref="A3.E3.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E3.m1.2.2.2.2.2.2.2.1.cmml" xref="A3.E3.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="A3.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.E3.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="A3.E3.m1.2.2.2.2.2.2.2.3.cmml" xref="A3.E3.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="A3.E3.m1.4.4.4.4.cmml" xref="A3.E3.m1.4.4.4.4"><times id="A3.E3.m1.4.4.4.4.3.cmml" xref="A3.E3.m1.4.4.4.4.3"></times><ci id="A3.E3.m1.4.4.4.4.4.cmml" xref="A3.E3.m1.4.4.4.4.4">𝛽</ci><apply id="A3.E3.m1.4.4.4.4.5.cmml" xref="A3.E3.m1.4.4.4.4.5"><csymbol cd="ambiguous" id="A3.E3.m1.4.4.4.4.5.1.cmml" xref="A3.E3.m1.4.4.4.4.5">superscript</csymbol><ci id="A3.E3.m1.4.4.4.4.5.2.cmml" xref="A3.E3.m1.4.4.4.4.5.2">ℒ</ci><apply id="A3.E3.m1.4.4.4.4.5.3.cmml" xref="A3.E3.m1.4.4.4.4.5.3"><ci id="A3.E3.m1.4.4.4.4.5.3.1.cmml" xref="A3.E3.m1.4.4.4.4.5.3.1">→</ci><ci id="A3.E3.m1.4.4.4.4.5.3.2.cmml" xref="A3.E3.m1.4.4.4.4.5.3.2">𝑇</ci><ci id="A3.E3.m1.4.4.4.4.5.3.3.cmml" xref="A3.E3.m1.4.4.4.4.5.3.3">𝐼</ci></apply></apply><interval closure="open" id="A3.E3.m1.4.4.4.4.2.3.cmml" xref="A3.E3.m1.4.4.4.4.2.2"><apply id="A3.E3.m1.3.3.3.3.1.1.1.cmml" xref="A3.E3.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.E3.m1.3.3.3.3.1.1.1.1.cmml" xref="A3.E3.m1.3.3.3.3.1.1.1">subscript</csymbol><ci id="A3.E3.m1.3.3.3.3.1.1.1.2.cmml" xref="A3.E3.m1.3.3.3.3.1.1.1.2">𝐳</ci><ci id="A3.E3.m1.3.3.3.3.1.1.1.3.cmml" xref="A3.E3.m1.3.3.3.3.1.1.1.3">𝐈</ci></apply><apply id="A3.E3.m1.4.4.4.4.2.2.2.cmml" xref="A3.E3.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="A3.E3.m1.4.4.4.4.2.2.2.1.cmml" xref="A3.E3.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="A3.E3.m1.4.4.4.4.2.2.2.2.cmml" xref="A3.E3.m1.4.4.4.4.2.2.2.2">𝐳</ci><ci id="A3.E3.m1.4.4.4.4.2.2.2.3.cmml" xref="A3.E3.m1.4.4.4.4.2.2.2.3">𝐓</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E3.m1.4c">\mathcal{L}_{glob}=\mathcal{L}_{CE}(\mathcal{F}_{g}(\theta_{g};\mathbf{X}^{k}_{I}),y^{k})+\beta\mathcal{L}^{T\rightarrow I}(\mathbf{z_{I}},\mathbf{z_{T}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="A3.p3.10" class="ltx_p"><span id="A3.p3.10.1" class="ltx_text ltx_font_bold">Step 3 (edge):</span> Next, the edge device trains its local model using <math id="A3.p3.8.m1.1" class="ltx_Math" alttext="\mathbf{X_{T}}" display="inline"><semantics id="A3.p3.8.m1.1a"><msub id="A3.p3.8.m1.1.1" xref="A3.p3.8.m1.1.1.cmml"><mi id="A3.p3.8.m1.1.1.2" xref="A3.p3.8.m1.1.1.2.cmml">𝐗</mi><mi id="A3.p3.8.m1.1.1.3" xref="A3.p3.8.m1.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p3.8.m1.1b"><apply id="A3.p3.8.m1.1.1.cmml" xref="A3.p3.8.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.8.m1.1.1.1.cmml" xref="A3.p3.8.m1.1.1">subscript</csymbol><ci id="A3.p3.8.m1.1.1.2.cmml" xref="A3.p3.8.m1.1.1.2">𝐗</ci><ci id="A3.p3.8.m1.1.1.3.cmml" xref="A3.p3.8.m1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.8.m1.1c">\mathbf{X_{T}}</annotation></semantics></math>.
Here, the training objective is a weighted sum between the cross-entropy loss <math id="A3.p3.9.m2.1" class="ltx_Math" alttext="\mathcal{L}_{CE}" display="inline"><semantics id="A3.p3.9.m2.1a"><msub id="A3.p3.9.m2.1.1" xref="A3.p3.9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.9.m2.1.1.2" xref="A3.p3.9.m2.1.1.2.cmml">ℒ</mi><mrow id="A3.p3.9.m2.1.1.3" xref="A3.p3.9.m2.1.1.3.cmml"><mi id="A3.p3.9.m2.1.1.3.2" xref="A3.p3.9.m2.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A3.p3.9.m2.1.1.3.1" xref="A3.p3.9.m2.1.1.3.1.cmml">​</mo><mi id="A3.p3.9.m2.1.1.3.3" xref="A3.p3.9.m2.1.1.3.3.cmml">E</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.p3.9.m2.1b"><apply id="A3.p3.9.m2.1.1.cmml" xref="A3.p3.9.m2.1.1"><csymbol cd="ambiguous" id="A3.p3.9.m2.1.1.1.cmml" xref="A3.p3.9.m2.1.1">subscript</csymbol><ci id="A3.p3.9.m2.1.1.2.cmml" xref="A3.p3.9.m2.1.1.2">ℒ</ci><apply id="A3.p3.9.m2.1.1.3.cmml" xref="A3.p3.9.m2.1.1.3"><times id="A3.p3.9.m2.1.1.3.1.cmml" xref="A3.p3.9.m2.1.1.3.1"></times><ci id="A3.p3.9.m2.1.1.3.2.cmml" xref="A3.p3.9.m2.1.1.3.2">𝐶</ci><ci id="A3.p3.9.m2.1.1.3.3.cmml" xref="A3.p3.9.m2.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.9.m2.1c">\mathcal{L}_{CE}</annotation></semantics></math> and the contrastive loss <math id="A3.p3.10.m3.1" class="ltx_Math" alttext="\mathcal{L}^{S\rightarrow L}" display="inline"><semantics id="A3.p3.10.m3.1a"><msup id="A3.p3.10.m3.1.1" xref="A3.p3.10.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.10.m3.1.1.2" xref="A3.p3.10.m3.1.1.2.cmml">ℒ</mi><mrow id="A3.p3.10.m3.1.1.3" xref="A3.p3.10.m3.1.1.3.cmml"><mi id="A3.p3.10.m3.1.1.3.2" xref="A3.p3.10.m3.1.1.3.2.cmml">S</mi><mo stretchy="false" id="A3.p3.10.m3.1.1.3.1" xref="A3.p3.10.m3.1.1.3.1.cmml">→</mo><mi id="A3.p3.10.m3.1.1.3.3" xref="A3.p3.10.m3.1.1.3.3.cmml">L</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.p3.10.m3.1b"><apply id="A3.p3.10.m3.1.1.cmml" xref="A3.p3.10.m3.1.1"><csymbol cd="ambiguous" id="A3.p3.10.m3.1.1.1.cmml" xref="A3.p3.10.m3.1.1">superscript</csymbol><ci id="A3.p3.10.m3.1.1.2.cmml" xref="A3.p3.10.m3.1.1.2">ℒ</ci><apply id="A3.p3.10.m3.1.1.3.cmml" xref="A3.p3.10.m3.1.1.3"><ci id="A3.p3.10.m3.1.1.3.1.cmml" xref="A3.p3.10.m3.1.1.3.1">→</ci><ci id="A3.p3.10.m3.1.1.3.2.cmml" xref="A3.p3.10.m3.1.1.3.2">𝑆</ci><ci id="A3.p3.10.m3.1.1.3.3.cmml" xref="A3.p3.10.m3.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.10.m3.1c">\mathcal{L}^{S\rightarrow L}</annotation></semantics></math>.</p>
<table id="A3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A3.E4.m1.4" class="ltx_Math" alttext="\mathcal{L}_{loc}=\mathcal{L}_{CE}(\mathcal{F}_{k}(\theta_{k};\mathbf{X}^{k}_{T}),y^{k})+\beta\mathcal{L}^{S\rightarrow L}(\mathbf{z^{\prime}_{T}},\mathbf{z_{T}})" display="block"><semantics id="A3.E4.m1.4a"><mrow id="A3.E4.m1.4.4" xref="A3.E4.m1.4.4.cmml"><msub id="A3.E4.m1.4.4.6" xref="A3.E4.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E4.m1.4.4.6.2" xref="A3.E4.m1.4.4.6.2.cmml">ℒ</mi><mrow id="A3.E4.m1.4.4.6.3" xref="A3.E4.m1.4.4.6.3.cmml"><mi id="A3.E4.m1.4.4.6.3.2" xref="A3.E4.m1.4.4.6.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A3.E4.m1.4.4.6.3.1" xref="A3.E4.m1.4.4.6.3.1.cmml">​</mo><mi id="A3.E4.m1.4.4.6.3.3" xref="A3.E4.m1.4.4.6.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="A3.E4.m1.4.4.6.3.1a" xref="A3.E4.m1.4.4.6.3.1.cmml">​</mo><mi id="A3.E4.m1.4.4.6.3.4" xref="A3.E4.m1.4.4.6.3.4.cmml">c</mi></mrow></msub><mo id="A3.E4.m1.4.4.5" xref="A3.E4.m1.4.4.5.cmml">=</mo><mrow id="A3.E4.m1.4.4.4" xref="A3.E4.m1.4.4.4.cmml"><mrow id="A3.E4.m1.2.2.2.2" xref="A3.E4.m1.2.2.2.2.cmml"><msub id="A3.E4.m1.2.2.2.2.4" xref="A3.E4.m1.2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E4.m1.2.2.2.2.4.2" xref="A3.E4.m1.2.2.2.2.4.2.cmml">ℒ</mi><mrow id="A3.E4.m1.2.2.2.2.4.3" xref="A3.E4.m1.2.2.2.2.4.3.cmml"><mi id="A3.E4.m1.2.2.2.2.4.3.2" xref="A3.E4.m1.2.2.2.2.4.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="A3.E4.m1.2.2.2.2.4.3.1" xref="A3.E4.m1.2.2.2.2.4.3.1.cmml">​</mo><mi id="A3.E4.m1.2.2.2.2.4.3.3" xref="A3.E4.m1.2.2.2.2.4.3.3.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A3.E4.m1.2.2.2.2.3" xref="A3.E4.m1.2.2.2.2.3.cmml">​</mo><mrow id="A3.E4.m1.2.2.2.2.2.2" xref="A3.E4.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A3.E4.m1.2.2.2.2.2.2.3" xref="A3.E4.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="A3.E4.m1.1.1.1.1.1.1.1" xref="A3.E4.m1.1.1.1.1.1.1.1.cmml"><msub id="A3.E4.m1.1.1.1.1.1.1.1.4" xref="A3.E4.m1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E4.m1.1.1.1.1.1.1.1.4.2" xref="A3.E4.m1.1.1.1.1.1.1.1.4.2.cmml">ℱ</mi><mi id="A3.E4.m1.1.1.1.1.1.1.1.4.3" xref="A3.E4.m1.1.1.1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="A3.E4.m1.1.1.1.1.1.1.1.3" xref="A3.E4.m1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="A3.E4.m1.1.1.1.1.1.1.1.2.2" xref="A3.E4.m1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="A3.E4.m1.1.1.1.1.1.1.1.2.2.3" xref="A3.E4.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="A3.E4.m1.1.1.1.1.1.1.1.2.2.4" xref="A3.E4.m1.1.1.1.1.1.1.1.2.3.cmml">;</mo><msubsup id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐗</mi><mi id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.3" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.3.cmml">T</mi><mi id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="A3.E4.m1.1.1.1.1.1.1.1.2.2.5" xref="A3.E4.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E4.m1.2.2.2.2.2.2.4" xref="A3.E4.m1.2.2.2.2.2.3.cmml">,</mo><msup id="A3.E4.m1.2.2.2.2.2.2.2" xref="A3.E4.m1.2.2.2.2.2.2.2.cmml"><mi id="A3.E4.m1.2.2.2.2.2.2.2.2" xref="A3.E4.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="A3.E4.m1.2.2.2.2.2.2.2.3" xref="A3.E4.m1.2.2.2.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="A3.E4.m1.2.2.2.2.2.2.5" xref="A3.E4.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E4.m1.4.4.4.5" xref="A3.E4.m1.4.4.4.5.cmml">+</mo><mrow id="A3.E4.m1.4.4.4.4" xref="A3.E4.m1.4.4.4.4.cmml"><mi id="A3.E4.m1.4.4.4.4.4" xref="A3.E4.m1.4.4.4.4.4.cmml">β</mi><mo lspace="0em" rspace="0em" id="A3.E4.m1.4.4.4.4.3" xref="A3.E4.m1.4.4.4.4.3.cmml">​</mo><msup id="A3.E4.m1.4.4.4.4.5" xref="A3.E4.m1.4.4.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.E4.m1.4.4.4.4.5.2" xref="A3.E4.m1.4.4.4.4.5.2.cmml">ℒ</mi><mrow id="A3.E4.m1.4.4.4.4.5.3" xref="A3.E4.m1.4.4.4.4.5.3.cmml"><mi id="A3.E4.m1.4.4.4.4.5.3.2" xref="A3.E4.m1.4.4.4.4.5.3.2.cmml">S</mi><mo stretchy="false" id="A3.E4.m1.4.4.4.4.5.3.1" xref="A3.E4.m1.4.4.4.4.5.3.1.cmml">→</mo><mi id="A3.E4.m1.4.4.4.4.5.3.3" xref="A3.E4.m1.4.4.4.4.5.3.3.cmml">L</mi></mrow></msup><mo lspace="0em" rspace="0em" id="A3.E4.m1.4.4.4.4.3a" xref="A3.E4.m1.4.4.4.4.3.cmml">​</mo><mrow id="A3.E4.m1.4.4.4.4.2.2" xref="A3.E4.m1.4.4.4.4.2.3.cmml"><mo stretchy="false" id="A3.E4.m1.4.4.4.4.2.2.3" xref="A3.E4.m1.4.4.4.4.2.3.cmml">(</mo><msubsup id="A3.E4.m1.3.3.3.3.1.1.1" xref="A3.E4.m1.3.3.3.3.1.1.1.cmml"><mi id="A3.E4.m1.3.3.3.3.1.1.1.2.2" xref="A3.E4.m1.3.3.3.3.1.1.1.2.2.cmml">𝐳</mi><mi id="A3.E4.m1.3.3.3.3.1.1.1.3" xref="A3.E4.m1.3.3.3.3.1.1.1.3.cmml">𝐓</mi><mo id="A3.E4.m1.3.3.3.3.1.1.1.2.3" xref="A3.E4.m1.3.3.3.3.1.1.1.2.3.cmml">′</mo></msubsup><mo id="A3.E4.m1.4.4.4.4.2.2.4" xref="A3.E4.m1.4.4.4.4.2.3.cmml">,</mo><msub id="A3.E4.m1.4.4.4.4.2.2.2" xref="A3.E4.m1.4.4.4.4.2.2.2.cmml"><mi id="A3.E4.m1.4.4.4.4.2.2.2.2" xref="A3.E4.m1.4.4.4.4.2.2.2.2.cmml">𝐳</mi><mi id="A3.E4.m1.4.4.4.4.2.2.2.3" xref="A3.E4.m1.4.4.4.4.2.2.2.3.cmml">𝐓</mi></msub><mo stretchy="false" id="A3.E4.m1.4.4.4.4.2.2.5" xref="A3.E4.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E4.m1.4b"><apply id="A3.E4.m1.4.4.cmml" xref="A3.E4.m1.4.4"><eq id="A3.E4.m1.4.4.5.cmml" xref="A3.E4.m1.4.4.5"></eq><apply id="A3.E4.m1.4.4.6.cmml" xref="A3.E4.m1.4.4.6"><csymbol cd="ambiguous" id="A3.E4.m1.4.4.6.1.cmml" xref="A3.E4.m1.4.4.6">subscript</csymbol><ci id="A3.E4.m1.4.4.6.2.cmml" xref="A3.E4.m1.4.4.6.2">ℒ</ci><apply id="A3.E4.m1.4.4.6.3.cmml" xref="A3.E4.m1.4.4.6.3"><times id="A3.E4.m1.4.4.6.3.1.cmml" xref="A3.E4.m1.4.4.6.3.1"></times><ci id="A3.E4.m1.4.4.6.3.2.cmml" xref="A3.E4.m1.4.4.6.3.2">𝑙</ci><ci id="A3.E4.m1.4.4.6.3.3.cmml" xref="A3.E4.m1.4.4.6.3.3">𝑜</ci><ci id="A3.E4.m1.4.4.6.3.4.cmml" xref="A3.E4.m1.4.4.6.3.4">𝑐</ci></apply></apply><apply id="A3.E4.m1.4.4.4.cmml" xref="A3.E4.m1.4.4.4"><plus id="A3.E4.m1.4.4.4.5.cmml" xref="A3.E4.m1.4.4.4.5"></plus><apply id="A3.E4.m1.2.2.2.2.cmml" xref="A3.E4.m1.2.2.2.2"><times id="A3.E4.m1.2.2.2.2.3.cmml" xref="A3.E4.m1.2.2.2.2.3"></times><apply id="A3.E4.m1.2.2.2.2.4.cmml" xref="A3.E4.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="A3.E4.m1.2.2.2.2.4.1.cmml" xref="A3.E4.m1.2.2.2.2.4">subscript</csymbol><ci id="A3.E4.m1.2.2.2.2.4.2.cmml" xref="A3.E4.m1.2.2.2.2.4.2">ℒ</ci><apply id="A3.E4.m1.2.2.2.2.4.3.cmml" xref="A3.E4.m1.2.2.2.2.4.3"><times id="A3.E4.m1.2.2.2.2.4.3.1.cmml" xref="A3.E4.m1.2.2.2.2.4.3.1"></times><ci id="A3.E4.m1.2.2.2.2.4.3.2.cmml" xref="A3.E4.m1.2.2.2.2.4.3.2">𝐶</ci><ci id="A3.E4.m1.2.2.2.2.4.3.3.cmml" xref="A3.E4.m1.2.2.2.2.4.3.3">𝐸</ci></apply></apply><interval closure="open" id="A3.E4.m1.2.2.2.2.2.3.cmml" xref="A3.E4.m1.2.2.2.2.2.2"><apply id="A3.E4.m1.1.1.1.1.1.1.1.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1"><times id="A3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.3"></times><apply id="A3.E4.m1.1.1.1.1.1.1.1.4.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.E4.m1.1.1.1.1.1.1.1.4.1.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="A3.E4.m1.1.1.1.1.1.1.1.4.2.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.4.2">ℱ</ci><ci id="A3.E4.m1.1.1.1.1.1.1.1.4.3.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><list id="A3.E4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2"><apply id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.2">𝐗</ci><ci id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A3.E4.m1.1.1.1.1.1.1.1.2.2.2.3">𝑇</ci></apply></list></apply><apply id="A3.E4.m1.2.2.2.2.2.2.2.cmml" xref="A3.E4.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.E4.m1.2.2.2.2.2.2.2.1.cmml" xref="A3.E4.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="A3.E4.m1.2.2.2.2.2.2.2.2.cmml" xref="A3.E4.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="A3.E4.m1.2.2.2.2.2.2.2.3.cmml" xref="A3.E4.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply><apply id="A3.E4.m1.4.4.4.4.cmml" xref="A3.E4.m1.4.4.4.4"><times id="A3.E4.m1.4.4.4.4.3.cmml" xref="A3.E4.m1.4.4.4.4.3"></times><ci id="A3.E4.m1.4.4.4.4.4.cmml" xref="A3.E4.m1.4.4.4.4.4">𝛽</ci><apply id="A3.E4.m1.4.4.4.4.5.cmml" xref="A3.E4.m1.4.4.4.4.5"><csymbol cd="ambiguous" id="A3.E4.m1.4.4.4.4.5.1.cmml" xref="A3.E4.m1.4.4.4.4.5">superscript</csymbol><ci id="A3.E4.m1.4.4.4.4.5.2.cmml" xref="A3.E4.m1.4.4.4.4.5.2">ℒ</ci><apply id="A3.E4.m1.4.4.4.4.5.3.cmml" xref="A3.E4.m1.4.4.4.4.5.3"><ci id="A3.E4.m1.4.4.4.4.5.3.1.cmml" xref="A3.E4.m1.4.4.4.4.5.3.1">→</ci><ci id="A3.E4.m1.4.4.4.4.5.3.2.cmml" xref="A3.E4.m1.4.4.4.4.5.3.2">𝑆</ci><ci id="A3.E4.m1.4.4.4.4.5.3.3.cmml" xref="A3.E4.m1.4.4.4.4.5.3.3">𝐿</ci></apply></apply><interval closure="open" id="A3.E4.m1.4.4.4.4.2.3.cmml" xref="A3.E4.m1.4.4.4.4.2.2"><apply id="A3.E4.m1.3.3.3.3.1.1.1.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.E4.m1.3.3.3.3.1.1.1.1.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1">subscript</csymbol><apply id="A3.E4.m1.3.3.3.3.1.1.1.2.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A3.E4.m1.3.3.3.3.1.1.1.2.1.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1">superscript</csymbol><ci id="A3.E4.m1.3.3.3.3.1.1.1.2.2.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1.2.2">𝐳</ci><ci id="A3.E4.m1.3.3.3.3.1.1.1.2.3.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1.2.3">′</ci></apply><ci id="A3.E4.m1.3.3.3.3.1.1.1.3.cmml" xref="A3.E4.m1.3.3.3.3.1.1.1.3">𝐓</ci></apply><apply id="A3.E4.m1.4.4.4.4.2.2.2.cmml" xref="A3.E4.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="A3.E4.m1.4.4.4.4.2.2.2.1.cmml" xref="A3.E4.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="A3.E4.m1.4.4.4.4.2.2.2.2.cmml" xref="A3.E4.m1.4.4.4.4.2.2.2.2">𝐳</ci><ci id="A3.E4.m1.4.4.4.4.2.2.2.3.cmml" xref="A3.E4.m1.4.4.4.4.2.2.2.3">𝐓</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E4.m1.4c">\mathcal{L}_{loc}=\mathcal{L}_{CE}(\mathcal{F}_{k}(\theta_{k};\mathbf{X}^{k}_{T}),y^{k})+\beta\mathcal{L}^{S\rightarrow L}(\mathbf{z^{\prime}_{T}},\mathbf{z_{T}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="A3.p3.13" class="ltx_p"><span id="A3.p3.13.1" class="ltx_text ltx_font_bold">Step 4 (server):</span> Finally, the server receives the trained global model and edge generated embeddings <math id="A3.p3.11.m1.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="A3.p3.11.m1.1a"><msubsup id="A3.p3.11.m1.1.1" xref="A3.p3.11.m1.1.1.cmml"><mi id="A3.p3.11.m1.1.1.2.2" xref="A3.p3.11.m1.1.1.2.2.cmml">𝐳</mi><mi id="A3.p3.11.m1.1.1.3" xref="A3.p3.11.m1.1.1.3.cmml">𝐓</mi><mo id="A3.p3.11.m1.1.1.2.3" xref="A3.p3.11.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="A3.p3.11.m1.1b"><apply id="A3.p3.11.m1.1.1.cmml" xref="A3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.11.m1.1.1.1.cmml" xref="A3.p3.11.m1.1.1">subscript</csymbol><apply id="A3.p3.11.m1.1.1.2.cmml" xref="A3.p3.11.m1.1.1"><csymbol cd="ambiguous" id="A3.p3.11.m1.1.1.2.1.cmml" xref="A3.p3.11.m1.1.1">superscript</csymbol><ci id="A3.p3.11.m1.1.1.2.2.cmml" xref="A3.p3.11.m1.1.1.2.2">𝐳</ci><ci id="A3.p3.11.m1.1.1.2.3.cmml" xref="A3.p3.11.m1.1.1.2.3">′</ci></apply><ci id="A3.p3.11.m1.1.1.3.cmml" xref="A3.p3.11.m1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.11.m1.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math>. The server then aggregates the global model using weighted average and also trains the server side model <math id="A3.p3.12.m2.1" class="ltx_Math" alttext="\mathcal{F}_{s}(\cdot)" display="inline"><semantics id="A3.p3.12.m2.1a"><mrow id="A3.p3.12.m2.1.2" xref="A3.p3.12.m2.1.2.cmml"><msub id="A3.p3.12.m2.1.2.2" xref="A3.p3.12.m2.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.12.m2.1.2.2.2" xref="A3.p3.12.m2.1.2.2.2.cmml">ℱ</mi><mi id="A3.p3.12.m2.1.2.2.3" xref="A3.p3.12.m2.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A3.p3.12.m2.1.2.1" xref="A3.p3.12.m2.1.2.1.cmml">​</mo><mrow id="A3.p3.12.m2.1.2.3.2" xref="A3.p3.12.m2.1.2.cmml"><mo stretchy="false" id="A3.p3.12.m2.1.2.3.2.1" xref="A3.p3.12.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A3.p3.12.m2.1.1" xref="A3.p3.12.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="A3.p3.12.m2.1.2.3.2.2" xref="A3.p3.12.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p3.12.m2.1b"><apply id="A3.p3.12.m2.1.2.cmml" xref="A3.p3.12.m2.1.2"><times id="A3.p3.12.m2.1.2.1.cmml" xref="A3.p3.12.m2.1.2.1"></times><apply id="A3.p3.12.m2.1.2.2.cmml" xref="A3.p3.12.m2.1.2.2"><csymbol cd="ambiguous" id="A3.p3.12.m2.1.2.2.1.cmml" xref="A3.p3.12.m2.1.2.2">subscript</csymbol><ci id="A3.p3.12.m2.1.2.2.2.cmml" xref="A3.p3.12.m2.1.2.2.2">ℱ</ci><ci id="A3.p3.12.m2.1.2.2.3.cmml" xref="A3.p3.12.m2.1.2.2.3">𝑠</ci></apply><ci id="A3.p3.12.m2.1.1.cmml" xref="A3.p3.12.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.12.m2.1c">\mathcal{F}_{s}(\cdot)</annotation></semantics></math> using the contrastive loss <math id="A3.p3.13.m3.1" class="ltx_Math" alttext="\mathcal{L}^{L\rightarrow S}" display="inline"><semantics id="A3.p3.13.m3.1a"><msup id="A3.p3.13.m3.1.1" xref="A3.p3.13.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.p3.13.m3.1.1.2" xref="A3.p3.13.m3.1.1.2.cmml">ℒ</mi><mrow id="A3.p3.13.m3.1.1.3" xref="A3.p3.13.m3.1.1.3.cmml"><mi id="A3.p3.13.m3.1.1.3.2" xref="A3.p3.13.m3.1.1.3.2.cmml">L</mi><mo stretchy="false" id="A3.p3.13.m3.1.1.3.1" xref="A3.p3.13.m3.1.1.3.1.cmml">→</mo><mi id="A3.p3.13.m3.1.1.3.3" xref="A3.p3.13.m3.1.1.3.3.cmml">S</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="A3.p3.13.m3.1b"><apply id="A3.p3.13.m3.1.1.cmml" xref="A3.p3.13.m3.1.1"><csymbol cd="ambiguous" id="A3.p3.13.m3.1.1.1.cmml" xref="A3.p3.13.m3.1.1">superscript</csymbol><ci id="A3.p3.13.m3.1.1.2.cmml" xref="A3.p3.13.m3.1.1.2">ℒ</ci><apply id="A3.p3.13.m3.1.1.3.cmml" xref="A3.p3.13.m3.1.1.3"><ci id="A3.p3.13.m3.1.1.3.1.cmml" xref="A3.p3.13.m3.1.1.3.1">→</ci><ci id="A3.p3.13.m3.1.1.3.2.cmml" xref="A3.p3.13.m3.1.1.3.2">𝐿</ci><ci id="A3.p3.13.m3.1.1.3.3.cmml" xref="A3.p3.13.m3.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.13.m3.1c">\mathcal{L}^{L\rightarrow S}</annotation></semantics></math>:</p>
</div>
<div id="A3.p4" class="ltx_para">
<p id="A3.p4.1" class="ltx_p">We summarize the full training algorithm in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix C Learning Algorithm ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and a pictorial representation of the same in Figure <a href="#A3.F3" title="Figure 3 ‣ Appendix C Learning Algorithm ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> in Appendix <a href="#A3" title="Appendix C Learning Algorithm ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<div id="A3.p5" class="ltx_para">
<p id="A3.p5.1" class="ltx_p">Figure <a href="#A3.F3" title="Figure 3 ‣ Appendix C Learning Algorithm ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows a pictorial representation of our full learning algorithm, which is listed in detail in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix C Learning Algorithm ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="A3.F3" class="ltx_figure"><img src="/html/2403.01615/assets/img/partialfl_framework.png" id="A3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="357" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F3.2.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>Training steps of the PartialFL framework. Training steps 1, 2, 3, and 4 are repeated in each global training round.</figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.4.2" class="ltx_text ltx_font_bold">PartialFL</span></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.2.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.1" class="ltx_text ltx_font_bold">Server Initialize: <math id="alg1.l1.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}^{0}_{g}" display="inline"><semantics id="alg1.l1.1.m1.1a"><msubsup id="alg1.l1.1.m1.1.1" xref="alg1.l1.1.m1.1.1.cmml"><mi id="alg1.l1.1.m1.1.1.2.2" xref="alg1.l1.1.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l1.1.m1.1.1.3" xref="alg1.l1.1.m1.1.1.3.cmml">g</mi><mn id="alg1.l1.1.m1.1.1.2.3" xref="alg1.l1.1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.1.m1.1b"><apply id="alg1.l1.1.m1.1.1.cmml" xref="alg1.l1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.1.m1.1.1.1.cmml" xref="alg1.l1.1.m1.1.1">subscript</csymbol><apply id="alg1.l1.1.m1.1.1.2.cmml" xref="alg1.l1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.1.m1.1.1.2.1.cmml" xref="alg1.l1.1.m1.1.1">superscript</csymbol><ci id="alg1.l1.1.m1.1.1.2.2.cmml" xref="alg1.l1.1.m1.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.l1.1.m1.1.1.2.3.cmml" xref="alg1.l1.1.m1.1.1.2.3">0</cn></apply><ci id="alg1.l1.1.m1.1.1.3.cmml" xref="alg1.l1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.1.m1.1c">\mathbf{\theta}^{0}_{g}</annotation></semantics></math></span>, <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{s}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝜃</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{\theta}_{s}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.4" class="ltx_Math" alttext="k\in\{1,2,...,K\}" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.5" xref="alg1.l2.m1.4.5.cmml"><mi id="alg1.l2.m1.4.5.2" xref="alg1.l2.m1.4.5.2.cmml">k</mi><mo id="alg1.l2.m1.4.5.1" xref="alg1.l2.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l2.m1.4.5.3.2" xref="alg1.l2.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l2.m1.4.5.3.2.1" xref="alg1.l2.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.4.5.3.2.2" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">2</mn><mo id="alg1.l2.m1.4.5.3.2.3" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">…</mi><mo id="alg1.l2.m1.4.5.3.2.4" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l2.m1.4.5.3.2.5" xref="alg1.l2.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.5.cmml" xref="alg1.l2.m1.4.5"><in id="alg1.l2.m1.4.5.1.cmml" xref="alg1.l2.m1.4.5.1"></in><ci id="alg1.l2.m1.4.5.2.cmml" xref="alg1.l2.m1.4.5.2">𝑘</ci><set id="alg1.l2.m1.4.5.3.1.cmml" xref="alg1.l2.m1.4.5.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">2</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci><ci id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">k\in\{1,2,...,K\}</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.1" class="ltx_text ltx_font_bold">Client Initialize: <math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{k}" display="inline"><semantics id="alg1.l3.1.m1.1a"><msub id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml"><mi id="alg1.l3.1.m1.1.1.2" xref="alg1.l3.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l3.1.m1.1.1.3" xref="alg1.l3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><apply id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.1.m1.1.1.1.cmml" xref="alg1.l3.1.m1.1.1">subscript</csymbol><ci id="alg1.l3.1.m1.1.1.2.cmml" xref="alg1.l3.1.m1.1.1.2">𝜃</ci><ci id="alg1.l3.1.m1.1.1.3.cmml" xref="alg1.l3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\mathbf{\theta}_{k}</annotation></semantics></math></span> 

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.2.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">Upload <math id="alg1.l4.1.m1.1" class="ltx_Math" alttext="\mathbf{X^{k}_{T}}" display="inline"><semantics id="alg1.l4.1.m1.1a"><msubsup id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml"><mi id="alg1.l4.1.m1.1.1.2.2" xref="alg1.l4.1.m1.1.1.2.2.cmml">𝐗</mi><mi id="alg1.l4.1.m1.1.1.3" xref="alg1.l4.1.m1.1.1.3.cmml">𝐓</mi><mi id="alg1.l4.1.m1.1.1.2.3" xref="alg1.l4.1.m1.1.1.2.3.cmml">𝐤</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><apply id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.1.m1.1.1.1.cmml" xref="alg1.l4.1.m1.1.1">subscript</csymbol><apply id="alg1.l4.1.m1.1.1.2.cmml" xref="alg1.l4.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.1.m1.1.1.2.1.cmml" xref="alg1.l4.1.m1.1.1">superscript</csymbol><ci id="alg1.l4.1.m1.1.1.2.2.cmml" xref="alg1.l4.1.m1.1.1.2.2">𝐗</ci><ci id="alg1.l4.1.m1.1.1.2.3.cmml" xref="alg1.l4.1.m1.1.1.2.3">𝐤</ci></apply><ci id="alg1.l4.1.m1.1.1.3.cmml" xref="alg1.l4.1.m1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\mathbf{X^{k}_{T}}</annotation></semantics></math> to server</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span><span id="alg1.l6.2" class="ltx_text ltx_font_bold">Server Executes:</span>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l7.m1.4" class="ltx_Math" alttext="k\in\{1,2,...,K\}" display="inline"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.5" xref="alg1.l7.m1.4.5.cmml"><mi id="alg1.l7.m1.4.5.2" xref="alg1.l7.m1.4.5.2.cmml">k</mi><mo id="alg1.l7.m1.4.5.1" xref="alg1.l7.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l7.m1.4.5.3.2" xref="alg1.l7.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l7.m1.4.5.3.2.1" xref="alg1.l7.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">1</mn><mo id="alg1.l7.m1.4.5.3.2.2" xref="alg1.l7.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml">2</mn><mo id="alg1.l7.m1.4.5.3.2.3" xref="alg1.l7.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml">…</mi><mo id="alg1.l7.m1.4.5.3.2.4" xref="alg1.l7.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l7.m1.4.5.3.2.5" xref="alg1.l7.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.5.cmml" xref="alg1.l7.m1.4.5"><in id="alg1.l7.m1.4.5.1.cmml" xref="alg1.l7.m1.4.5.1"></in><ci id="alg1.l7.m1.4.5.2.cmml" xref="alg1.l7.m1.4.5.2">𝑘</ci><set id="alg1.l7.m1.4.5.3.1.cmml" xref="alg1.l7.m1.4.5.3.2"><cn type="integer" id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">1</cn><cn type="integer" id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2">2</cn><ci id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3">…</ci><ci id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">k\in\{1,2,...,K\}</annotation></semantics></math> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <math id="alg1.l8.m1.2" class="ltx_Math" alttext="\mathbf{z^{k}_{T}}\leftarrow\mathcal{F}_{s}(\mathbf{\theta}_{s};\mathbf{X^{k}_{T}})" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><msubsup id="alg1.l8.m1.2.2.4" xref="alg1.l8.m1.2.2.4.cmml"><mi id="alg1.l8.m1.2.2.4.2.2" xref="alg1.l8.m1.2.2.4.2.2.cmml">𝐳</mi><mi id="alg1.l8.m1.2.2.4.3" xref="alg1.l8.m1.2.2.4.3.cmml">𝐓</mi><mi id="alg1.l8.m1.2.2.4.2.3" xref="alg1.l8.m1.2.2.4.2.3.cmml">𝐤</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">←</mo><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.2.cmml"><msub id="alg1.l8.m1.2.2.2.4" xref="alg1.l8.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.2.2.2.4.2" xref="alg1.l8.m1.2.2.2.4.2.cmml">ℱ</mi><mi id="alg1.l8.m1.2.2.2.4.3" xref="alg1.l8.m1.2.2.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l8.m1.2.2.2.2.2.4" xref="alg1.l8.m1.2.2.2.2.3.cmml">;</mo><msubsup id="alg1.l8.m1.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.2.cmml">𝐗</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.3.cmml">𝐓</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.2.3.cmml">𝐤</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.2.5" xref="alg1.l8.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><ci id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3">←</ci><apply id="alg1.l8.m1.2.2.4.cmml" xref="alg1.l8.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.4">subscript</csymbol><apply id="alg1.l8.m1.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.4.2.1.cmml" xref="alg1.l8.m1.2.2.4">superscript</csymbol><ci id="alg1.l8.m1.2.2.4.2.2.cmml" xref="alg1.l8.m1.2.2.4.2.2">𝐳</ci><ci id="alg1.l8.m1.2.2.4.2.3.cmml" xref="alg1.l8.m1.2.2.4.2.3">𝐤</ci></apply><ci id="alg1.l8.m1.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.4.3">𝐓</ci></apply><apply id="alg1.l8.m1.2.2.2.cmml" xref="alg1.l8.m1.2.2.2"><times id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.3"></times><apply id="alg1.l8.m1.2.2.2.4.cmml" xref="alg1.l8.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.4.1.cmml" xref="alg1.l8.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.4.2.cmml" xref="alg1.l8.m1.2.2.2.4.2">ℱ</ci><ci id="alg1.l8.m1.2.2.2.4.3.cmml" xref="alg1.l8.m1.2.2.2.4.3">𝑠</ci></apply><list id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2"><apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2.2">𝐗</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2.3">𝐤</ci></apply><ci id="alg1.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.3">𝐓</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\mathbf{z^{k}_{T}}\leftarrow\mathcal{F}_{s}(\mathbf{\theta}_{s};\mathbf{X^{k}_{T}})</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span><span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text ltx_font_bold">for</span> Each round <math id="alg1.l10.m1.3" class="ltx_Math" alttext="t=0,...,T-1" display="inline"><semantics id="alg1.l10.m1.3a"><mrow id="alg1.l10.m1.3.3" xref="alg1.l10.m1.3.3.cmml"><mi id="alg1.l10.m1.3.3.3" xref="alg1.l10.m1.3.3.3.cmml">t</mi><mo id="alg1.l10.m1.3.3.2" xref="alg1.l10.m1.3.3.2.cmml">=</mo><mrow id="alg1.l10.m1.3.3.1.1" xref="alg1.l10.m1.3.3.1.2.cmml"><mn id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">0</mn><mo id="alg1.l10.m1.3.3.1.1.2" xref="alg1.l10.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">…</mi><mo id="alg1.l10.m1.3.3.1.1.3" xref="alg1.l10.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l10.m1.3.3.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.cmml"><mi id="alg1.l10.m1.3.3.1.1.1.2" xref="alg1.l10.m1.3.3.1.1.1.2.cmml">T</mi><mo id="alg1.l10.m1.3.3.1.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.cmml">−</mo><mn id="alg1.l10.m1.3.3.1.1.1.3" xref="alg1.l10.m1.3.3.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.3b"><apply id="alg1.l10.m1.3.3.cmml" xref="alg1.l10.m1.3.3"><eq id="alg1.l10.m1.3.3.2.cmml" xref="alg1.l10.m1.3.3.2"></eq><ci id="alg1.l10.m1.3.3.3.cmml" xref="alg1.l10.m1.3.3.3">𝑡</ci><list id="alg1.l10.m1.3.3.1.2.cmml" xref="alg1.l10.m1.3.3.1.1"><cn type="integer" id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">0</cn><ci id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">…</ci><apply id="alg1.l10.m1.3.3.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1"><minus id="alg1.l10.m1.3.3.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1"></minus><ci id="alg1.l10.m1.3.3.1.1.1.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l10.m1.3.3.1.1.1.3.cmml" xref="alg1.l10.m1.3.3.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.3c">t=0,...,T-1</annotation></semantics></math> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">## Step 1: Sample and distribution</span>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>     Sample edge devices <math id="alg1.l12.m1.4" class="ltx_Math" alttext="\mathcal{S}\in\{1,2,...,K\}" display="inline"><semantics id="alg1.l12.m1.4a"><mrow id="alg1.l12.m1.4.5" xref="alg1.l12.m1.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.4.5.2" xref="alg1.l12.m1.4.5.2.cmml">𝒮</mi><mo id="alg1.l12.m1.4.5.1" xref="alg1.l12.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l12.m1.4.5.3.2" xref="alg1.l12.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l12.m1.4.5.3.2.1" xref="alg1.l12.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">1</mn><mo id="alg1.l12.m1.4.5.3.2.2" xref="alg1.l12.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml">2</mn><mo id="alg1.l12.m1.4.5.3.2.3" xref="alg1.l12.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml">…</mi><mo id="alg1.l12.m1.4.5.3.2.4" xref="alg1.l12.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l12.m1.4.4" xref="alg1.l12.m1.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l12.m1.4.5.3.2.5" xref="alg1.l12.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.4b"><apply id="alg1.l12.m1.4.5.cmml" xref="alg1.l12.m1.4.5"><in id="alg1.l12.m1.4.5.1.cmml" xref="alg1.l12.m1.4.5.1"></in><ci id="alg1.l12.m1.4.5.2.cmml" xref="alg1.l12.m1.4.5.2">𝒮</ci><set id="alg1.l12.m1.4.5.3.1.cmml" xref="alg1.l12.m1.4.5.3.2"><cn type="integer" id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">1</cn><cn type="integer" id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2">2</cn><ci id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3">…</ci><ci id="alg1.l12.m1.4.4.cmml" xref="alg1.l12.m1.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.4c">\mathcal{S}\in\{1,2,...,K\}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     Distribute <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\mathbf{\theta}^{t}_{g}" display="inline"><semantics id="alg1.l13.m1.1a"><msubsup id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">g</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1">superscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝜃</ci><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathbf{\theta}^{t}_{g}</annotation></semantics></math> and <math id="alg1.l13.m2.1" class="ltx_Math" alttext="\mathbf{z^{k}_{T}}" display="inline"><semantics id="alg1.l13.m2.1a"><msubsup id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><mi id="alg1.l13.m2.1.1.2.2" xref="alg1.l13.m2.1.1.2.2.cmml">𝐳</mi><mi id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml">𝐓</mi><mi id="alg1.l13.m2.1.1.2.3" xref="alg1.l13.m2.1.1.2.3.cmml">𝐤</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1">subscript</csymbol><apply id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.2.1.cmml" xref="alg1.l13.m2.1.1">superscript</csymbol><ci id="alg1.l13.m2.1.1.2.2.cmml" xref="alg1.l13.m2.1.1.2.2">𝐳</ci><ci id="alg1.l13.m2.1.1.2.3.cmml" xref="alg1.l13.m2.1.1.2.3">𝐤</ci></apply><ci id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">\mathbf{z^{k}_{T}}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg1.l14.2" class="ltx_text ltx_font_bold">## Step 2 and 3: Client training</span>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span> Each edge device <math id="alg1.l15.m1.1" class="ltx_Math" alttext="k\in\mathcal{S}" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">k</mi><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><in id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></in><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">𝑘</ci><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">k\in\mathcal{S}</annotation></semantics></math> in parallel <span id="alg1.l15.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.5.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>         <math id="alg1.l16.m1.4" class="ltx_Math" alttext="\mathbf{\theta}^{t}_{g,k},\mathbf{\theta}_{k}\leftarrow" display="inline"><semantics id="alg1.l16.m1.4a"><mrow id="alg1.l16.m1.4.4" xref="alg1.l16.m1.4.4.cmml"><mrow id="alg1.l16.m1.4.4.2.2" xref="alg1.l16.m1.4.4.2.3.cmml"><msubsup id="alg1.l16.m1.3.3.1.1.1" xref="alg1.l16.m1.3.3.1.1.1.cmml"><mi id="alg1.l16.m1.3.3.1.1.1.2.2" xref="alg1.l16.m1.3.3.1.1.1.2.2.cmml">θ</mi><mrow id="alg1.l16.m1.2.2.2.4" xref="alg1.l16.m1.2.2.2.3.cmml"><mi id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml">g</mi><mo id="alg1.l16.m1.2.2.2.4.1" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml">k</mi></mrow><mi id="alg1.l16.m1.3.3.1.1.1.2.3" xref="alg1.l16.m1.3.3.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l16.m1.4.4.2.2.3" xref="alg1.l16.m1.4.4.2.3.cmml">,</mo><msub id="alg1.l16.m1.4.4.2.2.2" xref="alg1.l16.m1.4.4.2.2.2.cmml"><mi id="alg1.l16.m1.4.4.2.2.2.2" xref="alg1.l16.m1.4.4.2.2.2.2.cmml">θ</mi><mi id="alg1.l16.m1.4.4.2.2.2.3" xref="alg1.l16.m1.4.4.2.2.2.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="alg1.l16.m1.4.4.3" xref="alg1.l16.m1.4.4.3.cmml">←</mo><mi id="alg1.l16.m1.4.4.4" xref="alg1.l16.m1.4.4.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.4b"><apply id="alg1.l16.m1.4.4.cmml" xref="alg1.l16.m1.4.4"><ci id="alg1.l16.m1.4.4.3.cmml" xref="alg1.l16.m1.4.4.3">←</ci><list id="alg1.l16.m1.4.4.2.3.cmml" xref="alg1.l16.m1.4.4.2.2"><apply id="alg1.l16.m1.3.3.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1">subscript</csymbol><apply id="alg1.l16.m1.3.3.1.1.1.2.cmml" xref="alg1.l16.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.2.1.cmml" xref="alg1.l16.m1.3.3.1.1.1">superscript</csymbol><ci id="alg1.l16.m1.3.3.1.1.1.2.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.2.2">𝜃</ci><ci id="alg1.l16.m1.3.3.1.1.1.2.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.2.3">𝑡</ci></apply><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.4"><ci id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1">𝑔</ci><ci id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2">𝑘</ci></list></apply><apply id="alg1.l16.m1.4.4.2.2.2.cmml" xref="alg1.l16.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.4.4.2.2.2.1.cmml" xref="alg1.l16.m1.4.4.2.2.2">subscript</csymbol><ci id="alg1.l16.m1.4.4.2.2.2.2.cmml" xref="alg1.l16.m1.4.4.2.2.2.2">𝜃</ci><ci id="alg1.l16.m1.4.4.2.2.2.3.cmml" xref="alg1.l16.m1.4.4.2.2.2.3">𝑘</ci></apply></list><csymbol cd="latexml" id="alg1.l16.m1.4.4.4.cmml" xref="alg1.l16.m1.4.4.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.4c">\mathbf{\theta}^{t}_{g,k},\mathbf{\theta}_{k}\leftarrow</annotation></semantics></math> <span id="alg1.l16.4" class="ltx_text ltx_font_bold">ClientTrain(<math id="alg1.l16.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}^{t}_{g}" display="inline"><semantics id="alg1.l16.1.m1.1a"><msubsup id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml"><mi id="alg1.l16.1.m1.1.1.2.2" xref="alg1.l16.1.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l16.1.m1.1.1.3" xref="alg1.l16.1.m1.1.1.3.cmml">g</mi><mi id="alg1.l16.1.m1.1.1.2.3" xref="alg1.l16.1.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b"><apply id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.1.m1.1.1.1.cmml" xref="alg1.l16.1.m1.1.1">subscript</csymbol><apply id="alg1.l16.1.m1.1.1.2.cmml" xref="alg1.l16.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.1.m1.1.1.2.1.cmml" xref="alg1.l16.1.m1.1.1">superscript</csymbol><ci id="alg1.l16.1.m1.1.1.2.2.cmml" xref="alg1.l16.1.m1.1.1.2.2">𝜃</ci><ci id="alg1.l16.1.m1.1.1.2.3.cmml" xref="alg1.l16.1.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l16.1.m1.1.1.3.cmml" xref="alg1.l16.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">\mathbf{\theta}^{t}_{g}</annotation></semantics></math>,<math id="alg1.l16.2.m2.1" class="ltx_Math" alttext="\mathbf{\theta}_{k}" display="inline"><semantics id="alg1.l16.2.m2.1a"><msub id="alg1.l16.2.m2.1.1" xref="alg1.l16.2.m2.1.1.cmml"><mi id="alg1.l16.2.m2.1.1.2" xref="alg1.l16.2.m2.1.1.2.cmml">θ</mi><mi id="alg1.l16.2.m2.1.1.3" xref="alg1.l16.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.2.m2.1b"><apply id="alg1.l16.2.m2.1.1.cmml" xref="alg1.l16.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l16.2.m2.1.1.1.cmml" xref="alg1.l16.2.m2.1.1">subscript</csymbol><ci id="alg1.l16.2.m2.1.1.2.cmml" xref="alg1.l16.2.m2.1.1.2">𝜃</ci><ci id="alg1.l16.2.m2.1.1.3.cmml" xref="alg1.l16.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.2.m2.1c">\mathbf{\theta}_{k}</annotation></semantics></math>,<math id="alg1.l16.3.m3.1" class="ltx_Math" alttext="\mathbf{z^{k}_{T}}" display="inline"><semantics id="alg1.l16.3.m3.1a"><msubsup id="alg1.l16.3.m3.1.1" xref="alg1.l16.3.m3.1.1.cmml"><mi id="alg1.l16.3.m3.1.1.2.2" xref="alg1.l16.3.m3.1.1.2.2.cmml">𝐳</mi><mi id="alg1.l16.3.m3.1.1.3" xref="alg1.l16.3.m3.1.1.3.cmml">𝐓</mi><mi id="alg1.l16.3.m3.1.1.2.3" xref="alg1.l16.3.m3.1.1.2.3.cmml">𝐤</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l16.3.m3.1b"><apply id="alg1.l16.3.m3.1.1.cmml" xref="alg1.l16.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.3.m3.1.1.1.cmml" xref="alg1.l16.3.m3.1.1">subscript</csymbol><apply id="alg1.l16.3.m3.1.1.2.cmml" xref="alg1.l16.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l16.3.m3.1.1.2.1.cmml" xref="alg1.l16.3.m3.1.1">superscript</csymbol><ci id="alg1.l16.3.m3.1.1.2.2.cmml" xref="alg1.l16.3.m3.1.1.2.2">𝐳</ci><ci id="alg1.l16.3.m3.1.1.2.3.cmml" xref="alg1.l16.3.m3.1.1.2.3">𝐤</ci></apply><ci id="alg1.l16.3.m3.1.1.3.cmml" xref="alg1.l16.3.m3.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.3.m3.1c">\mathbf{z^{k}_{T}}</annotation></semantics></math>,<math id="alg1.l16.4.m4.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="alg1.l16.4.m4.1a"><msup id="alg1.l16.4.m4.1.1" xref="alg1.l16.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.4.m4.1.1.2" xref="alg1.l16.4.m4.1.1.2.cmml">𝒟</mi><mi id="alg1.l16.4.m4.1.1.3" xref="alg1.l16.4.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l16.4.m4.1b"><apply id="alg1.l16.4.m4.1.1.cmml" xref="alg1.l16.4.m4.1.1"><csymbol cd="ambiguous" id="alg1.l16.4.m4.1.1.1.cmml" xref="alg1.l16.4.m4.1.1">superscript</csymbol><ci id="alg1.l16.4.m4.1.1.2.cmml" xref="alg1.l16.4.m4.1.1.2">𝒟</ci><ci id="alg1.l16.4.m4.1.1.3.cmml" xref="alg1.l16.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.4.m4.1c">\mathcal{D}^{k}</annotation></semantics></math>)</span>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>         <math id="alg1.l17.m1.4" class="ltx_Math" alttext="\mathbf{z^{\prime k}_{T}}\leftarrow\mathcal{F}_{k}(\mathbf{\theta}_{k};\mathcal{D}^{k})" display="inline"><semantics id="alg1.l17.m1.4a"><mrow id="alg1.l17.m1.4.4" xref="alg1.l17.m1.4.4.cmml"><msubsup id="alg1.l17.m1.4.4.4" xref="alg1.l17.m1.4.4.4.cmml"><mi id="alg1.l17.m1.4.4.4.2.2" xref="alg1.l17.m1.4.4.4.2.2.cmml">𝐳</mi><mi id="alg1.l17.m1.4.4.4.3" xref="alg1.l17.m1.4.4.4.3.cmml">𝐓</mi><mrow id="alg1.l17.m1.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml"><mo mathsize="142%" id="alg1.l17.m1.2.2.2.2.1" xref="alg1.l17.m1.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="alg1.l17.m1.2.2.2.2.2" xref="alg1.l17.m1.2.2.2.3.cmml">⁣</mo><mi id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml">𝐤</mi></mrow></msubsup><mo stretchy="false" id="alg1.l17.m1.4.4.3" xref="alg1.l17.m1.4.4.3.cmml">←</mo><mrow id="alg1.l17.m1.4.4.2" xref="alg1.l17.m1.4.4.2.cmml"><msub id="alg1.l17.m1.4.4.2.4" xref="alg1.l17.m1.4.4.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.4.4.2.4.2" xref="alg1.l17.m1.4.4.2.4.2.cmml">ℱ</mi><mi id="alg1.l17.m1.4.4.2.4.3" xref="alg1.l17.m1.4.4.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l17.m1.4.4.2.3" xref="alg1.l17.m1.4.4.2.3.cmml">​</mo><mrow id="alg1.l17.m1.4.4.2.2.2" xref="alg1.l17.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="alg1.l17.m1.4.4.2.2.2.3" xref="alg1.l17.m1.4.4.2.2.3.cmml">(</mo><msub id="alg1.l17.m1.3.3.1.1.1.1" xref="alg1.l17.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l17.m1.3.3.1.1.1.1.2" xref="alg1.l17.m1.3.3.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l17.m1.3.3.1.1.1.1.3" xref="alg1.l17.m1.3.3.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l17.m1.4.4.2.2.2.4" xref="alg1.l17.m1.4.4.2.2.3.cmml">;</mo><msup id="alg1.l17.m1.4.4.2.2.2.2" xref="alg1.l17.m1.4.4.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l17.m1.4.4.2.2.2.2.2" xref="alg1.l17.m1.4.4.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l17.m1.4.4.2.2.2.2.3" xref="alg1.l17.m1.4.4.2.2.2.2.3.cmml">k</mi></msup><mo stretchy="false" id="alg1.l17.m1.4.4.2.2.2.5" xref="alg1.l17.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.4b"><apply id="alg1.l17.m1.4.4.cmml" xref="alg1.l17.m1.4.4"><ci id="alg1.l17.m1.4.4.3.cmml" xref="alg1.l17.m1.4.4.3">←</ci><apply id="alg1.l17.m1.4.4.4.cmml" xref="alg1.l17.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.4.1.cmml" xref="alg1.l17.m1.4.4.4">subscript</csymbol><apply id="alg1.l17.m1.4.4.4.2.cmml" xref="alg1.l17.m1.4.4.4"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.4.2.1.cmml" xref="alg1.l17.m1.4.4.4">superscript</csymbol><ci id="alg1.l17.m1.4.4.4.2.2.cmml" xref="alg1.l17.m1.4.4.4.2.2">𝐳</ci><list id="alg1.l17.m1.2.2.2.3.cmml" xref="alg1.l17.m1.2.2.2.2"><ci id="alg1.l17.m1.2.2.2.2.1.cmml" xref="alg1.l17.m1.2.2.2.2.1">′</ci><ci id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1">𝐤</ci></list></apply><ci id="alg1.l17.m1.4.4.4.3.cmml" xref="alg1.l17.m1.4.4.4.3">𝐓</ci></apply><apply id="alg1.l17.m1.4.4.2.cmml" xref="alg1.l17.m1.4.4.2"><times id="alg1.l17.m1.4.4.2.3.cmml" xref="alg1.l17.m1.4.4.2.3"></times><apply id="alg1.l17.m1.4.4.2.4.cmml" xref="alg1.l17.m1.4.4.2.4"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.2.4.1.cmml" xref="alg1.l17.m1.4.4.2.4">subscript</csymbol><ci id="alg1.l17.m1.4.4.2.4.2.cmml" xref="alg1.l17.m1.4.4.2.4.2">ℱ</ci><ci id="alg1.l17.m1.4.4.2.4.3.cmml" xref="alg1.l17.m1.4.4.2.4.3">𝑘</ci></apply><list id="alg1.l17.m1.4.4.2.2.3.cmml" xref="alg1.l17.m1.4.4.2.2.2"><apply id="alg1.l17.m1.3.3.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l17.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.2">𝜃</ci><ci id="alg1.l17.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l17.m1.3.3.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l17.m1.4.4.2.2.2.2.cmml" xref="alg1.l17.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l17.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l17.m1.4.4.2.2.2.2">superscript</csymbol><ci id="alg1.l17.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l17.m1.4.4.2.2.2.2.2">𝒟</ci><ci id="alg1.l17.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l17.m1.4.4.2.2.2.2.3">𝑘</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.4c">\mathbf{z^{\prime k}_{T}}\leftarrow\mathcal{F}_{k}(\mathbf{\theta}_{k};\mathcal{D}^{k})</annotation></semantics></math>

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.2.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>         <span id="alg1.l18.1" class="ltx_text ltx_font_bold">Upload <math id="alg1.l18.1.m1.6" class="ltx_Math" alttext="\mathbf{\theta}^{t}_{g,k},\mathbf{z^{\prime k}_{T}}" display="inline"><semantics id="alg1.l18.1.m1.6a"><mrow id="alg1.l18.1.m1.6.6.2" xref="alg1.l18.1.m1.6.6.3.cmml"><msubsup id="alg1.l18.1.m1.5.5.1.1" xref="alg1.l18.1.m1.5.5.1.1.cmml"><mi id="alg1.l18.1.m1.5.5.1.1.2.2" xref="alg1.l18.1.m1.5.5.1.1.2.2.cmml">θ</mi><mrow id="alg1.l18.1.m1.2.2.2.4" xref="alg1.l18.1.m1.2.2.2.3.cmml"><mi id="alg1.l18.1.m1.1.1.1.1" xref="alg1.l18.1.m1.1.1.1.1.cmml">g</mi><mo id="alg1.l18.1.m1.2.2.2.4.1" xref="alg1.l18.1.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l18.1.m1.2.2.2.2" xref="alg1.l18.1.m1.2.2.2.2.cmml">k</mi></mrow><mi id="alg1.l18.1.m1.5.5.1.1.2.3" xref="alg1.l18.1.m1.5.5.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l18.1.m1.6.6.2.3" xref="alg1.l18.1.m1.6.6.3.cmml">,</mo><msubsup id="alg1.l18.1.m1.6.6.2.2" xref="alg1.l18.1.m1.6.6.2.2.cmml"><mi id="alg1.l18.1.m1.6.6.2.2.2.2" xref="alg1.l18.1.m1.6.6.2.2.2.2.cmml">𝐳</mi><mi id="alg1.l18.1.m1.6.6.2.2.3" xref="alg1.l18.1.m1.6.6.2.2.3.cmml">𝐓</mi><mrow id="alg1.l18.1.m1.4.4.2.2" xref="alg1.l18.1.m1.4.4.2.3.cmml"><mo mathsize="142%" id="alg1.l18.1.m1.4.4.2.2.1" xref="alg1.l18.1.m1.4.4.2.2.1.cmml">′</mo><mo lspace="0em" id="alg1.l18.1.m1.4.4.2.2.2" xref="alg1.l18.1.m1.4.4.2.3.cmml">⁣</mo><mi id="alg1.l18.1.m1.3.3.1.1" xref="alg1.l18.1.m1.3.3.1.1.cmml">𝐤</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.1.m1.6b"><list id="alg1.l18.1.m1.6.6.3.cmml" xref="alg1.l18.1.m1.6.6.2"><apply id="alg1.l18.1.m1.5.5.1.1.cmml" xref="alg1.l18.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l18.1.m1.5.5.1.1.1.cmml" xref="alg1.l18.1.m1.5.5.1.1">subscript</csymbol><apply id="alg1.l18.1.m1.5.5.1.1.2.cmml" xref="alg1.l18.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l18.1.m1.5.5.1.1.2.1.cmml" xref="alg1.l18.1.m1.5.5.1.1">superscript</csymbol><ci id="alg1.l18.1.m1.5.5.1.1.2.2.cmml" xref="alg1.l18.1.m1.5.5.1.1.2.2">𝜃</ci><ci id="alg1.l18.1.m1.5.5.1.1.2.3.cmml" xref="alg1.l18.1.m1.5.5.1.1.2.3">𝑡</ci></apply><list id="alg1.l18.1.m1.2.2.2.3.cmml" xref="alg1.l18.1.m1.2.2.2.4"><ci id="alg1.l18.1.m1.1.1.1.1.cmml" xref="alg1.l18.1.m1.1.1.1.1">𝑔</ci><ci id="alg1.l18.1.m1.2.2.2.2.cmml" xref="alg1.l18.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="alg1.l18.1.m1.6.6.2.2.cmml" xref="alg1.l18.1.m1.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l18.1.m1.6.6.2.2.1.cmml" xref="alg1.l18.1.m1.6.6.2.2">subscript</csymbol><apply id="alg1.l18.1.m1.6.6.2.2.2.cmml" xref="alg1.l18.1.m1.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l18.1.m1.6.6.2.2.2.1.cmml" xref="alg1.l18.1.m1.6.6.2.2">superscript</csymbol><ci id="alg1.l18.1.m1.6.6.2.2.2.2.cmml" xref="alg1.l18.1.m1.6.6.2.2.2.2">𝐳</ci><list id="alg1.l18.1.m1.4.4.2.3.cmml" xref="alg1.l18.1.m1.4.4.2.2"><ci id="alg1.l18.1.m1.4.4.2.2.1.cmml" xref="alg1.l18.1.m1.4.4.2.2.1">′</ci><ci id="alg1.l18.1.m1.3.3.1.1.cmml" xref="alg1.l18.1.m1.3.3.1.1">𝐤</ci></list></apply><ci id="alg1.l18.1.m1.6.6.2.2.3.cmml" xref="alg1.l18.1.m1.6.6.2.2.3">𝐓</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.1.m1.6c">\mathbf{\theta}^{t}_{g,k},\mathbf{z^{\prime k}_{T}}</annotation></semantics></math> to server</span>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>     <span id="alg1.l19.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.2.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>     <span id="alg1.l20.1" class="ltx_text ltx_font_bold">## Step 4.1: Server trains <math id="alg1.l20.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{s}" display="inline"><semantics id="alg1.l20.1.m1.1a"><msub id="alg1.l20.1.m1.1.1" xref="alg1.l20.1.m1.1.1.cmml"><mi id="alg1.l20.1.m1.1.1.2" xref="alg1.l20.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l20.1.m1.1.1.3" xref="alg1.l20.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l20.1.m1.1b"><apply id="alg1.l20.1.m1.1.1.cmml" xref="alg1.l20.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l20.1.m1.1.1.1.cmml" xref="alg1.l20.1.m1.1.1">subscript</csymbol><ci id="alg1.l20.1.m1.1.1.2.cmml" xref="alg1.l20.1.m1.1.1.2">𝜃</ci><ci id="alg1.l20.1.m1.1.1.3.cmml" xref="alg1.l20.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.1.m1.1c">\mathbf{\theta}_{s}</annotation></semantics></math></span>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>     <span id="alg1.l21.2" class="ltx_text ltx_font_bold">for</span> Each edge device <math id="alg1.l21.m1.1" class="ltx_Math" alttext="k\in\mathcal{S}" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">k</mi><mo id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><in id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1"></in><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝑘</ci><ci id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">k\in\mathcal{S}</annotation></semantics></math> <span id="alg1.l21.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l22.4.1.1" class="ltx_text" style="font-size:80%;">22:</span></span>         <math id="alg1.l22.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{s}\leftarrow" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><msub id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml"><mi id="alg1.l22.m1.1.1.2.2" xref="alg1.l22.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l22.m1.1.1.2.3" xref="alg1.l22.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml">←</mo><mi id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><ci id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1">←</ci><apply id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.1.cmml" xref="alg1.l22.m1.1.1.2">subscript</csymbol><ci id="alg1.l22.m1.1.1.2.2.cmml" xref="alg1.l22.m1.1.1.2.2">𝜃</ci><ci id="alg1.l22.m1.1.1.2.3.cmml" xref="alg1.l22.m1.1.1.2.3">𝑠</ci></apply><csymbol cd="latexml" id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">\mathbf{\theta}_{s}\leftarrow</annotation></semantics></math> <span id="alg1.l22.3" class="ltx_text ltx_font_bold">ServerTrain(<math id="alg1.l22.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}^{t}_{s}" display="inline"><semantics id="alg1.l22.1.m1.1a"><msubsup id="alg1.l22.1.m1.1.1" xref="alg1.l22.1.m1.1.1.cmml"><mi id="alg1.l22.1.m1.1.1.2.2" xref="alg1.l22.1.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l22.1.m1.1.1.3" xref="alg1.l22.1.m1.1.1.3.cmml">s</mi><mi id="alg1.l22.1.m1.1.1.2.3" xref="alg1.l22.1.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l22.1.m1.1b"><apply id="alg1.l22.1.m1.1.1.cmml" xref="alg1.l22.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.1.m1.1.1.1.cmml" xref="alg1.l22.1.m1.1.1">subscript</csymbol><apply id="alg1.l22.1.m1.1.1.2.cmml" xref="alg1.l22.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l22.1.m1.1.1.2.1.cmml" xref="alg1.l22.1.m1.1.1">superscript</csymbol><ci id="alg1.l22.1.m1.1.1.2.2.cmml" xref="alg1.l22.1.m1.1.1.2.2">𝜃</ci><ci id="alg1.l22.1.m1.1.1.2.3.cmml" xref="alg1.l22.1.m1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l22.1.m1.1.1.3.cmml" xref="alg1.l22.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.1.m1.1c">\mathbf{\theta}^{t}_{s}</annotation></semantics></math>, <math id="alg1.l22.2.m2.2" class="ltx_Math" alttext="\mathbf{z^{\prime k}_{T}}" display="inline"><semantics id="alg1.l22.2.m2.2a"><msubsup id="alg1.l22.2.m2.2.3" xref="alg1.l22.2.m2.2.3.cmml"><mi id="alg1.l22.2.m2.2.3.2.2" xref="alg1.l22.2.m2.2.3.2.2.cmml">𝐳</mi><mi id="alg1.l22.2.m2.2.3.3" xref="alg1.l22.2.m2.2.3.3.cmml">𝐓</mi><mrow id="alg1.l22.2.m2.2.2.2.2" xref="alg1.l22.2.m2.2.2.2.3.cmml"><mo mathsize="142%" id="alg1.l22.2.m2.2.2.2.2.1" xref="alg1.l22.2.m2.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="alg1.l22.2.m2.2.2.2.2.2" xref="alg1.l22.2.m2.2.2.2.3.cmml">⁣</mo><mi id="alg1.l22.2.m2.1.1.1.1" xref="alg1.l22.2.m2.1.1.1.1.cmml">𝐤</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l22.2.m2.2b"><apply id="alg1.l22.2.m2.2.3.cmml" xref="alg1.l22.2.m2.2.3"><csymbol cd="ambiguous" id="alg1.l22.2.m2.2.3.1.cmml" xref="alg1.l22.2.m2.2.3">subscript</csymbol><apply id="alg1.l22.2.m2.2.3.2.cmml" xref="alg1.l22.2.m2.2.3"><csymbol cd="ambiguous" id="alg1.l22.2.m2.2.3.2.1.cmml" xref="alg1.l22.2.m2.2.3">superscript</csymbol><ci id="alg1.l22.2.m2.2.3.2.2.cmml" xref="alg1.l22.2.m2.2.3.2.2">𝐳</ci><list id="alg1.l22.2.m2.2.2.2.3.cmml" xref="alg1.l22.2.m2.2.2.2.2"><ci id="alg1.l22.2.m2.2.2.2.2.1.cmml" xref="alg1.l22.2.m2.2.2.2.2.1">′</ci><ci id="alg1.l22.2.m2.1.1.1.1.cmml" xref="alg1.l22.2.m2.1.1.1.1">𝐤</ci></list></apply><ci id="alg1.l22.2.m2.2.3.3.cmml" xref="alg1.l22.2.m2.2.3.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.2.m2.2c">\mathbf{z^{\prime k}_{T}}</annotation></semantics></math>, <math id="alg1.l22.3.m3.1" class="ltx_Math" alttext="\mathbf{X}^{k}_{T}" display="inline"><semantics id="alg1.l22.3.m3.1a"><msubsup id="alg1.l22.3.m3.1.1" xref="alg1.l22.3.m3.1.1.cmml"><mi id="alg1.l22.3.m3.1.1.2.2" xref="alg1.l22.3.m3.1.1.2.2.cmml">𝐗</mi><mi id="alg1.l22.3.m3.1.1.3" xref="alg1.l22.3.m3.1.1.3.cmml">T</mi><mi id="alg1.l22.3.m3.1.1.2.3" xref="alg1.l22.3.m3.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l22.3.m3.1b"><apply id="alg1.l22.3.m3.1.1.cmml" xref="alg1.l22.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l22.3.m3.1.1.1.cmml" xref="alg1.l22.3.m3.1.1">subscript</csymbol><apply id="alg1.l22.3.m3.1.1.2.cmml" xref="alg1.l22.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l22.3.m3.1.1.2.1.cmml" xref="alg1.l22.3.m3.1.1">superscript</csymbol><ci id="alg1.l22.3.m3.1.1.2.2.cmml" xref="alg1.l22.3.m3.1.1.2.2">𝐗</ci><ci id="alg1.l22.3.m3.1.1.2.3.cmml" xref="alg1.l22.3.m3.1.1.2.3">𝑘</ci></apply><ci id="alg1.l22.3.m3.1.1.3.cmml" xref="alg1.l22.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.3.m3.1c">\mathbf{X}^{k}_{T}</annotation></semantics></math>)</span>

</div>
<div id="alg1.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l23.1.1.1" class="ltx_text" style="font-size:80%;">23:</span></span>     <span id="alg1.l23.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l23.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l24.1.1.1" class="ltx_text" style="font-size:80%;">24:</span></span>     <span id="alg1.l24.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l24.m1.4" class="ltx_Math" alttext="k\in\{1,2,...,K\}" display="inline"><semantics id="alg1.l24.m1.4a"><mrow id="alg1.l24.m1.4.5" xref="alg1.l24.m1.4.5.cmml"><mi id="alg1.l24.m1.4.5.2" xref="alg1.l24.m1.4.5.2.cmml">k</mi><mo id="alg1.l24.m1.4.5.1" xref="alg1.l24.m1.4.5.1.cmml">∈</mo><mrow id="alg1.l24.m1.4.5.3.2" xref="alg1.l24.m1.4.5.3.1.cmml"><mo stretchy="false" id="alg1.l24.m1.4.5.3.2.1" xref="alg1.l24.m1.4.5.3.1.cmml">{</mo><mn id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml">1</mn><mo id="alg1.l24.m1.4.5.3.2.2" xref="alg1.l24.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l24.m1.2.2" xref="alg1.l24.m1.2.2.cmml">2</mn><mo id="alg1.l24.m1.4.5.3.2.3" xref="alg1.l24.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l24.m1.3.3" xref="alg1.l24.m1.3.3.cmml">…</mi><mo id="alg1.l24.m1.4.5.3.2.4" xref="alg1.l24.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l24.m1.4.4" xref="alg1.l24.m1.4.4.cmml">K</mi><mo stretchy="false" id="alg1.l24.m1.4.5.3.2.5" xref="alg1.l24.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.4b"><apply id="alg1.l24.m1.4.5.cmml" xref="alg1.l24.m1.4.5"><in id="alg1.l24.m1.4.5.1.cmml" xref="alg1.l24.m1.4.5.1"></in><ci id="alg1.l24.m1.4.5.2.cmml" xref="alg1.l24.m1.4.5.2">𝑘</ci><set id="alg1.l24.m1.4.5.3.1.cmml" xref="alg1.l24.m1.4.5.3.2"><cn type="integer" id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1">1</cn><cn type="integer" id="alg1.l24.m1.2.2.cmml" xref="alg1.l24.m1.2.2">2</cn><ci id="alg1.l24.m1.3.3.cmml" xref="alg1.l24.m1.3.3">…</ci><ci id="alg1.l24.m1.4.4.cmml" xref="alg1.l24.m1.4.4">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.4c">k\in\{1,2,...,K\}</annotation></semantics></math> <span id="alg1.l24.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l25.1.1.1" class="ltx_text" style="font-size:80%;">25:</span></span>         <math id="alg1.l25.m1.2" class="ltx_Math" alttext="\mathbf{z^{k}_{T}}\leftarrow\mathcal{F}_{s}(\mathbf{\theta}_{s};\mathbf{X^{k}_{T}})" display="inline"><semantics id="alg1.l25.m1.2a"><mrow id="alg1.l25.m1.2.2" xref="alg1.l25.m1.2.2.cmml"><msubsup id="alg1.l25.m1.2.2.4" xref="alg1.l25.m1.2.2.4.cmml"><mi id="alg1.l25.m1.2.2.4.2.2" xref="alg1.l25.m1.2.2.4.2.2.cmml">𝐳</mi><mi id="alg1.l25.m1.2.2.4.3" xref="alg1.l25.m1.2.2.4.3.cmml">𝐓</mi><mi id="alg1.l25.m1.2.2.4.2.3" xref="alg1.l25.m1.2.2.4.2.3.cmml">𝐤</mi></msubsup><mo stretchy="false" id="alg1.l25.m1.2.2.3" xref="alg1.l25.m1.2.2.3.cmml">←</mo><mrow id="alg1.l25.m1.2.2.2" xref="alg1.l25.m1.2.2.2.cmml"><msub id="alg1.l25.m1.2.2.2.4" xref="alg1.l25.m1.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l25.m1.2.2.2.4.2" xref="alg1.l25.m1.2.2.2.4.2.cmml">ℱ</mi><mi id="alg1.l25.m1.2.2.2.4.3" xref="alg1.l25.m1.2.2.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l25.m1.2.2.2.3" xref="alg1.l25.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l25.m1.2.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l25.m1.2.2.2.2.2.3" xref="alg1.l25.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l25.m1.1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l25.m1.1.1.1.1.1.1.2" xref="alg1.l25.m1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l25.m1.1.1.1.1.1.1.3" xref="alg1.l25.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l25.m1.2.2.2.2.2.4" xref="alg1.l25.m1.2.2.2.2.3.cmml">;</mo><msubsup id="alg1.l25.m1.2.2.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l25.m1.2.2.2.2.2.2.2.2" xref="alg1.l25.m1.2.2.2.2.2.2.2.2.cmml">𝐗</mi><mi id="alg1.l25.m1.2.2.2.2.2.2.3" xref="alg1.l25.m1.2.2.2.2.2.2.3.cmml">𝐓</mi><mi id="alg1.l25.m1.2.2.2.2.2.2.2.3" xref="alg1.l25.m1.2.2.2.2.2.2.2.3.cmml">𝐤</mi></msubsup><mo stretchy="false" id="alg1.l25.m1.2.2.2.2.2.5" xref="alg1.l25.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.2b"><apply id="alg1.l25.m1.2.2.cmml" xref="alg1.l25.m1.2.2"><ci id="alg1.l25.m1.2.2.3.cmml" xref="alg1.l25.m1.2.2.3">←</ci><apply id="alg1.l25.m1.2.2.4.cmml" xref="alg1.l25.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.4.1.cmml" xref="alg1.l25.m1.2.2.4">subscript</csymbol><apply id="alg1.l25.m1.2.2.4.2.cmml" xref="alg1.l25.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.4.2.1.cmml" xref="alg1.l25.m1.2.2.4">superscript</csymbol><ci id="alg1.l25.m1.2.2.4.2.2.cmml" xref="alg1.l25.m1.2.2.4.2.2">𝐳</ci><ci id="alg1.l25.m1.2.2.4.2.3.cmml" xref="alg1.l25.m1.2.2.4.2.3">𝐤</ci></apply><ci id="alg1.l25.m1.2.2.4.3.cmml" xref="alg1.l25.m1.2.2.4.3">𝐓</ci></apply><apply id="alg1.l25.m1.2.2.2.cmml" xref="alg1.l25.m1.2.2.2"><times id="alg1.l25.m1.2.2.2.3.cmml" xref="alg1.l25.m1.2.2.2.3"></times><apply id="alg1.l25.m1.2.2.2.4.cmml" xref="alg1.l25.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.2.4.1.cmml" xref="alg1.l25.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l25.m1.2.2.2.4.2.cmml" xref="alg1.l25.m1.2.2.2.4.2">ℱ</ci><ci id="alg1.l25.m1.2.2.2.4.3.cmml" xref="alg1.l25.m1.2.2.2.4.3">𝑠</ci></apply><list id="alg1.l25.m1.2.2.2.2.3.cmml" xref="alg1.l25.m1.2.2.2.2.2"><apply id="alg1.l25.m1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l25.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l25.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l25.m1.2.2.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l25.m1.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.l25.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l25.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l25.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l25.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l25.m1.2.2.2.2.2.2.2.2">𝐗</ci><ci id="alg1.l25.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l25.m1.2.2.2.2.2.2.2.3">𝐤</ci></apply><ci id="alg1.l25.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l25.m1.2.2.2.2.2.2.3">𝐓</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.2c">\mathbf{z^{k}_{T}}\leftarrow\mathcal{F}_{s}(\mathbf{\theta}_{s};\mathbf{X^{k}_{T}})</annotation></semantics></math>

</div>
<div id="alg1.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l26.1.1.1" class="ltx_text" style="font-size:80%;">26:</span></span>     <span id="alg1.l26.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l26.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l27.2.1.1" class="ltx_text" style="font-size:80%;">27:</span></span>     <span id="alg1.l27.1" class="ltx_text ltx_font_bold">## Step 4.2: Server aggregates <math id="alg1.l27.1.m1.2" class="ltx_Math" alttext="\mathbf{\theta^{t}_{g,k}}" display="inline"><semantics id="alg1.l27.1.m1.2a"><msubsup id="alg1.l27.1.m1.2.3" xref="alg1.l27.1.m1.2.3.cmml"><mi id="alg1.l27.1.m1.2.3.2.2" xref="alg1.l27.1.m1.2.3.2.2.cmml">θ</mi><mrow id="alg1.l27.1.m1.2.2.2.4" xref="alg1.l27.1.m1.2.2.2.3.cmml"><mi id="alg1.l27.1.m1.1.1.1.1" xref="alg1.l27.1.m1.1.1.1.1.cmml">𝐠</mi><mo id="alg1.l27.1.m1.2.2.2.4.1" xref="alg1.l27.1.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l27.1.m1.2.2.2.2" xref="alg1.l27.1.m1.2.2.2.2.cmml">𝐤</mi></mrow><mi id="alg1.l27.1.m1.2.3.2.3" xref="alg1.l27.1.m1.2.3.2.3.cmml">𝐭</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l27.1.m1.2b"><apply id="alg1.l27.1.m1.2.3.cmml" xref="alg1.l27.1.m1.2.3"><csymbol cd="ambiguous" id="alg1.l27.1.m1.2.3.1.cmml" xref="alg1.l27.1.m1.2.3">subscript</csymbol><apply id="alg1.l27.1.m1.2.3.2.cmml" xref="alg1.l27.1.m1.2.3"><csymbol cd="ambiguous" id="alg1.l27.1.m1.2.3.2.1.cmml" xref="alg1.l27.1.m1.2.3">superscript</csymbol><ci id="alg1.l27.1.m1.2.3.2.2.cmml" xref="alg1.l27.1.m1.2.3.2.2">𝜃</ci><ci id="alg1.l27.1.m1.2.3.2.3.cmml" xref="alg1.l27.1.m1.2.3.2.3">𝐭</ci></apply><list id="alg1.l27.1.m1.2.2.2.3.cmml" xref="alg1.l27.1.m1.2.2.2.4"><ci id="alg1.l27.1.m1.1.1.1.1.cmml" xref="alg1.l27.1.m1.1.1.1.1">𝐠</ci><ci id="alg1.l27.1.m1.2.2.2.2.cmml" xref="alg1.l27.1.m1.2.2.2.2">𝐤</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.1.m1.2c">\mathbf{\theta^{t}_{g,k}}</annotation></semantics></math></span>

</div>
<div id="alg1.l28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l28.1.1.1" class="ltx_text" style="font-size:80%;">28:</span></span>     <math id="alg1.l28.m1.3" class="ltx_Math" alttext="\mathbf{\theta^{t+1}_{g}}\leftarrow\frac{1}{|\mathcal{S}|}\sum_{k\in\mathcal{S}}\mathbf{\theta_{g,k}^{t}}" display="inline"><semantics id="alg1.l28.m1.3a"><mrow id="alg1.l28.m1.3.4" xref="alg1.l28.m1.3.4.cmml"><msubsup id="alg1.l28.m1.3.4.2" xref="alg1.l28.m1.3.4.2.cmml"><mi id="alg1.l28.m1.3.4.2.2.2" xref="alg1.l28.m1.3.4.2.2.2.cmml">θ</mi><mi id="alg1.l28.m1.3.4.2.3" xref="alg1.l28.m1.3.4.2.3.cmml">𝐠</mi><mrow id="alg1.l28.m1.3.4.2.2.3" xref="alg1.l28.m1.3.4.2.2.3.cmml"><mi id="alg1.l28.m1.3.4.2.2.3.2" xref="alg1.l28.m1.3.4.2.2.3.2.cmml">𝐭</mi><mo id="alg1.l28.m1.3.4.2.2.3.1" xref="alg1.l28.m1.3.4.2.2.3.1.cmml">+</mo><mn id="alg1.l28.m1.3.4.2.2.3.3" xref="alg1.l28.m1.3.4.2.2.3.3.cmml">𝟏</mn></mrow></msubsup><mo stretchy="false" id="alg1.l28.m1.3.4.1" xref="alg1.l28.m1.3.4.1.cmml">←</mo><mrow id="alg1.l28.m1.3.4.3" xref="alg1.l28.m1.3.4.3.cmml"><mfrac id="alg1.l28.m1.1.1" xref="alg1.l28.m1.1.1.cmml"><mn id="alg1.l28.m1.1.1.3" xref="alg1.l28.m1.1.1.3.cmml">1</mn><mrow id="alg1.l28.m1.1.1.1.3" xref="alg1.l28.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l28.m1.1.1.1.3.1" xref="alg1.l28.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.1.1.1.1" xref="alg1.l28.m1.1.1.1.1.cmml">𝒮</mi><mo stretchy="false" id="alg1.l28.m1.1.1.1.3.2" xref="alg1.l28.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l28.m1.3.4.3.1" xref="alg1.l28.m1.3.4.3.1.cmml">​</mo><mrow id="alg1.l28.m1.3.4.3.2" xref="alg1.l28.m1.3.4.3.2.cmml"><msub id="alg1.l28.m1.3.4.3.2.1" xref="alg1.l28.m1.3.4.3.2.1.cmml"><mo id="alg1.l28.m1.3.4.3.2.1.2" xref="alg1.l28.m1.3.4.3.2.1.2.cmml">∑</mo><mrow id="alg1.l28.m1.3.4.3.2.1.3" xref="alg1.l28.m1.3.4.3.2.1.3.cmml"><mi id="alg1.l28.m1.3.4.3.2.1.3.2" xref="alg1.l28.m1.3.4.3.2.1.3.2.cmml">k</mi><mo id="alg1.l28.m1.3.4.3.2.1.3.1" xref="alg1.l28.m1.3.4.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l28.m1.3.4.3.2.1.3.3" xref="alg1.l28.m1.3.4.3.2.1.3.3.cmml">𝒮</mi></mrow></msub><msubsup id="alg1.l28.m1.3.4.3.2.2" xref="alg1.l28.m1.3.4.3.2.2.cmml"><mi id="alg1.l28.m1.3.4.3.2.2.2.2" xref="alg1.l28.m1.3.4.3.2.2.2.2.cmml">θ</mi><mrow id="alg1.l28.m1.3.3.2.4" xref="alg1.l28.m1.3.3.2.3.cmml"><mi id="alg1.l28.m1.2.2.1.1" xref="alg1.l28.m1.2.2.1.1.cmml">𝐠</mi><mo id="alg1.l28.m1.3.3.2.4.1" xref="alg1.l28.m1.3.3.2.3.cmml">,</mo><mi id="alg1.l28.m1.3.3.2.2" xref="alg1.l28.m1.3.3.2.2.cmml">𝐤</mi></mrow><mi id="alg1.l28.m1.3.4.3.2.2.3" xref="alg1.l28.m1.3.4.3.2.2.3.cmml">𝐭</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l28.m1.3b"><apply id="alg1.l28.m1.3.4.cmml" xref="alg1.l28.m1.3.4"><ci id="alg1.l28.m1.3.4.1.cmml" xref="alg1.l28.m1.3.4.1">←</ci><apply id="alg1.l28.m1.3.4.2.cmml" xref="alg1.l28.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l28.m1.3.4.2.1.cmml" xref="alg1.l28.m1.3.4.2">subscript</csymbol><apply id="alg1.l28.m1.3.4.2.2.cmml" xref="alg1.l28.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l28.m1.3.4.2.2.1.cmml" xref="alg1.l28.m1.3.4.2">superscript</csymbol><ci id="alg1.l28.m1.3.4.2.2.2.cmml" xref="alg1.l28.m1.3.4.2.2.2">𝜃</ci><apply id="alg1.l28.m1.3.4.2.2.3.cmml" xref="alg1.l28.m1.3.4.2.2.3"><plus id="alg1.l28.m1.3.4.2.2.3.1.cmml" xref="alg1.l28.m1.3.4.2.2.3.1"></plus><ci id="alg1.l28.m1.3.4.2.2.3.2.cmml" xref="alg1.l28.m1.3.4.2.2.3.2">𝐭</ci><cn type="integer" id="alg1.l28.m1.3.4.2.2.3.3.cmml" xref="alg1.l28.m1.3.4.2.2.3.3">1</cn></apply></apply><ci id="alg1.l28.m1.3.4.2.3.cmml" xref="alg1.l28.m1.3.4.2.3">𝐠</ci></apply><apply id="alg1.l28.m1.3.4.3.cmml" xref="alg1.l28.m1.3.4.3"><times id="alg1.l28.m1.3.4.3.1.cmml" xref="alg1.l28.m1.3.4.3.1"></times><apply id="alg1.l28.m1.1.1.cmml" xref="alg1.l28.m1.1.1"><divide id="alg1.l28.m1.1.1.2.cmml" xref="alg1.l28.m1.1.1"></divide><cn type="integer" id="alg1.l28.m1.1.1.3.cmml" xref="alg1.l28.m1.1.1.3">1</cn><apply id="alg1.l28.m1.1.1.1.2.cmml" xref="alg1.l28.m1.1.1.1.3"><abs id="alg1.l28.m1.1.1.1.2.1.cmml" xref="alg1.l28.m1.1.1.1.3.1"></abs><ci id="alg1.l28.m1.1.1.1.1.cmml" xref="alg1.l28.m1.1.1.1.1">𝒮</ci></apply></apply><apply id="alg1.l28.m1.3.4.3.2.cmml" xref="alg1.l28.m1.3.4.3.2"><apply id="alg1.l28.m1.3.4.3.2.1.cmml" xref="alg1.l28.m1.3.4.3.2.1"><csymbol cd="ambiguous" id="alg1.l28.m1.3.4.3.2.1.1.cmml" xref="alg1.l28.m1.3.4.3.2.1">subscript</csymbol><sum id="alg1.l28.m1.3.4.3.2.1.2.cmml" xref="alg1.l28.m1.3.4.3.2.1.2"></sum><apply id="alg1.l28.m1.3.4.3.2.1.3.cmml" xref="alg1.l28.m1.3.4.3.2.1.3"><in id="alg1.l28.m1.3.4.3.2.1.3.1.cmml" xref="alg1.l28.m1.3.4.3.2.1.3.1"></in><ci id="alg1.l28.m1.3.4.3.2.1.3.2.cmml" xref="alg1.l28.m1.3.4.3.2.1.3.2">𝑘</ci><ci id="alg1.l28.m1.3.4.3.2.1.3.3.cmml" xref="alg1.l28.m1.3.4.3.2.1.3.3">𝒮</ci></apply></apply><apply id="alg1.l28.m1.3.4.3.2.2.cmml" xref="alg1.l28.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.3.4.3.2.2.1.cmml" xref="alg1.l28.m1.3.4.3.2.2">superscript</csymbol><apply id="alg1.l28.m1.3.4.3.2.2.2.cmml" xref="alg1.l28.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l28.m1.3.4.3.2.2.2.1.cmml" xref="alg1.l28.m1.3.4.3.2.2">subscript</csymbol><ci id="alg1.l28.m1.3.4.3.2.2.2.2.cmml" xref="alg1.l28.m1.3.4.3.2.2.2.2">𝜃</ci><list id="alg1.l28.m1.3.3.2.3.cmml" xref="alg1.l28.m1.3.3.2.4"><ci id="alg1.l28.m1.2.2.1.1.cmml" xref="alg1.l28.m1.2.2.1.1">𝐠</ci><ci id="alg1.l28.m1.3.3.2.2.cmml" xref="alg1.l28.m1.3.3.2.2">𝐤</ci></list></apply><ci id="alg1.l28.m1.3.4.3.2.2.3.cmml" xref="alg1.l28.m1.3.4.3.2.2.3">𝐭</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l28.m1.3c">\mathbf{\theta^{t+1}_{g}}\leftarrow\frac{1}{|\mathcal{S}|}\sum_{k\in\mathcal{S}}\mathbf{\theta_{g,k}^{t}}</annotation></semantics></math>

</div>
<div id="alg1.l29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l29.1.1.1" class="ltx_text" style="font-size:80%;">29:</span></span><span id="alg1.l29.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l29.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l30.5.1.1" class="ltx_text" style="font-size:80%;">30:</span></span><span id="alg1.l30.6" class="ltx_text ltx_font_bold">function</span> <span id="alg1.l30.4" class="ltx_text ltx_font_bold ltx_font_smallcaps">ClientTrain(<math id="alg1.l30.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{g}" display="inline"><semantics id="alg1.l30.1.m1.1a"><msub id="alg1.l30.1.m1.1.1" xref="alg1.l30.1.m1.1.1.cmml"><mi id="alg1.l30.1.m1.1.1.2" xref="alg1.l30.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l30.1.m1.1.1.3" xref="alg1.l30.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l30.1.m1.1b"><apply id="alg1.l30.1.m1.1.1.cmml" xref="alg1.l30.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l30.1.m1.1.1.1.cmml" xref="alg1.l30.1.m1.1.1">subscript</csymbol><ci id="alg1.l30.1.m1.1.1.2.cmml" xref="alg1.l30.1.m1.1.1.2">𝜃</ci><ci id="alg1.l30.1.m1.1.1.3.cmml" xref="alg1.l30.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.1.m1.1c">\mathbf{\theta}_{g}</annotation></semantics></math>, <math id="alg1.l30.2.m2.1" class="ltx_Math" alttext="\mathbf{\theta}_{k}" display="inline"><semantics id="alg1.l30.2.m2.1a"><msub id="alg1.l30.2.m2.1.1" xref="alg1.l30.2.m2.1.1.cmml"><mi id="alg1.l30.2.m2.1.1.2" xref="alg1.l30.2.m2.1.1.2.cmml">θ</mi><mi id="alg1.l30.2.m2.1.1.3" xref="alg1.l30.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l30.2.m2.1b"><apply id="alg1.l30.2.m2.1.1.cmml" xref="alg1.l30.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l30.2.m2.1.1.1.cmml" xref="alg1.l30.2.m2.1.1">subscript</csymbol><ci id="alg1.l30.2.m2.1.1.2.cmml" xref="alg1.l30.2.m2.1.1.2">𝜃</ci><ci id="alg1.l30.2.m2.1.1.3.cmml" xref="alg1.l30.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.2.m2.1c">\mathbf{\theta}_{k}</annotation></semantics></math>, <math id="alg1.l30.3.m3.1" class="ltx_Math" alttext="\mathbf{z_{T}}" display="inline"><semantics id="alg1.l30.3.m3.1a"><msub id="alg1.l30.3.m3.1.1" xref="alg1.l30.3.m3.1.1.cmml"><mi mathvariant="normal" id="alg1.l30.3.m3.1.1.2" xref="alg1.l30.3.m3.1.1.2.cmml">z</mi><mi mathvariant="normal" id="alg1.l30.3.m3.1.1.3" xref="alg1.l30.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l30.3.m3.1b"><apply id="alg1.l30.3.m3.1.1.cmml" xref="alg1.l30.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l30.3.m3.1.1.1.cmml" xref="alg1.l30.3.m3.1.1">subscript</csymbol><ci id="alg1.l30.3.m3.1.1.2.cmml" xref="alg1.l30.3.m3.1.1.2">z</ci><ci id="alg1.l30.3.m3.1.1.3.cmml" xref="alg1.l30.3.m3.1.1.3">T</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.3.m3.1c">\mathbf{z_{T}}</annotation></semantics></math>, <math id="alg1.l30.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg1.l30.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l30.4.m4.1.1" xref="alg1.l30.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l30.4.m4.1b"><ci id="alg1.l30.4.m4.1.1.cmml" xref="alg1.l30.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.4.m4.1c">\mathcal{D}</annotation></semantics></math>)</span>

</div>
<div id="alg1.l31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l31.1.1.1" class="ltx_text" style="font-size:80%;">31:</span></span>     <span id="alg1.l31.2" class="ltx_text ltx_font_bold">for</span> Local epoch <math id="alg1.l31.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg1.l31.m1.1a"><mi id="alg1.l31.m1.1.1" xref="alg1.l31.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l31.m1.1b"><ci id="alg1.l31.m1.1.1.cmml" xref="alg1.l31.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m1.1c">e</annotation></semantics></math> from 0 to <math id="alg1.l31.m2.1" class="ltx_Math" alttext="E-1" display="inline"><semantics id="alg1.l31.m2.1a"><mrow id="alg1.l31.m2.1.1" xref="alg1.l31.m2.1.1.cmml"><mi id="alg1.l31.m2.1.1.2" xref="alg1.l31.m2.1.1.2.cmml">E</mi><mo id="alg1.l31.m2.1.1.1" xref="alg1.l31.m2.1.1.1.cmml">−</mo><mn id="alg1.l31.m2.1.1.3" xref="alg1.l31.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l31.m2.1b"><apply id="alg1.l31.m2.1.1.cmml" xref="alg1.l31.m2.1.1"><minus id="alg1.l31.m2.1.1.1.cmml" xref="alg1.l31.m2.1.1.1"></minus><ci id="alg1.l31.m2.1.1.2.cmml" xref="alg1.l31.m2.1.1.2">𝐸</ci><cn type="integer" id="alg1.l31.m2.1.1.3.cmml" xref="alg1.l31.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l31.m2.1c">E-1</annotation></semantics></math> <span id="alg1.l31.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l32.1.1.1" class="ltx_text" style="font-size:80%;">32:</span></span>         <span id="alg1.l32.2" class="ltx_text ltx_font_bold">for</span> Iteration <math id="alg1.l32.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l32.m1.1a"><mi id="alg1.l32.m1.1.1" xref="alg1.l32.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l32.m1.1b"><ci id="alg1.l32.m1.1.1.cmml" xref="alg1.l32.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m1.1c">i</annotation></semantics></math> from 0 to <math id="alg1.l32.m2.1" class="ltx_Math" alttext="I-1" display="inline"><semantics id="alg1.l32.m2.1a"><mrow id="alg1.l32.m2.1.1" xref="alg1.l32.m2.1.1.cmml"><mi id="alg1.l32.m2.1.1.2" xref="alg1.l32.m2.1.1.2.cmml">I</mi><mo id="alg1.l32.m2.1.1.1" xref="alg1.l32.m2.1.1.1.cmml">−</mo><mn id="alg1.l32.m2.1.1.3" xref="alg1.l32.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l32.m2.1b"><apply id="alg1.l32.m2.1.1.cmml" xref="alg1.l32.m2.1.1"><minus id="alg1.l32.m2.1.1.1.cmml" xref="alg1.l32.m2.1.1.1"></minus><ci id="alg1.l32.m2.1.1.2.cmml" xref="alg1.l32.m2.1.1.2">𝐼</ci><cn type="integer" id="alg1.l32.m2.1.1.3.cmml" xref="alg1.l32.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l32.m2.1c">I-1</annotation></semantics></math> <span id="alg1.l32.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l33.1.1.1" class="ltx_text" style="font-size:80%;">33:</span></span>              Sample mini-batch <math id="alg1.l33.m1.1" class="ltx_Math" alttext="\mathbf{l}" display="inline"><semantics id="alg1.l33.m1.1a"><mi id="alg1.l33.m1.1.1" xref="alg1.l33.m1.1.1.cmml">𝐥</mi><annotation-xml encoding="MathML-Content" id="alg1.l33.m1.1b"><ci id="alg1.l33.m1.1.1.cmml" xref="alg1.l33.m1.1.1">𝐥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l33.m1.1c">\mathbf{l}</annotation></semantics></math> from <math id="alg1.l33.m2.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="alg1.l33.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l33.m2.1.1" xref="alg1.l33.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="alg1.l33.m2.1b"><ci id="alg1.l33.m2.1.1.cmml" xref="alg1.l33.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l33.m2.1c">\mathcal{D}</annotation></semantics></math>

</div>
<div id="alg1.l34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l34.1.1.1" class="ltx_text" style="font-size:80%;">34:</span></span>              <math id="alg1.l34.m1.3" class="ltx_Math" alttext="\mathbf{\theta}_{g}\leftarrow\mathbf{\theta}_{g}-\eta\nabla_{\theta_{g}}\mathcal{L}_{glob}(\mathcal{\theta}_{g};\mathcal{D^{\mathbf{l}},\mathbf{z^{l}_{T}}})" display="inline"><semantics id="alg1.l34.m1.3a"><mrow id="alg1.l34.m1.3.3" xref="alg1.l34.m1.3.3.cmml"><msub id="alg1.l34.m1.3.3.5" xref="alg1.l34.m1.3.3.5.cmml"><mi id="alg1.l34.m1.3.3.5.2" xref="alg1.l34.m1.3.3.5.2.cmml">θ</mi><mi id="alg1.l34.m1.3.3.5.3" xref="alg1.l34.m1.3.3.5.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.l34.m1.3.3.4" xref="alg1.l34.m1.3.3.4.cmml">←</mo><mrow id="alg1.l34.m1.3.3.3" xref="alg1.l34.m1.3.3.3.cmml"><msub id="alg1.l34.m1.3.3.3.5" xref="alg1.l34.m1.3.3.3.5.cmml"><mi id="alg1.l34.m1.3.3.3.5.2" xref="alg1.l34.m1.3.3.3.5.2.cmml">θ</mi><mi id="alg1.l34.m1.3.3.3.5.3" xref="alg1.l34.m1.3.3.3.5.3.cmml">g</mi></msub><mo id="alg1.l34.m1.3.3.3.4" xref="alg1.l34.m1.3.3.3.4.cmml">−</mo><mrow id="alg1.l34.m1.3.3.3.3" xref="alg1.l34.m1.3.3.3.3.cmml"><mi id="alg1.l34.m1.3.3.3.3.5" xref="alg1.l34.m1.3.3.3.3.5.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l34.m1.3.3.3.3.4" xref="alg1.l34.m1.3.3.3.3.4.cmml">​</mo><mrow id="alg1.l34.m1.3.3.3.3.6" xref="alg1.l34.m1.3.3.3.3.6.cmml"><msub id="alg1.l34.m1.3.3.3.3.6.1" xref="alg1.l34.m1.3.3.3.3.6.1.cmml"><mo rspace="0.167em" id="alg1.l34.m1.3.3.3.3.6.1.2" xref="alg1.l34.m1.3.3.3.3.6.1.2.cmml">∇</mo><msub id="alg1.l34.m1.3.3.3.3.6.1.3" xref="alg1.l34.m1.3.3.3.3.6.1.3.cmml"><mi id="alg1.l34.m1.3.3.3.3.6.1.3.2" xref="alg1.l34.m1.3.3.3.3.6.1.3.2.cmml">θ</mi><mi id="alg1.l34.m1.3.3.3.3.6.1.3.3" xref="alg1.l34.m1.3.3.3.3.6.1.3.3.cmml">g</mi></msub></msub><msub id="alg1.l34.m1.3.3.3.3.6.2" xref="alg1.l34.m1.3.3.3.3.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l34.m1.3.3.3.3.6.2.2" xref="alg1.l34.m1.3.3.3.3.6.2.2.cmml">ℒ</mi><mrow id="alg1.l34.m1.3.3.3.3.6.2.3" xref="alg1.l34.m1.3.3.3.3.6.2.3.cmml"><mi id="alg1.l34.m1.3.3.3.3.6.2.3.2" xref="alg1.l34.m1.3.3.3.3.6.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l34.m1.3.3.3.3.6.2.3.1" xref="alg1.l34.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l34.m1.3.3.3.3.6.2.3.3" xref="alg1.l34.m1.3.3.3.3.6.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l34.m1.3.3.3.3.6.2.3.1a" xref="alg1.l34.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l34.m1.3.3.3.3.6.2.3.4" xref="alg1.l34.m1.3.3.3.3.6.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l34.m1.3.3.3.3.6.2.3.1b" xref="alg1.l34.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l34.m1.3.3.3.3.6.2.3.5" xref="alg1.l34.m1.3.3.3.3.6.2.3.5.cmml">b</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l34.m1.3.3.3.3.4a" xref="alg1.l34.m1.3.3.3.3.4.cmml">​</mo><mrow id="alg1.l34.m1.3.3.3.3.3.3" xref="alg1.l34.m1.3.3.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l34.m1.3.3.3.3.3.3.4" xref="alg1.l34.m1.3.3.3.3.3.4.cmml">(</mo><msub id="alg1.l34.m1.1.1.1.1.1.1.1" xref="alg1.l34.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l34.m1.1.1.1.1.1.1.1.2" xref="alg1.l34.m1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l34.m1.1.1.1.1.1.1.1.3" xref="alg1.l34.m1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="alg1.l34.m1.3.3.3.3.3.3.5" xref="alg1.l34.m1.3.3.3.3.3.4.cmml">;</mo><msup id="alg1.l34.m1.2.2.2.2.2.2.2" xref="alg1.l34.m1.2.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l34.m1.2.2.2.2.2.2.2.2" xref="alg1.l34.m1.2.2.2.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l34.m1.2.2.2.2.2.2.2.3" xref="alg1.l34.m1.2.2.2.2.2.2.2.3.cmml">𝐥</mi></msup><mo id="alg1.l34.m1.3.3.3.3.3.3.6" xref="alg1.l34.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg1.l34.m1.3.3.3.3.3.3.3" xref="alg1.l34.m1.3.3.3.3.3.3.3.cmml"><mi id="alg1.l34.m1.3.3.3.3.3.3.3.2.2" xref="alg1.l34.m1.3.3.3.3.3.3.3.2.2.cmml">𝐳</mi><mi id="alg1.l34.m1.3.3.3.3.3.3.3.3" xref="alg1.l34.m1.3.3.3.3.3.3.3.3.cmml">𝐓</mi><mi id="alg1.l34.m1.3.3.3.3.3.3.3.2.3" xref="alg1.l34.m1.3.3.3.3.3.3.3.2.3.cmml">𝐥</mi></msubsup><mo stretchy="false" id="alg1.l34.m1.3.3.3.3.3.3.7" xref="alg1.l34.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l34.m1.3b"><apply id="alg1.l34.m1.3.3.cmml" xref="alg1.l34.m1.3.3"><ci id="alg1.l34.m1.3.3.4.cmml" xref="alg1.l34.m1.3.3.4">←</ci><apply id="alg1.l34.m1.3.3.5.cmml" xref="alg1.l34.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.5.1.cmml" xref="alg1.l34.m1.3.3.5">subscript</csymbol><ci id="alg1.l34.m1.3.3.5.2.cmml" xref="alg1.l34.m1.3.3.5.2">𝜃</ci><ci id="alg1.l34.m1.3.3.5.3.cmml" xref="alg1.l34.m1.3.3.5.3">𝑔</ci></apply><apply id="alg1.l34.m1.3.3.3.cmml" xref="alg1.l34.m1.3.3.3"><minus id="alg1.l34.m1.3.3.3.4.cmml" xref="alg1.l34.m1.3.3.3.4"></minus><apply id="alg1.l34.m1.3.3.3.5.cmml" xref="alg1.l34.m1.3.3.3.5"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.3.5.1.cmml" xref="alg1.l34.m1.3.3.3.5">subscript</csymbol><ci id="alg1.l34.m1.3.3.3.5.2.cmml" xref="alg1.l34.m1.3.3.3.5.2">𝜃</ci><ci id="alg1.l34.m1.3.3.3.5.3.cmml" xref="alg1.l34.m1.3.3.3.5.3">𝑔</ci></apply><apply id="alg1.l34.m1.3.3.3.3.cmml" xref="alg1.l34.m1.3.3.3.3"><times id="alg1.l34.m1.3.3.3.3.4.cmml" xref="alg1.l34.m1.3.3.3.3.4"></times><ci id="alg1.l34.m1.3.3.3.3.5.cmml" xref="alg1.l34.m1.3.3.3.3.5">𝜂</ci><apply id="alg1.l34.m1.3.3.3.3.6.cmml" xref="alg1.l34.m1.3.3.3.3.6"><apply id="alg1.l34.m1.3.3.3.3.6.1.cmml" xref="alg1.l34.m1.3.3.3.3.6.1"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.3.3.6.1.1.cmml" xref="alg1.l34.m1.3.3.3.3.6.1">subscript</csymbol><ci id="alg1.l34.m1.3.3.3.3.6.1.2.cmml" xref="alg1.l34.m1.3.3.3.3.6.1.2">∇</ci><apply id="alg1.l34.m1.3.3.3.3.6.1.3.cmml" xref="alg1.l34.m1.3.3.3.3.6.1.3"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.3.3.6.1.3.1.cmml" xref="alg1.l34.m1.3.3.3.3.6.1.3">subscript</csymbol><ci id="alg1.l34.m1.3.3.3.3.6.1.3.2.cmml" xref="alg1.l34.m1.3.3.3.3.6.1.3.2">𝜃</ci><ci id="alg1.l34.m1.3.3.3.3.6.1.3.3.cmml" xref="alg1.l34.m1.3.3.3.3.6.1.3.3">𝑔</ci></apply></apply><apply id="alg1.l34.m1.3.3.3.3.6.2.cmml" xref="alg1.l34.m1.3.3.3.3.6.2"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.3.3.6.2.1.cmml" xref="alg1.l34.m1.3.3.3.3.6.2">subscript</csymbol><ci id="alg1.l34.m1.3.3.3.3.6.2.2.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.2">ℒ</ci><apply id="alg1.l34.m1.3.3.3.3.6.2.3.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.3"><times id="alg1.l34.m1.3.3.3.3.6.2.3.1.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.3.1"></times><ci id="alg1.l34.m1.3.3.3.3.6.2.3.2.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.3.2">𝑔</ci><ci id="alg1.l34.m1.3.3.3.3.6.2.3.3.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.3.3">𝑙</ci><ci id="alg1.l34.m1.3.3.3.3.6.2.3.4.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.3.4">𝑜</ci><ci id="alg1.l34.m1.3.3.3.3.6.2.3.5.cmml" xref="alg1.l34.m1.3.3.3.3.6.2.3.5">𝑏</ci></apply></apply></apply><list id="alg1.l34.m1.3.3.3.3.3.4.cmml" xref="alg1.l34.m1.3.3.3.3.3.3"><apply id="alg1.l34.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l34.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l34.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l34.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l34.m1.1.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="alg1.l34.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l34.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l34.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l34.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l34.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l34.m1.2.2.2.2.2.2.2.2">𝒟</ci><ci id="alg1.l34.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l34.m1.2.2.2.2.2.2.2.3">𝐥</ci></apply><apply id="alg1.l34.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.3.3.3.3.3.1.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3">subscript</csymbol><apply id="alg1.l34.m1.3.3.3.3.3.3.3.2.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l34.m1.3.3.3.3.3.3.3.2.1.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3">superscript</csymbol><ci id="alg1.l34.m1.3.3.3.3.3.3.3.2.2.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3.2.2">𝐳</ci><ci id="alg1.l34.m1.3.3.3.3.3.3.3.2.3.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3.2.3">𝐥</ci></apply><ci id="alg1.l34.m1.3.3.3.3.3.3.3.3.cmml" xref="alg1.l34.m1.3.3.3.3.3.3.3.3">𝐓</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l34.m1.3c">\mathbf{\theta}_{g}\leftarrow\mathbf{\theta}_{g}-\eta\nabla_{\theta_{g}}\mathcal{L}_{glob}(\mathcal{\theta}_{g};\mathcal{D^{\mathbf{l}},\mathbf{z^{l}_{T}}})</annotation></semantics></math>

</div>
<div id="alg1.l35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l35.1.1.1" class="ltx_text" style="font-size:80%;">35:</span></span>              <math id="alg1.l35.m1.3" class="ltx_Math" alttext="\mathbf{\theta}_{k}\leftarrow\mathbf{\theta}_{k}-\eta\nabla_{\theta_{k}}\mathcal{L}_{local}(\mathcal{\theta}_{k};\mathcal{D^{\mathbf{l}}},\mathbf{z}^{\mathbf{l}}_{T})" display="inline"><semantics id="alg1.l35.m1.3a"><mrow id="alg1.l35.m1.3.3" xref="alg1.l35.m1.3.3.cmml"><msub id="alg1.l35.m1.3.3.5" xref="alg1.l35.m1.3.3.5.cmml"><mi id="alg1.l35.m1.3.3.5.2" xref="alg1.l35.m1.3.3.5.2.cmml">θ</mi><mi id="alg1.l35.m1.3.3.5.3" xref="alg1.l35.m1.3.3.5.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l35.m1.3.3.4" xref="alg1.l35.m1.3.3.4.cmml">←</mo><mrow id="alg1.l35.m1.3.3.3" xref="alg1.l35.m1.3.3.3.cmml"><msub id="alg1.l35.m1.3.3.3.5" xref="alg1.l35.m1.3.3.3.5.cmml"><mi id="alg1.l35.m1.3.3.3.5.2" xref="alg1.l35.m1.3.3.3.5.2.cmml">θ</mi><mi id="alg1.l35.m1.3.3.3.5.3" xref="alg1.l35.m1.3.3.3.5.3.cmml">k</mi></msub><mo id="alg1.l35.m1.3.3.3.4" xref="alg1.l35.m1.3.3.3.4.cmml">−</mo><mrow id="alg1.l35.m1.3.3.3.3" xref="alg1.l35.m1.3.3.3.3.cmml"><mi id="alg1.l35.m1.3.3.3.3.5" xref="alg1.l35.m1.3.3.3.3.5.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l35.m1.3.3.3.3.4" xref="alg1.l35.m1.3.3.3.3.4.cmml">​</mo><mrow id="alg1.l35.m1.3.3.3.3.6" xref="alg1.l35.m1.3.3.3.3.6.cmml"><msub id="alg1.l35.m1.3.3.3.3.6.1" xref="alg1.l35.m1.3.3.3.3.6.1.cmml"><mo rspace="0.167em" id="alg1.l35.m1.3.3.3.3.6.1.2" xref="alg1.l35.m1.3.3.3.3.6.1.2.cmml">∇</mo><msub id="alg1.l35.m1.3.3.3.3.6.1.3" xref="alg1.l35.m1.3.3.3.3.6.1.3.cmml"><mi id="alg1.l35.m1.3.3.3.3.6.1.3.2" xref="alg1.l35.m1.3.3.3.3.6.1.3.2.cmml">θ</mi><mi id="alg1.l35.m1.3.3.3.3.6.1.3.3" xref="alg1.l35.m1.3.3.3.3.6.1.3.3.cmml">k</mi></msub></msub><msub id="alg1.l35.m1.3.3.3.3.6.2" xref="alg1.l35.m1.3.3.3.3.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l35.m1.3.3.3.3.6.2.2" xref="alg1.l35.m1.3.3.3.3.6.2.2.cmml">ℒ</mi><mrow id="alg1.l35.m1.3.3.3.3.6.2.3" xref="alg1.l35.m1.3.3.3.3.6.2.3.cmml"><mi id="alg1.l35.m1.3.3.3.3.6.2.3.2" xref="alg1.l35.m1.3.3.3.3.6.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l35.m1.3.3.3.3.6.2.3.1" xref="alg1.l35.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l35.m1.3.3.3.3.6.2.3.3" xref="alg1.l35.m1.3.3.3.3.6.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l35.m1.3.3.3.3.6.2.3.1a" xref="alg1.l35.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l35.m1.3.3.3.3.6.2.3.4" xref="alg1.l35.m1.3.3.3.3.6.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l35.m1.3.3.3.3.6.2.3.1b" xref="alg1.l35.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l35.m1.3.3.3.3.6.2.3.5" xref="alg1.l35.m1.3.3.3.3.6.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l35.m1.3.3.3.3.6.2.3.1c" xref="alg1.l35.m1.3.3.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l35.m1.3.3.3.3.6.2.3.6" xref="alg1.l35.m1.3.3.3.3.6.2.3.6.cmml">l</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l35.m1.3.3.3.3.4a" xref="alg1.l35.m1.3.3.3.3.4.cmml">​</mo><mrow id="alg1.l35.m1.3.3.3.3.3.3" xref="alg1.l35.m1.3.3.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l35.m1.3.3.3.3.3.3.4" xref="alg1.l35.m1.3.3.3.3.3.4.cmml">(</mo><msub id="alg1.l35.m1.1.1.1.1.1.1.1" xref="alg1.l35.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l35.m1.1.1.1.1.1.1.1.2" xref="alg1.l35.m1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l35.m1.1.1.1.1.1.1.1.3" xref="alg1.l35.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="alg1.l35.m1.3.3.3.3.3.3.5" xref="alg1.l35.m1.3.3.3.3.3.4.cmml">;</mo><msup id="alg1.l35.m1.2.2.2.2.2.2.2" xref="alg1.l35.m1.2.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l35.m1.2.2.2.2.2.2.2.2" xref="alg1.l35.m1.2.2.2.2.2.2.2.2.cmml">𝒟</mi><mi id="alg1.l35.m1.2.2.2.2.2.2.2.3" xref="alg1.l35.m1.2.2.2.2.2.2.2.3.cmml">𝐥</mi></msup><mo id="alg1.l35.m1.3.3.3.3.3.3.6" xref="alg1.l35.m1.3.3.3.3.3.4.cmml">,</mo><msubsup id="alg1.l35.m1.3.3.3.3.3.3.3" xref="alg1.l35.m1.3.3.3.3.3.3.3.cmml"><mi id="alg1.l35.m1.3.3.3.3.3.3.3.2.2" xref="alg1.l35.m1.3.3.3.3.3.3.3.2.2.cmml">𝐳</mi><mi id="alg1.l35.m1.3.3.3.3.3.3.3.3" xref="alg1.l35.m1.3.3.3.3.3.3.3.3.cmml">T</mi><mi id="alg1.l35.m1.3.3.3.3.3.3.3.2.3" xref="alg1.l35.m1.3.3.3.3.3.3.3.2.3.cmml">𝐥</mi></msubsup><mo stretchy="false" id="alg1.l35.m1.3.3.3.3.3.3.7" xref="alg1.l35.m1.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l35.m1.3b"><apply id="alg1.l35.m1.3.3.cmml" xref="alg1.l35.m1.3.3"><ci id="alg1.l35.m1.3.3.4.cmml" xref="alg1.l35.m1.3.3.4">←</ci><apply id="alg1.l35.m1.3.3.5.cmml" xref="alg1.l35.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.5.1.cmml" xref="alg1.l35.m1.3.3.5">subscript</csymbol><ci id="alg1.l35.m1.3.3.5.2.cmml" xref="alg1.l35.m1.3.3.5.2">𝜃</ci><ci id="alg1.l35.m1.3.3.5.3.cmml" xref="alg1.l35.m1.3.3.5.3">𝑘</ci></apply><apply id="alg1.l35.m1.3.3.3.cmml" xref="alg1.l35.m1.3.3.3"><minus id="alg1.l35.m1.3.3.3.4.cmml" xref="alg1.l35.m1.3.3.3.4"></minus><apply id="alg1.l35.m1.3.3.3.5.cmml" xref="alg1.l35.m1.3.3.3.5"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.3.5.1.cmml" xref="alg1.l35.m1.3.3.3.5">subscript</csymbol><ci id="alg1.l35.m1.3.3.3.5.2.cmml" xref="alg1.l35.m1.3.3.3.5.2">𝜃</ci><ci id="alg1.l35.m1.3.3.3.5.3.cmml" xref="alg1.l35.m1.3.3.3.5.3">𝑘</ci></apply><apply id="alg1.l35.m1.3.3.3.3.cmml" xref="alg1.l35.m1.3.3.3.3"><times id="alg1.l35.m1.3.3.3.3.4.cmml" xref="alg1.l35.m1.3.3.3.3.4"></times><ci id="alg1.l35.m1.3.3.3.3.5.cmml" xref="alg1.l35.m1.3.3.3.3.5">𝜂</ci><apply id="alg1.l35.m1.3.3.3.3.6.cmml" xref="alg1.l35.m1.3.3.3.3.6"><apply id="alg1.l35.m1.3.3.3.3.6.1.cmml" xref="alg1.l35.m1.3.3.3.3.6.1"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.3.3.6.1.1.cmml" xref="alg1.l35.m1.3.3.3.3.6.1">subscript</csymbol><ci id="alg1.l35.m1.3.3.3.3.6.1.2.cmml" xref="alg1.l35.m1.3.3.3.3.6.1.2">∇</ci><apply id="alg1.l35.m1.3.3.3.3.6.1.3.cmml" xref="alg1.l35.m1.3.3.3.3.6.1.3"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.3.3.6.1.3.1.cmml" xref="alg1.l35.m1.3.3.3.3.6.1.3">subscript</csymbol><ci id="alg1.l35.m1.3.3.3.3.6.1.3.2.cmml" xref="alg1.l35.m1.3.3.3.3.6.1.3.2">𝜃</ci><ci id="alg1.l35.m1.3.3.3.3.6.1.3.3.cmml" xref="alg1.l35.m1.3.3.3.3.6.1.3.3">𝑘</ci></apply></apply><apply id="alg1.l35.m1.3.3.3.3.6.2.cmml" xref="alg1.l35.m1.3.3.3.3.6.2"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.3.3.6.2.1.cmml" xref="alg1.l35.m1.3.3.3.3.6.2">subscript</csymbol><ci id="alg1.l35.m1.3.3.3.3.6.2.2.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.2">ℒ</ci><apply id="alg1.l35.m1.3.3.3.3.6.2.3.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3"><times id="alg1.l35.m1.3.3.3.3.6.2.3.1.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3.1"></times><ci id="alg1.l35.m1.3.3.3.3.6.2.3.2.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3.2">𝑙</ci><ci id="alg1.l35.m1.3.3.3.3.6.2.3.3.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3.3">𝑜</ci><ci id="alg1.l35.m1.3.3.3.3.6.2.3.4.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3.4">𝑐</ci><ci id="alg1.l35.m1.3.3.3.3.6.2.3.5.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3.5">𝑎</ci><ci id="alg1.l35.m1.3.3.3.3.6.2.3.6.cmml" xref="alg1.l35.m1.3.3.3.3.6.2.3.6">𝑙</ci></apply></apply></apply><list id="alg1.l35.m1.3.3.3.3.3.4.cmml" xref="alg1.l35.m1.3.3.3.3.3.3"><apply id="alg1.l35.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l35.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l35.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l35.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l35.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l35.m1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l35.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l35.m1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l35.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l35.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l35.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l35.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l35.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l35.m1.2.2.2.2.2.2.2.2">𝒟</ci><ci id="alg1.l35.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l35.m1.2.2.2.2.2.2.2.3">𝐥</ci></apply><apply id="alg1.l35.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.3.3.3.3.3.1.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3">subscript</csymbol><apply id="alg1.l35.m1.3.3.3.3.3.3.3.2.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l35.m1.3.3.3.3.3.3.3.2.1.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3">superscript</csymbol><ci id="alg1.l35.m1.3.3.3.3.3.3.3.2.2.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3.2.2">𝐳</ci><ci id="alg1.l35.m1.3.3.3.3.3.3.3.2.3.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3.2.3">𝐥</ci></apply><ci id="alg1.l35.m1.3.3.3.3.3.3.3.3.cmml" xref="alg1.l35.m1.3.3.3.3.3.3.3.3">𝑇</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l35.m1.3c">\mathbf{\theta}_{k}\leftarrow\mathbf{\theta}_{k}-\eta\nabla_{\theta_{k}}\mathcal{L}_{local}(\mathcal{\theta}_{k};\mathcal{D^{\mathbf{l}}},\mathbf{z}^{\mathbf{l}}_{T})</annotation></semantics></math>

</div>
<div id="alg1.l36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l36.1.1.1" class="ltx_text" style="font-size:80%;">36:</span></span>         <span id="alg1.l36.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l36.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l37.1.1.1" class="ltx_text" style="font-size:80%;">37:</span></span>     <span id="alg1.l37.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l37.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l38.1.1.1" class="ltx_text" style="font-size:80%;">38:</span></span>     <span id="alg1.l38.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l38.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{g}" display="inline"><semantics id="alg1.l38.m1.1a"><msub id="alg1.l38.m1.1.1" xref="alg1.l38.m1.1.1.cmml"><mi id="alg1.l38.m1.1.1.2" xref="alg1.l38.m1.1.1.2.cmml">θ</mi><mi id="alg1.l38.m1.1.1.3" xref="alg1.l38.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l38.m1.1b"><apply id="alg1.l38.m1.1.1.cmml" xref="alg1.l38.m1.1.1"><csymbol cd="ambiguous" id="alg1.l38.m1.1.1.1.cmml" xref="alg1.l38.m1.1.1">subscript</csymbol><ci id="alg1.l38.m1.1.1.2.cmml" xref="alg1.l38.m1.1.1.2">𝜃</ci><ci id="alg1.l38.m1.1.1.3.cmml" xref="alg1.l38.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l38.m1.1c">\mathbf{\theta}_{g}</annotation></semantics></math>, <math id="alg1.l38.m2.1" class="ltx_Math" alttext="\mathbf{\theta}_{k}" display="inline"><semantics id="alg1.l38.m2.1a"><msub id="alg1.l38.m2.1.1" xref="alg1.l38.m2.1.1.cmml"><mi id="alg1.l38.m2.1.1.2" xref="alg1.l38.m2.1.1.2.cmml">θ</mi><mi id="alg1.l38.m2.1.1.3" xref="alg1.l38.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l38.m2.1b"><apply id="alg1.l38.m2.1.1.cmml" xref="alg1.l38.m2.1.1"><csymbol cd="ambiguous" id="alg1.l38.m2.1.1.1.cmml" xref="alg1.l38.m2.1.1">subscript</csymbol><ci id="alg1.l38.m2.1.1.2.cmml" xref="alg1.l38.m2.1.1.2">𝜃</ci><ci id="alg1.l38.m2.1.1.3.cmml" xref="alg1.l38.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l38.m2.1c">\mathbf{\theta}_{k}</annotation></semantics></math>, <math id="alg1.l38.m3.1" class="ltx_Math" alttext="\mathbf{z^{\prime}}_{T}" display="inline"><semantics id="alg1.l38.m3.1a"><mmultiscripts id="alg1.l38.m3.1.1" xref="alg1.l38.m3.1.1.cmml"><mi id="alg1.l38.m3.1.1.2.2" xref="alg1.l38.m3.1.1.2.2.cmml">𝐳</mi><mrow id="alg1.l38.m3.1.1a" xref="alg1.l38.m3.1.1.cmml"></mrow><mo id="alg1.l38.m3.1.1.2.3" xref="alg1.l38.m3.1.1.2.3.cmml">′</mo><mi id="alg1.l38.m3.1.1.3" xref="alg1.l38.m3.1.1.3.cmml">T</mi><mrow id="alg1.l38.m3.1.1b" xref="alg1.l38.m3.1.1.cmml"></mrow></mmultiscripts><annotation-xml encoding="MathML-Content" id="alg1.l38.m3.1b"><apply id="alg1.l38.m3.1.1.cmml" xref="alg1.l38.m3.1.1"><csymbol cd="ambiguous" id="alg1.l38.m3.1.1.1.cmml" xref="alg1.l38.m3.1.1">subscript</csymbol><apply id="alg1.l38.m3.1.1.2.cmml" xref="alg1.l38.m3.1.1"><csymbol cd="ambiguous" id="alg1.l38.m3.1.1.2.1.cmml" xref="alg1.l38.m3.1.1">superscript</csymbol><ci id="alg1.l38.m3.1.1.2.2.cmml" xref="alg1.l38.m3.1.1.2.2">𝐳</ci><ci id="alg1.l38.m3.1.1.2.3.cmml" xref="alg1.l38.m3.1.1.2.3">′</ci></apply><ci id="alg1.l38.m3.1.1.3.cmml" xref="alg1.l38.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l38.m3.1c">\mathbf{z^{\prime}}_{T}</annotation></semantics></math>

</div>
<div id="alg1.l39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l39.1.1.1" class="ltx_text" style="font-size:80%;">39:</span></span><span id="alg1.l39.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l39.3" class="ltx_text ltx_font_bold">function</span>
</div>
<div id="alg1.l40" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l40.4.1.1" class="ltx_text" style="font-size:80%;">40:</span></span><span id="alg1.l40.5" class="ltx_text ltx_font_bold">function</span> <span id="alg1.l40.3" class="ltx_text ltx_font_bold ltx_font_smallcaps">ServerTrain(<math id="alg1.l40.1.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{s}" display="inline"><semantics id="alg1.l40.1.m1.1a"><msub id="alg1.l40.1.m1.1.1" xref="alg1.l40.1.m1.1.1.cmml"><mi id="alg1.l40.1.m1.1.1.2" xref="alg1.l40.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l40.1.m1.1.1.3" xref="alg1.l40.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l40.1.m1.1b"><apply id="alg1.l40.1.m1.1.1.cmml" xref="alg1.l40.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l40.1.m1.1.1.1.cmml" xref="alg1.l40.1.m1.1.1">subscript</csymbol><ci id="alg1.l40.1.m1.1.1.2.cmml" xref="alg1.l40.1.m1.1.1.2">𝜃</ci><ci id="alg1.l40.1.m1.1.1.3.cmml" xref="alg1.l40.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l40.1.m1.1c">\mathbf{\theta}_{s}</annotation></semantics></math>, <math id="alg1.l40.2.m2.1" class="ltx_Math" alttext="\mathbf{z^{\prime}_{T}}" display="inline"><semantics id="alg1.l40.2.m2.1a"><msubsup id="alg1.l40.2.m2.1.1" xref="alg1.l40.2.m2.1.1.cmml"><mi mathvariant="normal" id="alg1.l40.2.m2.1.1.2.2" xref="alg1.l40.2.m2.1.1.2.2.cmml">z</mi><mi mathvariant="normal" id="alg1.l40.2.m2.1.1.3" xref="alg1.l40.2.m2.1.1.3.cmml">T</mi><mo id="alg1.l40.2.m2.1.1.2.3" xref="alg1.l40.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l40.2.m2.1b"><apply id="alg1.l40.2.m2.1.1.cmml" xref="alg1.l40.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l40.2.m2.1.1.1.cmml" xref="alg1.l40.2.m2.1.1">subscript</csymbol><apply id="alg1.l40.2.m2.1.1.2.cmml" xref="alg1.l40.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l40.2.m2.1.1.2.1.cmml" xref="alg1.l40.2.m2.1.1">superscript</csymbol><ci id="alg1.l40.2.m2.1.1.2.2.cmml" xref="alg1.l40.2.m2.1.1.2.2">z</ci><ci id="alg1.l40.2.m2.1.1.2.3.cmml" xref="alg1.l40.2.m2.1.1.2.3">′</ci></apply><ci id="alg1.l40.2.m2.1.1.3.cmml" xref="alg1.l40.2.m2.1.1.3">T</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l40.2.m2.1c">\mathbf{z^{\prime}_{T}}</annotation></semantics></math>, <math id="alg1.l40.3.m3.1" class="ltx_Math" alttext="\mathbf{X_{T}}" display="inline"><semantics id="alg1.l40.3.m3.1a"><msub id="alg1.l40.3.m3.1.1" xref="alg1.l40.3.m3.1.1.cmml"><mi mathvariant="normal" id="alg1.l40.3.m3.1.1.2" xref="alg1.l40.3.m3.1.1.2.cmml">X</mi><mi mathvariant="normal" id="alg1.l40.3.m3.1.1.3" xref="alg1.l40.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l40.3.m3.1b"><apply id="alg1.l40.3.m3.1.1.cmml" xref="alg1.l40.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l40.3.m3.1.1.1.cmml" xref="alg1.l40.3.m3.1.1">subscript</csymbol><ci id="alg1.l40.3.m3.1.1.2.cmml" xref="alg1.l40.3.m3.1.1.2">X</ci><ci id="alg1.l40.3.m3.1.1.3.cmml" xref="alg1.l40.3.m3.1.1.3">T</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l40.3.m3.1c">\mathbf{X_{T}}</annotation></semantics></math>)</span>

</div>
<div id="alg1.l41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l41.1.1.1" class="ltx_text" style="font-size:80%;">41:</span></span>     <span id="alg1.l41.2" class="ltx_text ltx_font_bold">for</span> Iteration <math id="alg1.l41.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l41.m1.1a"><mi id="alg1.l41.m1.1.1" xref="alg1.l41.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l41.m1.1b"><ci id="alg1.l41.m1.1.1.cmml" xref="alg1.l41.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l41.m1.1c">i</annotation></semantics></math> from 0 to <math id="alg1.l41.m2.1" class="ltx_Math" alttext="I-1" display="inline"><semantics id="alg1.l41.m2.1a"><mrow id="alg1.l41.m2.1.1" xref="alg1.l41.m2.1.1.cmml"><mi id="alg1.l41.m2.1.1.2" xref="alg1.l41.m2.1.1.2.cmml">I</mi><mo id="alg1.l41.m2.1.1.1" xref="alg1.l41.m2.1.1.1.cmml">−</mo><mn id="alg1.l41.m2.1.1.3" xref="alg1.l41.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l41.m2.1b"><apply id="alg1.l41.m2.1.1.cmml" xref="alg1.l41.m2.1.1"><minus id="alg1.l41.m2.1.1.1.cmml" xref="alg1.l41.m2.1.1.1"></minus><ci id="alg1.l41.m2.1.1.2.cmml" xref="alg1.l41.m2.1.1.2">𝐼</ci><cn type="integer" id="alg1.l41.m2.1.1.3.cmml" xref="alg1.l41.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l41.m2.1c">I-1</annotation></semantics></math> <span id="alg1.l41.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l42" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l42.1.1.1" class="ltx_text" style="font-size:80%;">42:</span></span>         Sample mini-batch <math id="alg1.l42.m1.1" class="ltx_Math" alttext="\mathbf{l}" display="inline"><semantics id="alg1.l42.m1.1a"><mi id="alg1.l42.m1.1.1" xref="alg1.l42.m1.1.1.cmml">𝐥</mi><annotation-xml encoding="MathML-Content" id="alg1.l42.m1.1b"><ci id="alg1.l42.m1.1.1.cmml" xref="alg1.l42.m1.1.1">𝐥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l42.m1.1c">\mathbf{l}</annotation></semantics></math> from <math id="alg1.l42.m2.1" class="ltx_Math" alttext="\mathbf{X_{T}}" display="inline"><semantics id="alg1.l42.m2.1a"><msub id="alg1.l42.m2.1.1" xref="alg1.l42.m2.1.1.cmml"><mi id="alg1.l42.m2.1.1.2" xref="alg1.l42.m2.1.1.2.cmml">𝐗</mi><mi id="alg1.l42.m2.1.1.3" xref="alg1.l42.m2.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l42.m2.1b"><apply id="alg1.l42.m2.1.1.cmml" xref="alg1.l42.m2.1.1"><csymbol cd="ambiguous" id="alg1.l42.m2.1.1.1.cmml" xref="alg1.l42.m2.1.1">subscript</csymbol><ci id="alg1.l42.m2.1.1.2.cmml" xref="alg1.l42.m2.1.1.2">𝐗</ci><ci id="alg1.l42.m2.1.1.3.cmml" xref="alg1.l42.m2.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l42.m2.1c">\mathbf{X_{T}}</annotation></semantics></math>

</div>
<div id="alg1.l43" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l43.1.1.1" class="ltx_text" style="font-size:80%;">43:</span></span>         <math id="alg1.l43.m1.5" class="ltx_Math" alttext="\mathbf{\theta}_{s}\leftarrow\mathbf{\theta}_{s}-\eta\nabla_{\theta_{s}}\mathcal{L}_{server}(\mathcal{\theta}_{s};\mathbf{X^{l}_{T}},\mathbf{z^{\prime l}_{T}})" display="inline"><semantics id="alg1.l43.m1.5a"><mrow id="alg1.l43.m1.5.5" xref="alg1.l43.m1.5.5.cmml"><msub id="alg1.l43.m1.5.5.5" xref="alg1.l43.m1.5.5.5.cmml"><mi id="alg1.l43.m1.5.5.5.2" xref="alg1.l43.m1.5.5.5.2.cmml">θ</mi><mi id="alg1.l43.m1.5.5.5.3" xref="alg1.l43.m1.5.5.5.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l43.m1.5.5.4" xref="alg1.l43.m1.5.5.4.cmml">←</mo><mrow id="alg1.l43.m1.5.5.3" xref="alg1.l43.m1.5.5.3.cmml"><msub id="alg1.l43.m1.5.5.3.5" xref="alg1.l43.m1.5.5.3.5.cmml"><mi id="alg1.l43.m1.5.5.3.5.2" xref="alg1.l43.m1.5.5.3.5.2.cmml">θ</mi><mi id="alg1.l43.m1.5.5.3.5.3" xref="alg1.l43.m1.5.5.3.5.3.cmml">s</mi></msub><mo id="alg1.l43.m1.5.5.3.4" xref="alg1.l43.m1.5.5.3.4.cmml">−</mo><mrow id="alg1.l43.m1.5.5.3.3" xref="alg1.l43.m1.5.5.3.3.cmml"><mi id="alg1.l43.m1.5.5.3.3.5" xref="alg1.l43.m1.5.5.3.3.5.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l43.m1.5.5.3.3.4" xref="alg1.l43.m1.5.5.3.3.4.cmml">​</mo><mrow id="alg1.l43.m1.5.5.3.3.6" xref="alg1.l43.m1.5.5.3.3.6.cmml"><msub id="alg1.l43.m1.5.5.3.3.6.1" xref="alg1.l43.m1.5.5.3.3.6.1.cmml"><mo rspace="0.167em" id="alg1.l43.m1.5.5.3.3.6.1.2" xref="alg1.l43.m1.5.5.3.3.6.1.2.cmml">∇</mo><msub id="alg1.l43.m1.5.5.3.3.6.1.3" xref="alg1.l43.m1.5.5.3.3.6.1.3.cmml"><mi id="alg1.l43.m1.5.5.3.3.6.1.3.2" xref="alg1.l43.m1.5.5.3.3.6.1.3.2.cmml">θ</mi><mi id="alg1.l43.m1.5.5.3.3.6.1.3.3" xref="alg1.l43.m1.5.5.3.3.6.1.3.3.cmml">s</mi></msub></msub><msub id="alg1.l43.m1.5.5.3.3.6.2" xref="alg1.l43.m1.5.5.3.3.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l43.m1.5.5.3.3.6.2.2" xref="alg1.l43.m1.5.5.3.3.6.2.2.cmml">ℒ</mi><mrow id="alg1.l43.m1.5.5.3.3.6.2.3" xref="alg1.l43.m1.5.5.3.3.6.2.3.cmml"><mi id="alg1.l43.m1.5.5.3.3.6.2.3.2" xref="alg1.l43.m1.5.5.3.3.6.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l43.m1.5.5.3.3.6.2.3.1" xref="alg1.l43.m1.5.5.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l43.m1.5.5.3.3.6.2.3.3" xref="alg1.l43.m1.5.5.3.3.6.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l43.m1.5.5.3.3.6.2.3.1a" xref="alg1.l43.m1.5.5.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l43.m1.5.5.3.3.6.2.3.4" xref="alg1.l43.m1.5.5.3.3.6.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l43.m1.5.5.3.3.6.2.3.1b" xref="alg1.l43.m1.5.5.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l43.m1.5.5.3.3.6.2.3.5" xref="alg1.l43.m1.5.5.3.3.6.2.3.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l43.m1.5.5.3.3.6.2.3.1c" xref="alg1.l43.m1.5.5.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l43.m1.5.5.3.3.6.2.3.6" xref="alg1.l43.m1.5.5.3.3.6.2.3.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l43.m1.5.5.3.3.6.2.3.1d" xref="alg1.l43.m1.5.5.3.3.6.2.3.1.cmml">​</mo><mi id="alg1.l43.m1.5.5.3.3.6.2.3.7" xref="alg1.l43.m1.5.5.3.3.6.2.3.7.cmml">r</mi></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l43.m1.5.5.3.3.4a" xref="alg1.l43.m1.5.5.3.3.4.cmml">​</mo><mrow id="alg1.l43.m1.5.5.3.3.3.3" xref="alg1.l43.m1.5.5.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l43.m1.5.5.3.3.3.3.4" xref="alg1.l43.m1.5.5.3.3.3.4.cmml">(</mo><msub id="alg1.l43.m1.3.3.1.1.1.1.1" xref="alg1.l43.m1.3.3.1.1.1.1.1.cmml"><mi id="alg1.l43.m1.3.3.1.1.1.1.1.2" xref="alg1.l43.m1.3.3.1.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l43.m1.3.3.1.1.1.1.1.3" xref="alg1.l43.m1.3.3.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l43.m1.5.5.3.3.3.3.5" xref="alg1.l43.m1.5.5.3.3.3.4.cmml">;</mo><msubsup id="alg1.l43.m1.4.4.2.2.2.2.2" xref="alg1.l43.m1.4.4.2.2.2.2.2.cmml"><mi id="alg1.l43.m1.4.4.2.2.2.2.2.2.2" xref="alg1.l43.m1.4.4.2.2.2.2.2.2.2.cmml">𝐗</mi><mi id="alg1.l43.m1.4.4.2.2.2.2.2.3" xref="alg1.l43.m1.4.4.2.2.2.2.2.3.cmml">𝐓</mi><mi id="alg1.l43.m1.4.4.2.2.2.2.2.2.3" xref="alg1.l43.m1.4.4.2.2.2.2.2.2.3.cmml">𝐥</mi></msubsup><mo id="alg1.l43.m1.5.5.3.3.3.3.6" xref="alg1.l43.m1.5.5.3.3.3.4.cmml">,</mo><msubsup id="alg1.l43.m1.5.5.3.3.3.3.3" xref="alg1.l43.m1.5.5.3.3.3.3.3.cmml"><mi id="alg1.l43.m1.5.5.3.3.3.3.3.2.2" xref="alg1.l43.m1.5.5.3.3.3.3.3.2.2.cmml">𝐳</mi><mi id="alg1.l43.m1.5.5.3.3.3.3.3.3" xref="alg1.l43.m1.5.5.3.3.3.3.3.3.cmml">𝐓</mi><mrow id="alg1.l43.m1.2.2.2.2" xref="alg1.l43.m1.2.2.2.3.cmml"><mo mathsize="142%" id="alg1.l43.m1.2.2.2.2.1" xref="alg1.l43.m1.2.2.2.2.1.cmml">′</mo><mo lspace="0em" id="alg1.l43.m1.2.2.2.2.2" xref="alg1.l43.m1.2.2.2.3.cmml">⁣</mo><mi id="alg1.l43.m1.1.1.1.1" xref="alg1.l43.m1.1.1.1.1.cmml">𝐥</mi></mrow></msubsup><mo stretchy="false" id="alg1.l43.m1.5.5.3.3.3.3.7" xref="alg1.l43.m1.5.5.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l43.m1.5b"><apply id="alg1.l43.m1.5.5.cmml" xref="alg1.l43.m1.5.5"><ci id="alg1.l43.m1.5.5.4.cmml" xref="alg1.l43.m1.5.5.4">←</ci><apply id="alg1.l43.m1.5.5.5.cmml" xref="alg1.l43.m1.5.5.5"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.5.1.cmml" xref="alg1.l43.m1.5.5.5">subscript</csymbol><ci id="alg1.l43.m1.5.5.5.2.cmml" xref="alg1.l43.m1.5.5.5.2">𝜃</ci><ci id="alg1.l43.m1.5.5.5.3.cmml" xref="alg1.l43.m1.5.5.5.3">𝑠</ci></apply><apply id="alg1.l43.m1.5.5.3.cmml" xref="alg1.l43.m1.5.5.3"><minus id="alg1.l43.m1.5.5.3.4.cmml" xref="alg1.l43.m1.5.5.3.4"></minus><apply id="alg1.l43.m1.5.5.3.5.cmml" xref="alg1.l43.m1.5.5.3.5"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.3.5.1.cmml" xref="alg1.l43.m1.5.5.3.5">subscript</csymbol><ci id="alg1.l43.m1.5.5.3.5.2.cmml" xref="alg1.l43.m1.5.5.3.5.2">𝜃</ci><ci id="alg1.l43.m1.5.5.3.5.3.cmml" xref="alg1.l43.m1.5.5.3.5.3">𝑠</ci></apply><apply id="alg1.l43.m1.5.5.3.3.cmml" xref="alg1.l43.m1.5.5.3.3"><times id="alg1.l43.m1.5.5.3.3.4.cmml" xref="alg1.l43.m1.5.5.3.3.4"></times><ci id="alg1.l43.m1.5.5.3.3.5.cmml" xref="alg1.l43.m1.5.5.3.3.5">𝜂</ci><apply id="alg1.l43.m1.5.5.3.3.6.cmml" xref="alg1.l43.m1.5.5.3.3.6"><apply id="alg1.l43.m1.5.5.3.3.6.1.cmml" xref="alg1.l43.m1.5.5.3.3.6.1"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.3.3.6.1.1.cmml" xref="alg1.l43.m1.5.5.3.3.6.1">subscript</csymbol><ci id="alg1.l43.m1.5.5.3.3.6.1.2.cmml" xref="alg1.l43.m1.5.5.3.3.6.1.2">∇</ci><apply id="alg1.l43.m1.5.5.3.3.6.1.3.cmml" xref="alg1.l43.m1.5.5.3.3.6.1.3"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.3.3.6.1.3.1.cmml" xref="alg1.l43.m1.5.5.3.3.6.1.3">subscript</csymbol><ci id="alg1.l43.m1.5.5.3.3.6.1.3.2.cmml" xref="alg1.l43.m1.5.5.3.3.6.1.3.2">𝜃</ci><ci id="alg1.l43.m1.5.5.3.3.6.1.3.3.cmml" xref="alg1.l43.m1.5.5.3.3.6.1.3.3">𝑠</ci></apply></apply><apply id="alg1.l43.m1.5.5.3.3.6.2.cmml" xref="alg1.l43.m1.5.5.3.3.6.2"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.3.3.6.2.1.cmml" xref="alg1.l43.m1.5.5.3.3.6.2">subscript</csymbol><ci id="alg1.l43.m1.5.5.3.3.6.2.2.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.2">ℒ</ci><apply id="alg1.l43.m1.5.5.3.3.6.2.3.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3"><times id="alg1.l43.m1.5.5.3.3.6.2.3.1.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.1"></times><ci id="alg1.l43.m1.5.5.3.3.6.2.3.2.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.2">𝑠</ci><ci id="alg1.l43.m1.5.5.3.3.6.2.3.3.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.3">𝑒</ci><ci id="alg1.l43.m1.5.5.3.3.6.2.3.4.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.4">𝑟</ci><ci id="alg1.l43.m1.5.5.3.3.6.2.3.5.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.5">𝑣</ci><ci id="alg1.l43.m1.5.5.3.3.6.2.3.6.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.6">𝑒</ci><ci id="alg1.l43.m1.5.5.3.3.6.2.3.7.cmml" xref="alg1.l43.m1.5.5.3.3.6.2.3.7">𝑟</ci></apply></apply></apply><list id="alg1.l43.m1.5.5.3.3.3.4.cmml" xref="alg1.l43.m1.5.5.3.3.3.3"><apply id="alg1.l43.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l43.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l43.m1.3.3.1.1.1.1.1.1.cmml" xref="alg1.l43.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l43.m1.3.3.1.1.1.1.1.2.cmml" xref="alg1.l43.m1.3.3.1.1.1.1.1.2">𝜃</ci><ci id="alg1.l43.m1.3.3.1.1.1.1.1.3.cmml" xref="alg1.l43.m1.3.3.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l43.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l43.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2">subscript</csymbol><apply id="alg1.l43.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l43.m1.4.4.2.2.2.2.2.2.1.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2">superscript</csymbol><ci id="alg1.l43.m1.4.4.2.2.2.2.2.2.2.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2.2.2">𝐗</ci><ci id="alg1.l43.m1.4.4.2.2.2.2.2.2.3.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2.2.3">𝐥</ci></apply><ci id="alg1.l43.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.l43.m1.4.4.2.2.2.2.2.3">𝐓</ci></apply><apply id="alg1.l43.m1.5.5.3.3.3.3.3.cmml" xref="alg1.l43.m1.5.5.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.3.3.3.3.3.1.cmml" xref="alg1.l43.m1.5.5.3.3.3.3.3">subscript</csymbol><apply id="alg1.l43.m1.5.5.3.3.3.3.3.2.cmml" xref="alg1.l43.m1.5.5.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l43.m1.5.5.3.3.3.3.3.2.1.cmml" xref="alg1.l43.m1.5.5.3.3.3.3.3">superscript</csymbol><ci id="alg1.l43.m1.5.5.3.3.3.3.3.2.2.cmml" xref="alg1.l43.m1.5.5.3.3.3.3.3.2.2">𝐳</ci><list id="alg1.l43.m1.2.2.2.3.cmml" xref="alg1.l43.m1.2.2.2.2"><ci id="alg1.l43.m1.2.2.2.2.1.cmml" xref="alg1.l43.m1.2.2.2.2.1">′</ci><ci id="alg1.l43.m1.1.1.1.1.cmml" xref="alg1.l43.m1.1.1.1.1">𝐥</ci></list></apply><ci id="alg1.l43.m1.5.5.3.3.3.3.3.3.cmml" xref="alg1.l43.m1.5.5.3.3.3.3.3.3">𝐓</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l43.m1.5c">\mathbf{\theta}_{s}\leftarrow\mathbf{\theta}_{s}-\eta\nabla_{\theta_{s}}\mathcal{L}_{server}(\mathcal{\theta}_{s};\mathbf{X^{l}_{T}},\mathbf{z^{\prime l}_{T}})</annotation></semantics></math>

</div>
<div id="alg1.l44" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l44.1.1.1" class="ltx_text" style="font-size:80%;">44:</span></span>     <span id="alg1.l44.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l44.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l45" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l45.1.1.1" class="ltx_text" style="font-size:80%;">45:</span></span>     <span id="alg1.l45.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l45.m1.1" class="ltx_Math" alttext="\mathbf{\theta}_{s}" display="inline"><semantics id="alg1.l45.m1.1a"><msub id="alg1.l45.m1.1.1" xref="alg1.l45.m1.1.1.cmml"><mi id="alg1.l45.m1.1.1.2" xref="alg1.l45.m1.1.1.2.cmml">θ</mi><mi id="alg1.l45.m1.1.1.3" xref="alg1.l45.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l45.m1.1b"><apply id="alg1.l45.m1.1.1.cmml" xref="alg1.l45.m1.1.1"><csymbol cd="ambiguous" id="alg1.l45.m1.1.1.1.cmml" xref="alg1.l45.m1.1.1">subscript</csymbol><ci id="alg1.l45.m1.1.1.2.cmml" xref="alg1.l45.m1.1.1.2">𝜃</ci><ci id="alg1.l45.m1.1.1.3.cmml" xref="alg1.l45.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l45.m1.1c">\mathbf{\theta}_{s}</annotation></semantics></math>

</div>
<div id="alg1.l46" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l46.1.1.1" class="ltx_text" style="font-size:80%;">46:</span></span><span id="alg1.l46.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l46.3" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</figure>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Experiment Details</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Dataset</h3>

<section id="A4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.1 </span>IEMOCAP</h4>

<div id="A4.SS1.SSS1.p1" class="ltx_para">
<p id="A4.SS1.SSS1.p1.1" class="ltx_p">The IEMOCAP database <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> was collected using multi-modal sensors to capture motion, audio, and video of human interactions. The original corpus contains 10,039 utterances from ten subjects (five male and five female) expressing various categorical emotions from improvised and scripted scenarios.
Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, we focus on the improvised sessions. We use the four most frequent emotion labels: neutral, sad, happiness, and anger for training the SER model due to the data imbalance in other labels.</p>
</div>
</section>
<section id="A4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.2 </span>MSP-Improv</h4>

<div id="A4.SS1.SSS2.p1" class="ltx_para">
<p id="A4.SS1.SSS2.p1.1" class="ltx_p">The MSP-Improv corpus <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> is a multi-modal emotion recognition data set captured from improvised scenarios. The data is collected from 12 speakers (six male and six female) and includes audio and textual data of utterances spoken in different recording conditions.</p>
</div>
</section>
<section id="A4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.1.3 </span>UPMC Food101</h4>

<div id="A4.SS1.SSS3.p1" class="ltx_para">
<p id="A4.SS1.SSS3.p1.1" class="ltx_p">The UPMC Food101 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> consists of web pages with textual recipe descriptions for 101 food labels automatically retrieved online. Each page was matched with a single image, where the images were obtained by querying Google Image Search for the given category. Examples of food labels are Filet Mignon, Pad Thai, Breakfast Burrito and Spaghetti Bolognese. The web pages were processed with html2text<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>github.com/aaronsw/html2text</span></span></span> to obtain the raw text.</p>
</div>
</section>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Data Statistics</h3>

<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.1" class="ltx_p">Data statistics are shown in Table <a href="#A4.T1" title="Table 1 ‣ D.2 Data Statistics ‣ Appendix D Experiment Details ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="A4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A4.T1.2.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>Statistics of data sets used in this study.</figcaption>
<table id="A4.T1.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A4.T1.3.1.1" class="ltx_tr">
<td id="A4.T1.3.1.1.1" class="ltx_td ltx_align_top ltx_border_tt"></td>
<td id="A4.T1.3.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_tt"><span id="A4.T1.3.1.1.2.1" class="ltx_text ltx_font_bold">Train</span></td>
<td id="A4.T1.3.1.1.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_tt"><span id="A4.T1.3.1.1.3.1" class="ltx_text ltx_font_bold">Dev</span></td>
<td id="A4.T1.3.1.1.4" class="ltx_td ltx_align_center ltx_align_top ltx_border_tt"><span id="A4.T1.3.1.1.4.1" class="ltx_text ltx_font_bold">Test</span></td>
<td id="A4.T1.3.1.1.5" class="ltx_td ltx_align_right ltx_align_top ltx_border_tt">  
<span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T1.3.2.2" class="ltx_tr">
<td id="A4.T1.3.2.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="A4.T1.3.2.2.1.1" class="ltx_text ltx_font_bold">Food101</span></td>
<td id="A4.T1.3.2.2.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">58545</td>
<td id="A4.T1.3.2.2.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">6556</td>
<td id="A4.T1.3.2.2.4" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">21695</td>
<td id="A4.T1.3.2.2.5" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">   <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T1.3.3.3" class="ltx_tr">
<td id="A4.T1.3.3.3.1" class="ltx_td ltx_align_top ltx_border_tt"></td>
<td id="A4.T1.3.3.3.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_tt"><span id="A4.T1.3.3.3.2.1" class="ltx_text ltx_font_bold">Neu.</span></td>
<td id="A4.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_tt"><span id="A4.T1.3.3.3.3.1" class="ltx_text ltx_font_bold">Hap.</span></td>
<td id="A4.T1.3.3.3.4" class="ltx_td ltx_align_center ltx_align_top ltx_border_tt"><span id="A4.T1.3.3.3.4.1" class="ltx_text ltx_font_bold">Sad</span></td>
<td id="A4.T1.3.3.3.5" class="ltx_td ltx_align_right ltx_align_top ltx_border_tt">
<span id="A4.T1.3.3.3.5.1" class="ltx_text ltx_font_bold">Ang.</span>   
<span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T1.3.4.4" class="ltx_tr">
<td id="A4.T1.3.4.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t"><span id="A4.T1.3.4.4.1.1" class="ltx_text ltx_font_bold">IEMOCAP</span></td>
<td id="A4.T1.3.4.4.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">1099</td>
<td id="A4.T1.3.4.4.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">947</td>
<td id="A4.T1.3.4.4.4" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">608</td>
<td id="A4.T1.3.4.4.5" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">289    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T1.3.5.5" class="ltx_tr">
<td id="A4.T1.3.5.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb"><span id="A4.T1.3.5.5.1.1" class="ltx_text ltx_font_bold">MSP-Improv</span></td>
<td id="A4.T1.3.5.5.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb">2072</td>
<td id="A4.T1.3.5.5.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb">1184</td>
<td id="A4.T1.3.5.5.4" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb">739</td>
<td id="A4.T1.3.5.5.5" class="ltx_td ltx_align_right ltx_align_top ltx_border_bb">585    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="A4.T2.2.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>Ablation study: comparisons between PartialFL and FL on the Food101 data set under different data heterogeneity settings.</figcaption>
<table id="A4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T2.3.1.1" class="ltx_tr">
<th id="A4.T2.3.1.1.1" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt"><span id="A4.T2.3.1.1.1.1" class="ltx_text ltx_font_bold">Classification</span></th>
<th id="A4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt"><span id="A4.T2.3.1.1.2.1" class="ltx_text ltx_font_bold">Exp.</span></th>
<th id="A4.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A4.T2.3.1.1.3.1" class="ltx_text ltx_font_bold">Alpha</span></th>
<th id="A4.T2.3.1.1.4" class="ltx_td ltx_align_right ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="A4.T2.3.1.1.4.1" class="ltx_text ltx_font_bold">Top5</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</th>
</tr>
<tr id="A4.T2.3.2.2" class="ltx_tr">
<th id="A4.T2.3.2.2.1" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column"><span id="A4.T2.3.2.2.1.1" class="ltx_text ltx_font_bold">Modality</span></th>
<th id="A4.T2.3.2.2.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column"><span id="A4.T2.3.2.2.2.1" class="ltx_text ltx_font_bold">Setting</span></th>
<th id="A4.T2.3.2.2.3" class="ltx_td ltx_align_right ltx_align_top ltx_th ltx_th_column">
<span id="A4.T2.3.2.2.3.1" class="ltx_text ltx_font_bold">Accuracy</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T2.3.3.1" class="ltx_tr">
<td id="A4.T2.3.3.1.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="6"><span id="A4.T2.3.3.1.1.1" class="ltx_text ltx_font_bold">Image</span></td>
<td id="A4.T2.3.3.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">FL</td>
<td id="A4.T2.3.3.1.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="2"><span id="A4.T2.3.3.1.3.1" class="ltx_text">1.0</span></td>
<td id="A4.T2.3.3.1.4" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">51.08%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.4.2" class="ltx_tr">
<td id="A4.T2.3.4.2.1" class="ltx_td ltx_align_justify ltx_align_top">PartialFL</td>
<td id="A4.T2.3.4.2.2" class="ltx_td ltx_align_right ltx_align_top">
<span id="A4.T2.3.4.2.2.1" class="ltx_text ltx_font_bold">53.03%</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.5.3" class="ltx_tr">
<td id="A4.T2.3.5.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">FL</td>
<td id="A4.T2.3.5.3.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="2"><span id="A4.T2.3.5.3.2.1" class="ltx_text">0.5</span></td>
<td id="A4.T2.3.5.3.3" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">48.27%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.6.4" class="ltx_tr">
<td id="A4.T2.3.6.4.1" class="ltx_td ltx_align_justify ltx_align_top">PartialFL</td>
<td id="A4.T2.3.6.4.2" class="ltx_td ltx_align_right ltx_align_top">
<span id="A4.T2.3.6.4.2.1" class="ltx_text ltx_font_bold">51.20%</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.7.5" class="ltx_tr">
<td id="A4.T2.3.7.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">FL</td>
<td id="A4.T2.3.7.5.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="2"><span id="A4.T2.3.7.5.2.1" class="ltx_text">0.1</span></td>
<td id="A4.T2.3.7.5.3" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">36.20%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.8.6" class="ltx_tr">
<td id="A4.T2.3.8.6.1" class="ltx_td ltx_align_justify ltx_align_top">PartialFL</td>
<td id="A4.T2.3.8.6.2" class="ltx_td ltx_align_right ltx_align_top">
<span id="A4.T2.3.8.6.2.1" class="ltx_text ltx_font_bold">39.54%</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.9.7" class="ltx_tr">
<td id="A4.T2.3.9.7.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb ltx_border_t" rowspan="6"><span id="A4.T2.3.9.7.1.1" class="ltx_text ltx_font_bold">Image+Text</span></td>
<td id="A4.T2.3.9.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">FL</td>
<td id="A4.T2.3.9.7.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="2"><span id="A4.T2.3.9.7.3.1" class="ltx_text">1.0</span></td>
<td id="A4.T2.3.9.7.4" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">56.04%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.10.8" class="ltx_tr">
<td id="A4.T2.3.10.8.1" class="ltx_td ltx_align_justify ltx_align_top">PartialFL</td>
<td id="A4.T2.3.10.8.2" class="ltx_td ltx_align_right ltx_align_top">
<span id="A4.T2.3.10.8.2.1" class="ltx_text ltx_font_bold">58.62%</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.11.9" class="ltx_tr">
<td id="A4.T2.3.11.9.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">FL</td>
<td id="A4.T2.3.11.9.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="2"><span id="A4.T2.3.11.9.2.1" class="ltx_text">0.5</span></td>
<td id="A4.T2.3.11.9.3" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">52.91%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.12.10" class="ltx_tr">
<td id="A4.T2.3.12.10.1" class="ltx_td ltx_align_justify ltx_align_top">PartialFL</td>
<td id="A4.T2.3.12.10.2" class="ltx_td ltx_align_right ltx_align_top">
<span id="A4.T2.3.12.10.2.1" class="ltx_text ltx_font_bold">55.94%</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.13.11" class="ltx_tr">
<td id="A4.T2.3.13.11.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">FL</td>
<td id="A4.T2.3.13.11.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb ltx_border_t" rowspan="2"><span id="A4.T2.3.13.11.2.1" class="ltx_text">0.1</span></td>
<td id="A4.T2.3.13.11.3" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">40.68%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T2.3.14.12" class="ltx_tr">
<td id="A4.T2.3.14.12.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb">PartialFL</td>
<td id="A4.T2.3.14.12.2" class="ltx_td ltx_align_right ltx_align_top ltx_border_bb">
<span id="A4.T2.3.14.12.2.1" class="ltx_text ltx_font_bold">43.74%</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.3 </span>Models and Features</h3>

<section id="A4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.1 </span>Audio</h4>

<div id="A4.SS3.SSS1.p1" class="ltx_para">
<p id="A4.SS3.SSS1.p1.1" class="ltx_p">The model we use for the SER task is similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. The network has 2 main components: an embedding network and an emotion classifier. The embedding network of the audio data is a set of convolution layers proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, followed by a Gated Recurrent Unit (GRU) layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. We obtain an utterance-level audio representation by applying mean pooling to the output of the GRU layer. We then use a projection layer to compute the audio embedding. Finally, the emotion classifier takes the audio embedding and estimates emotion labels using a set of dense layers. Inputs to the embedding network are 80 dimensional Mel filter bank (MFB) features using 25ms Hamming window with step size of 10ms.
We further apply z-normalization to these features within each speaker before feeding them to the embedding network.</p>
</div>
<figure id="A4.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A4.T3.4.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>Ablation study: Impact of missing modalities in some edge devices; in the Food-101 dataset, the Global model uses Image modality only and we report Top 5 Accuracy; In IEMOCAP and MSP-Improv, we use the Audio only Global model and report UAR.</figcaption>
<table id="A4.T3.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T3.2.2" class="ltx_tr">
<th id="A4.T3.2.2.3" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt"><span id="A4.T3.2.2.3.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A4.T3.1.1.1" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt"><math id="A4.T3.1.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="A4.T3.1.1.1.m1.1a"><mi id="A4.T3.1.1.1.m1.1.1" xref="A4.T3.1.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="A4.T3.1.1.1.m1.1b"><ci id="A4.T3.1.1.1.m1.1.1.cmml" xref="A4.T3.1.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T3.1.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></th>
<th id="A4.T3.2.2.2" class="ltx_td ltx_align_center ltx_align_top ltx_th ltx_th_column ltx_border_tt"><math id="A4.T3.2.2.2.m1.1" class="ltx_Math" alttext="\boldsymbol{q}" display="inline"><semantics id="A4.T3.2.2.2.m1.1a"><mi id="A4.T3.2.2.2.m1.1.1" xref="A4.T3.2.2.2.m1.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="A4.T3.2.2.2.m1.1b"><ci id="A4.T3.2.2.2.m1.1.1.cmml" xref="A4.T3.2.2.2.m1.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T3.2.2.2.m1.1c">\boldsymbol{q}</annotation></semantics></math></th>
<th id="A4.T3.2.2.4" class="ltx_td ltx_align_right ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="A4.T3.2.2.4.1" class="ltx_text ltx_font_bold">Scores</span>    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T3.2.3.1" class="ltx_tr">
<td id="A4.T3.2.3.1.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="8"><span id="A4.T3.2.3.1.1.1" class="ltx_text ltx_font_bold">Food-101</span></td>
<td id="A4.T3.2.3.1.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="4"><span id="A4.T3.2.3.1.2.1" class="ltx_text ltx_font_bold">1.0</span></td>
<td id="A4.T3.2.3.1.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">100%</td>
<td id="A4.T3.2.3.1.4" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">58.62%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.4.2" class="ltx_tr">
<td id="A4.T3.2.4.2.1" class="ltx_td ltx_align_center ltx_align_top">50%</td>
<td id="A4.T3.2.4.2.2" class="ltx_td ltx_align_right ltx_align_top">58.04%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.5.3" class="ltx_tr">
<td id="A4.T3.2.5.3.1" class="ltx_td ltx_align_center ltx_align_top">25%</td>
<td id="A4.T3.2.5.3.2" class="ltx_td ltx_align_right ltx_align_top">57.58%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.6.4" class="ltx_tr">
<td id="A4.T3.2.6.4.1" class="ltx_td ltx_align_center ltx_align_top">0%</td>
<td id="A4.T3.2.6.4.2" class="ltx_td ltx_align_right ltx_align_top">56.04%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.7.5" class="ltx_tr">
<td id="A4.T3.2.7.5.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="4"><span id="A4.T3.2.7.5.1.1" class="ltx_text ltx_font_bold">0.5</span></td>
<td id="A4.T3.2.7.5.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">100%</td>
<td id="A4.T3.2.7.5.3" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">51.2%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.8.6" class="ltx_tr">
<td id="A4.T3.2.8.6.1" class="ltx_td ltx_align_center ltx_align_top">50%</td>
<td id="A4.T3.2.8.6.2" class="ltx_td ltx_align_right ltx_align_top">50.94%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.9.7" class="ltx_tr">
<td id="A4.T3.2.9.7.1" class="ltx_td ltx_align_center ltx_align_top">25%</td>
<td id="A4.T3.2.9.7.2" class="ltx_td ltx_align_right ltx_align_top">50.31%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.10.8" class="ltx_tr">
<td id="A4.T3.2.10.8.1" class="ltx_td ltx_align_center ltx_align_top">0%</td>
<td id="A4.T3.2.10.8.2" class="ltx_td ltx_align_right ltx_align_top">48.27%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.11.9" class="ltx_tr">
<td id="A4.T3.2.11.9.1" class="ltx_td ltx_align_top"></td>
<td id="A4.T3.2.11.9.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="4"><span id="A4.T3.2.11.9.2.1" class="ltx_text ltx_font_bold">0.1</span></td>
<td id="A4.T3.2.11.9.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">100%</td>
<td id="A4.T3.2.11.9.4" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">39.54%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.12.10" class="ltx_tr">
<td id="A4.T3.2.12.10.1" class="ltx_td ltx_align_top"></td>
<td id="A4.T3.2.12.10.2" class="ltx_td ltx_align_center ltx_align_top">50%</td>
<td id="A4.T3.2.12.10.3" class="ltx_td ltx_align_right ltx_align_top">39.47%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.13.11" class="ltx_tr">
<td id="A4.T3.2.13.11.1" class="ltx_td ltx_align_top"></td>
<td id="A4.T3.2.13.11.2" class="ltx_td ltx_align_center ltx_align_top">25%</td>
<td id="A4.T3.2.13.11.3" class="ltx_td ltx_align_right ltx_align_top">38.65%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.14.12" class="ltx_tr">
<td id="A4.T3.2.14.12.1" class="ltx_td ltx_align_top"></td>
<td id="A4.T3.2.14.12.2" class="ltx_td ltx_align_center ltx_align_top">0%</td>
<td id="A4.T3.2.14.12.3" class="ltx_td ltx_align_right ltx_align_top">36.20%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.15.13" class="ltx_tr">
<td id="A4.T3.2.15.13.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="3"><span id="A4.T3.2.15.13.1.1" class="ltx_text ltx_font_bold">IEMOCAP</span></td>
<td id="A4.T3.2.15.13.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_t" rowspan="3"><span id="A4.T3.2.15.13.2.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="A4.T3.2.15.13.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">100%</td>
<td id="A4.T3.2.15.13.4" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">61.30%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.16.14" class="ltx_tr">
<td id="A4.T3.2.16.14.1" class="ltx_td ltx_align_center ltx_align_top">50%</td>
<td id="A4.T3.2.16.14.2" class="ltx_td ltx_align_right ltx_align_top">59.37%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.17.15" class="ltx_tr">
<td id="A4.T3.2.17.15.1" class="ltx_td ltx_align_center ltx_align_top">0%</td>
<td id="A4.T3.2.17.15.2" class="ltx_td ltx_align_right ltx_align_top">56.93%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.18.16" class="ltx_tr">
<td id="A4.T3.2.18.16.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb ltx_border_t" rowspan="3"><span id="A4.T3.2.18.16.1.1" class="ltx_text ltx_font_bold">MSP-Improv</span></td>
<td id="A4.T3.2.18.16.2" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb ltx_border_t" rowspan="3"><span id="A4.T3.2.18.16.2.1" class="ltx_text ltx_font_bold">-</span></td>
<td id="A4.T3.2.18.16.3" class="ltx_td ltx_align_center ltx_align_top ltx_border_t">100%</td>
<td id="A4.T3.2.18.16.4" class="ltx_td ltx_align_right ltx_align_top ltx_border_t">45.14%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.19.17" class="ltx_tr">
<td id="A4.T3.2.19.17.1" class="ltx_td ltx_align_center ltx_align_top">50%</td>
<td id="A4.T3.2.19.17.2" class="ltx_td ltx_align_right ltx_align_top">44.97%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
<tr id="A4.T3.2.20.18" class="ltx_tr">
<td id="A4.T3.2.20.18.1" class="ltx_td ltx_align_center ltx_align_top ltx_border_bb">0%</td>
<td id="A4.T3.2.20.18.2" class="ltx_td ltx_align_right ltx_align_top ltx_border_bb">43.90%    <span class="ltx_rule" style="width:0.0pt;height:8.6pt;background:black;display:inline-block;"></span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.2 </span>Image</h4>

<div id="A4.SS3.SSS2.p1" class="ltx_para">
<p id="A4.SS3.SSS2.p1.1" class="ltx_p">Similar to the SER model, the image model consists of an embedding network and a classifier. The image embedding network is a set of dense layers followed by a projection layer. We use the image embedding to generate the prediction output. We use the MobileNetV2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> pre-trained model to extract representations of raw images which are passed to the embedding network. We use this model since it is small enough to fit most edge devices.</p>
</div>
<figure id="A4.F4" class="ltx_figure"><img src="/html/2403.01615/assets/x3.png" id="A4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F4.4.1.1" class="ltx_text ltx_font_bold">Fig. 4</span>: </span>Top-5 accuracies on test set for PartialFL compared to other baselines in the UPMC Food-101 data set. In all cases, we repeat the experiment 5 times with different seed numbers and report average performances. In PartialFL, we report best performance from different temperature values. We use <math id="A4.F4.2.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A4.F4.2.m1.1b"><mrow id="A4.F4.2.m1.1.1" xref="A4.F4.2.m1.1.1.cmml"><mi id="A4.F4.2.m1.1.1.2" xref="A4.F4.2.m1.1.1.2.cmml">α</mi><mo id="A4.F4.2.m1.1.1.1" xref="A4.F4.2.m1.1.1.1.cmml">=</mo><mn id="A4.F4.2.m1.1.1.3" xref="A4.F4.2.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F4.2.m1.1c"><apply id="A4.F4.2.m1.1.1.cmml" xref="A4.F4.2.m1.1.1"><eq id="A4.F4.2.m1.1.1.1.cmml" xref="A4.F4.2.m1.1.1.1"></eq><ci id="A4.F4.2.m1.1.1.2.cmml" xref="A4.F4.2.m1.1.1.2">𝛼</ci><cn type="float" id="A4.F4.2.m1.1.1.3.cmml" xref="A4.F4.2.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F4.2.m1.1d">\alpha=1.0</annotation></semantics></math> in all federated experiments (FL, SL and PartialFL)</figcaption>
</figure>
</section>
<section id="A4.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.3 </span>Text</h4>

<div id="A4.SS3.SSS3.p1" class="ltx_para">
<p id="A4.SS3.SSS3.p1.1" class="ltx_p">For the text model, we use an embedding network which maps DistilBert <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> sentence representations into a lower-dimensional text embedding. We use a considerably larger embedding network (compared to the edge) in our server. The text model on edge also includes a classifier module (fully connected layer with an outer softmax layer) to generate predictions using local text embeddings.</p>
</div>
</section>
<section id="A4.SS3.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">D.3.4 </span>Multi-modal Model</h4>

<div id="A4.SS3.SSS4.p1" class="ltx_para">
<p id="A4.SS3.SSS4.p1.1" class="ltx_p">In the multi-modal global model, we concatenate audio (or image) representations with text representations and pass them through a projection layer to obtain the multi-modal embedding. The classifier then uses this multi-modal embedding to generate the predictions for corresponding tasks.</p>
</div>
</section>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Additional Results</h2>

<section id="A5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Results on UPMC Food-101 dataset</h3>

<div id="A5.SS1.p1" class="ltx_para">
<p id="A5.SS1.p1.1" class="ltx_p">We report top-1 and top-5 accuracies in this data set. Model performances and sizes for this dataset are shown in Figure <a href="#A4.F4" title="Figure 4 ‣ D.3.2 Image ‣ D.3 Models and Features ‣ Appendix D Experiment Details ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<section id="A5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">E.1.1 </span>Uni-modal global model (image only)</h4>

<div id="A5.SS1.SSS1.p1" class="ltx_para">
<p id="A5.SS1.SSS1.p1.1" class="ltx_p">Firstly, the centralized image model shows the best performance, largely thanks to a larger model size. Furthermore, we can observe that SL consistently yields better performance than FL. Under FL settings, we find that FedProx outperforms FedAvg, and the top-5 accuracy of FL baseline is about 4% higher using the FedProx algorithm when compared with FedAvg. PartialFL outperforms the FL baseline by 1.95% by making use of the shared data modality. SL outperforms PartialFL by only 1.76%, but at a significant communication overhead.</p>
</div>
</section>
<section id="A5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">E.1.2 </span>Multi-modal global model (image+text)</h4>

<div id="A5.SS1.SSS2.p1" class="ltx_para">
<p id="A5.SS1.SSS2.p1.1" class="ltx_p">Similar to the previous setting, we observe the centralized multi-modal models showing better performance compared to other baselines and FedProx outperforms FedAvg in both FL and PartialFL experiments. Our proposed PartialFL approach improves the global model performance by 2.58% comparing to the FL baseline.</p>
</div>
</section>
</section>
<section id="A5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>Impact of non-IID settings</h3>

<div id="A5.SS2.p1" class="ltx_para">
<p id="A5.SS2.p1.3" class="ltx_p">In this experiment, we explore how PartialFL performs under a non-IID setting with data heterogeneity, which is frequently encountered in most real world FL applications. We simulate non-IID edge devices by controlling the <math id="A5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A5.SS2.p1.1.m1.1a"><mi id="A5.SS2.p1.1.m1.1.1" xref="A5.SS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.1.m1.1b"><ci id="A5.SS2.p1.1.m1.1.1.cmml" xref="A5.SS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.1.m1.1c">\alpha</annotation></semantics></math> parameter <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> when creating the data sets, which controls the concentration of the Dirichlet distribution in allocating proportion of label samples to each device (so a small alpha corresponds to more imbalanced data distribution, and hence higher data heterogeneity). We perform this experiment only on the Food-101 data set since the speech data sets are small (with each speaker as a separate edge device). Table <a href="#A4.T2" title="Table 2 ‣ D.2 Data Statistics ‣ Appendix D Experiment Details ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents model comparisons between the PartialFL and FL baselines. We only present results with FedProx, as it showed better performance than FedAvg. As expected, performances of both PartialFL and traditional FL decrease as <math id="A5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A5.SS2.p1.2.m2.1a"><mi id="A5.SS2.p1.2.m2.1.1" xref="A5.SS2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.2.m2.1b"><ci id="A5.SS2.p1.2.m2.1.1.cmml" xref="A5.SS2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.2.m2.1c">\alpha</annotation></semantics></math> value reduces, but PartialFL consistently outperforms FL baselines in all settings. Furthermore, we observe that the PartialFL provides larger performance improvements against FL in non-IID settings (compared to the IID setting of <math id="A5.SS2.p1.3.m3.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="A5.SS2.p1.3.m3.1a"><mrow id="A5.SS2.p1.3.m3.1.1" xref="A5.SS2.p1.3.m3.1.1.cmml"><mi id="A5.SS2.p1.3.m3.1.1.2" xref="A5.SS2.p1.3.m3.1.1.2.cmml">α</mi><mo id="A5.SS2.p1.3.m3.1.1.1" xref="A5.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="A5.SS2.p1.3.m3.1.1.3" xref="A5.SS2.p1.3.m3.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.SS2.p1.3.m3.1b"><apply id="A5.SS2.p1.3.m3.1.1.cmml" xref="A5.SS2.p1.3.m3.1.1"><eq id="A5.SS2.p1.3.m3.1.1.1.cmml" xref="A5.SS2.p1.3.m3.1.1.1"></eq><ci id="A5.SS2.p1.3.m3.1.1.2.cmml" xref="A5.SS2.p1.3.m3.1.1.2">𝛼</ci><cn type="float" id="A5.SS2.p1.3.m3.1.1.3.cmml" xref="A5.SS2.p1.3.m3.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS2.p1.3.m3.1c">\alpha=1.0</annotation></semantics></math>), by leveraging the shared modality.</p>
</div>
</section>
<section id="A5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.3 </span>Impact of missing modalities in edge devices</h3>

<div id="A5.SS3.p1" class="ltx_para">
<p id="A5.SS3.p1.6" class="ltx_p">In practice, not every edge device may contain multi-modal data; for example, in commercial SLU systems, some devices are designed to only accept audio inputs while others may accept audio, video and text inputs. In this setting, we evaluate performance of PartialFL when the shareable modality is missing in a subset of edge devices. We define <math id="A5.SS3.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A5.SS3.p1.1.m1.1a"><mi id="A5.SS3.p1.1.m1.1.1" xref="A5.SS3.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.1.m1.1b"><ci id="A5.SS3.p1.1.m1.1.1.cmml" xref="A5.SS3.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.1.m1.1c">q</annotation></semantics></math> as the percentage of the devices with multi-modal data, and we simulate the case with various values of <math id="A5.SS3.p1.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A5.SS3.p1.2.m2.1a"><mi id="A5.SS3.p1.2.m2.1.1" xref="A5.SS3.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.2.m2.1b"><ci id="A5.SS3.p1.2.m2.1.1.cmml" xref="A5.SS3.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.2.m2.1c">q</annotation></semantics></math>. <math id="A5.SS3.p1.3.m3.1" class="ltx_Math" alttext="q=0\%" display="inline"><semantics id="A5.SS3.p1.3.m3.1a"><mrow id="A5.SS3.p1.3.m3.1.1" xref="A5.SS3.p1.3.m3.1.1.cmml"><mi id="A5.SS3.p1.3.m3.1.1.2" xref="A5.SS3.p1.3.m3.1.1.2.cmml">q</mi><mo id="A5.SS3.p1.3.m3.1.1.1" xref="A5.SS3.p1.3.m3.1.1.1.cmml">=</mo><mrow id="A5.SS3.p1.3.m3.1.1.3" xref="A5.SS3.p1.3.m3.1.1.3.cmml"><mn id="A5.SS3.p1.3.m3.1.1.3.2" xref="A5.SS3.p1.3.m3.1.1.3.2.cmml">0</mn><mo id="A5.SS3.p1.3.m3.1.1.3.1" xref="A5.SS3.p1.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.3.m3.1b"><apply id="A5.SS3.p1.3.m3.1.1.cmml" xref="A5.SS3.p1.3.m3.1.1"><eq id="A5.SS3.p1.3.m3.1.1.1.cmml" xref="A5.SS3.p1.3.m3.1.1.1"></eq><ci id="A5.SS3.p1.3.m3.1.1.2.cmml" xref="A5.SS3.p1.3.m3.1.1.2">𝑞</ci><apply id="A5.SS3.p1.3.m3.1.1.3.cmml" xref="A5.SS3.p1.3.m3.1.1.3"><csymbol cd="latexml" id="A5.SS3.p1.3.m3.1.1.3.1.cmml" xref="A5.SS3.p1.3.m3.1.1.3.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.3.m3.1.1.3.2.cmml" xref="A5.SS3.p1.3.m3.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.3.m3.1c">q=0\%</annotation></semantics></math> indicates the case where none of the edge devices contain the shareable modality, and is equivalent to the FL baseline. We explore <math id="A5.SS3.p1.4.m4.4" class="ltx_Math" alttext="q\in\{0\%,25\%,50\%,100\%\}" display="inline"><semantics id="A5.SS3.p1.4.m4.4a"><mrow id="A5.SS3.p1.4.m4.4.4" xref="A5.SS3.p1.4.m4.4.4.cmml"><mi id="A5.SS3.p1.4.m4.4.4.6" xref="A5.SS3.p1.4.m4.4.4.6.cmml">q</mi><mo id="A5.SS3.p1.4.m4.4.4.5" xref="A5.SS3.p1.4.m4.4.4.5.cmml">∈</mo><mrow id="A5.SS3.p1.4.m4.4.4.4.4" xref="A5.SS3.p1.4.m4.4.4.4.5.cmml"><mo stretchy="false" id="A5.SS3.p1.4.m4.4.4.4.4.5" xref="A5.SS3.p1.4.m4.4.4.4.5.cmml">{</mo><mrow id="A5.SS3.p1.4.m4.1.1.1.1.1" xref="A5.SS3.p1.4.m4.1.1.1.1.1.cmml"><mn id="A5.SS3.p1.4.m4.1.1.1.1.1.2" xref="A5.SS3.p1.4.m4.1.1.1.1.1.2.cmml">0</mn><mo id="A5.SS3.p1.4.m4.1.1.1.1.1.1" xref="A5.SS3.p1.4.m4.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="A5.SS3.p1.4.m4.4.4.4.4.6" xref="A5.SS3.p1.4.m4.4.4.4.5.cmml">,</mo><mrow id="A5.SS3.p1.4.m4.2.2.2.2.2" xref="A5.SS3.p1.4.m4.2.2.2.2.2.cmml"><mn id="A5.SS3.p1.4.m4.2.2.2.2.2.2" xref="A5.SS3.p1.4.m4.2.2.2.2.2.2.cmml">25</mn><mo id="A5.SS3.p1.4.m4.2.2.2.2.2.1" xref="A5.SS3.p1.4.m4.2.2.2.2.2.1.cmml">%</mo></mrow><mo id="A5.SS3.p1.4.m4.4.4.4.4.7" xref="A5.SS3.p1.4.m4.4.4.4.5.cmml">,</mo><mrow id="A5.SS3.p1.4.m4.3.3.3.3.3" xref="A5.SS3.p1.4.m4.3.3.3.3.3.cmml"><mn id="A5.SS3.p1.4.m4.3.3.3.3.3.2" xref="A5.SS3.p1.4.m4.3.3.3.3.3.2.cmml">50</mn><mo id="A5.SS3.p1.4.m4.3.3.3.3.3.1" xref="A5.SS3.p1.4.m4.3.3.3.3.3.1.cmml">%</mo></mrow><mo id="A5.SS3.p1.4.m4.4.4.4.4.8" xref="A5.SS3.p1.4.m4.4.4.4.5.cmml">,</mo><mrow id="A5.SS3.p1.4.m4.4.4.4.4.4" xref="A5.SS3.p1.4.m4.4.4.4.4.4.cmml"><mn id="A5.SS3.p1.4.m4.4.4.4.4.4.2" xref="A5.SS3.p1.4.m4.4.4.4.4.4.2.cmml">100</mn><mo id="A5.SS3.p1.4.m4.4.4.4.4.4.1" xref="A5.SS3.p1.4.m4.4.4.4.4.4.1.cmml">%</mo></mrow><mo stretchy="false" id="A5.SS3.p1.4.m4.4.4.4.4.9" xref="A5.SS3.p1.4.m4.4.4.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.4.m4.4b"><apply id="A5.SS3.p1.4.m4.4.4.cmml" xref="A5.SS3.p1.4.m4.4.4"><in id="A5.SS3.p1.4.m4.4.4.5.cmml" xref="A5.SS3.p1.4.m4.4.4.5"></in><ci id="A5.SS3.p1.4.m4.4.4.6.cmml" xref="A5.SS3.p1.4.m4.4.4.6">𝑞</ci><set id="A5.SS3.p1.4.m4.4.4.4.5.cmml" xref="A5.SS3.p1.4.m4.4.4.4.4"><apply id="A5.SS3.p1.4.m4.1.1.1.1.1.cmml" xref="A5.SS3.p1.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="A5.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="A5.SS3.p1.4.m4.1.1.1.1.1.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.4.m4.1.1.1.1.1.2.cmml" xref="A5.SS3.p1.4.m4.1.1.1.1.1.2">0</cn></apply><apply id="A5.SS3.p1.4.m4.2.2.2.2.2.cmml" xref="A5.SS3.p1.4.m4.2.2.2.2.2"><csymbol cd="latexml" id="A5.SS3.p1.4.m4.2.2.2.2.2.1.cmml" xref="A5.SS3.p1.4.m4.2.2.2.2.2.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.4.m4.2.2.2.2.2.2.cmml" xref="A5.SS3.p1.4.m4.2.2.2.2.2.2">25</cn></apply><apply id="A5.SS3.p1.4.m4.3.3.3.3.3.cmml" xref="A5.SS3.p1.4.m4.3.3.3.3.3"><csymbol cd="latexml" id="A5.SS3.p1.4.m4.3.3.3.3.3.1.cmml" xref="A5.SS3.p1.4.m4.3.3.3.3.3.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.4.m4.3.3.3.3.3.2.cmml" xref="A5.SS3.p1.4.m4.3.3.3.3.3.2">50</cn></apply><apply id="A5.SS3.p1.4.m4.4.4.4.4.4.cmml" xref="A5.SS3.p1.4.m4.4.4.4.4.4"><csymbol cd="latexml" id="A5.SS3.p1.4.m4.4.4.4.4.4.1.cmml" xref="A5.SS3.p1.4.m4.4.4.4.4.4.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.4.m4.4.4.4.4.4.2.cmml" xref="A5.SS3.p1.4.m4.4.4.4.4.4.2">100</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.4.m4.4c">q\in\{0\%,25\%,50\%,100\%\}</annotation></semantics></math> and <math id="A5.SS3.p1.5.m5.3" class="ltx_Math" alttext="q\in\{0\%,50\%,100\%\}" display="inline"><semantics id="A5.SS3.p1.5.m5.3a"><mrow id="A5.SS3.p1.5.m5.3.3" xref="A5.SS3.p1.5.m5.3.3.cmml"><mi id="A5.SS3.p1.5.m5.3.3.5" xref="A5.SS3.p1.5.m5.3.3.5.cmml">q</mi><mo id="A5.SS3.p1.5.m5.3.3.4" xref="A5.SS3.p1.5.m5.3.3.4.cmml">∈</mo><mrow id="A5.SS3.p1.5.m5.3.3.3.3" xref="A5.SS3.p1.5.m5.3.3.3.4.cmml"><mo stretchy="false" id="A5.SS3.p1.5.m5.3.3.3.3.4" xref="A5.SS3.p1.5.m5.3.3.3.4.cmml">{</mo><mrow id="A5.SS3.p1.5.m5.1.1.1.1.1" xref="A5.SS3.p1.5.m5.1.1.1.1.1.cmml"><mn id="A5.SS3.p1.5.m5.1.1.1.1.1.2" xref="A5.SS3.p1.5.m5.1.1.1.1.1.2.cmml">0</mn><mo id="A5.SS3.p1.5.m5.1.1.1.1.1.1" xref="A5.SS3.p1.5.m5.1.1.1.1.1.1.cmml">%</mo></mrow><mo id="A5.SS3.p1.5.m5.3.3.3.3.5" xref="A5.SS3.p1.5.m5.3.3.3.4.cmml">,</mo><mrow id="A5.SS3.p1.5.m5.2.2.2.2.2" xref="A5.SS3.p1.5.m5.2.2.2.2.2.cmml"><mn id="A5.SS3.p1.5.m5.2.2.2.2.2.2" xref="A5.SS3.p1.5.m5.2.2.2.2.2.2.cmml">50</mn><mo id="A5.SS3.p1.5.m5.2.2.2.2.2.1" xref="A5.SS3.p1.5.m5.2.2.2.2.2.1.cmml">%</mo></mrow><mo id="A5.SS3.p1.5.m5.3.3.3.3.6" xref="A5.SS3.p1.5.m5.3.3.3.4.cmml">,</mo><mrow id="A5.SS3.p1.5.m5.3.3.3.3.3" xref="A5.SS3.p1.5.m5.3.3.3.3.3.cmml"><mn id="A5.SS3.p1.5.m5.3.3.3.3.3.2" xref="A5.SS3.p1.5.m5.3.3.3.3.3.2.cmml">100</mn><mo id="A5.SS3.p1.5.m5.3.3.3.3.3.1" xref="A5.SS3.p1.5.m5.3.3.3.3.3.1.cmml">%</mo></mrow><mo stretchy="false" id="A5.SS3.p1.5.m5.3.3.3.3.7" xref="A5.SS3.p1.5.m5.3.3.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.5.m5.3b"><apply id="A5.SS3.p1.5.m5.3.3.cmml" xref="A5.SS3.p1.5.m5.3.3"><in id="A5.SS3.p1.5.m5.3.3.4.cmml" xref="A5.SS3.p1.5.m5.3.3.4"></in><ci id="A5.SS3.p1.5.m5.3.3.5.cmml" xref="A5.SS3.p1.5.m5.3.3.5">𝑞</ci><set id="A5.SS3.p1.5.m5.3.3.3.4.cmml" xref="A5.SS3.p1.5.m5.3.3.3.3"><apply id="A5.SS3.p1.5.m5.1.1.1.1.1.cmml" xref="A5.SS3.p1.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="A5.SS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="A5.SS3.p1.5.m5.1.1.1.1.1.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.5.m5.1.1.1.1.1.2.cmml" xref="A5.SS3.p1.5.m5.1.1.1.1.1.2">0</cn></apply><apply id="A5.SS3.p1.5.m5.2.2.2.2.2.cmml" xref="A5.SS3.p1.5.m5.2.2.2.2.2"><csymbol cd="latexml" id="A5.SS3.p1.5.m5.2.2.2.2.2.1.cmml" xref="A5.SS3.p1.5.m5.2.2.2.2.2.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.5.m5.2.2.2.2.2.2.cmml" xref="A5.SS3.p1.5.m5.2.2.2.2.2.2">50</cn></apply><apply id="A5.SS3.p1.5.m5.3.3.3.3.3.cmml" xref="A5.SS3.p1.5.m5.3.3.3.3.3"><csymbol cd="latexml" id="A5.SS3.p1.5.m5.3.3.3.3.3.1.cmml" xref="A5.SS3.p1.5.m5.3.3.3.3.3.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.5.m5.3.3.3.3.3.2.cmml" xref="A5.SS3.p1.5.m5.3.3.3.3.3.2">100</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.5.m5.3c">q\in\{0\%,50\%,100\%\}</annotation></semantics></math> in the Food-101 data set and emotion recognition data sets, respectively.
Results are presented in Table <a href="#A4.T3" title="Table 3 ‣ D.3.1 Audio ‣ D.3 Models and Features ‣ Appendix D Experiment Details ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. In general, we observe that fewer the number of edge devices with the shareable data, lower the performance of the global model. However, this decrease is not substantially large; for example, when <math id="A5.SS3.p1.6.m6.1" class="ltx_Math" alttext="q=25\%" display="inline"><semantics id="A5.SS3.p1.6.m6.1a"><mrow id="A5.SS3.p1.6.m6.1.1" xref="A5.SS3.p1.6.m6.1.1.cmml"><mi id="A5.SS3.p1.6.m6.1.1.2" xref="A5.SS3.p1.6.m6.1.1.2.cmml">q</mi><mo id="A5.SS3.p1.6.m6.1.1.1" xref="A5.SS3.p1.6.m6.1.1.1.cmml">=</mo><mrow id="A5.SS3.p1.6.m6.1.1.3" xref="A5.SS3.p1.6.m6.1.1.3.cmml"><mn id="A5.SS3.p1.6.m6.1.1.3.2" xref="A5.SS3.p1.6.m6.1.1.3.2.cmml">25</mn><mo id="A5.SS3.p1.6.m6.1.1.3.1" xref="A5.SS3.p1.6.m6.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS3.p1.6.m6.1b"><apply id="A5.SS3.p1.6.m6.1.1.cmml" xref="A5.SS3.p1.6.m6.1.1"><eq id="A5.SS3.p1.6.m6.1.1.1.cmml" xref="A5.SS3.p1.6.m6.1.1.1"></eq><ci id="A5.SS3.p1.6.m6.1.1.2.cmml" xref="A5.SS3.p1.6.m6.1.1.2">𝑞</ci><apply id="A5.SS3.p1.6.m6.1.1.3.cmml" xref="A5.SS3.p1.6.m6.1.1.3"><csymbol cd="latexml" id="A5.SS3.p1.6.m6.1.1.3.1.cmml" xref="A5.SS3.p1.6.m6.1.1.3.1">percent</csymbol><cn type="integer" id="A5.SS3.p1.6.m6.1.1.3.2.cmml" xref="A5.SS3.p1.6.m6.1.1.3.2">25</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS3.p1.6.m6.1c">q=25\%</annotation></semantics></math>, we find that the top-5 accuracy drops by around 1% in the Food-101 data set. These results suggest that PartialFL is robust to missing modalities in some devices and the performance decrease is not substantial.</p>
</div>
</section>
<section id="A5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.4 </span>Impact of temperature <math id="A5.SS4.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A5.SS4.1.m1.1b"><mi id="A5.SS4.1.m1.1.1" xref="A5.SS4.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A5.SS4.1.m1.1c"><ci id="A5.SS4.1.m1.1.1.cmml" xref="A5.SS4.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS4.1.m1.1d">\tau</annotation></semantics></math>
</h3>

<div id="A5.SS4.p1" class="ltx_para">
<p id="A5.SS4.p1.3" class="ltx_p">The temperature parameter <math id="A5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A5.SS4.p1.1.m1.1a"><mi id="A5.SS4.p1.1.m1.1.1" xref="A5.SS4.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A5.SS4.p1.1.m1.1b"><ci id="A5.SS4.p1.1.m1.1.1.cmml" xref="A5.SS4.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS4.p1.1.m1.1c">\tau</annotation></semantics></math> in the contrastive loss objectives defines the strength of penalties on the hard negative samples and often has a substantial impact on the final model performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. In this study, we examine its impact on PartialFL. Table <a href="#A5.T4" title="Table 4 ‣ E.4 Impact of temperature 𝜏 ‣ Appendix E Additional Results ‣ Partial Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows performances of the uni-modal global model with different temperature parameters in all the datasets we explored.
As we can see from the table, performance differences at different temperature values are close to each other (<math id="A5.SS4.p1.2.m2.1" class="ltx_Math" alttext="&lt;1\%" display="inline"><semantics id="A5.SS4.p1.2.m2.1a"><mrow id="A5.SS4.p1.2.m2.1.1" xref="A5.SS4.p1.2.m2.1.1.cmml"><mi id="A5.SS4.p1.2.m2.1.1.2" xref="A5.SS4.p1.2.m2.1.1.2.cmml"></mi><mo id="A5.SS4.p1.2.m2.1.1.1" xref="A5.SS4.p1.2.m2.1.1.1.cmml">&lt;</mo><mrow id="A5.SS4.p1.2.m2.1.1.3" xref="A5.SS4.p1.2.m2.1.1.3.cmml"><mn id="A5.SS4.p1.2.m2.1.1.3.2" xref="A5.SS4.p1.2.m2.1.1.3.2.cmml">1</mn><mo id="A5.SS4.p1.2.m2.1.1.3.1" xref="A5.SS4.p1.2.m2.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.SS4.p1.2.m2.1b"><apply id="A5.SS4.p1.2.m2.1.1.cmml" xref="A5.SS4.p1.2.m2.1.1"><lt id="A5.SS4.p1.2.m2.1.1.1.cmml" xref="A5.SS4.p1.2.m2.1.1.1"></lt><csymbol cd="latexml" id="A5.SS4.p1.2.m2.1.1.2.cmml" xref="A5.SS4.p1.2.m2.1.1.2">absent</csymbol><apply id="A5.SS4.p1.2.m2.1.1.3.cmml" xref="A5.SS4.p1.2.m2.1.1.3"><csymbol cd="latexml" id="A5.SS4.p1.2.m2.1.1.3.1.cmml" xref="A5.SS4.p1.2.m2.1.1.3.1">percent</csymbol><cn type="integer" id="A5.SS4.p1.2.m2.1.1.3.2.cmml" xref="A5.SS4.p1.2.m2.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.SS4.p1.2.m2.1c">&lt;1\%</annotation></semantics></math>) among all values of <math id="A5.SS4.p1.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A5.SS4.p1.3.m3.1a"><mi id="A5.SS4.p1.3.m3.1.1" xref="A5.SS4.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="A5.SS4.p1.3.m3.1b"><ci id="A5.SS4.p1.3.m3.1.1.cmml" xref="A5.SS4.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.SS4.p1.3.m3.1c">\tau</annotation></semantics></math>, suggesting that the PartialFL is fairly robust to this hyper-parameter.</p>
</div>
<figure id="A5.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="A5.T4.6.1.1" class="ltx_text ltx_font_bold">Table 4</span>: </span>Ablation study: Impact of temperature (<math id="A5.T4.2.m1.1" class="ltx_Math" alttext="\boldsymbol{\tau}" display="inline"><semantics id="A5.T4.2.m1.1b"><mi id="A5.T4.2.m1.1.1" xref="A5.T4.2.m1.1.1.cmml">𝝉</mi><annotation-xml encoding="MathML-Content" id="A5.T4.2.m1.1c"><ci id="A5.T4.2.m1.1.1.cmml" xref="A5.T4.2.m1.1.1">𝝉</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.2.m1.1d">\boldsymbol{\tau}</annotation></semantics></math>) on the PartialFL algorithm.</figcaption>
<table id="A5.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A5.T4.4.2" class="ltx_tr">
<th id="A5.T4.4.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A5.T4.4.2.3.1" class="ltx_text ltx_font_bold">Model (metric)</span></th>
<th id="A5.T4.4.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A5.T4.4.2.4.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A5.T4.3.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A5.T4.3.1.1.m1.1" class="ltx_Math" alttext="\boldsymbol{\alpha}" display="inline"><semantics id="A5.T4.3.1.1.m1.1a"><mi id="A5.T4.3.1.1.m1.1.1" xref="A5.T4.3.1.1.m1.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="A5.T4.3.1.1.m1.1b"><ci id="A5.T4.3.1.1.m1.1.1.cmml" xref="A5.T4.3.1.1.m1.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.3.1.1.m1.1c">\boldsymbol{\alpha}</annotation></semantics></math></th>
<th id="A5.T4.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A5.T4.4.2.2.m1.1" class="ltx_Math" alttext="\boldsymbol{\tau}" display="inline"><semantics id="A5.T4.4.2.2.m1.1a"><mi id="A5.T4.4.2.2.m1.1.1" xref="A5.T4.4.2.2.m1.1.1.cmml">𝝉</mi><annotation-xml encoding="MathML-Content" id="A5.T4.4.2.2.m1.1b"><ci id="A5.T4.4.2.2.m1.1.1.cmml" xref="A5.T4.4.2.2.m1.1.1">𝝉</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.4.2.2.m1.1c">\boldsymbol{\tau}</annotation></semantics></math></th>
<th id="A5.T4.4.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A5.T4.4.2.5.1" class="ltx_text ltx_font_bold">Score</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A5.T4.4.3.1" class="ltx_tr">
<td id="A5.T4.4.3.1.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="9"><span id="A5.T4.4.3.1.1.1" class="ltx_text">Image (top-5 acc)</span></td>
<td id="A5.T4.4.3.1.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="9"><span id="A5.T4.4.3.1.2.1" class="ltx_text">Food-101</span></td>
<td id="A5.T4.4.3.1.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="A5.T4.4.3.1.3.1" class="ltx_text">1.0</span></td>
<td id="A5.T4.4.3.1.4" class="ltx_td ltx_align_center ltx_border_t">0.05</td>
<td id="A5.T4.4.3.1.5" class="ltx_td ltx_align_center ltx_border_t">53.03%</td>
</tr>
<tr id="A5.T4.4.4.2" class="ltx_tr">
<td id="A5.T4.4.4.2.1" class="ltx_td ltx_align_center ltx_border_t">0.1</td>
<td id="A5.T4.4.4.2.2" class="ltx_td ltx_align_center ltx_border_t">52.67%</td>
</tr>
<tr id="A5.T4.4.5.3" class="ltx_tr">
<td id="A5.T4.4.5.3.1" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="A5.T4.4.5.3.2" class="ltx_td ltx_align_center ltx_border_t">51.95%</td>
</tr>
<tr id="A5.T4.4.6.4" class="ltx_tr">
<td id="A5.T4.4.6.4.1" class="ltx_td ltx_align_center" rowspan="3"><span id="A5.T4.4.6.4.1.1" class="ltx_text">0.5</span></td>
<td id="A5.T4.4.6.4.2" class="ltx_td ltx_align_center ltx_border_t">0.05</td>
<td id="A5.T4.4.6.4.3" class="ltx_td ltx_align_center ltx_border_t">51.2%</td>
</tr>
<tr id="A5.T4.4.7.5" class="ltx_tr">
<td id="A5.T4.4.7.5.1" class="ltx_td ltx_align_center ltx_border_t">0.1</td>
<td id="A5.T4.4.7.5.2" class="ltx_td ltx_align_center ltx_border_t">50.86%</td>
</tr>
<tr id="A5.T4.4.8.6" class="ltx_tr">
<td id="A5.T4.4.8.6.1" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="A5.T4.4.8.6.2" class="ltx_td ltx_align_center ltx_border_t">49.93%</td>
</tr>
<tr id="A5.T4.4.9.7" class="ltx_tr">
<td id="A5.T4.4.9.7.1" class="ltx_td ltx_align_center" rowspan="3"><span id="A5.T4.4.9.7.1.1" class="ltx_text">0.1</span></td>
<td id="A5.T4.4.9.7.2" class="ltx_td ltx_align_center ltx_border_t">0.05</td>
<td id="A5.T4.4.9.7.3" class="ltx_td ltx_align_center ltx_border_t">39.42%</td>
</tr>
<tr id="A5.T4.4.10.8" class="ltx_tr">
<td id="A5.T4.4.10.8.1" class="ltx_td ltx_align_center ltx_border_t">0.1</td>
<td id="A5.T4.4.10.8.2" class="ltx_td ltx_align_center ltx_border_t">39.54%</td>
</tr>
<tr id="A5.T4.4.11.9" class="ltx_tr">
<td id="A5.T4.4.11.9.1" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="A5.T4.4.11.9.2" class="ltx_td ltx_align_center ltx_border_t">39.38%</td>
</tr>
<tr id="A5.T4.4.12.10" class="ltx_tr">
<td id="A5.T4.4.12.10.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="6"><span id="A5.T4.4.12.10.1.1" class="ltx_text">Audio (UAR)</span></td>
<td id="A5.T4.4.12.10.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="A5.T4.4.12.10.2.1" class="ltx_text">IEMOCAP</span></td>
<td id="A5.T4.4.12.10.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="A5.T4.4.12.10.3.1" class="ltx_text">-</span></td>
<td id="A5.T4.4.12.10.4" class="ltx_td ltx_align_center ltx_border_t">0.05</td>
<td id="A5.T4.4.12.10.5" class="ltx_td ltx_align_center ltx_border_t">60.71%</td>
</tr>
<tr id="A5.T4.4.13.11" class="ltx_tr">
<td id="A5.T4.4.13.11.1" class="ltx_td ltx_align_center ltx_border_t">0.1</td>
<td id="A5.T4.4.13.11.2" class="ltx_td ltx_align_center ltx_border_t">61.30%</td>
</tr>
<tr id="A5.T4.4.14.12" class="ltx_tr">
<td id="A5.T4.4.14.12.1" class="ltx_td ltx_align_center ltx_border_t">0.2</td>
<td id="A5.T4.4.14.12.2" class="ltx_td ltx_align_center ltx_border_t">60.52%</td>
</tr>
<tr id="A5.T4.4.15.13" class="ltx_tr">
<td id="A5.T4.4.15.13.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="3"><span id="A5.T4.4.15.13.1.1" class="ltx_text">MSP-Improv</span></td>
<td id="A5.T4.4.15.13.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="3"><span id="A5.T4.4.15.13.2.1" class="ltx_text">-</span></td>
<td id="A5.T4.4.15.13.3" class="ltx_td ltx_align_center ltx_border_t">0.05</td>
<td id="A5.T4.4.15.13.4" class="ltx_td ltx_align_center ltx_border_t">44.68%</td>
</tr>
<tr id="A5.T4.4.16.14" class="ltx_tr">
<td id="A5.T4.4.16.14.1" class="ltx_td ltx_align_center ltx_border_t">0.1</td>
<td id="A5.T4.4.16.14.2" class="ltx_td ltx_align_center ltx_border_t">44.81%</td>
</tr>
<tr id="A5.T4.4.17.15" class="ltx_tr">
<td id="A5.T4.4.17.15.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.2</td>
<td id="A5.T4.4.17.15.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">45.14%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.01613" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.01615" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.01615">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.01615" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.01616" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 14:40:43 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
