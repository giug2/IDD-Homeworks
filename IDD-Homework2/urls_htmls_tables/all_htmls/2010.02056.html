<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2010.02056] Specialized federated learning using a mixture of experts</title><meta property="og:description" content="In federated learning, clients share a global model that has been trained on decentralized local client data. Although federated learning shows significant promise as a key approach when data cannot be shared or centra…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Specialized federated learning using a mixture of experts">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Specialized federated learning using a mixture of experts">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2010.02056">

<!--Generated on Thu Mar 14 10:51:17 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Specialized federated learning using a mixture of experts</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Edvin Listo Zec
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Olof Mogren
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">John Martinsson
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Leon René Sütfeld
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Daniel Gillblad
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In federated learning, clients share a global model that has been trained on decentralized local client data. Although federated learning shows significant promise as a key approach when data cannot be shared or centralized, current methods show limited privacy properties and have shortcomings when applied to common real-world scenarios, especially when client data is heterogeneous. In this paper, we propose an alternative method to learn a personalized model for each client in a federated setting, with greater generalization abilities than previous methods. To achieve this personalization we propose a federated learning framework using a mixture of experts to combine the specialist nature of a locally trained model with the generalist knowledge of a global model. We evaluate our method on a variety of datasets with different levels of data heterogeneity, and our results show that the mixture of experts model is better suited as a personalized model for devices in these settings, outperforming both fine-tuned global models and local specialists.</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In many real-world scenarios, data is distributed over a large number of devices or across many organizations, due to privacy concerns or communication limitations. Federated learning is a framework that can leverage this data in a distributed learning setup. This allows for the use of all participating clients’ compute power, with the added benefit of a large decentralized training data set, while enhancing privacy and data security.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2010.02056/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="316" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Federated mixtures of experts, consisting of a global model <math id="S1.F1.4.m1.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S1.F1.4.m1.1b"><msub id="S1.F1.4.m1.1.1" xref="S1.F1.4.m1.1.1.cmml"><mi id="S1.F1.4.m1.1.1.2" xref="S1.F1.4.m1.1.1.2.cmml">f</mi><mi id="S1.F1.4.m1.1.1.3" xref="S1.F1.4.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F1.4.m1.1c"><apply id="S1.F1.4.m1.1.1.cmml" xref="S1.F1.4.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.4.m1.1.1.1.cmml" xref="S1.F1.4.m1.1.1">subscript</csymbol><ci id="S1.F1.4.m1.1.1.2.cmml" xref="S1.F1.4.m1.1.1.2">𝑓</ci><ci id="S1.F1.4.m1.1.1.3.cmml" xref="S1.F1.4.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.4.m1.1d">f_{g}</annotation></semantics></math> and local specialist models <math id="S1.F1.5.m2.1" class="ltx_Math" alttext="f^{k}_{s}" display="inline"><semantics id="S1.F1.5.m2.1b"><msubsup id="S1.F1.5.m2.1.1" xref="S1.F1.5.m2.1.1.cmml"><mi id="S1.F1.5.m2.1.1.2.2" xref="S1.F1.5.m2.1.1.2.2.cmml">f</mi><mi id="S1.F1.5.m2.1.1.3" xref="S1.F1.5.m2.1.1.3.cmml">s</mi><mi id="S1.F1.5.m2.1.1.2.3" xref="S1.F1.5.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S1.F1.5.m2.1c"><apply id="S1.F1.5.m2.1.1.cmml" xref="S1.F1.5.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.5.m2.1.1.1.cmml" xref="S1.F1.5.m2.1.1">subscript</csymbol><apply id="S1.F1.5.m2.1.1.2.cmml" xref="S1.F1.5.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.5.m2.1.1.2.1.cmml" xref="S1.F1.5.m2.1.1">superscript</csymbol><ci id="S1.F1.5.m2.1.1.2.2.cmml" xref="S1.F1.5.m2.1.1.2.2">𝑓</ci><ci id="S1.F1.5.m2.1.1.2.3.cmml" xref="S1.F1.5.m2.1.1.2.3">𝑘</ci></apply><ci id="S1.F1.5.m2.1.1.3.cmml" xref="S1.F1.5.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m2.1d">f^{k}_{s}</annotation></semantics></math> using local gating functions <math id="S1.F1.6.m3.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S1.F1.6.m3.1b"><msup id="S1.F1.6.m3.1.1" xref="S1.F1.6.m3.1.1.cmml"><mi id="S1.F1.6.m3.1.1.2" xref="S1.F1.6.m3.1.1.2.cmml">h</mi><mi id="S1.F1.6.m3.1.1.3" xref="S1.F1.6.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S1.F1.6.m3.1c"><apply id="S1.F1.6.m3.1.1.cmml" xref="S1.F1.6.m3.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m3.1.1.1.cmml" xref="S1.F1.6.m3.1.1">superscript</csymbol><ci id="S1.F1.6.m3.1.1.2.cmml" xref="S1.F1.6.m3.1.1.2">ℎ</ci><ci id="S1.F1.6.m3.1.1.3.cmml" xref="S1.F1.6.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m3.1d">h^{k}</annotation></semantics></math>. Some clients opt-out from federation, not contributing to the global model and keeping their data completely private.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">For instance, in keyboard prediction for smartphones, thousands or even millions of users produce keyboard input that can be leveraged as training data. The training can ensue directly on the devices, doing away with the need for costly data transfer, storage, and immense compute on a central server <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib8" title="" class="ltx_ref">2018</a>)</cite>. The medical field is another example area where data is often extremely sensitive and cannot be shared externally, thus requiring distributed and privacy-protecting approaches.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.14" class="ltx_p">The optimization problem that we solve in a federated learning setting is</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1.6" class="ltx_Math" alttext="\min_{w\in\mathbb{R}^{d}}\frac{1}{K}\sum_{k=1}^{K}\mathbb{E}_{(x,y)\sim p_{k}}\left[\ell_{k}(w;\;x,y)\right]" display="block"><semantics id="S1.E1.m1.6a"><mrow id="S1.E1.m1.6.6" xref="S1.E1.m1.6.6.cmml"><mrow id="S1.E1.m1.6.6.3" xref="S1.E1.m1.6.6.3.cmml"><munder id="S1.E1.m1.6.6.3.1" xref="S1.E1.m1.6.6.3.1.cmml"><mi id="S1.E1.m1.6.6.3.1.2" xref="S1.E1.m1.6.6.3.1.2.cmml">min</mi><mrow id="S1.E1.m1.6.6.3.1.3" xref="S1.E1.m1.6.6.3.1.3.cmml"><mi id="S1.E1.m1.6.6.3.1.3.2" xref="S1.E1.m1.6.6.3.1.3.2.cmml">w</mi><mo id="S1.E1.m1.6.6.3.1.3.1" xref="S1.E1.m1.6.6.3.1.3.1.cmml">∈</mo><msup id="S1.E1.m1.6.6.3.1.3.3" xref="S1.E1.m1.6.6.3.1.3.3.cmml"><mi id="S1.E1.m1.6.6.3.1.3.3.2" xref="S1.E1.m1.6.6.3.1.3.3.2.cmml">ℝ</mi><mi id="S1.E1.m1.6.6.3.1.3.3.3" xref="S1.E1.m1.6.6.3.1.3.3.3.cmml">d</mi></msup></mrow></munder><mo lspace="0.167em" id="S1.E1.m1.6.6.3a" xref="S1.E1.m1.6.6.3.cmml">⁡</mo><mfrac id="S1.E1.m1.6.6.3.2" xref="S1.E1.m1.6.6.3.2.cmml"><mn id="S1.E1.m1.6.6.3.2.2" xref="S1.E1.m1.6.6.3.2.2.cmml">1</mn><mi id="S1.E1.m1.6.6.3.2.3" xref="S1.E1.m1.6.6.3.2.3.cmml">K</mi></mfrac></mrow><mo lspace="0em" rspace="0em" id="S1.E1.m1.6.6.2" xref="S1.E1.m1.6.6.2.cmml">​</mo><mrow id="S1.E1.m1.6.6.1" xref="S1.E1.m1.6.6.1.cmml"><munderover id="S1.E1.m1.6.6.1.2" xref="S1.E1.m1.6.6.1.2.cmml"><mo movablelimits="false" id="S1.E1.m1.6.6.1.2.2.2" xref="S1.E1.m1.6.6.1.2.2.2.cmml">∑</mo><mrow id="S1.E1.m1.6.6.1.2.2.3" xref="S1.E1.m1.6.6.1.2.2.3.cmml"><mi id="S1.E1.m1.6.6.1.2.2.3.2" xref="S1.E1.m1.6.6.1.2.2.3.2.cmml">k</mi><mo id="S1.E1.m1.6.6.1.2.2.3.1" xref="S1.E1.m1.6.6.1.2.2.3.1.cmml">=</mo><mn id="S1.E1.m1.6.6.1.2.2.3.3" xref="S1.E1.m1.6.6.1.2.2.3.3.cmml">1</mn></mrow><mi id="S1.E1.m1.6.6.1.2.3" xref="S1.E1.m1.6.6.1.2.3.cmml">K</mi></munderover><mrow id="S1.E1.m1.6.6.1.1" xref="S1.E1.m1.6.6.1.1.cmml"><msub id="S1.E1.m1.6.6.1.1.3" xref="S1.E1.m1.6.6.1.1.3.cmml"><mi id="S1.E1.m1.6.6.1.1.3.2" xref="S1.E1.m1.6.6.1.1.3.2.cmml">𝔼</mi><mrow id="S1.E1.m1.2.2.2" xref="S1.E1.m1.2.2.2.cmml"><mrow id="S1.E1.m1.2.2.2.4.2" xref="S1.E1.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S1.E1.m1.2.2.2.4.2.1" xref="S1.E1.m1.2.2.2.4.1.cmml">(</mo><mi id="S1.E1.m1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.cmml">x</mi><mo id="S1.E1.m1.2.2.2.4.2.2" xref="S1.E1.m1.2.2.2.4.1.cmml">,</mo><mi id="S1.E1.m1.2.2.2.2" xref="S1.E1.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S1.E1.m1.2.2.2.4.2.3" xref="S1.E1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S1.E1.m1.2.2.2.3" xref="S1.E1.m1.2.2.2.3.cmml">∼</mo><msub id="S1.E1.m1.2.2.2.5" xref="S1.E1.m1.2.2.2.5.cmml"><mi id="S1.E1.m1.2.2.2.5.2" xref="S1.E1.m1.2.2.2.5.2.cmml">p</mi><mi id="S1.E1.m1.2.2.2.5.3" xref="S1.E1.m1.2.2.2.5.3.cmml">k</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.6.6.1.1.2" xref="S1.E1.m1.6.6.1.1.2.cmml">​</mo><mrow id="S1.E1.m1.6.6.1.1.1.1" xref="S1.E1.m1.6.6.1.1.1.2.cmml"><mo id="S1.E1.m1.6.6.1.1.1.1.2" xref="S1.E1.m1.6.6.1.1.1.2.1.cmml">[</mo><mrow id="S1.E1.m1.6.6.1.1.1.1.1" xref="S1.E1.m1.6.6.1.1.1.1.1.cmml"><msub id="S1.E1.m1.6.6.1.1.1.1.1.2" xref="S1.E1.m1.6.6.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S1.E1.m1.6.6.1.1.1.1.1.2.2" xref="S1.E1.m1.6.6.1.1.1.1.1.2.2.cmml">ℓ</mi><mi id="S1.E1.m1.6.6.1.1.1.1.1.2.3" xref="S1.E1.m1.6.6.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S1.E1.m1.6.6.1.1.1.1.1.1" xref="S1.E1.m1.6.6.1.1.1.1.1.1.cmml">​</mo><mrow id="S1.E1.m1.6.6.1.1.1.1.1.3.2" xref="S1.E1.m1.6.6.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S1.E1.m1.6.6.1.1.1.1.1.3.2.1" xref="S1.E1.m1.6.6.1.1.1.1.1.3.1.cmml">(</mo><mi id="S1.E1.m1.3.3" xref="S1.E1.m1.3.3.cmml">w</mi><mo rspace="0.447em" id="S1.E1.m1.6.6.1.1.1.1.1.3.2.2" xref="S1.E1.m1.6.6.1.1.1.1.1.3.1.cmml">;</mo><mi id="S1.E1.m1.4.4" xref="S1.E1.m1.4.4.cmml">x</mi><mo id="S1.E1.m1.6.6.1.1.1.1.1.3.2.3" xref="S1.E1.m1.6.6.1.1.1.1.1.3.1.cmml">,</mo><mi id="S1.E1.m1.5.5" xref="S1.E1.m1.5.5.cmml">y</mi><mo stretchy="false" id="S1.E1.m1.6.6.1.1.1.1.1.3.2.4" xref="S1.E1.m1.6.6.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S1.E1.m1.6.6.1.1.1.1.3" xref="S1.E1.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.6b"><apply id="S1.E1.m1.6.6.cmml" xref="S1.E1.m1.6.6"><times id="S1.E1.m1.6.6.2.cmml" xref="S1.E1.m1.6.6.2"></times><apply id="S1.E1.m1.6.6.3.cmml" xref="S1.E1.m1.6.6.3"><apply id="S1.E1.m1.6.6.3.1.cmml" xref="S1.E1.m1.6.6.3.1"><csymbol cd="ambiguous" id="S1.E1.m1.6.6.3.1.1.cmml" xref="S1.E1.m1.6.6.3.1">subscript</csymbol><min id="S1.E1.m1.6.6.3.1.2.cmml" xref="S1.E1.m1.6.6.3.1.2"></min><apply id="S1.E1.m1.6.6.3.1.3.cmml" xref="S1.E1.m1.6.6.3.1.3"><in id="S1.E1.m1.6.6.3.1.3.1.cmml" xref="S1.E1.m1.6.6.3.1.3.1"></in><ci id="S1.E1.m1.6.6.3.1.3.2.cmml" xref="S1.E1.m1.6.6.3.1.3.2">𝑤</ci><apply id="S1.E1.m1.6.6.3.1.3.3.cmml" xref="S1.E1.m1.6.6.3.1.3.3"><csymbol cd="ambiguous" id="S1.E1.m1.6.6.3.1.3.3.1.cmml" xref="S1.E1.m1.6.6.3.1.3.3">superscript</csymbol><ci id="S1.E1.m1.6.6.3.1.3.3.2.cmml" xref="S1.E1.m1.6.6.3.1.3.3.2">ℝ</ci><ci id="S1.E1.m1.6.6.3.1.3.3.3.cmml" xref="S1.E1.m1.6.6.3.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="S1.E1.m1.6.6.3.2.cmml" xref="S1.E1.m1.6.6.3.2"><divide id="S1.E1.m1.6.6.3.2.1.cmml" xref="S1.E1.m1.6.6.3.2"></divide><cn type="integer" id="S1.E1.m1.6.6.3.2.2.cmml" xref="S1.E1.m1.6.6.3.2.2">1</cn><ci id="S1.E1.m1.6.6.3.2.3.cmml" xref="S1.E1.m1.6.6.3.2.3">𝐾</ci></apply></apply><apply id="S1.E1.m1.6.6.1.cmml" xref="S1.E1.m1.6.6.1"><apply id="S1.E1.m1.6.6.1.2.cmml" xref="S1.E1.m1.6.6.1.2"><csymbol cd="ambiguous" id="S1.E1.m1.6.6.1.2.1.cmml" xref="S1.E1.m1.6.6.1.2">superscript</csymbol><apply id="S1.E1.m1.6.6.1.2.2.cmml" xref="S1.E1.m1.6.6.1.2"><csymbol cd="ambiguous" id="S1.E1.m1.6.6.1.2.2.1.cmml" xref="S1.E1.m1.6.6.1.2">subscript</csymbol><sum id="S1.E1.m1.6.6.1.2.2.2.cmml" xref="S1.E1.m1.6.6.1.2.2.2"></sum><apply id="S1.E1.m1.6.6.1.2.2.3.cmml" xref="S1.E1.m1.6.6.1.2.2.3"><eq id="S1.E1.m1.6.6.1.2.2.3.1.cmml" xref="S1.E1.m1.6.6.1.2.2.3.1"></eq><ci id="S1.E1.m1.6.6.1.2.2.3.2.cmml" xref="S1.E1.m1.6.6.1.2.2.3.2">𝑘</ci><cn type="integer" id="S1.E1.m1.6.6.1.2.2.3.3.cmml" xref="S1.E1.m1.6.6.1.2.2.3.3">1</cn></apply></apply><ci id="S1.E1.m1.6.6.1.2.3.cmml" xref="S1.E1.m1.6.6.1.2.3">𝐾</ci></apply><apply id="S1.E1.m1.6.6.1.1.cmml" xref="S1.E1.m1.6.6.1.1"><times id="S1.E1.m1.6.6.1.1.2.cmml" xref="S1.E1.m1.6.6.1.1.2"></times><apply id="S1.E1.m1.6.6.1.1.3.cmml" xref="S1.E1.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S1.E1.m1.6.6.1.1.3.1.cmml" xref="S1.E1.m1.6.6.1.1.3">subscript</csymbol><ci id="S1.E1.m1.6.6.1.1.3.2.cmml" xref="S1.E1.m1.6.6.1.1.3.2">𝔼</ci><apply id="S1.E1.m1.2.2.2.cmml" xref="S1.E1.m1.2.2.2"><csymbol cd="latexml" id="S1.E1.m1.2.2.2.3.cmml" xref="S1.E1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S1.E1.m1.2.2.2.4.1.cmml" xref="S1.E1.m1.2.2.2.4.2"><ci id="S1.E1.m1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1">𝑥</ci><ci id="S1.E1.m1.2.2.2.2.cmml" xref="S1.E1.m1.2.2.2.2">𝑦</ci></interval><apply id="S1.E1.m1.2.2.2.5.cmml" xref="S1.E1.m1.2.2.2.5"><csymbol cd="ambiguous" id="S1.E1.m1.2.2.2.5.1.cmml" xref="S1.E1.m1.2.2.2.5">subscript</csymbol><ci id="S1.E1.m1.2.2.2.5.2.cmml" xref="S1.E1.m1.2.2.2.5.2">𝑝</ci><ci id="S1.E1.m1.2.2.2.5.3.cmml" xref="S1.E1.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply><apply id="S1.E1.m1.6.6.1.1.1.2.cmml" xref="S1.E1.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S1.E1.m1.6.6.1.1.1.2.1.cmml" xref="S1.E1.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S1.E1.m1.6.6.1.1.1.1.1.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1"><times id="S1.E1.m1.6.6.1.1.1.1.1.1.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1.1"></times><apply id="S1.E1.m1.6.6.1.1.1.1.1.2.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E1.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1.2">subscript</csymbol><ci id="S1.E1.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1.2.2">ℓ</ci><ci id="S1.E1.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1.2.3">𝑘</ci></apply><list id="S1.E1.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S1.E1.m1.6.6.1.1.1.1.1.3.2"><ci id="S1.E1.m1.3.3.cmml" xref="S1.E1.m1.3.3">𝑤</ci><ci id="S1.E1.m1.4.4.cmml" xref="S1.E1.m1.4.4">𝑥</ci><ci id="S1.E1.m1.5.5.cmml" xref="S1.E1.m1.5.5">𝑦</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.6c">\min_{w\in\mathbb{R}^{d}}\frac{1}{K}\sum_{k=1}^{K}\mathbb{E}_{(x,y)\sim p_{k}}\left[\ell_{k}(w;\;x,y)\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S1.p3.10" class="ltx_p">where <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi mathvariant="normal" id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">ℓ</mi><mi id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">ℓ</ci><ci id="S1.p3.1.m1.1.1.3.cmml" xref="S1.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">\ell_{k}</annotation></semantics></math> is the loss for client <math id="S1.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.p3.2.m2.1a"><mi id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><ci id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">k</annotation></semantics></math> and <math id="S1.p3.3.m3.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S1.p3.3.m3.2a"><mrow id="S1.p3.3.m3.2.3.2" xref="S1.p3.3.m3.2.3.1.cmml"><mo stretchy="false" id="S1.p3.3.m3.2.3.2.1" xref="S1.p3.3.m3.2.3.1.cmml">(</mo><mi id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml">x</mi><mo id="S1.p3.3.m3.2.3.2.2" xref="S1.p3.3.m3.2.3.1.cmml">,</mo><mi id="S1.p3.3.m3.2.2" xref="S1.p3.3.m3.2.2.cmml">y</mi><mo stretchy="false" id="S1.p3.3.m3.2.3.2.3" xref="S1.p3.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.2b"><interval closure="open" id="S1.p3.3.m3.2.3.1.cmml" xref="S1.p3.3.m3.2.3.2"><ci id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1">𝑥</ci><ci id="S1.p3.3.m3.2.2.cmml" xref="S1.p3.3.m3.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.2c">(x,y)</annotation></semantics></math> samples from the <math id="S1.p3.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.p3.4.m4.1a"><mi id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><ci id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">k</annotation></semantics></math>th client’s data distribution <math id="S1.p3.5.m5.1" class="ltx_Math" alttext="p_{k}" display="inline"><semantics id="S1.p3.5.m5.1a"><msub id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml"><mi id="S1.p3.5.m5.1.1.2" xref="S1.p3.5.m5.1.1.2.cmml">p</mi><mi id="S1.p3.5.m5.1.1.3" xref="S1.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.1b"><apply id="S1.p3.5.m5.1.1.cmml" xref="S1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S1.p3.5.m5.1.1.1.cmml" xref="S1.p3.5.m5.1.1">subscript</csymbol><ci id="S1.p3.5.m5.1.1.2.cmml" xref="S1.p3.5.m5.1.1.2">𝑝</ci><ci id="S1.p3.5.m5.1.1.3.cmml" xref="S1.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.1c">p_{k}</annotation></semantics></math>. A central server is coordinating training between the <math id="S1.p3.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S1.p3.6.m6.1a"><mi id="S1.p3.6.m6.1.1" xref="S1.p3.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p3.6.m6.1b"><ci id="S1.p3.6.m6.1.1.cmml" xref="S1.p3.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.6.m6.1c">K</annotation></semantics></math> local clients. The most prevalent algorithm for solving this optimization is the federated averaging (<span id="S1.p3.10.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>) algorithm <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>. In this solution, each client has its own client model, parameterized by <math id="S1.p3.7.m7.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="S1.p3.7.m7.1a"><msup id="S1.p3.7.m7.1.1" xref="S1.p3.7.m7.1.1.cmml"><mi id="S1.p3.7.m7.1.1.2" xref="S1.p3.7.m7.1.1.2.cmml">w</mi><mi id="S1.p3.7.m7.1.1.3" xref="S1.p3.7.m7.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S1.p3.7.m7.1b"><apply id="S1.p3.7.m7.1.1.cmml" xref="S1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S1.p3.7.m7.1.1.1.cmml" xref="S1.p3.7.m7.1.1">superscript</csymbol><ci id="S1.p3.7.m7.1.1.2.cmml" xref="S1.p3.7.m7.1.1.2">𝑤</ci><ci id="S1.p3.7.m7.1.1.3.cmml" xref="S1.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.7.m7.1c">w^{k}</annotation></semantics></math> which is trained on a local dataset for <math id="S1.p3.8.m8.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S1.p3.8.m8.1a"><mi id="S1.p3.8.m8.1.1" xref="S1.p3.8.m8.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S1.p3.8.m8.1b"><ci id="S1.p3.8.m8.1.1.cmml" xref="S1.p3.8.m8.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.8.m8.1c">E</annotation></semantics></math> local epochs. When all clients have completed the training, their weights are sent to the central server where they are aggregated into a global model, parameterized by <math id="S1.p3.9.m9.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S1.p3.9.m9.1a"><msub id="S1.p3.9.m9.1.1" xref="S1.p3.9.m9.1.1.cmml"><mi id="S1.p3.9.m9.1.1.2" xref="S1.p3.9.m9.1.1.2.cmml">w</mi><mi id="S1.p3.9.m9.1.1.3" xref="S1.p3.9.m9.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.9.m9.1b"><apply id="S1.p3.9.m9.1.1.cmml" xref="S1.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S1.p3.9.m9.1.1.1.cmml" xref="S1.p3.9.m9.1.1">subscript</csymbol><ci id="S1.p3.9.m9.1.1.2.cmml" xref="S1.p3.9.m9.1.1.2">𝑤</ci><ci id="S1.p3.9.m9.1.1.3.cmml" xref="S1.p3.9.m9.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.9.m9.1c">w_{g}</annotation></semantics></math>. In <span id="S1.p3.10.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, the <math id="S1.p3.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.p3.10.m10.1a"><mi id="S1.p3.10.m10.1.1" xref="S1.p3.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p3.10.m10.1b"><ci id="S1.p3.10.m10.1.1.cmml" xref="S1.p3.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.10.m10.1c">k</annotation></semantics></math> client models are combined by parameter averaging, weighted by the size of their respective local datasets:</p>
<table id="S1.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E2.m1.1" class="ltx_Math" alttext="w_{g}^{t+1}\leftarrow\sum_{k}\frac{n_{k}}{n}w^{k}_{t+1}," display="block"><semantics id="S1.E2.m1.1a"><mrow id="S1.E2.m1.1.1.1" xref="S1.E2.m1.1.1.1.1.cmml"><mrow id="S1.E2.m1.1.1.1.1" xref="S1.E2.m1.1.1.1.1.cmml"><msubsup id="S1.E2.m1.1.1.1.1.2" xref="S1.E2.m1.1.1.1.1.2.cmml"><mi id="S1.E2.m1.1.1.1.1.2.2.2" xref="S1.E2.m1.1.1.1.1.2.2.2.cmml">w</mi><mi id="S1.E2.m1.1.1.1.1.2.2.3" xref="S1.E2.m1.1.1.1.1.2.2.3.cmml">g</mi><mrow id="S1.E2.m1.1.1.1.1.2.3" xref="S1.E2.m1.1.1.1.1.2.3.cmml"><mi id="S1.E2.m1.1.1.1.1.2.3.2" xref="S1.E2.m1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S1.E2.m1.1.1.1.1.2.3.1" xref="S1.E2.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S1.E2.m1.1.1.1.1.2.3.3" xref="S1.E2.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo rspace="0.111em" stretchy="false" id="S1.E2.m1.1.1.1.1.1" xref="S1.E2.m1.1.1.1.1.1.cmml">←</mo><mrow id="S1.E2.m1.1.1.1.1.3" xref="S1.E2.m1.1.1.1.1.3.cmml"><munder id="S1.E2.m1.1.1.1.1.3.1" xref="S1.E2.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S1.E2.m1.1.1.1.1.3.1.2" xref="S1.E2.m1.1.1.1.1.3.1.2.cmml">∑</mo><mi id="S1.E2.m1.1.1.1.1.3.1.3" xref="S1.E2.m1.1.1.1.1.3.1.3.cmml">k</mi></munder><mrow id="S1.E2.m1.1.1.1.1.3.2" xref="S1.E2.m1.1.1.1.1.3.2.cmml"><mfrac id="S1.E2.m1.1.1.1.1.3.2.2" xref="S1.E2.m1.1.1.1.1.3.2.2.cmml"><msub id="S1.E2.m1.1.1.1.1.3.2.2.2" xref="S1.E2.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S1.E2.m1.1.1.1.1.3.2.2.2.2" xref="S1.E2.m1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S1.E2.m1.1.1.1.1.3.2.2.2.3" xref="S1.E2.m1.1.1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="S1.E2.m1.1.1.1.1.3.2.2.3" xref="S1.E2.m1.1.1.1.1.3.2.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S1.E2.m1.1.1.1.1.3.2.1" xref="S1.E2.m1.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S1.E2.m1.1.1.1.1.3.2.3" xref="S1.E2.m1.1.1.1.1.3.2.3.cmml"><mi id="S1.E2.m1.1.1.1.1.3.2.3.2.2" xref="S1.E2.m1.1.1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="S1.E2.m1.1.1.1.1.3.2.3.3" xref="S1.E2.m1.1.1.1.1.3.2.3.3.cmml"><mi id="S1.E2.m1.1.1.1.1.3.2.3.3.2" xref="S1.E2.m1.1.1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S1.E2.m1.1.1.1.1.3.2.3.3.1" xref="S1.E2.m1.1.1.1.1.3.2.3.3.1.cmml">+</mo><mn id="S1.E2.m1.1.1.1.1.3.2.3.3.3" xref="S1.E2.m1.1.1.1.1.3.2.3.3.3.cmml">1</mn></mrow><mi id="S1.E2.m1.1.1.1.1.3.2.3.2.3" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S1.E2.m1.1.1.1.2" xref="S1.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.E2.m1.1b"><apply id="S1.E2.m1.1.1.1.1.cmml" xref="S1.E2.m1.1.1.1"><ci id="S1.E2.m1.1.1.1.1.1.cmml" xref="S1.E2.m1.1.1.1.1.1">←</ci><apply id="S1.E2.m1.1.1.1.1.2.cmml" xref="S1.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.2.1.cmml" xref="S1.E2.m1.1.1.1.1.2">superscript</csymbol><apply id="S1.E2.m1.1.1.1.1.2.2.cmml" xref="S1.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.2.2.1.cmml" xref="S1.E2.m1.1.1.1.1.2">subscript</csymbol><ci id="S1.E2.m1.1.1.1.1.2.2.2.cmml" xref="S1.E2.m1.1.1.1.1.2.2.2">𝑤</ci><ci id="S1.E2.m1.1.1.1.1.2.2.3.cmml" xref="S1.E2.m1.1.1.1.1.2.2.3">𝑔</ci></apply><apply id="S1.E2.m1.1.1.1.1.2.3.cmml" xref="S1.E2.m1.1.1.1.1.2.3"><plus id="S1.E2.m1.1.1.1.1.2.3.1.cmml" xref="S1.E2.m1.1.1.1.1.2.3.1"></plus><ci id="S1.E2.m1.1.1.1.1.2.3.2.cmml" xref="S1.E2.m1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S1.E2.m1.1.1.1.1.2.3.3.cmml" xref="S1.E2.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S1.E2.m1.1.1.1.1.3.cmml" xref="S1.E2.m1.1.1.1.1.3"><apply id="S1.E2.m1.1.1.1.1.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.1.1.cmml" xref="S1.E2.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S1.E2.m1.1.1.1.1.3.1.2.cmml" xref="S1.E2.m1.1.1.1.1.3.1.2"></sum><ci id="S1.E2.m1.1.1.1.1.3.1.3.cmml" xref="S1.E2.m1.1.1.1.1.3.1.3">𝑘</ci></apply><apply id="S1.E2.m1.1.1.1.1.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2"><times id="S1.E2.m1.1.1.1.1.3.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.1"></times><apply id="S1.E2.m1.1.1.1.1.3.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2"><divide id="S1.E2.m1.1.1.1.1.3.2.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2"></divide><apply id="S1.E2.m1.1.1.1.1.3.2.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S1.E2.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S1.E2.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="S1.E2.m1.1.1.1.1.3.2.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S1.E2.m1.1.1.1.1.3.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.2.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3">subscript</csymbol><apply id="S1.E2.m1.1.1.1.1.3.2.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S1.E2.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3">superscript</csymbol><ci id="S1.E2.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.2">𝑤</ci><ci id="S1.E2.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.2.3">𝑘</ci></apply><apply id="S1.E2.m1.1.1.1.1.3.2.3.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.3"><plus id="S1.E2.m1.1.1.1.1.3.2.3.3.1.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.3.1"></plus><ci id="S1.E2.m1.1.1.1.1.3.2.3.3.2.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.3.2">𝑡</ci><cn type="integer" id="S1.E2.m1.1.1.1.1.3.2.3.3.3.cmml" xref="S1.E2.m1.1.1.1.1.3.2.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E2.m1.1c">w_{g}^{t+1}\leftarrow\sum_{k}\frac{n_{k}}{n}w^{k}_{t+1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S1.p3.13" class="ltx_p">where <math id="S1.p3.11.m1.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S1.p3.11.m1.1a"><msub id="S1.p3.11.m1.1.1" xref="S1.p3.11.m1.1.1.cmml"><mi id="S1.p3.11.m1.1.1.2" xref="S1.p3.11.m1.1.1.2.cmml">n</mi><mi id="S1.p3.11.m1.1.1.3" xref="S1.p3.11.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S1.p3.11.m1.1b"><apply id="S1.p3.11.m1.1.1.cmml" xref="S1.p3.11.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.11.m1.1.1.1.cmml" xref="S1.p3.11.m1.1.1">subscript</csymbol><ci id="S1.p3.11.m1.1.1.2.cmml" xref="S1.p3.11.m1.1.1.2">𝑛</ci><ci id="S1.p3.11.m1.1.1.3.cmml" xref="S1.p3.11.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.11.m1.1c">n_{k}</annotation></semantics></math> is the size of the dataset of client <math id="S1.p3.12.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S1.p3.12.m2.1a"><mi id="S1.p3.12.m2.1.1" xref="S1.p3.12.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p3.12.m2.1b"><ci id="S1.p3.12.m2.1.1.cmml" xref="S1.p3.12.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.12.m2.1c">k</annotation></semantics></math> and <math id="S1.p3.13.m3.1" class="ltx_Math" alttext="n=\sum_{k}n_{k}" display="inline"><semantics id="S1.p3.13.m3.1a"><mrow id="S1.p3.13.m3.1.1" xref="S1.p3.13.m3.1.1.cmml"><mi id="S1.p3.13.m3.1.1.2" xref="S1.p3.13.m3.1.1.2.cmml">n</mi><mo rspace="0.111em" id="S1.p3.13.m3.1.1.1" xref="S1.p3.13.m3.1.1.1.cmml">=</mo><mrow id="S1.p3.13.m3.1.1.3" xref="S1.p3.13.m3.1.1.3.cmml"><msub id="S1.p3.13.m3.1.1.3.1" xref="S1.p3.13.m3.1.1.3.1.cmml"><mo id="S1.p3.13.m3.1.1.3.1.2" xref="S1.p3.13.m3.1.1.3.1.2.cmml">∑</mo><mi id="S1.p3.13.m3.1.1.3.1.3" xref="S1.p3.13.m3.1.1.3.1.3.cmml">k</mi></msub><msub id="S1.p3.13.m3.1.1.3.2" xref="S1.p3.13.m3.1.1.3.2.cmml"><mi id="S1.p3.13.m3.1.1.3.2.2" xref="S1.p3.13.m3.1.1.3.2.2.cmml">n</mi><mi id="S1.p3.13.m3.1.1.3.2.3" xref="S1.p3.13.m3.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p3.13.m3.1b"><apply id="S1.p3.13.m3.1.1.cmml" xref="S1.p3.13.m3.1.1"><eq id="S1.p3.13.m3.1.1.1.cmml" xref="S1.p3.13.m3.1.1.1"></eq><ci id="S1.p3.13.m3.1.1.2.cmml" xref="S1.p3.13.m3.1.1.2">𝑛</ci><apply id="S1.p3.13.m3.1.1.3.cmml" xref="S1.p3.13.m3.1.1.3"><apply id="S1.p3.13.m3.1.1.3.1.cmml" xref="S1.p3.13.m3.1.1.3.1"><csymbol cd="ambiguous" id="S1.p3.13.m3.1.1.3.1.1.cmml" xref="S1.p3.13.m3.1.1.3.1">subscript</csymbol><sum id="S1.p3.13.m3.1.1.3.1.2.cmml" xref="S1.p3.13.m3.1.1.3.1.2"></sum><ci id="S1.p3.13.m3.1.1.3.1.3.cmml" xref="S1.p3.13.m3.1.1.3.1.3">𝑘</ci></apply><apply id="S1.p3.13.m3.1.1.3.2.cmml" xref="S1.p3.13.m3.1.1.3.2"><csymbol cd="ambiguous" id="S1.p3.13.m3.1.1.3.2.1.cmml" xref="S1.p3.13.m3.1.1.3.2">subscript</csymbol><ci id="S1.p3.13.m3.1.1.3.2.2.cmml" xref="S1.p3.13.m3.1.1.3.2.2">𝑛</ci><ci id="S1.p3.13.m3.1.1.3.2.3.cmml" xref="S1.p3.13.m3.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.13.m3.1c">n=\sum_{k}n_{k}</annotation></semantics></math>. Finally, the new global model is sent out to each client, where it constitutes the starting point for the next round of (local) training. This process is repeated for a defined number of global communication rounds.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The averaging of local models in parameter space generally works but requires some care to be taken in order to ensure convergence. <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> showed that all local models need to be initialized with the same random seed for <span id="S1.p4.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> to work. Extended phases of local training between communication rounds can similarly break training, indicating that the individual client models will over time diverge towards different local minima in the loss landscape. Similarly, different distributions between client datasets will also lead to divergence of client models <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Depending on the use case, however, the existence of local datasets and the option to train models locally can be advantageous: specialized local models, optimized for the data distribution at hand may yield higher performance in the local context than a single global model, although typically at the cost of generalization performance. Keyboard prediction, for example, based on a global model may represent a good approximation of the population average, but could provide a better experience at the hands of a user when biased towards their individual writing style and word choices. This raises an important question – when is a global FL-trained model better than a specialized local model? A specialist would be expected to perform better than a global generalist in a highly non-iid setting, whereas the global generalist would be expected to perform better in an iid setting.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.8" class="ltx_p">There are several ways client distributions can be non-identical. The conditional distributions <math id="S1.p6.1.m1.1" class="ltx_Math" alttext="P_{i}(x|y)" display="inline"><semantics id="S1.p6.1.m1.1a"><mrow id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml"><msub id="S1.p6.1.m1.1.1.3" xref="S1.p6.1.m1.1.1.3.cmml"><mi id="S1.p6.1.m1.1.1.3.2" xref="S1.p6.1.m1.1.1.3.2.cmml">P</mi><mi id="S1.p6.1.m1.1.1.3.3" xref="S1.p6.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.p6.1.m1.1.1.2" xref="S1.p6.1.m1.1.1.2.cmml">​</mo><mrow id="S1.p6.1.m1.1.1.1.1" xref="S1.p6.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.p6.1.m1.1.1.1.1.2" xref="S1.p6.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.1.m1.1.1.1.1.1" xref="S1.p6.1.m1.1.1.1.1.1.cmml"><mi id="S1.p6.1.m1.1.1.1.1.1.2" xref="S1.p6.1.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S1.p6.1.m1.1.1.1.1.1.1" xref="S1.p6.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p6.1.m1.1.1.1.1.1.3" xref="S1.p6.1.m1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S1.p6.1.m1.1.1.1.1.3" xref="S1.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><apply id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1"><times id="S1.p6.1.m1.1.1.2.cmml" xref="S1.p6.1.m1.1.1.2"></times><apply id="S1.p6.1.m1.1.1.3.cmml" xref="S1.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S1.p6.1.m1.1.1.3.1.cmml" xref="S1.p6.1.m1.1.1.3">subscript</csymbol><ci id="S1.p6.1.m1.1.1.3.2.cmml" xref="S1.p6.1.m1.1.1.3.2">𝑃</ci><ci id="S1.p6.1.m1.1.1.3.3.cmml" xref="S1.p6.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S1.p6.1.m1.1.1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1.1"><csymbol cd="latexml" id="S1.p6.1.m1.1.1.1.1.1.1.cmml" xref="S1.p6.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.1.m1.1.1.1.1.1.2.cmml" xref="S1.p6.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S1.p6.1.m1.1.1.1.1.1.3.cmml" xref="S1.p6.1.m1.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">P_{i}(x|y)</annotation></semantics></math> on all clients <math id="S1.p6.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S1.p6.2.m2.1a"><mi id="S1.p6.2.m2.1.1" xref="S1.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S1.p6.2.m2.1b"><ci id="S1.p6.2.m2.1.1.cmml" xref="S1.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.2.m2.1c">i</annotation></semantics></math> may be the same, but the marginal distributions <math id="S1.p6.3.m3.1" class="ltx_Math" alttext="P_{i}(x)" display="inline"><semantics id="S1.p6.3.m3.1a"><mrow id="S1.p6.3.m3.1.2" xref="S1.p6.3.m3.1.2.cmml"><msub id="S1.p6.3.m3.1.2.2" xref="S1.p6.3.m3.1.2.2.cmml"><mi id="S1.p6.3.m3.1.2.2.2" xref="S1.p6.3.m3.1.2.2.2.cmml">P</mi><mi id="S1.p6.3.m3.1.2.2.3" xref="S1.p6.3.m3.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.p6.3.m3.1.2.1" xref="S1.p6.3.m3.1.2.1.cmml">​</mo><mrow id="S1.p6.3.m3.1.2.3.2" xref="S1.p6.3.m3.1.2.cmml"><mo stretchy="false" id="S1.p6.3.m3.1.2.3.2.1" xref="S1.p6.3.m3.1.2.cmml">(</mo><mi id="S1.p6.3.m3.1.1" xref="S1.p6.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S1.p6.3.m3.1.2.3.2.2" xref="S1.p6.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.3.m3.1b"><apply id="S1.p6.3.m3.1.2.cmml" xref="S1.p6.3.m3.1.2"><times id="S1.p6.3.m3.1.2.1.cmml" xref="S1.p6.3.m3.1.2.1"></times><apply id="S1.p6.3.m3.1.2.2.cmml" xref="S1.p6.3.m3.1.2.2"><csymbol cd="ambiguous" id="S1.p6.3.m3.1.2.2.1.cmml" xref="S1.p6.3.m3.1.2.2">subscript</csymbol><ci id="S1.p6.3.m3.1.2.2.2.cmml" xref="S1.p6.3.m3.1.2.2.2">𝑃</ci><ci id="S1.p6.3.m3.1.2.2.3.cmml" xref="S1.p6.3.m3.1.2.2.3">𝑖</ci></apply><ci id="S1.p6.3.m3.1.1.cmml" xref="S1.p6.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.3.m3.1c">P_{i}(x)</annotation></semantics></math> may vary (covariate shift) or <math id="S1.p6.4.m4.1" class="ltx_Math" alttext="P_{i}(y)" display="inline"><semantics id="S1.p6.4.m4.1a"><mrow id="S1.p6.4.m4.1.2" xref="S1.p6.4.m4.1.2.cmml"><msub id="S1.p6.4.m4.1.2.2" xref="S1.p6.4.m4.1.2.2.cmml"><mi id="S1.p6.4.m4.1.2.2.2" xref="S1.p6.4.m4.1.2.2.2.cmml">P</mi><mi id="S1.p6.4.m4.1.2.2.3" xref="S1.p6.4.m4.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.p6.4.m4.1.2.1" xref="S1.p6.4.m4.1.2.1.cmml">​</mo><mrow id="S1.p6.4.m4.1.2.3.2" xref="S1.p6.4.m4.1.2.cmml"><mo stretchy="false" id="S1.p6.4.m4.1.2.3.2.1" xref="S1.p6.4.m4.1.2.cmml">(</mo><mi id="S1.p6.4.m4.1.1" xref="S1.p6.4.m4.1.1.cmml">y</mi><mo stretchy="false" id="S1.p6.4.m4.1.2.3.2.2" xref="S1.p6.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.4.m4.1b"><apply id="S1.p6.4.m4.1.2.cmml" xref="S1.p6.4.m4.1.2"><times id="S1.p6.4.m4.1.2.1.cmml" xref="S1.p6.4.m4.1.2.1"></times><apply id="S1.p6.4.m4.1.2.2.cmml" xref="S1.p6.4.m4.1.2.2"><csymbol cd="ambiguous" id="S1.p6.4.m4.1.2.2.1.cmml" xref="S1.p6.4.m4.1.2.2">subscript</csymbol><ci id="S1.p6.4.m4.1.2.2.2.cmml" xref="S1.p6.4.m4.1.2.2.2">𝑃</ci><ci id="S1.p6.4.m4.1.2.2.3.cmml" xref="S1.p6.4.m4.1.2.2.3">𝑖</ci></apply><ci id="S1.p6.4.m4.1.1.cmml" xref="S1.p6.4.m4.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.4.m4.1c">P_{i}(y)</annotation></semantics></math> may vary (prior probability shift). Further, if the marginal distribution <math id="S1.p6.5.m5.1" class="ltx_Math" alttext="P(y)" display="inline"><semantics id="S1.p6.5.m5.1a"><mrow id="S1.p6.5.m5.1.2" xref="S1.p6.5.m5.1.2.cmml"><mi id="S1.p6.5.m5.1.2.2" xref="S1.p6.5.m5.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S1.p6.5.m5.1.2.1" xref="S1.p6.5.m5.1.2.1.cmml">​</mo><mrow id="S1.p6.5.m5.1.2.3.2" xref="S1.p6.5.m5.1.2.cmml"><mo stretchy="false" id="S1.p6.5.m5.1.2.3.2.1" xref="S1.p6.5.m5.1.2.cmml">(</mo><mi id="S1.p6.5.m5.1.1" xref="S1.p6.5.m5.1.1.cmml">y</mi><mo stretchy="false" id="S1.p6.5.m5.1.2.3.2.2" xref="S1.p6.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.5.m5.1b"><apply id="S1.p6.5.m5.1.2.cmml" xref="S1.p6.5.m5.1.2"><times id="S1.p6.5.m5.1.2.1.cmml" xref="S1.p6.5.m5.1.2.1"></times><ci id="S1.p6.5.m5.1.2.2.cmml" xref="S1.p6.5.m5.1.2.2">𝑃</ci><ci id="S1.p6.5.m5.1.1.cmml" xref="S1.p6.5.m5.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.5.m5.1c">P(y)</annotation></semantics></math> is the same on all clients, the conditional <math id="S1.p6.6.m6.1" class="ltx_Math" alttext="P_{i}(x|y)" display="inline"><semantics id="S1.p6.6.m6.1a"><mrow id="S1.p6.6.m6.1.1" xref="S1.p6.6.m6.1.1.cmml"><msub id="S1.p6.6.m6.1.1.3" xref="S1.p6.6.m6.1.1.3.cmml"><mi id="S1.p6.6.m6.1.1.3.2" xref="S1.p6.6.m6.1.1.3.2.cmml">P</mi><mi id="S1.p6.6.m6.1.1.3.3" xref="S1.p6.6.m6.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.p6.6.m6.1.1.2" xref="S1.p6.6.m6.1.1.2.cmml">​</mo><mrow id="S1.p6.6.m6.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.p6.6.m6.1.1.1.1.2" xref="S1.p6.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.6.m6.1.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.cmml"><mi id="S1.p6.6.m6.1.1.1.1.1.2" xref="S1.p6.6.m6.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S1.p6.6.m6.1.1.1.1.1.1" xref="S1.p6.6.m6.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p6.6.m6.1.1.1.1.1.3" xref="S1.p6.6.m6.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S1.p6.6.m6.1.1.1.1.3" xref="S1.p6.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.6.m6.1b"><apply id="S1.p6.6.m6.1.1.cmml" xref="S1.p6.6.m6.1.1"><times id="S1.p6.6.m6.1.1.2.cmml" xref="S1.p6.6.m6.1.1.2"></times><apply id="S1.p6.6.m6.1.1.3.cmml" xref="S1.p6.6.m6.1.1.3"><csymbol cd="ambiguous" id="S1.p6.6.m6.1.1.3.1.cmml" xref="S1.p6.6.m6.1.1.3">subscript</csymbol><ci id="S1.p6.6.m6.1.1.3.2.cmml" xref="S1.p6.6.m6.1.1.3.2">𝑃</ci><ci id="S1.p6.6.m6.1.1.3.3.cmml" xref="S1.p6.6.m6.1.1.3.3">𝑖</ci></apply><apply id="S1.p6.6.m6.1.1.1.1.1.cmml" xref="S1.p6.6.m6.1.1.1.1"><csymbol cd="latexml" id="S1.p6.6.m6.1.1.1.1.1.1.cmml" xref="S1.p6.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.6.m6.1.1.1.1.1.2.cmml" xref="S1.p6.6.m6.1.1.1.1.1.2">𝑥</ci><ci id="S1.p6.6.m6.1.1.1.1.1.3.cmml" xref="S1.p6.6.m6.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.6.m6.1c">P_{i}(x|y)</annotation></semantics></math> may vary (same label, different features) or <math id="S1.p6.7.m7.1" class="ltx_Math" alttext="P(x)" display="inline"><semantics id="S1.p6.7.m7.1a"><mrow id="S1.p6.7.m7.1.2" xref="S1.p6.7.m7.1.2.cmml"><mi id="S1.p6.7.m7.1.2.2" xref="S1.p6.7.m7.1.2.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S1.p6.7.m7.1.2.1" xref="S1.p6.7.m7.1.2.1.cmml">​</mo><mrow id="S1.p6.7.m7.1.2.3.2" xref="S1.p6.7.m7.1.2.cmml"><mo stretchy="false" id="S1.p6.7.m7.1.2.3.2.1" xref="S1.p6.7.m7.1.2.cmml">(</mo><mi id="S1.p6.7.m7.1.1" xref="S1.p6.7.m7.1.1.cmml">x</mi><mo stretchy="false" id="S1.p6.7.m7.1.2.3.2.2" xref="S1.p6.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.7.m7.1b"><apply id="S1.p6.7.m7.1.2.cmml" xref="S1.p6.7.m7.1.2"><times id="S1.p6.7.m7.1.2.1.cmml" xref="S1.p6.7.m7.1.2.1"></times><ci id="S1.p6.7.m7.1.2.2.cmml" xref="S1.p6.7.m7.1.2.2">𝑃</ci><ci id="S1.p6.7.m7.1.1.cmml" xref="S1.p6.7.m7.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.7.m7.1c">P(x)</annotation></semantics></math> is the same, but the conditional <math id="S1.p6.8.m8.1" class="ltx_Math" alttext="P_{i}(y|x)" display="inline"><semantics id="S1.p6.8.m8.1a"><mrow id="S1.p6.8.m8.1.1" xref="S1.p6.8.m8.1.1.cmml"><msub id="S1.p6.8.m8.1.1.3" xref="S1.p6.8.m8.1.1.3.cmml"><mi id="S1.p6.8.m8.1.1.3.2" xref="S1.p6.8.m8.1.1.3.2.cmml">P</mi><mi id="S1.p6.8.m8.1.1.3.3" xref="S1.p6.8.m8.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S1.p6.8.m8.1.1.2" xref="S1.p6.8.m8.1.1.2.cmml">​</mo><mrow id="S1.p6.8.m8.1.1.1.1" xref="S1.p6.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S1.p6.8.m8.1.1.1.1.2" xref="S1.p6.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S1.p6.8.m8.1.1.1.1.1" xref="S1.p6.8.m8.1.1.1.1.1.cmml"><mi id="S1.p6.8.m8.1.1.1.1.1.2" xref="S1.p6.8.m8.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S1.p6.8.m8.1.1.1.1.1.1" xref="S1.p6.8.m8.1.1.1.1.1.1.cmml">|</mo><mi id="S1.p6.8.m8.1.1.1.1.1.3" xref="S1.p6.8.m8.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S1.p6.8.m8.1.1.1.1.3" xref="S1.p6.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p6.8.m8.1b"><apply id="S1.p6.8.m8.1.1.cmml" xref="S1.p6.8.m8.1.1"><times id="S1.p6.8.m8.1.1.2.cmml" xref="S1.p6.8.m8.1.1.2"></times><apply id="S1.p6.8.m8.1.1.3.cmml" xref="S1.p6.8.m8.1.1.3"><csymbol cd="ambiguous" id="S1.p6.8.m8.1.1.3.1.cmml" xref="S1.p6.8.m8.1.1.3">subscript</csymbol><ci id="S1.p6.8.m8.1.1.3.2.cmml" xref="S1.p6.8.m8.1.1.3.2">𝑃</ci><ci id="S1.p6.8.m8.1.1.3.3.cmml" xref="S1.p6.8.m8.1.1.3.3">𝑖</ci></apply><apply id="S1.p6.8.m8.1.1.1.1.1.cmml" xref="S1.p6.8.m8.1.1.1.1"><csymbol cd="latexml" id="S1.p6.8.m8.1.1.1.1.1.1.cmml" xref="S1.p6.8.m8.1.1.1.1.1.1">conditional</csymbol><ci id="S1.p6.8.m8.1.1.1.1.1.2.cmml" xref="S1.p6.8.m8.1.1.1.1.1.2">𝑦</ci><ci id="S1.p6.8.m8.1.1.1.1.1.3.cmml" xref="S1.p6.8.m8.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.8.m8.1c">P_{i}(y|x)</annotation></semantics></math> varies (same features, different label). In this work we study non-identical distributions in the form of prior probability shift, although we hypothesize that our proposed method can handle other distributional shifts as well and would be an interesting direction for future work.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">To address the issue of specialized local models within the federated learning setting, we propose a general framework based on a mixture of experts <cite class="ltx_cite ltx_citemacro_citep">(Jacobs et al., <a href="#bib.bib12" title="" class="ltx_ref">1991</a>)</cite>. In this work we have one mixture of experts per client, each combining one local specialist model and one global model. Each client has a local <span id="S1.p7.1.1" class="ltx_text ltx_font_italic">gating function</span> that performs a weighting of the experts dependent on the input data. First, the global model is trained using <span id="S1.p7.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. This is followed by training of all clients’ local specialist models, initialized with the trained federated global model. This is followed by training of the entire mixture, i.e., the local and global models as well as the gating function. A common problem with fine-tuned specialist models is that although they achieve better accuracy on local test data, they do not generalize as well as a global model. However, in our work we show that we can reach the same local accuracy on client data as a fine-tuned model, while retaining superior generalization performance.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">While standard federated learning already shows some privacy enhancing properties, it has been shown that in some settings, properties of the client and of the training data may be reconstructed from the gradients communicated to the server <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite>. Therefore, we will work with a stronger notion of privacy in this paper. While existing solutions may be private enough for some settings, we will assume that clients requiring privacy for some of their data need this data not to have any influence on the training of the global model at all. Instead, our framework allows for a complete opt-out from the federation with some or all of the data for any client.
Clients with such preferences will still benefit from the global model and retain a high level of performance on their own, skewed data distribution. This is important when local datasets are particularly sensitive, as may be the case in medical applications.
Our experimental evaluations demonstrate the robustness of our learning framework with different levels of label heterogeneity in the data, and under varying fractions of opt-out clients.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Distributed machine learning
has been studied as a strategy to allow for training data to remain on the clients, giving it some aspects of privacy, while leveraging the power
of learning from bigger data and compute <cite class="ltx_cite ltx_citemacro_citep">(Konečnỳ et al., <a href="#bib.bib18" title="" class="ltx_ref">2016</a>; Shokri &amp; Shmatikov, <a href="#bib.bib25" title="" class="ltx_ref">2015</a>; McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>; Vanhaesebrouck et al., <a href="#bib.bib26" title="" class="ltx_ref">2017</a>; Bellet et al., <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite>.
The federated averaging algorithm <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>
has been influential and demonstrated that averaging of the weights in neural network models
trained separately at the clients is successful in many settings, producing a federated
model that demonstrates the ability to generalize from limited subsets of data at the
clients. However, it has been shown that federated averaging struggles when data is not
independent and identically distributed among the clients, e.g., in the problem of prior probability shift. This illustrates the need for client personalization within federated learning <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib16" title="" class="ltx_ref">2019</a>; Hsieh et al., <a href="#bib.bib10" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">In general, addressing class imbalance is still a relatively
understudied problem in deep learning <cite class="ltx_cite ltx_citemacro_citep">(Johnson &amp; Khoshgoftaar, <a href="#bib.bib15" title="" class="ltx_ref">2019</a>)</cite>.
A common approach for personalization on skewed label distributions is to first train a generalist model and then fine-tune it using more specific data. This approach is used in meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Finn et al., <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>,
domain adaptation <cite class="ltx_cite ltx_citemacro_citep">(Mansour et al., <a href="#bib.bib21" title="" class="ltx_ref">2009</a>)</cite>, and transfer learning <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al., <a href="#bib.bib23" title="" class="ltx_ref">2014</a>)</cite>.
For the distributed setting, fine-tuning was first proposed by
<cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite> who used federated averaging
to obtain a generalist model which was later fine-tuned
locally on each client, using each client’s specific training data.
Some work has been inspired by the meta-learning paradigm to learn models that are specialized at the clients <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>; Fallah et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>.
<cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> combined this strategy and ideas from transfer learning with deep neural networks and presented a solution where shallow layers are frozen, and the deeper layers are retrained at every client.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib31" title="" class="ltx_ref">2018</a>)</cite> propose a strategy to improve training on non-iid client data by creating a subset of data which is globally shared between all clients. <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> show that performance degrades when client distributions shift, and propose to solve the problem via server momentum.
Recent strategies have also explored knowledge distillation techniques for federated learning <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2018</a>; He et al., <a href="#bib.bib9" title="" class="ltx_ref">2020</a>; Lin et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>, which show promising results in non-iid settings.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.5" class="ltx_p"><span id="S2.p4.5.1" class="ltx_text ltx_font_bold">Mixing models.</span> <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> proposed to combine a global model <math id="S2.p4.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">w</annotation></semantics></math> trained using federated averaging, with a local model <math id="S2.p4.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S2.p4.2.m2.1a"><mi id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">v</annotation></semantics></math> with a weight <math id="S2.p4.3.m3.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S2.p4.3.m3.1a"><msub id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">α</mi><mi id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.1.cmml" xref="S2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1.2">𝛼</ci><ci id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">\alpha_{i}</annotation></semantics></math>. To find optimal <math id="S2.p4.4.m4.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="S2.p4.4.m4.1a"><msub id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml"><mi id="S2.p4.4.m4.1.1.2" xref="S2.p4.4.m4.1.1.2.cmml">α</mi><mi id="S2.p4.4.m4.1.1.3" xref="S2.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><apply id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p4.4.m4.1.1.1.cmml" xref="S2.p4.4.m4.1.1">subscript</csymbol><ci id="S2.p4.4.m4.1.1.2.cmml" xref="S2.p4.4.m4.1.1.2">𝛼</ci><ci id="S2.p4.4.m4.1.1.3.cmml" xref="S2.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">\alpha_{i}</annotation></semantics></math> they optimize <math id="S2.p4.5.m5.3" class="ltx_Math" alttext="\alpha_{i}^{*}=\arg\min_{\alpha_{i}\in[0,1]}f_{i}\left(\alpha_{i}\bm{v}+\left(1-\alpha_{i}\right)\bm{w}\right)" display="inline"><semantics id="S2.p4.5.m5.3a"><mrow id="S2.p4.5.m5.3.3" xref="S2.p4.5.m5.3.3.cmml"><msubsup id="S2.p4.5.m5.3.3.3" xref="S2.p4.5.m5.3.3.3.cmml"><mi id="S2.p4.5.m5.3.3.3.2.2" xref="S2.p4.5.m5.3.3.3.2.2.cmml">α</mi><mi id="S2.p4.5.m5.3.3.3.2.3" xref="S2.p4.5.m5.3.3.3.2.3.cmml">i</mi><mo id="S2.p4.5.m5.3.3.3.3" xref="S2.p4.5.m5.3.3.3.3.cmml">∗</mo></msubsup><mo id="S2.p4.5.m5.3.3.2" xref="S2.p4.5.m5.3.3.2.cmml">=</mo><mrow id="S2.p4.5.m5.3.3.1" xref="S2.p4.5.m5.3.3.1.cmml"><mrow id="S2.p4.5.m5.3.3.1.3" xref="S2.p4.5.m5.3.3.1.3.cmml"><mi id="S2.p4.5.m5.3.3.1.3.1" xref="S2.p4.5.m5.3.3.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S2.p4.5.m5.3.3.1.3a" xref="S2.p4.5.m5.3.3.1.3.cmml">⁡</mo><mrow id="S2.p4.5.m5.3.3.1.3.2" xref="S2.p4.5.m5.3.3.1.3.2.cmml"><msub id="S2.p4.5.m5.3.3.1.3.2.1" xref="S2.p4.5.m5.3.3.1.3.2.1.cmml"><mi id="S2.p4.5.m5.3.3.1.3.2.1.2" xref="S2.p4.5.m5.3.3.1.3.2.1.2.cmml">min</mi><mrow id="S2.p4.5.m5.2.2.2" xref="S2.p4.5.m5.2.2.2.cmml"><msub id="S2.p4.5.m5.2.2.2.4" xref="S2.p4.5.m5.2.2.2.4.cmml"><mi id="S2.p4.5.m5.2.2.2.4.2" xref="S2.p4.5.m5.2.2.2.4.2.cmml">α</mi><mi id="S2.p4.5.m5.2.2.2.4.3" xref="S2.p4.5.m5.2.2.2.4.3.cmml">i</mi></msub><mo id="S2.p4.5.m5.2.2.2.3" xref="S2.p4.5.m5.2.2.2.3.cmml">∈</mo><mrow id="S2.p4.5.m5.2.2.2.5.2" xref="S2.p4.5.m5.2.2.2.5.1.cmml"><mo stretchy="false" id="S2.p4.5.m5.2.2.2.5.2.1" xref="S2.p4.5.m5.2.2.2.5.1.cmml">[</mo><mn id="S2.p4.5.m5.1.1.1.1" xref="S2.p4.5.m5.1.1.1.1.cmml">0</mn><mo id="S2.p4.5.m5.2.2.2.5.2.2" xref="S2.p4.5.m5.2.2.2.5.1.cmml">,</mo><mn id="S2.p4.5.m5.2.2.2.2" xref="S2.p4.5.m5.2.2.2.2.cmml">1</mn><mo stretchy="false" id="S2.p4.5.m5.2.2.2.5.2.3" xref="S2.p4.5.m5.2.2.2.5.1.cmml">]</mo></mrow></mrow></msub><mo lspace="0.167em" id="S2.p4.5.m5.3.3.1.3.2a" xref="S2.p4.5.m5.3.3.1.3.2.cmml">⁡</mo><msub id="S2.p4.5.m5.3.3.1.3.2.2" xref="S2.p4.5.m5.3.3.1.3.2.2.cmml"><mi id="S2.p4.5.m5.3.3.1.3.2.2.2" xref="S2.p4.5.m5.3.3.1.3.2.2.2.cmml">f</mi><mi id="S2.p4.5.m5.3.3.1.3.2.2.3" xref="S2.p4.5.m5.3.3.1.3.2.2.3.cmml">i</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.p4.5.m5.3.3.1.2" xref="S2.p4.5.m5.3.3.1.2.cmml">​</mo><mrow id="S2.p4.5.m5.3.3.1.1.1" xref="S2.p4.5.m5.3.3.1.1.1.1.cmml"><mo id="S2.p4.5.m5.3.3.1.1.1.2" xref="S2.p4.5.m5.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.p4.5.m5.3.3.1.1.1.1" xref="S2.p4.5.m5.3.3.1.1.1.1.cmml"><mrow id="S2.p4.5.m5.3.3.1.1.1.1.3" xref="S2.p4.5.m5.3.3.1.1.1.1.3.cmml"><msub id="S2.p4.5.m5.3.3.1.1.1.1.3.2" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2.cmml"><mi id="S2.p4.5.m5.3.3.1.1.1.1.3.2.2" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2.2.cmml">α</mi><mi id="S2.p4.5.m5.3.3.1.1.1.1.3.2.3" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.p4.5.m5.3.3.1.1.1.1.3.1" xref="S2.p4.5.m5.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="S2.p4.5.m5.3.3.1.1.1.1.3.3" xref="S2.p4.5.m5.3.3.1.1.1.1.3.3.cmml">𝒗</mi></mrow><mo id="S2.p4.5.m5.3.3.1.1.1.1.2" xref="S2.p4.5.m5.3.3.1.1.1.1.2.cmml">+</mo><mrow id="S2.p4.5.m5.3.3.1.1.1.1.1" xref="S2.p4.5.m5.3.3.1.1.1.1.1.cmml"><mrow id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.2" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.cmml"><mn id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.2" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.1" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.3" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.p4.5.m5.3.3.1.1.1.1.1.2" xref="S2.p4.5.m5.3.3.1.1.1.1.1.2.cmml">​</mo><mi id="S2.p4.5.m5.3.3.1.1.1.1.1.3" xref="S2.p4.5.m5.3.3.1.1.1.1.1.3.cmml">𝒘</mi></mrow></mrow><mo id="S2.p4.5.m5.3.3.1.1.1.3" xref="S2.p4.5.m5.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.5.m5.3b"><apply id="S2.p4.5.m5.3.3.cmml" xref="S2.p4.5.m5.3.3"><eq id="S2.p4.5.m5.3.3.2.cmml" xref="S2.p4.5.m5.3.3.2"></eq><apply id="S2.p4.5.m5.3.3.3.cmml" xref="S2.p4.5.m5.3.3.3"><csymbol cd="ambiguous" id="S2.p4.5.m5.3.3.3.1.cmml" xref="S2.p4.5.m5.3.3.3">superscript</csymbol><apply id="S2.p4.5.m5.3.3.3.2.cmml" xref="S2.p4.5.m5.3.3.3"><csymbol cd="ambiguous" id="S2.p4.5.m5.3.3.3.2.1.cmml" xref="S2.p4.5.m5.3.3.3">subscript</csymbol><ci id="S2.p4.5.m5.3.3.3.2.2.cmml" xref="S2.p4.5.m5.3.3.3.2.2">𝛼</ci><ci id="S2.p4.5.m5.3.3.3.2.3.cmml" xref="S2.p4.5.m5.3.3.3.2.3">𝑖</ci></apply><times id="S2.p4.5.m5.3.3.3.3.cmml" xref="S2.p4.5.m5.3.3.3.3"></times></apply><apply id="S2.p4.5.m5.3.3.1.cmml" xref="S2.p4.5.m5.3.3.1"><times id="S2.p4.5.m5.3.3.1.2.cmml" xref="S2.p4.5.m5.3.3.1.2"></times><apply id="S2.p4.5.m5.3.3.1.3.cmml" xref="S2.p4.5.m5.3.3.1.3"><arg id="S2.p4.5.m5.3.3.1.3.1.cmml" xref="S2.p4.5.m5.3.3.1.3.1"></arg><apply id="S2.p4.5.m5.3.3.1.3.2.cmml" xref="S2.p4.5.m5.3.3.1.3.2"><apply id="S2.p4.5.m5.3.3.1.3.2.1.cmml" xref="S2.p4.5.m5.3.3.1.3.2.1"><csymbol cd="ambiguous" id="S2.p4.5.m5.3.3.1.3.2.1.1.cmml" xref="S2.p4.5.m5.3.3.1.3.2.1">subscript</csymbol><min id="S2.p4.5.m5.3.3.1.3.2.1.2.cmml" xref="S2.p4.5.m5.3.3.1.3.2.1.2"></min><apply id="S2.p4.5.m5.2.2.2.cmml" xref="S2.p4.5.m5.2.2.2"><in id="S2.p4.5.m5.2.2.2.3.cmml" xref="S2.p4.5.m5.2.2.2.3"></in><apply id="S2.p4.5.m5.2.2.2.4.cmml" xref="S2.p4.5.m5.2.2.2.4"><csymbol cd="ambiguous" id="S2.p4.5.m5.2.2.2.4.1.cmml" xref="S2.p4.5.m5.2.2.2.4">subscript</csymbol><ci id="S2.p4.5.m5.2.2.2.4.2.cmml" xref="S2.p4.5.m5.2.2.2.4.2">𝛼</ci><ci id="S2.p4.5.m5.2.2.2.4.3.cmml" xref="S2.p4.5.m5.2.2.2.4.3">𝑖</ci></apply><interval closure="closed" id="S2.p4.5.m5.2.2.2.5.1.cmml" xref="S2.p4.5.m5.2.2.2.5.2"><cn type="integer" id="S2.p4.5.m5.1.1.1.1.cmml" xref="S2.p4.5.m5.1.1.1.1">0</cn><cn type="integer" id="S2.p4.5.m5.2.2.2.2.cmml" xref="S2.p4.5.m5.2.2.2.2">1</cn></interval></apply></apply><apply id="S2.p4.5.m5.3.3.1.3.2.2.cmml" xref="S2.p4.5.m5.3.3.1.3.2.2"><csymbol cd="ambiguous" id="S2.p4.5.m5.3.3.1.3.2.2.1.cmml" xref="S2.p4.5.m5.3.3.1.3.2.2">subscript</csymbol><ci id="S2.p4.5.m5.3.3.1.3.2.2.2.cmml" xref="S2.p4.5.m5.3.3.1.3.2.2.2">𝑓</ci><ci id="S2.p4.5.m5.3.3.1.3.2.2.3.cmml" xref="S2.p4.5.m5.3.3.1.3.2.2.3">𝑖</ci></apply></apply></apply><apply id="S2.p4.5.m5.3.3.1.1.1.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1"><plus id="S2.p4.5.m5.3.3.1.1.1.1.2.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.2"></plus><apply id="S2.p4.5.m5.3.3.1.1.1.1.3.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3"><times id="S2.p4.5.m5.3.3.1.1.1.1.3.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3.1"></times><apply id="S2.p4.5.m5.3.3.1.1.1.1.3.2.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p4.5.m5.3.3.1.1.1.1.3.2.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S2.p4.5.m5.3.3.1.1.1.1.3.2.2.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2.2">𝛼</ci><ci id="S2.p4.5.m5.3.3.1.1.1.1.3.2.3.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.p4.5.m5.3.3.1.1.1.1.3.3.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.3.3">𝒗</ci></apply><apply id="S2.p4.5.m5.3.3.1.1.1.1.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1"><times id="S2.p4.5.m5.3.3.1.1.1.1.1.2.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.2"></times><apply id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1"><minus id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.2">1</cn><apply id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S2.p4.5.m5.3.3.1.1.1.1.1.3.cmml" xref="S2.p4.5.m5.3.3.1.1.1.1.1.3">𝒘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m5.3c">\alpha_{i}^{*}=\arg\min_{\alpha_{i}\in[0,1]}f_{i}\left(\alpha_{i}\bm{v}+\left(1-\alpha_{i}\right)\bm{w}\right)</annotation></semantics></math> in every communication round.
While this weighting scheme will balance the two models, it is unable to adapt to
the strengths of the different members of the mix.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citep">(Hanzely &amp; Richtárik, <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite> proposed a solution that provides an explicit trade-off between global and local models by the introduction of an alternative learning scheme that does not take the full federation step at every round, but instead takes a step in the direction towards the federated average.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">Mixture of experts have previously been used for learning private user models in a federated setting <cite class="ltx_cite ltx_citemacro_citep">(Peterson et al., <a href="#bib.bib24" title="" class="ltx_ref">2019</a>)</cite>. Although experiments are limited, the authors show that a mixture of a local and global model is more robust to differential privacy noise than a global model trained with federated averaging.</p>
</div>
<div id="S2.p7" class="ltx_para">
<p id="S2.p7.1" class="ltx_p"><span id="S2.p7.1.1" class="ltx_text ltx_font_bold">Contributions.</span> In this work, we integrate mixture of experts into a non-iid federated setting in order to learn a personalized federated model for each client. More specifically, we leverage the strengths of a global model trained with federated averaging and a local model trained locally on each client. We show empirically on multiple datasets that our method outperforms both a locally trained model and a global federated model fine-tuned on test data from each client. Our results also show that our proposed method generalizes better than both baseline personalization methods. Further, we show our proposed method to be robust against low client participation, making it possible for clients to opt out from the global federation, and to keep the data completely private for these clients.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Federated learning using a mixture of experts</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this work, we present a framework for model personalization in a non-iid federated learning setting that builds on federated averaging and mixtures of experts. Our framework includes a personalized model for each client, which consists of a mixture of a globally trained model and a locally trained specialist. The local models never leave the clients, which gives strong privacy properties, while the global model is trained using federated averaging and leverages larger
compute and data. In our framework, as illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, clients can choose to opt-out from the federation. This ensures complete privacy for their data, as no information from their data ever leaves the client.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.9" class="ltx_p">Let <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">f</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝑓</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">f_{g}</annotation></semantics></math> be the global model with parameters <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">w</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑤</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">w_{g}</annotation></semantics></math>. We denote the index of clients by <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">k</annotation></semantics></math> and the local specialist models by <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="f^{k}_{s}" display="inline"><semantics id="S3.p2.4.m4.1a"><msubsup id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2.2" xref="S3.p2.4.m4.1.1.2.2.cmml">f</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">s</mi><mi id="S3.p2.4.m4.1.1.2.3" xref="S3.p2.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">subscript</csymbol><apply id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.2.1.cmml" xref="S3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.p2.4.m4.1.1.2.2.cmml" xref="S3.p2.4.m4.1.1.2.2">𝑓</ci><ci id="S3.p2.4.m4.1.1.2.3.cmml" xref="S3.p2.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">f^{k}_{s}</annotation></semantics></math> with parameters <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="w^{k}_{s}" display="inline"><semantics id="S3.p2.5.m5.1a"><msubsup id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2.2" xref="S3.p2.5.m5.1.1.2.2.cmml">w</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">s</mi><mi id="S3.p2.5.m5.1.1.2.3" xref="S3.p2.5.m5.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><apply id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.2.1.cmml" xref="S3.p2.5.m5.1.1">superscript</csymbol><ci id="S3.p2.5.m5.1.1.2.2.cmml" xref="S3.p2.5.m5.1.1.2.2">𝑤</ci><ci id="S3.p2.5.m5.1.1.2.3.cmml" xref="S3.p2.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">w^{k}_{s}</annotation></semantics></math>. The gating function is denoted by <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S3.p2.6.m6.1a"><msup id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">h</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">superscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">ℎ</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">h^{k}</annotation></semantics></math>, parameterized with <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="w^{k}_{h}" display="inline"><semantics id="S3.p2.7.m7.1a"><msubsup id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2.2" xref="S3.p2.7.m7.1.1.2.2.cmml">w</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">h</mi><mi id="S3.p2.7.m7.1.1.2.3" xref="S3.p2.7.m7.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><apply id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.2.1.cmml" xref="S3.p2.7.m7.1.1">superscript</csymbol><ci id="S3.p2.7.m7.1.1.2.2.cmml" xref="S3.p2.7.m7.1.1.2.2">𝑤</ci><ci id="S3.p2.7.m7.1.1.2.3.cmml" xref="S3.p2.7.m7.1.1.2.3">𝑘</ci></apply><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">w^{k}_{h}</annotation></semantics></math>. Training in the proposed framework is divided into three main parts. First, a global model <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">f</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝑓</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">f_{g}</annotation></semantics></math> is trained using federated averaging using opt-in data (see Section <a href="#S3.SS1" title="3.1 Opting out from federation ‣ 3 Federated learning using a mixture of experts ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>). Second, a local specialist model <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="f_{s}^{k}" display="inline"><semantics id="S3.p2.9.m9.1a"><msubsup id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml"><mi id="S3.p2.9.m9.1.1.2.2" xref="S3.p2.9.m9.1.1.2.2.cmml">f</mi><mi id="S3.p2.9.m9.1.1.2.3" xref="S3.p2.9.m9.1.1.2.3.cmml">s</mi><mi id="S3.p2.9.m9.1.1.3" xref="S3.p2.9.m9.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><apply id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.cmml" xref="S3.p2.9.m9.1.1">superscript</csymbol><apply id="S3.p2.9.m9.1.1.2.cmml" xref="S3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.2.1.cmml" xref="S3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.p2.9.m9.1.1.2.2.cmml" xref="S3.p2.9.m9.1.1.2.2">𝑓</ci><ci id="S3.p2.9.m9.1.1.2.3.cmml" xref="S3.p2.9.m9.1.1.2.3">𝑠</ci></apply><ci id="S3.p2.9.m9.1.1.3.cmml" xref="S3.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">f_{s}^{k}</annotation></semantics></math> is created for each client, initialized with the weights of the global model and fine-tuned using the local opt-in data on the client. Third, we train the mixture of experts</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.5" class="ltx_Math" alttext="h^{k}(x)f^{k}_{s}(x)+(1-h^{k}(x))f_{g}(x)." display="block"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.3" xref="S3.E3.m1.5.5.1.1.3.cmml"><msup id="S3.E3.m1.5.5.1.1.3.2" xref="S3.E3.m1.5.5.1.1.3.2.cmml"><mi id="S3.E3.m1.5.5.1.1.3.2.2" xref="S3.E3.m1.5.5.1.1.3.2.2.cmml">h</mi><mi id="S3.E3.m1.5.5.1.1.3.2.3" xref="S3.E3.m1.5.5.1.1.3.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.3.1" xref="S3.E3.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.1.3.3.2" xref="S3.E3.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.1.3.3.2.1" xref="S3.E3.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.1.3.3.2.2" xref="S3.E3.m1.5.5.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.3.1a" xref="S3.E3.m1.5.5.1.1.3.1.cmml">​</mo><msubsup id="S3.E3.m1.5.5.1.1.3.4" xref="S3.E3.m1.5.5.1.1.3.4.cmml"><mi id="S3.E3.m1.5.5.1.1.3.4.2.2" xref="S3.E3.m1.5.5.1.1.3.4.2.2.cmml">f</mi><mi id="S3.E3.m1.5.5.1.1.3.4.3" xref="S3.E3.m1.5.5.1.1.3.4.3.cmml">s</mi><mi id="S3.E3.m1.5.5.1.1.3.4.2.3" xref="S3.E3.m1.5.5.1.1.3.4.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.3.1b" xref="S3.E3.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.1.3.5.2" xref="S3.E3.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.1.3.5.2.1" xref="S3.E3.m1.5.5.1.1.3.cmml">(</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.1.3.5.2.2" xref="S3.E3.m1.5.5.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.2" xref="S3.E3.m1.5.5.1.1.2.cmml">+</mo><mrow id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.cmml"><mn id="S3.E3.m1.5.5.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml"><msup id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">h</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.1.1.1.1.3.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.2.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.1.1.1.1.1.3.3.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E3.m1.5.5.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.2.cmml">​</mo><msub id="S3.E3.m1.5.5.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.5.5.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.5.5.1.1.1.2a" xref="S3.E3.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.5.5.1.1.1.4.2" xref="S3.E3.m1.5.5.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.5.5.1.1.1.4.2.1" xref="S3.E3.m1.5.5.1.1.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.5.5.1.1.1.4.2.2" xref="S3.E3.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1"><plus id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.2"></plus><apply id="S3.E3.m1.5.5.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.3"><times id="S3.E3.m1.5.5.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.3.1"></times><apply id="S3.E3.m1.5.5.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.3.2.2">ℎ</ci><ci id="S3.E3.m1.5.5.1.1.3.2.3.cmml" xref="S3.E3.m1.5.5.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑥</ci><apply id="S3.E3.m1.5.5.1.1.3.4.cmml" xref="S3.E3.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.3.4.1.cmml" xref="S3.E3.m1.5.5.1.1.3.4">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.3.4.2.cmml" xref="S3.E3.m1.5.5.1.1.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.3.4.2.1.cmml" xref="S3.E3.m1.5.5.1.1.3.4">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.3.4.2.2.cmml" xref="S3.E3.m1.5.5.1.1.3.4.2.2">𝑓</ci><ci id="S3.E3.m1.5.5.1.1.3.4.2.3.cmml" xref="S3.E3.m1.5.5.1.1.3.4.2.3">𝑘</ci></apply><ci id="S3.E3.m1.5.5.1.1.3.4.3.cmml" xref="S3.E3.m1.5.5.1.1.3.4.3">𝑠</ci></apply><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑥</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"><times id="S3.E3.m1.5.5.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.2"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1"><minus id="S3.E3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2">1</cn><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.1"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.2">ℎ</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑥</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.5.5.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.3.3">𝑔</ci></apply><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">h^{k}(x)f^{k}_{s}(x)+(1-h^{k}(x))f_{g}(x).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.13" class="ltx_p">We freeze the weights of <math id="S3.p2.10.m1.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.p2.10.m1.1a"><msub id="S3.p2.10.m1.1.1" xref="S3.p2.10.m1.1.1.cmml"><mi id="S3.p2.10.m1.1.1.2" xref="S3.p2.10.m1.1.1.2.cmml">f</mi><mi id="S3.p2.10.m1.1.1.3" xref="S3.p2.10.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.10.m1.1b"><apply id="S3.p2.10.m1.1.1.cmml" xref="S3.p2.10.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m1.1.1.1.cmml" xref="S3.p2.10.m1.1.1">subscript</csymbol><ci id="S3.p2.10.m1.1.1.2.cmml" xref="S3.p2.10.m1.1.1.2">𝑓</ci><ci id="S3.p2.10.m1.1.1.3.cmml" xref="S3.p2.10.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m1.1c">f_{g}</annotation></semantics></math>, only updating the local specialist <math id="S3.p2.11.m2.1" class="ltx_Math" alttext="f_{s}^{k}" display="inline"><semantics id="S3.p2.11.m2.1a"><msubsup id="S3.p2.11.m2.1.1" xref="S3.p2.11.m2.1.1.cmml"><mi id="S3.p2.11.m2.1.1.2.2" xref="S3.p2.11.m2.1.1.2.2.cmml">f</mi><mi id="S3.p2.11.m2.1.1.2.3" xref="S3.p2.11.m2.1.1.2.3.cmml">s</mi><mi id="S3.p2.11.m2.1.1.3" xref="S3.p2.11.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p2.11.m2.1b"><apply id="S3.p2.11.m2.1.1.cmml" xref="S3.p2.11.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.1.cmml" xref="S3.p2.11.m2.1.1">superscript</csymbol><apply id="S3.p2.11.m2.1.1.2.cmml" xref="S3.p2.11.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.11.m2.1.1.2.1.cmml" xref="S3.p2.11.m2.1.1">subscript</csymbol><ci id="S3.p2.11.m2.1.1.2.2.cmml" xref="S3.p2.11.m2.1.1.2.2">𝑓</ci><ci id="S3.p2.11.m2.1.1.2.3.cmml" xref="S3.p2.11.m2.1.1.2.3">𝑠</ci></apply><ci id="S3.p2.11.m2.1.1.3.cmml" xref="S3.p2.11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m2.1c">f_{s}^{k}</annotation></semantics></math> and the gating model <math id="S3.p2.12.m3.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S3.p2.12.m3.1a"><msup id="S3.p2.12.m3.1.1" xref="S3.p2.12.m3.1.1.cmml"><mi id="S3.p2.12.m3.1.1.2" xref="S3.p2.12.m3.1.1.2.cmml">h</mi><mi id="S3.p2.12.m3.1.1.3" xref="S3.p2.12.m3.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.12.m3.1b"><apply id="S3.p2.12.m3.1.1.cmml" xref="S3.p2.12.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.12.m3.1.1.1.cmml" xref="S3.p2.12.m3.1.1">superscript</csymbol><ci id="S3.p2.12.m3.1.1.2.cmml" xref="S3.p2.12.m3.1.1.2">ℎ</ci><ci id="S3.p2.12.m3.1.1.3.cmml" xref="S3.p2.12.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m3.1c">h^{k}</annotation></semantics></math> on each client. By freezing the weights of <math id="S3.p2.13.m4.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.p2.13.m4.1a"><msub id="S3.p2.13.m4.1.1" xref="S3.p2.13.m4.1.1.cmml"><mi id="S3.p2.13.m4.1.1.2" xref="S3.p2.13.m4.1.1.2.cmml">f</mi><mi id="S3.p2.13.m4.1.1.3" xref="S3.p2.13.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.13.m4.1b"><apply id="S3.p2.13.m4.1.1.cmml" xref="S3.p2.13.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.13.m4.1.1.1.cmml" xref="S3.p2.13.m4.1.1">subscript</csymbol><ci id="S3.p2.13.m4.1.1.2.cmml" xref="S3.p2.13.m4.1.1.2">𝑓</ci><ci id="S3.p2.13.m4.1.1.3.cmml" xref="S3.p2.13.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m4.1c">f_{g}</annotation></semantics></math> in the last step, we ensure that the generalist knowledge in the model is not unlearned in the fine-tuning procedure.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.2" class="ltx_p">As the mixture is trained, the two expert models <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="f_{s}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">f</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑓</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">f_{s}</annotation></semantics></math> and <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">f</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝑓</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">f_{g}</annotation></semantics></math> compete against each other, while the gating function sends an error signal guiding the winner of the two experts for every input. Over the course of this procedure, the gating function will learn to separate the input space given how well each expert perform on the task.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Opting out from federation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">Users requiring high levels of privacy may not want to participate in the federation and disclose their locally trained model to a central server. For this reason, our proposed framework allows for clients to opt-out from federation.
Each client may arbitrarily partition its data into a part that is not used in the federation, and a part that is. No information from the opt-out data will ever leave the client. The system will still leverage learning from
this data by using it to train the local specialist model <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="f_{s}^{k}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msubsup id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p1.1.m1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.2.3.cmml">s</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2.2">𝑓</ci><ci id="S3.SS1.p1.1.m1.1.1.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.2.3">𝑠</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">f_{s}^{k}</annotation></semantics></math> and the gating model <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msup id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">ℎ</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">h^{k}</annotation></semantics></math>.
This is a very flexible and useful property as it allows for the use of sensitive data in training of the private local models, while transformations of it, created by some privatization mechanism (e.g. differential privacy), can be used to train the federated model.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.9" class="ltx_p">Formally, each client dataset <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝒟</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{D}^{k}</annotation></semantics></math> is split into two non-overlapping datasets, <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{O}}^{k}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msubsup id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.2.3.cmml">𝒪</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2.2">𝒟</ci><ci id="S3.SS1.p2.2.m2.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.2.3">𝒪</ci></apply><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{D}_{\mathcal{O}}^{k}</annotation></semantics></math> and <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{I}}^{k}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msubsup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.3.m3.1.1.2.3" xref="S3.SS1.p2.3.m3.1.1.2.3.cmml">ℐ</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">𝒟</ci><ci id="S3.SS1.p2.3.m3.1.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.1.2.3">ℐ</ci></apply><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathcal{D}_{\mathcal{I}}^{k}</annotation></semantics></math>, one of which has to be non-empty. The local model <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="f^{k}_{l}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msubsup id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.2.2.cmml">f</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">l</mi><mi id="S3.SS1.p2.4.m4.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2">𝑓</ci><ci id="S3.SS1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">f^{k}_{l}</annotation></semantics></math> and the gating model <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msup id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">h</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">ℎ</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">h^{k}</annotation></semantics></math> is trained using the whole dataset <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{D}^{k}=\mathcal{D}_{\mathcal{O}}^{k}\cup\mathcal{D}_{\mathcal{I}}^{k}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><msup id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml">k</mi></msup><mo id="S3.SS1.p2.6.m6.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml"><msubsup id="S3.SS1.p2.6.m6.1.1.3.2" xref="S3.SS1.p2.6.m6.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.3.2.2.2" xref="S3.SS1.p2.6.m6.1.1.3.2.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.3.2.2.3" xref="S3.SS1.p2.6.m6.1.1.3.2.2.3.cmml">𝒪</mi><mi id="S3.SS1.p2.6.m6.1.1.3.2.3" xref="S3.SS1.p2.6.m6.1.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.p2.6.m6.1.1.3.1" xref="S3.SS1.p2.6.m6.1.1.3.1.cmml">∪</mo><msubsup id="S3.SS1.p2.6.m6.1.1.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.3.3.2.2" xref="S3.SS1.p2.6.m6.1.1.3.3.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.6.m6.1.1.3.3.2.3" xref="S3.SS1.p2.6.m6.1.1.3.3.2.3.cmml">ℐ</mi><mi id="S3.SS1.p2.6.m6.1.1.3.3.3" xref="S3.SS1.p2.6.m6.1.1.3.3.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><eq id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1"></eq><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2">𝒟</ci><ci id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3"><union id="S3.SS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.1"></union><apply id="S3.SS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.3.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">superscript</csymbol><apply id="S3.SS1.p2.6.m6.1.1.3.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.3.2.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.3.2.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2.2.2">𝒟</ci><ci id="S3.SS1.p2.6.m6.1.1.3.2.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2.2.3">𝒪</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.3.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.2.3">𝑘</ci></apply><apply id="S3.SS1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.3.3.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3">superscript</csymbol><apply id="S3.SS1.p2.6.m6.1.1.3.3.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.2.2">𝒟</ci><ci id="S3.SS1.p2.6.m6.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.2.3">ℐ</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.3.3.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\mathcal{D}^{k}=\mathcal{D}_{\mathcal{O}}^{k}\cup\mathcal{D}_{\mathcal{I}}^{k}</annotation></semantics></math>, while the global model <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msub id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2" xref="S3.SS1.p2.7.m7.1.1.2.cmml">f</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2">𝑓</ci><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">f_{g}</annotation></semantics></math> is trained with <span id="S3.SS1.p2.9.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> using only the non-sensitive <span id="S3.SS1.p2.9.2" class="ltx_text ltx_font_italic">opt-in</span> dataset <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{I}}^{k}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msubsup id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml">ℐ</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">superscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝒟</ci><ci id="S3.SS1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3">ℐ</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\mathcal{D}_{\mathcal{I}}^{k}</annotation></semantics></math>. In Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> this is visualized by each client either opting-in or out all of its data. In our experiments, we assume that a client that opts out does so with its whole dataset, meaning that it puts all of its data in <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{O}}^{k}" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><msubsup id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m9.1.1.2.2" xref="S3.SS1.p2.9.m9.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.9.m9.1.1.2.3" xref="S3.SS1.p2.9.m9.1.1.2.3.cmml">𝒪</mi><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">superscript</csymbol><apply id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2.2">𝒟</ci><ci id="S3.SS1.p2.9.m9.1.1.2.3.cmml" xref="S3.SS1.p2.9.m9.1.1.2.3">𝒪</ci></apply><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">\mathcal{D}_{\mathcal{O}}^{k}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Optimization problem</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.8" class="ltx_p"><span id="S3.SS2.p1.8.1" class="ltx_text ltx_font_bold">Step 1: Train a global model.</span> We train the global model using <span id="S3.SS2.p1.8.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. In other words, globally we optimize</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.6" class="ltx_Math" alttext="\min_{w_{g}\in\mathbb{R}^{d}}\frac{1}{\left|\mathcal{D}_{\mathcal{I}}^{k}\right|}\sum_{k\in\mathcal{D}_{\mathcal{I}}^{k}}\mathbb{E}_{(x,y)\sim\mathcal{D}_{\mathcal{I}}^{k}}\left[\ell_{k}(w_{g};\;x,y,\hat{y}_{g})\right]" display="block"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.6.6.3" xref="S3.E4.m1.6.6.3.cmml"><munder id="S3.E4.m1.6.6.3.1" xref="S3.E4.m1.6.6.3.1.cmml"><mi id="S3.E4.m1.6.6.3.1.2" xref="S3.E4.m1.6.6.3.1.2.cmml">min</mi><mrow id="S3.E4.m1.6.6.3.1.3" xref="S3.E4.m1.6.6.3.1.3.cmml"><msub id="S3.E4.m1.6.6.3.1.3.2" xref="S3.E4.m1.6.6.3.1.3.2.cmml"><mi id="S3.E4.m1.6.6.3.1.3.2.2" xref="S3.E4.m1.6.6.3.1.3.2.2.cmml">w</mi><mi id="S3.E4.m1.6.6.3.1.3.2.3" xref="S3.E4.m1.6.6.3.1.3.2.3.cmml">g</mi></msub><mo id="S3.E4.m1.6.6.3.1.3.1" xref="S3.E4.m1.6.6.3.1.3.1.cmml">∈</mo><msup id="S3.E4.m1.6.6.3.1.3.3" xref="S3.E4.m1.6.6.3.1.3.3.cmml"><mi id="S3.E4.m1.6.6.3.1.3.3.2" xref="S3.E4.m1.6.6.3.1.3.3.2.cmml">ℝ</mi><mi id="S3.E4.m1.6.6.3.1.3.3.3" xref="S3.E4.m1.6.6.3.1.3.3.3.cmml">d</mi></msup></mrow></munder><mo lspace="0.167em" id="S3.E4.m1.6.6.3a" xref="S3.E4.m1.6.6.3.cmml">⁡</mo><mfrac id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mn id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">1</mn><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo><msubsup id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.2.2" xref="S3.E4.m1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.2.3" xref="S3.E4.m1.1.1.1.1.1.2.3.cmml">ℐ</mi><mi id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.2" xref="S3.E4.m1.6.6.2.cmml">​</mo><mrow id="S3.E4.m1.6.6.1" xref="S3.E4.m1.6.6.1.cmml"><munder id="S3.E4.m1.6.6.1.2" xref="S3.E4.m1.6.6.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.6.6.1.2.2" xref="S3.E4.m1.6.6.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.6.6.1.2.3" xref="S3.E4.m1.6.6.1.2.3.cmml"><mi id="S3.E4.m1.6.6.1.2.3.2" xref="S3.E4.m1.6.6.1.2.3.2.cmml">k</mi><mo id="S3.E4.m1.6.6.1.2.3.1" xref="S3.E4.m1.6.6.1.2.3.1.cmml">∈</mo><msubsup id="S3.E4.m1.6.6.1.2.3.3" xref="S3.E4.m1.6.6.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6.1.2.3.3.2.2" xref="S3.E4.m1.6.6.1.2.3.3.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6.1.2.3.3.2.3" xref="S3.E4.m1.6.6.1.2.3.3.2.3.cmml">ℐ</mi><mi id="S3.E4.m1.6.6.1.2.3.3.3" xref="S3.E4.m1.6.6.1.2.3.3.3.cmml">k</mi></msubsup></mrow></munder><mrow id="S3.E4.m1.6.6.1.1" xref="S3.E4.m1.6.6.1.1.cmml"><msub id="S3.E4.m1.6.6.1.1.3" xref="S3.E4.m1.6.6.1.1.3.cmml"><mi id="S3.E4.m1.6.6.1.1.3.2" xref="S3.E4.m1.6.6.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><mrow id="S3.E4.m1.3.3.2.4.2" xref="S3.E4.m1.3.3.2.4.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.2.4.2.1" xref="S3.E4.m1.3.3.2.4.1.cmml">(</mo><mi id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">x</mi><mo id="S3.E4.m1.3.3.2.4.2.2" xref="S3.E4.m1.3.3.2.4.1.cmml">,</mo><mi id="S3.E4.m1.3.3.2.2" xref="S3.E4.m1.3.3.2.2.cmml">y</mi><mo stretchy="false" id="S3.E4.m1.3.3.2.4.2.3" xref="S3.E4.m1.3.3.2.4.1.cmml">)</mo></mrow><mo id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.3.cmml">∼</mo><msubsup id="S3.E4.m1.3.3.2.5" xref="S3.E4.m1.3.3.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.5.2.2" xref="S3.E4.m1.3.3.2.5.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.2.5.2.3" xref="S3.E4.m1.3.3.2.5.2.3.cmml">ℐ</mi><mi id="S3.E4.m1.3.3.2.5.3" xref="S3.E4.m1.3.3.2.5.3.cmml">k</mi></msubsup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.1.1.2" xref="S3.E4.m1.6.6.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.6.6.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.2.cmml"><mo id="S3.E4.m1.6.6.1.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.cmml"><msub id="S3.E4.m1.6.6.1.1.1.1.1.4" xref="S3.E4.m1.6.6.1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E4.m1.6.6.1.1.1.1.1.4.2" xref="S3.E4.m1.6.6.1.1.1.1.1.4.2.cmml">ℓ</mi><mi id="S3.E4.m1.6.6.1.1.1.1.1.4.3" xref="S3.E4.m1.6.6.1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.1.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E4.m1.6.6.1.1.1.1.1.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.1.1.1.1.1.2.2.3" xref="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo rspace="0.447em" id="S3.E4.m1.6.6.1.1.1.1.1.2.2.4" xref="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml">;</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">x</mi><mo id="S3.E4.m1.6.6.1.1.1.1.1.2.2.5" xref="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">y</mi><mo id="S3.E4.m1.6.6.1.1.1.1.1.2.2.6" xref="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.2" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mo id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.1" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="S3.E4.m1.6.6.1.1.1.1.1.2.2.7" xref="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.1.1.1.1.3" xref="S3.E4.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><times id="S3.E4.m1.6.6.2.cmml" xref="S3.E4.m1.6.6.2"></times><apply id="S3.E4.m1.6.6.3.cmml" xref="S3.E4.m1.6.6.3"><apply id="S3.E4.m1.6.6.3.1.cmml" xref="S3.E4.m1.6.6.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.3.1.1.cmml" xref="S3.E4.m1.6.6.3.1">subscript</csymbol><min id="S3.E4.m1.6.6.3.1.2.cmml" xref="S3.E4.m1.6.6.3.1.2"></min><apply id="S3.E4.m1.6.6.3.1.3.cmml" xref="S3.E4.m1.6.6.3.1.3"><in id="S3.E4.m1.6.6.3.1.3.1.cmml" xref="S3.E4.m1.6.6.3.1.3.1"></in><apply id="S3.E4.m1.6.6.3.1.3.2.cmml" xref="S3.E4.m1.6.6.3.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.3.1.3.2.1.cmml" xref="S3.E4.m1.6.6.3.1.3.2">subscript</csymbol><ci id="S3.E4.m1.6.6.3.1.3.2.2.cmml" xref="S3.E4.m1.6.6.3.1.3.2.2">𝑤</ci><ci id="S3.E4.m1.6.6.3.1.3.2.3.cmml" xref="S3.E4.m1.6.6.3.1.3.2.3">𝑔</ci></apply><apply id="S3.E4.m1.6.6.3.1.3.3.cmml" xref="S3.E4.m1.6.6.3.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.3.1.3.3.1.cmml" xref="S3.E4.m1.6.6.3.1.3.3">superscript</csymbol><ci id="S3.E4.m1.6.6.3.1.3.3.2.cmml" xref="S3.E4.m1.6.6.3.1.3.3.2">ℝ</ci><ci id="S3.E4.m1.6.6.3.1.3.3.3.cmml" xref="S3.E4.m1.6.6.3.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><divide id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1"></divide><cn type="integer" id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">1</cn><apply id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1"><abs id="S3.E4.m1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.2"></abs><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2.2">𝒟</ci><ci id="S3.E4.m1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.1.1.1.2.3">ℐ</ci></apply><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E4.m1.6.6.1.cmml" xref="S3.E4.m1.6.6.1"><apply id="S3.E4.m1.6.6.1.2.cmml" xref="S3.E4.m1.6.6.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.2.1.cmml" xref="S3.E4.m1.6.6.1.2">subscript</csymbol><sum id="S3.E4.m1.6.6.1.2.2.cmml" xref="S3.E4.m1.6.6.1.2.2"></sum><apply id="S3.E4.m1.6.6.1.2.3.cmml" xref="S3.E4.m1.6.6.1.2.3"><in id="S3.E4.m1.6.6.1.2.3.1.cmml" xref="S3.E4.m1.6.6.1.2.3.1"></in><ci id="S3.E4.m1.6.6.1.2.3.2.cmml" xref="S3.E4.m1.6.6.1.2.3.2">𝑘</ci><apply id="S3.E4.m1.6.6.1.2.3.3.cmml" xref="S3.E4.m1.6.6.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.2.3.3.1.cmml" xref="S3.E4.m1.6.6.1.2.3.3">superscript</csymbol><apply id="S3.E4.m1.6.6.1.2.3.3.2.cmml" xref="S3.E4.m1.6.6.1.2.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.2.3.3.2.1.cmml" xref="S3.E4.m1.6.6.1.2.3.3">subscript</csymbol><ci id="S3.E4.m1.6.6.1.2.3.3.2.2.cmml" xref="S3.E4.m1.6.6.1.2.3.3.2.2">𝒟</ci><ci id="S3.E4.m1.6.6.1.2.3.3.2.3.cmml" xref="S3.E4.m1.6.6.1.2.3.3.2.3">ℐ</ci></apply><ci id="S3.E4.m1.6.6.1.2.3.3.3.cmml" xref="S3.E4.m1.6.6.1.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E4.m1.6.6.1.1.cmml" xref="S3.E4.m1.6.6.1.1"><times id="S3.E4.m1.6.6.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.2"></times><apply id="S3.E4.m1.6.6.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.3.1.cmml" xref="S3.E4.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.3.2.cmml" xref="S3.E4.m1.6.6.1.1.3.2">𝔼</ci><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><csymbol cd="latexml" id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3">similar-to</csymbol><interval closure="open" id="S3.E4.m1.3.3.2.4.1.cmml" xref="S3.E4.m1.3.3.2.4.2"><ci id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1">𝑥</ci><ci id="S3.E4.m1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.2.2">𝑦</ci></interval><apply id="S3.E4.m1.3.3.2.5.cmml" xref="S3.E4.m1.3.3.2.5"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.5.1.cmml" xref="S3.E4.m1.3.3.2.5">superscript</csymbol><apply id="S3.E4.m1.3.3.2.5.2.cmml" xref="S3.E4.m1.3.3.2.5"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.5.2.1.cmml" xref="S3.E4.m1.3.3.2.5">subscript</csymbol><ci id="S3.E4.m1.3.3.2.5.2.2.cmml" xref="S3.E4.m1.3.3.2.5.2.2">𝒟</ci><ci id="S3.E4.m1.3.3.2.5.2.3.cmml" xref="S3.E4.m1.3.3.2.5.2.3">ℐ</ci></apply><ci id="S3.E4.m1.3.3.2.5.3.cmml" xref="S3.E4.m1.3.3.2.5.3">𝑘</ci></apply></apply></apply><apply id="S3.E4.m1.6.6.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.6.6.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.6.6.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1"><times id="S3.E4.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.3"></times><apply id="S3.E4.m1.6.6.1.1.1.1.1.4.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.1.4.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.1.1.1.4.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.4.2">ℓ</ci><ci id="S3.E4.m1.6.6.1.1.1.1.1.4.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.4.3">𝑘</ci></apply><list id="S3.E4.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2"><apply id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝑥</ci><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝑦</ci><apply id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2"><ci id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.2.2">𝑦</ci></apply><ci id="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.6.6.1.1.1.1.1.2.2.2.3">𝑔</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">\min_{w_{g}\in\mathbb{R}^{d}}\frac{1}{\left|\mathcal{D}_{\mathcal{I}}^{k}\right|}\sum_{k\in\mathcal{D}_{\mathcal{I}}^{k}}\mathbb{E}_{(x,y)\sim\mathcal{D}_{\mathcal{I}}^{k}}\left[\ell_{k}(w_{g};\;x,y,\hat{y}_{g})\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.7" class="ltx_p">for the opt-in dataset <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{I}}^{k}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msubsup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2.2" xref="S3.SS2.p1.1.m1.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.2.3" xref="S3.SS2.p1.1.m1.1.1.2.3.cmml">ℐ</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2.2">𝒟</ci><ci id="S3.SS2.p1.1.m1.1.1.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.2.3">ℐ</ci></apply><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{D}_{\mathcal{I}}^{k}</annotation></semantics></math>. Here <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">ℓ</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\ell_{k}</annotation></semantics></math> is the loss for the global model <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑤</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">w_{g}</annotation></semantics></math> on client <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">k</annotation></semantics></math> for the prediction <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="f_{g}(x)=\hat{y}_{g}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.2" xref="S3.SS2.p1.5.m5.1.2.cmml"><mrow id="S3.SS2.p1.5.m5.1.2.2" xref="S3.SS2.p1.5.m5.1.2.2.cmml"><msub id="S3.SS2.p1.5.m5.1.2.2.2" xref="S3.SS2.p1.5.m5.1.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.1.2.2.2.2" xref="S3.SS2.p1.5.m5.1.2.2.2.2.cmml">f</mi><mi id="S3.SS2.p1.5.m5.1.2.2.2.3" xref="S3.SS2.p1.5.m5.1.2.2.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.2.2.1" xref="S3.SS2.p1.5.m5.1.2.2.1.cmml">​</mo><mrow id="S3.SS2.p1.5.m5.1.2.2.3.2" xref="S3.SS2.p1.5.m5.1.2.2.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m5.1.2.2.3.2.1" xref="S3.SS2.p1.5.m5.1.2.2.cmml">(</mo><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.p1.5.m5.1.2.2.3.2.2" xref="S3.SS2.p1.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.5.m5.1.2.1" xref="S3.SS2.p1.5.m5.1.2.1.cmml">=</mo><msub id="S3.SS2.p1.5.m5.1.2.3" xref="S3.SS2.p1.5.m5.1.2.3.cmml"><mover accent="true" id="S3.SS2.p1.5.m5.1.2.3.2" xref="S3.SS2.p1.5.m5.1.2.3.2.cmml"><mi id="S3.SS2.p1.5.m5.1.2.3.2.2" xref="S3.SS2.p1.5.m5.1.2.3.2.2.cmml">y</mi><mo id="S3.SS2.p1.5.m5.1.2.3.2.1" xref="S3.SS2.p1.5.m5.1.2.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.p1.5.m5.1.2.3.3" xref="S3.SS2.p1.5.m5.1.2.3.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.2.cmml" xref="S3.SS2.p1.5.m5.1.2"><eq id="S3.SS2.p1.5.m5.1.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.1"></eq><apply id="S3.SS2.p1.5.m5.1.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2"><times id="S3.SS2.p1.5.m5.1.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.2.1"></times><apply id="S3.SS2.p1.5.m5.1.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.2.2.2">𝑓</ci><ci id="S3.SS2.p1.5.m5.1.2.2.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.2.2.3">𝑔</ci></apply><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑥</ci></apply><apply id="S3.SS2.p1.5.m5.1.2.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.2.3.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3">subscript</csymbol><apply id="S3.SS2.p1.5.m5.1.2.3.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2"><ci id="S3.SS2.p1.5.m5.1.2.3.2.1.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2.1">^</ci><ci id="S3.SS2.p1.5.m5.1.2.3.2.2.cmml" xref="S3.SS2.p1.5.m5.1.2.3.2.2">𝑦</ci></apply><ci id="S3.SS2.p1.5.m5.1.2.3.3.cmml" xref="S3.SS2.p1.5.m5.1.2.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">f_{g}(x)=\hat{y}_{g}</annotation></semantics></math>, and <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{I}}^{k}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><msubsup id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.2.2" xref="S3.SS2.p1.6.m6.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.2.3" xref="S3.SS2.p1.6.m6.1.1.2.3.cmml">ℐ</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.2.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2.2">𝒟</ci><ci id="S3.SS2.p1.6.m6.1.1.2.3.cmml" xref="S3.SS2.p1.6.m6.1.1.2.3">ℐ</ci></apply><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{D}_{\mathcal{I}}^{k}</annotation></semantics></math> is the <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">k</annotation></semantics></math>th clients <span id="S3.SS2.p1.7.1" class="ltx_text ltx_font_italic">opt-in</span> data distribution.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">Step 2: Train local specialists.</span> The output model from <span id="S3.SS2.p2.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> is fine-tuned on each clients datasets, minimizing the local loss. We initialize the specialist model with the global parameters <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑤</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">w_{g}</annotation></semantics></math> and optimize:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.7" class="ltx_Math" alttext="\min_{w_{s}^{k}\in\mathbb{R}^{d}}\mathbb{E}_{(x,y)\sim\mathcal{D}^{k}}\left[\ell_{k}(w^{k}_{s};\;x,y,\hat{y}_{l})\right]\quad\forall k=1,\dots,n." display="block"><semantics id="S3.E5.m1.7a"><mrow id="S3.E5.m1.7.7.1"><mrow id="S3.E5.m1.7.7.1.1.2" xref="S3.E5.m1.7.7.1.1.3.cmml"><mrow id="S3.E5.m1.7.7.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1.1.1.2.2" xref="S3.E5.m1.7.7.1.1.1.1.2.3.cmml"><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.cmml"><munder id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.2.cmml">min</mi><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.cmml"><msubsup id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.2.cmml">w</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.3.cmml">s</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.3.cmml">k</mi></msubsup><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.1.cmml">∈</mo><msup id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.2.cmml">ℝ</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.3.cmml">d</mi></msup></mrow></munder><mo lspace="0.167em" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3a" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml">𝔼</mi><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mrow id="S3.E5.m1.2.2.2.4.2" xref="S3.E5.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.4.2.1" xref="S3.E5.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">x</mi><mo id="S3.E5.m1.2.2.2.4.2.2" xref="S3.E5.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.2.2.2.4.2.3" xref="S3.E5.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E5.m1.2.2.2.5" xref="S3.E5.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.5.2" xref="S3.E5.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E5.m1.2.2.2.5.3" xref="S3.E5.m1.2.2.2.5.3.cmml">k</mi></msup></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.2.cmml">ℓ</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msubsup id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo rspace="0.447em" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">;</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">x</mi><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.5" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">y</mi><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.6" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.7" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mspace width="1.167em" id="S3.E5.m1.7.7.1.1.1.1.2.2.3" xref="S3.E5.m1.7.7.1.1.1.1.2.3.cmml"></mspace><mrow id="S3.E5.m1.7.7.1.1.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S3.E5.m1.7.7.1.1.1.1.2.2.2.1" xref="S3.E5.m1.7.7.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E5.m1.7.7.1.1.1.1.2.2.2.2" xref="S3.E5.m1.7.7.1.1.1.1.2.2.2.2.cmml">k</mi></mrow></mrow><mo id="S3.E5.m1.7.7.1.1.1.1.3" xref="S3.E5.m1.7.7.1.1.1.1.3.cmml">=</mo><mn id="S3.E5.m1.7.7.1.1.1.1.4" xref="S3.E5.m1.7.7.1.1.1.1.4.cmml">1</mn></mrow><mo id="S3.E5.m1.7.7.1.1.2.3" xref="S3.E5.m1.7.7.1.1.3a.cmml">,</mo><mrow id="S3.E5.m1.7.7.1.1.2.2.2" xref="S3.E5.m1.7.7.1.1.2.2.1.cmml"><mi mathvariant="normal" id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">…</mi><mo id="S3.E5.m1.7.7.1.1.2.2.2.1" xref="S3.E5.m1.7.7.1.1.2.2.1.cmml">,</mo><mi id="S3.E5.m1.6.6" xref="S3.E5.m1.6.6.cmml">n</mi></mrow></mrow><mo lspace="0em" id="S3.E5.m1.7.7.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.7b"><apply id="S3.E5.m1.7.7.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.3a.cmml" xref="S3.E5.m1.7.7.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1"><eq id="S3.E5.m1.7.7.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.3"></eq><list id="S3.E5.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.2.2"><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1"><times id="S3.E5.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3"><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1">subscript</csymbol><min id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.2"></min><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3"><in id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.1"></in><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2">superscript</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.2">𝑤</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.2.3">𝑠</ci></apply><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.2.3">𝑘</ci></apply><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.2">ℝ</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.1.3.3.3">𝑑</ci></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.3.2.2">𝔼</ci><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E5.m1.2.2.2.4.1.cmml" xref="S3.E5.m1.2.2.2.4.2"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑥</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E5.m1.2.2.2.5.cmml" xref="S3.E5.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.5.1.cmml" xref="S3.E5.m1.2.2.2.5">superscript</csymbol><ci id="S3.E5.m1.2.2.2.5.2.cmml" xref="S3.E5.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E5.m1.2.2.2.5.3.cmml" xref="S3.E5.m1.2.2.2.5.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1"><times id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"></times><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.2">ℓ</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><list id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑥</ci><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝑦</ci><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2"><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1">^</ci><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci></apply><ci id="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E5.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply></list></apply></apply></apply><apply id="S3.E5.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.7.7.1.1.1.1.2.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E5.m1.7.7.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.7.7.1.1.1.1.2.2.2.2">𝑘</ci></apply></list><cn type="integer" id="S3.E5.m1.7.7.1.1.1.1.4.cmml" xref="S3.E5.m1.7.7.1.1.1.1.4">1</cn></apply><list id="S3.E5.m1.7.7.1.1.2.2.1.cmml" xref="S3.E5.m1.7.7.1.1.2.2.2"><ci id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5">…</ci><ci id="S3.E5.m1.6.6.cmml" xref="S3.E5.m1.6.6">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.7c">\min_{w_{s}^{k}\in\mathbb{R}^{d}}\mathbb{E}_{(x,y)\sim\mathcal{D}^{k}}\left[\ell_{k}(w^{k}_{s};\;x,y,\hat{y}_{l})\right]\quad\forall k=1,\dots,n.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.6" class="ltx_p">Here, <math id="S3.SS2.p2.2.m1.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS2.p2.2.m1.1a"><msub id="S3.SS2.p2.2.m1.1.1" xref="S3.SS2.p2.2.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p2.2.m1.1.1.2" xref="S3.SS2.p2.2.m1.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p2.2.m1.1.1.3" xref="S3.SS2.p2.2.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m1.1b"><apply id="S3.SS2.p2.2.m1.1.1.cmml" xref="S3.SS2.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m1.1.1.1.cmml" xref="S3.SS2.p2.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m1.1.1.2.cmml" xref="S3.SS2.p2.2.m1.1.1.2">ℓ</ci><ci id="S3.SS2.p2.2.m1.1.1.3.cmml" xref="S3.SS2.p2.2.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m1.1c">\ell_{k}</annotation></semantics></math> is the loss for the prediction <math id="S3.SS2.p2.3.m2.2" class="ltx_Math" alttext="\hat{y}_{l}=f^{k}_{s}(w^{k}_{s};\;x)" display="inline"><semantics id="S3.SS2.p2.3.m2.2a"><mrow id="S3.SS2.p2.3.m2.2.2" xref="S3.SS2.p2.3.m2.2.2.cmml"><msub id="S3.SS2.p2.3.m2.2.2.3" xref="S3.SS2.p2.3.m2.2.2.3.cmml"><mover accent="true" id="S3.SS2.p2.3.m2.2.2.3.2" xref="S3.SS2.p2.3.m2.2.2.3.2.cmml"><mi id="S3.SS2.p2.3.m2.2.2.3.2.2" xref="S3.SS2.p2.3.m2.2.2.3.2.2.cmml">y</mi><mo id="S3.SS2.p2.3.m2.2.2.3.2.1" xref="S3.SS2.p2.3.m2.2.2.3.2.1.cmml">^</mo></mover><mi id="S3.SS2.p2.3.m2.2.2.3.3" xref="S3.SS2.p2.3.m2.2.2.3.3.cmml">l</mi></msub><mo id="S3.SS2.p2.3.m2.2.2.2" xref="S3.SS2.p2.3.m2.2.2.2.cmml">=</mo><mrow id="S3.SS2.p2.3.m2.2.2.1" xref="S3.SS2.p2.3.m2.2.2.1.cmml"><msubsup id="S3.SS2.p2.3.m2.2.2.1.3" xref="S3.SS2.p2.3.m2.2.2.1.3.cmml"><mi id="S3.SS2.p2.3.m2.2.2.1.3.2.2" xref="S3.SS2.p2.3.m2.2.2.1.3.2.2.cmml">f</mi><mi id="S3.SS2.p2.3.m2.2.2.1.3.3" xref="S3.SS2.p2.3.m2.2.2.1.3.3.cmml">s</mi><mi id="S3.SS2.p2.3.m2.2.2.1.3.2.3" xref="S3.SS2.p2.3.m2.2.2.1.3.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m2.2.2.1.2" xref="S3.SS2.p2.3.m2.2.2.1.2.cmml">​</mo><mrow id="S3.SS2.p2.3.m2.2.2.1.1.1" xref="S3.SS2.p2.3.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.3.m2.2.2.1.1.1.2" xref="S3.SS2.p2.3.m2.2.2.1.1.2.cmml">(</mo><msubsup id="S3.SS2.p2.3.m2.2.2.1.1.1.1" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.2" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p2.3.m2.2.2.1.1.1.1.3" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.3.cmml">s</mi><mi id="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.3" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.3.cmml">k</mi></msubsup><mo rspace="0.447em" id="S3.SS2.p2.3.m2.2.2.1.1.1.3" xref="S3.SS2.p2.3.m2.2.2.1.1.2.cmml">;</mo><mi id="S3.SS2.p2.3.m2.1.1" xref="S3.SS2.p2.3.m2.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.p2.3.m2.2.2.1.1.1.4" xref="S3.SS2.p2.3.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m2.2b"><apply id="S3.SS2.p2.3.m2.2.2.cmml" xref="S3.SS2.p2.3.m2.2.2"><eq id="S3.SS2.p2.3.m2.2.2.2.cmml" xref="S3.SS2.p2.3.m2.2.2.2"></eq><apply id="S3.SS2.p2.3.m2.2.2.3.cmml" xref="S3.SS2.p2.3.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m2.2.2.3.1.cmml" xref="S3.SS2.p2.3.m2.2.2.3">subscript</csymbol><apply id="S3.SS2.p2.3.m2.2.2.3.2.cmml" xref="S3.SS2.p2.3.m2.2.2.3.2"><ci id="S3.SS2.p2.3.m2.2.2.3.2.1.cmml" xref="S3.SS2.p2.3.m2.2.2.3.2.1">^</ci><ci id="S3.SS2.p2.3.m2.2.2.3.2.2.cmml" xref="S3.SS2.p2.3.m2.2.2.3.2.2">𝑦</ci></apply><ci id="S3.SS2.p2.3.m2.2.2.3.3.cmml" xref="S3.SS2.p2.3.m2.2.2.3.3">𝑙</ci></apply><apply id="S3.SS2.p2.3.m2.2.2.1.cmml" xref="S3.SS2.p2.3.m2.2.2.1"><times id="S3.SS2.p2.3.m2.2.2.1.2.cmml" xref="S3.SS2.p2.3.m2.2.2.1.2"></times><apply id="S3.SS2.p2.3.m2.2.2.1.3.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m2.2.2.1.3.1.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3">subscript</csymbol><apply id="S3.SS2.p2.3.m2.2.2.1.3.2.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m2.2.2.1.3.2.1.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3">superscript</csymbol><ci id="S3.SS2.p2.3.m2.2.2.1.3.2.2.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3.2.2">𝑓</ci><ci id="S3.SS2.p2.3.m2.2.2.1.3.2.3.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3.2.3">𝑘</ci></apply><ci id="S3.SS2.p2.3.m2.2.2.1.3.3.cmml" xref="S3.SS2.p2.3.m2.2.2.1.3.3">𝑠</ci></apply><list id="S3.SS2.p2.3.m2.2.2.1.1.2.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1"><apply id="S3.SS2.p2.3.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p2.3.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p2.3.m2.2.2.1.1.1.1.3">𝑠</ci></apply><ci id="S3.SS2.p2.3.m2.1.1.cmml" xref="S3.SS2.p2.3.m2.1.1">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m2.2c">\hat{y}_{l}=f^{k}_{s}(w^{k}_{s};\;x)</annotation></semantics></math> from the fine-tuned model on the input <math id="S3.SS2.p2.4.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p2.4.m3.1a"><mi id="S3.SS2.p2.4.m3.1.1" xref="S3.SS2.p2.4.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m3.1b"><ci id="S3.SS2.p2.4.m3.1.1.cmml" xref="S3.SS2.p2.4.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m3.1c">x</annotation></semantics></math> and <math id="S3.SS2.p2.5.m4.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="S3.SS2.p2.5.m4.1a"><msup id="S3.SS2.p2.5.m4.1.1" xref="S3.SS2.p2.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.5.m4.1.1.2" xref="S3.SS2.p2.5.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p2.5.m4.1.1.3" xref="S3.SS2.p2.5.m4.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m4.1b"><apply id="S3.SS2.p2.5.m4.1.1.cmml" xref="S3.SS2.p2.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m4.1.1.1.cmml" xref="S3.SS2.p2.5.m4.1.1">superscript</csymbol><ci id="S3.SS2.p2.5.m4.1.1.2.cmml" xref="S3.SS2.p2.5.m4.1.1.2">𝒟</ci><ci id="S3.SS2.p2.5.m4.1.1.3.cmml" xref="S3.SS2.p2.5.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m4.1c">\mathcal{D}^{k}</annotation></semantics></math> is the <math id="S3.SS2.p2.6.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p2.6.m5.1a"><mi id="S3.SS2.p2.6.m5.1.1" xref="S3.SS2.p2.6.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m5.1b"><ci id="S3.SS2.p2.6.m5.1.1.cmml" xref="S3.SS2.p2.6.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m5.1c">k</annotation></semantics></math>th clients dataset.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.3" class="ltx_p"><span id="S3.SS2.p3.3.1" class="ltx_text ltx_font_bold">Step 3: Train local mixtures.</span> The local mixture of experts are trained using the gating models <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="h^{k}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">h^{k}</annotation></semantics></math>, with the prediction error given by weighing the trained models <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑓</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">f_{g}</annotation></semantics></math> and <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="f^{k}_{s}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msubsup id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2.2" xref="S3.SS2.p3.3.m3.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">s</mi><mi id="S3.SS2.p3.3.m3.1.1.2.3" xref="S3.SS2.p3.3.m3.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><apply id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2.2">𝑓</ci><ci id="S3.SS2.p3.3.m3.1.1.2.3.cmml" xref="S3.SS2.p3.3.m3.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">f^{k}_{s}</annotation></semantics></math>:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.8" class="ltx_Math" alttext="\hat{y}_{h}=h^{k}(x)f^{k}_{s}(x)+\left(1-h^{k}(x)\right)f_{g}(x)\quad\forall k=1,\dots,n." display="block"><semantics id="S3.E6.m1.8a"><mrow id="S3.E6.m1.8.8.1"><mrow id="S3.E6.m1.8.8.1.1.2" xref="S3.E6.m1.8.8.1.1.3.cmml"><mrow id="S3.E6.m1.8.8.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.cmml"><msub id="S3.E6.m1.8.8.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.1.3.cmml"><mover accent="true" id="S3.E6.m1.8.8.1.1.1.1.3.2" xref="S3.E6.m1.8.8.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.8.8.1.1.1.1.3.2.2" xref="S3.E6.m1.8.8.1.1.1.1.3.2.2.cmml">y</mi><mo id="S3.E6.m1.8.8.1.1.1.1.3.2.1" xref="S3.E6.m1.8.8.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E6.m1.8.8.1.1.1.1.3.3" xref="S3.E6.m1.8.8.1.1.1.1.3.3.cmml">h</mi></msub><mo id="S3.E6.m1.8.8.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.8.8.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml"><msup id="S3.E6.m1.8.8.1.1.1.1.1.3.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.8.8.1.1.1.1.1.3.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2.2.cmml">h</mi><mi id="S3.E6.m1.8.8.1.1.1.1.1.3.2.3" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.1.1.3.1" xref="S3.E6.m1.8.8.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.3.3.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.3.3.2.1" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.1.1.3.1a" xref="S3.E6.m1.8.8.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S3.E6.m1.8.8.1.1.1.1.1.3.4" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.cmml"><mi id="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.2.cmml">f</mi><mi id="S3.E6.m1.8.8.1.1.1.1.1.3.4.3" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.3.cmml">s</mi><mi id="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.3" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.1.1.3.1b" xref="S3.E6.m1.8.8.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.3.5.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.3.5.2.1" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.3.5.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.8.8.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml"><msup id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.2.cmml">h</mi><mi id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.2.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.1.1.1.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E6.m1.8.8.1.1.1.1.1.1.3" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E6.m1.8.8.1.1.1.1.1.1.3.3" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.8.8.1.1.1.1.1.1.2a" xref="S3.E6.m1.8.8.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.8.8.1.1.1.1.1.1.4.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.1.4.2.1" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">x</mi><mo stretchy="false" id="S3.E6.m1.8.8.1.1.1.1.1.1.4.2.2" xref="S3.E6.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mspace width="1.167em" id="S3.E6.m1.8.8.1.1.2.3" xref="S3.E6.m1.8.8.1.1.3a.cmml"></mspace><mrow id="S3.E6.m1.8.8.1.1.2.2" xref="S3.E6.m1.8.8.1.1.2.2.cmml"><mrow id="S3.E6.m1.8.8.1.1.2.2.2" xref="S3.E6.m1.8.8.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S3.E6.m1.8.8.1.1.2.2.2.1" xref="S3.E6.m1.8.8.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E6.m1.8.8.1.1.2.2.2.2" xref="S3.E6.m1.8.8.1.1.2.2.2.2.cmml">k</mi></mrow><mo id="S3.E6.m1.8.8.1.1.2.2.1" xref="S3.E6.m1.8.8.1.1.2.2.1.cmml">=</mo><mrow id="S3.E6.m1.8.8.1.1.2.2.3.2" xref="S3.E6.m1.8.8.1.1.2.2.3.1.cmml"><mn id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">1</mn><mo id="S3.E6.m1.8.8.1.1.2.2.3.2.1" xref="S3.E6.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml">…</mi><mo id="S3.E6.m1.8.8.1.1.2.2.3.2.2" xref="S3.E6.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S3.E6.m1.7.7" xref="S3.E6.m1.7.7.cmml">n</mi></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.8.8.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.8b"><apply id="S3.E6.m1.8.8.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.3a.cmml" xref="S3.E6.m1.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.8.8.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1"><eq id="S3.E6.m1.8.8.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.2"></eq><apply id="S3.E6.m1.8.8.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.3">subscript</csymbol><apply id="S3.E6.m1.8.8.1.1.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.3.2"><ci id="S3.E6.m1.8.8.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.3.2.1">^</ci><ci id="S3.E6.m1.8.8.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S3.E6.m1.8.8.1.1.1.1.3.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.3.3">ℎ</ci></apply><apply id="S3.E6.m1.8.8.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1"><plus id="S3.E6.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.2"></plus><apply id="S3.E6.m1.8.8.1.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3"><times id="S3.E6.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.1"></times><apply id="S3.E6.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2.2">ℎ</ci><ci id="S3.E6.m1.8.8.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑥</ci><apply id="S3.E6.m1.8.8.1.1.1.1.1.3.4.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.3.4.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4">subscript</csymbol><apply id="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4">superscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.2">𝑓</ci><ci id="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.2.3">𝑘</ci></apply><ci id="S3.E6.m1.8.8.1.1.1.1.1.3.4.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.3.4.3">𝑠</ci></apply><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝑥</ci></apply><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1"><times id="S3.E6.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3"><times id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.2">ℎ</ci><ci id="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑥</ci></apply></apply><apply id="S3.E6.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E6.m1.8.8.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.8.8.1.1.1.1.1.1.3.3">𝑔</ci></apply><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑥</ci></apply></apply></apply><apply id="S3.E6.m1.8.8.1.1.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.2"><eq id="S3.E6.m1.8.8.1.1.2.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.2.1"></eq><apply id="S3.E6.m1.8.8.1.1.2.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.2.2"><csymbol cd="latexml" id="S3.E6.m1.8.8.1.1.2.2.2.1.cmml" xref="S3.E6.m1.8.8.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E6.m1.8.8.1.1.2.2.2.2.cmml" xref="S3.E6.m1.8.8.1.1.2.2.2.2">𝑘</ci></apply><list id="S3.E6.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.E6.m1.8.8.1.1.2.2.3.2"><cn type="integer" id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">1</cn><ci id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6">…</ci><ci id="S3.E6.m1.7.7.cmml" xref="S3.E6.m1.7.7">𝑛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.8c">\hat{y}_{h}=h^{k}(x)f^{k}_{s}(x)+\left(1-h^{k}(x)\right)f_{g}(x)\quad\forall k=1,\dots,n.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.5" class="ltx_p">In other words, at the end of a communication round, given <math id="S3.SS2.p3.4.m1.1" class="ltx_Math" alttext="f^{k}_{s}" display="inline"><semantics id="S3.SS2.p3.4.m1.1a"><msubsup id="S3.SS2.p3.4.m1.1.1" xref="S3.SS2.p3.4.m1.1.1.cmml"><mi id="S3.SS2.p3.4.m1.1.1.2.2" xref="S3.SS2.p3.4.m1.1.1.2.2.cmml">f</mi><mi id="S3.SS2.p3.4.m1.1.1.3" xref="S3.SS2.p3.4.m1.1.1.3.cmml">s</mi><mi id="S3.SS2.p3.4.m1.1.1.2.3" xref="S3.SS2.p3.4.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m1.1b"><apply id="S3.SS2.p3.4.m1.1.1.cmml" xref="S3.SS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m1.1.1.1.cmml" xref="S3.SS2.p3.4.m1.1.1">subscript</csymbol><apply id="S3.SS2.p3.4.m1.1.1.2.cmml" xref="S3.SS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m1.1.1.2.1.cmml" xref="S3.SS2.p3.4.m1.1.1">superscript</csymbol><ci id="S3.SS2.p3.4.m1.1.1.2.2.cmml" xref="S3.SS2.p3.4.m1.1.1.2.2">𝑓</ci><ci id="S3.SS2.p3.4.m1.1.1.2.3.cmml" xref="S3.SS2.p3.4.m1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p3.4.m1.1.1.3.cmml" xref="S3.SS2.p3.4.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m1.1c">f^{k}_{s}</annotation></semantics></math> and <math id="S3.SS2.p3.5.m2.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S3.SS2.p3.5.m2.1a"><msub id="S3.SS2.p3.5.m2.1.1" xref="S3.SS2.p3.5.m2.1.1.cmml"><mi id="S3.SS2.p3.5.m2.1.1.2" xref="S3.SS2.p3.5.m2.1.1.2.cmml">f</mi><mi id="S3.SS2.p3.5.m2.1.1.3" xref="S3.SS2.p3.5.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m2.1b"><apply id="S3.SS2.p3.5.m2.1.1.cmml" xref="S3.SS2.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m2.1.1.1.cmml" xref="S3.SS2.p3.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m2.1.1.2.cmml" xref="S3.SS2.p3.5.m2.1.1.2">𝑓</ci><ci id="S3.SS2.p3.5.m2.1.1.3.cmml" xref="S3.SS2.p3.5.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m2.1c">f_{g}</annotation></semantics></math>, we optimize the mixture (<a href="#S3.E6" title="In 3.2 Optimization problem ‣ 3 Federated learning using a mixture of experts ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>):</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.8" class="ltx_Math" alttext="\min_{w_{g},w^{k}_{s},w^{k}_{h}}\mathbb{E}_{(x,y)\sim\mathcal{D}^{k}}\left[\ell_{k}(w_{g},w^{k}_{s},w^{k}_{h};\;x,y,\hat{y}_{h})\right]," display="block"><semantics id="S3.E7.m1.8a"><mrow id="S3.E7.m1.8.8.1" xref="S3.E7.m1.8.8.1.1.cmml"><mrow id="S3.E7.m1.8.8.1.1" xref="S3.E7.m1.8.8.1.1.cmml"><mrow id="S3.E7.m1.8.8.1.1.3" xref="S3.E7.m1.8.8.1.1.3.cmml"><munder id="S3.E7.m1.8.8.1.1.3.1" xref="S3.E7.m1.8.8.1.1.3.1.cmml"><mi id="S3.E7.m1.8.8.1.1.3.1.2" xref="S3.E7.m1.8.8.1.1.3.1.2.cmml">min</mi><mrow id="S3.E7.m1.3.3.3.3" xref="S3.E7.m1.3.3.3.4.cmml"><msub id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.E7.m1.3.3.3.3.4" xref="S3.E7.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.cmml">w</mi><mi id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml">s</mi><mi id="S3.E7.m1.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S3.E7.m1.3.3.3.3.5" xref="S3.E7.m1.3.3.3.4.cmml">,</mo><msubsup id="S3.E7.m1.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.cmml"><mi id="S3.E7.m1.3.3.3.3.3.2.2" xref="S3.E7.m1.3.3.3.3.3.2.2.cmml">w</mi><mi id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">h</mi><mi id="S3.E7.m1.3.3.3.3.3.2.3" xref="S3.E7.m1.3.3.3.3.3.2.3.cmml">k</mi></msubsup></mrow></munder><mo lspace="0.167em" id="S3.E7.m1.8.8.1.1.3a" xref="S3.E7.m1.8.8.1.1.3.cmml">⁡</mo><msub id="S3.E7.m1.8.8.1.1.3.2" xref="S3.E7.m1.8.8.1.1.3.2.cmml"><mi id="S3.E7.m1.8.8.1.1.3.2.2" xref="S3.E7.m1.8.8.1.1.3.2.2.cmml">𝔼</mi><mrow id="S3.E7.m1.5.5.2" xref="S3.E7.m1.5.5.2.cmml"><mrow id="S3.E7.m1.5.5.2.4.2" xref="S3.E7.m1.5.5.2.4.1.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.2.4.2.1" xref="S3.E7.m1.5.5.2.4.1.cmml">(</mo><mi id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.cmml">x</mi><mo id="S3.E7.m1.5.5.2.4.2.2" xref="S3.E7.m1.5.5.2.4.1.cmml">,</mo><mi id="S3.E7.m1.5.5.2.2" xref="S3.E7.m1.5.5.2.2.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.5.5.2.4.2.3" xref="S3.E7.m1.5.5.2.4.1.cmml">)</mo></mrow><mo id="S3.E7.m1.5.5.2.3" xref="S3.E7.m1.5.5.2.3.cmml">∼</mo><msup id="S3.E7.m1.5.5.2.5" xref="S3.E7.m1.5.5.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.5.5.2.5.2" xref="S3.E7.m1.5.5.2.5.2.cmml">𝒟</mi><mi id="S3.E7.m1.5.5.2.5.3" xref="S3.E7.m1.5.5.2.5.3.cmml">k</mi></msup></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.2" xref="S3.E7.m1.8.8.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.8.8.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.2.cmml"><mo id="S3.E7.m1.8.8.1.1.1.1.2" xref="S3.E7.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.8.8.1.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.1.cmml"><msub id="S3.E7.m1.8.8.1.1.1.1.1.6" xref="S3.E7.m1.8.8.1.1.1.1.1.6.cmml"><mi mathvariant="normal" id="S3.E7.m1.8.8.1.1.1.1.1.6.2" xref="S3.E7.m1.8.8.1.1.1.1.1.6.2.cmml">ℓ</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.6.3" xref="S3.E7.m1.8.8.1.1.1.1.1.6.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.1.1.1.1.1.5" xref="S3.E7.m1.8.8.1.1.1.1.1.5.cmml">​</mo><mrow id="S3.E7.m1.8.8.1.1.1.1.1.4.4" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml"><mo stretchy="false" id="S3.E7.m1.8.8.1.1.1.1.1.4.4.5" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">(</mo><msub id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.E7.m1.8.8.1.1.1.1.1.4.4.6" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.2" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.2.cmml">w</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.3.cmml">s</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.3" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.3.cmml">k</mi></msubsup><mo id="S3.E7.m1.8.8.1.1.1.1.1.4.4.7" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">,</mo><msubsup id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.2" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.2.cmml">w</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.3" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.3.cmml">h</mi><mi id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.3" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.3.cmml">k</mi></msubsup><mo rspace="0.447em" id="S3.E7.m1.8.8.1.1.1.1.1.4.4.8" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">;</mo><mi id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml">x</mi><mo id="S3.E7.m1.8.8.1.1.1.1.1.4.4.9" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">,</mo><mi id="S3.E7.m1.7.7" xref="S3.E7.m1.7.7.cmml">y</mi><mo id="S3.E7.m1.8.8.1.1.1.1.1.4.4.10" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.cmml"><mover accent="true" id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.cmml"><mi id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.2" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.2.cmml">y</mi><mo id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.1" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.1.cmml">^</mo></mover><mi id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.3" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.3.cmml">h</mi></msub><mo stretchy="false" id="S3.E7.m1.8.8.1.1.1.1.1.4.4.11" xref="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.8.8.1.1.1.1.3" xref="S3.E7.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E7.m1.8.8.1.2" xref="S3.E7.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.8b"><apply id="S3.E7.m1.8.8.1.1.cmml" xref="S3.E7.m1.8.8.1"><times id="S3.E7.m1.8.8.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.2"></times><apply id="S3.E7.m1.8.8.1.1.3.cmml" xref="S3.E7.m1.8.8.1.1.3"><apply id="S3.E7.m1.8.8.1.1.3.1.cmml" xref="S3.E7.m1.8.8.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.3.1.1.cmml" xref="S3.E7.m1.8.8.1.1.3.1">subscript</csymbol><min id="S3.E7.m1.8.8.1.1.3.1.2.cmml" xref="S3.E7.m1.8.8.1.1.3.1.2"></min><list id="S3.E7.m1.3.3.3.4.cmml" xref="S3.E7.m1.3.3.3.3"><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.E7.m1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2">𝑤</ci><ci id="S3.E7.m1.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3">𝑠</ci></apply><apply id="S3.E7.m1.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.3.3.1.cmml" xref="S3.E7.m1.3.3.3.3.3">subscript</csymbol><apply id="S3.E7.m1.3.3.3.3.3.2.cmml" xref="S3.E7.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.3.3.2.1.cmml" xref="S3.E7.m1.3.3.3.3.3">superscript</csymbol><ci id="S3.E7.m1.3.3.3.3.3.2.2.cmml" xref="S3.E7.m1.3.3.3.3.3.2.2">𝑤</ci><ci id="S3.E7.m1.3.3.3.3.3.2.3.cmml" xref="S3.E7.m1.3.3.3.3.3.2.3">𝑘</ci></apply><ci id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3">ℎ</ci></apply></list></apply><apply id="S3.E7.m1.8.8.1.1.3.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.3.2.1.cmml" xref="S3.E7.m1.8.8.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.3.2.2.cmml" xref="S3.E7.m1.8.8.1.1.3.2.2">𝔼</ci><apply id="S3.E7.m1.5.5.2.cmml" xref="S3.E7.m1.5.5.2"><csymbol cd="latexml" id="S3.E7.m1.5.5.2.3.cmml" xref="S3.E7.m1.5.5.2.3">similar-to</csymbol><interval closure="open" id="S3.E7.m1.5.5.2.4.1.cmml" xref="S3.E7.m1.5.5.2.4.2"><ci id="S3.E7.m1.4.4.1.1.cmml" xref="S3.E7.m1.4.4.1.1">𝑥</ci><ci id="S3.E7.m1.5.5.2.2.cmml" xref="S3.E7.m1.5.5.2.2">𝑦</ci></interval><apply id="S3.E7.m1.5.5.2.5.cmml" xref="S3.E7.m1.5.5.2.5"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.2.5.1.cmml" xref="S3.E7.m1.5.5.2.5">superscript</csymbol><ci id="S3.E7.m1.5.5.2.5.2.cmml" xref="S3.E7.m1.5.5.2.5.2">𝒟</ci><ci id="S3.E7.m1.5.5.2.5.3.cmml" xref="S3.E7.m1.5.5.2.5.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E7.m1.8.8.1.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.8.8.1.1.1.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.8.8.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1"><times id="S3.E7.m1.8.8.1.1.1.1.1.5.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.5"></times><apply id="S3.E7.m1.8.8.1.1.1.1.1.6.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.6.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.1.6.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.6.2">ℓ</ci><ci id="S3.E7.m1.8.8.1.1.1.1.1.6.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.6.3">𝑘</ci></apply><vector id="S3.E7.m1.8.8.1.1.1.1.1.4.5.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4"><apply id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.2">𝑤</ci><ci id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.2.2.2.3">𝑠</ci></apply><apply id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3">subscript</csymbol><apply id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3">superscript</csymbol><ci id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.2">𝑤</ci><ci id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.2.3">𝑘</ci></apply><ci id="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.3.3.3.3">ℎ</ci></apply><ci id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6">𝑥</ci><ci id="S3.E7.m1.7.7.cmml" xref="S3.E7.m1.7.7">𝑦</ci><apply id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4">subscript</csymbol><apply id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2"><ci id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.1.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.1">^</ci><ci id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.2.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.2.2">𝑦</ci></apply><ci id="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.3.cmml" xref="S3.E7.m1.8.8.1.1.1.1.1.4.4.4.3">ℎ</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.8c">\min_{w_{g},w^{k}_{s},w^{k}_{h}}\mathbb{E}_{(x,y)\sim\mathcal{D}^{k}}\left[\ell_{k}(w_{g},w^{k}_{s},w^{k}_{h};\;x,y,\hat{y}_{h})\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.15" class="ltx_p">locally for every client <math id="S3.SS2.p3.6.m1.3" class="ltx_Math" alttext="k=1,\dots,n" display="inline"><semantics id="S3.SS2.p3.6.m1.3a"><mrow id="S3.SS2.p3.6.m1.3.4" xref="S3.SS2.p3.6.m1.3.4.cmml"><mi id="S3.SS2.p3.6.m1.3.4.2" xref="S3.SS2.p3.6.m1.3.4.2.cmml">k</mi><mo id="S3.SS2.p3.6.m1.3.4.1" xref="S3.SS2.p3.6.m1.3.4.1.cmml">=</mo><mrow id="S3.SS2.p3.6.m1.3.4.3.2" xref="S3.SS2.p3.6.m1.3.4.3.1.cmml"><mn id="S3.SS2.p3.6.m1.1.1" xref="S3.SS2.p3.6.m1.1.1.cmml">1</mn><mo id="S3.SS2.p3.6.m1.3.4.3.2.1" xref="S3.SS2.p3.6.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.6.m1.2.2" xref="S3.SS2.p3.6.m1.2.2.cmml">…</mi><mo id="S3.SS2.p3.6.m1.3.4.3.2.2" xref="S3.SS2.p3.6.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS2.p3.6.m1.3.3" xref="S3.SS2.p3.6.m1.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m1.3b"><apply id="S3.SS2.p3.6.m1.3.4.cmml" xref="S3.SS2.p3.6.m1.3.4"><eq id="S3.SS2.p3.6.m1.3.4.1.cmml" xref="S3.SS2.p3.6.m1.3.4.1"></eq><ci id="S3.SS2.p3.6.m1.3.4.2.cmml" xref="S3.SS2.p3.6.m1.3.4.2">𝑘</ci><list id="S3.SS2.p3.6.m1.3.4.3.1.cmml" xref="S3.SS2.p3.6.m1.3.4.3.2"><cn type="integer" id="S3.SS2.p3.6.m1.1.1.cmml" xref="S3.SS2.p3.6.m1.1.1">1</cn><ci id="S3.SS2.p3.6.m1.2.2.cmml" xref="S3.SS2.p3.6.m1.2.2">…</ci><ci id="S3.SS2.p3.6.m1.3.3.cmml" xref="S3.SS2.p3.6.m1.3.3">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m1.3c">k=1,\dots,n</annotation></semantics></math>. Here, <math id="S3.SS2.p3.7.m2.1" class="ltx_Math" alttext="\ell_{k}" display="inline"><semantics id="S3.SS2.p3.7.m2.1a"><msub id="S3.SS2.p3.7.m2.1.1" xref="S3.SS2.p3.7.m2.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.p3.7.m2.1.1.2" xref="S3.SS2.p3.7.m2.1.1.2.cmml">ℓ</mi><mi id="S3.SS2.p3.7.m2.1.1.3" xref="S3.SS2.p3.7.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m2.1b"><apply id="S3.SS2.p3.7.m2.1.1.cmml" xref="S3.SS2.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m2.1.1.1.cmml" xref="S3.SS2.p3.7.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m2.1.1.2.cmml" xref="S3.SS2.p3.7.m2.1.1.2">ℓ</ci><ci id="S3.SS2.p3.7.m2.1.1.3.cmml" xref="S3.SS2.p3.7.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m2.1c">\ell_{k}</annotation></semantics></math> is the loss from predicting <math id="S3.SS2.p3.8.m3.1" class="ltx_Math" alttext="\hat{y}" display="inline"><semantics id="S3.SS2.p3.8.m3.1a"><mover accent="true" id="S3.SS2.p3.8.m3.1.1" xref="S3.SS2.p3.8.m3.1.1.cmml"><mi id="S3.SS2.p3.8.m3.1.1.2" xref="S3.SS2.p3.8.m3.1.1.2.cmml">y</mi><mo id="S3.SS2.p3.8.m3.1.1.1" xref="S3.SS2.p3.8.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m3.1b"><apply id="S3.SS2.p3.8.m3.1.1.cmml" xref="S3.SS2.p3.8.m3.1.1"><ci id="S3.SS2.p3.8.m3.1.1.1.cmml" xref="S3.SS2.p3.8.m3.1.1.1">^</ci><ci id="S3.SS2.p3.8.m3.1.1.2.cmml" xref="S3.SS2.p3.8.m3.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m3.1c">\hat{y}</annotation></semantics></math> for the label <math id="S3.SS2.p3.9.m4.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p3.9.m4.1a"><mi id="S3.SS2.p3.9.m4.1.1" xref="S3.SS2.p3.9.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m4.1b"><ci id="S3.SS2.p3.9.m4.1.1.cmml" xref="S3.SS2.p3.9.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m4.1c">y</annotation></semantics></math> given the input <math id="S3.SS2.p3.10.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS2.p3.10.m5.1a"><mi id="S3.SS2.p3.10.m5.1.1" xref="S3.SS2.p3.10.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m5.1b"><ci id="S3.SS2.p3.10.m5.1.1.cmml" xref="S3.SS2.p3.10.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m5.1c">x</annotation></semantics></math> with the model from (<a href="#S3.E6" title="In 3.2 Optimization problem ‣ 3 Federated learning using a mixture of experts ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) over the data distribution <math id="S3.SS2.p3.11.m6.1" class="ltx_Math" alttext="\mathcal{D}^{k}" display="inline"><semantics id="S3.SS2.p3.11.m6.1a"><msup id="S3.SS2.p3.11.m6.1.1" xref="S3.SS2.p3.11.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.11.m6.1.1.2" xref="S3.SS2.p3.11.m6.1.1.2.cmml">𝒟</mi><mi id="S3.SS2.p3.11.m6.1.1.3" xref="S3.SS2.p3.11.m6.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m6.1b"><apply id="S3.SS2.p3.11.m6.1.1.cmml" xref="S3.SS2.p3.11.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m6.1.1.1.cmml" xref="S3.SS2.p3.11.m6.1.1">superscript</csymbol><ci id="S3.SS2.p3.11.m6.1.1.2.cmml" xref="S3.SS2.p3.11.m6.1.1.2">𝒟</ci><ci id="S3.SS2.p3.11.m6.1.1.3.cmml" xref="S3.SS2.p3.11.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m6.1c">\mathcal{D}^{k}</annotation></semantics></math> of client <math id="S3.SS2.p3.12.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p3.12.m7.1a"><mi id="S3.SS2.p3.12.m7.1.1" xref="S3.SS2.p3.12.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m7.1b"><ci id="S3.SS2.p3.12.m7.1.1.cmml" xref="S3.SS2.p3.12.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m7.1c">k</annotation></semantics></math>. We freeze the weights of <math id="S3.SS2.p3.13.m8.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.SS2.p3.13.m8.1a"><msub id="S3.SS2.p3.13.m8.1.1" xref="S3.SS2.p3.13.m8.1.1.cmml"><mi id="S3.SS2.p3.13.m8.1.1.2" xref="S3.SS2.p3.13.m8.1.1.2.cmml">w</mi><mi id="S3.SS2.p3.13.m8.1.1.3" xref="S3.SS2.p3.13.m8.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.13.m8.1b"><apply id="S3.SS2.p3.13.m8.1.1.cmml" xref="S3.SS2.p3.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.13.m8.1.1.1.cmml" xref="S3.SS2.p3.13.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.13.m8.1.1.2.cmml" xref="S3.SS2.p3.13.m8.1.1.2">𝑤</ci><ci id="S3.SS2.p3.13.m8.1.1.3.cmml" xref="S3.SS2.p3.13.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.13.m8.1c">w_{g}</annotation></semantics></math>, and only update <math id="S3.SS2.p3.14.m9.1" class="ltx_Math" alttext="w_{s}^{k}" display="inline"><semantics id="S3.SS2.p3.14.m9.1a"><msubsup id="S3.SS2.p3.14.m9.1.1" xref="S3.SS2.p3.14.m9.1.1.cmml"><mi id="S3.SS2.p3.14.m9.1.1.2.2" xref="S3.SS2.p3.14.m9.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p3.14.m9.1.1.2.3" xref="S3.SS2.p3.14.m9.1.1.2.3.cmml">s</mi><mi id="S3.SS2.p3.14.m9.1.1.3" xref="S3.SS2.p3.14.m9.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.14.m9.1b"><apply id="S3.SS2.p3.14.m9.1.1.cmml" xref="S3.SS2.p3.14.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m9.1.1.1.cmml" xref="S3.SS2.p3.14.m9.1.1">superscript</csymbol><apply id="S3.SS2.p3.14.m9.1.1.2.cmml" xref="S3.SS2.p3.14.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.14.m9.1.1.2.1.cmml" xref="S3.SS2.p3.14.m9.1.1">subscript</csymbol><ci id="S3.SS2.p3.14.m9.1.1.2.2.cmml" xref="S3.SS2.p3.14.m9.1.1.2.2">𝑤</ci><ci id="S3.SS2.p3.14.m9.1.1.2.3.cmml" xref="S3.SS2.p3.14.m9.1.1.2.3">𝑠</ci></apply><ci id="S3.SS2.p3.14.m9.1.1.3.cmml" xref="S3.SS2.p3.14.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.14.m9.1c">w_{s}^{k}</annotation></semantics></math> and <math id="S3.SS2.p3.15.m10.1" class="ltx_Math" alttext="w_{h}^{k}" display="inline"><semantics id="S3.SS2.p3.15.m10.1a"><msubsup id="S3.SS2.p3.15.m10.1.1" xref="S3.SS2.p3.15.m10.1.1.cmml"><mi id="S3.SS2.p3.15.m10.1.1.2.2" xref="S3.SS2.p3.15.m10.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p3.15.m10.1.1.2.3" xref="S3.SS2.p3.15.m10.1.1.2.3.cmml">h</mi><mi id="S3.SS2.p3.15.m10.1.1.3" xref="S3.SS2.p3.15.m10.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.15.m10.1b"><apply id="S3.SS2.p3.15.m10.1.1.cmml" xref="S3.SS2.p3.15.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.15.m10.1.1.1.cmml" xref="S3.SS2.p3.15.m10.1.1">superscript</csymbol><apply id="S3.SS2.p3.15.m10.1.1.2.cmml" xref="S3.SS2.p3.15.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.15.m10.1.1.2.1.cmml" xref="S3.SS2.p3.15.m10.1.1">subscript</csymbol><ci id="S3.SS2.p3.15.m10.1.1.2.2.cmml" xref="S3.SS2.p3.15.m10.1.1.2.2">𝑤</ci><ci id="S3.SS2.p3.15.m10.1.1.2.3.cmml" xref="S3.SS2.p3.15.m10.1.1.2.3">ℎ</ci></apply><ci id="S3.SS2.p3.15.m10.1.1.3.cmml" xref="S3.SS2.p3.15.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.15.m10.1c">w_{h}^{k}</annotation></semantics></math>.
A summary of the method is described in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.2 Optimization problem ‣ 3 Federated learning using a mixture of experts ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> </figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">input:</span> Models participating in <span id="alg1.l1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> <math id="alg1.l1.m1.3" class="ltx_Math" alttext="w_{1},\dots,w_{k}" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3.2" xref="alg1.l1.m1.3.3.3.cmml"><msub id="alg1.l1.m1.2.2.1.1" xref="alg1.l1.m1.2.2.1.1.cmml"><mi id="alg1.l1.m1.2.2.1.1.2" xref="alg1.l1.m1.2.2.1.1.2.cmml">w</mi><mn id="alg1.l1.m1.2.2.1.1.3" xref="alg1.l1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m1.3.3.2.3" xref="alg1.l1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">…</mi><mo id="alg1.l1.m1.3.3.2.4" xref="alg1.l1.m1.3.3.3.cmml">,</mo><msub id="alg1.l1.m1.3.3.2.2" xref="alg1.l1.m1.3.3.2.2.cmml"><mi id="alg1.l1.m1.3.3.2.2.2" xref="alg1.l1.m1.3.3.2.2.2.cmml">w</mi><mi id="alg1.l1.m1.3.3.2.2.3" xref="alg1.l1.m1.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><list id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.2"><apply id="alg1.l1.m1.2.2.1.1.cmml" xref="alg1.l1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.2">𝑤</ci><cn type="integer" id="alg1.l1.m1.2.2.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.3">1</cn></apply><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">…</ci><apply id="alg1.l1.m1.3.3.2.2.cmml" xref="alg1.l1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.2.1.cmml" xref="alg1.l1.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.2.2.cmml" xref="alg1.l1.m1.3.3.2.2.2">𝑤</ci><ci id="alg1.l1.m1.3.3.2.2.3.cmml" xref="alg1.l1.m1.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">w_{1},\dots,w_{k}</annotation></semantics></math>, local gate <math id="alg1.l1.m2.1" class="ltx_Math" alttext="w_{h}^{k}" display="inline"><semantics id="alg1.l1.m2.1a"><msubsup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2.2" xref="alg1.l1.m2.1.1.2.2.cmml">w</mi><mi id="alg1.l1.m2.1.1.2.3" xref="alg1.l1.m2.1.1.2.3.cmml">h</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><apply id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.2.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.2.cmml" xref="alg1.l1.m2.1.1.2.2">𝑤</ci><ci id="alg1.l1.m2.1.1.2.3.cmml" xref="alg1.l1.m2.1.1.2.3">ℎ</ci></apply><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">w_{h}^{k}</annotation></semantics></math>, learning rate <math id="alg1.l1.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">\eta</annotation></semantics></math>, decay rates <math id="alg1.l1.m4.2" class="ltx_Math" alttext="\beta_{1},\beta_{2}" display="inline"><semantics id="alg1.l1.m4.2a"><mrow id="alg1.l1.m4.2.2.2" xref="alg1.l1.m4.2.2.3.cmml"><msub id="alg1.l1.m4.1.1.1.1" xref="alg1.l1.m4.1.1.1.1.cmml"><mi id="alg1.l1.m4.1.1.1.1.2" xref="alg1.l1.m4.1.1.1.1.2.cmml">β</mi><mn id="alg1.l1.m4.1.1.1.1.3" xref="alg1.l1.m4.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m4.2.2.2.3" xref="alg1.l1.m4.2.2.3.cmml">,</mo><msub id="alg1.l1.m4.2.2.2.2" xref="alg1.l1.m4.2.2.2.2.cmml"><mi id="alg1.l1.m4.2.2.2.2.2" xref="alg1.l1.m4.2.2.2.2.2.cmml">β</mi><mn id="alg1.l1.m4.2.2.2.2.3" xref="alg1.l1.m4.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.2b"><list id="alg1.l1.m4.2.2.3.cmml" xref="alg1.l1.m4.2.2.2"><apply id="alg1.l1.m4.1.1.1.1.cmml" xref="alg1.l1.m4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m4.1.1.1.1.1.cmml" xref="alg1.l1.m4.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m4.1.1.1.1.2.cmml" xref="alg1.l1.m4.1.1.1.1.2">𝛽</ci><cn type="integer" id="alg1.l1.m4.1.1.1.1.3.cmml" xref="alg1.l1.m4.1.1.1.1.3">1</cn></apply><apply id="alg1.l1.m4.2.2.2.2.cmml" xref="alg1.l1.m4.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m4.2.2.2.2.1.cmml" xref="alg1.l1.m4.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m4.2.2.2.2.2.cmml" xref="alg1.l1.m4.2.2.2.2.2">𝛽</ci><cn type="integer" id="alg1.l1.m4.2.2.2.2.3.cmml" xref="alg1.l1.m4.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.2c">\beta_{1},\beta_{2}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Initialize <math id="alg1.l2.m1.3" class="ltx_Math" alttext="w_{1},\dots,w_{k}" display="inline"><semantics id="alg1.l2.m1.3a"><mrow id="alg1.l2.m1.3.3.2" xref="alg1.l2.m1.3.3.3.cmml"><msub id="alg1.l2.m1.2.2.1.1" xref="alg1.l2.m1.2.2.1.1.cmml"><mi id="alg1.l2.m1.2.2.1.1.2" xref="alg1.l2.m1.2.2.1.1.2.cmml">w</mi><mn id="alg1.l2.m1.2.2.1.1.3" xref="alg1.l2.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l2.m1.3.3.2.3" xref="alg1.l2.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">…</mi><mo id="alg1.l2.m1.3.3.2.4" xref="alg1.l2.m1.3.3.3.cmml">,</mo><msub id="alg1.l2.m1.3.3.2.2" xref="alg1.l2.m1.3.3.2.2.cmml"><mi id="alg1.l2.m1.3.3.2.2.2" xref="alg1.l2.m1.3.3.2.2.2.cmml">w</mi><mi id="alg1.l2.m1.3.3.2.2.3" xref="alg1.l2.m1.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.3b"><list id="alg1.l2.m1.3.3.3.cmml" xref="alg1.l2.m1.3.3.2"><apply id="alg1.l2.m1.2.2.1.1.cmml" xref="alg1.l2.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l2.m1.2.2.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.2">𝑤</ci><cn type="integer" id="alg1.l2.m1.2.2.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.3">1</cn></apply><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">…</ci><apply id="alg1.l2.m1.3.3.2.2.cmml" xref="alg1.l2.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.3.3.2.2.1.cmml" xref="alg1.l2.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l2.m1.3.3.2.2.2.cmml" xref="alg1.l2.m1.3.3.2.2.2">𝑤</ci><ci id="alg1.l2.m1.3.3.2.2.3.cmml" xref="alg1.l2.m1.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.3c">w_{1},\dots,w_{k}</annotation></semantics></math> with the same random seed.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Initialize <math id="alg1.l3.m1.1" class="ltx_Math" alttext="w_{h}^{k}" display="inline"><semantics id="alg1.l3.m1.1a"><msubsup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">h</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝑤</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">ℎ</ci></apply><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">w_{h}^{k}</annotation></semantics></math>.

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.4.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <math id="alg1.l4.m1.1" class="ltx_Math" alttext="w_{g}\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l4.m1.1.1.2.3" xref="alg1.l4.m1.1.1.2.3.cmml">g</mi></msub><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.2.2">𝑤</ci><ci id="alg1.l4.m1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.2.3">𝑔</ci></apply><csymbol cd="latexml" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">w_{g}\leftarrow</annotation></semantics></math> <span id="alg1.l4.1" class="ltx_text ltx_font_smallcaps">FedAvg<math id="alg1.l4.1.m1.3" class="ltx_Math" alttext="(w_{1},\dots,w_{k})\;" display="inline"><semantics id="alg1.l4.1.m1.3a"><mrow id="alg1.l4.1.m1.3.3.2" xref="alg1.l4.1.m1.3.3.3.cmml"><mo stretchy="false" id="alg1.l4.1.m1.3.3.2.3" xref="alg1.l4.1.m1.3.3.3.cmml">(</mo><msub id="alg1.l4.1.m1.2.2.1.1" xref="alg1.l4.1.m1.2.2.1.1.cmml"><mi id="alg1.l4.1.m1.2.2.1.1.2" xref="alg1.l4.1.m1.2.2.1.1.2.cmml">w</mi><mn id="alg1.l4.1.m1.2.2.1.1.3" xref="alg1.l4.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l4.1.m1.3.3.2.4" xref="alg1.l4.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">…</mi><mo id="alg1.l4.1.m1.3.3.2.5" xref="alg1.l4.1.m1.3.3.3.cmml">,</mo><msub id="alg1.l4.1.m1.3.3.2.2" xref="alg1.l4.1.m1.3.3.2.2.cmml"><mi id="alg1.l4.1.m1.3.3.2.2.2" xref="alg1.l4.1.m1.3.3.2.2.2.cmml">w</mi><mi id="alg1.l4.1.m1.3.3.2.2.3" xref="alg1.l4.1.m1.3.3.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l4.1.m1.3.3.2.6" xref="alg1.l4.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.3b"><vector id="alg1.l4.1.m1.3.3.3.cmml" xref="alg1.l4.1.m1.3.3.2"><apply id="alg1.l4.1.m1.2.2.1.1.cmml" xref="alg1.l4.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l4.1.m1.2.2.1.1.1.cmml" xref="alg1.l4.1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l4.1.m1.2.2.1.1.2.cmml" xref="alg1.l4.1.m1.2.2.1.1.2">𝑤</ci><cn type="integer" id="alg1.l4.1.m1.2.2.1.1.3.cmml" xref="alg1.l4.1.m1.2.2.1.1.3">1</cn></apply><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">…</ci><apply id="alg1.l4.1.m1.3.3.2.2.cmml" xref="alg1.l4.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l4.1.m1.3.3.2.2.1.cmml" xref="alg1.l4.1.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l4.1.m1.3.3.2.2.2.cmml" xref="alg1.l4.1.m1.3.3.2.2.2">𝑤</ci><ci id="alg1.l4.1.m1.3.3.2.2.3.cmml" xref="alg1.l4.1.m1.3.3.2.2.3">𝑘</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.3c">(w_{1},\dots,w_{k})\;</annotation></semantics></math></span> <span id="alg1.l4.3" class="ltx_text ltx_font_italic">// Train for <math id="alg1.l4.2.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l4.2.m1.1a"><mi id="alg1.l4.2.m1.1.1" xref="alg1.l4.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.2.m1.1b"><ci id="alg1.l4.2.m1.1.1.cmml" xref="alg1.l4.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.2.m1.1c">E</annotation></semantics></math> local epochs and <math id="alg1.l4.3.m2.1" class="ltx_Math" alttext="G" display="inline"><semantics id="alg1.l4.3.m2.1a"><mi id="alg1.l4.3.m2.1.1" xref="alg1.l4.3.m2.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.3.m2.1b"><ci id="alg1.l4.3.m2.1.1.cmml" xref="alg1.l4.3.m2.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.3.m2.1c">G</annotation></semantics></math> communication rounds</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> client <math id="alg1.l5.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">k</annotation></semantics></math> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     Initialize specialist model <math id="alg1.l6.m1.1" class="ltx_Math" alttext="w_{s}^{k}\leftarrow w_{g}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2.2" xref="alg1.l6.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l6.m1.1.1.2.2.3" xref="alg1.l6.m1.1.1.2.2.3.cmml">s</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">w</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">g</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">superscript</csymbol><apply id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.2.1.cmml" xref="alg1.l6.m1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.2.cmml" xref="alg1.l6.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l6.m1.1.1.2.2.3.cmml" xref="alg1.l6.m1.1.1.2.2.3">𝑠</ci></apply><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑤</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">w_{s}^{k}\leftarrow w_{g}</annotation></semantics></math>.

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.3.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <math id="alg1.l7.m1.4" class="ltx_Math" alttext="w_{s}^{k}\leftarrow\text{Adam}(w_{s}^{k},lr,\beta_{1},\beta_{2})\;" display="inline"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml"><msubsup id="alg1.l7.m1.4.4.6" xref="alg1.l7.m1.4.4.6.cmml"><mi id="alg1.l7.m1.4.4.6.2.2" xref="alg1.l7.m1.4.4.6.2.2.cmml">w</mi><mi id="alg1.l7.m1.4.4.6.2.3" xref="alg1.l7.m1.4.4.6.2.3.cmml">s</mi><mi id="alg1.l7.m1.4.4.6.3" xref="alg1.l7.m1.4.4.6.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.4.4.5" xref="alg1.l7.m1.4.4.5.cmml">←</mo><mrow id="alg1.l7.m1.4.4.4" xref="alg1.l7.m1.4.4.4.cmml"><mtext id="alg1.l7.m1.4.4.4.6" xref="alg1.l7.m1.4.4.4.6a.cmml">Adam</mtext><mo lspace="0em" rspace="0em" id="alg1.l7.m1.4.4.4.5" xref="alg1.l7.m1.4.4.4.5.cmml">​</mo><mrow id="alg1.l7.m1.4.4.4.4.4" xref="alg1.l7.m1.4.4.4.4.5.cmml"><mo stretchy="false" id="alg1.l7.m1.4.4.4.4.4.5" xref="alg1.l7.m1.4.4.4.4.5.cmml">(</mo><msubsup id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml">s</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l7.m1.4.4.4.4.4.6" xref="alg1.l7.m1.4.4.4.4.5.cmml">,</mo><mrow id="alg1.l7.m1.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l7.m1.2.2.2.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.2.2.2.1" xref="alg1.l7.m1.2.2.2.2.2.2.1.cmml">​</mo><mi id="alg1.l7.m1.2.2.2.2.2.2.3" xref="alg1.l7.m1.2.2.2.2.2.2.3.cmml">r</mi></mrow><mo id="alg1.l7.m1.4.4.4.4.4.7" xref="alg1.l7.m1.4.4.4.4.5.cmml">,</mo><msub id="alg1.l7.m1.3.3.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l7.m1.3.3.3.3.3.3.2" xref="alg1.l7.m1.3.3.3.3.3.3.2.cmml">β</mi><mn id="alg1.l7.m1.3.3.3.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.3.3.3.cmml">1</mn></msub><mo id="alg1.l7.m1.4.4.4.4.4.8" xref="alg1.l7.m1.4.4.4.4.5.cmml">,</mo><msub id="alg1.l7.m1.4.4.4.4.4.4" xref="alg1.l7.m1.4.4.4.4.4.4.cmml"><mi id="alg1.l7.m1.4.4.4.4.4.4.2" xref="alg1.l7.m1.4.4.4.4.4.4.2.cmml">β</mi><mn id="alg1.l7.m1.4.4.4.4.4.4.3" xref="alg1.l7.m1.4.4.4.4.4.4.3.cmml">2</mn></msub><mo stretchy="false" id="alg1.l7.m1.4.4.4.4.4.9" xref="alg1.l7.m1.4.4.4.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.4b"><apply id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4"><ci id="alg1.l7.m1.4.4.5.cmml" xref="alg1.l7.m1.4.4.5">←</ci><apply id="alg1.l7.m1.4.4.6.cmml" xref="alg1.l7.m1.4.4.6"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.6.1.cmml" xref="alg1.l7.m1.4.4.6">superscript</csymbol><apply id="alg1.l7.m1.4.4.6.2.cmml" xref="alg1.l7.m1.4.4.6"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.6.2.1.cmml" xref="alg1.l7.m1.4.4.6">subscript</csymbol><ci id="alg1.l7.m1.4.4.6.2.2.cmml" xref="alg1.l7.m1.4.4.6.2.2">𝑤</ci><ci id="alg1.l7.m1.4.4.6.2.3.cmml" xref="alg1.l7.m1.4.4.6.2.3">𝑠</ci></apply><ci id="alg1.l7.m1.4.4.6.3.cmml" xref="alg1.l7.m1.4.4.6.3">𝑘</ci></apply><apply id="alg1.l7.m1.4.4.4.cmml" xref="alg1.l7.m1.4.4.4"><times id="alg1.l7.m1.4.4.4.5.cmml" xref="alg1.l7.m1.4.4.4.5"></times><ci id="alg1.l7.m1.4.4.4.6a.cmml" xref="alg1.l7.m1.4.4.4.6"><mtext id="alg1.l7.m1.4.4.4.6.cmml" xref="alg1.l7.m1.4.4.4.6">Adam</mtext></ci><vector id="alg1.l7.m1.4.4.4.4.5.cmml" xref="alg1.l7.m1.4.4.4.4.4"><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l7.m1.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2"><times id="alg1.l7.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.1"></times><ci id="alg1.l7.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.2">𝑙</ci><ci id="alg1.l7.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.2.2.2.3">𝑟</ci></apply><apply id="alg1.l7.m1.3.3.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l7.m1.3.3.3.3.3.3">subscript</csymbol><ci id="alg1.l7.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l7.m1.3.3.3.3.3.3.2">𝛽</ci><cn type="integer" id="alg1.l7.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3.3.3.3">1</cn></apply><apply id="alg1.l7.m1.4.4.4.4.4.4.cmml" xref="alg1.l7.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.4.4.4.4.1.cmml" xref="alg1.l7.m1.4.4.4.4.4.4">subscript</csymbol><ci id="alg1.l7.m1.4.4.4.4.4.4.2.cmml" xref="alg1.l7.m1.4.4.4.4.4.4.2">𝛽</ci><cn type="integer" id="alg1.l7.m1.4.4.4.4.4.4.3.cmml" xref="alg1.l7.m1.4.4.4.4.4.4.3">2</cn></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">w_{s}^{k}\leftarrow\text{Adam}(w_{s}^{k},lr,\beta_{1},\beta_{2})\;</annotation></semantics></math> <span id="alg1.l7.2" class="ltx_text ltx_font_italic">// Fine-tune <math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="alg1.l7.1.m1.1a"><msub id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml"><mi id="alg1.l7.1.m1.1.1.2" xref="alg1.l7.1.m1.1.1.2.cmml">w</mi><mi id="alg1.l7.1.m1.1.1.3" xref="alg1.l7.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><apply id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.1.m1.1.1.1.cmml" xref="alg1.l7.1.m1.1.1">subscript</csymbol><ci id="alg1.l7.1.m1.1.1.2.cmml" xref="alg1.l7.1.m1.1.1.2">𝑤</ci><ci id="alg1.l7.1.m1.1.1.3.cmml" xref="alg1.l7.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">w_{g}</annotation></semantics></math> on each client <math id="alg1.l7.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l7.2.m2.1a"><mi id="alg1.l7.2.m2.1.1" xref="alg1.l7.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.2.m2.1b"><ci id="alg1.l7.2.m2.1.1.cmml" xref="alg1.l7.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.2.m2.1c">k</annotation></semantics></math></span>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     Freeze global parameters <math id="alg1.l8.m1.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">w</mi><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑤</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">w_{g}</annotation></semantics></math>.

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.2.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <math id="alg1.l9.m1.8" class="ltx_Math" alttext="w_{s}^{k},w_{h}^{k}\leftarrow\text{Adam}(w_{g},w_{s}^{k},w_{h}^{k},lr,\beta_{1},\beta_{2})\;" display="inline"><semantics id="alg1.l9.m1.8a"><mrow id="alg1.l9.m1.8.8" xref="alg1.l9.m1.8.8.cmml"><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.3.cmml"><msubsup id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.2.3.cmml">s</mi><mi id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml">w</mi><mi id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.3.cmml">h</mi><mi id="alg1.l9.m1.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l9.m1.8.8.9" xref="alg1.l9.m1.8.8.9.cmml">←</mo><mrow id="alg1.l9.m1.8.8.8" xref="alg1.l9.m1.8.8.8.cmml"><mtext id="alg1.l9.m1.8.8.8.8" xref="alg1.l9.m1.8.8.8.8a.cmml">Adam</mtext><mo lspace="0em" rspace="0em" id="alg1.l9.m1.8.8.8.7" xref="alg1.l9.m1.8.8.8.7.cmml">​</mo><mrow id="alg1.l9.m1.8.8.8.6.6" xref="alg1.l9.m1.8.8.8.6.7.cmml"><mo stretchy="false" id="alg1.l9.m1.8.8.8.6.6.7" xref="alg1.l9.m1.8.8.8.6.7.cmml">(</mo><msub id="alg1.l9.m1.3.3.3.1.1.1" xref="alg1.l9.m1.3.3.3.1.1.1.cmml"><mi id="alg1.l9.m1.3.3.3.1.1.1.2" xref="alg1.l9.m1.3.3.3.1.1.1.2.cmml">w</mi><mi id="alg1.l9.m1.3.3.3.1.1.1.3" xref="alg1.l9.m1.3.3.3.1.1.1.3.cmml">g</mi></msub><mo id="alg1.l9.m1.8.8.8.6.6.8" xref="alg1.l9.m1.8.8.8.6.7.cmml">,</mo><msubsup id="alg1.l9.m1.4.4.4.2.2.2" xref="alg1.l9.m1.4.4.4.2.2.2.cmml"><mi id="alg1.l9.m1.4.4.4.2.2.2.2.2" xref="alg1.l9.m1.4.4.4.2.2.2.2.2.cmml">w</mi><mi id="alg1.l9.m1.4.4.4.2.2.2.2.3" xref="alg1.l9.m1.4.4.4.2.2.2.2.3.cmml">s</mi><mi id="alg1.l9.m1.4.4.4.2.2.2.3" xref="alg1.l9.m1.4.4.4.2.2.2.3.cmml">k</mi></msubsup><mo id="alg1.l9.m1.8.8.8.6.6.9" xref="alg1.l9.m1.8.8.8.6.7.cmml">,</mo><msubsup id="alg1.l9.m1.5.5.5.3.3.3" xref="alg1.l9.m1.5.5.5.3.3.3.cmml"><mi id="alg1.l9.m1.5.5.5.3.3.3.2.2" xref="alg1.l9.m1.5.5.5.3.3.3.2.2.cmml">w</mi><mi id="alg1.l9.m1.5.5.5.3.3.3.2.3" xref="alg1.l9.m1.5.5.5.3.3.3.2.3.cmml">h</mi><mi id="alg1.l9.m1.5.5.5.3.3.3.3" xref="alg1.l9.m1.5.5.5.3.3.3.3.cmml">k</mi></msubsup><mo id="alg1.l9.m1.8.8.8.6.6.10" xref="alg1.l9.m1.8.8.8.6.7.cmml">,</mo><mrow id="alg1.l9.m1.6.6.6.4.4.4" xref="alg1.l9.m1.6.6.6.4.4.4.cmml"><mi id="alg1.l9.m1.6.6.6.4.4.4.2" xref="alg1.l9.m1.6.6.6.4.4.4.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.6.6.6.4.4.4.1" xref="alg1.l9.m1.6.6.6.4.4.4.1.cmml">​</mo><mi id="alg1.l9.m1.6.6.6.4.4.4.3" xref="alg1.l9.m1.6.6.6.4.4.4.3.cmml">r</mi></mrow><mo id="alg1.l9.m1.8.8.8.6.6.11" xref="alg1.l9.m1.8.8.8.6.7.cmml">,</mo><msub id="alg1.l9.m1.7.7.7.5.5.5" xref="alg1.l9.m1.7.7.7.5.5.5.cmml"><mi id="alg1.l9.m1.7.7.7.5.5.5.2" xref="alg1.l9.m1.7.7.7.5.5.5.2.cmml">β</mi><mn id="alg1.l9.m1.7.7.7.5.5.5.3" xref="alg1.l9.m1.7.7.7.5.5.5.3.cmml">1</mn></msub><mo id="alg1.l9.m1.8.8.8.6.6.12" xref="alg1.l9.m1.8.8.8.6.7.cmml">,</mo><msub id="alg1.l9.m1.8.8.8.6.6.6" xref="alg1.l9.m1.8.8.8.6.6.6.cmml"><mi id="alg1.l9.m1.8.8.8.6.6.6.2" xref="alg1.l9.m1.8.8.8.6.6.6.2.cmml">β</mi><mn id="alg1.l9.m1.8.8.8.6.6.6.3" xref="alg1.l9.m1.8.8.8.6.6.6.3.cmml">2</mn></msub><mo stretchy="false" id="alg1.l9.m1.8.8.8.6.6.13" xref="alg1.l9.m1.8.8.8.6.7.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.8b"><apply id="alg1.l9.m1.8.8.cmml" xref="alg1.l9.m1.8.8"><ci id="alg1.l9.m1.8.8.9.cmml" xref="alg1.l9.m1.8.8.9">←</ci><list id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l9.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3">𝑘</ci></apply><apply id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">𝑤</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3">ℎ</ci></apply><ci id="alg1.l9.m1.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.3">𝑘</ci></apply></list><apply id="alg1.l9.m1.8.8.8.cmml" xref="alg1.l9.m1.8.8.8"><times id="alg1.l9.m1.8.8.8.7.cmml" xref="alg1.l9.m1.8.8.8.7"></times><ci id="alg1.l9.m1.8.8.8.8a.cmml" xref="alg1.l9.m1.8.8.8.8"><mtext id="alg1.l9.m1.8.8.8.8.cmml" xref="alg1.l9.m1.8.8.8.8">Adam</mtext></ci><vector id="alg1.l9.m1.8.8.8.6.7.cmml" xref="alg1.l9.m1.8.8.8.6.6"><apply id="alg1.l9.m1.3.3.3.1.1.1.cmml" xref="alg1.l9.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.3.3.3.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l9.m1.3.3.3.1.1.1.2">𝑤</ci><ci id="alg1.l9.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l9.m1.3.3.3.1.1.1.3">𝑔</ci></apply><apply id="alg1.l9.m1.4.4.4.2.2.2.cmml" xref="alg1.l9.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.4.2.2.2.1.cmml" xref="alg1.l9.m1.4.4.4.2.2.2">superscript</csymbol><apply id="alg1.l9.m1.4.4.4.2.2.2.2.cmml" xref="alg1.l9.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.4.4.4.2.2.2.2.1.cmml" xref="alg1.l9.m1.4.4.4.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.4.4.4.2.2.2.2.2.cmml" xref="alg1.l9.m1.4.4.4.2.2.2.2.2">𝑤</ci><ci id="alg1.l9.m1.4.4.4.2.2.2.2.3.cmml" xref="alg1.l9.m1.4.4.4.2.2.2.2.3">𝑠</ci></apply><ci id="alg1.l9.m1.4.4.4.2.2.2.3.cmml" xref="alg1.l9.m1.4.4.4.2.2.2.3">𝑘</ci></apply><apply id="alg1.l9.m1.5.5.5.3.3.3.cmml" xref="alg1.l9.m1.5.5.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.5.3.3.3.1.cmml" xref="alg1.l9.m1.5.5.5.3.3.3">superscript</csymbol><apply id="alg1.l9.m1.5.5.5.3.3.3.2.cmml" xref="alg1.l9.m1.5.5.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.5.3.3.3.2.1.cmml" xref="alg1.l9.m1.5.5.5.3.3.3">subscript</csymbol><ci id="alg1.l9.m1.5.5.5.3.3.3.2.2.cmml" xref="alg1.l9.m1.5.5.5.3.3.3.2.2">𝑤</ci><ci id="alg1.l9.m1.5.5.5.3.3.3.2.3.cmml" xref="alg1.l9.m1.5.5.5.3.3.3.2.3">ℎ</ci></apply><ci id="alg1.l9.m1.5.5.5.3.3.3.3.cmml" xref="alg1.l9.m1.5.5.5.3.3.3.3">𝑘</ci></apply><apply id="alg1.l9.m1.6.6.6.4.4.4.cmml" xref="alg1.l9.m1.6.6.6.4.4.4"><times id="alg1.l9.m1.6.6.6.4.4.4.1.cmml" xref="alg1.l9.m1.6.6.6.4.4.4.1"></times><ci id="alg1.l9.m1.6.6.6.4.4.4.2.cmml" xref="alg1.l9.m1.6.6.6.4.4.4.2">𝑙</ci><ci id="alg1.l9.m1.6.6.6.4.4.4.3.cmml" xref="alg1.l9.m1.6.6.6.4.4.4.3">𝑟</ci></apply><apply id="alg1.l9.m1.7.7.7.5.5.5.cmml" xref="alg1.l9.m1.7.7.7.5.5.5"><csymbol cd="ambiguous" id="alg1.l9.m1.7.7.7.5.5.5.1.cmml" xref="alg1.l9.m1.7.7.7.5.5.5">subscript</csymbol><ci id="alg1.l9.m1.7.7.7.5.5.5.2.cmml" xref="alg1.l9.m1.7.7.7.5.5.5.2">𝛽</ci><cn type="integer" id="alg1.l9.m1.7.7.7.5.5.5.3.cmml" xref="alg1.l9.m1.7.7.7.5.5.5.3">1</cn></apply><apply id="alg1.l9.m1.8.8.8.6.6.6.cmml" xref="alg1.l9.m1.8.8.8.6.6.6"><csymbol cd="ambiguous" id="alg1.l9.m1.8.8.8.6.6.6.1.cmml" xref="alg1.l9.m1.8.8.8.6.6.6">subscript</csymbol><ci id="alg1.l9.m1.8.8.8.6.6.6.2.cmml" xref="alg1.l9.m1.8.8.8.6.6.6.2">𝛽</ci><cn type="integer" id="alg1.l9.m1.8.8.8.6.6.6.3.cmml" xref="alg1.l9.m1.8.8.8.6.6.6.3">2</cn></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.8c">w_{s}^{k},w_{h}^{k}\leftarrow\text{Adam}(w_{g},w_{s}^{k},w_{h}^{k},lr,\beta_{1},\beta_{2})\;</annotation></semantics></math> <span id="alg1.l9.1" class="ltx_text ltx_font_italic">// Train mixture of experts on client <math id="alg1.l9.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l9.1.m1.1a"><mi id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">k</annotation></semantics></math></span>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>  <span id="alg1.l11.2" class="ltx_text ltx_font_bold">output:</span> Trained mixture of experts: global model <math id="alg1.l11.m1.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">w</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑤</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">w_{g}</annotation></semantics></math>, local experts <math id="alg1.l11.m2.1" class="ltx_Math" alttext="w_{s}^{k}" display="inline"><semantics id="alg1.l11.m2.1a"><msubsup id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml"><mi id="alg1.l11.m2.1.1.2.2" xref="alg1.l11.m2.1.1.2.2.cmml">w</mi><mi id="alg1.l11.m2.1.1.2.3" xref="alg1.l11.m2.1.1.2.3.cmml">s</mi><mi id="alg1.l11.m2.1.1.3" xref="alg1.l11.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><apply id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.1.cmml" xref="alg1.l11.m2.1.1">superscript</csymbol><apply id="alg1.l11.m2.1.1.2.cmml" xref="alg1.l11.m2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m2.1.1.2.1.cmml" xref="alg1.l11.m2.1.1">subscript</csymbol><ci id="alg1.l11.m2.1.1.2.2.cmml" xref="alg1.l11.m2.1.1.2.2">𝑤</ci><ci id="alg1.l11.m2.1.1.2.3.cmml" xref="alg1.l11.m2.1.1.2.3">𝑠</ci></apply><ci id="alg1.l11.m2.1.1.3.cmml" xref="alg1.l11.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">w_{s}^{k}</annotation></semantics></math> and local gating functions <math id="alg1.l11.m3.1" class="ltx_Math" alttext="w_{h}^{k}" display="inline"><semantics id="alg1.l11.m3.1a"><msubsup id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi id="alg1.l11.m3.1.1.2.2" xref="alg1.l11.m3.1.1.2.2.cmml">w</mi><mi id="alg1.l11.m3.1.1.2.3" xref="alg1.l11.m3.1.1.2.3.cmml">h</mi><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1">superscript</csymbol><apply id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.2.1.cmml" xref="alg1.l11.m3.1.1">subscript</csymbol><ci id="alg1.l11.m3.1.1.2.2.cmml" xref="alg1.l11.m3.1.1.2.2">𝑤</ci><ci id="alg1.l11.m3.1.1.2.3.cmml" xref="alg1.l11.m3.1.1.2.3">ℎ</ci></apply><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">w_{h}^{k}</annotation></semantics></math>.

</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental setup</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We use two different ways of sampling client data to simulate heterogeneous distributions. The first setup is a more generalized version of the pathological non-iid setup as described in <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite> where each client is only assigned 2 classes. The second sampling strategy is performed using the Dirichlet distribution as described in <cite class="ltx_cite ltx_citemacro_citep">(Yurochkin et al., <a href="#bib.bib30" title="" class="ltx_ref">2019</a>; Hsu et al., <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p"><span id="S4.p2.1.1" class="ltx_text ltx_font_bold">Datasets and models.</span> Our experiments are carried out using two model architectures on three datasets. The dataset used are CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib19" title="" class="ltx_ref">2009</a>)</cite>, Fashion-MNIST <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a href="#bib.bib29" title="" class="ltx_ref">2017</a>)</cite>, and AG News <cite class="ltx_cite ltx_citemacro_citep">(Gulli, <a href="#bib.bib6" title="" class="ltx_ref">2004</a>)</cite>.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">The CIFAR-10 dataset consists of 60 000 32x32 color images in 10 classes, with 6000 images per class. The dataset is split into 50 000 training images and 10 000 test images.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">The Fashion-MNIST dataset contains 70 000 28x28 gray-scale images of Zalando clothing in 10 classes. It is split into 60 000 training images and 10 000 test images.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">The AG News topic classification dataset consists of 4 classes, each of which contains 30 000 training samples and 1 900 testing samples. In total there are 120 000 training samples and 7 600 testing samples.</p>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.5" class="ltx_p">For CIFAR-10 and Fashion-MNIST, the specialist model <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="f_{s}" display="inline"><semantics id="S4.p6.1.m1.1a"><msub id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">f</mi><mi id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1">subscript</csymbol><ci id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2">𝑓</ci><ci id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">f_{s}</annotation></semantics></math> and the global model <math id="S4.p6.2.m2.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S4.p6.2.m2.1a"><msub id="S4.p6.2.m2.1.1" xref="S4.p6.2.m2.1.1.cmml"><mi id="S4.p6.2.m2.1.1.2" xref="S4.p6.2.m2.1.1.2.cmml">f</mi><mi id="S4.p6.2.m2.1.1.3" xref="S4.p6.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.2.m2.1b"><apply id="S4.p6.2.m2.1.1.cmml" xref="S4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.1.cmml" xref="S4.p6.2.m2.1.1">subscript</csymbol><ci id="S4.p6.2.m2.1.1.2.cmml" xref="S4.p6.2.m2.1.1.2">𝑓</ci><ci id="S4.p6.2.m2.1.1.3.cmml" xref="S4.p6.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">f_{g}</annotation></semantics></math> are CNNs with the same architecture. The CNN has two convolutional layers, each with a kernel size of 5 (the first with 6 channels, the second with 16), and two fully-connected layers with 120 and 84 units, respectively, with ReLU activations. This is followed by an output layer with a softmax activation. The gating function <math id="S4.p6.3.m3.1" class="ltx_Math" alttext="h_{k}" display="inline"><semantics id="S4.p6.3.m3.1a"><msub id="S4.p6.3.m3.1.1" xref="S4.p6.3.m3.1.1.cmml"><mi id="S4.p6.3.m3.1.1.2" xref="S4.p6.3.m3.1.1.2.cmml">h</mi><mi id="S4.p6.3.m3.1.1.3" xref="S4.p6.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.3.m3.1b"><apply id="S4.p6.3.m3.1.1.cmml" xref="S4.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p6.3.m3.1.1.1.cmml" xref="S4.p6.3.m3.1.1">subscript</csymbol><ci id="S4.p6.3.m3.1.1.2.cmml" xref="S4.p6.3.m3.1.1.2">ℎ</ci><ci id="S4.p6.3.m3.1.1.3.cmml" xref="S4.p6.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m3.1c">h_{k}</annotation></semantics></math> has the same architecture as <math id="S4.p6.4.m4.1" class="ltx_Math" alttext="f_{g}" display="inline"><semantics id="S4.p6.4.m4.1a"><msub id="S4.p6.4.m4.1.1" xref="S4.p6.4.m4.1.1.cmml"><mi id="S4.p6.4.m4.1.1.2" xref="S4.p6.4.m4.1.1.2.cmml">f</mi><mi id="S4.p6.4.m4.1.1.3" xref="S4.p6.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.4.m4.1b"><apply id="S4.p6.4.m4.1.1.cmml" xref="S4.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p6.4.m4.1.1.1.cmml" xref="S4.p6.4.m4.1.1">subscript</csymbol><ci id="S4.p6.4.m4.1.1.2.cmml" xref="S4.p6.4.m4.1.1.2">𝑓</ci><ci id="S4.p6.4.m4.1.1.3.cmml" xref="S4.p6.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.4.m4.1c">f_{g}</annotation></semantics></math> and <math id="S4.p6.5.m5.1" class="ltx_Math" alttext="f_{s}" display="inline"><semantics id="S4.p6.5.m5.1a"><msub id="S4.p6.5.m5.1.1" xref="S4.p6.5.m5.1.1.cmml"><mi id="S4.p6.5.m5.1.1.2" xref="S4.p6.5.m5.1.1.2.cmml">f</mi><mi id="S4.p6.5.m5.1.1.3" xref="S4.p6.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.5.m5.1b"><apply id="S4.p6.5.m5.1.1.cmml" xref="S4.p6.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p6.5.m5.1.1.1.cmml" xref="S4.p6.5.m5.1.1">subscript</csymbol><ci id="S4.p6.5.m5.1.1.2.cmml" xref="S4.p6.5.m5.1.1.2">𝑓</ci><ci id="S4.p6.5.m5.1.1.3.cmml" xref="S4.p6.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.5.m5.1c">f_{s}</annotation></semantics></math>, but with a sigmoid activation in the output layer instead of a softmax.</p>
</div>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.1" class="ltx_p">For AG News, both the local and the global models consist of an embedding layer with a dimension size of 100, a bi-directional LSTM layer with 64 nodes followed by an output layer with a softmax activation. The gating function has the same architecture in this case as well, but with a sigmoid activation in the output layer. We use the Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib17" title="" class="ltx_ref">2014</a>)</cite> to train all models.</p>
</div>
<div id="S4.p8" class="ltx_para">
<p id="S4.p8.6" class="ltx_p"><span id="S4.p8.6.1" class="ltx_text ltx_font_bold">Pathological non-iid sampling.</span> The first way we create a skewed non-iid dataset for each client is by constructing a subset for each client with oversampling of specific classes. Sampling is performed such that the dataset of each client contains two majority classes which together form a fraction <math id="S4.p8.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.p8.1.m1.1a"><mi id="S4.p8.1.m1.1.1" xref="S4.p8.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.p8.1.m1.1b"><ci id="S4.p8.1.m1.1.1.cmml" xref="S4.p8.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.1.m1.1c">p</annotation></semantics></math> of the client data and the remaining classes form a fraction <math id="S4.p8.2.m2.1" class="ltx_Math" alttext="(1-p)" display="inline"><semantics id="S4.p8.2.m2.1a"><mrow id="S4.p8.2.m2.1.1.1" xref="S4.p8.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="S4.p8.2.m2.1.1.1.2" xref="S4.p8.2.m2.1.1.1.1.cmml">(</mo><mrow id="S4.p8.2.m2.1.1.1.1" xref="S4.p8.2.m2.1.1.1.1.cmml"><mn id="S4.p8.2.m2.1.1.1.1.2" xref="S4.p8.2.m2.1.1.1.1.2.cmml">1</mn><mo id="S4.p8.2.m2.1.1.1.1.1" xref="S4.p8.2.m2.1.1.1.1.1.cmml">−</mo><mi id="S4.p8.2.m2.1.1.1.1.3" xref="S4.p8.2.m2.1.1.1.1.3.cmml">p</mi></mrow><mo stretchy="false" id="S4.p8.2.m2.1.1.1.3" xref="S4.p8.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.2.m2.1b"><apply id="S4.p8.2.m2.1.1.1.1.cmml" xref="S4.p8.2.m2.1.1.1"><minus id="S4.p8.2.m2.1.1.1.1.1.cmml" xref="S4.p8.2.m2.1.1.1.1.1"></minus><cn type="integer" id="S4.p8.2.m2.1.1.1.1.2.cmml" xref="S4.p8.2.m2.1.1.1.1.2">1</cn><ci id="S4.p8.2.m2.1.1.1.1.3.cmml" xref="S4.p8.2.m2.1.1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.2.m2.1c">(1-p)</annotation></semantics></math> of the client data. We perform experiments with <math id="S4.p8.3.m3.4" class="ltx_Math" alttext="p=\{0.2,0.3,\dots,1.0\}" display="inline"><semantics id="S4.p8.3.m3.4a"><mrow id="S4.p8.3.m3.4.5" xref="S4.p8.3.m3.4.5.cmml"><mi id="S4.p8.3.m3.4.5.2" xref="S4.p8.3.m3.4.5.2.cmml">p</mi><mo id="S4.p8.3.m3.4.5.1" xref="S4.p8.3.m3.4.5.1.cmml">=</mo><mrow id="S4.p8.3.m3.4.5.3.2" xref="S4.p8.3.m3.4.5.3.1.cmml"><mo stretchy="false" id="S4.p8.3.m3.4.5.3.2.1" xref="S4.p8.3.m3.4.5.3.1.cmml">{</mo><mn id="S4.p8.3.m3.1.1" xref="S4.p8.3.m3.1.1.cmml">0.2</mn><mo id="S4.p8.3.m3.4.5.3.2.2" xref="S4.p8.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.p8.3.m3.2.2" xref="S4.p8.3.m3.2.2.cmml">0.3</mn><mo id="S4.p8.3.m3.4.5.3.2.3" xref="S4.p8.3.m3.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.p8.3.m3.3.3" xref="S4.p8.3.m3.3.3.cmml">…</mi><mo id="S4.p8.3.m3.4.5.3.2.4" xref="S4.p8.3.m3.4.5.3.1.cmml">,</mo><mn id="S4.p8.3.m3.4.4" xref="S4.p8.3.m3.4.4.cmml">1.0</mn><mo stretchy="false" id="S4.p8.3.m3.4.5.3.2.5" xref="S4.p8.3.m3.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.3.m3.4b"><apply id="S4.p8.3.m3.4.5.cmml" xref="S4.p8.3.m3.4.5"><eq id="S4.p8.3.m3.4.5.1.cmml" xref="S4.p8.3.m3.4.5.1"></eq><ci id="S4.p8.3.m3.4.5.2.cmml" xref="S4.p8.3.m3.4.5.2">𝑝</ci><set id="S4.p8.3.m3.4.5.3.1.cmml" xref="S4.p8.3.m3.4.5.3.2"><cn type="float" id="S4.p8.3.m3.1.1.cmml" xref="S4.p8.3.m3.1.1">0.2</cn><cn type="float" id="S4.p8.3.m3.2.2.cmml" xref="S4.p8.3.m3.2.2">0.3</cn><ci id="S4.p8.3.m3.3.3.cmml" xref="S4.p8.3.m3.3.3">…</ci><cn type="float" id="S4.p8.3.m3.4.4.cmml" xref="S4.p8.3.m3.4.4">1.0</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.3.m3.4c">p=\{0.2,0.3,\dots,1.0\}</annotation></semantics></math> to see what effect the degree of heterogeneity has on performance. In the extreme case <math id="S4.p8.4.m4.1" class="ltx_Math" alttext="p=1.0" display="inline"><semantics id="S4.p8.4.m4.1a"><mrow id="S4.p8.4.m4.1.1" xref="S4.p8.4.m4.1.1.cmml"><mi id="S4.p8.4.m4.1.1.2" xref="S4.p8.4.m4.1.1.2.cmml">p</mi><mo id="S4.p8.4.m4.1.1.1" xref="S4.p8.4.m4.1.1.1.cmml">=</mo><mn id="S4.p8.4.m4.1.1.3" xref="S4.p8.4.m4.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.4.m4.1b"><apply id="S4.p8.4.m4.1.1.cmml" xref="S4.p8.4.m4.1.1"><eq id="S4.p8.4.m4.1.1.1.cmml" xref="S4.p8.4.m4.1.1.1"></eq><ci id="S4.p8.4.m4.1.1.2.cmml" xref="S4.p8.4.m4.1.1.2">𝑝</ci><cn type="float" id="S4.p8.4.m4.1.1.3.cmml" xref="S4.p8.4.m4.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.4.m4.1c">p=1.0</annotation></semantics></math>, each client dataset only contains two classes in total, which is the same pathological non-iid setup as used for the MNIST dataset in <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib22" title="" class="ltx_ref">2017</a>)</cite>. A majority class fraction of <math id="S4.p8.5.m5.1" class="ltx_Math" alttext="p=0.2" display="inline"><semantics id="S4.p8.5.m5.1a"><mrow id="S4.p8.5.m5.1.1" xref="S4.p8.5.m5.1.1.cmml"><mi id="S4.p8.5.m5.1.1.2" xref="S4.p8.5.m5.1.1.2.cmml">p</mi><mo id="S4.p8.5.m5.1.1.1" xref="S4.p8.5.m5.1.1.1.cmml">=</mo><mn id="S4.p8.5.m5.1.1.3" xref="S4.p8.5.m5.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.5.m5.1b"><apply id="S4.p8.5.m5.1.1.cmml" xref="S4.p8.5.m5.1.1"><eq id="S4.p8.5.m5.1.1.1.cmml" xref="S4.p8.5.m5.1.1.1"></eq><ci id="S4.p8.5.m5.1.1.2.cmml" xref="S4.p8.5.m5.1.1.2">𝑝</ci><cn type="float" id="S4.p8.5.m5.1.1.3.cmml" xref="S4.p8.5.m5.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.5.m5.1c">p=0.2</annotation></semantics></math> represents an iid setting for CIFAR-10 and Fashion-MNIST. For the AG News dataset which only has four classes, a fraction of <math id="S4.p8.6.m6.1" class="ltx_Math" alttext="p=0.5" display="inline"><semantics id="S4.p8.6.m6.1a"><mrow id="S4.p8.6.m6.1.1" xref="S4.p8.6.m6.1.1.cmml"><mi id="S4.p8.6.m6.1.1.2" xref="S4.p8.6.m6.1.1.2.cmml">p</mi><mo id="S4.p8.6.m6.1.1.1" xref="S4.p8.6.m6.1.1.1.cmml">=</mo><mn id="S4.p8.6.m6.1.1.3" xref="S4.p8.6.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p8.6.m6.1b"><apply id="S4.p8.6.m6.1.1.cmml" xref="S4.p8.6.m6.1.1"><eq id="S4.p8.6.m6.1.1.1.cmml" xref="S4.p8.6.m6.1.1.1"></eq><ci id="S4.p8.6.m6.1.1.2.cmml" xref="S4.p8.6.m6.1.1.2">𝑝</ci><cn type="float" id="S4.p8.6.m6.1.1.3.cmml" xref="S4.p8.6.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p8.6.m6.1c">p=0.5</annotation></semantics></math> represents an iid setting.</p>
</div>
<div id="S4.p9" class="ltx_para">
<p id="S4.p9.7" class="ltx_p"><span id="S4.p9.7.1" class="ltx_text ltx_font_bold">Dirichlet distribution non-iid.</span> The second sampling strategy is to use the Dirichlet distribution as described in <cite class="ltx_cite ltx_citemacro_citep">(Yurochkin et al., <a href="#bib.bib30" title="" class="ltx_ref">2019</a>; Hsu et al., <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite>. For each class we sample <math id="S4.p9.1.m1.1" class="ltx_Math" alttext="\mathbf{n}_{k}\sim\text{Dir}_{j}(\alpha)" display="inline"><semantics id="S4.p9.1.m1.1a"><mrow id="S4.p9.1.m1.1.2" xref="S4.p9.1.m1.1.2.cmml"><msub id="S4.p9.1.m1.1.2.2" xref="S4.p9.1.m1.1.2.2.cmml"><mi id="S4.p9.1.m1.1.2.2.2" xref="S4.p9.1.m1.1.2.2.2.cmml">𝐧</mi><mi id="S4.p9.1.m1.1.2.2.3" xref="S4.p9.1.m1.1.2.2.3.cmml">k</mi></msub><mo id="S4.p9.1.m1.1.2.1" xref="S4.p9.1.m1.1.2.1.cmml">∼</mo><mrow id="S4.p9.1.m1.1.2.3" xref="S4.p9.1.m1.1.2.3.cmml"><msub id="S4.p9.1.m1.1.2.3.2" xref="S4.p9.1.m1.1.2.3.2.cmml"><mtext id="S4.p9.1.m1.1.2.3.2.2" xref="S4.p9.1.m1.1.2.3.2.2a.cmml">Dir</mtext><mi id="S4.p9.1.m1.1.2.3.2.3" xref="S4.p9.1.m1.1.2.3.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.p9.1.m1.1.2.3.1" xref="S4.p9.1.m1.1.2.3.1.cmml">​</mo><mrow id="S4.p9.1.m1.1.2.3.3.2" xref="S4.p9.1.m1.1.2.3.cmml"><mo stretchy="false" id="S4.p9.1.m1.1.2.3.3.2.1" xref="S4.p9.1.m1.1.2.3.cmml">(</mo><mi id="S4.p9.1.m1.1.1" xref="S4.p9.1.m1.1.1.cmml">α</mi><mo stretchy="false" id="S4.p9.1.m1.1.2.3.3.2.2" xref="S4.p9.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.1.m1.1b"><apply id="S4.p9.1.m1.1.2.cmml" xref="S4.p9.1.m1.1.2"><csymbol cd="latexml" id="S4.p9.1.m1.1.2.1.cmml" xref="S4.p9.1.m1.1.2.1">similar-to</csymbol><apply id="S4.p9.1.m1.1.2.2.cmml" xref="S4.p9.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.2.2.1.cmml" xref="S4.p9.1.m1.1.2.2">subscript</csymbol><ci id="S4.p9.1.m1.1.2.2.2.cmml" xref="S4.p9.1.m1.1.2.2.2">𝐧</ci><ci id="S4.p9.1.m1.1.2.2.3.cmml" xref="S4.p9.1.m1.1.2.2.3">𝑘</ci></apply><apply id="S4.p9.1.m1.1.2.3.cmml" xref="S4.p9.1.m1.1.2.3"><times id="S4.p9.1.m1.1.2.3.1.cmml" xref="S4.p9.1.m1.1.2.3.1"></times><apply id="S4.p9.1.m1.1.2.3.2.cmml" xref="S4.p9.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="S4.p9.1.m1.1.2.3.2.1.cmml" xref="S4.p9.1.m1.1.2.3.2">subscript</csymbol><ci id="S4.p9.1.m1.1.2.3.2.2a.cmml" xref="S4.p9.1.m1.1.2.3.2.2"><mtext id="S4.p9.1.m1.1.2.3.2.2.cmml" xref="S4.p9.1.m1.1.2.3.2.2">Dir</mtext></ci><ci id="S4.p9.1.m1.1.2.3.2.3.cmml" xref="S4.p9.1.m1.1.2.3.2.3">𝑗</ci></apply><ci id="S4.p9.1.m1.1.1.cmml" xref="S4.p9.1.m1.1.1">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.1.m1.1c">\mathbf{n}_{k}\sim\text{Dir}_{j}(\alpha)</annotation></semantics></math> and assign each client <math id="S4.p9.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.p9.2.m2.1a"><mi id="S4.p9.2.m2.1.1" xref="S4.p9.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.p9.2.m2.1b"><ci id="S4.p9.2.m2.1.1.cmml" xref="S4.p9.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.2.m2.1c">j</annotation></semantics></math> a proportion of <math id="S4.p9.3.m3.2" class="ltx_Math" alttext="\mathbf{n}_{k,j}" display="inline"><semantics id="S4.p9.3.m3.2a"><msub id="S4.p9.3.m3.2.3" xref="S4.p9.3.m3.2.3.cmml"><mi id="S4.p9.3.m3.2.3.2" xref="S4.p9.3.m3.2.3.2.cmml">𝐧</mi><mrow id="S4.p9.3.m3.2.2.2.4" xref="S4.p9.3.m3.2.2.2.3.cmml"><mi id="S4.p9.3.m3.1.1.1.1" xref="S4.p9.3.m3.1.1.1.1.cmml">k</mi><mo id="S4.p9.3.m3.2.2.2.4.1" xref="S4.p9.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.p9.3.m3.2.2.2.2" xref="S4.p9.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p9.3.m3.2b"><apply id="S4.p9.3.m3.2.3.cmml" xref="S4.p9.3.m3.2.3"><csymbol cd="ambiguous" id="S4.p9.3.m3.2.3.1.cmml" xref="S4.p9.3.m3.2.3">subscript</csymbol><ci id="S4.p9.3.m3.2.3.2.cmml" xref="S4.p9.3.m3.2.3.2">𝐧</ci><list id="S4.p9.3.m3.2.2.2.3.cmml" xref="S4.p9.3.m3.2.2.2.4"><ci id="S4.p9.3.m3.1.1.1.1.cmml" xref="S4.p9.3.m3.1.1.1.1">𝑘</ci><ci id="S4.p9.3.m3.2.2.2.2.cmml" xref="S4.p9.3.m3.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.3.m3.2c">\mathbf{n}_{k,j}</annotation></semantics></math> for class <math id="S4.p9.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p9.4.m4.1a"><mi id="S4.p9.4.m4.1.1" xref="S4.p9.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p9.4.m4.1b"><ci id="S4.p9.4.m4.1.1.cmml" xref="S4.p9.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.4.m4.1c">k</annotation></semantics></math>. When <math id="S4.p9.5.m5.1" class="ltx_Math" alttext="\alpha\to\infty" display="inline"><semantics id="S4.p9.5.m5.1a"><mrow id="S4.p9.5.m5.1.1" xref="S4.p9.5.m5.1.1.cmml"><mi id="S4.p9.5.m5.1.1.2" xref="S4.p9.5.m5.1.1.2.cmml">α</mi><mo stretchy="false" id="S4.p9.5.m5.1.1.1" xref="S4.p9.5.m5.1.1.1.cmml">→</mo><mi mathvariant="normal" id="S4.p9.5.m5.1.1.3" xref="S4.p9.5.m5.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.5.m5.1b"><apply id="S4.p9.5.m5.1.1.cmml" xref="S4.p9.5.m5.1.1"><ci id="S4.p9.5.m5.1.1.1.cmml" xref="S4.p9.5.m5.1.1.1">→</ci><ci id="S4.p9.5.m5.1.1.2.cmml" xref="S4.p9.5.m5.1.1.2">𝛼</ci><infinity id="S4.p9.5.m5.1.1.3.cmml" xref="S4.p9.5.m5.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.5.m5.1c">\alpha\to\infty</annotation></semantics></math> we have an iid setting of equal number of instances per class for each client. When <math id="S4.p9.6.m6.1" class="ltx_Math" alttext="\alpha\to 0" display="inline"><semantics id="S4.p9.6.m6.1a"><mrow id="S4.p9.6.m6.1.1" xref="S4.p9.6.m6.1.1.cmml"><mi id="S4.p9.6.m6.1.1.2" xref="S4.p9.6.m6.1.1.2.cmml">α</mi><mo stretchy="false" id="S4.p9.6.m6.1.1.1" xref="S4.p9.6.m6.1.1.1.cmml">→</mo><mn id="S4.p9.6.m6.1.1.3" xref="S4.p9.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.6.m6.1b"><apply id="S4.p9.6.m6.1.1.cmml" xref="S4.p9.6.m6.1.1"><ci id="S4.p9.6.m6.1.1.1.cmml" xref="S4.p9.6.m6.1.1.1">→</ci><ci id="S4.p9.6.m6.1.1.2.cmml" xref="S4.p9.6.m6.1.1.2">𝛼</ci><cn type="integer" id="S4.p9.6.m6.1.1.3.cmml" xref="S4.p9.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.6.m6.1c">\alpha\to 0</annotation></semantics></math>, we have a completely non-iid setting where each client dataset only has one class in total. We form experiments with <math id="S4.p9.7.m7.6" class="ltx_Math" alttext="\alpha=\{0.05,0.1,0.5,1.0,10,100\}" display="inline"><semantics id="S4.p9.7.m7.6a"><mrow id="S4.p9.7.m7.6.7" xref="S4.p9.7.m7.6.7.cmml"><mi id="S4.p9.7.m7.6.7.2" xref="S4.p9.7.m7.6.7.2.cmml">α</mi><mo id="S4.p9.7.m7.6.7.1" xref="S4.p9.7.m7.6.7.1.cmml">=</mo><mrow id="S4.p9.7.m7.6.7.3.2" xref="S4.p9.7.m7.6.7.3.1.cmml"><mo stretchy="false" id="S4.p9.7.m7.6.7.3.2.1" xref="S4.p9.7.m7.6.7.3.1.cmml">{</mo><mn id="S4.p9.7.m7.1.1" xref="S4.p9.7.m7.1.1.cmml">0.05</mn><mo id="S4.p9.7.m7.6.7.3.2.2" xref="S4.p9.7.m7.6.7.3.1.cmml">,</mo><mn id="S4.p9.7.m7.2.2" xref="S4.p9.7.m7.2.2.cmml">0.1</mn><mo id="S4.p9.7.m7.6.7.3.2.3" xref="S4.p9.7.m7.6.7.3.1.cmml">,</mo><mn id="S4.p9.7.m7.3.3" xref="S4.p9.7.m7.3.3.cmml">0.5</mn><mo id="S4.p9.7.m7.6.7.3.2.4" xref="S4.p9.7.m7.6.7.3.1.cmml">,</mo><mn id="S4.p9.7.m7.4.4" xref="S4.p9.7.m7.4.4.cmml">1.0</mn><mo id="S4.p9.7.m7.6.7.3.2.5" xref="S4.p9.7.m7.6.7.3.1.cmml">,</mo><mn id="S4.p9.7.m7.5.5" xref="S4.p9.7.m7.5.5.cmml">10</mn><mo id="S4.p9.7.m7.6.7.3.2.6" xref="S4.p9.7.m7.6.7.3.1.cmml">,</mo><mn id="S4.p9.7.m7.6.6" xref="S4.p9.7.m7.6.6.cmml">100</mn><mo stretchy="false" id="S4.p9.7.m7.6.7.3.2.7" xref="S4.p9.7.m7.6.7.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.7.m7.6b"><apply id="S4.p9.7.m7.6.7.cmml" xref="S4.p9.7.m7.6.7"><eq id="S4.p9.7.m7.6.7.1.cmml" xref="S4.p9.7.m7.6.7.1"></eq><ci id="S4.p9.7.m7.6.7.2.cmml" xref="S4.p9.7.m7.6.7.2">𝛼</ci><set id="S4.p9.7.m7.6.7.3.1.cmml" xref="S4.p9.7.m7.6.7.3.2"><cn type="float" id="S4.p9.7.m7.1.1.cmml" xref="S4.p9.7.m7.1.1">0.05</cn><cn type="float" id="S4.p9.7.m7.2.2.cmml" xref="S4.p9.7.m7.2.2">0.1</cn><cn type="float" id="S4.p9.7.m7.3.3.cmml" xref="S4.p9.7.m7.3.3">0.5</cn><cn type="float" id="S4.p9.7.m7.4.4.cmml" xref="S4.p9.7.m7.4.4">1.0</cn><cn type="integer" id="S4.p9.7.m7.5.5.cmml" xref="S4.p9.7.m7.5.5">10</cn><cn type="integer" id="S4.p9.7.m7.6.6.cmml" xref="S4.p9.7.m7.6.6">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.7.m7.6c">\alpha=\{0.05,0.1,0.5,1.0,10,100\}</annotation></semantics></math>.</p>
</div>
<div id="S4.p10" class="ltx_para">
<p id="S4.p10.5" class="ltx_p"><span id="S4.p10.5.1" class="ltx_text ltx_font_bold">Opt-out factor and privacy.</span> Some users might want to opt out from participating to a global model, due to privacy reasons. These users will still receive the global model. To simulate this scenario in the experimental evaluation, we introduce an <span id="S4.p10.5.2" class="ltx_text ltx_font_italic">opt-out factor</span> denoted by <math id="S4.p10.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.p10.1.m1.1a"><mi id="S4.p10.1.m1.1.1" xref="S4.p10.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.p10.1.m1.1b"><ci id="S4.p10.1.m1.1.1.cmml" xref="S4.p10.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.1.m1.1c">q</annotation></semantics></math>. This is a fraction deciding the number of clients participating in the <span id="S4.p10.5.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> optimization. The clients that participate in the federated learning optimization have all their data in <math id="S4.p10.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{I}}^{k}" display="inline"><semantics id="S4.p10.2.m2.1a"><msubsup id="S4.p10.2.m2.1.1" xref="S4.p10.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p10.2.m2.1.1.2.2" xref="S4.p10.2.m2.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S4.p10.2.m2.1.1.2.3" xref="S4.p10.2.m2.1.1.2.3.cmml">ℐ</mi><mi id="S4.p10.2.m2.1.1.3" xref="S4.p10.2.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p10.2.m2.1b"><apply id="S4.p10.2.m2.1.1.cmml" xref="S4.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p10.2.m2.1.1.1.cmml" xref="S4.p10.2.m2.1.1">superscript</csymbol><apply id="S4.p10.2.m2.1.1.2.cmml" xref="S4.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p10.2.m2.1.1.2.1.cmml" xref="S4.p10.2.m2.1.1">subscript</csymbol><ci id="S4.p10.2.m2.1.1.2.2.cmml" xref="S4.p10.2.m2.1.1.2.2">𝒟</ci><ci id="S4.p10.2.m2.1.1.2.3.cmml" xref="S4.p10.2.m2.1.1.2.3">ℐ</ci></apply><ci id="S4.p10.2.m2.1.1.3.cmml" xref="S4.p10.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.2.m2.1c">\mathcal{D}_{\mathcal{I}}^{k}</annotation></semantics></math>, while the clients that opt out have all their data in <math id="S4.p10.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathcal{O}}^{k}" display="inline"><semantics id="S4.p10.3.m3.1a"><msubsup id="S4.p10.3.m3.1.1" xref="S4.p10.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p10.3.m3.1.1.2.2" xref="S4.p10.3.m3.1.1.2.2.cmml">𝒟</mi><mi class="ltx_font_mathcaligraphic" id="S4.p10.3.m3.1.1.2.3" xref="S4.p10.3.m3.1.1.2.3.cmml">𝒪</mi><mi id="S4.p10.3.m3.1.1.3" xref="S4.p10.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p10.3.m3.1b"><apply id="S4.p10.3.m3.1.1.cmml" xref="S4.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p10.3.m3.1.1.1.cmml" xref="S4.p10.3.m3.1.1">superscript</csymbol><apply id="S4.p10.3.m3.1.1.2.cmml" xref="S4.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p10.3.m3.1.1.2.1.cmml" xref="S4.p10.3.m3.1.1">subscript</csymbol><ci id="S4.p10.3.m3.1.1.2.2.cmml" xref="S4.p10.3.m3.1.1.2.2">𝒟</ci><ci id="S4.p10.3.m3.1.1.2.3.cmml" xref="S4.p10.3.m3.1.1.2.3">𝒪</ci></apply><ci id="S4.p10.3.m3.1.1.3.cmml" xref="S4.p10.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.3.m3.1c">\mathcal{D}_{\mathcal{O}}^{k}</annotation></semantics></math>. <math id="S4.p10.4.m4.1" class="ltx_Math" alttext="q=0" display="inline"><semantics id="S4.p10.4.m4.1a"><mrow id="S4.p10.4.m4.1.1" xref="S4.p10.4.m4.1.1.cmml"><mi id="S4.p10.4.m4.1.1.2" xref="S4.p10.4.m4.1.1.2.cmml">q</mi><mo id="S4.p10.4.m4.1.1.1" xref="S4.p10.4.m4.1.1.1.cmml">=</mo><mn id="S4.p10.4.m4.1.1.3" xref="S4.p10.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p10.4.m4.1b"><apply id="S4.p10.4.m4.1.1.cmml" xref="S4.p10.4.m4.1.1"><eq id="S4.p10.4.m4.1.1.1.cmml" xref="S4.p10.4.m4.1.1.1"></eq><ci id="S4.p10.4.m4.1.1.2.cmml" xref="S4.p10.4.m4.1.1.2">𝑞</ci><cn type="integer" id="S4.p10.4.m4.1.1.3.cmml" xref="S4.p10.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.4.m4.1c">q=0</annotation></semantics></math> means all clients are participating. We perform experiments varying <math id="S4.p10.5.m5.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.p10.5.m5.1a"><mi id="S4.p10.5.m5.1.1" xref="S4.p10.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.p10.5.m5.1b"><ci id="S4.p10.5.m5.1.1.cmml" xref="S4.p10.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p10.5.m5.1c">q</annotation></semantics></math>, to see how robust our algorithm is to different levels of client participation. In Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> we visualize how the opt-out factor can be used.</p>
</div>
<div id="S4.p11" class="ltx_para">
<p id="S4.p11.5" class="ltx_p"><span id="S4.p11.5.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedAvg<span id="S4.p11.5.1.1" class="ltx_text ltx_font_upright"> parameters.</span></span> For CIFAR-10 and Fashion-MNIST, the training is performed using 100 clients with 100 training samples per client. A client sampling fraction of <math id="S4.p11.1.m1.1" class="ltx_Math" alttext="0.05" display="inline"><semantics id="S4.p11.1.m1.1a"><mn id="S4.p11.1.m1.1.1" xref="S4.p11.1.m1.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S4.p11.1.m1.1b"><cn type="float" id="S4.p11.1.m1.1.1.cmml" xref="S4.p11.1.m1.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.1.m1.1c">0.05</annotation></semantics></math> is used, meaning that <math id="S4.p11.2.m2.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.p11.2.m2.1a"><mn id="S4.p11.2.m2.1.1" xref="S4.p11.2.m2.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.p11.2.m2.1b"><cn type="integer" id="S4.p11.2.m2.1.1.cmml" xref="S4.p11.2.m2.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.2.m2.1c">5</annotation></semantics></math> clients participate in each communication round. If the opt-out fraction <math id="S4.p11.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.p11.3.m3.1a"><mi id="S4.p11.3.m3.1.1" xref="S4.p11.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.p11.3.m3.1b"><ci id="S4.p11.3.m3.1.1.cmml" xref="S4.p11.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.3.m3.1c">q</annotation></semantics></math> is larger than <math id="S4.p11.4.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.p11.4.m4.1a"><mn id="S4.p11.4.m4.1.1" xref="S4.p11.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.p11.4.m4.1b"><cn type="integer" id="S4.p11.4.m4.1.1.cmml" xref="S4.p11.4.m4.1.1">0</cn></annotation-xml></semantics></math>, we change the sampling fraction such that there always are <math id="S4.p11.5.m5.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S4.p11.5.m5.1a"><mn id="S4.p11.5.m5.1.1" xref="S4.p11.5.m5.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S4.p11.5.m5.1b"><cn type="integer" id="S4.p11.5.m5.1.1.cmml" xref="S4.p11.5.m5.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p11.5.m5.1c">5</annotation></semantics></math> clients that participate in every communication round.</p>
</div>
<div id="S4.p12" class="ltx_para">
<p id="S4.p12.5" class="ltx_p">For AG News, we set the number of clients to 1000, with 100 training samples per client. We use a client sampling fraction of <math id="S4.p12.1.m1.1" class="ltx_Math" alttext="0.05" display="inline"><semantics id="S4.p12.1.m1.1a"><mn id="S4.p12.1.m1.1.1" xref="S4.p12.1.m1.1.1.cmml">0.05</mn><annotation-xml encoding="MathML-Content" id="S4.p12.1.m1.1b"><cn type="float" id="S4.p12.1.m1.1.1.cmml" xref="S4.p12.1.m1.1.1">0.05</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p12.1.m1.1c">0.05</annotation></semantics></math>, meaning that <math id="S4.p12.2.m2.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S4.p12.2.m2.1a"><mn id="S4.p12.2.m2.1.1" xref="S4.p12.2.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S4.p12.2.m2.1b"><cn type="integer" id="S4.p12.2.m2.1.1.cmml" xref="S4.p12.2.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p12.2.m2.1c">50</annotation></semantics></math> clients participate in each communication round. If the opt-out fraction <math id="S4.p12.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.p12.3.m3.1a"><mi id="S4.p12.3.m3.1.1" xref="S4.p12.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.p12.3.m3.1b"><ci id="S4.p12.3.m3.1.1.cmml" xref="S4.p12.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p12.3.m3.1c">q</annotation></semantics></math> is larger than <math id="S4.p12.4.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.p12.4.m4.1a"><mn id="S4.p12.4.m4.1.1" xref="S4.p12.4.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S4.p12.4.m4.1b"><cn type="integer" id="S4.p12.4.m4.1.1.cmml" xref="S4.p12.4.m4.1.1">0</cn></annotation-xml></semantics></math>, we change the sampling fraction such that there always are <math id="S4.p12.5.m5.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S4.p12.5.m5.1a"><mn id="S4.p12.5.m5.1.1" xref="S4.p12.5.m5.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S4.p12.5.m5.1b"><cn type="integer" id="S4.p12.5.m5.1.1.cmml" xref="S4.p12.5.m5.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p12.5.m5.1c">50</annotation></semantics></math> clients that participate in every communication round.</p>
</div>
<div id="S4.p13" class="ltx_para">
<p id="S4.p13.2" class="ltx_p">For all datasets we set the number of communication rounds to <math id="S4.p13.1.m1.1" class="ltx_Math" alttext="1250" display="inline"><semantics id="S4.p13.1.m1.1a"><mn id="S4.p13.1.m1.1.1" xref="S4.p13.1.m1.1.1.cmml">1250</mn><annotation-xml encoding="MathML-Content" id="S4.p13.1.m1.1b"><cn type="integer" id="S4.p13.1.m1.1.1.cmml" xref="S4.p13.1.m1.1.1">1250</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.1.m1.1c">1250</annotation></semantics></math>, number of local epochs to 3 and local batch size to <math id="S4.p13.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.p13.2.m2.1a"><mn id="S4.p13.2.m2.1.1" xref="S4.p13.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.p13.2.m2.1b"><cn type="integer" id="S4.p13.2.m2.1.1.cmml" xref="S4.p13.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.p13.2.m2.1c">10</annotation></semantics></math>. We use early stopping and validate the performance of <span id="S4.p13.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> on each participating client’s local validation set every 50th communication round. The global model with the best mean validation loss over participating clients is returned.</p>
</div>
<div id="S4.p14" class="ltx_para">
<p id="S4.p14.1" class="ltx_p"><span id="S4.p14.1.1" class="ltx_text ltx_font_bold">Baselines.</span> We use three different models as baselines. First, a locally trained model for every client, only trained on each clients own dataset. Second, <span id="S4.p14.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. Third, the final model output from <span id="S4.p14.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> fine-tuned for each client on its own local data, denoted by <math id="S4.p14.1.m1.1" class="ltx_Math" alttext="f^{k}_{s}" display="inline"><semantics id="S4.p14.1.m1.1a"><msubsup id="S4.p14.1.m1.1.1" xref="S4.p14.1.m1.1.1.cmml"><mi id="S4.p14.1.m1.1.1.2.2" xref="S4.p14.1.m1.1.1.2.2.cmml">f</mi><mi id="S4.p14.1.m1.1.1.3" xref="S4.p14.1.m1.1.1.3.cmml">s</mi><mi id="S4.p14.1.m1.1.1.2.3" xref="S4.p14.1.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p14.1.m1.1b"><apply id="S4.p14.1.m1.1.1.cmml" xref="S4.p14.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p14.1.m1.1.1.1.cmml" xref="S4.p14.1.m1.1.1">subscript</csymbol><apply id="S4.p14.1.m1.1.1.2.cmml" xref="S4.p14.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p14.1.m1.1.1.2.1.cmml" xref="S4.p14.1.m1.1.1">superscript</csymbol><ci id="S4.p14.1.m1.1.1.2.2.cmml" xref="S4.p14.1.m1.1.1.2.2">𝑓</ci><ci id="S4.p14.1.m1.1.1.2.3.cmml" xref="S4.p14.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S4.p14.1.m1.1.1.3.cmml" xref="S4.p14.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p14.1.m1.1c">f^{k}_{s}</annotation></semantics></math>. We train the local model, the fine-tuned model and the mixture using early stopping for 500 epochs, monitoring local validation loss on each client and return the best performing model in each case.</p>
</div>
<div id="S4.p15" class="ltx_para">
<p id="S4.p15.2" class="ltx_p"><span id="S4.p15.2.1" class="ltx_text ltx_font_bold">Evaluation.</span> We evaluate using both a <span id="S4.p15.2.2" class="ltx_text ltx_font_italic">local</span> (skewed) and a <span id="S4.p15.2.3" class="ltx_text ltx_font_italic">global</span> (balanced) test set. Each client has a local test set (<math id="S4.p15.1.m1.1" class="ltx_Math" alttext="n=500" display="inline"><semantics id="S4.p15.1.m1.1a"><mrow id="S4.p15.1.m1.1.1" xref="S4.p15.1.m1.1.1.cmml"><mi id="S4.p15.1.m1.1.1.2" xref="S4.p15.1.m1.1.1.2.cmml">n</mi><mo id="S4.p15.1.m1.1.1.1" xref="S4.p15.1.m1.1.1.1.cmml">=</mo><mn id="S4.p15.1.m1.1.1.3" xref="S4.p15.1.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p15.1.m1.1b"><apply id="S4.p15.1.m1.1.1.cmml" xref="S4.p15.1.m1.1.1"><eq id="S4.p15.1.m1.1.1.1.cmml" xref="S4.p15.1.m1.1.1.1"></eq><ci id="S4.p15.1.m1.1.1.2.cmml" xref="S4.p15.1.m1.1.1.2">𝑛</ci><cn type="integer" id="S4.p15.1.m1.1.1.3.cmml" xref="S4.p15.1.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p15.1.m1.1c">n=500</annotation></semantics></math> samples) that mirrors its local data distribution. This test set is used to measure how well a model specializes to a client. The global test set (<math id="S4.p15.2.m2.1" class="ltx_Math" alttext="n=1000" display="inline"><semantics id="S4.p15.2.m2.1a"><mrow id="S4.p15.2.m2.1.1" xref="S4.p15.2.m2.1.1.cmml"><mi id="S4.p15.2.m2.1.1.2" xref="S4.p15.2.m2.1.1.2.cmml">n</mi><mo id="S4.p15.2.m2.1.1.1" xref="S4.p15.2.m2.1.1.1.cmml">=</mo><mn id="S4.p15.2.m2.1.1.3" xref="S4.p15.2.m2.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p15.2.m2.1b"><apply id="S4.p15.2.m2.1.1.cmml" xref="S4.p15.2.m2.1.1"><eq id="S4.p15.2.m2.1.1.1.cmml" xref="S4.p15.2.m2.1.1.1"></eq><ci id="S4.p15.2.m2.1.1.2.cmml" xref="S4.p15.2.m2.1.1.2">𝑛</ci><cn type="integer" id="S4.p15.2.m2.1.1.3.cmml" xref="S4.p15.2.m2.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p15.2.m2.1c">n=1000</annotation></semantics></math> samples) is a balanced test set (it contains the same number of data points for all classes) and is the same for all clients. We use this to measure how well a model generalizes. During evaluation, we sample 20 random clients and calculate the local and global test accuracies for all baselines and report a mean over the clients. All experiments were performed on a Tesla V100-SXM2-32GB, and all reported results are means over four runs.</p>
</div>
<figure id="S4.T1" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy on a global and local test set for all baselines on all datasets with varying majority class fractions <math id="S4.T1.3.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.3.m1.1b"><mi id="S4.T1.3.m1.1.1" xref="S4.T1.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.3.m1.1c"><ci id="S4.T1.3.m1.1.1.cmml" xref="S4.T1.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.m1.1d">p</annotation></semantics></math>. Best performing specialist in bold. Opt-out fraction <math id="S4.T1.4.m2.1" class="ltx_Math" alttext="q=0" display="inline"><semantics id="S4.T1.4.m2.1b"><mrow id="S4.T1.4.m2.1.1" xref="S4.T1.4.m2.1.1.cmml"><mi id="S4.T1.4.m2.1.1.2" xref="S4.T1.4.m2.1.1.2.cmml">q</mi><mo id="S4.T1.4.m2.1.1.1" xref="S4.T1.4.m2.1.1.1.cmml">=</mo><mn id="S4.T1.4.m2.1.1.3" xref="S4.T1.4.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.m2.1c"><apply id="S4.T1.4.m2.1.1.cmml" xref="S4.T1.4.m2.1.1"><eq id="S4.T1.4.m2.1.1.1.cmml" xref="S4.T1.4.m2.1.1.1"></eq><ci id="S4.T1.4.m2.1.1.2.cmml" xref="S4.T1.4.m2.1.1.2">𝑞</ci><cn type="integer" id="S4.T1.4.m2.1.1.3.cmml" xref="S4.T1.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.m2.1d">q=0</annotation></semantics></math>. All results reported are over four runs.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.sf1" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S4.T1.sf1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.sf1.1.1" class="ltx_tr">
<th id="S4.T1.sf1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T1.sf1.1.1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.sf1.1.1.1.m1.1a"><mi id="S4.T1.sf1.1.1.1.m1.1.1" xref="S4.T1.sf1.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.sf1.1.1.1.m1.1b"><ci id="S4.T1.sf1.1.1.1.m1.1.1.cmml" xref="S4.T1.sf1.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.sf1.1.1.1.m1.1c">p</annotation></semantics></math></th>
<th id="S4.T1.sf1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S4.T1.sf1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local</th>
<th id="S4.T1.sf1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Fine-tuned</th>
<th id="S4.T1.sf1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mixture</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.sf1.1.2.1" class="ltx_tr">
<th id="S4.T1.sf1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.3</th>
<td id="S4.T1.sf1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">42.65</td>
<td id="S4.T1.sf1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">19.17</td>
<td id="S4.T1.sf1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">39.78</td>
<td id="S4.T1.sf1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.sf1.1.2.1.5.1" class="ltx_text ltx_font_bold">41.57</span></td>
</tr>
<tr id="S4.T1.sf1.1.3.2" class="ltx_tr">
<th id="S4.T1.sf1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.6</th>
<td id="S4.T1.sf1.1.3.2.2" class="ltx_td ltx_align_center">30.47</td>
<td id="S4.T1.sf1.1.3.2.3" class="ltx_td ltx_align_center">14.74</td>
<td id="S4.T1.sf1.1.3.2.4" class="ltx_td ltx_align_center">25.87</td>
<td id="S4.T1.sf1.1.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf1.1.3.2.5.1" class="ltx_text ltx_font_bold">26.37</span></td>
</tr>
<tr id="S4.T1.sf1.1.4.3" class="ltx_tr">
<th id="S4.T1.sf1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.7</th>
<td id="S4.T1.sf1.1.4.3.2" class="ltx_td ltx_align_center">22.90</td>
<td id="S4.T1.sf1.1.4.3.3" class="ltx_td ltx_align_center">14.62</td>
<td id="S4.T1.sf1.1.4.3.4" class="ltx_td ltx_align_center">20.66</td>
<td id="S4.T1.sf1.1.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf1.1.4.3.5.1" class="ltx_text ltx_font_bold">21.45</span></td>
</tr>
<tr id="S4.T1.sf1.1.5.4" class="ltx_tr">
<th id="S4.T1.sf1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.8</th>
<td id="S4.T1.sf1.1.5.4.2" class="ltx_td ltx_align_center">20.00</td>
<td id="S4.T1.sf1.1.5.4.3" class="ltx_td ltx_align_center">13.98</td>
<td id="S4.T1.sf1.1.5.4.4" class="ltx_td ltx_align_center">18.85</td>
<td id="S4.T1.sf1.1.5.4.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf1.1.5.4.5.1" class="ltx_text ltx_font_bold">19.55</span></td>
</tr>
<tr id="S4.T1.sf1.1.6.5" class="ltx_tr">
<th id="S4.T1.sf1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T1.sf1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">15.08</td>
<td id="S4.T1.sf1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">14.18</td>
<td id="S4.T1.sf1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">14.55</td>
<td id="S4.T1.sf1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.sf1.1.6.5.5.1" class="ltx_text ltx_font_bold">14.66</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(a) </span>CIFAR-10: Global test set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.sf2" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S4.T1.sf2.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.sf2.1.1" class="ltx_tr">
<th id="S4.T1.sf2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T1.sf2.1.1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.sf2.1.1.1.m1.1a"><mi id="S4.T1.sf2.1.1.1.m1.1.1" xref="S4.T1.sf2.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.sf2.1.1.1.m1.1b"><ci id="S4.T1.sf2.1.1.1.m1.1.1.cmml" xref="S4.T1.sf2.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.sf2.1.1.1.m1.1c">p</annotation></semantics></math></th>
<th id="S4.T1.sf2.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S4.T1.sf2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local</th>
<th id="S4.T1.sf2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Fine-tuned</th>
<th id="S4.T1.sf2.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mixture</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.sf2.1.2.1" class="ltx_tr">
<th id="S4.T1.sf2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.3</th>
<td id="S4.T1.sf2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">43.32</td>
<td id="S4.T1.sf2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">23.39</td>
<td id="S4.T1.sf2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">42.98</td>
<td id="S4.T1.sf2.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.sf2.1.2.1.5.1" class="ltx_text ltx_font_bold">43.86</span></td>
</tr>
<tr id="S4.T1.sf2.1.3.2" class="ltx_tr">
<th id="S4.T1.sf2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.6</th>
<td id="S4.T1.sf2.1.3.2.2" class="ltx_td ltx_align_center">30.13</td>
<td id="S4.T1.sf2.1.3.2.3" class="ltx_td ltx_align_center">42.19</td>
<td id="S4.T1.sf2.1.3.2.4" class="ltx_td ltx_align_center"><span id="S4.T1.sf2.1.3.2.4.1" class="ltx_text ltx_font_bold">50.97</span></td>
<td id="S4.T1.sf2.1.3.2.5" class="ltx_td ltx_align_center">50.57</td>
</tr>
<tr id="S4.T1.sf2.1.4.3" class="ltx_tr">
<th id="S4.T1.sf2.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.7</th>
<td id="S4.T1.sf2.1.4.3.2" class="ltx_td ltx_align_center">21.81</td>
<td id="S4.T1.sf2.1.4.3.3" class="ltx_td ltx_align_center">50.23</td>
<td id="S4.T1.sf2.1.4.3.4" class="ltx_td ltx_align_center"><span id="S4.T1.sf2.1.4.3.4.1" class="ltx_text ltx_font_bold">54.98</span></td>
<td id="S4.T1.sf2.1.4.3.5" class="ltx_td ltx_align_center">54.73</td>
</tr>
<tr id="S4.T1.sf2.1.5.4" class="ltx_tr">
<th id="S4.T1.sf2.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.8</th>
<td id="S4.T1.sf2.1.5.4.2" class="ltx_td ltx_align_center">16.78</td>
<td id="S4.T1.sf2.1.5.4.3" class="ltx_td ltx_align_center">59.89</td>
<td id="S4.T1.sf2.1.5.4.4" class="ltx_td ltx_align_center"><span id="S4.T1.sf2.1.5.4.4.1" class="ltx_text ltx_font_bold">64.54</span></td>
<td id="S4.T1.sf2.1.5.4.5" class="ltx_td ltx_align_center">64.47</td>
</tr>
<tr id="S4.T1.sf2.1.6.5" class="ltx_tr">
<th id="S4.T1.sf2.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T1.sf2.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">13.62</td>
<td id="S4.T1.sf2.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">77.00</td>
<td id="S4.T1.sf2.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">78.32</td>
<td id="S4.T1.sf2.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.sf2.1.6.5.5.1" class="ltx_text ltx_font_bold">78.56</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(b) </span>CIFAR-10: Local test set</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.sf3" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S4.T1.sf3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.sf3.1.1" class="ltx_tr">
<th id="S4.T1.sf3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T1.sf3.1.1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.sf3.1.1.1.m1.1a"><mi id="S4.T1.sf3.1.1.1.m1.1.1" xref="S4.T1.sf3.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.sf3.1.1.1.m1.1b"><ci id="S4.T1.sf3.1.1.1.m1.1.1.cmml" xref="S4.T1.sf3.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.sf3.1.1.1.m1.1c">p</annotation></semantics></math></th>
<th id="S4.T1.sf3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S4.T1.sf3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local</th>
<th id="S4.T1.sf3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Fine-tuned</th>
<th id="S4.T1.sf3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mixture</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.sf3.1.2.1" class="ltx_tr">
<th id="S4.T1.sf3.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.3</th>
<td id="S4.T1.sf3.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">71.12</td>
<td id="S4.T1.sf3.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">40.65</td>
<td id="S4.T1.sf3.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">69.32</td>
<td id="S4.T1.sf3.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.sf3.1.2.1.5.1" class="ltx_text ltx_font_bold">70.50</span></td>
</tr>
<tr id="S4.T1.sf3.1.3.2" class="ltx_tr">
<th id="S4.T1.sf3.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.6</th>
<td id="S4.T1.sf3.1.3.2.2" class="ltx_td ltx_align_center">66.85</td>
<td id="S4.T1.sf3.1.3.2.3" class="ltx_td ltx_align_center">18.07</td>
<td id="S4.T1.sf3.1.3.2.4" class="ltx_td ltx_align_center">61.43</td>
<td id="S4.T1.sf3.1.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf3.1.3.2.5.1" class="ltx_text ltx_font_bold">64.82</span></td>
</tr>
<tr id="S4.T1.sf3.1.4.3" class="ltx_tr">
<th id="S4.T1.sf3.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.7</th>
<td id="S4.T1.sf3.1.4.3.2" class="ltx_td ltx_align_center">64.45</td>
<td id="S4.T1.sf3.1.4.3.3" class="ltx_td ltx_align_center">17.57</td>
<td id="S4.T1.sf3.1.4.3.4" class="ltx_td ltx_align_center">58.95</td>
<td id="S4.T1.sf3.1.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf3.1.4.3.5.1" class="ltx_text ltx_font_bold">62.15</span></td>
</tr>
<tr id="S4.T1.sf3.1.5.4" class="ltx_tr">
<th id="S4.T1.sf3.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.8</th>
<td id="S4.T1.sf3.1.5.4.2" class="ltx_td ltx_align_center">67.45</td>
<td id="S4.T1.sf3.1.5.4.3" class="ltx_td ltx_align_center">17.69</td>
<td id="S4.T1.sf3.1.5.4.4" class="ltx_td ltx_align_center">58.66</td>
<td id="S4.T1.sf3.1.5.4.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf3.1.5.4.5.1" class="ltx_text ltx_font_bold">61.53</span></td>
</tr>
<tr id="S4.T1.sf3.1.6.5" class="ltx_tr">
<th id="S4.T1.sf3.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T1.sf3.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">49.43</td>
<td id="S4.T1.sf3.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">18.11</td>
<td id="S4.T1.sf3.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.sf3.1.6.5.4.1" class="ltx_text ltx_font_bold">23.69</span></td>
<td id="S4.T1.sf3.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb">22.64</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(c) </span>Fashion-MNIST: Global test set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.sf4" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S4.T1.sf4.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.sf4.1.1" class="ltx_tr">
<th id="S4.T1.sf4.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T1.sf4.1.1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.sf4.1.1.1.m1.1a"><mi id="S4.T1.sf4.1.1.1.m1.1.1" xref="S4.T1.sf4.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.sf4.1.1.1.m1.1b"><ci id="S4.T1.sf4.1.1.1.m1.1.1.cmml" xref="S4.T1.sf4.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.sf4.1.1.1.m1.1c">p</annotation></semantics></math></th>
<th id="S4.T1.sf4.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S4.T1.sf4.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">Local</th>
<th id="S4.T1.sf4.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">Fine-tuned</th>
<th id="S4.T1.sf4.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">Mixture</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.sf4.1.2.1" class="ltx_tr">
<th id="S4.T1.sf4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">0.3</th>
<td id="S4.T1.sf4.1.2.1.2" class="ltx_td ltx_align_right ltx_border_t">70.66</td>
<td id="S4.T1.sf4.1.2.1.3" class="ltx_td ltx_align_right ltx_border_t">45.77</td>
<td id="S4.T1.sf4.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t">69.76</td>
<td id="S4.T1.sf4.1.2.1.5" class="ltx_td ltx_align_right ltx_border_t"><span id="S4.T1.sf4.1.2.1.5.1" class="ltx_text ltx_font_bold">70.42</span></td>
</tr>
<tr id="S4.T1.sf4.1.3.2" class="ltx_tr">
<th id="S4.T1.sf4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.6</th>
<td id="S4.T1.sf4.1.3.2.2" class="ltx_td ltx_align_right">65.14</td>
<td id="S4.T1.sf4.1.3.2.3" class="ltx_td ltx_align_right">55.16</td>
<td id="S4.T1.sf4.1.3.2.4" class="ltx_td ltx_align_right">71.01</td>
<td id="S4.T1.sf4.1.3.2.5" class="ltx_td ltx_align_right"><span id="S4.T1.sf4.1.3.2.5.1" class="ltx_text ltx_font_bold">71.18</span></td>
</tr>
<tr id="S4.T1.sf4.1.4.3" class="ltx_tr">
<th id="S4.T1.sf4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.7</th>
<td id="S4.T1.sf4.1.4.3.2" class="ltx_td ltx_align_right">64.67</td>
<td id="S4.T1.sf4.1.4.3.3" class="ltx_td ltx_align_right">65.12</td>
<td id="S4.T1.sf4.1.4.3.4" class="ltx_td ltx_align_right"><span id="S4.T1.sf4.1.4.3.4.1" class="ltx_text ltx_font_bold">74.86</span></td>
<td id="S4.T1.sf4.1.4.3.5" class="ltx_td ltx_align_right">74.63</td>
</tr>
<tr id="S4.T1.sf4.1.5.4" class="ltx_tr">
<th id="S4.T1.sf4.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.8</th>
<td id="S4.T1.sf4.1.5.4.2" class="ltx_td ltx_align_right">66.45</td>
<td id="S4.T1.sf4.1.5.4.3" class="ltx_td ltx_align_right">74.84</td>
<td id="S4.T1.sf4.1.5.4.4" class="ltx_td ltx_align_right">76.02</td>
<td id="S4.T1.sf4.1.5.4.5" class="ltx_td ltx_align_right"><span id="S4.T1.sf4.1.5.4.5.1" class="ltx_text ltx_font_bold">76.70</span></td>
</tr>
<tr id="S4.T1.sf4.1.6.5" class="ltx_tr">
<th id="S4.T1.sf4.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T1.sf4.1.6.5.2" class="ltx_td ltx_align_right ltx_border_bb">48.01</td>
<td id="S4.T1.sf4.1.6.5.3" class="ltx_td ltx_align_right ltx_border_bb"><span id="S4.T1.sf4.1.6.5.3.1" class="ltx_text ltx_font_bold">94.22</span></td>
<td id="S4.T1.sf4.1.6.5.4" class="ltx_td ltx_align_right ltx_border_bb">91.28</td>
<td id="S4.T1.sf4.1.6.5.5" class="ltx_td ltx_align_right ltx_border_bb">92.10</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(d) </span>Fashion-MNIST: Local test set</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.sf5" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S4.T1.sf5.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.sf5.1.1" class="ltx_tr">
<th id="S4.T1.sf5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T1.sf5.1.1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.sf5.1.1.1.m1.1a"><mi id="S4.T1.sf5.1.1.1.m1.1.1" xref="S4.T1.sf5.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.sf5.1.1.1.m1.1b"><ci id="S4.T1.sf5.1.1.1.m1.1.1.cmml" xref="S4.T1.sf5.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.sf5.1.1.1.m1.1c">p</annotation></semantics></math></th>
<th id="S4.T1.sf5.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S4.T1.sf5.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local</th>
<th id="S4.T1.sf5.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Fine-tuned</th>
<th id="S4.T1.sf5.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mixture</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.sf5.1.2.1" class="ltx_tr">
<th id="S4.T1.sf5.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S4.T1.sf5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">80.31</td>
<td id="S4.T1.sf5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">28.82</td>
<td id="S4.T1.sf5.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">75.51</td>
<td id="S4.T1.sf5.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.sf5.1.2.1.5.1" class="ltx_text ltx_font_bold">78.03</span></td>
</tr>
<tr id="S4.T1.sf5.1.3.2" class="ltx_tr">
<th id="S4.T1.sf5.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.7</th>
<td id="S4.T1.sf5.1.3.2.2" class="ltx_td ltx_align_center">10.42</td>
<td id="S4.T1.sf5.1.3.2.3" class="ltx_td ltx_align_center">3.88</td>
<td id="S4.T1.sf5.1.3.2.4" class="ltx_td ltx_align_center">9.79</td>
<td id="S4.T1.sf5.1.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf5.1.3.2.5.1" class="ltx_text ltx_font_bold">10.15</span></td>
</tr>
<tr id="S4.T1.sf5.1.4.3" class="ltx_tr">
<th id="S4.T1.sf5.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.8</th>
<td id="S4.T1.sf5.1.4.3.2" class="ltx_td ltx_align_center">10.39</td>
<td id="S4.T1.sf5.1.4.3.3" class="ltx_td ltx_align_center">3.82</td>
<td id="S4.T1.sf5.1.4.3.4" class="ltx_td ltx_align_center">9.59</td>
<td id="S4.T1.sf5.1.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf5.1.4.3.5.1" class="ltx_text ltx_font_bold">10.01</span></td>
</tr>
<tr id="S4.T1.sf5.1.5.4" class="ltx_tr">
<th id="S4.T1.sf5.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S4.T1.sf5.1.5.4.2" class="ltx_td ltx_align_center">9.73</td>
<td id="S4.T1.sf5.1.5.4.3" class="ltx_td ltx_align_center">3.91</td>
<td id="S4.T1.sf5.1.5.4.4" class="ltx_td ltx_align_center">8.90</td>
<td id="S4.T1.sf5.1.5.4.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf5.1.5.4.5.1" class="ltx_text ltx_font_bold">9.43</span></td>
</tr>
<tr id="S4.T1.sf5.1.6.5" class="ltx_tr">
<th id="S4.T1.sf5.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T1.sf5.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">8.62</td>
<td id="S4.T1.sf5.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">3.95</td>
<td id="S4.T1.sf5.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">6.43</td>
<td id="S4.T1.sf5.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.sf5.1.6.5.5.1" class="ltx_text ltx_font_bold">7.29</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(e) </span>AG News: Global test set</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1.sf6" class="ltx_table ltx_figure_panel ltx_align_center">
<table id="S4.T1.sf6.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.sf6.1.1" class="ltx_tr">
<th id="S4.T1.sf6.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt"><math id="S4.T1.sf6.1.1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.T1.sf6.1.1.1.m1.1a"><mi id="S4.T1.sf6.1.1.1.m1.1.1" xref="S4.T1.sf6.1.1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.sf6.1.1.1.m1.1b"><ci id="S4.T1.sf6.1.1.1.m1.1.1.cmml" xref="S4.T1.sf6.1.1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.sf6.1.1.1.m1.1c">p</annotation></semantics></math></th>
<th id="S4.T1.sf6.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg</th>
<th id="S4.T1.sf6.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local</th>
<th id="S4.T1.sf6.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Fine-tuned</th>
<th id="S4.T1.sf6.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Mixture</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.sf6.1.2.1" class="ltx_tr">
<th id="S4.T1.sf6.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S4.T1.sf6.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">81.93</td>
<td id="S4.T1.sf6.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">34.22</td>
<td id="S4.T1.sf6.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">78.48</td>
<td id="S4.T1.sf6.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.sf6.1.2.1.5.1" class="ltx_text ltx_font_bold">80.53</span></td>
</tr>
<tr id="S4.T1.sf6.1.3.2" class="ltx_tr">
<th id="S4.T1.sf6.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.7</th>
<td id="S4.T1.sf6.1.3.2.2" class="ltx_td ltx_align_center">79.23</td>
<td id="S4.T1.sf6.1.3.2.3" class="ltx_td ltx_align_center">48.92</td>
<td id="S4.T1.sf6.1.3.2.4" class="ltx_td ltx_align_center">80.37</td>
<td id="S4.T1.sf6.1.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf6.1.3.2.5.1" class="ltx_text ltx_font_bold">81.98</span></td>
</tr>
<tr id="S4.T1.sf6.1.4.3" class="ltx_tr">
<th id="S4.T1.sf6.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.8</th>
<td id="S4.T1.sf6.1.4.3.2" class="ltx_td ltx_align_center">75.45</td>
<td id="S4.T1.sf6.1.4.3.3" class="ltx_td ltx_align_center">56.21</td>
<td id="S4.T1.sf6.1.4.3.4" class="ltx_td ltx_align_center">81.49</td>
<td id="S4.T1.sf6.1.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.sf6.1.4.3.5.1" class="ltx_text ltx_font_bold">82.66</span></td>
</tr>
<tr id="S4.T1.sf6.1.5.4" class="ltx_tr">
<th id="S4.T1.sf6.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S4.T1.sf6.1.5.4.2" class="ltx_td ltx_align_center">68.47</td>
<td id="S4.T1.sf6.1.5.4.3" class="ltx_td ltx_align_center">63.71</td>
<td id="S4.T1.sf6.1.5.4.4" class="ltx_td ltx_align_center"><span id="S4.T1.sf6.1.5.4.4.1" class="ltx_text ltx_font_bold">83.44</span></td>
<td id="S4.T1.sf6.1.5.4.5" class="ltx_td ltx_align_center">82.96</td>
</tr>
<tr id="S4.T1.sf6.1.6.5" class="ltx_tr">
<th id="S4.T1.sf6.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T1.sf6.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">54.86</td>
<td id="S4.T1.sf6.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">72.34</td>
<td id="S4.T1.sf6.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.sf6.1.6.5.4.1" class="ltx_text ltx_font_bold">87.26</span></td>
<td id="S4.T1.sf6.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb">86.51</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">(f) </span>AG News: Local test set</figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results and discussion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">For the sake of reproducibility, all code is made available. <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span id="footnote1.1" class="ltx_text ltx_font_typewriter">Link to github repo will be made available here.</span></span></span></span></p>
</div>
<figure id="S5.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/lr_cifar10.png" id="S5.F2.sf1.g1" class="ltx_graphics ltx_img_landscape" width="198" height="150" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/lr_fashion.png" id="S5.F2.sf2.g1" class="ltx_graphics ltx_img_landscape" width="198" height="150" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Fashion-MNIST</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/lr_agnews.png" id="S5.F2.sf3.g1" class="ltx_graphics ltx_img_landscape" width="198" height="149" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>AG News</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Learning rate vs balanced validation accuracy for <span id="S5.F2.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> on (a) CIFAR-10, (b) Fashion-MNIST and (c) AG News using different majority class fractions <math id="S5.F2.2.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.F2.2.m1.1b"><mi id="S5.F2.2.m1.1.1" xref="S5.F2.2.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.F2.2.m1.1c"><ci id="S5.F2.2.m1.1.1.cmml" xref="S5.F2.2.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.2.m1.1d">p</annotation></semantics></math>. Reported values are means over four runs.</figcaption>
</figure>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/cifar10_opt0.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="198" height="149" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10 (100 clients)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/fashion_opt0.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="198" height="148" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Fashion-MNIST (100 clients)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/agnews_opt0_alpha.png" id="S5.F3.sf3.g1" class="ltx_graphics ltx_img_landscape" width="198" height="147" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>AG News (1000 clients)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Accuracy on balanced test data (<math id="S5.F3.5.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.F3.5.m1.1b"><mi id="S5.F3.5.m1.1.1" xref="S5.F3.5.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.F3.5.m1.1c"><ci id="S5.F3.5.m1.1.1.cmml" xref="S5.F3.5.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.5.m1.1d">x</annotation></semantics></math>-axis) vs unbalanced local test data (<math id="S5.F3.6.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S5.F3.6.m2.1b"><mi id="S5.F3.6.m2.1.1" xref="S5.F3.6.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.F3.6.m2.1c"><ci id="S5.F3.6.m2.1.1.cmml" xref="S5.F3.6.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.6.m2.1d">y</annotation></semantics></math>-axis) for the three datasets with opt-out fraction <math id="S5.F3.7.m3.1" class="ltx_Math" alttext="q=0" display="inline"><semantics id="S5.F3.7.m3.1b"><mrow id="S5.F3.7.m3.1.1" xref="S5.F3.7.m3.1.1.cmml"><mi id="S5.F3.7.m3.1.1.2" xref="S5.F3.7.m3.1.1.2.cmml">q</mi><mo id="S5.F3.7.m3.1.1.1" xref="S5.F3.7.m3.1.1.1.cmml">=</mo><mn id="S5.F3.7.m3.1.1.3" xref="S5.F3.7.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.7.m3.1c"><apply id="S5.F3.7.m3.1.1.cmml" xref="S5.F3.7.m3.1.1"><eq id="S5.F3.7.m3.1.1.1.cmml" xref="S5.F3.7.m3.1.1.1"></eq><ci id="S5.F3.7.m3.1.1.2.cmml" xref="S5.F3.7.m3.1.1.2">𝑞</ci><cn type="integer" id="S5.F3.7.m3.1.1.3.cmml" xref="S5.F3.7.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.7.m3.1d">q=0</annotation></semantics></math>. Different majority class fractions <math id="S5.F3.8.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.F3.8.m4.1b"><mi id="S5.F3.8.m4.1.1" xref="S5.F3.8.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.F3.8.m4.1c"><ci id="S5.F3.8.m4.1.1.cmml" xref="S5.F3.8.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.8.m4.1d">p</annotation></semantics></math> are shown as colored numbers. Reported values are means over four runs.</figcaption>
</figure>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.4" class="ltx_p">Figure <a href="#S5.F2" title="Figure 2 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows a learning rate sweep for <span id="S5.p2.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> on all three datasets using different majority class fractions <math id="S5.p2.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.p2.1.m1.1a"><mi id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><ci id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">p</annotation></semantics></math>. The sweep was carried out over learning rates <math id="S5.p2.2.m2.5" class="ltx_Math" alttext="\eta=\{10^{-7},5\cdot 10^{-7},\dots,10^{-3},5\cdot 10^{-3}\}" display="inline"><semantics id="S5.p2.2.m2.5a"><mrow id="S5.p2.2.m2.5.5" xref="S5.p2.2.m2.5.5.cmml"><mi id="S5.p2.2.m2.5.5.6" xref="S5.p2.2.m2.5.5.6.cmml">η</mi><mo id="S5.p2.2.m2.5.5.5" xref="S5.p2.2.m2.5.5.5.cmml">=</mo><mrow id="S5.p2.2.m2.5.5.4.4" xref="S5.p2.2.m2.5.5.4.5.cmml"><mo stretchy="false" id="S5.p2.2.m2.5.5.4.4.5" xref="S5.p2.2.m2.5.5.4.5.cmml">{</mo><msup id="S5.p2.2.m2.2.2.1.1.1" xref="S5.p2.2.m2.2.2.1.1.1.cmml"><mn id="S5.p2.2.m2.2.2.1.1.1.2" xref="S5.p2.2.m2.2.2.1.1.1.2.cmml">10</mn><mrow id="S5.p2.2.m2.2.2.1.1.1.3" xref="S5.p2.2.m2.2.2.1.1.1.3.cmml"><mo id="S5.p2.2.m2.2.2.1.1.1.3a" xref="S5.p2.2.m2.2.2.1.1.1.3.cmml">−</mo><mn id="S5.p2.2.m2.2.2.1.1.1.3.2" xref="S5.p2.2.m2.2.2.1.1.1.3.2.cmml">7</mn></mrow></msup><mo id="S5.p2.2.m2.5.5.4.4.6" xref="S5.p2.2.m2.5.5.4.5.cmml">,</mo><mrow id="S5.p2.2.m2.3.3.2.2.2" xref="S5.p2.2.m2.3.3.2.2.2.cmml"><mn id="S5.p2.2.m2.3.3.2.2.2.2" xref="S5.p2.2.m2.3.3.2.2.2.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p2.2.m2.3.3.2.2.2.1" xref="S5.p2.2.m2.3.3.2.2.2.1.cmml">⋅</mo><msup id="S5.p2.2.m2.3.3.2.2.2.3" xref="S5.p2.2.m2.3.3.2.2.2.3.cmml"><mn id="S5.p2.2.m2.3.3.2.2.2.3.2" xref="S5.p2.2.m2.3.3.2.2.2.3.2.cmml">10</mn><mrow id="S5.p2.2.m2.3.3.2.2.2.3.3" xref="S5.p2.2.m2.3.3.2.2.2.3.3.cmml"><mo id="S5.p2.2.m2.3.3.2.2.2.3.3a" xref="S5.p2.2.m2.3.3.2.2.2.3.3.cmml">−</mo><mn id="S5.p2.2.m2.3.3.2.2.2.3.3.2" xref="S5.p2.2.m2.3.3.2.2.2.3.3.2.cmml">7</mn></mrow></msup></mrow><mo id="S5.p2.2.m2.5.5.4.4.7" xref="S5.p2.2.m2.5.5.4.5.cmml">,</mo><mi mathvariant="normal" id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml">…</mi><mo id="S5.p2.2.m2.5.5.4.4.8" xref="S5.p2.2.m2.5.5.4.5.cmml">,</mo><msup id="S5.p2.2.m2.4.4.3.3.3" xref="S5.p2.2.m2.4.4.3.3.3.cmml"><mn id="S5.p2.2.m2.4.4.3.3.3.2" xref="S5.p2.2.m2.4.4.3.3.3.2.cmml">10</mn><mrow id="S5.p2.2.m2.4.4.3.3.3.3" xref="S5.p2.2.m2.4.4.3.3.3.3.cmml"><mo id="S5.p2.2.m2.4.4.3.3.3.3a" xref="S5.p2.2.m2.4.4.3.3.3.3.cmml">−</mo><mn id="S5.p2.2.m2.4.4.3.3.3.3.2" xref="S5.p2.2.m2.4.4.3.3.3.3.2.cmml">3</mn></mrow></msup><mo id="S5.p2.2.m2.5.5.4.4.9" xref="S5.p2.2.m2.5.5.4.5.cmml">,</mo><mrow id="S5.p2.2.m2.5.5.4.4.4" xref="S5.p2.2.m2.5.5.4.4.4.cmml"><mn id="S5.p2.2.m2.5.5.4.4.4.2" xref="S5.p2.2.m2.5.5.4.4.4.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p2.2.m2.5.5.4.4.4.1" xref="S5.p2.2.m2.5.5.4.4.4.1.cmml">⋅</mo><msup id="S5.p2.2.m2.5.5.4.4.4.3" xref="S5.p2.2.m2.5.5.4.4.4.3.cmml"><mn id="S5.p2.2.m2.5.5.4.4.4.3.2" xref="S5.p2.2.m2.5.5.4.4.4.3.2.cmml">10</mn><mrow id="S5.p2.2.m2.5.5.4.4.4.3.3" xref="S5.p2.2.m2.5.5.4.4.4.3.3.cmml"><mo id="S5.p2.2.m2.5.5.4.4.4.3.3a" xref="S5.p2.2.m2.5.5.4.4.4.3.3.cmml">−</mo><mn id="S5.p2.2.m2.5.5.4.4.4.3.3.2" xref="S5.p2.2.m2.5.5.4.4.4.3.3.2.cmml">3</mn></mrow></msup></mrow><mo stretchy="false" id="S5.p2.2.m2.5.5.4.4.10" xref="S5.p2.2.m2.5.5.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.5b"><apply id="S5.p2.2.m2.5.5.cmml" xref="S5.p2.2.m2.5.5"><eq id="S5.p2.2.m2.5.5.5.cmml" xref="S5.p2.2.m2.5.5.5"></eq><ci id="S5.p2.2.m2.5.5.6.cmml" xref="S5.p2.2.m2.5.5.6">𝜂</ci><set id="S5.p2.2.m2.5.5.4.5.cmml" xref="S5.p2.2.m2.5.5.4.4"><apply id="S5.p2.2.m2.2.2.1.1.1.cmml" xref="S5.p2.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.p2.2.m2.2.2.1.1.1.1.cmml" xref="S5.p2.2.m2.2.2.1.1.1">superscript</csymbol><cn type="integer" id="S5.p2.2.m2.2.2.1.1.1.2.cmml" xref="S5.p2.2.m2.2.2.1.1.1.2">10</cn><apply id="S5.p2.2.m2.2.2.1.1.1.3.cmml" xref="S5.p2.2.m2.2.2.1.1.1.3"><minus id="S5.p2.2.m2.2.2.1.1.1.3.1.cmml" xref="S5.p2.2.m2.2.2.1.1.1.3"></minus><cn type="integer" id="S5.p2.2.m2.2.2.1.1.1.3.2.cmml" xref="S5.p2.2.m2.2.2.1.1.1.3.2">7</cn></apply></apply><apply id="S5.p2.2.m2.3.3.2.2.2.cmml" xref="S5.p2.2.m2.3.3.2.2.2"><ci id="S5.p2.2.m2.3.3.2.2.2.1.cmml" xref="S5.p2.2.m2.3.3.2.2.2.1">⋅</ci><cn type="integer" id="S5.p2.2.m2.3.3.2.2.2.2.cmml" xref="S5.p2.2.m2.3.3.2.2.2.2">5</cn><apply id="S5.p2.2.m2.3.3.2.2.2.3.cmml" xref="S5.p2.2.m2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S5.p2.2.m2.3.3.2.2.2.3.1.cmml" xref="S5.p2.2.m2.3.3.2.2.2.3">superscript</csymbol><cn type="integer" id="S5.p2.2.m2.3.3.2.2.2.3.2.cmml" xref="S5.p2.2.m2.3.3.2.2.2.3.2">10</cn><apply id="S5.p2.2.m2.3.3.2.2.2.3.3.cmml" xref="S5.p2.2.m2.3.3.2.2.2.3.3"><minus id="S5.p2.2.m2.3.3.2.2.2.3.3.1.cmml" xref="S5.p2.2.m2.3.3.2.2.2.3.3"></minus><cn type="integer" id="S5.p2.2.m2.3.3.2.2.2.3.3.2.cmml" xref="S5.p2.2.m2.3.3.2.2.2.3.3.2">7</cn></apply></apply></apply><ci id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1">…</ci><apply id="S5.p2.2.m2.4.4.3.3.3.cmml" xref="S5.p2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S5.p2.2.m2.4.4.3.3.3.1.cmml" xref="S5.p2.2.m2.4.4.3.3.3">superscript</csymbol><cn type="integer" id="S5.p2.2.m2.4.4.3.3.3.2.cmml" xref="S5.p2.2.m2.4.4.3.3.3.2">10</cn><apply id="S5.p2.2.m2.4.4.3.3.3.3.cmml" xref="S5.p2.2.m2.4.4.3.3.3.3"><minus id="S5.p2.2.m2.4.4.3.3.3.3.1.cmml" xref="S5.p2.2.m2.4.4.3.3.3.3"></minus><cn type="integer" id="S5.p2.2.m2.4.4.3.3.3.3.2.cmml" xref="S5.p2.2.m2.4.4.3.3.3.3.2">3</cn></apply></apply><apply id="S5.p2.2.m2.5.5.4.4.4.cmml" xref="S5.p2.2.m2.5.5.4.4.4"><ci id="S5.p2.2.m2.5.5.4.4.4.1.cmml" xref="S5.p2.2.m2.5.5.4.4.4.1">⋅</ci><cn type="integer" id="S5.p2.2.m2.5.5.4.4.4.2.cmml" xref="S5.p2.2.m2.5.5.4.4.4.2">5</cn><apply id="S5.p2.2.m2.5.5.4.4.4.3.cmml" xref="S5.p2.2.m2.5.5.4.4.4.3"><csymbol cd="ambiguous" id="S5.p2.2.m2.5.5.4.4.4.3.1.cmml" xref="S5.p2.2.m2.5.5.4.4.4.3">superscript</csymbol><cn type="integer" id="S5.p2.2.m2.5.5.4.4.4.3.2.cmml" xref="S5.p2.2.m2.5.5.4.4.4.3.2">10</cn><apply id="S5.p2.2.m2.5.5.4.4.4.3.3.cmml" xref="S5.p2.2.m2.5.5.4.4.4.3.3"><minus id="S5.p2.2.m2.5.5.4.4.4.3.3.1.cmml" xref="S5.p2.2.m2.5.5.4.4.4.3.3"></minus><cn type="integer" id="S5.p2.2.m2.5.5.4.4.4.3.3.2.cmml" xref="S5.p2.2.m2.5.5.4.4.4.3.3.2">3</cn></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.5c">\eta=\{10^{-7},5\cdot 10^{-7},\dots,10^{-3},5\cdot 10^{-3}\}</annotation></semantics></math>. The accuracy was calculated on a balanced validation set. The learning rate of <math id="S5.p2.3.m3.1" class="ltx_Math" alttext="\eta=5\cdot 10^{-5}" display="inline"><semantics id="S5.p2.3.m3.1a"><mrow id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml"><mi id="S5.p2.3.m3.1.1.2" xref="S5.p2.3.m3.1.1.2.cmml">η</mi><mo id="S5.p2.3.m3.1.1.1" xref="S5.p2.3.m3.1.1.1.cmml">=</mo><mrow id="S5.p2.3.m3.1.1.3" xref="S5.p2.3.m3.1.1.3.cmml"><mn id="S5.p2.3.m3.1.1.3.2" xref="S5.p2.3.m3.1.1.3.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p2.3.m3.1.1.3.1" xref="S5.p2.3.m3.1.1.3.1.cmml">⋅</mo><msup id="S5.p2.3.m3.1.1.3.3" xref="S5.p2.3.m3.1.1.3.3.cmml"><mn id="S5.p2.3.m3.1.1.3.3.2" xref="S5.p2.3.m3.1.1.3.3.2.cmml">10</mn><mrow id="S5.p2.3.m3.1.1.3.3.3" xref="S5.p2.3.m3.1.1.3.3.3.cmml"><mo id="S5.p2.3.m3.1.1.3.3.3a" xref="S5.p2.3.m3.1.1.3.3.3.cmml">−</mo><mn id="S5.p2.3.m3.1.1.3.3.3.2" xref="S5.p2.3.m3.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><apply id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1"><eq id="S5.p2.3.m3.1.1.1.cmml" xref="S5.p2.3.m3.1.1.1"></eq><ci id="S5.p2.3.m3.1.1.2.cmml" xref="S5.p2.3.m3.1.1.2">𝜂</ci><apply id="S5.p2.3.m3.1.1.3.cmml" xref="S5.p2.3.m3.1.1.3"><ci id="S5.p2.3.m3.1.1.3.1.cmml" xref="S5.p2.3.m3.1.1.3.1">⋅</ci><cn type="integer" id="S5.p2.3.m3.1.1.3.2.cmml" xref="S5.p2.3.m3.1.1.3.2">5</cn><apply id="S5.p2.3.m3.1.1.3.3.cmml" xref="S5.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S5.p2.3.m3.1.1.3.3.1.cmml" xref="S5.p2.3.m3.1.1.3.3">superscript</csymbol><cn type="integer" id="S5.p2.3.m3.1.1.3.3.2.cmml" xref="S5.p2.3.m3.1.1.3.3.2">10</cn><apply id="S5.p2.3.m3.1.1.3.3.3.cmml" xref="S5.p2.3.m3.1.1.3.3.3"><minus id="S5.p2.3.m3.1.1.3.3.3.1.cmml" xref="S5.p2.3.m3.1.1.3.3.3"></minus><cn type="integer" id="S5.p2.3.m3.1.1.3.3.3.2.cmml" xref="S5.p2.3.m3.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">\eta=5\cdot 10^{-5}</annotation></semantics></math> yielded the best validation accuracy for both CIFAR-10 and Fashion-MNIST, and given these results, we use this learning rate for training <span id="S5.p2.4.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> in all experiments for these two datasets. For the AG News dataset best overall performing learning rate was found to be <math id="S5.p2.4.m4.1" class="ltx_Math" alttext="\eta=5\cdot 10^{-4}" display="inline"><semantics id="S5.p2.4.m4.1a"><mrow id="S5.p2.4.m4.1.1" xref="S5.p2.4.m4.1.1.cmml"><mi id="S5.p2.4.m4.1.1.2" xref="S5.p2.4.m4.1.1.2.cmml">η</mi><mo id="S5.p2.4.m4.1.1.1" xref="S5.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S5.p2.4.m4.1.1.3" xref="S5.p2.4.m4.1.1.3.cmml"><mn id="S5.p2.4.m4.1.1.3.2" xref="S5.p2.4.m4.1.1.3.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p2.4.m4.1.1.3.1" xref="S5.p2.4.m4.1.1.3.1.cmml">⋅</mo><msup id="S5.p2.4.m4.1.1.3.3" xref="S5.p2.4.m4.1.1.3.3.cmml"><mn id="S5.p2.4.m4.1.1.3.3.2" xref="S5.p2.4.m4.1.1.3.3.2.cmml">10</mn><mrow id="S5.p2.4.m4.1.1.3.3.3" xref="S5.p2.4.m4.1.1.3.3.3.cmml"><mo id="S5.p2.4.m4.1.1.3.3.3a" xref="S5.p2.4.m4.1.1.3.3.3.cmml">−</mo><mn id="S5.p2.4.m4.1.1.3.3.3.2" xref="S5.p2.4.m4.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.4.m4.1b"><apply id="S5.p2.4.m4.1.1.cmml" xref="S5.p2.4.m4.1.1"><eq id="S5.p2.4.m4.1.1.1.cmml" xref="S5.p2.4.m4.1.1.1"></eq><ci id="S5.p2.4.m4.1.1.2.cmml" xref="S5.p2.4.m4.1.1.2">𝜂</ci><apply id="S5.p2.4.m4.1.1.3.cmml" xref="S5.p2.4.m4.1.1.3"><ci id="S5.p2.4.m4.1.1.3.1.cmml" xref="S5.p2.4.m4.1.1.3.1">⋅</ci><cn type="integer" id="S5.p2.4.m4.1.1.3.2.cmml" xref="S5.p2.4.m4.1.1.3.2">5</cn><apply id="S5.p2.4.m4.1.1.3.3.cmml" xref="S5.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S5.p2.4.m4.1.1.3.3.1.cmml" xref="S5.p2.4.m4.1.1.3.3">superscript</csymbol><cn type="integer" id="S5.p2.4.m4.1.1.3.3.2.cmml" xref="S5.p2.4.m4.1.1.3.3.2">10</cn><apply id="S5.p2.4.m4.1.1.3.3.3.cmml" xref="S5.p2.4.m4.1.1.3.3.3"><minus id="S5.p2.4.m4.1.1.3.3.3.1.cmml" xref="S5.p2.4.m4.1.1.3.3.3"></minus><cn type="integer" id="S5.p2.4.m4.1.1.3.3.3.2.cmml" xref="S5.p2.4.m4.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.4.m4.1c">\eta=5\cdot 10^{-4}</annotation></semantics></math>.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.4" class="ltx_p">The same learning rates of <math id="S5.p3.1.m1.1" class="ltx_Math" alttext="\eta=5\cdot 10^{-5}" display="inline"><semantics id="S5.p3.1.m1.1a"><mrow id="S5.p3.1.m1.1.1" xref="S5.p3.1.m1.1.1.cmml"><mi id="S5.p3.1.m1.1.1.2" xref="S5.p3.1.m1.1.1.2.cmml">η</mi><mo id="S5.p3.1.m1.1.1.1" xref="S5.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S5.p3.1.m1.1.1.3" xref="S5.p3.1.m1.1.1.3.cmml"><mn id="S5.p3.1.m1.1.1.3.2" xref="S5.p3.1.m1.1.1.3.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p3.1.m1.1.1.3.1" xref="S5.p3.1.m1.1.1.3.1.cmml">⋅</mo><msup id="S5.p3.1.m1.1.1.3.3" xref="S5.p3.1.m1.1.1.3.3.cmml"><mn id="S5.p3.1.m1.1.1.3.3.2" xref="S5.p3.1.m1.1.1.3.3.2.cmml">10</mn><mrow id="S5.p3.1.m1.1.1.3.3.3" xref="S5.p3.1.m1.1.1.3.3.3.cmml"><mo id="S5.p3.1.m1.1.1.3.3.3a" xref="S5.p3.1.m1.1.1.3.3.3.cmml">−</mo><mn id="S5.p3.1.m1.1.1.3.3.3.2" xref="S5.p3.1.m1.1.1.3.3.3.2.cmml">5</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.1.m1.1b"><apply id="S5.p3.1.m1.1.1.cmml" xref="S5.p3.1.m1.1.1"><eq id="S5.p3.1.m1.1.1.1.cmml" xref="S5.p3.1.m1.1.1.1"></eq><ci id="S5.p3.1.m1.1.1.2.cmml" xref="S5.p3.1.m1.1.1.2">𝜂</ci><apply id="S5.p3.1.m1.1.1.3.cmml" xref="S5.p3.1.m1.1.1.3"><ci id="S5.p3.1.m1.1.1.3.1.cmml" xref="S5.p3.1.m1.1.1.3.1">⋅</ci><cn type="integer" id="S5.p3.1.m1.1.1.3.2.cmml" xref="S5.p3.1.m1.1.1.3.2">5</cn><apply id="S5.p3.1.m1.1.1.3.3.cmml" xref="S5.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S5.p3.1.m1.1.1.3.3.1.cmml" xref="S5.p3.1.m1.1.1.3.3">superscript</csymbol><cn type="integer" id="S5.p3.1.m1.1.1.3.3.2.cmml" xref="S5.p3.1.m1.1.1.3.3.2">10</cn><apply id="S5.p3.1.m1.1.1.3.3.3.cmml" xref="S5.p3.1.m1.1.1.3.3.3"><minus id="S5.p3.1.m1.1.1.3.3.3.1.cmml" xref="S5.p3.1.m1.1.1.3.3.3"></minus><cn type="integer" id="S5.p3.1.m1.1.1.3.3.3.2.cmml" xref="S5.p3.1.m1.1.1.3.3.3.2">5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.1.m1.1c">\eta=5\cdot 10^{-5}</annotation></semantics></math> (CIFAR-10 and Fashion-MNIST) and <math id="S5.p3.2.m2.1" class="ltx_Math" alttext="\eta=5\cdot 10^{-4}" display="inline"><semantics id="S5.p3.2.m2.1a"><mrow id="S5.p3.2.m2.1.1" xref="S5.p3.2.m2.1.1.cmml"><mi id="S5.p3.2.m2.1.1.2" xref="S5.p3.2.m2.1.1.2.cmml">η</mi><mo id="S5.p3.2.m2.1.1.1" xref="S5.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S5.p3.2.m2.1.1.3" xref="S5.p3.2.m2.1.1.3.cmml"><mn id="S5.p3.2.m2.1.1.3.2" xref="S5.p3.2.m2.1.1.3.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S5.p3.2.m2.1.1.3.1" xref="S5.p3.2.m2.1.1.3.1.cmml">⋅</mo><msup id="S5.p3.2.m2.1.1.3.3" xref="S5.p3.2.m2.1.1.3.3.cmml"><mn id="S5.p3.2.m2.1.1.3.3.2" xref="S5.p3.2.m2.1.1.3.3.2.cmml">10</mn><mrow id="S5.p3.2.m2.1.1.3.3.3" xref="S5.p3.2.m2.1.1.3.3.3.cmml"><mo id="S5.p3.2.m2.1.1.3.3.3a" xref="S5.p3.2.m2.1.1.3.3.3.cmml">−</mo><mn id="S5.p3.2.m2.1.1.3.3.3.2" xref="S5.p3.2.m2.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.2.m2.1b"><apply id="S5.p3.2.m2.1.1.cmml" xref="S5.p3.2.m2.1.1"><eq id="S5.p3.2.m2.1.1.1.cmml" xref="S5.p3.2.m2.1.1.1"></eq><ci id="S5.p3.2.m2.1.1.2.cmml" xref="S5.p3.2.m2.1.1.2">𝜂</ci><apply id="S5.p3.2.m2.1.1.3.cmml" xref="S5.p3.2.m2.1.1.3"><ci id="S5.p3.2.m2.1.1.3.1.cmml" xref="S5.p3.2.m2.1.1.3.1">⋅</ci><cn type="integer" id="S5.p3.2.m2.1.1.3.2.cmml" xref="S5.p3.2.m2.1.1.3.2">5</cn><apply id="S5.p3.2.m2.1.1.3.3.cmml" xref="S5.p3.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S5.p3.2.m2.1.1.3.3.1.cmml" xref="S5.p3.2.m2.1.1.3.3">superscript</csymbol><cn type="integer" id="S5.p3.2.m2.1.1.3.3.2.cmml" xref="S5.p3.2.m2.1.1.3.3.2">10</cn><apply id="S5.p3.2.m2.1.1.3.3.3.cmml" xref="S5.p3.2.m2.1.1.3.3.3"><minus id="S5.p3.2.m2.1.1.3.3.3.1.cmml" xref="S5.p3.2.m2.1.1.3.3.3"></minus><cn type="integer" id="S5.p3.2.m2.1.1.3.3.3.2.cmml" xref="S5.p3.2.m2.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.2.m2.1c">\eta=5\cdot 10^{-4}</annotation></semantics></math> (AG News) was set to train the local baseline models. For the fine-tuned baseline model and the mixture of experts, a lower learning rate was used of <math id="S5.p3.3.m3.1" class="ltx_Math" alttext="\eta=10^{-5}" display="inline"><semantics id="S5.p3.3.m3.1a"><mrow id="S5.p3.3.m3.1.1" xref="S5.p3.3.m3.1.1.cmml"><mi id="S5.p3.3.m3.1.1.2" xref="S5.p3.3.m3.1.1.2.cmml">η</mi><mo id="S5.p3.3.m3.1.1.1" xref="S5.p3.3.m3.1.1.1.cmml">=</mo><msup id="S5.p3.3.m3.1.1.3" xref="S5.p3.3.m3.1.1.3.cmml"><mn id="S5.p3.3.m3.1.1.3.2" xref="S5.p3.3.m3.1.1.3.2.cmml">10</mn><mrow id="S5.p3.3.m3.1.1.3.3" xref="S5.p3.3.m3.1.1.3.3.cmml"><mo id="S5.p3.3.m3.1.1.3.3a" xref="S5.p3.3.m3.1.1.3.3.cmml">−</mo><mn id="S5.p3.3.m3.1.1.3.3.2" xref="S5.p3.3.m3.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.3.m3.1b"><apply id="S5.p3.3.m3.1.1.cmml" xref="S5.p3.3.m3.1.1"><eq id="S5.p3.3.m3.1.1.1.cmml" xref="S5.p3.3.m3.1.1.1"></eq><ci id="S5.p3.3.m3.1.1.2.cmml" xref="S5.p3.3.m3.1.1.2">𝜂</ci><apply id="S5.p3.3.m3.1.1.3.cmml" xref="S5.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.p3.3.m3.1.1.3.1.cmml" xref="S5.p3.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S5.p3.3.m3.1.1.3.2.cmml" xref="S5.p3.3.m3.1.1.3.2">10</cn><apply id="S5.p3.3.m3.1.1.3.3.cmml" xref="S5.p3.3.m3.1.1.3.3"><minus id="S5.p3.3.m3.1.1.3.3.1.cmml" xref="S5.p3.3.m3.1.1.3.3"></minus><cn type="integer" id="S5.p3.3.m3.1.1.3.3.2.cmml" xref="S5.p3.3.m3.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.3.m3.1c">\eta=10^{-5}</annotation></semantics></math> for CIFAR-10 and Fashion-MNIST and <math id="S5.p3.4.m4.1" class="ltx_Math" alttext="\eta=10^{-6}" display="inline"><semantics id="S5.p3.4.m4.1a"><mrow id="S5.p3.4.m4.1.1" xref="S5.p3.4.m4.1.1.cmml"><mi id="S5.p3.4.m4.1.1.2" xref="S5.p3.4.m4.1.1.2.cmml">η</mi><mo id="S5.p3.4.m4.1.1.1" xref="S5.p3.4.m4.1.1.1.cmml">=</mo><msup id="S5.p3.4.m4.1.1.3" xref="S5.p3.4.m4.1.1.3.cmml"><mn id="S5.p3.4.m4.1.1.3.2" xref="S5.p3.4.m4.1.1.3.2.cmml">10</mn><mrow id="S5.p3.4.m4.1.1.3.3" xref="S5.p3.4.m4.1.1.3.3.cmml"><mo id="S5.p3.4.m4.1.1.3.3a" xref="S5.p3.4.m4.1.1.3.3.cmml">−</mo><mn id="S5.p3.4.m4.1.1.3.3.2" xref="S5.p3.4.m4.1.1.3.3.2.cmml">6</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.p3.4.m4.1b"><apply id="S5.p3.4.m4.1.1.cmml" xref="S5.p3.4.m4.1.1"><eq id="S5.p3.4.m4.1.1.1.cmml" xref="S5.p3.4.m4.1.1.1"></eq><ci id="S5.p3.4.m4.1.1.2.cmml" xref="S5.p3.4.m4.1.1.2">𝜂</ci><apply id="S5.p3.4.m4.1.1.3.cmml" xref="S5.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.p3.4.m4.1.1.3.1.cmml" xref="S5.p3.4.m4.1.1.3">superscript</csymbol><cn type="integer" id="S5.p3.4.m4.1.1.3.2.cmml" xref="S5.p3.4.m4.1.1.3.2">10</cn><apply id="S5.p3.4.m4.1.1.3.3.cmml" xref="S5.p3.4.m4.1.1.3.3"><minus id="S5.p3.4.m4.1.1.3.3.1.cmml" xref="S5.p3.4.m4.1.1.3.3"></minus><cn type="integer" id="S5.p3.4.m4.1.1.3.3.2.cmml" xref="S5.p3.4.m4.1.1.3.3.2">6</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p3.4.m4.1c">\eta=10^{-6}</annotation></semantics></math> for AG News. In the appendix we show training and validation losses for <span id="S5.p3.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> over communication rounds.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">In Table <a href="#S4.T1" title="Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> we see results for the three datasets for varying majority class fractions <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.p4.1.m1.1a"><mi id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><ci id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">p</annotation></semantics></math>. The leftmost Tables <a href="#S4.T1.sf1" title="In Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1a</span></a>, <a href="#S4.T1.sf3" title="In Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1c</span></a> and <a href="#S4.T1.sf5" title="In Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1e</span></a> show the results for a global (balanced) dataset, which is the same for all clients. The rightmost tables <a href="#S4.T1.sf2" title="In Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1b</span></a>, <a href="#S4.T1.sf4" title="In Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1d</span></a> and <a href="#S4.T1.sf6" title="In Table 1 ‣ 4 Experimental setup ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1f</span></a> show the results on a local (unbalanced) dataset mirroring each clients distribution. In bold we present the best performing specialist. We note here that our proposed mixture of experts is overall the best specialist model in terms of generalization, whereas it performs roughly equally as good as the fine-tuned specialist on a local test set.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.2" class="ltx_p">This is further visualized for all datasets in Figure <a href="#S5.F3" title="Figure 3 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Here the global test accuracy is shown on the <math id="S5.p5.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.p5.1.m1.1a"><mi id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><ci id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">x</annotation></semantics></math>-axis and the local test accuracy is shown on the <math id="S5.p5.2.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S5.p5.2.m2.1a"><mi id="S5.p5.2.m2.1.1" xref="S5.p5.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.p5.2.m2.1b"><ci id="S5.p5.2.m2.1.1.cmml" xref="S5.p5.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m2.1c">y</annotation></semantics></math>-axis for the different baselines. We note that the mixture of expert consistently outperforms the fine-tuned specialist on all three datasets, performing roughly equal on a local test set while consistently outperforming it on the global test set.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.2" class="ltx_p">In Figure <a href="#S5.F4" title="Figure 4 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> global test accuracies for the fine-tuned baseline and the mixture of experts on all datasets are shown, as a fraction of <span id="S5.p6.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> test accuracy. Here we see that that our proposed method consistently outperforms the fine-tuned baseline in terms of generalization, being the closest to <span id="S5.p6.2.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> performance in all settings. In Figure <a href="#S5.F5" title="Figure 5 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> similar results for different Dirichlet <math id="S5.p6.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.p6.1.m1.1a"><mi id="S5.p6.1.m1.1.1" xref="S5.p6.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.p6.1.m1.1b"><ci id="S5.p6.1.m1.1.1.cmml" xref="S5.p6.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.1.m1.1c">\alpha</annotation></semantics></math> values are presented, instead of majority class fractions <math id="S5.p6.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.p6.2.m2.1a"><mi id="S5.p6.2.m2.1.1" xref="S5.p6.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.p6.2.m2.1b"><ci id="S5.p6.2.m2.1.1.cmml" xref="S5.p6.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p6.2.m2.1c">p</annotation></semantics></math>.</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/cifar10_fraction_opt0.png" id="S5.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="198" height="148" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10 (100 clients)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/agnews_fraction_opt0.png" id="S5.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="198" height="144" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>AG News (1000 clients)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/fashion_fraction_opt0.png" id="S5.F4.sf3.g1" class="ltx_graphics ltx_img_landscape" width="198" height="152" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Fashion-MNIST (100 clients)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Test accuracy with a <math id="S5.F4.3.m1.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="S5.F4.3.m1.1b"><mrow id="S5.F4.3.m1.1.1" xref="S5.F4.3.m1.1.1.cmml"><mn id="S5.F4.3.m1.1.1.2" xref="S5.F4.3.m1.1.1.2.cmml">95</mn><mo id="S5.F4.3.m1.1.1.1" xref="S5.F4.3.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.3.m1.1c"><apply id="S5.F4.3.m1.1.1.cmml" xref="S5.F4.3.m1.1.1"><csymbol cd="latexml" id="S5.F4.3.m1.1.1.1.cmml" xref="S5.F4.3.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.F4.3.m1.1.1.2.cmml" xref="S5.F4.3.m1.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.3.m1.1d">95\%</annotation></semantics></math> confidence interval vs majority class fractions for fine-tuned baseline and the mixture on a global (balanced) test set for (a) CIFAR-10 and (b) AG News and (c) Fashion-MNIST, as a fraction of <span id="S5.F4.6.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> test accuracy. Opt-out fraction <math id="S5.F4.4.m2.1" class="ltx_Math" alttext="q=0" display="inline"><semantics id="S5.F4.4.m2.1b"><mrow id="S5.F4.4.m2.1.1" xref="S5.F4.4.m2.1.1.cmml"><mi id="S5.F4.4.m2.1.1.2" xref="S5.F4.4.m2.1.1.2.cmml">q</mi><mo id="S5.F4.4.m2.1.1.1" xref="S5.F4.4.m2.1.1.1.cmml">=</mo><mn id="S5.F4.4.m2.1.1.3" xref="S5.F4.4.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F4.4.m2.1c"><apply id="S5.F4.4.m2.1.1.cmml" xref="S5.F4.4.m2.1.1"><eq id="S5.F4.4.m2.1.1.1.cmml" xref="S5.F4.4.m2.1.1.1"></eq><ci id="S5.F4.4.m2.1.1.2.cmml" xref="S5.F4.4.m2.1.1.2">𝑞</ci><cn type="integer" id="S5.F4.4.m2.1.1.3.cmml" xref="S5.F4.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.m2.1d">q=0</annotation></semantics></math>. Reported values are means over four runs.</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/cifar10_fraction_alpha.png" id="S5.F5.sf1.g1" class="ltx_graphics ltx_img_landscape" width="198" height="151" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>CIFAR-10 (100 clients)</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/fashion_fraction_alpha.png" id="S5.F5.sf2.g1" class="ltx_graphics ltx_img_landscape" width="198" height="151" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Fashion-MNIST (100 clients)</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Test accuracy with a <math id="S5.F5.4.m1.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="S5.F5.4.m1.1b"><mrow id="S5.F5.4.m1.1.1" xref="S5.F5.4.m1.1.1.cmml"><mn id="S5.F5.4.m1.1.1.2" xref="S5.F5.4.m1.1.1.2.cmml">95</mn><mo id="S5.F5.4.m1.1.1.1" xref="S5.F5.4.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.4.m1.1c"><apply id="S5.F5.4.m1.1.1.cmml" xref="S5.F5.4.m1.1.1"><csymbol cd="latexml" id="S5.F5.4.m1.1.1.1.cmml" xref="S5.F5.4.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.F5.4.m1.1.1.2.cmml" xref="S5.F5.4.m1.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.m1.1d">95\%</annotation></semantics></math> confidence interval vs Dirichlet parameter <math id="S5.F5.5.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.F5.5.m2.1b"><mi id="S5.F5.5.m2.1.1" xref="S5.F5.5.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.F5.5.m2.1c"><ci id="S5.F5.5.m2.1.1.cmml" xref="S5.F5.5.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.5.m2.1d">\alpha</annotation></semantics></math> for fine-tuned baseline and the mixture on a global (balanced) test set for (a) CIFAR-10 and (b) Fashion-MNIST, as a fraction of <span id="S5.F5.8.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> test accuracy. Opt-out fraction <math id="S5.F5.6.m3.1" class="ltx_Math" alttext="q=0" display="inline"><semantics id="S5.F5.6.m3.1b"><mrow id="S5.F5.6.m3.1.1" xref="S5.F5.6.m3.1.1.cmml"><mi id="S5.F5.6.m3.1.1.2" xref="S5.F5.6.m3.1.1.2.cmml">q</mi><mo id="S5.F5.6.m3.1.1.1" xref="S5.F5.6.m3.1.1.1.cmml">=</mo><mn id="S5.F5.6.m3.1.1.3" xref="S5.F5.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.6.m3.1c"><apply id="S5.F5.6.m3.1.1.cmml" xref="S5.F5.6.m3.1.1"><eq id="S5.F5.6.m3.1.1.1.cmml" xref="S5.F5.6.m3.1.1.1"></eq><ci id="S5.F5.6.m3.1.1.2.cmml" xref="S5.F5.6.m3.1.1.2">𝑞</ci><cn type="integer" id="S5.F5.6.m3.1.1.3.cmml" xref="S5.F5.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.6.m3.1d">q=0</annotation></semantics></math>. Reported values are means over four runs.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="S5.p7" class="ltx_para">
<p id="S5.p7.6" class="ltx_p"><span id="S5.p7.6.1" class="ltx_text ltx_font_bold">Opt-out fractions.</span> Experiments were carried out to test what effect client opt-out has on performance. The results can be seen in Figure <a href="#S5.F6" title="Figure 6 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> for CIFAR-10 over varying majority class fractions <math id="S5.p7.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.p7.1.m1.1a"><mi id="S5.p7.1.m1.1.1" xref="S5.p7.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.p7.1.m1.1b"><ci id="S5.p7.1.m1.1.1.cmml" xref="S5.p7.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.1.m1.1c">p</annotation></semantics></math> with large opt-out fractions of <math id="S5.p7.2.m2.2" class="ltx_Math" alttext="q=\{0.9,0.95\}" display="inline"><semantics id="S5.p7.2.m2.2a"><mrow id="S5.p7.2.m2.2.3" xref="S5.p7.2.m2.2.3.cmml"><mi id="S5.p7.2.m2.2.3.2" xref="S5.p7.2.m2.2.3.2.cmml">q</mi><mo id="S5.p7.2.m2.2.3.1" xref="S5.p7.2.m2.2.3.1.cmml">=</mo><mrow id="S5.p7.2.m2.2.3.3.2" xref="S5.p7.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S5.p7.2.m2.2.3.3.2.1" xref="S5.p7.2.m2.2.3.3.1.cmml">{</mo><mn id="S5.p7.2.m2.1.1" xref="S5.p7.2.m2.1.1.cmml">0.9</mn><mo id="S5.p7.2.m2.2.3.3.2.2" xref="S5.p7.2.m2.2.3.3.1.cmml">,</mo><mn id="S5.p7.2.m2.2.2" xref="S5.p7.2.m2.2.2.cmml">0.95</mn><mo stretchy="false" id="S5.p7.2.m2.2.3.3.2.3" xref="S5.p7.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.2.m2.2b"><apply id="S5.p7.2.m2.2.3.cmml" xref="S5.p7.2.m2.2.3"><eq id="S5.p7.2.m2.2.3.1.cmml" xref="S5.p7.2.m2.2.3.1"></eq><ci id="S5.p7.2.m2.2.3.2.cmml" xref="S5.p7.2.m2.2.3.2">𝑞</ci><set id="S5.p7.2.m2.2.3.3.1.cmml" xref="S5.p7.2.m2.2.3.3.2"><cn type="float" id="S5.p7.2.m2.1.1.cmml" xref="S5.p7.2.m2.1.1">0.9</cn><cn type="float" id="S5.p7.2.m2.2.2.cmml" xref="S5.p7.2.m2.2.2">0.95</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.2.m2.2c">q=\{0.9,0.95\}</annotation></semantics></math>, meaning that <math id="S5.p7.3.m3.1" class="ltx_Math" alttext="90\%" display="inline"><semantics id="S5.p7.3.m3.1a"><mrow id="S5.p7.3.m3.1.1" xref="S5.p7.3.m3.1.1.cmml"><mn id="S5.p7.3.m3.1.1.2" xref="S5.p7.3.m3.1.1.2.cmml">90</mn><mo id="S5.p7.3.m3.1.1.1" xref="S5.p7.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.3.m3.1b"><apply id="S5.p7.3.m3.1.1.cmml" xref="S5.p7.3.m3.1.1"><csymbol cd="latexml" id="S5.p7.3.m3.1.1.1.cmml" xref="S5.p7.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S5.p7.3.m3.1.1.2.cmml" xref="S5.p7.3.m3.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.3.m3.1c">90\%</annotation></semantics></math> and <math id="S5.p7.4.m4.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="S5.p7.4.m4.1a"><mrow id="S5.p7.4.m4.1.1" xref="S5.p7.4.m4.1.1.cmml"><mn id="S5.p7.4.m4.1.1.2" xref="S5.p7.4.m4.1.1.2.cmml">95</mn><mo id="S5.p7.4.m4.1.1.1" xref="S5.p7.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.4.m4.1b"><apply id="S5.p7.4.m4.1.1.cmml" xref="S5.p7.4.m4.1.1"><csymbol cd="latexml" id="S5.p7.4.m4.1.1.1.cmml" xref="S5.p7.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S5.p7.4.m4.1.1.2.cmml" xref="S5.p7.4.m4.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.4.m4.1c">95\%</annotation></semantics></math> of clients, respectively, choose not to participate in the federated learning, but still obtains the global model at the end of training. Similar to the results with no opt-out (<math id="S5.p7.5.m5.1" class="ltx_Math" alttext="q=0" display="inline"><semantics id="S5.p7.5.m5.1a"><mrow id="S5.p7.5.m5.1.1" xref="S5.p7.5.m5.1.1.cmml"><mi id="S5.p7.5.m5.1.1.2" xref="S5.p7.5.m5.1.1.2.cmml">q</mi><mo id="S5.p7.5.m5.1.1.1" xref="S5.p7.5.m5.1.1.1.cmml">=</mo><mn id="S5.p7.5.m5.1.1.3" xref="S5.p7.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.5.m5.1b"><apply id="S5.p7.5.m5.1.1.cmml" xref="S5.p7.5.m5.1.1"><eq id="S5.p7.5.m5.1.1.1.cmml" xref="S5.p7.5.m5.1.1.1"></eq><ci id="S5.p7.5.m5.1.1.2.cmml" xref="S5.p7.5.m5.1.1.2">𝑞</ci><cn type="integer" id="S5.p7.5.m5.1.1.3.cmml" xref="S5.p7.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.5.m5.1c">q=0</annotation></semantics></math>), our proposed model outperforms the fine-tuned baseline on the global test set, while performing on par on the local test sets. In Figure <a href="#S5.F6.sf2" title="In Figure 6 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6b</span></a>, we see that in the iid case of <math id="S5.p7.6.m6.1" class="ltx_Math" alttext="p=0.2" display="inline"><semantics id="S5.p7.6.m6.1a"><mrow id="S5.p7.6.m6.1.1" xref="S5.p7.6.m6.1.1.cmml"><mi id="S5.p7.6.m6.1.1.2" xref="S5.p7.6.m6.1.1.2.cmml">p</mi><mo id="S5.p7.6.m6.1.1.1" xref="S5.p7.6.m6.1.1.1.cmml">=</mo><mn id="S5.p7.6.m6.1.1.3" xref="S5.p7.6.m6.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.6.m6.1b"><apply id="S5.p7.6.m6.1.1.cmml" xref="S5.p7.6.m6.1.1"><eq id="S5.p7.6.m6.1.1.1.cmml" xref="S5.p7.6.m6.1.1.1"></eq><ci id="S5.p7.6.m6.1.1.2.cmml" xref="S5.p7.6.m6.1.1.2">𝑝</ci><cn type="float" id="S5.p7.6.m6.1.1.3.cmml" xref="S5.p7.6.m6.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.6.m6.1c">p=0.2</annotation></semantics></math> that the mixture not only outperforms the fine-tuned model, but also <span id="S5.p7.6.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> in both generalization and specialization. This shows that the mixture in this setting is more robust to many clients opting out from federated learning.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F6.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/cifar10_opt09.png" id="S5.F6.sf1.g1" class="ltx_graphics ltx_img_landscape" width="198" height="148" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Opt out-fraction <math id="S5.F6.sf1.2.m1.1" class="ltx_Math" alttext="q=0.9" display="inline"><semantics id="S5.F6.sf1.2.m1.1b"><mrow id="S5.F6.sf1.2.m1.1.1" xref="S5.F6.sf1.2.m1.1.1.cmml"><mi id="S5.F6.sf1.2.m1.1.1.2" xref="S5.F6.sf1.2.m1.1.1.2.cmml">q</mi><mo id="S5.F6.sf1.2.m1.1.1.1" xref="S5.F6.sf1.2.m1.1.1.1.cmml">=</mo><mn id="S5.F6.sf1.2.m1.1.1.3" xref="S5.F6.sf1.2.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.sf1.2.m1.1c"><apply id="S5.F6.sf1.2.m1.1.1.cmml" xref="S5.F6.sf1.2.m1.1.1"><eq id="S5.F6.sf1.2.m1.1.1.1.cmml" xref="S5.F6.sf1.2.m1.1.1.1"></eq><ci id="S5.F6.sf1.2.m1.1.1.2.cmml" xref="S5.F6.sf1.2.m1.1.1.2">𝑞</ci><cn type="float" id="S5.F6.sf1.2.m1.1.1.3.cmml" xref="S5.F6.sf1.2.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.sf1.2.m1.1d">q=0.9</annotation></semantics></math></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F6.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.02056/assets/cifar10_opt95.png" id="S5.F6.sf2.g1" class="ltx_graphics ltx_img_landscape" width="198" height="150" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Opt-out fraction <math id="S5.F6.sf2.2.m1.1" class="ltx_Math" alttext="q=0.95" display="inline"><semantics id="S5.F6.sf2.2.m1.1b"><mrow id="S5.F6.sf2.2.m1.1.1" xref="S5.F6.sf2.2.m1.1.1.cmml"><mi id="S5.F6.sf2.2.m1.1.1.2" xref="S5.F6.sf2.2.m1.1.1.2.cmml">q</mi><mo id="S5.F6.sf2.2.m1.1.1.1" xref="S5.F6.sf2.2.m1.1.1.1.cmml">=</mo><mn id="S5.F6.sf2.2.m1.1.1.3" xref="S5.F6.sf2.2.m1.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.sf2.2.m1.1c"><apply id="S5.F6.sf2.2.m1.1.1.cmml" xref="S5.F6.sf2.2.m1.1.1"><eq id="S5.F6.sf2.2.m1.1.1.1.cmml" xref="S5.F6.sf2.2.m1.1.1.1"></eq><ci id="S5.F6.sf2.2.m1.1.1.2.cmml" xref="S5.F6.sf2.2.m1.1.1.2">𝑞</ci><cn type="float" id="S5.F6.sf2.2.m1.1.1.3.cmml" xref="S5.F6.sf2.2.m1.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.sf2.2.m1.1d">q=0.95</annotation></semantics></math></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Test accuracy on a global test set (<math id="S5.F6.4.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.F6.4.m1.1b"><mi id="S5.F6.4.m1.1.1" xref="S5.F6.4.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S5.F6.4.m1.1c"><ci id="S5.F6.4.m1.1.1.cmml" xref="S5.F6.4.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.4.m1.1d">x</annotation></semantics></math>-axis) and local test set (<math id="S5.F6.5.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S5.F6.5.m2.1b"><mi id="S5.F6.5.m2.1.1" xref="S5.F6.5.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S5.F6.5.m2.1c"><ci id="S5.F6.5.m2.1.1.cmml" xref="S5.F6.5.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.5.m2.1d">y</annotation></semantics></math>-axis) for the CIFAR-10 dataset, with two different opt-out fractions <math id="S5.F6.6.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S5.F6.6.m3.1b"><mi id="S5.F6.6.m3.1.1" xref="S5.F6.6.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.F6.6.m3.1c"><ci id="S5.F6.6.m3.1.1.cmml" xref="S5.F6.6.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.6.m3.1d">q</annotation></semantics></math>. Majority class fractions are shown in colored numbers.</figcaption>
</figure>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">To address the problems of learning a personalized model in a federated setting when the client data is heterogeneous, we have proposed a novel framework for federated mixtures of experts where a global model is combined with a local specialist model.
We find that by combining the two expert models we achieve high performance on local client datasets, with minimal loss on generalization as compared to a fine-tuned baseline on two image classification datasets and one text classification dataset in highly non-iid settings, and achieve test accuracies on par with <span id="S6.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> in iid settings.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Our approach is not only an intuitive approach for the generalist vs specialist balance, but also allows for varying level of participation of the different clients in the federation. As such, the framework gives strong privacy guarantees, where clients who do not want to disclose their data are able to opt out and keep their data completely private. The experiments show that our proposed solution is robust to a high opt-out fraction of users, as seen in Figure <a href="#S5.F3" title="Figure 3 ‣ 5 Results and discussion ‣ Specialized federated learning using a mixture of experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. It thus constitutes a flexible solution for strong privacy guarantees in real-world settings where users might not want to disclose their model to a central server.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">The proposed framework is compatible with any gradient-based machine learning model, and can incorporate combinations of these, strengthening the potential of this direction of research, and leveraging the beneficial properties of ensembles of various machine learning models.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">In this work we limited our experiments to non-identical distributions in the form of prior probability shift. We hypothesize that our proposed method can handle other distributional shifts, such as covariate or concept shifts as well, and see this as an interesting direction for future work.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Arivazhagan, M. G., Aggarwal, V., Singh, A. K., and Choudhary, S.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.00818</em>, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bellet et al. (2018)</span>
<span class="ltx_bibblock">
Bellet, A., Guerraoui, R., Taziki, M., and Tommasi, M.

</span>
<span class="ltx_bibblock">Personalized and private peer-to-peer machine learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics</em>, pp.  473–481, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2020)</span>
<span class="ltx_bibblock">
Deng, Y., Kamani, M. M., and Mahdavi, M.

</span>
<span class="ltx_bibblock">Adaptive personalized federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al. (2020)</span>
<span class="ltx_bibblock">
Fallah, A., Mokhtari, A., and Ozdaglar, A.

</span>
<span class="ltx_bibblock">Personalized federated learning: A meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.07948</em>, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn et al. (2017)</span>
<span class="ltx_bibblock">
Finn, C., Abbeel, P., and Levine, S.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gulli (2004)</span>
<span class="ltx_bibblock">
Gulli, A.

</span>
<span class="ltx_bibblock">Ag’s corpus of news articles.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">URL http://groups. di. unipi. it/~ gulli/AG_
corpus_of_news_articles. html</em>, 2004.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hanzely &amp; Richtárik (2020)</span>
<span class="ltx_bibblock">
Hanzely, F. and Richtárik, P.

</span>
<span class="ltx_bibblock">Federated learning of a mixture of global and local models.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al. (2018)</span>
<span class="ltx_bibblock">
Hard, A., Kiddon, C. M., Ramage, D., Beaufays, F., Eichner, H., Rao, K.,
Mathews, R., and Augenstein, S.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction, 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/1811.03604" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1811.03604</a>.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
He, C., Avestimehr, S., and Annavaram, M.

</span>
<span class="ltx_bibblock">Group knowledge transfer: Collaborative training of large cnns on the
edge.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33
proceedings (NeurIPS)</em>, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al. (2020)</span>
<span class="ltx_bibblock">
Hsieh, K., Phanishayee, A., Mutlu, O., and Gibbons, P.

</span>
<span class="ltx_bibblock">The non-iid data quagmire of decentralized machine learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 4387–4398. PMLR, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2019)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H., Qi, H., and Brown, M.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et al. (1991)</span>
<span class="ltx_bibblock">
Jacobs, R. A., Jordan, M. I., Nowlan, S. J., and Hinton, G. E.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, 3(1):79–87, 1991.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2018)</span>
<span class="ltx_bibblock">
Jeong, E., Oh, S., Kim, H., Park, J., Bennis, M., and Kim, S.-L.

</span>
<span class="ltx_bibblock">Communication-efficient on-device machine learning: Federated
distillation and augmentation under non-iid private data.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.11479</em>, 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2019)</span>
<span class="ltx_bibblock">
Jiang, Y., Konečnỳ, J., Rush, K., and Kannan, S.

</span>
<span class="ltx_bibblock">Improving federated learning personalization via model agnostic meta
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.12488</em>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson &amp; Khoshgoftaar (2019)</span>
<span class="ltx_bibblock">
Johnson, J. M. and Khoshgoftaar, T. M.

</span>
<span class="ltx_bibblock">Survey on deep learning with class imbalance.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Journal of Big Data</em>, 6(1):27, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2019)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N.,
Bonawitz, K., Charles, Z., Cormode, G., Cummings, R., et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.04977</em>, 2019.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Ba, J.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al. (2016)</span>
<span class="ltx_bibblock">
Konečnỳ, J., McMahan, H. B., Yu, F. X., Richtárik, P., Suresh,
A. T., and Bacon, D.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Lin, T., Kong, L., Stich, S. U., and Jaggi, M.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 33, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mansour et al. (2009)</span>
<span class="ltx_bibblock">
Mansour, Y., Mohri, M., and Rostamizadeh, A.

</span>
<span class="ltx_bibblock">Domain adaptation: Learning bounds and algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:0902.3430</em>, 2009.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al. (2014)</span>
<span class="ltx_bibblock">
Oquab, M., Bottou, L., Laptev, I., and Sivic, J.

</span>
<span class="ltx_bibblock">Learning and transferring mid-level image representations using
convolutional neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  1717–1724, 2014.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peterson et al. (2019)</span>
<span class="ltx_bibblock">
Peterson, D., Kanani, P., and Marathe, V. J.

</span>
<span class="ltx_bibblock">Private federated learning with domain adaptation.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.06733</em>, 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shokri &amp; Shmatikov (2015)</span>
<span class="ltx_bibblock">
Shokri, R. and Shmatikov, V.

</span>
<span class="ltx_bibblock">Privacy-preserving deep learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGSAC conference on computer
and communications security</em>, pp.  1310–1321, 2015.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vanhaesebrouck et al. (2017)</span>
<span class="ltx_bibblock">
Vanhaesebrouck, P., Bellet, A., and Tommasi, M.

</span>
<span class="ltx_bibblock">Decentralized collaborative learning of personalized models over
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, pp.  509–517.
PMLR, 2017.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, K., Mathews, R., Kiddon, C., Eichner, H., Beaufays, F., and Ramage, D.

</span>
<span class="ltx_bibblock">Federated evaluation of on-device personalization.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.10252</em>, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, Z., Song, M., Zhang, Z., Song, Y., Wang, Q., and Qi, H.

</span>
<span class="ltx_bibblock">Beyond inferring class representatives: User-level privacy leakage
from federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2019 - IEEE Conference on Computer
Communications</em>, pp.  2512–2520, 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2017)</span>
<span class="ltx_bibblock">
Xiao, H., Rasul, K., and Vollgraf, R.

</span>
<span class="ltx_bibblock">Fashion-mnist: a novel image dataset for benchmarking machine
learning algorithms, 2017.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yurochkin et al. (2019)</span>
<span class="ltx_bibblock">
Yurochkin, M., Agarwal, M., Ghosh, S., Greenewald, K., Hoang, N., and Khazaeni,
Y.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 7252–7261. PMLR, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y., Li, M., Lai, L., Suda, N., Civin, D., and Chandra, V.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2010.02055" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2010.02056" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2010.02056">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2010.02056" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2010.02057" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 10:51:17 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
