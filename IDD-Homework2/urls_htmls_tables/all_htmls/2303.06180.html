<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.06180] Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels</title><meta property="og:description" content="Numerous large-scale chest x-ray datasets have spearheaded expert-level detection of abnormalities using deep learning. However, these datasets focus on detecting a subset of disease labels that could be present, thus …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.06180">

<!--Generated on Thu Feb 29 20:53:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Deep learning Federated learning Transfer learning Surgical aggregation Classification Chest x-ray">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>University of Maryland Medical Intelligent Imaging (UM2ii) Center, Baltimore, MD 
<br class="ltx_break"><span id="id1.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{pkulkarni,akanhere,pyi,vparekh}@som.umaryland.edu</span></span></span> </span></span></span><span id="id2" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Department of Biomedical Engineering, Johns Hopkins University, Baltimore, MD 
<br class="ltx_break"><span id="id2.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">email: </span>akanher1@jhu.edu</span></span></span></span></span></span>
<h1 class="ltx_title ltx_title_document">Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pranav Kulkarni 
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Adway Kanhere
</span><span class="ltx_author_notes">1122</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Paul H. Yi
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Vishwa S. Parekh
</span><span class="ltx_author_notes">11</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Numerous large-scale chest x-ray datasets have spearheaded expert-level detection of abnormalities using deep learning. However, these datasets focus on detecting a subset of disease labels that could be present, thus making them distributed and non-iid with partial labels. Recent literature has indicated the impact of batch normalization layers on the convergence of federated learning due to domain shift associated with non-iid data with partial labels. To that end, we propose FedFBN, a federated learning framework that draws inspiration from transfer learning by using pretrained networks as the model backend and freezing the batch normalization layers throughout the training process. We evaluate FedFBN with current FL strategies using synthetic iid toy datasets and large-scale non-iid datasets across scenarios with partial and complete labels. Our results demonstrate that FedFBN outperforms current aggregation strategies for training global models using distributed and non-iid data with partial labels.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Deep learning Federated learning Transfer learning Surgical aggregation Classification Chest x-ray
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) is a promising machine learning paradigm that allows the training of machine learning algorithms, such as deep neural networks, on multiple distributed datasets while preserving privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> The FL approach involves a central server that trains a global model by iteratively aggregating knowledge from local models that are trained on different datasets stored on separate nodes. Specifically, each node trains its local model on its dataset and communicates the model to the server, which intelligently aggregates the local models into a single global model for the next round of training. In the field of medical imaging, FL has enabled the training of large-scale deep learning models using homogeneous data from multiple institutions without sharing sensitive patient data. However, most medical imaging datasets are heterogeneous, acquired from different domains with partial and incomplete annotations. This poses a significant challenge for the FL approach, as the local models may differ significantly from each other, leading to suboptimal aggregation of knowledge and decreased accuracy of the global model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Batch normalization (BN) layers are a core element in most deep learning model architectures. By normalizing, recentering, and rescaling the layer inputs, BN ensures rapid and stable model convergence by learning a moving mean of the training data statistics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. However, recent literature has indicated that, due to domain shift, BN layers significantly impact the convergence of FedAvg, the de-facto strategy for weight aggregation in a FL setup <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. As a result of domain shift, there is a disconnect between the statistics learned by BN layers at each local model, and thus naïvely averaging these statistics has drastically reduced model accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Furthermore, FedAvg has shown to be affected by catastrophic forgetting during domain adaption tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To solve the problem of suboptimal aggregation from distributed datasets, FedBN has recently emerged as a popular technique <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Compared to other FL algorithms, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, FedBN has demonstrated success in creating a global model that can generalize well to non-iid data with domain shift. This is achieved by avoiding the aggregation of BN layers during communication rounds. FedBN has been shown to improve the performance of FL models on non-iid data and reduce the negative impact of data heterogeneity. However, FedBN is limited to training personalized local models rather than global models. Recent literature has demonstrated that, in the case of partial labels when participating datasets have either different of partially overlapping labels, FedBN converges to a suboptimal solution and exhibits poor performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. Meanwhile, in a non-federated setup, transfer learning (TL) has emerged as a popular technique to rapidly adapt pretrained networks to medical image classification tasks. While the overall effectiveness of TL on model performance is unclear <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> due to a significant domain shift from the source to target data in addition to feature duplication, other approaches have demonstrated the importance of fine-tuning BN layers to achieve greater model accuracy using TL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. To that end, we propose FedFBN, a federated learning framework that draws inspiration from FedBN and transfer learning by using pretrained networks as the model backend and freezing the batch normalization layers throughout the collaborative learning phase. We evaluated the FedFBN framework for aggregating knowledge from distributed iid and non-iid datasets with complete and partial labels and compared its performance to individual node baseline models, models trained on centrally aggregated data, and different FL aggregation strategies, including FedAvg and FedBN.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>FedFBN</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">The FedFBN algorithm is implementated as a modification of the FedBN algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Rather than avoiding the aggregation of the BN layer statistics, FedFBN keeps these statistics frozen i.e. avoids updating them in the training process. The FedFBN algorithm is described in detail in Algorithm <a href="#algorithm1" title="In 2.1 FedFBN ‣ 2 Methods ‣ Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.13" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.6.6" class="ltx_listingline">
<span id="algorithm1.6.6.1" class="ltx_text"><span id="algorithm1.6.6.1.1" class="ltx_text ltx_font_bold">Input:</span> </span><math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">K</annotation></semantics></math> clients indexed by <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">k</annotation></semantics></math>, model layer indexed by <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">l</annotation></semantics></math>, initialized model parameters <math id="algorithm1.4.4.m4.3" class="ltx_Math" alttext="w_{0,k}^{(i)}" display="inline"><semantics id="algorithm1.4.4.m4.3a"><msubsup id="algorithm1.4.4.m4.3.4" xref="algorithm1.4.4.m4.3.4.cmml"><mi id="algorithm1.4.4.m4.3.4.2.2" xref="algorithm1.4.4.m4.3.4.2.2.cmml">w</mi><mrow id="algorithm1.4.4.m4.2.2.2.4" xref="algorithm1.4.4.m4.2.2.2.3.cmml"><mn id="algorithm1.4.4.m4.1.1.1.1" xref="algorithm1.4.4.m4.1.1.1.1.cmml">0</mn><mo id="algorithm1.4.4.m4.2.2.2.4.1" xref="algorithm1.4.4.m4.2.2.2.3.cmml">,</mo><mi id="algorithm1.4.4.m4.2.2.2.2" xref="algorithm1.4.4.m4.2.2.2.2.cmml">k</mi></mrow><mrow id="algorithm1.4.4.m4.3.3.1.3" xref="algorithm1.4.4.m4.3.4.cmml"><mo stretchy="false" id="algorithm1.4.4.m4.3.3.1.3.1" xref="algorithm1.4.4.m4.3.4.cmml">(</mo><mi id="algorithm1.4.4.m4.3.3.1.1" xref="algorithm1.4.4.m4.3.3.1.1.cmml">i</mi><mo stretchy="false" id="algorithm1.4.4.m4.3.3.1.3.2" xref="algorithm1.4.4.m4.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.3b"><apply id="algorithm1.4.4.m4.3.4.cmml" xref="algorithm1.4.4.m4.3.4"><csymbol cd="ambiguous" id="algorithm1.4.4.m4.3.4.1.cmml" xref="algorithm1.4.4.m4.3.4">superscript</csymbol><apply id="algorithm1.4.4.m4.3.4.2.cmml" xref="algorithm1.4.4.m4.3.4"><csymbol cd="ambiguous" id="algorithm1.4.4.m4.3.4.2.1.cmml" xref="algorithm1.4.4.m4.3.4">subscript</csymbol><ci id="algorithm1.4.4.m4.3.4.2.2.cmml" xref="algorithm1.4.4.m4.3.4.2.2">𝑤</ci><list id="algorithm1.4.4.m4.2.2.2.3.cmml" xref="algorithm1.4.4.m4.2.2.2.4"><cn type="integer" id="algorithm1.4.4.m4.1.1.1.1.cmml" xref="algorithm1.4.4.m4.1.1.1.1">0</cn><ci id="algorithm1.4.4.m4.2.2.2.2.cmml" xref="algorithm1.4.4.m4.2.2.2.2">𝑘</ci></list></apply><ci id="algorithm1.4.4.m4.3.3.1.1.cmml" xref="algorithm1.4.4.m4.3.3.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.3c">w_{0,k}^{(i)}</annotation></semantics></math>, training epochs before aggregation <math id="algorithm1.5.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.5.5.m5.1a"><mi id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">E</annotation></semantics></math>, and total federated rounds <math id="algorithm1.6.6.m6.1" class="ltx_Math" alttext="N" display="inline"><semantics id="algorithm1.6.6.m6.1a"><mi id="algorithm1.6.6.m6.1.1" xref="algorithm1.6.6.m6.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m6.1b"><ci id="algorithm1.6.6.m6.1.1.cmml" xref="algorithm1.6.6.m6.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m6.1c">N</annotation></semantics></math>;
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span id="algorithm1.7.7.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.7.7.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.7.7.1.m1.4" class="ltx_Math" alttext="\text{each round}\ n=1,2,...,N" display="inline"><semantics id="algorithm1.7.7.1.m1.4a"><mrow id="algorithm1.7.7.1.m1.4.5" xref="algorithm1.7.7.1.m1.4.5.cmml"><mrow id="algorithm1.7.7.1.m1.4.5.2" xref="algorithm1.7.7.1.m1.4.5.2.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.7.7.1.m1.4.5.2.2" xref="algorithm1.7.7.1.m1.4.5.2.2a.cmml">each round</mtext><mo lspace="0.500em" rspace="0em" id="algorithm1.7.7.1.m1.4.5.2.1" xref="algorithm1.7.7.1.m1.4.5.2.1.cmml">​</mo><mi id="algorithm1.7.7.1.m1.4.5.2.3" xref="algorithm1.7.7.1.m1.4.5.2.3.cmml">n</mi></mrow><mo id="algorithm1.7.7.1.m1.4.5.1" xref="algorithm1.7.7.1.m1.4.5.1.cmml">=</mo><mrow id="algorithm1.7.7.1.m1.4.5.3.2" xref="algorithm1.7.7.1.m1.4.5.3.1.cmml"><mn id="algorithm1.7.7.1.m1.1.1" xref="algorithm1.7.7.1.m1.1.1.cmml">1</mn><mo id="algorithm1.7.7.1.m1.4.5.3.2.1" xref="algorithm1.7.7.1.m1.4.5.3.1.cmml">,</mo><mn id="algorithm1.7.7.1.m1.2.2" xref="algorithm1.7.7.1.m1.2.2.cmml">2</mn><mo id="algorithm1.7.7.1.m1.4.5.3.2.2" xref="algorithm1.7.7.1.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.7.7.1.m1.3.3" xref="algorithm1.7.7.1.m1.3.3.cmml">…</mi><mo id="algorithm1.7.7.1.m1.4.5.3.2.3" xref="algorithm1.7.7.1.m1.4.5.3.1.cmml">,</mo><mi id="algorithm1.7.7.1.m1.4.4" xref="algorithm1.7.7.1.m1.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.1.m1.4b"><apply id="algorithm1.7.7.1.m1.4.5.cmml" xref="algorithm1.7.7.1.m1.4.5"><eq id="algorithm1.7.7.1.m1.4.5.1.cmml" xref="algorithm1.7.7.1.m1.4.5.1"></eq><apply id="algorithm1.7.7.1.m1.4.5.2.cmml" xref="algorithm1.7.7.1.m1.4.5.2"><times id="algorithm1.7.7.1.m1.4.5.2.1.cmml" xref="algorithm1.7.7.1.m1.4.5.2.1"></times><ci id="algorithm1.7.7.1.m1.4.5.2.2a.cmml" xref="algorithm1.7.7.1.m1.4.5.2.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.7.7.1.m1.4.5.2.2.cmml" xref="algorithm1.7.7.1.m1.4.5.2.2">each round</mtext></ci><ci id="algorithm1.7.7.1.m1.4.5.2.3.cmml" xref="algorithm1.7.7.1.m1.4.5.2.3">𝑛</ci></apply><list id="algorithm1.7.7.1.m1.4.5.3.1.cmml" xref="algorithm1.7.7.1.m1.4.5.3.2"><cn type="integer" id="algorithm1.7.7.1.m1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1">1</cn><cn type="integer" id="algorithm1.7.7.1.m1.2.2.cmml" xref="algorithm1.7.7.1.m1.2.2">2</cn><ci id="algorithm1.7.7.1.m1.3.3.cmml" xref="algorithm1.7.7.1.m1.3.3">…</ci><ci id="algorithm1.7.7.1.m1.4.4.cmml" xref="algorithm1.7.7.1.m1.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.1.m1.4c">\text{each round}\ n=1,2,...,N</annotation></semantics></math></em> <span id="algorithm1.7.7.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.8.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.8.8.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.8.8.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.8.8.1.m1.1" class="ltx_Math" alttext="\text{each client}\ k\ \text{and each layer}\ l" display="inline"><semantics id="algorithm1.8.8.1.m1.1a"><mrow id="algorithm1.8.8.1.m1.1.1" xref="algorithm1.8.8.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.8.8.1.m1.1.1.2" xref="algorithm1.8.8.1.m1.1.1.2a.cmml">each client</mtext><mo lspace="0.500em" rspace="0em" id="algorithm1.8.8.1.m1.1.1.1" xref="algorithm1.8.8.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.8.8.1.m1.1.1.3" xref="algorithm1.8.8.1.m1.1.1.3.cmml">k</mi><mo lspace="0.500em" rspace="0em" id="algorithm1.8.8.1.m1.1.1.1a" xref="algorithm1.8.8.1.m1.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_italic" id="algorithm1.8.8.1.m1.1.1.4" xref="algorithm1.8.8.1.m1.1.1.4a.cmml">and each layer</mtext><mo lspace="0.500em" rspace="0em" id="algorithm1.8.8.1.m1.1.1.1b" xref="algorithm1.8.8.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.8.8.1.m1.1.1.5" xref="algorithm1.8.8.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.1.m1.1b"><apply id="algorithm1.8.8.1.m1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1"><times id="algorithm1.8.8.1.m1.1.1.1.cmml" xref="algorithm1.8.8.1.m1.1.1.1"></times><ci id="algorithm1.8.8.1.m1.1.1.2a.cmml" xref="algorithm1.8.8.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.8.8.1.m1.1.1.2.cmml" xref="algorithm1.8.8.1.m1.1.1.2">each client</mtext></ci><ci id="algorithm1.8.8.1.m1.1.1.3.cmml" xref="algorithm1.8.8.1.m1.1.1.3">𝑘</ci><ci id="algorithm1.8.8.1.m1.1.1.4a.cmml" xref="algorithm1.8.8.1.m1.1.1.4"><mtext class="ltx_mathvariant_italic" id="algorithm1.8.8.1.m1.1.1.4.cmml" xref="algorithm1.8.8.1.m1.1.1.4">and each layer</mtext></ci><ci id="algorithm1.8.8.1.m1.1.1.5.cmml" xref="algorithm1.8.8.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.1.m1.1c">\text{each client}\ k\ \text{and each layer}\ l</annotation></semantics></math></em> <span id="algorithm1.8.8.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.9.9.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.9.9.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.9.9.1.m1.1" class="ltx_Math" alttext="\text{layer}\ l\ \text{is not BatchNorm}" display="inline"><semantics id="algorithm1.9.9.1.m1.1a"><mrow id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.9.9.1.m1.1.1.2" xref="algorithm1.9.9.1.m1.1.1.2a.cmml">layer</mtext><mo lspace="0.500em" rspace="0em" id="algorithm1.9.9.1.m1.1.1.1" xref="algorithm1.9.9.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.9.9.1.m1.1.1.3" xref="algorithm1.9.9.1.m1.1.1.3.cmml">l</mi><mo lspace="0.500em" rspace="0em" id="algorithm1.9.9.1.m1.1.1.1a" xref="algorithm1.9.9.1.m1.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_italic" id="algorithm1.9.9.1.m1.1.1.4" xref="algorithm1.9.9.1.m1.1.1.4a.cmml">is not BatchNorm</mtext></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.1b"><apply id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1"><times id="algorithm1.9.9.1.m1.1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1.1"></times><ci id="algorithm1.9.9.1.m1.1.1.2a.cmml" xref="algorithm1.9.9.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.9.9.1.m1.1.1.2.cmml" xref="algorithm1.9.9.1.m1.1.1.2">layer</mtext></ci><ci id="algorithm1.9.9.1.m1.1.1.3.cmml" xref="algorithm1.9.9.1.m1.1.1.3">𝑙</ci><ci id="algorithm1.9.9.1.m1.1.1.4a.cmml" xref="algorithm1.9.9.1.m1.1.1.4"><mtext class="ltx_mathvariant_italic" id="algorithm1.9.9.1.m1.1.1.4.cmml" xref="algorithm1.9.9.1.m1.1.1.4">is not BatchNorm</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.1c">\text{layer}\ l\ \text{is not BatchNorm}</annotation></semantics></math></em> <span id="algorithm1.9.9.3" class="ltx_text ltx_font_bold">then</span> 
</div>
<div id="algorithm1.10.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.10.10.m1.7" class="ltx_Math" alttext="w_{n,k}^{(l)}\leftarrow SGD(w_{n-1,k}^{(l)})" display="inline"><semantics id="algorithm1.10.10.m1.7a"><mrow id="algorithm1.10.10.m1.7.7" xref="algorithm1.10.10.m1.7.7.cmml"><msubsup id="algorithm1.10.10.m1.7.7.3" xref="algorithm1.10.10.m1.7.7.3.cmml"><mi id="algorithm1.10.10.m1.7.7.3.2.2" xref="algorithm1.10.10.m1.7.7.3.2.2.cmml">w</mi><mrow id="algorithm1.10.10.m1.2.2.2.4" xref="algorithm1.10.10.m1.2.2.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.cmml">n</mi><mo id="algorithm1.10.10.m1.2.2.2.4.1" xref="algorithm1.10.10.m1.2.2.2.3.cmml">,</mo><mi id="algorithm1.10.10.m1.2.2.2.2" xref="algorithm1.10.10.m1.2.2.2.2.cmml">k</mi></mrow><mrow id="algorithm1.10.10.m1.3.3.1.3" xref="algorithm1.10.10.m1.7.7.3.cmml"><mo stretchy="false" id="algorithm1.10.10.m1.3.3.1.3.1" xref="algorithm1.10.10.m1.7.7.3.cmml">(</mo><mi id="algorithm1.10.10.m1.3.3.1.1" xref="algorithm1.10.10.m1.3.3.1.1.cmml">l</mi><mo stretchy="false" id="algorithm1.10.10.m1.3.3.1.3.2" xref="algorithm1.10.10.m1.7.7.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="algorithm1.10.10.m1.7.7.2" xref="algorithm1.10.10.m1.7.7.2.cmml">←</mo><mrow id="algorithm1.10.10.m1.7.7.1" xref="algorithm1.10.10.m1.7.7.1.cmml"><mi id="algorithm1.10.10.m1.7.7.1.3" xref="algorithm1.10.10.m1.7.7.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.7.7.1.2" xref="algorithm1.10.10.m1.7.7.1.2.cmml">​</mo><mi id="algorithm1.10.10.m1.7.7.1.4" xref="algorithm1.10.10.m1.7.7.1.4.cmml">G</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.7.7.1.2a" xref="algorithm1.10.10.m1.7.7.1.2.cmml">​</mo><mi id="algorithm1.10.10.m1.7.7.1.5" xref="algorithm1.10.10.m1.7.7.1.5.cmml">D</mi><mo lspace="0em" rspace="0em" id="algorithm1.10.10.m1.7.7.1.2b" xref="algorithm1.10.10.m1.7.7.1.2.cmml">​</mo><mrow id="algorithm1.10.10.m1.7.7.1.1.1" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.10.10.m1.7.7.1.1.1.2" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml">(</mo><msubsup id="algorithm1.10.10.m1.7.7.1.1.1.1" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml"><mi id="algorithm1.10.10.m1.7.7.1.1.1.1.2.2" xref="algorithm1.10.10.m1.7.7.1.1.1.1.2.2.cmml">w</mi><mrow id="algorithm1.10.10.m1.5.5.2.2" xref="algorithm1.10.10.m1.5.5.2.3.cmml"><mrow id="algorithm1.10.10.m1.5.5.2.2.1" xref="algorithm1.10.10.m1.5.5.2.2.1.cmml"><mi id="algorithm1.10.10.m1.5.5.2.2.1.2" xref="algorithm1.10.10.m1.5.5.2.2.1.2.cmml">n</mi><mo id="algorithm1.10.10.m1.5.5.2.2.1.1" xref="algorithm1.10.10.m1.5.5.2.2.1.1.cmml">−</mo><mn id="algorithm1.10.10.m1.5.5.2.2.1.3" xref="algorithm1.10.10.m1.5.5.2.2.1.3.cmml">1</mn></mrow><mo id="algorithm1.10.10.m1.5.5.2.2.2" xref="algorithm1.10.10.m1.5.5.2.3.cmml">,</mo><mi id="algorithm1.10.10.m1.4.4.1.1" xref="algorithm1.10.10.m1.4.4.1.1.cmml">k</mi></mrow><mrow id="algorithm1.10.10.m1.6.6.1.3" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.10.10.m1.6.6.1.3.1" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml">(</mo><mi id="algorithm1.10.10.m1.6.6.1.1" xref="algorithm1.10.10.m1.6.6.1.1.cmml">l</mi><mo stretchy="false" id="algorithm1.10.10.m1.6.6.1.3.2" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="algorithm1.10.10.m1.7.7.1.1.1.3" xref="algorithm1.10.10.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.7b"><apply id="algorithm1.10.10.m1.7.7.cmml" xref="algorithm1.10.10.m1.7.7"><ci id="algorithm1.10.10.m1.7.7.2.cmml" xref="algorithm1.10.10.m1.7.7.2">←</ci><apply id="algorithm1.10.10.m1.7.7.3.cmml" xref="algorithm1.10.10.m1.7.7.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.7.7.3.1.cmml" xref="algorithm1.10.10.m1.7.7.3">superscript</csymbol><apply id="algorithm1.10.10.m1.7.7.3.2.cmml" xref="algorithm1.10.10.m1.7.7.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.7.7.3.2.1.cmml" xref="algorithm1.10.10.m1.7.7.3">subscript</csymbol><ci id="algorithm1.10.10.m1.7.7.3.2.2.cmml" xref="algorithm1.10.10.m1.7.7.3.2.2">𝑤</ci><list id="algorithm1.10.10.m1.2.2.2.3.cmml" xref="algorithm1.10.10.m1.2.2.2.4"><ci id="algorithm1.10.10.m1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1">𝑛</ci><ci id="algorithm1.10.10.m1.2.2.2.2.cmml" xref="algorithm1.10.10.m1.2.2.2.2">𝑘</ci></list></apply><ci id="algorithm1.10.10.m1.3.3.1.1.cmml" xref="algorithm1.10.10.m1.3.3.1.1">𝑙</ci></apply><apply id="algorithm1.10.10.m1.7.7.1.cmml" xref="algorithm1.10.10.m1.7.7.1"><times id="algorithm1.10.10.m1.7.7.1.2.cmml" xref="algorithm1.10.10.m1.7.7.1.2"></times><ci id="algorithm1.10.10.m1.7.7.1.3.cmml" xref="algorithm1.10.10.m1.7.7.1.3">𝑆</ci><ci id="algorithm1.10.10.m1.7.7.1.4.cmml" xref="algorithm1.10.10.m1.7.7.1.4">𝐺</ci><ci id="algorithm1.10.10.m1.7.7.1.5.cmml" xref="algorithm1.10.10.m1.7.7.1.5">𝐷</ci><apply id="algorithm1.10.10.m1.7.7.1.1.1.1.cmml" xref="algorithm1.10.10.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.7.7.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.7.7.1.1.1">superscript</csymbol><apply id="algorithm1.10.10.m1.7.7.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.7.7.1.1.1.1.2.1.cmml" xref="algorithm1.10.10.m1.7.7.1.1.1">subscript</csymbol><ci id="algorithm1.10.10.m1.7.7.1.1.1.1.2.2.cmml" xref="algorithm1.10.10.m1.7.7.1.1.1.1.2.2">𝑤</ci><list id="algorithm1.10.10.m1.5.5.2.3.cmml" xref="algorithm1.10.10.m1.5.5.2.2"><apply id="algorithm1.10.10.m1.5.5.2.2.1.cmml" xref="algorithm1.10.10.m1.5.5.2.2.1"><minus id="algorithm1.10.10.m1.5.5.2.2.1.1.cmml" xref="algorithm1.10.10.m1.5.5.2.2.1.1"></minus><ci id="algorithm1.10.10.m1.5.5.2.2.1.2.cmml" xref="algorithm1.10.10.m1.5.5.2.2.1.2">𝑛</ci><cn type="integer" id="algorithm1.10.10.m1.5.5.2.2.1.3.cmml" xref="algorithm1.10.10.m1.5.5.2.2.1.3">1</cn></apply><ci id="algorithm1.10.10.m1.4.4.1.1.cmml" xref="algorithm1.10.10.m1.4.4.1.1">𝑘</ci></list></apply><ci id="algorithm1.10.10.m1.6.6.1.1.cmml" xref="algorithm1.10.10.m1.6.6.1.1">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.7c">w_{n,k}^{(l)}\leftarrow SGD(w_{n-1,k}^{(l)})</annotation></semantics></math>

</div>
<div id="algorithm1.13.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="algorithm1.13.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.13.16" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.11.11.2" class="ltx_text ltx_font_bold">if</span> <em id="algorithm1.11.11.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.11.11.1.m1.2" class="ltx_Math" alttext="\text{mod}(t,E)=0" display="inline"><semantics id="algorithm1.11.11.1.m1.2a"><mrow id="algorithm1.11.11.1.m1.2.3" xref="algorithm1.11.11.1.m1.2.3.cmml"><mrow id="algorithm1.11.11.1.m1.2.3.2" xref="algorithm1.11.11.1.m1.2.3.2.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.11.11.1.m1.2.3.2.2" xref="algorithm1.11.11.1.m1.2.3.2.2a.cmml">mod</mtext><mo lspace="0em" rspace="0em" id="algorithm1.11.11.1.m1.2.3.2.1" xref="algorithm1.11.11.1.m1.2.3.2.1.cmml">​</mo><mrow id="algorithm1.11.11.1.m1.2.3.2.3.2" xref="algorithm1.11.11.1.m1.2.3.2.3.1.cmml"><mo stretchy="false" id="algorithm1.11.11.1.m1.2.3.2.3.2.1" xref="algorithm1.11.11.1.m1.2.3.2.3.1.cmml">(</mo><mi id="algorithm1.11.11.1.m1.1.1" xref="algorithm1.11.11.1.m1.1.1.cmml">t</mi><mo id="algorithm1.11.11.1.m1.2.3.2.3.2.2" xref="algorithm1.11.11.1.m1.2.3.2.3.1.cmml">,</mo><mi id="algorithm1.11.11.1.m1.2.2" xref="algorithm1.11.11.1.m1.2.2.cmml">E</mi><mo stretchy="false" id="algorithm1.11.11.1.m1.2.3.2.3.2.3" xref="algorithm1.11.11.1.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.11.11.1.m1.2.3.1" xref="algorithm1.11.11.1.m1.2.3.1.cmml">=</mo><mn id="algorithm1.11.11.1.m1.2.3.3" xref="algorithm1.11.11.1.m1.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.1.m1.2b"><apply id="algorithm1.11.11.1.m1.2.3.cmml" xref="algorithm1.11.11.1.m1.2.3"><eq id="algorithm1.11.11.1.m1.2.3.1.cmml" xref="algorithm1.11.11.1.m1.2.3.1"></eq><apply id="algorithm1.11.11.1.m1.2.3.2.cmml" xref="algorithm1.11.11.1.m1.2.3.2"><times id="algorithm1.11.11.1.m1.2.3.2.1.cmml" xref="algorithm1.11.11.1.m1.2.3.2.1"></times><ci id="algorithm1.11.11.1.m1.2.3.2.2a.cmml" xref="algorithm1.11.11.1.m1.2.3.2.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.11.11.1.m1.2.3.2.2.cmml" xref="algorithm1.11.11.1.m1.2.3.2.2">mod</mtext></ci><interval closure="open" id="algorithm1.11.11.1.m1.2.3.2.3.1.cmml" xref="algorithm1.11.11.1.m1.2.3.2.3.2"><ci id="algorithm1.11.11.1.m1.1.1.cmml" xref="algorithm1.11.11.1.m1.1.1">𝑡</ci><ci id="algorithm1.11.11.1.m1.2.2.cmml" xref="algorithm1.11.11.1.m1.2.2">𝐸</ci></interval></apply><cn type="integer" id="algorithm1.11.11.1.m1.2.3.3.cmml" xref="algorithm1.11.11.1.m1.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.1.m1.2c">\text{mod}(t,E)=0</annotation></semantics></math></em> <span id="algorithm1.11.11.3" class="ltx_text ltx_font_bold">then</span> 
</div>
<div id="algorithm1.12.12" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.12.12.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.12.12.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.12.12.1.m1.1" class="ltx_Math" alttext="\text{each client}\ k\ \text{and each layer}\ l" display="inline"><semantics id="algorithm1.12.12.1.m1.1a"><mrow id="algorithm1.12.12.1.m1.1.1" xref="algorithm1.12.12.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.12.12.1.m1.1.1.2" xref="algorithm1.12.12.1.m1.1.1.2a.cmml">each client</mtext><mo lspace="0.500em" rspace="0em" id="algorithm1.12.12.1.m1.1.1.1" xref="algorithm1.12.12.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.12.12.1.m1.1.1.3" xref="algorithm1.12.12.1.m1.1.1.3.cmml">k</mi><mo lspace="0.500em" rspace="0em" id="algorithm1.12.12.1.m1.1.1.1a" xref="algorithm1.12.12.1.m1.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_italic" id="algorithm1.12.12.1.m1.1.1.4" xref="algorithm1.12.12.1.m1.1.1.4a.cmml">and each layer</mtext><mo lspace="0.500em" rspace="0em" id="algorithm1.12.12.1.m1.1.1.1b" xref="algorithm1.12.12.1.m1.1.1.1.cmml">​</mo><mi id="algorithm1.12.12.1.m1.1.1.5" xref="algorithm1.12.12.1.m1.1.1.5.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.1.m1.1b"><apply id="algorithm1.12.12.1.m1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1"><times id="algorithm1.12.12.1.m1.1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1.1"></times><ci id="algorithm1.12.12.1.m1.1.1.2a.cmml" xref="algorithm1.12.12.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.12.12.1.m1.1.1.2.cmml" xref="algorithm1.12.12.1.m1.1.1.2">each client</mtext></ci><ci id="algorithm1.12.12.1.m1.1.1.3.cmml" xref="algorithm1.12.12.1.m1.1.1.3">𝑘</ci><ci id="algorithm1.12.12.1.m1.1.1.4a.cmml" xref="algorithm1.12.12.1.m1.1.1.4"><mtext class="ltx_mathvariant_italic" id="algorithm1.12.12.1.m1.1.1.4.cmml" xref="algorithm1.12.12.1.m1.1.1.4">and each layer</mtext></ci><ci id="algorithm1.12.12.1.m1.1.1.5.cmml" xref="algorithm1.12.12.1.m1.1.1.5">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.1.m1.1c">\text{each client}\ k\ \text{and each layer}\ l</annotation></semantics></math></em> <span id="algorithm1.12.12.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.13.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.13.13.m1.6" class="ltx_Math" alttext="w_{n,k}^{(l)}\leftarrow\frac{1}{K}\sum_{i=1}^{K}w_{n,i}^{(l)}" display="inline"><semantics id="algorithm1.13.13.m1.6a"><mrow id="algorithm1.13.13.m1.6.7" xref="algorithm1.13.13.m1.6.7.cmml"><msubsup id="algorithm1.13.13.m1.6.7.2" xref="algorithm1.13.13.m1.6.7.2.cmml"><mi id="algorithm1.13.13.m1.6.7.2.2.2" xref="algorithm1.13.13.m1.6.7.2.2.2.cmml">w</mi><mrow id="algorithm1.13.13.m1.2.2.2.4" xref="algorithm1.13.13.m1.2.2.2.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml">n</mi><mo id="algorithm1.13.13.m1.2.2.2.4.1" xref="algorithm1.13.13.m1.2.2.2.3.cmml">,</mo><mi id="algorithm1.13.13.m1.2.2.2.2" xref="algorithm1.13.13.m1.2.2.2.2.cmml">k</mi></mrow><mrow id="algorithm1.13.13.m1.3.3.1.3" xref="algorithm1.13.13.m1.6.7.2.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.3.3.1.3.1" xref="algorithm1.13.13.m1.6.7.2.cmml">(</mo><mi id="algorithm1.13.13.m1.3.3.1.1" xref="algorithm1.13.13.m1.3.3.1.1.cmml">l</mi><mo stretchy="false" id="algorithm1.13.13.m1.3.3.1.3.2" xref="algorithm1.13.13.m1.6.7.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="algorithm1.13.13.m1.6.7.1" xref="algorithm1.13.13.m1.6.7.1.cmml">←</mo><mrow id="algorithm1.13.13.m1.6.7.3" xref="algorithm1.13.13.m1.6.7.3.cmml"><mfrac id="algorithm1.13.13.m1.6.7.3.2" xref="algorithm1.13.13.m1.6.7.3.2.cmml"><mn id="algorithm1.13.13.m1.6.7.3.2.2" xref="algorithm1.13.13.m1.6.7.3.2.2.cmml">1</mn><mi id="algorithm1.13.13.m1.6.7.3.2.3" xref="algorithm1.13.13.m1.6.7.3.2.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.13.13.m1.6.7.3.1" xref="algorithm1.13.13.m1.6.7.3.1.cmml">​</mo><mrow id="algorithm1.13.13.m1.6.7.3.3" xref="algorithm1.13.13.m1.6.7.3.3.cmml"><msubsup id="algorithm1.13.13.m1.6.7.3.3.1" xref="algorithm1.13.13.m1.6.7.3.3.1.cmml"><mo id="algorithm1.13.13.m1.6.7.3.3.1.2.2" xref="algorithm1.13.13.m1.6.7.3.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.13.13.m1.6.7.3.3.1.2.3" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.cmml"><mi id="algorithm1.13.13.m1.6.7.3.3.1.2.3.2" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.2.cmml">i</mi><mo id="algorithm1.13.13.m1.6.7.3.3.1.2.3.1" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.1.cmml">=</mo><mn id="algorithm1.13.13.m1.6.7.3.3.1.2.3.3" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="algorithm1.13.13.m1.6.7.3.3.1.3" xref="algorithm1.13.13.m1.6.7.3.3.1.3.cmml">K</mi></msubsup><msubsup id="algorithm1.13.13.m1.6.7.3.3.2" xref="algorithm1.13.13.m1.6.7.3.3.2.cmml"><mi id="algorithm1.13.13.m1.6.7.3.3.2.2.2" xref="algorithm1.13.13.m1.6.7.3.3.2.2.2.cmml">w</mi><mrow id="algorithm1.13.13.m1.5.5.2.4" xref="algorithm1.13.13.m1.5.5.2.3.cmml"><mi id="algorithm1.13.13.m1.4.4.1.1" xref="algorithm1.13.13.m1.4.4.1.1.cmml">n</mi><mo id="algorithm1.13.13.m1.5.5.2.4.1" xref="algorithm1.13.13.m1.5.5.2.3.cmml">,</mo><mi id="algorithm1.13.13.m1.5.5.2.2" xref="algorithm1.13.13.m1.5.5.2.2.cmml">i</mi></mrow><mrow id="algorithm1.13.13.m1.6.6.1.3" xref="algorithm1.13.13.m1.6.7.3.3.2.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.6.6.1.3.1" xref="algorithm1.13.13.m1.6.7.3.3.2.cmml">(</mo><mi id="algorithm1.13.13.m1.6.6.1.1" xref="algorithm1.13.13.m1.6.6.1.1.cmml">l</mi><mo stretchy="false" id="algorithm1.13.13.m1.6.6.1.3.2" xref="algorithm1.13.13.m1.6.7.3.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.6b"><apply id="algorithm1.13.13.m1.6.7.cmml" xref="algorithm1.13.13.m1.6.7"><ci id="algorithm1.13.13.m1.6.7.1.cmml" xref="algorithm1.13.13.m1.6.7.1">←</ci><apply id="algorithm1.13.13.m1.6.7.2.cmml" xref="algorithm1.13.13.m1.6.7.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.6.7.2.1.cmml" xref="algorithm1.13.13.m1.6.7.2">superscript</csymbol><apply id="algorithm1.13.13.m1.6.7.2.2.cmml" xref="algorithm1.13.13.m1.6.7.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.6.7.2.2.1.cmml" xref="algorithm1.13.13.m1.6.7.2">subscript</csymbol><ci id="algorithm1.13.13.m1.6.7.2.2.2.cmml" xref="algorithm1.13.13.m1.6.7.2.2.2">𝑤</ci><list id="algorithm1.13.13.m1.2.2.2.3.cmml" xref="algorithm1.13.13.m1.2.2.2.4"><ci id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1">𝑛</ci><ci id="algorithm1.13.13.m1.2.2.2.2.cmml" xref="algorithm1.13.13.m1.2.2.2.2">𝑘</ci></list></apply><ci id="algorithm1.13.13.m1.3.3.1.1.cmml" xref="algorithm1.13.13.m1.3.3.1.1">𝑙</ci></apply><apply id="algorithm1.13.13.m1.6.7.3.cmml" xref="algorithm1.13.13.m1.6.7.3"><times id="algorithm1.13.13.m1.6.7.3.1.cmml" xref="algorithm1.13.13.m1.6.7.3.1"></times><apply id="algorithm1.13.13.m1.6.7.3.2.cmml" xref="algorithm1.13.13.m1.6.7.3.2"><divide id="algorithm1.13.13.m1.6.7.3.2.1.cmml" xref="algorithm1.13.13.m1.6.7.3.2"></divide><cn type="integer" id="algorithm1.13.13.m1.6.7.3.2.2.cmml" xref="algorithm1.13.13.m1.6.7.3.2.2">1</cn><ci id="algorithm1.13.13.m1.6.7.3.2.3.cmml" xref="algorithm1.13.13.m1.6.7.3.2.3">𝐾</ci></apply><apply id="algorithm1.13.13.m1.6.7.3.3.cmml" xref="algorithm1.13.13.m1.6.7.3.3"><apply id="algorithm1.13.13.m1.6.7.3.3.1.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.6.7.3.3.1.1.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1">superscript</csymbol><apply id="algorithm1.13.13.m1.6.7.3.3.1.2.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.6.7.3.3.1.2.1.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1">subscript</csymbol><sum id="algorithm1.13.13.m1.6.7.3.3.1.2.2.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1.2.2"></sum><apply id="algorithm1.13.13.m1.6.7.3.3.1.2.3.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3"><eq id="algorithm1.13.13.m1.6.7.3.3.1.2.3.1.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.1"></eq><ci id="algorithm1.13.13.m1.6.7.3.3.1.2.3.2.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="algorithm1.13.13.m1.6.7.3.3.1.2.3.3.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1.2.3.3">1</cn></apply></apply><ci id="algorithm1.13.13.m1.6.7.3.3.1.3.cmml" xref="algorithm1.13.13.m1.6.7.3.3.1.3">𝐾</ci></apply><apply id="algorithm1.13.13.m1.6.7.3.3.2.cmml" xref="algorithm1.13.13.m1.6.7.3.3.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.6.7.3.3.2.1.cmml" xref="algorithm1.13.13.m1.6.7.3.3.2">superscript</csymbol><apply id="algorithm1.13.13.m1.6.7.3.3.2.2.cmml" xref="algorithm1.13.13.m1.6.7.3.3.2"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.6.7.3.3.2.2.1.cmml" xref="algorithm1.13.13.m1.6.7.3.3.2">subscript</csymbol><ci id="algorithm1.13.13.m1.6.7.3.3.2.2.2.cmml" xref="algorithm1.13.13.m1.6.7.3.3.2.2.2">𝑤</ci><list id="algorithm1.13.13.m1.5.5.2.3.cmml" xref="algorithm1.13.13.m1.5.5.2.4"><ci id="algorithm1.13.13.m1.4.4.1.1.cmml" xref="algorithm1.13.13.m1.4.4.1.1">𝑛</ci><ci id="algorithm1.13.13.m1.5.5.2.2.cmml" xref="algorithm1.13.13.m1.5.5.2.2">𝑖</ci></list></apply><ci id="algorithm1.13.13.m1.6.6.1.1.cmml" xref="algorithm1.13.13.m1.6.6.1.1">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.6c">w_{n,k}^{(l)}\leftarrow\frac{1}{K}\sum_{i=1}^{K}w_{n,i}^{(l)}</annotation></semantics></math>

</div>
<div id="algorithm1.13.17" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.13.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.13.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end if
</div>
<div id="algorithm1.13.20" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.13.21" class="ltx_listingline"> end for
</div>
<div id="algorithm1.13.22" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.15.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>FedFBN</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Datasets</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.10" class="ltx_p"><span id="S2.SS2.p1.10.1" class="ltx_text ltx_font_bold">NIH Chest X-Ray 14:</span>
The NIH dataset, curated by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, consists of 14 disease labels with <math id="S2.SS2.p1.1.m1.2" class="ltx_Math" alttext="N=112,120" display="inline"><semantics id="S2.SS2.p1.1.m1.2a"><mrow id="S2.SS2.p1.1.m1.2.3" xref="S2.SS2.p1.1.m1.2.3.cmml"><mi id="S2.SS2.p1.1.m1.2.3.2" xref="S2.SS2.p1.1.m1.2.3.2.cmml">N</mi><mo id="S2.SS2.p1.1.m1.2.3.1" xref="S2.SS2.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.1.m1.2.3.3.2" xref="S2.SS2.p1.1.m1.2.3.3.1.cmml"><mn id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">112</mn><mo id="S2.SS2.p1.1.m1.2.3.3.2.1" xref="S2.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.1.m1.2.2" xref="S2.SS2.p1.1.m1.2.2.cmml">120</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.2b"><apply id="S2.SS2.p1.1.m1.2.3.cmml" xref="S2.SS2.p1.1.m1.2.3"><eq id="S2.SS2.p1.1.m1.2.3.1.cmml" xref="S2.SS2.p1.1.m1.2.3.1"></eq><ci id="S2.SS2.p1.1.m1.2.3.2.cmml" xref="S2.SS2.p1.1.m1.2.3.2">𝑁</ci><list id="S2.SS2.p1.1.m1.2.3.3.1.cmml" xref="S2.SS2.p1.1.m1.2.3.3.2"><cn type="integer" id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">112</cn><cn type="integer" id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2">120</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.2c">N=112,120</annotation></semantics></math> frontal-view CXRs from <math id="S2.SS2.p1.2.m2.2" class="ltx_Math" alttext="M=30,805" display="inline"><semantics id="S2.SS2.p1.2.m2.2a"><mrow id="S2.SS2.p1.2.m2.2.3" xref="S2.SS2.p1.2.m2.2.3.cmml"><mi id="S2.SS2.p1.2.m2.2.3.2" xref="S2.SS2.p1.2.m2.2.3.2.cmml">M</mi><mo id="S2.SS2.p1.2.m2.2.3.1" xref="S2.SS2.p1.2.m2.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.2.m2.2.3.3.2" xref="S2.SS2.p1.2.m2.2.3.3.1.cmml"><mn id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">30</mn><mo id="S2.SS2.p1.2.m2.2.3.3.2.1" xref="S2.SS2.p1.2.m2.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.2.m2.2.2" xref="S2.SS2.p1.2.m2.2.2.cmml">805</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.2b"><apply id="S2.SS2.p1.2.m2.2.3.cmml" xref="S2.SS2.p1.2.m2.2.3"><eq id="S2.SS2.p1.2.m2.2.3.1.cmml" xref="S2.SS2.p1.2.m2.2.3.1"></eq><ci id="S2.SS2.p1.2.m2.2.3.2.cmml" xref="S2.SS2.p1.2.m2.2.3.2">𝑀</ci><list id="S2.SS2.p1.2.m2.2.3.3.1.cmml" xref="S2.SS2.p1.2.m2.2.3.3.2"><cn type="integer" id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">30</cn><cn type="integer" id="S2.SS2.p1.2.m2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2">805</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.2c">M=30,805</annotation></semantics></math> patients. We randomly divided the dataset into training (70%, <math id="S2.SS2.p1.3.m3.2" class="ltx_Math" alttext="N=78,571" display="inline"><semantics id="S2.SS2.p1.3.m3.2a"><mrow id="S2.SS2.p1.3.m3.2.3" xref="S2.SS2.p1.3.m3.2.3.cmml"><mi id="S2.SS2.p1.3.m3.2.3.2" xref="S2.SS2.p1.3.m3.2.3.2.cmml">N</mi><mo id="S2.SS2.p1.3.m3.2.3.1" xref="S2.SS2.p1.3.m3.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.3.m3.2.3.3.2" xref="S2.SS2.p1.3.m3.2.3.3.1.cmml"><mn id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml">78</mn><mo id="S2.SS2.p1.3.m3.2.3.3.2.1" xref="S2.SS2.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.3.m3.2.2" xref="S2.SS2.p1.3.m3.2.2.cmml">571</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.2b"><apply id="S2.SS2.p1.3.m3.2.3.cmml" xref="S2.SS2.p1.3.m3.2.3"><eq id="S2.SS2.p1.3.m3.2.3.1.cmml" xref="S2.SS2.p1.3.m3.2.3.1"></eq><ci id="S2.SS2.p1.3.m3.2.3.2.cmml" xref="S2.SS2.p1.3.m3.2.3.2">𝑁</ci><list id="S2.SS2.p1.3.m3.2.3.3.1.cmml" xref="S2.SS2.p1.3.m3.2.3.3.2"><cn type="integer" id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">78</cn><cn type="integer" id="S2.SS2.p1.3.m3.2.2.cmml" xref="S2.SS2.p1.3.m3.2.2">571</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.2c">N=78,571</annotation></semantics></math>, <math id="S2.SS2.p1.4.m4.2" class="ltx_Math" alttext="M=21,563" display="inline"><semantics id="S2.SS2.p1.4.m4.2a"><mrow id="S2.SS2.p1.4.m4.2.3" xref="S2.SS2.p1.4.m4.2.3.cmml"><mi id="S2.SS2.p1.4.m4.2.3.2" xref="S2.SS2.p1.4.m4.2.3.2.cmml">M</mi><mo id="S2.SS2.p1.4.m4.2.3.1" xref="S2.SS2.p1.4.m4.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.2.3.3.2" xref="S2.SS2.p1.4.m4.2.3.3.1.cmml"><mn id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml">21</mn><mo id="S2.SS2.p1.4.m4.2.3.3.2.1" xref="S2.SS2.p1.4.m4.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.4.m4.2.2" xref="S2.SS2.p1.4.m4.2.2.cmml">563</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.2b"><apply id="S2.SS2.p1.4.m4.2.3.cmml" xref="S2.SS2.p1.4.m4.2.3"><eq id="S2.SS2.p1.4.m4.2.3.1.cmml" xref="S2.SS2.p1.4.m4.2.3.1"></eq><ci id="S2.SS2.p1.4.m4.2.3.2.cmml" xref="S2.SS2.p1.4.m4.2.3.2">𝑀</ci><list id="S2.SS2.p1.4.m4.2.3.3.1.cmml" xref="S2.SS2.p1.4.m4.2.3.3.2"><cn type="integer" id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">21</cn><cn type="integer" id="S2.SS2.p1.4.m4.2.2.cmml" xref="S2.SS2.p1.4.m4.2.2">563</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.2c">M=21,563</annotation></semantics></math>), validation (10%, <math id="S2.SS2.p1.5.m5.2" class="ltx_Math" alttext="N=11,219" display="inline"><semantics id="S2.SS2.p1.5.m5.2a"><mrow id="S2.SS2.p1.5.m5.2.3" xref="S2.SS2.p1.5.m5.2.3.cmml"><mi id="S2.SS2.p1.5.m5.2.3.2" xref="S2.SS2.p1.5.m5.2.3.2.cmml">N</mi><mo id="S2.SS2.p1.5.m5.2.3.1" xref="S2.SS2.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.5.m5.2.3.3.2" xref="S2.SS2.p1.5.m5.2.3.3.1.cmml"><mn id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml">11</mn><mo id="S2.SS2.p1.5.m5.2.3.3.2.1" xref="S2.SS2.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.5.m5.2.2" xref="S2.SS2.p1.5.m5.2.2.cmml">219</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.2b"><apply id="S2.SS2.p1.5.m5.2.3.cmml" xref="S2.SS2.p1.5.m5.2.3"><eq id="S2.SS2.p1.5.m5.2.3.1.cmml" xref="S2.SS2.p1.5.m5.2.3.1"></eq><ci id="S2.SS2.p1.5.m5.2.3.2.cmml" xref="S2.SS2.p1.5.m5.2.3.2">𝑁</ci><list id="S2.SS2.p1.5.m5.2.3.3.1.cmml" xref="S2.SS2.p1.5.m5.2.3.3.2"><cn type="integer" id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">11</cn><cn type="integer" id="S2.SS2.p1.5.m5.2.2.cmml" xref="S2.SS2.p1.5.m5.2.2">219</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.2c">N=11,219</annotation></semantics></math>, <math id="S2.SS2.p1.6.m6.2" class="ltx_Math" alttext="M=3,080" display="inline"><semantics id="S2.SS2.p1.6.m6.2a"><mrow id="S2.SS2.p1.6.m6.2.3" xref="S2.SS2.p1.6.m6.2.3.cmml"><mi id="S2.SS2.p1.6.m6.2.3.2" xref="S2.SS2.p1.6.m6.2.3.2.cmml">M</mi><mo id="S2.SS2.p1.6.m6.2.3.1" xref="S2.SS2.p1.6.m6.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.6.m6.2.3.3.2" xref="S2.SS2.p1.6.m6.2.3.3.1.cmml"><mn id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">3</mn><mo id="S2.SS2.p1.6.m6.2.3.3.2.1" xref="S2.SS2.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.6.m6.2.2" xref="S2.SS2.p1.6.m6.2.2.cmml">080</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.2b"><apply id="S2.SS2.p1.6.m6.2.3.cmml" xref="S2.SS2.p1.6.m6.2.3"><eq id="S2.SS2.p1.6.m6.2.3.1.cmml" xref="S2.SS2.p1.6.m6.2.3.1"></eq><ci id="S2.SS2.p1.6.m6.2.3.2.cmml" xref="S2.SS2.p1.6.m6.2.3.2">𝑀</ci><list id="S2.SS2.p1.6.m6.2.3.3.1.cmml" xref="S2.SS2.p1.6.m6.2.3.3.2"><cn type="integer" id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">3</cn><cn type="integer" id="S2.SS2.p1.6.m6.2.2.cmml" xref="S2.SS2.p1.6.m6.2.2">080</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.2c">M=3,080</annotation></semantics></math>), and testing (20%, <math id="S2.SS2.p1.7.m7.2" class="ltx_Math" alttext="N=22,330" display="inline"><semantics id="S2.SS2.p1.7.m7.2a"><mrow id="S2.SS2.p1.7.m7.2.3" xref="S2.SS2.p1.7.m7.2.3.cmml"><mi id="S2.SS2.p1.7.m7.2.3.2" xref="S2.SS2.p1.7.m7.2.3.2.cmml">N</mi><mo id="S2.SS2.p1.7.m7.2.3.1" xref="S2.SS2.p1.7.m7.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.7.m7.2.3.3.2" xref="S2.SS2.p1.7.m7.2.3.3.1.cmml"><mn id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">22</mn><mo id="S2.SS2.p1.7.m7.2.3.3.2.1" xref="S2.SS2.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.7.m7.2.2" xref="S2.SS2.p1.7.m7.2.2.cmml">330</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.2b"><apply id="S2.SS2.p1.7.m7.2.3.cmml" xref="S2.SS2.p1.7.m7.2.3"><eq id="S2.SS2.p1.7.m7.2.3.1.cmml" xref="S2.SS2.p1.7.m7.2.3.1"></eq><ci id="S2.SS2.p1.7.m7.2.3.2.cmml" xref="S2.SS2.p1.7.m7.2.3.2">𝑁</ci><list id="S2.SS2.p1.7.m7.2.3.3.1.cmml" xref="S2.SS2.p1.7.m7.2.3.3.2"><cn type="integer" id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">22</cn><cn type="integer" id="S2.SS2.p1.7.m7.2.2.cmml" xref="S2.SS2.p1.7.m7.2.2">330</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.2c">N=22,330</annotation></semantics></math>, <math id="S2.SS2.p1.8.m8.2" class="ltx_Math" alttext="M=6,162" display="inline"><semantics id="S2.SS2.p1.8.m8.2a"><mrow id="S2.SS2.p1.8.m8.2.3" xref="S2.SS2.p1.8.m8.2.3.cmml"><mi id="S2.SS2.p1.8.m8.2.3.2" xref="S2.SS2.p1.8.m8.2.3.2.cmml">M</mi><mo id="S2.SS2.p1.8.m8.2.3.1" xref="S2.SS2.p1.8.m8.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.8.m8.2.3.3.2" xref="S2.SS2.p1.8.m8.2.3.3.1.cmml"><mn id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">6</mn><mo id="S2.SS2.p1.8.m8.2.3.3.2.1" xref="S2.SS2.p1.8.m8.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.8.m8.2.2" xref="S2.SS2.p1.8.m8.2.2.cmml">162</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.2b"><apply id="S2.SS2.p1.8.m8.2.3.cmml" xref="S2.SS2.p1.8.m8.2.3"><eq id="S2.SS2.p1.8.m8.2.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.1"></eq><ci id="S2.SS2.p1.8.m8.2.3.2.cmml" xref="S2.SS2.p1.8.m8.2.3.2">𝑀</ci><list id="S2.SS2.p1.8.m8.2.3.3.1.cmml" xref="S2.SS2.p1.8.m8.2.3.3.2"><cn type="integer" id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">6</cn><cn type="integer" id="S2.SS2.p1.8.m8.2.2.cmml" xref="S2.SS2.p1.8.m8.2.2">162</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.2c">M=6,162</annotation></semantics></math>) splits while ensuring no patient appears in more than one split. Furthermore, we sampled two synthetic iid toy datasets, NIH (1) and (2), from the NIH dataset by equally distributing patients diagnosed with at least one positive finding with healthy patients to prevent patient overlap. Both synthetic datasets consisted of the same number of patients with distinct training (<math id="S2.SS2.p1.9.m9.2" class="ltx_Math" alttext="M=10,781" display="inline"><semantics id="S2.SS2.p1.9.m9.2a"><mrow id="S2.SS2.p1.9.m9.2.3" xref="S2.SS2.p1.9.m9.2.3.cmml"><mi id="S2.SS2.p1.9.m9.2.3.2" xref="S2.SS2.p1.9.m9.2.3.2.cmml">M</mi><mo id="S2.SS2.p1.9.m9.2.3.1" xref="S2.SS2.p1.9.m9.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.9.m9.2.3.3.2" xref="S2.SS2.p1.9.m9.2.3.3.1.cmml"><mn id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">10</mn><mo id="S2.SS2.p1.9.m9.2.3.3.2.1" xref="S2.SS2.p1.9.m9.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.9.m9.2.2" xref="S2.SS2.p1.9.m9.2.2.cmml">781</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.2b"><apply id="S2.SS2.p1.9.m9.2.3.cmml" xref="S2.SS2.p1.9.m9.2.3"><eq id="S2.SS2.p1.9.m9.2.3.1.cmml" xref="S2.SS2.p1.9.m9.2.3.1"></eq><ci id="S2.SS2.p1.9.m9.2.3.2.cmml" xref="S2.SS2.p1.9.m9.2.3.2">𝑀</ci><list id="S2.SS2.p1.9.m9.2.3.3.1.cmml" xref="S2.SS2.p1.9.m9.2.3.3.2"><cn type="integer" id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">10</cn><cn type="integer" id="S2.SS2.p1.9.m9.2.2.cmml" xref="S2.SS2.p1.9.m9.2.2">781</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.2c">M=10,781</annotation></semantics></math>) and validation (<math id="S2.SS2.p1.10.m10.2" class="ltx_Math" alttext="M=1,540" display="inline"><semantics id="S2.SS2.p1.10.m10.2a"><mrow id="S2.SS2.p1.10.m10.2.3" xref="S2.SS2.p1.10.m10.2.3.cmml"><mi id="S2.SS2.p1.10.m10.2.3.2" xref="S2.SS2.p1.10.m10.2.3.2.cmml">M</mi><mo id="S2.SS2.p1.10.m10.2.3.1" xref="S2.SS2.p1.10.m10.2.3.1.cmml">=</mo><mrow id="S2.SS2.p1.10.m10.2.3.3.2" xref="S2.SS2.p1.10.m10.2.3.3.1.cmml"><mn id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">1</mn><mo id="S2.SS2.p1.10.m10.2.3.3.2.1" xref="S2.SS2.p1.10.m10.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p1.10.m10.2.2" xref="S2.SS2.p1.10.m10.2.2.cmml">540</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.2b"><apply id="S2.SS2.p1.10.m10.2.3.cmml" xref="S2.SS2.p1.10.m10.2.3"><eq id="S2.SS2.p1.10.m10.2.3.1.cmml" xref="S2.SS2.p1.10.m10.2.3.1"></eq><ci id="S2.SS2.p1.10.m10.2.3.2.cmml" xref="S2.SS2.p1.10.m10.2.3.2">𝑀</ci><list id="S2.SS2.p1.10.m10.2.3.3.1.cmml" xref="S2.SS2.p1.10.m10.2.3.3.2"><cn type="integer" id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">1</cn><cn type="integer" id="S2.SS2.p1.10.m10.2.2.cmml" xref="S2.SS2.p1.10.m10.2.2">540</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.2c">M=1,540</annotation></semantics></math>) sets sampled from the global splits, while ensuring there is no patient overlap.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.8" class="ltx_p"><span id="S2.SS2.p2.8.1" class="ltx_text ltx_font_bold">CheXpert:</span>
The Stanford CheXpert dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> consists of 13 disease labels (7 shared with NIH) and an additional label for ‘normal’ with <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">N</annotation></semantics></math>=224,316 CXRs from <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mi id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><ci id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">M</annotation></semantics></math>=65,240 patients. To handle uncertain labels in the dataset, we chose the U-Zeros approach i.e. treating all uncertain labels as negatives. We randomly divided the dataset into training (70%, <math id="S2.SS2.p2.3.m3.2" class="ltx_Math" alttext="N=155,470" display="inline"><semantics id="S2.SS2.p2.3.m3.2a"><mrow id="S2.SS2.p2.3.m3.2.3" xref="S2.SS2.p2.3.m3.2.3.cmml"><mi id="S2.SS2.p2.3.m3.2.3.2" xref="S2.SS2.p2.3.m3.2.3.2.cmml">N</mi><mo id="S2.SS2.p2.3.m3.2.3.1" xref="S2.SS2.p2.3.m3.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.3.m3.2.3.3.2" xref="S2.SS2.p2.3.m3.2.3.3.1.cmml"><mn id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">155</mn><mo id="S2.SS2.p2.3.m3.2.3.3.2.1" xref="S2.SS2.p2.3.m3.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.3.m3.2.2" xref="S2.SS2.p2.3.m3.2.2.cmml">470</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.2b"><apply id="S2.SS2.p2.3.m3.2.3.cmml" xref="S2.SS2.p2.3.m3.2.3"><eq id="S2.SS2.p2.3.m3.2.3.1.cmml" xref="S2.SS2.p2.3.m3.2.3.1"></eq><ci id="S2.SS2.p2.3.m3.2.3.2.cmml" xref="S2.SS2.p2.3.m3.2.3.2">𝑁</ci><list id="S2.SS2.p2.3.m3.2.3.3.1.cmml" xref="S2.SS2.p2.3.m3.2.3.3.2"><cn type="integer" id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">155</cn><cn type="integer" id="S2.SS2.p2.3.m3.2.2.cmml" xref="S2.SS2.p2.3.m3.2.2">470</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.2c">N=155,470</annotation></semantics></math>, <math id="S2.SS2.p2.4.m4.2" class="ltx_Math" alttext="M=45,178" display="inline"><semantics id="S2.SS2.p2.4.m4.2a"><mrow id="S2.SS2.p2.4.m4.2.3" xref="S2.SS2.p2.4.m4.2.3.cmml"><mi id="S2.SS2.p2.4.m4.2.3.2" xref="S2.SS2.p2.4.m4.2.3.2.cmml">M</mi><mo id="S2.SS2.p2.4.m4.2.3.1" xref="S2.SS2.p2.4.m4.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.4.m4.2.3.3.2" xref="S2.SS2.p2.4.m4.2.3.3.1.cmml"><mn id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml">45</mn><mo id="S2.SS2.p2.4.m4.2.3.3.2.1" xref="S2.SS2.p2.4.m4.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.4.m4.2.2" xref="S2.SS2.p2.4.m4.2.2.cmml">178</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.2b"><apply id="S2.SS2.p2.4.m4.2.3.cmml" xref="S2.SS2.p2.4.m4.2.3"><eq id="S2.SS2.p2.4.m4.2.3.1.cmml" xref="S2.SS2.p2.4.m4.2.3.1"></eq><ci id="S2.SS2.p2.4.m4.2.3.2.cmml" xref="S2.SS2.p2.4.m4.2.3.2">𝑀</ci><list id="S2.SS2.p2.4.m4.2.3.3.1.cmml" xref="S2.SS2.p2.4.m4.2.3.3.2"><cn type="integer" id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">45</cn><cn type="integer" id="S2.SS2.p2.4.m4.2.2.cmml" xref="S2.SS2.p2.4.m4.2.2">178</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.2c">M=45,178</annotation></semantics></math>), validation (10%, <math id="S2.SS2.p2.5.m5.2" class="ltx_Math" alttext="N=22,736" display="inline"><semantics id="S2.SS2.p2.5.m5.2a"><mrow id="S2.SS2.p2.5.m5.2.3" xref="S2.SS2.p2.5.m5.2.3.cmml"><mi id="S2.SS2.p2.5.m5.2.3.2" xref="S2.SS2.p2.5.m5.2.3.2.cmml">N</mi><mo id="S2.SS2.p2.5.m5.2.3.1" xref="S2.SS2.p2.5.m5.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.5.m5.2.3.3.2" xref="S2.SS2.p2.5.m5.2.3.3.1.cmml"><mn id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">22</mn><mo id="S2.SS2.p2.5.m5.2.3.3.2.1" xref="S2.SS2.p2.5.m5.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.5.m5.2.2" xref="S2.SS2.p2.5.m5.2.2.cmml">736</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.2b"><apply id="S2.SS2.p2.5.m5.2.3.cmml" xref="S2.SS2.p2.5.m5.2.3"><eq id="S2.SS2.p2.5.m5.2.3.1.cmml" xref="S2.SS2.p2.5.m5.2.3.1"></eq><ci id="S2.SS2.p2.5.m5.2.3.2.cmml" xref="S2.SS2.p2.5.m5.2.3.2">𝑁</ci><list id="S2.SS2.p2.5.m5.2.3.3.1.cmml" xref="S2.SS2.p2.5.m5.2.3.3.2"><cn type="integer" id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">22</cn><cn type="integer" id="S2.SS2.p2.5.m5.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2">736</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.2c">N=22,736</annotation></semantics></math>, <math id="S2.SS2.p2.6.m6.2" class="ltx_Math" alttext="M=6,454" display="inline"><semantics id="S2.SS2.p2.6.m6.2a"><mrow id="S2.SS2.p2.6.m6.2.3" xref="S2.SS2.p2.6.m6.2.3.cmml"><mi id="S2.SS2.p2.6.m6.2.3.2" xref="S2.SS2.p2.6.m6.2.3.2.cmml">M</mi><mo id="S2.SS2.p2.6.m6.2.3.1" xref="S2.SS2.p2.6.m6.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.6.m6.2.3.3.2" xref="S2.SS2.p2.6.m6.2.3.3.1.cmml"><mn id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml">6</mn><mo id="S2.SS2.p2.6.m6.2.3.3.2.1" xref="S2.SS2.p2.6.m6.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.6.m6.2.2" xref="S2.SS2.p2.6.m6.2.2.cmml">454</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.2b"><apply id="S2.SS2.p2.6.m6.2.3.cmml" xref="S2.SS2.p2.6.m6.2.3"><eq id="S2.SS2.p2.6.m6.2.3.1.cmml" xref="S2.SS2.p2.6.m6.2.3.1"></eq><ci id="S2.SS2.p2.6.m6.2.3.2.cmml" xref="S2.SS2.p2.6.m6.2.3.2">𝑀</ci><list id="S2.SS2.p2.6.m6.2.3.3.1.cmml" xref="S2.SS2.p2.6.m6.2.3.3.2"><cn type="integer" id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">6</cn><cn type="integer" id="S2.SS2.p2.6.m6.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2">454</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.2c">M=6,454</annotation></semantics></math>), and testing (20%, <math id="S2.SS2.p2.7.m7.2" class="ltx_Math" alttext="N=45,208" display="inline"><semantics id="S2.SS2.p2.7.m7.2a"><mrow id="S2.SS2.p2.7.m7.2.3" xref="S2.SS2.p2.7.m7.2.3.cmml"><mi id="S2.SS2.p2.7.m7.2.3.2" xref="S2.SS2.p2.7.m7.2.3.2.cmml">N</mi><mo id="S2.SS2.p2.7.m7.2.3.1" xref="S2.SS2.p2.7.m7.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.7.m7.2.3.3.2" xref="S2.SS2.p2.7.m7.2.3.3.1.cmml"><mn id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">45</mn><mo id="S2.SS2.p2.7.m7.2.3.3.2.1" xref="S2.SS2.p2.7.m7.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.7.m7.2.2" xref="S2.SS2.p2.7.m7.2.2.cmml">208</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.2b"><apply id="S2.SS2.p2.7.m7.2.3.cmml" xref="S2.SS2.p2.7.m7.2.3"><eq id="S2.SS2.p2.7.m7.2.3.1.cmml" xref="S2.SS2.p2.7.m7.2.3.1"></eq><ci id="S2.SS2.p2.7.m7.2.3.2.cmml" xref="S2.SS2.p2.7.m7.2.3.2">𝑁</ci><list id="S2.SS2.p2.7.m7.2.3.3.1.cmml" xref="S2.SS2.p2.7.m7.2.3.3.2"><cn type="integer" id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">45</cn><cn type="integer" id="S2.SS2.p2.7.m7.2.2.cmml" xref="S2.SS2.p2.7.m7.2.2">208</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.2c">N=45,208</annotation></semantics></math>, <math id="S2.SS2.p2.8.m8.2" class="ltx_Math" alttext="M=12,908" display="inline"><semantics id="S2.SS2.p2.8.m8.2a"><mrow id="S2.SS2.p2.8.m8.2.3" xref="S2.SS2.p2.8.m8.2.3.cmml"><mi id="S2.SS2.p2.8.m8.2.3.2" xref="S2.SS2.p2.8.m8.2.3.2.cmml">M</mi><mo id="S2.SS2.p2.8.m8.2.3.1" xref="S2.SS2.p2.8.m8.2.3.1.cmml">=</mo><mrow id="S2.SS2.p2.8.m8.2.3.3.2" xref="S2.SS2.p2.8.m8.2.3.3.1.cmml"><mn id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml">12</mn><mo id="S2.SS2.p2.8.m8.2.3.3.2.1" xref="S2.SS2.p2.8.m8.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.8.m8.2.2" xref="S2.SS2.p2.8.m8.2.2.cmml">908</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.2b"><apply id="S2.SS2.p2.8.m8.2.3.cmml" xref="S2.SS2.p2.8.m8.2.3"><eq id="S2.SS2.p2.8.m8.2.3.1.cmml" xref="S2.SS2.p2.8.m8.2.3.1"></eq><ci id="S2.SS2.p2.8.m8.2.3.2.cmml" xref="S2.SS2.p2.8.m8.2.3.2">𝑀</ci><list id="S2.SS2.p2.8.m8.2.3.3.1.cmml" xref="S2.SS2.p2.8.m8.2.3.3.2"><cn type="integer" id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">12</cn><cn type="integer" id="S2.SS2.p2.8.m8.2.2.cmml" xref="S2.SS2.p2.8.m8.2.2">908</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.2c">M=12,908</annotation></semantics></math>) splits while ensuring no patient appears in more than one split.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p"><span id="S2.SS2.p3.1.1" class="ltx_text ltx_font_bold">MIMIC-CXR-JPG</span>:
To evaluate the generalizability of our methods, we utilized the MIMIC-CXR-JPG dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as our external test set. Similar to the CheXpert dataset, the MIMIC dataset consists of 13 disease labels (7 shared with NIH) and an additional label for ‘normal’ with <math id="S2.SS2.p3.1.m1.2" class="ltx_Math" alttext="N=377,110" display="inline"><semantics id="S2.SS2.p3.1.m1.2a"><mrow id="S2.SS2.p3.1.m1.2.3" xref="S2.SS2.p3.1.m1.2.3.cmml"><mi id="S2.SS2.p3.1.m1.2.3.2" xref="S2.SS2.p3.1.m1.2.3.2.cmml">N</mi><mo id="S2.SS2.p3.1.m1.2.3.1" xref="S2.SS2.p3.1.m1.2.3.1.cmml">=</mo><mrow id="S2.SS2.p3.1.m1.2.3.3.2" xref="S2.SS2.p3.1.m1.2.3.3.1.cmml"><mn id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml">377</mn><mo id="S2.SS2.p3.1.m1.2.3.3.2.1" xref="S2.SS2.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p3.1.m1.2.2" xref="S2.SS2.p3.1.m1.2.2.cmml">110</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.2b"><apply id="S2.SS2.p3.1.m1.2.3.cmml" xref="S2.SS2.p3.1.m1.2.3"><eq id="S2.SS2.p3.1.m1.2.3.1.cmml" xref="S2.SS2.p3.1.m1.2.3.1"></eq><ci id="S2.SS2.p3.1.m1.2.3.2.cmml" xref="S2.SS2.p3.1.m1.2.3.2">𝑁</ci><list id="S2.SS2.p3.1.m1.2.3.3.1.cmml" xref="S2.SS2.p3.1.m1.2.3.3.2"><cn type="integer" id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">377</cn><cn type="integer" id="S2.SS2.p3.1.m1.2.2.cmml" xref="S2.SS2.p3.1.m1.2.2">110</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.2c">N=377,110</annotation></semantics></math> CXRs from 65,379 patients. To handle uncertain labels in the dataset, we chose the U-Zeros approach i.e. treating all uncertain labels as negatives.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Federated Learning Setup</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">For our federated learning setup, we utilized a two-node surgical aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> setup to train a multi-label global meta-model. In short, surgical aggregation is a task-agnostic, semi-supervised framework for aggregating knowledge from distributed datasets with partial labels, consisting of a representation and task block. Due to it’s agnostic nature, surgical aggregation serves as a backbone in our analysis. By changing the aggregation strategy used for aggregation weights for the representation block, we can evaluate various FL strategies including FedFBN. For our model architecture, we used DenseNet121 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, initialized with ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> weights.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Prior to federation, the classification heads of all local models were warmed-up using transfer learning with learning rate of 1e-3. For our analysis, we modified the strategy used for weight aggregation in the representation block. For preprocessing, all images were downsampled to 224x224, normalized between 0 and 1, and augmented. We trained all models for 100 epochs with 1 epoch between two consecutive communication rounds (<math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><mrow id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">E</mi><mo id="S2.SS3.p2.1.m1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><eq id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1"></eq><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">E=1</annotation></semantics></math>) with a batch size of 64 and learning rate of 1e-5 using TensorFlow 2.8.1. At the end of each local training round, the binary cross entropy (BCE) losses at each node were communicated back to the server and the best performing global model was determined by the model with the smallest mean loss.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Experimental Setup</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">We conducted four experiments that evaluate FedFBN across non-iid and iid datasets with partial and complete label distribution across two nodes. Across all four experiments, we will compare the performance of models training using FedFBN with FedAvg and FedBN. Due to the inability of FedBN to learn a global model, we measured the performance of each local FedBN model. Additionally, we will also compare with baseline and centrally aggregated models. Here, baseline refers to models trained with the complete dataset, while centrally aggregated models were locally trained by naïvely concatenating each dataset without harmonizing disease labels. Furthermore, prior literature has demonstrated that utilizing partial loss to tackle partial labels in a federated setup yields poor performance on unseen labels <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.1" class="ltx_p">For all experiments, as model metrics, we measured BCE loss and the average area under receiver operating characteristic curve (AUROC) score. In a multi-label scenario, the AUROC score is defined as the mean AUROC score across all disease labels. We compared the performance of FedFBN with other FL strategies and baseline models using bootstrapping and two-tailed paired t-test. We calculated the 95% confidence interval (CI) for the AUROC scores and compared them using bootstrapping and a paired two-tailed t-test. Statistical significance was defined as <math id="S2.SS4.p2.1.m1.1" class="ltx_Math" alttext="p&lt;0.05" display="inline"><semantics id="S2.SS4.p2.1.m1.1a"><mrow id="S2.SS4.p2.1.m1.1.1" xref="S2.SS4.p2.1.m1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.1.1.2" xref="S2.SS4.p2.1.m1.1.1.2.cmml">p</mi><mo id="S2.SS4.p2.1.m1.1.1.1" xref="S2.SS4.p2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S2.SS4.p2.1.m1.1.1.3" xref="S2.SS4.p2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.1b"><apply id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1"><lt id="S2.SS4.p2.1.m1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1.1"></lt><ci id="S2.SS4.p2.1.m1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.1.1.2">𝑝</ci><cn type="float" id="S2.SS4.p2.1.m1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.1c">p&lt;0.05</annotation></semantics></math>.</p>
</div>
<div id="S2.SS4.p3" class="ltx_para">
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p"><span id="S2.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Distributed iid data with complete labels:</span>
This experiment encapsulates the best possible case for a federated learning setup. While the data is distributed, it is iid and contains the complete representation of all labels. We use the two synthetic NIH (1) and (2) datasets to evaluate the performance of FedFBN. Since both datasets contain the complete label distribution, the baseline and centrally aggregated models are equivalent. We evaluated all models on the held-out NIH test set and the MIMIC external test set.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p"><span id="S2.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Distributed iid data with partial labels:</span>
In this experiment, we add a layer of complexity to the problem due to the presence of partial labels. To simulate this case, we randomly pruned the disease labels from the two synthetic NIH (1) and (2) datasets to yield datasets containing 11 and 7 disease labels, with 4 labels shared across both. We evaluated all models on the held-out NIH test set by measuring the model performance on the 4 shared labels as well as each subset of the label distribution. Similarly, we also evaluated all models on the MIMIC external test set.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.1" class="ltx_p"><span id="S2.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Distributed non-iid data with complete labels:</span>
The complexity of the problem increases drastically as we switch from iid to non-iid data. Due to domain shift, the features learned by each local model differ. In this experiment, we train a global model using the entire NIH and CheXpert datasets on the 7 shared labels using surgical aggregation with differential learning rates of 1e-5 and 5e-5 to tackle domain shift. As a result, we can effectively evaluate across all three large-scale datasets in our analysis. We evaluate all models on the held-out NIH and CheXpert datasets, along with the MIMIC external test set on the 7 shared labels. Additionally, we cross-evaluate the NIH baseline model on the CheXpert test set and vice versa.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S2.I1.i4.p1" class="ltx_para">
<p id="S2.I1.i4.p1.1" class="ltx_p"><span id="S2.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Distributed non-iid data with partial labels:</span>
Out of the all scenarios considered in our experimental setup, tackling distributed non-iid data with partial labels is the most complex problem due to domain shift and the presence of unseen disease labels. Here, we train a global model using the entire NIH and CheXpert datasets using surgical aggregation with differential learning rates of 1e-5 and 5e-5 to tackle domain shift. This yields us a 20 disease label classifier and we can effectively evaluate across all three large-scale datasets. We evaluate all models on the held-out NIH and CheXpert datasets, along with the MIMIC external test set on the 7 shared labels and all observed disease labels in each dataset. Additionally, we cross-evaluate the NIH baseline model on the CheXpert test set and vice versa.</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.4" class="ltx_p">In the experiment with distributed iid data with complete labels, on the held-out NIH test set, we observe that the performance of FedFBN is comparable to, if not slightly better than, the baseline NIH model with a mean AUROC 0.82 (<math id="S3.p1.1.m1.1" class="ltx_Math" alttext="p=0.07" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">p</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml">0.07</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><eq id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></eq><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑝</ci><cn type="float" id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3">0.07</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">p=0.07</annotation></semantics></math>). We also observe that FedFBN performs comparably to FedAvg (<math id="S3.p1.2.m2.1" class="ltx_Math" alttext="p=0.25" display="inline"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">p</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><eq id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></eq><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑝</ci><cn type="float" id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">p=0.25</annotation></semantics></math>), while slightly outperforming the local FedBN model (<math id="S3.p1.3.m3.1" class="ltx_Math" alttext="p=0.01" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">p</mi><mo id="S3.p1.3.m3.1.1.1" xref="S3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><eq id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1"></eq><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑝</ci><cn type="float" id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">p=0.01</annotation></semantics></math>). On the MIMIC external test set, we observe that FedFBN generalizes better to unseen distributions and outperforms all models with a mean AUROC of 0.75 (<math id="S3.p1.4.m4.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">p</mi><mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">&lt;</mo><mn id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><lt id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"></lt><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝑝</ci><cn type="float" id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">p&lt;0.001</annotation></semantics></math>). Results are detailed in Table <a href="#S3.T1" title="Table 1 ‣ 3 Results ‣ Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Model metrics for iid datasets with complete labels on held-out NIH test set and external MIMIC test set. 95% CI for mean AUROC scores provided in brackets. Best performing models are highlighted in bold.</figcaption><img src="/html/2303.06180/assets/assets/exp-4/results.png" id="S3.T1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="419" height="147" alt="[Uncaptioned image]">
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.6" class="ltx_p">When switching to a partial label distribution with iid data, on the held-out NIH test set, we observe that FedFBN performs comparable to the baseline NIH model across the each subset of the label distribution with a mean AUROC of 0.82 (<math id="S3.p2.1.m1.1" class="ltx_Math" alttext="p=0.22" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">p</mi><mo id="S3.p2.1.m1.1.1.1" xref="S3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">0.22</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><eq id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1"></eq><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝑝</ci><cn type="float" id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">0.22</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">p=0.22</annotation></semantics></math>) for NIH (1) and 0.85 (<math id="S3.p2.2.m2.1" class="ltx_Math" alttext="p=0.11" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">p</mi><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">0.11</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><eq id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></eq><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑝</ci><cn type="float" id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">0.11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">p=0.11</annotation></semantics></math>) for NIH (2), and all 14 NIH disease labels with a mean AUROC of 0.82 (<math id="S3.p2.3.m3.1" class="ltx_Math" alttext="p=0.42" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">p</mi><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">0.42</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><eq id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></eq><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑝</ci><cn type="float" id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">0.42</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">p=0.42</annotation></semantics></math>). Furthermore, on the 4 shared labels between both synthetic datasets, FedFBN outperforms the baseline model with a mean AUROC of 0.89 (<math id="S3.p2.4.m4.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">p</mi><mo id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">&lt;</mo><mn id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><lt id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1"></lt><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝑝</ci><cn type="float" id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">p&lt;0.001</annotation></semantics></math>). Moreover, across all test sets, FedFBN outperforms FedAvg and the local FedBN model (<math id="S3.p2.5.m5.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">p</mi><mo id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml">&lt;</mo><mn id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><lt id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"></lt><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝑝</ci><cn type="float" id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">p&lt;0.001</annotation></semantics></math>). As expected, the local FedBN model performs poorly due it’s drawback in scenarios with partial labels. We observe similar results on the MIMIC external test set, where FedFBN generalizes better and outperforms all models with a mean AUROC of 0.75 (<math id="S3.p2.6.m6.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">p</mi><mo id="S3.p2.6.m6.1.1.1" xref="S3.p2.6.m6.1.1.1.cmml">&lt;</mo><mn id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><lt id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1"></lt><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝑝</ci><cn type="float" id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">p&lt;0.001</annotation></semantics></math>). Results are detailed in Table <a href="#S3.F1.sf2" title="In Table 2 ‣ 3 Results ‣ Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(b)</span></a>.</p>
</div>
<figure id="S3.T2" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Model metrics for iid datasets with partial labels on held-out NIH test set and external MIMIC test set. 95% CI for mean AUROC scores provided in brackets. Best performing models are highlighted in bold.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06180/assets/assets/exp-3/results_common.png" id="S3.F1.sf1.g1" class="ltx_graphics ltx_img_landscape" width="240" height="134" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.sf1.2.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S3.F1.sf1.3.2" class="ltx_text" style="font-size:80%;">4 Shared Disease Labels</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06180/assets/assets/exp-3/results_all.png" id="S3.F1.sf2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="139" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.sf2.2.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S3.F1.sf2.3.2" class="ltx_text" style="font-size:80%;">All Disease Labels</span></figcaption>
</figure>
</div>
</div>
</figure>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.5" class="ltx_p">Despite the added complexity of distributed non-iid data with complete disease labels, we observe that FedFBN performs comparably to the baseline NIH model with a mean AUROC of 0.84 (<math id="S3.p3.1.m1.1" class="ltx_Math" alttext="p=0.1" display="inline"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">p</mi><mo id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><eq id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></eq><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑝</ci><cn type="float" id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">p=0.1</annotation></semantics></math>) and the baseline CheXpert model with a mean AUROC of 0.77 (<math id="S3.p3.2.m2.1" class="ltx_Math" alttext="p=0.98" display="inline"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">p</mi><mo id="S3.p3.2.m2.1.1.1" xref="S3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">0.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><eq id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1"></eq><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝑝</ci><cn type="float" id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">0.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">p=0.98</annotation></semantics></math>). We finally observe the drawbacks of FedAvg in this experiment as it performs worse than the centrally aggregated model and is outperformed by FedBN. However, on the NIH test set, FedFBN outperforms the local FedBN model (<math id="S3.p3.3.m3.1" class="ltx_Math" alttext="p=0.01" display="inline"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">p</mi><mo id="S3.p3.3.m3.1.1.1" xref="S3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><eq id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1"></eq><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝑝</ci><cn type="float" id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">p=0.01</annotation></semantics></math>). On all other evaluations across both test sets, FedFBN outperforms FedAvg and the local FedBN model (<math id="S3.p3.4.m4.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">p</mi><mo id="S3.p3.4.m4.1.1.1" xref="S3.p3.4.m4.1.1.1.cmml">&lt;</mo><mn id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><lt id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1"></lt><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝑝</ci><cn type="float" id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">p&lt;0.001</annotation></semantics></math>). We observe similar results on the MIMIC external test set, where FedFBN generalizes better and outperforms all models with a mean AUROC of 0.81 (<math id="S3.p3.5.m5.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml">p</mi><mo id="S3.p3.5.m5.1.1.1" xref="S3.p3.5.m5.1.1.1.cmml">&lt;</mo><mn id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><lt id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1"></lt><ci id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2">𝑝</ci><cn type="float" id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">p&lt;0.001</annotation></semantics></math>). Results are detailed in Table <a href="#S3.T3" title="Table 3 ‣ 3 Results ‣ Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Model metrics for non-iid datasets with complete labels on held-out NIH and CheXpert test sets and external MIMIC test set. 95% CI for mean AUROC scores provided in brackets. Best performing models are highlighted in bold.</figcaption><img src="/html/2303.06180/assets/assets/exp-2/results.png" id="S3.T3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="171" alt="[Uncaptioned image]">
</figure>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.8" class="ltx_p">In the final experiment, with the highest complexity due to distributed non-iid data with partial labels and domain shift, we yet again observe FedFBN’s superiority over other aggregation strategies. When the 7 shared disease labels are considered, FedFBN performs better than the baseline NIH model with a mean AUROC of 0.84 (<math id="S3.p4.1.m1.1" class="ltx_Math" alttext="p=0.03" display="inline"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">p</mi><mo id="S3.p4.1.m1.1.1.1" xref="S3.p4.1.m1.1.1.1.cmml">=</mo><mn id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">0.03</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><eq id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1"></eq><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝑝</ci><cn type="float" id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">0.03</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">p=0.03</annotation></semantics></math>) while performing comparably to the baseline CheXpert model with a mean AUROC of 0.77 (<math id="S3.p4.2.m2.1" class="ltx_Math" alttext="p=0.98" display="inline"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">p</mi><mo id="S3.p4.2.m2.1.1.1" xref="S3.p4.2.m2.1.1.1.cmml">=</mo><mn id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">0.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><eq id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1"></eq><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑝</ci><cn type="float" id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">0.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">p=0.98</annotation></semantics></math>). Furthermore, FedFBN outperforms FedAvg and the local FedBN model across both test sets (<math id="S3.p4.3.m3.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p4.3.m3.1a"><mrow id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">p</mi><mo id="S3.p4.3.m3.1.1.1" xref="S3.p4.3.m3.1.1.1.cmml">&lt;</mo><mn id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><lt id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1.1"></lt><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝑝</ci><cn type="float" id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">p&lt;0.001</annotation></semantics></math>). When all observed disease labels across both test sets are considered, we observe that FedFBN performs comparable to the baseline NIH model with a mean AUROC of 0.81 (<math id="S3.p4.4.m4.1" class="ltx_Math" alttext="p=0.06" display="inline"><semantics id="S3.p4.4.m4.1a"><mrow id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">p</mi><mo id="S3.p4.4.m4.1.1.1" xref="S3.p4.4.m4.1.1.1.cmml">=</mo><mn id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml">0.06</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><eq id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1.1"></eq><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">𝑝</ci><cn type="float" id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3">0.06</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">p=0.06</annotation></semantics></math>), but outperforms the baseline CheXpert model with a mean AUROC of 0.75 (<math id="S3.p4.5.m5.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p4.5.m5.1a"><mrow id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml">p</mi><mo id="S3.p4.5.m5.1.1.1" xref="S3.p4.5.m5.1.1.1.cmml">&lt;</mo><mn id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><lt id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1.1"></lt><ci id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2">𝑝</ci><cn type="float" id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">p&lt;0.001</annotation></semantics></math>). We observe that apart from performing comparably to FedBN on the NIH test set (<math id="S3.p4.6.m6.1" class="ltx_Math" alttext="p=0.72" display="inline"><semantics id="S3.p4.6.m6.1a"><mrow id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml"><mi id="S3.p4.6.m6.1.1.2" xref="S3.p4.6.m6.1.1.2.cmml">p</mi><mo id="S3.p4.6.m6.1.1.1" xref="S3.p4.6.m6.1.1.1.cmml">=</mo><mn id="S3.p4.6.m6.1.1.3" xref="S3.p4.6.m6.1.1.3.cmml">0.72</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1"><eq id="S3.p4.6.m6.1.1.1.cmml" xref="S3.p4.6.m6.1.1.1"></eq><ci id="S3.p4.6.m6.1.1.2.cmml" xref="S3.p4.6.m6.1.1.2">𝑝</ci><cn type="float" id="S3.p4.6.m6.1.1.3.cmml" xref="S3.p4.6.m6.1.1.3">0.72</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">p=0.72</annotation></semantics></math>), FedFBN outperforms both FedAvg and the local FedBN model (<math id="S3.p4.7.m7.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p4.7.m7.1a"><mrow id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml"><mi id="S3.p4.7.m7.1.1.2" xref="S3.p4.7.m7.1.1.2.cmml">p</mi><mo id="S3.p4.7.m7.1.1.1" xref="S3.p4.7.m7.1.1.1.cmml">&lt;</mo><mn id="S3.p4.7.m7.1.1.3" xref="S3.p4.7.m7.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><apply id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1"><lt id="S3.p4.7.m7.1.1.1.cmml" xref="S3.p4.7.m7.1.1.1"></lt><ci id="S3.p4.7.m7.1.1.2.cmml" xref="S3.p4.7.m7.1.1.2">𝑝</ci><cn type="float" id="S3.p4.7.m7.1.1.3.cmml" xref="S3.p4.7.m7.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">p&lt;0.001</annotation></semantics></math>). We observe similar results on the MIMIC external test set, where FedFBN generalized better and outperforms all models with a mean AUROC of 0.75 (<math id="S3.p4.8.m8.1" class="ltx_Math" alttext="p&lt;0.001" display="inline"><semantics id="S3.p4.8.m8.1a"><mrow id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml"><mi id="S3.p4.8.m8.1.1.2" xref="S3.p4.8.m8.1.1.2.cmml">p</mi><mo id="S3.p4.8.m8.1.1.1" xref="S3.p4.8.m8.1.1.1.cmml">&lt;</mo><mn id="S3.p4.8.m8.1.1.3" xref="S3.p4.8.m8.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><apply id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1"><lt id="S3.p4.8.m8.1.1.1.cmml" xref="S3.p4.8.m8.1.1.1"></lt><ci id="S3.p4.8.m8.1.1.2.cmml" xref="S3.p4.8.m8.1.1.2">𝑝</ci><cn type="float" id="S3.p4.8.m8.1.1.3.cmml" xref="S3.p4.8.m8.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">p&lt;0.001</annotation></semantics></math>). Results are detailed in Table <a href="#S3.F1.sf4" title="In Table 4 ‣ 3 Results ‣ Optimizing Federated Learning for Medical Image Classification on Distributed Non-iid Datasets with Partial Labels" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1(d)</span></a>.</p>
</div>
<figure id="S3.T4" class="ltx_table">

<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Model metrics for non-iid datasets with partial labels on held-out NIH and CheXpert test sets and external MIMIC test set. 95% CI for mean AUROC scores provided in brackets. Best performing models are highlighted in bold.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F1.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06180/assets/assets/exp-1/results_common.png" id="S3.F1.sf3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="171" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.sf3.2.1.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S3.F1.sf3.3.2" class="ltx_text" style="font-size:80%;">7 Shared Disease Labels</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F1.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06180/assets/assets/exp-1/results_all.png" id="S3.F1.sf4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="171" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.sf4.2.1.1" class="ltx_text" style="font-size:80%;">(d)</span> </span><span id="S3.F1.sf4.3.2" class="ltx_text" style="font-size:80%;">All Disease Labels</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The distributed nature of medical imaging data has impacted the clinical utility of deep learning models. As a result, tackling distributed non-iid datasets with partial labels is a crucial step towards training clinically useful models. Our results demonstrate that FedFBN outperforms current FL aggregation strategies for training global models, while generalizing better to unseen distributions and performing comparably to baseline models. Despite FedAvg being the de-facto standard for FL setups, our work reinforces its limitations with non-iid data. Furthermore, our work also highlights the limitations in FedBN, another popular choice among FL setups dealing with non-iid data. While FedBN addresses many drawbacks with FedAvg, its limitation to training personalized local models rather than global models drastically affects its utility in the clinical workflow. While our work is limited to smaller-scale experiments that do not reflect a realistic FL setup with numerous nodes, our results indicate the superiority of FedFBN over FedAvg and FedBN and demonstrate that FedFBN has the potential to train clinically useful models by leveraging large-scale centrally trained networks to address the negative impact of batch normalization due to domain shift with distributed non-iid datasets with partial labels.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.J., Li, K., Fei-Fei, L.: Imagenet: A
large-scale hierarchical image database. In: 2009 IEEE conference on computer
vision and pattern recognition. pp. 248–255. Ieee (2009)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Goldberger, A.L., Amaral, L.A., Glass, L., Hausdorff, J.M., Ivanov, P.C., Mark,
R.G., Mietus, J.E., Moody, G.B., Peng, C.K., Stanley, H.E.: Physiobank,
physiotoolkit, and physionet: components of a new research resource for
complex physiologic signals. circulation <span id="bib.bib2.1.1" class="ltx_text ltx_font_bold">101</span>(23), e215–e220
(2000)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Huang, G., et al.: Densely connected convolutional networks. Proceedings of the
IEEE conference on computer vision and pattern recognition (2017).
https://doi.org/https://doi.org/10.48550/arXiv.1608.06993

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Ioffe, S., Szegedy, C.: Batch normalization: Accelerating deep network training
by reducing internal covariate shift. In: International conference on machine
learning. pp. 448–456. pmlr (2015)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Irvin, J., Rajpurkar, P., Ko, M., Yu, Y., Ciurea-Ilcus, S., Chute, C.,
Marklund, H., Haghgoo, B., Ball, R., Shpanskaya, K., et al.: Chexpert: A
large chest radiograph dataset with uncertainty labels and expert comparison.
In: Proceedings of the AAAI conference on artificial intelligence. vol. 33,
pp. 590–597 (2019)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Johnson, A.E., Pollard, T.J., Greenbaum, N.R., Lungren, M.P., Deng, C.y., Peng,
Y., Lu, Z., Mark, R.G., Berkowitz, S.J., Horng, S.: Mimic-cxr-jpg, a large
publicly available database of labeled chest radiographs. arXiv preprint
arXiv:1901.07042 (2019)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Kulkarni, P., Kanhere, A., Yi, P.H., Parekh, V.S.: Surgical aggregation: A
federated learning framework for harmonizing distributed datasets with
diverse tasks. arXiv preprint arXiv:2301.06683 (2023)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Li, T., Sahu, A.K., Zaheer, M., Sanjabi, M., Talwalkar, A., Smith, V.:
Federated optimization in heterogeneous networks. Proceedings of Machine
learning and systems <span id="bib.bib8.1.1" class="ltx_text ltx_font_bold">2</span>, 429–450 (2020)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Li, X., Jiang, M., Zhang, X., Kamp, M., Dou, Q.: Fedbn: Federated learning on
non-iid features via local batch normalization. arXiv preprint
arXiv:2102.07623 (2021)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Li, Y., Wang, N., Shi, J., Liu, J., Hou, X.: Revisiting batch normalization for
practical domain adaptation. arXiv preprint arXiv:1603.04779 (2016)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Liang, P.P., Liu, T., Ziyin, L., Allen, N.B., Auerbach, R.P., Brent, D.,
Salakhutdinov, R., Morency, L.P.: Think locally, act globally: Federated
learning with local and global representations. arXiv preprint
arXiv:2001.01523 (2020)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
McMahan, B., more: Communication-Efficient Learning of Deep Networks from
Decentralized Data. In: Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics. Proceedings of Machine Learning
Research, vol. 54, pp. 1273–1282. PMLR (20–22 Apr 2017)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Raghu, M., Zhang, C., Kleinberg, J., Bengio, S.: Transfusion: Understanding
transfer learning for medical imaging. Advances in neural information
processing systems <span id="bib.bib13.1.1" class="ltx_text ltx_font_bold">32</span> (2019)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Rieke, N., et al.: The future of digital health with federated learning. npj
Digital Medicine <span id="bib.bib14.1.1" class="ltx_text ltx_font_bold">3</span>(119) (2020).
https://doi.org/https://doi.org/10.1038/s41746-020-00323-1

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Sheller, M., et al.: Federated learning in medicine: facilitating
multi-institutional collaborations without sharing patient data. Scientific
Reports <span id="bib.bib15.1.1" class="ltx_text ltx_font_bold">10</span>(12598) (2020).
https://doi.org/https://doi.org/10.1038/s41598-020-69250-1

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Wang, X., Peng, Y., Lu, L., Lu, Z., Bagheri, M., Summers, R.M.: Chestx-ray8:
Hospital-scale chest x-ray database and benchmarks on weakly-supervised
classification and localization of common thorax diseases. In: Proceedings of
the IEEE conference on computer vision and pattern recognition. pp.
2097–2106 (2017)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Wang, Y., Shi, Q., Chang, T.H.: Why batch normalization damage federated
learning on non-iid data? arXiv preprint arXiv:2301.02982 (2023)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.06179" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.06180" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.06180">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.06180" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.06181" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 20:53:11 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
