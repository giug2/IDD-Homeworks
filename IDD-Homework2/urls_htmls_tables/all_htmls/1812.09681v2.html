<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1812.09681] Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering</title><meta property="og:description" content="One of the key issues of Visual Question Answering (VQA) is to reason with semantic clues in the visual content under the guidance of the question, how to model relational semantics still remains as a great challenge. …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1812.09681">

<!--Generated on Fri Mar  1 18:20:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Visual Question Answering,  Visual Relational Reasoning,  Graph Neural Networks
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Zhuoqian Yang,
Zengchang Qin,
Jing Yu,
Yue Hu
</span><span class="ltx_author_notes">Zhuoqian Yang and Zengchang Qin are with Intelligent Computing and Machine Learning Lab, School of Automation Science and Electrical Engineering, Beihang University.Jing Yu and Yue Hu are with the Institute of Information Engineering, Chinese Academy of Sciences.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">One of the key issues of Visual Question Answering (VQA) is to reason with semantic clues in the visual content under the guidance of the question, how to model relational semantics still remains as a great challenge. To fully capture visual semantics, we propose to reason over a structured visual representation – scene graph, with embedded objects and inter-object relationships. This shows great benefit over vanilla vector representations and implicit visual relationship learning.
Based on existing visual relationship models, we propose a visual relationship encoder that projects visual relationships into a learned deep semantic space constrained by visual context and language priors. Upon the constructed graph, we propose a <span id="id1.id1.1" class="ltx_text ltx_font_bold">Scene</span> <span id="id1.id1.2" class="ltx_text ltx_font_bold">G</span>raph <span id="id1.id1.3" class="ltx_text ltx_font_bold">C</span>onvolutional <span id="id1.id1.4" class="ltx_text ltx_font_bold">N</span>etwork (<span id="id1.id1.5" class="ltx_text ltx_font_bold">SceneGCN</span>) to jointly reason the object properties and relational semantics for the correct answer. We demonstrate the model’s effectiveness and interpretability on the challenging <span id="id1.id1.6" class="ltx_text ltx_font_italic">GQA</span> dataset and the classical <span id="id1.id1.7" class="ltx_text ltx_font_italic">VQA 2.0</span> dataset, remarkably achieving state-of-the-art 54.56% accuracy on GQA compared to the existing best model.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Visual Question Answering, Visual Relational Reasoning, Graph Neural Networks

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) is one of the most challenging tasks in cross-modal information modeling: an image and a free-form question in natural language are presented to an intelligent agent who is required to determine the correct answer using both visual and textual information.
A key issue in visual question answering is to reason with the semantic clues from the visual content under the guidance of the question. To achieve such human-like abilities, the intelligent agent should not only infer clues from individual objects but also the visual relationships between them. For example, to solve the VQA problem in Figure <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, intelligent agents need to capture not only the object <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">plane</span> that is <span id="S1.p1.1.2" class="ltx_text ltx_font_italic">blue</span>, but also the relationship <math id="S1.p1.1.m1.3" class="ltx_Math" alttext="\left\langle\textit{tower},\textit{to the left of},\textit{plane}\right\rangle" display="inline"><semantics id="S1.p1.1.m1.3a"><mrow id="S1.p1.1.m1.3.4.2" xref="S1.p1.1.m1.3.4.1.cmml"><mo id="S1.p1.1.m1.3.4.2.1" xref="S1.p1.1.m1.3.4.1.cmml">⟨</mo><mtext class="ltx_mathvariant_italic" id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1a.cmml">tower</mtext><mo id="S1.p1.1.m1.3.4.2.2" xref="S1.p1.1.m1.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_italic" id="S1.p1.1.m1.2.2" xref="S1.p1.1.m1.2.2a.cmml">to the left of</mtext><mo id="S1.p1.1.m1.3.4.2.3" xref="S1.p1.1.m1.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_italic" id="S1.p1.1.m1.3.3" xref="S1.p1.1.m1.3.3a.cmml">plane</mtext><mo id="S1.p1.1.m1.3.4.2.4" xref="S1.p1.1.m1.3.4.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.3b"><list id="S1.p1.1.m1.3.4.1.cmml" xref="S1.p1.1.m1.3.4.2"><ci id="S1.p1.1.m1.1.1a.cmml" xref="S1.p1.1.m1.1.1"><mtext class="ltx_mathvariant_italic" id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">tower</mtext></ci><ci id="S1.p1.1.m1.2.2a.cmml" xref="S1.p1.1.m1.2.2"><mtext class="ltx_mathvariant_italic" id="S1.p1.1.m1.2.2.cmml" xref="S1.p1.1.m1.2.2">to the left of</mtext></ci><ci id="S1.p1.1.m1.3.3a.cmml" xref="S1.p1.1.m1.3.3"><mtext class="ltx_mathvariant_italic" id="S1.p1.1.m1.3.3.cmml" xref="S1.p1.1.m1.3.3">plane</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.3c">\left\langle\textit{tower},\textit{to the left of},\textit{plane}\right\rangle</annotation></semantics></math> for correct answer prediction.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1812.09681/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="167" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Semantic visual relationships are crucial in inferring the correct answer. The question requires not only the recognition of the object <span id="S1.F1.5.1" class="ltx_text ltx_font_italic">plane</span> that is <span id="S1.F1.6.2" class="ltx_text ltx_font_italic">blue</span>, but also the relationship <math id="S1.F1.2.m1.3" class="ltx_Math" alttext="\left\langle\textit{tower},\textit{to the left of},\textit{plane}\right\rangle" display="inline"><semantics id="S1.F1.2.m1.3b"><mrow id="S1.F1.2.m1.3.4.2" xref="S1.F1.2.m1.3.4.1.cmml"><mo id="S1.F1.2.m1.3.4.2.1" xref="S1.F1.2.m1.3.4.1.cmml">⟨</mo><mtext class="ltx_mathvariant_italic" id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1a.cmml">tower</mtext><mo id="S1.F1.2.m1.3.4.2.2" xref="S1.F1.2.m1.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_italic" id="S1.F1.2.m1.2.2" xref="S1.F1.2.m1.2.2a.cmml">to the left of</mtext><mo id="S1.F1.2.m1.3.4.2.3" xref="S1.F1.2.m1.3.4.1.cmml">,</mo><mtext class="ltx_mathvariant_italic" id="S1.F1.2.m1.3.3" xref="S1.F1.2.m1.3.3a.cmml">plane</mtext><mo id="S1.F1.2.m1.3.4.2.4" xref="S1.F1.2.m1.3.4.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.3c"><list id="S1.F1.2.m1.3.4.1.cmml" xref="S1.F1.2.m1.3.4.2"><ci id="S1.F1.2.m1.1.1a.cmml" xref="S1.F1.2.m1.1.1"><mtext class="ltx_mathvariant_italic" id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1">tower</mtext></ci><ci id="S1.F1.2.m1.2.2a.cmml" xref="S1.F1.2.m1.2.2"><mtext class="ltx_mathvariant_italic" id="S1.F1.2.m1.2.2.cmml" xref="S1.F1.2.m1.2.2">to the left of</mtext></ci><ci id="S1.F1.2.m1.3.3a.cmml" xref="S1.F1.2.m1.3.3"><mtext class="ltx_mathvariant_italic" id="S1.F1.2.m1.3.3.cmml" xref="S1.F1.2.m1.3.3">plane</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.3d">\left\langle\textit{tower},\textit{to the left of},\textit{plane}\right\rangle</annotation></semantics></math>. The proposed Scene Graph Convolutional Network (SceneGCN) is capable of locating the visual relationship that is closely related to the question with interpretable attention-based rationale.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.4" class="ltx_p">However, the predominant existing solutions for VQA rely on regional features (e.g. patch-based, object-based) in image modeling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. These approaches are agnostic to the visual relational clues in images. Some recent research attempted to make VQA agents more relation-aware, for example, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. However, the representation of visual relationships used by these approaches are not sufficiently informative because of the following reasons: (1) Implicit models, such as Santoro <math id="S1.p2.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S1.p2.1.m1.1a"><mrow id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml"><mi id="S1.p2.1.m1.1.1.2" xref="S1.p2.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S1.p2.1.m1.1.1.1" xref="S1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S1.p2.1.m1.1.1.3" xref="S1.p2.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1"><times id="S1.p2.1.m1.1.1.1.cmml" xref="S1.p2.1.m1.1.1.1"></times><ci id="S1.p2.1.m1.1.1.2.cmml" xref="S1.p2.1.m1.1.1.2">𝑒</ci><ci id="S1.p2.1.m1.1.1.3.cmml" xref="S1.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">et</annotation></semantics></math> <math id="S1.p2.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S1.p2.2.m2.1a"><mrow id="S1.p2.2.m2.1.1.1" xref="S1.p2.2.m2.1.1.1.1.cmml"><mrow id="S1.p2.2.m2.1.1.1.1" xref="S1.p2.2.m2.1.1.1.1.cmml"><mi id="S1.p2.2.m2.1.1.1.1.2" xref="S1.p2.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S1.p2.2.m2.1.1.1.1.1" xref="S1.p2.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S1.p2.2.m2.1.1.1.1.3" xref="S1.p2.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S1.p2.2.m2.1.1.1.2" xref="S1.p2.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><apply id="S1.p2.2.m2.1.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1"><times id="S1.p2.2.m2.1.1.1.1.1.cmml" xref="S1.p2.2.m2.1.1.1.1.1"></times><ci id="S1.p2.2.m2.1.1.1.1.2.cmml" xref="S1.p2.2.m2.1.1.1.1.2">𝑎</ci><ci id="S1.p2.2.m2.1.1.1.1.3.cmml" xref="S1.p2.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">al.</annotation></semantics></math>’s Relation Network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and Hudson <math id="S1.p2.3.m3.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S1.p2.3.m3.1a"><mrow id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S1.p2.3.m3.1.1.1" xref="S1.p2.3.m3.1.1.1.cmml">​</mo><mi id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><times id="S1.p2.3.m3.1.1.1.cmml" xref="S1.p2.3.m3.1.1.1"></times><ci id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2">𝑒</ci><ci id="S1.p2.3.m3.1.1.3.cmml" xref="S1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">et</annotation></semantics></math> <math id="S1.p2.4.m4.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S1.p2.4.m4.1a"><mrow id="S1.p2.4.m4.1.1.1" xref="S1.p2.4.m4.1.1.1.1.cmml"><mrow id="S1.p2.4.m4.1.1.1.1" xref="S1.p2.4.m4.1.1.1.1.cmml"><mi id="S1.p2.4.m4.1.1.1.1.2" xref="S1.p2.4.m4.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S1.p2.4.m4.1.1.1.1.1" xref="S1.p2.4.m4.1.1.1.1.1.cmml">​</mo><mi id="S1.p2.4.m4.1.1.1.1.3" xref="S1.p2.4.m4.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S1.p2.4.m4.1.1.1.2" xref="S1.p2.4.m4.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.4.m4.1b"><apply id="S1.p2.4.m4.1.1.1.1.cmml" xref="S1.p2.4.m4.1.1.1"><times id="S1.p2.4.m4.1.1.1.1.1.cmml" xref="S1.p2.4.m4.1.1.1.1.1"></times><ci id="S1.p2.4.m4.1.1.1.1.2.cmml" xref="S1.p2.4.m4.1.1.1.1.2">𝑎</ci><ci id="S1.p2.4.m4.1.1.1.1.3.cmml" xref="S1.p2.4.m4.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.4.m4.1c">al.</annotation></semantics></math>’s MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, are trained without explicit relational annotations and use latent or no representation for visual relationships. These models are expected to learn relational knowledge from a indirect source of supervision — image-question-answer triples in VQA datasets. These models have limited capability of understanding rich and deep relational semantics due to the noisiness of VQA data; (2) Explicit models use explicit visual relationship representations. However, current methods either only address spatial relationships and ignore semantical relationships <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> or use no more than labels to represent semantical relationships <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Our work is inspired by advances in the area of visual relationship modeling
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, which embed visual relationships (spatial and semantical) into vector spaces and then detect, predict relationship between objects and thereby automatically construct scene graphs on images. Comprehensively-annotated visual relationships became available with the release of large-scale visual relationship benchmarks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and greatly facilitate visual relationship representation learning. These advances motivate us to introduce semantic-rich visual relationship modeling as a critical prior knowledge into visual relational reasoning for the VQA task.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this work, we try to answer two questions: (1) How to effectively represent visual relational semantics and (2) how to effectively combine and use object and relational information with a neural network. For the first question, we propose to represent images as scene graphs with each node denoting an object and each directed edge denoting a relationship between two objects. Object features in the image are extracted with an object detection network, whereas for visual relationships, we build a visual relationship encoder to yield discriminative and type-aware visual relationship embeddings constrained by both the visual context and language priors. For the second question, we propose a <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">Scene</span> <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">G</span>raph <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">C</span>onvolutional <span id="S1.p4.1.4" class="ltx_text ltx_font_italic">N</span>etwork (<span id="S1.p4.1.5" class="ltx_text ltx_font_italic">SceneGCN</span>) to reason about the visual clues for the correct answer under the guidance of the question. The SceneGCN model mainly consists of two units: the <span id="S1.p4.1.6" class="ltx_text ltx_font_italic">scene graph convolution unit</span> unit which figures the importance of the relationships according to the question and dynamically enrich object representations by its relation-essential neighborhood; and the <span id="S1.p4.1.7" class="ltx_text ltx_font_italic">question guided object attention unit</span> which further identifies the critical relation-aware objects to answer the question.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We demonstrate the model’s effectiveness, generalization, and interpretability on the challenging <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">GQA</span> dataset for compositional reasoning problems as well as the popular <span id="S1.p5.1.2" class="ltx_text ltx_font_italic">VQA2.0</span> dataset for general VQA problems. It achieves state-of-the-art 54.56% accuracy on GQA. Extensive ablation studies verifies the significance of introducing informative visual relationship priors to guide the relational reasoning process. The proposed SceneGCN model is highly interpretable. We visualize the model’s progressive reasoning process on the scene graph: first localizing the important relationships according to the question and then finding essential objects referred by the question.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Visual Question Answering</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Researchers have had different approaches to the modeling of the behavior of answering questions based on visual content. An early and typical approach fused visual and textual features for a joint representation and inferred the answer based on the fused image-question representation. Feature fusion techniques include element-wise summation/multiplication, concatenation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, bilinear pooling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and even more sophisticated fusion methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. These methods are, however, crippled by the monolithic vector representation they used for both visual and textual information which have little capability of representing fine-grained information.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Patch-based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and object-based <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> features are then introduced to represent information in finer granularity and thereby enrich the semantics in images that can be mined. VQA is then formed as retrieving visual information from a visual knowledge base (image) under the guidance of a textual query. These methods leveraged attention mechanisms to locate image regions that are relevant to the question.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.13" class="ltx_p">Recently developed methods emphasize on the reasoning aspect of visual question answering — processing and reasoning about retrieved visual information. Kim <math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><times id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1"></times><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">𝑒</ci><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">et</annotation></semantics></math> <math id="S2.SS1.p3.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS1.p3.2.m2.1a"><mrow id="S2.SS1.p3.2.m2.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.1.cmml"><mrow id="S2.SS1.p3.2.m2.1.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.1.cmml"><mi id="S2.SS1.p3.2.m2.1.1.1.1.2" xref="S2.SS1.p3.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.2.m2.1.1.1.1.1" xref="S2.SS1.p3.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.2.m2.1.1.1.1.3" xref="S2.SS1.p3.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS1.p3.2.m2.1.1.1.2" xref="S2.SS1.p3.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.1b"><apply id="S2.SS1.p3.2.m2.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1"><times id="S2.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.1"></times><ci id="S2.SS1.p3.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.2">𝑎</ci><ci id="S2.SS1.p3.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> address the multi-faceted nature of VQA by constructing a differentiable multi-task model in which a master module interpreted the question and queried submodules for different reasoning tasks such as counting objects, recognizing visual relationships, <math id="S2.SS1.p3.3.m3.1" class="ltx_Math" alttext="etc." display="inline"><semantics id="S2.SS1.p3.3.m3.1a"><mrow id="S2.SS1.p3.3.m3.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml"><mrow id="S2.SS1.p3.3.m3.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml"><mi id="S2.SS1.p3.3.m3.1.1.1.1.2" xref="S2.SS1.p3.3.m3.1.1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.3.m3.1.1.1.1.1" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.3.m3.1.1.1.1.3" xref="S2.SS1.p3.3.m3.1.1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.3.m3.1.1.1.1.1a" xref="S2.SS1.p3.3.m3.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.3.m3.1.1.1.1.4" xref="S2.SS1.p3.3.m3.1.1.1.1.4.cmml">c</mi></mrow><mo lspace="0em" id="S2.SS1.p3.3.m3.1.1.1.2" xref="S2.SS1.p3.3.m3.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><apply id="S2.SS1.p3.3.m3.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1"><times id="S2.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.1"></times><ci id="S2.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.2">𝑒</ci><ci id="S2.SS1.p3.3.m3.1.1.1.1.3.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.3">𝑡</ci><ci id="S2.SS1.p3.3.m3.1.1.1.1.4.cmml" xref="S2.SS1.p3.3.m3.1.1.1.1.4">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">etc.</annotation></semantics></math>. Hudson <math id="S2.SS1.p3.4.m4.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS1.p3.4.m4.1a"><mrow id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml"><mi id="S2.SS1.p3.4.m4.1.1.2" xref="S2.SS1.p3.4.m4.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.4.m4.1.1.1" xref="S2.SS1.p3.4.m4.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.4.m4.1.1.3" xref="S2.SS1.p3.4.m4.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.1b"><apply id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1"><times id="S2.SS1.p3.4.m4.1.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1.1"></times><ci id="S2.SS1.p3.4.m4.1.1.2.cmml" xref="S2.SS1.p3.4.m4.1.1.2">𝑒</ci><ci id="S2.SS1.p3.4.m4.1.1.3.cmml" xref="S2.SS1.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.1c">et</annotation></semantics></math> <math id="S2.SS1.p3.5.m5.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS1.p3.5.m5.1a"><mrow id="S2.SS1.p3.5.m5.1.1.1" xref="S2.SS1.p3.5.m5.1.1.1.1.cmml"><mrow id="S2.SS1.p3.5.m5.1.1.1.1" xref="S2.SS1.p3.5.m5.1.1.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.1.1.2" xref="S2.SS1.p3.5.m5.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.5.m5.1.1.1.1.1" xref="S2.SS1.p3.5.m5.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.5.m5.1.1.1.1.3" xref="S2.SS1.p3.5.m5.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS1.p3.5.m5.1.1.1.2" xref="S2.SS1.p3.5.m5.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1.1"><times id="S2.SS1.p3.5.m5.1.1.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1.1.1.1"></times><ci id="S2.SS1.p3.5.m5.1.1.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.1.1.2">𝑎</ci><ci id="S2.SS1.p3.5.m5.1.1.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and Chen <math id="S2.SS1.p3.6.m6.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS1.p3.6.m6.1a"><mrow id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml"><mi id="S2.SS1.p3.6.m6.1.1.2" xref="S2.SS1.p3.6.m6.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.6.m6.1.1.1" xref="S2.SS1.p3.6.m6.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.6.m6.1.1.3" xref="S2.SS1.p3.6.m6.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.1b"><apply id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1"><times id="S2.SS1.p3.6.m6.1.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1.1"></times><ci id="S2.SS1.p3.6.m6.1.1.2.cmml" xref="S2.SS1.p3.6.m6.1.1.2">𝑒</ci><ci id="S2.SS1.p3.6.m6.1.1.3.cmml" xref="S2.SS1.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.1c">et</annotation></semantics></math> <math id="S2.SS1.p3.7.m7.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS1.p3.7.m7.1a"><mrow id="S2.SS1.p3.7.m7.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml"><mrow id="S2.SS1.p3.7.m7.1.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml"><mi id="S2.SS1.p3.7.m7.1.1.1.1.2" xref="S2.SS1.p3.7.m7.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.7.m7.1.1.1.1.1" xref="S2.SS1.p3.7.m7.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.7.m7.1.1.1.1.3" xref="S2.SS1.p3.7.m7.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS1.p3.7.m7.1.1.1.2" xref="S2.SS1.p3.7.m7.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.7.m7.1b"><apply id="S2.SS1.p3.7.m7.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1"><times id="S2.SS1.p3.7.m7.1.1.1.1.1.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.1"></times><ci id="S2.SS1.p3.7.m7.1.1.1.1.2.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.2">𝑎</ci><ci id="S2.SS1.p3.7.m7.1.1.1.1.3.cmml" xref="S2.SS1.p3.7.m7.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.7.m7.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> built iterative reasoning models that mimic human’s step-wise reasoning process. Santoro <math id="S2.SS1.p3.8.m8.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS1.p3.8.m8.1a"><mrow id="S2.SS1.p3.8.m8.1.1" xref="S2.SS1.p3.8.m8.1.1.cmml"><mi id="S2.SS1.p3.8.m8.1.1.2" xref="S2.SS1.p3.8.m8.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.8.m8.1.1.1" xref="S2.SS1.p3.8.m8.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.8.m8.1.1.3" xref="S2.SS1.p3.8.m8.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.8.m8.1b"><apply id="S2.SS1.p3.8.m8.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1"><times id="S2.SS1.p3.8.m8.1.1.1.cmml" xref="S2.SS1.p3.8.m8.1.1.1"></times><ci id="S2.SS1.p3.8.m8.1.1.2.cmml" xref="S2.SS1.p3.8.m8.1.1.2">𝑒</ci><ci id="S2.SS1.p3.8.m8.1.1.3.cmml" xref="S2.SS1.p3.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.8.m8.1c">et</annotation></semantics></math> <math id="S2.SS1.p3.9.m9.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS1.p3.9.m9.1a"><mrow id="S2.SS1.p3.9.m9.1.1.1" xref="S2.SS1.p3.9.m9.1.1.1.1.cmml"><mrow id="S2.SS1.p3.9.m9.1.1.1.1" xref="S2.SS1.p3.9.m9.1.1.1.1.cmml"><mi id="S2.SS1.p3.9.m9.1.1.1.1.2" xref="S2.SS1.p3.9.m9.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.9.m9.1.1.1.1.1" xref="S2.SS1.p3.9.m9.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.9.m9.1.1.1.1.3" xref="S2.SS1.p3.9.m9.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS1.p3.9.m9.1.1.1.2" xref="S2.SS1.p3.9.m9.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.9.m9.1b"><apply id="S2.SS1.p3.9.m9.1.1.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1.1"><times id="S2.SS1.p3.9.m9.1.1.1.1.1.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.1"></times><ci id="S2.SS1.p3.9.m9.1.1.1.1.2.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.2">𝑎</ci><ci id="S2.SS1.p3.9.m9.1.1.1.1.3.cmml" xref="S2.SS1.p3.9.m9.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.9.m9.1c">al.</annotation></semantics></math>’s work is devoted specifically to discovering visual relationships via indirect supervision from visual questions and answers. Yi <math id="S2.SS1.p3.10.m10.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS1.p3.10.m10.1a"><mrow id="S2.SS1.p3.10.m10.1.1" xref="S2.SS1.p3.10.m10.1.1.cmml"><mi id="S2.SS1.p3.10.m10.1.1.2" xref="S2.SS1.p3.10.m10.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.10.m10.1.1.1" xref="S2.SS1.p3.10.m10.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.10.m10.1.1.3" xref="S2.SS1.p3.10.m10.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.10.m10.1b"><apply id="S2.SS1.p3.10.m10.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1"><times id="S2.SS1.p3.10.m10.1.1.1.cmml" xref="S2.SS1.p3.10.m10.1.1.1"></times><ci id="S2.SS1.p3.10.m10.1.1.2.cmml" xref="S2.SS1.p3.10.m10.1.1.2">𝑒</ci><ci id="S2.SS1.p3.10.m10.1.1.3.cmml" xref="S2.SS1.p3.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.10.m10.1c">et</annotation></semantics></math> <math id="S2.SS1.p3.11.m11.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS1.p3.11.m11.1a"><mrow id="S2.SS1.p3.11.m11.1.1.1" xref="S2.SS1.p3.11.m11.1.1.1.1.cmml"><mrow id="S2.SS1.p3.11.m11.1.1.1.1" xref="S2.SS1.p3.11.m11.1.1.1.1.cmml"><mi id="S2.SS1.p3.11.m11.1.1.1.1.2" xref="S2.SS1.p3.11.m11.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.11.m11.1.1.1.1.1" xref="S2.SS1.p3.11.m11.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.11.m11.1.1.1.1.3" xref="S2.SS1.p3.11.m11.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS1.p3.11.m11.1.1.1.2" xref="S2.SS1.p3.11.m11.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.11.m11.1b"><apply id="S2.SS1.p3.11.m11.1.1.1.1.cmml" xref="S2.SS1.p3.11.m11.1.1.1"><times id="S2.SS1.p3.11.m11.1.1.1.1.1.cmml" xref="S2.SS1.p3.11.m11.1.1.1.1.1"></times><ci id="S2.SS1.p3.11.m11.1.1.1.1.2.cmml" xref="S2.SS1.p3.11.m11.1.1.1.1.2">𝑎</ci><ci id="S2.SS1.p3.11.m11.1.1.1.1.3.cmml" xref="S2.SS1.p3.11.m11.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.11.m11.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> disentangles reasoning from representation learning by first establishing structured representations of the images and questions and then performing reasoning as symbolic program execution. Narasimhan <math id="S2.SS1.p3.12.m12.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS1.p3.12.m12.1a"><mrow id="S2.SS1.p3.12.m12.1.1" xref="S2.SS1.p3.12.m12.1.1.cmml"><mi id="S2.SS1.p3.12.m12.1.1.2" xref="S2.SS1.p3.12.m12.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.12.m12.1.1.1" xref="S2.SS1.p3.12.m12.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.12.m12.1.1.3" xref="S2.SS1.p3.12.m12.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.12.m12.1b"><apply id="S2.SS1.p3.12.m12.1.1.cmml" xref="S2.SS1.p3.12.m12.1.1"><times id="S2.SS1.p3.12.m12.1.1.1.cmml" xref="S2.SS1.p3.12.m12.1.1.1"></times><ci id="S2.SS1.p3.12.m12.1.1.2.cmml" xref="S2.SS1.p3.12.m12.1.1.2">𝑒</ci><ci id="S2.SS1.p3.12.m12.1.1.3.cmml" xref="S2.SS1.p3.12.m12.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.12.m12.1c">et</annotation></semantics></math> <math id="S2.SS1.p3.13.m13.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS1.p3.13.m13.1a"><mrow id="S2.SS1.p3.13.m13.1.1.1" xref="S2.SS1.p3.13.m13.1.1.1.1.cmml"><mrow id="S2.SS1.p3.13.m13.1.1.1.1" xref="S2.SS1.p3.13.m13.1.1.1.1.cmml"><mi id="S2.SS1.p3.13.m13.1.1.1.1.2" xref="S2.SS1.p3.13.m13.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.13.m13.1.1.1.1.1" xref="S2.SS1.p3.13.m13.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p3.13.m13.1.1.1.1.3" xref="S2.SS1.p3.13.m13.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS1.p3.13.m13.1.1.1.2" xref="S2.SS1.p3.13.m13.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.13.m13.1b"><apply id="S2.SS1.p3.13.m13.1.1.1.1.cmml" xref="S2.SS1.p3.13.m13.1.1.1"><times id="S2.SS1.p3.13.m13.1.1.1.1.1.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.1"></times><ci id="S2.SS1.p3.13.m13.1.1.1.1.2.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.2">𝑎</ci><ci id="S2.SS1.p3.13.m13.1.1.1.1.3.cmml" xref="S2.SS1.p3.13.m13.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.13.m13.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> studies visual question answering that requires both visual information in images and commonsense or expertise in knowledge-bases.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Visual Relationship Modeling</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.12" class="ltx_p">Our work is closely related to the research of visual relationship modeling, which serves as the basis of predicate prediction, visual relationship detection and automatic scene-graph construction, etc..
Lu <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mrow id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><times id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1"></times><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑒</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">et</annotation></semantics></math> <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mrow id="S2.SS2.p1.2.m2.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml"><mrow id="S2.SS2.p1.2.m2.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.2.m2.1.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.2.m2.1.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS2.p1.2.m2.1.1.1.2" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1"><times id="S2.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.1"></times><ci id="S2.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> introduced word embeddings as a linguistic prior, which were used for determining the plausibility of relationships.
Recent approaches constantly borrow ideas and techniques from the area of knowledge embedding.
Zhang <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><mrow id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m3.1.1.1" xref="S2.SS2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><times id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1.1"></times><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑒</ci><ci id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">et</annotation></semantics></math> <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><mrow id="S2.SS2.p1.4.m4.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.1.cmml"><mrow id="S2.SS2.p1.4.m4.1.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.1.1.2" xref="S2.SS2.p1.4.m4.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.4.m4.1.1.1.1.1" xref="S2.SS2.p1.4.m4.1.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.4.m4.1.1.1.1.3" xref="S2.SS2.p1.4.m4.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS2.p1.4.m4.1.1.1.2" xref="S2.SS2.p1.4.m4.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1"><times id="S2.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.1"></times><ci id="S2.SS2.p1.4.m4.1.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> devised the Visual Translation Embeddings framework which enforces its embeddings to fulfill <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="\emph{subject}+\emph{predicate}\approx\emph{object}" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><mrow id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mrow id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.5.m5.1.1.2.2" xref="S2.SS2.p1.5.m5.1.1.2.2b.cmml"><em id="S2.SS2.p1.5.m5.1.1.2.2.1nest" class="ltx_emph ltx_font_italic">subject</em></mtext><mo id="S2.SS2.p1.5.m5.1.1.2.1" xref="S2.SS2.p1.5.m5.1.1.2.1.cmml">+</mo><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.5.m5.1.1.2.3" xref="S2.SS2.p1.5.m5.1.1.2.3b.cmml"><em id="S2.SS2.p1.5.m5.1.1.2.3.1nest" class="ltx_emph ltx_font_italic">predicate</em></mtext></mrow><mo id="S2.SS2.p1.5.m5.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.cmml">≈</mo><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3b.cmml"><em id="S2.SS2.p1.5.m5.1.1.3.1nest" class="ltx_emph ltx_font_italic">object</em></mtext></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><approx id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1"></approx><apply id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2"><plus id="S2.SS2.p1.5.m5.1.1.2.1.cmml" xref="S2.SS2.p1.5.m5.1.1.2.1"></plus><ci id="S2.SS2.p1.5.m5.1.1.2.2b.cmml" xref="S2.SS2.p1.5.m5.1.1.2.2"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.5.m5.1.1.2.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2.2"><em id="S2.SS2.p1.5.m5.1.1.2.2.1anest" class="ltx_emph ltx_font_italic">subject</em></mtext></ci><ci id="S2.SS2.p1.5.m5.1.1.2.3b.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.5.m5.1.1.2.3.cmml" xref="S2.SS2.p1.5.m5.1.1.2.3"><em id="S2.SS2.p1.5.m5.1.1.2.3.1anest" class="ltx_emph ltx_font_italic">predicate</em></mtext></ci></apply><ci id="S2.SS2.p1.5.m5.1.1.3b.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3"><em id="S2.SS2.p1.5.m5.1.1.3.1anest" class="ltx_emph ltx_font_italic">object</em></mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">\emph{subject}+\emph{predicate}\approx\emph{object}</annotation></semantics></math>, a structual constraint that draws inspiration from the knowledge embedding method TransE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.
Wan <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><mrow id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.6.m6.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><times id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1"></times><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝑒</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">et</annotation></semantics></math> <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mrow id="S2.SS2.p1.7.m7.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.1.cmml"><mrow id="S2.SS2.p1.7.m7.1.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.2" xref="S2.SS2.p1.7.m7.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.7.m7.1.1.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.7.m7.1.1.1.1.3" xref="S2.SS2.p1.7.m7.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS2.p1.7.m7.1.1.1.2" xref="S2.SS2.p1.7.m7.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1"><times id="S2.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.1"></times><ci id="S2.SS2.p1.7.m7.1.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.7.m7.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> introduced a technique called <em id="S2.SS2.p1.12.1" class="ltx_emph ltx_font_italic">hierarchical projection</em> to instantiate the conceptual embeddings (embeddings of categories rather than instances) with visual information. The instantiated embeddings are trained to fulfill <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="\emph{subject}_{\bot}+\emph{predicate}_{\bot}\approx\emph{object}_{\bot}" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><mrow id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml"><mrow id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml"><msub id="S2.SS2.p1.8.m8.1.1.2.2" xref="S2.SS2.p1.8.m8.1.1.2.2.cmml"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m8.1.1.2.2.2" xref="S2.SS2.p1.8.m8.1.1.2.2.2b.cmml"><em id="S2.SS2.p1.8.m8.1.1.2.2.2.1nest" class="ltx_emph ltx_font_italic">subject</em></mtext><mo id="S2.SS2.p1.8.m8.1.1.2.2.3" xref="S2.SS2.p1.8.m8.1.1.2.2.3.cmml">⊥</mo></msub><mo id="S2.SS2.p1.8.m8.1.1.2.1" xref="S2.SS2.p1.8.m8.1.1.2.1.cmml">+</mo><msub id="S2.SS2.p1.8.m8.1.1.2.3" xref="S2.SS2.p1.8.m8.1.1.2.3.cmml"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m8.1.1.2.3.2" xref="S2.SS2.p1.8.m8.1.1.2.3.2b.cmml"><em id="S2.SS2.p1.8.m8.1.1.2.3.2.1nest" class="ltx_emph ltx_font_italic">predicate</em></mtext><mo id="S2.SS2.p1.8.m8.1.1.2.3.3" xref="S2.SS2.p1.8.m8.1.1.2.3.3.cmml">⊥</mo></msub></mrow><mo id="S2.SS2.p1.8.m8.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.cmml">≈</mo><msub id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m8.1.1.3.2" xref="S2.SS2.p1.8.m8.1.1.3.2b.cmml"><em id="S2.SS2.p1.8.m8.1.1.3.2.1nest" class="ltx_emph ltx_font_italic">object</em></mtext><mo id="S2.SS2.p1.8.m8.1.1.3.3" xref="S2.SS2.p1.8.m8.1.1.3.3.cmml">⊥</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1"><approx id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1"></approx><apply id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2"><plus id="S2.SS2.p1.8.m8.1.1.2.1.cmml" xref="S2.SS2.p1.8.m8.1.1.2.1"></plus><apply id="S2.SS2.p1.8.m8.1.1.2.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.2.2.1.cmml" xref="S2.SS2.p1.8.m8.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.2.2.2b.cmml" xref="S2.SS2.p1.8.m8.1.1.2.2.2"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m8.1.1.2.2.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2.2.2"><em id="S2.SS2.p1.8.m8.1.1.2.2.2.1anest" class="ltx_emph ltx_font_italic">subject</em></mtext></ci><csymbol cd="latexml" id="S2.SS2.p1.8.m8.1.1.2.2.3.cmml" xref="S2.SS2.p1.8.m8.1.1.2.2.3">bottom</csymbol></apply><apply id="S2.SS2.p1.8.m8.1.1.2.3.cmml" xref="S2.SS2.p1.8.m8.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.2.3.1.cmml" xref="S2.SS2.p1.8.m8.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.2.3.2b.cmml" xref="S2.SS2.p1.8.m8.1.1.2.3.2"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m8.1.1.2.3.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2.3.2"><em id="S2.SS2.p1.8.m8.1.1.2.3.2.1anest" class="ltx_emph ltx_font_italic">predicate</em></mtext></ci><csymbol cd="latexml" id="S2.SS2.p1.8.m8.1.1.2.3.3.cmml" xref="S2.SS2.p1.8.m8.1.1.2.3.3">bottom</csymbol></apply></apply><apply id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.1.3.1.cmml" xref="S2.SS2.p1.8.m8.1.1.3">subscript</csymbol><ci id="S2.SS2.p1.8.m8.1.1.3.2b.cmml" xref="S2.SS2.p1.8.m8.1.1.3.2"><mtext class="ltx_mathvariant_italic" id="S2.SS2.p1.8.m8.1.1.3.2.cmml" xref="S2.SS2.p1.8.m8.1.1.3.2"><em id="S2.SS2.p1.8.m8.1.1.3.2.1anest" class="ltx_emph ltx_font_italic">object</em></mtext></ci><csymbol cd="latexml" id="S2.SS2.p1.8.m8.1.1.3.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3.3">bottom</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">\emph{subject}_{\bot}+\emph{predicate}_{\bot}\approx\emph{object}_{\bot}</annotation></semantics></math>. This work may be interpreted as the visual counterpart of TransD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
Zellers <math id="S2.SS2.p1.9.m9.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS2.p1.9.m9.1a"><mrow id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml"><mi id="S2.SS2.p1.9.m9.1.1.2" xref="S2.SS2.p1.9.m9.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.9.m9.1.1.1" xref="S2.SS2.p1.9.m9.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.9.m9.1.1.3" xref="S2.SS2.p1.9.m9.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><apply id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1"><times id="S2.SS2.p1.9.m9.1.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1.1"></times><ci id="S2.SS2.p1.9.m9.1.1.2.cmml" xref="S2.SS2.p1.9.m9.1.1.2">𝑒</ci><ci id="S2.SS2.p1.9.m9.1.1.3.cmml" xref="S2.SS2.p1.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">et</annotation></semantics></math> <math id="S2.SS2.p1.10.m10.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS2.p1.10.m10.1a"><mrow id="S2.SS2.p1.10.m10.1.1.1" xref="S2.SS2.p1.10.m10.1.1.1.1.cmml"><mrow id="S2.SS2.p1.10.m10.1.1.1.1" xref="S2.SS2.p1.10.m10.1.1.1.1.cmml"><mi id="S2.SS2.p1.10.m10.1.1.1.1.2" xref="S2.SS2.p1.10.m10.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.10.m10.1.1.1.1.1" xref="S2.SS2.p1.10.m10.1.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.10.m10.1.1.1.1.3" xref="S2.SS2.p1.10.m10.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS2.p1.10.m10.1.1.1.2" xref="S2.SS2.p1.10.m10.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><apply id="S2.SS2.p1.10.m10.1.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1.1"><times id="S2.SS2.p1.10.m10.1.1.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1.1"></times><ci id="S2.SS2.p1.10.m10.1.1.1.1.2.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.10.m10.1.1.1.1.3.cmml" xref="S2.SS2.p1.10.m10.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">al.</annotation></semantics></math>proposed the MotifNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> which mines information from motifs — regularly appearing substructures in scene graphs. Zhang <math id="S2.SS2.p1.11.m11.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS2.p1.11.m11.1a"><mrow id="S2.SS2.p1.11.m11.1.1" xref="S2.SS2.p1.11.m11.1.1.cmml"><mi id="S2.SS2.p1.11.m11.1.1.2" xref="S2.SS2.p1.11.m11.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.11.m11.1.1.1" xref="S2.SS2.p1.11.m11.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.11.m11.1.1.3" xref="S2.SS2.p1.11.m11.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.1b"><apply id="S2.SS2.p1.11.m11.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1"><times id="S2.SS2.p1.11.m11.1.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1.1"></times><ci id="S2.SS2.p1.11.m11.1.1.2.cmml" xref="S2.SS2.p1.11.m11.1.1.2">𝑒</ci><ci id="S2.SS2.p1.11.m11.1.1.3.cmml" xref="S2.SS2.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.1c">et</annotation></semantics></math> <math id="S2.SS2.p1.12.m12.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS2.p1.12.m12.1a"><mrow id="S2.SS2.p1.12.m12.1.1.1" xref="S2.SS2.p1.12.m12.1.1.1.1.cmml"><mrow id="S2.SS2.p1.12.m12.1.1.1.1" xref="S2.SS2.p1.12.m12.1.1.1.1.cmml"><mi id="S2.SS2.p1.12.m12.1.1.1.1.2" xref="S2.SS2.p1.12.m12.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.12.m12.1.1.1.1.1" xref="S2.SS2.p1.12.m12.1.1.1.1.1.cmml">​</mo><mi id="S2.SS2.p1.12.m12.1.1.1.1.3" xref="S2.SS2.p1.12.m12.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS2.p1.12.m12.1.1.1.2" xref="S2.SS2.p1.12.m12.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m12.1b"><apply id="S2.SS2.p1.12.m12.1.1.1.1.cmml" xref="S2.SS2.p1.12.m12.1.1.1"><times id="S2.SS2.p1.12.m12.1.1.1.1.1.cmml" xref="S2.SS2.p1.12.m12.1.1.1.1.1"></times><ci id="S2.SS2.p1.12.m12.1.1.1.1.2.cmml" xref="S2.SS2.p1.12.m12.1.1.1.1.2">𝑎</ci><ci id="S2.SS2.p1.12.m12.1.1.1.1.3.cmml" xref="S2.SS2.p1.12.m12.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m12.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> introduces language based and embedding based supervision to cope with the long-tailed distribution of training data, which used to undermine the quality of label-based supervision. Our model builds upon the visual relationship representation inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and studies how it can be used for VQA reasoning.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.5.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.6.2" class="ltx_text ltx_font_italic">Graph Neural Networks</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">Graph Neural Networks (GNNs) extract features from topological graphs through operations in the vertice domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> or the spectral domain <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. We focus on vertice-based methods since scene graphs are dynamically constructed, whereas specture-based methods operate only on static graphs.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.8" class="ltx_p">Typical vertice-domain graph convolution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> on a single node takes the form of a summation over a set of states of neighbor nodes:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.4" class="ltx_Math" alttext="\textbf{h}_{i}^{(l+1)}=\sigma(\sum_{j\in S_{i}}{\textbf{W}^{(l)}\textbf{h}_{j}^{(l)})}" display="block"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><msubsup id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.4.4.3.2.2" xref="S2.E1.m1.4.4.3.2.2a.cmml">h</mtext><mi id="S2.E1.m1.4.4.3.2.3" xref="S2.E1.m1.4.4.3.2.3.cmml">i</mi><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml">=</mo><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.cmml"><mi id="S2.E1.m1.4.4.1.3" xref="S2.E1.m1.4.4.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.cmml"><munder id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S2.E1.m1.4.4.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.2.cmml">∑</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.3.2.cmml">j</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S2.E1.m1.4.4.1.1.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.3.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3.2.cmml">S</mi><mi id="S2.E1.m1.4.4.1.1.1.1.1.3.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S2.E1.m1.4.4.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml"><msup id="S2.E1.m1.4.4.1.1.1.1.2.2" xref="S2.E1.m1.4.4.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.4.4.1.1.1.1.2.2.2" xref="S2.E1.m1.4.4.1.1.1.1.2.2.2a.cmml">W</mtext><mrow id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.4.4.1.1.1.1.2.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.2.2.cmml">(</mo><mi id="S2.E1.m1.2.2.1.1" xref="S2.E1.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S2.E1.m1.2.2.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.2.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.1.1.1.1.2.1" xref="S2.E1.m1.4.4.1.1.1.1.2.1.cmml">​</mo><msubsup id="S2.E1.m1.4.4.1.1.1.1.2.3" xref="S2.E1.m1.4.4.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.4.4.1.1.1.1.2.3.2.2" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2.2a.cmml">h</mtext><mi id="S2.E1.m1.4.4.1.1.1.1.2.3.2.3" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2.3.cmml">j</mi><mrow id="S2.E1.m1.3.3.1.3" xref="S2.E1.m1.4.4.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.2.3.cmml">(</mo><mi id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml">l</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><eq id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"></eq><apply id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.1.cmml" xref="S2.E1.m1.4.4.3">superscript</csymbol><apply id="S2.E1.m1.4.4.3.2.cmml" xref="S2.E1.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.2.1.cmml" xref="S2.E1.m1.4.4.3">subscript</csymbol><ci id="S2.E1.m1.4.4.3.2.2a.cmml" xref="S2.E1.m1.4.4.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.4.4.3.2.2.cmml" xref="S2.E1.m1.4.4.3.2.2">h</mtext></ci><ci id="S2.E1.m1.4.4.3.2.3.cmml" xref="S2.E1.m1.4.4.3.2.3">𝑖</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><plus id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"></plus><ci id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E1.m1.4.4.1.cmml" xref="S2.E1.m1.4.4.1"><times id="S2.E1.m1.4.4.1.2.cmml" xref="S2.E1.m1.4.4.1.2"></times><ci id="S2.E1.m1.4.4.1.3.cmml" xref="S2.E1.m1.4.4.1.3">𝜎</ci><apply id="S2.E1.m1.4.4.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><apply id="S2.E1.m1.4.4.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1">subscript</csymbol><sum id="S2.E1.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.2"></sum><apply id="S2.E1.m1.4.4.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3"><in id="S2.E1.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.1"></in><ci id="S2.E1.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.2">𝑗</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3.2">𝑆</ci><ci id="S2.E1.m1.4.4.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S2.E1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2"><times id="S2.E1.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.1"></times><apply id="S2.E1.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.2">superscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.2.2.2a.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.2.2">W</mtext></ci><ci id="S2.E1.m1.2.2.1.1.cmml" xref="S2.E1.m1.2.2.1.1">𝑙</ci></apply><apply id="S2.E1.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E1.m1.4.4.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.2.3.2.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.2.3.2.2a.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E1.m1.4.4.1.1.1.1.2.3.2.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2.2">h</mtext></ci><ci id="S2.E1.m1.4.4.1.1.1.1.2.3.2.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.2.3.2.3">𝑗</ci></apply><ci id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\textbf{h}_{i}^{(l+1)}=\sigma(\sum_{j\in S_{i}}{\textbf{W}^{(l)}\textbf{h}_{j}^{(l)})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p2.7" class="ltx_p">where <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="\textbf{h}_{i}^{(l)}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><msubsup id="S2.SS3.p2.1.m1.1.2" xref="S2.SS3.p2.1.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p2.1.m1.1.2.2.2" xref="S2.SS3.p2.1.m1.1.2.2.2a.cmml">h</mtext><mi id="S2.SS3.p2.1.m1.1.2.2.3" xref="S2.SS3.p2.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.SS3.p2.1.m1.1.1.1.3" xref="S2.SS3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.3.1" xref="S2.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S2.SS3.p2.1.m1.1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.SS3.p2.1.m1.1.1.1.3.2" xref="S2.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.2.1.cmml" xref="S2.SS3.p2.1.m1.1.2">superscript</csymbol><apply id="S2.SS3.p2.1.m1.1.2.2.cmml" xref="S2.SS3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.2.2.1.cmml" xref="S2.SS3.p2.1.m1.1.2">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.2.2.2a.cmml" xref="S2.SS3.p2.1.m1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p2.1.m1.1.2.2.2.cmml" xref="S2.SS3.p2.1.m1.1.2.2.2">h</mtext></ci><ci id="S2.SS3.p2.1.m1.1.2.2.3.cmml" xref="S2.SS3.p2.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS3.p2.1.m1.1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\textbf{h}_{i}^{(l)}</annotation></semantics></math> denote the hidden state of node <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><msub id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">v</mi><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑣</ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">v_{i}</annotation></semantics></math> at the <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="l^{th}" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><msup id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">l</mi><mrow id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml"><mi id="S2.SS3.p2.3.m3.1.1.3.2" xref="S2.SS3.p2.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.3.m3.1.1.3.1" xref="S2.SS3.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p2.3.m3.1.1.3.3" xref="S2.SS3.p2.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝑙</ci><apply id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3"><times id="S2.SS3.p2.3.m3.1.1.3.1.cmml" xref="S2.SS3.p2.3.m3.1.1.3.1"></times><ci id="S2.SS3.p2.3.m3.1.1.3.2.cmml" xref="S2.SS3.p2.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS3.p2.3.m3.1.1.3.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">l^{th}</annotation></semantics></math>layer, <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><msub id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2" xref="S2.SS3.p2.4.m4.1.1.2.cmml">S</mi><mi id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2">𝑆</ci><ci id="S2.SS3.p2.4.m4.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">S_{i}</annotation></semantics></math> is a set of nodes that are connected to node <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><msub id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml"><mi id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml">v</mi><mi id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2">𝑣</ci><ci id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">v_{i}</annotation></semantics></math> and <math id="S2.SS3.p2.6.m6.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S2.SS3.p2.6.m6.1a"><mi id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b"><ci id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">\sigma</annotation></semantics></math> denote a element-wise activation function such as the <span id="S2.SS3.p2.7.1" class="ltx_text ltx_markedasmath ltx_font_italic">ReLU</span>. This type of transformation has been shown to be very effective at accumulating and encoding features from local, structured neighborhoods, and has led to significant improvements in areas such as graph classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.2" class="ltx_p">Introducing edge information into graph processing is an important problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. A number of methods represent edges with labels. Gilmer <math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><mrow id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.1.1.2" xref="S2.SS3.p3.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.1.m1.1.1.1" xref="S2.SS3.p3.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS3.p3.1.m1.1.1.3" xref="S2.SS3.p3.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><apply id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1"><times id="S2.SS3.p3.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1.1"></times><ci id="S2.SS3.p3.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.1.1.2">𝑒</ci><ci id="S2.SS3.p3.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">et</annotation></semantics></math> <math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><mrow id="S2.SS3.p3.2.m2.1.1.1" xref="S2.SS3.p3.2.m2.1.1.1.1.cmml"><mrow id="S2.SS3.p3.2.m2.1.1.1.1" xref="S2.SS3.p3.2.m2.1.1.1.1.cmml"><mi id="S2.SS3.p3.2.m2.1.1.1.1.2" xref="S2.SS3.p3.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.2.m2.1.1.1.1.1" xref="S2.SS3.p3.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S2.SS3.p3.2.m2.1.1.1.1.3" xref="S2.SS3.p3.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS3.p3.2.m2.1.1.1.2" xref="S2.SS3.p3.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><apply id="S2.SS3.p3.2.m2.1.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1.1"><times id="S2.SS3.p3.2.m2.1.1.1.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1.1.1.1"></times><ci id="S2.SS3.p3.2.m2.1.1.1.1.2.cmml" xref="S2.SS3.p3.2.m2.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p3.2.m2.1.1.1.1.3.cmml" xref="S2.SS3.p3.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> proposed the following equation for updating node hidden states:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.4" class="ltx_Math" alttext="\textbf{h}_{i}^{(l+1)}=\sigma(\sum_{j\in S_{i}}{f_{r}(\textbf{h}_{i}^{(l)},\textbf{h}_{j}^{(l)}))}" display="block"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><msubsup id="S2.E2.m1.4.4.3" xref="S2.E2.m1.4.4.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.4.4.3.2.2" xref="S2.E2.m1.4.4.3.2.2a.cmml">h</mtext><mi id="S2.E2.m1.4.4.3.2.3" xref="S2.E2.m1.4.4.3.2.3.cmml">i</mi><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.4.4.2" xref="S2.E2.m1.4.4.2.cmml">=</mo><mrow id="S2.E2.m1.4.4.1" xref="S2.E2.m1.4.4.1.cmml"><mi id="S2.E2.m1.4.4.1.3" xref="S2.E2.m1.4.4.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.2" xref="S2.E2.m1.4.4.1.2.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.cmml"><munder id="S2.E2.m1.4.4.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.3.cmml"><mo lspace="0em" movablelimits="false" id="S2.E2.m1.4.4.1.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.1.1.3.2.cmml">∑</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.3.3" xref="S2.E2.m1.4.4.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.3.3.2" xref="S2.E2.m1.4.4.1.1.1.1.3.3.2.cmml">j</mi><mo id="S2.E2.m1.4.4.1.1.1.1.3.3.1" xref="S2.E2.m1.4.4.1.1.1.1.3.3.1.cmml">∈</mo><msub id="S2.E2.m1.4.4.1.1.1.1.3.3.3" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.3.3.3.2" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3.2.cmml">S</mi><mi id="S2.E2.m1.4.4.1.1.1.1.3.3.3.3" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S2.E2.m1.4.4.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.2.cmml"><msub id="S2.E2.m1.4.4.1.1.1.1.2.4" xref="S2.E2.m1.4.4.1.1.1.1.2.4.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.2.4.2" xref="S2.E2.m1.4.4.1.1.1.1.2.4.2.cmml">f</mi><mi id="S2.E2.m1.4.4.1.1.1.1.2.4.3" xref="S2.E2.m1.4.4.1.1.1.1.2.4.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.1.1.1.2.3" xref="S2.E2.m1.4.4.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.2.2.2.3" xref="S2.E2.m1.4.4.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.2a.cmml">h</mtext><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.E2.m1.2.2.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.3.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml">l</mi><mo stretchy="false" id="S2.E2.m1.2.2.1.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E2.m1.4.4.1.1.1.1.2.2.2.4" xref="S2.E2.m1.4.4.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.2a.cmml">h</mtext><mi id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.3" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml">j</mi><mrow id="S2.E2.m1.3.3.1.3" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.1.3.1" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">l</mi><mo stretchy="false" id="S2.E2.m1.3.3.1.3.2" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.2.2.2.5" xref="S2.E2.m1.4.4.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><eq id="S2.E2.m1.4.4.2.cmml" xref="S2.E2.m1.4.4.2"></eq><apply id="S2.E2.m1.4.4.3.cmml" xref="S2.E2.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.3.1.cmml" xref="S2.E2.m1.4.4.3">superscript</csymbol><apply id="S2.E2.m1.4.4.3.2.cmml" xref="S2.E2.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.3.2.1.cmml" xref="S2.E2.m1.4.4.3">subscript</csymbol><ci id="S2.E2.m1.4.4.3.2.2a.cmml" xref="S2.E2.m1.4.4.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.4.4.3.2.2.cmml" xref="S2.E2.m1.4.4.3.2.2">h</mtext></ci><ci id="S2.E2.m1.4.4.3.2.3.cmml" xref="S2.E2.m1.4.4.3.2.3">𝑖</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><plus id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"></plus><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E2.m1.4.4.1.cmml" xref="S2.E2.m1.4.4.1"><times id="S2.E2.m1.4.4.1.2.cmml" xref="S2.E2.m1.4.4.1.2"></times><ci id="S2.E2.m1.4.4.1.3.cmml" xref="S2.E2.m1.4.4.1.3">𝜎</ci><apply id="S2.E2.m1.4.4.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1"><apply id="S2.E2.m1.4.4.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3">subscript</csymbol><sum id="S2.E2.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.2"></sum><apply id="S2.E2.m1.4.4.1.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3"><in id="S2.E2.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.1"></in><ci id="S2.E2.m1.4.4.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.2">𝑗</ci><apply id="S2.E2.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3.2">𝑆</ci><ci id="S2.E2.m1.4.4.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S2.E2.m1.4.4.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2"><times id="S2.E2.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.3"></times><apply id="S2.E2.m1.4.4.1.1.1.1.2.4.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.2.4.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.2.4.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.4.2">𝑓</ci><ci id="S2.E2.m1.4.4.1.1.1.1.2.4.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.4.3">𝑟</ci></apply><interval closure="open" id="S2.E2.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2"><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.2">h</mtext></ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1">𝑙</ci></apply><apply id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.2a.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.2">h</mtext></ci><ci id="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.2.2.2.2.2.3">𝑗</ci></apply><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝑙</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">\textbf{h}_{i}^{(l+1)}=\sigma(\sum_{j\in S_{i}}{f_{r}(\textbf{h}_{i}^{(l)},\textbf{h}_{j}^{(l)}))}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p3.17" class="ltx_p">where <math id="S2.SS3.p3.3.m1.1" class="ltx_Math" alttext="\textbf{h}_{i}^{(l)}" display="inline"><semantics id="S2.SS3.p3.3.m1.1a"><msubsup id="S2.SS3.p3.3.m1.1.2" xref="S2.SS3.p3.3.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p3.3.m1.1.2.2.2" xref="S2.SS3.p3.3.m1.1.2.2.2a.cmml">h</mtext><mi id="S2.SS3.p3.3.m1.1.2.2.3" xref="S2.SS3.p3.3.m1.1.2.2.3.cmml">i</mi><mrow id="S2.SS3.p3.3.m1.1.1.1.3" xref="S2.SS3.p3.3.m1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p3.3.m1.1.1.1.3.1" xref="S2.SS3.p3.3.m1.1.2.cmml">(</mo><mi id="S2.SS3.p3.3.m1.1.1.1.1" xref="S2.SS3.p3.3.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.SS3.p3.3.m1.1.1.1.3.2" xref="S2.SS3.p3.3.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m1.1b"><apply id="S2.SS3.p3.3.m1.1.2.cmml" xref="S2.SS3.p3.3.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m1.1.2.1.cmml" xref="S2.SS3.p3.3.m1.1.2">superscript</csymbol><apply id="S2.SS3.p3.3.m1.1.2.2.cmml" xref="S2.SS3.p3.3.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m1.1.2.2.1.cmml" xref="S2.SS3.p3.3.m1.1.2">subscript</csymbol><ci id="S2.SS3.p3.3.m1.1.2.2.2a.cmml" xref="S2.SS3.p3.3.m1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p3.3.m1.1.2.2.2.cmml" xref="S2.SS3.p3.3.m1.1.2.2.2">h</mtext></ci><ci id="S2.SS3.p3.3.m1.1.2.2.3.cmml" xref="S2.SS3.p3.3.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.SS3.p3.3.m1.1.1.1.1.cmml" xref="S2.SS3.p3.3.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m1.1c">\textbf{h}_{i}^{(l)}</annotation></semantics></math> denote the hidden state of node <math id="S2.SS3.p3.4.m2.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S2.SS3.p3.4.m2.1a"><msub id="S2.SS3.p3.4.m2.1.1" xref="S2.SS3.p3.4.m2.1.1.cmml"><mi id="S2.SS3.p3.4.m2.1.1.2" xref="S2.SS3.p3.4.m2.1.1.2.cmml">v</mi><mi id="S2.SS3.p3.4.m2.1.1.3" xref="S2.SS3.p3.4.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m2.1b"><apply id="S2.SS3.p3.4.m2.1.1.cmml" xref="S2.SS3.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m2.1.1.1.cmml" xref="S2.SS3.p3.4.m2.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m2.1.1.2.cmml" xref="S2.SS3.p3.4.m2.1.1.2">𝑣</ci><ci id="S2.SS3.p3.4.m2.1.1.3.cmml" xref="S2.SS3.p3.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m2.1c">v_{i}</annotation></semantics></math> at the <math id="S2.SS3.p3.5.m3.1" class="ltx_Math" alttext="l^{th}" display="inline"><semantics id="S2.SS3.p3.5.m3.1a"><msup id="S2.SS3.p3.5.m3.1.1" xref="S2.SS3.p3.5.m3.1.1.cmml"><mi id="S2.SS3.p3.5.m3.1.1.2" xref="S2.SS3.p3.5.m3.1.1.2.cmml">l</mi><mrow id="S2.SS3.p3.5.m3.1.1.3" xref="S2.SS3.p3.5.m3.1.1.3.cmml"><mi id="S2.SS3.p3.5.m3.1.1.3.2" xref="S2.SS3.p3.5.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.5.m3.1.1.3.1" xref="S2.SS3.p3.5.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p3.5.m3.1.1.3.3" xref="S2.SS3.p3.5.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m3.1b"><apply id="S2.SS3.p3.5.m3.1.1.cmml" xref="S2.SS3.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.5.m3.1.1.1.cmml" xref="S2.SS3.p3.5.m3.1.1">superscript</csymbol><ci id="S2.SS3.p3.5.m3.1.1.2.cmml" xref="S2.SS3.p3.5.m3.1.1.2">𝑙</ci><apply id="S2.SS3.p3.5.m3.1.1.3.cmml" xref="S2.SS3.p3.5.m3.1.1.3"><times id="S2.SS3.p3.5.m3.1.1.3.1.cmml" xref="S2.SS3.p3.5.m3.1.1.3.1"></times><ci id="S2.SS3.p3.5.m3.1.1.3.2.cmml" xref="S2.SS3.p3.5.m3.1.1.3.2">𝑡</ci><ci id="S2.SS3.p3.5.m3.1.1.3.3.cmml" xref="S2.SS3.p3.5.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m3.1c">l^{th}</annotation></semantics></math>layer, <math id="S2.SS3.p3.6.m4.1" class="ltx_Math" alttext="S_{i}" display="inline"><semantics id="S2.SS3.p3.6.m4.1a"><msub id="S2.SS3.p3.6.m4.1.1" xref="S2.SS3.p3.6.m4.1.1.cmml"><mi id="S2.SS3.p3.6.m4.1.1.2" xref="S2.SS3.p3.6.m4.1.1.2.cmml">S</mi><mi id="S2.SS3.p3.6.m4.1.1.3" xref="S2.SS3.p3.6.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m4.1b"><apply id="S2.SS3.p3.6.m4.1.1.cmml" xref="S2.SS3.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.6.m4.1.1.1.cmml" xref="S2.SS3.p3.6.m4.1.1">subscript</csymbol><ci id="S2.SS3.p3.6.m4.1.1.2.cmml" xref="S2.SS3.p3.6.m4.1.1.2">𝑆</ci><ci id="S2.SS3.p3.6.m4.1.1.3.cmml" xref="S2.SS3.p3.6.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m4.1c">S_{i}</annotation></semantics></math> is a set of nodes that are connected to node <math id="S2.SS3.p3.7.m5.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S2.SS3.p3.7.m5.1a"><msub id="S2.SS3.p3.7.m5.1.1" xref="S2.SS3.p3.7.m5.1.1.cmml"><mi id="S2.SS3.p3.7.m5.1.1.2" xref="S2.SS3.p3.7.m5.1.1.2.cmml">v</mi><mi id="S2.SS3.p3.7.m5.1.1.3" xref="S2.SS3.p3.7.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m5.1b"><apply id="S2.SS3.p3.7.m5.1.1.cmml" xref="S2.SS3.p3.7.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m5.1.1.1.cmml" xref="S2.SS3.p3.7.m5.1.1">subscript</csymbol><ci id="S2.SS3.p3.7.m5.1.1.2.cmml" xref="S2.SS3.p3.7.m5.1.1.2">𝑣</ci><ci id="S2.SS3.p3.7.m5.1.1.3.cmml" xref="S2.SS3.p3.7.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m5.1c">v_{i}</annotation></semantics></math> and <math id="S2.SS3.p3.8.m6.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S2.SS3.p3.8.m6.1a"><mi id="S2.SS3.p3.8.m6.1.1" xref="S2.SS3.p3.8.m6.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m6.1b"><ci id="S2.SS3.p3.8.m6.1.1.cmml" xref="S2.SS3.p3.8.m6.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m6.1c">\sigma</annotation></semantics></math> denote a element-wise activation function such as the <span id="S2.SS3.p3.17.1" class="ltx_text ltx_markedasmath ltx_font_italic">ReLU</span>. <math id="S2.SS3.p3.10.m8.2" class="ltx_Math" alttext="f_{r}(\cdot,\cdot)" display="inline"><semantics id="S2.SS3.p3.10.m8.2a"><mrow id="S2.SS3.p3.10.m8.2.3" xref="S2.SS3.p3.10.m8.2.3.cmml"><msub id="S2.SS3.p3.10.m8.2.3.2" xref="S2.SS3.p3.10.m8.2.3.2.cmml"><mi id="S2.SS3.p3.10.m8.2.3.2.2" xref="S2.SS3.p3.10.m8.2.3.2.2.cmml">f</mi><mi id="S2.SS3.p3.10.m8.2.3.2.3" xref="S2.SS3.p3.10.m8.2.3.2.3.cmml">r</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p3.10.m8.2.3.1" xref="S2.SS3.p3.10.m8.2.3.1.cmml">​</mo><mrow id="S2.SS3.p3.10.m8.2.3.3.2" xref="S2.SS3.p3.10.m8.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS3.p3.10.m8.2.3.3.2.1" xref="S2.SS3.p3.10.m8.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p3.10.m8.1.1" xref="S2.SS3.p3.10.m8.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS3.p3.10.m8.2.3.3.2.2" xref="S2.SS3.p3.10.m8.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p3.10.m8.2.2" xref="S2.SS3.p3.10.m8.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS3.p3.10.m8.2.3.3.2.3" xref="S2.SS3.p3.10.m8.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m8.2b"><apply id="S2.SS3.p3.10.m8.2.3.cmml" xref="S2.SS3.p3.10.m8.2.3"><times id="S2.SS3.p3.10.m8.2.3.1.cmml" xref="S2.SS3.p3.10.m8.2.3.1"></times><apply id="S2.SS3.p3.10.m8.2.3.2.cmml" xref="S2.SS3.p3.10.m8.2.3.2"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m8.2.3.2.1.cmml" xref="S2.SS3.p3.10.m8.2.3.2">subscript</csymbol><ci id="S2.SS3.p3.10.m8.2.3.2.2.cmml" xref="S2.SS3.p3.10.m8.2.3.2.2">𝑓</ci><ci id="S2.SS3.p3.10.m8.2.3.2.3.cmml" xref="S2.SS3.p3.10.m8.2.3.2.3">𝑟</ci></apply><interval closure="open" id="S2.SS3.p3.10.m8.2.3.3.1.cmml" xref="S2.SS3.p3.10.m8.2.3.3.2"><ci id="S2.SS3.p3.10.m8.1.1.cmml" xref="S2.SS3.p3.10.m8.1.1">⋅</ci><ci id="S2.SS3.p3.10.m8.2.2.cmml" xref="S2.SS3.p3.10.m8.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m8.2c">f_{r}(\cdot,\cdot)</annotation></semantics></math> is a function that reacts to <math id="S2.SS3.p3.11.m9.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS3.p3.11.m9.1a"><mi id="S2.SS3.p3.11.m9.1.1" xref="S2.SS3.p3.11.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.11.m9.1b"><ci id="S2.SS3.p3.11.m9.1.1.cmml" xref="S2.SS3.p3.11.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.11.m9.1c">r</annotation></semantics></math>, the label of relationship between node <math id="S2.SS3.p3.12.m10.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S2.SS3.p3.12.m10.1a"><msub id="S2.SS3.p3.12.m10.1.1" xref="S2.SS3.p3.12.m10.1.1.cmml"><mi id="S2.SS3.p3.12.m10.1.1.2" xref="S2.SS3.p3.12.m10.1.1.2.cmml">v</mi><mi id="S2.SS3.p3.12.m10.1.1.3" xref="S2.SS3.p3.12.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.12.m10.1b"><apply id="S2.SS3.p3.12.m10.1.1.cmml" xref="S2.SS3.p3.12.m10.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.12.m10.1.1.1.cmml" xref="S2.SS3.p3.12.m10.1.1">subscript</csymbol><ci id="S2.SS3.p3.12.m10.1.1.2.cmml" xref="S2.SS3.p3.12.m10.1.1.2">𝑣</ci><ci id="S2.SS3.p3.12.m10.1.1.3.cmml" xref="S2.SS3.p3.12.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.12.m10.1c">v_{i}</annotation></semantics></math> and <math id="S2.SS3.p3.13.m11.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S2.SS3.p3.13.m11.1a"><msub id="S2.SS3.p3.13.m11.1.1" xref="S2.SS3.p3.13.m11.1.1.cmml"><mi id="S2.SS3.p3.13.m11.1.1.2" xref="S2.SS3.p3.13.m11.1.1.2.cmml">v</mi><mi id="S2.SS3.p3.13.m11.1.1.3" xref="S2.SS3.p3.13.m11.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.13.m11.1b"><apply id="S2.SS3.p3.13.m11.1.1.cmml" xref="S2.SS3.p3.13.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.13.m11.1.1.1.cmml" xref="S2.SS3.p3.13.m11.1.1">subscript</csymbol><ci id="S2.SS3.p3.13.m11.1.1.2.cmml" xref="S2.SS3.p3.13.m11.1.1.2">𝑣</ci><ci id="S2.SS3.p3.13.m11.1.1.3.cmml" xref="S2.SS3.p3.13.m11.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.13.m11.1c">v_{j}</annotation></semantics></math>. The type of each instance of relationship is to be determined by pre-existing information or by a relation detector. <math id="S2.SS3.p3.14.m12.2" class="ltx_Math" alttext="f(\cdot,\cdot)" display="inline"><semantics id="S2.SS3.p3.14.m12.2a"><mrow id="S2.SS3.p3.14.m12.2.3" xref="S2.SS3.p3.14.m12.2.3.cmml"><mi id="S2.SS3.p3.14.m12.2.3.2" xref="S2.SS3.p3.14.m12.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.14.m12.2.3.1" xref="S2.SS3.p3.14.m12.2.3.1.cmml">​</mo><mrow id="S2.SS3.p3.14.m12.2.3.3.2" xref="S2.SS3.p3.14.m12.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS3.p3.14.m12.2.3.3.2.1" xref="S2.SS3.p3.14.m12.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p3.14.m12.1.1" xref="S2.SS3.p3.14.m12.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.SS3.p3.14.m12.2.3.3.2.2" xref="S2.SS3.p3.14.m12.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.SS3.p3.14.m12.2.2" xref="S2.SS3.p3.14.m12.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS3.p3.14.m12.2.3.3.2.3" xref="S2.SS3.p3.14.m12.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.14.m12.2b"><apply id="S2.SS3.p3.14.m12.2.3.cmml" xref="S2.SS3.p3.14.m12.2.3"><times id="S2.SS3.p3.14.m12.2.3.1.cmml" xref="S2.SS3.p3.14.m12.2.3.1"></times><ci id="S2.SS3.p3.14.m12.2.3.2.cmml" xref="S2.SS3.p3.14.m12.2.3.2">𝑓</ci><interval closure="open" id="S2.SS3.p3.14.m12.2.3.3.1.cmml" xref="S2.SS3.p3.14.m12.2.3.3.2"><ci id="S2.SS3.p3.14.m12.1.1.cmml" xref="S2.SS3.p3.14.m12.1.1">⋅</ci><ci id="S2.SS3.p3.14.m12.2.2.cmml" xref="S2.SS3.p3.14.m12.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.14.m12.2c">f(\cdot,\cdot)</annotation></semantics></math> is defined as a linear transformation with different transformation parameters <math id="S2.SS3.p3.15.m13.1" class="ltx_Math" alttext="\textbf{W}_{r}^{(l)}" display="inline"><semantics id="S2.SS3.p3.15.m13.1a"><msubsup id="S2.SS3.p3.15.m13.1.2" xref="S2.SS3.p3.15.m13.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p3.15.m13.1.2.2.2" xref="S2.SS3.p3.15.m13.1.2.2.2a.cmml">W</mtext><mi id="S2.SS3.p3.15.m13.1.2.2.3" xref="S2.SS3.p3.15.m13.1.2.2.3.cmml">r</mi><mrow id="S2.SS3.p3.15.m13.1.1.1.3" xref="S2.SS3.p3.15.m13.1.2.cmml"><mo stretchy="false" id="S2.SS3.p3.15.m13.1.1.1.3.1" xref="S2.SS3.p3.15.m13.1.2.cmml">(</mo><mi id="S2.SS3.p3.15.m13.1.1.1.1" xref="S2.SS3.p3.15.m13.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.SS3.p3.15.m13.1.1.1.3.2" xref="S2.SS3.p3.15.m13.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.15.m13.1b"><apply id="S2.SS3.p3.15.m13.1.2.cmml" xref="S2.SS3.p3.15.m13.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.15.m13.1.2.1.cmml" xref="S2.SS3.p3.15.m13.1.2">superscript</csymbol><apply id="S2.SS3.p3.15.m13.1.2.2.cmml" xref="S2.SS3.p3.15.m13.1.2"><csymbol cd="ambiguous" id="S2.SS3.p3.15.m13.1.2.2.1.cmml" xref="S2.SS3.p3.15.m13.1.2">subscript</csymbol><ci id="S2.SS3.p3.15.m13.1.2.2.2a.cmml" xref="S2.SS3.p3.15.m13.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p3.15.m13.1.2.2.2.cmml" xref="S2.SS3.p3.15.m13.1.2.2.2">W</mtext></ci><ci id="S2.SS3.p3.15.m13.1.2.2.3.cmml" xref="S2.SS3.p3.15.m13.1.2.2.3">𝑟</ci></apply><ci id="S2.SS3.p3.15.m13.1.1.1.1.cmml" xref="S2.SS3.p3.15.m13.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.15.m13.1c">\textbf{W}_{r}^{(l)}</annotation></semantics></math> for different relationships. Yao <math id="S2.SS3.p3.16.m14.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS3.p3.16.m14.1a"><mrow id="S2.SS3.p3.16.m14.1.1" xref="S2.SS3.p3.16.m14.1.1.cmml"><mi id="S2.SS3.p3.16.m14.1.1.2" xref="S2.SS3.p3.16.m14.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.16.m14.1.1.1" xref="S2.SS3.p3.16.m14.1.1.1.cmml">​</mo><mi id="S2.SS3.p3.16.m14.1.1.3" xref="S2.SS3.p3.16.m14.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.16.m14.1b"><apply id="S2.SS3.p3.16.m14.1.1.cmml" xref="S2.SS3.p3.16.m14.1.1"><times id="S2.SS3.p3.16.m14.1.1.1.cmml" xref="S2.SS3.p3.16.m14.1.1.1"></times><ci id="S2.SS3.p3.16.m14.1.1.2.cmml" xref="S2.SS3.p3.16.m14.1.1.2">𝑒</ci><ci id="S2.SS3.p3.16.m14.1.1.3.cmml" xref="S2.SS3.p3.16.m14.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.16.m14.1c">et</annotation></semantics></math> <math id="S2.SS3.p3.17.m15.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS3.p3.17.m15.1a"><mrow id="S2.SS3.p3.17.m15.1.1.1" xref="S2.SS3.p3.17.m15.1.1.1.1.cmml"><mrow id="S2.SS3.p3.17.m15.1.1.1.1" xref="S2.SS3.p3.17.m15.1.1.1.1.cmml"><mi id="S2.SS3.p3.17.m15.1.1.1.1.2" xref="S2.SS3.p3.17.m15.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.17.m15.1.1.1.1.1" xref="S2.SS3.p3.17.m15.1.1.1.1.1.cmml">​</mo><mi id="S2.SS3.p3.17.m15.1.1.1.1.3" xref="S2.SS3.p3.17.m15.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS3.p3.17.m15.1.1.1.2" xref="S2.SS3.p3.17.m15.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.17.m15.1b"><apply id="S2.SS3.p3.17.m15.1.1.1.1.cmml" xref="S2.SS3.p3.17.m15.1.1.1"><times id="S2.SS3.p3.17.m15.1.1.1.1.1.cmml" xref="S2.SS3.p3.17.m15.1.1.1.1.1"></times><ci id="S2.SS3.p3.17.m15.1.1.1.1.2.cmml" xref="S2.SS3.p3.17.m15.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p3.17.m15.1.1.1.1.3.cmml" xref="S2.SS3.p3.17.m15.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.17.m15.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> use a similar structure for image captioning.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p">To ameliorate this problem, they alternatively obtain <math id="S2.SS3.p4.1.m1.1" class="ltx_Math" alttext="\textbf{W}_{r}^{(l)}" display="inline"><semantics id="S2.SS3.p4.1.m1.1a"><msubsup id="S2.SS3.p4.1.m1.1.2" xref="S2.SS3.p4.1.m1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p4.1.m1.1.2.2.2" xref="S2.SS3.p4.1.m1.1.2.2.2a.cmml">W</mtext><mi id="S2.SS3.p4.1.m1.1.2.2.3" xref="S2.SS3.p4.1.m1.1.2.2.3.cmml">r</mi><mrow id="S2.SS3.p4.1.m1.1.1.1.3" xref="S2.SS3.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p4.1.m1.1.1.1.3.1" xref="S2.SS3.p4.1.m1.1.2.cmml">(</mo><mi id="S2.SS3.p4.1.m1.1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S2.SS3.p4.1.m1.1.1.1.3.2" xref="S2.SS3.p4.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><apply id="S2.SS3.p4.1.m1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.2.1.cmml" xref="S2.SS3.p4.1.m1.1.2">superscript</csymbol><apply id="S2.SS3.p4.1.m1.1.2.2.cmml" xref="S2.SS3.p4.1.m1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.2.2.1.cmml" xref="S2.SS3.p4.1.m1.1.2">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.2.2.2a.cmml" xref="S2.SS3.p4.1.m1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S2.SS3.p4.1.m1.1.2.2.2.cmml" xref="S2.SS3.p4.1.m1.1.2.2.2">W</mtext></ci><ci id="S2.SS3.p4.1.m1.1.2.2.3.cmml" xref="S2.SS3.p4.1.m1.1.2.2.3">𝑟</ci></apply><ci id="S2.SS3.p4.1.m1.1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1.1">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">\textbf{W}_{r}^{(l)}</annotation></semantics></math> through a linear combination of basis transformations, where the basis (a set of low-dimensional matrices) and coefficients are learned. Nevertheless, despite the reduced number of parameters, this model did not gain substantial improvements from treating each kind of relationship distinctively. We hypothesize that simply labeling the relationships is not sufficient to exploit their multitudinous, because errors in the labeling can lead to loss of useful information and introduction of noise. Additionally, parameters obtained from a basis transformation may still be too crude for generating accurate descriptions.</p>
</div>
<div id="S2.SS3.p5" class="ltx_para">
<p id="S2.SS3.p5.2" class="ltx_p">Another limitation of previous graph convolution models is that they use binary connectivity between nodes, that is, two nodes are either connected or uncorrelated at all. This connectivity is usually predetermined, either provided in the data or obtained with the help of priori information, such as a pretrained relation classifier <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Velickovic <math id="S2.SS3.p5.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S2.SS3.p5.1.m1.1a"><mrow id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml"><mi id="S2.SS3.p5.1.m1.1.1.2" xref="S2.SS3.p5.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p5.1.m1.1.1.1" xref="S2.SS3.p5.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS3.p5.1.m1.1.1.3" xref="S2.SS3.p5.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><apply id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1"><times id="S2.SS3.p5.1.m1.1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1.1"></times><ci id="S2.SS3.p5.1.m1.1.1.2.cmml" xref="S2.SS3.p5.1.m1.1.1.2">𝑒</ci><ci id="S2.SS3.p5.1.m1.1.1.3.cmml" xref="S2.SS3.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">et</annotation></semantics></math> <math id="S2.SS3.p5.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S2.SS3.p5.2.m2.1a"><mrow id="S2.SS3.p5.2.m2.1.1.1" xref="S2.SS3.p5.2.m2.1.1.1.1.cmml"><mrow id="S2.SS3.p5.2.m2.1.1.1.1" xref="S2.SS3.p5.2.m2.1.1.1.1.cmml"><mi id="S2.SS3.p5.2.m2.1.1.1.1.2" xref="S2.SS3.p5.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p5.2.m2.1.1.1.1.1" xref="S2.SS3.p5.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S2.SS3.p5.2.m2.1.1.1.1.3" xref="S2.SS3.p5.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S2.SS3.p5.2.m2.1.1.1.2" xref="S2.SS3.p5.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.2.m2.1b"><apply id="S2.SS3.p5.2.m2.1.1.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1.1"><times id="S2.SS3.p5.2.m2.1.1.1.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1.1.1.1"></times><ci id="S2.SS3.p5.2.m2.1.1.1.1.2.cmml" xref="S2.SS3.p5.2.m2.1.1.1.1.2">𝑎</ci><ci id="S2.SS3.p5.2.m2.1.1.1.1.3.cmml" xref="S2.SS3.p5.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.2.m2.1c">al.</annotation></semantics></math> addressed this problem with their Graph Attention Network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, which enables contiguous connectivity values to be dynamically determined with a multi-head attention mechanism:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.6" class="ltx_Math" alttext="\textbf{h}_{i}^{(l+1)}=\bigcup_{k=1}^{K}{\sigma(\sum_{j\in S_{i}}{\omega_{ji,k}\textbf{W}_{k}^{(l)}\textbf{h}_{j}^{(l)})}}" display="block"><semantics id="S2.E3.m1.6a"><mrow id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml"><msubsup id="S2.E3.m1.6.6.3" xref="S2.E3.m1.6.6.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.6.6.3.2.2" xref="S2.E3.m1.6.6.3.2.2a.cmml">h</mtext><mi id="S2.E3.m1.6.6.3.2.3" xref="S2.E3.m1.6.6.3.2.3.cmml">i</mi><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">l</mi><mo id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo rspace="0.111em" id="S2.E3.m1.6.6.2" xref="S2.E3.m1.6.6.2.cmml">=</mo><mrow id="S2.E3.m1.6.6.1" xref="S2.E3.m1.6.6.1.cmml"><munderover id="S2.E3.m1.6.6.1.2" xref="S2.E3.m1.6.6.1.2.cmml"><mo movablelimits="false" id="S2.E3.m1.6.6.1.2.2.2" xref="S2.E3.m1.6.6.1.2.2.2.cmml">⋃</mo><mrow id="S2.E3.m1.6.6.1.2.2.3" xref="S2.E3.m1.6.6.1.2.2.3.cmml"><mi id="S2.E3.m1.6.6.1.2.2.3.2" xref="S2.E3.m1.6.6.1.2.2.3.2.cmml">k</mi><mo id="S2.E3.m1.6.6.1.2.2.3.1" xref="S2.E3.m1.6.6.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.6.6.1.2.2.3.3" xref="S2.E3.m1.6.6.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.6.6.1.2.3" xref="S2.E3.m1.6.6.1.2.3.cmml">K</mi></munderover><mrow id="S2.E3.m1.6.6.1.1" xref="S2.E3.m1.6.6.1.1.cmml"><mi id="S2.E3.m1.6.6.1.1.3" xref="S2.E3.m1.6.6.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.6.6.1.1.2" xref="S2.E3.m1.6.6.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.6.6.1.1.1.1" xref="S2.E3.m1.6.6.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.6.6.1.1.1.1.2" xref="S2.E3.m1.6.6.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.6.6.1.1.1.1.1" xref="S2.E3.m1.6.6.1.1.1.1.1.cmml"><munder id="S2.E3.m1.6.6.1.1.1.1.1.1" xref="S2.E3.m1.6.6.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S2.E3.m1.6.6.1.1.1.1.1.1.2" xref="S2.E3.m1.6.6.1.1.1.1.1.1.2.cmml">∑</mo><mrow id="S2.E3.m1.6.6.1.1.1.1.1.1.3" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.6.6.1.1.1.1.1.1.3.2" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.2.cmml">j</mi><mo id="S2.E3.m1.6.6.1.1.1.1.1.1.3.1" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.1.cmml">∈</mo><msub id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.2" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.2.cmml">S</mi><mi id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.3" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S2.E3.m1.6.6.1.1.1.1.1.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.cmml"><msub id="S2.E3.m1.6.6.1.1.1.1.1.2.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.2.cmml"><mi id="S2.E3.m1.6.6.1.1.1.1.1.2.2.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.2.2.cmml">ω</mi><mrow id="S2.E3.m1.3.3.2.2" xref="S2.E3.m1.3.3.2.3.cmml"><mrow id="S2.E3.m1.3.3.2.2.1" xref="S2.E3.m1.3.3.2.2.1.cmml"><mi id="S2.E3.m1.3.3.2.2.1.2" xref="S2.E3.m1.3.3.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.2.2.1.1" xref="S2.E3.m1.3.3.2.2.1.1.cmml">​</mo><mi id="S2.E3.m1.3.3.2.2.1.3" xref="S2.E3.m1.3.3.2.2.1.3.cmml">i</mi></mrow><mo id="S2.E3.m1.3.3.2.2.2" xref="S2.E3.m1.3.3.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.6.6.1.1.1.1.1.2.1" xref="S2.E3.m1.6.6.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S2.E3.m1.6.6.1.1.1.1.1.2.3" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.2a.cmml">W</mtext><mi id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.3" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.3.cmml">k</mi><mrow id="S2.E3.m1.4.4.1.3" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S2.E3.m1.4.4.1.3.1" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.cmml">(</mo><mi id="S2.E3.m1.4.4.1.1" xref="S2.E3.m1.4.4.1.1.cmml">l</mi><mo stretchy="false" id="S2.E3.m1.4.4.1.3.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m1.6.6.1.1.1.1.1.2.1a" xref="S2.E3.m1.6.6.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S2.E3.m1.6.6.1.1.1.1.1.2.4" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.2a.cmml">h</mtext><mi id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.3" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.3.cmml">j</mi><mrow id="S2.E3.m1.5.5.1.3" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.1.3.1" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.cmml">(</mo><mi id="S2.E3.m1.5.5.1.1" xref="S2.E3.m1.5.5.1.1.cmml">l</mi><mo stretchy="false" id="S2.E3.m1.5.5.1.3.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.cmml">)</mo></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S2.E3.m1.6.6.1.1.1.1.3" xref="S2.E3.m1.6.6.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.6b"><apply id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6"><eq id="S2.E3.m1.6.6.2.cmml" xref="S2.E3.m1.6.6.2"></eq><apply id="S2.E3.m1.6.6.3.cmml" xref="S2.E3.m1.6.6.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.3.1.cmml" xref="S2.E3.m1.6.6.3">superscript</csymbol><apply id="S2.E3.m1.6.6.3.2.cmml" xref="S2.E3.m1.6.6.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.3.2.1.cmml" xref="S2.E3.m1.6.6.3">subscript</csymbol><ci id="S2.E3.m1.6.6.3.2.2a.cmml" xref="S2.E3.m1.6.6.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.6.6.3.2.2.cmml" xref="S2.E3.m1.6.6.3.2.2">h</mtext></ci><ci id="S2.E3.m1.6.6.3.2.3.cmml" xref="S2.E3.m1.6.6.3.2.3">𝑖</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1"><plus id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"></plus><ci id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2">𝑙</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E3.m1.6.6.1.cmml" xref="S2.E3.m1.6.6.1"><apply id="S2.E3.m1.6.6.1.2.cmml" xref="S2.E3.m1.6.6.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.2.1.cmml" xref="S2.E3.m1.6.6.1.2">superscript</csymbol><apply id="S2.E3.m1.6.6.1.2.2.cmml" xref="S2.E3.m1.6.6.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.2.2.1.cmml" xref="S2.E3.m1.6.6.1.2">subscript</csymbol><union id="S2.E3.m1.6.6.1.2.2.2.cmml" xref="S2.E3.m1.6.6.1.2.2.2"></union><apply id="S2.E3.m1.6.6.1.2.2.3.cmml" xref="S2.E3.m1.6.6.1.2.2.3"><eq id="S2.E3.m1.6.6.1.2.2.3.1.cmml" xref="S2.E3.m1.6.6.1.2.2.3.1"></eq><ci id="S2.E3.m1.6.6.1.2.2.3.2.cmml" xref="S2.E3.m1.6.6.1.2.2.3.2">𝑘</ci><cn type="integer" id="S2.E3.m1.6.6.1.2.2.3.3.cmml" xref="S2.E3.m1.6.6.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.6.6.1.2.3.cmml" xref="S2.E3.m1.6.6.1.2.3">𝐾</ci></apply><apply id="S2.E3.m1.6.6.1.1.cmml" xref="S2.E3.m1.6.6.1.1"><times id="S2.E3.m1.6.6.1.1.2.cmml" xref="S2.E3.m1.6.6.1.1.2"></times><ci id="S2.E3.m1.6.6.1.1.3.cmml" xref="S2.E3.m1.6.6.1.1.3">𝜎</ci><apply id="S2.E3.m1.6.6.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1"><apply id="S2.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1">subscript</csymbol><sum id="S2.E3.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.2"></sum><apply id="S2.E3.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3"><in id="S2.E3.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.1"></in><ci id="S2.E3.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.2">𝑗</ci><apply id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.2">𝑆</ci><ci id="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S2.E3.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2"><times id="S2.E3.m1.6.6.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.1"></times><apply id="S2.E3.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E3.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.2.2">𝜔</ci><list id="S2.E3.m1.3.3.2.3.cmml" xref="S2.E3.m1.3.3.2.2"><apply id="S2.E3.m1.3.3.2.2.1.cmml" xref="S2.E3.m1.3.3.2.2.1"><times id="S2.E3.m1.3.3.2.2.1.1.cmml" xref="S2.E3.m1.3.3.2.2.1.1"></times><ci id="S2.E3.m1.3.3.2.2.1.2.cmml" xref="S2.E3.m1.3.3.2.2.1.2">𝑗</ci><ci id="S2.E3.m1.3.3.2.2.1.3.cmml" xref="S2.E3.m1.3.3.2.2.1.3">𝑖</ci></apply><ci id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1.1">𝑘</ci></list></apply><apply id="S2.E3.m1.6.6.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.2a.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.2">W</mtext></ci><ci id="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.3.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.3.2.3">𝑘</ci></apply><ci id="S2.E3.m1.4.4.1.1.cmml" xref="S2.E3.m1.4.4.1.1">𝑙</ci></apply><apply id="S2.E3.m1.6.6.1.1.1.1.1.2.4.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.2.4.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4">superscript</csymbol><apply id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.2a.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.2"><mtext class="ltx_mathvariant_bold" id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.2">h</mtext></ci><ci id="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.3.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2.4.2.3">𝑗</ci></apply><ci id="S2.E3.m1.5.5.1.1.cmml" xref="S2.E3.m1.5.5.1.1">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.6c">\textbf{h}_{i}^{(l+1)}=\bigcup_{k=1}^{K}{\sigma(\sum_{j\in S_{i}}{\omega_{ji,k}\textbf{W}_{k}^{(l)}\textbf{h}_{j}^{(l)})}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p5.4" class="ltx_p">where <math id="S2.SS3.p5.3.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS3.p5.3.m1.1a"><mi id="S2.SS3.p5.3.m1.1.1" xref="S2.SS3.p5.3.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.3.m1.1b"><ci id="S2.SS3.p5.3.m1.1.1.cmml" xref="S2.SS3.p5.3.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.3.m1.1c">k</annotation></semantics></math> is the subscript of attention heads and <math id="S2.SS3.p5.4.m2.1" class="ltx_Math" alttext="\bigcup" display="inline"><semantics id="S2.SS3.p5.4.m2.1a"><mo id="S2.SS3.p5.4.m2.1.1" xref="S2.SS3.p5.4.m2.1.1.cmml">⋃</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.4.m2.1b"><union id="S2.SS3.p5.4.m2.1.1.cmml" xref="S2.SS3.p5.4.m2.1.1"></union></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.4.m2.1c">\bigcup</annotation></semantics></math> is used to denote a method of merging attended features from different attention heads, e.g., summation, concatenation. Additionally, each attention head uses a distinctive set of parameters to encode features.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1812.09681/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.5.1" class="ltx_text ltx_font_bold">Overview of the proposed SceneGCN model.</span> A semantic-aware scene graph is constructed from the input image first. Then the core SceneGCN module conducts a two-stage reasoning process on the scene graph over the question by enriching the node’s representation (<span id="S3.F2.6.2" class="ltx_text ltx_font_italic">scene graph convolution</span>) based on the question-relevant relational prior (<span id="S3.F2.7.3" class="ltx_text ltx_font_italic">question-relation guided self-attention</span>), and aggregating the objects’ information (<span id="S3.F2.8.4" class="ltx_text ltx_font_italic">question guided object attention</span>) for the image representation. The answers are predicted referring to the joint embedding of the two modalities.</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Our model for VQA is based on the <span id="S3.p1.1.1" class="ltx_text ltx_font_italic">joint embedding learning</span> framework which fuses the visual and textual embeddings and then uses a classifier for answer prediction. Given an image, we first construct a scene graph with embedded representation of visual objects and relationships. Then the proposed SceneGCN module conducts a two-stage reasoning process on the scene graph under the guidance of the question. The <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">scene graph convolution unit</span> first dynamically updates each object’s representation by aggregating the information from its neighbor nodes and semantic relationships, where the aggregation weights are learned by the question-relation guided self-attention. The <span id="S3.p1.1.3" class="ltx_text ltx_font_italic">question guided object attention unit</span> then pays different attention to the relation-aware objects and integrates the object representations based on the attention weights to form the relation-aware image representation. Such image representation is fused with the question representation via GRU and fed into MLP for answer prediction. Our framework is illustrated in Figure <a href="#S3.F2" title="Figure 2 ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Scene graph construction</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">Each image is represented as a scene graph where the nodes, denoted as <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="V=\{v_{i}\}^{N}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">V</mi><mo id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">=</mo><msup id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml"><mrow id="S3.SS1.p1.1.m1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mi id="S3.SS1.p1.1.m1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><eq id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2"></eq><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑉</ci><apply id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1">superscript</csymbol><set id="S3.SS1.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1"><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><ci id="S3.SS1.p1.1.m1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">V=\{v_{i}\}^{N}</annotation></semantics></math>, represent objects detected by a pre-trained object detector while edges, denoted as <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="E=\{e_{ij}\}^{N\times N}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mrow id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">E</mi><mo id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">=</mo><msup id="S3.SS1.p1.2.m2.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.cmml"><mrow id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.2.cmml">e</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.3.2" xref="S3.SS1.p1.2.m2.1.1.1.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.2.m2.1.1.1.3.1" xref="S3.SS1.p1.2.m2.1.1.1.3.1.cmml">×</mo><mi id="S3.SS1.p1.2.m2.1.1.1.3.3" xref="S3.SS1.p1.2.m2.1.1.1.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><eq id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2"></eq><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝐸</ci><apply id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1">superscript</csymbol><set id="S3.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1"><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.2">𝑒</ci><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3"><times id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.1"></times><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></set><apply id="S3.SS1.p1.2.m2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><times id="S3.SS1.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></times><ci id="S3.SS1.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.2">𝑁</ci><ci id="S3.SS1.p1.2.m2.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">E=\{e_{ij}\}^{N\times N}</annotation></semantics></math>, represent the semantic visual relationships embedded by our relationship encoder. Note that the edges are directed. We use a pre-trained object detector to detect <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">N</annotation></semantics></math> objects in an image and describe each object as a <math id="S3.SS1.p1.4.m4.2" class="ltx_Math" alttext="2,048" display="inline"><semantics id="S3.SS1.p1.4.m4.2a"><mrow id="S3.SS1.p1.4.m4.2.3.2" xref="S3.SS1.p1.4.m4.2.3.1.cmml"><mn id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">2</mn><mo id="S3.SS1.p1.4.m4.2.3.2.1" xref="S3.SS1.p1.4.m4.2.3.1.cmml">,</mo><mn id="S3.SS1.p1.4.m4.2.2" xref="S3.SS1.p1.4.m4.2.2.cmml">048</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><list id="S3.SS1.p1.4.m4.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3.2"><cn type="integer" id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">2</cn><cn type="integer" id="S3.SS1.p1.4.m4.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2">048</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">2,048</annotation></semantics></math>-dimensional vector. The relationship encoder, pre-trained on a visual relationship benchmark, i.e. <span id="S3.SS1.p1.6.1" class="ltx_text ltx_font_italic">GQA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, encodes relationships as <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mn id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><cn type="integer" id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">512</annotation></semantics></math>-dimensional relation embeddings, denoted as <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\textbf{r}_{ij}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2a.cmml">r</mtext><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2a.cmml" xref="S3.SS1.p1.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">r</mtext></ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><times id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">𝑖</ci><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\textbf{r}_{ij}</annotation></semantics></math>. We assume that certain relationship exist between any pair of objects by considering “unknown-relationship” as a kind of relationship. Therefore, the graph we constructed is fully-connected (except that we do not use self connections).</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Visual relationship encoder</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.4" class="ltx_p">The visual relationship encoder projects visual relationships into a deep semantic space which is aligned with their natural language annotations. This approach is different from a number of visual relationship models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> that are trained as classifiers. The performance of those models are restricted by the long-tailed distribution of training samples among categories in scene graph datasets such as Visual Genome<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and <span id="S3.SS2.p1.4.1" class="ltx_text ltx_font_italic">GQA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Datasets are heavily trimmed to cope with this imbalance. To avoid the incomplete utilization of training data, we adopt an approach that draws inspiration from Lu <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></times><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑒</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">et</annotation></semantics></math> <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml"><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S3.SS2.p1.2.m2.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"><times id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1"></times><ci id="S3.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>’s and Zhang <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></times><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑒</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">et</annotation></semantics></math> <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml"><mrow id="S3.SS2.p1.4.m4.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m4.1.1.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.1.1.cmml">​</mo><mi id="S3.SS2.p1.4.m4.1.1.1.1.3" xref="S3.SS2.p1.4.m4.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S3.SS2.p1.4.m4.1.1.1.2" xref="S3.SS2.p1.4.m4.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"><times id="S3.SS2.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.1"></times><ci id="S3.SS2.p1.4.m4.1.1.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p1.4.m4.1.1.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">al.</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>’s method which structurally aligns visual relationships with their textual annotations. The detailed structure of the visual relationship encoder is illustrated in Figure <a href="#S3.F3" title="Figure 3 ‣ III-B Visual relationship encoder ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.21" class="ltx_p">Our visual relationship encoder consists of a visual module and a language module as illustrated in Fig.<a href="#S3.F3" title="Figure 3 ‣ III-B Visual relationship encoder ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The visual module takes three feature maps <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\textbf{x}^{s}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2a.cmml">x</mtext><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2a.cmml" xref="S3.SS2.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">x</mtext></ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\textbf{x}^{s}</annotation></semantics></math>, <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\textbf{x}^{o}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2a.cmml">x</mtext><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2a.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">x</mtext></ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\textbf{x}^{o}</annotation></semantics></math>, <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="\textbf{x}^{r}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msup id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2a.cmml">x</mtext><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2a.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">x</mtext></ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\textbf{x}^{r}</annotation></semantics></math> as input and outputs three visual embedding vectors <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="\textbf{v}^{s}" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><msup id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2a.cmml">v</mtext><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2a.cmml" xref="S3.SS2.p2.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">v</mtext></ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">\textbf{v}^{s}</annotation></semantics></math>, <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="\textbf{v}^{o}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><msup id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2a.cmml">v</mtext><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2a.cmml" xref="S3.SS2.p2.5.m5.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">v</mtext></ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">\textbf{v}^{o}</annotation></semantics></math>, <math id="S3.SS2.p2.6.m6.1" class="ltx_Math" alttext="\textbf{v}^{r}" display="inline"><semantics id="S3.SS2.p2.6.m6.1a"><msup id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2a.cmml">v</mtext><mi id="S3.SS2.p2.6.m6.1.1.3" xref="S3.SS2.p2.6.m6.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS2.p2.6.m6.1.1.2a.cmml" xref="S3.SS2.p2.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">v</mtext></ci><ci id="S3.SS2.p2.6.m6.1.1.3.cmml" xref="S3.SS2.p2.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\textbf{v}^{r}</annotation></semantics></math> with respect to the subject, object and relationship. The language module uses a common GRU to encode the textual annotations <math id="S3.SS2.p2.7.m7.1" class="ltx_Math" alttext="l^{s}" display="inline"><semantics id="S3.SS2.p2.7.m7.1a"><msup id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml">l</mi><mi id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2">𝑙</ci><ci id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">l^{s}</annotation></semantics></math>, <math id="S3.SS2.p2.8.m8.1" class="ltx_Math" alttext="l^{o}" display="inline"><semantics id="S3.SS2.p2.8.m8.1a"><msup id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">l</mi><mi id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2">𝑙</ci><ci id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">l^{o}</annotation></semantics></math>, <math id="S3.SS2.p2.9.m9.1" class="ltx_Math" alttext="l^{r}" display="inline"><semantics id="S3.SS2.p2.9.m9.1a"><msup id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">l</mi><mi id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">superscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝑙</ci><ci id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">l^{r}</annotation></semantics></math> to yield textual embeddings <math id="S3.SS2.p2.10.m10.1" class="ltx_Math" alttext="\textbf{l}^{s}" display="inline"><semantics id="S3.SS2.p2.10.m10.1a"><msup id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.10.m10.1.1.2" xref="S3.SS2.p2.10.m10.1.1.2a.cmml">l</mtext><mi id="S3.SS2.p2.10.m10.1.1.3" xref="S3.SS2.p2.10.m10.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><apply id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">superscript</csymbol><ci id="S3.SS2.p2.10.m10.1.1.2a.cmml" xref="S3.SS2.p2.10.m10.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.10.m10.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.2">l</mtext></ci><ci id="S3.SS2.p2.10.m10.1.1.3.cmml" xref="S3.SS2.p2.10.m10.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">\textbf{l}^{s}</annotation></semantics></math>, <math id="S3.SS2.p2.11.m11.1" class="ltx_Math" alttext="\textbf{l}^{o}" display="inline"><semantics id="S3.SS2.p2.11.m11.1a"><msup id="S3.SS2.p2.11.m11.1.1" xref="S3.SS2.p2.11.m11.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.11.m11.1.1.2" xref="S3.SS2.p2.11.m11.1.1.2a.cmml">l</mtext><mi id="S3.SS2.p2.11.m11.1.1.3" xref="S3.SS2.p2.11.m11.1.1.3.cmml">o</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.11.m11.1b"><apply id="S3.SS2.p2.11.m11.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.11.m11.1.1.1.cmml" xref="S3.SS2.p2.11.m11.1.1">superscript</csymbol><ci id="S3.SS2.p2.11.m11.1.1.2a.cmml" xref="S3.SS2.p2.11.m11.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.11.m11.1.1.2.cmml" xref="S3.SS2.p2.11.m11.1.1.2">l</mtext></ci><ci id="S3.SS2.p2.11.m11.1.1.3.cmml" xref="S3.SS2.p2.11.m11.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.11.m11.1c">\textbf{l}^{o}</annotation></semantics></math>, <math id="S3.SS2.p2.12.m12.1" class="ltx_Math" alttext="\textbf{l}^{r}" display="inline"><semantics id="S3.SS2.p2.12.m12.1a"><msup id="S3.SS2.p2.12.m12.1.1" xref="S3.SS2.p2.12.m12.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.12.m12.1.1.2" xref="S3.SS2.p2.12.m12.1.1.2a.cmml">l</mtext><mi id="S3.SS2.p2.12.m12.1.1.3" xref="S3.SS2.p2.12.m12.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.12.m12.1b"><apply id="S3.SS2.p2.12.m12.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.12.m12.1.1.1.cmml" xref="S3.SS2.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS2.p2.12.m12.1.1.2a.cmml" xref="S3.SS2.p2.12.m12.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS2.p2.12.m12.1.1.2.cmml" xref="S3.SS2.p2.12.m12.1.1.2">l</mtext></ci><ci id="S3.SS2.p2.12.m12.1.1.3.cmml" xref="S3.SS2.p2.12.m12.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.12.m12.1c">\textbf{l}^{r}</annotation></semantics></math> which have the same number of dimensions with the visual embeddings. Note that weights are shared between the subject-branch and the object-branch. The GRU is shared by all three branches. Images are first passed through a ResNet-101 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> network pretrained on ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> to yield <math id="S3.SS2.p2.13.m13.1" class="ltx_Math" alttext="14\times 14" display="inline"><semantics id="S3.SS2.p2.13.m13.1a"><mrow id="S3.SS2.p2.13.m13.1.1" xref="S3.SS2.p2.13.m13.1.1.cmml"><mn id="S3.SS2.p2.13.m13.1.1.2" xref="S3.SS2.p2.13.m13.1.1.2.cmml">14</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.13.m13.1.1.1" xref="S3.SS2.p2.13.m13.1.1.1.cmml">×</mo><mn id="S3.SS2.p2.13.m13.1.1.3" xref="S3.SS2.p2.13.m13.1.1.3.cmml">14</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.13.m13.1b"><apply id="S3.SS2.p2.13.m13.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1"><times id="S3.SS2.p2.13.m13.1.1.1.cmml" xref="S3.SS2.p2.13.m13.1.1.1"></times><cn type="integer" id="S3.SS2.p2.13.m13.1.1.2.cmml" xref="S3.SS2.p2.13.m13.1.1.2">14</cn><cn type="integer" id="S3.SS2.p2.13.m13.1.1.3.cmml" xref="S3.SS2.p2.13.m13.1.1.3">14</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.13.m13.1c">14\times 14</annotation></semantics></math> feature maps. Regional features are obtained through ROI-Align <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> with crop-size <math id="S3.SS2.p2.14.m14.1" class="ltx_Math" alttext="7\times 7" display="inline"><semantics id="S3.SS2.p2.14.m14.1a"><mrow id="S3.SS2.p2.14.m14.1.1" xref="S3.SS2.p2.14.m14.1.1.cmml"><mn id="S3.SS2.p2.14.m14.1.1.2" xref="S3.SS2.p2.14.m14.1.1.2.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.14.m14.1.1.1" xref="S3.SS2.p2.14.m14.1.1.1.cmml">×</mo><mn id="S3.SS2.p2.14.m14.1.1.3" xref="S3.SS2.p2.14.m14.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.14.m14.1b"><apply id="S3.SS2.p2.14.m14.1.1.cmml" xref="S3.SS2.p2.14.m14.1.1"><times id="S3.SS2.p2.14.m14.1.1.1.cmml" xref="S3.SS2.p2.14.m14.1.1.1"></times><cn type="integer" id="S3.SS2.p2.14.m14.1.1.2.cmml" xref="S3.SS2.p2.14.m14.1.1.2">7</cn><cn type="integer" id="S3.SS2.p2.14.m14.1.1.3.cmml" xref="S3.SS2.p2.14.m14.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.14.m14.1c">7\times 7</annotation></semantics></math>. A <math id="S3.SS2.p2.15.m15.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S3.SS2.p2.15.m15.1a"><mrow id="S3.SS2.p2.15.m15.1.1" xref="S3.SS2.p2.15.m15.1.1.cmml"><mn id="S3.SS2.p2.15.m15.1.1.2" xref="S3.SS2.p2.15.m15.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.15.m15.1.1.1" xref="S3.SS2.p2.15.m15.1.1.1.cmml">×</mo><mn id="S3.SS2.p2.15.m15.1.1.3" xref="S3.SS2.p2.15.m15.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.15.m15.1b"><apply id="S3.SS2.p2.15.m15.1.1.cmml" xref="S3.SS2.p2.15.m15.1.1"><times id="S3.SS2.p2.15.m15.1.1.1.cmml" xref="S3.SS2.p2.15.m15.1.1.1"></times><cn type="integer" id="S3.SS2.p2.15.m15.1.1.2.cmml" xref="S3.SS2.p2.15.m15.1.1.2">1</cn><cn type="integer" id="S3.SS2.p2.15.m15.1.1.3.cmml" xref="S3.SS2.p2.15.m15.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.15.m15.1c">1\times 1</annotation></semantics></math> convolution layer projects the <math id="S3.SS2.p2.16.m16.2" class="ltx_Math" alttext="2,048" display="inline"><semantics id="S3.SS2.p2.16.m16.2a"><mrow id="S3.SS2.p2.16.m16.2.3.2" xref="S3.SS2.p2.16.m16.2.3.1.cmml"><mn id="S3.SS2.p2.16.m16.1.1" xref="S3.SS2.p2.16.m16.1.1.cmml">2</mn><mo id="S3.SS2.p2.16.m16.2.3.2.1" xref="S3.SS2.p2.16.m16.2.3.1.cmml">,</mo><mn id="S3.SS2.p2.16.m16.2.2" xref="S3.SS2.p2.16.m16.2.2.cmml">048</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.16.m16.2b"><list id="S3.SS2.p2.16.m16.2.3.1.cmml" xref="S3.SS2.p2.16.m16.2.3.2"><cn type="integer" id="S3.SS2.p2.16.m16.1.1.cmml" xref="S3.SS2.p2.16.m16.1.1">2</cn><cn type="integer" id="S3.SS2.p2.16.m16.2.2.cmml" xref="S3.SS2.p2.16.m16.2.2">048</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.16.m16.2c">2,048</annotation></semantics></math>-dimensional features down to <math id="S3.SS2.p2.17.m17.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S3.SS2.p2.17.m17.1a"><mn id="S3.SS2.p2.17.m17.1.1" xref="S3.SS2.p2.17.m17.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.17.m17.1b"><cn type="integer" id="S3.SS2.p2.17.m17.1.1.cmml" xref="S3.SS2.p2.17.m17.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.17.m17.1c">512</annotation></semantics></math> dimensions and three consecutive <math id="S3.SS2.p2.18.m18.1" class="ltx_Math" alttext="3\times 3" display="inline"><semantics id="S3.SS2.p2.18.m18.1a"><mrow id="S3.SS2.p2.18.m18.1.1" xref="S3.SS2.p2.18.m18.1.1.cmml"><mn id="S3.SS2.p2.18.m18.1.1.2" xref="S3.SS2.p2.18.m18.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.18.m18.1.1.1" xref="S3.SS2.p2.18.m18.1.1.1.cmml">×</mo><mn id="S3.SS2.p2.18.m18.1.1.3" xref="S3.SS2.p2.18.m18.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.18.m18.1b"><apply id="S3.SS2.p2.18.m18.1.1.cmml" xref="S3.SS2.p2.18.m18.1.1"><times id="S3.SS2.p2.18.m18.1.1.1.cmml" xref="S3.SS2.p2.18.m18.1.1.1"></times><cn type="integer" id="S3.SS2.p2.18.m18.1.1.2.cmml" xref="S3.SS2.p2.18.m18.1.1.2">3</cn><cn type="integer" id="S3.SS2.p2.18.m18.1.1.3.cmml" xref="S3.SS2.p2.18.m18.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.18.m18.1c">3\times 3</annotation></semantics></math> convolution layers compress the <math id="S3.SS2.p2.19.m19.1" class="ltx_Math" alttext="7\times 7" display="inline"><semantics id="S3.SS2.p2.19.m19.1a"><mrow id="S3.SS2.p2.19.m19.1.1" xref="S3.SS2.p2.19.m19.1.1.cmml"><mn id="S3.SS2.p2.19.m19.1.1.2" xref="S3.SS2.p2.19.m19.1.1.2.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.19.m19.1.1.1" xref="S3.SS2.p2.19.m19.1.1.1.cmml">×</mo><mn id="S3.SS2.p2.19.m19.1.1.3" xref="S3.SS2.p2.19.m19.1.1.3.cmml">7</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.19.m19.1b"><apply id="S3.SS2.p2.19.m19.1.1.cmml" xref="S3.SS2.p2.19.m19.1.1"><times id="S3.SS2.p2.19.m19.1.1.1.cmml" xref="S3.SS2.p2.19.m19.1.1.1"></times><cn type="integer" id="S3.SS2.p2.19.m19.1.1.2.cmml" xref="S3.SS2.p2.19.m19.1.1.2">7</cn><cn type="integer" id="S3.SS2.p2.19.m19.1.1.3.cmml" xref="S3.SS2.p2.19.m19.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.19.m19.1c">7\times 7</annotation></semantics></math> feature maps down to a single <math id="S3.SS2.p2.20.m20.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S3.SS2.p2.20.m20.1a"><mn id="S3.SS2.p2.20.m20.1.1" xref="S3.SS2.p2.20.m20.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.20.m20.1b"><cn type="integer" id="S3.SS2.p2.20.m20.1.1.cmml" xref="S3.SS2.p2.20.m20.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.20.m20.1c">512</annotation></semantics></math>-dimensional vector for each bounding box. Fully-connected layers, denoted by <math id="S3.SS2.p2.21.m21.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS2.p2.21.m21.1a"><mi id="S3.SS2.p2.21.m21.1.1" xref="S3.SS2.p2.21.m21.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.21.m21.1b"><ci id="S3.SS2.p2.21.m21.1.1.cmml" xref="S3.SS2.p2.21.m21.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.21.m21.1c">w</annotation></semantics></math>s in the figure, pass on to generate the final relationship embeddings. Dashed lines denote shortcut connections which are added to optimize gradient flow for the convolution layers.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.13" class="ltx_p">The training objective is defined by</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="L_{\text{total}}=L_{s}+L_{r}+L_{o}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">L</mi><mtext id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3a.cmml">total</mtext></msub><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">L</mi><mi id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">s</mi></msub><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">+</mo><msub id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">L</mi><mi id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">r</mi></msub><mo id="S3.E4.m1.1.1.3.1a" xref="S3.E4.m1.1.1.3.1.cmml">+</mo><msub id="S3.E4.m1.1.1.3.4" xref="S3.E4.m1.1.1.3.4.cmml"><mi id="S3.E4.m1.1.1.3.4.2" xref="S3.E4.m1.1.1.3.4.2.cmml">L</mi><mi id="S3.E4.m1.1.1.3.4.3" xref="S3.E4.m1.1.1.3.4.3.cmml">o</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">𝐿</ci><ci id="S3.E4.m1.1.1.2.3a.cmml" xref="S3.E4.m1.1.1.2.3"><mtext mathsize="70%" id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3">total</mtext></ci></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><plus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></plus><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">𝐿</ci><ci id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">𝑠</ci></apply><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">𝐿</ci><ci id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">𝑟</ci></apply><apply id="S3.E4.m1.1.1.3.4.cmml" xref="S3.E4.m1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.4.1.cmml" xref="S3.E4.m1.1.1.3.4">subscript</csymbol><ci id="S3.E4.m1.1.1.3.4.2.cmml" xref="S3.E4.m1.1.1.3.4.2">𝐿</ci><ci id="S3.E4.m1.1.1.3.4.3.cmml" xref="S3.E4.m1.1.1.3.4.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">L_{\text{total}}=L_{s}+L_{r}+L_{o}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.7" class="ltx_p">where <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="L_{s}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">L</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝐿</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">L_{s}</annotation></semantics></math>, <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="L_{o}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">L</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝐿</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">L_{o}</annotation></semantics></math> and <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="L_{r}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">L</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝐿</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">L_{r}</annotation></semantics></math> are the loss terms computed with the subject, object and relation embeddings, respectively. Next, we describe the computation of <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="L_{s}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">L</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝐿</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">L_{s}</annotation></semantics></math>, <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="L_{o}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">L</mi><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝐿</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">L_{o}</annotation></semantics></math> and <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="L_{r}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">L</mi><mi id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝐿</ci><ci id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">L_{r}</annotation></semantics></math>. The subject, object and relation subscripts are omitted since the same function is used. The loss function is designed to minimize the cosine similarity between the embeddings of positive pairs and alienate negative pairs (superscripted with <sup id="S3.SS2.p3.7.1" class="ltx_sup"><span id="S3.SS2.p3.7.1.1" class="ltx_text ltx_font_italic">-</span></sup>), it consists of two parts:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="L=L_{v}^{Tr}+L_{l}^{TrSm}" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">L</mi><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><msubsup id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml"><mi id="S3.E5.m1.1.1.3.2.2.2" xref="S3.E5.m1.1.1.3.2.2.2.cmml">L</mi><mi id="S3.E5.m1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.3.2.2.3.cmml">v</mi><mrow id="S3.E5.m1.1.1.3.2.3" xref="S3.E5.m1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.3.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.2.3.1" xref="S3.E5.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.3.2.3.3.cmml">r</mi></mrow></msubsup><mo id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">+</mo><msubsup id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.2.2" xref="S3.E5.m1.1.1.3.3.2.2.cmml">L</mi><mi id="S3.E5.m1.1.1.3.3.2.3" xref="S3.E5.m1.1.1.3.3.2.3.cmml">l</mi><mrow id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.1.1.3.3.3.2" xref="S3.E5.m1.1.1.3.3.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.3.1" xref="S3.E5.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.3.3.3" xref="S3.E5.m1.1.1.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.3.1a" xref="S3.E5.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.3.3.4" xref="S3.E5.m1.1.1.3.3.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.3.3.1b" xref="S3.E5.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.3.3.5" xref="S3.E5.m1.1.1.3.3.3.5.cmml">m</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"></eq><ci id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">𝐿</ci><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><plus id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></plus><apply id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.3.2">superscript</csymbol><apply id="S3.E5.m1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.3.2.2.2">𝐿</ci><ci id="S3.E5.m1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.3.2.2.3">𝑣</ci></apply><apply id="S3.E5.m1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.3.2.3"><times id="S3.E5.m1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.3.2.3.1"></times><ci id="S3.E5.m1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.3.2.3.2">𝑇</ci><ci id="S3.E5.m1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.3.2.3.3">𝑟</ci></apply></apply><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3">superscript</csymbol><apply id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.1.1.3.3.2.2">𝐿</ci><ci id="S3.E5.m1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3"><times id="S3.E5.m1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3.3.1"></times><ci id="S3.E5.m1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.3.2">𝑇</ci><ci id="S3.E5.m1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3.3">𝑟</ci><ci id="S3.E5.m1.1.1.3.3.3.4.cmml" xref="S3.E5.m1.1.1.3.3.3.4">𝑆</ci><ci id="S3.E5.m1.1.1.3.3.3.5.cmml" xref="S3.E5.m1.1.1.3.3.3.5">𝑚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">L=L_{v}^{Tr}+L_{l}^{TrSm}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.8" class="ltx_p">where <math id="S3.SS2.p3.8.m1.1" class="ltx_Math" alttext="L_{v}^{Tr}" display="inline"><semantics id="S3.SS2.p3.8.m1.1a"><msubsup id="S3.SS2.p3.8.m1.1.1" xref="S3.SS2.p3.8.m1.1.1.cmml"><mi id="S3.SS2.p3.8.m1.1.1.2.2" xref="S3.SS2.p3.8.m1.1.1.2.2.cmml">L</mi><mi id="S3.SS2.p3.8.m1.1.1.2.3" xref="S3.SS2.p3.8.m1.1.1.2.3.cmml">v</mi><mrow id="S3.SS2.p3.8.m1.1.1.3" xref="S3.SS2.p3.8.m1.1.1.3.cmml"><mi id="S3.SS2.p3.8.m1.1.1.3.2" xref="S3.SS2.p3.8.m1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.8.m1.1.1.3.1" xref="S3.SS2.p3.8.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.8.m1.1.1.3.3" xref="S3.SS2.p3.8.m1.1.1.3.3.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m1.1b"><apply id="S3.SS2.p3.8.m1.1.1.cmml" xref="S3.SS2.p3.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m1.1.1.1.cmml" xref="S3.SS2.p3.8.m1.1.1">superscript</csymbol><apply id="S3.SS2.p3.8.m1.1.1.2.cmml" xref="S3.SS2.p3.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m1.1.1.2.1.cmml" xref="S3.SS2.p3.8.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m1.1.1.2.2.cmml" xref="S3.SS2.p3.8.m1.1.1.2.2">𝐿</ci><ci id="S3.SS2.p3.8.m1.1.1.2.3.cmml" xref="S3.SS2.p3.8.m1.1.1.2.3">𝑣</ci></apply><apply id="S3.SS2.p3.8.m1.1.1.3.cmml" xref="S3.SS2.p3.8.m1.1.1.3"><times id="S3.SS2.p3.8.m1.1.1.3.1.cmml" xref="S3.SS2.p3.8.m1.1.1.3.1"></times><ci id="S3.SS2.p3.8.m1.1.1.3.2.cmml" xref="S3.SS2.p3.8.m1.1.1.3.2">𝑇</ci><ci id="S3.SS2.p3.8.m1.1.1.3.3.cmml" xref="S3.SS2.p3.8.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m1.1c">L_{v}^{Tr}</annotation></semantics></math> is the triplet loss:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="L_{v}^{Tr}=\frac{1}{N_{\text{pos}}N_{\text{neg}}}\sum_{i=1}^{N_{\text{pos}}}\sum_{j=1}^{N_{\text{neg}}}\max[0,m-s(\textbf{v}_{i},\textbf{l}_{i})+s(\textbf{v}^{-}_{ij},\textbf{l}_{i})]" display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><msubsup id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.2.2" xref="S3.E6.m1.3.3.3.2.2.cmml">L</mi><mi id="S3.E6.m1.3.3.3.2.3" xref="S3.E6.m1.3.3.3.2.3.cmml">v</mi><mrow id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.3.2" xref="S3.E6.m1.3.3.3.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.1" xref="S3.E6.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.cmml">r</mi></mrow></msubsup><mo id="S3.E6.m1.3.3.2" xref="S3.E6.m1.3.3.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.cmml"><mfrac id="S3.E6.m1.3.3.1.3" xref="S3.E6.m1.3.3.1.3.cmml"><mn id="S3.E6.m1.3.3.1.3.2" xref="S3.E6.m1.3.3.1.3.2.cmml">1</mn><mrow id="S3.E6.m1.3.3.1.3.3" xref="S3.E6.m1.3.3.1.3.3.cmml"><msub id="S3.E6.m1.3.3.1.3.3.2" xref="S3.E6.m1.3.3.1.3.3.2.cmml"><mi id="S3.E6.m1.3.3.1.3.3.2.2" xref="S3.E6.m1.3.3.1.3.3.2.2.cmml">N</mi><mtext id="S3.E6.m1.3.3.1.3.3.2.3" xref="S3.E6.m1.3.3.1.3.3.2.3a.cmml">pos</mtext></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.3.3.1" xref="S3.E6.m1.3.3.1.3.3.1.cmml">​</mo><msub id="S3.E6.m1.3.3.1.3.3.3" xref="S3.E6.m1.3.3.1.3.3.3.cmml"><mi id="S3.E6.m1.3.3.1.3.3.3.2" xref="S3.E6.m1.3.3.1.3.3.3.2.cmml">N</mi><mtext id="S3.E6.m1.3.3.1.3.3.3.3" xref="S3.E6.m1.3.3.1.3.3.3.3a.cmml">neg</mtext></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><munderover id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.3.3.1.1.2.2.3.1" xref="S3.E6.m1.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.1.1.2.2.3.3" xref="S3.E6.m1.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.3.2" xref="S3.E6.m1.3.3.1.1.2.3.2.cmml">N</mi><mtext id="S3.E6.m1.3.3.1.1.2.3.3" xref="S3.E6.m1.3.3.1.1.2.3.3a.cmml">pos</mtext></msub></munderover><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml"><munderover id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E6.m1.3.3.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E6.m1.3.3.1.1.1.2.2.3.1" xref="S3.E6.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.1.1.1.2.2.3.3" xref="S3.E6.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E6.m1.3.3.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.2.3.2" xref="S3.E6.m1.3.3.1.1.1.2.3.2.cmml">N</mi><mtext id="S3.E6.m1.3.3.1.1.1.2.3.3" xref="S3.E6.m1.3.3.1.1.1.2.3.3a.cmml">neg</mtext></msub></munderover><mrow id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">max</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1a" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">[</mo><mn id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">0</mn><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4.cmml">m</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">−</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml">(</mo><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml">v</mtext><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml">,</mo><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2a.cmml">l</mtext><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.5.cmml">+</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">(</mo><msubsup id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2a.cmml">v</mtext><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.cmml">j</mi></mrow><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3.cmml">−</mo></msubsup><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.4" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">,</mo><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2a.cmml">l</mtext><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.5" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.4" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><eq id="S3.E6.m1.3.3.2.cmml" xref="S3.E6.m1.3.3.2"></eq><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3">superscript</csymbol><apply id="S3.E6.m1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.2.1.cmml" xref="S3.E6.m1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.3.2.2.cmml" xref="S3.E6.m1.3.3.3.2.2">𝐿</ci><ci id="S3.E6.m1.3.3.3.2.3.cmml" xref="S3.E6.m1.3.3.3.2.3">𝑣</ci></apply><apply id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3"><times id="S3.E6.m1.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.1"></times><ci id="S3.E6.m1.3.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.3.2">𝑇</ci><ci id="S3.E6.m1.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3">𝑟</ci></apply></apply><apply id="S3.E6.m1.3.3.1.cmml" xref="S3.E6.m1.3.3.1"><times id="S3.E6.m1.3.3.1.2.cmml" xref="S3.E6.m1.3.3.1.2"></times><apply id="S3.E6.m1.3.3.1.3.cmml" xref="S3.E6.m1.3.3.1.3"><divide id="S3.E6.m1.3.3.1.3.1.cmml" xref="S3.E6.m1.3.3.1.3"></divide><cn type="integer" id="S3.E6.m1.3.3.1.3.2.cmml" xref="S3.E6.m1.3.3.1.3.2">1</cn><apply id="S3.E6.m1.3.3.1.3.3.cmml" xref="S3.E6.m1.3.3.1.3.3"><times id="S3.E6.m1.3.3.1.3.3.1.cmml" xref="S3.E6.m1.3.3.1.3.3.1"></times><apply id="S3.E6.m1.3.3.1.3.3.2.cmml" xref="S3.E6.m1.3.3.1.3.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.3.3.2.1.cmml" xref="S3.E6.m1.3.3.1.3.3.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.3.3.2.2.cmml" xref="S3.E6.m1.3.3.1.3.3.2.2">𝑁</ci><ci id="S3.E6.m1.3.3.1.3.3.2.3a.cmml" xref="S3.E6.m1.3.3.1.3.3.2.3"><mtext mathsize="70%" id="S3.E6.m1.3.3.1.3.3.2.3.cmml" xref="S3.E6.m1.3.3.1.3.3.2.3">pos</mtext></ci></apply><apply id="S3.E6.m1.3.3.1.3.3.3.cmml" xref="S3.E6.m1.3.3.1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.1.3.3.3.2">𝑁</ci><ci id="S3.E6.m1.3.3.1.3.3.3.3a.cmml" xref="S3.E6.m1.3.3.1.3.3.3.3"><mtext mathsize="70%" id="S3.E6.m1.3.3.1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.1.3.3.3.3">neg</mtext></ci></apply></apply></apply><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1"><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"></sum><apply id="S3.E6.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3"><eq id="S3.E6.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.3.2">𝑁</ci><ci id="S3.E6.m1.3.3.1.1.2.3.3a.cmml" xref="S3.E6.m1.3.3.1.1.2.3.3"><mtext mathsize="50%" id="S3.E6.m1.3.3.1.1.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3.3">pos</mtext></ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"><apply id="S3.E6.m1.3.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3"><eq id="S3.E6.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3.2">𝑁</ci><ci id="S3.E6.m1.3.3.1.1.1.2.3.3a.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3.3"><mtext mathsize="50%" id="S3.E6.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3.3">neg</mtext></ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><max id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"></max><cn type="integer" id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">0</cn><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1"><plus id="S3.E6.m1.3.3.1.1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.5"></plus><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2"><minus id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.3"></minus><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.4">𝑚</ci><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.3"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.4">𝑠</ci><interval closure="open" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2"><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">v</mtext></ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.2">l</mtext></ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.3"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.4">𝑠</ci><interval closure="open" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2"><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1">superscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.2">v</mtext></ci><minus id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.2.3"></minus></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.1"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.2">𝑖</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2a.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.2">l</mtext></ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.4.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">L_{v}^{Tr}=\frac{1}{N_{\text{pos}}N_{\text{neg}}}\sum_{i=1}^{N_{\text{pos}}}\sum_{j=1}^{N_{\text{neg}}}\max[0,m-s(\textbf{v}_{i},\textbf{l}_{i})+s(\textbf{v}^{-}_{ij},\textbf{l}_{i})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.9" class="ltx_p">and <math id="S3.SS2.p3.9.m1.1" class="ltx_Math" alttext="L_{l}^{TrSm}" display="inline"><semantics id="S3.SS2.p3.9.m1.1a"><msubsup id="S3.SS2.p3.9.m1.1.1" xref="S3.SS2.p3.9.m1.1.1.cmml"><mi id="S3.SS2.p3.9.m1.1.1.2.2" xref="S3.SS2.p3.9.m1.1.1.2.2.cmml">L</mi><mi id="S3.SS2.p3.9.m1.1.1.2.3" xref="S3.SS2.p3.9.m1.1.1.2.3.cmml">l</mi><mrow id="S3.SS2.p3.9.m1.1.1.3" xref="S3.SS2.p3.9.m1.1.1.3.cmml"><mi id="S3.SS2.p3.9.m1.1.1.3.2" xref="S3.SS2.p3.9.m1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.9.m1.1.1.3.1" xref="S3.SS2.p3.9.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.9.m1.1.1.3.3" xref="S3.SS2.p3.9.m1.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.9.m1.1.1.3.1a" xref="S3.SS2.p3.9.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.9.m1.1.1.3.4" xref="S3.SS2.p3.9.m1.1.1.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.9.m1.1.1.3.1b" xref="S3.SS2.p3.9.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.9.m1.1.1.3.5" xref="S3.SS2.p3.9.m1.1.1.3.5.cmml">m</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m1.1b"><apply id="S3.SS2.p3.9.m1.1.1.cmml" xref="S3.SS2.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m1.1.1.1.cmml" xref="S3.SS2.p3.9.m1.1.1">superscript</csymbol><apply id="S3.SS2.p3.9.m1.1.1.2.cmml" xref="S3.SS2.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m1.1.1.2.1.cmml" xref="S3.SS2.p3.9.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m1.1.1.2.2.cmml" xref="S3.SS2.p3.9.m1.1.1.2.2">𝐿</ci><ci id="S3.SS2.p3.9.m1.1.1.2.3.cmml" xref="S3.SS2.p3.9.m1.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.p3.9.m1.1.1.3.cmml" xref="S3.SS2.p3.9.m1.1.1.3"><times id="S3.SS2.p3.9.m1.1.1.3.1.cmml" xref="S3.SS2.p3.9.m1.1.1.3.1"></times><ci id="S3.SS2.p3.9.m1.1.1.3.2.cmml" xref="S3.SS2.p3.9.m1.1.1.3.2">𝑇</ci><ci id="S3.SS2.p3.9.m1.1.1.3.3.cmml" xref="S3.SS2.p3.9.m1.1.1.3.3">𝑟</ci><ci id="S3.SS2.p3.9.m1.1.1.3.4.cmml" xref="S3.SS2.p3.9.m1.1.1.3.4">𝑆</ci><ci id="S3.SS2.p3.9.m1.1.1.3.5.cmml" xref="S3.SS2.p3.9.m1.1.1.3.5">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m1.1c">L_{l}^{TrSm}</annotation></semantics></math> is the triplet softmax loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.7" class="ltx_Math" alttext="L_{l}^{TrSm}=\frac{1}{N_{\text{pos}}}\sum_{i=1}^{N_{\text{pos}}}-\log\frac{e^{s(\textbf{v}_{i},\textbf{l}_{i})}}{e^{s(\textbf{v}_{i},\textbf{l}_{i})}+\sum_{j=1}^{N_{\text{neg}}}e^{s(\textbf{v}_{i},\textbf{l}^{-}_{ij})}}." display="block"><semantics id="S3.E7.m1.7a"><mrow id="S3.E7.m1.7.7.1" xref="S3.E7.m1.7.7.1.1.cmml"><mrow id="S3.E7.m1.7.7.1.1" xref="S3.E7.m1.7.7.1.1.cmml"><msubsup id="S3.E7.m1.7.7.1.1.2" xref="S3.E7.m1.7.7.1.1.2.cmml"><mi id="S3.E7.m1.7.7.1.1.2.2.2" xref="S3.E7.m1.7.7.1.1.2.2.2.cmml">L</mi><mi id="S3.E7.m1.7.7.1.1.2.2.3" xref="S3.E7.m1.7.7.1.1.2.2.3.cmml">l</mi><mrow id="S3.E7.m1.7.7.1.1.2.3" xref="S3.E7.m1.7.7.1.1.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1.2.3.2" xref="S3.E7.m1.7.7.1.1.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.2.3.1" xref="S3.E7.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.7.7.1.1.2.3.3" xref="S3.E7.m1.7.7.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.2.3.1a" xref="S3.E7.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.7.7.1.1.2.3.4" xref="S3.E7.m1.7.7.1.1.2.3.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.2.3.1b" xref="S3.E7.m1.7.7.1.1.2.3.1.cmml">​</mo><mi id="S3.E7.m1.7.7.1.1.2.3.5" xref="S3.E7.m1.7.7.1.1.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S3.E7.m1.7.7.1.1.1" xref="S3.E7.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.7.7.1.1.3" xref="S3.E7.m1.7.7.1.1.3.cmml"><mrow id="S3.E7.m1.7.7.1.1.3.2" xref="S3.E7.m1.7.7.1.1.3.2.cmml"><mfrac id="S3.E7.m1.7.7.1.1.3.2.2" xref="S3.E7.m1.7.7.1.1.3.2.2.cmml"><mn id="S3.E7.m1.7.7.1.1.3.2.2.2" xref="S3.E7.m1.7.7.1.1.3.2.2.2.cmml">1</mn><msub id="S3.E7.m1.7.7.1.1.3.2.2.3" xref="S3.E7.m1.7.7.1.1.3.2.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1.3.2.2.3.2" xref="S3.E7.m1.7.7.1.1.3.2.2.3.2.cmml">N</mi><mtext id="S3.E7.m1.7.7.1.1.3.2.2.3.3" xref="S3.E7.m1.7.7.1.1.3.2.2.3.3a.cmml">pos</mtext></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.1.1.3.2.1" xref="S3.E7.m1.7.7.1.1.3.2.1.cmml">​</mo><munderover id="S3.E7.m1.7.7.1.1.3.2.3" xref="S3.E7.m1.7.7.1.1.3.2.3.cmml"><mo movablelimits="false" rspace="0em" id="S3.E7.m1.7.7.1.1.3.2.3.2.2" xref="S3.E7.m1.7.7.1.1.3.2.3.2.2.cmml">∑</mo><mrow id="S3.E7.m1.7.7.1.1.3.2.3.2.3" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.cmml"><mi id="S3.E7.m1.7.7.1.1.3.2.3.2.3.2" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.7.7.1.1.3.2.3.2.3.1" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.1.cmml">=</mo><mn id="S3.E7.m1.7.7.1.1.3.2.3.2.3.3" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.E7.m1.7.7.1.1.3.2.3.3" xref="S3.E7.m1.7.7.1.1.3.2.3.3.cmml"><mi id="S3.E7.m1.7.7.1.1.3.2.3.3.2" xref="S3.E7.m1.7.7.1.1.3.2.3.3.2.cmml">N</mi><mtext id="S3.E7.m1.7.7.1.1.3.2.3.3.3" xref="S3.E7.m1.7.7.1.1.3.2.3.3.3a.cmml">pos</mtext></msub></munderover></mrow><mo lspace="0em" id="S3.E7.m1.7.7.1.1.3.1" xref="S3.E7.m1.7.7.1.1.3.1.cmml">−</mo><mrow id="S3.E7.m1.7.7.1.1.3.3" xref="S3.E7.m1.7.7.1.1.3.3.cmml"><mi id="S3.E7.m1.7.7.1.1.3.3.1" xref="S3.E7.m1.7.7.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E7.m1.7.7.1.1.3.3a" xref="S3.E7.m1.7.7.1.1.3.3.cmml">⁡</mo><mfrac id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml"><msup id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.4" xref="S3.E7.m1.2.2.2.4.cmml">e</mi><mrow id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.2.2.4" xref="S3.E7.m1.2.2.2.2.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2a.cmml">v</mtext><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.2.2.2.2.2.2.2.4" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E7.m1.2.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.2.2.2.2.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.2.2.2.2a.cmml">l</mtext><mi id="S3.E7.m1.2.2.2.2.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E7.m1.2.2.2.2.2.2.2.5" xref="S3.E7.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></msup><mrow id="S3.E7.m1.6.6.6" xref="S3.E7.m1.6.6.6.cmml"><msup id="S3.E7.m1.6.6.6.6" xref="S3.E7.m1.6.6.6.6.cmml"><mi id="S3.E7.m1.6.6.6.6.2" xref="S3.E7.m1.6.6.6.6.2.cmml">e</mi><mrow id="S3.E7.m1.4.4.4.2.2" xref="S3.E7.m1.4.4.4.2.2.cmml"><mi id="S3.E7.m1.4.4.4.2.2.4" xref="S3.E7.m1.4.4.4.2.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.4.4.4.2.2.3" xref="S3.E7.m1.4.4.4.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.4.4.4.2.2.2.2" xref="S3.E7.m1.4.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.4.2.2.2.2.3" xref="S3.E7.m1.4.4.4.2.2.2.3.cmml">(</mo><msub id="S3.E7.m1.3.3.3.1.1.1.1.1" xref="S3.E7.m1.3.3.3.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.3.3.3.1.1.1.1.1.2" xref="S3.E7.m1.3.3.3.1.1.1.1.1.2a.cmml">v</mtext><mi id="S3.E7.m1.3.3.3.1.1.1.1.1.3" xref="S3.E7.m1.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.4.4.4.2.2.2.2.4" xref="S3.E7.m1.4.4.4.2.2.2.3.cmml">,</mo><msub id="S3.E7.m1.4.4.4.2.2.2.2.2" xref="S3.E7.m1.4.4.4.2.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.4.4.4.2.2.2.2.2.2" xref="S3.E7.m1.4.4.4.2.2.2.2.2.2a.cmml">l</mtext><mi id="S3.E7.m1.4.4.4.2.2.2.2.2.3" xref="S3.E7.m1.4.4.4.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E7.m1.4.4.4.2.2.2.2.5" xref="S3.E7.m1.4.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></msup><mo rspace="0.055em" id="S3.E7.m1.6.6.6.5" xref="S3.E7.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E7.m1.6.6.6.7" xref="S3.E7.m1.6.6.6.7.cmml"><msubsup id="S3.E7.m1.6.6.6.7.1" xref="S3.E7.m1.6.6.6.7.1.cmml"><mo id="S3.E7.m1.6.6.6.7.1.2.2" xref="S3.E7.m1.6.6.6.7.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.6.6.6.7.1.2.3" xref="S3.E7.m1.6.6.6.7.1.2.3.cmml"><mi id="S3.E7.m1.6.6.6.7.1.2.3.2" xref="S3.E7.m1.6.6.6.7.1.2.3.2.cmml">j</mi><mo id="S3.E7.m1.6.6.6.7.1.2.3.1" xref="S3.E7.m1.6.6.6.7.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.6.6.6.7.1.2.3.3" xref="S3.E7.m1.6.6.6.7.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E7.m1.6.6.6.7.1.3" xref="S3.E7.m1.6.6.6.7.1.3.cmml"><mi id="S3.E7.m1.6.6.6.7.1.3.2" xref="S3.E7.m1.6.6.6.7.1.3.2.cmml">N</mi><mtext id="S3.E7.m1.6.6.6.7.1.3.3" xref="S3.E7.m1.6.6.6.7.1.3.3a.cmml">neg</mtext></msub></msubsup><msup id="S3.E7.m1.6.6.6.7.2" xref="S3.E7.m1.6.6.6.7.2.cmml"><mi id="S3.E7.m1.6.6.6.7.2.2" xref="S3.E7.m1.6.6.6.7.2.2.cmml">e</mi><mrow id="S3.E7.m1.6.6.6.4.2" xref="S3.E7.m1.6.6.6.4.2.cmml"><mi id="S3.E7.m1.6.6.6.4.2.4" xref="S3.E7.m1.6.6.6.4.2.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.6.6.6.4.2.3" xref="S3.E7.m1.6.6.6.4.2.3.cmml">​</mo><mrow id="S3.E7.m1.6.6.6.4.2.2.2" xref="S3.E7.m1.6.6.6.4.2.2.3.cmml"><mo stretchy="false" id="S3.E7.m1.6.6.6.4.2.2.2.3" xref="S3.E7.m1.6.6.6.4.2.2.3.cmml">(</mo><msub id="S3.E7.m1.5.5.5.3.1.1.1.1" xref="S3.E7.m1.5.5.5.3.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.5.5.5.3.1.1.1.1.2" xref="S3.E7.m1.5.5.5.3.1.1.1.1.2a.cmml">v</mtext><mi id="S3.E7.m1.5.5.5.3.1.1.1.1.3" xref="S3.E7.m1.5.5.5.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.6.6.6.4.2.2.2.4" xref="S3.E7.m1.6.6.6.4.2.2.3.cmml">,</mo><msubsup id="S3.E7.m1.6.6.6.4.2.2.2.2" xref="S3.E7.m1.6.6.6.4.2.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E7.m1.6.6.6.4.2.2.2.2.2.2" xref="S3.E7.m1.6.6.6.4.2.2.2.2.2.2a.cmml">l</mtext><mrow id="S3.E7.m1.6.6.6.4.2.2.2.2.3" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.cmml"><mi id="S3.E7.m1.6.6.6.4.2.2.2.2.3.2" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.6.6.6.4.2.2.2.2.3.1" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.1.cmml">​</mo><mi id="S3.E7.m1.6.6.6.4.2.2.2.2.3.3" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.3.cmml">j</mi></mrow><mo id="S3.E7.m1.6.6.6.4.2.2.2.2.2.3" xref="S3.E7.m1.6.6.6.4.2.2.2.2.2.3.cmml">−</mo></msubsup><mo stretchy="false" id="S3.E7.m1.6.6.6.4.2.2.2.5" xref="S3.E7.m1.6.6.6.4.2.2.3.cmml">)</mo></mrow></mrow></msup></mrow></mrow></mfrac></mrow></mrow></mrow><mo lspace="0em" id="S3.E7.m1.7.7.1.2" xref="S3.E7.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.7b"><apply id="S3.E7.m1.7.7.1.1.cmml" xref="S3.E7.m1.7.7.1"><eq id="S3.E7.m1.7.7.1.1.1.cmml" xref="S3.E7.m1.7.7.1.1.1"></eq><apply id="S3.E7.m1.7.7.1.1.2.cmml" xref="S3.E7.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.1.cmml" xref="S3.E7.m1.7.7.1.1.2">superscript</csymbol><apply id="S3.E7.m1.7.7.1.1.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.2.2.1.cmml" xref="S3.E7.m1.7.7.1.1.2">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.2.2.2">𝐿</ci><ci id="S3.E7.m1.7.7.1.1.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.2.3">𝑙</ci></apply><apply id="S3.E7.m1.7.7.1.1.2.3.cmml" xref="S3.E7.m1.7.7.1.1.2.3"><times id="S3.E7.m1.7.7.1.1.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.2.3.1"></times><ci id="S3.E7.m1.7.7.1.1.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.2.3.2">𝑇</ci><ci id="S3.E7.m1.7.7.1.1.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.2.3.3">𝑟</ci><ci id="S3.E7.m1.7.7.1.1.2.3.4.cmml" xref="S3.E7.m1.7.7.1.1.2.3.4">𝑆</ci><ci id="S3.E7.m1.7.7.1.1.2.3.5.cmml" xref="S3.E7.m1.7.7.1.1.2.3.5">𝑚</ci></apply></apply><apply id="S3.E7.m1.7.7.1.1.3.cmml" xref="S3.E7.m1.7.7.1.1.3"><minus id="S3.E7.m1.7.7.1.1.3.1.cmml" xref="S3.E7.m1.7.7.1.1.3.1"></minus><apply id="S3.E7.m1.7.7.1.1.3.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2"><times id="S3.E7.m1.7.7.1.1.3.2.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.1"></times><apply id="S3.E7.m1.7.7.1.1.3.2.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2"><divide id="S3.E7.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2"></divide><cn type="integer" id="S3.E7.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2.2">1</cn><apply id="S3.E7.m1.7.7.1.1.3.2.2.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.3.2.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.3.2.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2.3.2">𝑁</ci><ci id="S3.E7.m1.7.7.1.1.3.2.2.3.3a.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2.3.3"><mtext mathsize="70%" id="S3.E7.m1.7.7.1.1.3.2.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.2.3.3">pos</mtext></ci></apply></apply><apply id="S3.E7.m1.7.7.1.1.3.2.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.3.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3">superscript</csymbol><apply id="S3.E7.m1.7.7.1.1.3.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.3.2.3.2.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3">subscript</csymbol><sum id="S3.E7.m1.7.7.1.1.3.2.3.2.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.2.2"></sum><apply id="S3.E7.m1.7.7.1.1.3.2.3.2.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3"><eq id="S3.E7.m1.7.7.1.1.3.2.3.2.3.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.1"></eq><ci id="S3.E7.m1.7.7.1.1.3.2.3.2.3.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.7.7.1.1.3.2.3.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.7.7.1.1.3.2.3.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.1.1.3.2.3.3.1.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.3">subscript</csymbol><ci id="S3.E7.m1.7.7.1.1.3.2.3.3.2.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.3.2">𝑁</ci><ci id="S3.E7.m1.7.7.1.1.3.2.3.3.3a.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.3.3"><mtext mathsize="50%" id="S3.E7.m1.7.7.1.1.3.2.3.3.3.cmml" xref="S3.E7.m1.7.7.1.1.3.2.3.3.3">pos</mtext></ci></apply></apply></apply><apply id="S3.E7.m1.7.7.1.1.3.3.cmml" xref="S3.E7.m1.7.7.1.1.3.3"><log id="S3.E7.m1.7.7.1.1.3.3.1.cmml" xref="S3.E7.m1.7.7.1.1.3.3.1"></log><apply id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6"><divide id="S3.E7.m1.6.6.7.cmml" xref="S3.E7.m1.6.6"></divide><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2">superscript</csymbol><ci id="S3.E7.m1.2.2.2.4.cmml" xref="S3.E7.m1.2.2.2.4">𝑒</ci><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2"><times id="S3.E7.m1.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.3"></times><ci id="S3.E7.m1.2.2.2.2.2.4.cmml" xref="S3.E7.m1.2.2.2.2.2.4">𝑠</ci><interval closure="open" id="S3.E7.m1.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.2a.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2">v</mtext></ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.2.2.2.2.2a.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E7.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2.2">l</mtext></ci><ci id="S3.E7.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.E7.m1.6.6.6.cmml" xref="S3.E7.m1.6.6.6"><plus id="S3.E7.m1.6.6.6.5.cmml" xref="S3.E7.m1.6.6.6.5"></plus><apply id="S3.E7.m1.6.6.6.6.cmml" xref="S3.E7.m1.6.6.6.6"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.6.1.cmml" xref="S3.E7.m1.6.6.6.6">superscript</csymbol><ci id="S3.E7.m1.6.6.6.6.2.cmml" xref="S3.E7.m1.6.6.6.6.2">𝑒</ci><apply id="S3.E7.m1.4.4.4.2.2.cmml" xref="S3.E7.m1.4.4.4.2.2"><times id="S3.E7.m1.4.4.4.2.2.3.cmml" xref="S3.E7.m1.4.4.4.2.2.3"></times><ci id="S3.E7.m1.4.4.4.2.2.4.cmml" xref="S3.E7.m1.4.4.4.2.2.4">𝑠</ci><interval closure="open" id="S3.E7.m1.4.4.4.2.2.2.3.cmml" xref="S3.E7.m1.4.4.4.2.2.2.2"><apply id="S3.E7.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.2a.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E7.m1.3.3.3.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.2">v</mtext></ci><ci id="S3.E7.m1.3.3.3.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.3.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m1.4.4.4.2.2.2.2.2.cmml" xref="S3.E7.m1.4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.4.2.2.2.2.2.1.cmml" xref="S3.E7.m1.4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.4.4.4.2.2.2.2.2.2a.cmml" xref="S3.E7.m1.4.4.4.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E7.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S3.E7.m1.4.4.4.2.2.2.2.2.2">l</mtext></ci><ci id="S3.E7.m1.4.4.4.2.2.2.2.2.3.cmml" xref="S3.E7.m1.4.4.4.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.E7.m1.6.6.6.7.cmml" xref="S3.E7.m1.6.6.6.7"><apply id="S3.E7.m1.6.6.6.7.1.cmml" xref="S3.E7.m1.6.6.6.7.1"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.7.1.1.cmml" xref="S3.E7.m1.6.6.6.7.1">superscript</csymbol><apply id="S3.E7.m1.6.6.6.7.1.2.cmml" xref="S3.E7.m1.6.6.6.7.1"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.7.1.2.1.cmml" xref="S3.E7.m1.6.6.6.7.1">subscript</csymbol><sum id="S3.E7.m1.6.6.6.7.1.2.2.cmml" xref="S3.E7.m1.6.6.6.7.1.2.2"></sum><apply id="S3.E7.m1.6.6.6.7.1.2.3.cmml" xref="S3.E7.m1.6.6.6.7.1.2.3"><eq id="S3.E7.m1.6.6.6.7.1.2.3.1.cmml" xref="S3.E7.m1.6.6.6.7.1.2.3.1"></eq><ci id="S3.E7.m1.6.6.6.7.1.2.3.2.cmml" xref="S3.E7.m1.6.6.6.7.1.2.3.2">𝑗</ci><cn type="integer" id="S3.E7.m1.6.6.6.7.1.2.3.3.cmml" xref="S3.E7.m1.6.6.6.7.1.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.6.6.6.7.1.3.cmml" xref="S3.E7.m1.6.6.6.7.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.7.1.3.1.cmml" xref="S3.E7.m1.6.6.6.7.1.3">subscript</csymbol><ci id="S3.E7.m1.6.6.6.7.1.3.2.cmml" xref="S3.E7.m1.6.6.6.7.1.3.2">𝑁</ci><ci id="S3.E7.m1.6.6.6.7.1.3.3a.cmml" xref="S3.E7.m1.6.6.6.7.1.3.3"><mtext mathsize="50%" id="S3.E7.m1.6.6.6.7.1.3.3.cmml" xref="S3.E7.m1.6.6.6.7.1.3.3">neg</mtext></ci></apply></apply><apply id="S3.E7.m1.6.6.6.7.2.cmml" xref="S3.E7.m1.6.6.6.7.2"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.7.2.1.cmml" xref="S3.E7.m1.6.6.6.7.2">superscript</csymbol><ci id="S3.E7.m1.6.6.6.7.2.2.cmml" xref="S3.E7.m1.6.6.6.7.2.2">𝑒</ci><apply id="S3.E7.m1.6.6.6.4.2.cmml" xref="S3.E7.m1.6.6.6.4.2"><times id="S3.E7.m1.6.6.6.4.2.3.cmml" xref="S3.E7.m1.6.6.6.4.2.3"></times><ci id="S3.E7.m1.6.6.6.4.2.4.cmml" xref="S3.E7.m1.6.6.6.4.2.4">𝑠</ci><interval closure="open" id="S3.E7.m1.6.6.6.4.2.2.3.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2"><apply id="S3.E7.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.3.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.5.3.1.1.1.1.2a.cmml" xref="S3.E7.m1.5.5.5.3.1.1.1.1.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E7.m1.5.5.5.3.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.5.3.1.1.1.1.2">v</mtext></ci><ci id="S3.E7.m1.5.5.5.3.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.5.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m1.6.6.6.4.2.2.2.2.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.4.2.2.2.2.1.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2">subscript</csymbol><apply id="S3.E7.m1.6.6.6.4.2.2.2.2.2.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.6.4.2.2.2.2.2.1.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2">superscript</csymbol><ci id="S3.E7.m1.6.6.6.4.2.2.2.2.2.2a.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.2.2"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="S3.E7.m1.6.6.6.4.2.2.2.2.2.2.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.2.2">l</mtext></ci><minus id="S3.E7.m1.6.6.6.4.2.2.2.2.2.3.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.2.3"></minus></apply><apply id="S3.E7.m1.6.6.6.4.2.2.2.2.3.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3"><times id="S3.E7.m1.6.6.6.4.2.2.2.2.3.1.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.1"></times><ci id="S3.E7.m1.6.6.6.4.2.2.2.2.3.2.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.2">𝑖</ci><ci id="S3.E7.m1.6.6.6.4.2.2.2.2.3.3.cmml" xref="S3.E7.m1.6.6.6.4.2.2.2.2.3.3">𝑗</ci></apply></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.7c">L_{l}^{TrSm}=\frac{1}{N_{\text{pos}}}\sum_{i=1}^{N_{\text{pos}}}-\log\frac{e^{s(\textbf{v}_{i},\textbf{l}_{i})}}{e^{s(\textbf{v}_{i},\textbf{l}_{i})}+\sum_{j=1}^{N_{\text{neg}}}e^{s(\textbf{v}_{i},\textbf{l}^{-}_{ij})}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p3.12" class="ltx_p">In these equations, we denote by <math id="S3.SS2.p3.10.m1.1" class="ltx_Math" alttext="N_{\text{pos}}" display="inline"><semantics id="S3.SS2.p3.10.m1.1a"><msub id="S3.SS2.p3.10.m1.1.1" xref="S3.SS2.p3.10.m1.1.1.cmml"><mi id="S3.SS2.p3.10.m1.1.1.2" xref="S3.SS2.p3.10.m1.1.1.2.cmml">N</mi><mtext id="S3.SS2.p3.10.m1.1.1.3" xref="S3.SS2.p3.10.m1.1.1.3a.cmml">pos</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m1.1b"><apply id="S3.SS2.p3.10.m1.1.1.cmml" xref="S3.SS2.p3.10.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m1.1.1.1.cmml" xref="S3.SS2.p3.10.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m1.1.1.2.cmml" xref="S3.SS2.p3.10.m1.1.1.2">𝑁</ci><ci id="S3.SS2.p3.10.m1.1.1.3a.cmml" xref="S3.SS2.p3.10.m1.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.10.m1.1.1.3.cmml" xref="S3.SS2.p3.10.m1.1.1.3">pos</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m1.1c">N_{\text{pos}}</annotation></semantics></math> the number of positive samples in a training batch and <math id="S3.SS2.p3.11.m2.1" class="ltx_Math" alttext="N_{\text{neg}}" display="inline"><semantics id="S3.SS2.p3.11.m2.1a"><msub id="S3.SS2.p3.11.m2.1.1" xref="S3.SS2.p3.11.m2.1.1.cmml"><mi id="S3.SS2.p3.11.m2.1.1.2" xref="S3.SS2.p3.11.m2.1.1.2.cmml">N</mi><mtext id="S3.SS2.p3.11.m2.1.1.3" xref="S3.SS2.p3.11.m2.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.11.m2.1b"><apply id="S3.SS2.p3.11.m2.1.1.cmml" xref="S3.SS2.p3.11.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.11.m2.1.1.1.cmml" xref="S3.SS2.p3.11.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.11.m2.1.1.2.cmml" xref="S3.SS2.p3.11.m2.1.1.2">𝑁</ci><ci id="S3.SS2.p3.11.m2.1.1.3a.cmml" xref="S3.SS2.p3.11.m2.1.1.3"><mtext mathsize="70%" id="S3.SS2.p3.11.m2.1.1.3.cmml" xref="S3.SS2.p3.11.m2.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.11.m2.1c">N_{\text{neg}}</annotation></semantics></math> the number of negative samples to pair with each positive sample. The function <math id="S3.SS2.p3.12.m3.2" class="ltx_Math" alttext="s(\cdot,\cdot)" display="inline"><semantics id="S3.SS2.p3.12.m3.2a"><mrow id="S3.SS2.p3.12.m3.2.3" xref="S3.SS2.p3.12.m3.2.3.cmml"><mi id="S3.SS2.p3.12.m3.2.3.2" xref="S3.SS2.p3.12.m3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.12.m3.2.3.1" xref="S3.SS2.p3.12.m3.2.3.1.cmml">​</mo><mrow id="S3.SS2.p3.12.m3.2.3.3.2" xref="S3.SS2.p3.12.m3.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.12.m3.2.3.3.2.1" xref="S3.SS2.p3.12.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.12.m3.1.1" xref="S3.SS2.p3.12.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p3.12.m3.2.3.3.2.2" xref="S3.SS2.p3.12.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.12.m3.2.2" xref="S3.SS2.p3.12.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p3.12.m3.2.3.3.2.3" xref="S3.SS2.p3.12.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.12.m3.2b"><apply id="S3.SS2.p3.12.m3.2.3.cmml" xref="S3.SS2.p3.12.m3.2.3"><times id="S3.SS2.p3.12.m3.2.3.1.cmml" xref="S3.SS2.p3.12.m3.2.3.1"></times><ci id="S3.SS2.p3.12.m3.2.3.2.cmml" xref="S3.SS2.p3.12.m3.2.3.2">𝑠</ci><interval closure="open" id="S3.SS2.p3.12.m3.2.3.3.1.cmml" xref="S3.SS2.p3.12.m3.2.3.3.2"><ci id="S3.SS2.p3.12.m3.1.1.cmml" xref="S3.SS2.p3.12.m3.1.1">⋅</ci><ci id="S3.SS2.p3.12.m3.2.2.cmml" xref="S3.SS2.p3.12.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.12.m3.2c">s(\cdot,\cdot)</annotation></semantics></math> computes cosine similarity.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/1812.09681/assets/figures/RelationEncoder.jpg" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="225" height="482" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S3.F3.8.1" class="ltx_text ltx_font_bold">Illustration of the visual relationship encoder.</span> <math id="S3.F3.4.m1.1" class="ltx_Math" alttext="L_{s}" display="inline"><semantics id="S3.F3.4.m1.1b"><msub id="S3.F3.4.m1.1.1" xref="S3.F3.4.m1.1.1.cmml"><mi id="S3.F3.4.m1.1.1.2" xref="S3.F3.4.m1.1.1.2.cmml">L</mi><mi id="S3.F3.4.m1.1.1.3" xref="S3.F3.4.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.4.m1.1c"><apply id="S3.F3.4.m1.1.1.cmml" xref="S3.F3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.F3.4.m1.1.1.1.cmml" xref="S3.F3.4.m1.1.1">subscript</csymbol><ci id="S3.F3.4.m1.1.1.2.cmml" xref="S3.F3.4.m1.1.1.2">𝐿</ci><ci id="S3.F3.4.m1.1.1.3.cmml" xref="S3.F3.4.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.4.m1.1d">L_{s}</annotation></semantics></math>, <math id="S3.F3.5.m2.1" class="ltx_Math" alttext="L_{o}" display="inline"><semantics id="S3.F3.5.m2.1b"><msub id="S3.F3.5.m2.1.1" xref="S3.F3.5.m2.1.1.cmml"><mi id="S3.F3.5.m2.1.1.2" xref="S3.F3.5.m2.1.1.2.cmml">L</mi><mi id="S3.F3.5.m2.1.1.3" xref="S3.F3.5.m2.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.5.m2.1c"><apply id="S3.F3.5.m2.1.1.cmml" xref="S3.F3.5.m2.1.1"><csymbol cd="ambiguous" id="S3.F3.5.m2.1.1.1.cmml" xref="S3.F3.5.m2.1.1">subscript</csymbol><ci id="S3.F3.5.m2.1.1.2.cmml" xref="S3.F3.5.m2.1.1.2">𝐿</ci><ci id="S3.F3.5.m2.1.1.3.cmml" xref="S3.F3.5.m2.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.5.m2.1d">L_{o}</annotation></semantics></math> and <math id="S3.F3.6.m3.1" class="ltx_Math" alttext="L_{r}" display="inline"><semantics id="S3.F3.6.m3.1b"><msub id="S3.F3.6.m3.1.1" xref="S3.F3.6.m3.1.1.cmml"><mi id="S3.F3.6.m3.1.1.2" xref="S3.F3.6.m3.1.1.2.cmml">L</mi><mi id="S3.F3.6.m3.1.1.3" xref="S3.F3.6.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F3.6.m3.1c"><apply id="S3.F3.6.m3.1.1.cmml" xref="S3.F3.6.m3.1.1"><csymbol cd="ambiguous" id="S3.F3.6.m3.1.1.1.cmml" xref="S3.F3.6.m3.1.1">subscript</csymbol><ci id="S3.F3.6.m3.1.1.2.cmml" xref="S3.F3.6.m3.1.1.2">𝐿</ci><ci id="S3.F3.6.m3.1.1.3.cmml" xref="S3.F3.6.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.6.m3.1d">L_{r}</annotation></semantics></math>, shown in the blue box, are loss terms respectively computed form subject, object and relation embeddings. The visual module is placed above the blue box and the language module below.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Scene graph convolution</span>
</h3>

<figure id="S3.F4" class="ltx_figure"><img src="/html/1812.09681/assets/x3.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="207" height="187" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S3.F4.4.1" class="ltx_text ltx_font_bold">Illustration of the scene graph convolution operation</span> working in conjunction with the question-relation guided self-attention. The <math id="S3.F4.2.m1.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S3.F4.2.m1.1b"><mo id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><compose id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">\circ</annotation></semantics></math> operator denotes element-wise multiplication. Different trainable parameters are annotated with different colors. The blue dashed box encircles the computation of the question-relation guided self-attention.</figcaption>
</figure>
<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The scene graph convolution operation, based on graph attention networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, updates each node’s representation by aggregating information from neighbor nodes and the relationships between them. The <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_italic">question-relation guided self-attention</span> mechanism is used to infer the relevance of inter-object relationships to the question. The attention mechanism is multi-headed, allowing the operation to examine interactions among three or more objects. The complete computation process of updating node <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">v</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑣</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">v_{i}</annotation></semantics></math>’s hidden state through scene graph convolution is depicted in Fig.<a href="#S3.F4" title="Figure 4 ‣ III-C Scene graph convolution ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.4" class="ltx_p">Denote by <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\textbf{h}_{i}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2a.cmml">h</mtext><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2a.cmml" xref="S3.SS3.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">h</mtext></ci><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\textbf{h}_{i}</annotation></semantics></math> the hidden state of node <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑣</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">v_{i}</annotation></semantics></math> and <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="V_{i}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">V</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑉</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">V_{i}</annotation></semantics></math> the set of nodes that are neighbor to <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">v</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑣</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">v_{i}</annotation></semantics></math>, the scene graph convolution on a single node is performed by:</p>
<ol id="S3.I1" class="ltx_enumerate">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.2" class="ltx_p">linearly projecting each object embedding (in our case from <math id="S3.I1.i1.p1.1.m1.2" class="ltx_Math" alttext="2,048" display="inline"><semantics id="S3.I1.i1.p1.1.m1.2a"><mrow id="S3.I1.i1.p1.1.m1.2.3.2" xref="S3.I1.i1.p1.1.m1.2.3.1.cmml"><mn id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">2</mn><mo id="S3.I1.i1.p1.1.m1.2.3.2.1" xref="S3.I1.i1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S3.I1.i1.p1.1.m1.2.2" xref="S3.I1.i1.p1.1.m1.2.2.cmml">048</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.2b"><list id="S3.I1.i1.p1.1.m1.2.3.1.cmml" xref="S3.I1.i1.p1.1.m1.2.3.2"><cn type="integer" id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">2</cn><cn type="integer" id="S3.I1.i1.p1.1.m1.2.2.cmml" xref="S3.I1.i1.p1.1.m1.2.2">048</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.2c">2,048</annotation></semantics></math> dimensions to <math id="S3.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S3.I1.i1.p1.2.m2.1a"><mn id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><cn type="integer" id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">512</annotation></semantics></math> dimensions):</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\textbf{h}_{i}^{p}=\textbf{W}_{p}\cdot\textbf{h}_{i}+\textbf{b}," display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><msubsup id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.2.2.2" xref="S3.E8.m1.1.1.1.1.2.2.2a.cmml">h</mtext><mi id="S3.E8.m1.1.1.1.1.2.2.3" xref="S3.E8.m1.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E8.m1.1.1.1.1.2.3" xref="S3.E8.m1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><mrow id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><msub id="S3.E8.m1.1.1.1.1.3.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2a.cmml">W</mtext><mi id="S3.E8.m1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E8.m1.1.1.1.1.3.2.1" xref="S3.E8.m1.1.1.1.1.3.2.1.cmml">⋅</mo><msub id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2a.cmml">h</mtext><mi id="S3.E8.m1.1.1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E8.m1.1.1.1.1.3.1" xref="S3.E8.m1.1.1.1.1.3.1.cmml">+</mo><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3a.cmml">b</mtext></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><apply id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.2.2.2a.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.2.2.2">h</mtext></ci><ci id="S3.E8.m1.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.1.1.2.3">𝑝</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><plus id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><ci id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.1">⋅</ci><apply id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.2a.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2">W</mtext></ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3">𝑝</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.3.2a.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2">h</mtext></ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.E8.m1.1.1.1.1.3.3a.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><mtext class="ltx_mathvariant_bold" id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3">b</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\textbf{h}_{i}^{p}=\textbf{W}_{p}\cdot\textbf{h}_{i}+\textbf{b},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.I1.i1.p1.4" class="ltx_p">where <math id="S3.I1.i1.p1.3.m1.1" class="ltx_Math" alttext="\textbf{h}_{i}^{p}" display="inline"><semantics id="S3.I1.i1.p1.3.m1.1a"><msubsup id="S3.I1.i1.p1.3.m1.1.1" xref="S3.I1.i1.p1.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.I1.i1.p1.3.m1.1.1.2.2" xref="S3.I1.i1.p1.3.m1.1.1.2.2a.cmml">h</mtext><mi id="S3.I1.i1.p1.3.m1.1.1.2.3" xref="S3.I1.i1.p1.3.m1.1.1.2.3.cmml">i</mi><mi id="S3.I1.i1.p1.3.m1.1.1.3" xref="S3.I1.i1.p1.3.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m1.1b"><apply id="S3.I1.i1.p1.3.m1.1.1.cmml" xref="S3.I1.i1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.3.m1.1.1.1.cmml" xref="S3.I1.i1.p1.3.m1.1.1">superscript</csymbol><apply id="S3.I1.i1.p1.3.m1.1.1.2.cmml" xref="S3.I1.i1.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.3.m1.1.1.2.1.cmml" xref="S3.I1.i1.p1.3.m1.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.3.m1.1.1.2.2a.cmml" xref="S3.I1.i1.p1.3.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.I1.i1.p1.3.m1.1.1.2.2.cmml" xref="S3.I1.i1.p1.3.m1.1.1.2.2">h</mtext></ci><ci id="S3.I1.i1.p1.3.m1.1.1.2.3.cmml" xref="S3.I1.i1.p1.3.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.I1.i1.p1.3.m1.1.1.3.cmml" xref="S3.I1.i1.p1.3.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m1.1c">\textbf{h}_{i}^{p}</annotation></semantics></math> is the resultant projected hidden state of node <math id="S3.I1.i1.p1.4.m2.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.I1.i1.p1.4.m2.1a"><msub id="S3.I1.i1.p1.4.m2.1.1" xref="S3.I1.i1.p1.4.m2.1.1.cmml"><mi id="S3.I1.i1.p1.4.m2.1.1.2" xref="S3.I1.i1.p1.4.m2.1.1.2.cmml">v</mi><mi id="S3.I1.i1.p1.4.m2.1.1.3" xref="S3.I1.i1.p1.4.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.4.m2.1b"><apply id="S3.I1.i1.p1.4.m2.1.1.cmml" xref="S3.I1.i1.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.4.m2.1.1.1.cmml" xref="S3.I1.i1.p1.4.m2.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.4.m2.1.1.2.cmml" xref="S3.I1.i1.p1.4.m2.1.1.2">𝑣</ci><ci id="S3.I1.i1.p1.4.m2.1.1.3.cmml" xref="S3.I1.i1.p1.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.4.m2.1c">v_{i}</annotation></semantics></math>;</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">concatenating the projected object features with relationship embeddings (<math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\|" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mo id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">∥</mo><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">∥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\|</annotation></semantics></math> denotes concatenation):</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="\textbf{h}_{ji}^{f}=\sigma(\textbf{h}^{p}_{j})~{}\|~{}\textbf{r}_{ji}," display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msubsup id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2a.cmml">h</mtext><mrow id="S3.E9.m1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.3.2" xref="S3.E9.m1.1.1.1.1.3.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.3.2.3.1" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.3.2.3.3" xref="S3.E9.m1.1.1.1.1.3.2.3.3.cmml">i</mi></mrow><mi id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml">f</mi></msubsup><mo id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2a.cmml">h</mtext><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo rspace="0.330em" stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.608em" id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">∥</mo><msub id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.3.2a.cmml">r</mtext><mrow id="S3.E9.m1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"></eq><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.2a.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2">h</mtext></ci><apply id="S3.E9.m1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3"><times id="S3.E9.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E9.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.2">𝑗</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3">𝑓</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">𝜎</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.2">h</mtext></ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.2.3">𝑝</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.3.2a.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E9.m1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.2">r</mtext></ci><apply id="S3.E9.m1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3"><times id="S3.E9.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3.2">𝑗</ci><ci id="S3.E9.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">\textbf{h}_{ji}^{f}=\sigma(\textbf{h}^{p}_{j})~{}\|~{}\textbf{r}_{ji},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.I1.i2.p1.2" class="ltx_p">where <math id="S3.I1.i2.p1.2.m1.1" class="ltx_Math" alttext="\textbf{h}_{ji}^{f}" display="inline"><semantics id="S3.I1.i2.p1.2.m1.1a"><msubsup id="S3.I1.i2.p1.2.m1.1.1" xref="S3.I1.i2.p1.2.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.I1.i2.p1.2.m1.1.1.2.2" xref="S3.I1.i2.p1.2.m1.1.1.2.2a.cmml">h</mtext><mrow id="S3.I1.i2.p1.2.m1.1.1.2.3" xref="S3.I1.i2.p1.2.m1.1.1.2.3.cmml"><mi id="S3.I1.i2.p1.2.m1.1.1.2.3.2" xref="S3.I1.i2.p1.2.m1.1.1.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.I1.i2.p1.2.m1.1.1.2.3.1" xref="S3.I1.i2.p1.2.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.I1.i2.p1.2.m1.1.1.2.3.3" xref="S3.I1.i2.p1.2.m1.1.1.2.3.3.cmml">i</mi></mrow><mi id="S3.I1.i2.p1.2.m1.1.1.3" xref="S3.I1.i2.p1.2.m1.1.1.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m1.1b"><apply id="S3.I1.i2.p1.2.m1.1.1.cmml" xref="S3.I1.i2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m1.1.1">superscript</csymbol><apply id="S3.I1.i2.p1.2.m1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m1.1.1.2.1.cmml" xref="S3.I1.i2.p1.2.m1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.2.m1.1.1.2.2a.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.I1.i2.p1.2.m1.1.1.2.2.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2.2">h</mtext></ci><apply id="S3.I1.i2.p1.2.m1.1.1.2.3.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2.3"><times id="S3.I1.i2.p1.2.m1.1.1.2.3.1.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2.3.1"></times><ci id="S3.I1.i2.p1.2.m1.1.1.2.3.2.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2.3.2">𝑗</ci><ci id="S3.I1.i2.p1.2.m1.1.1.2.3.3.cmml" xref="S3.I1.i2.p1.2.m1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.I1.i2.p1.2.m1.1.1.3.cmml" xref="S3.I1.i2.p1.2.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m1.1c">\textbf{h}_{ji}^{f}</annotation></semantics></math> is the concatenated vector;</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.7" class="ltx_p">updating the projected object embeddings:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.3" class="ltx_Math" alttext="\textbf{h}^{s}_{i}=\sigma\left(\textbf{h}_{i}^{p}+\mathop{\|}\limits_{k=1}^{K}{\sum_{j\in V_{i}}{\omega_{ji,k}(\textbf{W}_{k}\cdot\textbf{h}_{ji}^{f})}}\right)," display="block"><semantics id="S3.E10.m1.3a"><mrow id="S3.E10.m1.3.3.1" xref="S3.E10.m1.3.3.1.1.cmml"><mrow id="S3.E10.m1.3.3.1.1" xref="S3.E10.m1.3.3.1.1.cmml"><msubsup id="S3.E10.m1.3.3.1.1.3" xref="S3.E10.m1.3.3.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.3.2.2" xref="S3.E10.m1.3.3.1.1.3.2.2a.cmml">h</mtext><mi id="S3.E10.m1.3.3.1.1.3.3" xref="S3.E10.m1.3.3.1.1.3.3.cmml">i</mi><mi id="S3.E10.m1.3.3.1.1.3.2.3" xref="S3.E10.m1.3.3.1.1.3.2.3.cmml">s</mi></msubsup><mo id="S3.E10.m1.3.3.1.1.2" xref="S3.E10.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.3.3.1.1.1" xref="S3.E10.m1.3.3.1.1.1.cmml"><mi id="S3.E10.m1.3.3.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.3.3.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml"><msubsup id="S3.E10.m1.3.3.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.2a.cmml">h</mtext><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.3.cmml">p</mi></msubsup><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.cmml"><munderover id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml">∥</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">K</mi></munderover><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml"><munder id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.cmml">j</mi><mo id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.2.cmml">V</mi><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mrow></munder><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">ω</mi><mrow id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.3.cmml"><mrow id="S3.E10.m1.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.1.cmml"><mi id="S3.E10.m1.2.2.2.2.1.2" xref="S3.E10.m1.2.2.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E10.m1.2.2.2.2.1.3" xref="S3.E10.m1.2.2.2.2.1.3.cmml">i</mi></mrow><mo id="S3.E10.m1.2.2.2.2.2" xref="S3.E10.m1.2.2.2.3.cmml">,</mo><mi id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml">W</mtext><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⋅</mo><msubsup id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2a.cmml">h</mtext><mrow id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></mrow><mi id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">f</mi></msubsup></mrow><mo stretchy="false" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.3.3.1.1.1.1.1.3" xref="S3.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.3.3.1.2" xref="S3.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.3b"><apply id="S3.E10.m1.3.3.1.1.cmml" xref="S3.E10.m1.3.3.1"><eq id="S3.E10.m1.3.3.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.2"></eq><apply id="S3.E10.m1.3.3.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.3.1.cmml" xref="S3.E10.m1.3.3.1.1.3">subscript</csymbol><apply id="S3.E10.m1.3.3.1.1.3.2.cmml" xref="S3.E10.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.3.2.1.cmml" xref="S3.E10.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E10.m1.3.3.1.1.3.2.2a.cmml" xref="S3.E10.m1.3.3.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.3.2.2.cmml" xref="S3.E10.m1.3.3.1.1.3.2.2">h</mtext></ci><ci id="S3.E10.m1.3.3.1.1.3.2.3.cmml" xref="S3.E10.m1.3.3.1.1.3.2.3">𝑠</ci></apply><ci id="S3.E10.m1.3.3.1.1.3.3.cmml" xref="S3.E10.m1.3.3.1.1.3.3">𝑖</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1"><times id="S3.E10.m1.3.3.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.2"></times><ci id="S3.E10.m1.3.3.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.3">𝜎</ci><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1"><plus id="S3.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.2"></plus><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.2">h</mtext></ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.3.3">𝑝</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1"><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.2">∥</ci><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1"><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3"><in id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.1"></in><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.2">𝑗</ci><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.2">𝑉</ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.3.2">𝜔</ci><list id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2"><apply id="S3.E10.m1.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.1"><times id="S3.E10.m1.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1"></times><ci id="S3.E10.m1.2.2.2.2.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.2">𝑗</ci><ci id="S3.E10.m1.2.2.2.2.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.3">𝑖</ci></apply><ci id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1">𝑘</ci></list></apply><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1">⋅</ci><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">W</mtext></ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2">h</mtext></ci><apply id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3"><times id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝑗</ci><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑓</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.3c">\textbf{h}^{s}_{i}=\sigma\left(\textbf{h}_{i}^{p}+\mathop{\|}\limits_{k=1}^{K}{\sum_{j\in V_{i}}{\omega_{ji,k}(\textbf{W}_{k}\cdot\textbf{h}_{ji}^{f})}}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.I1.i3.p1.6" class="ltx_p">where <math id="S3.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.I1.i3.p1.1.m1.1a"><mi id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.1b"><ci id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.1c">\sigma</annotation></semantics></math> denotes <span id="S3.I1.i3.p1.6.1" class="ltx_text ltx_font_italic">ReLU</span> activation. <math id="S3.I1.i3.p1.2.m2.3" class="ltx_Math" alttext="\omega^{(l)}_{ji,k}" display="inline"><semantics id="S3.I1.i3.p1.2.m2.3a"><msubsup id="S3.I1.i3.p1.2.m2.3.4" xref="S3.I1.i3.p1.2.m2.3.4.cmml"><mi id="S3.I1.i3.p1.2.m2.3.4.2.2" xref="S3.I1.i3.p1.2.m2.3.4.2.2.cmml">ω</mi><mrow id="S3.I1.i3.p1.2.m2.3.3.2.2" xref="S3.I1.i3.p1.2.m2.3.3.2.3.cmml"><mrow id="S3.I1.i3.p1.2.m2.3.3.2.2.1" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.cmml"><mi id="S3.I1.i3.p1.2.m2.3.3.2.2.1.2" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.I1.i3.p1.2.m2.3.3.2.2.1.1" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.1.cmml">​</mo><mi id="S3.I1.i3.p1.2.m2.3.3.2.2.1.3" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.3.cmml">i</mi></mrow><mo id="S3.I1.i3.p1.2.m2.3.3.2.2.2" xref="S3.I1.i3.p1.2.m2.3.3.2.3.cmml">,</mo><mi id="S3.I1.i3.p1.2.m2.2.2.1.1" xref="S3.I1.i3.p1.2.m2.2.2.1.1.cmml">k</mi></mrow><mrow id="S3.I1.i3.p1.2.m2.1.1.1.3" xref="S3.I1.i3.p1.2.m2.3.4.cmml"><mo stretchy="false" id="S3.I1.i3.p1.2.m2.1.1.1.3.1" xref="S3.I1.i3.p1.2.m2.3.4.cmml">(</mo><mi id="S3.I1.i3.p1.2.m2.1.1.1.1" xref="S3.I1.i3.p1.2.m2.1.1.1.1.cmml">l</mi><mo stretchy="false" id="S3.I1.i3.p1.2.m2.1.1.1.3.2" xref="S3.I1.i3.p1.2.m2.3.4.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.3b"><apply id="S3.I1.i3.p1.2.m2.3.4.cmml" xref="S3.I1.i3.p1.2.m2.3.4"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.3.4.1.cmml" xref="S3.I1.i3.p1.2.m2.3.4">subscript</csymbol><apply id="S3.I1.i3.p1.2.m2.3.4.2.cmml" xref="S3.I1.i3.p1.2.m2.3.4"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.3.4.2.1.cmml" xref="S3.I1.i3.p1.2.m2.3.4">superscript</csymbol><ci id="S3.I1.i3.p1.2.m2.3.4.2.2.cmml" xref="S3.I1.i3.p1.2.m2.3.4.2.2">𝜔</ci><ci id="S3.I1.i3.p1.2.m2.1.1.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1.1.1">𝑙</ci></apply><list id="S3.I1.i3.p1.2.m2.3.3.2.3.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2"><apply id="S3.I1.i3.p1.2.m2.3.3.2.2.1.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1"><times id="S3.I1.i3.p1.2.m2.3.3.2.2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.1"></times><ci id="S3.I1.i3.p1.2.m2.3.3.2.2.1.2.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.2">𝑗</ci><ci id="S3.I1.i3.p1.2.m2.3.3.2.2.1.3.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2.1.3">𝑖</ci></apply><ci id="S3.I1.i3.p1.2.m2.2.2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.2.2.1.1">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.3c">\omega^{(l)}_{ji,k}</annotation></semantics></math> is an attention weight — a scalar that describes the extent to which node <math id="S3.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.I1.i3.p1.3.m3.1a"><msub id="S3.I1.i3.p1.3.m3.1.1" xref="S3.I1.i3.p1.3.m3.1.1.cmml"><mi id="S3.I1.i3.p1.3.m3.1.1.2" xref="S3.I1.i3.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.I1.i3.p1.3.m3.1.1.3" xref="S3.I1.i3.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m3.1b"><apply id="S3.I1.i3.p1.3.m3.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.3.m3.1.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.3.m3.1.1.2.cmml" xref="S3.I1.i3.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.I1.i3.p1.3.m3.1.1.3.cmml" xref="S3.I1.i3.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m3.1c">v_{j}</annotation></semantics></math> correlates to <math id="S3.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.I1.i3.p1.4.m4.1a"><msub id="S3.I1.i3.p1.4.m4.1.1" xref="S3.I1.i3.p1.4.m4.1.1.cmml"><mi id="S3.I1.i3.p1.4.m4.1.1.2" xref="S3.I1.i3.p1.4.m4.1.1.2.cmml">v</mi><mi id="S3.I1.i3.p1.4.m4.1.1.3" xref="S3.I1.i3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.4.m4.1b"><apply id="S3.I1.i3.p1.4.m4.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.4.m4.1.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.4.m4.1.1.2.cmml" xref="S3.I1.i3.p1.4.m4.1.1.2">𝑣</ci><ci id="S3.I1.i3.p1.4.m4.1.1.3.cmml" xref="S3.I1.i3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.4.m4.1c">v_{i}</annotation></semantics></math>. This attention weight is computed by the Question-relation guided self-attention. The <math id="S3.I1.i3.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.I1.i3.p1.5.m5.1a"><mi id="S3.I1.i3.p1.5.m5.1.1" xref="S3.I1.i3.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.5.m5.1b"><ci id="S3.I1.i3.p1.5.m5.1.1.cmml" xref="S3.I1.i3.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.5.m5.1c">k</annotation></semantics></math> subscript marks the subscripted parameter or attention weight as used by the <math id="S3.I1.i3.p1.6.m6.1" class="ltx_Math" alttext="k_{\text{th}}" display="inline"><semantics id="S3.I1.i3.p1.6.m6.1a"><msub id="S3.I1.i3.p1.6.m6.1.1" xref="S3.I1.i3.p1.6.m6.1.1.cmml"><mi id="S3.I1.i3.p1.6.m6.1.1.2" xref="S3.I1.i3.p1.6.m6.1.1.2.cmml">k</mi><mtext id="S3.I1.i3.p1.6.m6.1.1.3" xref="S3.I1.i3.p1.6.m6.1.1.3a.cmml">th</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.6.m6.1b"><apply id="S3.I1.i3.p1.6.m6.1.1.cmml" xref="S3.I1.i3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.6.m6.1.1.1.cmml" xref="S3.I1.i3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.6.m6.1.1.2.cmml" xref="S3.I1.i3.p1.6.m6.1.1.2">𝑘</ci><ci id="S3.I1.i3.p1.6.m6.1.1.3a.cmml" xref="S3.I1.i3.p1.6.m6.1.1.3"><mtext mathsize="70%" id="S3.I1.i3.p1.6.m6.1.1.3.cmml" xref="S3.I1.i3.p1.6.m6.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.6.m6.1c">k_{\text{th}}</annotation></semantics></math> attention head.</p>
</div>
</li>
</ol>
</div>
<section id="S3.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Question-relation guided self-attention</h4>

<div id="S3.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS3.SSS0.Px1.p1.6" class="ltx_p">The question-relation guided self-attention (illustrated in Fig.<a href="#S3.F4" title="Figure 4 ‣ III-C Scene graph convolution ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) examines the pairwise relevance between objects in the scene graph. The attention weight from the <math id="S3.SS3.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="k^{\text{th}}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><msup id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml">k</mi><mtext id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3a.cmml">th</mtext></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.2">𝑘</ci><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3a.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3"><mtext mathsize="70%" id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.3">th</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">k^{\text{th}}</annotation></semantics></math> attention head <math id="S3.SS3.SSS0.Px1.p1.2.m2.2" class="ltx_Math" alttext="\omega_{ji,k}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.2a"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.2.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.2.3.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.3.2.cmml">ω</mi><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.3.cmml"><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.3.cmml">i</mi></mrow><mo id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.2b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.2.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.2.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.3.2">𝜔</ci><list id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1"><times id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.1"></times><ci id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.2">𝑗</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.2.2.2.2.1.3">𝑖</ci></apply><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.1">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.2c">\omega_{ji,k}</annotation></semantics></math> measures the extent to which node <math id="S3.SS3.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.2">𝑣</ci><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">v_{j}</annotation></semantics></math> correlates to node <math id="S3.SS3.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.4.m4.1a"><msub id="S3.SS3.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml">v</mi><mi id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.2">𝑣</ci><ci id="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.4.m4.1c">v_{i}</annotation></semantics></math>. The attention weight is calculated using both the question embedding <span id="S3.SS3.SSS0.Px1.p1.6.1" class="ltx_text ltx_markedasmath ltx_font_bold">q</span> and the relationship embedding <math id="S3.SS3.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\textbf{r}_{ji}" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.6.m6.1a"><msub id="S3.SS3.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2a.cmml">r</mtext><mrow id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.2" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.1" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.3" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2a.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.2">r</mtext></ci><apply id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3"><times id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.1"></times><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.2">𝑗</ci><ci id="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS3.SSS0.Px1.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.6.m6.1c">\textbf{r}_{ji}</annotation></semantics></math>: first, the two embedding vectors are projected and fused with</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.2" class="ltx_Math" alttext="\textbf{c}_{ji}=(\textbf{w}_{q}\cdot\textbf{q})\circ(\textbf{w}_{r}\cdot\textbf{r}_{ji})" display="block"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml"><msub id="S3.E11.m1.2.2.4" xref="S3.E11.m1.2.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.2.2.4.2" xref="S3.E11.m1.2.2.4.2a.cmml">c</mtext><mrow id="S3.E11.m1.2.2.4.3" xref="S3.E11.m1.2.2.4.3.cmml"><mi id="S3.E11.m1.2.2.4.3.2" xref="S3.E11.m1.2.2.4.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.4.3.1" xref="S3.E11.m1.2.2.4.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.4.3.3" xref="S3.E11.m1.2.2.4.3.3.cmml">i</mi></mrow></msub><mo id="S3.E11.m1.2.2.3" xref="S3.E11.m1.2.2.3.cmml">=</mo><mrow id="S3.E11.m1.2.2.2" xref="S3.E11.m1.2.2.2.cmml"><mrow id="S3.E11.m1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.cmml"><msub id="S3.E11.m1.1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.1.1.1.1.1.1.2.2a.cmml">w</mtext><mi id="S3.E11.m1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E11.m1.1.1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.1.1.cmml">⋅</mo><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.3a.cmml">q</mtext></mrow><mo rspace="0.055em" stretchy="false" id="S3.E11.m1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E11.m1.2.2.2.3" xref="S3.E11.m1.2.2.2.3.cmml">∘</mo><mrow id="S3.E11.m1.2.2.2.2.1" xref="S3.E11.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E11.m1.2.2.2.2.1.2" xref="S3.E11.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E11.m1.2.2.2.2.1.1" xref="S3.E11.m1.2.2.2.2.1.1.cmml"><msub id="S3.E11.m1.2.2.2.2.1.1.2" xref="S3.E11.m1.2.2.2.2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.2.2.2.2.1.1.2.2" xref="S3.E11.m1.2.2.2.2.1.1.2.2a.cmml">w</mtext><mi id="S3.E11.m1.2.2.2.2.1.1.2.3" xref="S3.E11.m1.2.2.2.2.1.1.2.3.cmml">r</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E11.m1.2.2.2.2.1.1.1" xref="S3.E11.m1.2.2.2.2.1.1.1.cmml">⋅</mo><msub id="S3.E11.m1.2.2.2.2.1.1.3" xref="S3.E11.m1.2.2.2.2.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.2.2.2.2.1.1.3.2" xref="S3.E11.m1.2.2.2.2.1.1.3.2a.cmml">r</mtext><mrow id="S3.E11.m1.2.2.2.2.1.1.3.3" xref="S3.E11.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S3.E11.m1.2.2.2.2.1.1.3.3.2" xref="S3.E11.m1.2.2.2.2.1.1.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E11.m1.2.2.2.2.1.1.3.3.1" xref="S3.E11.m1.2.2.2.2.1.1.3.3.1.cmml">​</mo><mi id="S3.E11.m1.2.2.2.2.1.1.3.3.3" xref="S3.E11.m1.2.2.2.2.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E11.m1.2.2.2.2.1.3" xref="S3.E11.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2"><eq id="S3.E11.m1.2.2.3.cmml" xref="S3.E11.m1.2.2.3"></eq><apply id="S3.E11.m1.2.2.4.cmml" xref="S3.E11.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.4.1.cmml" xref="S3.E11.m1.2.2.4">subscript</csymbol><ci id="S3.E11.m1.2.2.4.2a.cmml" xref="S3.E11.m1.2.2.4.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.2.2.4.2.cmml" xref="S3.E11.m1.2.2.4.2">c</mtext></ci><apply id="S3.E11.m1.2.2.4.3.cmml" xref="S3.E11.m1.2.2.4.3"><times id="S3.E11.m1.2.2.4.3.1.cmml" xref="S3.E11.m1.2.2.4.3.1"></times><ci id="S3.E11.m1.2.2.4.3.2.cmml" xref="S3.E11.m1.2.2.4.3.2">𝑗</ci><ci id="S3.E11.m1.2.2.4.3.3.cmml" xref="S3.E11.m1.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S3.E11.m1.2.2.2.cmml" xref="S3.E11.m1.2.2.2"><compose id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.3"></compose><apply id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1"><ci id="S3.E11.m1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.1">⋅</ci><apply id="S3.E11.m1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.1.2.2a.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.2">w</mtext></ci><ci id="S3.E11.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.E11.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E11.m1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.1.3">q</mtext></ci></apply><apply id="S3.E11.m1.2.2.2.2.1.1.cmml" xref="S3.E11.m1.2.2.2.2.1"><ci id="S3.E11.m1.2.2.2.2.1.1.1.cmml" xref="S3.E11.m1.2.2.2.2.1.1.1">⋅</ci><apply id="S3.E11.m1.2.2.2.2.1.1.2.cmml" xref="S3.E11.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E11.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.1.1.2.2a.cmml" xref="S3.E11.m1.2.2.2.2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E11.m1.2.2.2.2.1.1.2.2">w</mtext></ci><ci id="S3.E11.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E11.m1.2.2.2.2.1.1.2.3">𝑟</ci></apply><apply id="S3.E11.m1.2.2.2.2.1.1.3.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.1.1.3.2a.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E11.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3.2">r</mtext></ci><apply id="S3.E11.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3.3"><times id="S3.E11.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3.3.1"></times><ci id="S3.E11.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3.3.2">𝑗</ci><ci id="S3.E11.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S3.E11.m1.2.2.2.2.1.1.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\textbf{c}_{ji}=(\textbf{w}_{q}\cdot\textbf{q})\circ(\textbf{w}_{r}\cdot\textbf{r}_{ji})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.SSS0.Px1.p1.7" class="ltx_p">where <math id="S3.SS3.SSS0.Px1.p1.7.m1.1" class="ltx_Math" alttext="\circ" display="inline"><semantics id="S3.SS3.SSS0.Px1.p1.7.m1.1a"><mo id="S3.SS3.SSS0.Px1.p1.7.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.7.m1.1.1.cmml">∘</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.7.m1.1b"><compose id="S3.SS3.SSS0.Px1.p1.7.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.7.m1.1.1"></compose></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.7.m1.1c">\circ</annotation></semantics></math> denotes element-wise multiplication; then, the attention weight is obtained with</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.3" class="ltx_Math" alttext="\omega_{ji,k}=\text{softmax}(\textbf{w}_{k}\cdot\textbf{c}_{ji}+b_{k})." display="block"><semantics id="S3.E12.m1.3a"><mrow id="S3.E12.m1.3.3.1" xref="S3.E12.m1.3.3.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1" xref="S3.E12.m1.3.3.1.1.cmml"><msub id="S3.E12.m1.3.3.1.1.3" xref="S3.E12.m1.3.3.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.3.2" xref="S3.E12.m1.3.3.1.1.3.2.cmml">ω</mi><mrow id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.3.cmml"><mrow id="S3.E12.m1.2.2.2.2.1" xref="S3.E12.m1.2.2.2.2.1.cmml"><mi id="S3.E12.m1.2.2.2.2.1.2" xref="S3.E12.m1.2.2.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.2.2.2.2.1.1" xref="S3.E12.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E12.m1.2.2.2.2.1.3" xref="S3.E12.m1.2.2.2.2.1.3.cmml">i</mi></mrow><mo id="S3.E12.m1.2.2.2.2.2" xref="S3.E12.m1.2.2.2.3.cmml">,</mo><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S3.E12.m1.3.3.1.1.2" xref="S3.E12.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.3.3.1.1.1" xref="S3.E12.m1.3.3.1.1.1.cmml"><mtext id="S3.E12.m1.3.3.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.3.3.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.cmml"><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2a.cmml">w</mtext><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.2a.cmml">c</mtext><mrow id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.E12.m1.3.3.1.1.1.1.1.1.1" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E12.m1.3.3.1.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S3.E12.m1.3.3.1.1.1.1.1.3" xref="S3.E12.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E12.m1.3.3.1.2" xref="S3.E12.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.3b"><apply id="S3.E12.m1.3.3.1.1.cmml" xref="S3.E12.m1.3.3.1"><eq id="S3.E12.m1.3.3.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.2"></eq><apply id="S3.E12.m1.3.3.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.3.2">𝜔</ci><list id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.2"><apply id="S3.E12.m1.2.2.2.2.1.cmml" xref="S3.E12.m1.2.2.2.2.1"><times id="S3.E12.m1.2.2.2.2.1.1.cmml" xref="S3.E12.m1.2.2.2.2.1.1"></times><ci id="S3.E12.m1.2.2.2.2.1.2.cmml" xref="S3.E12.m1.2.2.2.2.1.2">𝑗</ci><ci id="S3.E12.m1.2.2.2.2.1.3.cmml" xref="S3.E12.m1.2.2.2.2.1.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑘</ci></list></apply><apply id="S3.E12.m1.3.3.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1"><times id="S3.E12.m1.3.3.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.2"></times><ci id="S3.E12.m1.3.3.1.1.1.3a.cmml" xref="S3.E12.m1.3.3.1.1.1.3"><mtext id="S3.E12.m1.3.3.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.3">softmax</mtext></ci><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1"><plus id="S3.E12.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.1"></plus><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2"><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.1">⋅</ci><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2a.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.2">w</mtext></ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.2a.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.2">c</mtext></ci><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3"><times id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.1"></times><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.2">𝑗</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E12.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E12.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.3.3.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.3c">\omega_{ji,k}=\text{softmax}(\textbf{w}_{k}\cdot\textbf{c}_{ji}+b_{k}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Question guided object attention</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.4" class="ltx_p">The question guided object attention examines the updated object embeddings to find the object that is most relevant. The attention weight <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">ω</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝜔</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\omega_{i}</annotation></semantics></math> measures the importance of node <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">v</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑣</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">v_{i}</annotation></semantics></math> to answering the question. It is computed by first projecting and fusing the question embedding <span id="S3.SS4.p1.4.1" class="ltx_text ltx_markedasmath ltx_font_bold">q</span> with the node hidden state <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\textbf{h}_{i}^{s}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msubsup id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p1.4.m4.1.1.2.2" xref="S3.SS4.p1.4.m4.1.1.2.2a.cmml">h</mtext><mi id="S3.SS4.p1.4.m4.1.1.2.3" xref="S3.SS4.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">superscript</csymbol><apply id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.2.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.2a.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p1.4.m4.1.1.2.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2.2">h</mtext></ci><ci id="S3.SS4.p1.4.m4.1.1.2.3.cmml" xref="S3.SS4.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\textbf{h}_{i}^{s}</annotation></semantics></math></p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.2" class="ltx_Math" alttext="\textbf{c}^{s}_{i}=(\textbf{w}^{s}_{q}\cdot\textbf{q})\circ(\textbf{w}^{s}_{h}\cdot\textbf{h}_{i}^{s})" display="block"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml"><msubsup id="S3.E13.m1.2.2.4" xref="S3.E13.m1.2.2.4.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.2.2.4.2.2" xref="S3.E13.m1.2.2.4.2.2a.cmml">c</mtext><mi id="S3.E13.m1.2.2.4.3" xref="S3.E13.m1.2.2.4.3.cmml">i</mi><mi id="S3.E13.m1.2.2.4.2.3" xref="S3.E13.m1.2.2.4.2.3.cmml">s</mi></msubsup><mo id="S3.E13.m1.2.2.3" xref="S3.E13.m1.2.2.3.cmml">=</mo><mrow id="S3.E13.m1.2.2.2" xref="S3.E13.m1.2.2.2.cmml"><mrow id="S3.E13.m1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E13.m1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.1.2.2.2" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2a.cmml">w</mtext><mi id="S3.E13.m1.1.1.1.1.1.1.2.3" xref="S3.E13.m1.1.1.1.1.1.1.2.3.cmml">q</mi><mi id="S3.E13.m1.1.1.1.1.1.1.2.2.3" xref="S3.E13.m1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E13.m1.1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.1.cmml">⋅</mo><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.3a.cmml">q</mtext></mrow><mo rspace="0.055em" stretchy="false" id="S3.E13.m1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E13.m1.2.2.2.3" xref="S3.E13.m1.2.2.2.3.cmml">∘</mo><mrow id="S3.E13.m1.2.2.2.2.1" xref="S3.E13.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.2.2.1.2" xref="S3.E13.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E13.m1.2.2.2.2.1.1" xref="S3.E13.m1.2.2.2.2.1.1.cmml"><msubsup id="S3.E13.m1.2.2.2.2.1.1.2" xref="S3.E13.m1.2.2.2.2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.2.2.2.2.1.1.2.2.2" xref="S3.E13.m1.2.2.2.2.1.1.2.2.2a.cmml">w</mtext><mi id="S3.E13.m1.2.2.2.2.1.1.2.3" xref="S3.E13.m1.2.2.2.2.1.1.2.3.cmml">h</mi><mi id="S3.E13.m1.2.2.2.2.1.1.2.2.3" xref="S3.E13.m1.2.2.2.2.1.1.2.2.3.cmml">s</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E13.m1.2.2.2.2.1.1.1" xref="S3.E13.m1.2.2.2.2.1.1.1.cmml">⋅</mo><msubsup id="S3.E13.m1.2.2.2.2.1.1.3" xref="S3.E13.m1.2.2.2.2.1.1.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.2.2.2.2.1.1.3.2.2" xref="S3.E13.m1.2.2.2.2.1.1.3.2.2a.cmml">h</mtext><mi id="S3.E13.m1.2.2.2.2.1.1.3.2.3" xref="S3.E13.m1.2.2.2.2.1.1.3.2.3.cmml">i</mi><mi id="S3.E13.m1.2.2.2.2.1.1.3.3" xref="S3.E13.m1.2.2.2.2.1.1.3.3.cmml">s</mi></msubsup></mrow><mo stretchy="false" id="S3.E13.m1.2.2.2.2.1.3" xref="S3.E13.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2"><eq id="S3.E13.m1.2.2.3.cmml" xref="S3.E13.m1.2.2.3"></eq><apply id="S3.E13.m1.2.2.4.cmml" xref="S3.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.4.1.cmml" xref="S3.E13.m1.2.2.4">subscript</csymbol><apply id="S3.E13.m1.2.2.4.2.cmml" xref="S3.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.4.2.1.cmml" xref="S3.E13.m1.2.2.4">superscript</csymbol><ci id="S3.E13.m1.2.2.4.2.2a.cmml" xref="S3.E13.m1.2.2.4.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.2.2.4.2.2.cmml" xref="S3.E13.m1.2.2.4.2.2">c</mtext></ci><ci id="S3.E13.m1.2.2.4.2.3.cmml" xref="S3.E13.m1.2.2.4.2.3">𝑠</ci></apply><ci id="S3.E13.m1.2.2.4.3.cmml" xref="S3.E13.m1.2.2.4.3">𝑖</ci></apply><apply id="S3.E13.m1.2.2.2.cmml" xref="S3.E13.m1.2.2.2"><compose id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.3"></compose><apply id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1"><ci id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.1">⋅</ci><apply id="S3.E13.m1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.2.2.2a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2.2">w</mtext></ci><ci id="S3.E13.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.E13.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E13.m1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.3">q</mtext></ci></apply><apply id="S3.E13.m1.2.2.2.2.1.1.cmml" xref="S3.E13.m1.2.2.2.2.1"><ci id="S3.E13.m1.2.2.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.1">⋅</ci><apply id="S3.E13.m1.2.2.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2">subscript</csymbol><apply id="S3.E13.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="S3.E13.m1.2.2.2.2.1.1.2.2.2a.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.2.2">w</mtext></ci><ci id="S3.E13.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.2.3">𝑠</ci></apply><ci id="S3.E13.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.3">ℎ</ci></apply><apply id="S3.E13.m1.2.2.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E13.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E13.m1.2.2.2.2.1.1.3.2.2a.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E13.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3.2.2">h</mtext></ci><ci id="S3.E13.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E13.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\textbf{c}^{s}_{i}=(\textbf{w}^{s}_{q}\cdot\textbf{q})\circ(\textbf{w}^{s}_{h}\cdot\textbf{h}_{i}^{s})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.5" class="ltx_p">and then applying a softmax operation after a linear layer</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1.1" class="ltx_Math" alttext="\omega_{i}=\text{softmax}(\textbf{w}^{s}\cdot\textbf{c}^{s}_{i}+b^{s})." display="block"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><msub id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.3.2.cmml">ω</mi><mi id="S3.E14.m1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.cmml"><mtext id="S3.E14.m1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml"><msup id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2a.cmml">w</mtext><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msup><mo lspace="0.222em" rspace="0.222em" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msubsup id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2a.cmml">c</mtext><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml">s</mi></msubsup></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.E14.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msup></mrow><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E14.m1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2"></eq><apply id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.3.2">𝜔</ci><ci id="S3.E14.m1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.1.3"><mtext id="S3.E14.m1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"><plus id="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.1">⋅</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.2">w</mtext></ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2a.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.2">c</mtext></ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.3">𝑠</ci></apply><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\omega_{i}=\text{softmax}(\textbf{w}^{s}\cdot\textbf{c}^{s}_{i}+b^{s}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.2" class="ltx_p">In the end, all visual information in the graph nodes are aggregated by</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1.1" class="ltx_Math" alttext="\hat{\textbf{v}}=\sum_{i=1}^{N}\omega_{i}\cdot\textbf{h}_{i}^{s}." display="block"><semantics id="S3.E15.m1.1a"><mrow id="S3.E15.m1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><mrow id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><mover accent="true" id="S3.E15.m1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.1.1.1.1.2.2" xref="S3.E15.m1.1.1.1.1.2.2a.cmml">v</mtext><mo id="S3.E15.m1.1.1.1.1.2.1" xref="S3.E15.m1.1.1.1.1.2.1.cmml">^</mo></mover><mo rspace="0.111em" id="S3.E15.m1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E15.m1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.3.cmml"><munderover id="S3.E15.m1.1.1.1.1.3.1" xref="S3.E15.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E15.m1.1.1.1.1.3.1.2.2" xref="S3.E15.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E15.m1.1.1.1.1.3.1.2.3" xref="S3.E15.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.1.2.3.2" xref="S3.E15.m1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E15.m1.1.1.1.1.3.1.2.3.1" xref="S3.E15.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E15.m1.1.1.1.1.3.1.2.3.3" xref="S3.E15.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E15.m1.1.1.1.1.3.1.3" xref="S3.E15.m1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E15.m1.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.3.2.cmml"><msub id="S3.E15.m1.1.1.1.1.3.2.2" xref="S3.E15.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.2.2" xref="S3.E15.m1.1.1.1.1.3.2.2.2.cmml">ω</mi><mi id="S3.E15.m1.1.1.1.1.3.2.2.3" xref="S3.E15.m1.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E15.m1.1.1.1.1.3.2.1" xref="S3.E15.m1.1.1.1.1.3.2.1.cmml">⋅</mo><msubsup id="S3.E15.m1.1.1.1.1.3.2.3" xref="S3.E15.m1.1.1.1.1.3.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.1.1.1.1.3.2.3.2.2" xref="S3.E15.m1.1.1.1.1.3.2.3.2.2a.cmml">h</mtext><mi id="S3.E15.m1.1.1.1.1.3.2.3.2.3" xref="S3.E15.m1.1.1.1.1.3.2.3.2.3.cmml">i</mi><mi id="S3.E15.m1.1.1.1.1.3.2.3.3" xref="S3.E15.m1.1.1.1.1.3.2.3.3.cmml">s</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E15.m1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1"><eq id="S3.E15.m1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1"></eq><apply id="S3.E15.m1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.2"><ci id="S3.E15.m1.1.1.1.1.2.1.cmml" xref="S3.E15.m1.1.1.1.1.2.1">^</ci><ci id="S3.E15.m1.1.1.1.1.2.2a.cmml" xref="S3.E15.m1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.1.1.1.1.2.2.cmml" xref="S3.E15.m1.1.1.1.1.2.2">v</mtext></ci></apply><apply id="S3.E15.m1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3"><apply id="S3.E15.m1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.1.1.cmml" xref="S3.E15.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E15.m1.1.1.1.1.3.1.2.cmml" xref="S3.E15.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.E15.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E15.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E15.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.1.2.3"><eq id="S3.E15.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E15.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E15.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E15.m1.1.1.1.1.3.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E15.m1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2"><ci id="S3.E15.m1.1.1.1.1.3.2.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.1">⋅</ci><apply id="S3.E15.m1.1.1.1.1.3.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.2">𝜔</ci><ci id="S3.E15.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E15.m1.1.1.1.1.3.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3">superscript</csymbol><apply id="S3.E15.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.2.3.2.2a.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E15.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3.2.2">h</mtext></ci><ci id="S3.E15.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S3.E15.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\hat{\textbf{v}}=\sum_{i=1}^{N}\omega_{i}\cdot\textbf{h}_{i}^{s}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p2.1" class="ltx_p">to yield <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\hat{\textbf{v}}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mover accent="true" id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2a.cmml">v</mtext><mo id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><ci id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1">^</ci><ci id="S3.SS4.p2.1.m1.1.1.2a.cmml" xref="S3.SS4.p2.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">v</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\hat{\textbf{v}}</annotation></semantics></math>, a vector that is expected to contain the relevant visual information for answering the question.</p>
</div>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS5.5.1.1" class="ltx_text">III-E</span> </span><span id="S3.SS5.6.2" class="ltx_text ltx_font_italic">Answer Prediction</span>
</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">We employ a two-layer MLP to predict the <span id="S3.SS5.p1.1.1" class="ltx_text ltx_markedasmath ltx_font_italic">scores</span> for candidate answers. Formally,</p>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1.1" class="ltx_Math" alttext="\text{scores}=\sigma(\text{MLP}(\hat{\textbf{v}}\circ\textbf{w}_{a}\textbf{q}))" display="block"><semantics id="S3.E16.m1.1a"><mrow id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><mtext id="S3.E16.m1.1.1.3" xref="S3.E16.m1.1.1.3a.cmml">scores</mtext><mo id="S3.E16.m1.1.1.2" xref="S3.E16.m1.1.1.2.cmml">=</mo><mrow id="S3.E16.m1.1.1.1" xref="S3.E16.m1.1.1.1.cmml"><mi id="S3.E16.m1.1.1.1.3" xref="S3.E16.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E16.m1.1.1.1.2" xref="S3.E16.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.cmml"><mtext id="S3.E16.m1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.3a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E16.m1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.2a.cmml">v</mtext><mo id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mo lspace="0.222em" rspace="0.222em" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">∘</mo><msub id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mtext class="ltx_mathvariant_bold" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.2a.cmml">w</mtext><mi id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">a</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_bold" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.3a.cmml">q</mtext></mrow><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E16.m1.1.1.1.1.1.3" xref="S3.E16.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1"><eq id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1.2"></eq><ci id="S3.E16.m1.1.1.3a.cmml" xref="S3.E16.m1.1.1.3"><mtext id="S3.E16.m1.1.1.3.cmml" xref="S3.E16.m1.1.1.3">scores</mtext></ci><apply id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.1.1.1"><times id="S3.E16.m1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.2"></times><ci id="S3.E16.m1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.3">𝜎</ci><apply id="S3.E16.m1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1"><times id="S3.E16.m1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.2"></times><ci id="S3.E16.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3"><mtext id="S3.E16.m1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.3">MLP</mtext></ci><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1"><times id="S3.E16.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2"><compose id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.1"></compose><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.2a.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.2"><mtext class="ltx_mathvariant_bold" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.2.2">v</mtext></ci></apply><apply id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.2a.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.2"><mtext class="ltx_mathvariant_bold" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.2">w</mtext></ci><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.2.3.3">𝑎</ci></apply></apply><ci id="S3.E16.m1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_bold" id="S3.E16.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m1.1.1.1.1.1.1.1.1.1.3">q</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\text{scores}=\sigma(\text{MLP}(\hat{\textbf{v}}\circ\textbf{w}_{a}\textbf{q}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p1.8" class="ltx_p">The MLP has <math id="S3.SS5.p1.2.m1.2" class="ltx_Math" alttext="1,024" display="inline"><semantics id="S3.SS5.p1.2.m1.2a"><mrow id="S3.SS5.p1.2.m1.2.3.2" xref="S3.SS5.p1.2.m1.2.3.1.cmml"><mn id="S3.SS5.p1.2.m1.1.1" xref="S3.SS5.p1.2.m1.1.1.cmml">1</mn><mo id="S3.SS5.p1.2.m1.2.3.2.1" xref="S3.SS5.p1.2.m1.2.3.1.cmml">,</mo><mn id="S3.SS5.p1.2.m1.2.2" xref="S3.SS5.p1.2.m1.2.2.cmml">024</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.2.m1.2b"><list id="S3.SS5.p1.2.m1.2.3.1.cmml" xref="S3.SS5.p1.2.m1.2.3.2"><cn type="integer" id="S3.SS5.p1.2.m1.1.1.cmml" xref="S3.SS5.p1.2.m1.1.1">1</cn><cn type="integer" id="S3.SS5.p1.2.m1.2.2.cmml" xref="S3.SS5.p1.2.m1.2.2">024</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.2.m1.2c">1,024</annotation></semantics></math> and <math id="S3.SS5.p1.3.m2.1" class="ltx_Math" alttext="N_{a}" display="inline"><semantics id="S3.SS5.p1.3.m2.1a"><msub id="S3.SS5.p1.3.m2.1.1" xref="S3.SS5.p1.3.m2.1.1.cmml"><mi id="S3.SS5.p1.3.m2.1.1.2" xref="S3.SS5.p1.3.m2.1.1.2.cmml">N</mi><mi id="S3.SS5.p1.3.m2.1.1.3" xref="S3.SS5.p1.3.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.3.m2.1b"><apply id="S3.SS5.p1.3.m2.1.1.cmml" xref="S3.SS5.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.3.m2.1.1.1.cmml" xref="S3.SS5.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS5.p1.3.m2.1.1.2.cmml" xref="S3.SS5.p1.3.m2.1.1.2">𝑁</ci><ci id="S3.SS5.p1.3.m2.1.1.3.cmml" xref="S3.SS5.p1.3.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.3.m2.1c">N_{a}</annotation></semantics></math> units in its first and second layer and uses a dropout probability of <math id="S3.SS5.p1.4.m3.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S3.SS5.p1.4.m3.1a"><mn id="S3.SS5.p1.4.m3.1.1" xref="S3.SS5.p1.4.m3.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.4.m3.1b"><cn type="float" id="S3.SS5.p1.4.m3.1.1.cmml" xref="S3.SS5.p1.4.m3.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.4.m3.1c">0.5</annotation></semantics></math>, where <math id="S3.SS5.p1.5.m4.1" class="ltx_Math" alttext="N_{a}" display="inline"><semantics id="S3.SS5.p1.5.m4.1a"><msub id="S3.SS5.p1.5.m4.1.1" xref="S3.SS5.p1.5.m4.1.1.cmml"><mi id="S3.SS5.p1.5.m4.1.1.2" xref="S3.SS5.p1.5.m4.1.1.2.cmml">N</mi><mi id="S3.SS5.p1.5.m4.1.1.3" xref="S3.SS5.p1.5.m4.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.5.m4.1b"><apply id="S3.SS5.p1.5.m4.1.1.cmml" xref="S3.SS5.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.5.m4.1.1.1.cmml" xref="S3.SS5.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS5.p1.5.m4.1.1.2.cmml" xref="S3.SS5.p1.5.m4.1.1.2">𝑁</ci><ci id="S3.SS5.p1.5.m4.1.1.3.cmml" xref="S3.SS5.p1.5.m4.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.5.m4.1c">N_{a}</annotation></semantics></math> is the number of all possible answers. We denote the predicted score for the <math id="S3.SS5.p1.6.m5.1" class="ltx_Math" alttext="i^{th}" display="inline"><semantics id="S3.SS5.p1.6.m5.1a"><msup id="S3.SS5.p1.6.m5.1.1" xref="S3.SS5.p1.6.m5.1.1.cmml"><mi id="S3.SS5.p1.6.m5.1.1.2" xref="S3.SS5.p1.6.m5.1.1.2.cmml">i</mi><mrow id="S3.SS5.p1.6.m5.1.1.3" xref="S3.SS5.p1.6.m5.1.1.3.cmml"><mi id="S3.SS5.p1.6.m5.1.1.3.2" xref="S3.SS5.p1.6.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS5.p1.6.m5.1.1.3.1" xref="S3.SS5.p1.6.m5.1.1.3.1.cmml">​</mo><mi id="S3.SS5.p1.6.m5.1.1.3.3" xref="S3.SS5.p1.6.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.6.m5.1b"><apply id="S3.SS5.p1.6.m5.1.1.cmml" xref="S3.SS5.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.6.m5.1.1.1.cmml" xref="S3.SS5.p1.6.m5.1.1">superscript</csymbol><ci id="S3.SS5.p1.6.m5.1.1.2.cmml" xref="S3.SS5.p1.6.m5.1.1.2">𝑖</ci><apply id="S3.SS5.p1.6.m5.1.1.3.cmml" xref="S3.SS5.p1.6.m5.1.1.3"><times id="S3.SS5.p1.6.m5.1.1.3.1.cmml" xref="S3.SS5.p1.6.m5.1.1.3.1"></times><ci id="S3.SS5.p1.6.m5.1.1.3.2.cmml" xref="S3.SS5.p1.6.m5.1.1.3.2">𝑡</ci><ci id="S3.SS5.p1.6.m5.1.1.3.3.cmml" xref="S3.SS5.p1.6.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.6.m5.1c">i^{th}</annotation></semantics></math> answer by <math id="S3.SS5.p1.7.m6.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S3.SS5.p1.7.m6.1a"><msub id="S3.SS5.p1.7.m6.1.1" xref="S3.SS5.p1.7.m6.1.1.cmml"><mi id="S3.SS5.p1.7.m6.1.1.2" xref="S3.SS5.p1.7.m6.1.1.2.cmml">s</mi><mi id="S3.SS5.p1.7.m6.1.1.3" xref="S3.SS5.p1.7.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.7.m6.1b"><apply id="S3.SS5.p1.7.m6.1.1.cmml" xref="S3.SS5.p1.7.m6.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.7.m6.1.1.1.cmml" xref="S3.SS5.p1.7.m6.1.1">subscript</csymbol><ci id="S3.SS5.p1.7.m6.1.1.2.cmml" xref="S3.SS5.p1.7.m6.1.1.2">𝑠</ci><ci id="S3.SS5.p1.7.m6.1.1.3.cmml" xref="S3.SS5.p1.7.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.7.m6.1c">s_{i}</annotation></semantics></math> and the benchmark label by <math id="S3.SS5.p1.8.m7.1" class="ltx_Math" alttext="\hat{s}_{i}" display="inline"><semantics id="S3.SS5.p1.8.m7.1a"><msub id="S3.SS5.p1.8.m7.1.1" xref="S3.SS5.p1.8.m7.1.1.cmml"><mover accent="true" id="S3.SS5.p1.8.m7.1.1.2" xref="S3.SS5.p1.8.m7.1.1.2.cmml"><mi id="S3.SS5.p1.8.m7.1.1.2.2" xref="S3.SS5.p1.8.m7.1.1.2.2.cmml">s</mi><mo id="S3.SS5.p1.8.m7.1.1.2.1" xref="S3.SS5.p1.8.m7.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS5.p1.8.m7.1.1.3" xref="S3.SS5.p1.8.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.8.m7.1b"><apply id="S3.SS5.p1.8.m7.1.1.cmml" xref="S3.SS5.p1.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS5.p1.8.m7.1.1.1.cmml" xref="S3.SS5.p1.8.m7.1.1">subscript</csymbol><apply id="S3.SS5.p1.8.m7.1.1.2.cmml" xref="S3.SS5.p1.8.m7.1.1.2"><ci id="S3.SS5.p1.8.m7.1.1.2.1.cmml" xref="S3.SS5.p1.8.m7.1.1.2.1">^</ci><ci id="S3.SS5.p1.8.m7.1.1.2.2.cmml" xref="S3.SS5.p1.8.m7.1.1.2.2">𝑠</ci></apply><ci id="S3.SS5.p1.8.m7.1.1.3.cmml" xref="S3.SS5.p1.8.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.8.m7.1c">\hat{s}_{i}</annotation></semantics></math>. The binary cross-entropy loss we use is formally defined by:</p>
<table id="S3.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E17.m1.5" class="ltx_Math" alttext="L=\sum_{j=1}^{B}\sum_{i=1}^{N_{a}}((1-s_{i}^{(j)})\text{log}(1-\hat{s}_{i}^{(j)})-s_{i}^{(j)}\text{log}(\hat{s}_{i}^{(j)}))" display="block"><semantics id="S3.E17.m1.5a"><mrow id="S3.E17.m1.5.5" xref="S3.E17.m1.5.5.cmml"><mi id="S3.E17.m1.5.5.3" xref="S3.E17.m1.5.5.3.cmml">L</mi><mo rspace="0.111em" id="S3.E17.m1.5.5.2" xref="S3.E17.m1.5.5.2.cmml">=</mo><mrow id="S3.E17.m1.5.5.1" xref="S3.E17.m1.5.5.1.cmml"><munderover id="S3.E17.m1.5.5.1.2" xref="S3.E17.m1.5.5.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E17.m1.5.5.1.2.2.2" xref="S3.E17.m1.5.5.1.2.2.2.cmml">∑</mo><mrow id="S3.E17.m1.5.5.1.2.2.3" xref="S3.E17.m1.5.5.1.2.2.3.cmml"><mi id="S3.E17.m1.5.5.1.2.2.3.2" xref="S3.E17.m1.5.5.1.2.2.3.2.cmml">j</mi><mo id="S3.E17.m1.5.5.1.2.2.3.1" xref="S3.E17.m1.5.5.1.2.2.3.1.cmml">=</mo><mn id="S3.E17.m1.5.5.1.2.2.3.3" xref="S3.E17.m1.5.5.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E17.m1.5.5.1.2.3" xref="S3.E17.m1.5.5.1.2.3.cmml">B</mi></munderover><mrow id="S3.E17.m1.5.5.1.1" xref="S3.E17.m1.5.5.1.1.cmml"><munderover id="S3.E17.m1.5.5.1.1.2" xref="S3.E17.m1.5.5.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E17.m1.5.5.1.1.2.2.2" xref="S3.E17.m1.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E17.m1.5.5.1.1.2.2.3" xref="S3.E17.m1.5.5.1.1.2.2.3.cmml"><mi id="S3.E17.m1.5.5.1.1.2.2.3.2" xref="S3.E17.m1.5.5.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E17.m1.5.5.1.1.2.2.3.1" xref="S3.E17.m1.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E17.m1.5.5.1.1.2.2.3.3" xref="S3.E17.m1.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E17.m1.5.5.1.1.2.3" xref="S3.E17.m1.5.5.1.1.2.3.cmml"><mi id="S3.E17.m1.5.5.1.1.2.3.2" xref="S3.E17.m1.5.5.1.1.2.3.2.cmml">N</mi><mi id="S3.E17.m1.5.5.1.1.2.3.3" xref="S3.E17.m1.5.5.1.1.2.3.3.cmml">a</mi></msub></munderover><mrow id="S3.E17.m1.5.5.1.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.5.5.1.1.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.E17.m1.5.5.1.1.1.1.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.2.cmml"><mrow id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">s</mi><mi id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mrow id="S3.E17.m1.1.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E17.m1.1.1.1.3.1" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E17.m1.1.1.1.1" xref="S3.E17.m1.1.1.1.1.cmml">j</mi><mo stretchy="false" id="S3.E17.m1.1.1.1.3.2" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E17.m1.5.5.1.1.1.1.1.2.3" xref="S3.E17.m1.5.5.1.1.1.1.1.2.3.cmml">​</mo><mtext id="S3.E17.m1.5.5.1.1.1.1.1.2.4" xref="S3.E17.m1.5.5.1.1.1.1.1.2.4a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="S3.E17.m1.5.5.1.1.1.1.1.2.3a" xref="S3.E17.m1.5.5.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.cmml"><mn id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.2.cmml">1</mn><mo id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.1.cmml">−</mo><msubsup id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.cmml"><mi id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.2" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.2.cmml">s</mi><mo id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.1" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.3" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.3.cmml">i</mi><mrow id="S3.E17.m1.2.2.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.1.3.1" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.cmml">(</mo><mi id="S3.E17.m1.2.2.1.1" xref="S3.E17.m1.2.2.1.1.cmml">j</mi><mo stretchy="false" id="S3.E17.m1.2.2.1.3.2" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E17.m1.5.5.1.1.1.1.1.4" xref="S3.E17.m1.5.5.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.E17.m1.5.5.1.1.1.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.cmml"><msubsup id="S3.E17.m1.5.5.1.1.1.1.1.3.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.cmml"><mi id="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.2.cmml">s</mi><mi id="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S3.E17.m1.3.3.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.cmml"><mo stretchy="false" id="S3.E17.m1.3.3.1.3.1" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.cmml">(</mo><mi id="S3.E17.m1.3.3.1.1" xref="S3.E17.m1.3.3.1.1.cmml">j</mi><mo stretchy="false" id="S3.E17.m1.3.3.1.3.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S3.E17.m1.5.5.1.1.1.1.1.3.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.2.cmml">​</mo><mtext id="S3.E17.m1.5.5.1.1.1.1.1.3.4" xref="S3.E17.m1.5.5.1.1.1.1.1.3.4a.cmml">log</mtext><mo lspace="0em" rspace="0em" id="S3.E17.m1.5.5.1.1.1.1.1.3.2a" xref="S3.E17.m1.5.5.1.1.1.1.1.3.2.cmml">​</mo><mrow id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml">(</mo><msubsup id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml"><mover accent="true" id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.cmml"><mi id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.2.cmml">s</mi><mo id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.1" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.3.cmml">i</mi><mrow id="S3.E17.m1.4.4.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.4.4.1.3.1" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml">(</mo><mi id="S3.E17.m1.4.4.1.1" xref="S3.E17.m1.4.4.1.1.cmml">j</mi><mo stretchy="false" id="S3.E17.m1.4.4.1.3.2" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E17.m1.5.5.1.1.1.1.3" xref="S3.E17.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.5b"><apply id="S3.E17.m1.5.5.cmml" xref="S3.E17.m1.5.5"><eq id="S3.E17.m1.5.5.2.cmml" xref="S3.E17.m1.5.5.2"></eq><ci id="S3.E17.m1.5.5.3.cmml" xref="S3.E17.m1.5.5.3">𝐿</ci><apply id="S3.E17.m1.5.5.1.cmml" xref="S3.E17.m1.5.5.1"><apply id="S3.E17.m1.5.5.1.2.cmml" xref="S3.E17.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.2.1.cmml" xref="S3.E17.m1.5.5.1.2">superscript</csymbol><apply id="S3.E17.m1.5.5.1.2.2.cmml" xref="S3.E17.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.2.2.1.cmml" xref="S3.E17.m1.5.5.1.2">subscript</csymbol><sum id="S3.E17.m1.5.5.1.2.2.2.cmml" xref="S3.E17.m1.5.5.1.2.2.2"></sum><apply id="S3.E17.m1.5.5.1.2.2.3.cmml" xref="S3.E17.m1.5.5.1.2.2.3"><eq id="S3.E17.m1.5.5.1.2.2.3.1.cmml" xref="S3.E17.m1.5.5.1.2.2.3.1"></eq><ci id="S3.E17.m1.5.5.1.2.2.3.2.cmml" xref="S3.E17.m1.5.5.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E17.m1.5.5.1.2.2.3.3.cmml" xref="S3.E17.m1.5.5.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E17.m1.5.5.1.2.3.cmml" xref="S3.E17.m1.5.5.1.2.3">𝐵</ci></apply><apply id="S3.E17.m1.5.5.1.1.cmml" xref="S3.E17.m1.5.5.1.1"><apply id="S3.E17.m1.5.5.1.1.2.cmml" xref="S3.E17.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.2.1.cmml" xref="S3.E17.m1.5.5.1.1.2">superscript</csymbol><apply id="S3.E17.m1.5.5.1.1.2.2.cmml" xref="S3.E17.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.2.2.1.cmml" xref="S3.E17.m1.5.5.1.1.2">subscript</csymbol><sum id="S3.E17.m1.5.5.1.1.2.2.2.cmml" xref="S3.E17.m1.5.5.1.1.2.2.2"></sum><apply id="S3.E17.m1.5.5.1.1.2.2.3.cmml" xref="S3.E17.m1.5.5.1.1.2.2.3"><eq id="S3.E17.m1.5.5.1.1.2.2.3.1.cmml" xref="S3.E17.m1.5.5.1.1.2.2.3.1"></eq><ci id="S3.E17.m1.5.5.1.1.2.2.3.2.cmml" xref="S3.E17.m1.5.5.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E17.m1.5.5.1.1.2.2.3.3.cmml" xref="S3.E17.m1.5.5.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E17.m1.5.5.1.1.2.3.cmml" xref="S3.E17.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.2.3.1.cmml" xref="S3.E17.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S3.E17.m1.5.5.1.1.2.3.2.cmml" xref="S3.E17.m1.5.5.1.1.2.3.2">𝑁</ci><ci id="S3.E17.m1.5.5.1.1.2.3.3.cmml" xref="S3.E17.m1.5.5.1.1.2.3.3">𝑎</ci></apply></apply><apply id="S3.E17.m1.5.5.1.1.1.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1"><minus id="S3.E17.m1.5.5.1.1.1.1.1.4.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.4"></minus><apply id="S3.E17.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2"><times id="S3.E17.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.3"></times><apply id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2">𝑠</ci><ci id="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E17.m1.1.1.1.1.cmml" xref="S3.E17.m1.1.1.1.1">𝑗</ci></apply></apply><ci id="S3.E17.m1.5.5.1.1.1.1.1.2.4a.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.4"><mtext id="S3.E17.m1.5.5.1.1.1.1.1.2.4.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.4">log</mtext></ci><apply id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1"><minus id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.1"></minus><cn type="integer" id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.2">1</cn><apply id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3">superscript</csymbol><apply id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3">subscript</csymbol><apply id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2"><ci id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.1">^</ci><ci id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.2.2">𝑠</ci></apply><ci id="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.2.2.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E17.m1.2.2.1.1.cmml" xref="S3.E17.m1.2.2.1.1">𝑗</ci></apply></apply></apply><apply id="S3.E17.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3"><times id="S3.E17.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.2"></times><apply id="S3.E17.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.2">𝑠</ci><ci id="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.3.2.3">𝑖</ci></apply><ci id="S3.E17.m1.3.3.1.1.cmml" xref="S3.E17.m1.3.3.1.1">𝑗</ci></apply><ci id="S3.E17.m1.5.5.1.1.1.1.1.3.4a.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.4"><mtext id="S3.E17.m1.5.5.1.1.1.1.1.3.4.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.4">log</mtext></ci><apply id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1">superscript</csymbol><apply id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1">subscript</csymbol><apply id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2"><ci id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.1.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.1">^</ci><ci id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.2.2">𝑠</ci></apply><ci id="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.3.cmml" xref="S3.E17.m1.5.5.1.1.1.1.1.3.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E17.m1.4.4.1.1.cmml" xref="S3.E17.m1.4.4.1.1">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.5c">L=\sum_{j=1}^{B}\sum_{i=1}^{N_{a}}((1-s_{i}^{(j)})\text{log}(1-\hat{s}_{i}^{(j)})-s_{i}^{(j)}\text{log}(\hat{s}_{i}^{(j)}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S3.SS5.p1.10" class="ltx_p">where <math id="S3.SS5.p1.9.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS5.p1.9.m1.1a"><mi id="S3.SS5.p1.9.m1.1.1" xref="S3.SS5.p1.9.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.9.m1.1b"><ci id="S3.SS5.p1.9.m1.1.1.cmml" xref="S3.SS5.p1.9.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.9.m1.1c">B</annotation></semantics></math> denotes the batch-size and <math id="S3.SS5.p1.10.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS5.p1.10.m2.1a"><mi id="S3.SS5.p1.10.m2.1.1" xref="S3.SS5.p1.10.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p1.10.m2.1b"><ci id="S3.SS5.p1.10.m2.1.1.cmml" xref="S3.SS5.p1.10.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p1.10.m2.1c">j</annotation></semantics></math> subscripts question-answers entries in training batches. Although <span id="S3.SS5.p1.10.1" class="ltx_text ltx_font_italic">GQA</span> annotates each question with only one answer, it is empirically found that binary loss works better than softmax loss.</p>
</div>
</section>
<section id="S3.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS6.5.1.1" class="ltx_text">III-F</span> </span><span id="S3.SS6.6.2" class="ltx_text ltx_font_italic">Implementation details</span>
</h3>

<section id="S3.SS6.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Object Features</h4>

<div id="S3.SS6.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS6.SSS0.Px1.p1.2" class="ltx_p">We directly use the object features provided by Anderson <math id="S3.SS6.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="et" display="inline"><semantics id="S3.SS6.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS6.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.1.cmml">​</mo><mi id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1"><times id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.1"></times><ci id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.2">𝑒</ci><ci id="S3.SS6.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS6.SSS0.Px1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px1.p1.1.m1.1c">et</annotation></semantics></math> <math id="S3.SS6.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="al." display="inline"><semantics id="S3.SS6.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.cmml"><mrow id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.cmml"><mi id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.2" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml">​</mo><mi id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml">l</mi></mrow><mo lspace="0em" id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.2" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1"><times id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.1"></times><ci id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.2">𝑎</ci><ci id="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS6.SSS0.Px1.p1.2.m2.1.1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px1.p1.2.m2.1c">al.</annotation></semantics></math><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> for <span id="S3.SS6.SSS0.Px1.p1.2.1" class="ltx_text ltx_font_italic">VQA 2.0</span> and for <span id="S3.SS6.SSS0.Px1.p1.2.2" class="ltx_text ltx_font_italic">GQA<cite class="ltx_cite ltx_citemacro_cite"><span id="S3.SS6.SSS0.Px1.p1.2.2.1.1" class="ltx_text ltx_font_upright">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S3.SS6.SSS0.Px1.p1.2.2.2.2" class="ltx_text ltx_font_upright">]</span></cite></span> we use the features that is provided in the dataset.</p>
</div>
</section>
<section id="S3.SS6.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Visual Relationship Encoder</h4>

<div id="S3.SS6.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS6.SSS0.Px2.p1.15" class="ltx_p">The visual relationship encoder is trained <math id="S3.SS6.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.1.m1.1a"><mn id="S3.SS6.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS6.SSS0.Px2.p1.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.1.m1.1b"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.1.m1.1c">5</annotation></semantics></math> epochs on <span id="S3.SS6.SSS0.Px2.p1.15.1" class="ltx_text ltx_font_italic">GQA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> using an Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> optimizer with learning rate <math id="S3.SS6.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.2.m2.1a"><mn id="S3.SS6.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS6.SSS0.Px2.p1.2.m2.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.2.m2.1b"><cn type="float" id="S3.SS6.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.2.m2.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.2.m2.1c">0.0001</annotation></semantics></math>, learning rate decay <math id="S3.SS6.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.3.m3.1a"><mn id="S3.SS6.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS6.SSS0.Px2.p1.3.m3.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.3.m3.1b"><cn type="float" id="S3.SS6.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.3.m3.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.3.m3.1c">0.8</annotation></semantics></math> and weight decay <math id="S3.SS6.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="0.0001" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.4.m4.1a"><mn id="S3.SS6.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS6.SSS0.Px2.p1.4.m4.1.1.cmml">0.0001</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.4.m4.1b"><cn type="float" id="S3.SS6.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.4.m4.1.1">0.0001</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.4.m4.1c">0.0001</annotation></semantics></math>. <math id="S3.SS6.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="300" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.5.m5.1a"><mn id="S3.SS6.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS6.SSS0.Px2.p1.5.m5.1.1.cmml">300</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.5.m5.1b"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.5.m5.1.1">300</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.5.m5.1c">300</annotation></semantics></math>-dimensional <math id="S3.SS6.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="Glove" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.6.m6.1a"><mrow id="S3.SS6.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1a" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.4" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1b" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.5" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.5.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1c" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.6" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.6.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1"><times id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.1"></times><ci id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.2">𝐺</ci><ci id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.3">𝑙</ci><ci id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.4.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.4">𝑜</ci><ci id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.5.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.5">𝑣</ci><ci id="S3.SS6.SSS0.Px2.p1.6.m6.1.1.6.cmml" xref="S3.SS6.SSS0.Px2.p1.6.m6.1.1.6">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.6.m6.1c">Glove</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> word embeddings are passed through a unidirectional, <math id="S3.SS6.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.7.m7.1a"><mn id="S3.SS6.SSS0.Px2.p1.7.m7.1.1" xref="S3.SS6.SSS0.Px2.p1.7.m7.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.7.m7.1b"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.7.m7.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.7.m7.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.7.m7.1c">1</annotation></semantics></math>-layered GRU to obtain embeddings of the subject’s name, object’s name and predicate. <math id="S3.SS6.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.8.m8.1a"><mi id="S3.SS6.SSS0.Px2.p1.8.m8.1.1" xref="S3.SS6.SSS0.Px2.p1.8.m8.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.8.m8.1b"><ci id="S3.SS6.SSS0.Px2.p1.8.m8.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.8.m8.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.8.m8.1c">m</annotation></semantics></math> in the loss function is set <math id="S3.SS6.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.9.m9.1a"><mn id="S3.SS6.SSS0.Px2.p1.9.m9.1.1" xref="S3.SS6.SSS0.Px2.p1.9.m9.1.1.cmml">0.2</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.9.m9.1b"><cn type="float" id="S3.SS6.SSS0.Px2.p1.9.m9.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.9.m9.1.1">0.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.9.m9.1c">0.2</annotation></semantics></math>. <math id="S3.SS6.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="N_{\text{pos}}" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.10.m10.1a"><msub id="S3.SS6.SSS0.Px2.p1.10.m10.1.1" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1.cmml"><mi id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.2" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1.2.cmml">N</mi><mtext id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.3" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1.3a.cmml">pos</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.10.m10.1b"><apply id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.2.cmml" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1.2">𝑁</ci><ci id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.3a.cmml" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1.3"><mtext mathsize="70%" id="S3.SS6.SSS0.Px2.p1.10.m10.1.1.3.cmml" xref="S3.SS6.SSS0.Px2.p1.10.m10.1.1.3">pos</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.10.m10.1c">N_{\text{pos}}</annotation></semantics></math> and <math id="S3.SS6.SSS0.Px2.p1.11.m11.1" class="ltx_Math" alttext="N_{\text{neg}}" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.11.m11.1a"><msub id="S3.SS6.SSS0.Px2.p1.11.m11.1.1" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1.cmml"><mi id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.2" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1.2.cmml">N</mi><mtext id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.3" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.11.m11.1b"><apply id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.2.cmml" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1.2">𝑁</ci><ci id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.3a.cmml" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1.3"><mtext mathsize="70%" id="S3.SS6.SSS0.Px2.p1.11.m11.1.1.3.cmml" xref="S3.SS6.SSS0.Px2.p1.11.m11.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.11.m11.1c">N_{\text{neg}}</annotation></semantics></math> are set <math id="S3.SS6.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="256" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.12.m12.1a"><mn id="S3.SS6.SSS0.Px2.p1.12.m12.1.1" xref="S3.SS6.SSS0.Px2.p1.12.m12.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.12.m12.1b"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.12.m12.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.12.m12.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.12.m12.1c">256</annotation></semantics></math> and <math id="S3.SS6.SSS0.Px2.p1.13.m13.1" class="ltx_Math" alttext="128" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.13.m13.1a"><mn id="S3.SS6.SSS0.Px2.p1.13.m13.1.1" xref="S3.SS6.SSS0.Px2.p1.13.m13.1.1.cmml">128</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.13.m13.1b"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.13.m13.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.13.m13.1.1">128</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.13.m13.1c">128</annotation></semantics></math>, respectively. It is reported in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> that cosine similarity values need to be manually scaled before computing the triplet softmax loss in order to prevent gradient vanishing, the adapted model does not benefit from this technique. All <math id="S3.SS6.SSS0.Px2.p1.14.m14.1" class="ltx_Math" alttext="311" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.14.m14.1a"><mn id="S3.SS6.SSS0.Px2.p1.14.m14.1.1" xref="S3.SS6.SSS0.Px2.p1.14.m14.1.1.cmml">311</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.14.m14.1b"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.14.m14.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.14.m14.1.1">311</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.14.m14.1c">311</annotation></semantics></math> predicates are used to train the visual relationship encoder albeit each predicate is limited to provide a maximum of <math id="S3.SS6.SSS0.Px2.p1.15.m15.2" class="ltx_Math" alttext="10,000" display="inline"><semantics id="S3.SS6.SSS0.Px2.p1.15.m15.2a"><mrow id="S3.SS6.SSS0.Px2.p1.15.m15.2.3.2" xref="S3.SS6.SSS0.Px2.p1.15.m15.2.3.1.cmml"><mn id="S3.SS6.SSS0.Px2.p1.15.m15.1.1" xref="S3.SS6.SSS0.Px2.p1.15.m15.1.1.cmml">10</mn><mo id="S3.SS6.SSS0.Px2.p1.15.m15.2.3.2.1" xref="S3.SS6.SSS0.Px2.p1.15.m15.2.3.1.cmml">,</mo><mn id="S3.SS6.SSS0.Px2.p1.15.m15.2.2" xref="S3.SS6.SSS0.Px2.p1.15.m15.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px2.p1.15.m15.2b"><list id="S3.SS6.SSS0.Px2.p1.15.m15.2.3.1.cmml" xref="S3.SS6.SSS0.Px2.p1.15.m15.2.3.2"><cn type="integer" id="S3.SS6.SSS0.Px2.p1.15.m15.1.1.cmml" xref="S3.SS6.SSS0.Px2.p1.15.m15.1.1">10</cn><cn type="integer" id="S3.SS6.SSS0.Px2.p1.15.m15.2.2.cmml" xref="S3.SS6.SSS0.Px2.p1.15.m15.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px2.p1.15.m15.2c">10,000</annotation></semantics></math> training samples.</p>
</div>
</section>
<section id="S3.SS6.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Visual Question Answering</h4>

<div id="S3.SS6.SSS0.Px3.p1" class="ltx_para">
<p id="S3.SS6.SSS0.Px3.p1.9" class="ltx_p">We train the visual question answering model on <span id="S3.SS6.SSS0.Px3.p1.9.1" class="ltx_text ltx_font_italic">GQA</span> balanced train questions with an Adamax <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> solver for <math id="S3.SS6.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.1.m1.1a"><mn id="S3.SS6.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS6.SSS0.Px3.p1.1.m1.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.1.m1.1b"><cn type="integer" id="S3.SS6.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.1.m1.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.1.m1.1c">20</annotation></semantics></math> epochs. Batch size and learning rate are set <math id="S3.SS6.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="256" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.2.m2.1a"><mn id="S3.SS6.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS6.SSS0.Px3.p1.2.m2.1.1.cmml">256</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.2.m2.1b"><cn type="integer" id="S3.SS6.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.2.m2.1.1">256</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.2.m2.1c">256</annotation></semantics></math> and <math id="S3.SS6.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="0.001" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.3.m3.1a"><mn id="S3.SS6.SSS0.Px3.p1.3.m3.1.1" xref="S3.SS6.SSS0.Px3.p1.3.m3.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.3.m3.1b"><cn type="float" id="S3.SS6.SSS0.Px3.p1.3.m3.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.3.m3.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.3.m3.1c">0.001</annotation></semantics></math>, respectively. Gradients with norm exceeding <math id="S3.SS6.SSS0.Px3.p1.4.m4.1" class="ltx_Math" alttext="0.25" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.4.m4.1a"><mn id="S3.SS6.SSS0.Px3.p1.4.m4.1.1" xref="S3.SS6.SSS0.Px3.p1.4.m4.1.1.cmml">0.25</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.4.m4.1b"><cn type="float" id="S3.SS6.SSS0.Px3.p1.4.m4.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.4.m4.1.1">0.25</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.4.m4.1c">0.25</annotation></semantics></math> are clipped. The object-based features we use are the ones provided in <span id="S3.SS6.SSS0.Px3.p1.9.2" class="ltx_text ltx_font_italic">GQA</span> and we use a maximum of <math id="S3.SS6.SSS0.Px3.p1.5.m5.1" class="ltx_Math" alttext="N=36" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.5.m5.1a"><mrow id="S3.SS6.SSS0.Px3.p1.5.m5.1.1" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.cmml"><mi id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.2" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.2.cmml">N</mi><mo id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.1" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.3" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.3.cmml">36</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.5.m5.1b"><apply id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1"><eq id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.1"></eq><ci id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.2.cmml" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.2">𝑁</ci><cn type="integer" id="S3.SS6.SSS0.Px3.p1.5.m5.1.1.3.cmml" xref="S3.SS6.SSS0.Px3.p1.5.m5.1.1.3">36</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.5.m5.1c">N=36</annotation></semantics></math> objects for each image. The number of all possible answers <math id="S3.SS6.SSS0.Px3.p1.6.m6.1" class="ltx_Math" alttext="N_{a}" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.6.m6.1a"><msub id="S3.SS6.SSS0.Px3.p1.6.m6.1.1" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1.cmml"><mi id="S3.SS6.SSS0.Px3.p1.6.m6.1.1.2" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1.2.cmml">N</mi><mi id="S3.SS6.SSS0.Px3.p1.6.m6.1.1.3" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.6.m6.1b"><apply id="S3.SS6.SSS0.Px3.p1.6.m6.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS0.Px3.p1.6.m6.1.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS6.SSS0.Px3.p1.6.m6.1.1.2.cmml" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1.2">𝑁</ci><ci id="S3.SS6.SSS0.Px3.p1.6.m6.1.1.3.cmml" xref="S3.SS6.SSS0.Px3.p1.6.m6.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.6.m6.1c">N_{a}</annotation></semantics></math> for <span id="S3.SS6.SSS0.Px3.p1.9.3" class="ltx_text ltx_font_italic">GQA</span> is set to <math id="S3.SS6.SSS0.Px3.p1.7.m7.2" class="ltx_Math" alttext="1,298" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.7.m7.2a"><mrow id="S3.SS6.SSS0.Px3.p1.7.m7.2.3.2" xref="S3.SS6.SSS0.Px3.p1.7.m7.2.3.1.cmml"><mn id="S3.SS6.SSS0.Px3.p1.7.m7.1.1" xref="S3.SS6.SSS0.Px3.p1.7.m7.1.1.cmml">1</mn><mo id="S3.SS6.SSS0.Px3.p1.7.m7.2.3.2.1" xref="S3.SS6.SSS0.Px3.p1.7.m7.2.3.1.cmml">,</mo><mn id="S3.SS6.SSS0.Px3.p1.7.m7.2.2" xref="S3.SS6.SSS0.Px3.p1.7.m7.2.2.cmml">298</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.7.m7.2b"><list id="S3.SS6.SSS0.Px3.p1.7.m7.2.3.1.cmml" xref="S3.SS6.SSS0.Px3.p1.7.m7.2.3.2"><cn type="integer" id="S3.SS6.SSS0.Px3.p1.7.m7.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.7.m7.1.1">1</cn><cn type="integer" id="S3.SS6.SSS0.Px3.p1.7.m7.2.2.cmml" xref="S3.SS6.SSS0.Px3.p1.7.m7.2.2">298</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.7.m7.2c">1,298</annotation></semantics></math> by filtering out answers that appear less than <math id="S3.SS6.SSS0.Px3.p1.8.m8.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.8.m8.1a"><mn id="S3.SS6.SSS0.Px3.p1.8.m8.1.1" xref="S3.SS6.SSS0.Px3.p1.8.m8.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.8.m8.1b"><cn type="integer" id="S3.SS6.SSS0.Px3.p1.8.m8.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.8.m8.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.8.m8.1c">20</annotation></semantics></math> times as they constitute a tiny portion of all the questions. For <span id="S3.SS6.SSS0.Px3.p1.9.4" class="ltx_text ltx_font_italic">VQA 2.0</span>, we filter out answers that appear less than <math id="S3.SS6.SSS0.Px3.p1.9.m9.1" class="ltx_Math" alttext="9" display="inline"><semantics id="S3.SS6.SSS0.Px3.p1.9.m9.1a"><mn id="S3.SS6.SSS0.Px3.p1.9.m9.1.1" xref="S3.SS6.SSS0.Px3.p1.9.m9.1.1.cmml">9</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS0.Px3.p1.9.m9.1b"><cn type="integer" id="S3.SS6.SSS0.Px3.p1.9.m9.1.1.cmml" xref="S3.SS6.SSS0.Px3.p1.9.m9.1.1">9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS0.Px3.p1.9.m9.1c">9</annotation></semantics></math> times following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Ablation study of SceneGCN on <span id="S4.T1.2.1" class="ltx_text ltx_font_italic">GQA</span> validation split.</figcaption>
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Metric</th>
<th id="S4.T1.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">Baseline</th>
<th id="S4.T1.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">+ width</th>
<th id="S4.T1.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">+ <em id="S4.T1.3.1.1.4.1" class="ltx_emph ltx_font_italic">q</em> att</th>
<th id="S4.T1.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">+ SceneGCN</th>
<th id="S4.T1.3.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">+ 2 att</th>
<th id="S4.T1.3.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">implicit</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.2.1" class="ltx_tr">
<td id="S4.T1.3.2.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Accuracy</td>
<td id="S4.T1.3.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">59.07</td>
<td id="S4.T1.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t">60.83</td>
<td id="S4.T1.3.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">61.03</td>
<td id="S4.T1.3.2.1.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.2.1.5.1" class="ltx_text ltx_font_bold">62.45</span></td>
<td id="S4.T1.3.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">62.42</td>
<td id="S4.T1.3.2.1.7" class="ltx_td ltx_align_center ltx_border_t">60.50</td>
</tr>
<tr id="S4.T1.3.3.2" class="ltx_tr" style="background-color:#EDF5F9;">
<td id="S4.T1.3.3.2.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.3.2.1.1" class="ltx_text" style="background-color:#EDF5F9;">Open</span></td>
<td id="S4.T1.3.3.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.3.2.2.1" class="ltx_text" style="background-color:#EDF5F9;">45.47</span></td>
<td id="S4.T1.3.3.2.3" class="ltx_td ltx_align_center"><span id="S4.T1.3.3.2.3.1" class="ltx_text" style="background-color:#EDF5F9;">46.69</span></td>
<td id="S4.T1.3.3.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.3.2.4.1" class="ltx_text" style="background-color:#EDF5F9;">46.52</span></td>
<td id="S4.T1.3.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.3.2.5.1" class="ltx_text" style="background-color:#EDF5F9;">47.88</span></td>
<td id="S4.T1.3.3.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.3.2.6.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">47.93</span></td>
<td id="S4.T1.3.3.2.7" class="ltx_td ltx_align_center"><span id="S4.T1.3.3.2.7.1" class="ltx_text" style="background-color:#EDF5F9;">46.25</span></td>
</tr>
<tr id="S4.T1.3.4.3" class="ltx_tr" style="background-color:#EDF5F9;">
<td id="S4.T1.3.4.3.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.4.3.1.1" class="ltx_text" style="background-color:#EDF5F9;">Binary</span></td>
<td id="S4.T1.3.4.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.4.3.2.1" class="ltx_text" style="background-color:#EDF5F9;">73.58</span></td>
<td id="S4.T1.3.4.3.3" class="ltx_td ltx_align_center"><span id="S4.T1.3.4.3.3.1" class="ltx_text" style="background-color:#EDF5F9;">75.92</span></td>
<td id="S4.T1.3.4.3.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.4.3.4.1" class="ltx_text" style="background-color:#EDF5F9;">76.51</span></td>
<td id="S4.T1.3.4.3.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.4.3.5.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">77.99</span></td>
<td id="S4.T1.3.4.3.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.4.3.6.1" class="ltx_text" style="background-color:#EDF5F9;">77.89</span></td>
<td id="S4.T1.3.4.3.7" class="ltx_td ltx_align_center"><span id="S4.T1.3.4.3.7.1" class="ltx_text" style="background-color:#EDF5F9;">75.70</span></td>
</tr>
<tr id="S4.T1.3.5.4" class="ltx_tr">
<td id="S4.T1.3.5.4.1" class="ltx_td ltx_align_center ltx_border_r">Global</td>
<td id="S4.T1.3.5.4.2" class="ltx_td ltx_align_center ltx_border_r">64.64</td>
<td id="S4.T1.3.5.4.3" class="ltx_td ltx_align_center">65.01</td>
<td id="S4.T1.3.5.4.4" class="ltx_td ltx_align_center ltx_border_r">65.46</td>
<td id="S4.T1.3.5.4.5" class="ltx_td ltx_align_center">65.70</td>
<td id="S4.T1.3.5.4.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.5.4.6.1" class="ltx_text ltx_font_bold">66.20</span></td>
<td id="S4.T1.3.5.4.7" class="ltx_td ltx_align_center">64.89</td>
</tr>
<tr id="S4.T1.3.6.5" class="ltx_tr">
<td id="S4.T1.3.6.5.1" class="ltx_td ltx_align_center ltx_border_r">Object</td>
<td id="S4.T1.3.6.5.2" class="ltx_td ltx_align_center ltx_border_r">80.15</td>
<td id="S4.T1.3.6.5.3" class="ltx_td ltx_align_center">80.90</td>
<td id="S4.T1.3.6.5.4" class="ltx_td ltx_align_center ltx_border_r">81.59</td>
<td id="S4.T1.3.6.5.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.6.5.5.1" class="ltx_text ltx_font_bold">82.14</span></td>
<td id="S4.T1.3.6.5.6" class="ltx_td ltx_align_center ltx_border_r">81.99</td>
<td id="S4.T1.3.6.5.7" class="ltx_td ltx_align_center">81.86</td>
</tr>
<tr id="S4.T1.3.7.6" class="ltx_tr">
<td id="S4.T1.3.7.6.1" class="ltx_td ltx_align_center ltx_border_r">Attribute</td>
<td id="S4.T1.3.7.6.2" class="ltx_td ltx_align_center ltx_border_r">62.18</td>
<td id="S4.T1.3.7.6.3" class="ltx_td ltx_align_center">65.95</td>
<td id="S4.T1.3.7.6.4" class="ltx_td ltx_align_center ltx_border_r">66.07</td>
<td id="S4.T1.3.7.6.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.7.6.5.1" class="ltx_text ltx_font_bold">68.56</span></td>
<td id="S4.T1.3.7.6.6" class="ltx_td ltx_align_center ltx_border_r">68.39</td>
<td id="S4.T1.3.7.6.7" class="ltx_td ltx_align_center">65.21</td>
</tr>
<tr id="S4.T1.3.8.7" class="ltx_tr" style="background-color:#FFFFE0;">
<td id="S4.T1.3.8.7.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.8.7.1.1" class="ltx_text" style="background-color:#FFFFE0;">Relation</span></td>
<td id="S4.T1.3.8.7.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.8.7.2.1" class="ltx_text" style="background-color:#FFFFE0;">52.01</span></td>
<td id="S4.T1.3.8.7.3" class="ltx_td ltx_align_center"><span id="S4.T1.3.8.7.3.1" class="ltx_text" style="background-color:#FFFFE0;">52.73</span></td>
<td id="S4.T1.3.8.7.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.8.7.4.1" class="ltx_text" style="background-color:#FFFFE0;">52.92</span></td>
<td id="S4.T1.3.8.7.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.8.7.5.1" class="ltx_text" style="background-color:#FFFFE0;">54.04</span></td>
<td id="S4.T1.3.8.7.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.8.7.6.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">54.25</span></td>
<td id="S4.T1.3.8.7.7" class="ltx_td ltx_align_center"><span id="S4.T1.3.8.7.7.1" class="ltx_text" style="background-color:#FFFFE0;">52.45</span></td>
</tr>
<tr id="S4.T1.3.9.8" class="ltx_tr">
<td id="S4.T1.3.9.8.1" class="ltx_td ltx_align_center ltx_border_r">Category</td>
<td id="S4.T1.3.9.8.2" class="ltx_td ltx_align_center ltx_border_r">53.63</td>
<td id="S4.T1.3.9.8.3" class="ltx_td ltx_align_center">55.47</td>
<td id="S4.T1.3.9.8.4" class="ltx_td ltx_align_center ltx_border_r">55.15</td>
<td id="S4.T1.3.9.8.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.9.8.5.1" class="ltx_text ltx_font_bold">55.55</span></td>
<td id="S4.T1.3.9.8.6" class="ltx_td ltx_align_center ltx_border_r">54.54</td>
<td id="S4.T1.3.9.8.7" class="ltx_td ltx_align_center">54.28</td>
</tr>
<tr id="S4.T1.3.10.9" class="ltx_tr" style="background-color:#EDF5F9;">
<td id="S4.T1.3.10.9.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.10.9.1.1" class="ltx_text" style="background-color:#EDF5F9;">Distribution</span></td>
<td id="S4.T1.3.10.9.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.10.9.2.1" class="ltx_text" style="background-color:#EDF5F9;">6.01</span></td>
<td id="S4.T1.3.10.9.3" class="ltx_td ltx_align_center"><span id="S4.T1.3.10.9.3.1" class="ltx_text" style="background-color:#EDF5F9;">5.31</span></td>
<td id="S4.T1.3.10.9.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.10.9.4.1" class="ltx_text" style="background-color:#EDF5F9;">4.95</span></td>
<td id="S4.T1.3.10.9.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.10.9.5.1" class="ltx_text" style="background-color:#EDF5F9;">5.58</span></td>
<td id="S4.T1.3.10.9.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.10.9.6.1" class="ltx_text" style="background-color:#EDF5F9;">6.35</span></td>
<td id="S4.T1.3.10.9.7" class="ltx_td ltx_align_center"><span id="S4.T1.3.10.9.7.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">4.43</span></td>
</tr>
<tr id="S4.T1.3.11.10" class="ltx_tr">
<td id="S4.T1.3.11.10.1" class="ltx_td ltx_align_center ltx_border_r">Grounding</td>
<td id="S4.T1.3.11.10.2" class="ltx_td ltx_align_center ltx_border_r">80.39</td>
<td id="S4.T1.3.11.10.3" class="ltx_td ltx_align_center">89.84</td>
<td id="S4.T1.3.11.10.4" class="ltx_td ltx_align_center ltx_border_r">90.89</td>
<td id="S4.T1.3.11.10.5" class="ltx_td ltx_align_center">92.32</td>
<td id="S4.T1.3.11.10.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.11.10.6.1" class="ltx_text ltx_font_bold">93.19</span></td>
<td id="S4.T1.3.11.10.7" class="ltx_td ltx_align_center">87.26</td>
</tr>
<tr id="S4.T1.3.12.11" class="ltx_tr" style="background-color:#EDF5F9;">
<td id="S4.T1.3.12.11.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.12.11.1.1" class="ltx_text" style="background-color:#EDF5F9;">Validity</span></td>
<td id="S4.T1.3.12.11.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.12.11.2.1" class="ltx_text" style="background-color:#EDF5F9;">94.77</span></td>
<td id="S4.T1.3.12.11.3" class="ltx_td ltx_align_center"><span id="S4.T1.3.12.11.3.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">95.01</span></td>
<td id="S4.T1.3.12.11.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.12.11.4.1" class="ltx_text" style="background-color:#EDF5F9;">94.97</span></td>
<td id="S4.T1.3.12.11.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.12.11.5.1" class="ltx_text" style="background-color:#EDF5F9;">94.92</span></td>
<td id="S4.T1.3.12.11.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.12.11.6.1" class="ltx_text" style="background-color:#EDF5F9;">94.97</span></td>
<td id="S4.T1.3.12.11.7" class="ltx_td ltx_align_center"><span id="S4.T1.3.12.11.7.1" class="ltx_text" style="background-color:#EDF5F9;">94.95</span></td>
</tr>
<tr id="S4.T1.3.13.12" class="ltx_tr" style="background-color:#EDF5F9;">
<td id="S4.T1.3.13.12.1" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.13.12.1.1" class="ltx_text" style="background-color:#EDF5F9;">Plausibility</span></td>
<td id="S4.T1.3.13.12.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.13.12.2.1" class="ltx_text" style="background-color:#EDF5F9;">90.88</span></td>
<td id="S4.T1.3.13.12.3" class="ltx_td ltx_align_center"><span id="S4.T1.3.13.12.3.1" class="ltx_text" style="background-color:#EDF5F9;">91.31</span></td>
<td id="S4.T1.3.13.12.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.13.12.4.1" class="ltx_text" style="background-color:#EDF5F9;">91.24</span></td>
<td id="S4.T1.3.13.12.5" class="ltx_td ltx_align_center"><span id="S4.T1.3.13.12.5.1" class="ltx_text" style="background-color:#EDF5F9;">91.23</span></td>
<td id="S4.T1.3.13.12.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.3.13.12.6.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">91.40</span></td>
<td id="S4.T1.3.13.12.7" class="ltx_td ltx_align_center"><span id="S4.T1.3.13.12.7.1" class="ltx_text" style="background-color:#EDF5F9;">91.10</span></td>
</tr>
<tr id="S4.T1.3.14.13" class="ltx_tr">
<td id="S4.T1.3.14.13.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">Consistency</td>
<td id="S4.T1.3.14.13.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">84.14</td>
<td id="S4.T1.3.14.13.3" class="ltx_td ltx_align_center ltx_border_bb">84.27</td>
<td id="S4.T1.3.14.13.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">84.75</td>
<td id="S4.T1.3.14.13.5" class="ltx_td ltx_align_center ltx_border_bb">87.14</td>
<td id="S4.T1.3.14.13.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S4.T1.3.14.13.6.1" class="ltx_text ltx_font_bold">88.17</span></td>
<td id="S4.T1.3.14.13.7" class="ltx_td ltx_align_center ltx_border_bb">83.43</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Comparison of SceneGCN with State-of-the-art on <span id="S4.T2.2.1" class="ltx_text ltx_font_italic">GQA</span> test split.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<th id="S4.T2.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">Model</th>
<th id="S4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Acc.</th>
<th id="S4.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Open</th>
<th id="S4.T2.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Binary</th>
<th id="S4.T2.3.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Dist.</th>
<th id="S4.T2.3.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Validity</th>
<th id="S4.T2.3.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Plaus.</th>
<th id="S4.T2.3.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Consist.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.2.1" class="ltx_tr">
<th id="S4.T2.3.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Local Prior <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S4.T2.3.2.1.2" class="ltx_td ltx_align_center ltx_border_t">31.31</td>
<td id="S4.T2.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t">16.99</td>
<td id="S4.T2.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t">47.53</td>
<td id="S4.T2.3.2.1.5" class="ltx_td ltx_align_center ltx_border_t">21.56</td>
<td id="S4.T2.3.2.1.6" class="ltx_td ltx_align_center ltx_border_t">84.44</td>
<td id="S4.T2.3.2.1.7" class="ltx_td ltx_align_center ltx_border_t">84.42</td>
<td id="S4.T2.3.2.1.8" class="ltx_td ltx_align_center ltx_border_t">51.34</td>
</tr>
<tr id="S4.T2.3.3.2" class="ltx_tr" style="background-color:#EDF5F9;">
<th id="S4.T2.3.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.3.3.2.1.1" class="ltx_text" style="background-color:#EDF5F9;">CNN+LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></span></th>
<td id="S4.T2.3.3.2.2" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.2.1" class="ltx_text" style="background-color:#EDF5F9;">46.55</span></td>
<td id="S4.T2.3.3.2.3" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.3.1" class="ltx_text" style="background-color:#EDF5F9;">31.80</span></td>
<td id="S4.T2.3.3.2.4" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.4.1" class="ltx_text" style="background-color:#EDF5F9;">63.26</span></td>
<td id="S4.T2.3.3.2.5" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.5.1" class="ltx_text" style="background-color:#EDF5F9;">7.46</span></td>
<td id="S4.T2.3.3.2.6" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.6.1" class="ltx_text" style="background-color:#EDF5F9;">96.02</span></td>
<td id="S4.T2.3.3.2.7" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.7.1" class="ltx_text" style="background-color:#EDF5F9;">84.25</span></td>
<td id="S4.T2.3.3.2.8" class="ltx_td ltx_align_center"><span id="S4.T2.3.3.2.8.1" class="ltx_text" style="background-color:#EDF5F9;">74.57</span></td>
</tr>
<tr id="S4.T2.3.4.3" class="ltx_tr">
<th id="S4.T2.3.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"> BottomUp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</th>
<td id="S4.T2.3.4.3.2" class="ltx_td ltx_align_center">49.74</td>
<td id="S4.T2.3.4.3.3" class="ltx_td ltx_align_center">34.83</td>
<td id="S4.T2.3.4.3.4" class="ltx_td ltx_align_center">66.64</td>
<td id="S4.T2.3.4.3.5" class="ltx_td ltx_align_center">5.98</td>
<td id="S4.T2.3.4.3.6" class="ltx_td ltx_align_center"><span id="S4.T2.3.4.3.6.1" class="ltx_text ltx_font_bold">96.18</span></td>
<td id="S4.T2.3.4.3.7" class="ltx_td ltx_align_center"><span id="S4.T2.3.4.3.7.1" class="ltx_text ltx_font_bold">84.57</span></td>
<td id="S4.T2.3.4.3.8" class="ltx_td ltx_align_center">78.71</td>
</tr>
<tr id="S4.T2.3.5.4" class="ltx_tr" style="background-color:#EDF5F9;">
<th id="S4.T2.3.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.3.5.4.1.1" class="ltx_text" style="background-color:#EDF5F9;">MAC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite></span></th>
<td id="S4.T2.3.5.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.2.1" class="ltx_text" style="background-color:#EDF5F9;">54.06</span></td>
<td id="S4.T2.3.5.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.3.1" class="ltx_text" style="background-color:#EDF5F9;">38.91</span></td>
<td id="S4.T2.3.5.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.4.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">71.23</span></td>
<td id="S4.T2.3.5.4.5" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.5.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">5.34</span></td>
<td id="S4.T2.3.5.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.6.1" class="ltx_text" style="background-color:#EDF5F9;">96.16</span></td>
<td id="S4.T2.3.5.4.7" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.7.1" class="ltx_text" style="background-color:#EDF5F9;">84.48</span></td>
<td id="S4.T2.3.5.4.8" class="ltx_td ltx_align_center"><span id="S4.T2.3.5.4.8.1" class="ltx_text" style="background-color:#EDF5F9;">81.59</span></td>
</tr>
<tr id="S4.T2.3.6.5" class="ltx_tr" style="background-color:#FFFFE0;">
<th id="S4.T2.3.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S4.T2.3.6.5.1.1" class="ltx_text" style="background-color:#FFFFE0;">SceneGCN (ours)</span></th>
<td id="S4.T2.3.6.5.2" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.2.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">54.56</span></td>
<td id="S4.T2.3.6.5.3" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.3.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">40.63</span></td>
<td id="S4.T2.3.6.5.4" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.4.1" class="ltx_text" style="background-color:#FFFFE0;">70.33</span></td>
<td id="S4.T2.3.6.5.5" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.5.1" class="ltx_text" style="background-color:#FFFFE0;">6.43</span></td>
<td id="S4.T2.3.6.5.6" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.6.1" class="ltx_text" style="background-color:#FFFFE0;">95.90</span></td>
<td id="S4.T2.3.6.5.7" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.7.1" class="ltx_text" style="background-color:#FFFFE0;">84.23</span></td>
<td id="S4.T2.3.6.5.8" class="ltx_td ltx_align_center"><span id="S4.T2.3.6.5.8.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">83.49</span></td>
</tr>
<tr id="S4.T2.3.7.6" class="ltx_tr">
<th id="S4.T2.3.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">Human <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>
</th>
<td id="S4.T2.3.7.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">89.3</td>
<td id="S4.T2.3.7.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">87.4</td>
<td id="S4.T2.3.7.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">91.2</td>
<td id="S4.T2.3.7.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-</td>
<td id="S4.T2.3.7.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">98.9</td>
<td id="S4.T2.3.7.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">97.2</td>
<td id="S4.T2.3.7.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">98.4</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Comparison of SceneGCN with State-of-the-art on <span id="S4.T3.2.1" class="ltx_text ltx_font_italic">VQA 2.0</span> test split.</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:2.3pt;padding-right:2.3pt;" rowspan="2"><span id="S4.T3.3.1.1.1.1" class="ltx_text">Model</span></th>
<th id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.3pt;padding-right:2.3pt;" colspan="4">test-dev</th>
<th id="S4.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.3pt;padding-right:2.3pt;" colspan="4">test-standard</th>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<th id="S4.T3.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Overall</th>
<th id="S4.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Other</th>
<th id="S4.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Number</th>
<th id="S4.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Yes/No</th>
<th id="S4.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Overall</th>
<th id="S4.T3.3.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Other</th>
<th id="S4.T3.3.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Number</th>
<th id="S4.T3.3.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Yes/No</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.3.1" class="ltx_tr">
<th id="S4.T3.3.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">Prior <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>
</th>
<td id="S4.T3.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">-</td>
<td id="S4.T3.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">-</td>
<td id="S4.T3.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">-</td>
<td id="S4.T3.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">-</td>
<td id="S4.T3.3.3.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">25.98</td>
<td id="S4.T3.3.3.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">01.17</td>
<td id="S4.T3.3.3.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">00.36</td>
<td id="S4.T3.3.3.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.3pt;padding-right:2.3pt;">61.20</td>
</tr>
<tr id="S4.T3.3.4.2" class="ltx_tr" style="background-color:#EDF5F9;">
<th id="S4.T3.3.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.1.1" class="ltx_text" style="background-color:#EDF5F9;">LSTM+CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite></span></th>
<td id="S4.T3.3.4.2.2" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.2.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.4.2.3" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.3.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.4.2.4" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.4.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.4.2.5" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.5.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.4.2.6" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.6.1" class="ltx_text" style="background-color:#EDF5F9;">54.22</span></td>
<td id="S4.T3.3.4.2.7" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.7.1" class="ltx_text" style="background-color:#EDF5F9;">41.83</span></td>
<td id="S4.T3.3.4.2.8" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.8.1" class="ltx_text" style="background-color:#EDF5F9;">35.18</span></td>
<td id="S4.T3.3.4.2.9" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.4.2.9.1" class="ltx_text" style="background-color:#EDF5F9;">73.46</span></td>
</tr>
<tr id="S4.T3.3.5.3" class="ltx_tr" style="background-color:#EDF5F9;">
<th id="S4.T3.3.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.1.1" class="ltx_text" style="background-color:#EDF5F9;">MCB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite></span></th>
<td id="S4.T3.3.5.3.2" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.2.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.5.3.3" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.3.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.5.3.4" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.4.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.5.3.5" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.5.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.5.3.6" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.6.1" class="ltx_text" style="background-color:#EDF5F9;">62.27</span></td>
<td id="S4.T3.3.5.3.7" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.7.1" class="ltx_text" style="background-color:#EDF5F9;">53.36</span></td>
<td id="S4.T3.3.5.3.8" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.8.1" class="ltx_text" style="background-color:#EDF5F9;">38.28</span></td>
<td id="S4.T3.3.5.3.9" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.5.3.9.1" class="ltx_text" style="background-color:#EDF5F9;">78.82</span></td>
</tr>
<tr id="S4.T3.3.6.4" class="ltx_tr">
<th id="S4.T3.3.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.3pt;padding-right:2.3pt;">BottomUp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>
</th>
<td id="S4.T3.3.6.4.2" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">65.32</td>
<td id="S4.T3.3.6.4.3" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">56.05</td>
<td id="S4.T3.3.6.4.4" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">44.21</td>
<td id="S4.T3.3.6.4.5" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">81.82</td>
<td id="S4.T3.3.6.4.6" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">65.67</td>
<td id="S4.T3.3.6.4.7" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">56.26</td>
<td id="S4.T3.3.6.4.8" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">43.90</td>
<td id="S4.T3.3.6.4.9" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;">82.20</td>
</tr>
<tr id="S4.T3.3.7.5" class="ltx_tr" style="background-color:#EDF5F9;">
<th id="S4.T3.3.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.1.1" class="ltx_text" style="background-color:#EDF5F9;">LV-NUS<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite></span></th>
<td id="S4.T3.3.7.5.2" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.2.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.7.5.3" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.3.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.7.5.4" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.4.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.7.5.5" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.5.1" class="ltx_text" style="background-color:#EDF5F9;">-</span></td>
<td id="S4.T3.3.7.5.6" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.6.1" class="ltx_text" style="background-color:#EDF5F9;">66.77</span></td>
<td id="S4.T3.3.7.5.7" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.7.1" class="ltx_text ltx_font_bold" style="background-color:#EDF5F9;">58.30</span></td>
<td id="S4.T3.3.7.5.8" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.8.1" class="ltx_text" style="background-color:#EDF5F9;">46.29</span></td>
<td id="S4.T3.3.7.5.9" class="ltx_td ltx_align_center" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.7.5.9.1" class="ltx_text" style="background-color:#EDF5F9;">81.89</span></td>
</tr>
<tr id="S4.T3.3.8.6" class="ltx_tr" style="background-color:#FFFFE0;">
<th id="S4.T3.3.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.1.1" class="ltx_text" style="background-color:#FFFFE0;">SceneGCN (ours)</span></th>
<td id="S4.T3.3.8.6.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.2.1" class="ltx_text" style="background-color:#FFFFE0;">66.81</span></td>
<td id="S4.T3.3.8.6.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.3.1" class="ltx_text" style="background-color:#FFFFE0;">57.77</span></td>
<td id="S4.T3.3.8.6.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.4.1" class="ltx_text" style="background-color:#FFFFE0;">46.85</span></td>
<td id="S4.T3.3.8.6.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.5.1" class="ltx_text" style="background-color:#FFFFE0;">82.72</span></td>
<td id="S4.T3.3.8.6.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.6.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">67.14</span></td>
<td id="S4.T3.3.8.6.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.7.1" class="ltx_text" style="background-color:#FFFFE0;">57.89</span></td>
<td id="S4.T3.3.8.6.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.8.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">46.61</span></td>
<td id="S4.T3.3.8.6.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.3pt;padding-right:2.3pt;"><span id="S4.T3.3.8.6.9.1" class="ltx_text ltx_font_bold" style="background-color:#FFFFE0;">83.16</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We present an ablation study to examine the effectiveness of the proposed method, a comparison with state-of-the-art methods and a qualitative evaluation.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Datasets and Metrics</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_italic">GQA</span> and <span id="S4.SS1.p1.1.2" class="ltx_text ltx_font_italic">VQA 2.0</span> are used to evaluate our visual question answering model. The ablation study is conducted solely on <span id="S4.SS1.p1.1.3" class="ltx_text ltx_font_italic">GQA</span> as the dataset provides a comprehensive set of evaluation metrics including one devoted to measuring agents’ capability of understanding visual relationships. We compare with state-of-the-art methods on both datasets.</p>
</div>
<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">GQA</h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> is a new dataset for VQA over real-world images with fixes of the flaws of existing benchmarks — strong language priors, use of basic, non-compositional language and ambiguous refering. <math id="S4.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="52\%" display="inline"><semantics id="S4.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">52</mn><mo id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px1.p1.1.m1.1.1.2">52</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px1.p1.1.m1.1c">52\%</annotation></semantics></math> of the questions in <span id="S4.SS1.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_italic">GQA</span> are annotated to require an understanding of visual relationships. The effectiveness of our model can be directly reflected on the <span id="S4.SS1.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_italic">relation</span> questions in <span id="S4.SS1.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_italic">GQA</span>. Apart from the standard accuracy metric measured on a number of different categories of questions, the dataset also provides the <span id="S4.SS1.SSS0.Px1.p1.1.4" class="ltx_text ltx_font_italic">Consistency</span> metric which measures responses on semantically equivalent or entailing questions, the <span id="S4.SS1.SSS0.Px1.p1.1.5" class="ltx_text ltx_font_italic">Validity</span> and <span id="S4.SS1.SSS0.Px1.p1.1.6" class="ltx_text ltx_font_italic">Plausibility</span> metrics which test whether answers are within a reasonable range, the <span id="S4.SS1.SSS0.Px1.p1.1.7" class="ltx_text ltx_font_italic">Distribution</span> metric which measures the difference between the predicted answer distribution and the real, and the <span id="S4.SS1.SSS0.Px1.p1.1.8" class="ltx_text ltx_font_italic">Grouding</span> metric which checks whether the model attends to regions within the image that are relevant to the question.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">VQA 2.0</h4>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> is a popular visual question answering benchmark with measures taken against guessing answers basing solely on language priors. <span id="S4.SS1.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">VQA 2.0</span> reports accuracy on three categories of questions: <span id="S4.SS1.SSS0.Px2.p1.1.2" class="ltx_text ltx_font_italic">yes/no</span>, <span id="S4.SS1.SSS0.Px2.p1.1.3" class="ltx_text ltx_font_italic">number</span> and <span id="S4.SS1.SSS0.Px2.p1.1.4" class="ltx_text ltx_font_italic">other</span>. Note that for <span id="S4.SS1.SSS0.Px2.p1.1.5" class="ltx_text ltx_font_italic">VQA 2.0</span> the groundtruth score of an answer is determined by a vote among <math id="S4.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><cn type="integer" id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">10</annotation></semantics></math> human annotators:</p>
<table id="S4.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E18.m1.4" class="ltx_Math" alttext="\text{score}_{\text{gt}}(a_{i})=\min\big{\{}1,\frac{n_{i}}{3}\big{\}}" display="block"><semantics id="S4.E18.m1.4a"><mrow id="S4.E18.m1.4.4" xref="S4.E18.m1.4.4.cmml"><mrow id="S4.E18.m1.4.4.1" xref="S4.E18.m1.4.4.1.cmml"><msub id="S4.E18.m1.4.4.1.3" xref="S4.E18.m1.4.4.1.3.cmml"><mtext id="S4.E18.m1.4.4.1.3.2" xref="S4.E18.m1.4.4.1.3.2a.cmml">score</mtext><mtext id="S4.E18.m1.4.4.1.3.3" xref="S4.E18.m1.4.4.1.3.3a.cmml">gt</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E18.m1.4.4.1.2" xref="S4.E18.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E18.m1.4.4.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E18.m1.4.4.1.1.1.2" xref="S4.E18.m1.4.4.1.1.1.1.cmml">(</mo><msub id="S4.E18.m1.4.4.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.cmml"><mi id="S4.E18.m1.4.4.1.1.1.1.2" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">a</mi><mi id="S4.E18.m1.4.4.1.1.1.1.3" xref="S4.E18.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E18.m1.4.4.1.1.1.3" xref="S4.E18.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E18.m1.4.4.2" xref="S4.E18.m1.4.4.2.cmml">=</mo><mrow id="S4.E18.m1.4.4.3.2" xref="S4.E18.m1.4.4.3.1.cmml"><mi id="S4.E18.m1.1.1" xref="S4.E18.m1.1.1.cmml">min</mi><mo id="S4.E18.m1.4.4.3.2a" xref="S4.E18.m1.4.4.3.1.cmml">⁡</mo><mrow id="S4.E18.m1.4.4.3.2.1" xref="S4.E18.m1.4.4.3.1.cmml"><mo maxsize="120%" minsize="120%" id="S4.E18.m1.4.4.3.2.1.1" xref="S4.E18.m1.4.4.3.1.cmml">{</mo><mn id="S4.E18.m1.2.2" xref="S4.E18.m1.2.2.cmml">1</mn><mo id="S4.E18.m1.4.4.3.2.1.2" xref="S4.E18.m1.4.4.3.1.cmml">,</mo><mfrac id="S4.E18.m1.3.3" xref="S4.E18.m1.3.3.cmml"><msub id="S4.E18.m1.3.3.2" xref="S4.E18.m1.3.3.2.cmml"><mi id="S4.E18.m1.3.3.2.2" xref="S4.E18.m1.3.3.2.2.cmml">n</mi><mi id="S4.E18.m1.3.3.2.3" xref="S4.E18.m1.3.3.2.3.cmml">i</mi></msub><mn id="S4.E18.m1.3.3.3" xref="S4.E18.m1.3.3.3.cmml">3</mn></mfrac><mo maxsize="120%" minsize="120%" id="S4.E18.m1.4.4.3.2.1.3" xref="S4.E18.m1.4.4.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.4b"><apply id="S4.E18.m1.4.4.cmml" xref="S4.E18.m1.4.4"><eq id="S4.E18.m1.4.4.2.cmml" xref="S4.E18.m1.4.4.2"></eq><apply id="S4.E18.m1.4.4.1.cmml" xref="S4.E18.m1.4.4.1"><times id="S4.E18.m1.4.4.1.2.cmml" xref="S4.E18.m1.4.4.1.2"></times><apply id="S4.E18.m1.4.4.1.3.cmml" xref="S4.E18.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.3.1.cmml" xref="S4.E18.m1.4.4.1.3">subscript</csymbol><ci id="S4.E18.m1.4.4.1.3.2a.cmml" xref="S4.E18.m1.4.4.1.3.2"><mtext id="S4.E18.m1.4.4.1.3.2.cmml" xref="S4.E18.m1.4.4.1.3.2">score</mtext></ci><ci id="S4.E18.m1.4.4.1.3.3a.cmml" xref="S4.E18.m1.4.4.1.3.3"><mtext mathsize="70%" id="S4.E18.m1.4.4.1.3.3.cmml" xref="S4.E18.m1.4.4.1.3.3">gt</mtext></ci></apply><apply id="S4.E18.m1.4.4.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1">subscript</csymbol><ci id="S4.E18.m1.4.4.1.1.1.1.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2">𝑎</ci><ci id="S4.E18.m1.4.4.1.1.1.1.3.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E18.m1.4.4.3.1.cmml" xref="S4.E18.m1.4.4.3.2"><min id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1"></min><cn type="integer" id="S4.E18.m1.2.2.cmml" xref="S4.E18.m1.2.2">1</cn><apply id="S4.E18.m1.3.3.cmml" xref="S4.E18.m1.3.3"><divide id="S4.E18.m1.3.3.1.cmml" xref="S4.E18.m1.3.3"></divide><apply id="S4.E18.m1.3.3.2.cmml" xref="S4.E18.m1.3.3.2"><csymbol cd="ambiguous" id="S4.E18.m1.3.3.2.1.cmml" xref="S4.E18.m1.3.3.2">subscript</csymbol><ci id="S4.E18.m1.3.3.2.2.cmml" xref="S4.E18.m1.3.3.2.2">𝑛</ci><ci id="S4.E18.m1.3.3.2.3.cmml" xref="S4.E18.m1.3.3.2.3">𝑖</ci></apply><cn type="integer" id="S4.E18.m1.3.3.3.cmml" xref="S4.E18.m1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.4c">\text{score}_{\text{gt}}(a_{i})=\min\big{\{}1,\frac{n_{i}}{3}\big{\}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS0.Px2.p1.3" class="ltx_p">where <math id="S4.SS1.SSS0.Px2.p1.2.m1.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.2.m1.1a"><msub id="S4.SS1.SSS0.Px2.p1.2.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2.cmml">n</mi><mi id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m1.1b"><apply id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.2">𝑛</ci><ci id="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m1.1c">n_{i}</annotation></semantics></math> is the times that an answer <math id="S4.SS1.SSS0.Px2.p1.3.m2.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.3.m2.1a"><msub id="S4.SS1.SSS0.Px2.p1.3.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.cmml"><mi id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.2" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.2.cmml">a</mi><mi id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.3" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.3.m2.1b"><apply id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.2.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.2">𝑎</ci><ci id="S4.SS1.SSS0.Px2.p1.3.m2.1.1.3.cmml" xref="S4.SS1.SSS0.Px2.p1.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.3.m2.1c">a_{i}</annotation></semantics></math> is voted by different annotators.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Ablation study</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">In this experiment, improvements are progressively added to the model. The models in this experiments are trained on the balanced train split of <span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_italic">GQA</span> and evaluated on the complete validation split. We use the
BottomUp <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> as baseline (with the minor adaptation that <span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_italic">ReLU</span> is used instead of gated tanh activation) and add improvements one after another. Numeric results are shown in Table.<a href="#S4.T1" title="TABLE I ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Effectiveness of improvements on the baseline</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.4" class="ltx_p">The <span id="S4.SS2.SSS0.Px1.p1.4.1" class="ltx_text ltx_font_italic">+ width</span> model uses increased embedding size. The size of the question embeddings and visual features are increased from <math id="S4.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="512" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.1.m1.1a"><mn id="S4.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">512</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.1.m1.1b"><cn type="integer" id="S4.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.1.m1.1.1">512</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.1.m1.1c">512</annotation></semantics></math> to <math id="S4.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="1024" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.2.m2.1a"><mn id="S4.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">1024</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.2.m2.1b"><cn type="integer" id="S4.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.2.m2.1.1">1024</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.2.m2.1c">1024</annotation></semantics></math>. The <span id="S4.SS2.SSS0.Px1.p1.4.2" class="ltx_text ltx_font_italic">+ <em id="S4.SS2.SSS0.Px1.p1.4.2.1" class="ltx_emph ltx_font_upright">q</em> att</span> model improves the question embedding module. We pass the question through a 2-layer GRU (instead of 1-layer) and a question attention module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> to obtain attentive question features. These improvements account for <math id="S4.SS2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="1.96" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.3.m3.1a"><mn id="S4.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">1.96</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.3.m3.1b"><cn type="float" id="S4.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.3.m3.1.1">1.96</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.3.m3.1c">1.96</annotation></semantics></math>% of overall accuracy improvement. The <span id="S4.SS2.SSS0.Px1.p1.4.3" class="ltx_text ltx_font_italic">relation</span> metric is improved by <math id="S4.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="0.91" display="inline"><semantics id="S4.SS2.SSS0.Px1.p1.4.m4.1a"><mn id="S4.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">0.91</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px1.p1.4.m4.1b"><cn type="float" id="S4.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS0.Px1.p1.4.m4.1.1">0.91</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px1.p1.4.m4.1c">0.91</annotation></semantics></math>%.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Effectiveness of the scene graph convolution</h4>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p1.2" class="ltx_p">Two models with our scene graph convolution are tested. The <span id="S4.SS2.SSS0.Px2.p1.2.1" class="ltx_text ltx_font_italic">+ SceneGCN</span> model uses a single attention head in the scene graph convolution and the <span id="S4.SS2.SSS0.Px2.p1.2.2" class="ltx_text ltx_font_italic">+ 2 att</span> model uses 2 attention heads. The SceneGCN module further improves the accuracy and <span id="S4.SS2.SSS0.Px2.p1.2.3" class="ltx_text ltx_font_italic">relation</span> score by <math id="S4.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="1.41" display="inline"><semantics id="S4.SS2.SSS0.Px2.p1.1.m1.1a"><mn id="S4.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">1.41</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.1.m1.1b"><cn type="float" id="S4.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.1.m1.1.1">1.41</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.1.m1.1c">1.41</annotation></semantics></math>% and <math id="S4.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="1.33" display="inline"><semantics id="S4.SS2.SSS0.Px2.p1.2.m2.1a"><mn id="S4.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">1.33</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS0.Px2.p1.2.m2.1b"><cn type="float" id="S4.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS0.Px2.p1.2.m2.1.1">1.33</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS0.Px2.p1.2.m2.1c">1.33</annotation></semantics></math>% respectively. Besides, most of the metrics are improved when SceneGCN is employed. The SceneGCN module with two attention heads benefits a number of different metrics compared with the one with a single attention head, despite not achieving the highest overall accuracy. Using more attention heads improves performance on <span id="S4.SS2.SSS0.Px2.p1.2.4" class="ltx_text ltx_font_italic">open</span>-ended questions, <span id="S4.SS2.SSS0.Px2.p1.2.5" class="ltx_text ltx_font_italic">global</span> and <span id="S4.SS2.SSS0.Px2.p1.2.6" class="ltx_text ltx_font_italic">relation</span>al understanding, <span id="S4.SS2.SSS0.Px2.p1.2.7" class="ltx_text ltx_font_italic">grounding</span> and <span id="S4.SS2.SSS0.Px2.p1.2.8" class="ltx_text ltx_font_italic">consistency</span>, proving that the SceneGCN module is capable of improving reasoning abilities.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Comparison with implicit relational reasoning</h4>

<div id="S4.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px3.p1.1" class="ltx_p">To examine the degree to which the SceceGCN improves relational understanding, we compare with the <span id="S4.SS2.SSS0.Px3.p1.1.1" class="ltx_text ltx_font_italic">implicit</span> model which uses the concatenation of object feature vectors as relation embeddings and is otherwise the same as <span id="S4.SS2.SSS0.Px3.p1.1.2" class="ltx_text ltx_font_italic">+ SceneGCN</span>. This practive is similar with <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. The results show that the <span id="S4.SS2.SSS0.Px3.p1.1.3" class="ltx_text ltx_font_italic">implicit</span> relational reasoning model does not bring apparent improvement to the model, we hypothesize the main reason to be the non-deterministic nature of visual relationships — it is insufficient to determine visual relationships given only the properties of the subject and the object.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">State-of-the-art comparison</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.3" class="ltx_p">The comparison between our method with state-of-the-art methods is shown in Table.<a href="#S4.T2" title="TABLE II ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> and Table.<a href="#S4.T3" title="TABLE III ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. Results on both datasets show that the SceneGCN model improves significantly over the baseline <span id="S4.SS3.p1.3.1" class="ltx_text ltx_font_italic">BottomUp</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, by <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="4.82" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mn id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">4.82</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><cn type="float" id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">4.82</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">4.82</annotation></semantics></math>% and <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="1.47" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mn id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">1.47</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><cn type="float" id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">1.47</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">1.47</annotation></semantics></math>% of overall accuracy, respectively. The performance on <span id="S4.SS3.p1.3.2" class="ltx_text ltx_font_italic">open</span>-ended questions is notably improved by <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="5.80" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mn id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">5.80</mn><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><cn type="float" id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">5.80</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">5.80</annotation></semantics></math> on <span id="S4.SS3.p1.3.3" class="ltx_text ltx_font_italic">GQA</span>. Our model outperforms the state-of-the-art model <span id="S4.SS3.p1.3.4" class="ltx_text ltx_font_italic">MAC</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> on overall accuracy, the ability to answer <span id="S4.SS3.p1.3.5" class="ltx_text ltx_font_italic">open</span>-ended questions and <span id="S4.SS3.p1.3.6" class="ltx_text ltx_font_italic">consistency</span>, proving the advantage of prior visual relationship learning over implicit methods. Also, the model trained and evaluated on <span id="S4.SS3.p1.3.7" class="ltx_text ltx_font_italic">VQA 2.0</span> gained less of an improvement compared to the one on <span id="S4.SS3.p1.3.8" class="ltx_text ltx_font_italic">GQA</span>, we hypothesize this is because a much smaller portion of questions in <span id="S4.SS3.p1.3.9" class="ltx_text ltx_font_italic">VQA 2.0</span> tests relational understanding.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Interpretability</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To obtain insight into the reasoning process and how SceneGCN leverages the relational information, we visualize the attention distributions produced by the model (with a single attention head in the scene graph convolution) during the progressive computation and show examples in Figure <a href="#S4.F5" title="Figure 5 ‣ IV-E Experimental Details ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, <a href="#S4.F6" title="Figure 6 ‣ IV-E Experimental Details ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> and <a href="#S4.F7" title="Figure 7 ‣ IV-E Experimental Details ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<p id="S4.SS4.p2.1" class="ltx_p">We observe that the question-relation guided self-attention is capable of capturing the critical relationships for the correct answers. It performs well on various kinds of relationships, including spatial, interactive and comparative ones. Moreover, the attention maps of the question guided object attention demonstrate the model’s ability to focus on the most relevant objects based on the relation-aware object representations. We take the first example in Figure <a href="#S4.F5" title="Figure 5 ‣ IV-E Experimental Details ‣ IV Experiments ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> to see how the model explicitly reasons about the relation-level and object-level clues: first identifying the most relevant relationship <span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_italic">to the right of</span> from all the candidate relationships for the subject <span id="S4.SS4.p2.1.2" class="ltx_text ltx_font_italic">green vegetable</span>, then locating on the target object <span id="S4.SS4.p2.1.3" class="ltx_text ltx_font_italic">beef</span> serving as strong evidence for predicting the answer <span id="S4.SS4.p2.1.4" class="ltx_text ltx_font_italic">yes</span>. In the second step, notice how the model attends to the <span id="S4.SS4.p2.1.5" class="ltx_text ltx_font_italic">beef</span> instead of other objects. This owes to the ability of the model to conduct progressive reasoning and aggregating beneficial relational clues from the prior step, which guides it to only focus on the most critical objects referring to the question.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Experimental Details</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">All experiments are conducted on a server with 4 Tesla V100 GPUs. For the <span id="S4.SS5.p1.1.1" class="ltx_text ltx_font_italic">grounding</span> metric, we report the scores measured using attention weights computed by the <span id="S4.SS5.p1.1.2" class="ltx_text ltx_font_italic">question guided object attention</span> module.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p">Following previous work, we train our model on the training set and report the results on the validation set in our ablation study. We train our model on both the training and validation set and report the results returned by the evaluation servers for the state-of-the-art comparison.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/1812.09681/assets/x4.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="311" height="552" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S4.F5.13.1" class="ltx_text ltx_font_bold">Qualitative Results.</span> For each question, the first column shows the original image. The second column depicts the top three relationships of a <span id="S4.F5.14.2" class="ltx_text ltx_font_italic">central object</span> according to the attention weights learned by the question-relation guided self-attention (<math id="S4.F5.5.m1.2" class="ltx_Math" alttext="\omega_{ji,k}" display="inline"><semantics id="S4.F5.5.m1.2b"><msub id="S4.F5.5.m1.2.3" xref="S4.F5.5.m1.2.3.cmml"><mi id="S4.F5.5.m1.2.3.2" xref="S4.F5.5.m1.2.3.2.cmml">ω</mi><mrow id="S4.F5.5.m1.2.2.2.2" xref="S4.F5.5.m1.2.2.2.3.cmml"><mrow id="S4.F5.5.m1.2.2.2.2.1" xref="S4.F5.5.m1.2.2.2.2.1.cmml"><mi id="S4.F5.5.m1.2.2.2.2.1.2" xref="S4.F5.5.m1.2.2.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.F5.5.m1.2.2.2.2.1.1" xref="S4.F5.5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.F5.5.m1.2.2.2.2.1.3" xref="S4.F5.5.m1.2.2.2.2.1.3.cmml">i</mi></mrow><mo id="S4.F5.5.m1.2.2.2.2.2" xref="S4.F5.5.m1.2.2.2.3.cmml">,</mo><mi id="S4.F5.5.m1.1.1.1.1" xref="S4.F5.5.m1.1.1.1.1.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F5.5.m1.2c"><apply id="S4.F5.5.m1.2.3.cmml" xref="S4.F5.5.m1.2.3"><csymbol cd="ambiguous" id="S4.F5.5.m1.2.3.1.cmml" xref="S4.F5.5.m1.2.3">subscript</csymbol><ci id="S4.F5.5.m1.2.3.2.cmml" xref="S4.F5.5.m1.2.3.2">𝜔</ci><list id="S4.F5.5.m1.2.2.2.3.cmml" xref="S4.F5.5.m1.2.2.2.2"><apply id="S4.F5.5.m1.2.2.2.2.1.cmml" xref="S4.F5.5.m1.2.2.2.2.1"><times id="S4.F5.5.m1.2.2.2.2.1.1.cmml" xref="S4.F5.5.m1.2.2.2.2.1.1"></times><ci id="S4.F5.5.m1.2.2.2.2.1.2.cmml" xref="S4.F5.5.m1.2.2.2.2.1.2">𝑗</ci><ci id="S4.F5.5.m1.2.2.2.2.1.3.cmml" xref="S4.F5.5.m1.2.2.2.2.1.3">𝑖</ci></apply><ci id="S4.F5.5.m1.1.1.1.1.cmml" xref="S4.F5.5.m1.1.1.1.1">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.m1.2d">\omega_{ji,k}</annotation></semantics></math> as in Eq.<a href="#S3.E12" title="In Question-relation guided self-attention ‣ III-C Scene graph convolution ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>). The relationship with the highest attention weight is marked with orange, whereas light blue is used to mark the <math id="S4.F5.6.m2.1" class="ltx_Math" alttext="2^{\text{nd}}" display="inline"><semantics id="S4.F5.6.m2.1b"><msup id="S4.F5.6.m2.1.1" xref="S4.F5.6.m2.1.1.cmml"><mn id="S4.F5.6.m2.1.1.2" xref="S4.F5.6.m2.1.1.2.cmml">2</mn><mtext id="S4.F5.6.m2.1.1.3" xref="S4.F5.6.m2.1.1.3a.cmml">nd</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.F5.6.m2.1c"><apply id="S4.F5.6.m2.1.1.cmml" xref="S4.F5.6.m2.1.1"><csymbol cd="ambiguous" id="S4.F5.6.m2.1.1.1.cmml" xref="S4.F5.6.m2.1.1">superscript</csymbol><cn type="integer" id="S4.F5.6.m2.1.1.2.cmml" xref="S4.F5.6.m2.1.1.2">2</cn><ci id="S4.F5.6.m2.1.1.3a.cmml" xref="S4.F5.6.m2.1.1.3"><mtext mathsize="70%" id="S4.F5.6.m2.1.1.3.cmml" xref="S4.F5.6.m2.1.1.3">nd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m2.1d">2^{\text{nd}}</annotation></semantics></math> and <math id="S4.F5.7.m3.1" class="ltx_Math" alttext="3^{\text{rd}}" display="inline"><semantics id="S4.F5.7.m3.1b"><msup id="S4.F5.7.m3.1.1" xref="S4.F5.7.m3.1.1.cmml"><mn id="S4.F5.7.m3.1.1.2" xref="S4.F5.7.m3.1.1.2.cmml">3</mn><mtext id="S4.F5.7.m3.1.1.3" xref="S4.F5.7.m3.1.1.3a.cmml">rd</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.F5.7.m3.1c"><apply id="S4.F5.7.m3.1.1.cmml" xref="S4.F5.7.m3.1.1"><csymbol cd="ambiguous" id="S4.F5.7.m3.1.1.1.cmml" xref="S4.F5.7.m3.1.1">superscript</csymbol><cn type="integer" id="S4.F5.7.m3.1.1.2.cmml" xref="S4.F5.7.m3.1.1.2">3</cn><ci id="S4.F5.7.m3.1.1.3a.cmml" xref="S4.F5.7.m3.1.1.3"><mtext mathsize="70%" id="S4.F5.7.m3.1.1.3.cmml" xref="S4.F5.7.m3.1.1.3">rd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.m3.1d">3^{\text{rd}}</annotation></semantics></math> most relevant relationships. The <span id="S4.F5.15.3" class="ltx_text ltx_font_italic">central object</span> is the one with the highest weight from the question guided object attention (<math id="S4.F5.8.m4.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S4.F5.8.m4.1b"><msub id="S4.F5.8.m4.1.1" xref="S4.F5.8.m4.1.1.cmml"><mi id="S4.F5.8.m4.1.1.2" xref="S4.F5.8.m4.1.1.2.cmml">ω</mi><mi id="S4.F5.8.m4.1.1.3" xref="S4.F5.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F5.8.m4.1c"><apply id="S4.F5.8.m4.1.1.cmml" xref="S4.F5.8.m4.1.1"><csymbol cd="ambiguous" id="S4.F5.8.m4.1.1.1.cmml" xref="S4.F5.8.m4.1.1">subscript</csymbol><ci id="S4.F5.8.m4.1.1.2.cmml" xref="S4.F5.8.m4.1.1.2">𝜔</ci><ci id="S4.F5.8.m4.1.1.3.cmml" xref="S4.F5.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.m4.1d">\omega_{i}</annotation></semantics></math> as in Eq.<a href="#S3.E14" title="In III-D Question guided object attention ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>). We also show the relation label predicted by the visual relationship encoder in the second column. The third column visualizes the distribution of the the question guided object attention, where the <span id="S4.F5.16.4" class="ltx_text ltx_font_italic">central object</span> is marked with red.</figcaption>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/1812.09681/assets/x5.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="311" height="562" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S4.F6.13.1" class="ltx_text ltx_font_bold">Qualitative Results.</span> For each question, the first column shows the original image. The second column depicts the top three relationships of a <span id="S4.F6.14.2" class="ltx_text ltx_font_italic">central object</span> according to the attention weights learned by the question-relation guided self-attention (<math id="S4.F6.5.m1.2" class="ltx_Math" alttext="\omega_{ji,k}" display="inline"><semantics id="S4.F6.5.m1.2b"><msub id="S4.F6.5.m1.2.3" xref="S4.F6.5.m1.2.3.cmml"><mi id="S4.F6.5.m1.2.3.2" xref="S4.F6.5.m1.2.3.2.cmml">ω</mi><mrow id="S4.F6.5.m1.2.2.2.2" xref="S4.F6.5.m1.2.2.2.3.cmml"><mrow id="S4.F6.5.m1.2.2.2.2.1" xref="S4.F6.5.m1.2.2.2.2.1.cmml"><mi id="S4.F6.5.m1.2.2.2.2.1.2" xref="S4.F6.5.m1.2.2.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.F6.5.m1.2.2.2.2.1.1" xref="S4.F6.5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.F6.5.m1.2.2.2.2.1.3" xref="S4.F6.5.m1.2.2.2.2.1.3.cmml">i</mi></mrow><mo id="S4.F6.5.m1.2.2.2.2.2" xref="S4.F6.5.m1.2.2.2.3.cmml">,</mo><mi id="S4.F6.5.m1.1.1.1.1" xref="S4.F6.5.m1.1.1.1.1.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F6.5.m1.2c"><apply id="S4.F6.5.m1.2.3.cmml" xref="S4.F6.5.m1.2.3"><csymbol cd="ambiguous" id="S4.F6.5.m1.2.3.1.cmml" xref="S4.F6.5.m1.2.3">subscript</csymbol><ci id="S4.F6.5.m1.2.3.2.cmml" xref="S4.F6.5.m1.2.3.2">𝜔</ci><list id="S4.F6.5.m1.2.2.2.3.cmml" xref="S4.F6.5.m1.2.2.2.2"><apply id="S4.F6.5.m1.2.2.2.2.1.cmml" xref="S4.F6.5.m1.2.2.2.2.1"><times id="S4.F6.5.m1.2.2.2.2.1.1.cmml" xref="S4.F6.5.m1.2.2.2.2.1.1"></times><ci id="S4.F6.5.m1.2.2.2.2.1.2.cmml" xref="S4.F6.5.m1.2.2.2.2.1.2">𝑗</ci><ci id="S4.F6.5.m1.2.2.2.2.1.3.cmml" xref="S4.F6.5.m1.2.2.2.2.1.3">𝑖</ci></apply><ci id="S4.F6.5.m1.1.1.1.1.cmml" xref="S4.F6.5.m1.1.1.1.1">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.5.m1.2d">\omega_{ji,k}</annotation></semantics></math> as in Eq.<a href="#S3.E12" title="In Question-relation guided self-attention ‣ III-C Scene graph convolution ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>). The relationship with the highest attention weight is marked with orange, whereas light blue is used to mark the <math id="S4.F6.6.m2.1" class="ltx_Math" alttext="2^{\text{nd}}" display="inline"><semantics id="S4.F6.6.m2.1b"><msup id="S4.F6.6.m2.1.1" xref="S4.F6.6.m2.1.1.cmml"><mn id="S4.F6.6.m2.1.1.2" xref="S4.F6.6.m2.1.1.2.cmml">2</mn><mtext id="S4.F6.6.m2.1.1.3" xref="S4.F6.6.m2.1.1.3a.cmml">nd</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.F6.6.m2.1c"><apply id="S4.F6.6.m2.1.1.cmml" xref="S4.F6.6.m2.1.1"><csymbol cd="ambiguous" id="S4.F6.6.m2.1.1.1.cmml" xref="S4.F6.6.m2.1.1">superscript</csymbol><cn type="integer" id="S4.F6.6.m2.1.1.2.cmml" xref="S4.F6.6.m2.1.1.2">2</cn><ci id="S4.F6.6.m2.1.1.3a.cmml" xref="S4.F6.6.m2.1.1.3"><mtext mathsize="70%" id="S4.F6.6.m2.1.1.3.cmml" xref="S4.F6.6.m2.1.1.3">nd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.6.m2.1d">2^{\text{nd}}</annotation></semantics></math> and <math id="S4.F6.7.m3.1" class="ltx_Math" alttext="3^{\text{rd}}" display="inline"><semantics id="S4.F6.7.m3.1b"><msup id="S4.F6.7.m3.1.1" xref="S4.F6.7.m3.1.1.cmml"><mn id="S4.F6.7.m3.1.1.2" xref="S4.F6.7.m3.1.1.2.cmml">3</mn><mtext id="S4.F6.7.m3.1.1.3" xref="S4.F6.7.m3.1.1.3a.cmml">rd</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.F6.7.m3.1c"><apply id="S4.F6.7.m3.1.1.cmml" xref="S4.F6.7.m3.1.1"><csymbol cd="ambiguous" id="S4.F6.7.m3.1.1.1.cmml" xref="S4.F6.7.m3.1.1">superscript</csymbol><cn type="integer" id="S4.F6.7.m3.1.1.2.cmml" xref="S4.F6.7.m3.1.1.2">3</cn><ci id="S4.F6.7.m3.1.1.3a.cmml" xref="S4.F6.7.m3.1.1.3"><mtext mathsize="70%" id="S4.F6.7.m3.1.1.3.cmml" xref="S4.F6.7.m3.1.1.3">rd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.7.m3.1d">3^{\text{rd}}</annotation></semantics></math> most relevant relationships. The <span id="S4.F6.15.3" class="ltx_text ltx_font_italic">central object</span> is the one with the highest weight from the question guided object attention (<math id="S4.F6.8.m4.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S4.F6.8.m4.1b"><msub id="S4.F6.8.m4.1.1" xref="S4.F6.8.m4.1.1.cmml"><mi id="S4.F6.8.m4.1.1.2" xref="S4.F6.8.m4.1.1.2.cmml">ω</mi><mi id="S4.F6.8.m4.1.1.3" xref="S4.F6.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F6.8.m4.1c"><apply id="S4.F6.8.m4.1.1.cmml" xref="S4.F6.8.m4.1.1"><csymbol cd="ambiguous" id="S4.F6.8.m4.1.1.1.cmml" xref="S4.F6.8.m4.1.1">subscript</csymbol><ci id="S4.F6.8.m4.1.1.2.cmml" xref="S4.F6.8.m4.1.1.2">𝜔</ci><ci id="S4.F6.8.m4.1.1.3.cmml" xref="S4.F6.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.8.m4.1d">\omega_{i}</annotation></semantics></math> as in Eq.<a href="#S3.E14" title="In III-D Question guided object attention ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>). We also show the relation label predicted by the visual relationship encoder in the second column. The third column visualizes the distribution of the the question guided object attention, where the <span id="S4.F6.16.4" class="ltx_text ltx_font_italic">central object</span> is arked with red.</figcaption>
</figure>
<figure id="S4.F7" class="ltx_figure"><img src="/html/1812.09681/assets/x6.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="311" height="546" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span id="S4.F7.13.1" class="ltx_text ltx_font_bold">Qualitative Results.</span> For each question, the first column shows the original image. The second column depicts the top three relationships of a <span id="S4.F7.14.2" class="ltx_text ltx_font_italic">central object</span> according to the attention weights learned by the question-relation guided self-attention (<math id="S4.F7.5.m1.2" class="ltx_Math" alttext="\omega_{ji,k}" display="inline"><semantics id="S4.F7.5.m1.2b"><msub id="S4.F7.5.m1.2.3" xref="S4.F7.5.m1.2.3.cmml"><mi id="S4.F7.5.m1.2.3.2" xref="S4.F7.5.m1.2.3.2.cmml">ω</mi><mrow id="S4.F7.5.m1.2.2.2.2" xref="S4.F7.5.m1.2.2.2.3.cmml"><mrow id="S4.F7.5.m1.2.2.2.2.1" xref="S4.F7.5.m1.2.2.2.2.1.cmml"><mi id="S4.F7.5.m1.2.2.2.2.1.2" xref="S4.F7.5.m1.2.2.2.2.1.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.F7.5.m1.2.2.2.2.1.1" xref="S4.F7.5.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.F7.5.m1.2.2.2.2.1.3" xref="S4.F7.5.m1.2.2.2.2.1.3.cmml">i</mi></mrow><mo id="S4.F7.5.m1.2.2.2.2.2" xref="S4.F7.5.m1.2.2.2.3.cmml">,</mo><mi id="S4.F7.5.m1.1.1.1.1" xref="S4.F7.5.m1.1.1.1.1.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F7.5.m1.2c"><apply id="S4.F7.5.m1.2.3.cmml" xref="S4.F7.5.m1.2.3"><csymbol cd="ambiguous" id="S4.F7.5.m1.2.3.1.cmml" xref="S4.F7.5.m1.2.3">subscript</csymbol><ci id="S4.F7.5.m1.2.3.2.cmml" xref="S4.F7.5.m1.2.3.2">𝜔</ci><list id="S4.F7.5.m1.2.2.2.3.cmml" xref="S4.F7.5.m1.2.2.2.2"><apply id="S4.F7.5.m1.2.2.2.2.1.cmml" xref="S4.F7.5.m1.2.2.2.2.1"><times id="S4.F7.5.m1.2.2.2.2.1.1.cmml" xref="S4.F7.5.m1.2.2.2.2.1.1"></times><ci id="S4.F7.5.m1.2.2.2.2.1.2.cmml" xref="S4.F7.5.m1.2.2.2.2.1.2">𝑗</ci><ci id="S4.F7.5.m1.2.2.2.2.1.3.cmml" xref="S4.F7.5.m1.2.2.2.2.1.3">𝑖</ci></apply><ci id="S4.F7.5.m1.1.1.1.1.cmml" xref="S4.F7.5.m1.1.1.1.1">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.5.m1.2d">\omega_{ji,k}</annotation></semantics></math> as in Eq.<a href="#S3.E12" title="In Question-relation guided self-attention ‣ III-C Scene graph convolution ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>). The relationship with the highest attention weight is marked with orange, whereas light blue is used to mark the <math id="S4.F7.6.m2.1" class="ltx_Math" alttext="2^{\text{nd}}" display="inline"><semantics id="S4.F7.6.m2.1b"><msup id="S4.F7.6.m2.1.1" xref="S4.F7.6.m2.1.1.cmml"><mn id="S4.F7.6.m2.1.1.2" xref="S4.F7.6.m2.1.1.2.cmml">2</mn><mtext id="S4.F7.6.m2.1.1.3" xref="S4.F7.6.m2.1.1.3a.cmml">nd</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.F7.6.m2.1c"><apply id="S4.F7.6.m2.1.1.cmml" xref="S4.F7.6.m2.1.1"><csymbol cd="ambiguous" id="S4.F7.6.m2.1.1.1.cmml" xref="S4.F7.6.m2.1.1">superscript</csymbol><cn type="integer" id="S4.F7.6.m2.1.1.2.cmml" xref="S4.F7.6.m2.1.1.2">2</cn><ci id="S4.F7.6.m2.1.1.3a.cmml" xref="S4.F7.6.m2.1.1.3"><mtext mathsize="70%" id="S4.F7.6.m2.1.1.3.cmml" xref="S4.F7.6.m2.1.1.3">nd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.6.m2.1d">2^{\text{nd}}</annotation></semantics></math> and <math id="S4.F7.7.m3.1" class="ltx_Math" alttext="3^{\text{rd}}" display="inline"><semantics id="S4.F7.7.m3.1b"><msup id="S4.F7.7.m3.1.1" xref="S4.F7.7.m3.1.1.cmml"><mn id="S4.F7.7.m3.1.1.2" xref="S4.F7.7.m3.1.1.2.cmml">3</mn><mtext id="S4.F7.7.m3.1.1.3" xref="S4.F7.7.m3.1.1.3a.cmml">rd</mtext></msup><annotation-xml encoding="MathML-Content" id="S4.F7.7.m3.1c"><apply id="S4.F7.7.m3.1.1.cmml" xref="S4.F7.7.m3.1.1"><csymbol cd="ambiguous" id="S4.F7.7.m3.1.1.1.cmml" xref="S4.F7.7.m3.1.1">superscript</csymbol><cn type="integer" id="S4.F7.7.m3.1.1.2.cmml" xref="S4.F7.7.m3.1.1.2">3</cn><ci id="S4.F7.7.m3.1.1.3a.cmml" xref="S4.F7.7.m3.1.1.3"><mtext mathsize="70%" id="S4.F7.7.m3.1.1.3.cmml" xref="S4.F7.7.m3.1.1.3">rd</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.7.m3.1d">3^{\text{rd}}</annotation></semantics></math> most relevant relationships. The <span id="S4.F7.15.3" class="ltx_text ltx_font_italic">central object</span> is the one with the highest weight from the question guided object attention (<math id="S4.F7.8.m4.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S4.F7.8.m4.1b"><msub id="S4.F7.8.m4.1.1" xref="S4.F7.8.m4.1.1.cmml"><mi id="S4.F7.8.m4.1.1.2" xref="S4.F7.8.m4.1.1.2.cmml">ω</mi><mi id="S4.F7.8.m4.1.1.3" xref="S4.F7.8.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F7.8.m4.1c"><apply id="S4.F7.8.m4.1.1.cmml" xref="S4.F7.8.m4.1.1"><csymbol cd="ambiguous" id="S4.F7.8.m4.1.1.1.cmml" xref="S4.F7.8.m4.1.1">subscript</csymbol><ci id="S4.F7.8.m4.1.1.2.cmml" xref="S4.F7.8.m4.1.1.2">𝜔</ci><ci id="S4.F7.8.m4.1.1.3.cmml" xref="S4.F7.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F7.8.m4.1d">\omega_{i}</annotation></semantics></math> as in Eq.<a href="#S3.E14" title="In III-D Question guided object attention ‣ III Methodology ‣ Scene Graph Reasoning with Prior Visual Relationship for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>). We also show the relation label predicted by the visual relationship encoder in the second column. The third column visualizes the distribution of the the question guided object attention, where the <span id="S4.F7.16.4" class="ltx_text ltx_font_italic">central object</span> is marked with red.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, a novel solution to the problem of relational reasoning in visual question answering was proposed by utilizing prior visual relationship learning. The new model is named as Scene Graph Convolutional Network, by which input images are represented by structured scene graphs using a pretrained object detector and a pretrained visual relationship encoder that embeds both objects and relationships. The proposed scene graph convolution operation updates each node’s hidden states using information from both objects and relationships. We demonstrated the effectiveness and transparency of the model through quantitative and qualitative studies, and achieved state-of-the-art results on both the <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">GQA</span> and <span id="S5.p1.1.2" class="ltx_text ltx_font_italic">VQA 2.0</span> datasets. Morover, interpretable attention-based visualization shows strong evidence that our model has good capability in relationship identifying and progressive reasoning.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Zichao Yang, Xiaodong He, and Jianfeng Gao.

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Hierarchical question-image co-attention for visual question
answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Advances In Neural Information Processing Systems</span>, pages
289–297, 2016.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.

</span>
<span class="ltx_bibblock">Bottom-up and top-down attention for image captioning and visual
question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 6077–6086, 2018.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Drew A. Hudson and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Compositional attention networks for machine reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Adam Santoro, David Raposo, David G Barrett, Mateusz Malinowski, Razvan
Pascanu, Peter Battaglia, and Tim Lillicrap.

</span>
<span class="ltx_bibblock">A simple neural network module for relational reasoning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, pages 4967–4976, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Damien Teney, Lingqiao Liu, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Graph-structured representations for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 3233–3241, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Peng Wang, Qi Wu, Shen Chuanhua Cao, Jiewei, and Lianli Gao.

</span>
<span class="ltx_bibblock">Neighbourhood watch: Referring expression comprehension via
language-guided graph attention networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Ting Yao, Yingwei Pan, Yehao Li, and Tao Mei.

</span>
<span class="ltx_bibblock">Exploring visual relationship for image captioning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1809.07041</span>, 2015.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Cewu Lu, Ranjay Krishna, Michael Bernstein, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Visual relationship detection with language priors.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">European Conference on Computer Vision</span>, pages 852–869.
Springer, 2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Hanwang Zhang, Zawlin Kyaw, Shih-Fu Chang, and Tat-Seng Chua.

</span>
<span class="ltx_bibblock">Visual translation embedding network for visual relation detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 5532–5540, 2017.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Hai Wan, Yonghao Luo, Bo Peng, and Wei-Shi Zheng.

</span>
<span class="ltx_bibblock">Representation learning for scene graph completion via jointly
structural and visual embedding.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">IJCAI</span>, pages 949–956, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Ji Zhang, Yannis Kalantidis, Marcus Rohrbach, Manohar Paluri, Ahmed Elgammal,
and Mohamed Elhoseiny.

</span>
<span class="ltx_bibblock">Large-scale visual relationship understanding.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">AAAI</span>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma,
Michael Bernstein, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.

</span>
<span class="ltx_bibblock">2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Drew A. Hudson and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Gqa: a new dataset for compositional question answering over
real-world images.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1902.09506</span>, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Bolei Zhou, Yuandong Tian, Sainbayar Sukhbaatar, Arthur Szlam, and Rob Fergus.

</span>
<span class="ltx_bibblock">Simple baseline for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1512.02167v2</span>, 2015.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J.B. Tenebaum and W.T. Freeman.

</span>
<span class="ltx_bibblock">Separating style and content.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, page 662–668, 1997.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Akira Fukui, Dong Huk Park, Daylen Yang, Anna Rohrbach, Trevor Darrel, and
Marcus Rohrbach.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">EMNLP</span>, page 457–468, 2016.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Jin-Hwa Kim, Kyoung-Woon On, Woosang Lim, Jeonghee Kim, Jung-Woo Ha, and
Byoung-Tak Zhang.

</span>
<span class="ltx_bibblock">Hadamard product for low-rank bilinear pooling.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Hyeonwoo Noh, Paul Hongsuck Seo, and Han Bohyung.

</span>
<span class="ltx_bibblock">Image question answering using convolutional neural network with
dynamic parameter prediction.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Seung Wook Kim, Makarand Tapaswi, and Sanja Fidler.

</span>
<span class="ltx_bibblock">Visual reasoning by progressive module networks.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Xinlei Chen, Li-Jia Li, Li Fei-Fei, and Abhinav Gupta.

</span>
<span class="ltx_bibblock">Iterative visual reasoning beyond convolutions.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, pages 7239–7248, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Kexin Yi, Jiajun Wu, Chuang Gan, Antonio Torralba, Pushmeet Kohli, and Josh
Tenenbaum.

</span>
<span class="ltx_bibblock">Neural-symbolic vqa: Disentangling reasoning from vision and language
understanding.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
1031–1042, 2018.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Medhini Narasimhan, Svetlana Lazebnik, and Alexander Schwing.

</span>
<span class="ltx_bibblock">Out of the box: Reasoning with graph convolution nets for factual
visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
2659–2670, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Medhini Narasimhan and Alexander G Schwing.

</span>
<span class="ltx_bibblock">Straight to the facts: Learning knowledge base retrieval for factual
visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</span>, pages 451–468, 2018.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Antoine Bordes, Nicolas Usunier, Alberto Garcia-Duran, Jason Weston, and Oksana
Yakhnenko.

</span>
<span class="ltx_bibblock">Translating embeddings for modeling multi-relational data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
2787–2795, 2013.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Guoliang Ji, Shizhu He, Liheng Xu, Kang Liu, and Jun Zhao.

</span>
<span class="ltx_bibblock">Knowledge graph embedding via dynamic mapping matrix.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">Proceedings of the 53rd Annual Meeting of the Association for
Computational Linguistics and the 7th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</span>, volume 1, pages
687–696, 2015.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Rowan Zellers, Mark Yatskar, Sam Thomson, and Yejin Choi.

</span>
<span class="ltx_bibblock">Neural motifs: Scene graph parsing with global context.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, pages 5831–5840, 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
David K Duvenaud, Dougal Maclaurin, Jorge Iparraguirre, Rafael Bombarell,
Timothy Hirzel, Alán Aspuru-Guzik, and Ryan P Adams.

</span>
<span class="ltx_bibblock">Convolutional networks on graphs for learning molecular fingerprints.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
2224–2232, 2015.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Justin Gilmer, Samuel S Schoenholz, Patrick F Riley, Oriol Vinyals, and
George E Dahl.

</span>
<span class="ltx_bibblock">Neural message passing for quantum chemistry.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1704.01212</span>, 2017.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Petar Velickovic, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro
Lio, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Graph attention networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1710.10903</span>, 1(2), 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Thomas N Kipf and Max Welling.

</span>
<span class="ltx_bibblock">Semi-supervised classification with graph convolutional networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1609.02907</span>, 2016.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Jie Zhou, Ganqu Cui, Zhengyan Zhang, Cheng Yang, Zhiyuan Liu, and Maosong Sun.

</span>
<span class="ltx_bibblock">Graph neural networks: A review of methods and applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.08434</span>, 2018.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.

</span>
<span class="ltx_bibblock">Faster r-cnn: Towards real-time object detection with region proposal
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
91–99, 2015.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">2009 IEEE conference on computer vision and pattern
recognition</span>, pages 248–255. Ieee, 2009.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Kaiming He, Georgia Gkioxari, Piotr Dollár, and Ross Girshick.

</span>
<span class="ltx_bibblock">Mask r-cnn.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international conference on computer
vision</span>, pages 2961–2969, 2017.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.6980</span>, 2014.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and Christopher Manning.

</span>
<span class="ltx_bibblock">Glove: Global vectors for word representation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Proceedings of the 2014 conference on empirical methods in
natural language processing (EMNLP)</span>, pages 1532–1543, 2014.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Making the v in vqa matter: Elevating the role of image understanding
in visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">CVPR</span>, pages 6904–6913, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Ilija Ilievski and Jiashi Feng.

</span>
<span class="ltx_bibblock">A simple loss function for improving the convergence and accuracy of
visual question answering models.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1708.00584</span>, 2017.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Aishwarya Agrawal, Jiasen Lu, Stanislaw Antol, Margaret Mitchell, C. Lawrence
Zitnick, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">ICCV</span>, pages 2425–2433, 2015.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Zhou Yu, Jun Yu, Chenchao Xiang, Jianping Fan, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Beyond bilinear: Generalized multimodal factorized high-order pooling
for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">IEEE transactions on neural networks and learning systems</span>,
(99):1–13, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1812.09679" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1812.09681" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1812.09681">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1812.09681" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1812.09682" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 18:20:49 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
