<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network</title>
<!--Generated on Sun Oct  6 04:28:30 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Facial Expression Recognition Student Academic Performance Memory Network Vision xLSTM, Chen, Jili, Huang, Qionghao" lang="en" name="keywords"/>
<base href="/html/2410.05074v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S1" title="In xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S2" title="In xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S2.SS1" title="In 2 Related Work ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Student Facial Expression Recognition in Learning Environment</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S2.SS2" title="In 2 Related Work ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Long Short-Term Memory Network</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3" title="In xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.SS1" title="In 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Patch Embedding</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.SS2" title="In 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>xLSTM Encoder</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.SS3" title="In 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Path Transfer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.SS4" title="In 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Classification Head</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4" title="In xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.SS1" title="In 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets and Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.SS2" title="In 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experiment Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.SS3" title="In 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.SS4" title="In 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Case Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S5" title="In xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span class="ltx_note ltx_role_institutetext" id="id1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Zhejiang Key Laboratory of Intelligent Education Technology and Application,
Zhejiang Normal University, Zhejiang Province, Jinhua, China
<span class="ltx_note ltx_role_email" id="id1.1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>qhhuang@zjnu.edu.cn</span></span></span>
<br class="ltx_break"/></span></span></span><span class="ltx_note ltx_role_institutetext" id="id2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">institutetext: </span>Zhejiang Key Laboratory of Intelligent Education Technology and Application,
Zhejiang Normal University, Zhejiang Province, Jinhua, China
<br class="ltx_break"/><span class="ltx_note ltx_role_email" id="id2.1"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">email: </span>irelia@zjnu.edu.cn</span></span></span>
</span></span></span>
<h1 class="ltx_title ltx_title_document">xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qionghao Huang
</span><span class="ltx_author_notes">11</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jili Chen
</span><span class="ltx_author_notes">22</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Student expression recognition has become an essential tool for assessing learning experiences and emotional states. This paper introduces xLSTM-FER, a novel architecture derived from the Extended Long Short-Term Memory (xLSTM), designed to enhance the accuracy and efficiency of expression recognition through advanced sequence processing capabilities for student facial expression recognition. xLSTM-FER processes input images by segmenting them into a series of patches and leveraging a stack of xLSTM blocks to handle these patches. xLSTM-FER can capture subtle changes in real-world students’ facial expressions and improve recognition accuracy by learning spatial-temporal relationships within the sequence. Experiments on CK+, RAF-DF, and FERplus demonstrate the potential of xLSTM-FER in expression recognition tasks, showing better performance compared to state-of-the-art methods on standard datasets. The linear computational and memory complexity of xLSTM-FER make it particularly suitable for handling high-resolution images. Moreover, the design of xLSTM-FER allows for efficient processing of non-sequential inputs such as images without additional computation.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Facial Expression Recognition Student Academic Performance Memory Network Vision xLSTM
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Student facial expression recognition is a burgeoning field with significant implications for educational technology. By analyzing students’ facial cues, educators can gain insights into their emotional states, engagement levels <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib25" title="">25</a>]</cite>, cognitive load <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib12" title="">12</a>]</cite>, and academic performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib11" title="">11</a>]</cite> during learning activities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib9" title="">9</a>]</cite>. The current student face recognition systems primarily include those based on traditional CNN-based and Vision Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib5" title="">5</a>]</cite> (ViT)-based approaches.
The lightweight and efficient characteristics of CNNs have attracted the attention of early education researchers, leading to the development of a series of face recognition systems and teaching environments based on CNNs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib22" title="">22</a>]</cite>. The ViT has replaced CNN as a more robust backbone network for student facial expression recognition. The Vision Transformer, leveraging self-attention for global image modeling, has surpassed the performance of CNNs in both teaching feedback systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib28" title="">28</a>]</cite> and the assessment of learning outcomes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib29" title="">29</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, for CNNs, the main limitation is their lack of global receptive fields and dynamic weighting capabilities, which can restrict their ability to capture long-range dependencies and integrate information from the entire image <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib13" title="">13</a>]</cite>. Besides, this advantage of ViTs comes at the cost of quadratic complexity in terms of image sizes, which leads to a significant computational overhead when dealing with dense prediction tasks such as object detection and semantic segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib33" title="">33</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address the aforementioned issues, we propose the xLSTM-FER. xLSTM-FER begins by segmenting the input image into a series of non-overlapping patches, converting the 2D image into a 1D token sequence with added learnable 2D positional encodings to retain spatial information. These sequences are then fed into an xLSTM encoder composed of stacked xLSTM blocks. The xLSTM blocks maintain a linear complexity while capturing long-range dependencies and spatial-temporal dynamics within the image sequence. Each xLSTM block employs a modified LSTM layer (mLSTM) that uses matrix values for memory retrieval, enhancing the model’s capacity to discern subtle facial movements. To overcome the inherent difficulty of parallel processing in LSTM, the mLSTM utilizes a memory matrix to enhance parallel capabilities. By integrating different path traversals, the model achieves a comprehensive image representation. The summary of our contributions is as follows:</p>
</div>
<div class="ltx_para" id="S1.p4">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose xLSTM-FER, which segments input images into a series of patches and processes them through a stack of xLSTM blocks, allowing the model to capture subtle facial expression changes and improve recognition accuracy by learning the spatial-temporal dynamics within the sequence.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The xLSTM-FER has the capabilities of parallelization and scalability through the memory matrix calculation. With its linear computational and memory complexity, which is essential for capturing clear and detailed student expressions and making xLSTM-FER a more practical solution for real-world applications.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">The extensive empirical evaluations of the xLSTM-FER model on multiple standard datasets demonstrate its superior performance in facial expression recognition tasks, including a perfect score on the CK+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib18" title="">18</a>]</cite> dataset, and shows substantial improvements over previous state-of-the-art methods on both RAF-DB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib16" title="">16</a>]</cite> and FERplus <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib2" title="">2</a>]</cite> datasets.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Student Facial Expression Recognition in Learning Environment</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Early work utilizes Convolutional Neural Networks (CNNs) as the backbone for facial expression recognition tasks. Mohamad <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib21" title="">21</a>]</cite> use a VGG-B network to calculate the level of student engagement in MOOCs based on their facial expressions. Lasri <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.2">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib15" title="">15</a>]</cite> demonstrate a CNN-based automatic facial recognition system in educational settings can assist teachers in adjusting their teaching strategies and materials according to the emotional responses of students. Wang <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.3">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib26" title="">26</a>]</cite> introduce a framework integrating an enhanced MobileViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib19" title="">19</a>]</cite> model with an online platform for real-time student emotion analysis. To analyze student expressions and inform teaching strategies, Ling <span class="ltx_text ltx_font_italic" id="S2.SS1.p1.1.4">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib17" title="">17</a>]</cite> present a classroom-based FER system using YOLO and ViT. The computational demands of ViTs grow quadratically with the self-attention mechanism, which can be prohibitive for applications requiring high-resolution processing. To make facial recognition more efficient in educational scenarios, xLSTM-FER demonstrates linear computational and memory complexity, making it more suitable for training and practical deployment.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Long Short-Term Memory Network</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib7" title="">7</a>]</cite> is a type of recurrent neural network (RNN) architecture that is particularly good at learning order dependence in sequence prediction problems. Recently, Beck <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib3" title="">3</a>]</cite> propose improvements to LSTM, including exponential gating and novel memory structures, to address the limitations of LSTM and enable it to scale to larger model sizes. Alkin <span class="ltx_text ltx_font_italic" id="S2.SS2.p1.1.1">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib1" title="">1</a>]</cite> verify that xLSTM is also applicable as a visual backbone network. Compared to CNNs, xLSTM has the characteristic of being scalable, and compared to Vision Transformers, it has a more linear complexity which makes it easier to deploy in practice. However, its application in student facial expression recognition remains unexplored. Therefore, we propose xLSTM-FER to explore the potential application of LSTM-based models and overcome the challenge in student expression recognition.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Patch Embedding</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.4">The overall architecture of our network is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.F1.sf1" title="In Figure 1 ‣ 3.1 Patch Embedding ‣ 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_tag">1(a)</span></a>. We first perform patchification on the image. The input image <math alttext="x\in\mathrm{R}^{H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.4" xref="S3.SS1.p1.1.m1.1.1.3.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑥</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">R</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.4">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">x\in\mathrm{R}^{H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_x ∈ roman_R start_POSTSUPERSCRIPT italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math> is divided into a grid of non-overlapping patches. Each patch is a small square or rectangle of pixels with a width of <math alttext="P" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_P</annotation></semantics></math>. Then, each patch is flattened into a sequence of pixel values <math alttext="X_{p}\in\mathrm{R}^{N\times(P^{2}\times C)}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.2" xref="S3.SS1.p1.3.m3.1.2.cmml"><msub id="S3.SS1.p1.3.m3.1.2.2" xref="S3.SS1.p1.3.m3.1.2.2.cmml"><mi id="S3.SS1.p1.3.m3.1.2.2.2" xref="S3.SS1.p1.3.m3.1.2.2.2.cmml">X</mi><mi id="S3.SS1.p1.3.m3.1.2.2.3" xref="S3.SS1.p1.3.m3.1.2.2.3.cmml">p</mi></msub><mo id="S3.SS1.p1.3.m3.1.2.1" xref="S3.SS1.p1.3.m3.1.2.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.2.3" xref="S3.SS1.p1.3.m3.1.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.2.3.2" mathvariant="normal" xref="S3.SS1.p1.3.m3.1.2.3.2.cmml">R</mi><mrow id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.3.cmml">N</mi><mo id="S3.SS1.p1.3.m3.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.1.2.cmml">×</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml"><msup id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.3.cmml">C</mi></mrow><mo id="S3.SS1.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.2.cmml" xref="S3.SS1.p1.3.m3.1.2"><in id="S3.SS1.p1.3.m3.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.1"></in><apply id="S3.SS1.p1.3.m3.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.2.2.1.cmml" xref="S3.SS1.p1.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.2.2.2.cmml" xref="S3.SS1.p1.3.m3.1.2.2.2">𝑋</ci><ci id="S3.SS1.p1.3.m3.1.2.2.3.cmml" xref="S3.SS1.p1.3.m3.1.2.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.3.m3.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.2.3.1.cmml" xref="S3.SS1.p1.3.m3.1.2.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.2.3.2.cmml" xref="S3.SS1.p1.3.m3.1.2.3.2">R</ci><apply id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"><times id="S3.SS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.2"></times><ci id="S3.SS1.p1.3.m3.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.3">𝑁</ci><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1"><times id="S3.SS1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.1"></times><apply id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.2">𝑃</ci><cn id="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.1.1.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">X_{p}\in\mathrm{R}^{N\times(P^{2}\times C)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_X start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ roman_R start_POSTSUPERSCRIPT italic_N × ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT × italic_C ) end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N=HW/(P^{2})" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">N</mi><mo id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">=</mo><mrow id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml"><mrow id="S3.SS1.p1.4.m4.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.1.3.2.cmml">H</mi><mo id="S3.SS1.p1.4.m4.1.1.1.3.1" xref="S3.SS1.p1.4.m4.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.4.m4.1.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.1.3.3.cmml">W</mi></mrow><mo id="S3.SS1.p1.4.m4.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.2.cmml">/</mo><mrow id="S3.SS1.p1.4.m4.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.cmml">P</mi><mn id="S3.SS1.p1.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S3.SS1.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><eq id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2"></eq><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑁</ci><apply id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1"><divide id="S3.SS1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.2"></divide><apply id="S3.SS1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3"><times id="S3.SS1.p1.4.m4.1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.1"></times><ci id="S3.SS1.p1.4.m4.1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.2">𝐻</ci><ci id="S3.SS1.p1.4.m4.1.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.1.3.3">𝑊</ci></apply><apply id="S3.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.2">𝑃</ci><cn id="S3.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.4.m4.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">N=HW/(P^{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_N = italic_H italic_W / ( italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>. The flattened patch sequences are then linearly projected to a higher-dimensional space. To provide the model with information about the relative positions of the patches, we add learnable 2D positional embeddings to the patch sequences.</p>
</div>
<figure class="ltx_figure" id="S3.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="452" id="S3.F1.sf1.g1" src="x1.png" width="706"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F1.sf1.3.2" style="font-size:90%;">The pipeline of our xLSTM-FER.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="383" id="S3.F1.sf2.g1" src="x2.png" width="705"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F1.sf2.3.2" style="font-size:90%;">Left: The model diagram of the xLSTM Block. Right: The model diagram of the xLSTM Layer.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S3.F1.3.2" style="font-size:90%;">Framework of our xLSTM-FER.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>xLSTM Encoder</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.5"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.5.1">xLSTM Block.</span>
The xLSTM encoder is a structure composed of <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_L</annotation></semantics></math>-layer stacked xLSTM Blocks, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.F1.sf2" title="In Figure 1 ‣ 3.1 Patch Embedding ‣ 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_tag">1(b)</span></a>. The xLSTM Block begins by layer-normalizing and then inverting the input. One branch doubles the channels (F=2) to construct the output gating, while the other branch uses a causal convolution layer (Kernel=3) to build the input for the mLSTM layer, which includes the query and key branch vectors for the linear attention mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib14" title="">14</a>]</cite>, with the value vector bypassing the causal convolution. The output of the mLSTM layer is passed through a group normalization layer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib30" title="">30</a>]</cite> and is then summed with the output of the causal convolution via a weighted residual connection to obtain <math alttext="\tilde{h_{t}}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mover accent="true" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2.2" xref="S3.SS2.p1.2.m2.1.1.2.2.cmml">h</mi><mi id="S3.SS2.p1.2.m2.1.1.2.3" xref="S3.SS2.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><ci id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1">~</ci><apply id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2.2">ℎ</ci><ci id="S3.SS2.p1.2.m2.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\tilde{h_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">over~ start_ARG italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, and <math alttext="\tilde{h_{t}}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mover accent="true" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><msub id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2.2" xref="S3.SS2.p1.3.m3.1.1.2.2.cmml">h</mi><mi id="S3.SS2.p1.3.m3.1.1.2.3" xref="S3.SS2.p1.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><ci id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1">~</ci><apply id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2.2">ℎ</ci><ci id="S3.SS2.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.p1.3.m3.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\tilde{h_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">over~ start_ARG italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> is gated with the result of the output gate <math alttext="o_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">o</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑜</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">o_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to obtain the output of the hidden state <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">h</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">ℎ</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Finally, the channels are halved (F=1/2) and sum with the input embeddings of the block through a residual connection to obtain the entire xLSTM block’s output. This high-capacity storage capability enables the model to distinguish between subtle differences in facial expressions, crucial for identifying even the most nuanced emotions. This scalability is essential for creating robust systems capable of operating in diverse real-world environments.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.1.1">mLSTM Layer.</span> The mLSTM employs a FlashAttention mechanism, which is simulated using query, key, and value to guide the updates of both the cell state and the normalizer state, and subsequently outputs the results of the hidden layer as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S3.F1.sf2" title="In Figure 1 ‣ 3.1 Patch Embedding ‣ 3 Methodology ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_tag">1(b)</span></a>. Specifically, the mLSTM layer first performs linear projections on the query, key, and value vectors:</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{aligned} \operatorname{QueryMapping}\quad q_{t}\,=\,W_{q}%
\,x_{q}\,+\,b_{q},\\
\operatorname{ScaledKeyMapping}\quad k_{t}\;=\;\frac{1}{\sqrt{d}}W_{k}\;x_{k}%
\;+\;b_{k},\\
\operatorname{ValueMapping}\quad v_{t}\,=\,W_{v}\,x_{v}\,+\,b_{v},\end{aligned}" class="ltx_Math" display="inline" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mtable id="S3.E1.m1.6.6" rowspacing="0pt" xref="S3.E1.m1.6.6.cmml"><mtr id="S3.E1.m1.6.6a" xref="S3.E1.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.6.6b" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">QueryMapping</mi><mspace id="S3.E1.m1.2.2.2.2.2.2.1.1.1.2" width="1.167em" xref="S3.E1.m1.2.2.2.2.2.2.1.1.2.cmml"></mspace><msub id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.2" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.2.cmml">q</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.2.2.2.2.2.2.1.2" rspace="0.448em" xref="S3.E1.m1.2.2.2.2.2.2.1.2.cmml">=</mo><mrow id="S3.E1.m1.2.2.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.2.1.3.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.cmml"><msub id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.2.cmml">W</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.3.cmml">q</mi></msub><mo id="S3.E1.m1.2.2.2.2.2.2.1.3.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.1.cmml">⁢</mo><msub id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.2.cmml">x</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.3" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.3.cmml">q</mi></msub></mrow><mo id="S3.E1.m1.2.2.2.2.2.2.1.3.1" rspace="0.392em" xref="S3.E1.m1.2.2.2.2.2.2.1.3.1.cmml">+</mo><msub id="S3.E1.m1.2.2.2.2.2.2.1.3.3" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.1.3.3.2" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3.2.cmml">b</mi><mi id="S3.E1.m1.2.2.2.2.2.2.1.3.3.3" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3.3.cmml">q</mi></msub></mrow></mrow><mo id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E1.m1.6.6c" xref="S3.E1.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.6.6d" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.4.4.4.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.1.cmml"><mrow id="S3.E1.m1.4.4.4.2.2.2.1" xref="S3.E1.m1.4.4.4.2.2.2.1.cmml"><mrow id="S3.E1.m1.4.4.4.2.2.2.1.1.1" xref="S3.E1.m1.4.4.4.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.cmml">ScaledKeyMapping</mi><mspace id="S3.E1.m1.4.4.4.2.2.2.1.1.1.2" width="1.167em" xref="S3.E1.m1.4.4.4.2.2.2.1.1.2.cmml"></mspace><msub id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.2" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.2.cmml">k</mi><mi id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.3" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.4.4.4.2.2.2.1.2" rspace="0.558em" xref="S3.E1.m1.4.4.4.2.2.2.1.2.cmml">=</mo><mrow id="S3.E1.m1.4.4.4.2.2.2.1.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.4.4.4.2.2.2.1.3.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.cmml"><mfrac id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2a" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.cmml"><mn id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.2.cmml">1</mn><msqrt id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3.cmml"><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3.2.cmml">d</mi></msqrt></mfrac></mstyle><mo id="S3.E1.m1.4.4.4.2.2.2.1.3.2.1" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.1.cmml">⁢</mo><msub id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.cmml"><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.2.cmml">W</mi><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.3.cmml">k</mi></msub><mo id="S3.E1.m1.4.4.4.2.2.2.1.3.2.1a" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.1.cmml">⁢</mo><msub id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.cmml"><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.2.cmml">x</mi><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.3.cmml">k</mi></msub></mrow><mo id="S3.E1.m1.4.4.4.2.2.2.1.3.1" rspace="0.502em" xref="S3.E1.m1.4.4.4.2.2.2.1.3.1.cmml">+</mo><msub id="S3.E1.m1.4.4.4.2.2.2.1.3.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3.cmml"><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.3.2" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3.2.cmml">b</mi><mi id="S3.E1.m1.4.4.4.2.2.2.1.3.3.3" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E1.m1.4.4.4.2.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E1.m1.6.6e" xref="S3.E1.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.6.6f" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.6.6.6.2.2.2" xref="S3.E1.m1.6.6.6.2.2.2.1.cmml"><mrow id="S3.E1.m1.6.6.6.2.2.2.1" xref="S3.E1.m1.6.6.6.2.2.2.1.cmml"><mrow id="S3.E1.m1.6.6.6.2.2.2.1.1.1" xref="S3.E1.m1.6.6.6.2.2.2.1.1.2.cmml"><mi id="S3.E1.m1.5.5.5.1.1.1" xref="S3.E1.m1.5.5.5.1.1.1.cmml">ValueMapping</mi><mspace id="S3.E1.m1.6.6.6.2.2.2.1.1.1.2" width="1.167em" xref="S3.E1.m1.6.6.6.2.2.2.1.1.2.cmml"></mspace><msub id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.2" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.2.cmml">v</mi><mi id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.3" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.6.6.6.2.2.2.1.2" rspace="0.448em" xref="S3.E1.m1.6.6.6.2.2.2.1.2.cmml">=</mo><mrow id="S3.E1.m1.6.6.6.2.2.2.1.3" xref="S3.E1.m1.6.6.6.2.2.2.1.3.cmml"><mrow id="S3.E1.m1.6.6.6.2.2.2.1.3.2" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.cmml"><msub id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.cmml"><mi id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.2" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.2.cmml">W</mi><mi id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.3" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.3.cmml">v</mi></msub><mo id="S3.E1.m1.6.6.6.2.2.2.1.3.2.1" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.1.cmml">⁢</mo><msub id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.cmml"><mi id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.2" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.2.cmml">x</mi><mi id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.3" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.3.cmml">v</mi></msub></mrow><mo id="S3.E1.m1.6.6.6.2.2.2.1.3.1" rspace="0.392em" xref="S3.E1.m1.6.6.6.2.2.2.1.3.1.cmml">+</mo><msub id="S3.E1.m1.6.6.6.2.2.2.1.3.3" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3.cmml"><mi id="S3.E1.m1.6.6.6.2.2.2.1.3.3.2" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3.2.cmml">b</mi><mi id="S3.E1.m1.6.6.6.2.2.2.1.3.3.3" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3.3.cmml">v</mi></msub></mrow></mrow><mo id="S3.E1.m1.6.6.6.2.2.2.2" xref="S3.E1.m1.6.6.6.2.2.2.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><matrix id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><matrixrow id="S3.E1.m1.6.6a.cmml" xref="S3.E1.m1.6.6"><apply id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><eq id="S3.E1.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.2"></eq><list id="S3.E1.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1"><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">QueryMapping</ci><apply id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.2">𝑞</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E1.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3"><plus id="S3.E1.m1.2.2.2.2.2.2.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.1"></plus><apply id="S3.E1.m1.2.2.2.2.2.2.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2"><times id="S3.E1.m1.2.2.2.2.2.2.1.3.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.1"></times><apply id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.2">𝑊</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.2.3">𝑞</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.2">𝑥</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.2.3.3">𝑞</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.2.2.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.3.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.1.3.3.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3.2">𝑏</ci><ci id="S3.E1.m1.2.2.2.2.2.2.1.3.3.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1.3.3.3">𝑞</ci></apply></apply></apply></matrixrow><matrixrow id="S3.E1.m1.6.6b.cmml" xref="S3.E1.m1.6.6"><apply id="S3.E1.m1.4.4.4.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2"><eq id="S3.E1.m1.4.4.4.2.2.2.1.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.2"></eq><list id="S3.E1.m1.4.4.4.2.2.2.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1"><ci id="S3.E1.m1.3.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1">ScaledKeyMapping</ci><apply id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.2">𝑘</ci><ci id="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3"><plus id="S3.E1.m1.4.4.4.2.2.2.1.3.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.1"></plus><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2"><times id="S3.E1.m1.4.4.4.2.2.2.1.3.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.1"></times><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2"><divide id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2"></divide><cn id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.2.cmml" type="integer" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.2">1</cn><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3"><root id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3a.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3"></root><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.2.3.2">𝑑</ci></apply></apply><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.2">𝑊</ci><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.3.3">𝑘</ci></apply><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.2">𝑥</ci><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.2.4.3">𝑘</ci></apply></apply><apply id="S3.E1.m1.4.4.4.2.2.2.1.3.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.2.1.3.3.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3">subscript</csymbol><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.3.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3.2">𝑏</ci><ci id="S3.E1.m1.4.4.4.2.2.2.1.3.3.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.1.3.3.3">𝑘</ci></apply></apply></apply></matrixrow><matrixrow id="S3.E1.m1.6.6c.cmml" xref="S3.E1.m1.6.6"><apply id="S3.E1.m1.6.6.6.2.2.2.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2"><eq id="S3.E1.m1.6.6.6.2.2.2.1.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.2"></eq><list id="S3.E1.m1.6.6.6.2.2.2.1.1.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1"><ci id="S3.E1.m1.5.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.5.1.1.1">ValueMapping</ci><apply id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.2">𝑣</ci><ci id="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E1.m1.6.6.6.2.2.2.1.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3"><plus id="S3.E1.m1.6.6.6.2.2.2.1.3.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.1"></plus><apply id="S3.E1.m1.6.6.6.2.2.2.1.3.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2"><times id="S3.E1.m1.6.6.6.2.2.2.1.3.2.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.1"></times><apply id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.2">𝑊</ci><ci id="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.2.3">𝑣</ci></apply><apply id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3">subscript</csymbol><ci id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.2">𝑥</ci><ci id="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.2.3.3">𝑣</ci></apply></apply><apply id="S3.E1.m1.6.6.6.2.2.2.1.3.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.2.2.2.1.3.3.1.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3">subscript</csymbol><ci id="S3.E1.m1.6.6.6.2.2.2.1.3.3.2.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3.2">𝑏</ci><ci id="S3.E1.m1.6.6.6.2.2.2.1.3.3.3.cmml" xref="S3.E1.m1.6.6.6.2.2.2.1.3.3.3">𝑣</ci></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\displaystyle\begin{aligned} \operatorname{QueryMapping}\quad q_{t}\,=\,W_{q}%
\,x_{q}\,+\,b_{q},\\
\operatorname{ScaledKeyMapping}\quad k_{t}\;=\;\frac{1}{\sqrt{d}}W_{k}\;x_{k}%
\;+\;b_{k},\\
\operatorname{ValueMapping}\quad v_{t}\,=\,W_{v}\,x_{v}\,+\,b_{v},\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">start_ROW start_CELL roman_QueryMapping italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL roman_ScaledKeyMapping italic_k start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL roman_ValueMapping italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.10">where <math alttext="x_{q}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">x_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="x_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑥</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">x_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="x_{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><msub id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">x_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math>, represent the input query, key, and value vectors respectively, while <math alttext="W_{q}" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.1"><semantics id="S3.SS2.p3.4.m4.1a"><msub id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml">W</mi><mi id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2">𝑊</ci><ci id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">W_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.1d">italic_W start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="W_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑊</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">W_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_W start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="W_{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><msub id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml">W</mi><mi id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2">𝑊</ci><ci id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">W_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_W start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> are the corresponding mapping matrices. <math alttext="b_{q}" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">b</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑏</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">b_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_b start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="b_{k}" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><msub id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml"><mi id="S3.SS2.p3.8.m8.1.1.2" xref="S3.SS2.p3.8.m8.1.1.2.cmml">b</mi><mi id="S3.SS2.p3.8.m8.1.1.3" xref="S3.SS2.p3.8.m8.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><apply id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.8.m8.1.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p3.8.m8.1.1.2.cmml" xref="S3.SS2.p3.8.m8.1.1.2">𝑏</ci><ci id="S3.SS2.p3.8.m8.1.1.3.cmml" xref="S3.SS2.p3.8.m8.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">b_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="b_{v}" class="ltx_Math" display="inline" id="S3.SS2.p3.9.m9.1"><semantics id="S3.SS2.p3.9.m9.1a"><msub id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml">b</mi><mi id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2">𝑏</ci><ci id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">b_{v}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.9.m9.1d">italic_b start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> are the corresponding bias terms. By concatenating the mapped query, key, and value vectors, the input <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS2.p3.10.m10.1"><semantics id="S3.SS2.p3.10.m10.1a"><msub id="S3.SS2.p3.10.m10.1.1" xref="S3.SS2.p3.10.m10.1.1.cmml"><mi id="S3.SS2.p3.10.m10.1.1.2" xref="S3.SS2.p3.10.m10.1.1.2.cmml">x</mi><mi id="S3.SS2.p3.10.m10.1.1.3" xref="S3.SS2.p3.10.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.10.m10.1b"><apply id="S3.SS2.p3.10.m10.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.10.m10.1.1.1.cmml" xref="S3.SS2.p3.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.p3.10.m10.1.1.2.cmml" xref="S3.SS2.p3.10.m10.1.1.2">𝑥</ci><ci id="S3.SS2.p3.10.m10.1.1.3.cmml" xref="S3.SS2.p3.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.10.m10.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.10.m10.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is obtained for the memory network to perform memory updates. The xLSTM uses an input gate and a forget gate to control the situation of memory updates and employs exponential gating and OR gating to facilitate the matrix memory calculation:</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx2">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{aligned} \operatorname{Input\,Gate:}\quad i_{t}=\exp(%
\tilde{i}_{t}),\quad\tilde{i}_{t}=w_{i}^{\top}x_{t}+b_{i},\\
\operatorname{Forget\,Gate:}\quad f_{t}=\exp(\tilde{f}_{t})\operatorname{OR}%
\sigma({f}_{t}),\quad\tilde{f}_{t}=w_{f}^{\top}x_{t}+b_{f},\\
\end{aligned}" class="ltx_Math" display="inline" id="S3.E2.m1.6"><semantics id="S3.E2.m1.6a"><mtable id="S3.E2.m1.6.6" rowspacing="0pt" xref="S3.E2.m1.6.6.cmml"><mtr id="S3.E2.m1.6.6a" xref="S3.E2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.6.6b" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.3.3.3.3.3.3" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.3.3.3.3.3.3.1.2" xref="S3.E2.m1.3.3.3.3.3.3.1.3.cmml"><mrow id="S3.E2.m1.3.3.3.3.3.3.1.1.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.cmml"><mrow id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.2.cmml">Input</mi><mo id="S3.E2.m1.2.2.2.2.2.2.2.1" lspace="0.170em" xref="S3.E2.m1.2.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.2.3.cmml">Gate</mi></mrow><mo id="S3.E2.m1.2.2.2.2.2.2.1" lspace="0.278em" rspace="0.278em" xref="S3.E2.m1.2.2.2.2.2.2.1.cmml">:</mo><mi id="S3.E2.m1.2.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.2.3.cmml"></mi></mrow><mspace id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.2" width="1em" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.2.cmml"></mspace><msub id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml">i</mi><mi id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.3.3.3.3.3.3.1.1.1.3" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1a" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.2.cmml"><mo id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.2.cmml">(</mo><msub id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.2.cmml">i</mi><mo id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.1" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.3" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.3.3.3.3.1.2.3" rspace="1.167em" xref="S3.E2.m1.3.3.3.3.3.3.1.3a.cmml">,</mo><mrow id="S3.E2.m1.3.3.3.3.3.3.1.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.cmml"><msub id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.2.cmml">i</mi><mo id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.1" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E2.m1.3.3.3.3.3.3.1.2.2.1" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.cmml"><mrow id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.cmml"><msubsup id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.2.cmml">w</mi><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.3.cmml">i</mi><mo id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.1" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.1.cmml">⁢</mo><msub id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.2.cmml">x</mi><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.1" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.1.cmml">+</mo><msub id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.cmml"><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.2" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.2.cmml">b</mi><mi id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.3" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S3.E2.m1.3.3.3.3.3.3.2" xref="S3.E2.m1.6.6.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E2.m1.6.6c" xref="S3.E2.m1.6.6.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E2.m1.6.6d" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.6.6.6.3.3.3" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.6.6.6.3.3.3.1.2" xref="S3.E2.m1.6.6.6.3.3.3.1.3.cmml"><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.cmml"><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.2.cmml"><mrow id="S3.E2.m1.5.5.5.2.2.2" xref="S3.E2.m1.5.5.5.2.2.2.cmml"><mrow id="S3.E2.m1.5.5.5.2.2.2.2" xref="S3.E2.m1.5.5.5.2.2.2.2.cmml"><mi id="S3.E2.m1.5.5.5.2.2.2.2.2" xref="S3.E2.m1.5.5.5.2.2.2.2.2.cmml">Forget</mi><mo id="S3.E2.m1.5.5.5.2.2.2.2.1" lspace="0.170em" xref="S3.E2.m1.5.5.5.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E2.m1.5.5.5.2.2.2.2.3" xref="S3.E2.m1.5.5.5.2.2.2.2.3.cmml">Gate</mi></mrow><mo id="S3.E2.m1.5.5.5.2.2.2.1" lspace="0.278em" rspace="0.278em" xref="S3.E2.m1.5.5.5.2.2.2.1.cmml">:</mo><mi id="S3.E2.m1.5.5.5.2.2.2.3" xref="S3.E2.m1.5.5.5.2.2.2.3.cmml"></mi></mrow><mspace id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.2" width="1em" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.2.cmml"></mspace><msub id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.2" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.3" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.4" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.cmml"><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.2.cmml"><mi id="S3.E2.m1.4.4.4.1.1.1" xref="S3.E2.m1.4.4.4.1.1.1.cmml">exp</mi><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1a" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.2.cmml"><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.2.cmml">(</mo><msub id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.2.cmml">f</mi><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.3" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.3" lspace="0.167em" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.3.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.1.cmml">OR</mi><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4a" lspace="0.167em" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.cmml">⁡</mo><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.2" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.2.cmml">σ</mi></mrow><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.3a" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.3.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.cmml"><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.2" stretchy="false" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.cmml">(</mo><msub id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.2" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.2.cmml">f</mi><mi id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.3" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.3" stretchy="false" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.6.3.3.3.1.2.3" rspace="1.167em" xref="S3.E2.m1.6.6.6.3.3.3.1.3a.cmml">,</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.cmml"><msub id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.2.cmml">f</mi><mo id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.1" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.1.cmml">~</mo></mover><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.E2.m1.6.6.6.3.3.3.1.2.2.1" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.1.cmml">=</mo><mrow id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.cmml"><mrow id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.cmml"><msubsup id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.2.cmml">w</mi><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.3.cmml">f</mi><mo id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.1" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.1.cmml">⁢</mo><msub id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.2.cmml">x</mi><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.1" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.1.cmml">+</mo><msub id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.cmml"><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.2" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.2.cmml">b</mi><mi id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.3" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.3.cmml">f</mi></msub></mrow></mrow></mrow><mo id="S3.E2.m1.6.6.6.3.3.3.2" xref="S3.E2.m1.6.6.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><matrix id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><matrixrow id="S3.E2.m1.6.6a.cmml" xref="S3.E2.m1.6.6"><apply id="S3.E2.m1.3.3.3.3.3.3.1.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.3a.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.3.3.3.3.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1"><eq id="S3.E2.m1.3.3.3.3.3.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.3"></eq><list id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1"><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><ci id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1">:</ci><apply id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2"><times id="S3.E2.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.1"></times><ci id="S3.E2.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.2">Input</ci><ci id="S3.E2.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2.3">Gate</ci></apply><csymbol cd="latexml" id="S3.E2.m1.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.2.3">absent</csymbol></apply><apply id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.2">𝑖</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1"><exp id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"></exp><apply id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1">subscript</csymbol><apply id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2"><ci id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.1">~</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.2.2">𝑖</ci></apply><ci id="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.1.1.2.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2"><eq id="S3.E2.m1.3.3.3.3.3.3.1.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.1"></eq><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2">subscript</csymbol><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2"><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.1">~</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.2.2">𝑖</ci></apply><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.2.3">𝑡</ci></apply><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3"><plus id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.1"></plus><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2"><times id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.1"></times><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2">superscript</csymbol><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.2">𝑤</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.2.3">top</csymbol></apply><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.2">𝑥</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.2.3.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.1.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.2.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.2">𝑏</ci><ci id="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3.3.3.1.2.2.3.3.3">𝑖</ci></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E2.m1.6.6b.cmml" xref="S3.E2.m1.6.6"><apply id="S3.E2.m1.6.6.6.3.3.3.1.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.3a.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1"><eq id="S3.E2.m1.6.6.6.3.3.3.1.1.1.4.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.4"></eq><list id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1"><apply id="S3.E2.m1.5.5.5.2.2.2.cmml" xref="S3.E2.m1.5.5.5.2.2.2"><ci id="S3.E2.m1.5.5.5.2.2.2.1.cmml" xref="S3.E2.m1.5.5.5.2.2.2.1">:</ci><apply id="S3.E2.m1.5.5.5.2.2.2.2.cmml" xref="S3.E2.m1.5.5.5.2.2.2.2"><times id="S3.E2.m1.5.5.5.2.2.2.2.1.cmml" xref="S3.E2.m1.5.5.5.2.2.2.2.1"></times><ci id="S3.E2.m1.5.5.5.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.5.2.2.2.2.2">Forget</ci><ci id="S3.E2.m1.5.5.5.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.5.2.2.2.2.3">Gate</ci></apply><csymbol cd="latexml" id="S3.E2.m1.5.5.5.2.2.2.3.cmml" xref="S3.E2.m1.5.5.5.2.2.2.3">absent</csymbol></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3"><times id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.3"></times><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1"><exp id="S3.E2.m1.4.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.4.1.1.1"></exp><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2"><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.1">~</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.2.2">𝑓</ci></apply><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.2.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4"><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.1">OR</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.4.2">𝜎</ci></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.2">𝑓</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.1.1.3.2.1.1.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2"><eq id="S3.E2.m1.6.6.6.3.3.3.1.2.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.1"></eq><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2">subscript</csymbol><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2"><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.1">~</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.2.2">𝑓</ci></apply><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.2.3">𝑡</ci></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3"><plus id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.1"></plus><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2"><times id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.1"></times><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2">superscript</csymbol><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.2">𝑤</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.2.3">𝑓</ci></apply><csymbol cd="latexml" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.2.3">top</csymbol></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.2">𝑥</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.2.3.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.1.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3">subscript</csymbol><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.2.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.2">𝑏</ci><ci id="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.3.cmml" xref="S3.E2.m1.6.6.6.3.3.3.1.2.2.3.3.3">𝑓</ci></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">\displaystyle\begin{aligned} \operatorname{Input\,Gate:}\quad i_{t}=\exp(%
\tilde{i}_{t}),\quad\tilde{i}_{t}=w_{i}^{\top}x_{t}+b_{i},\\
\operatorname{Forget\,Gate:}\quad f_{t}=\exp(\tilde{f}_{t})\operatorname{OR}%
\sigma({f}_{t}),\quad\tilde{f}_{t}=w_{f}^{\top}x_{t}+b_{f},\\
\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.6d">start_ROW start_CELL start_OPFUNCTION roman_Input roman_Gate : end_OPFUNCTION italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_exp ( over~ start_ARG italic_i end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , over~ start_ARG italic_i end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL start_OPFUNCTION roman_Forget roman_Gate : end_OPFUNCTION italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = roman_exp ( over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) roman_OR italic_σ ( italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) , over~ start_ARG italic_f end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p4.6">where <math alttext="w_{i}^{\top}" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><msubsup id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2.2" xref="S3.SS2.p4.1.m1.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p4.1.m1.1.1.2.3" xref="S3.SS2.p4.1.m1.1.1.2.3.cmml">i</mi><mo id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">⊤</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">superscript</csymbol><apply id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2.2">𝑤</ci><ci id="S3.SS2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">top</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">w_{i}^{\top}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="w_{f}^{\top}" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><msubsup id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2.2" xref="S3.SS2.p4.2.m2.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p4.2.m2.1.1.2.3" xref="S3.SS2.p4.2.m2.1.1.2.3.cmml">f</mi><mo id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">⊤</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.2">𝑤</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3">𝑓</ci></apply><csymbol cd="latexml" id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">top</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">w_{f}^{\top}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="b_{i}" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">b</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑏</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">b_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="b_{f}" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.1"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">b</mi><mi id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝑏</ci><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">b_{f}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.1d">italic_b start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT</annotation></semantics></math> denote the weight vectors and bias terms corresponding to the input gate and forget gate, respectively. The <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_σ</annotation></semantics></math> denotes the activation function, and <math alttext="\exp(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.p4.6.m6.2"><semantics id="S3.SS2.p4.6.m6.2a"><mrow id="S3.SS2.p4.6.m6.2.3.2" xref="S3.SS2.p4.6.m6.2.3.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml">exp</mi><mo id="S3.SS2.p4.6.m6.2.3.2a" xref="S3.SS2.p4.6.m6.2.3.1.cmml">⁡</mo><mrow id="S3.SS2.p4.6.m6.2.3.2.1" xref="S3.SS2.p4.6.m6.2.3.1.cmml"><mo id="S3.SS2.p4.6.m6.2.3.2.1.1" stretchy="false" xref="S3.SS2.p4.6.m6.2.3.1.cmml">(</mo><mo id="S3.SS2.p4.6.m6.2.2" lspace="0em" rspace="0em" xref="S3.SS2.p4.6.m6.2.2.cmml">⋅</mo><mo id="S3.SS2.p4.6.m6.2.3.2.1.2" stretchy="false" xref="S3.SS2.p4.6.m6.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.2b"><apply id="S3.SS2.p4.6.m6.2.3.1.cmml" xref="S3.SS2.p4.6.m6.2.3.2"><exp id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"></exp><ci id="S3.SS2.p4.6.m6.2.2.cmml" xref="S3.SS2.p4.6.m6.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.2c">\exp(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.6.m6.2d">roman_exp ( ⋅ )</annotation></semantics></math> signifies the exponential operation. The mLSTM expands the memory cell into a matrix. By integrating the update mechanism of LSTM with the information retrieval scheme from Transformers, mLSTM introduces an attention-integrated cell state and hidden state update scheme, enabling the extraction of memories from different time steps:</p>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx3">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{aligned} \operatorname{Cell\,State:}\quad C_{t}=f_{t}C_{t-%
1}+i_{t}v_{t}k_{t}^{\top},\\
\operatorname{Normalizer\,State:}\quad n_{t}=f_{t}n_{t-1}+i_{t}k_{t},\\
\operatorname{Output\,Gate:}\quad o_{t}=\sigma(\tilde{o_{t}}),\quad\tilde{o_{t%
}}=W_{o}x_{t}+b_{o},\\
\operatorname{Hidden\,State:}\quad h_{t}=o_{t}\odot\tilde{h_{t}},\quad\tilde{h%
_{t}}=C_{t}q_{t}/\max\{|n^{\top}_{t}q_{t}|,1\},\end{aligned}" class="ltx_Math" display="inline" id="S3.E3.m1.11"><semantics id="S3.E3.m1.11a"><mtable id="S3.E3.m1.11.11" rowspacing="0pt" xref="S3.E3.m1.11.11.cmml"><mtr id="S3.E3.m1.11.11a" xref="S3.E3.m1.11.11.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.11.11b" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E3.m1.2.2.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.2.2.1.1.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">Cell</mi><mo id="S3.E3.m1.1.1.1.1.1.1.2.1" lspace="0.170em" xref="S3.E3.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">State</mi></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">:</mo><mi id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"></mi></mrow><mspace id="S3.E3.m1.2.2.2.2.2.2.1.1.1.2" width="1em" xref="S3.E3.m1.2.2.2.2.2.2.1.1.2.cmml"></mspace><msub id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.2.cmml">C</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.2.2.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.2.2.1.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.cmml"><mrow id="S3.E3.m1.2.2.2.2.2.2.1.3.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.cmml"><msub id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.2.cmml">f</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.2.1" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.2.cmml">C</mi><mrow id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.2.cmml">t</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.1" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.1.cmml">−</mo><mn id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.1" xref="S3.E3.m1.2.2.2.2.2.2.1.3.1.cmml">+</mo><mrow id="S3.E3.m1.2.2.2.2.2.2.1.3.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.cmml"><msub id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.2.cmml">i</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.3.1" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.1.cmml">⁢</mo><msub id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.2.cmml">v</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.3.1a" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.1.cmml">⁢</mo><msubsup id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.2" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.2.cmml">k</mi><mi id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.3.cmml">t</mi><mo id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.3" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.3.cmml">⊤</mo></msubsup></mrow></mrow></mrow><mo id="S3.E3.m1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E3.m1.11.11c" xref="S3.E3.m1.11.11.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.11.11d" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.4.4.4.2.2.2" xref="S3.E3.m1.4.4.4.2.2.2.1.cmml"><mrow id="S3.E3.m1.4.4.4.2.2.2.1" xref="S3.E3.m1.4.4.4.2.2.2.1.cmml"><mrow id="S3.E3.m1.4.4.4.2.2.2.1.1.1" xref="S3.E3.m1.4.4.4.2.2.2.1.1.2.cmml"><mrow id="S3.E3.m1.3.3.3.1.1.1" xref="S3.E3.m1.3.3.3.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.3.1.1.1.2" xref="S3.E3.m1.3.3.3.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.3.1.1.1.2.2" xref="S3.E3.m1.3.3.3.1.1.1.2.2.cmml">Normalizer</mi><mo id="S3.E3.m1.3.3.3.1.1.1.2.1" lspace="0.170em" xref="S3.E3.m1.3.3.3.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E3.m1.3.3.3.1.1.1.2.3" xref="S3.E3.m1.3.3.3.1.1.1.2.3.cmml">State</mi></mrow><mo id="S3.E3.m1.3.3.3.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.3.3.3.1.1.1.1.cmml">:</mo><mi id="S3.E3.m1.3.3.3.1.1.1.3" xref="S3.E3.m1.3.3.3.1.1.1.3.cmml"></mi></mrow><mspace id="S3.E3.m1.4.4.4.2.2.2.1.1.1.2" width="1em" xref="S3.E3.m1.4.4.4.2.2.2.1.1.2.cmml"></mspace><msub id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.2" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.2.cmml">n</mi><mi id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.3" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.4.4.4.2.2.2.1.2" xref="S3.E3.m1.4.4.4.2.2.2.1.2.cmml">=</mo><mrow id="S3.E3.m1.4.4.4.2.2.2.1.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.cmml"><mrow id="S3.E3.m1.4.4.4.2.2.2.1.3.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.cmml"><msub id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.cmml"><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.2.cmml">f</mi><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.4.4.4.2.2.2.1.3.2.1" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.1.cmml">⁢</mo><msub id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.cmml"><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.2.cmml">n</mi><mrow id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.cmml"><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.2.cmml">t</mi><mo id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.1" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.1.cmml">−</mo><mn id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E3.m1.4.4.4.2.2.2.1.3.1" xref="S3.E3.m1.4.4.4.2.2.2.1.3.1.cmml">+</mo><mrow id="S3.E3.m1.4.4.4.2.2.2.1.3.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.cmml"><msub id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.cmml"><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.2.cmml">i</mi><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.4.4.4.2.2.2.1.3.3.1" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.1.cmml">⁢</mo><msub id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.cmml"><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.2" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.2.cmml">k</mi><mi id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.3" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><mo id="S3.E3.m1.4.4.4.2.2.2.2" xref="S3.E3.m1.4.4.4.2.2.2.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E3.m1.11.11e" xref="S3.E3.m1.11.11.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.11.11f" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.7.7.7.3.3.3" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.7.7.7.3.3.3.1.2" xref="S3.E3.m1.7.7.7.3.3.3.1.3.cmml"><mrow id="S3.E3.m1.7.7.7.3.3.3.1.1.1" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.cmml"><mrow id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.2.cmml"><mrow id="S3.E3.m1.6.6.6.2.2.2" xref="S3.E3.m1.6.6.6.2.2.2.cmml"><mrow id="S3.E3.m1.6.6.6.2.2.2.2" xref="S3.E3.m1.6.6.6.2.2.2.2.cmml"><mi id="S3.E3.m1.6.6.6.2.2.2.2.2" xref="S3.E3.m1.6.6.6.2.2.2.2.2.cmml">Output</mi><mo id="S3.E3.m1.6.6.6.2.2.2.2.1" lspace="0.170em" xref="S3.E3.m1.6.6.6.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E3.m1.6.6.6.2.2.2.2.3" xref="S3.E3.m1.6.6.6.2.2.2.2.3.cmml">Gate</mi></mrow><mo id="S3.E3.m1.6.6.6.2.2.2.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.6.6.6.2.2.2.1.cmml">:</mo><mi id="S3.E3.m1.6.6.6.2.2.2.3" xref="S3.E3.m1.6.6.6.2.2.2.3.cmml"></mi></mrow><mspace id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.2" width="1em" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.2.cmml"></mspace><msub id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.cmml">o</mi><mi id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.7.7.7.3.3.3.1.1.1.2" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.cmml"><mi id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.2" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.2.cmml">σ</mi><mo id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.1" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.3.2" xref="S3.E3.m1.5.5.5.1.1.1.cmml"><mo id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.5.1.1.1.cmml">(</mo><mover accent="true" id="S3.E3.m1.5.5.5.1.1.1" xref="S3.E3.m1.5.5.5.1.1.1.cmml"><msub id="S3.E3.m1.5.5.5.1.1.1.2" xref="S3.E3.m1.5.5.5.1.1.1.2.cmml"><mi id="S3.E3.m1.5.5.5.1.1.1.2.2" xref="S3.E3.m1.5.5.5.1.1.1.2.2.cmml">o</mi><mi id="S3.E3.m1.5.5.5.1.1.1.2.3" xref="S3.E3.m1.5.5.5.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.5.5.5.1.1.1.1" xref="S3.E3.m1.5.5.5.1.1.1.1.cmml">~</mo></mover><mo id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.3.2.2" stretchy="false" xref="S3.E3.m1.5.5.5.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.7.7.7.3.3.3.1.2.3" rspace="1.167em" xref="S3.E3.m1.7.7.7.3.3.3.1.3a.cmml">,</mo><mrow id="S3.E3.m1.7.7.7.3.3.3.1.2.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.cmml"><mover accent="true" id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.cmml"><msub id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.cmml"><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.2.cmml">o</mi><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.1" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.1.cmml">~</mo></mover><mo id="S3.E3.m1.7.7.7.3.3.3.1.2.2.1" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.1.cmml">=</mo><mrow id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.cmml"><mrow id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.cmml"><msub id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.cmml"><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.2.cmml">W</mi><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.3.cmml">o</mi></msub><mo id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.1" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.1.cmml">⁢</mo><msub id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.cmml"><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.2.cmml">x</mi><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.1" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.1.cmml">+</mo><msub id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.cmml"><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.2" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.2.cmml">b</mi><mi id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.3" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.3.cmml">o</mi></msub></mrow></mrow></mrow><mo id="S3.E3.m1.7.7.7.3.3.3.2" xref="S3.E3.m1.11.11.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E3.m1.11.11g" xref="S3.E3.m1.11.11.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E3.m1.11.11h" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.11.11.11.4.4.4" xref="S3.E3.m1.11.11.cmml"><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2" xref="S3.E3.m1.11.11.11.4.4.4.1.3.cmml"><mrow id="S3.E3.m1.11.11.11.4.4.4.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.cmml"><mrow id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.2.cmml"><mrow id="S3.E3.m1.8.8.8.1.1.1" xref="S3.E3.m1.8.8.8.1.1.1.cmml"><mrow id="S3.E3.m1.8.8.8.1.1.1.2" xref="S3.E3.m1.8.8.8.1.1.1.2.cmml"><mi id="S3.E3.m1.8.8.8.1.1.1.2.2" xref="S3.E3.m1.8.8.8.1.1.1.2.2.cmml">Hidden</mi><mo id="S3.E3.m1.8.8.8.1.1.1.2.1" lspace="0.170em" xref="S3.E3.m1.8.8.8.1.1.1.2.1.cmml">⁢</mo><mi id="S3.E3.m1.8.8.8.1.1.1.2.3" xref="S3.E3.m1.8.8.8.1.1.1.2.3.cmml">State</mi></mrow><mo id="S3.E3.m1.8.8.8.1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.E3.m1.8.8.8.1.1.1.1.cmml">:</mo><mi id="S3.E3.m1.8.8.8.1.1.1.3" xref="S3.E3.m1.8.8.8.1.1.1.3.cmml"></mi></mrow><mspace id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.2" width="1em" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.2.cmml"></mspace><msub id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.2" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.3" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.11.11.11.4.4.4.1.1.1.2" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.cmml"><msub id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.2.cmml">o</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.1.cmml">⊙</mo><mover accent="true" id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.cmml"><msub id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.2.cmml">h</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.1" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.1.cmml">~</mo></mover></mrow></mrow><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.3" rspace="1.167em" xref="S3.E3.m1.11.11.11.4.4.4.1.3a.cmml">,</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.cmml"><mover accent="true" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.cmml"><msub id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.2.cmml">h</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.1.cmml">~</mo></mover><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.cmml"><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.cmml"><msub id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.2.cmml">C</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.1.cmml">⁢</mo><msub id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.2.cmml">q</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.2.cmml">/</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml"><mi id="S3.E3.m1.9.9.9.2.2.2" xref="S3.E3.m1.9.9.9.2.2.2.cmml">max</mi><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1a" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml"><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml">{</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">n</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.3.cmml">t</mi><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.1" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.2.cmml">q</mi><mi id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.3" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml">,</mo><mn id="S3.E3.m1.10.10.10.3.3.3" xref="S3.E3.m1.10.10.10.3.3.3.cmml">1</mn><mo id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.4" stretchy="false" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E3.m1.11.11.11.4.4.4.2" xref="S3.E3.m1.11.11.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E3.m1.11b"><matrix id="S3.E3.m1.11.11.cmml" xref="S3.E3.m1.11.11"><matrixrow id="S3.E3.m1.11.11a.cmml" xref="S3.E3.m1.11.11"><apply id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><eq id="S3.E3.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.2"></eq><list id="S3.E3.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1"><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><ci id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">:</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.1"></times><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">Cell</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">State</ci></apply><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">absent</csymbol></apply><apply id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.2">𝐶</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3"><plus id="S3.E3.m1.2.2.2.2.2.2.1.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.1"></plus><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2"><times id="S3.E3.m1.2.2.2.2.2.2.1.3.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.1"></times><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.2">𝑓</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.2.3">𝑡</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.2">𝐶</ci><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3"><minus id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.1"></minus><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.2">𝑡</ci><cn id="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.3.cmml" type="integer" xref="S3.E3.m1.2.2.2.2.2.2.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3"><times id="S3.E3.m1.2.2.2.2.2.2.1.3.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.1"></times><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.2">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.2.3">𝑡</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.2">𝑣</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.3.3">𝑡</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.2">𝑘</ci><ci id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.2.3">𝑡</ci></apply><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.1.3.3.4.3">top</csymbol></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E3.m1.11.11b.cmml" xref="S3.E3.m1.11.11"><apply id="S3.E3.m1.4.4.4.2.2.2.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2"><eq id="S3.E3.m1.4.4.4.2.2.2.1.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.2"></eq><list id="S3.E3.m1.4.4.4.2.2.2.1.1.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1"><apply id="S3.E3.m1.3.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.3.1.1.1"><ci id="S3.E3.m1.3.3.3.1.1.1.1.cmml" xref="S3.E3.m1.3.3.3.1.1.1.1">:</ci><apply id="S3.E3.m1.3.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.3.1.1.1.2"><times id="S3.E3.m1.3.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.3.1.1.1.2.1"></times><ci id="S3.E3.m1.3.3.3.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.3.1.1.1.2.2">Normalizer</ci><ci id="S3.E3.m1.3.3.3.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.3.1.1.1.2.3">State</ci></apply><csymbol cd="latexml" id="S3.E3.m1.3.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.3.1.1.1.3">absent</csymbol></apply><apply id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.2">𝑛</ci><ci id="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3"><plus id="S3.E3.m1.4.4.4.2.2.2.1.3.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.1"></plus><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2"><times id="S3.E3.m1.4.4.4.2.2.2.1.3.2.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.1"></times><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.2">𝑓</ci><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.2.3">𝑡</ci></apply><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3">subscript</csymbol><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.2">𝑛</ci><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3"><minus id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.1"></minus><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.2">𝑡</ci><cn id="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.3.cmml" type="integer" xref="S3.E3.m1.4.4.4.2.2.2.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3"><times id="S3.E3.m1.4.4.4.2.2.2.1.3.3.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.1"></times><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2">subscript</csymbol><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.2">𝑖</ci><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.2.3">𝑡</ci></apply><apply id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.1.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.2.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.2">𝑘</ci><ci id="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.3.cmml" xref="S3.E3.m1.4.4.4.2.2.2.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E3.m1.11.11c.cmml" xref="S3.E3.m1.11.11"><apply id="S3.E3.m1.7.7.7.3.3.3.1.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.3.3.1.3a.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.7.7.7.3.3.3.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1"><eq id="S3.E3.m1.7.7.7.3.3.3.1.1.1.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.2"></eq><list id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1"><apply id="S3.E3.m1.6.6.6.2.2.2.cmml" xref="S3.E3.m1.6.6.6.2.2.2"><ci id="S3.E3.m1.6.6.6.2.2.2.1.cmml" xref="S3.E3.m1.6.6.6.2.2.2.1">:</ci><apply id="S3.E3.m1.6.6.6.2.2.2.2.cmml" xref="S3.E3.m1.6.6.6.2.2.2.2"><times id="S3.E3.m1.6.6.6.2.2.2.2.1.cmml" xref="S3.E3.m1.6.6.6.2.2.2.2.1"></times><ci id="S3.E3.m1.6.6.6.2.2.2.2.2.cmml" xref="S3.E3.m1.6.6.6.2.2.2.2.2">Output</ci><ci id="S3.E3.m1.6.6.6.2.2.2.2.3.cmml" xref="S3.E3.m1.6.6.6.2.2.2.2.3">Gate</ci></apply><csymbol cd="latexml" id="S3.E3.m1.6.6.6.2.2.2.3.cmml" xref="S3.E3.m1.6.6.6.2.2.2.3">absent</csymbol></apply><apply id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.2">𝑜</ci><ci id="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3"><times id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.1"></times><ci id="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.2">𝜎</ci><apply id="S3.E3.m1.5.5.5.1.1.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.1.1.3.3.2"><ci id="S3.E3.m1.5.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.5.1.1.1.1">~</ci><apply id="S3.E3.m1.5.5.5.1.1.1.2.cmml" xref="S3.E3.m1.5.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.5.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.5.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.5.5.5.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.5.1.1.1.2.2">𝑜</ci><ci id="S3.E3.m1.5.5.5.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.5.1.1.1.2.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2"><eq id="S3.E3.m1.7.7.7.3.3.3.1.2.2.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.1"></eq><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2"><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.1">~</ci><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.2">𝑜</ci><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3"><plus id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.1"></plus><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2"><times id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.1"></times><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2">subscript</csymbol><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.2">𝑊</ci><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.2.3">𝑜</ci></apply><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3">subscript</csymbol><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.2">𝑥</ci><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.2.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.1.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3">subscript</csymbol><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.2.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.2">𝑏</ci><ci id="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.3.cmml" xref="S3.E3.m1.7.7.7.3.3.3.1.2.2.3.3.3">𝑜</ci></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E3.m1.11.11d.cmml" xref="S3.E3.m1.11.11"><apply id="S3.E3.m1.11.11.11.4.4.4.1.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.3a.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.3">formulae-sequence</csymbol><apply id="S3.E3.m1.11.11.11.4.4.4.1.1.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1"><eq id="S3.E3.m1.11.11.11.4.4.4.1.1.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.2"></eq><list id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1"><apply id="S3.E3.m1.8.8.8.1.1.1.cmml" xref="S3.E3.m1.8.8.8.1.1.1"><ci id="S3.E3.m1.8.8.8.1.1.1.1.cmml" xref="S3.E3.m1.8.8.8.1.1.1.1">:</ci><apply id="S3.E3.m1.8.8.8.1.1.1.2.cmml" xref="S3.E3.m1.8.8.8.1.1.1.2"><times id="S3.E3.m1.8.8.8.1.1.1.2.1.cmml" xref="S3.E3.m1.8.8.8.1.1.1.2.1"></times><ci id="S3.E3.m1.8.8.8.1.1.1.2.2.cmml" xref="S3.E3.m1.8.8.8.1.1.1.2.2">Hidden</ci><ci id="S3.E3.m1.8.8.8.1.1.1.2.3.cmml" xref="S3.E3.m1.8.8.8.1.1.1.2.3">State</ci></apply><csymbol cd="latexml" id="S3.E3.m1.8.8.8.1.1.1.3.cmml" xref="S3.E3.m1.8.8.8.1.1.1.3">absent</csymbol></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.1.1.1.3">𝑡</ci></apply></list><apply id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3"><csymbol cd="latexml" id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.1">direct-product</csymbol><apply id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.2">𝑜</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.2.3">𝑡</ci></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3"><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.1">~</ci><apply id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.2">ℎ</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.1.1.3.3.2.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2"><eq id="S3.E3.m1.11.11.11.4.4.4.1.2.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.2"></eq><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3"><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.1">~</ci><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.2">ℎ</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.3.2.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1"><divide id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.2"></divide><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3"><times id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.1"></times><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.2">𝐶</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.2.3">𝑡</ci></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.2">𝑞</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1"><max id="S3.E3.m1.9.9.9.2.2.2.cmml" xref="S3.E3.m1.9.9.9.2.2.2"></max><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1"><abs id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.2"></abs><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1"><times id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.1"></times><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.2">𝑛</ci><csymbol cd="latexml" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.2.3">top</csymbol></apply><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.11.11.11.4.4.4.1.2.2.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn id="S3.E3.m1.10.10.10.3.3.3.cmml" type="integer" xref="S3.E3.m1.10.10.10.3.3.3">1</cn></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.11c">\displaystyle\begin{aligned} \operatorname{Cell\,State:}\quad C_{t}=f_{t}C_{t-%
1}+i_{t}v_{t}k_{t}^{\top},\\
\operatorname{Normalizer\,State:}\quad n_{t}=f_{t}n_{t-1}+i_{t}k_{t},\\
\operatorname{Output\,Gate:}\quad o_{t}=\sigma(\tilde{o_{t}}),\quad\tilde{o_{t%
}}=W_{o}x_{t}+b_{o},\\
\operatorname{Hidden\,State:}\quad h_{t}=o_{t}\odot\tilde{h_{t}},\quad\tilde{h%
_{t}}=C_{t}q_{t}/\max\{|n^{\top}_{t}q_{t}|,1\},\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.11d">start_ROW start_CELL start_OPFUNCTION roman_Cell roman_State : end_OPFUNCTION italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_C start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT , end_CELL end_ROW start_ROW start_CELL start_OPFUNCTION roman_Normalizer roman_State : end_OPFUNCTION italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL start_OPFUNCTION roman_Output roman_Gate : end_OPFUNCTION italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( over~ start_ARG italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ) , over~ start_ARG italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG = italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT , end_CELL end_ROW start_ROW start_CELL start_OPFUNCTION roman_Hidden roman_State : end_OPFUNCTION italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_o start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ over~ start_ARG italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG , over~ start_ARG italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG = italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT / roman_max { | italic_n start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | , 1 } , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p5.1">inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib23" title="">23</a>]</cite>, the cell state uses a weighted sum according to proportions, where the forget gate corresponds to the weighted proportion of memory, and the input gate corresponds to the weighted proportion of the key-value pair to satisfy the covariance-based update rule. The mLSTM employs a normalizer that weights key vectors. Ultimately, through normalization and weighted control by the output gate, the hidden state <math alttext="h_{t}" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">ℎ</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">h_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> of the network is obtained. The mLSTMs employ matrix values to process memory retrieval, which allows the retrieval process in mLSTMs to be conducted directly through matrix multiplication. The hidden state from timestep t-1 is not included in the processing flow, which greatly enhances the parallelization capability of the mLSTM. The mLSTM introduction of matrix memory and parallelization brings a new level of sophistication to facial expression recognition systems. By employing a matrix memory cell, the mLSTM can store a richer feature representation, capturing the intricate details and variations that define different emotional expressions. Moreover, the parallelization feature of the mLSTM block enables the model to process this complex facial data more efficiently, significantly reduce the computational load.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Path Transfer</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">By integrating the outcomes from these various views <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib24" title="">24</a>]</cite>, a more accurate modeling of the sequence can be achieved. Traditional sequence modeling typically has two path traversal schemes: forward traversal and backward traversal. We have integrated four path scanning schemes: forward and backward bidirectional in the column direction and forward and backward bidirectional in the row direction. The xLSTM incorporates a flip module to achieve a more comprehensive image representation by weighting four paths of the image data.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Classification Head</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">The output of the xLSTM module will be mapped to the classification dimensions. The current main methods of token aggregation are as follows: 1. Using a learnable [CLS] token placed at the beginning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib5" title="">5</a>]</cite> or middle <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib34" title="">34</a>]</cite> of the sequence. 2. Applying average pooling to the entire sequence. 3. Using the average of the first token and the last token as the input for the classification head. In the vast majority of datasets, objects are typically centered around the middle token by default. To avoid this bias and enhance the generality of our model, our experiments adopt the last scheme mentioned. Our loss function is the cross-entropy loss function:</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx4">
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\begin{aligned} \mathcal{L}=-\sum_{n=1}^{N}y\log(\hat{y})\\
\end{aligned}" class="ltx_Math" display="inline" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mtable id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mtr id="S3.E4.m1.2.2a" xref="S3.E4.m1.2.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E4.m1.2.2b" xref="S3.E4.m1.2.2.cmml"><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.2.2.2.4" xref="S3.E4.m1.2.2.2.2.2.4.cmml">ℒ</mi><mo id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">=</mo><mrow id="S3.E4.m1.2.2.2.2.2.5" xref="S3.E4.m1.2.2.2.2.2.5.cmml"><mo id="S3.E4.m1.2.2.2.2.2.5a" xref="S3.E4.m1.2.2.2.2.2.5.cmml">−</mo><mrow id="S3.E4.m1.2.2.2.2.2.5.2" xref="S3.E4.m1.2.2.2.2.2.5.2.cmml"><mstyle displaystyle="true" id="S3.E4.m1.2.2.2.2.2.5.2.1" xref="S3.E4.m1.2.2.2.2.2.5.2.1.cmml"><munderover id="S3.E4.m1.2.2.2.2.2.5.2.1a" xref="S3.E4.m1.2.2.2.2.2.5.2.1.cmml"><mo id="S3.E4.m1.2.2.2.2.2.5.2.1.2.2" movablelimits="false" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.cmml"><mi id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.2" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.2.cmml">n</mi><mo id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.1" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.3" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.2.2.2.2.2.5.2.1.3" xref="S3.E4.m1.2.2.2.2.2.5.2.1.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E4.m1.2.2.2.2.2.5.2.2" xref="S3.E4.m1.2.2.2.2.2.5.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.5.2.2.2" xref="S3.E4.m1.2.2.2.2.2.5.2.2.2.cmml">y</mi><mo id="S3.E4.m1.2.2.2.2.2.5.2.2.1" lspace="0.167em" xref="S3.E4.m1.2.2.2.2.2.5.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.2.2.2.2.2.5.2.2.3.2" xref="S3.E4.m1.2.2.2.2.2.5.2.2.3.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">log</mi><mo id="S3.E4.m1.2.2.2.2.2.5.2.2.3.2a" xref="S3.E4.m1.2.2.2.2.2.5.2.2.3.1.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.2.2.2.5.2.2.3.2.1" xref="S3.E4.m1.2.2.2.2.2.5.2.2.3.1.cmml"><mo id="S3.E4.m1.2.2.2.2.2.5.2.2.3.2.1.1" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.5.2.2.3.1.cmml">(</mo><mover accent="true" id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.2.cmml">y</mi><mo id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">^</mo></mover><mo id="S3.E4.m1.2.2.2.2.2.5.2.2.3.2.1.2" stretchy="false" xref="S3.E4.m1.2.2.2.2.2.5.2.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><matrix id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><matrixrow id="S3.E4.m1.2.2a.cmml" xref="S3.E4.m1.2.2"><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><eq id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3"></eq><ci id="S3.E4.m1.2.2.2.2.2.4.cmml" xref="S3.E4.m1.2.2.2.2.2.4">ℒ</ci><apply id="S3.E4.m1.2.2.2.2.2.5.cmml" xref="S3.E4.m1.2.2.2.2.2.5"><minus id="S3.E4.m1.2.2.2.2.2.5.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5"></minus><apply id="S3.E4.m1.2.2.2.2.2.5.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2"><apply id="S3.E4.m1.2.2.2.2.2.5.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.5.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1">superscript</csymbol><apply id="S3.E4.m1.2.2.2.2.2.5.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.2.5.2.1.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1">subscript</csymbol><sum id="S3.E4.m1.2.2.2.2.2.5.2.1.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.2"></sum><apply id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3"><eq id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.1"></eq><ci id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.2">𝑛</ci><cn id="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.3.cmml" type="integer" xref="S3.E4.m1.2.2.2.2.2.5.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.2.2.2.2.2.5.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.1.3">𝑁</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.5.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.2"><times id="S3.E4.m1.2.2.2.2.2.5.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.2.1"></times><ci id="S3.E4.m1.2.2.2.2.2.5.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.2.2">𝑦</ci><apply id="S3.E4.m1.2.2.2.2.2.5.2.2.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.5.2.2.3.2"><log id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"></log><apply id="S3.E4.m1.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><ci id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1">^</ci><ci id="S3.E4.m1.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.2">𝑦</ci></apply></apply></apply></apply></apply></apply></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle\begin{aligned} \mathcal{L}=-\sum_{n=1}^{N}y\log(\hat{y})\\
\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">start_ROW start_CELL caligraphic_L = - ∑ start_POSTSUBSCRIPT italic_n = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_y roman_log ( over^ start_ARG italic_y end_ARG ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Metrics</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We conduct experiments on three datasets in FER research: CK+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib18" title="">18</a>]</cite>, RAF-DB <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib16" title="">16</a>]</cite>, and FERplus <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib2" title="">2</a>]</cite>. We report the Top-1 accuracy on the seven-category task as the evaluation metric. Here is a brief introduction to the datasets. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">CK+.</span> The CK+ dataset includes annotations for the following emotions: Anger, Contempt, Disgust, Fear, Happy, Sadness, and Surprise. The CK+ dataset comprises 784 training samples and 197 test samples. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.2">RAF-DB.</span> The RAF-DB encompasses seven basic emotional categories: surprise, fear, disgust, happiness, sadness, anger, and neutrality. The training subset encompasses 12,271 images, while the test subset consists of 3,068 images. <span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.3">FERplus.</span> The FERplus dataset is an enhanced version of the original FER dataset. The FERplus dataset categorizes expressions into eight distinct emotions: anger, disgust, fear, happy, sad, surprise, neutral, and contempt. The dataset comprises a total of 28,709 images for training, along with 3,589 images allocated for validation and 3,589 designated for testing purposes.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment Settings</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We conduct experiments with a patch size set to 16x16, the number of stacked xLSTM layers being 26, and the base dimension of the model being 384, which means the dimensions of the query, key, and value vectors are 768. The number of our attention heads is 192.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results</h3>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.6.1.1" style="font-size:113%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.7.2" style="font-size:113%;">Results on CK+, RAF-DB, and FERplus. The previous state-of-the-art (SOTA) values are marked with underlines, while the current SOTA values are marked in bold. All reported values are based on the <span class="ltx_text ltx_font_bold" id="S4.T1.7.2.1">“from scratch”</span> setting.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.8">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.8.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.8.1.1.1"><span class="ltx_text" id="S4.T1.8.1.1.1.1" style="font-size:80%;">Method</span></th>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="S4.T1.8.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.1.1.2.1">
<span class="ltx_p" id="S4.T1.8.1.1.2.1.1"><span class="ltx_text" id="S4.T1.8.1.1.2.1.1.1" style="font-size:80%;">CK+</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="S4.T1.8.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.1.1.3.1">
<span class="ltx_p" id="S4.T1.8.1.1.3.1.1"><span class="ltx_text" id="S4.T1.8.1.1.3.1.1.1" style="font-size:80%;">RAF-DB</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S4.T1.8.1.1.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.1.1.4.1">
<span class="ltx_p" id="S4.T1.8.1.1.4.1.1"><span class="ltx_text" id="S4.T1.8.1.1.4.1.1.1" style="font-size:80%;">FERplus</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.8.2.2.1">
<span class="ltx_text" id="S4.T1.8.2.2.1.1" style="font-size:80%;">FER-GCN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.2.2.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib6" title="">6</a><span class="ltx_text" id="S4.T1.8.2.2.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S4.T1.8.2.2.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.2.2.2.1">
<span class="ltx_p" id="S4.T1.8.2.2.2.1.1"><span class="ltx_text" id="S4.T1.8.2.2.2.1.1.1" style="font-size:80%;">99.54%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S4.T1.8.2.2.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.2.2.3.1">
<span class="ltx_p" id="S4.T1.8.2.2.3.1.1"><span class="ltx_text" id="S4.T1.8.2.2.3.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.8.2.2.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.2.2.4.1">
<span class="ltx_p" id="S4.T1.8.2.2.4.1.1"><span class="ltx_text" id="S4.T1.8.2.2.4.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.3.3.1">
<span class="ltx_text" id="S4.T1.8.3.3.1.1" style="font-size:80%;">FMPN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.3.3.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib4" title="">4</a><span class="ltx_text" id="S4.T1.8.3.3.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.3.3.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.3.3.2.1">
<span class="ltx_p" id="S4.T1.8.3.3.2.1.1"><span class="ltx_text" id="S4.T1.8.3.3.2.1.1.1" style="font-size:80%;">98.06%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.3.3.3.1">
<span class="ltx_p" id="S4.T1.8.3.3.3.1.1"><span class="ltx_text" id="S4.T1.8.3.3.3.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S4.T1.8.3.3.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.3.3.4.1">
<span class="ltx_p" id="S4.T1.8.3.3.4.1.1"><span class="ltx_text" id="S4.T1.8.3.3.4.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.4.4.1">
<span class="ltx_text" id="S4.T1.8.4.4.1.1" style="font-size:80%;">FAN </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.4.4.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib20" title="">20</a><span class="ltx_text" id="S4.T1.8.4.4.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.4.4.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.4.4.2.1">
<span class="ltx_p" id="S4.T1.8.4.4.2.1.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.4.4.2.1.1.1" style="font-size:80%;">99.70</span><span class="ltx_text" id="S4.T1.8.4.4.2.1.1.2" style="font-size:80%;">%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.4.4.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.4.4.3.1">
<span class="ltx_p" id="S4.T1.8.4.4.3.1.1"><span class="ltx_text" id="S4.T1.8.4.4.3.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S4.T1.8.4.4.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.4.4.4.1">
<span class="ltx_p" id="S4.T1.8.4.4.4.1.1"><span class="ltx_text" id="S4.T1.8.4.4.4.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.5.5.1">
<span class="ltx_text" id="S4.T1.8.5.5.1.1" style="font-size:80%;">SelfCureNet </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.5.5.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib27" title="">27</a><span class="ltx_text" id="S4.T1.8.5.5.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.5.5.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.5.5.2.1">
<span class="ltx_p" id="S4.T1.8.5.5.2.1.1"><span class="ltx_text" id="S4.T1.8.5.5.2.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.5.5.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.5.5.3.1">
<span class="ltx_p" id="S4.T1.8.5.5.3.1.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.5.5.3.1.1.1" style="font-size:80%;">78.31%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S4.T1.8.5.5.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.5.5.4.1">
<span class="ltx_p" id="S4.T1.8.5.5.4.1.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.8.5.5.4.1.1.1" style="font-size:80%;">83.42%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.6.6.1">
<span class="ltx_text" id="S4.T1.8.6.6.1.1" style="font-size:80%;">ViT </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.6.6.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib5" title="">5</a><span class="ltx_text" id="S4.T1.8.6.6.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.6.6.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.6.6.2.1">
<span class="ltx_p" id="S4.T1.8.6.6.2.1.1"><span class="ltx_text" id="S4.T1.8.6.6.2.1.1.1" style="font-size:80%;">96.88%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.6.6.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.6.6.3.1">
<span class="ltx_p" id="S4.T1.8.6.6.3.1.1"><span class="ltx_text" id="S4.T1.8.6.6.3.1.1.1" style="font-size:80%;">63.75%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S4.T1.8.6.6.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.6.6.4.1">
<span class="ltx_p" id="S4.T1.8.6.6.4.1.1"><span class="ltx_text" id="S4.T1.8.6.6.4.1.1.1" style="font-size:80%;">73.36%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.7.7.1">
<span class="ltx_text" id="S4.T1.8.7.7.1.1" style="font-size:80%;">MA-Net </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.7.7.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib32" title="">32</a><span class="ltx_text" id="S4.T1.8.7.7.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.7.7.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.7.7.2.1">
<span class="ltx_p" id="S4.T1.8.7.7.2.1.1"><span class="ltx_text" id="S4.T1.8.7.7.2.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.7.7.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.7.7.3.1">
<span class="ltx_p" id="S4.T1.8.7.7.3.1.1"><span class="ltx_text" id="S4.T1.8.7.7.3.1.1.1" style="font-size:80%;">67.48%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S4.T1.8.7.7.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.7.7.4.1">
<span class="ltx_p" id="S4.T1.8.7.7.4.1.1"><span class="ltx_text" id="S4.T1.8.7.7.4.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.8.8.8.1">
<span class="ltx_text" id="S4.T1.8.8.8.1.1" style="font-size:80%;">EAC </span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S4.T1.8.8.8.1.2.1" style="font-size:80%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib31" title="">31</a><span class="ltx_text" id="S4.T1.8.8.8.1.3.2" style="font-size:80%;">]</span></cite>
</th>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.8.8.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.8.2.1">
<span class="ltx_p" id="S4.T1.8.8.8.2.1.1"><span class="ltx_text" id="S4.T1.8.8.8.2.1.1.1" style="font-size:80%;">-</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="S4.T1.8.8.8.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.8.3.1">
<span class="ltx_p" id="S4.T1.8.8.8.3.1.1"><span class="ltx_text" id="S4.T1.8.8.8.3.1.1.1" style="font-size:80%;">73.73%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S4.T1.8.8.8.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.8.8.4.1">
<span class="ltx_p" id="S4.T1.8.8.8.4.1.1"><span class="ltx_text" id="S4.T1.8.8.8.4.1.1.1" style="font-size:80%;">75.77%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.8.9.9.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.9.9.1.1" style="font-size:80%;">xLSTM-FER(ours)</span></th>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S4.T1.8.9.9.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.9.9.2.1">
<span class="ltx_p" id="S4.T1.8.9.9.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.9.9.2.1.1.1" style="font-size:80%;">100%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="S4.T1.8.9.9.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.9.9.3.1">
<span class="ltx_p" id="S4.T1.8.9.9.3.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.9.9.3.1.1.1" style="font-size:80%;">87.06%</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S4.T1.8.9.9.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.9.9.4.1">
<span class="ltx_p" id="S4.T1.8.9.9.4.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.9.9.4.1.1.1" style="font-size:80%;">88.94%</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S4.T1.8.10.10.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.10.10.1.1" style="font-size:80%;">Rank</span></th>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="S4.T1.8.10.10.2">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.10.2.1">
<span class="ltx_p" id="S4.T1.8.10.10.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.10.10.2.1.1.1" style="font-size:80%;">1</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_r" id="S4.T1.8.10.10.3">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.10.3.1">
<span class="ltx_p" id="S4.T1.8.10.10.3.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.10.10.3.1.1.1" style="font-size:80%;">1</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S4.T1.8.10.10.4">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.8.10.10.4.1">
<span class="ltx_p" id="S4.T1.8.10.10.4.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.8.10.10.4.1.1.1" style="font-size:80%;">1</span></span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S4.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="706" id="S4.F2.sf1.g1" src="x3.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F2.sf1.3.2" style="font-size:90%;">Confusion Matrix on CK+.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="706" id="S4.F2.sf2.g1" src="x4.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F2.sf2.3.2" style="font-size:90%;">Confusion Matrix on RAF-DB</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F2.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="706" id="S4.F2.sf3.g1" src="x5.png" width="831"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.F2.sf3.3.2" style="font-size:90%;">Confusion Matrix on FERplus.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Confusion Metrics on Datasets.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We compare xLSTM-FER with the recent CNN-based models such as FER-GCN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib6" title="">6</a>]</cite>, EAC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib31" title="">31</a>]</cite> and ViT-based face recognition models including ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib5" title="">5</a>]</cite>, MA-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib32" title="">32</a>]</cite>, and others to verify the effectiveness of xLSTM-FER. All experiments are conducted from scratch. The experimental results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.T1" title="Table 1 ‣ 4.3 Results ‣ 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Results on CK+.</span> In the CK+ dataset, the outcomes presented in Table 7 reveal that our technique, xLSTM-FER, has pioneered a perfect accuracy rate of 100% for classifying facial expressions. The confusion matrix in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.F2.sf1" title="In Figure 2 ‣ 4.3 Results ‣ 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_tag">2(a)</span></a> indicates that xLSTM-FER has achieved 100% accuracy across all categories. These outcomes excel over the sota methods in the realms of both video and image-based facial expression analysis. Because xLSTM-FER successfully captures the interdependencies among different patch blocks.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">Results on RAF-DB.</span> xLSTM-FER achieves an impressive overall accuracy of 87.06% and shows a 14% improvement over the previous sota values, demonstrating superior performance compared to other models. In contrast, ViT only achieves a lower accuracy of 63.75%, and another visual transformer-based FER model, MA-Net, does not perform well on this in-the-wild dataset. xLSTM-FER achieves a competitive accuracy of 87.06%, indicating its robust performance compared to current state-of-the-art methods.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p4.1.1">Results on FERplus.</span> On the FERplus dataset, our model has outperformed all contemporary methods, attaining an accuracy rate of 88.94%. xLSTM-FER shows a 4.5% improvement compared with previous sota values. This confirms that the synergistic effect of the memory gating and attention mechanisms within xLSTM-FER can achieve an accurate representation of facial images.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Case Analysis</h3>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="181" id="S4.F3.g1" src="x6.png" width="664"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">A case study on the accuracy of xLSTM-FER compared to the baseline model (EAC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#bib.bib31" title="">31</a>]</cite>) in real-world examples.
</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">To further verify the advantages of xLSTM-FER over the baseline, we test several photos in the learning environment. The test results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.05074v1#S4.F3" title="Figure 3 ‣ 4.4 Case Analysis ‣ 4 Experiments ‣ xLSTM-FER: Enhancing Student Expression Recognition with Extended Vision Long Short-Term Memory Network"><span class="ltx_text ltx_ref_tag">3</span></a>. We find that, except for the “Fear” and “Sadness” categories, xLSTM-FER can provide more accurate predictions with higher confidence compared to EAC in other categories. This indicates that the memory network of xLSTM in its image extraction approach can adapt to the real-world needs of students’ FER tasks even with the linear complexity.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">To overcome the quadratic complexity in traditional student facial expression recognition, this paper presents xLSTM-FER, which has profound implications for the assessment of learning experiences and emotional states. The innovative approach of xLSTM-FER in segmenting input images into patches and processing them through a stack of xLSTM blocks. Our experimental results on CK+, RAF-DB, and FERplus not only validate the potential of xLSTM-FER in student facial expression recognition tasks but also highlight its competitive performance when compared to state-of-the-art methods on standard datasets. The linear computational and memory complexity of xLSTM-FER is a significant advantage, making it exceptionally well-suited for processing high-resolution images, which is essential for the clear and detailed capture of student expressions. We are confident that with further optimization and fine-tuning, xLSTM-FER will evolve as a significant tool in student expression recognition.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">The research project is supported by the National Natural Science Foundation of China (No. 62207028), partially by Zhejiang Provincial Natural Science Foundation (No. LY23F020009), and the Key R&amp;D Program of Zhejiang Province (No. 2022C03106), and Scientific Research Fund of Zhejiang Provincial Education Department (No. 2023SCG367).</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Alkin, B., Beck, M., Pöppel, K., Hochreiter, S., Brandstetter, J.:
Vision-lstm: xlstm as generic vision backbone. arXiv preprint
arXiv:2406.04303 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Barsoum, E., Zhang, C., Ferrer, C.C., Zhang, Z.: Training deep networks for
facial expression recognition with crowd-sourced label distribution. In:
Proceedings of the 18th ACM international conference on multimodal
interaction. pp. 279–283 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Beck, M., Pöppel, K., Spanring, M., Auer, A., Prudnikova, O., Kopp, M.,
Klambauer, G., Brandstetter, J., Hochreiter, S.: xlstm: Extended long
short-term memory. arXiv preprint arXiv:2405.04517 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Chen, Y., Wang, J., Chen, S., Shi, Z., Cai, J.: Facial motion prior networks
for facial expression recognition. In: 2019 IEEE Visual Communications and
Image Processing (VCIP). pp. 1–4. IEEE (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X.,
Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et al.:
An image is worth 16x16 words: Transformers for image recognition at scale.
arXiv preprint arXiv:2010.11929 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Fan, Y., Lam, J.C., Li, V.O.: Video-based emotion recognition using
deeply-supervised neural networks. In: Proceedings of the 20th ACM
international conference on multimodal interaction. pp. 584–588 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Hochreiter, S., Schmidhuber, J.: Long short-term memory. Neural computation
<span class="ltx_text ltx_font_bold" id="bib.bib7.1.1">9</span>(8), 1735–1780 (1997)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Huang, Q., Chen, J.: Enhancing academic performance prediction with temporal
graph networks for massive open online courses. Journal of Big Data
<span class="ltx_text ltx_font_bold" id="bib.bib8.1.1">11</span>(1),  52 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Huang, Q., Huang, C., Huang, J., Fujita, H.: Adaptive resource prefetching with
spatial–temporal and topic information for educational cloud storage
systems. Knowledge-Based Systems <span class="ltx_text ltx_font_bold" id="bib.bib9.1.1">181</span>, 104791 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Huang, Q., Huang, C., Wang, X., Jiang, F.: Facial expression recognition with
grid-wise attention and visual transformer. Information Sciences
<span class="ltx_text ltx_font_bold" id="bib.bib10.1.1">580</span>, 35–54 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Huang, Q., Zeng, Y.: Improving academic performance predictions with dual graph
neural networks. Complex &amp; Intelligent Systems pp. 1–19 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Jagadeesh, M., Baranidharan, B.: Facial expression recognition of online
learners from real-time videos using a novel deep learning model. Multimedia
Systems <span class="ltx_text ltx_font_bold" id="bib.bib12.1.1">28</span>(6), 2285–2305 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Jiang, F., Huang, Q., Mei, X., Guan, Q., Tu, Y., Luo, W., Huang, C.:
Face2nodes: learning facial expression representations with relation-aware
dynamic graph convolution networks. Information Sciences <span class="ltx_text ltx_font_bold" id="bib.bib13.1.1">649</span>,
119640 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Katharopoulos, A., Vyas, A., Pappas, N., Fleuret, F.: Transformers are rnns:
Fast autoregressive transformers with linear attention. In: International
conference on machine learning. pp. 5156–5165. PMLR (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Lasri, I., Solh, A.R., El Belkacemi, M.: Facial emotion recognition of students
using convolutional neural network. In: 2019 third international conference
on intelligent computing in data sciences (ICDS). pp. 1–6. IEEE (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Li, S., Deng, W., Du, J.: Reliable crowdsourcing and deep locality-preserving
learning for expression recognition in the wild. In: Proceedings of the IEEE
conference on computer vision and pattern recognition. pp. 2852–2861 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Ling, X., Liang, J., Wang, D., Yang, J.: A facial expression recognition system
for smart learning based on yolo and vision transformer. In: Proceedings of
the 2021 7th International Conference on Computing and Artificial
Intelligence. pp. 178–182 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Lucey, P., Cohn, J.F., Kanade, T., Saragih, J., Ambadar, Z., Matthews, I.: The
extended cohn-kanade dataset (ck+): A complete dataset for action unit and
emotion-specified expression. In: 2010 ieee computer society conference on
computer vision and pattern recognition-workshops. pp. 94–101. IEEE (2010)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Mehta, S., Rastegari, M.: Mobilevit: light-weight, general-purpose, and
mobile-friendly vision transformer. arXiv preprint arXiv:2110.02178 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Meng, D., Peng, X., Wang, K., Qiao, Y.: Frame attention networks for facial
expression recognition in videos. In: 2019 IEEE international conference on
image processing (ICIP). pp. 3866–3870. IEEE (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Mohamad Nezami, O., Dras, M., Hamey, L., Richards, D., Wan, S., Paris, C.:
Automatic recognition of student engagement using deep learning and facial
expression. In: Joint european conference on machine learning and knowledge
discovery in databases. pp. 273–289. Springer (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Ozdemir, M.A., Elagoz, B., Alaybeyoglu, A., Sadighzadeh, R., Akan, A.: Real
time emotion recognition from facial expressions using cnn architecture. In:
2019 medical technologies congress (tiptekno). pp. 1–4. IEEE (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Schlag, I., Irie, K., Schmidhuber, J.: Linear transformers are secretly fast
weight programmers. In: International Conference on Machine Learning. pp.
9355–9366. PMLR (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Schuster, M., Paliwal, K.K.: Bidirectional recurrent neural networks. IEEE
transactions on Signal Processing <span class="ltx_text ltx_font_bold" id="bib.bib24.1.1">45</span>(11), 2673–2681 (1997)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Tonguç, G., Ozkara, B.O.: Automatic recognition of student emotions from
facial expressions during a lecture. Computers &amp; Education <span class="ltx_text ltx_font_bold" id="bib.bib25.1.1">148</span>,
103797 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Wang, J., Zhang, Z.: Facial expression recognition in online course using
light-weight vision transformer via knowledge distillation. In: Pacific Rim
International Conference on Artificial Intelligence. pp. 247–253. Springer
(2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Wang, K., Peng, X., Yang, J., Lu, S., Qiao, Y.: Suppressing uncertainties for
large-scale facial expression recognition. In: Proceedings of the IEEE/CVF
conference on computer vision and pattern recognition. pp. 6897–6906 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Wang, K., Cheng, M.: Teaching feedback system based on vit expression
recognition in distance education. In: 2024 13th International Conference on
Educational and Information Technology (ICEIT). pp. 93–97. IEEE (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Wu, X., He, J., Huang, Q., Huang, C., Zhu, J., Huang, X., Fujita, H.: Fer-chc:
Facial expression recognition with cross-hierarchy contrast. Applied Soft
Computing <span class="ltx_text ltx_font_bold" id="bib.bib29.1.1">145</span>, 110530 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Wu, Y., He, K.: Group normalization. In: Proceedings of the European conference
on computer vision (ECCV). pp. 3–19 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Zhang, Y., Wang, C., Ling, X., Deng, W.: Learn from all: Erasing attention
consistency for noisy label facial expression recognition. In: European
Conference on Computer Vision. pp. 418–434. Springer (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Zhao, Z., Liu, Q., Wang, S.: Learning deep global multi-scale and local
attention features for facial expression recognition in the wild. IEEE
Transactions on Image Processing <span class="ltx_text ltx_font_bold" id="bib.bib32.1.1">30</span>, 6544–6556 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Zhou, S., Wu, X., Jiang, F., Huang, Q., Huang, C.: Emotion recognition from
large-scale video clips with cross-attention and hybrid feature weighting
neural networks. International Journal of Environmental Research and Public
Health <span class="ltx_text ltx_font_bold" id="bib.bib33.1.1">20</span>(2),  1400 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Zhu, L., Liao, B., Zhang, Q., Wang, X., Liu, W., Wang, X.: Vision mamba:
Efficient visual representation learning with bidirectional state space
model. arXiv preprint arXiv:2401.09417 (2024)

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 04:28:30 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
