<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1712.08697] Interpretable Counting for Visual Question Answering</title><meta property="og:description" content="Questions that require counting a variety of objects in images remain a major challenge in visual question answering (VQA).
The most common approaches to VQA involve either classifying answers based on fixed length rep…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Interpretable Counting for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Interpretable Counting for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1712.08697">

<!--Generated on Tue Mar 19 21:54:57 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Interpretable Counting for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Alexander Trott, Caiming Xiong, &amp; Richard Socher 
<br class="ltx_break">Salesforce Research 
<br class="ltx_break">Palo Alto, CA 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">{atrott,cxiong,rsocher}@salesforce.com</span>
</span><span class="ltx_author_notes">Corresponding author</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Questions that require counting a variety of objects in images remain a major challenge in visual question answering (VQA).
The most common approaches to VQA involve either classifying answers based on fixed length representations of both the image and question or summing fractional counts estimated from each section of the image.
In contrast, we treat counting as a sequential decision process and force our model to make discrete choices of what to count.
Specifically, the model sequentially selects from detected objects and learns interactions between objects that influence subsequent selections.
A distinction of our approach is its intuitive and interpretable output, as discrete counts are automatically grounded in the image.
Furthermore, our method outperforms the state of the art architecture for VQA on multiple metrics that evaluate counting.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Visual question answering (VQA) is an important benchmark to test for context-specific reasoning over complex images.
While the field has seen substantial progress, counting-based questions have seen the least improvement <cite class="ltx_cite ltx_citemacro_citep">(Chattopadhyay et al., <a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>.
Intuitively, counting should involve finding the number of distinct scene elements or objects that meet some criteria, see Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for an example.
In contrast, the predominant approach to VQA involves representing the visual input with the final feature map of a convolutional neural network (CNN), attending to regions based on an encoding of the question, and classifying the answer from the attention-weighted image features
<cite class="ltx_cite ltx_citemacro_citep">(Xu &amp; Saenko, <a href="#bib.bib43" title="" class="ltx_ref">2015</a>; Yang et al., <a href="#bib.bib44" title="" class="ltx_ref">2015</a>; Xiong et al., <a href="#bib.bib42" title="" class="ltx_ref">2016</a>; Lu et al., <a href="#bib.bib22" title="" class="ltx_ref">2016b</a>; Fukui et al., <a href="#bib.bib8" title="" class="ltx_ref">2016</a>; Kim et al., <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite>.
Our intuition about counting seems at odds with the effects of attention, where a weighted average obscures any notion of distinct elements.
As such, we are motivated to re-think the typical approach to counting in VQA and propose a method that embraces the discrete nature of the task.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">Our approach is partly inspired by recent work that represents images as a set of distinct objects, as identified by object detection <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>, and making use of the relationships between these objects <cite class="ltx_cite ltx_citemacro_citep">(Teney et al., <a href="#bib.bib37" title="" class="ltx_ref">2016</a>)</cite>.
We experiment with counting systems that build off of the vision module used for these two works, which represents each image as a set of detected objects.
For training and evaluation, we create a new dataset, HowMany-QA. It is taken from the counting-specific union of VQA 2.0 <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite> and Visual Genome QA <cite class="ltx_cite ltx_citemacro_citep">(Krishna et al., <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">We introduce the Interpretable Reinforcement Learning Counter (IRLC), which treats counting as a sequential decision process.
We treat learning to count as learning to enumerate the relevant objects in the scene.
As a result, IRLC not only returns a count but also the objects supporting its answer.
This output is produced through an iterative method.
Each step of this sequence has two stages:
First, an object is selected to be added to the count.
Second, the model adjusts the priority given to unselected objects based on their configuration with the selected objects (Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
We supervise only the final count and train the decision process using reinforcement learning (RL).</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1712.08697/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="165" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>
IRLC takes as input a counting question and image. Detected objects are added to the returned count through a sequential decision process. The above example illustrates actual model behavior after training.
</figcaption>
</figure>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">Additional experiments highlight the importance of the iterative approach when using this manner of weak supervision.
Furthermore, we train the current state of the art model for VQA on HowMany-QA and find that IRLC achieves a higher accuracy and lower count error.
Lastly, we compare the grounded counts of our model to the attentional focus of the state of the art baseline to demonstrate the interpretability gained through our approach.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Visual representations for counting.</span> As a standalone problem, counting from images has received some attention but typically within specific problem domains.
<cite class="ltx_cite ltx_citemacro_citet">Segui et al. (<a href="#bib.bib34" title="" class="ltx_ref">2015</a>)</cite> explore training a CNN to count directly from synthetic data.
Counts can also be estimated by learning to produce density maps for some category of interest (typically people), as in <cite class="ltx_cite ltx_citemacro_citet">Lempitsky &amp; Zisserman (<a href="#bib.bib18" title="" class="ltx_ref">2010</a>); Oñoro-Rubio &amp; López-Sastre (<a href="#bib.bib26" title="" class="ltx_ref">2016</a>); Zhang et al. (<a href="#bib.bib45" title="" class="ltx_ref">2015</a>)</cite>.
Density estimation simplifies the more challenging approach of counting by instance-by-instance detection <cite class="ltx_cite ltx_citemacro_citep">(Ren &amp; Zemel, <a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite>.
Methods to detect objects and their bounding boxes have advanced considerably <cite class="ltx_cite ltx_citemacro_citep">(Girshick et al., <a href="#bib.bib10" title="" class="ltx_ref">2015</a>; Girshick, <a href="#bib.bib9" title="" class="ltx_ref">2015</a>; Ren et al., <a href="#bib.bib32" title="" class="ltx_ref">2015b</a>; Dai et al., <a href="#bib.bib7" title="" class="ltx_ref">2016</a>; Lin et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> but tuning redundancy reduction steps in order to count is unreliable <cite class="ltx_cite ltx_citemacro_citep">(Chattopadhyay et al., <a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>. Here, we overcome this limitation by allowing flexible, question specific interactions during counting.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">Alternative approaches attempt to model subitizing, which describes the human ability to quickly and accurately gauge numerosity when at most a few objects are present.
<cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a href="#bib.bib46" title="" class="ltx_ref">2017</a>)</cite> demonstrates that CNNs may be trained towards a similar ability when estimating the number of salient objects in a scene.
This approach was extended to counting 80 classes of objects simultaneously in
<cite class="ltx_cite ltx_citemacro_citet">Chattopadhyay et al. (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite>.
Their model is trained to estimate counts within each subdivision of the full image, where local counts are typically within the subitizing range.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p">The above studies apply counting to a fixed set of object categories.
In contrast, we are interested in counting during visual question answering, where the criteria for counting change from question to question and can be arbitrarily complex.
This places our work in a different setting than those that count from the image alone.
For example, <cite class="ltx_cite ltx_citemacro_citet">Chattopadhyay et al. (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite> apply their trained models to a subset of VQA questions, but their analysis was limited to the specific subset of examples where the question and answer labels agreed with the object detection labels they use for training.
Here, we overcome this limitation by learning to count directly from question/answer pairs.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Visual question answering.</span>
The potential of deep learning to fuse visual and linguistic reasoning has been recognized for some time
<cite class="ltx_cite ltx_citemacro_citep">(Socher et al., <a href="#bib.bib36" title="" class="ltx_ref">2014</a>; Lu et al., <a href="#bib.bib21" title="" class="ltx_ref">2016a</a>)</cite>.
Visual question answering poses the challenge of retrieving question-specific information from an associated image, often requiring complex scene understanding and flexible reasoning.
In recent years, a number of datasets have been introduced for studying this problem <cite class="ltx_cite ltx_citemacro_citep">(Malinowski &amp; Fritz, <a href="#bib.bib24" title="" class="ltx_ref">2014</a>; Ren et al., <a href="#bib.bib31" title="" class="ltx_ref">2015a</a>; Zhu et al., <a href="#bib.bib48" title="" class="ltx_ref">2015</a>; Agrawal et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>; Goyal et al., <a href="#bib.bib11" title="" class="ltx_ref">2017</a>; Krishna et al., <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite>.
The majority of recent progress has been aimed at the so-named “VQA” datasets <cite class="ltx_cite ltx_citemacro_citep">(Agrawal et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>; Goyal et al., <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite>, where counting questions represent roughly 11% of the data.
Though our focus is on counting questions specifically, prior work on VQA is highly relevant.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p">An early baseline for VQA represents the question and image at a coarse granularity, respectively using a “bag of words” embedding along with spatially-pooled CNN outputs to classify the answer <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a href="#bib.bib47" title="" class="ltx_ref">2015</a>)</cite>.
In <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a href="#bib.bib31" title="" class="ltx_ref">2015a</a>)</cite>, a similar fixed-length image representation is fused with the question embeddings as input to a recurrent neural network (RNN), from which the answer is classified.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p"><span id="S2.p6.1.1" class="ltx_text ltx_font_bold">Attention.</span> More recent variants have chosen to represent the image at a finer granularity by omitting the spatial pooling of the CNN feature map and instead use attention to focus relevant image regions before producing an answer <cite class="ltx_cite ltx_citemacro_citep">(Xu &amp; Saenko, <a href="#bib.bib43" title="" class="ltx_ref">2015</a>; Yang et al., <a href="#bib.bib44" title="" class="ltx_ref">2015</a>; Xiong et al., <a href="#bib.bib42" title="" class="ltx_ref">2016</a>; Lu et al., <a href="#bib.bib22" title="" class="ltx_ref">2016b</a>; Fukui et al., <a href="#bib.bib8" title="" class="ltx_ref">2016</a>; Kim et al., <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite>.
These works use the spatially-tiled feature vectors output by a CNN to represent the image; others follow the intuition that a more meaningful representation may come from parsing the feature map according to the locations of objects in the scene <cite class="ltx_cite ltx_citemacro_citep">(Shih et al., <a href="#bib.bib35" title="" class="ltx_ref">2015</a>; Ilievski et al., <a href="#bib.bib14" title="" class="ltx_ref">2016</a>)</cite>.
Notably, using object detection was a key design choice for the winning submission for the VQA 2017 challenge <cite class="ltx_cite ltx_citemacro_citep">(Anderson et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>; Teney et al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite>.
Work directed at VQA with synthetic images (which sidesteps the challenges created by computer vision) has further demonstrated the utility that relationships may provide as an additional form of image annotation <cite class="ltx_cite ltx_citemacro_citep">(Teney et al., <a href="#bib.bib37" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
<div id="S2.p7" class="ltx_para ltx_noindent">
<p id="S2.p7.1" class="ltx_p"><span id="S2.p7.1.1" class="ltx_text ltx_font_bold">Interpretable VQA.</span> The use of “scene graphs” in real-image VQA would have the desirable property that intermediate model variables would be grounded in concepts explicitly, a step towards making neural reasoning more transparent.
A conceptual parallel to this is found in Neural Module Networks <cite class="ltx_cite ltx_citemacro_citep">(Andreas et al., <a href="#bib.bib3" title="" class="ltx_ref">2016a</a>; <a href="#bib.bib4" title="" class="ltx_ref">b</a>; Hu et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite>, which gain interpretability by grounding the reasoning process itself in defined concepts.
The general concept of interpretable VQA has been the subject of recent interest.
<cite class="ltx_cite ltx_citemacro_citet">Park et al. (<a href="#bib.bib27" title="" class="ltx_ref">2016</a>)</cite> extends the task itself to include generating explanations for produced answers.
<cite class="ltx_cite ltx_citemacro_citet">Chandrasekaran et al. (<a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite> take a different approach, asking how well humans can learn patterns in answers and failures of a trained VQA model.
While humans indeed identify some patterns, they do not gain any apparent insight from knowing intermediate states of the model (such as its attentional focus).
In light of this, we are motivated by the goal of developing more transparent AI.</p>
</div>
<div id="S2.p8" class="ltx_para ltx_noindent">
<p id="S2.p8.1" class="ltx_p">We address this at the level of counting in VQA.
We show that, despite the challenge presented by this particular task, an intuitive approach gains in both performance and interpretability over state of the art.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Datasets</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">Within the field of VQA, the majority of progress has been aimed at the VQA dataset <cite class="ltx_cite ltx_citemacro_citep">(Agrawal et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>)</cite> and, more recently, VQA 2.0 <cite class="ltx_cite ltx_citemacro_citep">(Goyal et al., <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite>, which expands the total number of questions in the dataset and attempts to reduce bias by balancing answers to repeated questions.
VQA 2.0 consists of 1.1M questions pertaining to the 205K images from COCO <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib19" title="" class="ltx_ref">2014</a>)</cite>.
The examples are divided according to the official COCO splits.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">In addition to VQA 2.0, we incorporate the Visual Genome (VG) dataset <cite class="ltx_cite ltx_citemacro_citep">(Krishna et al., <a href="#bib.bib17" title="" class="ltx_ref">2016</a>)</cite>.
Visual Genome consists of 108K images, roughly half of which are part of COCO.
VG includes its own visual question answering dataset.
We include examples from that dataset when they pertain to an image in the VQA 2.0 training set.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1712.08697/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="131" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
Examples of question-answer pairs that are excluded from HowMany-QA.
This selection exemplifies the common types of “number” questions that do not require counting and therefore distract from our objective: (from left to right) time, general number-based answers, ballparking, and reading numbers from images.
Importantly, the standard VQA evaluation metrics do not distinguish these from counting questions; instead, performance is reported for “number” questions as a whole.
</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>HowMany-QA</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">In order to evaluate counting specifically, we define a subset of the QA pairs, which we refer to as HowMany-QA.
Our inclusion criteria were designed to filter QA pairs where the question asks for a count, as opposed to simply an answer in the form of a number (Fig <a href="#S3.F2" title="Figure 2 ‣ 3 Datasets ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
For the first condition, we require that the question contains one of the following phrases: “how many”, “number of”, “amount of”, or “count of”.
We also reject a question if it contains the phrase “number of the”, since this phrase frequently refers to a printed number rather than a count (i.e. “what is the number of the bus?”).
Lastly, we require that the ground-truth answer is a number between 0 to 20 (inclusive).
The original VQA 2.0 train set includes roughly 444K QA pairs, of which 57,606 are labeled as having a “number” answer. Focusing on counting questions results in a still very large dataset with 47,542 pairs, showing the importance of this subtask.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Split</th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">QA Pairs</th>
<th id="S3.T1.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">Images</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt">Train</th>
<td id="S3.T1.1.2.1.2" class="ltx_td ltx_align_right ltx_border_tt">83,642</td>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_right ltx_border_tt">31,932</td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">   <span id="S3.T1.1.3.2.1.1" class="ltx_text ltx_font_italic">from VQA 2.0</span>
</th>
<td id="S3.T1.1.3.2.2" class="ltx_td ltx_align_right">47,542</td>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_right">31,932</td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">   <span id="S3.T1.1.4.3.1.1" class="ltx_text ltx_font_italic">from VG</span>
</th>
<td id="S3.T1.1.4.3.2" class="ltx_td ltx_align_right">36,100</td>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_right">0</td>
</tr>
<tr id="S3.T1.1.5.4" class="ltx_tr">
<th id="S3.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Dev.</th>
<td id="S3.T1.1.5.4.2" class="ltx_td ltx_align_right ltx_border_t">17,714</td>
<td id="S3.T1.1.5.4.3" class="ltx_td ltx_align_right ltx_border_t">13,119</td>
</tr>
<tr id="S3.T1.1.6.5" class="ltx_tr">
<th id="S3.T1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">Test</th>
<td id="S3.T1.1.6.5.2" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">5,000</td>
<td id="S3.T1.1.6.5.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">2,483</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>
Size breakdown of HowMany-QA.
Neither development or test included VG data.
</figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.1" class="ltx_p">Due to our filter and focus on counting questions, we cannot make use of the official test data since its annotations are not available. Hence, we divide the validation data into separate development and test sets.
More specifically, we apply the above criteria to the official validation data and select 5,000 of the resulting QA pairs to serve as the test data.
The remaining 17,714 QA pairs are used as the development set.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.1" class="ltx_p">As mentioned above, the HowMany-QA training data is augmented with available QA pairs from Visual Genome, which are selected using the same criteria.
A breakdown of the size and composition of HowMany-QA is provided in Table  <a href="#S3.T1" title="Table 1 ‣ 3.1 HowMany-QA ‣ 3 Datasets ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
All models compared in this work are trained and evaluated on HowMany-QA.
To facilitate future comparison to our work, we have made the training, development, and test question IDs available for <a target="_blank" href="https://einstein.ai/research/interpretable-counting-for-visual-question-answering/HowMany-QA.zip" title="" class="ltx_ref ltx_href">download</a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Model</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">In this work, we focus specifically on counting in the setting of visual question answering (where the criteria for counting changes on a question-by-question basis).
In addition, we are interested in model interpretability.
We explore this notion by experimenting with models that are capable of producing question-guided counts which are visually grounded in object proposals.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p id="S4.p2.1" class="ltx_p">Rather than substantially modifying existing counting approaches – such as <cite class="ltx_cite ltx_citemacro_citet">Chattopadhyay et al. (<a href="#bib.bib6" title="" class="ltx_ref">2017</a>)</cite> – we compare three models whose architectures naturally fit within our experimental scope.
These models each produce a count from the outputs of an object detection module and use identical strategies to encode the question and compare it to the detected objects.
The models differ only in terms of how these components are used to produce a count (Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>a).</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/1712.08697/assets/figures/high_level_and_specific.png" id="S4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="214" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>
<span id="S4.F3.4.1" class="ltx_text ltx_font_bold">(a)</span> Each model includes three basic modules: vision (blue), language (green), and counting (red).
Text in the shaded regions describes which aspects of these modules are shared across models.
<span id="S4.F3.5.2" class="ltx_text ltx_font_bold">(b)</span> (left) The language model embeds the question and compares it to each object using a scoring function, which is jointly trained with caption grounding; (right) IRLC counting module.
</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Object Detection</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.5" class="ltx_p">Our approach is inspired by the strategy of <cite class="ltx_cite ltx_citemacro_citet">Anderson et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Teney et al. (<a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite>.
Their model, which represents current state of the art in VQA, infers objects as the input to the question-answering system.
This inference is performed using the Faster R-CNN architecture <cite class="ltx_cite ltx_citemacro_citep">(Ren et al., <a href="#bib.bib32" title="" class="ltx_ref">2015b</a>)</cite>.
The Faster R-CNN proposes a set of regions corresponding to objects in the image.
It encodes the image as a set of bounding boxes <math id="S4.SS1.p1.1.m1.3" class="ltx_Math" alttext="\{b_{1},...,b_{N}\}" display="inline"><semantics id="S4.SS1.p1.1.m1.3a"><mrow id="S4.SS1.p1.1.m1.3.3.2" xref="S4.SS1.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.3.3.2.3" xref="S4.SS1.p1.1.m1.3.3.3.cmml">{</mo><msub id="S4.SS1.p1.1.m1.2.2.1.1" xref="S4.SS1.p1.1.m1.2.2.1.1.cmml"><mi id="S4.SS1.p1.1.m1.2.2.1.1.2" xref="S4.SS1.p1.1.m1.2.2.1.1.2.cmml">b</mi><mn id="S4.SS1.p1.1.m1.2.2.1.1.3" xref="S4.SS1.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.1.m1.3.3.2.4" xref="S4.SS1.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.p1.1.m1.3.3.2.5" xref="S4.SS1.p1.1.m1.3.3.3.cmml">,</mo><msub id="S4.SS1.p1.1.m1.3.3.2.2" xref="S4.SS1.p1.1.m1.3.3.2.2.cmml"><mi id="S4.SS1.p1.1.m1.3.3.2.2.2" xref="S4.SS1.p1.1.m1.3.3.2.2.2.cmml">b</mi><mi id="S4.SS1.p1.1.m1.3.3.2.2.3" xref="S4.SS1.p1.1.m1.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S4.SS1.p1.1.m1.3.3.2.6" xref="S4.SS1.p1.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.3b"><set id="S4.SS1.p1.1.m1.3.3.3.cmml" xref="S4.SS1.p1.1.m1.3.3.2"><apply id="S4.SS1.p1.1.m1.2.2.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.1.1.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.2">𝑏</ci><cn type="integer" id="S4.SS1.p1.1.m1.2.2.1.1.3.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">…</ci><apply id="S4.SS1.p1.1.m1.3.3.2.2.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.3.3.2.2.1.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2.2">𝑏</ci><ci id="S4.SS1.p1.1.m1.3.3.2.2.3.cmml" xref="S4.SS1.p1.1.m1.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.3c">\{b_{1},...,b_{N}\}</annotation></semantics></math>, <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="b_{i}\in\mathbb{R}^{4}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">b</mi><mi id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><in id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></in><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝑏</ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">ℝ</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">b_{i}\in\mathbb{R}^{4}</annotation></semantics></math> and complementary set of object encodings <math id="S4.SS1.p1.3.m3.3" class="ltx_Math" alttext="\{v_{1},...,v_{N}\}" display="inline"><semantics id="S4.SS1.p1.3.m3.3a"><mrow id="S4.SS1.p1.3.m3.3.3.2" xref="S4.SS1.p1.3.m3.3.3.3.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.3.3.2.3" xref="S4.SS1.p1.3.m3.3.3.3.cmml">{</mo><msub id="S4.SS1.p1.3.m3.2.2.1.1" xref="S4.SS1.p1.3.m3.2.2.1.1.cmml"><mi id="S4.SS1.p1.3.m3.2.2.1.1.2" xref="S4.SS1.p1.3.m3.2.2.1.1.2.cmml">v</mi><mn id="S4.SS1.p1.3.m3.2.2.1.1.3" xref="S4.SS1.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.3.m3.3.3.2.4" xref="S4.SS1.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">…</mi><mo id="S4.SS1.p1.3.m3.3.3.2.5" xref="S4.SS1.p1.3.m3.3.3.3.cmml">,</mo><msub id="S4.SS1.p1.3.m3.3.3.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.cmml"><mi id="S4.SS1.p1.3.m3.3.3.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.cmml">v</mi><mi id="S4.SS1.p1.3.m3.3.3.2.2.3" xref="S4.SS1.p1.3.m3.3.3.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S4.SS1.p1.3.m3.3.3.2.6" xref="S4.SS1.p1.3.m3.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.3b"><set id="S4.SS1.p1.3.m3.3.3.3.cmml" xref="S4.SS1.p1.3.m3.3.3.2"><apply id="S4.SS1.p1.3.m3.2.2.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.1.1.2.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.2">𝑣</ci><cn type="integer" id="S4.SS1.p1.3.m3.2.2.1.1.3.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">…</ci><apply id="S4.SS1.p1.3.m3.3.3.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.2.2.1.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2">𝑣</ci><ci id="S4.SS1.p1.3.m3.3.3.2.2.3.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.3c">\{v_{1},...,v_{N}\}</annotation></semantics></math>, <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="v_{i}\in\mathbb{R}^{2048}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mrow id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><msub id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.2.2.cmml">v</mi><mi id="S4.SS1.p1.4.m4.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p1.4.m4.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml"><mi id="S4.SS1.p1.4.m4.1.1.3.2" xref="S4.SS1.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mn id="S4.SS1.p1.4.m4.1.1.3.3" xref="S4.SS1.p1.4.m4.1.1.3.3.cmml">2048</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><in id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1"></in><apply id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2.2">𝑣</ci><ci id="S4.SS1.p1.4.m4.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.2.3">𝑖</ci></apply><apply id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.3.1.cmml" xref="S4.SS1.p1.4.m4.1.1.3">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.3.2.cmml" xref="S4.SS1.p1.4.m4.1.1.3.2">ℝ</ci><cn type="integer" id="S4.SS1.p1.4.m4.1.1.3.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3.3">2048</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">v_{i}\in\mathbb{R}^{2048}</annotation></semantics></math>, corresponding to the locations and feature representations of each of the <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">N</annotation></semantics></math> detected objects, respectively (blue box in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>a).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p">Rather than train our own vision module from scratch, we make use of the publicly available object proposals learned in <cite class="ltx_cite ltx_citemacro_citet">Anderson et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>. These provide rich, object-centric representations for each image in our dataset. These representations are fixed when learning to count and are shared across each of the QA models we experiment with.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Language</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">Each architecture encodes the question and compares it to each detected object via a scoring function.
We define <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">q</annotation></semantics></math> as the final hidden state of an LSTM <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter &amp; Schmidhuber, <a href="#bib.bib12" title="" class="ltx_ref">1997</a>)</cite> after processing the question and compute a score vector for each object (Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, green boxes):</p>
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E1.m1.2" class="ltx_Math" alttext="\displaystyle h^{t}={\rm LSTM}\left(x^{t},h^{t-1}\right)" display="inline"><semantics id="S4.E1.m1.2a"><mrow id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml"><msup id="S4.E1.m1.2.2.4" xref="S4.E1.m1.2.2.4.cmml"><mi id="S4.E1.m1.2.2.4.2" xref="S4.E1.m1.2.2.4.2.cmml">h</mi><mi id="S4.E1.m1.2.2.4.3" xref="S4.E1.m1.2.2.4.3.cmml">t</mi></msup><mo id="S4.E1.m1.2.2.3" xref="S4.E1.m1.2.2.3.cmml">=</mo><mrow id="S4.E1.m1.2.2.2" xref="S4.E1.m1.2.2.2.cmml"><mi id="S4.E1.m1.2.2.2.4" xref="S4.E1.m1.2.2.2.4.cmml">LSTM</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.2.2.2.3" xref="S4.E1.m1.2.2.2.3.cmml">​</mo><mrow id="S4.E1.m1.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.3.cmml"><mo id="S4.E1.m1.2.2.2.2.2.3" xref="S4.E1.m1.2.2.2.2.3.cmml">(</mo><msup id="S4.E1.m1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E1.m1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.E1.m1.2.2.2.2.2.4" xref="S4.E1.m1.2.2.2.2.3.cmml">,</mo><msup id="S4.E1.m1.2.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.2.2.cmml"><mi id="S4.E1.m1.2.2.2.2.2.2.2" xref="S4.E1.m1.2.2.2.2.2.2.2.cmml">h</mi><mrow id="S4.E1.m1.2.2.2.2.2.2.3" xref="S4.E1.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E1.m1.2.2.2.2.2.2.3.2" xref="S4.E1.m1.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="S4.E1.m1.2.2.2.2.2.2.3.1" xref="S4.E1.m1.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S4.E1.m1.2.2.2.2.2.2.3.3" xref="S4.E1.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.E1.m1.2.2.2.2.2.5" xref="S4.E1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.2b"><apply id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2"><eq id="S4.E1.m1.2.2.3.cmml" xref="S4.E1.m1.2.2.3"></eq><apply id="S4.E1.m1.2.2.4.cmml" xref="S4.E1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.4.1.cmml" xref="S4.E1.m1.2.2.4">superscript</csymbol><ci id="S4.E1.m1.2.2.4.2.cmml" xref="S4.E1.m1.2.2.4.2">ℎ</ci><ci id="S4.E1.m1.2.2.4.3.cmml" xref="S4.E1.m1.2.2.4.3">𝑡</ci></apply><apply id="S4.E1.m1.2.2.2.cmml" xref="S4.E1.m1.2.2.2"><times id="S4.E1.m1.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.3"></times><ci id="S4.E1.m1.2.2.2.4.cmml" xref="S4.E1.m1.2.2.2.4">LSTM</ci><interval closure="open" id="S4.E1.m1.2.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.2.2"><apply id="S4.E1.m1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E1.m1.2.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S4.E1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.2">ℎ</ci><apply id="S4.E1.m1.2.2.2.2.2.2.3.cmml" xref="S4.E1.m1.2.2.2.2.2.2.3"><minus id="S4.E1.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E1.m1.2.2.2.2.2.2.3.1"></minus><ci id="S4.E1.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E1.m1.2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S4.E1.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E1.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.2c">\displaystyle h^{t}={\rm LSTM}\left(x^{t},h^{t-1}\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E1.m2.1" class="ltx_Math" alttext="\displaystyle\quad q=h^{T}" display="inline"><semantics id="S4.E1.m2.1a"><mrow id="S4.E1.m2.1.1" xref="S4.E1.m2.1.1.cmml"><mi id="S4.E1.m2.1.1.2" xref="S4.E1.m2.1.1.2.cmml">q</mi><mo id="S4.E1.m2.1.1.1" xref="S4.E1.m2.1.1.1.cmml">=</mo><msup id="S4.E1.m2.1.1.3" xref="S4.E1.m2.1.1.3.cmml"><mi id="S4.E1.m2.1.1.3.2" xref="S4.E1.m2.1.1.3.2.cmml">h</mi><mi id="S4.E1.m2.1.1.3.3" xref="S4.E1.m2.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m2.1b"><apply id="S4.E1.m2.1.1.cmml" xref="S4.E1.m2.1.1"><eq id="S4.E1.m2.1.1.1.cmml" xref="S4.E1.m2.1.1.1"></eq><ci id="S4.E1.m2.1.1.2.cmml" xref="S4.E1.m2.1.1.2">𝑞</ci><apply id="S4.E1.m2.1.1.3.cmml" xref="S4.E1.m2.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m2.1.1.3.1.cmml" xref="S4.E1.m2.1.1.3">superscript</csymbol><ci id="S4.E1.m2.1.1.3.2.cmml" xref="S4.E1.m2.1.1.3.2">ℎ</ci><ci id="S4.E1.m2.1.1.3.3.cmml" xref="S4.E1.m2.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m2.1c">\displaystyle\quad q=h^{T}</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2.m1.2" class="ltx_Math" alttext="\displaystyle s_{i}={f}^{S}\left({\left[{q},{v_{i}}\right]}\right)" display="inline"><semantics id="S4.E2.m1.2a"><mrow id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml"><msub id="S4.E2.m1.2.2.3" xref="S4.E2.m1.2.2.3.cmml"><mi id="S4.E2.m1.2.2.3.2" xref="S4.E2.m1.2.2.3.2.cmml">s</mi><mi id="S4.E2.m1.2.2.3.3" xref="S4.E2.m1.2.2.3.3.cmml">i</mi></msub><mo id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml">=</mo><mrow id="S4.E2.m1.2.2.1" xref="S4.E2.m1.2.2.1.cmml"><msup id="S4.E2.m1.2.2.1.3" xref="S4.E2.m1.2.2.1.3.cmml"><mi id="S4.E2.m1.2.2.1.3.2" xref="S4.E2.m1.2.2.1.3.2.cmml">f</mi><mi id="S4.E2.m1.2.2.1.3.3" xref="S4.E2.m1.2.2.1.3.3.cmml">S</mi></msup><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.2.1.2" xref="S4.E2.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E2.m1.2.2.1.1.1" xref="S4.E2.m1.2.2.1.cmml"><mo id="S4.E2.m1.2.2.1.1.1.2" xref="S4.E2.m1.2.2.1.cmml">(</mo><mrow id="S4.E2.m1.2.2.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml"><mo id="S4.E2.m1.2.2.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">[</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">q</mi><mo id="S4.E2.m1.2.2.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">,</mo><msub id="S4.E2.m1.2.2.1.1.1.1.1.1" xref="S4.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.2" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2.cmml">v</mi><mi id="S4.E2.m1.2.2.1.1.1.1.1.1.3" xref="S4.E2.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E2.m1.2.2.1.1.1.1.1.4" xref="S4.E2.m1.2.2.1.1.1.1.2.cmml">]</mo></mrow><mo id="S4.E2.m1.2.2.1.1.1.3" xref="S4.E2.m1.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.2b"><apply id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2"><eq id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"></eq><apply id="S4.E2.m1.2.2.3.cmml" xref="S4.E2.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.3.1.cmml" xref="S4.E2.m1.2.2.3">subscript</csymbol><ci id="S4.E2.m1.2.2.3.2.cmml" xref="S4.E2.m1.2.2.3.2">𝑠</ci><ci id="S4.E2.m1.2.2.3.3.cmml" xref="S4.E2.m1.2.2.3.3">𝑖</ci></apply><apply id="S4.E2.m1.2.2.1.cmml" xref="S4.E2.m1.2.2.1"><times id="S4.E2.m1.2.2.1.2.cmml" xref="S4.E2.m1.2.2.1.2"></times><apply id="S4.E2.m1.2.2.1.3.cmml" xref="S4.E2.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.3.1.cmml" xref="S4.E2.m1.2.2.1.3">superscript</csymbol><ci id="S4.E2.m1.2.2.1.3.2.cmml" xref="S4.E2.m1.2.2.1.3.2">𝑓</ci><ci id="S4.E2.m1.2.2.1.3.3.cmml" xref="S4.E2.m1.2.2.1.3.3">𝑆</ci></apply><interval closure="closed" id="S4.E2.m1.2.2.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1"><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝑞</ci><apply id="S4.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.2">𝑣</ci><ci id="S4.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.2c">\displaystyle s_{i}={f}^{S}\left({\left[{q},{v_{i}}\right]}\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.7" class="ltx_p">Here, <math id="S4.SS2.p1.2.m1.1" class="ltx_Math" alttext="x_{t}" display="inline"><semantics id="S4.SS2.p1.2.m1.1a"><msub id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml"><mi id="S4.SS2.p1.2.m1.1.1.2" xref="S4.SS2.p1.2.m1.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.2.m1.1.1.3" xref="S4.SS2.p1.2.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.1b"><apply id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.1.1.2">𝑥</ci><ci id="S4.SS2.p1.2.m1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.1c">x_{t}</annotation></semantics></math> denotes the word embedding of the question token at position <math id="S4.SS2.p1.3.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p1.3.m2.1a"><mi id="S4.SS2.p1.3.m2.1.1" xref="S4.SS2.p1.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.1b"><ci id="S4.SS2.p1.3.m2.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.1c">t</annotation></semantics></math> and <math id="S4.SS2.p1.4.m3.1" class="ltx_Math" alttext="s_{i}\in\mathbb{R}^{n}" display="inline"><semantics id="S4.SS2.p1.4.m3.1a"><mrow id="S4.SS2.p1.4.m3.1.1" xref="S4.SS2.p1.4.m3.1.1.cmml"><msub id="S4.SS2.p1.4.m3.1.1.2" xref="S4.SS2.p1.4.m3.1.1.2.cmml"><mi id="S4.SS2.p1.4.m3.1.1.2.2" xref="S4.SS2.p1.4.m3.1.1.2.2.cmml">s</mi><mi id="S4.SS2.p1.4.m3.1.1.2.3" xref="S4.SS2.p1.4.m3.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS2.p1.4.m3.1.1.1" xref="S4.SS2.p1.4.m3.1.1.1.cmml">∈</mo><msup id="S4.SS2.p1.4.m3.1.1.3" xref="S4.SS2.p1.4.m3.1.1.3.cmml"><mi id="S4.SS2.p1.4.m3.1.1.3.2" xref="S4.SS2.p1.4.m3.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS2.p1.4.m3.1.1.3.3" xref="S4.SS2.p1.4.m3.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m3.1b"><apply id="S4.SS2.p1.4.m3.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1"><in id="S4.SS2.p1.4.m3.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1"></in><apply id="S4.SS2.p1.4.m3.1.1.2.cmml" xref="S4.SS2.p1.4.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.2.1.cmml" xref="S4.SS2.p1.4.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.4.m3.1.1.2.2.cmml" xref="S4.SS2.p1.4.m3.1.1.2.2">𝑠</ci><ci id="S4.SS2.p1.4.m3.1.1.2.3.cmml" xref="S4.SS2.p1.4.m3.1.1.2.3">𝑖</ci></apply><apply id="S4.SS2.p1.4.m3.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.3.1.cmml" xref="S4.SS2.p1.4.m3.1.1.3">superscript</csymbol><ci id="S4.SS2.p1.4.m3.1.1.3.2.cmml" xref="S4.SS2.p1.4.m3.1.1.3.2">ℝ</ci><ci id="S4.SS2.p1.4.m3.1.1.3.3.cmml" xref="S4.SS2.p1.4.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m3.1c">s_{i}\in\mathbb{R}^{n}</annotation></semantics></math> denotes the score vector encoding the relevance of object <math id="S4.SS2.p1.5.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.5.m4.1a"><mi id="S4.SS2.p1.5.m4.1.1" xref="S4.SS2.p1.5.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m4.1b"><ci id="S4.SS2.p1.5.m4.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m4.1c">i</annotation></semantics></math> to the question.
Following <cite class="ltx_cite ltx_citemacro_citet">Anderson et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>, we implement the scoring function <math id="S4.SS2.p1.6.m5.1" class="ltx_Math" alttext="{f}^{S}:\mathbb{R}^{m}\rightarrow\mathbb{R}^{n}" display="inline"><semantics id="S4.SS2.p1.6.m5.1a"><mrow id="S4.SS2.p1.6.m5.1.1" xref="S4.SS2.p1.6.m5.1.1.cmml"><msup id="S4.SS2.p1.6.m5.1.1.2" xref="S4.SS2.p1.6.m5.1.1.2.cmml"><mi id="S4.SS2.p1.6.m5.1.1.2.2" xref="S4.SS2.p1.6.m5.1.1.2.2.cmml">f</mi><mi id="S4.SS2.p1.6.m5.1.1.2.3" xref="S4.SS2.p1.6.m5.1.1.2.3.cmml">S</mi></msup><mo lspace="0.278em" rspace="0.278em" id="S4.SS2.p1.6.m5.1.1.1" xref="S4.SS2.p1.6.m5.1.1.1.cmml">:</mo><mrow id="S4.SS2.p1.6.m5.1.1.3" xref="S4.SS2.p1.6.m5.1.1.3.cmml"><msup id="S4.SS2.p1.6.m5.1.1.3.2" xref="S4.SS2.p1.6.m5.1.1.3.2.cmml"><mi id="S4.SS2.p1.6.m5.1.1.3.2.2" xref="S4.SS2.p1.6.m5.1.1.3.2.2.cmml">ℝ</mi><mi id="S4.SS2.p1.6.m5.1.1.3.2.3" xref="S4.SS2.p1.6.m5.1.1.3.2.3.cmml">m</mi></msup><mo stretchy="false" id="S4.SS2.p1.6.m5.1.1.3.1" xref="S4.SS2.p1.6.m5.1.1.3.1.cmml">→</mo><msup id="S4.SS2.p1.6.m5.1.1.3.3" xref="S4.SS2.p1.6.m5.1.1.3.3.cmml"><mi id="S4.SS2.p1.6.m5.1.1.3.3.2" xref="S4.SS2.p1.6.m5.1.1.3.3.2.cmml">ℝ</mi><mi id="S4.SS2.p1.6.m5.1.1.3.3.3" xref="S4.SS2.p1.6.m5.1.1.3.3.3.cmml">n</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m5.1b"><apply id="S4.SS2.p1.6.m5.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1"><ci id="S4.SS2.p1.6.m5.1.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1.1">:</ci><apply id="S4.SS2.p1.6.m5.1.1.2.cmml" xref="S4.SS2.p1.6.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.1.1.2.1.cmml" xref="S4.SS2.p1.6.m5.1.1.2">superscript</csymbol><ci id="S4.SS2.p1.6.m5.1.1.2.2.cmml" xref="S4.SS2.p1.6.m5.1.1.2.2">𝑓</ci><ci id="S4.SS2.p1.6.m5.1.1.2.3.cmml" xref="S4.SS2.p1.6.m5.1.1.2.3">𝑆</ci></apply><apply id="S4.SS2.p1.6.m5.1.1.3.cmml" xref="S4.SS2.p1.6.m5.1.1.3"><ci id="S4.SS2.p1.6.m5.1.1.3.1.cmml" xref="S4.SS2.p1.6.m5.1.1.3.1">→</ci><apply id="S4.SS2.p1.6.m5.1.1.3.2.cmml" xref="S4.SS2.p1.6.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.1.1.3.2.1.cmml" xref="S4.SS2.p1.6.m5.1.1.3.2">superscript</csymbol><ci id="S4.SS2.p1.6.m5.1.1.3.2.2.cmml" xref="S4.SS2.p1.6.m5.1.1.3.2.2">ℝ</ci><ci id="S4.SS2.p1.6.m5.1.1.3.2.3.cmml" xref="S4.SS2.p1.6.m5.1.1.3.2.3">𝑚</ci></apply><apply id="S4.SS2.p1.6.m5.1.1.3.3.cmml" xref="S4.SS2.p1.6.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.1.1.3.3.1.cmml" xref="S4.SS2.p1.6.m5.1.1.3.3">superscript</csymbol><ci id="S4.SS2.p1.6.m5.1.1.3.3.2.cmml" xref="S4.SS2.p1.6.m5.1.1.3.3.2">ℝ</ci><ci id="S4.SS2.p1.6.m5.1.1.3.3.3.cmml" xref="S4.SS2.p1.6.m5.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m5.1c">{f}^{S}:\mathbb{R}^{m}\rightarrow\mathbb{R}^{n}</annotation></semantics></math> as a layer of Gated Tanh Units (GTU) <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al., <a href="#bib.bib39" title="" class="ltx_ref">2016</a>)</cite>.
<math id="S4.SS2.p1.7.m6.1" class="ltx_math_unparsed" alttext="\left[,\right]" display="inline"><semantics id="S4.SS2.p1.7.m6.1a"><mrow id="S4.SS2.p1.7.m6.1b"><mo id="S4.SS2.p1.7.m6.1.1">[</mo><mo id="S4.SS2.p1.7.m6.1.2">,</mo><mo id="S4.SS2.p1.7.m6.1.3">]</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m6.1c">\left[,\right]</annotation></semantics></math> denotes vector concatenation.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.1" class="ltx_p">We experiment with jointly training the scoring function to perform caption grounding, which we supervise using region captions from Visual Genome.
Region captions provide linguistic descriptions of localized regions within the image, and the goal of caption grounding is to identify which object a given caption describes (details provided in Section  <a href="#A2.SS1" title="B.1 Caption Grounding ‣ Appendix B Training and implementation details ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.1</span></a> of the Appendix).
Caption grounding uses a strategy identical to that for question answering (Eqs. <a href="#S4.E1" title="In 4.2 Language ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S4.E2" title="In 4.2 Language ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>): an LSTM is used to encode each caption and the scoring function <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="{f}^{S}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><msup id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">f</mi><mi id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝑓</ci><ci id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">{f}^{S}</annotation></semantics></math> is used to encode its relevance to each detected object.
The weights of the scoring function are tied for counting and caption grounding (Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>b).
We include results from experiments where caption grounding is ignored.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Counting</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_bold">Interpretable RL Counter (IRLC).</span> For our proposed model, we aim to learn <span id="S4.SS3.p1.1.2" class="ltx_text ltx_font_italic">how</span> to count by learning <span id="S4.SS3.p1.1.3" class="ltx_text ltx_font_italic">what</span> to count.
We assume that each counting question implicitly refers to a subset of the objects within a scene that meet some variable criteria.
In this sense, the goal of our model is to enumerate that subset of objects.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.3" class="ltx_p">To implement this as a sequential decision process, we need to represent the probability of selecting a given action and how each action affects subsequent choices.
To that end, we project the object scores <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="s\in\mathbb{R}^{{N}{\rm x}{n}}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">s</mi><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.3.2" xref="S4.SS3.p2.1.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.3.3.1" xref="S4.SS3.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p2.1.m1.1.1.3.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.3.3.1a" xref="S4.SS3.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p2.1.m1.1.1.3.3.4" xref="S4.SS3.p2.1.m1.1.1.3.3.4.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><in id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1"></in><ci id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">𝑠</ci><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3"><times id="S4.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.2">𝑁</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.3">x</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.4.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">s\in\mathbb{R}^{{N}{\rm x}{n}}</annotation></semantics></math> to a vector of logits <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\kappa\in\mathbb{R}^{N}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">κ</mi><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.2" xref="S4.SS3.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.p2.2.m2.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><in id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></in><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝜅</ci><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2">ℝ</ci><ci id="S4.SS3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\kappa\in\mathbb{R}^{N}</annotation></semantics></math>, representing how likely each object is to be counted, where <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mi id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><ci id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">N</annotation></semantics></math> is the number of detected objects:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\kappa={Ws+b}" display="block"><semantics id="S4.E3.m1.1a"><mrow id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><mi id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">κ</mi><mo id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml"><mrow id="S4.E3.m1.1.1.3.2" xref="S4.E3.m1.1.1.3.2.cmml"><mi id="S4.E3.m1.1.1.3.2.2" xref="S4.E3.m1.1.1.3.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.3.2.1" xref="S4.E3.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.E3.m1.1.1.3.2.3" xref="S4.E3.m1.1.1.3.2.3.cmml">s</mi></mrow><mo id="S4.E3.m1.1.1.3.1" xref="S4.E3.m1.1.1.3.1.cmml">+</mo><mi id="S4.E3.m1.1.1.3.3" xref="S4.E3.m1.1.1.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><eq id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"></eq><ci id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2">𝜅</ci><apply id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3"><plus id="S4.E3.m1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.3.1"></plus><apply id="S4.E3.m1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.3.2"><times id="S4.E3.m1.1.1.3.2.1.cmml" xref="S4.E3.m1.1.1.3.2.1"></times><ci id="S4.E3.m1.1.1.3.2.2.cmml" xref="S4.E3.m1.1.1.3.2.2">𝑊</ci><ci id="S4.E3.m1.1.1.3.2.3.cmml" xref="S4.E3.m1.1.1.3.2.3">𝑠</ci></apply><ci id="S4.E3.m1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\kappa={Ws+b}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.15" class="ltx_p">And we compute a matrix of interaction terms <math id="S4.SS3.p2.4.m1.1" class="ltx_Math" alttext="\rho\in\mathbb{R}^{{N}{\rm x}{N}}" display="inline"><semantics id="S4.SS3.p2.4.m1.1a"><mrow id="S4.SS3.p2.4.m1.1.1" xref="S4.SS3.p2.4.m1.1.1.cmml"><mi id="S4.SS3.p2.4.m1.1.1.2" xref="S4.SS3.p2.4.m1.1.1.2.cmml">ρ</mi><mo id="S4.SS3.p2.4.m1.1.1.1" xref="S4.SS3.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p2.4.m1.1.1.3" xref="S4.SS3.p2.4.m1.1.1.3.cmml"><mi id="S4.SS3.p2.4.m1.1.1.3.2" xref="S4.SS3.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p2.4.m1.1.1.3.3" xref="S4.SS3.p2.4.m1.1.1.3.3.cmml"><mi id="S4.SS3.p2.4.m1.1.1.3.3.2" xref="S4.SS3.p2.4.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m1.1.1.3.3.1" xref="S4.SS3.p2.4.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p2.4.m1.1.1.3.3.3" xref="S4.SS3.p2.4.m1.1.1.3.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.4.m1.1.1.3.3.1a" xref="S4.SS3.p2.4.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p2.4.m1.1.1.3.3.4" xref="S4.SS3.p2.4.m1.1.1.3.3.4.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m1.1b"><apply id="S4.SS3.p2.4.m1.1.1.cmml" xref="S4.SS3.p2.4.m1.1.1"><in id="S4.SS3.p2.4.m1.1.1.1.cmml" xref="S4.SS3.p2.4.m1.1.1.1"></in><ci id="S4.SS3.p2.4.m1.1.1.2.cmml" xref="S4.SS3.p2.4.m1.1.1.2">𝜌</ci><apply id="S4.SS3.p2.4.m1.1.1.3.cmml" xref="S4.SS3.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m1.1.1.3.1.cmml" xref="S4.SS3.p2.4.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.4.m1.1.1.3.2.cmml" xref="S4.SS3.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p2.4.m1.1.1.3.3.cmml" xref="S4.SS3.p2.4.m1.1.1.3.3"><times id="S4.SS3.p2.4.m1.1.1.3.3.1.cmml" xref="S4.SS3.p2.4.m1.1.1.3.3.1"></times><ci id="S4.SS3.p2.4.m1.1.1.3.3.2.cmml" xref="S4.SS3.p2.4.m1.1.1.3.3.2">𝑁</ci><ci id="S4.SS3.p2.4.m1.1.1.3.3.3.cmml" xref="S4.SS3.p2.4.m1.1.1.3.3.3">x</ci><ci id="S4.SS3.p2.4.m1.1.1.3.3.4.cmml" xref="S4.SS3.p2.4.m1.1.1.3.3.4">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m1.1c">\rho\in\mathbb{R}^{{N}{\rm x}{N}}</annotation></semantics></math> that are used to update the logits <math id="S4.SS3.p2.5.m2.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S4.SS3.p2.5.m2.1a"><mi id="S4.SS3.p2.5.m2.1.1" xref="S4.SS3.p2.5.m2.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m2.1b"><ci id="S4.SS3.p2.5.m2.1.1.cmml" xref="S4.SS3.p2.5.m2.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m2.1c">\kappa</annotation></semantics></math>.
The value <math id="S4.SS3.p2.6.m3.1" class="ltx_Math" alttext="\rho_{ij}" display="inline"><semantics id="S4.SS3.p2.6.m3.1a"><msub id="S4.SS3.p2.6.m3.1.1" xref="S4.SS3.p2.6.m3.1.1.cmml"><mi id="S4.SS3.p2.6.m3.1.1.2" xref="S4.SS3.p2.6.m3.1.1.2.cmml">ρ</mi><mrow id="S4.SS3.p2.6.m3.1.1.3" xref="S4.SS3.p2.6.m3.1.1.3.cmml"><mi id="S4.SS3.p2.6.m3.1.1.3.2" xref="S4.SS3.p2.6.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.6.m3.1.1.3.1" xref="S4.SS3.p2.6.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.6.m3.1.1.3.3" xref="S4.SS3.p2.6.m3.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m3.1b"><apply id="S4.SS3.p2.6.m3.1.1.cmml" xref="S4.SS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m3.1.1.1.cmml" xref="S4.SS3.p2.6.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m3.1.1.2.cmml" xref="S4.SS3.p2.6.m3.1.1.2">𝜌</ci><apply id="S4.SS3.p2.6.m3.1.1.3.cmml" xref="S4.SS3.p2.6.m3.1.1.3"><times id="S4.SS3.p2.6.m3.1.1.3.1.cmml" xref="S4.SS3.p2.6.m3.1.1.3.1"></times><ci id="S4.SS3.p2.6.m3.1.1.3.2.cmml" xref="S4.SS3.p2.6.m3.1.1.3.2">𝑖</ci><ci id="S4.SS3.p2.6.m3.1.1.3.3.cmml" xref="S4.SS3.p2.6.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m3.1c">\rho_{ij}</annotation></semantics></math> represents how selecting object <math id="S4.SS3.p2.7.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS3.p2.7.m4.1a"><mi id="S4.SS3.p2.7.m4.1.1" xref="S4.SS3.p2.7.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m4.1b"><ci id="S4.SS3.p2.7.m4.1.1.cmml" xref="S4.SS3.p2.7.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m4.1c">i</annotation></semantics></math> will change <math id="S4.SS3.p2.8.m5.1" class="ltx_Math" alttext="\kappa_{j}" display="inline"><semantics id="S4.SS3.p2.8.m5.1a"><msub id="S4.SS3.p2.8.m5.1.1" xref="S4.SS3.p2.8.m5.1.1.cmml"><mi id="S4.SS3.p2.8.m5.1.1.2" xref="S4.SS3.p2.8.m5.1.1.2.cmml">κ</mi><mi id="S4.SS3.p2.8.m5.1.1.3" xref="S4.SS3.p2.8.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m5.1b"><apply id="S4.SS3.p2.8.m5.1.1.cmml" xref="S4.SS3.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.8.m5.1.1.1.cmml" xref="S4.SS3.p2.8.m5.1.1">subscript</csymbol><ci id="S4.SS3.p2.8.m5.1.1.2.cmml" xref="S4.SS3.p2.8.m5.1.1.2">𝜅</ci><ci id="S4.SS3.p2.8.m5.1.1.3.cmml" xref="S4.SS3.p2.8.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m5.1c">\kappa_{j}</annotation></semantics></math>.
We calculate this interaction from
a compressed representation of the question (<math id="S4.SS3.p2.9.m6.1" class="ltx_Math" alttext="Wq" display="inline"><semantics id="S4.SS3.p2.9.m6.1a"><mrow id="S4.SS3.p2.9.m6.1.1" xref="S4.SS3.p2.9.m6.1.1.cmml"><mi id="S4.SS3.p2.9.m6.1.1.2" xref="S4.SS3.p2.9.m6.1.1.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.9.m6.1.1.1" xref="S4.SS3.p2.9.m6.1.1.1.cmml">​</mo><mi id="S4.SS3.p2.9.m6.1.1.3" xref="S4.SS3.p2.9.m6.1.1.3.cmml">q</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m6.1b"><apply id="S4.SS3.p2.9.m6.1.1.cmml" xref="S4.SS3.p2.9.m6.1.1"><times id="S4.SS3.p2.9.m6.1.1.1.cmml" xref="S4.SS3.p2.9.m6.1.1.1"></times><ci id="S4.SS3.p2.9.m6.1.1.2.cmml" xref="S4.SS3.p2.9.m6.1.1.2">𝑊</ci><ci id="S4.SS3.p2.9.m6.1.1.3.cmml" xref="S4.SS3.p2.9.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m6.1c">Wq</annotation></semantics></math>),
the dot product of the normalized object vectors (<math id="S4.SS3.p2.10.m7.1" class="ltx_Math" alttext="\hat{v}^{\rm T}_{i}\hat{v}_{j}" display="inline"><semantics id="S4.SS3.p2.10.m7.1a"><mrow id="S4.SS3.p2.10.m7.1.1" xref="S4.SS3.p2.10.m7.1.1.cmml"><msubsup id="S4.SS3.p2.10.m7.1.1.2" xref="S4.SS3.p2.10.m7.1.1.2.cmml"><mover accent="true" id="S4.SS3.p2.10.m7.1.1.2.2.2" xref="S4.SS3.p2.10.m7.1.1.2.2.2.cmml"><mi id="S4.SS3.p2.10.m7.1.1.2.2.2.2" xref="S4.SS3.p2.10.m7.1.1.2.2.2.2.cmml">v</mi><mo id="S4.SS3.p2.10.m7.1.1.2.2.2.1" xref="S4.SS3.p2.10.m7.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.10.m7.1.1.2.3" xref="S4.SS3.p2.10.m7.1.1.2.3.cmml">i</mi><mi mathvariant="normal" id="S4.SS3.p2.10.m7.1.1.2.2.3" xref="S4.SS3.p2.10.m7.1.1.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS3.p2.10.m7.1.1.1" xref="S4.SS3.p2.10.m7.1.1.1.cmml">​</mo><msub id="S4.SS3.p2.10.m7.1.1.3" xref="S4.SS3.p2.10.m7.1.1.3.cmml"><mover accent="true" id="S4.SS3.p2.10.m7.1.1.3.2" xref="S4.SS3.p2.10.m7.1.1.3.2.cmml"><mi id="S4.SS3.p2.10.m7.1.1.3.2.2" xref="S4.SS3.p2.10.m7.1.1.3.2.2.cmml">v</mi><mo id="S4.SS3.p2.10.m7.1.1.3.2.1" xref="S4.SS3.p2.10.m7.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.10.m7.1.1.3.3" xref="S4.SS3.p2.10.m7.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.10.m7.1b"><apply id="S4.SS3.p2.10.m7.1.1.cmml" xref="S4.SS3.p2.10.m7.1.1"><times id="S4.SS3.p2.10.m7.1.1.1.cmml" xref="S4.SS3.p2.10.m7.1.1.1"></times><apply id="S4.SS3.p2.10.m7.1.1.2.cmml" xref="S4.SS3.p2.10.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m7.1.1.2.1.cmml" xref="S4.SS3.p2.10.m7.1.1.2">subscript</csymbol><apply id="S4.SS3.p2.10.m7.1.1.2.2.cmml" xref="S4.SS3.p2.10.m7.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m7.1.1.2.2.1.cmml" xref="S4.SS3.p2.10.m7.1.1.2">superscript</csymbol><apply id="S4.SS3.p2.10.m7.1.1.2.2.2.cmml" xref="S4.SS3.p2.10.m7.1.1.2.2.2"><ci id="S4.SS3.p2.10.m7.1.1.2.2.2.1.cmml" xref="S4.SS3.p2.10.m7.1.1.2.2.2.1">^</ci><ci id="S4.SS3.p2.10.m7.1.1.2.2.2.2.cmml" xref="S4.SS3.p2.10.m7.1.1.2.2.2.2">𝑣</ci></apply><ci id="S4.SS3.p2.10.m7.1.1.2.2.3.cmml" xref="S4.SS3.p2.10.m7.1.1.2.2.3">T</ci></apply><ci id="S4.SS3.p2.10.m7.1.1.2.3.cmml" xref="S4.SS3.p2.10.m7.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p2.10.m7.1.1.3.cmml" xref="S4.SS3.p2.10.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.10.m7.1.1.3.1.cmml" xref="S4.SS3.p2.10.m7.1.1.3">subscript</csymbol><apply id="S4.SS3.p2.10.m7.1.1.3.2.cmml" xref="S4.SS3.p2.10.m7.1.1.3.2"><ci id="S4.SS3.p2.10.m7.1.1.3.2.1.cmml" xref="S4.SS3.p2.10.m7.1.1.3.2.1">^</ci><ci id="S4.SS3.p2.10.m7.1.1.3.2.2.cmml" xref="S4.SS3.p2.10.m7.1.1.3.2.2">𝑣</ci></apply><ci id="S4.SS3.p2.10.m7.1.1.3.3.cmml" xref="S4.SS3.p2.10.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.10.m7.1c">\hat{v}^{\rm T}_{i}\hat{v}_{j}</annotation></semantics></math>),
the object coordinates (<math id="S4.SS3.p2.11.m8.1" class="ltx_Math" alttext="b_{i}" display="inline"><semantics id="S4.SS3.p2.11.m8.1a"><msub id="S4.SS3.p2.11.m8.1.1" xref="S4.SS3.p2.11.m8.1.1.cmml"><mi id="S4.SS3.p2.11.m8.1.1.2" xref="S4.SS3.p2.11.m8.1.1.2.cmml">b</mi><mi id="S4.SS3.p2.11.m8.1.1.3" xref="S4.SS3.p2.11.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.11.m8.1b"><apply id="S4.SS3.p2.11.m8.1.1.cmml" xref="S4.SS3.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.11.m8.1.1.1.cmml" xref="S4.SS3.p2.11.m8.1.1">subscript</csymbol><ci id="S4.SS3.p2.11.m8.1.1.2.cmml" xref="S4.SS3.p2.11.m8.1.1.2">𝑏</ci><ci id="S4.SS3.p2.11.m8.1.1.3.cmml" xref="S4.SS3.p2.11.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.11.m8.1c">b_{i}</annotation></semantics></math> and <math id="S4.SS3.p2.12.m9.1" class="ltx_Math" alttext="b_{j}" display="inline"><semantics id="S4.SS3.p2.12.m9.1a"><msub id="S4.SS3.p2.12.m9.1.1" xref="S4.SS3.p2.12.m9.1.1.cmml"><mi id="S4.SS3.p2.12.m9.1.1.2" xref="S4.SS3.p2.12.m9.1.1.2.cmml">b</mi><mi id="S4.SS3.p2.12.m9.1.1.3" xref="S4.SS3.p2.12.m9.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.12.m9.1b"><apply id="S4.SS3.p2.12.m9.1.1.cmml" xref="S4.SS3.p2.12.m9.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.12.m9.1.1.1.cmml" xref="S4.SS3.p2.12.m9.1.1">subscript</csymbol><ci id="S4.SS3.p2.12.m9.1.1.2.cmml" xref="S4.SS3.p2.12.m9.1.1.2">𝑏</ci><ci id="S4.SS3.p2.12.m9.1.1.3.cmml" xref="S4.SS3.p2.12.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.12.m9.1c">b_{j}</annotation></semantics></math>),
and basic overlap statistics (<math id="S4.SS3.p2.13.m10.1" class="ltx_Math" alttext="{\rm IoU}_{ij}" display="inline"><semantics id="S4.SS3.p2.13.m10.1a"><msub id="S4.SS3.p2.13.m10.1.1" xref="S4.SS3.p2.13.m10.1.1.cmml"><mi id="S4.SS3.p2.13.m10.1.1.2" xref="S4.SS3.p2.13.m10.1.1.2.cmml">IoU</mi><mrow id="S4.SS3.p2.13.m10.1.1.3" xref="S4.SS3.p2.13.m10.1.1.3.cmml"><mi id="S4.SS3.p2.13.m10.1.1.3.2" xref="S4.SS3.p2.13.m10.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.13.m10.1.1.3.1" xref="S4.SS3.p2.13.m10.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.13.m10.1.1.3.3" xref="S4.SS3.p2.13.m10.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.13.m10.1b"><apply id="S4.SS3.p2.13.m10.1.1.cmml" xref="S4.SS3.p2.13.m10.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.13.m10.1.1.1.cmml" xref="S4.SS3.p2.13.m10.1.1">subscript</csymbol><ci id="S4.SS3.p2.13.m10.1.1.2.cmml" xref="S4.SS3.p2.13.m10.1.1.2">IoU</ci><apply id="S4.SS3.p2.13.m10.1.1.3.cmml" xref="S4.SS3.p2.13.m10.1.1.3"><times id="S4.SS3.p2.13.m10.1.1.3.1.cmml" xref="S4.SS3.p2.13.m10.1.1.3.1"></times><ci id="S4.SS3.p2.13.m10.1.1.3.2.cmml" xref="S4.SS3.p2.13.m10.1.1.3.2">𝑖</ci><ci id="S4.SS3.p2.13.m10.1.1.3.3.cmml" xref="S4.SS3.p2.13.m10.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.13.m10.1c">{\rm IoU}_{ij}</annotation></semantics></math>, <math id="S4.SS3.p2.14.m11.1" class="ltx_Math" alttext="{\rm O}_{ij}" display="inline"><semantics id="S4.SS3.p2.14.m11.1a"><msub id="S4.SS3.p2.14.m11.1.1" xref="S4.SS3.p2.14.m11.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p2.14.m11.1.1.2" xref="S4.SS3.p2.14.m11.1.1.2.cmml">O</mi><mrow id="S4.SS3.p2.14.m11.1.1.3" xref="S4.SS3.p2.14.m11.1.1.3.cmml"><mi id="S4.SS3.p2.14.m11.1.1.3.2" xref="S4.SS3.p2.14.m11.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.14.m11.1.1.3.1" xref="S4.SS3.p2.14.m11.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.14.m11.1.1.3.3" xref="S4.SS3.p2.14.m11.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.14.m11.1b"><apply id="S4.SS3.p2.14.m11.1.1.cmml" xref="S4.SS3.p2.14.m11.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.14.m11.1.1.1.cmml" xref="S4.SS3.p2.14.m11.1.1">subscript</csymbol><ci id="S4.SS3.p2.14.m11.1.1.2.cmml" xref="S4.SS3.p2.14.m11.1.1.2">O</ci><apply id="S4.SS3.p2.14.m11.1.1.3.cmml" xref="S4.SS3.p2.14.m11.1.1.3"><times id="S4.SS3.p2.14.m11.1.1.3.1.cmml" xref="S4.SS3.p2.14.m11.1.1.3.1"></times><ci id="S4.SS3.p2.14.m11.1.1.3.2.cmml" xref="S4.SS3.p2.14.m11.1.1.3.2">𝑖</ci><ci id="S4.SS3.p2.14.m11.1.1.3.3.cmml" xref="S4.SS3.p2.14.m11.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.14.m11.1c">{\rm O}_{ij}</annotation></semantics></math>, and <math id="S4.SS3.p2.15.m12.1" class="ltx_Math" alttext="{\rm O}_{ji}" display="inline"><semantics id="S4.SS3.p2.15.m12.1a"><msub id="S4.SS3.p2.15.m12.1.1" xref="S4.SS3.p2.15.m12.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p2.15.m12.1.1.2" xref="S4.SS3.p2.15.m12.1.1.2.cmml">O</mi><mrow id="S4.SS3.p2.15.m12.1.1.3" xref="S4.SS3.p2.15.m12.1.1.3.cmml"><mi id="S4.SS3.p2.15.m12.1.1.3.2" xref="S4.SS3.p2.15.m12.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.15.m12.1.1.3.1" xref="S4.SS3.p2.15.m12.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p2.15.m12.1.1.3.3" xref="S4.SS3.p2.15.m12.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.15.m12.1b"><apply id="S4.SS3.p2.15.m12.1.1.cmml" xref="S4.SS3.p2.15.m12.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.15.m12.1.1.1.cmml" xref="S4.SS3.p2.15.m12.1.1">subscript</csymbol><ci id="S4.SS3.p2.15.m12.1.1.2.cmml" xref="S4.SS3.p2.15.m12.1.1.2">O</ci><apply id="S4.SS3.p2.15.m12.1.1.3.cmml" xref="S4.SS3.p2.15.m12.1.1.3"><times id="S4.SS3.p2.15.m12.1.1.3.1.cmml" xref="S4.SS3.p2.15.m12.1.1.3.1"></times><ci id="S4.SS3.p2.15.m12.1.1.3.2.cmml" xref="S4.SS3.p2.15.m12.1.1.3.2">𝑗</ci><ci id="S4.SS3.p2.15.m12.1.1.3.3.cmml" xref="S4.SS3.p2.15.m12.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.15.m12.1c">{\rm O}_{ji}</annotation></semantics></math>):</p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle\rho_{ij}={f}^{\rho}\left({\left[Wq,\hat{v}^{\rm T}_{i}\hat{v}_{j},b_{i},b_{j},{\rm IoU}_{ij},{\rm O}_{ij},{\rm O}_{ji}\right]}\right)" display="inline"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><msub id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.3.2.cmml">ρ</mi><mrow id="S4.E4.m1.1.1.3.3" xref="S4.E4.m1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.3.3.2" xref="S4.E4.m1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.3.3.1" xref="S4.E4.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.3.3.3" xref="S4.E4.m1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><msup id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.3.2.cmml">f</mi><mi id="S4.E4.m1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.3.3.cmml">ρ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mo id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.7" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml"><mo id="S4.E4.m1.1.1.1.1.1.1.7.8" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">[</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S4.E4.m1.1.1.1.1.1.1.7.9" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">,</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.1.1.2.2.cmml"><msubsup id="S4.E4.m1.1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">v</mi><mo id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.1" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S4.E4.m1.1.1.1.1.1.1.2.2.2.3" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mi mathvariant="normal" id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.2.2.1" xref="S4.E4.m1.1.1.1.1.1.1.2.2.1.cmml">​</mo><msub id="S4.E4.m1.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.cmml"><mover accent="true" id="S4.E4.m1.1.1.1.1.1.1.2.2.3.2" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.2" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.2.cmml">v</mi><mo id="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.1" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.1.cmml">^</mo></mover><mi id="S4.E4.m1.1.1.1.1.1.1.2.2.3.3" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></msub></mrow><mo id="S4.E4.m1.1.1.1.1.1.1.7.10" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">,</mo><msub id="S4.E4.m1.1.1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.3.3.2" xref="S4.E4.m1.1.1.1.1.1.1.3.3.2.cmml">b</mi><mi id="S4.E4.m1.1.1.1.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S4.E4.m1.1.1.1.1.1.1.7.11" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">,</mo><msub id="S4.E4.m1.1.1.1.1.1.1.4.4" xref="S4.E4.m1.1.1.1.1.1.1.4.4.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.4.4.2" xref="S4.E4.m1.1.1.1.1.1.1.4.4.2.cmml">b</mi><mi id="S4.E4.m1.1.1.1.1.1.1.4.4.3" xref="S4.E4.m1.1.1.1.1.1.1.4.4.3.cmml">j</mi></msub><mo id="S4.E4.m1.1.1.1.1.1.1.7.12" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">,</mo><msub id="S4.E4.m1.1.1.1.1.1.1.5.5" xref="S4.E4.m1.1.1.1.1.1.1.5.5.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.5.5.2" xref="S4.E4.m1.1.1.1.1.1.1.5.5.2.cmml">IoU</mi><mrow id="S4.E4.m1.1.1.1.1.1.1.5.5.3" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.5.5.3.2" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.5.5.3.1" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.1.1.5.5.3.3" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.3.cmml">j</mi></mrow></msub><mo id="S4.E4.m1.1.1.1.1.1.1.7.13" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">,</mo><msub id="S4.E4.m1.1.1.1.1.1.1.6.6" xref="S4.E4.m1.1.1.1.1.1.1.6.6.cmml"><mi mathvariant="normal" id="S4.E4.m1.1.1.1.1.1.1.6.6.2" xref="S4.E4.m1.1.1.1.1.1.1.6.6.2.cmml">O</mi><mrow id="S4.E4.m1.1.1.1.1.1.1.6.6.3" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.6.6.3.2" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.6.6.3.1" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.1.1.6.6.3.3" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.3.cmml">j</mi></mrow></msub><mo id="S4.E4.m1.1.1.1.1.1.1.7.14" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">,</mo><msub id="S4.E4.m1.1.1.1.1.1.1.7.7" xref="S4.E4.m1.1.1.1.1.1.1.7.7.cmml"><mi mathvariant="normal" id="S4.E4.m1.1.1.1.1.1.1.7.7.2" xref="S4.E4.m1.1.1.1.1.1.1.7.7.2.cmml">O</mi><mrow id="S4.E4.m1.1.1.1.1.1.1.7.7.3" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.7.7.3.2" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.1.1.7.7.3.1" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.1.1.7.7.3.3" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.3.cmml">i</mi></mrow></msub><mo id="S4.E4.m1.1.1.1.1.1.1.7.15" xref="S4.E4.m1.1.1.1.1.1.1.8.cmml">]</mo></mrow><mo id="S4.E4.m1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><eq id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2"></eq><apply id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.3.2">𝜌</ci><apply id="S4.E4.m1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.3.3"><times id="S4.E4.m1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.3.3.1"></times><ci id="S4.E4.m1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.3.3.2">𝑖</ci><ci id="S4.E4.m1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><times id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></times><apply id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.3">superscript</csymbol><ci id="S4.E4.m1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.3.2">𝑓</ci><ci id="S4.E4.m1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.3.3">𝜌</ci></apply><list id="S4.E4.m1.1.1.1.1.1.1.8.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7"><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2"><times id="S4.E4.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.1"></times><apply id="S4.E4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2"><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.1">^</ci><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.2.2">𝑣</ci></apply><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.2.3">T</ci></apply><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3">subscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.2"><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.1">^</ci><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.2.2">𝑣</ci></apply><ci id="S4.E4.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.3.2">𝑏</ci><ci id="S4.E4.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.4.4.cmml" xref="S4.E4.m1.1.1.1.1.1.1.4.4"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.4.4.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.4.4">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.4.4.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.4.4.2">𝑏</ci><ci id="S4.E4.m1.1.1.1.1.1.1.4.4.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.4.4.3">𝑗</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.5.5.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.5.5.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.5.5.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5.2">IoU</ci><apply id="S4.E4.m1.1.1.1.1.1.1.5.5.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3"><times id="S4.E4.m1.1.1.1.1.1.1.5.5.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.5.5.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.2">𝑖</ci><ci id="S4.E4.m1.1.1.1.1.1.1.5.5.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.5.5.3.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.1.6.6.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.6.6.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.6.6.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6.2">O</ci><apply id="S4.E4.m1.1.1.1.1.1.1.6.6.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3"><times id="S4.E4.m1.1.1.1.1.1.1.6.6.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.6.6.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.2">𝑖</ci><ci id="S4.E4.m1.1.1.1.1.1.1.6.6.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.6.6.3.3">𝑗</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.1.1.7.7.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.7.7.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.7.7.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7.2">O</ci><apply id="S4.E4.m1.1.1.1.1.1.1.7.7.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3"><times id="S4.E4.m1.1.1.1.1.1.1.7.7.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.1"></times><ci id="S4.E4.m1.1.1.1.1.1.1.7.7.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.2">𝑗</ci><ci id="S4.E4.m1.1.1.1.1.1.1.7.7.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.7.7.3.3">𝑖</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle\rho_{ij}={f}^{\rho}\left({\left[Wq,\hat{v}^{\rm T}_{i}\hat{v}_{j},b_{i},b_{j},{\rm IoU}_{ij},{\rm O}_{ij},{\rm O}_{ji}\right]}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.16" class="ltx_p">where <math id="S4.SS3.p2.16.m1.1" class="ltx_Math" alttext="{f}^{\rho}:x\in\mathbb{R}^{m}\Rightarrow\mathbb{R}" display="inline"><semantics id="S4.SS3.p2.16.m1.1a"><mrow id="S4.SS3.p2.16.m1.1.1" xref="S4.SS3.p2.16.m1.1.1.cmml"><msup id="S4.SS3.p2.16.m1.1.1.2" xref="S4.SS3.p2.16.m1.1.1.2.cmml"><mi id="S4.SS3.p2.16.m1.1.1.2.2" xref="S4.SS3.p2.16.m1.1.1.2.2.cmml">f</mi><mi id="S4.SS3.p2.16.m1.1.1.2.3" xref="S4.SS3.p2.16.m1.1.1.2.3.cmml">ρ</mi></msup><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p2.16.m1.1.1.1" xref="S4.SS3.p2.16.m1.1.1.1.cmml">:</mo><mrow id="S4.SS3.p2.16.m1.1.1.3" xref="S4.SS3.p2.16.m1.1.1.3.cmml"><mi id="S4.SS3.p2.16.m1.1.1.3.2" xref="S4.SS3.p2.16.m1.1.1.3.2.cmml">x</mi><mo id="S4.SS3.p2.16.m1.1.1.3.3" xref="S4.SS3.p2.16.m1.1.1.3.3.cmml">∈</mo><msup id="S4.SS3.p2.16.m1.1.1.3.4" xref="S4.SS3.p2.16.m1.1.1.3.4.cmml"><mi id="S4.SS3.p2.16.m1.1.1.3.4.2" xref="S4.SS3.p2.16.m1.1.1.3.4.2.cmml">ℝ</mi><mi id="S4.SS3.p2.16.m1.1.1.3.4.3" xref="S4.SS3.p2.16.m1.1.1.3.4.3.cmml">m</mi></msup><mo stretchy="false" id="S4.SS3.p2.16.m1.1.1.3.5" xref="S4.SS3.p2.16.m1.1.1.3.5.cmml">⇒</mo><mi id="S4.SS3.p2.16.m1.1.1.3.6" xref="S4.SS3.p2.16.m1.1.1.3.6.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.16.m1.1b"><apply id="S4.SS3.p2.16.m1.1.1.cmml" xref="S4.SS3.p2.16.m1.1.1"><ci id="S4.SS3.p2.16.m1.1.1.1.cmml" xref="S4.SS3.p2.16.m1.1.1.1">:</ci><apply id="S4.SS3.p2.16.m1.1.1.2.cmml" xref="S4.SS3.p2.16.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.16.m1.1.1.2.1.cmml" xref="S4.SS3.p2.16.m1.1.1.2">superscript</csymbol><ci id="S4.SS3.p2.16.m1.1.1.2.2.cmml" xref="S4.SS3.p2.16.m1.1.1.2.2">𝑓</ci><ci id="S4.SS3.p2.16.m1.1.1.2.3.cmml" xref="S4.SS3.p2.16.m1.1.1.2.3">𝜌</ci></apply><apply id="S4.SS3.p2.16.m1.1.1.3.cmml" xref="S4.SS3.p2.16.m1.1.1.3"><and id="S4.SS3.p2.16.m1.1.1.3a.cmml" xref="S4.SS3.p2.16.m1.1.1.3"></and><apply id="S4.SS3.p2.16.m1.1.1.3b.cmml" xref="S4.SS3.p2.16.m1.1.1.3"><in id="S4.SS3.p2.16.m1.1.1.3.3.cmml" xref="S4.SS3.p2.16.m1.1.1.3.3"></in><ci id="S4.SS3.p2.16.m1.1.1.3.2.cmml" xref="S4.SS3.p2.16.m1.1.1.3.2">𝑥</ci><apply id="S4.SS3.p2.16.m1.1.1.3.4.cmml" xref="S4.SS3.p2.16.m1.1.1.3.4"><csymbol cd="ambiguous" id="S4.SS3.p2.16.m1.1.1.3.4.1.cmml" xref="S4.SS3.p2.16.m1.1.1.3.4">superscript</csymbol><ci id="S4.SS3.p2.16.m1.1.1.3.4.2.cmml" xref="S4.SS3.p2.16.m1.1.1.3.4.2">ℝ</ci><ci id="S4.SS3.p2.16.m1.1.1.3.4.3.cmml" xref="S4.SS3.p2.16.m1.1.1.3.4.3">𝑚</ci></apply></apply><apply id="S4.SS3.p2.16.m1.1.1.3c.cmml" xref="S4.SS3.p2.16.m1.1.1.3"><ci id="S4.SS3.p2.16.m1.1.1.3.5.cmml" xref="S4.SS3.p2.16.m1.1.1.3.5">⇒</ci><share href="#S4.SS3.p2.16.m1.1.1.3.4.cmml" id="S4.SS3.p2.16.m1.1.1.3d.cmml" xref="S4.SS3.p2.16.m1.1.1.3"></share><ci id="S4.SS3.p2.16.m1.1.1.3.6.cmml" xref="S4.SS3.p2.16.m1.1.1.3.6">ℝ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.16.m1.1c">{f}^{\rho}:x\in\mathbb{R}^{m}\Rightarrow\mathbb{R}</annotation></semantics></math> is a 2-layer MLP with ReLU activations.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.2" class="ltx_p">For each step <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">t</annotation></semantics></math> of the counting sequence we greedily select the action with the highest value (interpreted as either selecting the next object to count or terminating), and update <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="\kappa" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">κ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><ci id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">𝜅</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">\kappa</annotation></semantics></math> accordingly:</p>
<table id="A4.EGx3" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.2" class="ltx_Math" alttext="\displaystyle a^{t}={\rm argmax}_{i}\;{\left[{\kappa^{t}},{\zeta}\right]}" display="inline"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><msup id="S4.E5.m1.2.2.3" xref="S4.E5.m1.2.2.3.cmml"><mi id="S4.E5.m1.2.2.3.2" xref="S4.E5.m1.2.2.3.2.cmml">a</mi><mi id="S4.E5.m1.2.2.3.3" xref="S4.E5.m1.2.2.3.3.cmml">t</mi></msup><mo id="S4.E5.m1.2.2.2" xref="S4.E5.m1.2.2.2.cmml">=</mo><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.cmml"><msub id="S4.E5.m1.2.2.1.3" xref="S4.E5.m1.2.2.1.3.cmml"><mi id="S4.E5.m1.2.2.1.3.2" xref="S4.E5.m1.2.2.1.3.2.cmml">argmax</mi><mi id="S4.E5.m1.2.2.1.3.3" xref="S4.E5.m1.2.2.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.2.cmml"><mo id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.cmml">[</mo><msup id="S4.E5.m1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.2.cmml">κ</mi><mi id="S4.E5.m1.2.2.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">ζ</mi><mo id="S4.E5.m1.2.2.1.1.1.4" xref="S4.E5.m1.2.2.1.1.2.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><eq id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2.2"></eq><apply id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.3.1.cmml" xref="S4.E5.m1.2.2.3">superscript</csymbol><ci id="S4.E5.m1.2.2.3.2.cmml" xref="S4.E5.m1.2.2.3.2">𝑎</ci><ci id="S4.E5.m1.2.2.3.3.cmml" xref="S4.E5.m1.2.2.3.3">𝑡</ci></apply><apply id="S4.E5.m1.2.2.1.cmml" xref="S4.E5.m1.2.2.1"><times id="S4.E5.m1.2.2.1.2.cmml" xref="S4.E5.m1.2.2.1.2"></times><apply id="S4.E5.m1.2.2.1.3.cmml" xref="S4.E5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.3.1.cmml" xref="S4.E5.m1.2.2.1.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.3.2.cmml" xref="S4.E5.m1.2.2.1.3.2">argmax</ci><ci id="S4.E5.m1.2.2.1.3.3.cmml" xref="S4.E5.m1.2.2.1.3.3">𝑖</ci></apply><interval closure="closed" id="S4.E5.m1.2.2.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1"><apply id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.2">𝜅</ci><ci id="S4.E5.m1.2.2.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.3">𝑡</ci></apply><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝜁</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\displaystyle a^{t}={\rm argmax}_{i}\;{\left[{\kappa^{t}},{\zeta}\right]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.2" class="ltx_Math" alttext="\displaystyle\kappa^{t+1}=\kappa^{t}+\rho(a^{t},\cdot)" display="inline"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><msup id="S4.E6.m1.2.2.3" xref="S4.E6.m1.2.2.3.cmml"><mi id="S4.E6.m1.2.2.3.2" xref="S4.E6.m1.2.2.3.2.cmml">κ</mi><mrow id="S4.E6.m1.2.2.3.3" xref="S4.E6.m1.2.2.3.3.cmml"><mi id="S4.E6.m1.2.2.3.3.2" xref="S4.E6.m1.2.2.3.3.2.cmml">t</mi><mo id="S4.E6.m1.2.2.3.3.1" xref="S4.E6.m1.2.2.3.3.1.cmml">+</mo><mn id="S4.E6.m1.2.2.3.3.3" xref="S4.E6.m1.2.2.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml">=</mo><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.cmml"><msup id="S4.E6.m1.2.2.1.3" xref="S4.E6.m1.2.2.1.3.cmml"><mi id="S4.E6.m1.2.2.1.3.2" xref="S4.E6.m1.2.2.1.3.2.cmml">κ</mi><mi id="S4.E6.m1.2.2.1.3.3" xref="S4.E6.m1.2.2.1.3.3.cmml">t</mi></msup><mo id="S4.E6.m1.2.2.1.2" xref="S4.E6.m1.2.2.1.2.cmml">+</mo><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.3" xref="S4.E6.m1.2.2.1.1.3.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.2" xref="S4.E6.m1.2.2.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.2.cmml">(</mo><msup id="S4.E6.m1.2.2.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.2.cmml">a</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.3.cmml">t</mi></msup><mo rspace="0em" id="S4.E6.m1.2.2.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.2.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.E6.m1.2.2.1.1.1.1.4" xref="S4.E6.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><eq id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"></eq><apply id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.3.1.cmml" xref="S4.E6.m1.2.2.3">superscript</csymbol><ci id="S4.E6.m1.2.2.3.2.cmml" xref="S4.E6.m1.2.2.3.2">𝜅</ci><apply id="S4.E6.m1.2.2.3.3.cmml" xref="S4.E6.m1.2.2.3.3"><plus id="S4.E6.m1.2.2.3.3.1.cmml" xref="S4.E6.m1.2.2.3.3.1"></plus><ci id="S4.E6.m1.2.2.3.3.2.cmml" xref="S4.E6.m1.2.2.3.3.2">𝑡</ci><cn type="integer" id="S4.E6.m1.2.2.3.3.3.cmml" xref="S4.E6.m1.2.2.3.3.3">1</cn></apply></apply><apply id="S4.E6.m1.2.2.1.cmml" xref="S4.E6.m1.2.2.1"><plus id="S4.E6.m1.2.2.1.2.cmml" xref="S4.E6.m1.2.2.1.2"></plus><apply id="S4.E6.m1.2.2.1.3.cmml" xref="S4.E6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.3.1.cmml" xref="S4.E6.m1.2.2.1.3">superscript</csymbol><ci id="S4.E6.m1.2.2.1.3.2.cmml" xref="S4.E6.m1.2.2.1.3.2">𝜅</ci><ci id="S4.E6.m1.2.2.1.3.3.cmml" xref="S4.E6.m1.2.2.1.3.3">𝑡</ci></apply><apply id="S4.E6.m1.2.2.1.1.cmml" xref="S4.E6.m1.2.2.1.1"><times id="S4.E6.m1.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2"></times><ci id="S4.E6.m1.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.3">𝜌</ci><interval closure="open" id="S4.E6.m1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1"><apply id="S4.E6.m1.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.2">𝑎</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">⋅</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\displaystyle\kappa^{t+1}=\kappa^{t}+\rho(a^{t},\cdot)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.10" class="ltx_p">where <math id="S4.SS3.p3.3.m1.1" class="ltx_Math" alttext="\zeta" display="inline"><semantics id="S4.SS3.p3.3.m1.1a"><mi id="S4.SS3.p3.3.m1.1.1" xref="S4.SS3.p3.3.m1.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m1.1b"><ci id="S4.SS3.p3.3.m1.1.1.cmml" xref="S4.SS3.p3.3.m1.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m1.1c">\zeta</annotation></semantics></math> is a learnable scalar representing the logit value of the terminal action, and <math id="S4.SS3.p3.4.m2.1" class="ltx_Math" alttext="\kappa^{0}" display="inline"><semantics id="S4.SS3.p3.4.m2.1a"><msup id="S4.SS3.p3.4.m2.1.1" xref="S4.SS3.p3.4.m2.1.1.cmml"><mi id="S4.SS3.p3.4.m2.1.1.2" xref="S4.SS3.p3.4.m2.1.1.2.cmml">κ</mi><mn id="S4.SS3.p3.4.m2.1.1.3" xref="S4.SS3.p3.4.m2.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m2.1b"><apply id="S4.SS3.p3.4.m2.1.1.cmml" xref="S4.SS3.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m2.1.1.1.cmml" xref="S4.SS3.p3.4.m2.1.1">superscript</csymbol><ci id="S4.SS3.p3.4.m2.1.1.2.cmml" xref="S4.SS3.p3.4.m2.1.1.2">𝜅</ci><cn type="integer" id="S4.SS3.p3.4.m2.1.1.3.cmml" xref="S4.SS3.p3.4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m2.1c">\kappa^{0}</annotation></semantics></math> is the result of Equation  <a href="#S4.E3" title="In 4.3 Counting ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (Fig. <a href="#S4.F3" title="Figure 3 ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>b, red box).
The action <math id="S4.SS3.p3.5.m3.1" class="ltx_Math" alttext="a^{t}" display="inline"><semantics id="S4.SS3.p3.5.m3.1a"><msup id="S4.SS3.p3.5.m3.1.1" xref="S4.SS3.p3.5.m3.1.1.cmml"><mi id="S4.SS3.p3.5.m3.1.1.2" xref="S4.SS3.p3.5.m3.1.1.2.cmml">a</mi><mi id="S4.SS3.p3.5.m3.1.1.3" xref="S4.SS3.p3.5.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m3.1b"><apply id="S4.SS3.p3.5.m3.1.1.cmml" xref="S4.SS3.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m3.1.1.1.cmml" xref="S4.SS3.p3.5.m3.1.1">superscript</csymbol><ci id="S4.SS3.p3.5.m3.1.1.2.cmml" xref="S4.SS3.p3.5.m3.1.1.2">𝑎</ci><ci id="S4.SS3.p3.5.m3.1.1.3.cmml" xref="S4.SS3.p3.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m3.1c">a^{t}</annotation></semantics></math> is expressed as the index of the selected object. <math id="S4.SS3.p3.6.m4.2" class="ltx_Math" alttext="\rho(a^{t},\cdot)" display="inline"><semantics id="S4.SS3.p3.6.m4.2a"><mrow id="S4.SS3.p3.6.m4.2.2" xref="S4.SS3.p3.6.m4.2.2.cmml"><mi id="S4.SS3.p3.6.m4.2.2.3" xref="S4.SS3.p3.6.m4.2.2.3.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m4.2.2.2" xref="S4.SS3.p3.6.m4.2.2.2.cmml">​</mo><mrow id="S4.SS3.p3.6.m4.2.2.1.1" xref="S4.SS3.p3.6.m4.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.6.m4.2.2.1.1.2" xref="S4.SS3.p3.6.m4.2.2.1.2.cmml">(</mo><msup id="S4.SS3.p3.6.m4.2.2.1.1.1" xref="S4.SS3.p3.6.m4.2.2.1.1.1.cmml"><mi id="S4.SS3.p3.6.m4.2.2.1.1.1.2" xref="S4.SS3.p3.6.m4.2.2.1.1.1.2.cmml">a</mi><mi id="S4.SS3.p3.6.m4.2.2.1.1.1.3" xref="S4.SS3.p3.6.m4.2.2.1.1.1.3.cmml">t</mi></msup><mo rspace="0em" id="S4.SS3.p3.6.m4.2.2.1.1.3" xref="S4.SS3.p3.6.m4.2.2.1.2.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m4.1.1" xref="S4.SS3.p3.6.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p3.6.m4.2.2.1.1.4" xref="S4.SS3.p3.6.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m4.2b"><apply id="S4.SS3.p3.6.m4.2.2.cmml" xref="S4.SS3.p3.6.m4.2.2"><times id="S4.SS3.p3.6.m4.2.2.2.cmml" xref="S4.SS3.p3.6.m4.2.2.2"></times><ci id="S4.SS3.p3.6.m4.2.2.3.cmml" xref="S4.SS3.p3.6.m4.2.2.3">𝜌</ci><interval closure="open" id="S4.SS3.p3.6.m4.2.2.1.2.cmml" xref="S4.SS3.p3.6.m4.2.2.1.1"><apply id="S4.SS3.p3.6.m4.2.2.1.1.1.cmml" xref="S4.SS3.p3.6.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m4.2.2.1.1.1.1.cmml" xref="S4.SS3.p3.6.m4.2.2.1.1.1">superscript</csymbol><ci id="S4.SS3.p3.6.m4.2.2.1.1.1.2.cmml" xref="S4.SS3.p3.6.m4.2.2.1.1.1.2">𝑎</ci><ci id="S4.SS3.p3.6.m4.2.2.1.1.1.3.cmml" xref="S4.SS3.p3.6.m4.2.2.1.1.1.3">𝑡</ci></apply><ci id="S4.SS3.p3.6.m4.1.1.cmml" xref="S4.SS3.p3.6.m4.1.1">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m4.2c">\rho(a^{t},\cdot)</annotation></semantics></math> denotes the row of <math id="S4.SS3.p3.7.m5.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS3.p3.7.m5.1a"><mi id="S4.SS3.p3.7.m5.1.1" xref="S4.SS3.p3.7.m5.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m5.1b"><ci id="S4.SS3.p3.7.m5.1.1.cmml" xref="S4.SS3.p3.7.m5.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m5.1c">\rho</annotation></semantics></math> indexed by <math id="S4.SS3.p3.8.m6.1" class="ltx_Math" alttext="a^{t}" display="inline"><semantics id="S4.SS3.p3.8.m6.1a"><msup id="S4.SS3.p3.8.m6.1.1" xref="S4.SS3.p3.8.m6.1.1.cmml"><mi id="S4.SS3.p3.8.m6.1.1.2" xref="S4.SS3.p3.8.m6.1.1.2.cmml">a</mi><mi id="S4.SS3.p3.8.m6.1.1.3" xref="S4.SS3.p3.8.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.8.m6.1b"><apply id="S4.SS3.p3.8.m6.1.1.cmml" xref="S4.SS3.p3.8.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.8.m6.1.1.1.cmml" xref="S4.SS3.p3.8.m6.1.1">superscript</csymbol><ci id="S4.SS3.p3.8.m6.1.1.2.cmml" xref="S4.SS3.p3.8.m6.1.1.2">𝑎</ci><ci id="S4.SS3.p3.8.m6.1.1.3.cmml" xref="S4.SS3.p3.8.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.8.m6.1c">a^{t}</annotation></semantics></math>.
Each object is only allowed to be counted once.
We define the count <math id="S4.SS3.p3.9.m7.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS3.p3.9.m7.1a"><mi id="S4.SS3.p3.9.m7.1.1" xref="S4.SS3.p3.9.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.9.m7.1b"><ci id="S4.SS3.p3.9.m7.1.1.cmml" xref="S4.SS3.p3.9.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.9.m7.1c">C</annotation></semantics></math> as the timestep when the terminal action was selected <math id="S4.SS3.p3.10.m8.1" class="ltx_Math" alttext="t:a^{t}=N+1" display="inline"><semantics id="S4.SS3.p3.10.m8.1a"><mrow id="S4.SS3.p3.10.m8.1.1" xref="S4.SS3.p3.10.m8.1.1.cmml"><mi id="S4.SS3.p3.10.m8.1.1.2" xref="S4.SS3.p3.10.m8.1.1.2.cmml">t</mi><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.10.m8.1.1.1" xref="S4.SS3.p3.10.m8.1.1.1.cmml">:</mo><mrow id="S4.SS3.p3.10.m8.1.1.3" xref="S4.SS3.p3.10.m8.1.1.3.cmml"><msup id="S4.SS3.p3.10.m8.1.1.3.2" xref="S4.SS3.p3.10.m8.1.1.3.2.cmml"><mi id="S4.SS3.p3.10.m8.1.1.3.2.2" xref="S4.SS3.p3.10.m8.1.1.3.2.2.cmml">a</mi><mi id="S4.SS3.p3.10.m8.1.1.3.2.3" xref="S4.SS3.p3.10.m8.1.1.3.2.3.cmml">t</mi></msup><mo id="S4.SS3.p3.10.m8.1.1.3.1" xref="S4.SS3.p3.10.m8.1.1.3.1.cmml">=</mo><mrow id="S4.SS3.p3.10.m8.1.1.3.3" xref="S4.SS3.p3.10.m8.1.1.3.3.cmml"><mi id="S4.SS3.p3.10.m8.1.1.3.3.2" xref="S4.SS3.p3.10.m8.1.1.3.3.2.cmml">N</mi><mo id="S4.SS3.p3.10.m8.1.1.3.3.1" xref="S4.SS3.p3.10.m8.1.1.3.3.1.cmml">+</mo><mn id="S4.SS3.p3.10.m8.1.1.3.3.3" xref="S4.SS3.p3.10.m8.1.1.3.3.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.10.m8.1b"><apply id="S4.SS3.p3.10.m8.1.1.cmml" xref="S4.SS3.p3.10.m8.1.1"><ci id="S4.SS3.p3.10.m8.1.1.1.cmml" xref="S4.SS3.p3.10.m8.1.1.1">:</ci><ci id="S4.SS3.p3.10.m8.1.1.2.cmml" xref="S4.SS3.p3.10.m8.1.1.2">𝑡</ci><apply id="S4.SS3.p3.10.m8.1.1.3.cmml" xref="S4.SS3.p3.10.m8.1.1.3"><eq id="S4.SS3.p3.10.m8.1.1.3.1.cmml" xref="S4.SS3.p3.10.m8.1.1.3.1"></eq><apply id="S4.SS3.p3.10.m8.1.1.3.2.cmml" xref="S4.SS3.p3.10.m8.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p3.10.m8.1.1.3.2.1.cmml" xref="S4.SS3.p3.10.m8.1.1.3.2">superscript</csymbol><ci id="S4.SS3.p3.10.m8.1.1.3.2.2.cmml" xref="S4.SS3.p3.10.m8.1.1.3.2.2">𝑎</ci><ci id="S4.SS3.p3.10.m8.1.1.3.2.3.cmml" xref="S4.SS3.p3.10.m8.1.1.3.2.3">𝑡</ci></apply><apply id="S4.SS3.p3.10.m8.1.1.3.3.cmml" xref="S4.SS3.p3.10.m8.1.1.3.3"><plus id="S4.SS3.p3.10.m8.1.1.3.3.1.cmml" xref="S4.SS3.p3.10.m8.1.1.3.3.1"></plus><ci id="S4.SS3.p3.10.m8.1.1.3.3.2.cmml" xref="S4.SS3.p3.10.m8.1.1.3.3.2">𝑁</ci><cn type="integer" id="S4.SS3.p3.10.m8.1.1.3.3.3.cmml" xref="S4.SS3.p3.10.m8.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.10.m8.1c">t:a^{t}=N+1</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p">This approach bears some similarity to Non-Maximal Suppression (NMS), a staple technique in object detection to suppress redundant proposals.
However, our approach is far less rigid and allows the question to determine how similar and/or overlapping objects interact.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1712.08697/assets/figures/v2_examples.jpg" id="S4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="151" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>
Grounded counts produced by IRLC. Counts are formed from selections of detected objects. Each image displays the objects that IRLC chose to count.
</figcaption>
</figure>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.2" class="ltx_p"><span id="S4.SS3.p5.2.1" class="ltx_text ltx_font_bold">Training IRLC.</span> Because the process of generating a count requires making discrete decisions, training requires that we use techniques from Reinforcement Learning.
Given our formulation, a natural choice is to apply REINFORCE <cite class="ltx_cite ltx_citemacro_citep">(Williams, <a href="#bib.bib40" title="" class="ltx_ref">1992</a>)</cite>.
To do so, we calculate a distribution over action probabilities <math id="S4.SS3.p5.1.m1.1" class="ltx_Math" alttext="p^{t}" display="inline"><semantics id="S4.SS3.p5.1.m1.1a"><msup id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">p</mi><mi id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝑝</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">p^{t}</annotation></semantics></math> from <math id="S4.SS3.p5.2.m2.1" class="ltx_Math" alttext="\kappa^{t}" display="inline"><semantics id="S4.SS3.p5.2.m2.1a"><msup id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml"><mi id="S4.SS3.p5.2.m2.1.1.2" xref="S4.SS3.p5.2.m2.1.1.2.cmml">κ</mi><mi id="S4.SS3.p5.2.m2.1.1.3" xref="S4.SS3.p5.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><apply id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.2.m2.1.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p5.2.m2.1.1.2.cmml" xref="S4.SS3.p5.2.m2.1.1.2">𝜅</ci><ci id="S4.SS3.p5.2.m2.1.1.3.cmml" xref="S4.SS3.p5.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">\kappa^{t}</annotation></semantics></math> and generate a count by iteratively sampling actions from the distribution:</p>
<table id="A4.EGx4" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7.m1.2" class="ltx_Math" alttext="\displaystyle p^{t}={\rm softmax}\left(\left[{\kappa^{t}},{\zeta}\right]\right)\;" display="inline"><semantics id="S4.E7.m1.2a"><mrow id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml"><msup id="S4.E7.m1.2.2.3" xref="S4.E7.m1.2.2.3.cmml"><mi id="S4.E7.m1.2.2.3.2" xref="S4.E7.m1.2.2.3.2.cmml">p</mi><mi id="S4.E7.m1.2.2.3.3" xref="S4.E7.m1.2.2.3.3.cmml">t</mi></msup><mo id="S4.E7.m1.2.2.2" xref="S4.E7.m1.2.2.2.cmml">=</mo><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.cmml"><mi id="S4.E7.m1.2.2.1.3" xref="S4.E7.m1.2.2.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.cmml"><mo id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.cmml">(</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.2.cmml"><mo id="S4.E7.m1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.2.cmml">[</mo><msup id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2.cmml">κ</mi><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.E7.m1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">ζ</mi><mo id="S4.E7.m1.2.2.1.1.1.1.1.4" xref="S4.E7.m1.2.2.1.1.1.1.2.cmml">]</mo></mrow><mo id="S4.E7.m1.2.2.1.1.1.3" xref="S4.E7.m1.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.2b"><apply id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2"><eq id="S4.E7.m1.2.2.2.cmml" xref="S4.E7.m1.2.2.2"></eq><apply id="S4.E7.m1.2.2.3.cmml" xref="S4.E7.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.3.1.cmml" xref="S4.E7.m1.2.2.3">superscript</csymbol><ci id="S4.E7.m1.2.2.3.2.cmml" xref="S4.E7.m1.2.2.3.2">𝑝</ci><ci id="S4.E7.m1.2.2.3.3.cmml" xref="S4.E7.m1.2.2.3.3">𝑡</ci></apply><apply id="S4.E7.m1.2.2.1.cmml" xref="S4.E7.m1.2.2.1"><times id="S4.E7.m1.2.2.1.2.cmml" xref="S4.E7.m1.2.2.1.2"></times><ci id="S4.E7.m1.2.2.1.3.cmml" xref="S4.E7.m1.2.2.1.3">softmax</ci><interval closure="closed" id="S4.E7.m1.2.2.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1"><apply id="S4.E7.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2">𝜅</ci><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝜁</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.2c">\displaystyle p^{t}={\rm softmax}\left(\left[{\kappa^{t}},{\zeta}\right]\right)\;</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E7.m2.1" class="ltx_Math" alttext="\displaystyle\;\;\;a^{t}\sim p^{t}" display="inline"><semantics id="S4.E7.m2.1a"><mrow id="S4.E7.m2.1.1" xref="S4.E7.m2.1.1.cmml"><msup id="S4.E7.m2.1.1.2" xref="S4.E7.m2.1.1.2.cmml"><mi id="S4.E7.m2.1.1.2.2" xref="S4.E7.m2.1.1.2.2.cmml">a</mi><mi id="S4.E7.m2.1.1.2.3" xref="S4.E7.m2.1.1.2.3.cmml">t</mi></msup><mo id="S4.E7.m2.1.1.1" xref="S4.E7.m2.1.1.1.cmml">∼</mo><msup id="S4.E7.m2.1.1.3" xref="S4.E7.m2.1.1.3.cmml"><mi id="S4.E7.m2.1.1.3.2" xref="S4.E7.m2.1.1.3.2.cmml">p</mi><mi id="S4.E7.m2.1.1.3.3" xref="S4.E7.m2.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m2.1b"><apply id="S4.E7.m2.1.1.cmml" xref="S4.E7.m2.1.1"><csymbol cd="latexml" id="S4.E7.m2.1.1.1.cmml" xref="S4.E7.m2.1.1.1">similar-to</csymbol><apply id="S4.E7.m2.1.1.2.cmml" xref="S4.E7.m2.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m2.1.1.2.1.cmml" xref="S4.E7.m2.1.1.2">superscript</csymbol><ci id="S4.E7.m2.1.1.2.2.cmml" xref="S4.E7.m2.1.1.2.2">𝑎</ci><ci id="S4.E7.m2.1.1.2.3.cmml" xref="S4.E7.m2.1.1.2.3">𝑡</ci></apply><apply id="S4.E7.m2.1.1.3.cmml" xref="S4.E7.m2.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m2.1.1.3.1.cmml" xref="S4.E7.m2.1.1.3">superscript</csymbol><ci id="S4.E7.m2.1.1.3.2.cmml" xref="S4.E7.m2.1.1.3.2">𝑝</ci><ci id="S4.E7.m2.1.1.3.3.cmml" xref="S4.E7.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m2.1c">\displaystyle\;\;\;a^{t}\sim p^{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.2" class="ltx_Math" alttext="\displaystyle\kappa^{t+1}=\kappa^{t}+\rho(a^{t},\cdot)" display="inline"><semantics id="S4.E8.m1.2a"><mrow id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml"><msup id="S4.E8.m1.2.2.3" xref="S4.E8.m1.2.2.3.cmml"><mi id="S4.E8.m1.2.2.3.2" xref="S4.E8.m1.2.2.3.2.cmml">κ</mi><mrow id="S4.E8.m1.2.2.3.3" xref="S4.E8.m1.2.2.3.3.cmml"><mi id="S4.E8.m1.2.2.3.3.2" xref="S4.E8.m1.2.2.3.3.2.cmml">t</mi><mo id="S4.E8.m1.2.2.3.3.1" xref="S4.E8.m1.2.2.3.3.1.cmml">+</mo><mn id="S4.E8.m1.2.2.3.3.3" xref="S4.E8.m1.2.2.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.E8.m1.2.2.2" xref="S4.E8.m1.2.2.2.cmml">=</mo><mrow id="S4.E8.m1.2.2.1" xref="S4.E8.m1.2.2.1.cmml"><msup id="S4.E8.m1.2.2.1.3" xref="S4.E8.m1.2.2.1.3.cmml"><mi id="S4.E8.m1.2.2.1.3.2" xref="S4.E8.m1.2.2.1.3.2.cmml">κ</mi><mi id="S4.E8.m1.2.2.1.3.3" xref="S4.E8.m1.2.2.1.3.3.cmml">t</mi></msup><mo id="S4.E8.m1.2.2.1.2" xref="S4.E8.m1.2.2.1.2.cmml">+</mo><mrow id="S4.E8.m1.2.2.1.1" xref="S4.E8.m1.2.2.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.3" xref="S4.E8.m1.2.2.1.1.3.cmml">ρ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.1.1.2" xref="S4.E8.m1.2.2.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.2.2.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.2.2.1.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.2.cmml">(</mo><msup id="S4.E8.m1.2.2.1.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.1.1.2.cmml">a</mi><mi id="S4.E8.m1.2.2.1.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.1.1.3.cmml">t</mi></msup><mo rspace="0em" id="S4.E8.m1.2.2.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.2.cmml">,</mo><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.E8.m1.2.2.1.1.1.1.4" xref="S4.E8.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.2b"><apply id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2"><eq id="S4.E8.m1.2.2.2.cmml" xref="S4.E8.m1.2.2.2"></eq><apply id="S4.E8.m1.2.2.3.cmml" xref="S4.E8.m1.2.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.3.1.cmml" xref="S4.E8.m1.2.2.3">superscript</csymbol><ci id="S4.E8.m1.2.2.3.2.cmml" xref="S4.E8.m1.2.2.3.2">𝜅</ci><apply id="S4.E8.m1.2.2.3.3.cmml" xref="S4.E8.m1.2.2.3.3"><plus id="S4.E8.m1.2.2.3.3.1.cmml" xref="S4.E8.m1.2.2.3.3.1"></plus><ci id="S4.E8.m1.2.2.3.3.2.cmml" xref="S4.E8.m1.2.2.3.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.2.2.3.3.3.cmml" xref="S4.E8.m1.2.2.3.3.3">1</cn></apply></apply><apply id="S4.E8.m1.2.2.1.cmml" xref="S4.E8.m1.2.2.1"><plus id="S4.E8.m1.2.2.1.2.cmml" xref="S4.E8.m1.2.2.1.2"></plus><apply id="S4.E8.m1.2.2.1.3.cmml" xref="S4.E8.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.3.1.cmml" xref="S4.E8.m1.2.2.1.3">superscript</csymbol><ci id="S4.E8.m1.2.2.1.3.2.cmml" xref="S4.E8.m1.2.2.1.3.2">𝜅</ci><ci id="S4.E8.m1.2.2.1.3.3.cmml" xref="S4.E8.m1.2.2.1.3.3">𝑡</ci></apply><apply id="S4.E8.m1.2.2.1.1.cmml" xref="S4.E8.m1.2.2.1.1"><times id="S4.E8.m1.2.2.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.2"></times><ci id="S4.E8.m1.2.2.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.3">𝜌</ci><interval closure="open" id="S4.E8.m1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1"><apply id="S4.E8.m1.2.2.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.2">𝑎</ci><ci id="S4.E8.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">⋅</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.2c">\displaystyle\kappa^{t+1}=\kappa^{t}+\rho(a^{t},\cdot)</annotation></semantics></math></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p5.5" class="ltx_p">We calculate the reward using Self-Critical Sequence training <cite class="ltx_cite ltx_citemacro_citep">(Rennie et al., <a href="#bib.bib33" title="" class="ltx_ref">2017</a>; Anderson et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>; Paulus et al., <a href="#bib.bib28" title="" class="ltx_ref">2017</a>)</cite>, a variation of policy gradient.
We define <math id="S4.SS3.p5.3.m1.1" class="ltx_Math" alttext="E=|C-C^{\rm GT}|" display="inline"><semantics id="S4.SS3.p5.3.m1.1a"><mrow id="S4.SS3.p5.3.m1.1.1" xref="S4.SS3.p5.3.m1.1.1.cmml"><mi id="S4.SS3.p5.3.m1.1.1.3" xref="S4.SS3.p5.3.m1.1.1.3.cmml">E</mi><mo id="S4.SS3.p5.3.m1.1.1.2" xref="S4.SS3.p5.3.m1.1.1.2.cmml">=</mo><mrow id="S4.SS3.p5.3.m1.1.1.1.1" xref="S4.SS3.p5.3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p5.3.m1.1.1.1.1.2" xref="S4.SS3.p5.3.m1.1.1.1.2.1.cmml">|</mo><mrow id="S4.SS3.p5.3.m1.1.1.1.1.1" xref="S4.SS3.p5.3.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.p5.3.m1.1.1.1.1.1.2" xref="S4.SS3.p5.3.m1.1.1.1.1.1.2.cmml">C</mi><mo id="S4.SS3.p5.3.m1.1.1.1.1.1.1" xref="S4.SS3.p5.3.m1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.SS3.p5.3.m1.1.1.1.1.1.3" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3.cmml"><mi id="S4.SS3.p5.3.m1.1.1.1.1.1.3.2" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3.2.cmml">C</mi><mi id="S4.SS3.p5.3.m1.1.1.1.1.1.3.3" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3.3.cmml">GT</mi></msup></mrow><mo stretchy="false" id="S4.SS3.p5.3.m1.1.1.1.1.3" xref="S4.SS3.p5.3.m1.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m1.1b"><apply id="S4.SS3.p5.3.m1.1.1.cmml" xref="S4.SS3.p5.3.m1.1.1"><eq id="S4.SS3.p5.3.m1.1.1.2.cmml" xref="S4.SS3.p5.3.m1.1.1.2"></eq><ci id="S4.SS3.p5.3.m1.1.1.3.cmml" xref="S4.SS3.p5.3.m1.1.1.3">𝐸</ci><apply id="S4.SS3.p5.3.m1.1.1.1.2.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1"><abs id="S4.SS3.p5.3.m1.1.1.1.2.1.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.2"></abs><apply id="S4.SS3.p5.3.m1.1.1.1.1.1.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1"><minus id="S4.SS3.p5.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1.1"></minus><ci id="S4.SS3.p5.3.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1.2">𝐶</ci><apply id="S4.SS3.p5.3.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS3.p5.3.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3.2">𝐶</ci><ci id="S4.SS3.p5.3.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.p5.3.m1.1.1.1.1.1.3.3">GT</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m1.1c">E=|C-C^{\rm GT}|</annotation></semantics></math> to be the count error and define the reward as <math id="S4.SS3.p5.4.m2.1" class="ltx_Math" alttext="R=E^{\rm greedy}-E" display="inline"><semantics id="S4.SS3.p5.4.m2.1a"><mrow id="S4.SS3.p5.4.m2.1.1" xref="S4.SS3.p5.4.m2.1.1.cmml"><mi id="S4.SS3.p5.4.m2.1.1.2" xref="S4.SS3.p5.4.m2.1.1.2.cmml">R</mi><mo id="S4.SS3.p5.4.m2.1.1.1" xref="S4.SS3.p5.4.m2.1.1.1.cmml">=</mo><mrow id="S4.SS3.p5.4.m2.1.1.3" xref="S4.SS3.p5.4.m2.1.1.3.cmml"><msup id="S4.SS3.p5.4.m2.1.1.3.2" xref="S4.SS3.p5.4.m2.1.1.3.2.cmml"><mi id="S4.SS3.p5.4.m2.1.1.3.2.2" xref="S4.SS3.p5.4.m2.1.1.3.2.2.cmml">E</mi><mi id="S4.SS3.p5.4.m2.1.1.3.2.3" xref="S4.SS3.p5.4.m2.1.1.3.2.3.cmml">greedy</mi></msup><mo id="S4.SS3.p5.4.m2.1.1.3.1" xref="S4.SS3.p5.4.m2.1.1.3.1.cmml">−</mo><mi id="S4.SS3.p5.4.m2.1.1.3.3" xref="S4.SS3.p5.4.m2.1.1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.4.m2.1b"><apply id="S4.SS3.p5.4.m2.1.1.cmml" xref="S4.SS3.p5.4.m2.1.1"><eq id="S4.SS3.p5.4.m2.1.1.1.cmml" xref="S4.SS3.p5.4.m2.1.1.1"></eq><ci id="S4.SS3.p5.4.m2.1.1.2.cmml" xref="S4.SS3.p5.4.m2.1.1.2">𝑅</ci><apply id="S4.SS3.p5.4.m2.1.1.3.cmml" xref="S4.SS3.p5.4.m2.1.1.3"><minus id="S4.SS3.p5.4.m2.1.1.3.1.cmml" xref="S4.SS3.p5.4.m2.1.1.3.1"></minus><apply id="S4.SS3.p5.4.m2.1.1.3.2.cmml" xref="S4.SS3.p5.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS3.p5.4.m2.1.1.3.2.1.cmml" xref="S4.SS3.p5.4.m2.1.1.3.2">superscript</csymbol><ci id="S4.SS3.p5.4.m2.1.1.3.2.2.cmml" xref="S4.SS3.p5.4.m2.1.1.3.2.2">𝐸</ci><ci id="S4.SS3.p5.4.m2.1.1.3.2.3.cmml" xref="S4.SS3.p5.4.m2.1.1.3.2.3">greedy</ci></apply><ci id="S4.SS3.p5.4.m2.1.1.3.3.cmml" xref="S4.SS3.p5.4.m2.1.1.3.3">𝐸</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.4.m2.1c">R=E^{\rm greedy}-E</annotation></semantics></math>, where <math id="S4.SS3.p5.5.m3.1" class="ltx_Math" alttext="E^{\rm greedy}" display="inline"><semantics id="S4.SS3.p5.5.m3.1a"><msup id="S4.SS3.p5.5.m3.1.1" xref="S4.SS3.p5.5.m3.1.1.cmml"><mi id="S4.SS3.p5.5.m3.1.1.2" xref="S4.SS3.p5.5.m3.1.1.2.cmml">E</mi><mi id="S4.SS3.p5.5.m3.1.1.3" xref="S4.SS3.p5.5.m3.1.1.3.cmml">greedy</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.5.m3.1b"><apply id="S4.SS3.p5.5.m3.1.1.cmml" xref="S4.SS3.p5.5.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.5.m3.1.1.1.cmml" xref="S4.SS3.p5.5.m3.1.1">superscript</csymbol><ci id="S4.SS3.p5.5.m3.1.1.2.cmml" xref="S4.SS3.p5.5.m3.1.1.2">𝐸</ci><ci id="S4.SS3.p5.5.m3.1.1.3.cmml" xref="S4.SS3.p5.5.m3.1.1.3">greedy</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.5.m3.1c">E^{\rm greedy}</annotation></semantics></math> is the baseline count error obtained by greedy action selection (which is also how the count is measured at test time).
From this, we define our (unnormalized) counting loss as</p>
<table id="A4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\displaystyle\tilde{L}_{C}=-R\sum_{t}{\rm log}\;p^{t}\left(a^{t}\right)" display="inline"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><msub id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml"><mover accent="true" id="S4.E9.m1.1.1.3.2" xref="S4.E9.m1.1.1.3.2.cmml"><mi id="S4.E9.m1.1.1.3.2.2" xref="S4.E9.m1.1.1.3.2.2.cmml">L</mi><mo id="S4.E9.m1.1.1.3.2.1" xref="S4.E9.m1.1.1.3.2.1.cmml">~</mo></mover><mi id="S4.E9.m1.1.1.3.3" xref="S4.E9.m1.1.1.3.3.cmml">C</mi></msub><mo id="S4.E9.m1.1.1.2" xref="S4.E9.m1.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1a" xref="S4.E9.m1.1.1.1.cmml">−</mo><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.2.cmml"><munder id="S4.E9.m1.1.1.1.1.1.2a" xref="S4.E9.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E9.m1.1.1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S4.E9.m1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.2.3.cmml">t</mi></munder></mstyle><mrow id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml">log</mi><mo lspace="0.280em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S4.E9.m1.1.1.1.1.1.1.4" xref="S4.E9.m1.1.1.1.1.1.1.4.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.4.2" xref="S4.E9.m1.1.1.1.1.1.1.4.2.cmml">p</mi><mi id="S4.E9.m1.1.1.1.1.1.1.4.3" xref="S4.E9.m1.1.1.1.1.1.1.4.3.cmml">t</mi></msup><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.2a" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><eq id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1.2"></eq><apply id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.3">subscript</csymbol><apply id="S4.E9.m1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.3.2"><ci id="S4.E9.m1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.3.2.1">~</ci><ci id="S4.E9.m1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.3.2.2">𝐿</ci></apply><ci id="S4.E9.m1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.3.3">𝐶</ci></apply><apply id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><minus id="S4.E9.m1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1"></minus><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1"><times id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"></times><ci id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3">𝑅</ci><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><apply id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2.2"></sum><ci id="S4.E9.m1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><times id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"></times><ci id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3">log</ci><apply id="S4.E9.m1.1.1.1.1.1.1.4.cmml" xref="S4.E9.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.4.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.4.2">𝑝</ci><ci id="S4.E9.m1.1.1.1.1.1.1.4.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\displaystyle\tilde{L}_{C}=-R\sum_{t}{\rm log}\;p^{t}\left(a^{t}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p6" class="ltx_para ltx_noindent">
<p id="S4.SS3.p6.1" class="ltx_p">Additionally, we include two auxiliary objectives to aid learning.
For each sampled sequence, we measure the total negative policy entropy <math id="S4.SS3.p6.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.SS3.p6.1.m1.1a"><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">H</annotation></semantics></math> across the observed time steps.
We also measure the average interaction strength at each time step and collect the total</p>
<table id="A4.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E10.m1.3" class="ltx_Math" alttext="\displaystyle\tilde{P}_{\rm H}=-\sum_{t}H\left(p^{t}\right)\qquad\tilde{P}_{\rm I}=\sum_{i\in\{a^{0}...a^{t}\}}\frac{1}{N}\sum_{j}L_{1}\left(\rho_{ij}\right)" display="inline"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3.2" xref="S4.E10.m1.3.3.3.cmml"><mrow id="S4.E10.m1.2.2.1.1" xref="S4.E10.m1.2.2.1.1.cmml"><msub id="S4.E10.m1.2.2.1.1.3" xref="S4.E10.m1.2.2.1.1.3.cmml"><mover accent="true" id="S4.E10.m1.2.2.1.1.3.2" xref="S4.E10.m1.2.2.1.1.3.2.cmml"><mi id="S4.E10.m1.2.2.1.1.3.2.2" xref="S4.E10.m1.2.2.1.1.3.2.2.cmml">P</mi><mo id="S4.E10.m1.2.2.1.1.3.2.1" xref="S4.E10.m1.2.2.1.1.3.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.E10.m1.2.2.1.1.3.3" xref="S4.E10.m1.2.2.1.1.3.3.cmml">H</mi></msub><mo id="S4.E10.m1.2.2.1.1.2" xref="S4.E10.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.2.2.1.1.1" xref="S4.E10.m1.2.2.1.1.1.cmml"><mo id="S4.E10.m1.2.2.1.1.1a" xref="S4.E10.m1.2.2.1.1.1.cmml">−</mo><mrow id="S4.E10.m1.2.2.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E10.m1.2.2.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.2.cmml"><munder id="S4.E10.m1.2.2.1.1.1.1.2a" xref="S4.E10.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E10.m1.2.2.1.1.1.1.2.2" xref="S4.E10.m1.2.2.1.1.1.1.2.2.cmml">∑</mo><mi id="S4.E10.m1.2.2.1.1.1.1.2.3" xref="S4.E10.m1.2.2.1.1.1.1.2.3.cmml">t</mi></munder></mstyle><mrow id="S4.E10.m1.2.2.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.2.2.1.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S4.E10.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mspace width="2em" id="S4.E10.m1.3.3.2.3" xref="S4.E10.m1.3.3.3a.cmml"></mspace><mrow id="S4.E10.m1.3.3.2.2" xref="S4.E10.m1.3.3.2.2.cmml"><msub id="S4.E10.m1.3.3.2.2.3" xref="S4.E10.m1.3.3.2.2.3.cmml"><mover accent="true" id="S4.E10.m1.3.3.2.2.3.2" xref="S4.E10.m1.3.3.2.2.3.2.cmml"><mi id="S4.E10.m1.3.3.2.2.3.2.2" xref="S4.E10.m1.3.3.2.2.3.2.2.cmml">P</mi><mo id="S4.E10.m1.3.3.2.2.3.2.1" xref="S4.E10.m1.3.3.2.2.3.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.E10.m1.3.3.2.2.3.3" xref="S4.E10.m1.3.3.2.2.3.3.cmml">I</mi></msub><mo id="S4.E10.m1.3.3.2.2.2" xref="S4.E10.m1.3.3.2.2.2.cmml">=</mo><mrow id="S4.E10.m1.3.3.2.2.1" xref="S4.E10.m1.3.3.2.2.1.cmml"><mstyle displaystyle="true" id="S4.E10.m1.3.3.2.2.1.2" xref="S4.E10.m1.3.3.2.2.1.2.cmml"><munder id="S4.E10.m1.3.3.2.2.1.2a" xref="S4.E10.m1.3.3.2.2.1.2.cmml"><mo movablelimits="false" id="S4.E10.m1.3.3.2.2.1.2.2" xref="S4.E10.m1.3.3.2.2.1.2.2.cmml">∑</mo><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.cmml"><mi id="S4.E10.m1.1.1.1.3" xref="S4.E10.m1.1.1.1.3.cmml">i</mi><mo id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.2.cmml">∈</mo><mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.2.cmml">{</mo><mrow id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><msup id="S4.E10.m1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.2.2" xref="S4.E10.m1.1.1.1.1.1.1.2.2.cmml">a</mi><mn id="S4.E10.m1.1.1.1.1.1.1.2.3" xref="S4.E10.m1.1.1.1.1.1.1.2.3.cmml">0</mn></msup><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml">…</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.1a" xref="S4.E10.m1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S4.E10.m1.1.1.1.1.1.1.4" xref="S4.E10.m1.1.1.1.1.1.1.4.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.4.2" xref="S4.E10.m1.1.1.1.1.1.1.4.2.cmml">a</mi><mi id="S4.E10.m1.1.1.1.1.1.1.4.3" xref="S4.E10.m1.1.1.1.1.1.1.4.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.2.cmml">}</mo></mrow></mrow></munder></mstyle><mrow id="S4.E10.m1.3.3.2.2.1.1" xref="S4.E10.m1.3.3.2.2.1.1.cmml"><mstyle displaystyle="true" id="S4.E10.m1.3.3.2.2.1.1.3" xref="S4.E10.m1.3.3.2.2.1.1.3.cmml"><mfrac id="S4.E10.m1.3.3.2.2.1.1.3a" xref="S4.E10.m1.3.3.2.2.1.1.3.cmml"><mn id="S4.E10.m1.3.3.2.2.1.1.3.2" xref="S4.E10.m1.3.3.2.2.1.1.3.2.cmml">1</mn><mi id="S4.E10.m1.3.3.2.2.1.1.3.3" xref="S4.E10.m1.3.3.2.2.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.2.2.1.1.2" xref="S4.E10.m1.3.3.2.2.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.3.3.2.2.1.1.1" xref="S4.E10.m1.3.3.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E10.m1.3.3.2.2.1.1.1.2" xref="S4.E10.m1.3.3.2.2.1.1.1.2.cmml"><munder id="S4.E10.m1.3.3.2.2.1.1.1.2a" xref="S4.E10.m1.3.3.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E10.m1.3.3.2.2.1.1.1.2.2" xref="S4.E10.m1.3.3.2.2.1.1.1.2.2.cmml">∑</mo><mi id="S4.E10.m1.3.3.2.2.1.1.1.2.3" xref="S4.E10.m1.3.3.2.2.1.1.1.2.3.cmml">j</mi></munder></mstyle><mrow id="S4.E10.m1.3.3.2.2.1.1.1.1" xref="S4.E10.m1.3.3.2.2.1.1.1.1.cmml"><msub id="S4.E10.m1.3.3.2.2.1.1.1.1.3" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3.cmml"><mi id="S4.E10.m1.3.3.2.2.1.1.1.1.3.2" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3.2.cmml">L</mi><mn id="S4.E10.m1.3.3.2.2.1.1.1.1.3.3" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.2.2.1.1.1.1.2" xref="S4.E10.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml">ρ</mi><mrow id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.1" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.3.cmml" xref="S4.E10.m1.3.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.3a.cmml" xref="S4.E10.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S4.E10.m1.2.2.1.1.cmml" xref="S4.E10.m1.2.2.1.1"><eq id="S4.E10.m1.2.2.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.2"></eq><apply id="S4.E10.m1.2.2.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.3.1.cmml" xref="S4.E10.m1.2.2.1.1.3">subscript</csymbol><apply id="S4.E10.m1.2.2.1.1.3.2.cmml" xref="S4.E10.m1.2.2.1.1.3.2"><ci id="S4.E10.m1.2.2.1.1.3.2.1.cmml" xref="S4.E10.m1.2.2.1.1.3.2.1">~</ci><ci id="S4.E10.m1.2.2.1.1.3.2.2.cmml" xref="S4.E10.m1.2.2.1.1.3.2.2">𝑃</ci></apply><ci id="S4.E10.m1.2.2.1.1.3.3.cmml" xref="S4.E10.m1.2.2.1.1.3.3">H</ci></apply><apply id="S4.E10.m1.2.2.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1"><minus id="S4.E10.m1.2.2.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1"></minus><apply id="S4.E10.m1.2.2.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1"><apply id="S4.E10.m1.2.2.1.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S4.E10.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2.2"></sum><ci id="S4.E10.m1.2.2.1.1.1.1.2.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E10.m1.2.2.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1"><times id="S4.E10.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.2"></times><ci id="S4.E10.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.3">𝐻</ci><apply id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S4.E10.m1.3.3.2.2.cmml" xref="S4.E10.m1.3.3.2.2"><eq id="S4.E10.m1.3.3.2.2.2.cmml" xref="S4.E10.m1.3.3.2.2.2"></eq><apply id="S4.E10.m1.3.3.2.2.3.cmml" xref="S4.E10.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.3.1.cmml" xref="S4.E10.m1.3.3.2.2.3">subscript</csymbol><apply id="S4.E10.m1.3.3.2.2.3.2.cmml" xref="S4.E10.m1.3.3.2.2.3.2"><ci id="S4.E10.m1.3.3.2.2.3.2.1.cmml" xref="S4.E10.m1.3.3.2.2.3.2.1">~</ci><ci id="S4.E10.m1.3.3.2.2.3.2.2.cmml" xref="S4.E10.m1.3.3.2.2.3.2.2">𝑃</ci></apply><ci id="S4.E10.m1.3.3.2.2.3.3.cmml" xref="S4.E10.m1.3.3.2.2.3.3">I</ci></apply><apply id="S4.E10.m1.3.3.2.2.1.cmml" xref="S4.E10.m1.3.3.2.2.1"><apply id="S4.E10.m1.3.3.2.2.1.2.cmml" xref="S4.E10.m1.3.3.2.2.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.1.2.1.cmml" xref="S4.E10.m1.3.3.2.2.1.2">subscript</csymbol><sum id="S4.E10.m1.3.3.2.2.1.2.2.cmml" xref="S4.E10.m1.3.3.2.2.1.2.2"></sum><apply id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><in id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.2"></in><ci id="S4.E10.m1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.3">𝑖</ci><set id="S4.E10.m1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1"><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1"><times id="S4.E10.m1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1"></times><apply id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.2">𝑎</ci><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">…</ci><apply id="S4.E10.m1.1.1.1.1.1.1.4.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4">superscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.4.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.2">𝑎</ci><ci id="S4.E10.m1.1.1.1.1.1.1.4.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.4.3">𝑡</ci></apply></apply></set></apply></apply><apply id="S4.E10.m1.3.3.2.2.1.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1"><times id="S4.E10.m1.3.3.2.2.1.1.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.2"></times><apply id="S4.E10.m1.3.3.2.2.1.1.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.3"><divide id="S4.E10.m1.3.3.2.2.1.1.3.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.3"></divide><cn type="integer" id="S4.E10.m1.3.3.2.2.1.1.3.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.3.2">1</cn><ci id="S4.E10.m1.3.3.2.2.1.1.3.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.3.3">𝑁</ci></apply><apply id="S4.E10.m1.3.3.2.2.1.1.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1"><apply id="S4.E10.m1.3.3.2.2.1.1.1.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.1.1.1.2.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.2">subscript</csymbol><sum id="S4.E10.m1.3.3.2.2.1.1.1.2.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.2.2"></sum><ci id="S4.E10.m1.3.3.2.2.1.1.1.2.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S4.E10.m1.3.3.2.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1"><times id="S4.E10.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.2"></times><apply id="S4.E10.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.1.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.2.2.1.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3.2">𝐿</ci><cn type="integer" id="S4.E10.m1.3.3.2.2.1.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.3.3">1</cn></apply><apply id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.2">𝜌</ci><apply id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3"><times id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.2.2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">\displaystyle\tilde{P}_{\rm H}=-\sum_{t}H\left(p^{t}\right)\qquad\tilde{P}_{\rm I}=\sum_{i\in\{a^{0}...a^{t}\}}\frac{1}{N}\sum_{j}L_{1}\left(\rho_{ij}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p6.2" class="ltx_p">where <math id="S4.SS3.p6.2.m1.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S4.SS3.p6.2.m1.1a"><msub id="S4.SS3.p6.2.m1.1.1" xref="S4.SS3.p6.2.m1.1.1.cmml"><mi id="S4.SS3.p6.2.m1.1.1.2" xref="S4.SS3.p6.2.m1.1.1.2.cmml">L</mi><mn id="S4.SS3.p6.2.m1.1.1.3" xref="S4.SS3.p6.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m1.1b"><apply id="S4.SS3.p6.2.m1.1.1.cmml" xref="S4.SS3.p6.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m1.1.1.1.cmml" xref="S4.SS3.p6.2.m1.1.1">subscript</csymbol><ci id="S4.SS3.p6.2.m1.1.1.2.cmml" xref="S4.SS3.p6.2.m1.1.1.2">𝐿</ci><cn type="integer" id="S4.SS3.p6.2.m1.1.1.3.cmml" xref="S4.SS3.p6.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m1.1c">L_{1}</annotation></semantics></math> is the Huber loss from Eq <a href="#S4.E12" title="In 4.3 Counting ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>.
Including the entropy objective is a common strategy when using policy gradient <cite class="ltx_cite ltx_citemacro_citep">(Williams &amp; Peng, <a href="#bib.bib41" title="" class="ltx_ref">1991</a>; Minh et al., <a href="#bib.bib25" title="" class="ltx_ref">2016</a>; Luo et al., <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite> and is used to improve exploration.
The interaction penalty is motivated by the <span id="S4.SS3.p6.2.1" class="ltx_text ltx_font_italic">a priori</span> expectation that interactions should be sparse.
During training, we minimize a weighted sum of the three losses, normalized by the number of decision steps.
As before, we provide training and implementation details in the Appendix (Sec. <a href="#A2.SS2" title="B.2 Counting models ‣ Appendix B Training and implementation details ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.2</span></a>).</p>
</div>
<div id="S4.SS3.p7" class="ltx_para ltx_noindent">
<p id="S4.SS3.p7.6" class="ltx_p"><span id="S4.SS3.p7.6.1" class="ltx_text ltx_font_bold">SoftCount.</span> As a baseline approach, we train a model to count directly from the outputs <math id="S4.SS3.p7.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS3.p7.1.m1.1a"><mi id="S4.SS3.p7.1.m1.1.1" xref="S4.SS3.p7.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.1.m1.1b"><ci id="S4.SS3.p7.1.m1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.1.m1.1c">s</annotation></semantics></math> of the scoring function.
For each object, we project its score vector <math id="S4.SS3.p7.2.m2.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S4.SS3.p7.2.m2.1a"><msub id="S4.SS3.p7.2.m2.1.1" xref="S4.SS3.p7.2.m2.1.1.cmml"><mi id="S4.SS3.p7.2.m2.1.1.2" xref="S4.SS3.p7.2.m2.1.1.2.cmml">s</mi><mi id="S4.SS3.p7.2.m2.1.1.3" xref="S4.SS3.p7.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.2.m2.1b"><apply id="S4.SS3.p7.2.m2.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.2.m2.1.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p7.2.m2.1.1.2.cmml" xref="S4.SS3.p7.2.m2.1.1.2">𝑠</ci><ci id="S4.SS3.p7.2.m2.1.1.3.cmml" xref="S4.SS3.p7.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.2.m2.1c">s_{i}</annotation></semantics></math> to a scalar value and apply a sigmoid nonlinearity, denoted as <math id="S4.SS3.p7.3.m3.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS3.p7.3.m3.1a"><mi id="S4.SS3.p7.3.m3.1.1" xref="S4.SS3.p7.3.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.3.m3.1b"><ci id="S4.SS3.p7.3.m3.1.1.cmml" xref="S4.SS3.p7.3.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.3.m3.1c">\sigma</annotation></semantics></math>, to assign the object a count value between 0 and 1.
The total count is the sum of these fractional, object-specific count values.
We train this model by minimizing the Huber loss associated with the absolute difference <math id="S4.SS3.p7.4.m4.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S4.SS3.p7.4.m4.1a"><mi id="S4.SS3.p7.4.m4.1.1" xref="S4.SS3.p7.4.m4.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.4.m4.1b"><ci id="S4.SS3.p7.4.m4.1.1.cmml" xref="S4.SS3.p7.4.m4.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.4.m4.1c">e</annotation></semantics></math> between the predicted count <math id="S4.SS3.p7.5.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS3.p7.5.m5.1a"><mi id="S4.SS3.p7.5.m5.1.1" xref="S4.SS3.p7.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.5.m5.1b"><ci id="S4.SS3.p7.5.m5.1.1.cmml" xref="S4.SS3.p7.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.5.m5.1c">C</annotation></semantics></math> and the ground truth count <math id="S4.SS3.p7.6.m6.1" class="ltx_Math" alttext="C^{\rm GT}" display="inline"><semantics id="S4.SS3.p7.6.m6.1a"><msup id="S4.SS3.p7.6.m6.1.1" xref="S4.SS3.p7.6.m6.1.1.cmml"><mi id="S4.SS3.p7.6.m6.1.1.2" xref="S4.SS3.p7.6.m6.1.1.2.cmml">C</mi><mi id="S4.SS3.p7.6.m6.1.1.3" xref="S4.SS3.p7.6.m6.1.1.3.cmml">GT</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.6.m6.1b"><apply id="S4.SS3.p7.6.m6.1.1.cmml" xref="S4.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.6.m6.1.1.1.cmml" xref="S4.SS3.p7.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.p7.6.m6.1.1.2.cmml" xref="S4.SS3.p7.6.m6.1.1.2">𝐶</ci><ci id="S4.SS3.p7.6.m6.1.1.3.cmml" xref="S4.SS3.p7.6.m6.1.1.3">GT</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.6.m6.1c">C^{\rm GT}</annotation></semantics></math>:</p>
<table id="A4.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E11.m1.1" class="ltx_Math" alttext="\displaystyle C" display="inline"><semantics id="S4.E11.m1.1a"><mi id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><ci id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">\displaystyle C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E11.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{i}\sigma\left(Ws_{i}\right)" display="inline"><semantics id="S4.E11.m2.1a"><mrow id="S4.E11.m2.1.1" xref="S4.E11.m2.1.1.cmml"><mi id="S4.E11.m2.1.1.3" xref="S4.E11.m2.1.1.3.cmml"></mi><mo id="S4.E11.m2.1.1.2" xref="S4.E11.m2.1.1.2.cmml">=</mo><mrow id="S4.E11.m2.1.1.1" xref="S4.E11.m2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E11.m2.1.1.1.2" xref="S4.E11.m2.1.1.1.2.cmml"><munder id="S4.E11.m2.1.1.1.2a" xref="S4.E11.m2.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E11.m2.1.1.1.2.2" xref="S4.E11.m2.1.1.1.2.2.cmml">∑</mo><mi id="S4.E11.m2.1.1.1.2.3" xref="S4.E11.m2.1.1.1.2.3.cmml">i</mi></munder></mstyle><mrow id="S4.E11.m2.1.1.1.1" xref="S4.E11.m2.1.1.1.1.cmml"><mi id="S4.E11.m2.1.1.1.1.3" xref="S4.E11.m2.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m2.1.1.1.1.2" xref="S4.E11.m2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E11.m2.1.1.1.1.1.1" xref="S4.E11.m2.1.1.1.1.1.1.1.cmml"><mo id="S4.E11.m2.1.1.1.1.1.1.2" xref="S4.E11.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E11.m2.1.1.1.1.1.1.1" xref="S4.E11.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m2.1.1.1.1.1.1.1.2" xref="S4.E11.m2.1.1.1.1.1.1.1.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.E11.m2.1.1.1.1.1.1.1.1" xref="S4.E11.m2.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S4.E11.m2.1.1.1.1.1.1.1.3" xref="S4.E11.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m2.1.1.1.1.1.1.1.3.2" xref="S4.E11.m2.1.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.E11.m2.1.1.1.1.1.1.1.3.3" xref="S4.E11.m2.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E11.m2.1.1.1.1.1.1.3" xref="S4.E11.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m2.1b"><apply id="S4.E11.m2.1.1.cmml" xref="S4.E11.m2.1.1"><eq id="S4.E11.m2.1.1.2.cmml" xref="S4.E11.m2.1.1.2"></eq><csymbol cd="latexml" id="S4.E11.m2.1.1.3.cmml" xref="S4.E11.m2.1.1.3">absent</csymbol><apply id="S4.E11.m2.1.1.1.cmml" xref="S4.E11.m2.1.1.1"><apply id="S4.E11.m2.1.1.1.2.cmml" xref="S4.E11.m2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m2.1.1.1.2.1.cmml" xref="S4.E11.m2.1.1.1.2">subscript</csymbol><sum id="S4.E11.m2.1.1.1.2.2.cmml" xref="S4.E11.m2.1.1.1.2.2"></sum><ci id="S4.E11.m2.1.1.1.2.3.cmml" xref="S4.E11.m2.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E11.m2.1.1.1.1.cmml" xref="S4.E11.m2.1.1.1.1"><times id="S4.E11.m2.1.1.1.1.2.cmml" xref="S4.E11.m2.1.1.1.1.2"></times><ci id="S4.E11.m2.1.1.1.1.3.cmml" xref="S4.E11.m2.1.1.1.1.3">𝜎</ci><apply id="S4.E11.m2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m2.1.1.1.1.1.1"><times id="S4.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m2.1.1.1.1.1.1.1.1"></times><ci id="S4.E11.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m2.1.1.1.1.1.1.1.2">𝑊</ci><apply id="S4.E11.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E11.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E11.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m2.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S4.E11.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m2.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m2.1c">\displaystyle=\sum_{i}\sigma\left(Ws_{i}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12.m1.1" class="ltx_Math" alttext="\displaystyle L_{1}" display="inline"><semantics id="S4.E12.m1.1a"><msub id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml"><mi id="S4.E12.m1.1.1.2" xref="S4.E12.m1.1.1.2.cmml">L</mi><mn id="S4.E12.m1.1.1.3" xref="S4.E12.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.cmml" xref="S4.E12.m1.1.1">subscript</csymbol><ci id="S4.E12.m1.1.1.2.cmml" xref="S4.E12.m1.1.1.2">𝐿</ci><cn type="integer" id="S4.E12.m1.1.1.3.cmml" xref="S4.E12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\displaystyle L_{1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E12.m2.6" class="ltx_Math" alttext="\displaystyle=\begin{cases}0.5e^{2}&amp;\text{if }e\leq 1\\
e-0.5&amp;\text{otherwise}\end{cases}\qquad e=|C-C^{\rm GT}|" display="inline"><semantics id="S4.E12.m2.6a"><mrow id="S4.E12.m2.6.6.2" xref="S4.E12.m2.6.6.3.cmml"><mrow id="S4.E12.m2.5.5.1.1" xref="S4.E12.m2.5.5.1.1.cmml"><mi id="S4.E12.m2.5.5.1.1.2" xref="S4.E12.m2.5.5.1.1.2.cmml"></mi><mo id="S4.E12.m2.5.5.1.1.1" xref="S4.E12.m2.5.5.1.1.1.cmml">=</mo><mrow id="S4.E12.m2.4.4a" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mo id="S4.E12.m2.4.4a.5" xref="S4.E12.m2.5.5.1.1.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E12.m2.4.4.4a" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mtr id="S4.E12.m2.4.4.4aa" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m2.4.4.4ab" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mrow id="S4.E12.m2.1.1.1.1.1.1" xref="S4.E12.m2.1.1.1.1.1.1.cmml"><mn id="S4.E12.m2.1.1.1.1.1.1.2" xref="S4.E12.m2.1.1.1.1.1.1.2.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="S4.E12.m2.1.1.1.1.1.1.1" xref="S4.E12.m2.1.1.1.1.1.1.1.cmml">​</mo><msup id="S4.E12.m2.1.1.1.1.1.1.3" xref="S4.E12.m2.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m2.1.1.1.1.1.1.3.2" xref="S4.E12.m2.1.1.1.1.1.1.3.2.cmml">e</mi><mn id="S4.E12.m2.1.1.1.1.1.1.3.3" xref="S4.E12.m2.1.1.1.1.1.1.3.3.cmml">2</mn></msup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m2.4.4.4ac" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mrow id="S4.E12.m2.2.2.2.2.2.1" xref="S4.E12.m2.2.2.2.2.2.1.cmml"><mrow id="S4.E12.m2.2.2.2.2.2.1.2" xref="S4.E12.m2.2.2.2.2.2.1.2.cmml"><mtext id="S4.E12.m2.2.2.2.2.2.1.2.2" xref="S4.E12.m2.2.2.2.2.2.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S4.E12.m2.2.2.2.2.2.1.2.1" xref="S4.E12.m2.2.2.2.2.2.1.2.1.cmml">​</mo><mi id="S4.E12.m2.2.2.2.2.2.1.2.3" xref="S4.E12.m2.2.2.2.2.2.1.2.3.cmml">e</mi></mrow><mo id="S4.E12.m2.2.2.2.2.2.1.1" xref="S4.E12.m2.2.2.2.2.2.1.1.cmml">≤</mo><mn id="S4.E12.m2.2.2.2.2.2.1.3" xref="S4.E12.m2.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S4.E12.m2.4.4.4ad" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m2.4.4.4ae" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mrow id="S4.E12.m2.3.3.3.3.1.1" xref="S4.E12.m2.3.3.3.3.1.1.cmml"><mi id="S4.E12.m2.3.3.3.3.1.1.2" xref="S4.E12.m2.3.3.3.3.1.1.2.cmml">e</mi><mo id="S4.E12.m2.3.3.3.3.1.1.1" xref="S4.E12.m2.3.3.3.3.1.1.1.cmml">−</mo><mn id="S4.E12.m2.3.3.3.3.1.1.3" xref="S4.E12.m2.3.3.3.3.1.1.3.cmml">0.5</mn></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m2.4.4.4af" xref="S4.E12.m2.5.5.1.1.3.1.cmml"><mtext id="S4.E12.m2.4.4.4.4.2.1" xref="S4.E12.m2.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><mspace width="2em" id="S4.E12.m2.6.6.2.3" xref="S4.E12.m2.6.6.3a.cmml"></mspace><mrow id="S4.E12.m2.6.6.2.2" xref="S4.E12.m2.6.6.2.2.cmml"><mi id="S4.E12.m2.6.6.2.2.3" xref="S4.E12.m2.6.6.2.2.3.cmml">e</mi><mo id="S4.E12.m2.6.6.2.2.2" xref="S4.E12.m2.6.6.2.2.2.cmml">=</mo><mrow id="S4.E12.m2.6.6.2.2.1.1" xref="S4.E12.m2.6.6.2.2.1.2.cmml"><mo stretchy="false" id="S4.E12.m2.6.6.2.2.1.1.2" xref="S4.E12.m2.6.6.2.2.1.2.1.cmml">|</mo><mrow id="S4.E12.m2.6.6.2.2.1.1.1" xref="S4.E12.m2.6.6.2.2.1.1.1.cmml"><mi id="S4.E12.m2.6.6.2.2.1.1.1.2" xref="S4.E12.m2.6.6.2.2.1.1.1.2.cmml">C</mi><mo id="S4.E12.m2.6.6.2.2.1.1.1.1" xref="S4.E12.m2.6.6.2.2.1.1.1.1.cmml">−</mo><msup id="S4.E12.m2.6.6.2.2.1.1.1.3" xref="S4.E12.m2.6.6.2.2.1.1.1.3.cmml"><mi id="S4.E12.m2.6.6.2.2.1.1.1.3.2" xref="S4.E12.m2.6.6.2.2.1.1.1.3.2.cmml">C</mi><mi id="S4.E12.m2.6.6.2.2.1.1.1.3.3" xref="S4.E12.m2.6.6.2.2.1.1.1.3.3.cmml">GT</mi></msup></mrow><mo stretchy="false" id="S4.E12.m2.6.6.2.2.1.1.3" xref="S4.E12.m2.6.6.2.2.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m2.6b"><apply id="S4.E12.m2.6.6.3.cmml" xref="S4.E12.m2.6.6.2"><csymbol cd="ambiguous" id="S4.E12.m2.6.6.3a.cmml" xref="S4.E12.m2.6.6.2.3">formulae-sequence</csymbol><apply id="S4.E12.m2.5.5.1.1.cmml" xref="S4.E12.m2.5.5.1.1"><eq id="S4.E12.m2.5.5.1.1.1.cmml" xref="S4.E12.m2.5.5.1.1.1"></eq><csymbol cd="latexml" id="S4.E12.m2.5.5.1.1.2.cmml" xref="S4.E12.m2.5.5.1.1.2">absent</csymbol><apply id="S4.E12.m2.5.5.1.1.3.1.cmml" xref="S4.E12.m2.4.4a"><csymbol cd="latexml" id="S4.E12.m2.5.5.1.1.3.1.1.cmml" xref="S4.E12.m2.4.4a.5">cases</csymbol><apply id="S4.E12.m2.1.1.1.1.1.1.cmml" xref="S4.E12.m2.1.1.1.1.1.1"><times id="S4.E12.m2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m2.1.1.1.1.1.1.1"></times><cn type="float" id="S4.E12.m2.1.1.1.1.1.1.2.cmml" xref="S4.E12.m2.1.1.1.1.1.1.2">0.5</cn><apply id="S4.E12.m2.1.1.1.1.1.1.3.cmml" xref="S4.E12.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E12.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m2.1.1.1.1.1.1.3.2">𝑒</ci><cn type="integer" id="S4.E12.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m2.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S4.E12.m2.2.2.2.2.2.1.cmml" xref="S4.E12.m2.2.2.2.2.2.1"><leq id="S4.E12.m2.2.2.2.2.2.1.1.cmml" xref="S4.E12.m2.2.2.2.2.2.1.1"></leq><apply id="S4.E12.m2.2.2.2.2.2.1.2.cmml" xref="S4.E12.m2.2.2.2.2.2.1.2"><times id="S4.E12.m2.2.2.2.2.2.1.2.1.cmml" xref="S4.E12.m2.2.2.2.2.2.1.2.1"></times><ci id="S4.E12.m2.2.2.2.2.2.1.2.2a.cmml" xref="S4.E12.m2.2.2.2.2.2.1.2.2"><mtext id="S4.E12.m2.2.2.2.2.2.1.2.2.cmml" xref="S4.E12.m2.2.2.2.2.2.1.2.2">if </mtext></ci><ci id="S4.E12.m2.2.2.2.2.2.1.2.3.cmml" xref="S4.E12.m2.2.2.2.2.2.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.E12.m2.2.2.2.2.2.1.3.cmml" xref="S4.E12.m2.2.2.2.2.2.1.3">1</cn></apply><apply id="S4.E12.m2.3.3.3.3.1.1.cmml" xref="S4.E12.m2.3.3.3.3.1.1"><minus id="S4.E12.m2.3.3.3.3.1.1.1.cmml" xref="S4.E12.m2.3.3.3.3.1.1.1"></minus><ci id="S4.E12.m2.3.3.3.3.1.1.2.cmml" xref="S4.E12.m2.3.3.3.3.1.1.2">𝑒</ci><cn type="float" id="S4.E12.m2.3.3.3.3.1.1.3.cmml" xref="S4.E12.m2.3.3.3.3.1.1.3">0.5</cn></apply><ci id="S4.E12.m2.4.4.4.4.2.1a.cmml" xref="S4.E12.m2.4.4.4.4.2.1"><mtext id="S4.E12.m2.4.4.4.4.2.1.cmml" xref="S4.E12.m2.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply><apply id="S4.E12.m2.6.6.2.2.cmml" xref="S4.E12.m2.6.6.2.2"><eq id="S4.E12.m2.6.6.2.2.2.cmml" xref="S4.E12.m2.6.6.2.2.2"></eq><ci id="S4.E12.m2.6.6.2.2.3.cmml" xref="S4.E12.m2.6.6.2.2.3">𝑒</ci><apply id="S4.E12.m2.6.6.2.2.1.2.cmml" xref="S4.E12.m2.6.6.2.2.1.1"><abs id="S4.E12.m2.6.6.2.2.1.2.1.cmml" xref="S4.E12.m2.6.6.2.2.1.1.2"></abs><apply id="S4.E12.m2.6.6.2.2.1.1.1.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1"><minus id="S4.E12.m2.6.6.2.2.1.1.1.1.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1.1"></minus><ci id="S4.E12.m2.6.6.2.2.1.1.1.2.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1.2">𝐶</ci><apply id="S4.E12.m2.6.6.2.2.1.1.1.3.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m2.6.6.2.2.1.1.1.3.1.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1.3">superscript</csymbol><ci id="S4.E12.m2.6.6.2.2.1.1.1.3.2.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1.3.2">𝐶</ci><ci id="S4.E12.m2.6.6.2.2.1.1.1.3.3.cmml" xref="S4.E12.m2.6.6.2.2.1.1.1.3.3">GT</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m2.6c">\displaystyle=\begin{cases}0.5e^{2}&amp;\text{if }e\leq 1\\
e-0.5&amp;\text{otherwise}\end{cases}\qquad e=|C-C^{\rm GT}|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p7.7" class="ltx_p">For evaluation, we round the estimated count <math id="S4.SS3.p7.7.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS3.p7.7.m1.1a"><mi id="S4.SS3.p7.7.m1.1.1" xref="S4.SS3.p7.7.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.7.m1.1b"><ci id="S4.SS3.p7.7.m1.1.1.cmml" xref="S4.SS3.p7.7.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.7.m1.1c">C</annotation></semantics></math> to the nearest integer and limit the output to the maximum ground truth count (in this case, 20).</p>
</div>
<div id="S4.SS3.p8" class="ltx_para ltx_noindent">
<p id="S4.SS3.p8.7" class="ltx_p"><span id="S4.SS3.p8.7.1" class="ltx_text ltx_font_bold">Attention Baseline (UpDown).</span> As a second baseline, we re-implement the QA architecture introduced in <cite class="ltx_cite ltx_citemacro_citet">Anderson et al. (<a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>, which the authors refer to as UpDown– see also <cite class="ltx_cite ltx_citemacro_citet">Teney et al. (<a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite> for additional details.
We focus on this architecture for three main reasons.
First, it represents the current state of the art for VQA 2.0.
Second, it was designed to use the visual representations we employ.
And, third, it exemplifies the common two-stage approach of (1) deploying question-based attention over image regions (here, detected objects) to get a fixed-length visual representation</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.2" class="ltx_Math" alttext="\alpha={\rm softmax}\left(Ws\right);\quad\hat{v}=\sum\alpha_{i}v_{i}" display="block"><semantics id="S4.E13.m1.2a"><mrow id="S4.E13.m1.2.2.2" xref="S4.E13.m1.2.2.3.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.3.cmml">α</mi><mo id="S4.E13.m1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E13.m1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S4.E13.m1.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.E13.m1.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S4.E13.m1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E13.m1.2.2.2.3" xref="S4.E13.m1.2.2.3a.cmml">;</mo><mrow id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml"><mover accent="true" id="S4.E13.m1.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.cmml"><mi id="S4.E13.m1.2.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.2.cmml">v</mi><mo id="S4.E13.m1.2.2.2.2.2.1" xref="S4.E13.m1.2.2.2.2.2.1.cmml">^</mo></mover><mo rspace="0.111em" id="S4.E13.m1.2.2.2.2.1" xref="S4.E13.m1.2.2.2.2.1.cmml">=</mo><mrow id="S4.E13.m1.2.2.2.2.3" xref="S4.E13.m1.2.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E13.m1.2.2.2.2.3.1" xref="S4.E13.m1.2.2.2.2.3.1.cmml">∑</mo><mrow id="S4.E13.m1.2.2.2.2.3.2" xref="S4.E13.m1.2.2.2.2.3.2.cmml"><msub id="S4.E13.m1.2.2.2.2.3.2.2" xref="S4.E13.m1.2.2.2.2.3.2.2.cmml"><mi id="S4.E13.m1.2.2.2.2.3.2.2.2" xref="S4.E13.m1.2.2.2.2.3.2.2.2.cmml">α</mi><mi id="S4.E13.m1.2.2.2.2.3.2.2.3" xref="S4.E13.m1.2.2.2.2.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.2.2.2.2.3.2.1" xref="S4.E13.m1.2.2.2.2.3.2.1.cmml">​</mo><msub id="S4.E13.m1.2.2.2.2.3.2.3" xref="S4.E13.m1.2.2.2.2.3.2.3.cmml"><mi id="S4.E13.m1.2.2.2.2.3.2.3.2" xref="S4.E13.m1.2.2.2.2.3.2.3.2.cmml">v</mi><mi id="S4.E13.m1.2.2.2.2.3.2.3.3" xref="S4.E13.m1.2.2.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.2b"><apply id="S4.E13.m1.2.2.3.cmml" xref="S4.E13.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.3a.cmml" xref="S4.E13.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2"></eq><ci id="S4.E13.m1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3">𝛼</ci><apply id="S4.E13.m1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.2"></times><ci id="S4.E13.m1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.3">softmax</ci><apply id="S4.E13.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1"><times id="S4.E13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S4.E13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S4.E13.m1.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2"><eq id="S4.E13.m1.2.2.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.1"></eq><apply id="S4.E13.m1.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2"><ci id="S4.E13.m1.2.2.2.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.2.1">^</ci><ci id="S4.E13.m1.2.2.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.2.2">𝑣</ci></apply><apply id="S4.E13.m1.2.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2.3"><sum id="S4.E13.m1.2.2.2.2.3.1.cmml" xref="S4.E13.m1.2.2.2.2.3.1"></sum><apply id="S4.E13.m1.2.2.2.2.3.2.cmml" xref="S4.E13.m1.2.2.2.2.3.2"><times id="S4.E13.m1.2.2.2.2.3.2.1.cmml" xref="S4.E13.m1.2.2.2.2.3.2.1"></times><apply id="S4.E13.m1.2.2.2.2.3.2.2.cmml" xref="S4.E13.m1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.2.3.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.3.2.2">subscript</csymbol><ci id="S4.E13.m1.2.2.2.2.3.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2.3.2.2.2">𝛼</ci><ci id="S4.E13.m1.2.2.2.2.3.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2.3.2.2.3">𝑖</ci></apply><apply id="S4.E13.m1.2.2.2.2.3.2.3.cmml" xref="S4.E13.m1.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.2.2.3.2.3.1.cmml" xref="S4.E13.m1.2.2.2.2.3.2.3">subscript</csymbol><ci id="S4.E13.m1.2.2.2.2.3.2.3.2.cmml" xref="S4.E13.m1.2.2.2.2.3.2.3.2">𝑣</ci><ci id="S4.E13.m1.2.2.2.2.3.2.3.3.cmml" xref="S4.E13.m1.2.2.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.2c">\alpha={\rm softmax}\left(Ws\right);\quad\hat{v}=\sum\alpha_{i}v_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p8.8" class="ltx_p">and then (2) classifying the answer based on this average and the question encoding</p>
<table id="A4.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E14.m1.4" class="ltx_Math" alttext="\displaystyle v^{\prime}={f}^{V}\left({\hat{v}}\right);\quad q^{\prime}={f}^{Q}\left({q}\right)" display="inline"><semantics id="S4.E14.m1.4a"><mrow id="S4.E14.m1.4.4.2" xref="S4.E14.m1.4.4.3.cmml"><mrow id="S4.E14.m1.3.3.1.1" xref="S4.E14.m1.3.3.1.1.cmml"><msup id="S4.E14.m1.3.3.1.1.2" xref="S4.E14.m1.3.3.1.1.2.cmml"><mi id="S4.E14.m1.3.3.1.1.2.2" xref="S4.E14.m1.3.3.1.1.2.2.cmml">v</mi><mo id="S4.E14.m1.3.3.1.1.2.3" xref="S4.E14.m1.3.3.1.1.2.3.cmml">′</mo></msup><mo id="S4.E14.m1.3.3.1.1.1" xref="S4.E14.m1.3.3.1.1.1.cmml">=</mo><mrow id="S4.E14.m1.3.3.1.1.3" xref="S4.E14.m1.3.3.1.1.3.cmml"><msup id="S4.E14.m1.3.3.1.1.3.2" xref="S4.E14.m1.3.3.1.1.3.2.cmml"><mi id="S4.E14.m1.3.3.1.1.3.2.2" xref="S4.E14.m1.3.3.1.1.3.2.2.cmml">f</mi><mi id="S4.E14.m1.3.3.1.1.3.2.3" xref="S4.E14.m1.3.3.1.1.3.2.3.cmml">V</mi></msup><mo lspace="0em" rspace="0em" id="S4.E14.m1.3.3.1.1.3.1" xref="S4.E14.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S4.E14.m1.3.3.1.1.3.3.2" xref="S4.E14.m1.1.1.cmml"><mo id="S4.E14.m1.3.3.1.1.3.3.2.1" xref="S4.E14.m1.1.1.cmml">(</mo><mover accent="true" id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml"><mi id="S4.E14.m1.1.1.2" xref="S4.E14.m1.1.1.2.cmml">v</mi><mo id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.cmml">^</mo></mover><mo id="S4.E14.m1.3.3.1.1.3.3.2.2" xref="S4.E14.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E14.m1.4.4.2.3" xref="S4.E14.m1.4.4.3a.cmml">;</mo><mrow id="S4.E14.m1.4.4.2.2" xref="S4.E14.m1.4.4.2.2.cmml"><msup id="S4.E14.m1.4.4.2.2.2" xref="S4.E14.m1.4.4.2.2.2.cmml"><mi id="S4.E14.m1.4.4.2.2.2.2" xref="S4.E14.m1.4.4.2.2.2.2.cmml">q</mi><mo id="S4.E14.m1.4.4.2.2.2.3" xref="S4.E14.m1.4.4.2.2.2.3.cmml">′</mo></msup><mo id="S4.E14.m1.4.4.2.2.1" xref="S4.E14.m1.4.4.2.2.1.cmml">=</mo><mrow id="S4.E14.m1.4.4.2.2.3" xref="S4.E14.m1.4.4.2.2.3.cmml"><msup id="S4.E14.m1.4.4.2.2.3.2" xref="S4.E14.m1.4.4.2.2.3.2.cmml"><mi id="S4.E14.m1.4.4.2.2.3.2.2" xref="S4.E14.m1.4.4.2.2.3.2.2.cmml">f</mi><mi id="S4.E14.m1.4.4.2.2.3.2.3" xref="S4.E14.m1.4.4.2.2.3.2.3.cmml">Q</mi></msup><mo lspace="0em" rspace="0em" id="S4.E14.m1.4.4.2.2.3.1" xref="S4.E14.m1.4.4.2.2.3.1.cmml">​</mo><mrow id="S4.E14.m1.4.4.2.2.3.3.2" xref="S4.E14.m1.4.4.2.2.3.cmml"><mo id="S4.E14.m1.4.4.2.2.3.3.2.1" xref="S4.E14.m1.4.4.2.2.3.cmml">(</mo><mi id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml">q</mi><mo id="S4.E14.m1.4.4.2.2.3.3.2.2" xref="S4.E14.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.4b"><apply id="S4.E14.m1.4.4.3.cmml" xref="S4.E14.m1.4.4.2"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.3a.cmml" xref="S4.E14.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S4.E14.m1.3.3.1.1.cmml" xref="S4.E14.m1.3.3.1.1"><eq id="S4.E14.m1.3.3.1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.1"></eq><apply id="S4.E14.m1.3.3.1.1.2.cmml" xref="S4.E14.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.2.1.cmml" xref="S4.E14.m1.3.3.1.1.2">superscript</csymbol><ci id="S4.E14.m1.3.3.1.1.2.2.cmml" xref="S4.E14.m1.3.3.1.1.2.2">𝑣</ci><ci id="S4.E14.m1.3.3.1.1.2.3.cmml" xref="S4.E14.m1.3.3.1.1.2.3">′</ci></apply><apply id="S4.E14.m1.3.3.1.1.3.cmml" xref="S4.E14.m1.3.3.1.1.3"><times id="S4.E14.m1.3.3.1.1.3.1.cmml" xref="S4.E14.m1.3.3.1.1.3.1"></times><apply id="S4.E14.m1.3.3.1.1.3.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.3.3.1.1.3.2.1.cmml" xref="S4.E14.m1.3.3.1.1.3.2">superscript</csymbol><ci id="S4.E14.m1.3.3.1.1.3.2.2.cmml" xref="S4.E14.m1.3.3.1.1.3.2.2">𝑓</ci><ci id="S4.E14.m1.3.3.1.1.3.2.3.cmml" xref="S4.E14.m1.3.3.1.1.3.2.3">𝑉</ci></apply><apply id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.3.3.1.1.3.3.2"><ci id="S4.E14.m1.1.1.1.cmml" xref="S4.E14.m1.1.1.1">^</ci><ci id="S4.E14.m1.1.1.2.cmml" xref="S4.E14.m1.1.1.2">𝑣</ci></apply></apply></apply><apply id="S4.E14.m1.4.4.2.2.cmml" xref="S4.E14.m1.4.4.2.2"><eq id="S4.E14.m1.4.4.2.2.1.cmml" xref="S4.E14.m1.4.4.2.2.1"></eq><apply id="S4.E14.m1.4.4.2.2.2.cmml" xref="S4.E14.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.2.1.cmml" xref="S4.E14.m1.4.4.2.2.2">superscript</csymbol><ci id="S4.E14.m1.4.4.2.2.2.2.cmml" xref="S4.E14.m1.4.4.2.2.2.2">𝑞</ci><ci id="S4.E14.m1.4.4.2.2.2.3.cmml" xref="S4.E14.m1.4.4.2.2.2.3">′</ci></apply><apply id="S4.E14.m1.4.4.2.2.3.cmml" xref="S4.E14.m1.4.4.2.2.3"><times id="S4.E14.m1.4.4.2.2.3.1.cmml" xref="S4.E14.m1.4.4.2.2.3.1"></times><apply id="S4.E14.m1.4.4.2.2.3.2.cmml" xref="S4.E14.m1.4.4.2.2.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.4.4.2.2.3.2.1.cmml" xref="S4.E14.m1.4.4.2.2.3.2">superscript</csymbol><ci id="S4.E14.m1.4.4.2.2.3.2.2.cmml" xref="S4.E14.m1.4.4.2.2.3.2.2">𝑓</ci><ci id="S4.E14.m1.4.4.2.2.3.2.3.cmml" xref="S4.E14.m1.4.4.2.2.3.2.3">𝑄</ci></apply><ci id="S4.E14.m1.2.2.cmml" xref="S4.E14.m1.2.2">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.4c">\displaystyle v^{\prime}={f}^{V}\left({\hat{v}}\right);\quad q^{\prime}={f}^{Q}\left({q}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="S4.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E15.m1.1" class="ltx_Math" alttext="\displaystyle p={\rm softmax}\left({f}^{C}\left({v^{\prime}\otimes q^{\prime}}\right)\right)" display="inline"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml"><mi id="S4.E15.m1.1.1.3" xref="S4.E15.m1.1.1.3.cmml">p</mi><mo id="S4.E15.m1.1.1.2" xref="S4.E15.m1.1.1.2.cmml">=</mo><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.3" xref="S4.E15.m1.1.1.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.1.1.1.2" xref="S4.E15.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><msup id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S4.E15.m1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.3.3.cmml">C</mi></msup><mo lspace="0em" rspace="0em" id="S4.E15.m1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">v</mi><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo lspace="0.222em" rspace="0.222em" id="S4.E15.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml">⊗</mo><msup id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">q</mi><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1"><eq id="S4.E15.m1.1.1.2.cmml" xref="S4.E15.m1.1.1.2"></eq><ci id="S4.E15.m1.1.1.3.cmml" xref="S4.E15.m1.1.1.3">𝑝</ci><apply id="S4.E15.m1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><times id="S4.E15.m1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.2"></times><ci id="S4.E15.m1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.3">softmax</ci><apply id="S4.E15.m1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"><times id="S4.E15.m1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2"></times><apply id="S4.E15.m1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S4.E15.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.3">𝐶</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E15.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.1">tensor-product</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.2.3">′</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">\displaystyle p={\rm softmax}\left({f}^{C}\left({v^{\prime}\otimes q^{\prime}}\right)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p8.6" class="ltx_p">where <math id="S4.SS3.p8.1.m1.1" class="ltx_Math" alttext="s\in\mathbb{R}^{{N}{\rm x}{n}}" display="inline"><semantics id="S4.SS3.p8.1.m1.1a"><mrow id="S4.SS3.p8.1.m1.1.1" xref="S4.SS3.p8.1.m1.1.1.cmml"><mi id="S4.SS3.p8.1.m1.1.1.2" xref="S4.SS3.p8.1.m1.1.1.2.cmml">s</mi><mo id="S4.SS3.p8.1.m1.1.1.1" xref="S4.SS3.p8.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS3.p8.1.m1.1.1.3" xref="S4.SS3.p8.1.m1.1.1.3.cmml"><mi id="S4.SS3.p8.1.m1.1.1.3.2" xref="S4.SS3.p8.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS3.p8.1.m1.1.1.3.3" xref="S4.SS3.p8.1.m1.1.1.3.3.cmml"><mi id="S4.SS3.p8.1.m1.1.1.3.3.2" xref="S4.SS3.p8.1.m1.1.1.3.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p8.1.m1.1.1.3.3.1" xref="S4.SS3.p8.1.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS3.p8.1.m1.1.1.3.3.3" xref="S4.SS3.p8.1.m1.1.1.3.3.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p8.1.m1.1.1.3.3.1a" xref="S4.SS3.p8.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS3.p8.1.m1.1.1.3.3.4" xref="S4.SS3.p8.1.m1.1.1.3.3.4.cmml">n</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.1.m1.1b"><apply id="S4.SS3.p8.1.m1.1.1.cmml" xref="S4.SS3.p8.1.m1.1.1"><in id="S4.SS3.p8.1.m1.1.1.1.cmml" xref="S4.SS3.p8.1.m1.1.1.1"></in><ci id="S4.SS3.p8.1.m1.1.1.2.cmml" xref="S4.SS3.p8.1.m1.1.1.2">𝑠</ci><apply id="S4.SS3.p8.1.m1.1.1.3.cmml" xref="S4.SS3.p8.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p8.1.m1.1.1.3.1.cmml" xref="S4.SS3.p8.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p8.1.m1.1.1.3.2.cmml" xref="S4.SS3.p8.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS3.p8.1.m1.1.1.3.3.cmml" xref="S4.SS3.p8.1.m1.1.1.3.3"><times id="S4.SS3.p8.1.m1.1.1.3.3.1.cmml" xref="S4.SS3.p8.1.m1.1.1.3.3.1"></times><ci id="S4.SS3.p8.1.m1.1.1.3.3.2.cmml" xref="S4.SS3.p8.1.m1.1.1.3.3.2">𝑁</ci><ci id="S4.SS3.p8.1.m1.1.1.3.3.3.cmml" xref="S4.SS3.p8.1.m1.1.1.3.3.3">x</ci><ci id="S4.SS3.p8.1.m1.1.1.3.3.4.cmml" xref="S4.SS3.p8.1.m1.1.1.3.3.4">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.1.m1.1c">s\in\mathbb{R}^{{N}{\rm x}{n}}</annotation></semantics></math> denotes the matrix of score vectors for each of the <math id="S4.SS3.p8.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS3.p8.2.m2.1a"><mi id="S4.SS3.p8.2.m2.1.1" xref="S4.SS3.p8.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.2.m2.1b"><ci id="S4.SS3.p8.2.m2.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.2.m2.1c">N</annotation></semantics></math> detected objects and <math id="S4.SS3.p8.3.m3.1" class="ltx_Math" alttext="\alpha\in\mathbb{R}^{N}" display="inline"><semantics id="S4.SS3.p8.3.m3.1a"><mrow id="S4.SS3.p8.3.m3.1.1" xref="S4.SS3.p8.3.m3.1.1.cmml"><mi id="S4.SS3.p8.3.m3.1.1.2" xref="S4.SS3.p8.3.m3.1.1.2.cmml">α</mi><mo id="S4.SS3.p8.3.m3.1.1.1" xref="S4.SS3.p8.3.m3.1.1.1.cmml">∈</mo><msup id="S4.SS3.p8.3.m3.1.1.3" xref="S4.SS3.p8.3.m3.1.1.3.cmml"><mi id="S4.SS3.p8.3.m3.1.1.3.2" xref="S4.SS3.p8.3.m3.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS3.p8.3.m3.1.1.3.3" xref="S4.SS3.p8.3.m3.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.3.m3.1b"><apply id="S4.SS3.p8.3.m3.1.1.cmml" xref="S4.SS3.p8.3.m3.1.1"><in id="S4.SS3.p8.3.m3.1.1.1.cmml" xref="S4.SS3.p8.3.m3.1.1.1"></in><ci id="S4.SS3.p8.3.m3.1.1.2.cmml" xref="S4.SS3.p8.3.m3.1.1.2">𝛼</ci><apply id="S4.SS3.p8.3.m3.1.1.3.cmml" xref="S4.SS3.p8.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p8.3.m3.1.1.3.1.cmml" xref="S4.SS3.p8.3.m3.1.1.3">superscript</csymbol><ci id="S4.SS3.p8.3.m3.1.1.3.2.cmml" xref="S4.SS3.p8.3.m3.1.1.3.2">ℝ</ci><ci id="S4.SS3.p8.3.m3.1.1.3.3.cmml" xref="S4.SS3.p8.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.3.m3.1c">\alpha\in\mathbb{R}^{N}</annotation></semantics></math> denotes the attention weights.
Here, each function <math id="S4.SS3.p8.4.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S4.SS3.p8.4.m4.1a"><mi id="S4.SS3.p8.4.m4.1.1" xref="S4.SS3.p8.4.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.4.m4.1b"><ci id="S4.SS3.p8.4.m4.1.1.cmml" xref="S4.SS3.p8.4.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.4.m4.1c">f</annotation></semantics></math> is implemented as a GTU layer and <math id="S4.SS3.p8.5.m5.1" class="ltx_Math" alttext="\otimes" display="inline"><semantics id="S4.SS3.p8.5.m5.1a"><mo id="S4.SS3.p8.5.m5.1.1" xref="S4.SS3.p8.5.m5.1.1.cmml">⊗</mo><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.5.m5.1b"><csymbol cd="latexml" id="S4.SS3.p8.5.m5.1.1.cmml" xref="S4.SS3.p8.5.m5.1.1">tensor-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.5.m5.1c">\otimes</annotation></semantics></math> denotes element-wise multiplication.
For training, we use a cross entropy loss, with the target given by the ground-truth count.
At test time, we use the most probable count given by <math id="S4.SS3.p8.6.m6.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S4.SS3.p8.6.m6.1a"><mi id="S4.SS3.p8.6.m6.1.1" xref="S4.SS3.p8.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.6.m6.1b"><ci id="S4.SS3.p8.6.m6.1.1.cmml" xref="S4.SS3.p8.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.6.m6.1c">p</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Counting Performance</h3>

<figure id="S5.T2" class="ltx_table">
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_tt">Model</th>
<td id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Accuracy</td>
<td id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">RMSE</td>
</tr>
<tr id="S5.T2.1.2.2" class="ltx_tr">
<th id="S5.T2.1.2.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">Guess1</th>
<td id="S5.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">33.8</td>
<td id="S5.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">3.74</td>
</tr>
<tr id="S5.T2.1.3.3" class="ltx_tr">
<th id="S5.T2.1.3.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">LSTM</th>
<td id="S5.T2.1.3.3.2" class="ltx_td ltx_align_center">36.8</td>
<td id="S5.T2.1.3.3.3" class="ltx_td ltx_align_center">3.47</td>
</tr>
<tr id="S5.T2.1.4.4" class="ltx_tr">
<th id="S5.T2.1.4.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">SoftCount</th>
<td id="S5.T2.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t">50.2 (49.2)</td>
<td id="S5.T2.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T2.1.4.4.3.1" class="ltx_text ltx_font_bold">2.37</span> (2.45)</td>
</tr>
<tr id="S5.T2.1.5.5" class="ltx_tr">
<th id="S5.T2.1.5.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">UpDown</th>
<td id="S5.T2.1.5.5.2" class="ltx_td ltx_align_center">52.7 (51.5)</td>
<td id="S5.T2.1.5.5.3" class="ltx_td ltx_align_center">2.64 (2.69)</td>
</tr>
<tr id="S5.T2.1.6.6" class="ltx_tr">
<th id="S5.T2.1.6.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">IRLC</th>
<td id="S5.T2.1.6.6.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.1.6.6.2.1" class="ltx_text ltx_font_bold">57.7</span> (56.1)</td>
<td id="S5.T2.1.6.6.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.1.6.6.3.1" class="ltx_text ltx_font_bold">2.37</span> (2.45)</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>HowMany-QA test set performance. Values in parentheses apply to models trained without caption grounding.</figcaption>
</figure>
<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p">We use two metrics for evaluation.
For consistency with past work, we report the standard VQA test metric of accuracy.
Since accuracy does not measure the degree of error we also report root-mean-squared-error (RMSE), which captures the typical deviation between the estimated and ground-truth count and emphasizes extreme errors.
Details are provided in the Appendix (Sec. <a href="#A4" title="Appendix D Evaluation metrics ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>).</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p">To better understand the performance of the above models, we also report the performance of two non-visual baselines.
The first baseline (Guess1) shows the performance when the estimated count is always 1 (the most common answer in the training set).
The second baseline (LSTM) learns to predict the count directly from a linear projection of the question embedding <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">q</annotation></semantics></math> (Eq.  <a href="#S4.E1" title="In 4.2 Language ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.1" class="ltx_p">IRLC achieves the highest overall accuracy and (with SoftCount) the lowest overall RMSE on the test set (Table <a href="#S5.T2" title="Table 2 ‣ 5.1 Counting Performance ‣ 5 Results ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).
Interestingly, SoftCount clearly lags in accuracy but is competitive in RMSE, arguing that accuracy and RMSE are not redundant.
We observe this to result from the fact that IRLC is less prone to small errors and very slightly more prone to large errors (which disproportionately impact RMSE).
However, whereas UpDown improves in accuracy at the cost of RMSE, IRLC is substantially more accurate without sacrificing overall RMSE.
</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1712.08697/assets/x3.png" id="S5.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="423" height="120" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>
Model performance on the HowMany-QA development set, grouped according to the frequency with which the counting subject appeared in the training data.
</figcaption>
</figure>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.1" class="ltx_p">To gain more insight into the performance of these models, we calculate these metrics within the development set after separating the data according to how common the subject of the count is during training<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>
We infer the subject using a simple dependency-parsing heuristic. Specifically, we extract the root word of the first noun-chunk.
</span></span></span>.
We break up the questions into 5 roughly equal-sized bins representing increasingly uncommon subjects.
We include a 6th bin for subjects never seen during training.
The accuracy and RMSE across the development set are reported for each of these bins in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.1 Counting Performance ‣ 5 Results ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para ltx_noindent">
<p id="S5.SS1.p5.1" class="ltx_p">Organizing the data this way reveals two main trends.
First, all models perform better when asked to count subjects that were common during training.
Second, the performance improvements offered by IRLC over UpDown persist over all groupings of the development data.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Grounding Quality</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p">We introduce a novel analysis to quantify how well counted objects match the subject of the question.
To perform this analysis, we form generic questions that refer to the object categories in the COCO object detection dataset.
We take the object proposals counted in response to a given question and compare them to the ground truth COCO labels to determine how relevant the counted object proposals are.
Our metric takes on a value of 1 when the counted objects perfectly map onto the category to which the question refers.
Values around 0 indicate that the counted objects were not relevant to the question.
Section <a href="#A4" title="Appendix D Evaluation metrics ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a> of the Appendix details how the grounding quality metric is calculated.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p">We perform this analysis for each of the 80 COCO categories using the images in the HowMany-QA development set.
Figure <a href="#S5.F6" title="Figure 6 ‣ 5.2 Grounding Quality ‣ 5 Results ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> compares the grounding quality of SoftCount and IRLC, where each point represents the average grounding quality for a particular COCO category.
As with the previous two metrics, grounding quality is highest for COCO categories that are more common during training.
We observe that IRLC consistently grounds its counts in objects that are more relevant to the question than does SoftCount. A paired t-test shows that this trend is statistically significant (<math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="p&lt;10^{-15}" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">p</mi><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">&lt;</mo><msup id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml"><mn id="S5.SS2.p2.1.m1.1.1.3.2" xref="S5.SS2.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S5.SS2.p2.1.m1.1.1.3.3" xref="S5.SS2.p2.1.m1.1.1.3.3.cmml"><mo id="S5.SS2.p2.1.m1.1.1.3.3a" xref="S5.SS2.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS2.p2.1.m1.1.1.3.3.2" xref="S5.SS2.p2.1.m1.1.1.3.3.2.cmml">15</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><lt id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1"></lt><ci id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">𝑝</ci><apply id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.1.1.3.1.cmml" xref="S5.SS2.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S5.SS2.p2.1.m1.1.1.3.2.cmml" xref="S5.SS2.p2.1.m1.1.1.3.2">10</cn><apply id="S5.SS2.p2.1.m1.1.1.3.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3.3"><minus id="S5.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS2.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S5.SS2.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS2.p2.1.m1.1.1.3.3.2">15</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">p&lt;10^{-15}</annotation></semantics></math>).</p>
</div>
<figure id="S5.F6" class="ltx_figure"><img src="/html/1712.08697/assets/x4.png" id="S5.F6.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="380" height="179" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>
(Left) Average grounding quality for each of the COCO object categories, as measured for SoftCount and IRLC. Each point represents a COCO category and is colored according to how common the category was during training (as in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.1 Counting Performance ‣ 5 Results ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). (Right) Histogram showing the difference in grounding quality between IRLC and SoftCount.
</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Qualitative Analysis</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.1" class="ltx_p">The design of IRLC is inspired by the ideal of interpretable VQA <cite class="ltx_cite ltx_citemacro_citep">(Chandrasekaran et al., <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite>.
One hallmark of interpretability is the ability to predict failure modes.
We argue that this is made more approachable by requiring IRLC to identify the objects in the scene that it chooses to count.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/1712.08697/assets/figures/v2_failures.jpg" id="S5.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="196" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>
Examples of failure cases with common and rare subjects (“people” and “ties,” respectively). Each example shows the output of IRLC, where boxes correspond to counted objects, and the output of UpDown, where boxes are shaded according to their attention weights.
</figcaption>
</figure>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS3.p2.1" class="ltx_p">Figure <a href="#S5.F7" title="Figure 7 ‣ 5.3 Qualitative Analysis ‣ 5 Results ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> illustrates two failure cases that exemplify observed trends in IRLC.
In particular, IRLC has little trouble counting people (they are the most common subject) but encounters difficulty with referring phrases (in this case, “sitting on the bench”).
When asked to count ties (a rare subject), IRLC includes a sleeve in the output, demonstrating the tendency to misidentify objects with few training examples.
These failures are obvious by virtue of the grounded counts, which point out exactly which objects IRLC counted.
In comparison, the attention focus of UpDown (representing the closest analogy to a grounded output) does not identify any pattern.
From the attention weights, it is unclear which scene elements form the basis of the returned count.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para ltx_noindent">
<p id="S5.SS3.p3.1" class="ltx_p">Indeed, the two models may share similar deficits.
We observe that, in many cases, they produce similar counts.
However, we stress that without IRLC and the chance to observe such similarities such deficits of the UpDown model would be difficult to identify.</p>
</div>
<div id="S5.SS3.p4" class="ltx_para ltx_noindent">
<p id="S5.SS3.p4.1" class="ltx_p">The Appendix includes further visualizations and comparisons of model output, including examples of how IRLC uses the iterative decision process to produce discrete, grounded counts (Sec. <a href="#A1" title="Appendix A Examples ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>).</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">We present an interpretable approach to counting in visual question answering, based on learning to enumerate objects in a scene.
By using RL, we are able to train our model to make binary decisions about whether a detected object contributes to the final count.
We experiment with two additional baselines and control for variations due to visual representations and for the mechanism of visual-linguistic comparison.
Our approach achieves state of the art for each of the evaluation metrics.
In addition, our model identifies the objects that contribute to each count.
These groundings provide traction for identifying the aspects of the task that the model has failed to learn and thereby improve not only performance but also interpretability.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. (2015)</span>
<span class="ltx_bibblock">
Aishwarya Agrawal, Jiasen Lu, Stanislaw Antol, Margaret Mitchell, C. Lawrence
Zitnick, Devi Parikh, and Dhruv Batra.

</span>
<span class="ltx_bibblock">VQA: Visual Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 2015.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. (2017)</span>
<span class="ltx_bibblock">
Peter Anderson, Xiaodong He, Chris Buehler, Damien Teney, Mark Johnson, Stephen
Gould, and Lei Zhang.

</span>
<span class="ltx_bibblock">Bottom-Up and Top-Down Attention for Image Captioning and VQA.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andreas et al. (2016a)</span>
<span class="ltx_bibblock">
Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Dan Klein.

</span>
<span class="ltx_bibblock">Neural module networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016a.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andreas et al. (2016b)</span>
<span class="ltx_bibblock">
Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Dan Klein.

</span>
<span class="ltx_bibblock">Learning to Compose Neural Networks for Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">NAACL</em>, 2016b.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chandrasekaran et al. (2017)</span>
<span class="ltx_bibblock">
Arjun Chandrasekaran, Deshraj Yadav, Prithvijit Chattopadhyay, Viraj Prabhu,
and Devi Parikh.

</span>
<span class="ltx_bibblock">It Takes Two to Tango: Towards Theory of AI’s Mind.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chattopadhyay et al. (2017)</span>
<span class="ltx_bibblock">
Prithvijit Chattopadhyay, Ramakrishna Vedantam, Ramprasaath R. Selvaraju, Dhruv
Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Counting Everyday Objects in Everyday Scenes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. (2016)</span>
<span class="ltx_bibblock">
Jifeng Dai, Yi Li, Kaiming He, and Jian Sun.

</span>
<span class="ltx_bibblock">R-FCN: Object Detection via Region-based Fully Convolutional
Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2016.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fukui et al. (2016)</span>
<span class="ltx_bibblock">
Akira Fukui, Dong Huk Park, Daylen Yang, Anna Rohrbach, Trevor Darrell, and
Marcus Rohrbach.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Girshick (2015)</span>
<span class="ltx_bibblock">
Ross Girshick.

</span>
<span class="ltx_bibblock">Fast R-CNN.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2015.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Girshick et al. (2015)</span>
<span class="ltx_bibblock">
Ross Girshick, Jeff Donahue, Trevor Darrell, and Jitendra Malik.

</span>
<span class="ltx_bibblock">Rich feature hierarchies for accurate object detection and semantic
segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2015.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goyal et al. (2017)</span>
<span class="ltx_bibblock">
Yash Goyal, Tejas Khot, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Making the V in VQA Matter: Elevating the Role of Image
Understanding in Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Sepp Hochreiter and Jürgen Schmidhuber.

</span>
<span class="ltx_bibblock">Long Short-Term Memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Neural Computation</em>, 9(8):1735–1780, 1997.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2017)</span>
<span class="ltx_bibblock">
Ronghang Hu, Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Kate Saenko.

</span>
<span class="ltx_bibblock">Learning to Reason: End-to-End Module Networks for Visual Question
Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ilievski et al. (2016)</span>
<span class="ltx_bibblock">
Ilija Ilievski, Shuicheng Yan, and Jiashi Feng.

</span>
<span class="ltx_bibblock">A Focused Dynamic Attention Model for Visual Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2017)</span>
<span class="ltx_bibblock">
Jin-Hwa Kim, Kyoung-Woon On, Woosang Lim, Jeonghee Kim, Jung-Woo Ha, and
Byoung-Tak Zhang.

</span>
<span class="ltx_bibblock">Hadamard Product for Low-rank Bilinear Pooling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2017.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2014.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krishna et al. (2016)</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A. Shamma,
Michael S. Bernstein, and Fei-Fei Li.

</span>
<span class="ltx_bibblock">Visual Genome: Connecting Language and Vision Using Crowdsourced
Dense Image Annotations.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 2016.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lempitsky &amp; Zisserman (2010)</span>
<span class="ltx_bibblock">
Victor Lempitsky and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Learning To Count Objects in Images.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2010.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, Lubomir Bourdev, Ross Girshick,
James Hays, Pietro Perona, Deva Ramanan, C. Lawrence Zitnick, and Piotr
Dollár.

</span>
<span class="ltx_bibblock">Microsoft COCO: Common Objects in Context.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2014.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2017)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár.

</span>
<span class="ltx_bibblock">Focal Loss for Dense Object Detection.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">ICCV</em>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2016a)</span>
<span class="ltx_bibblock">
Jiasen Lu, Caiming Xiong, Devi Parikh, and Richard Socher.

</span>
<span class="ltx_bibblock">Knowing When to Look: Adaptive Attention via A Visual Sentinel for
Image Captioning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2016a.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2016b)</span>
<span class="ltx_bibblock">
Jiasen Lu, Jianwei Yang, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Hierarchical Question-Image Co-Attention for Visual Question
Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2016b.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2017)</span>
<span class="ltx_bibblock">
Yuping Luo, Chung-cheng Chiu, Navdeep Jaitly, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Learning Online Alignments with Continuous Rewards Policy Gradient.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">ICASSP</em>, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Malinowski &amp; Fritz (2014)</span>
<span class="ltx_bibblock">
Mateusz Malinowski and Mario Fritz.

</span>
<span class="ltx_bibblock">A Multi-World Approach to Question Answering about Real-World Scenes
based on Uncertain Input.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2014.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Minh et al. (2016)</span>
<span class="ltx_bibblock">
Volodymyr Minh, Adrià Puigdomènech Badia, Mehdi Mirza, Alex Graves,
Tim Harley, Timothy Lillicrap, David Silver, and Koray Kavukcuoglu.

</span>
<span class="ltx_bibblock">Asynchronous Methods for Deep Reinforcement Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2016.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oñoro-Rubio &amp; López-Sastre (2016)</span>
<span class="ltx_bibblock">
Daniel Oñoro-Rubio and Roberto J. López-Sastre.

</span>
<span class="ltx_bibblock">Towards perspective-free object counting with deep learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2016.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Park et al. (2016)</span>
<span class="ltx_bibblock">
Dong Huk Park, Lisa Anne Hendricks, Zeynep Akata, Bernt Schiele, Trevor
Darrell, and Marcus Rohrbach.

</span>
<span class="ltx_bibblock">Attentive Explanations: Justifying Decisions and Pointing to the
Evidence.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2016.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paulus et al. (2017)</span>
<span class="ltx_bibblock">
Romain Paulus, Caiming Xiong, and Richard Socher.

</span>
<span class="ltx_bibblock">A Deep Reinforced Model for Abstractive Summarization.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pennington et al. (2014)</span>
<span class="ltx_bibblock">
Jeffrey Pennington, Richard Socher, and Christopher Manning.

</span>
<span class="ltx_bibblock">Glove: Global Vectors for Word Representation.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">EMNLP</em>, 2014.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren &amp; Zemel (2017)</span>
<span class="ltx_bibblock">
Mengye Ren and Richard S. Zemel.

</span>
<span class="ltx_bibblock">End-to-End Instance Segmentation with Recurrent Attention.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2015a)</span>
<span class="ltx_bibblock">
Mengye Ren, Ryan Kiros, and Richard Zemel.

</span>
<span class="ltx_bibblock">Exploring Models and Data for Image Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2015a.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2015b)</span>
<span class="ltx_bibblock">
Shaoqing Ren, Kaiming He, Ross Girshick, and Jian Sun.

</span>
<span class="ltx_bibblock">Faster R-CNN: Towards Real-Time Object Detection with Region
Proposal Networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2015b.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rennie et al. (2017)</span>
<span class="ltx_bibblock">
Steven J. Rennie, Etienne Marcheret, Youssef Mroueh, Jarret Ross, and Vaibhava
Goel.

</span>
<span class="ltx_bibblock">Self-critical Sequence Training for Image Captioning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Segui et al. (2015)</span>
<span class="ltx_bibblock">
Santi Segui, Oriol Pujol, and Jordi Vitria.

</span>
<span class="ltx_bibblock">Learning to count with deep object features.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CVPRW</em>, 2015.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shih et al. (2015)</span>
<span class="ltx_bibblock">
Kevin J. Shih, Saurabh Singh, and Derek Hoiem.

</span>
<span class="ltx_bibblock">Where To Look: Focus Regions for Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2015.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Socher et al. (2014)</span>
<span class="ltx_bibblock">
Richard Socher, Andrej Karpathy, Quoc V Le, Christopher D Manning, and Andrew Y
Ng.

</span>
<span class="ltx_bibblock">Grounded Compositional Semantics for Finding and Describing Images
with Sentences.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">TACL</em>, 2014.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teney et al. (2016)</span>
<span class="ltx_bibblock">
Damien Teney, Lingqiao Liu, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Graph-Structured Representations for Visual Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2016.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Teney et al. (2017)</span>
<span class="ltx_bibblock">
Damien Teney, Peter Anderson, Xiaodong He, and Anton van den Hengel.

</span>
<span class="ltx_bibblock">Tips and Tricks for Visual Question Answering: Learnings from the
2017 Challenge.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al. (2016)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Nal Kalchbrenner, Oriol Vinyals, Lasse Espeholt, Alex
Graves, and Koray Kavukcuoglu.

</span>
<span class="ltx_bibblock">Conditional Image Generation with PixelCNN Decoders.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">NIPS</em>, 2016.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
R J Williams.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following methods for connectionist
reinforcement learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Machine Learning</em>, 8:229–256, 1992.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams &amp; Peng (1991)</span>
<span class="ltx_bibblock">
Ronald J. Williams and Jing Peng.

</span>
<span class="ltx_bibblock">Function Optimization using Connectionist Reinforcement Learning
Algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Connection Science</em>, 3(3):241–268, 1991.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. (2016)</span>
<span class="ltx_bibblock">
Caiming Xiong, Stephen Merity, and Richard Socher.

</span>
<span class="ltx_bibblock">Dynamic Memory Networks for Visual and Textual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2016.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu &amp; Saenko (2015)</span>
<span class="ltx_bibblock">
Huijuan Xu and Kate Saenko.

</span>
<span class="ltx_bibblock">Ask, Attend and Answer: Exploring Question-Guided Spatial Attention
for Visual Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2015.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2015)</span>
<span class="ltx_bibblock">
Zichao Yang, Xiaodong He, Jianfeng Gao, Li Deng, and Alex Smola.

</span>
<span class="ltx_bibblock">Stacked Attention Networks for Image Question Answering.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2015.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2015)</span>
<span class="ltx_bibblock">
Cong Zhang, Hongsheng Li, Xiaogang Wang, and Xiaokang Yang.

</span>
<span class="ltx_bibblock">Cross-scene crowd counting via deep convolutional neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2015.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2017)</span>
<span class="ltx_bibblock">
Jianming Zhang, Shugao Ma, Mehrnoosh Sameki, Stan Sclaroff, Margrit Betke, Zhe
Lin, Xiaohui Shen, Brian Price, and Radomír Měch.

</span>
<span class="ltx_bibblock">Salient Object Subitizing.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 2017.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2015)</span>
<span class="ltx_bibblock">
Bolei Zhou, Yuandong Tian, Sainbayar Sukhbaatar, Arthur Szlam, and Rob Fergus.

</span>
<span class="ltx_bibblock">Simple Baseline for Visual Question Answering.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2015.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2015)</span>
<span class="ltx_bibblock">
Yuke Zhu, Oliver Groth, Michael Bernstein, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Visual7W: Grounded Question Answering in Images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2015.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Examples</h2>

<figure id="A1.F8" class="ltx_figure"><img src="/html/1712.08697/assets/figures/v2_many_examples.jpg" id="A1.F8.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="521" height="726" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>
Example outputs produced by each model. For SoftCount, objects are shaded according to the fractional count of each (0=transparent; 1=opaque). For UpDown, we similarly shade the objects but use the attention focus to determine opacity. For IRLC, we plot only the boxes from objects that were selected as part of the count.
</figcaption>
</figure>
<figure id="A1.F9" class="ltx_figure"><img src="/html/1712.08697/assets/figures/v2_evolution.jpg" id="A1.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="499" height="665" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>
Sequential counting of IRLC. At each timestep, we illustrate the unchosen boxes in pink, and shade each box according to <math id="A1.F9.5.m1.1" class="ltx_Math" alttext="\kappa^{t}" display="inline"><semantics id="A1.F9.5.m1.1b"><msup id="A1.F9.5.m1.1.1" xref="A1.F9.5.m1.1.1.cmml"><mi id="A1.F9.5.m1.1.1.2" xref="A1.F9.5.m1.1.1.2.cmml">κ</mi><mi id="A1.F9.5.m1.1.1.3" xref="A1.F9.5.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="A1.F9.5.m1.1c"><apply id="A1.F9.5.m1.1.1.cmml" xref="A1.F9.5.m1.1.1"><csymbol cd="ambiguous" id="A1.F9.5.m1.1.1.1.cmml" xref="A1.F9.5.m1.1.1">superscript</csymbol><ci id="A1.F9.5.m1.1.1.2.cmml" xref="A1.F9.5.m1.1.1.2">𝜅</ci><ci id="A1.F9.5.m1.1.1.3.cmml" xref="A1.F9.5.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.5.m1.1d">\kappa^{t}</annotation></semantics></math> (corresponding to the probability that the box would be selected at that time step; see main text). We also show the already-selected boxes in blue. For each of the questions, the counting sequence terminates at <math id="A1.F9.6.m2.1" class="ltx_Math" alttext="t=3" display="inline"><semantics id="A1.F9.6.m2.1b"><mrow id="A1.F9.6.m2.1.1" xref="A1.F9.6.m2.1.1.cmml"><mi id="A1.F9.6.m2.1.1.2" xref="A1.F9.6.m2.1.1.2.cmml">t</mi><mo id="A1.F9.6.m2.1.1.1" xref="A1.F9.6.m2.1.1.1.cmml">=</mo><mn id="A1.F9.6.m2.1.1.3" xref="A1.F9.6.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F9.6.m2.1c"><apply id="A1.F9.6.m2.1.1.cmml" xref="A1.F9.6.m2.1.1"><eq id="A1.F9.6.m2.1.1.1.cmml" xref="A1.F9.6.m2.1.1.1"></eq><ci id="A1.F9.6.m2.1.1.2.cmml" xref="A1.F9.6.m2.1.1.2">𝑡</ci><cn type="integer" id="A1.F9.6.m2.1.1.3.cmml" xref="A1.F9.6.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.6.m2.1d">t=3</annotation></semantics></math>, meaning that the returned count <math id="A1.F9.7.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A1.F9.7.m3.1b"><mi id="A1.F9.7.m3.1.1" xref="A1.F9.7.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A1.F9.7.m3.1c"><ci id="A1.F9.7.m3.1.1.cmml" xref="A1.F9.7.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.F9.7.m3.1d">C</annotation></semantics></math> is 3. For each of these questions, that is the correct answer. The example on the far right is a ‘correct failure,’ a case where the correct answer is returned but the counted objects are not related to the question. These kinds of subtle failures are revealed with the grounded counts.
</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Training and implementation details</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Caption Grounding</h3>

<div id="A2.SS1.p1" class="ltx_para ltx_noindent">
<p id="A2.SS1.p1.9" class="ltx_p">We experiment with jointly training counting and caption grounding. The goal of caption grounding is, given a set of objects and a caption, to identify the object that the caption describes.
Identical to the first stages of answering the counting question, we use an LSTM to encode the caption and compare it to each of the objects using the scoring function:</p>
<table id="A4.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E16.m1.1" class="ltx_Math" alttext="\displaystyle h^{t}" display="inline"><semantics id="A2.E16.m1.1a"><msup id="A2.E16.m1.1.1" xref="A2.E16.m1.1.1.cmml"><mi id="A2.E16.m1.1.1.2" xref="A2.E16.m1.1.1.2.cmml">h</mi><mi id="A2.E16.m1.1.1.3" xref="A2.E16.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="A2.E16.m1.1b"><apply id="A2.E16.m1.1.1.cmml" xref="A2.E16.m1.1.1"><csymbol cd="ambiguous" id="A2.E16.m1.1.1.1.cmml" xref="A2.E16.m1.1.1">superscript</csymbol><ci id="A2.E16.m1.1.1.2.cmml" xref="A2.E16.m1.1.1.2">ℎ</ci><ci id="A2.E16.m1.1.1.3.cmml" xref="A2.E16.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E16.m1.1c">\displaystyle h^{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E16.m2.2" class="ltx_Math" alttext="\displaystyle={\rm LSTM}\left(x^{t},h^{t-1}\right)" display="inline"><semantics id="A2.E16.m2.2a"><mrow id="A2.E16.m2.2.2" xref="A2.E16.m2.2.2.cmml"><mi id="A2.E16.m2.2.2.4" xref="A2.E16.m2.2.2.4.cmml"></mi><mo id="A2.E16.m2.2.2.3" xref="A2.E16.m2.2.2.3.cmml">=</mo><mrow id="A2.E16.m2.2.2.2" xref="A2.E16.m2.2.2.2.cmml"><mi id="A2.E16.m2.2.2.2.4" xref="A2.E16.m2.2.2.2.4.cmml">LSTM</mi><mo lspace="0em" rspace="0em" id="A2.E16.m2.2.2.2.3" xref="A2.E16.m2.2.2.2.3.cmml">​</mo><mrow id="A2.E16.m2.2.2.2.2.2" xref="A2.E16.m2.2.2.2.2.3.cmml"><mo id="A2.E16.m2.2.2.2.2.2.3" xref="A2.E16.m2.2.2.2.2.3.cmml">(</mo><msup id="A2.E16.m2.1.1.1.1.1.1" xref="A2.E16.m2.1.1.1.1.1.1.cmml"><mi id="A2.E16.m2.1.1.1.1.1.1.2" xref="A2.E16.m2.1.1.1.1.1.1.2.cmml">x</mi><mi id="A2.E16.m2.1.1.1.1.1.1.3" xref="A2.E16.m2.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="A2.E16.m2.2.2.2.2.2.4" xref="A2.E16.m2.2.2.2.2.3.cmml">,</mo><msup id="A2.E16.m2.2.2.2.2.2.2" xref="A2.E16.m2.2.2.2.2.2.2.cmml"><mi id="A2.E16.m2.2.2.2.2.2.2.2" xref="A2.E16.m2.2.2.2.2.2.2.2.cmml">h</mi><mrow id="A2.E16.m2.2.2.2.2.2.2.3" xref="A2.E16.m2.2.2.2.2.2.2.3.cmml"><mi id="A2.E16.m2.2.2.2.2.2.2.3.2" xref="A2.E16.m2.2.2.2.2.2.2.3.2.cmml">t</mi><mo id="A2.E16.m2.2.2.2.2.2.2.3.1" xref="A2.E16.m2.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="A2.E16.m2.2.2.2.2.2.2.3.3" xref="A2.E16.m2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msup><mo id="A2.E16.m2.2.2.2.2.2.5" xref="A2.E16.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E16.m2.2b"><apply id="A2.E16.m2.2.2.cmml" xref="A2.E16.m2.2.2"><eq id="A2.E16.m2.2.2.3.cmml" xref="A2.E16.m2.2.2.3"></eq><csymbol cd="latexml" id="A2.E16.m2.2.2.4.cmml" xref="A2.E16.m2.2.2.4">absent</csymbol><apply id="A2.E16.m2.2.2.2.cmml" xref="A2.E16.m2.2.2.2"><times id="A2.E16.m2.2.2.2.3.cmml" xref="A2.E16.m2.2.2.2.3"></times><ci id="A2.E16.m2.2.2.2.4.cmml" xref="A2.E16.m2.2.2.2.4">LSTM</ci><interval closure="open" id="A2.E16.m2.2.2.2.2.3.cmml" xref="A2.E16.m2.2.2.2.2.2"><apply id="A2.E16.m2.1.1.1.1.1.1.cmml" xref="A2.E16.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E16.m2.1.1.1.1.1.1.1.cmml" xref="A2.E16.m2.1.1.1.1.1.1">superscript</csymbol><ci id="A2.E16.m2.1.1.1.1.1.1.2.cmml" xref="A2.E16.m2.1.1.1.1.1.1.2">𝑥</ci><ci id="A2.E16.m2.1.1.1.1.1.1.3.cmml" xref="A2.E16.m2.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="A2.E16.m2.2.2.2.2.2.2.cmml" xref="A2.E16.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A2.E16.m2.2.2.2.2.2.2.1.cmml" xref="A2.E16.m2.2.2.2.2.2.2">superscript</csymbol><ci id="A2.E16.m2.2.2.2.2.2.2.2.cmml" xref="A2.E16.m2.2.2.2.2.2.2.2">ℎ</ci><apply id="A2.E16.m2.2.2.2.2.2.2.3.cmml" xref="A2.E16.m2.2.2.2.2.2.2.3"><minus id="A2.E16.m2.2.2.2.2.2.2.3.1.cmml" xref="A2.E16.m2.2.2.2.2.2.2.3.1"></minus><ci id="A2.E16.m2.2.2.2.2.2.2.3.2.cmml" xref="A2.E16.m2.2.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="A2.E16.m2.2.2.2.2.2.2.3.3.cmml" xref="A2.E16.m2.2.2.2.2.2.2.3.3">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E16.m2.2c">\displaystyle={\rm LSTM}\left(x^{t},h^{t-1}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="A2.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E17.m1.1" class="ltx_Math" alttext="\displaystyle s_{i}" display="inline"><semantics id="A2.E17.m1.1a"><msub id="A2.E17.m1.1.1" xref="A2.E17.m1.1.1.cmml"><mi id="A2.E17.m1.1.1.2" xref="A2.E17.m1.1.1.2.cmml">s</mi><mi id="A2.E17.m1.1.1.3" xref="A2.E17.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.E17.m1.1b"><apply id="A2.E17.m1.1.1.cmml" xref="A2.E17.m1.1.1"><csymbol cd="ambiguous" id="A2.E17.m1.1.1.1.cmml" xref="A2.E17.m1.1.1">subscript</csymbol><ci id="A2.E17.m1.1.1.2.cmml" xref="A2.E17.m1.1.1.2">𝑠</ci><ci id="A2.E17.m1.1.1.3.cmml" xref="A2.E17.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E17.m1.1c">\displaystyle s_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E17.m2.1" class="ltx_Math" alttext="\displaystyle={f}^{S}\left({\left[{h^{T}},{v_{i}}\right]}\right)" display="inline"><semantics id="A2.E17.m2.1a"><mrow id="A2.E17.m2.1.1" xref="A2.E17.m2.1.1.cmml"><mi id="A2.E17.m2.1.1.3" xref="A2.E17.m2.1.1.3.cmml"></mi><mo id="A2.E17.m2.1.1.2" xref="A2.E17.m2.1.1.2.cmml">=</mo><mrow id="A2.E17.m2.1.1.1" xref="A2.E17.m2.1.1.1.cmml"><msup id="A2.E17.m2.1.1.1.3" xref="A2.E17.m2.1.1.1.3.cmml"><mi id="A2.E17.m2.1.1.1.3.2" xref="A2.E17.m2.1.1.1.3.2.cmml">f</mi><mi id="A2.E17.m2.1.1.1.3.3" xref="A2.E17.m2.1.1.1.3.3.cmml">S</mi></msup><mo lspace="0em" rspace="0em" id="A2.E17.m2.1.1.1.2" xref="A2.E17.m2.1.1.1.2.cmml">​</mo><mrow id="A2.E17.m2.1.1.1.1.1" xref="A2.E17.m2.1.1.1.cmml"><mo id="A2.E17.m2.1.1.1.1.1.2" xref="A2.E17.m2.1.1.1.cmml">(</mo><mrow id="A2.E17.m2.1.1.1.1.1.1.2" xref="A2.E17.m2.1.1.1.1.1.1.3.cmml"><mo id="A2.E17.m2.1.1.1.1.1.1.2.3" xref="A2.E17.m2.1.1.1.1.1.1.3.cmml">[</mo><msup id="A2.E17.m2.1.1.1.1.1.1.1.1" xref="A2.E17.m2.1.1.1.1.1.1.1.1.cmml"><mi id="A2.E17.m2.1.1.1.1.1.1.1.1.2" xref="A2.E17.m2.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="A2.E17.m2.1.1.1.1.1.1.1.1.3" xref="A2.E17.m2.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo id="A2.E17.m2.1.1.1.1.1.1.2.4" xref="A2.E17.m2.1.1.1.1.1.1.3.cmml">,</mo><msub id="A2.E17.m2.1.1.1.1.1.1.2.2" xref="A2.E17.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A2.E17.m2.1.1.1.1.1.1.2.2.2" xref="A2.E17.m2.1.1.1.1.1.1.2.2.2.cmml">v</mi><mi id="A2.E17.m2.1.1.1.1.1.1.2.2.3" xref="A2.E17.m2.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="A2.E17.m2.1.1.1.1.1.1.2.5" xref="A2.E17.m2.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo id="A2.E17.m2.1.1.1.1.1.3" xref="A2.E17.m2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E17.m2.1b"><apply id="A2.E17.m2.1.1.cmml" xref="A2.E17.m2.1.1"><eq id="A2.E17.m2.1.1.2.cmml" xref="A2.E17.m2.1.1.2"></eq><csymbol cd="latexml" id="A2.E17.m2.1.1.3.cmml" xref="A2.E17.m2.1.1.3">absent</csymbol><apply id="A2.E17.m2.1.1.1.cmml" xref="A2.E17.m2.1.1.1"><times id="A2.E17.m2.1.1.1.2.cmml" xref="A2.E17.m2.1.1.1.2"></times><apply id="A2.E17.m2.1.1.1.3.cmml" xref="A2.E17.m2.1.1.1.3"><csymbol cd="ambiguous" id="A2.E17.m2.1.1.1.3.1.cmml" xref="A2.E17.m2.1.1.1.3">superscript</csymbol><ci id="A2.E17.m2.1.1.1.3.2.cmml" xref="A2.E17.m2.1.1.1.3.2">𝑓</ci><ci id="A2.E17.m2.1.1.1.3.3.cmml" xref="A2.E17.m2.1.1.1.3.3">𝑆</ci></apply><interval closure="closed" id="A2.E17.m2.1.1.1.1.1.1.3.cmml" xref="A2.E17.m2.1.1.1.1.1.1.2"><apply id="A2.E17.m2.1.1.1.1.1.1.1.1.cmml" xref="A2.E17.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.E17.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.E17.m2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A2.E17.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A2.E17.m2.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="A2.E17.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A2.E17.m2.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><apply id="A2.E17.m2.1.1.1.1.1.1.2.2.cmml" xref="A2.E17.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.E17.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A2.E17.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A2.E17.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A2.E17.m2.1.1.1.1.1.1.2.2.2">𝑣</ci><ci id="A2.E17.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A2.E17.m2.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E17.m2.1c">\displaystyle={f}^{S}\left({\left[{h^{T}},{v_{i}}\right]}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="A2.SS1.p1.8" class="ltx_p">where <math id="A2.SS1.p1.1.m1.1" class="ltx_Math" alttext="h\in\mathbb{R}^{1024}" display="inline"><semantics id="A2.SS1.p1.1.m1.1a"><mrow id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mi id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">h</mi><mo id="A2.SS1.p1.1.m1.1.1.1" xref="A2.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml"><mi id="A2.SS1.p1.1.m1.1.1.3.2" xref="A2.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mn id="A2.SS1.p1.1.m1.1.1.3.3" xref="A2.SS1.p1.1.m1.1.1.3.3.cmml">1024</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><in id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1.1"></in><ci id="A2.SS1.p1.1.m1.1.1.2.cmml" xref="A2.SS1.p1.1.m1.1.1.2">ℎ</ci><apply id="A2.SS1.p1.1.m1.1.1.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.1.3.1.cmml" xref="A2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.3.2.cmml" xref="A2.SS1.p1.1.m1.1.1.3.2">ℝ</ci><cn type="integer" id="A2.SS1.p1.1.m1.1.1.3.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3.3">1024</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">h\in\mathbb{R}^{1024}</annotation></semantics></math>, <math id="A2.SS1.p1.2.m2.1" class="ltx_Math" alttext="x^{t}_{i}\in\mathbb{R}^{300}" display="inline"><semantics id="A2.SS1.p1.2.m2.1a"><mrow id="A2.SS1.p1.2.m2.1.1" xref="A2.SS1.p1.2.m2.1.1.cmml"><msubsup id="A2.SS1.p1.2.m2.1.1.2" xref="A2.SS1.p1.2.m2.1.1.2.cmml"><mi id="A2.SS1.p1.2.m2.1.1.2.2.2" xref="A2.SS1.p1.2.m2.1.1.2.2.2.cmml">x</mi><mi id="A2.SS1.p1.2.m2.1.1.2.3" xref="A2.SS1.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="A2.SS1.p1.2.m2.1.1.2.2.3" xref="A2.SS1.p1.2.m2.1.1.2.2.3.cmml">t</mi></msubsup><mo id="A2.SS1.p1.2.m2.1.1.1" xref="A2.SS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="A2.SS1.p1.2.m2.1.1.3" xref="A2.SS1.p1.2.m2.1.1.3.cmml"><mi id="A2.SS1.p1.2.m2.1.1.3.2" xref="A2.SS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mn id="A2.SS1.p1.2.m2.1.1.3.3" xref="A2.SS1.p1.2.m2.1.1.3.3.cmml">300</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.2.m2.1b"><apply id="A2.SS1.p1.2.m2.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1"><in id="A2.SS1.p1.2.m2.1.1.1.cmml" xref="A2.SS1.p1.2.m2.1.1.1"></in><apply id="A2.SS1.p1.2.m2.1.1.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.1.2.1.cmml" xref="A2.SS1.p1.2.m2.1.1.2">subscript</csymbol><apply id="A2.SS1.p1.2.m2.1.1.2.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.1.2.2.1.cmml" xref="A2.SS1.p1.2.m2.1.1.2">superscript</csymbol><ci id="A2.SS1.p1.2.m2.1.1.2.2.2.cmml" xref="A2.SS1.p1.2.m2.1.1.2.2.2">𝑥</ci><ci id="A2.SS1.p1.2.m2.1.1.2.2.3.cmml" xref="A2.SS1.p1.2.m2.1.1.2.2.3">𝑡</ci></apply><ci id="A2.SS1.p1.2.m2.1.1.2.3.cmml" xref="A2.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><apply id="A2.SS1.p1.2.m2.1.1.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.2.m2.1.1.3.1.cmml" xref="A2.SS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.2.m2.1.1.3.2.cmml" xref="A2.SS1.p1.2.m2.1.1.3.2">ℝ</ci><cn type="integer" id="A2.SS1.p1.2.m2.1.1.3.3.cmml" xref="A2.SS1.p1.2.m2.1.1.3.3">300</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.2.m2.1c">x^{t}_{i}\in\mathbb{R}^{300}</annotation></semantics></math> is the embedding for the token at timestep <math id="A2.SS1.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A2.SS1.p1.3.m3.1a"><mi id="A2.SS1.p1.3.m3.1.1" xref="A2.SS1.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.3.m3.1b"><ci id="A2.SS1.p1.3.m3.1.1.cmml" xref="A2.SS1.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.3.m3.1c">t</annotation></semantics></math> of the caption, <math id="A2.SS1.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="A2.SS1.p1.4.m4.1a"><mi id="A2.SS1.p1.4.m4.1.1" xref="A2.SS1.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.4.m4.1b"><ci id="A2.SS1.p1.4.m4.1.1.cmml" xref="A2.SS1.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.4.m4.1c">T</annotation></semantics></math> is the caption length, and <math id="A2.SS1.p1.5.m5.1" class="ltx_Math" alttext="{f}^{S}:\mathbb{R}^{m}\rightarrow\mathbb{R}^{n}" display="inline"><semantics id="A2.SS1.p1.5.m5.1a"><mrow id="A2.SS1.p1.5.m5.1.1" xref="A2.SS1.p1.5.m5.1.1.cmml"><msup id="A2.SS1.p1.5.m5.1.1.2" xref="A2.SS1.p1.5.m5.1.1.2.cmml"><mi id="A2.SS1.p1.5.m5.1.1.2.2" xref="A2.SS1.p1.5.m5.1.1.2.2.cmml">f</mi><mi id="A2.SS1.p1.5.m5.1.1.2.3" xref="A2.SS1.p1.5.m5.1.1.2.3.cmml">S</mi></msup><mo lspace="0.278em" rspace="0.278em" id="A2.SS1.p1.5.m5.1.1.1" xref="A2.SS1.p1.5.m5.1.1.1.cmml">:</mo><mrow id="A2.SS1.p1.5.m5.1.1.3" xref="A2.SS1.p1.5.m5.1.1.3.cmml"><msup id="A2.SS1.p1.5.m5.1.1.3.2" xref="A2.SS1.p1.5.m5.1.1.3.2.cmml"><mi id="A2.SS1.p1.5.m5.1.1.3.2.2" xref="A2.SS1.p1.5.m5.1.1.3.2.2.cmml">ℝ</mi><mi id="A2.SS1.p1.5.m5.1.1.3.2.3" xref="A2.SS1.p1.5.m5.1.1.3.2.3.cmml">m</mi></msup><mo stretchy="false" id="A2.SS1.p1.5.m5.1.1.3.1" xref="A2.SS1.p1.5.m5.1.1.3.1.cmml">→</mo><msup id="A2.SS1.p1.5.m5.1.1.3.3" xref="A2.SS1.p1.5.m5.1.1.3.3.cmml"><mi id="A2.SS1.p1.5.m5.1.1.3.3.2" xref="A2.SS1.p1.5.m5.1.1.3.3.2.cmml">ℝ</mi><mi id="A2.SS1.p1.5.m5.1.1.3.3.3" xref="A2.SS1.p1.5.m5.1.1.3.3.3.cmml">n</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.5.m5.1b"><apply id="A2.SS1.p1.5.m5.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1"><ci id="A2.SS1.p1.5.m5.1.1.1.cmml" xref="A2.SS1.p1.5.m5.1.1.1">:</ci><apply id="A2.SS1.p1.5.m5.1.1.2.cmml" xref="A2.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="A2.SS1.p1.5.m5.1.1.2.1.cmml" xref="A2.SS1.p1.5.m5.1.1.2">superscript</csymbol><ci id="A2.SS1.p1.5.m5.1.1.2.2.cmml" xref="A2.SS1.p1.5.m5.1.1.2.2">𝑓</ci><ci id="A2.SS1.p1.5.m5.1.1.2.3.cmml" xref="A2.SS1.p1.5.m5.1.1.2.3">𝑆</ci></apply><apply id="A2.SS1.p1.5.m5.1.1.3.cmml" xref="A2.SS1.p1.5.m5.1.1.3"><ci id="A2.SS1.p1.5.m5.1.1.3.1.cmml" xref="A2.SS1.p1.5.m5.1.1.3.1">→</ci><apply id="A2.SS1.p1.5.m5.1.1.3.2.cmml" xref="A2.SS1.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="A2.SS1.p1.5.m5.1.1.3.2.1.cmml" xref="A2.SS1.p1.5.m5.1.1.3.2">superscript</csymbol><ci id="A2.SS1.p1.5.m5.1.1.3.2.2.cmml" xref="A2.SS1.p1.5.m5.1.1.3.2.2">ℝ</ci><ci id="A2.SS1.p1.5.m5.1.1.3.2.3.cmml" xref="A2.SS1.p1.5.m5.1.1.3.2.3">𝑚</ci></apply><apply id="A2.SS1.p1.5.m5.1.1.3.3.cmml" xref="A2.SS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="A2.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="A2.SS1.p1.5.m5.1.1.3.3">superscript</csymbol><ci id="A2.SS1.p1.5.m5.1.1.3.3.2.cmml" xref="A2.SS1.p1.5.m5.1.1.3.3.2">ℝ</ci><ci id="A2.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="A2.SS1.p1.5.m5.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.5.m5.1c">{f}^{S}:\mathbb{R}^{m}\rightarrow\mathbb{R}^{n}</annotation></semantics></math> is the scoring function (Sec. <a href="#S4.SS3" title="4.3 Counting ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>).
The embedding of object <math id="A2.SS1.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A2.SS1.p1.6.m6.1a"><mi id="A2.SS1.p1.6.m6.1.1" xref="A2.SS1.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.6.m6.1b"><ci id="A2.SS1.p1.6.m6.1.1.cmml" xref="A2.SS1.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.6.m6.1c">i</annotation></semantics></math> is denoted by <math id="A2.SS1.p1.7.m7.1" class="ltx_Math" alttext="v_{i}" display="inline"><semantics id="A2.SS1.p1.7.m7.1a"><msub id="A2.SS1.p1.7.m7.1.1" xref="A2.SS1.p1.7.m7.1.1.cmml"><mi id="A2.SS1.p1.7.m7.1.1.2" xref="A2.SS1.p1.7.m7.1.1.2.cmml">v</mi><mi id="A2.SS1.p1.7.m7.1.1.3" xref="A2.SS1.p1.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.7.m7.1b"><apply id="A2.SS1.p1.7.m7.1.1.cmml" xref="A2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.7.m7.1.1.1.cmml" xref="A2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="A2.SS1.p1.7.m7.1.1.2.cmml" xref="A2.SS1.p1.7.m7.1.1.2">𝑣</ci><ci id="A2.SS1.p1.7.m7.1.1.3.cmml" xref="A2.SS1.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.7.m7.1c">v_{i}</annotation></semantics></math> and the relevance of this object to the caption is encoded by the score vector <math id="A2.SS1.p1.8.m8.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="A2.SS1.p1.8.m8.1a"><msub id="A2.SS1.p1.8.m8.1.1" xref="A2.SS1.p1.8.m8.1.1.cmml"><mi id="A2.SS1.p1.8.m8.1.1.2" xref="A2.SS1.p1.8.m8.1.1.2.cmml">s</mi><mi id="A2.SS1.p1.8.m8.1.1.3" xref="A2.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.8.m8.1b"><apply id="A2.SS1.p1.8.m8.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A2.SS1.p1.8.m8.1.1.1.cmml" xref="A2.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="A2.SS1.p1.8.m8.1.1.2.cmml" xref="A2.SS1.p1.8.m8.1.1.2">𝑠</ci><ci id="A2.SS1.p1.8.m8.1.1.3.cmml" xref="A2.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.8.m8.1c">s_{i}</annotation></semantics></math>.</p>
</div>
<div id="A2.SS1.p2" class="ltx_para ltx_noindent">
<p id="A2.SS1.p2.5" class="ltx_p">We project each such score vector to a scalar logit <math id="A2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\alpha_{i}" display="inline"><semantics id="A2.SS1.p2.1.m1.1a"><msub id="A2.SS1.p2.1.m1.1.1" xref="A2.SS1.p2.1.m1.1.1.cmml"><mi id="A2.SS1.p2.1.m1.1.1.2" xref="A2.SS1.p2.1.m1.1.1.2.cmml">α</mi><mi id="A2.SS1.p2.1.m1.1.1.3" xref="A2.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.1.m1.1b"><apply id="A2.SS1.p2.1.m1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.1.m1.1.1.1.cmml" xref="A2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="A2.SS1.p2.1.m1.1.1.2.cmml" xref="A2.SS1.p2.1.m1.1.1.2">𝛼</ci><ci id="A2.SS1.p2.1.m1.1.1.3.cmml" xref="A2.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.1.m1.1c">\alpha_{i}</annotation></semantics></math> and apply a softmax nonlinearity to estimate <math id="A2.SS1.p2.2.m2.1" class="ltx_Math" alttext="p\in\mathbb{R}^{N}" display="inline"><semantics id="A2.SS1.p2.2.m2.1a"><mrow id="A2.SS1.p2.2.m2.1.1" xref="A2.SS1.p2.2.m2.1.1.cmml"><mi id="A2.SS1.p2.2.m2.1.1.2" xref="A2.SS1.p2.2.m2.1.1.2.cmml">p</mi><mo id="A2.SS1.p2.2.m2.1.1.1" xref="A2.SS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="A2.SS1.p2.2.m2.1.1.3" xref="A2.SS1.p2.2.m2.1.1.3.cmml"><mi id="A2.SS1.p2.2.m2.1.1.3.2" xref="A2.SS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="A2.SS1.p2.2.m2.1.1.3.3" xref="A2.SS1.p2.2.m2.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.2.m2.1b"><apply id="A2.SS1.p2.2.m2.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1"><in id="A2.SS1.p2.2.m2.1.1.1.cmml" xref="A2.SS1.p2.2.m2.1.1.1"></in><ci id="A2.SS1.p2.2.m2.1.1.2.cmml" xref="A2.SS1.p2.2.m2.1.1.2">𝑝</ci><apply id="A2.SS1.p2.2.m2.1.1.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p2.2.m2.1.1.3.1.cmml" xref="A2.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="A2.SS1.p2.2.m2.1.1.3.2.cmml" xref="A2.SS1.p2.2.m2.1.1.3.2">ℝ</ci><ci id="A2.SS1.p2.2.m2.1.1.3.3.cmml" xref="A2.SS1.p2.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.2.m2.1c">p\in\mathbb{R}^{N}</annotation></semantics></math>, where <math id="A2.SS1.p2.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A2.SS1.p2.3.m3.1a"><mi id="A2.SS1.p2.3.m3.1.1" xref="A2.SS1.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.3.m3.1b"><ci id="A2.SS1.p2.3.m3.1.1.cmml" xref="A2.SS1.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.3.m3.1c">N</annotation></semantics></math> is the number of object proposals and <math id="A2.SS1.p2.4.m4.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="A2.SS1.p2.4.m4.1a"><msub id="A2.SS1.p2.4.m4.1.1" xref="A2.SS1.p2.4.m4.1.1.cmml"><mi id="A2.SS1.p2.4.m4.1.1.2" xref="A2.SS1.p2.4.m4.1.1.2.cmml">p</mi><mi id="A2.SS1.p2.4.m4.1.1.3" xref="A2.SS1.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.4.m4.1b"><apply id="A2.SS1.p2.4.m4.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A2.SS1.p2.4.m4.1.1.1.cmml" xref="A2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="A2.SS1.p2.4.m4.1.1.2.cmml" xref="A2.SS1.p2.4.m4.1.1.2">𝑝</ci><ci id="A2.SS1.p2.4.m4.1.1.3.cmml" xref="A2.SS1.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.4.m4.1c">p_{i}</annotation></semantics></math> denotes the probability that the caption describes object proposal <math id="A2.SS1.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A2.SS1.p2.5.m5.1a"><mi id="A2.SS1.p2.5.m5.1.1" xref="A2.SS1.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p2.5.m5.1b"><ci id="A2.SS1.p2.5.m5.1.1.cmml" xref="A2.SS1.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p2.5.m5.1c">i</annotation></semantics></math>:</p>
<table id="A4.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E18.m1.1" class="ltx_Math" alttext="\displaystyle\alpha_{i}" display="inline"><semantics id="A2.E18.m1.1a"><msub id="A2.E18.m1.1.1" xref="A2.E18.m1.1.1.cmml"><mi id="A2.E18.m1.1.1.2" xref="A2.E18.m1.1.1.2.cmml">α</mi><mi id="A2.E18.m1.1.1.3" xref="A2.E18.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A2.E18.m1.1b"><apply id="A2.E18.m1.1.1.cmml" xref="A2.E18.m1.1.1"><csymbol cd="ambiguous" id="A2.E18.m1.1.1.1.cmml" xref="A2.E18.m1.1.1">subscript</csymbol><ci id="A2.E18.m1.1.1.2.cmml" xref="A2.E18.m1.1.1.2">𝛼</ci><ci id="A2.E18.m1.1.1.3.cmml" xref="A2.E18.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E18.m1.1c">\displaystyle\alpha_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E18.m2.1" class="ltx_Math" alttext="\displaystyle=Ws_{i}+b" display="inline"><semantics id="A2.E18.m2.1a"><mrow id="A2.E18.m2.1.1" xref="A2.E18.m2.1.1.cmml"><mi id="A2.E18.m2.1.1.2" xref="A2.E18.m2.1.1.2.cmml"></mi><mo id="A2.E18.m2.1.1.1" xref="A2.E18.m2.1.1.1.cmml">=</mo><mrow id="A2.E18.m2.1.1.3" xref="A2.E18.m2.1.1.3.cmml"><mrow id="A2.E18.m2.1.1.3.2" xref="A2.E18.m2.1.1.3.2.cmml"><mi id="A2.E18.m2.1.1.3.2.2" xref="A2.E18.m2.1.1.3.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="A2.E18.m2.1.1.3.2.1" xref="A2.E18.m2.1.1.3.2.1.cmml">​</mo><msub id="A2.E18.m2.1.1.3.2.3" xref="A2.E18.m2.1.1.3.2.3.cmml"><mi id="A2.E18.m2.1.1.3.2.3.2" xref="A2.E18.m2.1.1.3.2.3.2.cmml">s</mi><mi id="A2.E18.m2.1.1.3.2.3.3" xref="A2.E18.m2.1.1.3.2.3.3.cmml">i</mi></msub></mrow><mo id="A2.E18.m2.1.1.3.1" xref="A2.E18.m2.1.1.3.1.cmml">+</mo><mi id="A2.E18.m2.1.1.3.3" xref="A2.E18.m2.1.1.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.E18.m2.1b"><apply id="A2.E18.m2.1.1.cmml" xref="A2.E18.m2.1.1"><eq id="A2.E18.m2.1.1.1.cmml" xref="A2.E18.m2.1.1.1"></eq><csymbol cd="latexml" id="A2.E18.m2.1.1.2.cmml" xref="A2.E18.m2.1.1.2">absent</csymbol><apply id="A2.E18.m2.1.1.3.cmml" xref="A2.E18.m2.1.1.3"><plus id="A2.E18.m2.1.1.3.1.cmml" xref="A2.E18.m2.1.1.3.1"></plus><apply id="A2.E18.m2.1.1.3.2.cmml" xref="A2.E18.m2.1.1.3.2"><times id="A2.E18.m2.1.1.3.2.1.cmml" xref="A2.E18.m2.1.1.3.2.1"></times><ci id="A2.E18.m2.1.1.3.2.2.cmml" xref="A2.E18.m2.1.1.3.2.2">𝑊</ci><apply id="A2.E18.m2.1.1.3.2.3.cmml" xref="A2.E18.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="A2.E18.m2.1.1.3.2.3.1.cmml" xref="A2.E18.m2.1.1.3.2.3">subscript</csymbol><ci id="A2.E18.m2.1.1.3.2.3.2.cmml" xref="A2.E18.m2.1.1.3.2.3.2">𝑠</ci><ci id="A2.E18.m2.1.1.3.2.3.3.cmml" xref="A2.E18.m2.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="A2.E18.m2.1.1.3.3.cmml" xref="A2.E18.m2.1.1.3.3">𝑏</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E18.m2.1c">\displaystyle=Ws_{i}+b</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
<tbody id="A2.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.E19.m1.1" class="ltx_Math" alttext="\displaystyle p" display="inline"><semantics id="A2.E19.m1.1a"><mi id="A2.E19.m1.1.1" xref="A2.E19.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A2.E19.m1.1b"><ci id="A2.E19.m1.1.1.cmml" xref="A2.E19.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.E19.m1.1c">\displaystyle p</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.E19.m2.2" class="ltx_Math" alttext="\displaystyle={\rm softmax}\left(\alpha\right)." display="inline"><semantics id="A2.E19.m2.2a"><mrow id="A2.E19.m2.2.2.1" xref="A2.E19.m2.2.2.1.1.cmml"><mrow id="A2.E19.m2.2.2.1.1" xref="A2.E19.m2.2.2.1.1.cmml"><mi id="A2.E19.m2.2.2.1.1.2" xref="A2.E19.m2.2.2.1.1.2.cmml"></mi><mo id="A2.E19.m2.2.2.1.1.1" xref="A2.E19.m2.2.2.1.1.1.cmml">=</mo><mrow id="A2.E19.m2.2.2.1.1.3" xref="A2.E19.m2.2.2.1.1.3.cmml"><mi id="A2.E19.m2.2.2.1.1.3.2" xref="A2.E19.m2.2.2.1.1.3.2.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="A2.E19.m2.2.2.1.1.3.1" xref="A2.E19.m2.2.2.1.1.3.1.cmml">​</mo><mrow id="A2.E19.m2.2.2.1.1.3.3.2" xref="A2.E19.m2.2.2.1.1.3.cmml"><mo id="A2.E19.m2.2.2.1.1.3.3.2.1" xref="A2.E19.m2.2.2.1.1.3.cmml">(</mo><mi id="A2.E19.m2.1.1" xref="A2.E19.m2.1.1.cmml">α</mi><mo id="A2.E19.m2.2.2.1.1.3.3.2.2" xref="A2.E19.m2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A2.E19.m2.2.2.1.2" xref="A2.E19.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.E19.m2.2b"><apply id="A2.E19.m2.2.2.1.1.cmml" xref="A2.E19.m2.2.2.1"><eq id="A2.E19.m2.2.2.1.1.1.cmml" xref="A2.E19.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="A2.E19.m2.2.2.1.1.2.cmml" xref="A2.E19.m2.2.2.1.1.2">absent</csymbol><apply id="A2.E19.m2.2.2.1.1.3.cmml" xref="A2.E19.m2.2.2.1.1.3"><times id="A2.E19.m2.2.2.1.1.3.1.cmml" xref="A2.E19.m2.2.2.1.1.3.1"></times><ci id="A2.E19.m2.2.2.1.1.3.2.cmml" xref="A2.E19.m2.2.2.1.1.3.2">softmax</ci><ci id="A2.E19.m2.1.1.cmml" xref="A2.E19.m2.1.1">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.E19.m2.2c">\displaystyle={\rm softmax}\left(\alpha\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div id="A2.SS1.p3" class="ltx_para ltx_noindent">
<p id="A2.SS1.p3.1" class="ltx_p">During training, we randomly select four of the images in the batch of examples to use for caption grounding (rather than the full 32 images that make up a batch).
To create training data from the region captions in Visual Genome, we assign each caption to one of the detected object proposals.
To do so, we compute the intersection over union between the ground truth region that the caption describes and the coordinates of each object proposal.
We assign the object proposal with the largest IoU to the caption.
If the maximum IoU for the given caption is less than 0.5, we ignore it during training.
We compute the grounding probability <math id="A2.SS1.p3.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="A2.SS1.p3.1.m1.1a"><mi id="A2.SS1.p3.1.m1.1.1" xref="A2.SS1.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="A2.SS1.p3.1.m1.1b"><ci id="A2.SS1.p3.1.m1.1.1.cmml" xref="A2.SS1.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p3.1.m1.1c">p</annotation></semantics></math> for each caption to which we can successfully assign a detection and train using the cross entropy loss averaged over the captions.
We weight the loss associated with caption grounding by 0.1 relative to the counting loss.</p>
</div>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Counting models</h3>

<div id="A2.SS2.p1" class="ltx_para ltx_noindent">
<p id="A2.SS2.p1.1" class="ltx_p">Each of the considered counting models makes use of the same basic architecture for encoding the question and comparing it with each of the detected objects.
For each model, we initialized the word embeddings from GloVe <cite class="ltx_cite ltx_citemacro_citep">(Pennington et al., <a href="#bib.bib29" title="" class="ltx_ref">2014</a>)</cite> and encoded the question with an LSTM of hidden size 1024.
The only differences in the model-specific implementations of the language module was the hidden size of the scoring function <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="{f}^{S}" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><msup id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml"><mi id="A2.SS2.p1.1.m1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.cmml">f</mi><mi id="A2.SS2.p1.1.m1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="A2.SS2.p1.1.m1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.2">𝑓</ci><ci id="A2.SS2.p1.1.m1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">{f}^{S}</annotation></semantics></math>.
We determined these specifics from the optimal settings observed during initial experiments.
We use a hidden size of 512 for SoftCount and UpDown and a hidden size of 2048 for IRLC.
We observed that the former two models were more prone to overfitting, whereas IRLC benefited from the increased capacity.</p>
</div>
<div id="A2.SS2.p2" class="ltx_para ltx_noindent">
<p id="A2.SS2.p2.2" class="ltx_p">When training on counting, we optimize using Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib16" title="" class="ltx_ref">2014</a>)</cite>.
For SoftCount and UpDown, we use a learning rate of <math id="A2.SS2.p2.1.m1.1" class="ltx_Math" alttext="3\texttt{x}10^{-4}" display="inline"><semantics id="A2.SS2.p2.1.m1.1a"><mrow id="A2.SS2.p2.1.m1.1.1" xref="A2.SS2.p2.1.m1.1.1.cmml"><mn id="A2.SS2.p2.1.m1.1.1.2" xref="A2.SS2.p2.1.m1.1.1.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p2.1.m1.1.1.1" xref="A2.SS2.p2.1.m1.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="A2.SS2.p2.1.m1.1.1.3" xref="A2.SS2.p2.1.m1.1.1.3a.cmml">x</mtext><mo lspace="0em" rspace="0em" id="A2.SS2.p2.1.m1.1.1.1a" xref="A2.SS2.p2.1.m1.1.1.1.cmml">​</mo><msup id="A2.SS2.p2.1.m1.1.1.4" xref="A2.SS2.p2.1.m1.1.1.4.cmml"><mn id="A2.SS2.p2.1.m1.1.1.4.2" xref="A2.SS2.p2.1.m1.1.1.4.2.cmml">10</mn><mrow id="A2.SS2.p2.1.m1.1.1.4.3" xref="A2.SS2.p2.1.m1.1.1.4.3.cmml"><mo id="A2.SS2.p2.1.m1.1.1.4.3a" xref="A2.SS2.p2.1.m1.1.1.4.3.cmml">−</mo><mn id="A2.SS2.p2.1.m1.1.1.4.3.2" xref="A2.SS2.p2.1.m1.1.1.4.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.1.m1.1b"><apply id="A2.SS2.p2.1.m1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1"><times id="A2.SS2.p2.1.m1.1.1.1.cmml" xref="A2.SS2.p2.1.m1.1.1.1"></times><cn type="integer" id="A2.SS2.p2.1.m1.1.1.2.cmml" xref="A2.SS2.p2.1.m1.1.1.2">3</cn><ci id="A2.SS2.p2.1.m1.1.1.3a.cmml" xref="A2.SS2.p2.1.m1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="A2.SS2.p2.1.m1.1.1.3.cmml" xref="A2.SS2.p2.1.m1.1.1.3">x</mtext></ci><apply id="A2.SS2.p2.1.m1.1.1.4.cmml" xref="A2.SS2.p2.1.m1.1.1.4"><csymbol cd="ambiguous" id="A2.SS2.p2.1.m1.1.1.4.1.cmml" xref="A2.SS2.p2.1.m1.1.1.4">superscript</csymbol><cn type="integer" id="A2.SS2.p2.1.m1.1.1.4.2.cmml" xref="A2.SS2.p2.1.m1.1.1.4.2">10</cn><apply id="A2.SS2.p2.1.m1.1.1.4.3.cmml" xref="A2.SS2.p2.1.m1.1.1.4.3"><minus id="A2.SS2.p2.1.m1.1.1.4.3.1.cmml" xref="A2.SS2.p2.1.m1.1.1.4.3"></minus><cn type="integer" id="A2.SS2.p2.1.m1.1.1.4.3.2.cmml" xref="A2.SS2.p2.1.m1.1.1.4.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.1.m1.1c">3\texttt{x}10^{-4}</annotation></semantics></math> and decay the learning rate by 0.8 when the training accuracy plateaus.
For IRLC, we use a learning rate of <math id="A2.SS2.p2.2.m2.1" class="ltx_Math" alttext="5\texttt{x}10^{-4}" display="inline"><semantics id="A2.SS2.p2.2.m2.1a"><mrow id="A2.SS2.p2.2.m2.1.1" xref="A2.SS2.p2.2.m2.1.1.cmml"><mn id="A2.SS2.p2.2.m2.1.1.2" xref="A2.SS2.p2.2.m2.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p2.2.m2.1.1.1" xref="A2.SS2.p2.2.m2.1.1.1.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="A2.SS2.p2.2.m2.1.1.3" xref="A2.SS2.p2.2.m2.1.1.3a.cmml">x</mtext><mo lspace="0em" rspace="0em" id="A2.SS2.p2.2.m2.1.1.1a" xref="A2.SS2.p2.2.m2.1.1.1.cmml">​</mo><msup id="A2.SS2.p2.2.m2.1.1.4" xref="A2.SS2.p2.2.m2.1.1.4.cmml"><mn id="A2.SS2.p2.2.m2.1.1.4.2" xref="A2.SS2.p2.2.m2.1.1.4.2.cmml">10</mn><mrow id="A2.SS2.p2.2.m2.1.1.4.3" xref="A2.SS2.p2.2.m2.1.1.4.3.cmml"><mo id="A2.SS2.p2.2.m2.1.1.4.3a" xref="A2.SS2.p2.2.m2.1.1.4.3.cmml">−</mo><mn id="A2.SS2.p2.2.m2.1.1.4.3.2" xref="A2.SS2.p2.2.m2.1.1.4.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p2.2.m2.1b"><apply id="A2.SS2.p2.2.m2.1.1.cmml" xref="A2.SS2.p2.2.m2.1.1"><times id="A2.SS2.p2.2.m2.1.1.1.cmml" xref="A2.SS2.p2.2.m2.1.1.1"></times><cn type="integer" id="A2.SS2.p2.2.m2.1.1.2.cmml" xref="A2.SS2.p2.2.m2.1.1.2">5</cn><ci id="A2.SS2.p2.2.m2.1.1.3a.cmml" xref="A2.SS2.p2.2.m2.1.1.3"><mtext class="ltx_mathvariant_monospace" id="A2.SS2.p2.2.m2.1.1.3.cmml" xref="A2.SS2.p2.2.m2.1.1.3">x</mtext></ci><apply id="A2.SS2.p2.2.m2.1.1.4.cmml" xref="A2.SS2.p2.2.m2.1.1.4"><csymbol cd="ambiguous" id="A2.SS2.p2.2.m2.1.1.4.1.cmml" xref="A2.SS2.p2.2.m2.1.1.4">superscript</csymbol><cn type="integer" id="A2.SS2.p2.2.m2.1.1.4.2.cmml" xref="A2.SS2.p2.2.m2.1.1.4.2">10</cn><apply id="A2.SS2.p2.2.m2.1.1.4.3.cmml" xref="A2.SS2.p2.2.m2.1.1.4.3"><minus id="A2.SS2.p2.2.m2.1.1.4.3.1.cmml" xref="A2.SS2.p2.2.m2.1.1.4.3"></minus><cn type="integer" id="A2.SS2.p2.2.m2.1.1.4.3.2.cmml" xref="A2.SS2.p2.2.m2.1.1.4.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p2.2.m2.1c">5\texttt{x}10^{-4}</annotation></semantics></math> and decay the learning rate by 0.99999 every iteration.
For all models, we regularize using dropout and apply early stopping based on the development set accuracy (see below).</p>
</div>
<div id="A2.SS2.p3" class="ltx_para ltx_noindent">
<p id="A2.SS2.p3.2" class="ltx_p">When training IRLC, we apply the sampling procedure 5 times per question and average the losses.
We weight the entropy penalty <math id="A2.SS2.p3.1.m1.1" class="ltx_Math" alttext="P_{H}" display="inline"><semantics id="A2.SS2.p3.1.m1.1a"><msub id="A2.SS2.p3.1.m1.1.1" xref="A2.SS2.p3.1.m1.1.1.cmml"><mi id="A2.SS2.p3.1.m1.1.1.2" xref="A2.SS2.p3.1.m1.1.1.2.cmml">P</mi><mi id="A2.SS2.p3.1.m1.1.1.3" xref="A2.SS2.p3.1.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.1.m1.1b"><apply id="A2.SS2.p3.1.m1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.1.m1.1.1.1.cmml" xref="A2.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A2.SS2.p3.1.m1.1.1.2.cmml" xref="A2.SS2.p3.1.m1.1.1.2">𝑃</ci><ci id="A2.SS2.p3.1.m1.1.1.3.cmml" xref="A2.SS2.p3.1.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.1.m1.1c">P_{H}</annotation></semantics></math> and interaction penalty <math id="A2.SS2.p3.2.m2.1" class="ltx_Math" alttext="P_{I}" display="inline"><semantics id="A2.SS2.p3.2.m2.1a"><msub id="A2.SS2.p3.2.m2.1.1" xref="A2.SS2.p3.2.m2.1.1.cmml"><mi id="A2.SS2.p3.2.m2.1.1.2" xref="A2.SS2.p3.2.m2.1.1.2.cmml">P</mi><mi id="A2.SS2.p3.2.m2.1.1.3" xref="A2.SS2.p3.2.m2.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="A2.SS2.p3.2.m2.1b"><apply id="A2.SS2.p3.2.m2.1.1.cmml" xref="A2.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A2.SS2.p3.2.m2.1.1.1.cmml" xref="A2.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="A2.SS2.p3.2.m2.1.1.2.cmml" xref="A2.SS2.p3.2.m2.1.1.2">𝑃</ci><ci id="A2.SS2.p3.2.m2.1.1.3.cmml" xref="A2.SS2.p3.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p3.2.m2.1c">P_{I}</annotation></semantics></math> (Eq. <a href="#S4.E10" title="In 4.3 Counting ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>) both by 0.005 relative to the counting loss.
These penalty weights yield the best development set accuracy within the hyperparameter search we performed (Fig.  <a href="#A3.F10" title="Figure 10 ‣ Appendix C Additional analyses and experiments ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>).</p>
</div>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Additional analyses and experiments</h2>

<div id="A3.p1" class="ltx_para ltx_noindent">
<p id="A3.p1.1" class="ltx_p"><span id="A3.p1.1.1" class="ltx_text ltx_font_bold">IRLC auxiliary loss.</span> We performed a grid search to determine the optimal setting for the weights of the auxiliary losses for training IRLC. From our observations, the entropy penalty is important to balance the exploration of the model during training. In addition, the interaction penalty prevents degenerate counting strategies. The results of the grid search suggest that these auxiliary losses improve performance but become unhelpful if given too much weight (Fig.  <a href="#A3.F10" title="Figure 10 ‣ Appendix C Additional analyses and experiments ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). In any case, IRLC outperforms the baseline models across the range of settings explored.</p>
</div>
<figure id="A3.F10" class="ltx_figure"><img src="/html/1712.08697/assets/x5.png" id="A3.F10.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="296" height="231" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>
Results of a hyperparameter sweep over the penalty weights. The accuracy over the development set is reported for each weight setting.
</figcaption>
</figure>
<figure id="A3.F11" class="ltx_figure"><img src="/html/1712.08697/assets/x6.png" id="A3.F11.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="380" height="132" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>
HowMany-QA test set performance for models trained with the full HowMany-QA training data (blue) and trained without the additional data from Visual Genome (green).
</figcaption>
</figure>
<figure id="A3.F12" class="ltx_figure"><img src="/html/1712.08697/assets/x7.png" id="A3.F12.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="126" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>
(Left) Average count probability (Eq. <a href="#S4.E15" title="In 4.3 Counting ‣ 4 Model ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>) from UpDown, grouped according to the estimated count. (Right) Cumulative distribution of the absolute difference between the top two predicted counts, shown for when the most likely count was less than 5 (blue) and when it was greater than or equal to 5 (green). The probability distributions are much less smooth when the estimated count is large.
</figcaption>
</figure>
<div id="A3.p2" class="ltx_para ltx_noindent">
<p id="A3.p2.1" class="ltx_p"><span id="A3.p2.1.1" class="ltx_text ltx_font_bold">Data augmentation with Visual Genome.</span> Here, we compare performance on the HowMany-QA test set for models trained with and without additional data from Visual Genome QA.
In all cases, performance benefits from the additional training data (Fig.  <a href="#A3.F11" title="Figure 11 ‣ Appendix C Additional analyses and experiments ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>).
On average, excluding Visual Genome from the training data decreases accuracy by 2.7% and increases RMSE by 0.12.
Interestingly, the performance of IRLC is most robust to the loss of training data.</p>
</div>
<div id="A3.p3" class="ltx_para ltx_noindent">
<p id="A3.p3.1" class="ltx_p"><span id="A3.p3.1.1" class="ltx_text ltx_font_bold">Ordinality of UpDown output.</span> Whereas the training objectives for SoftCount and IRLC intrinsically reflect the ordinal nature of counts, the same is not true for UpDown. For example, the loss experienced by SoftCount and IRLC reflect the degree of error between the estimated count and the ground truth target; however, UpDown is trained only to place high probability mass on the ground truth value (missing by 1 or by 10 are treated as equally incorrect).
We examine the patterns in the output count probabilities from UpDown to ask whether the model learns an ordinal representation despite its non-ordinal training objective.
Figure  <a href="#A3.F12" title="Figure 12 ‣ Appendix C Additional analyses and experiments ‣ Interpretable Counting for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> illustrates these trends.
When the estimated count is less than 5, the second-most probable count is very frequently adjacent to the most probable count.
When the estimated count is larger than 5, the probability distribution is less smooth, such that the second-most probable count is often considerably different than the most probable count.
This result suggests that UpDown learns ordinality for lower count values (where training data is abundant) but fails to generalize this concept to larger counts (where training data is more sparse).</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Evaluation metrics</h2>

<div id="A4.p1" class="ltx_para ltx_noindent">
<p id="A4.p1.1" class="ltx_p"><span id="A4.p1.1.1" class="ltx_text ltx_font_bold">Accuracy.</span> The VQA dataset includes annotations from ten human reviewers per question.
The accuracy of a given answer <math id="A4.p1.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="A4.p1.1.m1.1a"><mi id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><ci id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">a</annotation></semantics></math> depends on how many of the provided answers it agrees with.
It is scored as correct if at least 3 humans answers agree:</p>
<table id="A4.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E20.m1.4" class="ltx_Math" alttext="\displaystyle{\texttt{Acc}}\left({a}\right)=\texttt{min}\left[\frac{\textnormal{\#humans that said }a}{3},1\right]." display="inline"><semantics id="A4.E20.m1.4a"><mrow id="A4.E20.m1.4.4.1" xref="A4.E20.m1.4.4.1.1.cmml"><mrow id="A4.E20.m1.4.4.1.1" xref="A4.E20.m1.4.4.1.1.cmml"><mrow id="A4.E20.m1.4.4.1.1.2" xref="A4.E20.m1.4.4.1.1.2.cmml"><mtext class="ltx_mathvariant_monospace" id="A4.E20.m1.4.4.1.1.2.2" xref="A4.E20.m1.4.4.1.1.2.2a.cmml">Acc</mtext><mo lspace="0em" rspace="0em" id="A4.E20.m1.4.4.1.1.2.1" xref="A4.E20.m1.4.4.1.1.2.1.cmml">​</mo><mrow id="A4.E20.m1.4.4.1.1.2.3.2" xref="A4.E20.m1.4.4.1.1.2.cmml"><mo id="A4.E20.m1.4.4.1.1.2.3.2.1" xref="A4.E20.m1.4.4.1.1.2.cmml">(</mo><mi id="A4.E20.m1.1.1" xref="A4.E20.m1.1.1.cmml">a</mi><mo id="A4.E20.m1.4.4.1.1.2.3.2.2" xref="A4.E20.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A4.E20.m1.4.4.1.1.1" xref="A4.E20.m1.4.4.1.1.1.cmml">=</mo><mrow id="A4.E20.m1.4.4.1.1.3" xref="A4.E20.m1.4.4.1.1.3.cmml"><mtext class="ltx_mathvariant_monospace" id="A4.E20.m1.4.4.1.1.3.2" xref="A4.E20.m1.4.4.1.1.3.2a.cmml">min</mtext><mo lspace="0em" rspace="0em" id="A4.E20.m1.4.4.1.1.3.1" xref="A4.E20.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="A4.E20.m1.4.4.1.1.3.3.2" xref="A4.E20.m1.4.4.1.1.3.3.1.cmml"><mo id="A4.E20.m1.4.4.1.1.3.3.2.1" xref="A4.E20.m1.4.4.1.1.3.3.1.cmml">[</mo><mstyle displaystyle="true" id="A4.E20.m1.2.2" xref="A4.E20.m1.2.2.cmml"><mfrac id="A4.E20.m1.2.2a" xref="A4.E20.m1.2.2.cmml"><mrow id="A4.E20.m1.2.2.2" xref="A4.E20.m1.2.2.2.cmml"><mtext id="A4.E20.m1.2.2.2.2" xref="A4.E20.m1.2.2.2.2a.cmml">#humans that said </mtext><mo lspace="0em" rspace="0em" id="A4.E20.m1.2.2.2.1" xref="A4.E20.m1.2.2.2.1.cmml">​</mo><mi id="A4.E20.m1.2.2.2.3" xref="A4.E20.m1.2.2.2.3.cmml">a</mi></mrow><mn id="A4.E20.m1.2.2.3" xref="A4.E20.m1.2.2.3.cmml">3</mn></mfrac></mstyle><mo id="A4.E20.m1.4.4.1.1.3.3.2.2" xref="A4.E20.m1.4.4.1.1.3.3.1.cmml">,</mo><mn id="A4.E20.m1.3.3" xref="A4.E20.m1.3.3.cmml">1</mn><mo id="A4.E20.m1.4.4.1.1.3.3.2.3" xref="A4.E20.m1.4.4.1.1.3.3.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="A4.E20.m1.4.4.1.2" xref="A4.E20.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E20.m1.4b"><apply id="A4.E20.m1.4.4.1.1.cmml" xref="A4.E20.m1.4.4.1"><eq id="A4.E20.m1.4.4.1.1.1.cmml" xref="A4.E20.m1.4.4.1.1.1"></eq><apply id="A4.E20.m1.4.4.1.1.2.cmml" xref="A4.E20.m1.4.4.1.1.2"><times id="A4.E20.m1.4.4.1.1.2.1.cmml" xref="A4.E20.m1.4.4.1.1.2.1"></times><ci id="A4.E20.m1.4.4.1.1.2.2a.cmml" xref="A4.E20.m1.4.4.1.1.2.2"><mtext class="ltx_mathvariant_monospace" id="A4.E20.m1.4.4.1.1.2.2.cmml" xref="A4.E20.m1.4.4.1.1.2.2">Acc</mtext></ci><ci id="A4.E20.m1.1.1.cmml" xref="A4.E20.m1.1.1">𝑎</ci></apply><apply id="A4.E20.m1.4.4.1.1.3.cmml" xref="A4.E20.m1.4.4.1.1.3"><times id="A4.E20.m1.4.4.1.1.3.1.cmml" xref="A4.E20.m1.4.4.1.1.3.1"></times><ci id="A4.E20.m1.4.4.1.1.3.2a.cmml" xref="A4.E20.m1.4.4.1.1.3.2"><mtext class="ltx_mathvariant_monospace" id="A4.E20.m1.4.4.1.1.3.2.cmml" xref="A4.E20.m1.4.4.1.1.3.2">min</mtext></ci><interval closure="closed" id="A4.E20.m1.4.4.1.1.3.3.1.cmml" xref="A4.E20.m1.4.4.1.1.3.3.2"><apply id="A4.E20.m1.2.2.cmml" xref="A4.E20.m1.2.2"><divide id="A4.E20.m1.2.2.1.cmml" xref="A4.E20.m1.2.2"></divide><apply id="A4.E20.m1.2.2.2.cmml" xref="A4.E20.m1.2.2.2"><times id="A4.E20.m1.2.2.2.1.cmml" xref="A4.E20.m1.2.2.2.1"></times><ci id="A4.E20.m1.2.2.2.2a.cmml" xref="A4.E20.m1.2.2.2.2"><mtext id="A4.E20.m1.2.2.2.2.cmml" xref="A4.E20.m1.2.2.2.2">#humans that said </mtext></ci><ci id="A4.E20.m1.2.2.2.3.cmml" xref="A4.E20.m1.2.2.2.3">𝑎</ci></apply><cn type="integer" id="A4.E20.m1.2.2.3.cmml" xref="A4.E20.m1.2.2.3">3</cn></apply><cn type="integer" id="A4.E20.m1.3.3.cmml" xref="A4.E20.m1.3.3">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E20.m1.4c">\displaystyle{\texttt{Acc}}\left({a}\right)=\texttt{min}\left[\frac{\textnormal{\#humans that said }a}{3},1\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p id="A4.p1.2" class="ltx_p">Each answer’s accuracy is averaged over each 10-choose-9 set of human answers.
As described in the main text, we only consider examples where the consensus answer was in the range of 0-20.
We use all ten labels to calculate accuracy, regardless of whether individual labels deviate from this range.
Thee accuracy values we report are taken from the average accuracy over some set of examples.</p>
</div>
<div id="A4.p2" class="ltx_para ltx_noindent">
<p id="A4.p2.1" class="ltx_p"><span id="A4.p2.1.1" class="ltx_text ltx_font_bold">RMSE.</span> This metric simply quantifies the typical deviation between the model count and the ground-truth.
Across a set of <math id="A4.p2.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A4.p2.1.m1.1a"><mi id="A4.p2.1.m1.1.1" xref="A4.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A4.p2.1.m1.1b"><ci id="A4.p2.1.m1.1.1.cmml" xref="A4.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.1.m1.1c">N</annotation></semantics></math>, we calculate this metric as</p>
<table id="A4.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E21.m1.2" class="ltx_Math" alttext="\displaystyle\texttt{RMSE}=\sqrt[]{\frac{1}{N}\sum_{i}(\hat{C}_{i}-C_{i})^{2}}," display="inline"><semantics id="A4.E21.m1.2a"><mrow id="A4.E21.m1.2.2.1" xref="A4.E21.m1.2.2.1.1.cmml"><mrow id="A4.E21.m1.2.2.1.1" xref="A4.E21.m1.2.2.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="A4.E21.m1.2.2.1.1.2" xref="A4.E21.m1.2.2.1.1.2a.cmml">RMSE</mtext><mo id="A4.E21.m1.2.2.1.1.1" xref="A4.E21.m1.2.2.1.1.1.cmml">=</mo><msqrt id="A4.E21.m1.1.1" xref="A4.E21.m1.1.1.cmml"><mrow id="A4.E21.m1.1.1.1" xref="A4.E21.m1.1.1.1.cmml"><mstyle displaystyle="true" id="A4.E21.m1.1.1.1.3" xref="A4.E21.m1.1.1.1.3.cmml"><mfrac id="A4.E21.m1.1.1.1.3a" xref="A4.E21.m1.1.1.1.3.cmml"><mn id="A4.E21.m1.1.1.1.3.2" xref="A4.E21.m1.1.1.1.3.2.cmml">1</mn><mi id="A4.E21.m1.1.1.1.3.3" xref="A4.E21.m1.1.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A4.E21.m1.1.1.1.2" xref="A4.E21.m1.1.1.1.2.cmml">​</mo><mrow id="A4.E21.m1.1.1.1.1" xref="A4.E21.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A4.E21.m1.1.1.1.1.2" xref="A4.E21.m1.1.1.1.1.2.cmml"><munder id="A4.E21.m1.1.1.1.1.2a" xref="A4.E21.m1.1.1.1.1.2.cmml"><mo movablelimits="false" id="A4.E21.m1.1.1.1.1.2.2" xref="A4.E21.m1.1.1.1.1.2.2.cmml">∑</mo><mi id="A4.E21.m1.1.1.1.1.2.3" xref="A4.E21.m1.1.1.1.1.2.3.cmml">i</mi></munder></mstyle><msup id="A4.E21.m1.1.1.1.1.1" xref="A4.E21.m1.1.1.1.1.1.cmml"><mrow id="A4.E21.m1.1.1.1.1.1.1.1" xref="A4.E21.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A4.E21.m1.1.1.1.1.1.1.1.2" xref="A4.E21.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E21.m1.1.1.1.1.1.1.1.1" xref="A4.E21.m1.1.1.1.1.1.1.1.1.cmml"><msub id="A4.E21.m1.1.1.1.1.1.1.1.1.2" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="A4.E21.m1.1.1.1.1.1.1.1.1.2.2" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.2" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mo id="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.1" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="A4.E21.m1.1.1.1.1.1.1.1.1.2.3" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="A4.E21.m1.1.1.1.1.1.1.1.1.1" xref="A4.E21.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A4.E21.m1.1.1.1.1.1.1.1.1.3" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A4.E21.m1.1.1.1.1.1.1.1.1.3.2" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3.2.cmml">C</mi><mi id="A4.E21.m1.1.1.1.1.1.1.1.1.3.3" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A4.E21.m1.1.1.1.1.1.1.1.3" xref="A4.E21.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A4.E21.m1.1.1.1.1.1.3" xref="A4.E21.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><mo id="A4.E21.m1.2.2.1.2" xref="A4.E21.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E21.m1.2b"><apply id="A4.E21.m1.2.2.1.1.cmml" xref="A4.E21.m1.2.2.1"><eq id="A4.E21.m1.2.2.1.1.1.cmml" xref="A4.E21.m1.2.2.1.1.1"></eq><ci id="A4.E21.m1.2.2.1.1.2a.cmml" xref="A4.E21.m1.2.2.1.1.2"><mtext class="ltx_mathvariant_monospace" id="A4.E21.m1.2.2.1.1.2.cmml" xref="A4.E21.m1.2.2.1.1.2">RMSE</mtext></ci><apply id="A4.E21.m1.1.1.cmml" xref="A4.E21.m1.1.1"><root id="A4.E21.m1.1.1a.cmml" xref="A4.E21.m1.1.1"></root><apply id="A4.E21.m1.1.1.1.cmml" xref="A4.E21.m1.1.1.1"><times id="A4.E21.m1.1.1.1.2.cmml" xref="A4.E21.m1.1.1.1.2"></times><apply id="A4.E21.m1.1.1.1.3.cmml" xref="A4.E21.m1.1.1.1.3"><divide id="A4.E21.m1.1.1.1.3.1.cmml" xref="A4.E21.m1.1.1.1.3"></divide><cn type="integer" id="A4.E21.m1.1.1.1.3.2.cmml" xref="A4.E21.m1.1.1.1.3.2">1</cn><ci id="A4.E21.m1.1.1.1.3.3.cmml" xref="A4.E21.m1.1.1.1.3.3">𝑁</ci></apply><apply id="A4.E21.m1.1.1.1.1.cmml" xref="A4.E21.m1.1.1.1.1"><apply id="A4.E21.m1.1.1.1.1.2.cmml" xref="A4.E21.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E21.m1.1.1.1.1.2.1.cmml" xref="A4.E21.m1.1.1.1.1.2">subscript</csymbol><sum id="A4.E21.m1.1.1.1.1.2.2.cmml" xref="A4.E21.m1.1.1.1.1.2.2"></sum><ci id="A4.E21.m1.1.1.1.1.2.3.cmml" xref="A4.E21.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A4.E21.m1.1.1.1.1.1.cmml" xref="A4.E21.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E21.m1.1.1.1.1.1.2.cmml" xref="A4.E21.m1.1.1.1.1.1">superscript</csymbol><apply id="A4.E21.m1.1.1.1.1.1.1.1.1.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1"><minus id="A4.E21.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="A4.E21.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A4.E21.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.2"><ci id="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.1">^</ci><ci id="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.2.2">𝐶</ci></apply><ci id="A4.E21.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="A4.E21.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E21.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A4.E21.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3.2">𝐶</ci><ci id="A4.E21.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A4.E21.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn type="integer" id="A4.E21.m1.1.1.1.1.1.3.cmml" xref="A4.E21.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E21.m1.2c">\displaystyle\texttt{RMSE}=\sqrt[]{\frac{1}{N}\sum_{i}(\hat{C}_{i}-C_{i})^{2}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
<p id="A4.p2.4" class="ltx_p">where <math id="A4.p2.2.m1.1" class="ltx_Math" alttext="\hat{C}_{i}" display="inline"><semantics id="A4.p2.2.m1.1a"><msub id="A4.p2.2.m1.1.1" xref="A4.p2.2.m1.1.1.cmml"><mover accent="true" id="A4.p2.2.m1.1.1.2" xref="A4.p2.2.m1.1.1.2.cmml"><mi id="A4.p2.2.m1.1.1.2.2" xref="A4.p2.2.m1.1.1.2.2.cmml">C</mi><mo id="A4.p2.2.m1.1.1.2.1" xref="A4.p2.2.m1.1.1.2.1.cmml">^</mo></mover><mi id="A4.p2.2.m1.1.1.3" xref="A4.p2.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p2.2.m1.1b"><apply id="A4.p2.2.m1.1.1.cmml" xref="A4.p2.2.m1.1.1"><csymbol cd="ambiguous" id="A4.p2.2.m1.1.1.1.cmml" xref="A4.p2.2.m1.1.1">subscript</csymbol><apply id="A4.p2.2.m1.1.1.2.cmml" xref="A4.p2.2.m1.1.1.2"><ci id="A4.p2.2.m1.1.1.2.1.cmml" xref="A4.p2.2.m1.1.1.2.1">^</ci><ci id="A4.p2.2.m1.1.1.2.2.cmml" xref="A4.p2.2.m1.1.1.2.2">𝐶</ci></apply><ci id="A4.p2.2.m1.1.1.3.cmml" xref="A4.p2.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.2.m1.1c">\hat{C}_{i}</annotation></semantics></math> and <math id="A4.p2.3.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="A4.p2.3.m2.1a"><msub id="A4.p2.3.m2.1.1" xref="A4.p2.3.m2.1.1.cmml"><mi id="A4.p2.3.m2.1.1.2" xref="A4.p2.3.m2.1.1.2.cmml">C</mi><mi id="A4.p2.3.m2.1.1.3" xref="A4.p2.3.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p2.3.m2.1b"><apply id="A4.p2.3.m2.1.1.cmml" xref="A4.p2.3.m2.1.1"><csymbol cd="ambiguous" id="A4.p2.3.m2.1.1.1.cmml" xref="A4.p2.3.m2.1.1">subscript</csymbol><ci id="A4.p2.3.m2.1.1.2.cmml" xref="A4.p2.3.m2.1.1.2">𝐶</ci><ci id="A4.p2.3.m2.1.1.3.cmml" xref="A4.p2.3.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.3.m2.1c">C_{i}</annotation></semantics></math> are the predicted and ground truth counts, respectively, for question <math id="A4.p2.4.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A4.p2.4.m3.1a"><mi id="A4.p2.4.m3.1.1" xref="A4.p2.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A4.p2.4.m3.1b"><ci id="A4.p2.4.m3.1.1.cmml" xref="A4.p2.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p2.4.m3.1c">i</annotation></semantics></math>.
RMSE is a measurement of error, so lower is better.</p>
</div>
<div id="A4.p3" class="ltx_para ltx_noindent">
<p id="A4.p3.3" class="ltx_p"><span id="A4.p3.3.1" class="ltx_text ltx_font_bold">Grounding Quality.</span> We introduce a new evaluation method for quantifying how relevant the objects counted by a model are to the type of object it was asked to count.
This evaluation metric takes advantage of the ground truth labels included in the COCO dataset.
These labels annotate each object instance of 80 different categories for each of the images in the development set.
We make use of GloVe embeddings to compute semantic similarity. We use <math id="A4.p3.1.m1.1" class="ltx_Math" alttext="{\texttt{GloVe}}\left({x}\right)\in\mathbb{R}^{300}" display="inline"><semantics id="A4.p3.1.m1.1a"><mrow id="A4.p3.1.m1.1.2" xref="A4.p3.1.m1.1.2.cmml"><mrow id="A4.p3.1.m1.1.2.2" xref="A4.p3.1.m1.1.2.2.cmml"><mtext class="ltx_mathvariant_monospace" id="A4.p3.1.m1.1.2.2.2" xref="A4.p3.1.m1.1.2.2.2a.cmml">GloVe</mtext><mo lspace="0em" rspace="0em" id="A4.p3.1.m1.1.2.2.1" xref="A4.p3.1.m1.1.2.2.1.cmml">​</mo><mrow id="A4.p3.1.m1.1.2.2.3.2" xref="A4.p3.1.m1.1.2.2.cmml"><mo id="A4.p3.1.m1.1.2.2.3.2.1" xref="A4.p3.1.m1.1.2.2.cmml">(</mo><mi id="A4.p3.1.m1.1.1" xref="A4.p3.1.m1.1.1.cmml">x</mi><mo id="A4.p3.1.m1.1.2.2.3.2.2" xref="A4.p3.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="A4.p3.1.m1.1.2.1" xref="A4.p3.1.m1.1.2.1.cmml">∈</mo><msup id="A4.p3.1.m1.1.2.3" xref="A4.p3.1.m1.1.2.3.cmml"><mi id="A4.p3.1.m1.1.2.3.2" xref="A4.p3.1.m1.1.2.3.2.cmml">ℝ</mi><mn id="A4.p3.1.m1.1.2.3.3" xref="A4.p3.1.m1.1.2.3.3.cmml">300</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.1.m1.1b"><apply id="A4.p3.1.m1.1.2.cmml" xref="A4.p3.1.m1.1.2"><in id="A4.p3.1.m1.1.2.1.cmml" xref="A4.p3.1.m1.1.2.1"></in><apply id="A4.p3.1.m1.1.2.2.cmml" xref="A4.p3.1.m1.1.2.2"><times id="A4.p3.1.m1.1.2.2.1.cmml" xref="A4.p3.1.m1.1.2.2.1"></times><ci id="A4.p3.1.m1.1.2.2.2a.cmml" xref="A4.p3.1.m1.1.2.2.2"><mtext class="ltx_mathvariant_monospace" id="A4.p3.1.m1.1.2.2.2.cmml" xref="A4.p3.1.m1.1.2.2.2">GloVe</mtext></ci><ci id="A4.p3.1.m1.1.1.cmml" xref="A4.p3.1.m1.1.1">𝑥</ci></apply><apply id="A4.p3.1.m1.1.2.3.cmml" xref="A4.p3.1.m1.1.2.3"><csymbol cd="ambiguous" id="A4.p3.1.m1.1.2.3.1.cmml" xref="A4.p3.1.m1.1.2.3">superscript</csymbol><ci id="A4.p3.1.m1.1.2.3.2.cmml" xref="A4.p3.1.m1.1.2.3.2">ℝ</ci><cn type="integer" id="A4.p3.1.m1.1.2.3.3.cmml" xref="A4.p3.1.m1.1.2.3.3">300</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.1.m1.1c">{\texttt{GloVe}}\left({x}\right)\in\mathbb{R}^{300}</annotation></semantics></math> to denote the (<math id="A4.p3.2.m2.1" class="ltx_Math" alttext="L2" display="inline"><semantics id="A4.p3.2.m2.1a"><mrow id="A4.p3.2.m2.1.1" xref="A4.p3.2.m2.1.1.cmml"><mi id="A4.p3.2.m2.1.1.2" xref="A4.p3.2.m2.1.1.2.cmml">L</mi><mo lspace="0em" rspace="0em" id="A4.p3.2.m2.1.1.1" xref="A4.p3.2.m2.1.1.1.cmml">​</mo><mn id="A4.p3.2.m2.1.1.3" xref="A4.p3.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p3.2.m2.1b"><apply id="A4.p3.2.m2.1.1.cmml" xref="A4.p3.2.m2.1.1"><times id="A4.p3.2.m2.1.1.1.cmml" xref="A4.p3.2.m2.1.1.1"></times><ci id="A4.p3.2.m2.1.1.2.cmml" xref="A4.p3.2.m2.1.1.2">𝐿</ci><cn type="integer" id="A4.p3.2.m2.1.1.3.cmml" xref="A4.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.2.m2.1c">L2</annotation></semantics></math> normalized) GloVe embedding of category <math id="A4.p3.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A4.p3.3.m3.1a"><mi id="A4.p3.3.m3.1.1" xref="A4.p3.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A4.p3.3.m3.1b"><ci id="A4.p3.3.m3.1.1.cmml" xref="A4.p3.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p3.3.m3.1c">x</annotation></semantics></math>.</p>
</div>
<div id="A4.p4" class="ltx_para ltx_noindent">
<p id="A4.p4.1" class="ltx_p">For each image <math id="A4.p4.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A4.p4.1.m1.1a"><mi id="A4.p4.1.m1.1.1" xref="A4.p4.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A4.p4.1.m1.1b"><ci id="A4.p4.1.m1.1.1.cmml" xref="A4.p4.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p4.1.m1.1c">m</annotation></semantics></math>, the analysis is carried out in two stages.</p>
</div>
<div id="A4.p5" class="ltx_para ltx_noindent">
<p id="A4.p5.3" class="ltx_p">First, we assign one of the COCO categories (or background) to each of the object proposals used for counting.
For each object proposal, we find the object in the COCO labels with the largest IoU.
If the IoU is above 0.5, we assign the object proposal to the category of the COCO object, otherwise we assign the object proposal to the background.
Below, we use <math id="A4.p5.1.m1.1" class="ltx_Math" alttext="k^{m}_{i}" display="inline"><semantics id="A4.p5.1.m1.1a"><msubsup id="A4.p5.1.m1.1.1" xref="A4.p5.1.m1.1.1.cmml"><mi id="A4.p5.1.m1.1.1.2.2" xref="A4.p5.1.m1.1.1.2.2.cmml">k</mi><mi id="A4.p5.1.m1.1.1.3" xref="A4.p5.1.m1.1.1.3.cmml">i</mi><mi id="A4.p5.1.m1.1.1.2.3" xref="A4.p5.1.m1.1.1.2.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.p5.1.m1.1b"><apply id="A4.p5.1.m1.1.1.cmml" xref="A4.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A4.p5.1.m1.1.1.1.cmml" xref="A4.p5.1.m1.1.1">subscript</csymbol><apply id="A4.p5.1.m1.1.1.2.cmml" xref="A4.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A4.p5.1.m1.1.1.2.1.cmml" xref="A4.p5.1.m1.1.1">superscript</csymbol><ci id="A4.p5.1.m1.1.1.2.2.cmml" xref="A4.p5.1.m1.1.1.2.2">𝑘</ci><ci id="A4.p5.1.m1.1.1.2.3.cmml" xref="A4.p5.1.m1.1.1.2.3">𝑚</ci></apply><ci id="A4.p5.1.m1.1.1.3.cmml" xref="A4.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p5.1.m1.1c">k^{m}_{i}</annotation></semantics></math> to denote the category assigned to object proposal <math id="A4.p5.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A4.p5.2.m2.1a"><mi id="A4.p5.2.m2.1.1" xref="A4.p5.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A4.p5.2.m2.1b"><ci id="A4.p5.2.m2.1.1.cmml" xref="A4.p5.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p5.2.m2.1c">i</annotation></semantics></math> for image <math id="A4.p5.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A4.p5.3.m3.1a"><mi id="A4.p5.3.m3.1.1" xref="A4.p5.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A4.p5.3.m3.1b"><ci id="A4.p5.3.m3.1.1.cmml" xref="A4.p5.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p5.3.m3.1c">m</annotation></semantics></math>.</p>
</div>
<div id="A4.p6" class="ltx_para ltx_noindent">
<p id="A4.p6.3" class="ltx_p">Second, for each of the COCO categories present in image <math id="A4.p6.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A4.p6.1.m1.1a"><mi id="A4.p6.1.m1.1.1" xref="A4.p6.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A4.p6.1.m1.1b"><ci id="A4.p6.1.m1.1.1.cmml" xref="A4.p6.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.1.m1.1c">m</annotation></semantics></math>, we use the category <math id="A4.p6.2.m2.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A4.p6.2.m2.1a"><mi id="A4.p6.2.m2.1.1" xref="A4.p6.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.p6.2.m2.1b"><ci id="A4.p6.2.m2.1.1.cmml" xref="A4.p6.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.2.m2.1c">q</annotation></semantics></math> (i.e. <math id="A4.p6.3.m3.1" class="ltx_Math" alttext="q=\textrm{``car''}" display="inline"><semantics id="A4.p6.3.m3.1a"><mrow id="A4.p6.3.m3.1.1" xref="A4.p6.3.m3.1.1.cmml"><mi id="A4.p6.3.m3.1.1.2" xref="A4.p6.3.m3.1.1.2.cmml">q</mi><mo id="A4.p6.3.m3.1.1.1" xref="A4.p6.3.m3.1.1.1.cmml">=</mo><mtext id="A4.p6.3.m3.1.1.3" xref="A4.p6.3.m3.1.1.3a.cmml">“car”</mtext></mrow><annotation-xml encoding="MathML-Content" id="A4.p6.3.m3.1b"><apply id="A4.p6.3.m3.1.1.cmml" xref="A4.p6.3.m3.1.1"><eq id="A4.p6.3.m3.1.1.1.cmml" xref="A4.p6.3.m3.1.1.1"></eq><ci id="A4.p6.3.m3.1.1.2.cmml" xref="A4.p6.3.m3.1.1.2">𝑞</ci><ci id="A4.p6.3.m3.1.1.3a.cmml" xref="A4.p6.3.m3.1.1.3"><mtext id="A4.p6.3.m3.1.1.3.cmml" xref="A4.p6.3.m3.1.1.3">“car”</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.3.m3.1c">q=\textrm{``car''}</annotation></semantics></math>) to build a question (i.e. “How many <span id="A4.p6.3.1" class="ltx_text ltx_font_italic">cars</span> are there?”). For SoftCount and IRLC, the count returned in response to this question is the sum of each object proposal’s inferred count value:</p>
<table id="A4.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E22.m1.5" class="ltx_Math" alttext="\displaystyle C^{(m,q)}=\sum_{i}^{N^{m}}w^{(m,q)}_{i}," display="inline"><semantics id="A4.E22.m1.5a"><mrow id="A4.E22.m1.5.5.1" xref="A4.E22.m1.5.5.1.1.cmml"><mrow id="A4.E22.m1.5.5.1.1" xref="A4.E22.m1.5.5.1.1.cmml"><msup id="A4.E22.m1.5.5.1.1.2" xref="A4.E22.m1.5.5.1.1.2.cmml"><mi id="A4.E22.m1.5.5.1.1.2.2" xref="A4.E22.m1.5.5.1.1.2.2.cmml">C</mi><mrow id="A4.E22.m1.2.2.2.4" xref="A4.E22.m1.2.2.2.3.cmml"><mo stretchy="false" id="A4.E22.m1.2.2.2.4.1" xref="A4.E22.m1.2.2.2.3.cmml">(</mo><mi id="A4.E22.m1.1.1.1.1" xref="A4.E22.m1.1.1.1.1.cmml">m</mi><mo id="A4.E22.m1.2.2.2.4.2" xref="A4.E22.m1.2.2.2.3.cmml">,</mo><mi id="A4.E22.m1.2.2.2.2" xref="A4.E22.m1.2.2.2.2.cmml">q</mi><mo stretchy="false" id="A4.E22.m1.2.2.2.4.3" xref="A4.E22.m1.2.2.2.3.cmml">)</mo></mrow></msup><mo id="A4.E22.m1.5.5.1.1.1" xref="A4.E22.m1.5.5.1.1.1.cmml">=</mo><mrow id="A4.E22.m1.5.5.1.1.3" xref="A4.E22.m1.5.5.1.1.3.cmml"><mstyle displaystyle="true" id="A4.E22.m1.5.5.1.1.3.1" xref="A4.E22.m1.5.5.1.1.3.1.cmml"><munderover id="A4.E22.m1.5.5.1.1.3.1a" xref="A4.E22.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="A4.E22.m1.5.5.1.1.3.1.2.2" xref="A4.E22.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mi id="A4.E22.m1.5.5.1.1.3.1.2.3" xref="A4.E22.m1.5.5.1.1.3.1.2.3.cmml">i</mi><msup id="A4.E22.m1.5.5.1.1.3.1.3" xref="A4.E22.m1.5.5.1.1.3.1.3.cmml"><mi id="A4.E22.m1.5.5.1.1.3.1.3.2" xref="A4.E22.m1.5.5.1.1.3.1.3.2.cmml">N</mi><mi id="A4.E22.m1.5.5.1.1.3.1.3.3" xref="A4.E22.m1.5.5.1.1.3.1.3.3.cmml">m</mi></msup></munderover></mstyle><msubsup id="A4.E22.m1.5.5.1.1.3.2" xref="A4.E22.m1.5.5.1.1.3.2.cmml"><mi id="A4.E22.m1.5.5.1.1.3.2.2.2" xref="A4.E22.m1.5.5.1.1.3.2.2.2.cmml">w</mi><mi id="A4.E22.m1.5.5.1.1.3.2.3" xref="A4.E22.m1.5.5.1.1.3.2.3.cmml">i</mi><mrow id="A4.E22.m1.4.4.2.4" xref="A4.E22.m1.4.4.2.3.cmml"><mo stretchy="false" id="A4.E22.m1.4.4.2.4.1" xref="A4.E22.m1.4.4.2.3.cmml">(</mo><mi id="A4.E22.m1.3.3.1.1" xref="A4.E22.m1.3.3.1.1.cmml">m</mi><mo id="A4.E22.m1.4.4.2.4.2" xref="A4.E22.m1.4.4.2.3.cmml">,</mo><mi id="A4.E22.m1.4.4.2.2" xref="A4.E22.m1.4.4.2.2.cmml">q</mi><mo stretchy="false" id="A4.E22.m1.4.4.2.4.3" xref="A4.E22.m1.4.4.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="A4.E22.m1.5.5.1.2" xref="A4.E22.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E22.m1.5b"><apply id="A4.E22.m1.5.5.1.1.cmml" xref="A4.E22.m1.5.5.1"><eq id="A4.E22.m1.5.5.1.1.1.cmml" xref="A4.E22.m1.5.5.1.1.1"></eq><apply id="A4.E22.m1.5.5.1.1.2.cmml" xref="A4.E22.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.1.1.2.1.cmml" xref="A4.E22.m1.5.5.1.1.2">superscript</csymbol><ci id="A4.E22.m1.5.5.1.1.2.2.cmml" xref="A4.E22.m1.5.5.1.1.2.2">𝐶</ci><interval closure="open" id="A4.E22.m1.2.2.2.3.cmml" xref="A4.E22.m1.2.2.2.4"><ci id="A4.E22.m1.1.1.1.1.cmml" xref="A4.E22.m1.1.1.1.1">𝑚</ci><ci id="A4.E22.m1.2.2.2.2.cmml" xref="A4.E22.m1.2.2.2.2">𝑞</ci></interval></apply><apply id="A4.E22.m1.5.5.1.1.3.cmml" xref="A4.E22.m1.5.5.1.1.3"><apply id="A4.E22.m1.5.5.1.1.3.1.cmml" xref="A4.E22.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.1.1.3.1.1.cmml" xref="A4.E22.m1.5.5.1.1.3.1">superscript</csymbol><apply id="A4.E22.m1.5.5.1.1.3.1.2.cmml" xref="A4.E22.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.1.1.3.1.2.1.cmml" xref="A4.E22.m1.5.5.1.1.3.1">subscript</csymbol><sum id="A4.E22.m1.5.5.1.1.3.1.2.2.cmml" xref="A4.E22.m1.5.5.1.1.3.1.2.2"></sum><ci id="A4.E22.m1.5.5.1.1.3.1.2.3.cmml" xref="A4.E22.m1.5.5.1.1.3.1.2.3">𝑖</ci></apply><apply id="A4.E22.m1.5.5.1.1.3.1.3.cmml" xref="A4.E22.m1.5.5.1.1.3.1.3"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.1.1.3.1.3.1.cmml" xref="A4.E22.m1.5.5.1.1.3.1.3">superscript</csymbol><ci id="A4.E22.m1.5.5.1.1.3.1.3.2.cmml" xref="A4.E22.m1.5.5.1.1.3.1.3.2">𝑁</ci><ci id="A4.E22.m1.5.5.1.1.3.1.3.3.cmml" xref="A4.E22.m1.5.5.1.1.3.1.3.3">𝑚</ci></apply></apply><apply id="A4.E22.m1.5.5.1.1.3.2.cmml" xref="A4.E22.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.1.1.3.2.1.cmml" xref="A4.E22.m1.5.5.1.1.3.2">subscript</csymbol><apply id="A4.E22.m1.5.5.1.1.3.2.2.cmml" xref="A4.E22.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="A4.E22.m1.5.5.1.1.3.2.2.1.cmml" xref="A4.E22.m1.5.5.1.1.3.2">superscript</csymbol><ci id="A4.E22.m1.5.5.1.1.3.2.2.2.cmml" xref="A4.E22.m1.5.5.1.1.3.2.2.2">𝑤</ci><interval closure="open" id="A4.E22.m1.4.4.2.3.cmml" xref="A4.E22.m1.4.4.2.4"><ci id="A4.E22.m1.3.3.1.1.cmml" xref="A4.E22.m1.3.3.1.1">𝑚</ci><ci id="A4.E22.m1.4.4.2.2.cmml" xref="A4.E22.m1.4.4.2.2">𝑞</ci></interval></apply><ci id="A4.E22.m1.5.5.1.1.3.2.3.cmml" xref="A4.E22.m1.5.5.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E22.m1.5c">\displaystyle C^{(m,q)}=\sum_{i}^{N^{m}}w^{(m,q)}_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p id="A4.p6.9" class="ltx_p">where <math id="A4.p6.4.m1.1" class="ltx_Math" alttext="N^{m}" display="inline"><semantics id="A4.p6.4.m1.1a"><msup id="A4.p6.4.m1.1.1" xref="A4.p6.4.m1.1.1.cmml"><mi id="A4.p6.4.m1.1.1.2" xref="A4.p6.4.m1.1.1.2.cmml">N</mi><mi id="A4.p6.4.m1.1.1.3" xref="A4.p6.4.m1.1.1.3.cmml">m</mi></msup><annotation-xml encoding="MathML-Content" id="A4.p6.4.m1.1b"><apply id="A4.p6.4.m1.1.1.cmml" xref="A4.p6.4.m1.1.1"><csymbol cd="ambiguous" id="A4.p6.4.m1.1.1.1.cmml" xref="A4.p6.4.m1.1.1">superscript</csymbol><ci id="A4.p6.4.m1.1.1.2.cmml" xref="A4.p6.4.m1.1.1.2">𝑁</ci><ci id="A4.p6.4.m1.1.1.3.cmml" xref="A4.p6.4.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.4.m1.1c">N^{m}</annotation></semantics></math> is the number of object proposals in image <math id="A4.p6.5.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="A4.p6.5.m2.1a"><mi id="A4.p6.5.m2.1.1" xref="A4.p6.5.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="A4.p6.5.m2.1b"><ci id="A4.p6.5.m2.1.1.cmml" xref="A4.p6.5.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.5.m2.1c">m</annotation></semantics></math> and <math id="A4.p6.6.m3.2" class="ltx_Math" alttext="w^{(m,q)}_{i}" display="inline"><semantics id="A4.p6.6.m3.2a"><msubsup id="A4.p6.6.m3.2.3" xref="A4.p6.6.m3.2.3.cmml"><mi id="A4.p6.6.m3.2.3.2.2" xref="A4.p6.6.m3.2.3.2.2.cmml">w</mi><mi id="A4.p6.6.m3.2.3.3" xref="A4.p6.6.m3.2.3.3.cmml">i</mi><mrow id="A4.p6.6.m3.2.2.2.4" xref="A4.p6.6.m3.2.2.2.3.cmml"><mo stretchy="false" id="A4.p6.6.m3.2.2.2.4.1" xref="A4.p6.6.m3.2.2.2.3.cmml">(</mo><mi id="A4.p6.6.m3.1.1.1.1" xref="A4.p6.6.m3.1.1.1.1.cmml">m</mi><mo id="A4.p6.6.m3.2.2.2.4.2" xref="A4.p6.6.m3.2.2.2.3.cmml">,</mo><mi id="A4.p6.6.m3.2.2.2.2" xref="A4.p6.6.m3.2.2.2.2.cmml">q</mi><mo stretchy="false" id="A4.p6.6.m3.2.2.2.4.3" xref="A4.p6.6.m3.2.2.2.3.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A4.p6.6.m3.2b"><apply id="A4.p6.6.m3.2.3.cmml" xref="A4.p6.6.m3.2.3"><csymbol cd="ambiguous" id="A4.p6.6.m3.2.3.1.cmml" xref="A4.p6.6.m3.2.3">subscript</csymbol><apply id="A4.p6.6.m3.2.3.2.cmml" xref="A4.p6.6.m3.2.3"><csymbol cd="ambiguous" id="A4.p6.6.m3.2.3.2.1.cmml" xref="A4.p6.6.m3.2.3">superscript</csymbol><ci id="A4.p6.6.m3.2.3.2.2.cmml" xref="A4.p6.6.m3.2.3.2.2">𝑤</ci><interval closure="open" id="A4.p6.6.m3.2.2.2.3.cmml" xref="A4.p6.6.m3.2.2.2.4"><ci id="A4.p6.6.m3.1.1.1.1.cmml" xref="A4.p6.6.m3.1.1.1.1">𝑚</ci><ci id="A4.p6.6.m3.2.2.2.2.cmml" xref="A4.p6.6.m3.2.2.2.2">𝑞</ci></interval></apply><ci id="A4.p6.6.m3.2.3.3.cmml" xref="A4.p6.6.m3.2.3.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.6.m3.2c">w^{(m,q)}_{i}</annotation></semantics></math> is the count value given to proposal <math id="A4.p6.7.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="A4.p6.7.m4.1a"><mi id="A4.p6.7.m4.1.1" xref="A4.p6.7.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="A4.p6.7.m4.1b"><ci id="A4.p6.7.m4.1.1.cmml" xref="A4.p6.7.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.7.m4.1c">i</annotation></semantics></math>.
We use the count values to compute a weighted sum of the semantic similarity between the assigned object proposal categories <math id="A4.p6.8.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A4.p6.8.m5.1a"><mi id="A4.p6.8.m5.1.1" xref="A4.p6.8.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A4.p6.8.m5.1b"><ci id="A4.p6.8.m5.1.1.cmml" xref="A4.p6.8.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.8.m5.1c">k</annotation></semantics></math> and the question category <math id="A4.p6.9.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="A4.p6.9.m6.1a"><mi id="A4.p6.9.m6.1.1" xref="A4.p6.9.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A4.p6.9.m6.1b"><ci id="A4.p6.9.m6.1.1.cmml" xref="A4.p6.9.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.9.m6.1c">q</annotation></semantics></math>:</p>
<table id="A4.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E23.m1.6" class="ltx_Math" alttext="\displaystyle s^{(m,q)}=\sum_{i}^{N^{m}}w^{(m,q)}_{i}\left({\texttt{GloVe}}\left({k^{m}_{i}}\right)^{T}{\texttt{GloVe}}\left({q}\right)\right)," display="inline"><semantics id="A4.E23.m1.6a"><mrow id="A4.E23.m1.6.6.1" xref="A4.E23.m1.6.6.1.1.cmml"><mrow id="A4.E23.m1.6.6.1.1" xref="A4.E23.m1.6.6.1.1.cmml"><msup id="A4.E23.m1.6.6.1.1.3" xref="A4.E23.m1.6.6.1.1.3.cmml"><mi id="A4.E23.m1.6.6.1.1.3.2" xref="A4.E23.m1.6.6.1.1.3.2.cmml">s</mi><mrow id="A4.E23.m1.2.2.2.4" xref="A4.E23.m1.2.2.2.3.cmml"><mo stretchy="false" id="A4.E23.m1.2.2.2.4.1" xref="A4.E23.m1.2.2.2.3.cmml">(</mo><mi id="A4.E23.m1.1.1.1.1" xref="A4.E23.m1.1.1.1.1.cmml">m</mi><mo id="A4.E23.m1.2.2.2.4.2" xref="A4.E23.m1.2.2.2.3.cmml">,</mo><mi id="A4.E23.m1.2.2.2.2" xref="A4.E23.m1.2.2.2.2.cmml">q</mi><mo stretchy="false" id="A4.E23.m1.2.2.2.4.3" xref="A4.E23.m1.2.2.2.3.cmml">)</mo></mrow></msup><mo id="A4.E23.m1.6.6.1.1.2" xref="A4.E23.m1.6.6.1.1.2.cmml">=</mo><mrow id="A4.E23.m1.6.6.1.1.1" xref="A4.E23.m1.6.6.1.1.1.cmml"><mstyle displaystyle="true" id="A4.E23.m1.6.6.1.1.1.2" xref="A4.E23.m1.6.6.1.1.1.2.cmml"><munderover id="A4.E23.m1.6.6.1.1.1.2a" xref="A4.E23.m1.6.6.1.1.1.2.cmml"><mo movablelimits="false" id="A4.E23.m1.6.6.1.1.1.2.2.2" xref="A4.E23.m1.6.6.1.1.1.2.2.2.cmml">∑</mo><mi id="A4.E23.m1.6.6.1.1.1.2.2.3" xref="A4.E23.m1.6.6.1.1.1.2.2.3.cmml">i</mi><msup id="A4.E23.m1.6.6.1.1.1.2.3" xref="A4.E23.m1.6.6.1.1.1.2.3.cmml"><mi id="A4.E23.m1.6.6.1.1.1.2.3.2" xref="A4.E23.m1.6.6.1.1.1.2.3.2.cmml">N</mi><mi id="A4.E23.m1.6.6.1.1.1.2.3.3" xref="A4.E23.m1.6.6.1.1.1.2.3.3.cmml">m</mi></msup></munderover></mstyle><mrow id="A4.E23.m1.6.6.1.1.1.1" xref="A4.E23.m1.6.6.1.1.1.1.cmml"><msubsup id="A4.E23.m1.6.6.1.1.1.1.3" xref="A4.E23.m1.6.6.1.1.1.1.3.cmml"><mi id="A4.E23.m1.6.6.1.1.1.1.3.2.2" xref="A4.E23.m1.6.6.1.1.1.1.3.2.2.cmml">w</mi><mi id="A4.E23.m1.6.6.1.1.1.1.3.3" xref="A4.E23.m1.6.6.1.1.1.1.3.3.cmml">i</mi><mrow id="A4.E23.m1.4.4.2.4" xref="A4.E23.m1.4.4.2.3.cmml"><mo stretchy="false" id="A4.E23.m1.4.4.2.4.1" xref="A4.E23.m1.4.4.2.3.cmml">(</mo><mi id="A4.E23.m1.3.3.1.1" xref="A4.E23.m1.3.3.1.1.cmml">m</mi><mo id="A4.E23.m1.4.4.2.4.2" xref="A4.E23.m1.4.4.2.3.cmml">,</mo><mi id="A4.E23.m1.4.4.2.2" xref="A4.E23.m1.4.4.2.2.cmml">q</mi><mo stretchy="false" id="A4.E23.m1.4.4.2.4.3" xref="A4.E23.m1.4.4.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A4.E23.m1.6.6.1.1.1.1.2" xref="A4.E23.m1.6.6.1.1.1.1.2.cmml">​</mo><mrow id="A4.E23.m1.6.6.1.1.1.1.1.1" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A4.E23.m1.6.6.1.1.1.1.1.1.2" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A4.E23.m1.6.6.1.1.1.1.1.1.1" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_monospace" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.3" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.3a.cmml">GloVe</mtext><mo lspace="0em" rspace="0em" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.2" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mrow id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">k</mi><mi id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">m</mi></msubsup><mo id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.3" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.2a" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mtext class="ltx_mathvariant_monospace" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.4" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.4a.cmml">GloVe</mtext><mo lspace="0em" rspace="0em" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.2b" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A4.E23.m1.6.6.1.1.1.1.1.1.1.5.2" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A4.E23.m1.6.6.1.1.1.1.1.1.1.5.2.1" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mi id="A4.E23.m1.5.5" xref="A4.E23.m1.5.5.cmml">q</mi><mo id="A4.E23.m1.6.6.1.1.1.1.1.1.1.5.2.2" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A4.E23.m1.6.6.1.1.1.1.1.1.3" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A4.E23.m1.6.6.1.2" xref="A4.E23.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E23.m1.6b"><apply id="A4.E23.m1.6.6.1.1.cmml" xref="A4.E23.m1.6.6.1"><eq id="A4.E23.m1.6.6.1.1.2.cmml" xref="A4.E23.m1.6.6.1.1.2"></eq><apply id="A4.E23.m1.6.6.1.1.3.cmml" xref="A4.E23.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.3.1.cmml" xref="A4.E23.m1.6.6.1.1.3">superscript</csymbol><ci id="A4.E23.m1.6.6.1.1.3.2.cmml" xref="A4.E23.m1.6.6.1.1.3.2">𝑠</ci><interval closure="open" id="A4.E23.m1.2.2.2.3.cmml" xref="A4.E23.m1.2.2.2.4"><ci id="A4.E23.m1.1.1.1.1.cmml" xref="A4.E23.m1.1.1.1.1">𝑚</ci><ci id="A4.E23.m1.2.2.2.2.cmml" xref="A4.E23.m1.2.2.2.2">𝑞</ci></interval></apply><apply id="A4.E23.m1.6.6.1.1.1.cmml" xref="A4.E23.m1.6.6.1.1.1"><apply id="A4.E23.m1.6.6.1.1.1.2.cmml" xref="A4.E23.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.2.1.cmml" xref="A4.E23.m1.6.6.1.1.1.2">superscript</csymbol><apply id="A4.E23.m1.6.6.1.1.1.2.2.cmml" xref="A4.E23.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.2.2.1.cmml" xref="A4.E23.m1.6.6.1.1.1.2">subscript</csymbol><sum id="A4.E23.m1.6.6.1.1.1.2.2.2.cmml" xref="A4.E23.m1.6.6.1.1.1.2.2.2"></sum><ci id="A4.E23.m1.6.6.1.1.1.2.2.3.cmml" xref="A4.E23.m1.6.6.1.1.1.2.2.3">𝑖</ci></apply><apply id="A4.E23.m1.6.6.1.1.1.2.3.cmml" xref="A4.E23.m1.6.6.1.1.1.2.3"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.2.3.1.cmml" xref="A4.E23.m1.6.6.1.1.1.2.3">superscript</csymbol><ci id="A4.E23.m1.6.6.1.1.1.2.3.2.cmml" xref="A4.E23.m1.6.6.1.1.1.2.3.2">𝑁</ci><ci id="A4.E23.m1.6.6.1.1.1.2.3.3.cmml" xref="A4.E23.m1.6.6.1.1.1.2.3.3">𝑚</ci></apply></apply><apply id="A4.E23.m1.6.6.1.1.1.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1"><times id="A4.E23.m1.6.6.1.1.1.1.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.2"></times><apply id="A4.E23.m1.6.6.1.1.1.1.3.cmml" xref="A4.E23.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.1.3.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.3">subscript</csymbol><apply id="A4.E23.m1.6.6.1.1.1.1.3.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.1.3.2.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.3">superscript</csymbol><ci id="A4.E23.m1.6.6.1.1.1.1.3.2.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.3.2.2">𝑤</ci><interval closure="open" id="A4.E23.m1.4.4.2.3.cmml" xref="A4.E23.m1.4.4.2.4"><ci id="A4.E23.m1.3.3.1.1.cmml" xref="A4.E23.m1.3.3.1.1">𝑚</ci><ci id="A4.E23.m1.4.4.2.2.cmml" xref="A4.E23.m1.4.4.2.2">𝑞</ci></interval></apply><ci id="A4.E23.m1.6.6.1.1.1.1.3.3.cmml" xref="A4.E23.m1.6.6.1.1.1.1.3.3">𝑖</ci></apply><apply id="A4.E23.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1"><times id="A4.E23.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.2"></times><ci id="A4.E23.m1.6.6.1.1.1.1.1.1.1.3a.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_monospace" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.3">GloVe</mtext></ci><apply id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑘</ci><ci id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="A4.E23.m1.6.6.1.1.1.1.1.1.1.4a.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.4"><mtext class="ltx_mathvariant_monospace" id="A4.E23.m1.6.6.1.1.1.1.1.1.1.4.cmml" xref="A4.E23.m1.6.6.1.1.1.1.1.1.1.4">GloVe</mtext></ci><ci id="A4.E23.m1.5.5.cmml" xref="A4.E23.m1.5.5">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E23.m1.6c">\displaystyle s^{(m,q)}=\sum_{i}^{N^{m}}w^{(m,q)}_{i}\left({\texttt{GloVe}}\left({k^{m}_{i}}\right)^{T}{\texttt{GloVe}}\left({q}\right)\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p id="A4.p6.10" class="ltx_p">where semantic similarity is estimated from the dot product between the embeddings of the assigned category and the question category.
If <math id="A4.p6.10.m1.1" class="ltx_Math" alttext="k^{m}_{i}" display="inline"><semantics id="A4.p6.10.m1.1a"><msubsup id="A4.p6.10.m1.1.1" xref="A4.p6.10.m1.1.1.cmml"><mi id="A4.p6.10.m1.1.1.2.2" xref="A4.p6.10.m1.1.1.2.2.cmml">k</mi><mi id="A4.p6.10.m1.1.1.3" xref="A4.p6.10.m1.1.1.3.cmml">i</mi><mi id="A4.p6.10.m1.1.1.2.3" xref="A4.p6.10.m1.1.1.2.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="A4.p6.10.m1.1b"><apply id="A4.p6.10.m1.1.1.cmml" xref="A4.p6.10.m1.1.1"><csymbol cd="ambiguous" id="A4.p6.10.m1.1.1.1.cmml" xref="A4.p6.10.m1.1.1">subscript</csymbol><apply id="A4.p6.10.m1.1.1.2.cmml" xref="A4.p6.10.m1.1.1"><csymbol cd="ambiguous" id="A4.p6.10.m1.1.1.2.1.cmml" xref="A4.p6.10.m1.1.1">superscript</csymbol><ci id="A4.p6.10.m1.1.1.2.2.cmml" xref="A4.p6.10.m1.1.1.2.2">𝑘</ci><ci id="A4.p6.10.m1.1.1.2.3.cmml" xref="A4.p6.10.m1.1.1.2.3">𝑚</ci></apply><ci id="A4.p6.10.m1.1.1.3.cmml" xref="A4.p6.10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p6.10.m1.1c">k^{m}_{i}</annotation></semantics></math> corresponds to the background category, we replace its embedding with a vector of zeros.</p>
</div>
<div id="A4.p7" class="ltx_para ltx_noindent">
<p id="A4.p7.1" class="ltx_p">The final metric is computed for each COCO category by accumulating the results over all images that contain a label for that category and normalizing by the net count to get an average:</p>
<table id="A4.EGx15" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A4.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A4.E24.m1.6" class="ltx_Math" alttext="\displaystyle s^{(q)}=\frac{\Sigma_{m}s^{(m,q)}}{\Sigma_{m}C^{(m,q)}}." display="inline"><semantics id="A4.E24.m1.6a"><mrow id="A4.E24.m1.6.6.1" xref="A4.E24.m1.6.6.1.1.cmml"><mrow id="A4.E24.m1.6.6.1.1" xref="A4.E24.m1.6.6.1.1.cmml"><msup id="A4.E24.m1.6.6.1.1.2" xref="A4.E24.m1.6.6.1.1.2.cmml"><mi id="A4.E24.m1.6.6.1.1.2.2" xref="A4.E24.m1.6.6.1.1.2.2.cmml">s</mi><mrow id="A4.E24.m1.1.1.1.3" xref="A4.E24.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="A4.E24.m1.1.1.1.3.1" xref="A4.E24.m1.6.6.1.1.2.cmml">(</mo><mi id="A4.E24.m1.1.1.1.1" xref="A4.E24.m1.1.1.1.1.cmml">q</mi><mo stretchy="false" id="A4.E24.m1.1.1.1.3.2" xref="A4.E24.m1.6.6.1.1.2.cmml">)</mo></mrow></msup><mo id="A4.E24.m1.6.6.1.1.1" xref="A4.E24.m1.6.6.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A4.E24.m1.5.5" xref="A4.E24.m1.5.5.cmml"><mfrac id="A4.E24.m1.5.5a" xref="A4.E24.m1.5.5.cmml"><mrow id="A4.E24.m1.3.3.2" xref="A4.E24.m1.3.3.2.cmml"><msub id="A4.E24.m1.3.3.2.4" xref="A4.E24.m1.3.3.2.4.cmml"><mi mathvariant="normal" id="A4.E24.m1.3.3.2.4.2" xref="A4.E24.m1.3.3.2.4.2.cmml">Σ</mi><mi id="A4.E24.m1.3.3.2.4.3" xref="A4.E24.m1.3.3.2.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="A4.E24.m1.3.3.2.3" xref="A4.E24.m1.3.3.2.3.cmml">​</mo><msup id="A4.E24.m1.3.3.2.5" xref="A4.E24.m1.3.3.2.5.cmml"><mi id="A4.E24.m1.3.3.2.5.2" xref="A4.E24.m1.3.3.2.5.2.cmml">s</mi><mrow id="A4.E24.m1.3.3.2.2.2.4" xref="A4.E24.m1.3.3.2.2.2.3.cmml"><mo stretchy="false" id="A4.E24.m1.3.3.2.2.2.4.1" xref="A4.E24.m1.3.3.2.2.2.3.cmml">(</mo><mi id="A4.E24.m1.2.2.1.1.1.1" xref="A4.E24.m1.2.2.1.1.1.1.cmml">m</mi><mo id="A4.E24.m1.3.3.2.2.2.4.2" xref="A4.E24.m1.3.3.2.2.2.3.cmml">,</mo><mi id="A4.E24.m1.3.3.2.2.2.2" xref="A4.E24.m1.3.3.2.2.2.2.cmml">q</mi><mo stretchy="false" id="A4.E24.m1.3.3.2.2.2.4.3" xref="A4.E24.m1.3.3.2.2.2.3.cmml">)</mo></mrow></msup></mrow><mrow id="A4.E24.m1.5.5.4" xref="A4.E24.m1.5.5.4.cmml"><msub id="A4.E24.m1.5.5.4.4" xref="A4.E24.m1.5.5.4.4.cmml"><mi mathvariant="normal" id="A4.E24.m1.5.5.4.4.2" xref="A4.E24.m1.5.5.4.4.2.cmml">Σ</mi><mi id="A4.E24.m1.5.5.4.4.3" xref="A4.E24.m1.5.5.4.4.3.cmml">m</mi></msub><mo lspace="0em" rspace="0em" id="A4.E24.m1.5.5.4.3" xref="A4.E24.m1.5.5.4.3.cmml">​</mo><msup id="A4.E24.m1.5.5.4.5" xref="A4.E24.m1.5.5.4.5.cmml"><mi id="A4.E24.m1.5.5.4.5.2" xref="A4.E24.m1.5.5.4.5.2.cmml">C</mi><mrow id="A4.E24.m1.5.5.4.2.2.4" xref="A4.E24.m1.5.5.4.2.2.3.cmml"><mo stretchy="false" id="A4.E24.m1.5.5.4.2.2.4.1" xref="A4.E24.m1.5.5.4.2.2.3.cmml">(</mo><mi id="A4.E24.m1.4.4.3.1.1.1" xref="A4.E24.m1.4.4.3.1.1.1.cmml">m</mi><mo id="A4.E24.m1.5.5.4.2.2.4.2" xref="A4.E24.m1.5.5.4.2.2.3.cmml">,</mo><mi id="A4.E24.m1.5.5.4.2.2.2" xref="A4.E24.m1.5.5.4.2.2.2.cmml">q</mi><mo stretchy="false" id="A4.E24.m1.5.5.4.2.2.4.3" xref="A4.E24.m1.5.5.4.2.2.3.cmml">)</mo></mrow></msup></mrow></mfrac></mstyle></mrow><mo lspace="0em" id="A4.E24.m1.6.6.1.2" xref="A4.E24.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.E24.m1.6b"><apply id="A4.E24.m1.6.6.1.1.cmml" xref="A4.E24.m1.6.6.1"><eq id="A4.E24.m1.6.6.1.1.1.cmml" xref="A4.E24.m1.6.6.1.1.1"></eq><apply id="A4.E24.m1.6.6.1.1.2.cmml" xref="A4.E24.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="A4.E24.m1.6.6.1.1.2.1.cmml" xref="A4.E24.m1.6.6.1.1.2">superscript</csymbol><ci id="A4.E24.m1.6.6.1.1.2.2.cmml" xref="A4.E24.m1.6.6.1.1.2.2">𝑠</ci><ci id="A4.E24.m1.1.1.1.1.cmml" xref="A4.E24.m1.1.1.1.1">𝑞</ci></apply><apply id="A4.E24.m1.5.5.cmml" xref="A4.E24.m1.5.5"><divide id="A4.E24.m1.5.5.5.cmml" xref="A4.E24.m1.5.5"></divide><apply id="A4.E24.m1.3.3.2.cmml" xref="A4.E24.m1.3.3.2"><times id="A4.E24.m1.3.3.2.3.cmml" xref="A4.E24.m1.3.3.2.3"></times><apply id="A4.E24.m1.3.3.2.4.cmml" xref="A4.E24.m1.3.3.2.4"><csymbol cd="ambiguous" id="A4.E24.m1.3.3.2.4.1.cmml" xref="A4.E24.m1.3.3.2.4">subscript</csymbol><ci id="A4.E24.m1.3.3.2.4.2.cmml" xref="A4.E24.m1.3.3.2.4.2">Σ</ci><ci id="A4.E24.m1.3.3.2.4.3.cmml" xref="A4.E24.m1.3.3.2.4.3">𝑚</ci></apply><apply id="A4.E24.m1.3.3.2.5.cmml" xref="A4.E24.m1.3.3.2.5"><csymbol cd="ambiguous" id="A4.E24.m1.3.3.2.5.1.cmml" xref="A4.E24.m1.3.3.2.5">superscript</csymbol><ci id="A4.E24.m1.3.3.2.5.2.cmml" xref="A4.E24.m1.3.3.2.5.2">𝑠</ci><interval closure="open" id="A4.E24.m1.3.3.2.2.2.3.cmml" xref="A4.E24.m1.3.3.2.2.2.4"><ci id="A4.E24.m1.2.2.1.1.1.1.cmml" xref="A4.E24.m1.2.2.1.1.1.1">𝑚</ci><ci id="A4.E24.m1.3.3.2.2.2.2.cmml" xref="A4.E24.m1.3.3.2.2.2.2">𝑞</ci></interval></apply></apply><apply id="A4.E24.m1.5.5.4.cmml" xref="A4.E24.m1.5.5.4"><times id="A4.E24.m1.5.5.4.3.cmml" xref="A4.E24.m1.5.5.4.3"></times><apply id="A4.E24.m1.5.5.4.4.cmml" xref="A4.E24.m1.5.5.4.4"><csymbol cd="ambiguous" id="A4.E24.m1.5.5.4.4.1.cmml" xref="A4.E24.m1.5.5.4.4">subscript</csymbol><ci id="A4.E24.m1.5.5.4.4.2.cmml" xref="A4.E24.m1.5.5.4.4.2">Σ</ci><ci id="A4.E24.m1.5.5.4.4.3.cmml" xref="A4.E24.m1.5.5.4.4.3">𝑚</ci></apply><apply id="A4.E24.m1.5.5.4.5.cmml" xref="A4.E24.m1.5.5.4.5"><csymbol cd="ambiguous" id="A4.E24.m1.5.5.4.5.1.cmml" xref="A4.E24.m1.5.5.4.5">superscript</csymbol><ci id="A4.E24.m1.5.5.4.5.2.cmml" xref="A4.E24.m1.5.5.4.5.2">𝐶</ci><interval closure="open" id="A4.E24.m1.5.5.4.2.2.3.cmml" xref="A4.E24.m1.5.5.4.2.2.4"><ci id="A4.E24.m1.4.4.3.1.1.1.cmml" xref="A4.E24.m1.4.4.3.1.1.1">𝑚</ci><ci id="A4.E24.m1.5.5.4.2.2.2.cmml" xref="A4.E24.m1.5.5.4.2.2.2">𝑞</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.E24.m1.6c">\displaystyle s^{(q)}=\frac{\Sigma_{m}s^{(m,q)}}{\Sigma_{m}C^{(m,q)}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p id="A4.p7.2" class="ltx_p">The interpretation of this metric is straightforward: on average, how relevant are the counted objects to the subject of the question.</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1712.08696" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1712.08697" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1712.08697">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1712.08697" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1712.08698" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 21:54:57 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
